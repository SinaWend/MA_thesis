Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Aug 10 11:59:46 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-10_11-59-12/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-10_11-59-12/rule_results/2.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=2
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_54_seed_0_24141958

 Experiment start at: 2024-08-10 12:07:54.905501
before training, model accuracy: 0.6347637176513672
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.97036874, 'precision': 0.9704517, 'recall': 0.9703647, 'specificity': 0.9703647, 'f1': 0.9703673, 'auroc': 0.99582493, 'binary_precision': 0.96435946, 'binary_recall': 0.97687817, 'binary_specificity': 0.96385115, 'binary_f1_score': 0.97057843}
confusion matrix:
       0      1
0  24397    915
1    586  24758
---- Validation: 
scalar performance:
{'acc': 0.92773825, 'precision': 0.6005001, 'recall': 0.8219808, 'specificity': 0.8219808, 'f1': 0.6422071, 'auroc': 0.88931704, 'binary_precision': 0.208628, 'binary_recall': 0.7108434, 'binary_specificity': 0.93311816, 'binary_f1_score': 0.32258067}
confusion matrix:
       0     1
0  15612  1119
1    120   295
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91061896, 'precision': 0.67372525, 'recall': 0.6515723, 'specificity': 0.6515723, 'f1': 0.6616192, 'auroc': 0.86994374, 'binary_precision': 0.4009009, 'binary_recall': 0.3458549, 'binary_specificity': 0.95728964, 'binary_f1_score': 0.37134907}
confusion matrix:
      0    1
0  8943  399
1   505  267
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-10 12:24:09.747863,epoch time: 0:16:14.842362,used: 0:16:14.842362,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_54_seed_0_24141958
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97899556, 'precision': 0.97927976, 'recall': 0.9790009, 'specificity': 0.9790009, 'f1': 0.9789927, 'auroc': 0.9974251, 'binary_precision': 0.99105877, 'binary_recall': 0.96673113, 'binary_specificity': 0.99127066, 'binary_f1_score': 0.97874385}
confusion matrix:
       0      1
0  25096    221
1    843  24496
---- Validation: 
scalar performance:
{'acc': 0.97387147, 'precision': 0.72937953, 'recall': 0.79039764, 'specificity': 0.79039764, 'f1': 0.7559948, 'auroc': 0.90796864, 'binary_precision': 0.46880907, 'binary_recall': 0.5975904, 'binary_specificity': 0.98320484, 'binary_f1_score': 0.5254237}
confusion matrix:
       0    1
0  16450  281
1    167  248
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.918331, 'precision': 0.6632323, 'recall': 0.55711865, 'specificity': 0.55711865, 'f1': 0.5767386, 'auroc': 0.8920459, 'binary_precision': 0.39453125, 'binary_recall': 0.13082902, 'binary_specificity': 0.9834083, 'binary_f1_score': 0.19649805}
confusion matrix:
      0    1
0  9187  155
1   671  101
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-10 12:39:41.324310,epoch time: 0:15:31.576447,used: 0:31:46.418809,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_54_seed_0_24141958
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9814829, 'precision': 0.98150826, 'recall': 0.9814813, 'specificity': 0.9814813, 'f1': 0.9814827, 'auroc': 0.9978225, 'binary_precision': 0.9781331, 'binary_recall': 0.98500395, 'binary_specificity': 0.9779586, 'binary_f1_score': 0.98155653}
confusion matrix:
       0      1
0  24758    558
1    380  24960
---- Validation: 
scalar performance:
{'acc': 0.9646565, 'precision': 0.685007, 'recall': 0.8397228, 'specificity': 0.8397228, 'f1': 0.73707646, 'auroc': 0.9250964, 'binary_precision': 0.37740692, 'binary_recall': 0.70843375, 'binary_specificity': 0.9710119, 'binary_f1_score': 0.4924623}
confusion matrix:
       0    1
0  16246  485
1    121  294
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91922086, 'precision': 0.66134137, 'recall': 0.54631156, 'specificity': 0.54631156, 'f1': 0.56236404, 'auroc': 0.90277356, 'binary_precision': 0.3923445, 'binary_recall': 0.106217615, 'binary_specificity': 0.9864055, 'binary_f1_score': 0.16717635}
confusion matrix:
      0    1
0  9215  127
1   690   82
new oracle model saved
early stop counter: 1
val acc:0.9646564722061157, best validation acc: 0.9738714694976807, corresponding to test acc:                         0.9183310270309448 / 0.9192208647727966
after epoch: 3,now: 2024-08-10 12:55:04.343058,epoch time: 0:15:23.018748,used: 0:47:09.437557,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_54_seed_0_24141958
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9712571, 'precision': 0.97214437, 'recall': 0.97124267, 'specificity': 0.97124267, 'f1': 0.97124296, 'auroc': 0.998183, 'binary_precision': 0.95184416, 'binary_recall': 0.9927796, 'binary_specificity': 0.94970566, 'binary_f1_score': 0.9718811}
confusion matrix:
       0      1
0  24038   1273
1    183  25162
---- Validation: 
scalar performance:
{'acc': 0.9313542, 'precision': 0.61177886, 'recall': 0.8567318, 'specificity': 0.8567318, 'f1': 0.6590555, 'auroc': 0.9226117, 'binary_precision': 0.2294034, 'binary_recall': 0.7783133, 'binary_specificity': 0.9351503, 'binary_f1_score': 0.35436094}
confusion matrix:
       0     1
0  15646  1085
1     92   323
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9187265, 'precision': 0.67302144, 'recall': 0.56743324, 'specificity': 0.56743324, 'f1': 0.5900914, 'auroc': 0.9065304, 'binary_precision': 0.4125874, 'binary_recall': 0.15284973, 'binary_specificity': 0.9820167, 'binary_f1_score': 0.22306237}
confusion matrix:
      0    1
0  9174  168
1   654  118
early stop counter: 2
val acc:0.9313542246818542, best validation acc: 0.9738714694976807, corresponding to test acc:                         0.9183310270309448 / 0.9192208647727966
after epoch: 4,now: 2024-08-10 13:10:27.447460,epoch time: 0:15:23.104402,used: 1:02:32.541959,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_54_seed_0_24141958
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97739655, 'precision': 0.9777522, 'recall': 0.97738755, 'specificity': 0.97738755, 'f1': 0.9773921, 'auroc': 0.9982997, 'binary_precision': 0.964884, 'binary_recall': 0.9908858, 'binary_specificity': 0.96388924, 'binary_f1_score': 0.9777121}
confusion matrix:
       0      1
0  24397    914
1    231  25114
---- Validation: 
scalar performance:
{'acc': 0.934387, 'precision': 0.6157372, 'recall': 0.85593593, 'specificity': 0.85593593, 'f1': 0.66436946, 'auroc': 0.91908, 'binary_precision': 0.23742604, 'binary_recall': 0.773494, 'binary_specificity': 0.93837786, 'binary_f1_score': 0.36332768}
confusion matrix:
       0     1
0  15700  1031
1     94   321
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92070395, 'precision': 0.6140076, 'recall': 0.51205975, 'specificity': 0.51205975, 'f1': 0.5064312, 'auroc': 0.8901583, 'binary_precision': 0.3026316, 'binary_recall': 0.029792747, 'binary_specificity': 0.9943267, 'binary_f1_score': 0.054245282}
confusion matrix:
      0   1
0  9289  53
1   749  23
new oracle model saved
early stop counter: 3
val acc:0.9343870282173157, best validation acc: 0.9738714694976807, corresponding to test acc:                         0.9183310270309448 / 0.9207039475440979
after epoch: 5,now: 2024-08-10 13:25:49.652465,epoch time: 0:15:22.205005,used: 1:17:54.746964,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_54_seed_0_24141958
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9709807, 'precision': 0.97206104, 'recall': 0.97096944, 'specificity': 0.97096944, 'f1': 0.9709636, 'auroc': 0.99890935, 'binary_precision': 0.94959694, 'binary_recall': 0.99479085, 'binary_specificity': 0.947148, 'binary_f1_score': 0.97166866}
confusion matrix:
       0      1
0  23978   1338
1    132  25208
---- Validation: 
scalar performance:
{'acc': 0.9247638, 'precision': 0.6030152, 'recall': 0.8521799, 'specificity': 0.8521799, 'f1': 0.6465611, 'auroc': 0.9168755, 'binary_precision': 0.21198156, 'binary_recall': 0.77590364, 'binary_specificity': 0.9284562, 'binary_f1_score': 0.33298862}
confusion matrix:
       0     1
0  15534  1197
1     93   322
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9209017, 'precision': 0.62957793, 'recall': 0.5151375, 'specificity': 0.5151375, 'f1': 0.5120619, 'auroc': 0.89024144, 'binary_precision': 0.33333334, 'binary_recall': 0.03626943, 'binary_specificity': 0.99400556, 'binary_f1_score': 0.06542056}
confusion matrix:
      0   1
0  9286  56
1   744  28
new oracle model saved
early stop counter: 4
val acc:0.9247637987136841, best validation acc: 0.9738714694976807, corresponding to test acc:                         0.9183310270309448 / 0.9209017157554626
after epoch: 6,now: 2024-08-10 13:41:14.814302,epoch time: 0:15:25.161837,used: 1:33:19.908801,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_54_seed_0_24141958
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9743367, 'precision': 0.9750825, 'recall': 0.9743242, 'specificity': 0.9743242, 'f1': 0.9743261, 'auroc': 0.9987873, 'binary_precision': 0.9564161, 'binary_recall': 0.9940025, 'binary_specificity': 0.954646, 'binary_f1_score': 0.9748471}
confusion matrix:
       0      1
0  24164   1148
1    152  25192
---- Validation: 
scalar performance:
{'acc': 0.8704071, 'precision': 0.56705064, 'recall': 0.85370076, 'specificity': 0.85370076, 'f1': 0.5835894, 'auroc': 0.9147415, 'binary_precision': 0.1387445, 'binary_recall': 0.83614457, 'binary_specificity': 0.87125695, 'binary_f1_score': 0.23799726}
confusion matrix:
       0     1
0  14577  2154
1     68   347
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9233735, 'precision': 0.65434116, 'recall': 0.5028102, 'specificity': 0.5028102, 'f1': 0.48643935, 'auroc': 0.8808888, 'binary_precision': 0.3846154, 'binary_recall': 0.006476684, 'binary_specificity': 0.99914366, 'binary_f1_score': 0.012738854}
confusion matrix:
      0  1
0  9334  8
1   767  5
new oracle model saved
early stop counter: 5
val acc:0.8704071044921875, best validation acc: 0.9738714694976807, corresponding to test acc:                         0.9183310270309448 / 0.9233735203742981
after epoch: 7,now: 2024-08-10 13:56:16.423582,epoch time: 0:15:01.609280,used: 1:48:21.518081,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_54_seed_0_24141958
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9577938, 'precision': 0.96075416, 'recall': 0.95776534, 'specificity': 0.95776534, 'f1': 0.957724, 'auroc': 0.9990145, 'binary_precision': 0.92399883, 'binary_recall': 0.99771166, 'binary_specificity': 0.917819, 'binary_f1_score': 0.95944154}
confusion matrix:
       0      1
0  23230   2080
1     58  25288
---- Validation: 
scalar performance:
{'acc': 0.8606672, 'precision': 0.56457126, 'recall': 0.86163425, 'specificity': 0.86163425, 'f1': 0.5769967, 'auroc': 0.9208783, 'binary_precision': 0.1330855, 'binary_recall': 0.8626506, 'binary_specificity': 0.860618, 'binary_f1_score': 0.23059583}
confusion matrix:
       0     1
0  14399  2332
1     57   358
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.925351, 'precision': 0.7557013, 'recall': 0.5365587, 'specificity': 0.5365587, 'f1': 0.5490654, 'auroc': 0.895164, 'binary_precision': 0.5825243, 'binary_recall': 0.07772021, 'binary_specificity': 0.99539715, 'binary_f1_score': 0.13714287}
confusion matrix:
      0   1
0  9299  43
1   712  60
new oracle model saved
early stop counter: 6
val acc:0.8606672286987305, best validation acc: 0.9738714694976807, corresponding to test acc:                         0.9183310270309448 / 0.9253510236740112
after epoch: 8,now: 2024-08-10 14:11:44.187661,epoch time: 0:15:27.764079,used: 2:03:49.282160,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_54_seed_0_24141958
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.97692275, 'precision': 0.9775347, 'recall': 0.97691435, 'specificity': 0.97691435, 'f1': 0.97691506, 'auroc': 0.9989993, 'binary_precision': 0.9605579, 'binary_recall': 0.99471194, 'binary_specificity': 0.95911676, 'binary_f1_score': 0.9773366}
confusion matrix:
       0      1
0  24281   1035
1    134  25206
---- Validation: 
scalar performance:
{'acc': 0.92464715, 'precision': 0.60462916, 'recall': 0.8615196, 'specificity': 0.8615196, 'f1': 0.64908206, 'auroc': 0.91868687, 'binary_precision': 0.21470396, 'binary_recall': 0.79518074, 'binary_specificity': 0.9278585, 'binary_f1_score': 0.33811474}
confusion matrix:
       0     1
0  15524  1207
1     85   330
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9216927, 'precision': 0.60361063, 'recall': 0.5066535, 'specificity': 0.5066535, 'f1': 0.49549058, 'auroc': 0.88872164, 'binary_precision': 0.2826087, 'binary_recall': 0.016839378, 'binary_specificity': 0.9964676, 'binary_f1_score': 0.03178484}
confusion matrix:
      0   1
0  9309  33
1   759  13
early stop counter: 7
val acc:0.9246471524238586, best validation acc: 0.9738714694976807, corresponding to test acc:                         0.9183310270309448 / 0.9253510236740112
after epoch: 9,now: 2024-08-10 14:27:24.699298,epoch time: 0:15:40.511637,used: 2:19:29.793797,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_54_seed_0_24141958
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9579122, 'precision': 0.9607878, 'recall': 0.95788884, 'specificity': 0.95788884, 'f1': 0.9578449, 'auroc': 0.9988636, 'binary_precision': 0.9245345, 'binary_recall': 0.9972774, 'binary_specificity': 0.91850036, 'binary_f1_score': 0.9595293}
confusion matrix:
       0      1
0  23250   2063
1     69  25274
---- Validation: 
scalar performance:
{'acc': 0.8847545, 'precision': 0.57632715, 'recall': 0.8716268, 'specificity': 0.8716268, 'f1': 0.60117865, 'auroc': 0.927696, 'binary_precision': 0.1566212, 'binary_recall': 0.8578313, 'binary_specificity': 0.8854223, 'binary_f1_score': 0.26488099}
confusion matrix:
       0     1
0  14814  1917
1     59   356
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9238679, 'precision': 0.7291815, 'recall': 0.5096134, 'specificity': 0.5096134, 'f1': 0.50013137, 'auroc': 0.8666515, 'binary_precision': 0.53333336, 'binary_recall': 0.020725388, 'binary_specificity': 0.9985014, 'binary_f1_score': 0.03990025}
confusion matrix:
      0   1
0  9328  14
1   756  16
early stop counter: 8
val acc:0.884754478931427, best validation acc: 0.9738714694976807, corresponding to test acc:                         0.9183310270309448 / 0.9253510236740112
after epoch: 10,now: 2024-08-10 14:43:09.128808,epoch time: 0:15:44.429510,used: 2:35:14.223307,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_54_seed_0_24141958
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96245265, 'precision': 0.9648042, 'recall': 0.96243584, 'specificity': 0.96243584, 'f1': 0.96240413, 'auroc': 0.9992554, 'binary_precision': 0.93186176, 'binary_recall': 0.9979085, 'binary_specificity': 0.9269632, 'binary_f1_score': 0.9637549}
confusion matrix:
       0      1
0  23467   1849
1     53  25287
---- Validation: 
scalar performance:
{'acc': 0.8516855, 'precision': 0.5614447, 'recall': 0.8605569, 'specificity': 0.8605569, 'f1': 0.5695862, 'auroc': 0.9219608, 'binary_precision': 0.12666667, 'binary_recall': 0.86987954, 'binary_specificity': 0.85123426, 'binary_f1_score': 0.22113323}
confusion matrix:
       0     1
0  14242  2489
1     54   361
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9258454, 'precision': 0.8748599, 'recall': 0.5178136, 'specificity': 0.5178136, 'f1': 0.51543146, 'auroc': 0.85686505, 'binary_precision': 0.8235294, 'binary_recall': 0.03626943, 'binary_specificity': 0.99935776, 'binary_f1_score': 0.069478914}
confusion matrix:
      0   1
0  9336   6
1   744  28
new oracle model saved
early stop counter: 9
val acc:0.8516855239868164, best validation acc: 0.9738714694976807, corresponding to test acc:                         0.9183310270309448 / 0.9258453845977783
after epoch: 11,now: 2024-08-10 14:58:36.497091,epoch time: 0:15:27.368283,used: 2:50:41.591590,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_54_seed_0_24141958
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9650979, 'precision': 0.96702605, 'recall': 0.9650777, 'specificity': 0.9650777, 'f1': 0.9650608, 'auroc': 0.99903756, 'binary_precision': 0.9371755, 'binary_recall': 0.99708015, 'binary_specificity': 0.93307525, 'binary_f1_score': 0.96620023}
confusion matrix:
       0      1
0  23618   1694
1     74  25270
---- Validation: 
scalar performance:
{'acc': 0.84217894, 'precision': 0.5563758, 'recall': 0.8439363, 'specificity': 0.8439363, 'f1': 0.55918384, 'auroc': 0.9096292, 'binary_precision': 0.117273636, 'binary_recall': 0.8457831, 'binary_specificity': 0.84208953, 'binary_f1_score': 0.2059859}
confusion matrix:
       0     1
0  14089  2642
1     64   351
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92485666, 'precision': 0.87917656, 'recall': 0.50955445, 'specificity': 0.50955445, 'f1': 0.499438, 'auroc': 0.8412343, 'binary_precision': 0.8333333, 'binary_recall': 0.019430052, 'binary_specificity': 0.99967885, 'binary_f1_score': 0.037974685}
confusion matrix:
      0   1
0  9339   3
1   757  15
early stop counter: 10
val acc:0.8421789407730103, best validation acc: 0.9738714694976807, corresponding to test acc:                         0.9183310270309448 / 0.9258453845977783
after epoch: 12,now: 2024-08-10 15:14:08.185901,epoch time: 0:15:31.688810,used: 3:06:13.280400,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_54_seed_0_24141958
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.96805906, 'precision': 0.96964777, 'recall': 0.9680465, 'specificity': 0.9680465, 'f1': 0.9680314, 'auroc': 0.99916434, 'binary_precision': 0.9424404, 'binary_recall': 0.99704015, 'binary_specificity': 0.9390528, 'binary_f1_score': 0.9689717}
confusion matrix:
       0      1
0  23774   1543
1     75  25264
---- Validation: 
scalar performance:
{'acc': 0.8790389, 'precision': 0.57289594, 'recall': 0.8675232, 'specificity': 0.8675232, 'f1': 0.5946021, 'auroc': 0.9263421, 'binary_precision': 0.14985226, 'binary_recall': 0.85542166, 'binary_specificity': 0.87962466, 'binary_f1_score': 0.25502872}
confusion matrix:
       0     1
0  14717  2014
1     60   355
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9250544, 'precision': 0.9312673, 'recall': 0.5096615, 'specificity': 0.5096615, 'f1': 0.49953967, 'auroc': 0.78685176, 'binary_precision': 0.9375, 'binary_recall': 0.019430052, 'binary_specificity': 0.99989295, 'binary_f1_score': 0.03807107}
confusion matrix:
      0   1
0  9341   1
1   757  15
early stop counter: 11
val acc:0.8790388703346252, best validation acc: 0.9738714694976807, corresponding to test acc:                         0.9183310270309448 / 0.9258453845977783
after epoch: 13,now: 2024-08-10 15:29:29.548359,epoch time: 0:15:21.362458,used: 3:21:34.642858,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_54_seed_0_24141958
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9755804, 'precision': 0.97643083, 'recall': 0.97556794, 'specificity': 0.97556794, 'f1': 0.975569, 'auroc': 0.99934065, 'binary_precision': 0.9564493, 'binary_recall': 0.9965671, 'binary_specificity': 0.9545688, 'binary_f1_score': 0.97609615}
confusion matrix:
       0      1
0  24163   1150
1     87  25256
---- Validation: 
scalar performance:
{'acc': 0.9306544, 'precision': 0.6078579, 'recall': 0.841099, 'specificity': 0.841099, 'f1': 0.65306354, 'auroc': 0.912753, 'binary_precision': 0.22238164, 'binary_recall': 0.74698794, 'binary_specificity': 0.9352101, 'binary_f1_score': 0.3427308}
confusion matrix:
       0     1
0  15647  1084
1    105   310
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9238679, 'precision': 0.96192646, 'recall': 0.5012953, 'specificity': 0.5012953, 'f1': 0.4827937, 'auroc': 0.80998945, 'binary_precision': 1.0, 'binary_recall': 0.0025906735, 'binary_specificity': 1.0, 'binary_f1_score': 0.005167959}
confusion matrix:
      0  1
0  9342  0
1   770  2
early stop counter: 12
val acc:0.9306544065475464, best validation acc: 0.9738714694976807, corresponding to test acc:                         0.9183310270309448 / 0.9258453845977783
after epoch: 14,now: 2024-08-10 15:44:30.224806,epoch time: 0:15:00.676447,used: 3:36:35.319305,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_54_seed_0_24141958
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.97208625, 'precision': 0.9732857, 'recall': 0.9720714, 'specificity': 0.9720714, 'f1': 0.97206783, 'auroc': 0.9992093, 'binary_precision': 0.9496073, 'binary_recall': 0.99711955, 'binary_specificity': 0.9470233, 'binary_f1_score': 0.9727836}
confusion matrix:
       0      1
0  23972   1341
1     73  25270
---- Validation: 
scalar performance:
{'acc': 0.912866, 'precision': 0.5904267, 'recall': 0.8460834, 'specificity': 0.8460834, 'f1': 0.6273761, 'auroc': 0.9171397, 'binary_precision': 0.18688335, 'binary_recall': 0.77590364, 'binary_specificity': 0.9162632, 'binary_f1_score': 0.3012161}
confusion matrix:
       0     1
0  15330  1401
1     93   322
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92406565, 'precision': 0.8787264, 'recall': 0.5031848, 'specificity': 0.5031848, 'f1': 0.48668382, 'auroc': 0.8328982, 'binary_precision': 0.8333333, 'binary_recall': 0.006476684, 'binary_specificity': 0.99989295, 'binary_f1_score': 0.01285347}
confusion matrix:
      0  1
0  9341  1
1   767  5
early stop counter: 13
val acc:0.9128659963607788, best validation acc: 0.9738714694976807, corresponding to test acc:                         0.9183310270309448 / 0.9258453845977783
after epoch: 15,now: 2024-08-10 15:59:50.073205,epoch time: 0:15:19.848399,used: 3:51:55.167704,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_54_seed_0_24141958
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 3:51:55.167704 at 2024-08-10 15:59:50.073205
persisted model performance metric: 

scalar performance:
{'acc': 0.918331, 'precision': 0.6632323, 'recall': 0.55711865, 'specificity': 0.55711865, 'f1': 0.5767386, 'auroc': 0.8920459, 'binary_precision': 0.39453125, 'binary_recall': 0.13082902, 'binary_specificity': 0.9834083, 'binary_f1_score': 0.19649805}
confusion matrix:
      0    1
0  9187  155
1   671  101
oracle model performance metric: 

scalar performance:
{'acc': 0.9258454, 'precision': 0.8748599, 'recall': 0.5178136, 'specificity': 0.5178136, 'f1': 0.51543146, 'auroc': 0.85686505, 'binary_precision': 0.8235294, 'binary_recall': 0.03626943, 'binary_specificity': 0.99935776, 'binary_f1_score': 0.069478914}
confusion matrix:
      0   1
0  9336   6
1   744  28
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-10_11-59-12/rule_results/2.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-10_11-59-12/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-10_11-59-12/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 474110 KiB |   3238 MiB | 239815 GiB | 239815 GiB |
|       from large pool | 400512 KiB |   3177 MiB | 239141 GiB | 239140 GiB |
|       from small pool |  73598 KiB |    109 MiB |    674 GiB |    674 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 474110 KiB |   3238 MiB | 239815 GiB | 239815 GiB |
|       from large pool | 400512 KiB |   3177 MiB | 239141 GiB | 239140 GiB |
|       from small pool |  73598 KiB |    109 MiB |    674 GiB |    674 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 459821 KiB |   3197 MiB | 235997 GiB | 235997 GiB |
|       from large pool | 387840 KiB |   3137 MiB | 235333 GiB | 235332 GiB |
|       from small pool |  71981 KiB |    107 MiB |    664 GiB |    664 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3464 MiB |   3464 MiB |   3464 MiB |      0 B   |
|       from large pool |   3354 MiB |   3354 MiB |   3354 MiB |      0 B   |
|       from small pool |    110 MiB |    110 MiB |    110 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |    791 MiB |   1030 MiB | 173229 GiB | 173228 GiB |
|       from large pool |    782 MiB |   1027 MiB | 172554 GiB | 172553 GiB |
|       from small pool |      8 MiB |     11 MiB |    675 GiB |    675 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4959    |    7362    |   50037 K  |   50032 K  |
|       from large pool |      87    |     529    |   17451 K  |   17450 K  |
|       from small pool |    4872    |    7273    |   32585 K  |   32581 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4959    |    7362    |   50037 K  |   50032 K  |
|       from large pool |      87    |     529    |   17451 K  |   17450 K  |
|       from small pool |    4872    |    7273    |   32585 K  |   32581 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     115    |     115    |     115    |       0    |
|       from large pool |      60    |      60    |      60    |       0    |
|       from small pool |      55    |      55    |      55    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      70    |    3198    |   23916 K  |   23916 K  |
|       from large pool |      24    |      33    |    8227 K  |    8227 K  |
|       from small pool |      46    |    3175    |   15689 K  |   15689 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3238 MiB | 239815 GiB | 239815 GiB |
|       from large pool |  16640 KiB |   3177 MiB | 239141 GiB | 239141 GiB |
|       from small pool |      0 KiB |    109 MiB |    674 GiB |    674 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3238 MiB | 239815 GiB | 239815 GiB |
|       from large pool |  16640 KiB |   3177 MiB | 239141 GiB | 239141 GiB |
|       from small pool |      0 KiB |    109 MiB |    674 GiB |    674 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3197 MiB | 235997 GiB | 235997 GiB |
|       from large pool |  16640 KiB |   3137 MiB | 235333 GiB | 235333 GiB |
|       from small pool |      0 KiB |    107 MiB |    664 GiB |    664 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1254 MiB |   3464 MiB |   3464 MiB |   2210 MiB |
|       from large pool |   1174 MiB |   3354 MiB |   3354 MiB |   2180 MiB |
|       from small pool |     80 MiB |    110 MiB |    110 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1030 MiB | 173229 GiB | 173229 GiB |
|       from large pool |  50944 KiB |   1027 MiB | 172554 GiB | 172554 GiB |
|       from small pool |      0 KiB |     15 MiB |    675 GiB |    675 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7362    |   50037 K  |   50037 K  |
|       from large pool |       2    |     529    |   17451 K  |   17451 K  |
|       from small pool |       0    |    7273    |   32585 K  |   32585 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7362    |   50037 K  |   50037 K  |
|       from large pool |       2    |     529    |   17451 K  |   17451 K  |
|       from small pool |       0    |    7273    |   32585 K  |   32585 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     115    |     115    |      53    |
|       from large pool |      22    |      60    |      60    |      38    |
|       from small pool |      40    |      55    |      55    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3198    |   23918 K  |   23918 K  |
|       from large pool |       4    |      33    |    8227 K  |    8227 K  |
|       from small pool |       0    |    3175    |   15691 K  |   15691 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3238 MiB | 239815 GiB | 239815 GiB |
|       from large pool |  16640 KiB |   3177 MiB | 239141 GiB | 239141 GiB |
|       from small pool |      0 KiB |    109 MiB |    674 GiB |    674 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3238 MiB | 239815 GiB | 239815 GiB |
|       from large pool |  16640 KiB |   3177 MiB | 239141 GiB | 239141 GiB |
|       from small pool |      0 KiB |    109 MiB |    674 GiB |    674 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3197 MiB | 235997 GiB | 235997 GiB |
|       from large pool |  16640 KiB |   3137 MiB | 235333 GiB | 235333 GiB |
|       from small pool |      0 KiB |    107 MiB |    664 GiB |    664 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1254 MiB |   3464 MiB |   3464 MiB |   2210 MiB |
|       from large pool |   1174 MiB |   3354 MiB |   3354 MiB |   2180 MiB |
|       from small pool |     80 MiB |    110 MiB |    110 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1030 MiB | 173229 GiB | 173229 GiB |
|       from large pool |  50944 KiB |   1027 MiB | 172554 GiB | 172554 GiB |
|       from small pool |      0 KiB |     15 MiB |    675 GiB |    675 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7362    |   50037 K  |   50037 K  |
|       from large pool |       2    |     529    |   17451 K  |   17451 K  |
|       from small pool |       0    |    7273    |   32585 K  |   32585 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7362    |   50037 K  |   50037 K  |
|       from large pool |       2    |     529    |   17451 K  |   17451 K  |
|       from small pool |       0    |    7273    |   32585 K  |   32585 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     115    |     115    |      53    |
|       from large pool |      22    |      60    |      60    |      38    |
|       from small pool |      40    |      55    |      55    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3198    |   23918 K  |   23918 K  |
|       from large pool |       4    |      33    |    8227 K  |    8227 K  |
|       from small pool |       0    |    3175    |   15691 K  |   15691 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_09_09_seed_1_24141958

 Experiment start at: 2024-08-10 16:09:09.256497
before training, model accuracy: 0.20374591648578644
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96035963, 'precision': 0.961123, 'recall': 0.9603437, 'specificity': 0.9603437, 'f1': 0.96034217, 'auroc': 0.9945061, 'binary_precision': 0.942557, 'binary_recall': 0.9805394, 'binary_specificity': 0.94014806, 'binary_f1_score': 0.96117306}
confusion matrix:
       0      1
0  23876   1520
1    495  24941
---- Validation: 
scalar performance:
{'acc': 0.8930678, 'precision': 0.5739457, 'recall': 0.81518745, 'specificity': 0.81518745, 'f1': 0.5994941, 'auroc': 0.8707173, 'binary_precision': 0.15551181, 'binary_recall': 0.7331787, 'binary_specificity': 0.89719623, 'binary_f1_score': 0.25659764}
confusion matrix:
       0     1
0  14976  1716
1    115   316
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.917253, 'precision': 0.71191543, 'recall': 0.7604451, 'specificity': 0.7604451, 'f1': 0.73282075, 'auroc': 0.89028525, 'binary_precision': 0.45894736, 'binary_recall': 0.5759577, 'binary_specificity': 0.9449325, 'binary_f1_score': 0.5108377}
confusion matrix:
      0    1
0  8820  514
1   321  436
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-10 16:25:19.854881,epoch time: 0:16:10.598384,used: 0:16:10.598384,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_09_09_seed_1_24141958
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.95727104, 'precision': 0.95944035, 'recall': 0.9572401, 'specificity': 0.9572401, 'f1': 0.95721847, 'auroc': 0.9967418, 'binary_precision': 0.9280957, 'binary_recall': 0.99143046, 'binary_specificity': 0.9230497, 'binary_f1_score': 0.95871824}
confusion matrix:
       0      1
0  23439   1954
1    218  25221
---- Validation: 
scalar performance:
{'acc': 0.8618817, 'precision': 0.5648532, 'recall': 0.8455274, 'specificity': 0.8455274, 'f1': 0.57800597, 'auroc': 0.9014287, 'binary_precision': 0.13481873, 'binary_recall': 0.82830626, 'binary_specificity': 0.8627486, 'binary_f1_score': 0.23189348}
confusion matrix:
       0     1
0  14401  2291
1     74   357
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9194332, 'precision': 0.71655905, 'recall': 0.7555543, 'specificity': 0.7555543, 'f1': 0.73390305, 'auroc': 0.9088756, 'binary_precision': 0.469163, 'binary_recall': 0.5627477, 'binary_specificity': 0.94836086, 'binary_f1_score': 0.5117118}
confusion matrix:
      0    1
0  8852  482
1   331  426
new oracle model saved
early stop counter: 1
val acc:0.861881673336029, best validation acc: 0.8930677771568298, corresponding to test acc:                         0.9172530174255371 / 0.9194331765174866
after epoch: 2,now: 2024-08-10 16:40:38.933286,epoch time: 0:15:19.078405,used: 0:31:29.676789,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_09_09_seed_1_24141958
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.98148805, 'precision': 0.9814999, 'recall': 0.9814862, 'specificity': 0.9814862, 'f1': 0.98148793, 'auroc': 0.9979886, 'binary_precision': 0.97929794, 'binary_recall': 0.9838025, 'binary_specificity': 0.97916996, 'binary_f1_score': 0.9815451}
confusion matrix:
       0      1
0  24867    529
1    412  25024
---- Validation: 
scalar performance:
{'acc': 0.94884074, 'precision': 0.64552647, 'recall': 0.8562255, 'specificity': 0.8562255, 'f1': 0.7003375, 'auroc': 0.8982485, 'binary_precision': 0.29754323, 'binary_recall': 0.75870067, 'binary_specificity': 0.9537503, 'binary_f1_score': 0.42745098}
confusion matrix:
       0    1
0  15920  772
1    104  327
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9212169, 'precision': 0.56446266, 'recall': 0.5058546, 'specificity': 0.5058546, 'f1': 0.4953034, 'auroc': 0.880623, 'binary_precision': 0.203125, 'binary_recall': 0.017173052, 'binary_specificity': 0.9945361, 'binary_f1_score': 0.031668697}
confusion matrix:
      0   1
0  9283  51
1   744  13
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-10 16:56:06.498338,epoch time: 0:15:27.565052,used: 0:46:57.241841,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_09_09_seed_1_24141958
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9449953, 'precision': 0.94956243, 'recall': 0.9449518, 'specificity': 0.9449518, 'f1': 0.9448514, 'auroc': 0.9973946, 'binary_precision': 0.90446585, 'binary_recall': 0.99520403, 'binary_specificity': 0.8946995, 'binary_f1_score': 0.9476679}
confusion matrix:
       0      1
0  22720   2674
1    122  25316
---- Validation: 
scalar performance:
{'acc': 0.77217776, 'precision': 0.5413084, 'recall': 0.8119489, 'specificity': 0.8119489, 'f1': 0.51348644, 'auroc': 0.89701116, 'binary_precision': 0.08749405, 'binary_recall': 0.8538283, 'binary_specificity': 0.7700695, 'binary_f1_score': 0.15872331}
confusion matrix:
       0     1
0  12854  3838
1     63   368
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9225052, 'precision': 0.5524376, 'recall': 0.50290936, 'specificity': 0.50290936, 'f1': 0.48862478, 'auroc': 0.87749386, 'binary_precision': 0.17948718, 'binary_recall': 0.009247027, 'binary_specificity': 0.99657166, 'binary_f1_score': 0.01758794}
confusion matrix:
      0   1
0  9302  32
1   750   7
new oracle model saved
early stop counter: 1
val acc:0.7721777558326721, best validation acc: 0.9488407373428345, corresponding to test acc:                         0.9212169051170349 / 0.9225051999092102
after epoch: 4,now: 2024-08-10 17:11:20.464862,epoch time: 0:15:13.966524,used: 1:02:11.208365,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_09_09_seed_1_24141958
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9743272, 'precision': 0.9749692, 'recall': 0.9743129, 'specificity': 0.9743129, 'f1': 0.97431797, 'auroc': 0.99828243, 'binary_precision': 0.9577027, 'binary_recall': 0.9925303, 'binary_specificity': 0.95609546, 'binary_f1_score': 0.97480553}
confusion matrix:
       0      1
0  24281   1115
1    190  25246
---- Validation: 
scalar performance:
{'acc': 0.8610641, 'precision': 0.56569314, 'recall': 0.85301906, 'specificity': 0.85301906, 'f1': 0.5789551, 'auroc': 0.9063035, 'binary_precision': 0.13602391, 'binary_recall': 0.84454757, 'binary_specificity': 0.86149055, 'binary_f1_score': 0.2343096}
confusion matrix:
       0     1
0  14380  2312
1     67   364
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9236944, 'precision': 0.5578498, 'recall': 0.5017314, 'specificity': 0.5017314, 'f1': 0.48530012, 'auroc': 0.891529, 'binary_precision': 0.1904762, 'binary_recall': 0.005284016, 'binary_specificity': 0.9981787, 'binary_f1_score': 0.010282777}
confusion matrix:
      0   1
0  9317  17
1   753   4
new oracle model saved
early stop counter: 2
val acc:0.861064076423645, best validation acc: 0.9488407373428345, corresponding to test acc:                         0.9212169051170349 / 0.923694372177124
after epoch: 5,now: 2024-08-10 17:26:45.711531,epoch time: 0:15:25.246669,used: 1:17:36.455034,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_09_09_seed_1_24141958
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9834553, 'precision': 0.9834585, 'recall': 0.98345447, 'specificity': 0.98345447, 'f1': 0.98345524, 'auroc': 0.9983728, 'binary_precision': 0.98238665, 'binary_recall': 0.98458815, 'binary_specificity': 0.9823207, 'binary_f1_score': 0.9834862}
confusion matrix:
       0      1
0  24948    449
1    392  25043
---- Validation: 
scalar performance:
{'acc': 0.9595865, 'precision': 0.664533, 'recall': 0.8018398, 'specificity': 0.8018398, 'f1': 0.71048474, 'auroc': 0.89438164, 'binary_precision': 0.33868974, 'binary_recall': 0.63573086, 'binary_specificity': 0.96794873, 'binary_f1_score': 0.44193548}
confusion matrix:
       0    1
0  16157  535
1    157  274
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92498267, 'precision': 0.46249133, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4805148, 'auroc': 0.8412963, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  9334  0
1   757  0
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-08-10 17:42:07.368534,epoch time: 0:15:21.657003,used: 1:32:58.112037,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_09_09_seed_1_24141958
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9689959, 'precision': 0.9701073, 'recall': 0.96897596, 'specificity': 0.96897596, 'f1': 0.9689766, 'auroc': 0.9982991, 'binary_precision': 0.9474553, 'binary_recall': 0.99312025, 'binary_specificity': 0.94483167, 'binary_f1_score': 0.96975046}
confusion matrix:
       0      1
0  23994   1401
1    175  25262
---- Validation: 
scalar performance:
{'acc': 0.87835073, 'precision': 0.5731175, 'recall': 0.85510474, 'specificity': 0.85510474, 'f1': 0.5947836, 'auroc': 0.90636396, 'binary_precision': 0.15118243, 'binary_recall': 0.8306264, 'binary_specificity': 0.87958306, 'binary_f1_score': 0.25580564}
confusion matrix:
       0     1
0  14682  2010
1     73   358
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92468536, 'precision': 0.4624802, 'recall': 0.4998393, 'specificity': 0.4998393, 'f1': 0.4804346, 'auroc': 0.82577336, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9996786, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  9331  3
1   757  0
early stop counter: 1
val acc:0.8783507347106934, best validation acc: 0.959586501121521, corresponding to test acc:                         0.9249826669692993 / 0.9249826669692993
after epoch: 7,now: 2024-08-10 17:57:38.749549,epoch time: 0:15:31.381015,used: 1:48:29.493052,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_09_09_seed_1_24141958
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9458412, 'precision': 0.9503943, 'recall': 0.9458037, 'specificity': 0.9458037, 'f1': 0.94570076, 'auroc': 0.99779487, 'binary_precision': 0.90529627, 'binary_recall': 0.99595046, 'binary_specificity': 0.89565694, 'binary_f1_score': 0.94846207}
confusion matrix:
       0      1
0  22747   2650
1    103  25332
---- Validation: 
scalar performance:
{'acc': 0.7889389, 'precision': 0.5451289, 'recall': 0.8250664, 'specificity': 0.8250664, 'f1': 0.5249012, 'auroc': 0.89074934, 'binary_precision': 0.0947288, 'binary_recall': 0.86310905, 'binary_specificity': 0.7870237, 'binary_f1_score': 0.17072052}
confusion matrix:
       0     1
0  13137  3555
1     59   372
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92488354, 'precision': 0.4624876, 'recall': 0.49994645, 'specificity': 0.49994645, 'f1': 0.48048806, 'auroc': 0.8386699, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998929, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  9333  1
1   757  0
early stop counter: 2
val acc:0.7889388799667358, best validation acc: 0.959586501121521, corresponding to test acc:                         0.9249826669692993 / 0.9249826669692993
after epoch: 8,now: 2024-08-10 18:13:14.531852,epoch time: 0:15:35.782303,used: 2:04:05.275355,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_09_09_seed_1_24141958
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9640187, 'precision': 0.96586657, 'recall': 0.96399283, 'specificity': 0.96399283, 'f1': 0.96398157, 'auroc': 0.9983339, 'binary_precision': 0.9367323, 'binary_recall': 0.99532175, 'binary_specificity': 0.9326639, 'binary_f1_score': 0.9651387}
confusion matrix:
       0      1
0  23685   1710
1    119  25318
---- Validation: 
scalar performance:
{'acc': 0.88968056, 'precision': 0.57395065, 'recall': 0.8258816, 'specificity': 0.8258816, 'f1': 0.5987961, 'auroc': 0.88995683, 'binary_precision': 0.15482955, 'binary_recall': 0.75870067, 'binary_specificity': 0.89306253, 'binary_f1_score': 0.25717655}
confusion matrix:
       0     1
0  14907  1785
1    104   327
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92488354, 'precision': 0.4624876, 'recall': 0.49994645, 'specificity': 0.49994645, 'f1': 0.48048806, 'auroc': 0.8429073, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998929, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  9333  1
1   757  0
early stop counter: 3
val acc:0.8896805644035339, best validation acc: 0.959586501121521, corresponding to test acc:                         0.9249826669692993 / 0.9249826669692993
after epoch: 9,now: 2024-08-10 18:28:41.252272,epoch time: 0:15:26.720420,used: 2:19:31.995775,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_09_09_seed_1_24141958
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9487921, 'precision': 0.9527486, 'recall': 0.9487554, 'specificity': 0.9487554, 'f1': 0.948677, 'auroc': 0.9979814, 'binary_precision': 0.91062117, 'binary_recall': 0.9953609, 'binary_specificity': 0.9021499, 'binary_f1_score': 0.95110726}
confusion matrix:
       0      1
0  22911   2485
1    118  25318
---- Validation: 
scalar performance:
{'acc': 0.7861356, 'precision': 0.5442687, 'recall': 0.8213683, 'specificity': 0.8213683, 'f1': 0.5227003, 'auroc': 0.88810146, 'binary_precision': 0.09317552, 'binary_recall': 0.85846865, 'binary_specificity': 0.7842679, 'binary_f1_score': 0.16810541}
confusion matrix:
       0     1
0  13091  3601
1     61   370
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92537904, 'precision': 0.83775914, 'recall': 0.5038559, 'specificity': 0.5038559, 'f1': 0.4884529, 'auroc': 0.8315828, 'binary_precision': 0.75, 'binary_recall': 0.007926024, 'binary_specificity': 0.9997857, 'binary_f1_score': 0.015686274}
confusion matrix:
      0  1
0  9332  2
1   751  6
new oracle model saved
early stop counter: 4
val acc:0.7861356139183044, best validation acc: 0.959586501121521, corresponding to test acc:                         0.9249826669692993 / 0.9253790378570557
after epoch: 10,now: 2024-08-10 18:44:09.491762,epoch time: 0:15:28.239490,used: 2:35:00.235265,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_09_09_seed_1_24141958
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9448576, 'precision': 0.9494944, 'recall': 0.9448197, 'specificity': 0.9448197, 'f1': 0.9447117, 'auroc': 0.99826145, 'binary_precision': 0.9040274, 'binary_recall': 0.9954787, 'binary_specificity': 0.89416075, 'binary_f1_score': 0.9475516}
confusion matrix:
       0      1
0  22709   2688
1    115  25320
---- Validation: 
scalar performance:
{'acc': 0.83525085, 'precision': 0.55550325, 'recall': 0.83638877, 'specificity': 0.83638877, 'f1': 0.55595094, 'auroc': 0.8961964, 'binary_precision': 0.11600257, 'binary_recall': 0.837587, 'binary_specificity': 0.83519053, 'binary_f1_score': 0.2037821}
confusion matrix:
       0     1
0  13941  2751
1     70   361
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92498267, 'precision': 0.46249133, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4805148, 'auroc': 0.84073234, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  9334  0
1   757  0
early stop counter: 5
val acc:0.8352508544921875, best validation acc: 0.959586501121521, corresponding to test acc:                         0.9249826669692993 / 0.9253790378570557
after epoch: 11,now: 2024-08-10 18:59:25.156285,epoch time: 0:15:15.664523,used: 2:50:15.899788,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_09_09_seed_1_24141958
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9447002, 'precision': 0.94943434, 'recall': 0.9446659, 'specificity': 0.9446659, 'f1': 0.94455117, 'auroc': 0.99807394, 'binary_precision': 0.90347433, 'binary_recall': 0.9958715, 'binary_specificity': 0.8934604, 'binary_f1_score': 0.9474255}
confusion matrix:
       0      1
0  22693   2706
1    105  25328
---- Validation: 
scalar performance:
{'acc': 0.7734042, 'precision': 0.5411213, 'recall': 0.80918753, 'specificity': 0.80918753, 'f1': 0.5137148, 'auroc': 0.8825289, 'binary_precision': 0.08734147, 'binary_recall': 0.84686774, 'binary_specificity': 0.7715073, 'binary_f1_score': 0.1583514}
confusion matrix:
       0     1
0  12878  3814
1     66   365
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92518085, 'precision': 0.83762515, 'recall': 0.501928, 'specificity': 0.501928, 'f1': 0.48450446, 'auroc': 0.8652189, 'binary_precision': 0.75, 'binary_recall': 0.003963012, 'binary_specificity': 0.9998929, 'binary_f1_score': 0.007884363}
confusion matrix:
      0  1
0  9333  1
1   754  3
early stop counter: 6
val acc:0.7734041810035706, best validation acc: 0.959586501121521, corresponding to test acc:                         0.9249826669692993 / 0.9253790378570557
after epoch: 12,now: 2024-08-10 19:14:53.361580,epoch time: 0:15:28.205295,used: 3:05:44.105083,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_09_09_seed_1_24141958
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.937559, 'precision': 0.94395715, 'recall': 0.93750954, 'specificity': 0.93750954, 'f1': 0.93732834, 'auroc': 0.99837947, 'binary_precision': 0.89086694, 'binary_recall': 0.99740535, 'binary_specificity': 0.8776137, 'binary_f1_score': 0.94113064}
confusion matrix:
       0      1
0  22287   3108
1     66  25371
---- Validation: 
scalar performance:
{'acc': 0.72352976, 'precision': 0.53466153, 'recall': 0.79377764, 'specificity': 0.79377764, 'f1': 0.4859329, 'auroc': 0.87333494, 'binary_precision': 0.07404474, 'binary_recall': 0.8677494, 'binary_specificity': 0.7198059, 'binary_f1_score': 0.13644655}
confusion matrix:
       0     1
0  12015  4677
1     57   374
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92498267, 'precision': 0.7125335, 'recall': 0.50060695, 'specificity': 0.50060695, 'f1': 0.48183033, 'auroc': 0.8460605, 'binary_precision': 0.5, 'binary_recall': 0.001321004, 'binary_specificity': 0.9998929, 'binary_f1_score': 0.0026350461}
confusion matrix:
      0  1
0  9333  1
1   756  1
early stop counter: 7
val acc:0.7235297560691833, best validation acc: 0.959586501121521, corresponding to test acc:                         0.9249826669692993 / 0.9253790378570557
after epoch: 13,now: 2024-08-10 19:30:22.327127,epoch time: 0:15:28.965547,used: 3:21:13.070630,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_09_09_seed_1_24141958
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.93500155, 'precision': 0.94193834, 'recall': 0.9349548, 'specificity': 0.9349548, 'f1': 0.93474066, 'auroc': 0.99795103, 'binary_precision': 0.88675684, 'binary_recall': 0.9974838, 'binary_specificity': 0.87242585, 'binary_f1_score': 0.9388669}
confusion matrix:
       0      1
0  22157   3240
1     64  25371
---- Validation: 
scalar performance:
{'acc': 0.7268586, 'precision': 0.535347, 'recall': 0.79774535, 'specificity': 0.79774535, 'f1': 0.48810768, 'auroc': 0.8708877, 'binary_precision': 0.07523009, 'binary_recall': 0.8723898, 'binary_specificity': 0.7231009, 'binary_f1_score': 0.13851538}
confusion matrix:
       0     1
0  12070  4622
1     55   376
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92627096, 'precision': 0.8546039, 'recall': 0.5116212, 'specificity': 0.5116212, 'f1': 0.5039037, 'auroc': 0.839692, 'binary_precision': 0.7826087, 'binary_recall': 0.023778072, 'binary_specificity': 0.99946433, 'binary_f1_score': 0.046153847}
confusion matrix:
      0   1
0  9329   5
1   739  18
new oracle model saved
early stop counter: 8
val acc:0.7268586158752441, best validation acc: 0.959586501121521, corresponding to test acc:                         0.9249826669692993 / 0.9262709617614746
after epoch: 14,now: 2024-08-10 19:45:48.398922,epoch time: 0:15:26.071795,used: 3:36:39.142425,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_09_09_seed_1_24141958
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9280768, 'precision': 0.93655026, 'recall': 0.92801934, 'specificity': 0.92801934, 'f1': 0.9277195, 'auroc': 0.9984415, 'binary_precision': 0.8759363, 'binary_recall': 0.9975626, 'binary_specificity': 0.8584761, 'binary_f1_score': 0.9328015}
confusion matrix:
       0      1
0  21801   3594
1     62  25375
---- Validation: 
scalar performance:
{'acc': 0.6972493, 'precision': 0.53383553, 'recall': 0.8017708, 'specificity': 0.8017708, 'f1': 0.4741613, 'auroc': 0.89054596, 'binary_precision': 0.07095143, 'binary_recall': 0.9118329, 'binary_specificity': 0.6917086, 'binary_f1_score': 0.13165827}
confusion matrix:
       0     1
0  11546  5146
1     38   393
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92547816, 'precision': 0.85169387, 'recall': 0.50451636, 'specificity': 0.50451636, 'f1': 0.4897729, 'auroc': 0.8756001, 'binary_precision': 0.7777778, 'binary_recall': 0.009247027, 'binary_specificity': 0.9997857, 'binary_f1_score': 0.018276762}
confusion matrix:
      0  1
0  9332  2
1   750  7
early stop counter: 9
val acc:0.6972492933273315, best validation acc: 0.959586501121521, corresponding to test acc:                         0.9249826669692993 / 0.9262709617614746
after epoch: 15,now: 2024-08-10 20:01:17.398805,epoch time: 0:15:28.999883,used: 3:52:08.142308,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_09_09_seed_1_24141958
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 3:52:08.142308 at 2024-08-10 20:01:17.398805
persisted model performance metric: 

scalar performance:
{'acc': 0.92498267, 'precision': 0.46249133, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4805148, 'auroc': 0.8412963, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  9334  0
1   757  0
oracle model performance metric: 

scalar performance:
{'acc': 0.92627096, 'precision': 0.8546039, 'recall': 0.5116212, 'specificity': 0.5116212, 'f1': 0.5039037, 'auroc': 0.839692, 'binary_precision': 0.7826087, 'binary_recall': 0.023778072, 'binary_specificity': 0.99946433, 'binary_f1_score': 0.046153847}
confusion matrix:
      0   1
0  9329   5
1   739  18
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-10_11-59-12/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-10_11-59-12/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 472248 KiB |   3238 MiB | 482772 GiB | 482772 GiB |
|       from large pool | 398656 KiB |   3177 MiB | 481410 GiB | 481410 GiB |
|       from small pool |  73592 KiB |    109 MiB |   1362 GiB |   1362 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 472248 KiB |   3238 MiB | 482772 GiB | 482772 GiB |
|       from large pool | 398656 KiB |   3177 MiB | 481410 GiB | 481410 GiB |
|       from small pool |  73592 KiB |    109 MiB |   1362 GiB |   1362 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 459820 KiB |   3197 MiB | 474901 GiB | 474901 GiB |
|       from large pool | 387840 KiB |   3137 MiB | 473560 GiB | 473559 GiB |
|       from small pool |  71980 KiB |    107 MiB |   1341 GiB |   1341 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3462 MiB |   3464 MiB |   5672 MiB |   2210 MiB |
|       from large pool |   3354 MiB |   3354 MiB |   5534 MiB |   2180 MiB |
|       from small pool |    108 MiB |    110 MiB |    138 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    806 MiB |   1050 MiB | 354697 GiB | 354697 GiB |
|       from large pool |    796 MiB |   1046 MiB | 353334 GiB | 353333 GiB |
|       from small pool |     10 MiB |     15 MiB |   1363 GiB |   1363 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4947    |    7384    |  100578 K  |  100573 K  |
|       from large pool |      87    |     529    |   35137 K  |   35136 K  |
|       from small pool |    4860    |    7295    |   65441 K  |   65436 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4947    |    7384    |  100578 K  |  100573 K  |
|       from large pool |      87    |     529    |   35137 K  |   35136 K  |
|       from small pool |    4860    |    7295    |   65441 K  |   65436 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     111    |     115    |     164    |      53    |
|       from large pool |      57    |      60    |      95    |      38    |
|       from small pool |      54    |      55    |      69    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      72    |    3211    |   47848 K  |   47847 K  |
|       from large pool |      26    |      33    |   16342 K  |   16342 K  |
|       from small pool |      46    |    3186    |   31505 K  |   31505 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3238 MiB | 482772 GiB | 482772 GiB |
|       from large pool |  16640 KiB |   3177 MiB | 481410 GiB | 481410 GiB |
|       from small pool |      0 KiB |    109 MiB |   1362 GiB |   1362 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3238 MiB | 482772 GiB | 482772 GiB |
|       from large pool |  16640 KiB |   3177 MiB | 481410 GiB | 481410 GiB |
|       from small pool |      0 KiB |    109 MiB |   1362 GiB |   1362 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3197 MiB | 474901 GiB | 474901 GiB |
|       from large pool |  16640 KiB |   3137 MiB | 473560 GiB | 473560 GiB |
|       from small pool |      0 KiB |    107 MiB |   1341 GiB |   1341 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1268 MiB |   3464 MiB |   5672 MiB |   4404 MiB |
|       from large pool |   1186 MiB |   3354 MiB |   5534 MiB |   4348 MiB |
|       from small pool |     82 MiB |    110 MiB |    138 MiB |     56 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1050 MiB | 354698 GiB | 354698 GiB |
|       from large pool |  50944 KiB |   1046 MiB | 353335 GiB | 353335 GiB |
|       from small pool |      0 KiB |     18 MiB |   1363 GiB |   1363 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7384    |  100578 K  |  100578 K  |
|       from large pool |       2    |     529    |   35137 K  |   35137 K  |
|       from small pool |       0    |    7295    |   65441 K  |   65441 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7384    |  100578 K  |  100578 K  |
|       from large pool |       2    |     529    |   35137 K  |   35137 K  |
|       from small pool |       0    |    7295    |   65441 K  |   65441 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      65    |     115    |     164    |      99    |
|       from large pool |      24    |      60    |      95    |      71    |
|       from small pool |      41    |      55    |      69    |      28    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3211    |   47850 K  |   47850 K  |
|       from large pool |       4    |      33    |   16342 K  |   16342 K  |
|       from small pool |       0    |    3186    |   31507 K  |   31507 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3238 MiB | 482772 GiB | 482772 GiB |
|       from large pool |  16640 KiB |   3177 MiB | 481410 GiB | 481410 GiB |
|       from small pool |      0 KiB |    109 MiB |   1362 GiB |   1362 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3238 MiB | 482772 GiB | 482772 GiB |
|       from large pool |  16640 KiB |   3177 MiB | 481410 GiB | 481410 GiB |
|       from small pool |      0 KiB |    109 MiB |   1362 GiB |   1362 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3197 MiB | 474901 GiB | 474901 GiB |
|       from large pool |  16640 KiB |   3137 MiB | 473560 GiB | 473560 GiB |
|       from small pool |      0 KiB |    107 MiB |   1341 GiB |   1341 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1268 MiB |   3464 MiB |   5672 MiB |   4404 MiB |
|       from large pool |   1186 MiB |   3354 MiB |   5534 MiB |   4348 MiB |
|       from small pool |     82 MiB |    110 MiB |    138 MiB |     56 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1050 MiB | 354698 GiB | 354698 GiB |
|       from large pool |  50944 KiB |   1046 MiB | 353335 GiB | 353335 GiB |
|       from small pool |      0 KiB |     18 MiB |   1363 GiB |   1363 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7384    |  100578 K  |  100578 K  |
|       from large pool |       2    |     529    |   35137 K  |   35137 K  |
|       from small pool |       0    |    7295    |   65441 K  |   65441 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7384    |  100578 K  |  100578 K  |
|       from large pool |       2    |     529    |   35137 K  |   35137 K  |
|       from small pool |       0    |    7295    |   65441 K  |   65441 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      65    |     115    |     164    |      99    |
|       from large pool |      24    |      60    |      95    |      71    |
|       from small pool |      41    |      55    |      69    |      28    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3211    |   47850 K  |   47850 K  |
|       from large pool |       4    |      33    |   16342 K  |   16342 K  |
|       from small pool |       0    |    3186    |   31507 K  |   31507 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_10_33_seed_2_24141958

 Experiment start at: 2024-08-10 20:10:33.406629
before training, model accuracy: 0.10721363127231598
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9684889, 'precision': 0.96859217, 'recall': 0.96849084, 'specificity': 0.96849084, 'f1': 0.9684872, 'auroc': 0.9939541, 'binary_precision': 0.97561646, 'binary_recall': 0.9610133, 'binary_specificity': 0.9759684, 'binary_f1_score': 0.9682598}
confusion matrix:
       0      1
0  25220    621
1   1008  24847
---- Validation: 
scalar performance:
{'acc': 0.9467414, 'precision': 0.6156316, 'recall': 0.7569495, 'specificity': 0.7569495, 'f1': 0.6552128, 'auroc': 0.83713114, 'binary_precision': 0.24270834, 'binary_recall': 0.55741626, 'binary_specificity': 0.9564827, 'binary_f1_score': 0.33817127}
confusion matrix:
       0    1
0  15979  727
1    185  233
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9157749, 'precision': 0.71366405, 'recall': 0.7311616, 'specificity': 0.7311616, 'f1': 0.7219473, 'auroc': 0.86669606, 'binary_precision': 0.4695052, 'binary_recall': 0.5119197, 'binary_specificity': 0.95040345, 'binary_f1_score': 0.48979592}
confusion matrix:
      0    1
0  8834  461
1   389  408
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-10 20:27:10.900721,epoch time: 0:16:37.494092,used: 0:16:37.494092,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_10_33_seed_2_24141958
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9818748, 'precision': 0.98193264, 'recall': 0.98187566, 'specificity': 0.98187566, 'f1': 0.9818743, 'auroc': 0.9969106, 'binary_precision': 0.9872492, 'binary_recall': 0.97636545, 'binary_specificity': 0.98738587, 'binary_f1_score': 0.98177713}
confusion matrix:
       0      1
0  25518    326
1    611  25241
---- Validation: 
scalar performance:
{'acc': 0.970626, 'precision': 0.7098005, 'recall': 0.79834664, 'specificity': 0.79834664, 'f1': 0.7456207, 'auroc': 0.8873805, 'binary_precision': 0.4292845, 'binary_recall': 0.6172249, 'binary_specificity': 0.97946846, 'binary_f1_score': 0.5063788}
confusion matrix:
       0    1
0  16363  343
1    160  258
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91854936, 'precision': 0.6844284, 'recall': 0.5514227, 'specificity': 0.5514227, 'f1': 0.5700205, 'auroc': 0.8666645, 'binary_precision': 0.4401914, 'binary_recall': 0.11543287, 'binary_specificity': 0.9874126, 'binary_f1_score': 0.18290259}
confusion matrix:
      0    1
0  9178  117
1   705   92
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-10 20:43:00.867580,epoch time: 0:15:49.966859,used: 0:32:27.460951,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_10_33_seed_2_24141958
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9787798, 'precision': 0.97901636, 'recall': 0.9787785, 'specificity': 0.9787785, 'f1': 0.9787771, 'auroc': 0.99816775, 'binary_precision': 0.96839994, 'binary_recall': 0.989865, 'binary_specificity': 0.967692, 'binary_f1_score': 0.9790148}
confusion matrix:
       0      1
0  25010    835
1    262  25589
---- Validation: 
scalar performance:
{'acc': 0.93377715, 'precision': 0.6160096, 'recall': 0.8575995, 'specificity': 0.8575995, 'f1': 0.6647094, 'auroc': 0.9122703, 'binary_precision': 0.23792094, 'binary_recall': 0.77751195, 'binary_specificity': 0.93768704, 'binary_f1_score': 0.36434978}
confusion matrix:
       0     1
0  15665  1041
1     93   325
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9195402, 'precision': 0.70582503, 'recall': 0.5892421, 'specificity': 0.5892421, 'f1': 0.61812824, 'auroc': 0.8779621, 'binary_precision': 0.47720364, 'binary_recall': 0.1969887, 'binary_specificity': 0.98149544, 'binary_f1_score': 0.27886322}
confusion matrix:
      0    1
0  9123  172
1   640  157
new oracle model saved
early stop counter: 1
val acc:0.9337771534919739, best validation acc: 0.9706259965896606, corresponding to test acc:                         0.9185493588447571 / 0.9195402264595032
after epoch: 3,now: 2024-08-10 20:58:33.752915,epoch time: 0:15:32.885335,used: 0:48:00.346286,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_10_33_seed_2_24141958
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96874034, 'precision': 0.9700993, 'recall': 0.968732, 'specificity': 0.968732, 'f1': 0.96871734, 'auroc': 0.99865174, 'binary_precision': 0.9449012, 'binary_recall': 0.9955523, 'binary_specificity': 0.94191176, 'binary_f1_score': 0.9695657}
confusion matrix:
       0      1
0  24339   1501
1    115  25741
---- Validation: 
scalar performance:
{'acc': 0.8700654, 'precision': 0.56765604, 'recall': 0.8552689, 'specificity': 0.8552689, 'f1': 0.58439875, 'auroc': 0.92018974, 'binary_precision': 0.13989638, 'binary_recall': 0.8397129, 'binary_specificity': 0.8708249, 'binary_f1_score': 0.23983602}
confusion matrix:
       0     1
0  14548  2158
1     67   351
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9195402, 'precision': 0.70713526, 'recall': 0.59612477, 'specificity': 0.59612477, 'f1': 0.62562627, 'auroc': 0.8855194, 'binary_precision': 0.47875354, 'binary_recall': 0.21204516, 'binary_specificity': 0.9802044, 'binary_f1_score': 0.29391304}
confusion matrix:
      0    1
0  9111  184
1   628  169
early stop counter: 2
val acc:0.8700653910636902, best validation acc: 0.9706259965896606, corresponding to test acc:                         0.9185493588447571 / 0.9195402264595032
after epoch: 4,now: 2024-08-10 21:14:25.478915,epoch time: 0:15:51.726000,used: 1:03:52.072286,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_10_33_seed_2_24141958
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9593392, 'precision': 0.96165395, 'recall': 0.95933235, 'specificity': 0.95933235, 'f1': 0.95928776, 'auroc': 0.9983108, 'binary_precision': 0.92901266, 'binary_recall': 0.9947008, 'binary_specificity': 0.92396396, 'binary_f1_score': 0.9607352}
confusion matrix:
       0      1
0  23878   1965
1    137  25716
---- Validation: 
scalar performance:
{'acc': 0.87304366, 'precision': 0.56475, 'recall': 0.82880545, 'specificity': 0.82880545, 'f1': 0.5810336, 'auroc': 0.9044308, 'binary_precision': 0.13568465, 'binary_recall': 0.78229666, 'binary_specificity': 0.87531424, 'binary_f1_score': 0.23125884}
confusion matrix:
       0     1
0  14623  2083
1     91   327
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9183512, 'precision': 0.6663517, 'recall': 0.5323877, 'specificity': 0.5323877, 'f1': 0.5412212, 'auroc': 0.81293464, 'binary_precision': 0.40689656, 'binary_recall': 0.074027605, 'binary_specificity': 0.9907477, 'binary_f1_score': 0.1252654}
confusion matrix:
      0   1
0  9209  86
1   738  59
early stop counter: 3
val acc:0.8730436563491821, best validation acc: 0.9706259965896606, corresponding to test acc:                         0.9185493588447571 / 0.9195402264595032
after epoch: 5,now: 2024-08-10 21:31:49.002286,epoch time: 0:17:23.523371,used: 1:21:15.595657,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_10_33_seed_2_24141958
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.966245, 'precision': 0.9678892, 'recall': 0.96623695, 'specificity': 0.96623695, 'f1': 0.96621484, 'auroc': 0.9988562, 'binary_precision': 0.9402206, 'binary_recall': 0.99582285, 'binary_specificity': 0.93665105, 'binary_f1_score': 0.9672232}
confusion matrix:
       0      1
0  24204   1637
1    108  25747
---- Validation: 
scalar performance:
{'acc': 0.8312894, 'precision': 0.5544841, 'recall': 0.8470582, 'specificity': 0.8470582, 'f1': 0.5528234, 'auroc': 0.9119282, 'binary_precision': 0.11305982, 'binary_recall': 0.8636364, 'binary_specificity': 0.83048004, 'binary_f1_score': 0.19994462}
confusion matrix:
       0     1
0  13874  2832
1     57   361
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9210265, 'precision': 0.7130038, 'recall': 0.53384006, 'specificity': 0.53384006, 'f1': 0.54380006, 'auroc': 0.7822721, 'binary_precision': 0.5, 'binary_recall': 0.074027605, 'binary_specificity': 0.9936525, 'binary_f1_score': 0.12896176}
confusion matrix:
      0   1
0  9236  59
1   738  59
new oracle model saved
early stop counter: 4
val acc:0.8312894105911255, best validation acc: 0.9706259965896606, corresponding to test acc:                         0.9185493588447571 / 0.9210265278816223
after epoch: 6,now: 2024-08-10 21:51:41.399859,epoch time: 0:19:52.397573,used: 1:41:07.993230,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_10_33_seed_2_24141958
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.89310586, 'precision': 0.91107917, 'recall': 0.89309776, 'specificity': 0.89309776, 'f1': 0.8919231, 'auroc': 0.99786925, 'binary_precision': 0.8251424, 'binary_recall': 0.99764025, 'binary_specificity': 0.78855526, 'binary_f1_score': 0.90322924}
confusion matrix:
       0      1
0  20381   5465
1     61  25789
---- Validation: 
scalar performance:
{'acc': 0.552733, 'precision': 0.5227732, 'recall': 0.73811615, 'specificity': 0.73811615, 'f1': 0.39783555, 'auroc': 0.904901, 'binary_precision': 0.048622366, 'binary_recall': 0.93301433, 'binary_specificity': 0.543218, 'binary_f1_score': 0.092428006}
confusion matrix:
      0     1
0  9075  7631
1    28   390
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9221165, 'precision': 0.73919237, 'recall': 0.5338582, 'specificity': 0.5338582, 'f1': 0.5439198, 'auroc': 0.7859073, 'binary_precision': 0.552381, 'binary_recall': 0.0727729, 'binary_specificity': 0.9949435, 'binary_f1_score': 0.1286031}
confusion matrix:
      0   1
0  9248  47
1   739  58
new oracle model saved
early stop counter: 5
val acc:0.5527330040931702, best validation acc: 0.9706259965896606, corresponding to test acc:                         0.9185493588447571 / 0.9221165180206299
after epoch: 7,now: 2024-08-10 22:07:48.832557,epoch time: 0:16:07.432698,used: 1:57:15.425928,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_10_33_seed_2_24141958
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9693013, 'precision': 0.97051036, 'recall': 0.9692944, 'specificity': 0.9692944, 'f1': 0.96928126, 'auroc': 0.9986993, 'binary_precision': 0.94672704, 'binary_recall': 0.9945852, 'binary_specificity': 0.9440037, 'binary_f1_score': 0.9700662}
confusion matrix:
       0      1
0  24394   1447
1    140  25715
---- Validation: 
scalar performance:
{'acc': 0.90317684, 'precision': 0.577446, 'recall': 0.8115942, 'specificity': 0.8115942, 'f1': 0.60662276, 'auroc': 0.89718604, 'binary_precision': 0.16267683, 'binary_recall': 0.715311, 'binary_specificity': 0.9078774, 'binary_f1_score': 0.26507095}
confusion matrix:
       0     1
0  15167  1539
1    119   299
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9227111, 'precision': 0.8207271, 'recall': 0.51697415, 'specificity': 0.51697415, 'f1': 0.5133357, 'auroc': 0.8225175, 'binary_precision': 0.71794873, 'binary_recall': 0.035131745, 'binary_specificity': 0.99881655, 'binary_f1_score': 0.066985644}
confusion matrix:
      0   1
0  9284  11
1   769  28
new oracle model saved
early stop counter: 6
val acc:0.9031768441200256, best validation acc: 0.9706259965896606, corresponding to test acc:                         0.9185493588447571 / 0.9227110743522644
after epoch: 8,now: 2024-08-10 22:23:40.776352,epoch time: 0:15:51.943795,used: 2:13:07.369723,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_10_33_seed_2_24141958
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9470559, 'precision': 0.95163214, 'recall': 0.947052, 'specificity': 0.947052, 'f1': 0.9469211, 'auroc': 0.9988433, 'binary_precision': 0.90618956, 'binary_recall': 0.99736947, 'binary_specificity': 0.8967345, 'binary_f1_score': 0.9495958}
confusion matrix:
       0      1
0  23177   2669
1     68  25782
---- Validation: 
scalar performance:
{'acc': 0.7813011, 'precision': 0.5421202, 'recall': 0.8191062, 'specificity': 0.8191062, 'f1': 0.517572, 'auroc': 0.8920203, 'binary_precision': 0.08875155, 'binary_recall': 0.8588517, 'binary_specificity': 0.7793607, 'binary_f1_score': 0.16087835}
confusion matrix:
       0     1
0  13020  3686
1     59   359
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9239001, 'precision': 0.86647534, 'recall': 0.52335525, 'specificity': 0.52335525, 'f1': 0.5251685, 'auroc': 0.768461, 'binary_precision': 0.80851066, 'binary_recall': 0.047678795, 'binary_specificity': 0.9990317, 'binary_f1_score': 0.09004739}
confusion matrix:
      0   1
0  9286   9
1   759  38
new oracle model saved
early stop counter: 7
val acc:0.7813010811805725, best validation acc: 0.9706259965896606, corresponding to test acc:                         0.9185493588447571 / 0.9239001274108887
after epoch: 9,now: 2024-08-10 22:39:32.510455,epoch time: 0:15:51.734103,used: 2:28:59.103826,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_10_33_seed_2_24141958
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.95388424, 'precision': 0.95732236, 'recall': 0.95387256, 'specificity': 0.95387256, 'f1': 0.9537966, 'auroc': 0.9989011, 'binary_precision': 0.91773754, 'binary_recall': 0.9971766, 'binary_specificity': 0.9105685, 'binary_f1_score': 0.95580935}
confusion matrix:
       0      1
0  23530   2311
1     73  25782
---- Validation: 
scalar performance:
{'acc': 0.8279024, 'precision': 0.5537775, 'recall': 0.8476548, 'specificity': 0.8476548, 'f1': 0.5506363, 'auroc': 0.9150232, 'binary_precision': 0.11152074, 'binary_recall': 0.8684211, 'binary_specificity': 0.82688856, 'binary_f1_score': 0.19765858}
confusion matrix:
       0     1
0  13814  2892
1     55   363
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9212247, 'precision': 0.7290058, 'recall': 0.508711, 'specificity': 0.508711, 'f1': 0.49764875, 'auroc': 0.83428884, 'binary_precision': 0.53571427, 'binary_recall': 0.018820576, 'binary_specificity': 0.9986014, 'binary_f1_score': 0.036363635}
confusion matrix:
      0   1
0  9282  13
1   782  15
early stop counter: 8
val acc:0.8279023766517639, best validation acc: 0.9706259965896606, corresponding to test acc:                         0.9185493588447571 / 0.9239001274108887
after epoch: 10,now: 2024-08-10 22:55:22.293829,epoch time: 0:15:49.783374,used: 2:44:48.887200,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_10_33_seed_2_24141958
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.94487, 'precision': 0.9497621, 'recall': 0.94486195, 'specificity': 0.94486195, 'f1': 0.944719, 'auroc': 0.99864936, 'binary_precision': 0.9028936, 'binary_recall': 0.9969828, 'binary_specificity': 0.8927411, 'binary_f1_score': 0.9476084}
confusion matrix:
       0      1
0  23072   2772
1     78  25774
---- Validation: 
scalar performance:
{'acc': 0.77972436, 'precision': 0.5427929, 'recall': 0.8264618, 'specificity': 0.8264618, 'f1': 0.5178534, 'auroc': 0.89860106, 'binary_precision': 0.08957416, 'binary_recall': 0.8755981, 'binary_specificity': 0.7773255, 'binary_f1_score': 0.1625222}
confusion matrix:
       0     1
0  12986  3720
1     52   366
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9230083, 'precision': 0.8783045, 'recall': 0.51541483, 'specificity': 0.51541483, 'f1': 0.5101595, 'auroc': 0.8199868, 'binary_precision': 0.8333333, 'binary_recall': 0.03136763, 'binary_specificity': 0.99946207, 'binary_f1_score': 0.0604595}
confusion matrix:
      0   1
0  9290   5
1   772  25
early stop counter: 9
val acc:0.7797243595123291, best validation acc: 0.9706259965896606, corresponding to test acc:                         0.9185493588447571 / 0.9239001274108887
after epoch: 11,now: 2024-08-10 23:11:15.113801,epoch time: 0:15:52.819972,used: 3:00:41.707172,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_10_33_seed_2_24141958
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9518338, 'precision': 0.95537627, 'recall': 0.951827, 'specificity': 0.951827, 'f1': 0.95173943, 'auroc': 0.9986008, 'binary_precision': 0.9152506, 'binary_recall': 0.99589974, 'binary_specificity': 0.90775424, 'binary_f1_score': 0.9538735}
confusion matrix:
       0      1
0  23460   2384
1    106  25746
---- Validation: 
scalar performance:
{'acc': 0.79204625, 'precision': 0.54383755, 'recall': 0.8211144, 'specificity': 0.8211144, 'f1': 0.52391434, 'auroc': 0.8869661, 'binary_precision': 0.0923476, 'binary_recall': 0.8516746, 'binary_specificity': 0.7905543, 'binary_f1_score': 0.16662766}
confusion matrix:
       0     1
0  13207  3499
1     62   356
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9225129, 'precision': 0.931829, 'recall': 0.50998384, 'specificity': 0.50998384, 'f1': 0.4994702, 'auroc': 0.81622815, 'binary_precision': 0.9411765, 'binary_recall': 0.020075282, 'binary_specificity': 0.9998924, 'binary_f1_score': 0.039312042}
confusion matrix:
      0   1
0  9294   1
1   781  16
early stop counter: 10
val acc:0.7920462489128113, best validation acc: 0.9706259965896606, corresponding to test acc:                         0.9185493588447571 / 0.9239001274108887
after epoch: 12,now: 2024-08-10 23:26:49.681087,epoch time: 0:15:34.567286,used: 3:16:16.274458,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_10_33_seed_2_24141958
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.92349505, 'precision': 0.9332155, 'recall': 0.9234892, 'specificity': 0.9234892, 'f1': 0.9230628, 'auroc': 0.9985751, 'binary_precision': 0.8683422, 'binary_recall': 0.99837524, 'binary_specificity': 0.84860325, 'binary_f1_score': 0.9288298}
confusion matrix:
       0      1
0  21933   3913
1     42  25808
---- Validation: 
scalar performance:
{'acc': 0.64114696, 'precision': 0.5280764, 'recall': 0.777598, 'specificity': 0.777598, 'f1': 0.44326612, 'auroc': 0.8755477, 'binary_precision': 0.05925812, 'binary_recall': 0.92105263, 'binary_specificity': 0.6341434, 'binary_f1_score': 0.11135213}
confusion matrix:
       0     1
0  10594  6112
1     33   385
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92261195, 'precision': 0.77116394, 'recall': 0.5249502, 'specificity': 0.5249502, 'f1': 0.52834165, 'auroc': 0.77615243, 'binary_precision': 0.61764705, 'binary_recall': 0.052697618, 'binary_specificity': 0.9972028, 'binary_f1_score': 0.09710983}
confusion matrix:
      0   1
0  9269  26
1   755  42
early stop counter: 11
val acc:0.6411469578742981, best validation acc: 0.9706259965896606, corresponding to test acc:                         0.9185493588447571 / 0.9239001274108887
after epoch: 13,now: 2024-08-10 23:42:42.177373,epoch time: 0:15:52.496286,used: 3:32:08.770744,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_10_33_seed_2_24141958
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.93065226, 'precision': 0.9385427, 'recall': 0.93063927, 'specificity': 0.93063927, 'f1': 0.9303375, 'auroc': 0.9983125, 'binary_precision': 0.8797667, 'binary_recall': 0.9976792, 'binary_specificity': 0.8635994, 'binary_f1_score': 0.9350202}
confusion matrix:
       0      1
0  22318   3525
1     60  25793
---- Validation: 
scalar performance:
{'acc': 0.8005139, 'precision': 0.54464394, 'recall': 0.81729054, 'specificity': 0.81729054, 'f1': 0.5281521, 'auroc': 0.87061286, 'binary_precision': 0.09442641, 'binary_recall': 0.8349282, 'binary_specificity': 0.7996528, 'binary_f1_score': 0.16966456}
confusion matrix:
       0     1
0  13359  3347
1     69   349
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92191833, 'precision': 0.9155116, 'recall': 0.50621974, 'specificity': 0.50621974, 'f1': 0.49204183, 'auroc': 0.71423686, 'binary_precision': 0.90909094, 'binary_recall': 0.0125470515, 'binary_specificity': 0.9998924, 'binary_f1_score': 0.024752473}
confusion matrix:
      0   1
0  9294   1
1   787  10
early stop counter: 12
val acc:0.8005139231681824, best validation acc: 0.9706259965896606, corresponding to test acc:                         0.9185493588447571 / 0.9239001274108887
after epoch: 14,now: 2024-08-10 23:58:34.132840,epoch time: 0:15:51.955467,used: 3:48:00.726211,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_10_33_seed_2_24141958
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.96318865, 'precision': 0.9653581, 'recall': 0.9631834, 'specificity': 0.9631834, 'f1': 0.9631454, 'auroc': 0.99916005, 'binary_precision': 0.933623, 'binary_recall': 0.9972923, 'binary_specificity': 0.92907447, 'binary_f1_score': 0.9644079}
confusion matrix:
       0      1
0  24011   1833
1     70  25782
---- Validation: 
scalar performance:
{'acc': 0.9068559, 'precision': 0.5738225, 'recall': 0.77965873, 'specificity': 0.77965873, 'f1': 0.6016295, 'auroc': 0.87969685, 'binary_precision': 0.15725102, 'binary_recall': 0.64593303, 'binary_specificity': 0.91338444, 'binary_f1_score': 0.2529274}
confusion matrix:
       0     1
0  15259  1447
1    148   270
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92112565, 'precision': 0.7275181, 'recall': 0.50464225, 'specificity': 0.50464225, 'f1': 0.4893071, 'auroc': 0.732502, 'binary_precision': 0.53333336, 'binary_recall': 0.010037641, 'binary_specificity': 0.9992469, 'binary_f1_score': 0.019704433}
confusion matrix:
      0  1
0  9288  7
1   789  8
early stop counter: 13
val acc:0.9068558812141418, best validation acc: 0.9706259965896606, corresponding to test acc:                         0.9185493588447571 / 0.9239001274108887
after epoch: 15,now: 2024-08-11 00:14:22.548229,epoch time: 0:15:48.415389,used: 4:03:49.141600,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_10_33_seed_2_24141958
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 4:03:49.141600 at 2024-08-11 00:14:22.548229
persisted model performance metric: 

scalar performance:
{'acc': 0.91854936, 'precision': 0.6844284, 'recall': 0.5514227, 'specificity': 0.5514227, 'f1': 0.5700205, 'auroc': 0.8666645, 'binary_precision': 0.4401914, 'binary_recall': 0.11543287, 'binary_specificity': 0.9874126, 'binary_f1_score': 0.18290259}
confusion matrix:
      0    1
0  9178  117
1   705   92
oracle model performance metric: 

scalar performance:
{'acc': 0.9239001, 'precision': 0.86647534, 'recall': 0.52335525, 'specificity': 0.52335525, 'f1': 0.5251685, 'auroc': 0.768461, 'binary_precision': 0.80851066, 'binary_recall': 0.047678795, 'binary_specificity': 0.9990317, 'binary_f1_score': 0.09004739}
confusion matrix:
      0   1
0  9286   9
1   759  38
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-10_11-59-12/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-10_11-59-12/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 470488 KiB |   3238 MiB | 732912 GiB | 732911 GiB |
|       from large pool | 396896 KiB |   3177 MiB | 730824 GiB | 730824 GiB |
|       from small pool |  73592 KiB |    109 MiB |   2087 GiB |   2087 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 470488 KiB |   3238 MiB | 732912 GiB | 732911 GiB |
|       from large pool | 396896 KiB |   3177 MiB | 730824 GiB | 730824 GiB |
|       from small pool |  73592 KiB |    109 MiB |   2087 GiB |   2087 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 459820 KiB |   3197 MiB | 722604 GiB | 722603 GiB |
|       from large pool | 387840 KiB |   3137 MiB | 720547 GiB | 720547 GiB |
|       from small pool |  71980 KiB |    107 MiB |   2056 GiB |   2056 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3482 MiB |   3482 MiB |   7886 MiB |   4404 MiB |
|       from large pool |   3374 MiB |   3374 MiB |   7722 MiB |   4348 MiB |
|       from small pool |    108 MiB |    110 MiB |    164 MiB |     56 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 440871 KiB |   1050 MiB | 539869 GiB | 539869 GiB |
|       from large pool | 430496 KiB |   1046 MiB | 537780 GiB | 537780 GiB |
|       from small pool |  10375 KiB |     18 MiB |   2089 GiB |   2089 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4947    |    7492    |  152707 K  |  152702 K  |
|       from large pool |      87    |     529    |   53521 K  |   53521 K  |
|       from small pool |    4860    |    7403    |   99186 K  |   99181 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4947    |    7492    |  152707 K  |  152702 K  |
|       from large pool |      87    |     529    |   53521 K  |   53521 K  |
|       from small pool |    4860    |    7403    |   99186 K  |   99181 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     112    |     115    |     211    |      99    |
|       from large pool |      58    |      60    |     129    |      71    |
|       from small pool |      54    |      55    |      82    |      28    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      71    |    3258    |   72572 K  |   72572 K  |
|       from large pool |      19    |      33    |   24786 K  |   24786 K  |
|       from small pool |      52    |    3240    |   47786 K  |   47786 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3238 MiB | 732912 GiB | 732912 GiB |
|       from large pool |  16640 KiB |   3177 MiB | 730824 GiB | 730824 GiB |
|       from small pool |      0 KiB |    109 MiB |   2087 GiB |   2087 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3238 MiB | 732912 GiB | 732912 GiB |
|       from large pool |  16640 KiB |   3177 MiB | 730824 GiB | 730824 GiB |
|       from small pool |      0 KiB |    109 MiB |   2087 GiB |   2087 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3197 MiB | 722604 GiB | 722604 GiB |
|       from large pool |  16640 KiB |   3137 MiB | 720547 GiB | 720547 GiB |
|       from small pool |      0 KiB |    107 MiB |   2056 GiB |   2056 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    890 MiB |   3482 MiB |   7886 MiB |   6996 MiB |
|       from large pool |    808 MiB |   3374 MiB |   7722 MiB |   6914 MiB |
|       from small pool |     82 MiB |    110 MiB |    164 MiB |     82 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1050 MiB | 539869 GiB | 539869 GiB |
|       from large pool |  50944 KiB |   1046 MiB | 537780 GiB | 537780 GiB |
|       from small pool |      0 KiB |     18 MiB |   2089 GiB |   2089 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7492    |  152707 K  |  152707 K  |
|       from large pool |       2    |     529    |   53521 K  |   53521 K  |
|       from small pool |       0    |    7403    |   99186 K  |   99186 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7492    |  152707 K  |  152707 K  |
|       from large pool |       2    |     529    |   53521 K  |   53521 K  |
|       from small pool |       0    |    7403    |   99186 K  |   99186 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      61    |     115    |     211    |     150    |
|       from large pool |      20    |      60    |     129    |     109    |
|       from small pool |      41    |      55    |      82    |      41    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3258    |   72574 K  |   72574 K  |
|       from large pool |       4    |      33    |   24786 K  |   24786 K  |
|       from small pool |       0    |    3240    |   47788 K  |   47788 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sun Aug 11 00:16:15 2024]
Finished job 0.
1 of 1 steps (100%) done
