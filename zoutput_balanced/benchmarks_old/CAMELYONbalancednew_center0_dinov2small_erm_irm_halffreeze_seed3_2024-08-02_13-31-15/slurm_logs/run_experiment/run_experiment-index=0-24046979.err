Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Fri Aug  2 20:14:02 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_halffreeze_seed3_2024-08-02_13-31-15/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_halffreeze_seed3_2024-08-02_13-31-15/rule_results/0.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=0
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_20_24_21_seed_0_24046979

 Experiment start at: 2024-08-02 20:24:21.521754
before training, model accuracy: 0.7297859191894531
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9495467, 'precision': 0.9499199, 'recall': 0.9495559, 'specificity': 0.9495559, 'f1': 0.94953704, 'auroc': 0.98584497, 'binary_precision': 0.96303475, 'binary_recall': 0.93504775, 'binary_specificity': 0.96406394, 'binary_f1_score': 0.94883496}
confusion matrix:
       0      1
0  27632   1030
1   1864  26834
---- Validation: 
scalar performance:
{'acc': 0.88032144, 'precision': 0.58227086, 'recall': 0.7857795, 'specificity': 0.7857795, 'f1': 0.60798323, 'auroc': 0.8797674, 'binary_precision': 0.17699115, 'binary_recall': 0.6842924, 'binary_specificity': 0.8872665, 'binary_f1_score': 0.28124002}
confusion matrix:
       0     1
0  16103  2046
1    203   440
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86113775, 'precision': 0.6006554, 'recall': 0.8505891, 'specificity': 0.8505891, 'f1': 0.6287958, 'auroc': 0.91353464, 'binary_precision': 0.20936902, 'binary_recall': 0.83908045, 'binary_specificity': 0.86209774, 'binary_f1_score': 0.33511856}
confusion matrix:
      0    1
0  5170  827
1    42  219
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-02 20:52:20.072800,epoch time: 0:27:58.551046,used: 0:27:58.551046,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_20_24_21_seed_0_24046979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9607392, 'precision': 0.9614681, 'recall': 0.9607545, 'specificity': 0.9607545, 'f1': 0.9607246, 'auroc': 0.99122775, 'binary_precision': 0.98000145, 'binary_recall': 0.9407358, 'binary_specificity': 0.98077327, 'binary_f1_score': 0.95996726}
confusion matrix:
       0      1
0  28107    551
1   1701  27001
---- Validation: 
scalar performance:
{'acc': 0.8969774, 'precision': 0.5943006, 'recall': 0.7906523, 'specificity': 0.7906523, 'f1': 0.6271913, 'auroc': 0.8841853, 'binary_precision': 0.20110957, 'binary_recall': 0.67651635, 'binary_specificity': 0.90478814, 'binary_f1_score': 0.3100499}
confusion matrix:
       0     1
0  16421  1728
1    208   435
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8668904, 'precision': 0.6047879, 'recall': 0.855423, 'specificity': 0.855423, 'f1': 0.63577485, 'auroc': 0.92146134, 'binary_precision': 0.2173913, 'binary_recall': 0.8429119, 'binary_specificity': 0.867934, 'binary_f1_score': 0.3456402}
confusion matrix:
      0    1
0  5205  792
1    41  220
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-02 21:19:43.245049,epoch time: 0:27:23.172249,used: 0:55:21.723295,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_20_24_21_seed_0_24046979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9695781, 'precision': 0.9700639, 'recall': 0.9695888, 'specificity': 0.9695888, 'f1': 0.96957076, 'auroc': 0.99455285, 'binary_precision': 0.98534286, 'binary_recall': 0.95337814, 'binary_specificity': 0.9857995, 'binary_f1_score': 0.969097}
confusion matrix:
       0      1
0  28254    407
1   1338  27361
---- Validation: 
scalar performance:
{'acc': 0.8992124, 'precision': 0.5942696, 'recall': 0.78280866, 'specificity': 0.78280866, 'f1': 0.6272013, 'auroc': 0.8763221, 'binary_precision': 0.20171674, 'binary_recall': 0.6578538, 'binary_specificity': 0.90776354, 'binary_f1_score': 0.30875912}
confusion matrix:
       0     1
0  16475  1674
1    220   423
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8643336, 'precision': 0.6030842, 'recall': 0.8540889, 'specificity': 0.8540889, 'f1': 0.6328643, 'auroc': 0.9239551, 'binary_precision': 0.21400778, 'binary_recall': 0.8429119, 'binary_specificity': 0.86526597, 'binary_f1_score': 0.34134987}
confusion matrix:
      0    1
0  5189  808
1    41  220
better model found
persisted
after epoch: 3,now: 2024-08-02 21:47:06.521327,epoch time: 0:27:23.276278,used: 1:22:44.999573,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_20_24_21_seed_0_24046979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9730997, 'precision': 0.9733527, 'recall': 0.9731083, 'specificity': 0.9731083, 'f1': 0.97309643, 'auroc': 0.99557996, 'binary_precision': 0.9844798, 'binary_recall': 0.9613951, 'binary_specificity': 0.9848215, 'binary_f1_score': 0.97280043}
confusion matrix:
       0      1
0  28224    435
1   1108  27593
---- Validation: 
scalar performance:
{'acc': 0.9269902, 'precision': 0.62000257, 'recall': 0.7649372, 'specificity': 0.7649372, 'f1': 0.65888625, 'auroc': 0.8843703, 'binary_precision': 0.25520483, 'binary_recall': 0.59097975, 'binary_specificity': 0.9388947, 'binary_f1_score': 0.35647276}
confusion matrix:
       0     1
0  17040  1109
1    263   380
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9185043, 'precision': 0.6505378, 'recall': 0.85486805, 'specificity': 0.85486805, 'f1': 0.7008357, 'auroc': 0.924084, 'binary_precision': 0.3110774, 'binary_recall': 0.7854406, 'binary_specificity': 0.9242955, 'binary_f1_score': 0.44565216}
confusion matrix:
      0    1
0  5543  454
1    56  205
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-02 22:14:29.737443,epoch time: 0:27:23.216116,used: 1:50:08.215689,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_20_24_21_seed_0_24046979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97669107, 'precision': 0.9770825, 'recall': 0.9767032, 'specificity': 0.9767032, 'f1': 0.9766867, 'auroc': 0.9967895, 'binary_precision': 0.99095833, 'binary_recall': 0.9622004, 'binary_specificity': 0.99120605, 'binary_f1_score': 0.97636765}
confusion matrix:
       0      1
0  28404    252
1   1085  27619
---- Validation: 
scalar performance:
{'acc': 0.9313006, 'precision': 0.6182734, 'recall': 0.7334163, 'specificity': 0.7334163, 'f1': 0.6527109, 'auroc': 0.86709917, 'binary_precision': 0.25417298, 'binary_recall': 0.5209953, 'binary_specificity': 0.94583726, 'binary_f1_score': 0.3416624}
confusion matrix:
       0    1
0  17166  983
1    308  335
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92729306, 'precision': 0.660016, 'recall': 0.83563334, 'specificity': 0.83563334, 'f1': 0.7093611, 'auroc': 0.91631687, 'binary_precision': 0.33217993, 'binary_recall': 0.7356322, 'binary_specificity': 0.9356345, 'binary_f1_score': 0.45768774}
confusion matrix:
      0    1
0  5611  386
1    69  192
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-02 22:42:01.346962,epoch time: 0:27:31.609519,used: 2:17:39.825208,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_20_24_21_seed_0_24046979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97993374, 'precision': 0.98004687, 'recall': 0.9799386, 'specificity': 0.9799386, 'f1': 0.9799327, 'auroc': 0.9974351, 'binary_precision': 0.98757476, 'binary_recall': 0.9721235, 'binary_specificity': 0.9877538, 'binary_f1_score': 0.97978824}
confusion matrix:
       0      1
0  28311    351
1    800  27898
---- Validation: 
scalar performance:
{'acc': 0.8999574, 'precision': 0.59287333, 'recall': 0.77419364, 'specificity': 0.77419364, 'f1': 0.6251615, 'auroc': 0.8816384, 'binary_precision': 0.19961146, 'binary_recall': 0.63919127, 'binary_specificity': 0.9091961, 'binary_f1_score': 0.3042191}
confusion matrix:
       0     1
0  16501  1648
1    232   411
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90667945, 'precision': 0.6324041, 'recall': 0.8377043, 'specificity': 0.8377043, 'f1': 0.6773312, 'auroc': 0.91619116, 'binary_precision': 0.27600554, 'binary_recall': 0.7624521, 'binary_specificity': 0.9129565, 'binary_f1_score': 0.4052953}
confusion matrix:
      0    1
0  5475  522
1    62  199
early stop counter: 1
val acc:0.8999574184417725, best validation acc: 0.9313005805015564, corresponding to test acc:                         0.927293062210083 / 0.927293062210083
after epoch: 6,now: 2024-08-02 23:09:31.009773,epoch time: 0:27:29.662811,used: 2:45:09.488019,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_20_24_21_seed_0_24046979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98014295, 'precision': 0.9802927, 'recall': 0.98014987, 'specificity': 0.98014987, 'f1': 0.9801415, 'auroc': 0.9971715, 'binary_precision': 0.98896575, 'binary_recall': 0.9711518, 'binary_specificity': 0.9891479, 'binary_f1_score': 0.9799778}
confusion matrix:
       0      1
0  28347    311
1    828  27874
---- Validation: 
scalar performance:
{'acc': 0.9287995, 'precision': 0.6194674, 'recall': 0.752373, 'specificity': 0.752373, 'f1': 0.65672433, 'auroc': 0.8834669, 'binary_precision': 0.25510922, 'binary_recall': 0.562986, 'binary_specificity': 0.9417599, 'binary_f1_score': 0.3511154}
confusion matrix:
       0     1
0  17092  1057
1    281   362
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9346437, 'precision': 0.67302376, 'recall': 0.83213925, 'specificity': 0.83213925, 'f1': 0.722058, 'auroc': 0.92226386, 'binary_precision': 0.35877863, 'binary_recall': 0.7203065, 'binary_specificity': 0.943972, 'binary_f1_score': 0.4789809}
confusion matrix:
      0    1
0  5661  336
1    73  188
new oracle model saved
early stop counter: 2
val acc:0.9287995100021362, best validation acc: 0.9313005805015564, corresponding to test acc:                         0.927293062210083 / 0.9346436858177185
after epoch: 7,now: 2024-08-02 23:36:52.317203,epoch time: 0:27:21.307430,used: 3:12:30.795449,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_20_24_21_seed_0_24046979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9812238, 'precision': 0.9814244, 'recall': 0.9812325, 'specificity': 0.9812325, 'f1': 0.9812221, 'auroc': 0.9975792, 'binary_precision': 0.9914612, 'binary_recall': 0.9708403, 'binary_specificity': 0.9916248, 'binary_f1_score': 0.9810424}
confusion matrix:
       0      1
0  28416    240
1    837  27867
---- Validation: 
scalar performance:
{'acc': 0.9322052, 'precision': 0.62036943, 'recall': 0.7353847, 'specificity': 0.7353847, 'f1': 0.65512276, 'auroc': 0.87716603, 'binary_precision': 0.25823754, 'binary_recall': 0.5241057, 'binary_specificity': 0.94666374, 'binary_f1_score': 0.34599587}
confusion matrix:
       0    1
0  17181  968
1    306  337
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94103545, 'precision': 0.68694025, 'recall': 0.8299773, 'specificity': 0.8299773, 'f1': 0.7346722, 'auroc': 0.9196335, 'binary_precision': 0.3870293, 'binary_recall': 0.70881224, 'binary_specificity': 0.95114225, 'binary_f1_score': 0.5006766}
confusion matrix:
      0    1
0  5704  293
1    76  185
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-08-03 00:04:06.538470,epoch time: 0:27:14.221267,used: 3:39:45.016716,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_20_24_21_seed_0_24046979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9833682, 'precision': 0.98345095, 'recall': 0.9833724, 'specificity': 0.9833724, 'f1': 0.98336756, 'auroc': 0.997908, 'binary_precision': 0.9899343, 'binary_recall': 0.97668827, 'binary_specificity': 0.9900565, 'binary_f1_score': 0.9832667}
confusion matrix:
       0      1
0  28377    285
1    669  28029
---- Validation: 
scalar performance:
{'acc': 0.93694127, 'precision': 0.63455886, 'recall': 0.755088, 'specificity': 0.755088, 'f1': 0.67236996, 'auroc': 0.88940215, 'binary_precision': 0.28526148, 'binary_recall': 0.5598756, 'binary_specificity': 0.9503003, 'binary_f1_score': 0.37795272}
confusion matrix:
       0    1
0  17247  902
1    283  360
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9501438, 'precision': 0.71228486, 'recall': 0.82740027, 'specificity': 0.82740027, 'f1': 0.7553725, 'auroc': 0.92051387, 'binary_precision': 0.43825665, 'binary_recall': 0.6934866, 'binary_specificity': 0.96131396, 'binary_f1_score': 0.537092}
confusion matrix:
      0    1
0  5765  232
1    80  181
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-08-03 00:31:26.247585,epoch time: 0:27:19.709115,used: 4:07:04.725831,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_20_24_21_seed_0_24046979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9843271, 'precision': 0.98441446, 'recall': 0.98433185, 'specificity': 0.98433185, 'f1': 0.9843265, 'auroc': 0.99811506, 'binary_precision': 0.991097, 'binary_recall': 0.97745645, 'binary_specificity': 0.99120724, 'binary_f1_score': 0.98422945}
confusion matrix:
       0      1
0  28408    252
1    647  28053
---- Validation: 
scalar performance:
{'acc': 0.9386441, 'precision': 0.632358, 'recall': 0.73421794, 'specificity': 0.73421794, 'f1': 0.66625184, 'auroc': 0.8886386, 'binary_precision': 0.2824232, 'binary_recall': 0.5147745, 'binary_specificity': 0.9536614, 'binary_f1_score': 0.3647383}
confusion matrix:
       0    1
0  17308  841
1    312  331
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95206136, 'precision': 0.71782005, 'recall': 0.81923914, 'specificity': 0.81923914, 'f1': 0.75729537, 'auroc': 0.91698384, 'binary_precision': 0.45012787, 'binary_recall': 0.6743295, 'binary_specificity': 0.96414876, 'binary_f1_score': 0.5398773}
confusion matrix:
      0    1
0  5782  215
1    85  176
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-08-03 00:58:47.410330,epoch time: 0:27:21.162745,used: 4:34:25.888576,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_20_24_21_seed_0_24046979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98448396, 'precision': 0.984486, 'recall': 0.98448503, 'specificity': 0.98448503, 'f1': 0.98448396, 'auroc': 0.9981674, 'binary_precision': 0.98571527, 'binary_recall': 0.98324275, 'binary_specificity': 0.98572725, 'binary_f1_score': 0.98447746}
confusion matrix:
       0      1
0  28247    409
1    481  28223
---- Validation: 
scalar performance:
{'acc': 0.9170924, 'precision': 0.60913455, 'recall': 0.773314, 'specificity': 0.773314, 'f1': 0.6469621, 'auroc': 0.8920809, 'binary_precision': 0.2326125, 'binary_recall': 0.61897355, 'binary_specificity': 0.92765445, 'binary_f1_score': 0.33814785}
confusion matrix:
       0     1
0  16836  1313
1    245   398
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9300096, 'precision': 0.66320825, 'recall': 0.827889, 'specificity': 0.827889, 'f1': 0.711584, 'auroc': 0.9167745, 'binary_precision': 0.33938295, 'binary_recall': 0.71647507, 'binary_specificity': 0.939303, 'binary_f1_score': 0.4605911}
confusion matrix:
      0    1
0  5633  364
1    74  187
early stop counter: 1
val acc:0.9170923829078674, best validation acc: 0.9386441111564636, corresponding to test acc:                         0.9520613551139832 / 0.9520613551139832
after epoch: 11,now: 2024-08-03 01:25:58.251760,epoch time: 0:27:10.841430,used: 5:01:36.730006,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_20_24_21_seed_0_24046979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9847106, 'precision': 0.98471516, 'recall': 0.9847119, 'specificity': 0.9847119, 'f1': 0.9847106, 'auroc': 0.99815416, 'binary_precision': 0.98639953, 'binary_recall': 0.9829971, 'binary_specificity': 0.9864266, 'binary_f1_score': 0.98469543}
confusion matrix:
       0      1
0  28270    389
1    488  28213
---- Validation: 
scalar performance:
{'acc': 0.91613454, 'precision': 0.6097438, 'recall': 0.7803186, 'specificity': 0.7803186, 'f1': 0.64817715, 'auroc': 0.8889635, 'binary_precision': 0.23327616, 'binary_recall': 0.63452566, 'binary_specificity': 0.92611164, 'binary_f1_score': 0.3411371}
confusion matrix:
       0     1
0  16808  1341
1    235   408
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91802496, 'precision': 0.64559954, 'recall': 0.8344623, 'specificity': 0.8344623, 'f1': 0.6932328, 'auroc': 0.9227468, 'binary_precision': 0.303125, 'binary_recall': 0.743295, 'binary_specificity': 0.9256295, 'binary_f1_score': 0.43063262}
confusion matrix:
      0    1
0  5551  446
1    67  194
early stop counter: 2
val acc:0.9161345362663269, best validation acc: 0.9386441111564636, corresponding to test acc:                         0.9520613551139832 / 0.9520613551139832
after epoch: 12,now: 2024-08-03 01:53:11.198405,epoch time: 0:27:12.946645,used: 5:28:49.676651,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_20_24_21_seed_0_24046979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98561716, 'precision': 0.98564994, 'recall': 0.9856212, 'specificity': 0.9856212, 'f1': 0.985617, 'auroc': 0.99831116, 'binary_precision': 0.98987985, 'binary_recall': 0.98129374, 'binary_specificity': 0.9899487, 'binary_f1_score': 0.9855681}
confusion matrix:
       0      1
0  28365    288
1    537  28170
---- Validation: 
scalar performance:
{'acc': 0.91363347, 'precision': 0.611429, 'recall': 0.7992753, 'specificity': 0.7992753, 'f1': 0.65136296, 'auroc': 0.89988, 'binary_precision': 0.23513514, 'binary_recall': 0.67651635, 'binary_specificity': 0.92203426, 'binary_f1_score': 0.34897715}
confusion matrix:
       0     1
0  16734  1415
1    208   435
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92681366, 'precision': 0.6587765, 'recall': 0.83355093, 'specificity': 0.83355093, 'f1': 0.7077681, 'auroc': 0.9230632, 'binary_precision': 0.3298791, 'binary_recall': 0.7318008, 'binary_specificity': 0.935301, 'binary_f1_score': 0.45476192}
confusion matrix:
      0    1
0  5609  388
1    70  191
early stop counter: 3
val acc:0.9136334657669067, best validation acc: 0.9386441111564636, corresponding to test acc:                         0.9520613551139832 / 0.9520613551139832
after epoch: 13,now: 2024-08-03 02:20:21.191206,epoch time: 0:27:09.992801,used: 5:55:59.669452,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_20_24_21_seed_0_24046979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9857043, 'precision': 0.98572063, 'recall': 0.9857068, 'specificity': 0.9857068, 'f1': 0.9857042, 'auroc': 0.99836326, 'binary_precision': 0.9887467, 'binary_recall': 0.98261505, 'binary_specificity': 0.98879856, 'binary_f1_score': 0.98567134}
confusion matrix:
       0      1
0  28336    321
1    499  28204
---- Validation: 
scalar performance:
{'acc': 0.92491484, 'precision': 0.61497825, 'recall': 0.7571123, 'specificity': 0.7571123, 'f1': 0.6524058, 'auroc': 0.89058715, 'binary_precision': 0.24569537, 'binary_recall': 0.5769829, 'binary_specificity': 0.93724173, 'binary_f1_score': 0.34463543}
confusion matrix:
       0     1
0  17010  1139
1    272   371
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9301694, 'precision': 0.66199625, 'recall': 0.82064307, 'specificity': 0.82064307, 'f1': 0.7092409, 'auroc': 0.9164089, 'binary_precision': 0.33763838, 'binary_recall': 0.7011494, 'binary_specificity': 0.94013673, 'binary_f1_score': 0.45579076}
confusion matrix:
      0    1
0  5638  359
1    78  183
early stop counter: 4
val acc:0.9249148368835449, best validation acc: 0.9386441111564636, corresponding to test acc:                         0.9520613551139832 / 0.9520613551139832
after epoch: 14,now: 2024-08-03 02:47:26.560925,epoch time: 0:27:05.369719,used: 6:23:05.039171,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_20_24_21_seed_0_24046979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9855474, 'precision': 0.9855606, 'recall': 0.9855497, 'specificity': 0.9855497, 'f1': 0.98554736, 'auroc': 0.99843955, 'binary_precision': 0.98829794, 'binary_recall': 0.9827544, 'binary_specificity': 0.9883449, 'binary_f1_score': 0.98551834}
confusion matrix:
       0      1
0  28323    334
1    495  28208
---- Validation: 
scalar performance:
{'acc': 0.93582374, 'precision': 0.6364616, 'recall': 0.77101064, 'specificity': 0.77101064, 'f1': 0.6769771, 'auroc': 0.89987344, 'binary_precision': 0.28786737, 'binary_recall': 0.5940902, 'binary_specificity': 0.947931, 'binary_f1_score': 0.38781723}
confusion matrix:
       0    1
0  17204  945
1    261  382
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.944551, 'precision': 0.6910843, 'recall': 0.8006618, 'specificity': 0.8006618, 'f1': 0.73131126, 'auroc': 0.9155203, 'binary_precision': 0.39810428, 'binary_recall': 0.6436782, 'binary_specificity': 0.9576455, 'binary_f1_score': 0.4919473}
confusion matrix:
      0    1
0  5743  254
1    93  168
early stop counter: 5
val acc:0.9358237385749817, best validation acc: 0.9386441111564636, corresponding to test acc:                         0.9520613551139832 / 0.9520613551139832
after epoch: 15,now: 2024-08-03 03:14:56.362651,epoch time: 0:27:29.801726,used: 6:50:34.840897,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_20_24_21_seed_0_24046979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 15 with time: 6:50:34.840897 at 2024-08-03 03:14:56.362651
persisted model performance metric: 

scalar performance:
{'acc': 0.95206136, 'precision': 0.71782005, 'recall': 0.81923914, 'specificity': 0.81923914, 'f1': 0.75729537, 'auroc': 0.91698384, 'binary_precision': 0.45012787, 'binary_recall': 0.6743295, 'binary_specificity': 0.96414876, 'binary_f1_score': 0.5398773}
confusion matrix:
      0    1
0  5782  215
1    85  176
oracle model performance metric: 

scalar performance:
{'acc': 0.95206136, 'precision': 0.71782005, 'recall': 0.81923914, 'specificity': 0.81923914, 'f1': 0.75729537, 'auroc': 0.91698384, 'binary_precision': 0.45012787, 'binary_recall': 0.6743295, 'binary_specificity': 0.96414876, 'binary_f1_score': 0.5398773}
confusion matrix:
      0    1
0  5782  215
1    85  176
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_halffreeze_seed3_2024-08-02_13-31-15/rule_results/0.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_halffreeze_seed3_2024-08-02_13-31-15/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_halffreeze_seed3_2024-08-02_13-31-15/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 197611 KiB |   1195 MiB | 488868 GiB | 488868 GiB |
|       from large pool | 180120 KiB |   1178 MiB | 482272 GiB | 482272 GiB |
|       from small pool |  17491 KiB |     37 MiB |   6595 GiB |   6595 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 197611 KiB |   1195 MiB | 488868 GiB | 488868 GiB |
|       from large pool | 180120 KiB |   1178 MiB | 482272 GiB | 482272 GiB |
|       from small pool |  17491 KiB |     37 MiB |   6595 GiB |   6595 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195461 KiB |   1193 MiB | 488853 GiB | 488853 GiB |
|       from large pool | 178979 KiB |   1176 MiB | 482270 GiB | 482270 GiB |
|       from small pool |  16482 KiB |     36 MiB |   6582 GiB |   6582 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1346 MiB |   1346 MiB |   1346 MiB |      0 B   |
|       from large pool |   1304 MiB |   1304 MiB |   1304 MiB |      0 B   |
|       from small pool |     42 MiB |     42 MiB |     42 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  58389 KiB | 161596 KiB | 245498 GiB | 245498 GiB |
|       from large pool |  51304 KiB | 160090 KiB | 238886 GiB | 238886 GiB |
|       from small pool |   7085 KiB |   9888 KiB |   6612 GiB |   6611 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2978    |    7645    |   83681 K  |   83678 K  |
|       from large pool |      79    |     167    |   45004 K  |   45004 K  |
|       from small pool |    2899    |    7565    |   38676 K  |   38673 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2978    |    7645    |   83681 K  |   83678 K  |
|       from large pool |      79    |     167    |   45004 K  |   45004 K  |
|       from small pool |    2899    |    7565    |   38676 K  |   38673 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      76    |      76    |      76    |       0    |
|       from large pool |      55    |      55    |      55    |       0    |
|       from small pool |      21    |      21    |      21    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      30    |    3605    |   49760 K  |   49760 K  |
|       from large pool |       9    |      57    |   31939 K  |   31939 K  |
|       from small pool |      21    |    3596    |   17821 K  |   17821 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1195 MiB | 488868 GiB | 488868 GiB |
|       from large pool |  16640 KiB |   1178 MiB | 482272 GiB | 482272 GiB |
|       from small pool |      0 KiB |     37 MiB |   6595 GiB |   6595 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1195 MiB | 488868 GiB | 488868 GiB |
|       from large pool |  16640 KiB |   1178 MiB | 482272 GiB | 482272 GiB |
|       from small pool |      0 KiB |     37 MiB |   6595 GiB |   6595 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1193 MiB | 488853 GiB | 488853 GiB |
|       from large pool |  16640 KiB |   1176 MiB | 482270 GiB | 482270 GiB |
|       from small pool |      0 KiB |     36 MiB |   6582 GiB |   6582 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 256000 KiB |   1346 MiB |   1346 MiB |   1096 MiB |
|       from large pool | 231424 KiB |   1304 MiB |   1304 MiB |   1078 MiB |
|       from small pool |  24576 KiB |     42 MiB |     42 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 161596 KiB | 245498 GiB | 245498 GiB |
|       from large pool |  30464 KiB | 160090 KiB | 238886 GiB | 238886 GiB |
|       from small pool |      0 KiB |  16243 KiB |   6612 GiB |   6612 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7645    |   83681 K  |   83681 K  |
|       from large pool |       2    |     167    |   45004 K  |   45004 K  |
|       from small pool |       0    |    7565    |   38676 K  |   38676 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7645    |   83681 K  |   83681 K  |
|       from large pool |       2    |     167    |   45004 K  |   45004 K  |
|       from small pool |       0    |    7565    |   38676 K  |   38676 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |      76    |      76    |      53    |
|       from large pool |      11    |      55    |      55    |      44    |
|       from small pool |      12    |      21    |      21    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3605    |   49761 K  |   49761 K  |
|       from large pool |       3    |      57    |   31939 K  |   31939 K  |
|       from small pool |       0    |    3596    |   17822 K  |   17822 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1195 MiB | 488868 GiB | 488868 GiB |
|       from large pool |  16640 KiB |   1178 MiB | 482272 GiB | 482272 GiB |
|       from small pool |      0 KiB |     37 MiB |   6595 GiB |   6595 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1195 MiB | 488868 GiB | 488868 GiB |
|       from large pool |  16640 KiB |   1178 MiB | 482272 GiB | 482272 GiB |
|       from small pool |      0 KiB |     37 MiB |   6595 GiB |   6595 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1193 MiB | 488853 GiB | 488853 GiB |
|       from large pool |  16640 KiB |   1176 MiB | 482270 GiB | 482270 GiB |
|       from small pool |      0 KiB |     36 MiB |   6582 GiB |   6582 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 256000 KiB |   1346 MiB |   1346 MiB |   1096 MiB |
|       from large pool | 231424 KiB |   1304 MiB |   1304 MiB |   1078 MiB |
|       from small pool |  24576 KiB |     42 MiB |     42 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 161596 KiB | 245498 GiB | 245498 GiB |
|       from large pool |  30464 KiB | 160090 KiB | 238886 GiB | 238886 GiB |
|       from small pool |      0 KiB |  16243 KiB |   6612 GiB |   6612 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7645    |   83681 K  |   83681 K  |
|       from large pool |       2    |     167    |   45004 K  |   45004 K  |
|       from small pool |       0    |    7565    |   38676 K  |   38676 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7645    |   83681 K  |   83681 K  |
|       from large pool |       2    |     167    |   45004 K  |   45004 K  |
|       from small pool |       0    |    7565    |   38676 K  |   38676 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |      76    |      76    |      53    |
|       from large pool |      11    |      55    |      55    |      44    |
|       from small pool |      12    |      21    |      21    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3605    |   49761 K  |   49761 K  |
|       from large pool |       3    |      57    |   31939 K  |   31939 K  |
|       from small pool |       0    |    3596    |   17822 K  |   17822 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_03_23_24_seed_1_24046979

 Experiment start at: 2024-08-03 03:23:24.961748
before training, model accuracy: 0.6474379897117615
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9520272, 'precision': 0.9529755, 'recall': 0.9520448, 'specificity': 0.9520448, 'f1': 0.95200336, 'auroc': 0.9883795, 'binary_precision': 0.9738928, 'binary_recall': 0.92903227, 'binary_specificity': 0.9750573, 'binary_f1_score': 0.95093375}
confusion matrix:
       0      1
0  28068    718
1   2046  26784
---- Validation: 
scalar performance:
{'acc': 0.9316969, 'precision': 0.6395235, 'recall': 0.79076636, 'specificity': 0.79076636, 'f1': 0.6828248, 'auroc': 0.8822681, 'binary_precision': 0.2931152, 'binary_recall': 0.63893014, 'binary_specificity': 0.9426025, 'binary_f1_score': 0.40186915}
confusion matrix:
       0     1
0  17030  1037
1    243   430
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92523366, 'precision': 0.6579732, 'recall': 0.839609, 'specificity': 0.839609, 'f1': 0.7076303, 'auroc': 0.92081106, 'binary_precision': 0.3277027, 'binary_recall': 0.74615383, 'binary_specificity': 0.9330642, 'binary_f1_score': 0.45539904}
confusion matrix:
      0    1
0  5548  398
1    66  194
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-03 03:51:20.875228,epoch time: 0:27:55.913480,used: 0:27:55.913480,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_03_23_24_seed_1_24046979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96113926, 'precision': 0.96186423, 'recall': 0.9611538, 'specificity': 0.9611538, 'f1': 0.9611249, 'auroc': 0.9929751, 'binary_precision': 0.9803454, 'binary_recall': 0.941205, 'binary_specificity': 0.9811026, 'binary_f1_score': 0.9603766}
confusion matrix:
       0      1
0  28243    544
1   1695  27134
---- Validation: 
scalar performance:
{'acc': 0.92411953, 'precision': 0.6353922, 'recall': 0.825461, 'specificity': 0.825461, 'f1': 0.6822483, 'auroc': 0.89378846, 'binary_precision': 0.28188702, 'binary_recall': 0.7191679, 'binary_specificity': 0.93175405, 'binary_f1_score': 0.40502095}
confusion matrix:
       0     1
0  16834  1233
1    189   484
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89719623, 'precision': 0.62925625, 'recall': 0.86543506, 'specificity': 0.86543506, 'f1': 0.6737436, 'auroc': 0.9307026, 'binary_precision': 0.26666668, 'binary_recall': 0.83076924, 'binary_specificity': 0.9001009, 'binary_f1_score': 0.40373832}
confusion matrix:
      0    1
0  5352  594
1    44  216
early stop counter: 1
val acc:0.9241195321083069, best validation acc: 0.931696891784668, corresponding to test acc:                         0.9252336621284485 / 0.9252336621284485
after epoch: 2,now: 2024-08-03 04:18:32.904177,epoch time: 0:27:12.028949,used: 0:55:07.942429,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_03_23_24_seed_1_24046979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9683595, 'precision': 0.9683962, 'recall': 0.9683628, 'specificity': 0.9683628, 'f1': 0.968359, 'auroc': 0.99476194, 'binary_precision': 0.9727279, 'binary_recall': 0.9637865, 'binary_specificity': 0.9729392, 'binary_f1_score': 0.9682365}
confusion matrix:
       0      1
0  28008    779
1   1044  27785
---- Validation: 
scalar performance:
{'acc': 0.89573103, 'precision': 0.607955, 'recall': 0.8393487, 'specificity': 0.8393487, 'f1': 0.6462134, 'auroc': 0.9029101, 'binary_precision': 0.22498927, 'binary_recall': 0.77860326, 'binary_specificity': 0.9000941, 'binary_f1_score': 0.34910062}
confusion matrix:
       0     1
0  16262  1805
1    149   524
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8401547, 'precision': 0.5934849, 'recall': 0.861413, 'specificity': 0.861413, 'f1': 0.6131468, 'auroc': 0.93596864, 'binary_precision': 0.19295302, 'binary_recall': 0.88461536, 'binary_specificity': 0.8382106, 'binary_f1_score': 0.3168044}
confusion matrix:
      0    1
0  4984  962
1    30  230
early stop counter: 2
val acc:0.8957310318946838, best validation acc: 0.931696891784668, corresponding to test acc:                         0.9252336621284485 / 0.9252336621284485
after epoch: 3,now: 2024-08-03 04:45:46.892540,epoch time: 0:27:13.988363,used: 1:22:21.930792,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_03_23_24_seed_1_24046979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97212577, 'precision': 0.9723213, 'recall': 0.9721333, 'specificity': 0.9721333, 'f1': 0.9721232, 'auroc': 0.99564064, 'binary_precision': 0.9821131, 'binary_recall': 0.9618093, 'binary_specificity': 0.98245734, 'binary_f1_score': 0.97185516}
confusion matrix:
       0      1
0  28282    505
1   1101  27728
---- Validation: 
scalar performance:
{'acc': 0.9185165, 'precision': 0.6298741, 'recall': 0.83471465, 'specificity': 0.83471465, 'f1': 0.67625713, 'auroc': 0.89826715, 'binary_precision': 0.26993534, 'binary_recall': 0.7444279, 'binary_specificity': 0.9250014, 'binary_f1_score': 0.39620402}
confusion matrix:
       0     1
0  16712  1355
1    172   501
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8789881, 'precision': 0.61511195, 'recall': 0.8669668, 'specificity': 0.8669668, 'f1': 0.6522981, 'auroc': 0.9331703, 'binary_precision': 0.23743315, 'binary_recall': 0.85384613, 'binary_specificity': 0.88008744, 'binary_f1_score': 0.37154812}
confusion matrix:
      0    1
0  5233  713
1    38  222
early stop counter: 3
val acc:0.9185165166854858, best validation acc: 0.931696891784668, corresponding to test acc:                         0.9252336621284485 / 0.9252336621284485
after epoch: 4,now: 2024-08-03 05:13:06.120175,epoch time: 0:27:19.227635,used: 1:49:41.158427,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_03_23_24_seed_1_24046979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97417384, 'precision': 0.9741923, 'recall': 0.9741762, 'specificity': 0.9741762, 'f1': 0.9741737, 'auroc': 0.99624836, 'binary_precision': 0.9773386, 'binary_recall': 0.9708974, 'binary_specificity': 0.9774551, 'binary_f1_score': 0.9741074}
confusion matrix:
       0      1
0  28138    649
1    839  27990
---- Validation: 
scalar performance:
{'acc': 0.904429, 'precision': 0.6131396, 'recall': 0.8281238, 'specificity': 0.8281238, 'f1': 0.6537883, 'auroc': 0.8981434, 'binary_precision': 0.23656927, 'binary_recall': 0.7459138, 'binary_specificity': 0.91033375, 'binary_f1_score': 0.35921288}
confusion matrix:
       0     1
0  16447  1620
1    171   502
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8675475, 'precision': 0.6066841, 'recall': 0.86099637, 'specificity': 0.86099637, 'f1': 0.63848126, 'auroc': 0.93322027, 'binary_precision': 0.22067595, 'binary_recall': 0.85384613, 'binary_specificity': 0.86814666, 'binary_f1_score': 0.35071093}
confusion matrix:
      0    1
0  5162  784
1    38  222
early stop counter: 4
val acc:0.904429018497467, best validation acc: 0.931696891784668, corresponding to test acc:                         0.9252336621284485 / 0.9252336621284485
after epoch: 5,now: 2024-08-03 05:40:19.906811,epoch time: 0:27:13.786636,used: 2:16:54.945063,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_03_23_24_seed_1_24046979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97655165, 'precision': 0.9768072, 'recall': 0.97656024, 'specificity': 0.97656024, 'f1': 0.9765488, 'auroc': 0.9968134, 'binary_precision': 0.98802924, 'binary_recall': 0.96482706, 'binary_specificity': 0.98829335, 'binary_f1_score': 0.97629035}
confusion matrix:
       0      1
0  28450    337
1   1014  27815
---- Validation: 
scalar performance:
{'acc': 0.9286019, 'precision': 0.6379317, 'recall': 0.8063276, 'specificity': 0.8063276, 'f1': 0.6831498, 'auroc': 0.89188206, 'binary_precision': 0.28862047, 'binary_recall': 0.67459136, 'binary_specificity': 0.93806386, 'binary_f1_score': 0.40427428}
confusion matrix:
       0     1
0  16948  1119
1    219   454
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91588783, 'precision': 0.64943326, 'recall': 0.8641556, 'specificity': 0.8641556, 'f1': 0.700175, 'auroc': 0.931834, 'binary_precision': 0.3079179, 'binary_recall': 0.8076923, 'binary_specificity': 0.9206189, 'binary_f1_score': 0.4458599}
confusion matrix:
      0    1
0  5474  472
1    50  210
early stop counter: 5
val acc:0.9286019206047058, best validation acc: 0.931696891784668, corresponding to test acc:                         0.9252336621284485 / 0.9252336621284485
after epoch: 6,now: 2024-08-03 06:07:29.378942,epoch time: 0:27:09.472131,used: 2:44:04.417194,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_03_23_24_seed_1_24046979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 6 with time: 2:44:04.417194 at 2024-08-03 06:07:29.378942
persisted model performance metric: 

scalar performance:
{'acc': 0.92523366, 'precision': 0.6579732, 'recall': 0.839609, 'specificity': 0.839609, 'f1': 0.7076303, 'auroc': 0.92081106, 'binary_precision': 0.3277027, 'binary_recall': 0.74615383, 'binary_specificity': 0.9330642, 'binary_f1_score': 0.45539904}
confusion matrix:
      0    1
0  5548  398
1    66  194
oracle model performance metric: 

scalar performance:
{'acc': 0.92523366, 'precision': 0.6579732, 'recall': 0.839609, 'specificity': 0.839609, 'f1': 0.7076303, 'auroc': 0.92081106, 'binary_precision': 0.3277027, 'binary_recall': 0.74615383, 'binary_specificity': 0.9330642, 'binary_f1_score': 0.45539904}
confusion matrix:
      0    1
0  5548  398
1    66  194
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_halffreeze_seed3_2024-08-02_13-31-15/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_halffreeze_seed3_2024-08-02_13-31-15/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 196690 KiB |   1195 MiB | 686766 GiB | 686766 GiB |
|       from large pool | 179211 KiB |   1178 MiB | 677491 GiB | 677491 GiB |
|       from small pool |  17479 KiB |     37 MiB |   9274 GiB |   9274 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 196690 KiB |   1195 MiB | 686766 GiB | 686766 GiB |
|       from large pool | 179211 KiB |   1178 MiB | 677491 GiB | 677491 GiB |
|       from small pool |  17479 KiB |     37 MiB |   9274 GiB |   9274 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195459 KiB |   1193 MiB | 686742 GiB | 686742 GiB |
|       from large pool | 178979 KiB |   1176 MiB | 677485 GiB | 677485 GiB |
|       from small pool |  16480 KiB |     36 MiB |   9256 GiB |   9256 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1336 MiB |   1346 MiB |   2432 MiB |   1096 MiB |
|       from large pool |   1298 MiB |   1304 MiB |   2376 MiB |   1078 MiB |
|       from small pool |     38 MiB |     42 MiB |     56 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  38830 KiB | 161596 KiB | 353008 GiB | 353008 GiB |
|       from large pool |  31733 KiB | 160090 KiB | 343702 GiB | 343702 GiB |
|       from small pool |   7097 KiB |  16243 KiB |   9305 GiB |   9305 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2954    |    7677    |  117620 K  |  117618 K  |
|       from large pool |      79    |     167    |   63229 K  |   63229 K  |
|       from small pool |    2875    |    7597    |   54391 K  |   54388 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2954    |    7677    |  117620 K  |  117618 K  |
|       from large pool |      79    |     167    |   63229 K  |   63229 K  |
|       from small pool |    2875    |    7597    |   54391 K  |   54388 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      74    |      76    |     127    |      53    |
|       from large pool |      55    |      55    |      99    |      44    |
|       from small pool |      19    |      21    |      28    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      31    |    3619    |   70975 K  |   70975 K  |
|       from large pool |      10    |      59    |   45627 K  |   45627 K  |
|       from small pool |      21    |    3609    |   25348 K  |   25348 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1195 MiB | 686766 GiB | 686766 GiB |
|       from large pool |  16640 KiB |   1178 MiB | 677491 GiB | 677491 GiB |
|       from small pool |      0 KiB |     37 MiB |   9274 GiB |   9274 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1195 MiB | 686766 GiB | 686766 GiB |
|       from large pool |  16640 KiB |   1178 MiB | 677491 GiB | 677491 GiB |
|       from small pool |      0 KiB |     37 MiB |   9274 GiB |   9274 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1193 MiB | 686742 GiB | 686742 GiB |
|       from large pool |  16640 KiB |   1176 MiB | 677485 GiB | 677485 GiB |
|       from small pool |      0 KiB |     36 MiB |   9256 GiB |   9256 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 235520 KiB |   1346 MiB |   2432 MiB |   2202 MiB |
|       from large pool | 210944 KiB |   1304 MiB |   2376 MiB |   2170 MiB |
|       from small pool |  24576 KiB |     42 MiB |     56 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 161596 KiB | 353008 GiB | 353008 GiB |
|       from large pool |  30464 KiB | 160090 KiB | 343702 GiB | 343702 GiB |
|       from small pool |      0 KiB |  19405 KiB |   9305 GiB |   9305 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7677    |  117620 K  |  117620 K  |
|       from large pool |       2    |     167    |   63229 K  |   63229 K  |
|       from small pool |       0    |    7597    |   54391 K  |   54391 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7677    |  117620 K  |  117620 K  |
|       from large pool |       2    |     167    |   63229 K  |   63229 K  |
|       from small pool |       0    |    7597    |   54391 K  |   54391 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |      76    |     127    |     105    |
|       from large pool |      10    |      55    |      99    |      89    |
|       from small pool |      12    |      21    |      28    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3619    |   70976 K  |   70976 K  |
|       from large pool |       3    |      59    |   45627 K  |   45627 K  |
|       from small pool |       0    |    3609    |   25349 K  |   25349 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1195 MiB | 686766 GiB | 686766 GiB |
|       from large pool |  16640 KiB |   1178 MiB | 677491 GiB | 677491 GiB |
|       from small pool |      0 KiB |     37 MiB |   9274 GiB |   9274 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1195 MiB | 686766 GiB | 686766 GiB |
|       from large pool |  16640 KiB |   1178 MiB | 677491 GiB | 677491 GiB |
|       from small pool |      0 KiB |     37 MiB |   9274 GiB |   9274 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1193 MiB | 686742 GiB | 686742 GiB |
|       from large pool |  16640 KiB |   1176 MiB | 677485 GiB | 677485 GiB |
|       from small pool |      0 KiB |     36 MiB |   9256 GiB |   9256 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 235520 KiB |   1346 MiB |   2432 MiB |   2202 MiB |
|       from large pool | 210944 KiB |   1304 MiB |   2376 MiB |   2170 MiB |
|       from small pool |  24576 KiB |     42 MiB |     56 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 161596 KiB | 353008 GiB | 353008 GiB |
|       from large pool |  30464 KiB | 160090 KiB | 343702 GiB | 343702 GiB |
|       from small pool |      0 KiB |  19405 KiB |   9305 GiB |   9305 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7677    |  117620 K  |  117620 K  |
|       from large pool |       2    |     167    |   63229 K  |   63229 K  |
|       from small pool |       0    |    7597    |   54391 K  |   54391 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7677    |  117620 K  |  117620 K  |
|       from large pool |       2    |     167    |   63229 K  |   63229 K  |
|       from small pool |       0    |    7597    |   54391 K  |   54391 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |      76    |     127    |     105    |
|       from large pool |      10    |      55    |      99    |      89    |
|       from small pool |      12    |      21    |      28    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3619    |   70976 K  |   70976 K  |
|       from large pool |       3    |      59    |   45627 K  |   45627 K  |
|       from small pool |       0    |    3609    |   25349 K  |   25349 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_06_15_58_seed_2_24046979

 Experiment start at: 2024-08-03 06:15:58.785194
before training, model accuracy: 0.754768431186676
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9494717, 'precision': 0.95042944, 'recall': 0.94947493, 'specificity': 0.94947493, 'f1': 0.9494451, 'auroc': 0.9872215, 'binary_precision': 0.97123337, 'binary_recall': 0.92639595, 'binary_specificity': 0.97255385, 'binary_f1_score': 0.948285}
confusion matrix:
       0      1
0  28348    800
1   2146  27010
---- Validation: 
scalar performance:
{'acc': 0.9370372, 'precision': 0.6226686, 'recall': 0.7394099, 'specificity': 0.7394099, 'f1': 0.65837586, 'auroc': 0.84843606, 'binary_precision': 0.26151314, 'binary_recall': 0.5282392, 'binary_specificity': 0.9505806, 'binary_f1_score': 0.34983498}
confusion matrix:
       0    1
0  17273  898
1    284  318
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88956565, 'precision': 0.60004354, 'recall': 0.7938491, 'specificity': 0.7938491, 'f1': 0.63317114, 'auroc': 0.8684611, 'binary_precision': 0.21382843, 'binary_recall': 0.69008267, 'binary_specificity': 0.8976155, 'binary_f1_score': 0.32649073}
confusion matrix:
      0    1
0  5383  614
1    75  167
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-03 06:44:11.012237,epoch time: 0:28:12.227043,used: 0:28:12.227043,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_06_15_58_seed_2_24046979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96348447, 'precision': 0.96423256, 'recall': 0.9634886, 'specificity': 0.9634886, 'f1': 0.96347, 'auroc': 0.99283564, 'binary_precision': 0.9829194, 'binary_recall': 0.94337744, 'binary_specificity': 0.9835998, 'binary_f1_score': 0.96274257}
confusion matrix:
       0      1
0  28668    478
1   1651  27507
---- Validation: 
scalar performance:
{'acc': 0.9326693, 'precision': 0.6204213, 'recall': 0.7596389, 'specificity': 0.7596389, 'f1': 0.65913385, 'auroc': 0.8654409, 'binary_precision': 0.25553915, 'binary_recall': 0.57475084, 'binary_specificity': 0.944527, 'binary_f1_score': 0.35378325}
confusion matrix:
       0     1
0  17163  1008
1    256   346
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89261097, 'precision': 0.61320424, 'recall': 0.843019, 'specificity': 0.843019, 'f1': 0.65223986, 'auroc': 0.9045721, 'binary_precision': 0.23580247, 'binary_recall': 0.7892562, 'binary_specificity': 0.89678174, 'binary_f1_score': 0.36311784}
confusion matrix:
      0    1
0  5378  619
1    51  191
new oracle model saved
early stop counter: 1
val acc:0.9326692819595337, best validation acc: 0.9370372295379639, corresponding to test acc:                         0.889565646648407 / 0.8926109671592712
after epoch: 2,now: 2024-08-03 07:11:39.760467,epoch time: 0:27:28.748230,used: 0:55:40.975273,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_06_15_58_seed_2_24046979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9700364, 'precision': 0.97010696, 'recall': 0.9700372, 'specificity': 0.9700372, 'f1': 0.97003525, 'auroc': 0.9951158, 'binary_precision': 0.9759003, 'binary_recall': 0.96388394, 'binary_specificity': 0.97619045, 'binary_f1_score': 0.9698549}
confusion matrix:
       0      1
0  28454    694
1   1053  28103
---- Validation: 
scalar performance:
{'acc': 0.92292124, 'precision': 0.61287147, 'recall': 0.7859223, 'specificity': 0.7859223, 'f1': 0.65317917, 'auroc': 0.8771274, 'binary_precision': 0.23839009, 'binary_recall': 0.6395349, 'binary_specificity': 0.93230975, 'binary_f1_score': 0.34731618}
confusion matrix:
       0     1
0  16941  1230
1    217   385
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8908479, 'precision': 0.61367726, 'recall': 0.8520155, 'specificity': 0.8520155, 'f1': 0.6528101, 'auroc': 0.9119222, 'binary_precision': 0.2358604, 'binary_recall': 0.80991733, 'binary_specificity': 0.8941137, 'binary_f1_score': 0.36533082}
confusion matrix:
      0    1
0  5362  635
1    46  196
early stop counter: 2
val acc:0.9229212403297424, best validation acc: 0.9370372295379639, corresponding to test acc:                         0.889565646648407 / 0.8926109671592712
after epoch: 3,now: 2024-08-03 07:39:18.457316,epoch time: 0:27:38.696849,used: 1:23:19.672122,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_06_15_58_seed_2_24046979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9731236, 'precision': 0.9736455, 'recall': 0.9731276, 'specificity': 0.9731276, 'f1': 0.97311634, 'auroc': 0.9963365, 'binary_precision': 0.9894281, 'binary_recall': 0.95647997, 'binary_specificity': 0.98977524, 'binary_f1_score': 0.9726751}
confusion matrix:
       0      1
0  28847    298
1   1269  27890
---- Validation: 
scalar performance:
{'acc': 0.93698394, 'precision': 0.6320258, 'recall': 0.77551955, 'specificity': 0.77551955, 'f1': 0.673554, 'auroc': 0.88396436, 'binary_precision': 0.27773526, 'binary_recall': 0.60299003, 'binary_specificity': 0.94804907, 'binary_f1_score': 0.3803038}
confusion matrix:
       0    1
0  17227  944
1    239  363
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9104023, 'precision': 0.6295101, 'recall': 0.84037715, 'specificity': 0.84037715, 'f1': 0.6749376, 'auroc': 0.9084412, 'binary_precision': 0.26928675, 'binary_recall': 0.7644628, 'binary_specificity': 0.9162915, 'binary_f1_score': 0.3982777}
confusion matrix:
      0    1
0  5495  502
1    57  185
new oracle model saved
early stop counter: 3
val acc:0.9369839429855347, best validation acc: 0.9370372295379639, corresponding to test acc:                         0.889565646648407 / 0.9104022979736328
after epoch: 4,now: 2024-08-03 08:06:51.406294,epoch time: 0:27:32.948978,used: 1:50:52.621100,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_06_15_58_seed_2_24046979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97639954, 'precision': 0.976719, 'recall': 0.97640264, 'specificity': 0.97640264, 'f1': 0.9763957, 'auroc': 0.996819, 'binary_precision': 0.9891201, 'binary_recall': 0.9634075, 'binary_specificity': 0.9893978, 'binary_f1_score': 0.9760945}
confusion matrix:
       0      1
0  28836    309
1   1067  28092
---- Validation: 
scalar performance:
{'acc': 0.9373036, 'precision': 0.63266855, 'recall': 0.77568465, 'specificity': 0.77568465, 'f1': 0.67424047, 'auroc': 0.88951635, 'binary_precision': 0.27901614, 'binary_recall': 0.60299003, 'binary_specificity': 0.9483793, 'binary_f1_score': 0.38150287}
confusion matrix:
       0    1
0  17233  938
1    239  363
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90815836, 'precision': 0.6229038, 'recall': 0.82136524, 'specificity': 0.82136524, 'f1': 0.6654715, 'auroc': 0.9053778, 'binary_precision': 0.25768667, 'binary_recall': 0.72727275, 'binary_specificity': 0.9154577, 'binary_f1_score': 0.38054052}
confusion matrix:
      0    1
0  5490  507
1    66  176
better model found
persisted
after epoch: 5,now: 2024-08-03 08:34:21.662489,epoch time: 0:27:30.256195,used: 2:18:22.877295,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_06_15_58_seed_2_24046979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.979058, 'precision': 0.9792491, 'recall': 0.9790601, 'specificity': 0.9790601, 'f1': 0.979056, 'auroc': 0.99718004, 'binary_precision': 0.9888706, 'binary_recall': 0.9690308, 'binary_specificity': 0.9890894, 'binary_f1_score': 0.9788502}
confusion matrix:
       0      1
0  28828    318
1    903  28255
---- Validation: 
scalar performance:
{'acc': 0.9267032, 'precision': 0.61970294, 'recall': 0.7934973, 'specificity': 0.7934973, 'f1': 0.6620388, 'auroc': 0.89104104, 'binary_precision': 0.25160462, 'binary_recall': 0.6511628, 'binary_specificity': 0.93583184, 'binary_f1_score': 0.36296296}
confusion matrix:
       0     1
0  17005  1166
1    210   392
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8964578, 'precision': 0.6134371, 'recall': 0.82915807, 'specificity': 0.82915807, 'f1': 0.6526598, 'auroc': 0.9066737, 'binary_precision': 0.23766233, 'binary_recall': 0.75619835, 'binary_specificity': 0.9021177, 'binary_f1_score': 0.3616601}
confusion matrix:
      0    1
0  5410  587
1    59  183
early stop counter: 1
val acc:0.9267032146453857, best validation acc: 0.9373036026954651, corresponding to test acc:                         0.9081583619117737 / 0.9104022979736328
after epoch: 6,now: 2024-08-03 09:01:56.733299,epoch time: 0:27:35.070810,used: 2:45:57.948105,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_06_15_58_seed_2_24046979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97729146, 'precision': 0.9773342, 'recall': 0.9772908, 'specificity': 0.9772908, 'f1': 0.9772909, 'auroc': 0.99749243, 'binary_precision': 0.97285086, 'binary_recall': 0.98199344, 'binary_specificity': 0.9725882, 'binary_f1_score': 0.97740084}
confusion matrix:
       0      1
0  28349    799
1    525  28631
---- Validation: 
scalar performance:
{'acc': 0.889096, 'precision': 0.58861023, 'recall': 0.8142232, 'specificity': 0.8142232, 'f1': 0.6189181, 'auroc': 0.88944435, 'binary_precision': 0.18697123, 'binary_recall': 0.73421925, 'binary_specificity': 0.8942271, 'binary_f1_score': 0.29804447}
confusion matrix:
       0     1
0  16249  1922
1    160   442
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83314633, 'precision': 0.57923615, 'recall': 0.8299315, 'specificity': 0.8299315, 'f1': 0.59163296, 'auroc': 0.90013325, 'binary_precision': 0.16680567, 'binary_recall': 0.8264463, 'binary_specificity': 0.8334167, 'binary_f1_score': 0.277585}
confusion matrix:
      0    1
0  4998  999
1    42  200
early stop counter: 2
val acc:0.8890960216522217, best validation acc: 0.9373036026954651, corresponding to test acc:                         0.9081583619117737 / 0.9104022979736328
after epoch: 7,now: 2024-08-03 09:29:40.951009,epoch time: 0:27:44.217710,used: 3:13:42.165815,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_06_15_58_seed_2_24046979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98046446, 'precision': 0.9807566, 'recall': 0.9804666, 'specificity': 0.9804666, 'f1': 0.98046154, 'auroc': 0.99773896, 'binary_precision': 0.99265015, 'binary_recall': 0.9681037, 'binary_specificity': 0.99282944, 'binary_f1_score': 0.98022324}
confusion matrix:
       0      1
0  28938    209
1    930  28227
---- Validation: 
scalar performance:
{'acc': 0.92888725, 'precision': 0.6194779, 'recall': 0.77936757, 'specificity': 0.77936757, 'f1': 0.6604194, 'auroc': 0.88638294, 'binary_precision': 0.25219744, 'binary_recall': 0.6196013, 'binary_specificity': 0.93913376, 'binary_f1_score': 0.3584815}
confusion matrix:
       0     1
0  17065  1106
1    229   373
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88058984, 'precision': 0.59592235, 'recall': 0.8030592, 'specificity': 0.8030592, 'f1': 0.6264764, 'auroc': 0.88911676, 'binary_precision': 0.20446533, 'binary_recall': 0.71900827, 'binary_specificity': 0.88711023, 'binary_f1_score': 0.31838974}
confusion matrix:
      0    1
0  5320  677
1    68  174
early stop counter: 3
val acc:0.9288872480392456, best validation acc: 0.9373036026954651, corresponding to test acc:                         0.9081583619117737 / 0.9104022979736328
after epoch: 8,now: 2024-08-03 09:57:33.754790,epoch time: 0:27:52.803781,used: 3:41:34.969596,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_06_15_58_seed_2_24046979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9810819, 'precision': 0.9811442, 'recall': 0.9810833, 'specificity': 0.9810833, 'f1': 0.9810813, 'auroc': 0.9976119, 'binary_precision': 0.98667777, 'binary_recall': 0.9753421, 'binary_specificity': 0.9868245, 'binary_f1_score': 0.9809771}
confusion matrix:
       0      1
0  28761    384
1    719  28440
---- Validation: 
scalar performance:
{'acc': 0.9189261, 'precision': 0.6141465, 'recall': 0.81276834, 'specificity': 0.81276834, 'f1': 0.6564576, 'auroc': 0.90105355, 'binary_precision': 0.23893303, 'binary_recall': 0.6993356, 'binary_specificity': 0.9262011, 'binary_f1_score': 0.35617596}
confusion matrix:
       0     1
0  16830  1341
1    181   421
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86969066, 'precision': 0.5953858, 'recall': 0.83109635, 'specificity': 0.83109635, 'f1': 0.623805, 'auroc': 0.898016, 'binary_precision': 0.20041972, 'binary_recall': 0.7892562, 'binary_specificity': 0.8729365, 'binary_f1_score': 0.31966528}
confusion matrix:
      0    1
0  5235  762
1    51  191
early stop counter: 4
val acc:0.9189261198043823, best validation acc: 0.9373036026954651, corresponding to test acc:                         0.9081583619117737 / 0.9104022979736328
after epoch: 9,now: 2024-08-03 10:25:05.121465,epoch time: 0:27:31.366675,used: 4:09:06.336271,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_06_15_58_seed_2_24046979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98252267, 'precision': 0.9826319, 'recall': 0.9825239, 'specificity': 0.9825239, 'f1': 0.98252165, 'auroc': 0.9978967, 'binary_precision': 0.98993593, 'binary_recall': 0.9749631, 'binary_specificity': 0.99008477, 'binary_f1_score': 0.98239243}
confusion matrix:
       0      1
0  28858    289
1    730  28427
---- Validation: 
scalar performance:
{'acc': 0.9186065, 'precision': 0.6128505, 'recall': 0.80858797, 'specificity': 0.80858797, 'f1': 0.654558, 'auroc': 0.89516634, 'binary_precision': 0.23663254, 'binary_recall': 0.6910299, 'binary_specificity': 0.92614603, 'binary_f1_score': 0.35254237}
confusion matrix:
       0     1
0  16829  1342
1    186   416
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8821927, 'precision': 0.600183, 'recall': 0.81777215, 'specificity': 0.81777215, 'f1': 0.6327048, 'auroc': 0.89652956, 'binary_precision': 0.21169591, 'binary_recall': 0.74793386, 'binary_specificity': 0.8876105, 'binary_f1_score': 0.3299909}
confusion matrix:
      0    1
0  5323  674
1    61  181
early stop counter: 5
val acc:0.9186065196990967, best validation acc: 0.9373036026954651, corresponding to test acc:                         0.9081583619117737 / 0.9104022979736328
after epoch: 10,now: 2024-08-03 10:52:52.138838,epoch time: 0:27:47.017373,used: 4:36:53.353644,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_06_15_58_seed_2_24046979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 10 with time: 4:36:53.353644 at 2024-08-03 10:52:52.138838
persisted model performance metric: 

scalar performance:
{'acc': 0.90815836, 'precision': 0.6229038, 'recall': 0.82136524, 'specificity': 0.82136524, 'f1': 0.6654715, 'auroc': 0.9053778, 'binary_precision': 0.25768667, 'binary_recall': 0.72727275, 'binary_specificity': 0.9154577, 'binary_f1_score': 0.38054052}
confusion matrix:
      0    1
0  5490  507
1    66  176
oracle model performance metric: 

scalar performance:
{'acc': 0.9104023, 'precision': 0.6295101, 'recall': 0.84037715, 'specificity': 0.84037715, 'f1': 0.6749376, 'auroc': 0.9084412, 'binary_precision': 0.26928675, 'binary_recall': 0.7644628, 'binary_specificity': 0.9162915, 'binary_f1_score': 0.3982777}
confusion matrix:
      0    1
0  5495  502
1    57  185
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_halffreeze_seed3_2024-08-02_13-31-15/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_halffreeze_seed3_2024-08-02_13-31-15/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 196696 KiB |   1195 MiB |    994 TiB |    994 TiB |
|       from large pool | 179211 KiB |   1178 MiB |    980 TiB |    980 TiB |
|       from small pool |  17485 KiB |     37 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 196696 KiB |   1195 MiB |    994 TiB |    994 TiB |
|       from large pool | 179211 KiB |   1178 MiB |    980 TiB |    980 TiB |
|       from small pool |  17485 KiB |     37 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195460 KiB |   1193 MiB |    994 TiB |    994 TiB |
|       from large pool | 178979 KiB |   1176 MiB |    980 TiB |    980 TiB |
|       from small pool |  16481 KiB |     36 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1336 MiB |   1346 MiB |   3538 MiB |   2202 MiB |
|       from large pool |   1298 MiB |   1304 MiB |   3468 MiB |   2170 MiB |
|       from small pool |     38 MiB |     42 MiB |     70 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  42920 KiB | 161596 KiB | 532890 GiB | 532890 GiB |
|       from large pool |  31733 KiB | 160090 KiB | 519096 GiB | 519096 GiB |
|       from small pool |  11187 KiB |  19405 KiB |  13793 GiB |  13793 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2966    |    7763    |  174343 K  |  174340 K  |
|       from large pool |      79    |     167    |   93748 K  |   93748 K  |
|       from small pool |    2887    |    7683    |   80595 K  |   80592 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2966    |    7763    |  174343 K  |  174340 K  |
|       from large pool |      79    |     167    |   93748 K  |   93748 K  |
|       from small pool |    2887    |    7683    |   80595 K  |   80592 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      74    |      76    |     179    |     105    |
|       from large pool |      55    |      55    |     144    |      89    |
|       from small pool |      19    |      21    |      35    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      34    |    3664    |  106639 K  |  106639 K  |
|       from large pool |      10    |      59    |   68562 K  |   68562 K  |
|       from small pool |      24    |    3654    |   38076 K  |   38076 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1195 MiB |    994 TiB |    994 TiB |
|       from large pool |  16640 KiB |   1178 MiB |    980 TiB |    980 TiB |
|       from small pool |      0 KiB |     37 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1195 MiB |    994 TiB |    994 TiB |
|       from large pool |  16640 KiB |   1178 MiB |    980 TiB |    980 TiB |
|       from small pool |      0 KiB |     37 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1193 MiB |    994 TiB |    994 TiB |
|       from large pool |  16640 KiB |   1176 MiB |    980 TiB |    980 TiB |
|       from small pool |      0 KiB |     36 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 239616 KiB |   1346 MiB |   3538 MiB |   3304 MiB |
|       from large pool | 210944 KiB |   1304 MiB |   3468 MiB |   3262 MiB |
|       from small pool |  28672 KiB |     42 MiB |     70 MiB |     42 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 161596 KiB | 532890 GiB | 532890 GiB |
|       from large pool |  30464 KiB | 160090 KiB | 519096 GiB | 519096 GiB |
|       from small pool |      0 KiB |  21230 KiB |  13793 GiB |  13793 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7763    |  174343 K  |  174343 K  |
|       from large pool |       2    |     167    |   93748 K  |   93748 K  |
|       from small pool |       0    |    7683    |   80595 K  |   80595 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7763    |  174343 K  |  174343 K  |
|       from large pool |       2    |     167    |   93748 K  |   93748 K  |
|       from small pool |       0    |    7683    |   80595 K  |   80595 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |      76    |     179    |     155    |
|       from large pool |      10    |      55    |     144    |     134    |
|       from small pool |      14    |      21    |      35    |      21    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3664    |  106640 K  |  106640 K  |
|       from large pool |       3    |      59    |   68562 K  |   68562 K  |
|       from small pool |       0    |    3654    |   38077 K  |   38077 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1195 MiB |    994 TiB |    994 TiB |
|       from large pool |  16640 KiB |   1178 MiB |    980 TiB |    980 TiB |
|       from small pool |      0 KiB |     37 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1195 MiB |    994 TiB |    994 TiB |
|       from large pool |  16640 KiB |   1178 MiB |    980 TiB |    980 TiB |
|       from small pool |      0 KiB |     37 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1193 MiB |    994 TiB |    994 TiB |
|       from large pool |  16640 KiB |   1176 MiB |    980 TiB |    980 TiB |
|       from small pool |      0 KiB |     36 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 239616 KiB |   1346 MiB |   3538 MiB |   3304 MiB |
|       from large pool | 210944 KiB |   1304 MiB |   3468 MiB |   3262 MiB |
|       from small pool |  28672 KiB |     42 MiB |     70 MiB |     42 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 161596 KiB | 532890 GiB | 532890 GiB |
|       from large pool |  30464 KiB | 160090 KiB | 519096 GiB | 519096 GiB |
|       from small pool |      0 KiB |  21230 KiB |  13793 GiB |  13793 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7763    |  174343 K  |  174343 K  |
|       from large pool |       2    |     167    |   93748 K  |   93748 K  |
|       from small pool |       0    |    7683    |   80595 K  |   80595 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7763    |  174343 K  |  174343 K  |
|       from large pool |       2    |     167    |   93748 K  |   93748 K  |
|       from small pool |       0    |    7683    |   80595 K  |   80595 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |      76    |     179    |     155    |
|       from large pool |      10    |      55    |     144    |     134    |
|       from small pool |      14    |      21    |      35    |      21    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3664    |  106640 K  |  106640 K  |
|       from large pool |       3    |      59    |   68562 K  |   68562 K  |
|       from small pool |       0    |    3654    |   38077 K  |   38077 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_11_02_55_seed_3_24046979

 Experiment start at: 2024-08-03 11:02:55.902422
before training, model accuracy: 0.7207813262939453
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9501602, 'precision': 0.95119166, 'recall': 0.9501812, 'specificity': 0.9501812, 'f1': 0.9501333, 'auroc': 0.9858458, 'binary_precision': 0.9729829, 'binary_recall': 0.92612314, 'binary_specificity': 0.97423923, 'binary_f1_score': 0.94897485}
confusion matrix:
       0      1
0  27948    739
1   2123  26614
---- Validation: 
scalar performance:
{'acc': 0.9110756, 'precision': 0.5978941, 'recall': 0.75618505, 'specificity': 0.75618505, 'f1': 0.6317632, 'auroc': 0.8588128, 'binary_precision': 0.21120448, 'binary_recall': 0.58998436, 'binary_specificity': 0.92238575, 'binary_f1_score': 0.3110561}
confusion matrix:
       0     1
0  16733  1408
1    262   377
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9252322, 'precision': 0.65640926, 'recall': 0.78749967, 'specificity': 0.78749967, 'f1': 0.697637, 'auroc': 0.88504744, 'binary_precision': 0.33088234, 'binary_recall': 0.6360424, 'binary_specificity': 0.9389569, 'binary_f1_score': 0.43530834}
confusion matrix:
      0    1
0  5599  364
1   103  180
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-03 11:33:53.468185,epoch time: 0:30:57.565763,used: 0:30:57.565763,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_11_02_55_seed_3_24046979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9642832, 'precision': 0.9646616, 'recall': 0.96429574, 'specificity': 0.96429574, 'f1': 0.9642766, 'auroc': 0.9922427, 'binary_precision': 0.9781409, 'binary_recall': 0.94985557, 'binary_specificity': 0.978736, 'binary_f1_score': 0.9637908}
confusion matrix:
       0      1
0  28077    610
1   1441  27296
---- Validation: 
scalar performance:
{'acc': 0.9277423, 'precision': 0.61931807, 'recall': 0.76028246, 'specificity': 0.76028246, 'f1': 0.65761715, 'auroc': 0.88050294, 'binary_precision': 0.2541096, 'binary_recall': 0.58059466, 'binary_specificity': 0.93997025, 'binary_f1_score': 0.35350165}
confusion matrix:
       0     1
0  17052  1089
1    268   371
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9418828, 'precision': 0.6973815, 'recall': 0.8063177, 'specificity': 0.8063177, 'f1': 0.7376236, 'auroc': 0.90448225, 'binary_precision': 0.41150442, 'binary_recall': 0.6572438, 'binary_specificity': 0.9553916, 'binary_f1_score': 0.5061224}
confusion matrix:
      0    1
0  5697  266
1    97  186
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-03 12:03:18.800230,epoch time: 0:29:25.332045,used: 1:00:22.897808,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_11_02_55_seed_3_24046979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96586794, 'precision': 0.9670157, 'recall': 0.9658914, 'specificity': 0.9658914, 'f1': 0.96584815, 'auroc': 0.99449766, 'binary_precision': 0.990404, 'binary_recall': 0.94091654, 'binary_specificity': 0.9908663, 'binary_f1_score': 0.96502626}
confusion matrix:
       0      1
0  28423    262
1   1698  27041
---- Validation: 
scalar performance:
{'acc': 0.94850904, 'precision': 0.63796735, 'recall': 0.6736481, 'specificity': 0.6736481, 'f1': 0.65339154, 'auroc': 0.87715644, 'binary_precision': 0.29802954, 'binary_recall': 0.37871674, 'binary_specificity': 0.9685795, 'binary_f1_score': 0.33356306}
confusion matrix:
       0    1
0  17571  570
1    397  242
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9580532, 'precision': 0.75725484, 'recall': 0.76934737, 'specificity': 0.76934737, 'f1': 0.7631406, 'auroc': 0.90075666, 'binary_precision': 0.53535354, 'binary_recall': 0.56183743, 'binary_specificity': 0.9768573, 'binary_f1_score': 0.5482759}
confusion matrix:
      0    1
0  5825  138
1   124  159
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-03 12:32:01.704657,epoch time: 0:28:42.904427,used: 1:29:05.802235,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_11_02_55_seed_3_24046979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9737218, 'precision': 0.9738922, 'recall': 0.97373056, 'specificity': 0.97373056, 'f1': 0.9737197, 'auroc': 0.9955233, 'binary_precision': 0.9831092, 'binary_recall': 0.9640546, 'binary_specificity': 0.98340654, 'binary_f1_score': 0.9734886}
confusion matrix:
       0      1
0  28210    476
1   1033  27705
---- Validation: 
scalar performance:
{'acc': 0.9398296, 'precision': 0.634802, 'recall': 0.73634255, 'specificity': 0.73634255, 'f1': 0.66891354, 'auroc': 0.8816731, 'binary_precision': 0.2870772, 'binary_recall': 0.51799685, 'binary_specificity': 0.95468825, 'binary_f1_score': 0.36941963}
confusion matrix:
       0    1
0  17319  822
1    308  331
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94988793, 'precision': 0.7208711, 'recall': 0.79031503, 'specificity': 0.79031503, 'f1': 0.75000954, 'auroc': 0.90336555, 'binary_precision': 0.46031746, 'binary_recall': 0.614841, 'binary_specificity': 0.965789, 'binary_f1_score': 0.526475}
confusion matrix:
      0    1
0  5759  204
1   109  174
early stop counter: 1
val acc:0.9398295879364014, best validation acc: 0.9485090374946594, corresponding to test acc:                         0.9580531716346741 / 0.9580531716346741
after epoch: 4,now: 2024-08-03 13:00:43.622590,epoch time: 0:28:41.917933,used: 1:57:47.720168,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_11_02_55_seed_3_24046979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97598565, 'precision': 0.97610974, 'recall': 0.97599375, 'specificity': 0.97599375, 'f1': 0.97598433, 'auroc': 0.99681425, 'binary_precision': 0.98404276, 'binary_recall': 0.9677105, 'binary_specificity': 0.98427695, 'binary_f1_score': 0.97580826}
confusion matrix:
       0      1
0  28233    451
1    928  27812
---- Validation: 
scalar performance:
{'acc': 0.94377, 'precision': 0.64194316, 'recall': 0.7285683, 'specificity': 0.7285683, 'f1': 0.67322266, 'auroc': 0.88504577, 'binary_precision': 0.3019943, 'binary_recall': 0.4976526, 'binary_specificity': 0.95948404, 'binary_f1_score': 0.37588653}
confusion matrix:
       0    1
0  17406  735
1    321  318
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9510086, 'precision': 0.7238724, 'recall': 0.7774385, 'specificity': 0.7774385, 'f1': 0.7472811, 'auroc': 0.899865, 'binary_precision': 0.46760562, 'binary_recall': 0.5865724, 'binary_specificity': 0.9683046, 'binary_f1_score': 0.52037615}
confusion matrix:
      0    1
0  5774  189
1   117  166
early stop counter: 2
val acc:0.9437699913978577, best validation acc: 0.9485090374946594, corresponding to test acc:                         0.9580531716346741 / 0.9580531716346741
after epoch: 5,now: 2024-08-03 13:30:48.899331,epoch time: 0:30:05.276741,used: 2:27:52.996909,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_11_02_55_seed_3_24046979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9772569, 'precision': 0.9774864, 'recall': 0.977267, 'specificity': 0.977267, 'f1': 0.9772545, 'auroc': 0.9969324, 'binary_precision': 0.9881834, 'binary_recall': 0.9661076, 'binary_specificity': 0.9884264, 'binary_f1_score': 0.9770208}
confusion matrix:
       0      1
0  28354    332
1    974  27764
---- Validation: 
scalar performance:
{'acc': 0.94808304, 'precision': 0.6559841, 'recall': 0.7360852, 'specificity': 0.7360852, 'f1': 0.68643385, 'auroc': 0.89428556, 'binary_precision': 0.3296146, 'binary_recall': 0.5086072, 'binary_specificity': 0.9635632, 'binary_f1_score': 0.40000004}
confusion matrix:
       0    1
0  17480  661
1    314  325
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95276976, 'precision': 0.7321503, 'recall': 0.78845847, 'specificity': 0.78845847, 'f1': 0.7567264, 'auroc': 0.90398026, 'binary_precision': 0.48314607, 'binary_recall': 0.60777384, 'binary_specificity': 0.96914303, 'binary_f1_score': 0.5383411}
confusion matrix:
      0    1
0  5779  184
1   111  172
early stop counter: 3
val acc:0.9480830430984497, best validation acc: 0.9485090374946594, corresponding to test acc:                         0.9580531716346741 / 0.9580531716346741
after epoch: 6,now: 2024-08-03 13:59:45.824674,epoch time: 0:28:56.925343,used: 2:56:49.922252,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_11_02_55_seed_3_24046979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9791028, 'precision': 0.9791527, 'recall': 0.97910786, 'specificity': 0.97910786, 'f1': 0.9791025, 'auroc': 0.99718726, 'binary_precision': 0.98427886, 'binary_recall': 0.9737987, 'binary_specificity': 0.98441696, 'binary_f1_score': 0.97901076}
confusion matrix:
       0      1
0  28238    447
1    753  27986
---- Validation: 
scalar performance:
{'acc': 0.9234824, 'precision': 0.6230486, 'recall': 0.8003525, 'specificity': 0.8003525, 'f1': 0.6660095, 'auroc': 0.8984829, 'binary_precision': 0.2584746, 'binary_recall': 0.6682316, 'binary_specificity': 0.9324734, 'binary_f1_score': 0.372763}
confusion matrix:
       0     1
0  16916  1225
1    212   427
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9289145, 'precision': 0.66957426, 'recall': 0.81635517, 'specificity': 0.81635517, 'f1': 0.7154038, 'auroc': 0.9013473, 'binary_precision': 0.35443038, 'binary_recall': 0.6925795, 'binary_specificity': 0.94013083, 'binary_f1_score': 0.4688995}
confusion matrix:
      0    1
0  5606  357
1    87  196
early stop counter: 4
val acc:0.9234824180603027, best validation acc: 0.9485090374946594, corresponding to test acc:                         0.9580531716346741 / 0.9580531716346741
after epoch: 7,now: 2024-08-03 14:27:32.476786,epoch time: 0:27:46.652112,used: 3:24:36.574364,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_11_02_55_seed_3_24046979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98023474, 'precision': 0.98041224, 'recall': 0.980244, 'specificity': 0.980244, 'f1': 0.9802332, 'auroc': 0.9975262, 'binary_precision': 0.9898843, 'binary_recall': 0.97042346, 'binary_specificity': 0.9900645, 'binary_f1_score': 0.9800573}
confusion matrix:
       0      1
0  28400    285
1    850  27889
---- Validation: 
scalar performance:
{'acc': 0.94185305, 'precision': 0.6445621, 'recall': 0.7555078, 'specificity': 0.7555078, 'f1': 0.681734, 'auroc': 0.8955388, 'binary_precision': 0.30524504, 'binary_recall': 0.5555556, 'binary_specificity': 0.95546, 'binary_f1_score': 0.39400667}
confusion matrix:
       0    1
0  17333  808
1    284  355
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94284344, 'precision': 0.69766605, 'recall': 0.7916744, 'specificity': 0.7916744, 'f1': 0.7337936, 'auroc': 0.8917401, 'binary_precision': 0.4135514, 'binary_recall': 0.6254417, 'binary_specificity': 0.9579071, 'binary_f1_score': 0.49789023}
confusion matrix:
      0    1
0  5712  251
1   106  177
early stop counter: 5
val acc:0.9418530464172363, best validation acc: 0.9485090374946594, corresponding to test acc:                         0.9580531716346741 / 0.9580531716346741
after epoch: 8,now: 2024-08-03 14:55:45.108027,epoch time: 0:28:12.631241,used: 3:52:49.205605,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_11_02_55_seed_3_24046979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 8 with time: 3:52:49.205605 at 2024-08-03 14:55:45.108027
persisted model performance metric: 

scalar performance:
{'acc': 0.9580532, 'precision': 0.75725484, 'recall': 0.76934737, 'specificity': 0.76934737, 'f1': 0.7631406, 'auroc': 0.90075666, 'binary_precision': 0.53535354, 'binary_recall': 0.56183743, 'binary_specificity': 0.9768573, 'binary_f1_score': 0.5482759}
confusion matrix:
      0    1
0  5825  138
1   124  159
oracle model performance metric: 

scalar performance:
{'acc': 0.9580532, 'precision': 0.75725484, 'recall': 0.76934737, 'specificity': 0.76934737, 'f1': 0.7631406, 'auroc': 0.90075666, 'binary_precision': 0.53535354, 'binary_recall': 0.56183743, 'binary_specificity': 0.9768573, 'binary_f1_score': 0.5482759}
confusion matrix:
      0    1
0  5825  138
1   124  159
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_halffreeze_seed3_2024-08-02_13-31-15/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_halffreeze_seed3_2024-08-02_13-31-15/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 196699 KiB |   1195 MiB |   1250 TiB |   1250 TiB |
|       from large pool | 179211 KiB |   1178 MiB |   1233 TiB |   1233 TiB |
|       from small pool |  17488 KiB |     37 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 196699 KiB |   1195 MiB |   1250 TiB |   1250 TiB |
|       from large pool | 179211 KiB |   1178 MiB |   1233 TiB |   1233 TiB |
|       from small pool |  17488 KiB |     37 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195461 KiB |   1193 MiB |   1250 TiB |   1250 TiB |
|       from large pool | 178979 KiB |   1176 MiB |   1233 TiB |   1233 TiB |
|       from small pool |  16482 KiB |     36 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1336 MiB |   1346 MiB |   4640 MiB |   3304 MiB |
|       from large pool |   1298 MiB |   1304 MiB |   4560 MiB |   3262 MiB |
|       from small pool |     38 MiB |     42 MiB |     80 MiB |     42 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  40869 KiB | 161596 KiB | 675415 GiB | 675415 GiB |
|       from large pool |  31733 KiB | 160090 KiB | 657952 GiB | 657952 GiB |
|       from small pool |   9136 KiB |  21230 KiB |  17463 GiB |  17463 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2972    |    7763    |  219297 K  |  219294 K  |
|       from large pool |      79    |     167    |  117899 K  |  117899 K  |
|       from small pool |    2893    |    7683    |  101397 K  |  101394 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2972    |    7763    |  219297 K  |  219294 K  |
|       from large pool |      79    |     167    |  117899 K  |  117899 K  |
|       from small pool |    2893    |    7683    |  101397 K  |  101394 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      74    |      76    |     229    |     155    |
|       from large pool |      55    |      55    |     189    |     134    |
|       from small pool |      19    |      21    |      40    |      21    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      31    |    3664    |  136409 K  |  136409 K  |
|       from large pool |      10    |      59    |   86704 K  |   86704 K  |
|       from small pool |      21    |    3654    |   49705 K  |   49705 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1195 MiB |   1250 TiB |   1250 TiB |
|       from large pool |  16640 KiB |   1178 MiB |   1233 TiB |   1233 TiB |
|       from small pool |      0 KiB |     37 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1195 MiB |   1250 TiB |   1250 TiB |
|       from large pool |  16640 KiB |   1178 MiB |   1233 TiB |   1233 TiB |
|       from small pool |      0 KiB |     37 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1193 MiB |   1250 TiB |   1250 TiB |
|       from large pool |  16640 KiB |   1176 MiB |   1233 TiB |   1233 TiB |
|       from small pool |      0 KiB |     36 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 237568 KiB |   1346 MiB |   4640 MiB |   4408 MiB |
|       from large pool | 210944 KiB |   1304 MiB |   4560 MiB |   4354 MiB |
|       from small pool |  26624 KiB |     42 MiB |     80 MiB |     54 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 161596 KiB | 675416 GiB | 675416 GiB |
|       from large pool |  30464 KiB | 160090 KiB | 657952 GiB | 657952 GiB |
|       from small pool |      0 KiB |  23492 KiB |  17463 GiB |  17463 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7763    |  219297 K  |  219297 K  |
|       from large pool |       2    |     167    |  117899 K  |  117899 K  |
|       from small pool |       0    |    7683    |  101397 K  |  101397 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7763    |  219297 K  |  219297 K  |
|       from large pool |       2    |     167    |  117899 K  |  117899 K  |
|       from small pool |       0    |    7683    |  101397 K  |  101397 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |      76    |     229    |     206    |
|       from large pool |      10    |      55    |     189    |     179    |
|       from small pool |      13    |      21    |      40    |      27    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3664    |  136410 K  |  136410 K  |
|       from large pool |       3    |      59    |   86704 K  |   86704 K  |
|       from small pool |       0    |    3654    |   49706 K  |   49706 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat Aug  3 14:57:14 2024]
Finished job 0.
1 of 1 steps (100%) done
