Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Fri Aug  2 17:27:40 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_halffreeze_seed3_2024-08-02_13-31-15/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_halffreeze_seed3_2024-08-02_13-31-15/rule_results/1.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=1
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_17_38_59_seed_0_24046977

 Experiment start at: 2024-08-02 17:38:59.435084
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.7297859191894531
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.8542538, 'precision': 0.86169434, 'recall': 0.85430634, 'specificity': 0.85430634, 'f1': 0.8535134, 'auroc': 0.90850985, 'binary_precision': 0.9137545, 'binary_recall': 0.782586, 'binary_specificity': 0.9260267, 'binary_f1_score': 0.84309894}
confusion matrix:
       0      1
0  26539   2120
1   6240  22461
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.8855364, 'precision': 0.5312899, 'recall': 0.58371425, 'specificity': 0.58371425, 'f1': 0.5365613, 'auroc': 0.74250436, 'binary_precision': 0.09066232, 'binary_recall': 0.25972006, 'binary_specificity': 0.9077084, 'binary_f1_score': 0.13440643}
confusion matrix:
       0     1
0  16474  1675
1    476   167
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8892617, 'precision': 0.5508941, 'recall': 0.6087364, 'specificity': 0.6087364, 'f1': 0.5631277, 'auroc': 0.75871253, 'binary_precision': 0.1338983, 'binary_recall': 0.30268198, 'binary_specificity': 0.91479075, 'binary_f1_score': 0.18566391}
confusion matrix:
      0    1
0  5486  511
1   182   79
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-02 17:58:20.048318,epoch time: 0:19:20.613234,used: 0:19:20.613234,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_17_38_59_seed_0_24046977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.89381105, 'precision': 0.9014833, 'recall': 0.8938641, 'specificity': 0.8938641, 'f1': 0.8933104, 'auroc': 0.9515579, 'binary_precision': 0.9571758, 'binary_recall': 0.8246812, 'binary_specificity': 0.96304697, 'binary_f1_score': 0.8860025}
confusion matrix:
       0      1
0  27599   1059
1   5032  23670
---- Validation: 
scalar performance:
{'acc': 0.8873989, 'precision': 0.5398217, 'recall': 0.6079302, 'specificity': 0.6079302, 'f1': 0.54865515, 'auroc': 0.7797377, 'binary_precision': 0.10593901, 'binary_recall': 0.30793157, 'binary_specificity': 0.9079288, 'binary_f1_score': 0.15764332}
confusion matrix:
       0     1
0  16478  1671
1    445   198
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8990093, 'precision': 0.57534873, 'recall': 0.65779823, 'specificity': 0.65779823, 'f1': 0.59585226, 'auroc': 0.8197119, 'binary_precision': 0.17850953, 'binary_recall': 0.394636, 'binary_specificity': 0.9209605, 'binary_f1_score': 0.2458234}
confusion matrix:
      0    1
0  5523  474
1   158  103
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-02 18:17:06.420919,epoch time: 0:18:46.372601,used: 0:38:06.985835,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_17_38_59_seed_0_24046977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.91363317, 'precision': 0.9182957, 'recall': 0.91367006, 'specificity': 0.91367006, 'f1': 0.91339695, 'auroc': 0.96824217, 'binary_precision': 0.9626325, 'binary_recall': 0.8608014, 'binary_specificity': 0.9665387, 'binary_f1_score': 0.90887356}
confusion matrix:
       0      1
0  27701    959
1   3995  24705
---- Validation: 
scalar performance:
{'acc': 0.8738293, 'precision': 0.5564449, 'recall': 0.6871613, 'specificity': 0.6871613, 'f1': 0.5701619, 'auroc': 0.816427, 'binary_precision': 0.13296516, 'binary_recall': 0.4867807, 'binary_specificity': 0.887542, 'binary_f1_score': 0.20887555}
confusion matrix:
       0     1
0  16108  2041
1    330   313
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8806328, 'precision': 0.5904544, 'recall': 0.7544855, 'specificity': 0.7544855, 'f1': 0.6179794, 'auroc': 0.8604053, 'binary_precision': 0.19925742, 'binary_recall': 0.61685824, 'binary_specificity': 0.89211273, 'binary_f1_score': 0.3012161}
confusion matrix:
      0    1
0  5350  647
1   100  161
early stop counter: 1
val acc:0.8738293051719666, best validation acc: 0.887398898601532, corresponding to test acc:                         0.8990092873573303 / 0.8990092873573303
after epoch: 3,now: 2024-08-02 18:35:58.618615,epoch time: 0:18:52.197696,used: 0:56:59.183531,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_17_38_59_seed_0_24046977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.92428523, 'precision': 0.9286761, 'recall': 0.9243206, 'specificity': 0.9243206, 'f1': 0.92409503, 'auroc': 0.9759947, 'binary_precision': 0.9722362, 'binary_recall': 0.87362367, 'binary_specificity': 0.9750174, 'binary_f1_score': 0.92029583}
confusion matrix:
       0      1
0  27944    716
1   3627  25073
---- Validation: 
scalar performance:
{'acc': 0.8693593, 'precision': 0.5644243, 'recall': 0.72910047, 'specificity': 0.72910047, 'f1': 0.5805876, 'auroc': 0.83779454, 'binary_precision': 0.14553991, 'binary_recall': 0.5785381, 'binary_specificity': 0.8796628, 'binary_f1_score': 0.23257266}
confusion matrix:
       0     1
0  15965  2184
1    271   372
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8676894, 'precision': 0.5936326, 'recall': 0.8008698, 'specificity': 0.8008698, 'f1': 0.62067354, 'auroc': 0.88464034, 'binary_precision': 0.20063359, 'binary_recall': 0.72796935, 'binary_specificity': 0.87377024, 'binary_f1_score': 0.31456953}
confusion matrix:
      0    1
0  5240  757
1    71  190
early stop counter: 2
val acc:0.8693593144416809, best validation acc: 0.887398898601532, corresponding to test acc:                         0.8990092873573303 / 0.8990092873573303
after epoch: 4,now: 2024-08-02 18:55:06.597918,epoch time: 0:19:07.979303,used: 1:16:07.162834,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_17_38_59_seed_0_24046977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9325488, 'precision': 0.9356444, 'recall': 0.93258125, 'specificity': 0.93258125, 'f1': 0.9324322, 'auroc': 0.98048663, 'binary_precision': 0.97255945, 'binary_recall': 0.89032125, 'binary_specificity': 0.97484124, 'binary_f1_score': 0.9296251}
confusion matrix:
       0      1
0  27937    721
1   3148  25554
---- Validation: 
scalar performance:
{'acc': 0.87074286, 'precision': 0.5696787, 'recall': 0.7500682, 'specificity': 0.7500682, 'f1': 0.5882948, 'auroc': 0.8527175, 'binary_precision': 0.15441176, 'binary_recall': 0.62052876, 'binary_specificity': 0.8796077, 'binary_f1_score': 0.24728851}
confusion matrix:
       0     1
0  15964  2185
1    244   399
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86545223, 'precision': 0.5981148, 'recall': 0.82718754, 'specificity': 0.82718754, 'f1': 0.6263623, 'auroc': 0.8954152, 'binary_precision': 0.20686175, 'binary_recall': 0.7854406, 'binary_specificity': 0.86893445, 'binary_f1_score': 0.32747605}
confusion matrix:
      0    1
0  5211  786
1    56  205
early stop counter: 3
val acc:0.8707428574562073, best validation acc: 0.887398898601532, corresponding to test acc:                         0.8990092873573303 / 0.8990092873573303
after epoch: 5,now: 2024-08-02 19:14:54.399631,epoch time: 0:19:47.801713,used: 1:35:54.964547,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_17_38_59_seed_0_24046977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.93746513, 'precision': 0.93967885, 'recall': 0.9374937, 'specificity': 0.9374937, 'f1': 0.9373891, 'auroc': 0.9821919, 'binary_precision': 0.9710781, 'binary_recall': 0.90189177, 'binary_specificity': 0.9730956, 'binary_f1_score': 0.93520707}
confusion matrix:
       0      1
0  27886    771
1   2816  25887
---- Validation: 
scalar performance:
{'acc': 0.8599404, 'precision': 0.56985235, 'recall': 0.7729777, 'specificity': 0.7729777, 'f1': 0.5860262, 'auroc': 0.8610815, 'binary_precision': 0.1526371, 'binary_recall': 0.67962676, 'binary_specificity': 0.8663287, 'binary_f1_score': 0.24928693}
confusion matrix:
       0     1
0  15723  2426
1    206   437
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8480345, 'precision': 0.5903898, 'recall': 0.83092594, 'specificity': 0.83092594, 'f1': 0.6115016, 'auroc': 0.9038594, 'binary_precision': 0.1903052, 'binary_recall': 0.8122605, 'binary_specificity': 0.84959143, 'binary_f1_score': 0.30836362}
confusion matrix:
      0    1
0  5095  902
1    49  212
early stop counter: 4
val acc:0.8599404096603394, best validation acc: 0.887398898601532, corresponding to test acc:                         0.8990092873573303 / 0.8990092873573303
after epoch: 6,now: 2024-08-02 19:34:51.106892,epoch time: 0:19:56.707261,used: 1:55:51.671808,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_17_38_59_seed_0_24046977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9430788, 'precision': 0.9450911, 'recall': 0.94310707, 'specificity': 0.94310707, 'f1': 0.9430169, 'auroc': 0.98429585, 'binary_precision': 0.97522885, 'binary_recall': 0.90935063, 'binary_specificity': 0.9768635, 'binary_f1_score': 0.9411383}
confusion matrix:
       0      1
0  27993    663
1   2602  26102
---- Validation: 
scalar performance:
{'acc': 0.8715943, 'precision': 0.5754753, 'recall': 0.7752608, 'specificity': 0.7752608, 'f1': 0.59666014, 'auroc': 0.86715245, 'binary_precision': 0.16400911, 'binary_recall': 0.6718507, 'binary_specificity': 0.878671, 'binary_f1_score': 0.26365578}
confusion matrix:
       0     1
0  15947  2202
1    211   432
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8579418, 'precision': 0.59680825, 'recall': 0.83975995, 'specificity': 0.83975995, 'f1': 0.6227995, 'auroc': 0.91017735, 'binary_precision': 0.20265152, 'binary_recall': 0.8199234, 'binary_specificity': 0.8595965, 'binary_f1_score': 0.32498103}
confusion matrix:
      0    1
0  5155  842
1    47  214
early stop counter: 5
val acc:0.8715943098068237, best validation acc: 0.887398898601532, corresponding to test acc:                         0.8990092873573303 / 0.8990092873573303
after epoch: 7,now: 2024-08-02 19:54:50.307617,epoch time: 0:19:59.200725,used: 2:15:50.872533,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_17_38_59_seed_0_24046977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.94499654, 'precision': 0.9465736, 'recall': 0.9450215, 'specificity': 0.9450215, 'f1': 0.94495, 'auroc': 0.98551035, 'binary_precision': 0.97332245, 'binary_recall': 0.91516864, 'binary_specificity': 0.9748744, 'binary_f1_score': 0.9433501}
confusion matrix:
       0      1
0  27936    720
1   2435  26269
---- Validation: 
scalar performance:
{'acc': 0.8663793, 'precision': 0.5743467, 'recall': 0.7815616, 'specificity': 0.7815616, 'f1': 0.5939, 'auroc': 0.8700683, 'binary_precision': 0.16110305, 'binary_recall': 0.6905132, 'binary_specificity': 0.87261003, 'binary_f1_score': 0.2612533}
confusion matrix:
       0     1
0  15837  2312
1    199   444
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84723556, 'precision': 0.59181345, 'recall': 0.8396708, 'specificity': 0.8396708, 'f1': 0.61315274, 'auroc': 0.9134433, 'binary_precision': 0.19220549, 'binary_recall': 0.8314176, 'binary_specificity': 0.84792393, 'binary_f1_score': 0.31223023}
confusion matrix:
      0    1
0  5085  912
1    44  217
early stop counter: 6
val acc:0.8663793206214905, best validation acc: 0.887398898601532, corresponding to test acc:                         0.8990092873573303 / 0.8990092873573303
after epoch: 8,now: 2024-08-02 20:15:31.905944,epoch time: 0:20:41.598327,used: 2:36:32.470860,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_17_38_59_seed_0_24046977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.94961643, 'precision': 0.9507842, 'recall': 0.94963694, 'specificity': 0.94963694, 'f1': 0.9495854, 'auroc': 0.98727167, 'binary_precision': 0.9739287, 'binary_recall': 0.92404974, 'binary_specificity': 0.9752242, 'binary_f1_score': 0.9483338}
confusion matrix:
       0      1
0  27947    710
1   2180  26523
---- Validation: 
scalar performance:
{'acc': 0.8516922, 'precision': 0.5714105, 'recall': 0.7972096, 'specificity': 0.7972096, 'f1': 0.5859367, 'auroc': 0.87502974, 'binary_precision': 0.15352295, 'binary_recall': 0.7387247, 'binary_specificity': 0.85569453, 'binary_f1_score': 0.2542146}
confusion matrix:
       0     1
0  15530  2619
1    168   475
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82917863, 'precision': 0.5833326, 'recall': 0.8320818, 'specificity': 0.8320818, 'f1': 0.5963082, 'auroc': 0.9151983, 'binary_precision': 0.17524116, 'binary_recall': 0.83524907, 'binary_specificity': 0.82891446, 'binary_f1_score': 0.289701}
confusion matrix:
      0     1
0  4971  1026
1    43   218
early stop counter: 7
val acc:0.8516921997070312, best validation acc: 0.887398898601532, corresponding to test acc:                         0.8990092873573303 / 0.8990092873573303
after epoch: 9,now: 2024-08-02 20:36:18.766589,epoch time: 0:20:46.860645,used: 2:57:19.331505,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_17_38_59_seed_0_24046977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9521792, 'precision': 0.9531284, 'recall': 0.9521977, 'specificity': 0.9521977, 'f1': 0.95215553, 'auroc': 0.9887519, 'binary_precision': 0.97406864, 'binary_recall': 0.92917114, 'binary_specificity': 0.9752242, 'binary_f1_score': 0.9510904}
confusion matrix:
       0      1
0  27947    710
1   2033  26670
---- Validation: 
scalar performance:
{'acc': 0.8594615, 'precision': 0.57453036, 'recall': 0.79748166, 'specificity': 0.79748166, 'f1': 0.5924134, 'auroc': 0.8732592, 'binary_precision': 0.15997277, 'binary_recall': 0.7309487, 'binary_specificity': 0.86401457, 'binary_f1_score': 0.2624965}
confusion matrix:
       0     1
0  15681  2468
1    173   470
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8347715, 'precision': 0.58626026, 'recall': 0.83683217, 'specificity': 0.83683217, 'f1': 0.6019644, 'auroc': 0.91810846, 'binary_precision': 0.18084228, 'binary_recall': 0.83908045, 'binary_specificity': 0.83458394, 'binary_f1_score': 0.29755434}
confusion matrix:
      0    1
0  5005  992
1    42  219
early stop counter: 8
val acc:0.8594614863395691, best validation acc: 0.887398898601532, corresponding to test acc:                         0.8990092873573303 / 0.8990092873573303
after epoch: 10,now: 2024-08-02 20:57:49.637528,epoch time: 0:21:30.870939,used: 3:18:50.202444,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_17_38_59_seed_0_24046977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9553696, 'precision': 0.9562093, 'recall': 0.95538545, 'specificity': 0.95538545, 'f1': 0.95535016, 'auroc': 0.9898063, 'binary_precision': 0.9759659, 'binary_recall': 0.9338002, 'binary_specificity': 0.9769706, 'binary_f1_score': 0.9544175}
confusion matrix:
       0      1
0  27999    660
1   1900  26801
---- Validation: 
scalar performance:
{'acc': 0.849404, 'precision': 0.5713369, 'recall': 0.8012754, 'specificity': 0.8012754, 'f1': 0.5851664, 'auroc': 0.87594974, 'binary_precision': 0.15296732, 'binary_recall': 0.7496112, 'binary_specificity': 0.85293955, 'binary_f1_score': 0.2540854}
confusion matrix:
       0     1
0  15480  2669
1    161   482
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8192713, 'precision': 0.58088183, 'recall': 0.8360742, 'specificity': 0.8360742, 'f1': 0.58971196, 'auroc': 0.92046475, 'binary_precision': 0.16945289, 'binary_recall': 0.8544061, 'binary_specificity': 0.8177422, 'binary_f1_score': 0.2828155}
confusion matrix:
      0     1
0  4904  1093
1    38   223
early stop counter: 9
val acc:0.849403977394104, best validation acc: 0.887398898601532, corresponding to test acc:                         0.8990092873573303 / 0.8990092873573303
after epoch: 11,now: 2024-08-02 21:18:31.405261,epoch time: 0:20:41.767733,used: 3:39:31.970177,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_17_38_59_seed_0_24046977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.95709556, 'precision': 0.9581009, 'recall': 0.9571161, 'specificity': 0.9571161, 'f1': 0.95707333, 'auroc': 0.99068093, 'binary_precision': 0.9797806, 'binary_recall': 0.93353075, 'binary_specificity': 0.98070145, 'binary_f1_score': 0.9560967}
confusion matrix:
       0      1
0  28102    553
1   1908  26797
---- Validation: 
scalar performance:
{'acc': 0.87207323, 'precision': 0.58026224, 'recall': 0.7972604, 'specificity': 0.7972604, 'f1': 0.60351825, 'auroc': 0.8766545, 'binary_precision': 0.1718226, 'binary_recall': 0.7169518, 'binary_specificity': 0.877569, 'binary_f1_score': 0.27720988}
confusion matrix:
       0     1
0  15927  2222
1    182   461
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8416427, 'precision': 0.590713, 'recall': 0.84591436, 'specificity': 0.84591436, 'f1': 0.6099876, 'auroc': 0.92100585, 'binary_precision': 0.1890971, 'binary_recall': 0.85057473, 'binary_specificity': 0.84125394, 'binary_f1_score': 0.30940765}
confusion matrix:
      0    1
0  5045  952
1    39  222
early stop counter: 10
val acc:0.872073233127594, best validation acc: 0.887398898601532, corresponding to test acc:                         0.8990092873573303 / 0.8990092873573303
after epoch: 12,now: 2024-08-02 21:39:09.070398,epoch time: 0:20:37.665137,used: 4:00:09.635314,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_17_38_59_seed_0_24046977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.95725244, 'precision': 0.95833755, 'recall': 0.95727205, 'specificity': 0.95727205, 'f1': 0.9572284, 'auroc': 0.9913176, 'binary_precision': 0.9808404, 'binary_recall': 0.93279445, 'binary_specificity': 0.98174965, 'binary_f1_score': 0.9562143}
confusion matrix:
       0      1
0  28134    523
1   1929  26774
---- Validation: 
scalar performance:
{'acc': 0.8777139, 'precision': 0.5816481, 'recall': 0.7896799, 'specificity': 0.7896799, 'f1': 0.60662866, 'auroc': 0.8781682, 'binary_precision': 0.17536288, 'binary_recall': 0.69517887, 'binary_specificity': 0.88418096, 'binary_f1_score': 0.2800752}
confusion matrix:
       0     1
0  16047  2102
1    196   447
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8493129, 'precision': 0.5940478, 'recall': 0.84625167, 'specificity': 0.84625167, 'f1': 0.6167229, 'auroc': 0.9218339, 'binary_precision': 0.19607843, 'binary_recall': 0.8429119, 'binary_specificity': 0.84959143, 'binary_f1_score': 0.31814894}
confusion matrix:
      0    1
0  5095  902
1    41  220
early stop counter: 11
val acc:0.8777139186859131, best validation acc: 0.887398898601532, corresponding to test acc:                         0.8990092873573303 / 0.8990092873573303
after epoch: 13,now: 2024-08-02 21:59:37.802659,epoch time: 0:20:28.732261,used: 4:20:38.367575,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_17_38_59_seed_0_24046977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9598675, 'precision': 0.9607111, 'recall': 0.9598818, 'specificity': 0.9598818, 'f1': 0.95985, 'auroc': 0.991781, 'binary_precision': 0.9805921, 'binary_recall': 0.9383602, 'binary_specificity': 0.9814033, 'binary_f1_score': 0.9590115}
confusion matrix:
       0      1
0  28128    533
1   1769  26930
---- Validation: 
scalar performance:
{'acc': 0.86579394, 'precision': 0.5769016, 'recall': 0.79550964, 'specificity': 0.79550964, 'f1': 0.5973403, 'auroc': 0.877911, 'binary_precision': 0.16506238, 'binary_recall': 0.7200622, 'binary_specificity': 0.8709571, 'binary_f1_score': 0.26856148}
confusion matrix:
       0     1
0  15807  2342
1    180   463
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8338127, 'precision': 0.58688754, 'recall': 0.84182894, 'specificity': 0.84182894, 'f1': 0.60246, 'auroc': 0.9214256, 'binary_precision': 0.18152085, 'binary_recall': 0.85057473, 'binary_specificity': 0.8330832, 'binary_f1_score': 0.29919136}
confusion matrix:
      0     1
0  4996  1001
1    39   222
early stop counter: 12
val acc:0.8657939434051514, best validation acc: 0.887398898601532, corresponding to test acc:                         0.8990092873573303 / 0.8990092873573303
after epoch: 14,now: 2024-08-02 22:19:55.242535,epoch time: 0:20:17.439876,used: 4:40:55.807451,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_17_38_59_seed_0_24046977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9616283, 'precision': 0.9621042, 'recall': 0.9616413, 'specificity': 0.9616413, 'f1': 0.96161914, 'auroc': 0.9917192, 'binary_precision': 0.97713524, 'binary_recall': 0.94544125, 'binary_specificity': 0.9778414, 'binary_f1_score': 0.961027}
confusion matrix:
       0      1
0  28022    635
1   1566  27137
---- Validation: 
scalar performance:
{'acc': 0.8803746, 'precision': 0.5845253, 'recall': 0.7963078, 'specificity': 0.7963078, 'f1': 0.61120516, 'auroc': 0.8782933, 'binary_precision': 0.18066056, 'binary_recall': 0.7060653, 'binary_specificity': 0.88655025, 'binary_f1_score': 0.28770596}
confusion matrix:
       0     1
0  16090  2059
1    189   454
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85778207, 'precision': 0.5985787, 'recall': 0.8488382, 'specificity': 0.8488382, 'f1': 0.6251349, 'auroc': 0.9230113, 'binary_precision': 0.20524836, 'binary_recall': 0.83908045, 'binary_specificity': 0.85859597, 'binary_f1_score': 0.3298193}
confusion matrix:
      0    1
0  5149  848
1    42  219
early stop counter: 13
val acc:0.8803746104240417, best validation acc: 0.887398898601532, corresponding to test acc:                         0.8990092873573303 / 0.8990092873573303
after epoch: 15,now: 2024-08-02 22:40:09.963676,epoch time: 0:20:14.721141,used: 5:01:10.528592,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_17_38_59_seed_0_24046977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9627964, 'precision': 0.9634546, 'recall': 0.9628123, 'specificity': 0.9628123, 'f1': 0.96278405, 'auroc': 0.99275255, 'binary_precision': 0.9811314, 'binary_recall': 0.94380575, 'binary_specificity': 0.9818188, 'binary_f1_score': 0.9621067}
confusion matrix:
       0      1
0  28135    521
1   1613  27091
---- Validation: 
scalar performance:
{'acc': 0.87414855, 'precision': 0.58184963, 'recall': 0.79983497, 'specificity': 0.79983497, 'f1': 0.6062045, 'auroc': 0.879608, 'binary_precision': 0.17484894, 'binary_recall': 0.7200622, 'binary_specificity': 0.8796077, 'binary_f1_score': 0.28137344}
confusion matrix:
       0     1
0  15964  2185
1    180   463
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8434004, 'precision': 0.59161556, 'recall': 0.84683144, 'specificity': 0.84683144, 'f1': 0.6117229, 'auroc': 0.92399263, 'binary_precision': 0.19088563, 'binary_recall': 0.85057473, 'binary_specificity': 0.8430882, 'binary_f1_score': 0.31179774}
confusion matrix:
      0    1
0  5056  941
1    39  222
early stop counter: 14
val acc:0.8741485476493835, best validation acc: 0.887398898601532, corresponding to test acc:                         0.8990092873573303 / 0.8990092873573303
after epoch: 16,now: 2024-08-02 23:00:00.140992,epoch time: 0:19:50.177316,used: 5:21:00.705908,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_17_38_59_seed_0_24046977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9643828, 'precision': 0.9648183, 'recall': 0.96439576, 'specificity': 0.96439576, 'f1': 0.96437514, 'auroc': 0.9934568, 'binary_precision': 0.9792558, 'binary_recall': 0.948927, 'binary_specificity': 0.9798646, 'binary_f1_score': 0.9638528}
confusion matrix:
       0      1
0  28079    577
1   1466  27238
---- Validation: 
scalar performance:
{'acc': 0.88271606, 'precision': 0.58504003, 'recall': 0.7922696, 'specificity': 0.7922696, 'f1': 0.6123316, 'auroc': 0.8774709, 'binary_precision': 0.1820774, 'binary_recall': 0.69517887, 'binary_specificity': 0.8893603, 'binary_f1_score': 0.28857327}
confusion matrix:
       0     1
0  16141  2008
1    196   447
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85938, 'precision': 0.5995574, 'recall': 0.84967196, 'specificity': 0.84967196, 'f1': 0.6268681, 'auroc': 0.92299795, 'binary_precision': 0.20719016, 'binary_recall': 0.83908045, 'binary_specificity': 0.86026347, 'binary_f1_score': 0.3323217}
confusion matrix:
      0    1
0  5159  838
1    42  219
early stop counter: 15
val acc:0.8827160596847534, best validation acc: 0.887398898601532, corresponding to test acc:                         0.8990092873573303 / 0.8990092873573303
after epoch: 17,now: 2024-08-02 23:19:04.238254,epoch time: 0:19:04.097262,used: 5:40:04.803170,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_17_38_59_seed_0_24046977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9672943, 'precision': 0.96753204, 'recall': 0.9673039, 'specificity': 0.9673039, 'f1': 0.96729064, 'auroc': 0.9941107, 'binary_precision': 0.9782857, 'binary_recall': 0.95585984, 'binary_specificity': 0.9787479, 'binary_f1_score': 0.9669428}
confusion matrix:
       0      1
0  28047    609
1   1267  27437
---- Validation: 
scalar performance:
{'acc': 0.8704768, 'precision': 0.5799086, 'recall': 0.7994341, 'specificity': 0.7994341, 'f1': 0.6026643, 'auroc': 0.8796191, 'binary_precision': 0.17089306, 'binary_recall': 0.7231726, 'binary_specificity': 0.87569565, 'binary_f1_score': 0.2764566}
confusion matrix:
       0     1
0  15893  2256
1    178   465
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8448386, 'precision': 0.59200317, 'recall': 0.8457495, 'specificity': 0.8457495, 'f1': 0.61267793, 'auroc': 0.9220306, 'binary_precision': 0.19184028, 'binary_recall': 0.8467433, 'binary_specificity': 0.8447557, 'binary_f1_score': 0.31280965}
confusion matrix:
      0    1
0  5066  931
1    40  221
early stop counter: 16
val acc:0.8704767823219299, best validation acc: 0.887398898601532, corresponding to test acc:                         0.8990092873573303 / 0.8990092873573303
after epoch: 18,now: 2024-08-02 23:38:14.548392,epoch time: 0:19:10.310138,used: 5:59:15.113308,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_17_38_59_seed_0_24046977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.96717227, 'precision': 0.9673458, 'recall': 0.9671798, 'specificity': 0.9671798, 'f1': 0.9671696, 'auroc': 0.9941914, 'binary_precision': 0.97654504, 'binary_recall': 0.9573897, 'binary_specificity': 0.9769698, 'binary_f1_score': 0.9668726}
confusion matrix:
       0      1
0  27998    660
1   1223  27479
---- Validation: 
scalar performance:
{'acc': 0.8663793, 'precision': 0.5784268, 'recall': 0.8018131, 'specificity': 0.8018131, 'f1': 0.5996184, 'auroc': 0.87757146, 'binary_precision': 0.16761565, 'binary_recall': 0.7325039, 'binary_specificity': 0.87112236, 'binary_f1_score': 0.27280626}
confusion matrix:
       0     1
0  15810  2339
1    172   471
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84100354, 'precision': 0.59111005, 'recall': 0.84924555, 'specificity': 0.84924555, 'f1': 0.61030304, 'auroc': 0.9229953, 'binary_precision': 0.1895093, 'binary_recall': 0.85823756, 'binary_specificity': 0.8402535, 'binary_f1_score': 0.3104643}
confusion matrix:
      0    1
0  5039  958
1    37  224
early stop counter: 17
val acc:0.8663793206214905, best validation acc: 0.887398898601532, corresponding to test acc:                         0.8990092873573303 / 0.8990092873573303
after epoch: 19,now: 2024-08-02 23:56:59.680401,epoch time: 0:18:45.132009,used: 6:18:00.245317,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_17_38_59_seed_0_24046977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9676081, 'precision': 0.96813166, 'recall': 0.96761924, 'specificity': 0.96761924, 'f1': 0.9675996, 'auroc': 0.9946567, 'binary_precision': 0.983953, 'binary_recall': 0.95076483, 'binary_specificity': 0.98447365, 'binary_f1_score': 0.9670742}
confusion matrix:
       0      1
0  28216    445
1   1413  27286
---- Validation: 
scalar performance:
{'acc': 0.9033631, 'precision': 0.59539396, 'recall': 0.77295667, 'specificity': 0.77295667, 'f1': 0.62877584, 'auroc': 0.8752967, 'binary_precision': 0.2048314, 'binary_recall': 0.63297045, 'binary_specificity': 0.9129429, 'binary_f1_score': 0.3095057}
confusion matrix:
       0     1
0  16569  1580
1    236   407
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8951742, 'precision': 0.6245362, 'recall': 0.8536893, 'specificity': 0.8536893, 'f1': 0.6670565, 'auroc': 0.9230037, 'binary_precision': 0.25826192, 'binary_recall': 0.8084291, 'binary_specificity': 0.8989495, 'binary_f1_score': 0.39146566}
confusion matrix:
      0    1
0  5391  606
1    50  211
better model found
persisted
after epoch: 20,now: 2024-08-03 00:15:27.053714,epoch time: 0:18:27.373313,used: 6:36:27.618630,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_17_38_59_seed_0_24046977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 6:36:27.618630 at 2024-08-03 00:15:27.053714
persisted model performance metric: 

scalar performance:
{'acc': 0.8951742, 'precision': 0.6245362, 'recall': 0.8536893, 'specificity': 0.8536893, 'f1': 0.6670565, 'auroc': 0.9230037, 'binary_precision': 0.25826192, 'binary_recall': 0.8084291, 'binary_specificity': 0.8989495, 'binary_f1_score': 0.39146566}
confusion matrix:
      0    1
0  5391  606
1    50  211
oracle model performance metric: 

scalar performance:
{'acc': 0.8990093, 'precision': 0.57534873, 'recall': 0.65779823, 'specificity': 0.65779823, 'f1': 0.59585226, 'auroc': 0.8197119, 'binary_precision': 0.17850953, 'binary_recall': 0.394636, 'binary_specificity': 0.9209605, 'binary_f1_score': 0.2458234}
confusion matrix:
      0    1
0  5523  474
1   158  103
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_halffreeze_seed3_2024-08-02_13-31-15/rule_results/1.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_halffreeze_seed3_2024-08-02_13-31-15/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_halffreeze_seed3_2024-08-02_13-31-15/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 198153 KiB |   7828 MiB | 478505 GiB | 478504 GiB |
|       from large pool | 180662 KiB |   7805 MiB | 471283 GiB | 471283 GiB |
|       from small pool |  17491 KiB |     37 MiB |   7221 GiB |   7221 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 198153 KiB |   7828 MiB | 478505 GiB | 478504 GiB |
|       from large pool | 180662 KiB |   7805 MiB | 471283 GiB | 471283 GiB |
|       from small pool |  17491 KiB |     37 MiB |   7221 GiB |   7221 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195461 KiB |   7827 MiB | 478478 GiB | 478478 GiB |
|       from large pool | 178979 KiB |   7804 MiB | 471273 GiB | 471273 GiB |
|       from small pool |  16482 KiB |     36 MiB |   7204 GiB |   7204 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8530 MiB |   8530 MiB |   8530 MiB |      0 B   |
|       from large pool |   8486 MiB |   8486 MiB |   8486 MiB |      0 B   |
|       from small pool |     44 MiB |     44 MiB |     44 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  59895 KiB | 732464 KiB | 269417 GiB | 269417 GiB |
|       from large pool |  50762 KiB | 730714 KiB | 262194 GiB | 262194 GiB |
|       from small pool |   9133 KiB |  11093 KiB |   7223 GiB |   7223 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2978    |    7665    |   92082 K  |   92079 K  |
|       from large pool |      79    |     762    |   44500 K  |   44500 K  |
|       from small pool |    2899    |    7584    |   47581 K  |   47578 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2978    |    7665    |   92082 K  |   92079 K  |
|       from large pool |      79    |     762    |   44500 K  |   44500 K  |
|       from small pool |    2899    |    7584    |   47581 K  |   47578 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     371    |     371    |     371    |       0    |
|       from large pool |     349    |     349    |     349    |       0    |
|       from small pool |      22    |      22    |      22    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      34    |    3606    |   53673 K  |   53673 K  |
|       from large pool |      10    |     350    |   33590 K  |   33590 K  |
|       from small pool |      24    |    3596    |   20083 K  |   20083 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB | 478505 GiB | 478505 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 471283 GiB | 471283 GiB |
|       from small pool |      0 KiB |     37 MiB |   7221 GiB |   7221 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB | 478505 GiB | 478505 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 471283 GiB | 471283 GiB |
|       from small pool |      0 KiB |     37 MiB |   7221 GiB |   7221 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB | 478478 GiB | 478478 GiB |
|       from large pool |  16640 KiB |   7804 MiB | 471273 GiB | 471273 GiB |
|       from small pool |      0 KiB |     36 MiB |   7204 GiB |   7204 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 258048 KiB |   8530 MiB |   8530 MiB |   8278 MiB |
|       from large pool | 231424 KiB |   8486 MiB |   8486 MiB |   8260 MiB |
|       from small pool |  26624 KiB |     44 MiB |     44 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB | 269417 GiB | 269417 GiB |
|       from large pool |  30464 KiB | 730714 KiB | 262194 GiB | 262194 GiB |
|       from small pool |      0 KiB |  23272 KiB |   7223 GiB |   7223 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7665    |   92082 K  |   92082 K  |
|       from large pool |       2    |     762    |   44500 K  |   44500 K  |
|       from small pool |       0    |    7584    |   47581 K  |   47581 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7665    |   92082 K  |   92082 K  |
|       from large pool |       2    |     762    |   44500 K  |   44500 K  |
|       from small pool |       0    |    7584    |   47581 K  |   47581 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |     371    |     371    |     347    |
|       from large pool |      11    |     349    |     349    |     338    |
|       from small pool |      13    |      22    |      22    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3606    |   53675 K  |   53675 K  |
|       from large pool |       3    |     350    |   33590 K  |   33590 K  |
|       from small pool |       0    |    3596    |   20084 K  |   20084 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB | 478505 GiB | 478505 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 471283 GiB | 471283 GiB |
|       from small pool |      0 KiB |     37 MiB |   7221 GiB |   7221 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB | 478505 GiB | 478505 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 471283 GiB | 471283 GiB |
|       from small pool |      0 KiB |     37 MiB |   7221 GiB |   7221 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB | 478478 GiB | 478478 GiB |
|       from large pool |  16640 KiB |   7804 MiB | 471273 GiB | 471273 GiB |
|       from small pool |      0 KiB |     36 MiB |   7204 GiB |   7204 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 258048 KiB |   8530 MiB |   8530 MiB |   8278 MiB |
|       from large pool | 231424 KiB |   8486 MiB |   8486 MiB |   8260 MiB |
|       from small pool |  26624 KiB |     44 MiB |     44 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB | 269417 GiB | 269417 GiB |
|       from large pool |  30464 KiB | 730714 KiB | 262194 GiB | 262194 GiB |
|       from small pool |      0 KiB |  23272 KiB |   7223 GiB |   7223 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7665    |   92082 K  |   92082 K  |
|       from large pool |       2    |     762    |   44500 K  |   44500 K  |
|       from small pool |       0    |    7584    |   47581 K  |   47581 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7665    |   92082 K  |   92082 K  |
|       from large pool |       2    |     762    |   44500 K  |   44500 K  |
|       from small pool |       0    |    7584    |   47581 K  |   47581 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |     371    |     371    |     347    |
|       from large pool |      11    |     349    |     349    |     338    |
|       from small pool |      13    |      22    |      22    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3606    |   53675 K  |   53675 K  |
|       from large pool |       3    |     350    |   33590 K  |   33590 K  |
|       from small pool |       0    |    3596    |   20084 K  |   20084 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_00_25_39_seed_1_24046977

 Experiment start at: 2024-08-03 00:25:39.984400
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.6474379897117615
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.8368162, 'precision': 0.8376255, 'recall': 0.83683395, 'specificity': 0.83683395, 'f1': 0.8367233, 'auroc': 0.90585935, 'binary_precision': 0.8543392, 'binary_recall': 0.81237644, 'binary_specificity': 0.8612915, 'binary_f1_score': 0.83282954}
confusion matrix:
       0      1
0  24794   3993
1   5409  23420
---- Validation: 
scalar performance:
{'acc': 0.8742796, 'precision': 0.50415623, 'recall': 0.51064473, 'specificity': 0.51064473, 'f1': 0.4981047, 'auroc': 0.7317909, 'binary_precision': 0.04340749, 'binary_recall': 0.11887073, 'binary_specificity': 0.9024188, 'binary_f1_score': 0.063593}
confusion matrix:
       0     1
0  16304  1763
1    593    80
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9025137, 'precision': 0.528031, 'recall': 0.5445484, 'specificity': 0.5445484, 'f1': 0.532599, 'auroc': 0.7977108, 'binary_precision': 0.09411765, 'binary_recall': 0.15384616, 'binary_specificity': 0.9352506, 'binary_f1_score': 0.11678832}
confusion matrix:
      0    1
0  5561  385
1   220   40
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-03 00:44:49.746193,epoch time: 0:19:09.761793,used: 0:19:09.761793,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_00_25_39_seed_1_24046977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.8900132, 'precision': 0.89554644, 'recall': 0.8900563, 'specificity': 0.8900563, 'f1': 0.88963497, 'auroc': 0.9458262, 'binary_precision': 0.942512, 'binary_recall': 0.8308647, 'binary_specificity': 0.9492479, 'binary_f1_score': 0.8831738}
confusion matrix:
       0      1
0  27326   1461
1   4876  23953
---- Validation: 
scalar performance:
{'acc': 0.89279616, 'precision': 0.52999943, 'recall': 0.56888604, 'specificity': 0.56888604, 'f1': 0.535651, 'auroc': 0.7858999, 'binary_precision': 0.09068628, 'binary_recall': 0.21991085, 'binary_specificity': 0.9178613, 'binary_f1_score': 0.1284165}
confusion matrix:
       0     1
0  16583  1484
1    525   148
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90976477, 'precision': 0.5532106, 'recall': 0.5832732, 'specificity': 0.5832732, 'f1': 0.5631584, 'auroc': 0.84189564, 'binary_precision': 0.14114833, 'binary_recall': 0.22692308, 'binary_specificity': 0.9396233, 'binary_f1_score': 0.17404132}
confusion matrix:
      0    1
0  5587  359
1   201   59
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-03 01:03:22.325650,epoch time: 0:18:32.579457,used: 0:37:42.341250,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_00_25_39_seed_1_24046977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.90999025, 'precision': 0.91366076, 'recall': 0.91002464, 'specificity': 0.91002464, 'f1': 0.90979517, 'auroc': 0.9612032, 'binary_precision': 0.9528096, 'binary_recall': 0.86284643, 'binary_specificity': 0.9572029, 'binary_f1_score': 0.9055993}
confusion matrix:
       0      1
0  27555   1232
1   3954  24875
---- Validation: 
scalar performance:
{'acc': 0.90240127, 'precision': 0.56616294, 'recall': 0.6561233, 'specificity': 0.6561233, 'f1': 0.5856417, 'auroc': 0.82239723, 'binary_precision': 0.15636148, 'binary_recall': 0.3907875, 'binary_specificity': 0.921459, 'binary_f1_score': 0.22335456}
confusion matrix:
       0     1
0  16648  1419
1    410   263
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91153723, 'precision': 0.5896202, 'recall': 0.66327465, 'specificity': 0.66327465, 'f1': 0.61191416, 'auroc': 0.86620486, 'binary_precision': 0.20689656, 'binary_recall': 0.3923077, 'binary_specificity': 0.93424153, 'binary_f1_score': 0.27091634}
confusion matrix:
      0    1
0  5555  391
1   158  102
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-03 01:21:52.382719,epoch time: 0:18:30.057069,used: 0:56:12.398319,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_00_25_39_seed_1_24046977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9218099, 'precision': 0.9257356, 'recall': 0.92184496, 'specificity': 0.92184496, 'f1': 0.9216336, 'auroc': 0.9718975, 'binary_precision': 0.96679974, 'binary_recall': 0.8737382, 'binary_specificity': 0.9699517, 'binary_f1_score': 0.9179163}
confusion matrix:
       0      1
0  27922    865
1   3640  25189
---- Validation: 
scalar performance:
{'acc': 0.9123799, 'precision': 0.58315605, 'recall': 0.6827565, 'specificity': 0.6827565, 'f1': 0.60821867, 'auroc': 0.84002614, 'binary_precision': 0.18842444, 'binary_recall': 0.43536404, 'binary_specificity': 0.9301489, 'binary_f1_score': 0.26301616}
confusion matrix:
       0     1
0  16805  1262
1    380   293
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91927165, 'precision': 0.618347, 'recall': 0.7188026, 'specificity': 0.7188026, 'f1': 0.6493276, 'auroc': 0.88156164, 'binary_precision': 0.25948104, 'binary_recall': 0.5, 'binary_specificity': 0.9376051, 'binary_f1_score': 0.3416557}
confusion matrix:
      0    1
0  5575  371
1   130  130
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-03 01:40:20.502439,epoch time: 0:18:28.119720,used: 1:14:40.518039,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_00_25_39_seed_1_24046977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.92909956, 'precision': 0.9333966, 'recall': 0.9291342, 'specificity': 0.9291342, 'f1': 0.9289272, 'auroc': 0.97727257, 'binary_precision': 0.97672534, 'binary_recall': 0.87924933, 'binary_specificity': 0.97901905, 'binary_f1_score': 0.9254276}
confusion matrix:
       0      1
0  28184    604
1   3481  25347
---- Validation: 
scalar performance:
{'acc': 0.9174493, 'precision': 0.5990782, 'recall': 0.7168573, 'specificity': 0.7168573, 'f1': 0.6297958, 'auroc': 0.8535677, 'binary_precision': 0.21770026, 'binary_recall': 0.5007429, 'binary_specificity': 0.9329717, 'binary_f1_score': 0.3034669}
confusion matrix:
       0     1
0  16856  1211
1    336   337
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9236223, 'precision': 0.63426876, 'recall': 0.75049675, 'specificity': 0.75049675, 'f1': 0.6702502, 'auroc': 0.8930289, 'binary_precision': 0.28853756, 'binary_recall': 0.56153846, 'binary_specificity': 0.9394551, 'binary_f1_score': 0.38120103}
confusion matrix:
      0    1
0  5586  360
1   114  146
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-03 01:58:46.384074,epoch time: 0:18:25.881635,used: 1:33:06.399674,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_00_25_39_seed_1_24046977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9375347, 'precision': 0.9390752, 'recall': 0.9375553, 'specificity': 0.9375553, 'f1': 0.9374819, 'auroc': 0.980879, 'binary_precision': 0.9652565, 'binary_recall': 0.9078327, 'binary_specificity': 0.967278, 'binary_f1_score': 0.93566436}
confusion matrix:
       0      1
0  27846    942
1   2657  26171
---- Validation: 
scalar performance:
{'acc': 0.9098186, 'precision': 0.6050629, 'recall': 0.7701212, 'specificity': 0.7701212, 'f1': 0.64104074, 'auroc': 0.86641455, 'binary_precision': 0.22528364, 'binary_recall': 0.61961365, 'binary_specificity': 0.9206288, 'binary_f1_score': 0.3304279}
confusion matrix:
       0     1
0  16633  1434
1    256   417
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91443765, 'precision': 0.63372916, 'recall': 0.8008733, 'specificity': 0.8008733, 'f1': 0.67629164, 'auroc': 0.9037711, 'binary_precision': 0.28250402, 'binary_recall': 0.6769231, 'binary_specificity': 0.9248234, 'binary_f1_score': 0.39864102}
confusion matrix:
      0    1
0  5499  447
1    84  176
early stop counter: 1
val acc:0.9098185896873474, best validation acc: 0.9174492955207825, corresponding to test acc:                         0.9236223101615906 / 0.9236223101615906
after epoch: 6,now: 2024-08-03 02:17:11.197111,epoch time: 0:18:24.813037,used: 1:51:31.212711,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_00_25_39_seed_1_24046977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.94354, 'precision': 0.9453278, 'recall': 0.9435643, 'specificity': 0.9435643, 'f1': 0.9434854, 'auroc': 0.98485327, 'binary_precision': 0.97373587, 'binary_recall': 0.9117586, 'binary_specificity': 0.97537, 'binary_f1_score': 0.94172865}
confusion matrix:
       0      1
0  28077    709
1   2544  26286
---- Validation: 
scalar performance:
{'acc': 0.915048, 'precision': 0.61229, 'recall': 0.7764097, 'specificity': 0.7764097, 'f1': 0.6505205, 'auroc': 0.8733283, 'binary_precision': 0.23936471, 'binary_recall': 0.62704307, 'binary_specificity': 0.9257763, 'binary_f1_score': 0.34646964}
confusion matrix:
       0     1
0  16726  1341
1    251   422
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9173381, 'precision': 0.63838696, 'recall': 0.8042258, 'specificity': 0.8042258, 'f1': 0.68193483, 'auroc': 0.91109604, 'binary_precision': 0.29159802, 'binary_recall': 0.6807692, 'binary_specificity': 0.92768246, 'binary_f1_score': 0.4083045}
confusion matrix:
      0    1
0  5516  430
1    83  177
early stop counter: 2
val acc:0.9150480031967163, best validation acc: 0.9174492955207825, corresponding to test acc:                         0.9236223101615906 / 0.9236223101615906
after epoch: 7,now: 2024-08-03 02:35:46.428938,epoch time: 0:18:35.231827,used: 2:10:06.444538,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_00_25_39_seed_1_24046977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9464906, 'precision': 0.94844556, 'recall': 0.94651353, 'specificity': 0.94651353, 'f1': 0.946434, 'auroc': 0.9869403, 'binary_precision': 0.97822934, 'binary_recall': 0.9133828, 'binary_specificity': 0.9796443, 'binary_f1_score': 0.9446946}
confusion matrix:
       0      1
0  28202    586
1   2497  26331
---- Validation: 
scalar performance:
{'acc': 0.9208111, 'precision': 0.61961585, 'recall': 0.77725273, 'specificity': 0.77725273, 'f1': 0.6593431, 'auroc': 0.8770571, 'binary_precision': 0.25409338, 'binary_recall': 0.6225854, 'binary_specificity': 0.93192005, 'binary_f1_score': 0.36089572}
confusion matrix:
       0     1
0  16837  1230
1    254   419
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9226555, 'precision': 0.64723146, 'recall': 0.8088398, 'specificity': 0.8088398, 'f1': 0.6921861, 'auroc': 0.91526425, 'binary_precision': 0.3090278, 'binary_recall': 0.6846154, 'binary_specificity': 0.9330642, 'binary_f1_score': 0.42583734}
confusion matrix:
      0    1
0  5548  398
1    82  178
better model found
persisted
after epoch: 8,now: 2024-08-03 02:54:19.298806,epoch time: 0:18:32.869868,used: 2:28:39.314406,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_00_25_39_seed_1_24046977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.94957995, 'precision': 0.95068055, 'recall': 0.9495981, 'specificity': 0.9495981, 'f1': 0.9495506, 'auroc': 0.98755383, 'binary_precision': 0.97313476, 'binary_recall': 0.92476326, 'binary_specificity': 0.9744329, 'binary_f1_score': 0.9483326}
confusion matrix:
       0      1
0  28051    736
1   2169  26660
---- Validation: 
scalar performance:
{'acc': 0.92278546, 'precision': 0.62619245, 'recall': 0.7932973, 'specificity': 0.7932973, 'f1': 0.66850317, 'auroc': 0.88465834, 'binary_precision': 0.26602176, 'binary_recall': 0.653789, 'binary_specificity': 0.93280566, 'binary_f1_score': 0.3781693}
confusion matrix:
       0     1
0  16853  1214
1    233   440
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9200773, 'precision': 0.6467562, 'recall': 0.82404524, 'specificity': 0.82404524, 'f1': 0.6934558, 'auroc': 0.9220568, 'binary_precision': 0.3065574, 'binary_recall': 0.7192308, 'binary_specificity': 0.9288597, 'binary_f1_score': 0.42988506}
confusion matrix:
      0    1
0  5523  423
1    73  187
better model found
persisted
after epoch: 9,now: 2024-08-03 03:12:50.667254,epoch time: 0:18:31.368448,used: 2:47:10.682854,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_00_25_39_seed_1_24046977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.95209664, 'precision': 0.95316535, 'recall': 0.95211357, 'specificity': 0.95211357, 'f1': 0.95206964, 'auroc': 0.9887806, 'binary_precision': 0.97534645, 'binary_recall': 0.92770916, 'binary_specificity': 0.976518, 'binary_f1_score': 0.95093155}
confusion matrix:
       0      1
0  28112    676
1   2084  26744
---- Validation: 
scalar performance:
{'acc': 0.9255603, 'precision': 0.6317055, 'recall': 0.7997433, 'specificity': 0.7997433, 'f1': 0.67546135, 'auroc': 0.8885994, 'binary_precision': 0.2766089, 'binary_recall': 0.6641902, 'binary_specificity': 0.9352964, 'binary_f1_score': 0.39056355}
confusion matrix:
       0     1
0  16898  1169
1    226   447
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91959393, 'precision': 0.65148526, 'recall': 0.8495388, 'specificity': 0.8495388, 'f1': 0.70141053, 'auroc': 0.9250556, 'binary_precision': 0.31357256, 'binary_recall': 0.77307695, 'binary_specificity': 0.92600065, 'binary_f1_score': 0.44617093}
confusion matrix:
      0    1
0  5506  440
1    59  201
better model found
persisted
after epoch: 10,now: 2024-08-03 03:31:23.533504,epoch time: 0:18:32.866250,used: 3:05:43.549104,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_00_25_39_seed_1_24046977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.95312065, 'precision': 0.95386356, 'recall': 0.9531355, 'specificity': 0.9531355, 'f1': 0.9531026, 'auroc': 0.989403, 'binary_precision': 0.97240907, 'binary_recall': 0.93277603, 'binary_specificity': 0.973495, 'binary_f1_score': 0.9521803}
confusion matrix:
       0      1
0  28024    763
1   1938  26891
---- Validation: 
scalar performance:
{'acc': 0.92070436, 'precision': 0.62791955, 'recall': 0.81296074, 'specificity': 0.81296074, 'f1': 0.67228717, 'auroc': 0.8938432, 'binary_precision': 0.26784694, 'binary_recall': 0.6968796, 'binary_specificity': 0.9290419, 'binary_f1_score': 0.38696367}
confusion matrix:
       0     1
0  16785  1282
1    204   469
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9087979, 'precision': 0.63930327, 'recall': 0.85677767, 'specificity': 0.85677767, 'f1': 0.6870532, 'auroc': 0.9291838, 'binary_precision': 0.28808865, 'binary_recall': 0.8, 'binary_specificity': 0.9135553, 'binary_f1_score': 0.4236253}
confusion matrix:
      0    1
0  5432  514
1    52  208
early stop counter: 1
val acc:0.9207043647766113, best validation acc: 0.9255602955818176, corresponding to test acc:                         0.9195939302444458 / 0.9236223101615906
after epoch: 11,now: 2024-08-03 03:49:53.761146,epoch time: 0:18:30.227642,used: 3:24:13.776746,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_00_25_39_seed_1_24046977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.95829284, 'precision': 0.9588335, 'recall': 0.9583061, 'specificity': 0.9583061, 'f1': 0.9582814, 'auroc': 0.9911753, 'binary_precision': 0.9747763, 'binary_recall': 0.940999, 'binary_specificity': 0.9756131, 'binary_f1_score': 0.95758986}
confusion matrix:
       0      1
0  28084    702
1   1701  27129
---- Validation: 
scalar performance:
{'acc': 0.9223052, 'precision': 0.6318584, 'recall': 0.8209437, 'specificity': 0.8209437, 'f1': 0.677665, 'auroc': 0.89648366, 'binary_precision': 0.27512923, 'binary_recall': 0.71173847, 'binary_specificity': 0.9301489, 'binary_f1_score': 0.3968517}
confusion matrix:
       0     1
0  16805  1262
1    194   479
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90799224, 'precision': 0.63983095, 'recall': 0.86371315, 'specificity': 0.86371315, 'f1': 0.6880588, 'auroc': 0.9323301, 'binary_precision': 0.28843537, 'binary_recall': 0.8153846, 'binary_specificity': 0.9120417, 'binary_f1_score': 0.42613068}
confusion matrix:
      0    1
0  5423  523
1    48  212
early stop counter: 2
val acc:0.9223052263259888, best validation acc: 0.9255602955818176, corresponding to test acc:                         0.9195939302444458 / 0.9236223101615906
after epoch: 12,now: 2024-08-03 04:08:21.334917,epoch time: 0:18:27.573771,used: 3:42:41.350517,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_00_25_39_seed_1_24046977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9585879, 'precision': 0.95902836, 'recall': 0.95859927, 'specificity': 0.95859927, 'f1': 0.9585787, 'auroc': 0.9917424, 'binary_precision': 0.97343075, 'binary_recall': 0.9429741, 'binary_specificity': 0.97422445, 'binary_f1_score': 0.9579604}
confusion matrix:
       0      1
0  28045    742
1   1644  27185
---- Validation: 
scalar performance:
{'acc': 0.9138741, 'precision': 0.62256604, 'recall': 0.8265848, 'specificity': 0.8265848, 'f1': 0.6664789, 'auroc': 0.89737475, 'binary_precision': 0.2558381, 'binary_recall': 0.73254085, 'binary_specificity': 0.9206288, 'binary_f1_score': 0.37923077}
confusion matrix:
       0     1
0  16633  1434
1    180   493
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8905898, 'precision': 0.6228012, 'recall': 0.86198735, 'specificity': 0.86198735, 'f1': 0.66437787, 'auroc': 0.93367493, 'binary_precision': 0.25381905, 'binary_recall': 0.83076924, 'binary_specificity': 0.8932055, 'binary_f1_score': 0.38883892}
confusion matrix:
      0    1
0  5311  635
1    44  216
early stop counter: 3
val acc:0.913874089717865, best validation acc: 0.9255602955818176, corresponding to test acc:                         0.9195939302444458 / 0.9236223101615906
after epoch: 13,now: 2024-08-03 04:26:50.138580,epoch time: 0:18:28.803663,used: 4:01:10.154180,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_00_25_39_seed_1_24046977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.95995903, 'precision': 0.96044445, 'recall': 0.95997095, 'specificity': 0.95997095, 'f1': 0.9599492, 'auroc': 0.9916152, 'binary_precision': 0.9755774, 'binary_recall': 0.94359845, 'binary_specificity': 0.9763435, 'binary_f1_score': 0.9593215}
confusion matrix:
       0      1
0  28106    681
1   1626  27203
---- Validation: 
scalar performance:
{'acc': 0.91254, 'precision': 0.62323034, 'recall': 0.83662194, 'specificity': 0.83662194, 'f1': 0.6678052, 'auroc': 0.897254, 'binary_precision': 0.25630677, 'binary_recall': 0.7548291, 'binary_specificity': 0.9184148, 'binary_f1_score': 0.38267422}
confusion matrix:
       0     1
0  16593  1474
1    165   508
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88462776, 'precision': 0.61748475, 'recall': 0.85887605, 'specificity': 0.85887605, 'f1': 0.65637064, 'auroc': 0.9349737, 'binary_precision': 0.24324325, 'binary_recall': 0.83076924, 'binary_specificity': 0.88698286, 'binary_f1_score': 0.37630662}
confusion matrix:
      0    1
0  5274  672
1    44  216
early stop counter: 4
val acc:0.9125400185585022, best validation acc: 0.9255602955818176, corresponding to test acc:                         0.9195939302444458 / 0.9236223101615906
after epoch: 14,now: 2024-08-03 04:45:27.349602,epoch time: 0:18:37.211022,used: 4:19:47.365202,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_00_25_39_seed_1_24046977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9605318, 'precision': 0.960618, 'recall': 0.9605369, 'specificity': 0.9605369, 'f1': 0.9605303, 'auroc': 0.992306, 'binary_precision': 0.9671064, 'binary_recall': 0.95355374, 'binary_specificity': 0.96752006, 'binary_f1_score': 0.96028227}
confusion matrix:
       0      1
0  27852    935
1   1339  27490
---- Validation: 
scalar performance:
{'acc': 0.91051227, 'precision': 0.62141585, 'recall': 0.83843136, 'specificity': 0.83843136, 'f1': 0.66545004, 'auroc': 0.89898443, 'binary_precision': 0.2524655, 'binary_recall': 0.76077265, 'binary_specificity': 0.91609013, 'binary_f1_score': 0.3791188}
confusion matrix:
       0     1
0  16551  1516
1    161   512
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88124394, 'precision': 0.6172999, 'recall': 0.8699831, 'specificity': 0.8699831, 'f1': 0.655687, 'auroc': 0.937453, 'binary_precision': 0.24160346, 'binary_recall': 0.8576923, 'binary_specificity': 0.8822738, 'binary_f1_score': 0.3770076}
confusion matrix:
      0    1
0  5246  700
1    37  223
early stop counter: 5
val acc:0.9105122685432434, best validation acc: 0.9255602955818176, corresponding to test acc:                         0.9195939302444458 / 0.9236223101615906
after epoch: 15,now: 2024-08-03 05:04:22.857964,epoch time: 0:18:55.508362,used: 4:38:42.873564,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_00_25_39_seed_1_24046977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9624236, 'precision': 0.9628509, 'recall': 0.9624348, 'specificity': 0.9624348, 'f1': 0.9624156, 'auroc': 0.9928951, 'binary_precision': 0.97709703, 'binary_recall': 0.9471019, 'binary_specificity': 0.97776777, 'binary_f1_score': 0.9618657}
confusion matrix:
       0      1
0  28147    640
1   1525  27304
---- Validation: 
scalar performance:
{'acc': 0.89925295, 'precision': 0.61184615, 'recall': 0.8440363, 'specificity': 0.8440363, 'f1': 0.6520141, 'auroc': 0.90016603, 'binary_precision': 0.2324967, 'binary_recall': 0.7845468, 'binary_specificity': 0.90352577, 'binary_f1_score': 0.35869566}
confusion matrix:
       0     1
0  16324  1743
1    145   528
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8641637, 'precision': 0.60478413, 'recall': 0.8610695, 'specificity': 0.8610695, 'f1': 0.6351079, 'auroc': 0.9377856, 'binary_precision': 0.21671526, 'binary_recall': 0.8576923, 'binary_specificity': 0.8644467, 'binary_f1_score': 0.34600466}
confusion matrix:
      0    1
0  5140  806
1    37  223
early stop counter: 6
val acc:0.8992529511451721, best validation acc: 0.9255602955818176, corresponding to test acc:                         0.9195939302444458 / 0.9236223101615906
after epoch: 16,now: 2024-08-03 05:23:26.188475,epoch time: 0:19:03.330511,used: 4:57:46.204075,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_00_25_39_seed_1_24046977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.96211123, 'precision': 0.96250564, 'recall': 0.96212196, 'specificity': 0.96212196, 'f1': 0.9621037, 'auroc': 0.9930159, 'binary_precision': 0.9761956, 'binary_recall': 0.94737935, 'binary_specificity': 0.9768646, 'binary_f1_score': 0.96157163}
confusion matrix:
       0      1
0  28121    666
1   1517  27312
---- Validation: 
scalar performance:
{'acc': 0.90496266, 'precision': 0.6177703, 'recall': 0.84771276, 'specificity': 0.84771276, 'f1': 0.66062665, 'auroc': 0.90080225, 'binary_precision': 0.24422899, 'binary_recall': 0.7860327, 'binary_specificity': 0.90939283, 'binary_f1_score': 0.37266645}
confusion matrix:
       0     1
0  16430  1637
1    144   529
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8739929, 'precision': 0.61128086, 'recall': 0.86436, 'specificity': 0.86436, 'f1': 0.64612234, 'auroc': 0.9382047, 'binary_precision': 0.22981367, 'binary_recall': 0.85384613, 'binary_specificity': 0.8748739, 'binary_f1_score': 0.36215335}
confusion matrix:
      0    1
0  5202  744
1    38  222
early stop counter: 7
val acc:0.9049626588821411, best validation acc: 0.9255602955818176, corresponding to test acc:                         0.9195939302444458 / 0.9236223101615906
after epoch: 17,now: 2024-08-03 05:42:26.870178,epoch time: 0:19:00.681703,used: 5:16:46.885778,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_00_25_39_seed_1_24046977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.96257985, 'precision': 0.96306944, 'recall': 0.96259123, 'specificity': 0.96259123, 'f1': 0.96257067, 'auroc': 0.9930747, 'binary_precision': 0.9783014, 'binary_recall': 0.94619817, 'binary_specificity': 0.9789843, 'binary_f1_score': 0.9619821}
confusion matrix:
       0      1
0  28183    605
1   1551  27277
---- Validation: 
scalar performance:
{'acc': 0.90955174, 'precision': 0.620904, 'recall': 0.8407943, 'specificity': 0.8407943, 'f1': 0.66483253, 'auroc': 0.900018, 'binary_precision': 0.25121713, 'binary_recall': 0.7667162, 'binary_specificity': 0.9148724, 'binary_f1_score': 0.3784378}
confusion matrix:
       0     1
0  16529  1538
1    157   516
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8785047, 'precision': 0.6143553, 'recall': 0.86487556, 'specificity': 0.86487556, 'f1': 0.6511699, 'auroc': 0.9379641, 'binary_precision': 0.2361111, 'binary_recall': 0.85, 'binary_specificity': 0.8797511, 'binary_f1_score': 0.36956522}
confusion matrix:
      0    1
0  5231  715
1    39  221
early stop counter: 8
val acc:0.909551739692688, best validation acc: 0.9255602955818176, corresponding to test acc:                         0.9195939302444458 / 0.9236223101615906
after epoch: 18,now: 2024-08-03 06:00:57.660934,epoch time: 0:18:30.790756,used: 5:35:17.676534,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_00_25_39_seed_1_24046977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9641072, 'precision': 0.9644948, 'recall': 0.9641178, 'specificity': 0.9641178, 'f1': 0.96410024, 'auroc': 0.99333835, 'binary_precision': 0.97809696, 'binary_recall': 0.94953, 'binary_specificity': 0.97870564, 'binary_f1_score': 0.96360177}
confusion matrix:
       0      1
0  28174    613
1   1455  27374
---- Validation: 
scalar performance:
{'acc': 0.89487725, 'precision': 0.6085061, 'recall': 0.8453433, 'specificity': 0.8453433, 'f1': 0.6469628, 'auroc': 0.89998853, 'binary_precision': 0.22556072, 'binary_recall': 0.7919762, 'binary_specificity': 0.89871037, 'binary_f1_score': 0.3511199}
confusion matrix:
       0     1
0  16237  1830
1    140   533
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85787946, 'precision': 0.60335726, 'recall': 0.87066287, 'specificity': 0.87066287, 'f1': 0.6315486, 'auroc': 0.9388423, 'binary_precision': 0.21256931, 'binary_recall': 0.88461536, 'binary_specificity': 0.8567104, 'binary_f1_score': 0.34277198}
confusion matrix:
      0    1
0  5094  852
1    30  230
early stop counter: 9
val acc:0.8948772549629211, best validation acc: 0.9255602955818176, corresponding to test acc:                         0.9195939302444458 / 0.9236223101615906
after epoch: 19,now: 2024-08-03 06:19:26.730714,epoch time: 0:18:29.069780,used: 5:53:46.746314,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_00_25_39_seed_1_24046977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9654436, 'precision': 0.9657582, 'recall': 0.9654536, 'specificity': 0.9654536, 'f1': 0.96543837, 'auroc': 0.99417233, 'binary_precision': 0.97805566, 'binary_recall': 0.9523066, 'binary_specificity': 0.9786007, 'binary_f1_score': 0.96500945}
confusion matrix:
       0      1
0  28170    616
1   1375  27455
---- Validation: 
scalar performance:
{'acc': 0.9096585, 'precision': 0.62177676, 'recall': 0.844426, 'specificity': 0.844426, 'f1': 0.66613036, 'auroc': 0.8997992, 'binary_precision': 0.2526673, 'binary_recall': 0.7741456, 'binary_specificity': 0.91470635, 'binary_f1_score': 0.3809872}
confusion matrix:
       0     1
0  16526  1541
1    152   521
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87238157, 'precision': 0.6108414, 'recall': 0.8671971, 'specificity': 0.8671971, 'f1': 0.6451994, 'auroc': 0.9378942, 'binary_precision': 0.22857143, 'binary_recall': 0.86153847, 'binary_specificity': 0.8728557, 'binary_f1_score': 0.3612903}
confusion matrix:
      0    1
0  5190  756
1    36  224
early stop counter: 10
val acc:0.9096584916114807, best validation acc: 0.9255602955818176, corresponding to test acc:                         0.9195939302444458 / 0.9236223101615906
after epoch: 20,now: 2024-08-03 06:37:55.507954,epoch time: 0:18:28.777240,used: 6:12:15.523554,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_00_25_39_seed_1_24046977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 6:12:15.523554 at 2024-08-03 06:37:55.507954
persisted model performance metric: 

scalar performance:
{'acc': 0.91959393, 'precision': 0.65148526, 'recall': 0.8495388, 'specificity': 0.8495388, 'f1': 0.70141053, 'auroc': 0.9250556, 'binary_precision': 0.31357256, 'binary_recall': 0.77307695, 'binary_specificity': 0.92600065, 'binary_f1_score': 0.44617093}
confusion matrix:
      0    1
0  5506  440
1    59  201
oracle model performance metric: 

scalar performance:
{'acc': 0.9236223, 'precision': 0.63426876, 'recall': 0.75049675, 'specificity': 0.75049675, 'f1': 0.6702502, 'auroc': 0.8930289, 'binary_precision': 0.28853756, 'binary_recall': 0.56153846, 'binary_specificity': 0.9394551, 'binary_f1_score': 0.38120103}
confusion matrix:
      0    1
0  5586  360
1   114  146
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_halffreeze_seed3_2024-08-02_13-31-15/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_halffreeze_seed3_2024-08-02_13-31-15/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 196690 KiB |   7828 MiB |    941 TiB |    941 TiB |
|       from large pool | 179211 KiB |   7805 MiB |    926 TiB |    926 TiB |
|       from small pool |  17479 KiB |     37 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 196690 KiB |   7828 MiB |    941 TiB |    941 TiB |
|       from large pool | 179211 KiB |   7805 MiB |    926 TiB |    926 TiB |
|       from small pool |  17479 KiB |     37 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195459 KiB |   7827 MiB |    941 TiB |    941 TiB |
|       from large pool | 178979 KiB |   7804 MiB |    926 TiB |    926 TiB |
|       from small pool |  16480 KiB |     36 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8512 MiB |   8530 MiB |  16790 MiB |   8278 MiB |
|       from large pool |   8472 MiB |   8486 MiB |  16732 MiB |   8260 MiB |
|       from small pool |     40 MiB |     44 MiB |     58 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  38830 KiB | 732464 KiB | 522212 GiB | 522212 GiB |
|       from large pool |  31733 KiB | 730714 KiB | 507687 GiB | 507687 GiB |
|       from small pool |   7097 KiB |  23272 KiB |  14524 GiB |  14524 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2954    |    7697    |  184999 K  |  184996 K  |
|       from large pool |      79    |     762    |   89600 K  |   89600 K  |
|       from small pool |    2875    |    7616    |   95399 K  |   95396 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2954    |    7697    |  184999 K  |  184996 K  |
|       from large pool |      79    |     762    |   89600 K  |   89600 K  |
|       from small pool |    2875    |    7616    |   95399 K  |   95396 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     368    |     371    |     715    |     347    |
|       from large pool |     348    |     349    |     686    |     338    |
|       from small pool |      20    |      22    |      29    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      35    |    3623    |  103503 K  |  103503 K  |
|       from large pool |      11    |     351    |   62532 K  |   62532 K  |
|       from small pool |      24    |    3613    |   40971 K  |   40971 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |    941 TiB |    941 TiB |
|       from large pool |  16640 KiB |   7805 MiB |    926 TiB |    926 TiB |
|       from small pool |      0 KiB |     37 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |    941 TiB |    941 TiB |
|       from large pool |  16640 KiB |   7805 MiB |    926 TiB |    926 TiB |
|       from small pool |      0 KiB |     37 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |    941 TiB |    941 TiB |
|       from large pool |  16640 KiB |   7804 MiB |    926 TiB |    926 TiB |
|       from small pool |      0 KiB |     36 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 235520 KiB |   8530 MiB |  16790 MiB |  16560 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  16732 MiB |  16526 MiB |
|       from small pool |  24576 KiB |     44 MiB |     58 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB | 522212 GiB | 522212 GiB |
|       from large pool |  30464 KiB | 730714 KiB | 507688 GiB | 507688 GiB |
|       from small pool |      0 KiB |  23272 KiB |  14524 GiB |  14524 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7697    |  184999 K  |  184999 K  |
|       from large pool |       2    |     762    |   89600 K  |   89600 K  |
|       from small pool |       0    |    7616    |   95399 K  |   95399 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7697    |  184999 K  |  184999 K  |
|       from large pool |       2    |     762    |   89600 K  |   89600 K  |
|       from small pool |       0    |    7616    |   95399 K  |   95399 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |     371    |     715    |     693    |
|       from large pool |      10    |     349    |     686    |     676    |
|       from small pool |      12    |      22    |      29    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3623    |  103505 K  |  103505 K  |
|       from large pool |       3    |     351    |   62532 K  |   62532 K  |
|       from small pool |       0    |    3613    |   40972 K  |   40972 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |    941 TiB |    941 TiB |
|       from large pool |  16640 KiB |   7805 MiB |    926 TiB |    926 TiB |
|       from small pool |      0 KiB |     37 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |    941 TiB |    941 TiB |
|       from large pool |  16640 KiB |   7805 MiB |    926 TiB |    926 TiB |
|       from small pool |      0 KiB |     37 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |    941 TiB |    941 TiB |
|       from large pool |  16640 KiB |   7804 MiB |    926 TiB |    926 TiB |
|       from small pool |      0 KiB |     36 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 235520 KiB |   8530 MiB |  16790 MiB |  16560 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  16732 MiB |  16526 MiB |
|       from small pool |  24576 KiB |     44 MiB |     58 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB | 522212 GiB | 522212 GiB |
|       from large pool |  30464 KiB | 730714 KiB | 507688 GiB | 507688 GiB |
|       from small pool |      0 KiB |  23272 KiB |  14524 GiB |  14524 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7697    |  184999 K  |  184999 K  |
|       from large pool |       2    |     762    |   89600 K  |   89600 K  |
|       from small pool |       0    |    7616    |   95399 K  |   95399 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7697    |  184999 K  |  184999 K  |
|       from large pool |       2    |     762    |   89600 K  |   89600 K  |
|       from small pool |       0    |    7616    |   95399 K  |   95399 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |     371    |     715    |     693    |
|       from large pool |      10    |     349    |     686    |     676    |
|       from small pool |      12    |      22    |      29    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3623    |  103505 K  |  103505 K  |
|       from large pool |       3    |     351    |   62532 K  |   62532 K  |
|       from small pool |       0    |    3613    |   40972 K  |   40972 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_06_47_33_seed_2_24046977

 Experiment start at: 2024-08-03 06:47:33.641977
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.754768431186676
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.86558384, 'precision': 0.86887443, 'recall': 0.86559194, 'specificity': 0.86559194, 'f1': 0.8652853, 'auroc': 0.9312414, 'binary_precision': 0.9037573, 'binary_recall': 0.81836265, 'binary_specificity': 0.91282123, 'binary_f1_score': 0.85894275}
confusion matrix:
       0      1
0  26606   2541
1   5296  23861
---- Validation: 
scalar performance:
{'acc': 0.8665637, 'precision': 0.54678357, 'recall': 0.6716869, 'specificity': 0.6716869, 'f1': 0.5547649, 'auroc': 0.74491763, 'binary_precision': 0.11336855, 'binary_recall': 0.46345514, 'binary_specificity': 0.8799186, 'binary_f1_score': 0.18217434}
confusion matrix:
       0     1
0  15989  2182
1    323   279
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.73248917, 'precision': 0.5019713, 'recall': 0.509902, 'specificity': 0.509902, 'f1': 0.45798713, 'auroc': 0.5397409, 'binary_precision': 0.041746948, 'binary_recall': 0.26859504, 'binary_specificity': 0.75120896, 'binary_f1_score': 0.07226237}
confusion matrix:
      0     1
0  4505  1492
1   177    65
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-03 07:06:37.619427,epoch time: 0:19:03.977450,used: 0:19:03.977450,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_06_47_33_seed_2_24046977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.90619856, 'precision': 0.90881157, 'recall': 0.9062067, 'specificity': 0.9062067, 'f1': 0.9060496, 'auroc': 0.9604084, 'binary_precision': 0.94154704, 'binary_recall': 0.86621165, 'binary_specificity': 0.94620186, 'binary_f1_score': 0.9023096}
confusion matrix:
       0      1
0  27578   1568
1   3901  25257
---- Validation: 
scalar performance:
{'acc': 0.91759443, 'precision': 0.5667821, 'recall': 0.6458494, 'specificity': 0.6458494, 'f1': 0.5866092, 'auroc': 0.7686467, 'binary_precision': 0.15586308, 'binary_recall': 0.3554817, 'binary_specificity': 0.93621707, 'binary_f1_score': 0.21670885}
confusion matrix:
       0     1
0  17012  1159
1    388   214
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85654753, 'precision': 0.5208923, 'recall': 0.56055504, 'specificity': 0.56055504, 'f1': 0.5183439, 'auroc': 0.6601758, 'binary_precision': 0.07542263, 'binary_recall': 0.23966943, 'binary_specificity': 0.8814407, 'binary_f1_score': 0.11473788}
confusion matrix:
      0    1
0  5286  711
1   184   58
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-03 07:25:11.687943,epoch time: 0:18:34.068516,used: 0:37:38.045966,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_06_47_33_seed_2_24046977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9227326, 'precision': 0.9260181, 'recall': 0.9227431, 'specificity': 0.9227431, 'f1': 0.92258453, 'auroc': 0.97091794, 'binary_precision': 0.9634907, 'binary_recall': 0.8788024, 'binary_specificity': 0.9666838, 'binary_f1_score': 0.9192}
confusion matrix:
       0      1
0  28174    971
1   3534  25625
---- Validation: 
scalar performance:
{'acc': 0.926064, 'precision': 0.57679564, 'recall': 0.64942145, 'specificity': 0.64942145, 'f1': 0.5979977, 'auroc': 0.78516793, 'binary_precision': 0.17574258, 'binary_recall': 0.3538206, 'binary_specificity': 0.9450223, 'binary_f1_score': 0.23484012}
confusion matrix:
       0    1
0  17172  999
1    389  213
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8730566, 'precision': 0.53522635, 'recall': 0.59293556, 'specificity': 0.59293556, 'f1': 0.5408097, 'auroc': 0.71767974, 'binary_precision': 0.10144927, 'binary_recall': 0.2892562, 'binary_specificity': 0.89661497, 'binary_f1_score': 0.15021458}
confusion matrix:
      0    1
0  5377  620
1   172   70
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-03 07:43:50.395944,epoch time: 0:18:38.708001,used: 0:56:16.753967,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_06_47_33_seed_2_24046977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9330406, 'precision': 0.93605804, 'recall': 0.93305063, 'specificity': 0.93305063, 'f1': 0.9329256, 'auroc': 0.97731924, 'binary_precision': 0.9723916, 'binary_recall': 0.89142287, 'binary_specificity': 0.97467834, 'binary_f1_score': 0.9301485}
confusion matrix:
       0      1
0  28407    738
1   3166  25993
---- Validation: 
scalar performance:
{'acc': 0.9322964, 'precision': 0.5910282, 'recall': 0.6654896, 'specificity': 0.6654896, 'f1': 0.61470354, 'auroc': 0.80532765, 'binary_precision': 0.20319432, 'binary_recall': 0.38039866, 'binary_specificity': 0.9505806, 'binary_f1_score': 0.264893}
confusion matrix:
       0    1
0  17273  898
1    373  229
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8810707, 'precision': 0.5537501, 'recall': 0.64072466, 'specificity': 0.64072466, 'f1': 0.56723636, 'auroc': 0.76855993, 'binary_precision': 0.13450292, 'binary_recall': 0.38016528, 'binary_specificity': 0.901284, 'binary_f1_score': 0.19870408}
confusion matrix:
      0    1
0  5405  592
1   150   92
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-03 08:02:28.242579,epoch time: 0:18:37.846635,used: 1:14:54.600602,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_06_47_33_seed_2_24046977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9369683, 'precision': 0.93893397, 'recall': 0.93697405, 'specificity': 0.93697405, 'f1': 0.93689823, 'auroc': 0.9806411, 'binary_precision': 0.96835023, 'binary_recall': 0.90348804, 'binary_specificity': 0.97046006, 'binary_f1_score': 0.9347953}
confusion matrix:
       0      1
0  28286    861
1   2814  26343
---- Validation: 
scalar performance:
{'acc': 0.93320197, 'precision': 0.5979714, 'recall': 0.6812153, 'specificity': 0.6812153, 'f1': 0.6241984, 'auroc': 0.8192328, 'binary_precision': 0.21602787, 'binary_recall': 0.41196012, 'binary_specificity': 0.9504705, 'binary_f1_score': 0.28342858}
confusion matrix:
       0    1
0  17271  900
1    354  248
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8826735, 'precision': 0.56891316, 'recall': 0.6891442, 'specificity': 0.6891442, 'f1': 0.5885446, 'auroc': 0.80527455, 'binary_precision': 0.16066483, 'binary_recall': 0.47933885, 'binary_specificity': 0.8989495, 'binary_f1_score': 0.24066392}
confusion matrix:
      0    1
0  5391  606
1   126  116
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-03 08:21:06.111906,epoch time: 0:18:37.869327,used: 1:33:32.469929,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_06_47_33_seed_2_24046977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9436574, 'precision': 0.9449053, 'recall': 0.9436637, 'specificity': 0.9436637, 'f1': 0.9436184, 'auroc': 0.98438215, 'binary_precision': 0.96852815, 'binary_recall': 0.91714394, 'binary_specificity': 0.97018355, 'binary_f1_score': 0.94213593}
confusion matrix:
       0      1
0  28276    869
1   2416  26743
---- Validation: 
scalar performance:
{'acc': 0.92979276, 'precision': 0.60391444, 'recall': 0.71639454, 'specificity': 0.71639454, 'f1': 0.6357593, 'auroc': 0.83058447, 'binary_precision': 0.22546013, 'binary_recall': 0.4883721, 'binary_specificity': 0.94441694, 'binary_f1_score': 0.3084995}
confusion matrix:
       0     1
0  17161  1010
1    308   294
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8692098, 'precision': 0.5724965, 'recall': 0.72972643, 'specificity': 0.72972643, 'f1': 0.59189117, 'auroc': 0.8323266, 'binary_precision': 0.16393442, 'binary_recall': 0.5785124, 'binary_specificity': 0.8809405, 'binary_f1_score': 0.25547445}
confusion matrix:
      0    1
0  5283  714
1   102  140
early stop counter: 1
val acc:0.9297927618026733, best validation acc: 0.9332019686698914, corresponding to test acc:                         0.8826735019683838 / 0.8826735019683838
after epoch: 6,now: 2024-08-03 08:39:47.350977,epoch time: 0:18:41.239071,used: 1:52:13.709000,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_06_47_33_seed_2_24046977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9493002, 'precision': 0.9504142, 'recall': 0.94930446, 'specificity': 0.94930446, 'f1': 0.9492692, 'auroc': 0.986863, 'binary_precision': 0.9728569, 'binary_recall': 0.9244092, 'binary_specificity': 0.9741998, 'binary_f1_score': 0.94801444}
confusion matrix:
       0      1
0  28395    752
1   2204  26953
---- Validation: 
scalar performance:
{'acc': 0.93069834, 'precision': 0.60612494, 'recall': 0.7192714, 'specificity': 0.7192714, 'f1': 0.6384819, 'auroc': 0.83494246, 'binary_precision': 0.22969837, 'binary_recall': 0.49335548, 'binary_specificity': 0.9451874, 'binary_f1_score': 0.31345645}
confusion matrix:
       0    1
0  17175  996
1    305  297
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86985093, 'precision': 0.5808644, 'recall': 0.7637665, 'specificity': 0.7637665, 'f1': 0.60366696, 'auroc': 0.8500655, 'binary_precision': 0.17760181, 'binary_recall': 0.6487603, 'binary_specificity': 0.87877274, 'binary_f1_score': 0.27886322}
confusion matrix:
      0    1
0  5270  727
1    85  157
early stop counter: 2
val acc:0.9306983351707458, best validation acc: 0.9332019686698914, corresponding to test acc:                         0.8826735019683838 / 0.8826735019683838
after epoch: 7,now: 2024-08-03 08:58:37.097656,epoch time: 0:18:49.746679,used: 2:11:03.455679,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_06_47_33_seed_2_24046977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9516843, 'precision': 0.95250666, 'recall': 0.95168793, 'specificity': 0.95168793, 'f1': 0.9516626, 'auroc': 0.98791206, 'binary_precision': 0.9718401, 'binary_recall': 0.9303426, 'binary_specificity': 0.97303325, 'binary_f1_score': 0.9506387}
confusion matrix:
       0      1
0  28361    786
1   2031  27126
---- Validation: 
scalar performance:
{'acc': 0.93682414, 'precision': 0.6147338, 'recall': 0.7136023, 'specificity': 0.7136023, 'f1': 0.64611506, 'auroc': 0.83922744, 'binary_precision': 0.24740484, 'binary_recall': 0.47508305, 'binary_specificity': 0.9521215, 'binary_f1_score': 0.32536972}
confusion matrix:
       0    1
0  17301  870
1    316  286
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88844365, 'precision': 0.5939709, 'recall': 0.7714553, 'specificity': 0.7714553, 'f1': 0.6244219, 'auroc': 0.86199504, 'binary_precision': 0.20365535, 'binary_recall': 0.6446281, 'binary_specificity': 0.89828247, 'binary_f1_score': 0.3095238}
confusion matrix:
      0    1
0  5387  610
1    86  156
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-08-03 09:17:31.997570,epoch time: 0:18:54.899914,used: 2:29:58.355593,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_06_47_33_seed_2_24046977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9553375, 'precision': 0.9563687, 'recall': 0.95534164, 'specificity': 0.95534164, 'f1': 0.9553126, 'auroc': 0.98935974, 'binary_precision': 0.97810507, 'binary_recall': 0.93154305, 'binary_specificity': 0.9791402, 'binary_f1_score': 0.9542564}
confusion matrix:
       0      1
0  28539    608
1   1996  27161
---- Validation: 
scalar performance:
{'acc': 0.9317637, 'precision': 0.615208, 'recall': 0.7455193, 'specificity': 0.7455193, 'f1': 0.651687, 'auroc': 0.84396625, 'binary_precision': 0.2460733, 'binary_recall': 0.54651165, 'binary_specificity': 0.944527, 'binary_f1_score': 0.33935016}
confusion matrix:
       0     1
0  17163  1008
1    273   329
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87449914, 'precision': 0.5902009, 'recall': 0.7939428, 'specificity': 0.7939428, 'f1': 0.61751574, 'auroc': 0.87022364, 'binary_precision': 0.19365798, 'binary_recall': 0.7066116, 'binary_specificity': 0.881274, 'binary_f1_score': 0.304}
confusion matrix:
      0    1
0  5285  712
1    71  171
early stop counter: 1
val acc:0.9317637085914612, best validation acc: 0.9368241429328918, corresponding to test acc:                         0.888443648815155 / 0.888443648815155
after epoch: 9,now: 2024-08-03 09:36:23.191107,epoch time: 0:18:51.193537,used: 2:48:49.549130,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_06_47_33_seed_2_24046977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.95636666, 'precision': 0.9573506, 'recall': 0.9563698, 'specificity': 0.9563698, 'f1': 0.9563434, 'auroc': 0.9901519, 'binary_precision': 0.97859865, 'binary_recall': 0.9331527, 'binary_specificity': 0.97958696, 'binary_f1_score': 0.95533556}
confusion matrix:
       0      1
0  28553    595
1   1949  27207
---- Validation: 
scalar performance:
{'acc': 0.9319768, 'precision': 0.61708933, 'recall': 0.75125074, 'specificity': 0.75125074, 'f1': 0.6544592, 'auroc': 0.8474605, 'binary_precision': 0.2494432, 'binary_recall': 0.55813956, 'binary_specificity': 0.9443619, 'binary_f1_score': 0.34479222}
confusion matrix:
       0     1
0  17160  1011
1    266   336
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8761019, 'precision': 0.59349895, 'recall': 0.80469024, 'specificity': 0.80469024, 'f1': 0.6224006, 'auroc': 0.8782601, 'binary_precision': 0.1993205, 'binary_recall': 0.72727275, 'binary_specificity': 0.88210773, 'binary_f1_score': 0.31288886}
confusion matrix:
      0    1
0  5290  707
1    66  176
early stop counter: 2
val acc:0.9319767951965332, best validation acc: 0.9368241429328918, corresponding to test acc:                         0.888443648815155 / 0.888443648815155
after epoch: 10,now: 2024-08-03 09:56:27.497196,epoch time: 0:20:04.306089,used: 3:08:53.855219,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_06_47_33_seed_2_24046977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.95897365, 'precision': 0.9595475, 'recall': 0.9589761, 'specificity': 0.9589761, 'f1': 0.958961, 'auroc': 0.99113715, 'binary_precision': 0.9758214, 'binary_recall': 0.9412814, 'binary_specificity': 0.9766708, 'binary_f1_score': 0.9582402}
confusion matrix:
       0      1
0  28468    680
1   1712  27444
---- Validation: 
scalar performance:
{'acc': 0.9256379, 'precision': 0.61004883, 'recall': 0.760022, 'specificity': 0.760022, 'f1': 0.6476114, 'auroc': 0.8511755, 'binary_precision': 0.23462567, 'binary_recall': 0.58305645, 'binary_specificity': 0.9369875, 'binary_f1_score': 0.33460435}
confusion matrix:
       0     1
0  17026  1145
1    251   351
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8724154, 'precision': 0.59557635, 'recall': 0.8245827, 'specificity': 0.8245827, 'f1': 0.6246327, 'auroc': 0.8876277, 'binary_precision': 0.20150863, 'binary_recall': 0.77272725, 'binary_specificity': 0.8764382, 'binary_f1_score': 0.3196581}
confusion matrix:
      0    1
0  5256  741
1    55  187
early stop counter: 3
val acc:0.9256379008293152, best validation acc: 0.9368241429328918, corresponding to test acc:                         0.888443648815155 / 0.888443648815155
after epoch: 11,now: 2024-08-03 10:16:06.390956,epoch time: 0:19:38.893760,used: 3:28:32.748979,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_06_47_33_seed_2_24046977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9609289, 'precision': 0.96153545, 'recall': 0.96093327, 'specificity': 0.96093327, 'f1': 0.96091634, 'auroc': 0.9923177, 'binary_precision': 0.9783266, 'binary_recall': 0.9427621, 'binary_specificity': 0.97910446, 'binary_f1_score': 0.96021515}
confusion matrix:
       0      1
0  28536    609
1   1669  27490
---- Validation: 
scalar performance:
{'acc': 0.92856765, 'precision': 0.6137217, 'recall': 0.7583232, 'specificity': 0.7583232, 'f1': 0.6516345, 'auroc': 0.8542824, 'binary_precision': 0.24214934, 'binary_recall': 0.57641196, 'binary_specificity': 0.9402344, 'binary_f1_score': 0.34103194}
confusion matrix:
       0     1
0  17085  1086
1    255   347
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8791473, 'precision': 0.6012256, 'recall': 0.83204997, 'specificity': 0.83204997, 'f1': 0.6337336, 'auroc': 0.8906471, 'binary_precision': 0.21235955, 'binary_recall': 0.78099173, 'binary_specificity': 0.8831082, 'binary_f1_score': 0.33392227}
confusion matrix:
      0    1
0  5296  701
1    53  189
early stop counter: 4
val acc:0.92856764793396, best validation acc: 0.9368241429328918, corresponding to test acc:                         0.888443648815155 / 0.888443648815155
after epoch: 12,now: 2024-08-03 10:34:56.168381,epoch time: 0:18:49.777425,used: 3:47:22.526404,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_06_47_33_seed_2_24046977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9613234, 'precision': 0.9621246, 'recall': 0.9613284, 'specificity': 0.9613284, 'f1': 0.9613069, 'auroc': 0.9921154, 'binary_precision': 0.9814258, 'binary_recall': 0.9404644, 'binary_specificity': 0.98219246, 'binary_f1_score': 0.9605086}
confusion matrix:
       0      1
0  28626    519
1   1736  27423
---- Validation: 
scalar performance:
{'acc': 0.9308049, 'precision': 0.61697817, 'recall': 0.7578728, 'specificity': 0.7578728, 'f1': 0.65518755, 'auroc': 0.85663277, 'binary_precision': 0.24873829, 'binary_recall': 0.5730897, 'binary_specificity': 0.94265586, 'binary_f1_score': 0.346908}
confusion matrix:
       0     1
0  17129  1042
1    257   345
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88235295, 'precision': 0.6032679, 'recall': 0.8317348, 'specificity': 0.8317348, 'f1': 0.6370858, 'auroc': 0.8930181, 'binary_precision': 0.21658987, 'binary_recall': 0.7768595, 'binary_specificity': 0.88661, 'binary_f1_score': 0.33873874}
confusion matrix:
      0    1
0  5317  680
1    54  188
early stop counter: 5
val acc:0.9308049082756042, best validation acc: 0.9368241429328918, corresponding to test acc:                         0.888443648815155 / 0.888443648815155
after epoch: 13,now: 2024-08-03 10:54:00.189209,epoch time: 0:19:04.020828,used: 4:06:26.547232,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_06_47_33_seed_2_24046977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9622839, 'precision': 0.96271586, 'recall': 0.96228653, 'specificity': 0.96228653, 'f1': 0.96227527, 'auroc': 0.9924625, 'binary_precision': 0.9768964, 'binary_recall': 0.9469767, 'binary_specificity': 0.97759634, 'binary_f1_score': 0.9617039}
confusion matrix:
       0      1
0  28494    653
1   1546  27611
---- Validation: 
scalar performance:
{'acc': 0.92286795, 'precision': 0.6079105, 'recall': 0.7658186, 'specificity': 0.7658186, 'f1': 0.64558697, 'auroc': 0.8607918, 'binary_precision': 0.22988506, 'binary_recall': 0.59800667, 'binary_specificity': 0.9336305, 'binary_f1_score': 0.3321033}
confusion matrix:
       0     1
0  16965  1206
1    242   360
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8701715, 'precision': 0.5961118, 'recall': 0.8333292, 'specificity': 0.8333292, 'f1': 0.6249125, 'auroc': 0.8973068, 'binary_precision': 0.20168068, 'binary_recall': 0.7933884, 'binary_specificity': 0.87327, 'binary_f1_score': 0.32160804}
confusion matrix:
      0    1
0  5237  760
1    50  192
early stop counter: 6
val acc:0.9228679537773132, best validation acc: 0.9368241429328918, corresponding to test acc:                         0.888443648815155 / 0.888443648815155
after epoch: 14,now: 2024-08-03 11:13:20.398757,epoch time: 0:19:20.209548,used: 4:25:46.756780,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_06_47_33_seed_2_24046977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.96312433, 'precision': 0.9636582, 'recall': 0.96312785, 'specificity': 0.96312785, 'f1': 0.9631139, 'auroc': 0.99284744, 'binary_precision': 0.9794433, 'binary_recall': 0.94612116, 'binary_specificity': 0.9801345, 'binary_f1_score': 0.9624939}
confusion matrix:
       0      1
0  28567    579
1   1571  27587
---- Validation: 
scalar performance:
{'acc': 0.93016565, 'precision': 0.61694515, 'recall': 0.7615578, 'specificity': 0.7615578, 'f1': 0.65559614, 'auroc': 0.86580396, 'binary_precision': 0.24840312, 'binary_recall': 0.5813953, 'binary_specificity': 0.9417203, 'binary_f1_score': 0.34808552}
confusion matrix:
       0     1
0  17112  1059
1    252   350
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8828338, 'precision': 0.6040635, 'recall': 0.83396757, 'specificity': 0.83396757, 'f1': 0.638275, 'auroc': 0.9004351, 'binary_precision': 0.21799308, 'binary_recall': 0.78099173, 'binary_specificity': 0.88694346, 'binary_f1_score': 0.3408476}
confusion matrix:
      0    1
0  5319  678
1    53  189
early stop counter: 7
val acc:0.9301656484603882, best validation acc: 0.9368241429328918, corresponding to test acc:                         0.888443648815155 / 0.888443648815155
after epoch: 15,now: 2024-08-03 11:33:39.460795,epoch time: 0:20:19.062038,used: 4:46:05.818818,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_06_47_33_seed_2_24046977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.96470225, 'precision': 0.9651409, 'recall': 0.96470547, 'specificity': 0.96470547, 'f1': 0.9646941, 'auroc': 0.993224, 'binary_precision': 0.9794763, 'binary_recall': 0.94931066, 'binary_specificity': 0.9801002, 'binary_f1_score': 0.9641576}
confusion matrix:
       0      1
0  28566    580
1   1478  27680
---- Validation: 
scalar performance:
{'acc': 0.93570554, 'precision': 0.62668073, 'recall': 0.76361644, 'specificity': 0.76361644, 'f1': 0.6662693, 'auroc': 0.8676075, 'binary_precision': 0.26784343, 'binary_recall': 0.5797342, 'binary_specificity': 0.94749874, 'binary_f1_score': 0.36640418}
confusion matrix:
       0    1
0  17217  954
1    253  349
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8983812, 'precision': 0.6174607, 'recall': 0.8400723, 'specificity': 0.8400723, 'f1': 0.6584965, 'auroc': 0.9032774, 'binary_precision': 0.24479167, 'binary_recall': 0.7768595, 'binary_specificity': 0.90328497, 'binary_f1_score': 0.37227726}
confusion matrix:
      0    1
0  5417  580
1    54  188
new oracle model saved
early stop counter: 8
val acc:0.9357055425643921, best validation acc: 0.9368241429328918, corresponding to test acc:                         0.888443648815155 / 0.8983811736106873
after epoch: 16,now: 2024-08-03 11:53:59.535738,epoch time: 0:20:20.074943,used: 5:06:25.893761,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_06_47_33_seed_2_24046977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.96370745, 'precision': 0.9644203, 'recall': 0.9637102, 'specificity': 0.9637102, 'f1': 0.9636937, 'auroc': 0.9936663, 'binary_precision': 0.9826503, 'binary_recall': 0.9440938, 'binary_specificity': 0.9833265, 'binary_f1_score': 0.9629863}
confusion matrix:
       0      1
0  28662    486
1   1630  27526
---- Validation: 
scalar performance:
{'acc': 0.9322964, 'precision': 0.6216163, 'recall': 0.76667374, 'specificity': 0.76667374, 'f1': 0.66133374, 'auroc': 0.8710441, 'binary_precision': 0.2574329, 'binary_recall': 0.589701, 'binary_specificity': 0.9436465, 'binary_f1_score': 0.35840484}
confusion matrix:
       0     1
0  17147  1024
1    247   355
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8910082, 'precision': 0.61134076, 'recall': 0.84020245, 'specificity': 0.84020245, 'f1': 0.64946777, 'auroc': 0.90505934, 'binary_precision': 0.23227383, 'binary_recall': 0.78512394, 'binary_specificity': 0.89528096, 'binary_f1_score': 0.35849056}
confusion matrix:
      0    1
0  5369  628
1    52  190
early stop counter: 9
val acc:0.9322963953018188, best validation acc: 0.9368241429328918, corresponding to test acc:                         0.888443648815155 / 0.8983811736106873
after epoch: 17,now: 2024-08-03 12:13:52.111990,epoch time: 0:19:52.576252,used: 5:26:18.470013,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_06_47_33_seed_2_24046977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9658514, 'precision': 0.9664848, 'recall': 0.96585524, 'specificity': 0.96585524, 'f1': 0.96584, 'auroc': 0.9945029, 'binary_precision': 0.98372567, 'binary_recall': 0.9473901, 'binary_specificity': 0.98432034, 'binary_f1_score': 0.96521604}
confusion matrix:
       0      1
0  28689    457
1   1534  27624
---- Validation: 
scalar performance:
{'acc': 0.9308049, 'precision': 0.61904335, 'recall': 0.76590323, 'specificity': 0.76590323, 'f1': 0.6584281, 'auroc': 0.86968327, 'binary_precision': 0.2523099, 'binary_recall': 0.589701, 'binary_specificity': 0.94210553, 'binary_f1_score': 0.35340968}
confusion matrix:
       0     1
0  17119  1052
1    247   355
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8916493, 'precision': 0.611915, 'recall': 0.840536, 'specificity': 0.840536, 'f1': 0.6503322, 'auroc': 0.90563536, 'binary_precision': 0.23341523, 'binary_recall': 0.78512394, 'binary_specificity': 0.895948, 'binary_f1_score': 0.35984847}
confusion matrix:
      0    1
0  5373  624
1    52  190
early stop counter: 10
val acc:0.9308049082756042, best validation acc: 0.9368241429328918, corresponding to test acc:                         0.888443648815155 / 0.8983811736106873
after epoch: 18,now: 2024-08-03 12:33:35.928286,epoch time: 0:19:43.816296,used: 5:46:02.286309,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_06_47_33_seed_2_24046977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9683212, 'precision': 0.968616, 'recall': 0.96832293, 'specificity': 0.96832293, 'f1': 0.9683163, 'auroc': 0.99488556, 'binary_precision': 0.9804032, 'binary_recall': 0.95575523, 'binary_specificity': 0.98089063, 'binary_f1_score': 0.96792233}
confusion matrix:
       0      1
0  28591    557
1   1290  27866
---- Validation: 
scalar performance:
{'acc': 0.9284611, 'precision': 0.61681676, 'recall': 0.771117, 'specificity': 0.771117, 'f1': 0.6565193, 'auroc': 0.8708477, 'binary_precision': 0.24744377, 'binary_recall': 0.60299003, 'binary_specificity': 0.93924385, 'binary_f1_score': 0.35089412}
confusion matrix:
       0     1
0  17067  1104
1    239   363
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88171184, 'precision': 0.6040134, 'recall': 0.8373495, 'specificity': 0.8373495, 'f1': 0.6380476, 'auroc': 0.9064622, 'binary_precision': 0.21753986, 'binary_recall': 0.7892562, 'binary_specificity': 0.88544273, 'binary_f1_score': 0.3410714}
confusion matrix:
      0    1
0  5310  687
1    51  191
early stop counter: 11
val acc:0.9284610748291016, best validation acc: 0.9368241429328918, corresponding to test acc:                         0.888443648815155 / 0.8983811736106873
after epoch: 19,now: 2024-08-03 12:53:09.636949,epoch time: 0:19:33.708663,used: 6:05:35.994972,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_06_47_33_seed_2_24046977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9694189, 'precision': 0.96958494, 'recall': 0.96942085, 'specificity': 0.96942085, 'f1': 0.96941626, 'auroc': 0.9949367, 'binary_precision': 0.9784668, 'binary_recall': 0.9599767, 'binary_specificity': 0.978865, 'binary_f1_score': 0.96913356}
confusion matrix:
       0      1
0  28530    616
1   1167  27991
---- Validation: 
scalar performance:
{'acc': 0.9237735, 'precision': 0.6134968, 'recall': 0.7839534, 'specificity': 0.7839534, 'f1': 0.653792, 'auroc': 0.87465304, 'binary_precision': 0.23979913, 'binary_recall': 0.63455147, 'binary_specificity': 0.93335533, 'binary_f1_score': 0.3480638}
confusion matrix:
       0     1
0  16960  1211
1    220   382
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8735374, 'precision': 0.59840506, 'recall': 0.8350801, 'specificity': 0.8350801, 'f1': 0.6287868, 'auroc': 0.908047, 'binary_precision': 0.20622987, 'binary_recall': 0.7933884, 'binary_specificity': 0.87677175, 'binary_f1_score': 0.32736573}
confusion matrix:
      0    1
0  5258  739
1    50  192
early stop counter: 12
val acc:0.9237735271453857, best validation acc: 0.9368241429328918, corresponding to test acc:                         0.888443648815155 / 0.8983811736106873
after epoch: 20,now: 2024-08-03 13:13:40.831325,epoch time: 0:20:31.194376,used: 6:26:07.189348,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_06_47_33_seed_2_24046977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 6:26:07.189348 at 2024-08-03 13:13:40.831325
persisted model performance metric: 

scalar performance:
{'acc': 0.88844365, 'precision': 0.5939709, 'recall': 0.7714553, 'specificity': 0.7714553, 'f1': 0.6244219, 'auroc': 0.86199504, 'binary_precision': 0.20365535, 'binary_recall': 0.6446281, 'binary_specificity': 0.89828247, 'binary_f1_score': 0.3095238}
confusion matrix:
      0    1
0  5387  610
1    86  156
oracle model performance metric: 

scalar performance:
{'acc': 0.8983812, 'precision': 0.6174607, 'recall': 0.8400723, 'specificity': 0.8400723, 'f1': 0.6584965, 'auroc': 0.9032774, 'binary_precision': 0.24479167, 'binary_recall': 0.7768595, 'binary_specificity': 0.90328497, 'binary_f1_score': 0.37227726}
confusion matrix:
      0    1
0  5417  580
1    54  188
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_halffreeze_seed3_2024-08-02_13-31-15/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_halffreeze_seed3_2024-08-02_13-31-15/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 196696 KiB |   7828 MiB |   1433 TiB |   1433 TiB |
|       from large pool | 179211 KiB |   7805 MiB |   1412 TiB |   1412 TiB |
|       from small pool |  17485 KiB |     37 MiB |     21 TiB |     21 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 196696 KiB |   7828 MiB |   1433 TiB |   1433 TiB |
|       from large pool | 179211 KiB |   7805 MiB |   1412 TiB |   1412 TiB |
|       from small pool |  17485 KiB |     37 MiB |     21 TiB |     21 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195460 KiB |   7827 MiB |   1433 TiB |   1433 TiB |
|       from large pool | 178979 KiB |   7804 MiB |   1412 TiB |   1412 TiB |
|       from small pool |  16481 KiB |     36 MiB |     21 TiB |     21 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8512 MiB |   8530 MiB |  25072 MiB |  16560 MiB |
|       from large pool |   8472 MiB |   8486 MiB |  24998 MiB |  16526 MiB |
|       from small pool |     40 MiB |     44 MiB |     74 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  40872 KiB | 732464 KiB | 784860 GiB | 784860 GiB |
|       from large pool |  31733 KiB | 730714 KiB | 762850 GiB | 762850 GiB |
|       from small pool |   9139 KiB |  23272 KiB |  22009 GiB |  22009 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2966    |    7783    |  280480 K  |  280477 K  |
|       from large pool |      79    |     762    |  136427 K  |  136426 K  |
|       from small pool |    2887    |    7702    |  144053 K  |  144050 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2966    |    7783    |  280480 K  |  280477 K  |
|       from large pool |      79    |     762    |  136427 K  |  136426 K  |
|       from small pool |    2887    |    7702    |  144053 K  |  144050 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     368    |     371    |    1061    |     693    |
|       from large pool |     348    |     349    |    1024    |     676    |
|       from small pool |      20    |      22    |      37    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      35    |    3667    |  154247 K  |  154247 K  |
|       from large pool |      11    |     351    |   92769 K  |   92769 K  |
|       from small pool |      24    |    3657    |   61478 K  |   61478 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |   1433 TiB |   1433 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   1412 TiB |   1412 TiB |
|       from small pool |      0 KiB |     37 MiB |     21 TiB |     21 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |   1433 TiB |   1433 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   1412 TiB |   1412 TiB |
|       from small pool |      0 KiB |     37 MiB |     21 TiB |     21 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |   1433 TiB |   1433 TiB |
|       from large pool |  16640 KiB |   7804 MiB |   1412 TiB |   1412 TiB |
|       from small pool |      0 KiB |     36 MiB |     21 TiB |     21 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 237568 KiB |   8530 MiB |  25072 MiB |  24840 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  24998 MiB |  24792 MiB |
|       from small pool |  26624 KiB |     44 MiB |     74 MiB |     48 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB | 784860 GiB | 784860 GiB |
|       from large pool |  30464 KiB | 730714 KiB | 762850 GiB | 762850 GiB |
|       from small pool |      0 KiB |  23272 KiB |  22009 GiB |  22009 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7783    |  280480 K  |  280480 K  |
|       from large pool |       2    |     762    |  136427 K  |  136427 K  |
|       from small pool |       0    |    7702    |  144053 K  |  144053 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7783    |  280480 K  |  280480 K  |
|       from large pool |       2    |     762    |  136427 K  |  136427 K  |
|       from small pool |       0    |    7702    |  144053 K  |  144053 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |     371    |    1061    |    1038    |
|       from large pool |      10    |     349    |    1024    |    1014    |
|       from small pool |      13    |      22    |      37    |      24    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3667    |  154248 K  |  154248 K  |
|       from large pool |       3    |     351    |   92769 K  |   92769 K  |
|       from small pool |       0    |    3657    |   61479 K  |   61479 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |   1433 TiB |   1433 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   1412 TiB |   1412 TiB |
|       from small pool |      0 KiB |     37 MiB |     21 TiB |     21 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |   1433 TiB |   1433 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   1412 TiB |   1412 TiB |
|       from small pool |      0 KiB |     37 MiB |     21 TiB |     21 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |   1433 TiB |   1433 TiB |
|       from large pool |  16640 KiB |   7804 MiB |   1412 TiB |   1412 TiB |
|       from small pool |      0 KiB |     36 MiB |     21 TiB |     21 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 237568 KiB |   8530 MiB |  25072 MiB |  24840 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  24998 MiB |  24792 MiB |
|       from small pool |  26624 KiB |     44 MiB |     74 MiB |     48 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB | 784860 GiB | 784860 GiB |
|       from large pool |  30464 KiB | 730714 KiB | 762850 GiB | 762850 GiB |
|       from small pool |      0 KiB |  23272 KiB |  22009 GiB |  22009 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7783    |  280480 K  |  280480 K  |
|       from large pool |       2    |     762    |  136427 K  |  136427 K  |
|       from small pool |       0    |    7702    |  144053 K  |  144053 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7783    |  280480 K  |  280480 K  |
|       from large pool |       2    |     762    |  136427 K  |  136427 K  |
|       from small pool |       0    |    7702    |  144053 K  |  144053 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |     371    |    1061    |    1038    |
|       from large pool |      10    |     349    |    1024    |    1014    |
|       from small pool |      13    |      22    |      37    |      24    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3667    |  154248 K  |  154248 K  |
|       from large pool |       3    |     351    |   92769 K  |   92769 K  |
|       from small pool |       0    |    3657    |   61479 K  |   61479 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_13_24_14_seed_3_24046977

 Experiment start at: 2024-08-03 13:24:14.268797
before training, model accuracy: 0.7207813262939453
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.8588743, 'precision': 0.8667737, 'recall': 0.85894084, 'specificity': 0.85894084, 'f1': 0.85812616, 'auroc': 0.9344382, 'binary_precision': 0.9208272, 'binary_recall': 0.7855453, 'binary_specificity': 0.93233633, 'binary_f1_score': 0.8478236}
confusion matrix:
       0      1
0  26745   1941
1   6163  22575
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.90979767, 'precision': 0.51191664, 'recall': 0.52150124, 'specificity': 0.52150124, 'f1': 0.51294786, 'auroc': 0.637403, 'binary_precision': 0.056349874, 'binary_recall': 0.10485133, 'binary_specificity': 0.9381511, 'binary_f1_score': 0.073304154}
confusion matrix:
       0     1
0  17019  1122
1    572    67
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92683315, 'precision': 0.5570273, 'recall': 0.55104446, 'specificity': 0.55104446, 'f1': 0.55378705, 'auroc': 0.5820986, 'binary_precision': 0.15476191, 'binary_recall': 0.13780919, 'binary_specificity': 0.9642797, 'binary_f1_score': 0.14579439}
confusion matrix:
      0    1
0  5750  213
1   244   39
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-03 13:44:49.483584,epoch time: 0:20:35.214787,used: 0:20:35.214787,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_13_24_14_seed_3_24046977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.89683753, 'precision': 0.9031248, 'recall': 0.89689636, 'specificity': 0.89689636, 'f1': 0.89644355, 'auroc': 0.9611391, 'binary_precision': 0.95370483, 'binary_recall': 0.8343714, 'binary_specificity': 0.9594213, 'binary_f1_score': 0.8900561}
confusion matrix:
       0      1
0  27521   1164
1   4760  23979
---- Validation: 
scalar performance:
{'acc': 0.9120341, 'precision': 0.5469103, 'recall': 0.5943754, 'specificity': 0.5943754, 'f1': 0.55877113, 'auroc': 0.726633, 'binary_precision': 0.12116679, 'binary_recall': 0.2535211, 'binary_specificity': 0.9352296, 'binary_f1_score': 0.16396761}
confusion matrix:
       0     1
0  16966  1175
1    477   162
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9284342, 'precision': 0.58583057, 'recall': 0.58554167, 'specificity': 0.58554167, 'f1': 0.5856858, 'auroc': 0.72502875, 'binary_precision': 0.20921986, 'binary_recall': 0.20848057, 'binary_specificity': 0.96260273, 'binary_f1_score': 0.20884956}
confusion matrix:
      0    1
0  5740  223
1   224   59
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-03 14:03:45.050852,epoch time: 0:18:55.567268,used: 0:39:30.782055,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_13_24_14_seed_3_24046977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9174387, 'precision': 0.92072093, 'recall': 0.91748035, 'specificity': 0.91748035, 'f1': 0.9172828, 'auroc': 0.97086734, 'binary_precision': 0.958117, 'binary_recall': 0.87320364, 'binary_specificity': 0.961757, 'binary_f1_score': 0.9136917}
confusion matrix:
       0      1
0  27588   1097
1   3644  25095
---- Validation: 
scalar performance:
{'acc': 0.9144835, 'precision': 0.5650295, 'recall': 0.6364084, 'specificity': 0.6364084, 'f1': 0.5833805, 'auroc': 0.77547055, 'binary_precision': 0.154396, 'binary_recall': 0.33802816, 'binary_specificity': 0.9347886, 'binary_f1_score': 0.21197252}
confusion matrix:
       0     1
0  16958  1183
1    423   216
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9239513, 'precision': 0.59112966, 'recall': 0.60843784, 'specificity': 0.60843784, 'f1': 0.59876996, 'auroc': 0.80161643, 'binary_precision': 0.21764706, 'binary_recall': 0.2614841, 'binary_specificity': 0.9553916, 'binary_f1_score': 0.23756017}
confusion matrix:
      0    1
0  5697  266
1   209   74
better model found
persisted
after epoch: 3,now: 2024-08-03 14:23:10.235726,epoch time: 0:19:25.184874,used: 0:58:55.966929,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_13_24_14_seed_3_24046977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.92867094, 'precision': 0.9324187, 'recall': 0.9287132, 'specificity': 0.9287132, 'f1': 0.9285208, 'auroc': 0.97700274, 'binary_precision': 0.9729024, 'binary_recall': 0.8820377, 'binary_specificity': 0.9753887, 'binary_f1_score': 0.9252445}
confusion matrix:
       0      1
0  27980    706
1   3390  25348
---- Validation: 
scalar performance:
{'acc': 0.92438763, 'precision': 0.57372487, 'recall': 0.63323087, 'specificity': 0.63323087, 'f1': 0.59215057, 'auroc': 0.8056358, 'binary_precision': 0.17212427, 'binary_recall': 0.32081378, 'binary_specificity': 0.94564795, 'binary_f1_score': 0.22404373}
confusion matrix:
       0    1
0  17155  986
1    434  205
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9311559, 'precision': 0.61489934, 'recall': 0.6256746, 'specificity': 0.6256746, 'f1': 0.6199769, 'auroc': 0.83371186, 'binary_precision': 0.2636656, 'binary_recall': 0.28975266, 'binary_specificity': 0.9615965, 'binary_f1_score': 0.27609426}
confusion matrix:
      0    1
0  5734  229
1   201   82
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-03 14:42:05.642817,epoch time: 0:18:55.407091,used: 1:17:51.374020,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_13_24_14_seed_3_24046977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9375697, 'precision': 0.9404535, 'recall': 0.9376078, 'specificity': 0.9376078, 'f1': 0.937471, 'auroc': 0.9815271, 'binary_precision': 0.9763293, 'binary_recall': 0.89700407, 'binary_specificity': 0.9782116, 'binary_f1_score': 0.9349872}
confusion matrix:
       0      1
0  28060    625
1   2960  25779
---- Validation: 
scalar performance:
{'acc': 0.9266773, 'precision': 0.59173894, 'recall': 0.67367136, 'specificity': 0.67367136, 'f1': 0.61660445, 'auroc': 0.82957596, 'binary_precision': 0.20527157, 'binary_recall': 0.40219092, 'binary_specificity': 0.94515187, 'binary_f1_score': 0.27181384}
confusion matrix:
       0    1
0  17146  995
1    382  257
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9340378, 'precision': 0.6423122, 'recall': 0.6726231, 'specificity': 0.6726231, 'f1': 0.6556495, 'auroc': 0.8544618, 'binary_precision': 0.31412104, 'binary_recall': 0.38515902, 'binary_specificity': 0.9600872, 'binary_f1_score': 0.34603176}
confusion matrix:
      0    1
0  5725  238
1   174  109
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-03 15:00:58.075499,epoch time: 0:18:52.432682,used: 1:36:43.806702,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_13_24_14_seed_3_24046977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.94291586, 'precision': 0.9446258, 'recall': 0.94294405, 'specificity': 0.94294405, 'f1': 0.9428634, 'auroc': 0.98277074, 'binary_precision': 0.97242635, 'binary_recall': 0.9117893, 'binary_specificity': 0.97409886, 'binary_f1_score': 0.9411321}
confusion matrix:
       0      1
0  27943    743
1   2535  26203
---- Validation: 
scalar performance:
{'acc': 0.92321616, 'precision': 0.60299426, 'recall': 0.72396874, 'specificity': 0.72396874, 'f1': 0.63535357, 'auroc': 0.8446593, 'binary_precision': 0.22405498, 'binary_recall': 0.5101721, 'binary_specificity': 0.9377653, 'binary_f1_score': 0.31136578}
confusion matrix:
       0     1
0  17012  1129
1    313   326
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.931316, 'precision': 0.6515482, 'recall': 0.72168565, 'specificity': 0.72168565, 'f1': 0.6784043, 'auroc': 0.863328, 'binary_precision': 0.3278302, 'binary_recall': 0.49116609, 'binary_specificity': 0.95220524, 'binary_f1_score': 0.39321074}
confusion matrix:
      0    1
0  5678  285
1   144  139
early stop counter: 1
val acc:0.9232161641120911, best validation acc: 0.9266772866249084, corresponding to test acc:                         0.9340378046035767 / 0.9340378046035767
after epoch: 6,now: 2024-08-03 15:22:08.194008,epoch time: 0:21:10.118509,used: 1:57:53.925211,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_13_24_14_seed_3_24046977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9467122, 'precision': 0.9486512, 'recall': 0.9467444, 'specificity': 0.9467444, 'f1': 0.9466572, 'auroc': 0.98541915, 'binary_precision': 0.97839046, 'binary_recall': 0.9137091, 'binary_specificity': 0.97977966, 'binary_f1_score': 0.9449442}
confusion matrix:
       0      1
0  28104    580
1   2480  26260
---- Validation: 
scalar performance:
{'acc': 0.9340256, 'precision': 0.61272347, 'recall': 0.7016321, 'specificity': 0.7016321, 'f1': 0.6417213, 'auroc': 0.8514055, 'binary_precision': 0.24533106, 'binary_recall': 0.45226917, 'binary_specificity': 0.95099497, 'binary_f1_score': 0.31810677}
confusion matrix:
       0    1
0  17252  889
1    350  289
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9414025, 'precision': 0.6802863, 'recall': 0.7269682, 'specificity': 0.7269682, 'f1': 0.7003929, 'auroc': 0.8709065, 'binary_precision': 0.38504156, 'binary_recall': 0.49116609, 'binary_specificity': 0.9627704, 'binary_f1_score': 0.431677}
confusion matrix:
      0    1
0  5741  222
1   144  139
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-08-03 15:41:48.111103,epoch time: 0:19:39.917095,used: 2:17:33.842306,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_13_24_14_seed_3_24046977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9499338, 'precision': 0.9514673, 'recall': 0.94996035, 'specificity': 0.94996035, 'f1': 0.9498933, 'auroc': 0.9869383, 'binary_precision': 0.9780061, 'binary_recall': 0.9206625, 'binary_specificity': 0.9792582, 'binary_f1_score': 0.9484684}
confusion matrix:
       0      1
0  28091    595
1   2280  26458
---- Validation: 
scalar performance:
{'acc': 0.9290202, 'precision': 0.61492556, 'recall': 0.73678684, 'specificity': 0.73678684, 'f1': 0.64982414, 'auroc': 0.8620335, 'binary_precision': 0.24708454, 'binary_recall': 0.53051645, 'binary_specificity': 0.9430572, 'binary_f1_score': 0.3371457}
confusion matrix:
       0     1
0  17108  1033
1    300   339
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9372398, 'precision': 0.6784928, 'recall': 0.7719103, 'specificity': 0.7719103, 'f1': 0.71336937, 'auroc': 0.87933254, 'binary_precision': 0.37697518, 'binary_recall': 0.590106, 'binary_specificity': 0.95371455, 'binary_f1_score': 0.4600551}
confusion matrix:
      0    1
0  5687  276
1   116  167
early stop counter: 1
val acc:0.9290202260017395, best validation acc: 0.9340255856513977, corresponding to test acc:                         0.9414024949073792 / 0.9414024949073792
after epoch: 8,now: 2024-08-03 16:01:08.783223,epoch time: 0:19:20.672120,used: 2:36:54.514426,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_13_24_14_seed_3_24046977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.95223254, 'precision': 0.9532454, 'recall': 0.95225406, 'specificity': 0.95225406, 'f1': 0.9522074, 'auroc': 0.98679113, 'binary_precision': 0.97489864, 'binary_recall': 0.9284571, 'binary_specificity': 0.97605103, 'binary_f1_score': 0.95111126}
confusion matrix:
       0      1
0  27999    687
1   2056  26682
---- Validation: 
scalar performance:
{'acc': 0.9242279, 'precision': 0.61120254, 'recall': 0.74864954, 'specificity': 0.74864954, 'f1': 0.647281, 'auroc': 0.8665558, 'binary_precision': 0.23866667, 'binary_recall': 0.5602504, 'binary_specificity': 0.9370487, 'binary_f1_score': 0.33473587}
confusion matrix:
       0     1
0  16999  1142
1    281   358
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9338777, 'precision': 0.67472625, 'recall': 0.7920276, 'specificity': 0.7920276, 'f1': 0.7152381, 'auroc': 0.8841009, 'binary_precision': 0.36734694, 'binary_recall': 0.6360424, 'binary_specificity': 0.94801277, 'binary_f1_score': 0.465718}
confusion matrix:
      0    1
0  5653  310
1   103  180
early stop counter: 2
val acc:0.9242278933525085, best validation acc: 0.9340255856513977, corresponding to test acc:                         0.9414024949073792 / 0.9414024949073792
after epoch: 9,now: 2024-08-03 16:20:39.268638,epoch time: 0:19:30.485415,used: 2:56:24.999841,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_13_24_14_seed_3_24046977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9556109, 'precision': 0.9565747, 'recall': 0.95563185, 'specificity': 0.95563185, 'f1': 0.9555889, 'auroc': 0.9888829, 'binary_precision': 0.9777794, 'binary_recall': 0.93249357, 'binary_specificity': 0.97877014, 'binary_f1_score': 0.9545997}
confusion matrix:
       0      1
0  28077    609
1   1940  26798
---- Validation: 
scalar performance:
{'acc': 0.93258786, 'precision': 0.6208768, 'recall': 0.7371236, 'specificity': 0.7371236, 'f1': 0.6559404, 'auroc': 0.87052923, 'binary_precision': 0.2590315, 'binary_recall': 0.52738655, 'binary_specificity': 0.94686073, 'binary_f1_score': 0.34742266}
confusion matrix:
       0    1
0  17177  964
1    302  337
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.940602, 'precision': 0.69140184, 'recall': 0.7921834, 'specificity': 0.7921834, 'f1': 0.7290747, 'auroc': 0.8867676, 'binary_precision': 0.4009009, 'binary_recall': 0.6289753, 'binary_specificity': 0.9553916, 'binary_f1_score': 0.48968363}
confusion matrix:
      0    1
0  5697  266
1   105  178
early stop counter: 3
val acc:0.9325878620147705, best validation acc: 0.9340255856513977, corresponding to test acc:                         0.9414024949073792 / 0.9414024949073792
after epoch: 10,now: 2024-08-03 16:41:13.070824,epoch time: 0:20:33.802186,used: 3:16:58.802027,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_13_24_14_seed_3_24046977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9569692, 'precision': 0.9577831, 'recall': 0.95698917, 'specificity': 0.95698917, 'f1': 0.9569514, 'auroc': 0.9898999, 'binary_precision': 0.9773223, 'binary_recall': 0.93573195, 'binary_specificity': 0.97824645, 'binary_f1_score': 0.956075}
confusion matrix:
       0      1
0  28061    624
1   1847  26892
---- Validation: 
scalar performance:
{'acc': 0.9340788, 'precision': 0.6211485, 'recall': 0.7288364, 'specificity': 0.7288364, 'f1': 0.65478724, 'auroc': 0.8710772, 'binary_precision': 0.26020816, 'binary_recall': 0.5086072, 'binary_specificity': 0.9490656, 'binary_f1_score': 0.34427962}
confusion matrix:
       0    1
0  17217  924
1    314  325
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9418828, 'precision': 0.69450176, 'recall': 0.7894883, 'specificity': 0.7894883, 'f1': 0.7307425, 'auroc': 0.8914223, 'binary_precision': 0.4074074, 'binary_recall': 0.6219081, 'binary_specificity': 0.95706856, 'binary_f1_score': 0.49230775}
confusion matrix:
      0    1
0  5707  256
1   107  176
new oracle model saved
better model found
persisted
after epoch: 11,now: 2024-08-03 17:02:48.453875,epoch time: 0:21:35.383051,used: 3:38:34.185078,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_13_24_14_seed_3_24046977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.95834494, 'precision': 0.95901823, 'recall': 0.9583631, 'specificity': 0.9583631, 'f1': 0.95833075, 'auroc': 0.9900389, 'binary_precision': 0.97683424, 'binary_recall': 0.93903756, 'binary_specificity': 0.97768867, 'binary_f1_score': 0.957563}
confusion matrix:
       0      1
0  28045    640
1   1752  26987
---- Validation: 
scalar performance:
{'acc': 0.9318956, 'precision': 0.61958903, 'recall': 0.7367653, 'specificity': 0.7367653, 'f1': 0.65459514, 'auroc': 0.87180626, 'binary_precision': 0.2564688, 'binary_recall': 0.52738655, 'binary_specificity': 0.9461441, 'binary_f1_score': 0.34511012}
confusion matrix:
       0    1
0  17164  977
1    302  337
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93916106, 'precision': 0.6880404, 'recall': 0.7947947, 'specificity': 0.7947947, 'f1': 0.7270758, 'auroc': 0.8935159, 'binary_precision': 0.3938731, 'binary_recall': 0.6360424, 'binary_specificity': 0.9535469, 'binary_f1_score': 0.48648646}
confusion matrix:
      0    1
0  5686  277
1   103  180
early stop counter: 1
val acc:0.9318956136703491, best validation acc: 0.9340788125991821, corresponding to test acc:                         0.9418827891349792 / 0.9418827891349792
after epoch: 12,now: 2024-08-03 17:25:18.267553,epoch time: 0:22:29.813678,used: 4:01:03.998756,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_13_24_14_seed_3_24046977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9584146, 'precision': 0.9590239, 'recall': 0.95843124, 'specificity': 0.95843124, 'f1': 0.9584019, 'auroc': 0.99079883, 'binary_precision': 0.97597545, 'binary_recall': 0.9400445, 'binary_specificity': 0.97681797, 'binary_f1_score': 0.95767313}
confusion matrix:
       0      1
0  28021    665
1   1723  27015
---- Validation: 
scalar performance:
{'acc': 0.93343985, 'precision': 0.62121135, 'recall': 0.73303515, 'specificity': 0.73303515, 'f1': 0.65558463, 'auroc': 0.87281704, 'binary_precision': 0.2600157, 'binary_recall': 0.51799685, 'binary_specificity': 0.94807345, 'binary_f1_score': 0.3462343}
confusion matrix:
       0    1
0  17199  942
1    308  331
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9407621, 'precision': 0.69276136, 'recall': 0.7973161, 'specificity': 0.7973161, 'f1': 0.73153645, 'auroc': 0.89493513, 'binary_precision': 0.40311804, 'binary_recall': 0.63957596, 'binary_specificity': 0.9550562, 'binary_f1_score': 0.4945355}
confusion matrix:
      0    1
0  5695  268
1   102  181
early stop counter: 2
val acc:0.9334398508071899, best validation acc: 0.9340788125991821, corresponding to test acc:                         0.9418827891349792 / 0.9418827891349792
after epoch: 13,now: 2024-08-03 17:49:40.974936,epoch time: 0:24:22.707383,used: 4:25:26.706139,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_13_24_14_seed_3_24046977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96074814, 'precision': 0.9613547, 'recall': 0.96076596, 'specificity': 0.96076596, 'f1': 0.9607363, 'auroc': 0.9915212, 'binary_precision': 0.9783284, 'binary_recall': 0.94244957, 'binary_specificity': 0.9790824, 'binary_f1_score': 0.96005386}
confusion matrix:
       0      1
0  28084    600
1   1654  27086
---- Validation: 
scalar performance:
{'acc': 0.93455803, 'precision': 0.6255305, 'recall': 0.7411631, 'specificity': 0.7411631, 'f1': 0.66120315, 'auroc': 0.87578654, 'binary_precision': 0.26808175, 'binary_recall': 0.53364635, 'binary_specificity': 0.9486798, 'binary_f1_score': 0.3568812}
confusion matrix:
       0    1
0  17210  931
1    298  341
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9436439, 'precision': 0.7035599, 'recall': 0.81397176, 'specificity': 0.81397176, 'f1': 0.7445969, 'auroc': 0.89835435, 'binary_precision': 0.42316258, 'binary_recall': 0.6713781, 'binary_specificity': 0.9565655, 'binary_f1_score': 0.5191257}
confusion matrix:
      0    1
0  5704  259
1    93  190
new oracle model saved
better model found
persisted
after epoch: 14,now: 2024-08-03 18:18:52.724212,epoch time: 0:29:11.749276,used: 4:54:38.455415,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_13_24_14_seed_3_24046977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9628378, 'precision': 0.96318054, 'recall': 0.9628513, 'specificity': 0.9628513, 'f1': 0.9628316, 'auroc': 0.99193394, 'binary_precision': 0.97602516, 'binary_recall': 0.94906056, 'binary_specificity': 0.976642, 'binary_f1_score': 0.96235394}
confusion matrix:
       0      1
0  28014    670
1   1464  27276
---- Validation: 
scalar performance:
{'acc': 0.9305644, 'precision': 0.623538, 'recall': 0.7594785, 'specificity': 0.7594785, 'f1': 0.6620363, 'auroc': 0.87904143, 'binary_precision': 0.26266953, 'binary_recall': 0.57589984, 'binary_specificity': 0.9430572, 'binary_f1_score': 0.36078432}
confusion matrix:
       0     1
0  17108  1033
1    271   368
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93868077, 'precision': 0.69074714, 'recall': 0.8164213, 'specificity': 0.8164213, 'f1': 0.7346399, 'auroc': 0.8994389, 'binary_precision': 0.39711934, 'binary_recall': 0.6819788, 'binary_specificity': 0.95086366, 'binary_f1_score': 0.50195056}
confusion matrix:
      0    1
0  5670  293
1    90  193
early stop counter: 1
val acc:0.9305644035339355, best validation acc: 0.9345580339431763, corresponding to test acc:                         0.9436439275741577 / 0.9436439275741577
after epoch: 15,now: 2024-08-03 18:46:56.180626,epoch time: 0:28:03.456414,used: 5:22:41.911829,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_13_24_14_seed_3_24046977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.96322095, 'precision': 0.9636177, 'recall': 0.96323436, 'specificity': 0.96323436, 'f1': 0.9632138, 'auroc': 0.9928378, 'binary_precision': 0.977408, 'binary_recall': 0.94843066, 'binary_specificity': 0.9780381, 'binary_f1_score': 0.96270126}
confusion matrix:
       0      1
0  28056    630
1   1482  27256
---- Validation: 
scalar performance:
{'acc': 0.93812567, 'precision': 0.6298339, 'recall': 0.731686, 'specificity': 0.731686, 'f1': 0.6634598, 'auroc': 0.8770664, 'binary_precision': 0.2774468, 'binary_recall': 0.5101721, 'binary_specificity': 0.9531999, 'binary_f1_score': 0.35942668}
confusion matrix:
       0    1
0  17292  849
1    313  326
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.946846, 'precision': 0.71279705, 'recall': 0.81060004, 'specificity': 0.81060004, 'f1': 0.750788, 'auroc': 0.8992053, 'binary_precision': 0.44208038, 'binary_recall': 0.6607774, 'binary_specificity': 0.96042264, 'binary_f1_score': 0.52974504}
confusion matrix:
      0    1
0  5727  236
1    96  187
new oracle model saved
better model found
persisted
after epoch: 16,now: 2024-08-03 19:10:20.224030,epoch time: 0:23:24.043404,used: 5:46:05.955233,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_13_24_14_seed_3_24046977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.96515393, 'precision': 0.9653768, 'recall': 0.9651644, 'specificity': 0.9651644, 'f1': 0.96515024, 'auroc': 0.99288964, 'binary_precision': 0.97579896, 'binary_recall': 0.95403457, 'binary_specificity': 0.9762942, 'binary_f1_score': 0.96479404}
confusion matrix:
       0      1
0  28005    680
1   1321  27418
---- Validation: 
scalar performance:
{'acc': 0.9328008, 'precision': 0.6262283, 'recall': 0.7553517, 'specificity': 0.7553517, 'f1': 0.6642189, 'auroc': 0.8782661, 'binary_precision': 0.26840147, 'binary_recall': 0.5649452, 'binary_specificity': 0.9457582, 'binary_f1_score': 0.36391127}
confusion matrix:
       0    1
0  17157  984
1    278  361
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9420429, 'precision': 0.70027274, 'recall': 0.821548, 'specificity': 0.821548, 'f1': 0.7438911, 'auroc': 0.9012131, 'binary_precision': 0.41577825, 'binary_recall': 0.68904597, 'binary_specificity': 0.95405, 'binary_f1_score': 0.51861703}
confusion matrix:
      0    1
0  5689  274
1    88  195
early stop counter: 1
val acc:0.932800829410553, best validation acc: 0.9381256699562073, corresponding to test acc:                         0.9468460083007812 / 0.9468460083007812
after epoch: 17,now: 2024-08-03 19:29:28.407603,epoch time: 0:19:08.183573,used: 6:05:14.138806,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_13_24_14_seed_3_24046977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9646489, 'precision': 0.96494937, 'recall': 0.96466064, 'specificity': 0.96466064, 'f1': 0.96464384, 'auroc': 0.9929979, 'binary_precision': 0.9769967, 'binary_recall': 0.9517712, 'binary_specificity': 0.97755, 'binary_f1_score': 0.964219}
confusion matrix:
       0      1
0  28042    644
1   1386  27352
---- Validation: 
scalar performance:
{'acc': 0.93333334, 'precision': 0.6266366, 'recall': 0.75336266, 'specificity': 0.75336266, 'f1': 0.6643224, 'auroc': 0.8787197, 'binary_precision': 0.26937547, 'binary_recall': 0.5602504, 'binary_specificity': 0.94647485, 'binary_f1_score': 0.36382118}
confusion matrix:
       0    1
0  17170  971
1    281  358
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.943804, 'precision': 0.7047857, 'recall': 0.81910443, 'specificity': 0.81910443, 'f1': 0.74694264, 'auroc': 0.9024073, 'binary_precision': 0.42511013, 'binary_recall': 0.6819788, 'binary_specificity': 0.9562301, 'binary_f1_score': 0.52374494}
confusion matrix:
      0    1
0  5702  261
1    90  193
early stop counter: 2
val acc:0.9333333373069763, best validation acc: 0.9381256699562073, corresponding to test acc:                         0.9468460083007812 / 0.9468460083007812
after epoch: 18,now: 2024-08-03 19:48:26.036692,epoch time: 0:18:57.629089,used: 6:24:11.767895,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_13_24_14_seed_3_24046977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9670695, 'precision': 0.96714884, 'recall': 0.9670758, 'specificity': 0.9670758, 'f1': 0.96706843, 'auroc': 0.9935155, 'binary_precision': 0.9734763, 'binary_recall': 0.96036744, 'binary_specificity': 0.9737842, 'binary_f1_score': 0.9668774}
confusion matrix:
       0      1
0  27933    752
1   1139  27600
---- Validation: 
scalar performance:
{'acc': 0.92949945, 'precision': 0.6218778, 'recall': 0.7596822, 'specificity': 0.7596822, 'f1': 0.66030353, 'auroc': 0.88080466, 'binary_precision': 0.25931132, 'binary_recall': 0.57746476, 'binary_specificity': 0.94189954, 'binary_f1_score': 0.35790497}
confusion matrix:
       0     1
0  17087  1054
1    270   369
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9404419, 'precision': 0.6967465, 'recall': 0.8257582, 'specificity': 0.8257582, 'f1': 0.74194765, 'auroc': 0.90433985, 'binary_precision': 0.4082474, 'binary_recall': 0.69964665, 'binary_specificity': 0.95186985, 'binary_f1_score': 0.515625}
confusion matrix:
      0    1
0  5676  287
1    85  198
early stop counter: 3
val acc:0.9294994473457336, best validation acc: 0.9381256699562073, corresponding to test acc:                         0.9468460083007812 / 0.9468460083007812
after epoch: 19,now: 2024-08-03 20:17:02.743931,epoch time: 0:28:36.707239,used: 6:52:48.475134,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_13_24_14_seed_3_24046977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.96738297, 'precision': 0.9676424, 'recall': 0.96739423, 'specificity': 0.96739423, 'f1': 0.967379, 'auroc': 0.99371374, 'binary_precision': 0.9788948, 'binary_recall': 0.9554264, 'binary_specificity': 0.979362, 'binary_f1_score': 0.9670183}
confusion matrix:
       0      1
0  28093    592
1   1281  27458
---- Validation: 
scalar performance:
{'acc': 0.93115014, 'precision': 0.6235907, 'recall': 0.75600713, 'specificity': 0.75600713, 'f1': 0.6616017, 'auroc': 0.8794242, 'binary_precision': 0.2630435, 'binary_recall': 0.5680751, 'binary_specificity': 0.94393915, 'binary_f1_score': 0.35958397}
confusion matrix:
       0     1
0  17124  1017
1    276   363
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93948126, 'precision': 0.6936786, 'recall': 0.8218893, 'specificity': 0.8218893, 'f1': 0.7384219, 'auroc': 0.9042808, 'binary_precision': 0.40246406, 'binary_recall': 0.6925795, 'binary_specificity': 0.95119905, 'binary_f1_score': 0.5090909}
confusion matrix:
      0    1
0  5672  291
1    87  196
early stop counter: 4
val acc:0.9311501383781433, best validation acc: 0.9381256699562073, corresponding to test acc:                         0.9468460083007812 / 0.9468460083007812
after epoch: 20,now: 2024-08-03 20:48:01.110272,epoch time: 0:30:58.366341,used: 7:23:46.841475,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_13_24_14_seed_3_24046977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 7:23:46.841475 at 2024-08-03 20:48:01.110272
persisted model performance metric: 

scalar performance:
{'acc': 0.946846, 'precision': 0.71279705, 'recall': 0.81060004, 'specificity': 0.81060004, 'f1': 0.750788, 'auroc': 0.8992053, 'binary_precision': 0.44208038, 'binary_recall': 0.6607774, 'binary_specificity': 0.96042264, 'binary_f1_score': 0.52974504}
confusion matrix:
      0    1
0  5727  236
1    96  187
oracle model performance metric: 

scalar performance:
{'acc': 0.946846, 'precision': 0.71279705, 'recall': 0.81060004, 'specificity': 0.81060004, 'f1': 0.750788, 'auroc': 0.8992053, 'binary_precision': 0.44208038, 'binary_recall': 0.6607774, 'binary_specificity': 0.96042264, 'binary_f1_score': 0.52974504}
confusion matrix:
      0    1
0  5727  236
1    96  187
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_halffreeze_seed3_2024-08-02_13-31-15/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_halffreeze_seed3_2024-08-02_13-31-15/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 196699 KiB |   7828 MiB |   1894 TiB |   1894 TiB |
|       from large pool | 179211 KiB |   7805 MiB |   1865 TiB |   1865 TiB |
|       from small pool |  17488 KiB |     37 MiB |     28 TiB |     28 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 196699 KiB |   7828 MiB |   1894 TiB |   1894 TiB |
|       from large pool | 179211 KiB |   7805 MiB |   1865 TiB |   1865 TiB |
|       from small pool |  17488 KiB |     37 MiB |     28 TiB |     28 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195461 KiB |   7827 MiB |   1893 TiB |   1893 TiB |
|       from large pool | 178979 KiB |   7804 MiB |   1865 TiB |   1865 TiB |
|       from small pool |  16482 KiB |     36 MiB |     28 TiB |     28 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8510 MiB |   8530 MiB |  33350 MiB |  24840 MiB |
|       from large pool |   8472 MiB |   8486 MiB |  33264 MiB |  24792 MiB |
|       from small pool |     38 MiB |     44 MiB |     86 MiB |     48 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  38821 KiB | 732464 KiB |   1006 TiB |   1006 TiB |
|       from large pool |  31733 KiB | 730714 KiB |    977 TiB |    977 TiB |
|       from small pool |   7088 KiB |  23272 KiB |     28 TiB |     28 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    2972    |    7783    |  371762 K  |  371759 K  |
|       from large pool |      79    |     762    |  180306 K  |  180306 K  |
|       from small pool |    2893    |    7702    |  191456 K  |  191453 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2972    |    7783    |  371762 K  |  371759 K  |
|       from large pool |      79    |     762    |  180306 K  |  180306 K  |
|       from small pool |    2893    |    7702    |  191456 K  |  191453 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     367    |     371    |    1405    |    1038    |
|       from large pool |     348    |     349    |    1362    |    1014    |
|       from small pool |      19    |      22    |      43    |      24    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      33    |    3667    |  203014 K  |  203014 K  |
|       from large pool |      11    |     351    |  120764 K  |  120764 K  |
|       from small pool |      22    |    3657    |   82249 K  |   82249 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |   1894 TiB |   1894 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   1865 TiB |   1865 TiB |
|       from small pool |      0 KiB |     37 MiB |     28 TiB |     28 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |   1894 TiB |   1894 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   1865 TiB |   1865 TiB |
|       from small pool |      0 KiB |     37 MiB |     28 TiB |     28 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |   1893 TiB |   1893 TiB |
|       from large pool |  16640 KiB |   7804 MiB |   1865 TiB |   1865 TiB |
|       from small pool |      0 KiB |     36 MiB |     28 TiB |     28 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 235520 KiB |   8530 MiB |  33350 MiB |  33120 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  33264 MiB |  33058 MiB |
|       from small pool |  24576 KiB |     44 MiB |     86 MiB |     62 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB |   1006 TiB |   1006 TiB |
|       from large pool |  30464 KiB | 730714 KiB |    977 TiB |    977 TiB |
|       from small pool |      0 KiB |  23272 KiB |     28 TiB |     28 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7783    |  371762 K  |  371762 K  |
|       from large pool |       2    |     762    |  180306 K  |  180306 K  |
|       from small pool |       0    |    7702    |  191456 K  |  191456 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7783    |  371762 K  |  371762 K  |
|       from large pool |       2    |     762    |  180306 K  |  180306 K  |
|       from small pool |       0    |    7702    |  191456 K  |  191456 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |     371    |    1405    |    1383    |
|       from large pool |      10    |     349    |    1362    |    1352    |
|       from small pool |      12    |      22    |      43    |      31    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3667    |  203015 K  |  203015 K  |
|       from large pool |       3    |     351    |  120764 K  |  120764 K  |
|       from small pool |       0    |    3657    |   82250 K  |   82250 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat Aug  3 20:49:26 2024]
Finished job 0.
1 of 1 steps (100%) done
