Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Fri Aug  2 20:14:02 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_halffreeze_seed3_2024-08-02_13-31-15/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_halffreeze_seed3_2024-08-02_13-31-15/rule_results/2.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=2
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/var/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_20_25_48_seed_0_24046978

 Experiment start at: 2024-08-02 20:25:49.056322
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.7297859191894531
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.85327756, 'precision': 0.8603536, 'recall': 0.8533337, 'specificity': 0.8533337, 'f1': 0.85256773, 'auroc': 0.9110915, 'binary_precision': 0.9110508, 'binary_recall': 0.7832631, 'binary_specificity': 0.9234044, 'binary_f1_score': 0.84233797}
confusion matrix:
       0      1
0  26462   2195
1   6221  22482
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.88447213, 'precision': 0.53003955, 'recall': 0.58091307, 'specificity': 0.58091307, 'f1': 0.5346871, 'auroc': 0.7437967, 'binary_precision': 0.08836207, 'binary_recall': 0.25505444, 'binary_specificity': 0.9067717, 'binary_f1_score': 0.1312525}
confusion matrix:
       0     1
0  16457  1692
1    479   164
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89133906, 'precision': 0.55172545, 'recall': 0.6079879, 'specificity': 0.6079879, 'f1': 0.5641918, 'auroc': 0.768896, 'binary_precision': 0.13565217, 'binary_recall': 0.29885057, 'binary_specificity': 0.9171252, 'binary_f1_score': 0.18660286}
confusion matrix:
      0    1
0  5500  497
1   183   78
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-02 20:45:56.735767,epoch time: 0:20:07.679445,used: 0:20:07.679445,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_20_25_48_seed_0_24046978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.89714086, 'precision': 0.90305495, 'recall': 0.8971958, 'specificity': 0.8971958, 'f1': 0.8967713, 'auroc': 0.953843, 'binary_precision': 0.9521053, 'binary_recall': 0.8365499, 'binary_specificity': 0.9578418, 'binary_f1_score': 0.8905949}
confusion matrix:
       0      1
0  27446   1208
1   4692  24014
---- Validation: 
scalar performance:
{'acc': 0.86983824, 'precision': 0.54647344, 'recall': 0.6535928, 'specificity': 0.6535928, 'f1': 0.5553452, 'auroc': 0.7921213, 'binary_precision': 0.11556503, 'binary_recall': 0.4214619, 'binary_specificity': 0.8857237, 'binary_f1_score': 0.18139224}
confusion matrix:
       0     1
0  16075  2074
1    372   271
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8844679, 'precision': 0.5792496, 'recall': 0.7033488, 'specificity': 0.7033488, 'f1': 0.6023829, 'auroc': 0.8360042, 'binary_precision': 0.18181819, 'binary_recall': 0.50574714, 'binary_specificity': 0.9009505, 'binary_f1_score': 0.2674772}
confusion matrix:
      0    1
0  5403  594
1   129  132
early stop counter: 1
val acc:0.8698382377624512, best validation acc: 0.884472131729126, corresponding to test acc:                         0.8913390636444092 / 0.8913390636444092
after epoch: 2,now: 2024-08-02 21:05:12.408740,epoch time: 0:19:15.672973,used: 0:39:23.352418,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_20_25_48_seed_0_24046978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9138075, 'precision': 0.9207968, 'recall': 0.9138615, 'specificity': 0.9138615, 'f1': 0.9134556, 'auroc': 0.96909696, 'binary_precision': 0.975238, 'binary_recall': 0.8493241, 'binary_specificity': 0.9783989, 'binary_f1_score': 0.9079364}
confusion matrix:
       0      1
0  28037    619
1   4325  24379
---- Validation: 
scalar performance:
{'acc': 0.868295, 'precision': 0.5594136, 'recall': 0.70904803, 'specificity': 0.70904803, 'f1': 0.5732956, 'auroc': 0.8247546, 'binary_precision': 0.13708399, 'binary_recall': 0.5381026, 'binary_specificity': 0.8799934, 'binary_f1_score': 0.21850331}
confusion matrix:
       0     1
0  15971  2178
1    297   346
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88095236, 'precision': 0.59611076, 'recall': 0.77664024, 'specificity': 0.77664024, 'f1': 0.6259662, 'auroc': 0.87279594, 'binary_precision': 0.20843373, 'binary_recall': 0.66283524, 'binary_specificity': 0.89044523, 'binary_f1_score': 0.31714022}
confusion matrix:
      0    1
0  5340  657
1    88  173
early stop counter: 2
val acc:0.8682950139045715, best validation acc: 0.884472131729126, corresponding to test acc:                         0.8913390636444092 / 0.8913390636444092
after epoch: 3,now: 2024-08-02 21:24:29.108093,epoch time: 0:19:16.699353,used: 0:58:40.051771,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_20_25_48_seed_0_24046978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.92590654, 'precision': 0.93018293, 'recall': 0.9259501, 'specificity': 0.9259501, 'f1': 0.92572707, 'auroc': 0.9756654, 'binary_precision': 0.97329205, 'binary_recall': 0.8759798, 'binary_specificity': 0.97592044, 'binary_f1_score': 0.92207557}
confusion matrix:
       0      1
0  27965    690
1   3560  25145
---- Validation: 
scalar performance:
{'acc': 0.8636654, 'precision': 0.567271, 'recall': 0.75315464, 'specificity': 0.75315464, 'f1': 0.58333194, 'auroc': 0.84833455, 'binary_precision': 0.14917733, 'binary_recall': 0.63452566, 'binary_specificity': 0.87178355, 'binary_f1_score': 0.24156305}
confusion matrix:
       0     1
0  15822  2327
1    235   408
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8736018, 'precision': 0.6029911, 'recall': 0.827775, 'specificity': 0.827775, 'f1': 0.6346494, 'auroc': 0.8954567, 'binary_precision': 0.21688034, 'binary_recall': 0.7777778, 'binary_specificity': 0.8777722, 'binary_f1_score': 0.33918127}
confusion matrix:
      0    1
0  5264  733
1    58  203
early stop counter: 3
val acc:0.8636654019355774, best validation acc: 0.884472131729126, corresponding to test acc:                         0.8913390636444092 / 0.8913390636444092
after epoch: 4,now: 2024-08-02 21:43:46.255912,epoch time: 0:19:17.147819,used: 1:17:57.199590,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_20_25_48_seed_0_24046978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.93329847, 'precision': 0.93584216, 'recall': 0.9333265, 'specificity': 0.9333265, 'f1': 0.93320394, 'auroc': 0.9803841, 'binary_precision': 0.9693219, 'binary_recall': 0.8950211, 'binary_specificity': 0.97163194, 'binary_f1_score': 0.93069094}
confusion matrix:
       0      1
0  27846    813
1   3013  25688
---- Validation: 
scalar performance:
{'acc': 0.84578544, 'precision': 0.56729585, 'recall': 0.786651, 'specificity': 0.786651, 'f1': 0.57854766, 'auroc': 0.86143446, 'binary_precision': 0.14599685, 'binary_recall': 0.7231726, 'binary_specificity': 0.8501295, 'binary_f1_score': 0.2429467}
confusion matrix:
       0     1
0  15429  2720
1    178   465
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84723556, 'precision': 0.5907041, 'recall': 0.8341738, 'specificity': 0.8341738, 'f1': 0.611685, 'auroc': 0.9050081, 'binary_precision': 0.190561, 'binary_recall': 0.8199234, 'binary_specificity': 0.8484242, 'binary_f1_score': 0.30924854}
confusion matrix:
      0    1
0  5088  909
1    47  214
early stop counter: 4
val acc:0.8457854390144348, best validation acc: 0.884472131729126, corresponding to test acc:                         0.8913390636444092 / 0.8913390636444092
after epoch: 5,now: 2024-08-02 22:02:46.128589,epoch time: 0:18:59.872677,used: 1:36:57.072267,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_20_25_48_seed_0_24046978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9376569, 'precision': 0.94004977, 'recall': 0.937684, 'specificity': 0.937684, 'f1': 0.9375746, 'auroc': 0.9826887, 'binary_precision': 0.97268313, 'binary_recall': 0.90070033, 'binary_specificity': 0.97466767, 'binary_f1_score': 0.93530875}
confusion matrix:
       0      1
0  27933    726
1   2850  25851
---- Validation: 
scalar performance:
{'acc': 0.8565879, 'precision': 0.57145804, 'recall': 0.78774333, 'specificity': 0.78774333, 'f1': 0.58737504, 'auroc': 0.866602, 'binary_precision': 0.15454546, 'binary_recall': 0.7138414, 'binary_specificity': 0.8616453, 'binary_f1_score': 0.25408247}
confusion matrix:
       0     1
0  15638  2511
1    184   459
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85650367, 'precision': 0.5955683, 'recall': 0.8371772, 'specificity': 0.8371772, 'f1': 0.6207582, 'auroc': 0.9114008, 'binary_precision': 0.20037629, 'binary_recall': 0.81609195, 'binary_specificity': 0.8582625, 'binary_f1_score': 0.32175225}
confusion matrix:
      0    1
0  5147  850
1    48  213
early stop counter: 5
val acc:0.8565878868103027, best validation acc: 0.884472131729126, corresponding to test acc:                         0.8913390636444092 / 0.8913390636444092
after epoch: 6,now: 2024-08-02 22:21:46.404928,epoch time: 0:19:00.276339,used: 1:55:57.348606,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_20_25_48_seed_0_24046978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9418933, 'precision': 0.9440005, 'recall': 0.9419186, 'specificity': 0.9419186, 'f1': 0.9418266, 'auroc': 0.9846715, 'binary_precision': 0.9747717, 'binary_recall': 0.9073551, 'binary_specificity': 0.9764821, 'binary_f1_score': 0.939856}
confusion matrix:
       0      1
0  27985    674
1   2659  26042
---- Validation: 
scalar performance:
{'acc': 0.86696464, 'precision': 0.57665634, 'recall': 0.7916154, 'specificity': 0.7916154, 'f1': 0.5972788, 'auroc': 0.8735428, 'binary_precision': 0.16492242, 'binary_recall': 0.71073097, 'binary_specificity': 0.8724999, 'binary_f1_score': 0.26772115}
confusion matrix:
       0     1
0  15835  2314
1    186   457
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86161715, 'precision': 0.5983272, 'recall': 0.8380129, 'specificity': 0.8380129, 'f1': 0.6257699, 'auroc': 0.91509616, 'binary_precision': 0.20602527, 'binary_recall': 0.8122605, 'binary_specificity': 0.86376524, 'binary_f1_score': 0.32868218}
confusion matrix:
      0    1
0  5180  817
1    49  212
early stop counter: 6
val acc:0.8669646382331848, best validation acc: 0.884472131729126, corresponding to test acc:                         0.8913390636444092 / 0.8913390636444092
after epoch: 7,now: 2024-08-02 22:40:49.006793,epoch time: 0:19:02.601865,used: 2:14:59.950471,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_20_25_48_seed_0_24046978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9464261, 'precision': 0.94800615, 'recall': 0.9464489, 'specificity': 0.9464489, 'f1': 0.9463807, 'auroc': 0.9866756, 'binary_precision': 0.9748045, 'binary_recall': 0.91662604, 'binary_specificity': 0.97627187, 'binary_f1_score': 0.94482046}
confusion matrix:
       0      1
0  27978    680
1   2393  26309
---- Validation: 
scalar performance:
{'acc': 0.86643255, 'precision': 0.57695967, 'recall': 0.79434013, 'specificity': 0.79434013, 'f1': 0.5975765, 'auroc': 0.87755644, 'binary_precision': 0.16529222, 'binary_recall': 0.7169518, 'binary_specificity': 0.8717285, 'binary_f1_score': 0.26864803}
confusion matrix:
       0     1
0  15821  2328
1    182   461
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85938, 'precision': 0.59768707, 'recall': 0.8405103, 'specificity': 0.8405103, 'f1': 0.6243509, 'auroc': 0.9180574, 'binary_precision': 0.2043935, 'binary_recall': 0.8199234, 'binary_specificity': 0.8610972, 'binary_f1_score': 0.3272171}
confusion matrix:
      0    1
0  5164  833
1    47  214
early stop counter: 7
val acc:0.8664325475692749, best validation acc: 0.884472131729126, corresponding to test acc:                         0.8913390636444092 / 0.8913390636444092
after epoch: 8,now: 2024-08-02 22:59:57.140966,epoch time: 0:19:08.134173,used: 2:34:08.084644,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_20_25_48_seed_0_24046978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9488319, 'precision': 0.95076716, 'recall': 0.9488572, 'specificity': 0.9488572, 'f1': 0.948779, 'auroc': 0.98718953, 'binary_precision': 0.98049456, 'binary_recall': 0.91596407, 'binary_specificity': 0.9817503, 'binary_f1_score': 0.94713145}
confusion matrix:
       0      1
0  28135    523
1   2412  26290
---- Validation: 
scalar performance:
{'acc': 0.8671243, 'precision': 0.5781033, 'recall': 0.79844856, 'specificity': 0.79844856, 'f1': 0.59934574, 'auroc': 0.8806726, 'binary_precision': 0.1672649, 'binary_recall': 0.7247278, 'binary_specificity': 0.87216926, 'binary_f1_score': 0.27179936}
confusion matrix:
       0     1
0  15829  2320
1    177   466
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8596996, 'precision': 0.5982605, 'recall': 0.8425094, 'specificity': 0.8425094, 'f1': 0.6252046, 'auroc': 0.9200673, 'binary_precision': 0.20534861, 'binary_recall': 0.8237548, 'binary_specificity': 0.861264, 'binary_f1_score': 0.32874617}
confusion matrix:
      0    1
0  5165  832
1    46  215
early stop counter: 8
val acc:0.8671243190765381, best validation acc: 0.884472131729126, corresponding to test acc:                         0.8913390636444092 / 0.8913390636444092
after epoch: 9,now: 2024-08-02 23:19:02.778880,epoch time: 0:19:05.637914,used: 2:53:13.722558,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_20_25_48_seed_0_24046978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.95240587, 'precision': 0.9530083, 'recall': 0.9524174, 'specificity': 0.9524174, 'f1': 0.9523909, 'auroc': 0.98838353, 'binary_precision': 0.96968603, 'binary_recall': 0.9340721, 'binary_specificity': 0.97076267, 'binary_f1_score': 0.95154595}
confusion matrix:
       0      1
0  27824    838
1   1892  26806
---- Validation: 
scalar performance:
{'acc': 0.84876543, 'precision': 0.5720282, 'recall': 0.80619514, 'specificity': 0.80619514, 'f1': 0.5859242, 'auroc': 0.8835875, 'binary_precision': 0.15391879, 'binary_recall': 0.7604977, 'binary_specificity': 0.85189265, 'binary_f1_score': 0.25602093}
confusion matrix:
       0     1
0  15461  2688
1    154   489
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8414829, 'precision': 0.58990693, 'recall': 0.8421663, 'specificity': 0.8421663, 'f1': 0.6088821, 'auroc': 0.9208391, 'binary_precision': 0.18787362, 'binary_recall': 0.8429119, 'binary_specificity': 0.8414207, 'binary_f1_score': 0.30726257}
confusion matrix:
      0    1
0  5046  951
1    41  220
early stop counter: 9
val acc:0.8487654328346252, best validation acc: 0.884472131729126, corresponding to test acc:                         0.8913390636444092 / 0.8913390636444092
after epoch: 10,now: 2024-08-02 23:38:14.903148,epoch time: 0:19:12.124268,used: 3:12:25.846826,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_20_25_48_seed_0_24046978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9546897, 'precision': 0.9557687, 'recall': 0.9547076, 'specificity': 0.9547076, 'f1': 0.9546641, 'auroc': 0.98986256, 'binary_precision': 0.9781287, 'binary_recall': 0.93024635, 'binary_specificity': 0.97916883, 'binary_f1_score': 0.9535868}
confusion matrix:
       0      1
0  28062    597
1   2002  26699
---- Validation: 
scalar performance:
{'acc': 0.86717755, 'precision': 0.57917964, 'recall': 0.8037265, 'specificity': 0.8037265, 'f1': 0.6008669, 'auroc': 0.88403004, 'binary_precision': 0.16898893, 'binary_recall': 0.7356143, 'binary_specificity': 0.8718387, 'binary_f1_score': 0.2748402}
confusion matrix:
       0     1
0  15823  2326
1    170   473
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8555449, 'precision': 0.5964965, 'recall': 0.8440063, 'specificity': 0.8440063, 'f1': 0.6217458, 'auroc': 0.92250335, 'binary_precision': 0.2014856, 'binary_recall': 0.8314176, 'binary_specificity': 0.856595, 'binary_f1_score': 0.32436472}
confusion matrix:
      0    1
0  5137  860
1    44  217
early stop counter: 10
val acc:0.8671775460243225, best validation acc: 0.884472131729126, corresponding to test acc:                         0.8913390636444092 / 0.8913390636444092
after epoch: 11,now: 2024-08-02 23:57:20.737893,epoch time: 0:19:05.834745,used: 3:31:31.681571,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_20_25_48_seed_0_24046978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9578975, 'precision': 0.9584409, 'recall': 0.9579102, 'specificity': 0.9579102, 'f1': 0.95788586, 'auroc': 0.99072075, 'binary_precision': 0.97440803, 'binary_recall': 0.94055957, 'binary_specificity': 0.97526085, 'binary_f1_score': 0.9571847}
confusion matrix:
       0      1
0  27950    709
1   1706  26995
---- Validation: 
scalar performance:
{'acc': 0.8529161, 'precision': 0.573848, 'recall': 0.807594, 'specificity': 0.807594, 'f1': 0.5896469, 'auroc': 0.88700294, 'binary_precision': 0.15757184, 'binary_recall': 0.7589425, 'binary_specificity': 0.8562455, 'binary_f1_score': 0.26096258}
confusion matrix:
       0     1
0  15540  2609
1    155   488
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8429211, 'precision': 0.5910051, 'recall': 0.844749, 'specificity': 0.844749, 'f1': 0.61077255, 'auroc': 0.922796, 'binary_precision': 0.18986255, 'binary_recall': 0.8467433, 'binary_specificity': 0.8427547, 'binary_f1_score': 0.31017545}
confusion matrix:
      0    1
0  5054  943
1    40  221
early stop counter: 11
val acc:0.8529161214828491, best validation acc: 0.884472131729126, corresponding to test acc:                         0.8913390636444092 / 0.8913390636444092
after epoch: 12,now: 2024-08-03 00:16:24.414952,epoch time: 0:19:03.677059,used: 3:50:35.358630,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_20_25_48_seed_0_24046978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.95737445, 'precision': 0.9580494, 'recall': 0.9573893, 'specificity': 0.9573893, 'f1': 0.95735973, 'auroc': 0.9905679, 'binary_precision': 0.9758254, 'binary_recall': 0.9380531, 'binary_specificity': 0.9767255, 'binary_f1_score': 0.9565666}
confusion matrix:
       0      1
0  27991    667
1   1778  26924
---- Validation: 
scalar performance:
{'acc': 0.8518519, 'precision': 0.57333624, 'recall': 0.807043, 'specificity': 0.807043, 'f1': 0.58863306, 'auroc': 0.88682485, 'binary_precision': 0.1565608, 'binary_recall': 0.7589425, 'binary_specificity': 0.85514355, 'binary_f1_score': 0.25957447}
confusion matrix:
       0     1
0  15520  2629
1    155   488
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8373282, 'precision': 0.5892849, 'recall': 0.8473279, 'specificity': 0.8473279, 'f1': 0.6067334, 'auroc': 0.9232956, 'binary_precision': 0.18589212, 'binary_recall': 0.85823756, 'binary_specificity': 0.8364182, 'binary_f1_score': 0.30559343}
confusion matrix:
      0    1
0  5016  981
1    37  224
early stop counter: 12
val acc:0.8518518805503845, best validation acc: 0.884472131729126, corresponding to test acc:                         0.8913390636444092 / 0.8913390636444092
after epoch: 13,now: 2024-08-03 00:35:24.288679,epoch time: 0:18:59.873727,used: 4:09:35.232357,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_20_25_48_seed_0_24046978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9608612, 'precision': 0.96114135, 'recall': 0.96087074, 'specificity': 0.96087074, 'f1': 0.96085584, 'auroc': 0.9919124, 'binary_precision': 0.97269964, 'binary_recall': 0.9484008, 'binary_specificity': 0.97334075, 'binary_f1_score': 0.9603966}
confusion matrix:
       0      1
0  27894    764
1   1481  27221
---- Validation: 
scalar performance:
{'acc': 0.8587165, 'precision': 0.5767561, 'recall': 0.81059694, 'specificity': 0.81059694, 'f1': 0.5953001, 'auroc': 0.8881042, 'binary_precision': 0.16331995, 'binary_recall': 0.7589425, 'binary_specificity': 0.86225134, 'binary_f1_score': 0.26879647}
confusion matrix:
       0     1
0  15649  2500
1    155   488
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8489933, 'precision': 0.59460306, 'recall': 0.84974957, 'specificity': 0.84974957, 'f1': 0.6173629, 'auroc': 0.92321515, 'binary_precision': 0.19680852, 'binary_recall': 0.85057473, 'binary_specificity': 0.84892446, 'binary_f1_score': 0.3196544}
confusion matrix:
      0    1
0  5091  906
1    39  222
early stop counter: 13
val acc:0.8587164878845215, best validation acc: 0.884472131729126, corresponding to test acc:                         0.8913390636444092 / 0.8913390636444092
after epoch: 14,now: 2024-08-03 00:54:40.336262,epoch time: 0:19:16.047583,used: 4:28:51.279940,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_20_25_48_seed_0_24046978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.96194214, 'precision': 0.9627636, 'recall': 0.9619591, 'specificity': 0.9619591, 'f1': 0.9619262, 'auroc': 0.99258244, 'binary_precision': 0.9824625, 'binary_recall': 0.9407379, 'binary_specificity': 0.9831804, 'binary_f1_score': 0.96114767}
confusion matrix:
       0      1
0  28175    482
1   1701  27002
---- Validation: 
scalar performance:
{'acc': 0.865315, 'precision': 0.57797617, 'recall': 0.8020122, 'specificity': 0.8020122, 'f1': 0.5987257, 'auroc': 0.8865316, 'binary_precision': 0.16666667, 'binary_recall': 0.7340591, 'binary_specificity': 0.8699653, 'binary_f1_score': 0.27165467}
confusion matrix:
       0     1
0  15789  2360
1    171   472
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8485139, 'precision': 0.5939748, 'recall': 0.8476671, 'specificity': 0.8476671, 'f1': 0.61638993, 'auroc': 0.92325795, 'binary_precision': 0.19574845, 'binary_recall': 0.8467433, 'binary_specificity': 0.84859097, 'binary_f1_score': 0.31798562}
confusion matrix:
      0    1
0  5089  908
1    40  221
early stop counter: 14
val acc:0.8653150200843811, best validation acc: 0.884472131729126, corresponding to test acc:                         0.8913390636444092 / 0.8913390636444092
after epoch: 15,now: 2024-08-03 01:13:42.452520,epoch time: 0:19:02.116258,used: 4:47:53.396198,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_20_25_48_seed_0_24046978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.96215135, 'precision': 0.9627538, 'recall': 0.9621653, 'specificity': 0.9621653, 'f1': 0.96213984, 'auroc': 0.99244595, 'binary_precision': 0.97964346, 'binary_recall': 0.94397604, 'binary_specificity': 0.98035455, 'binary_f1_score': 0.9614791}
confusion matrix:
       0      1
0  28095    563
1   1608  27094
---- Validation: 
scalar performance:
{'acc': 0.84956366, 'precision': 0.5715522, 'recall': 0.80210805, 'specificity': 0.80210805, 'f1': 0.5855092, 'auroc': 0.8842298, 'binary_precision': 0.15333334, 'binary_recall': 0.7511664, 'binary_specificity': 0.85304976, 'binary_f1_score': 0.25467968}
confusion matrix:
       0     1
0  15482  2667
1    160   483
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83589005, 'precision': 0.5882313, 'recall': 0.84474516, 'specificity': 0.84474516, 'f1': 0.60489166, 'auroc': 0.92321384, 'binary_precision': 0.1839934, 'binary_recall': 0.8544061, 'binary_specificity': 0.8350842, 'binary_f1_score': 0.30278346}
confusion matrix:
      0    1
0  5008  989
1    38  223
early stop counter: 15
val acc:0.8495636582374573, best validation acc: 0.884472131729126, corresponding to test acc:                         0.8913390636444092 / 0.8913390636444092
after epoch: 16,now: 2024-08-03 01:32:42.093526,epoch time: 0:18:59.641006,used: 5:06:53.037204,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_20_25_48_seed_0_24046978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9645223, 'precision': 0.9649714, 'recall': 0.964536, 'specificity': 0.964536, 'f1': 0.9645145, 'auroc': 0.99284434, 'binary_precision': 0.97964174, 'binary_recall': 0.9488242, 'binary_specificity': 0.9802478, 'binary_f1_score': 0.9639867}
confusion matrix:
       0      1
0  28089    566
1   1469  27236
---- Validation: 
scalar performance:
{'acc': 0.8588761, 'precision': 0.5752492, 'recall': 0.80242896, 'specificity': 0.80242896, 'f1': 0.59325427, 'auroc': 0.88411105, 'binary_precision': 0.16098548, 'binary_recall': 0.7418352, 'binary_specificity': 0.86302274, 'binary_f1_score': 0.26455906}
confusion matrix:
       0     1
0  15663  2486
1    166   477
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8432407, 'precision': 0.59117, 'recall': 0.84491575, 'specificity': 0.84491575, 'f1': 0.61108863, 'auroc': 0.92266226, 'binary_precision': 0.19018933, 'binary_recall': 0.8467433, 'binary_specificity': 0.8430882, 'binary_f1_score': 0.3106114}
confusion matrix:
      0    1
0  5056  941
1    40  221
early stop counter: 16
val acc:0.85887610912323, best validation acc: 0.884472131729126, corresponding to test acc:                         0.8913390636444092 / 0.8913390636444092
after epoch: 17,now: 2024-08-03 01:51:46.474203,epoch time: 0:19:04.380677,used: 5:25:57.417881,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_20_25_48_seed_0_24046978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9637029, 'precision': 0.96426535, 'recall': 0.9637158, 'specificity': 0.9637158, 'f1': 0.9636926, 'auroc': 0.9933688, 'binary_precision': 0.9806088, 'binary_recall': 0.94616914, 'binary_specificity': 0.98126245, 'binary_f1_score': 0.9630812}
confusion matrix:
       0      1
0  28122    537
1   1545  27156
---- Validation: 
scalar performance:
{'acc': 0.8543529, 'precision': 0.57397926, 'recall': 0.8053376, 'specificity': 0.8053376, 'f1': 0.59024054, 'auroc': 0.8823713, 'binary_precision': 0.15806663, 'binary_recall': 0.7527216, 'binary_specificity': 0.8579536, 'binary_f1_score': 0.26126856}
confusion matrix:
       0     1
0  15571  2578
1    159   484
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83525085, 'precision': 0.58756727, 'recall': 0.84257936, 'specificity': 0.84257936, 'f1': 0.60381883, 'auroc': 0.92308474, 'binary_precision': 0.18286656, 'binary_recall': 0.85057473, 'binary_specificity': 0.83458394, 'binary_f1_score': 0.30101696}
confusion matrix:
      0    1
0  5005  992
1    39  222
early stop counter: 17
val acc:0.8543528914451599, best validation acc: 0.884472131729126, corresponding to test acc:                         0.8913390636444092 / 0.8913390636444092
after epoch: 18,now: 2024-08-03 02:10:49.053632,epoch time: 0:19:02.579429,used: 5:44:59.997310,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_20_25_48_seed_0_24046978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9651151, 'precision': 0.9655056, 'recall': 0.9651263, 'specificity': 0.9651263, 'f1': 0.9651083, 'auroc': 0.99404466, 'binary_precision': 0.97918236, 'binary_recall': 0.95049125, 'binary_specificity': 0.9797613, 'binary_f1_score': 0.9646235}
confusion matrix:
       0      1
0  28078    580
1   1421  27281
---- Validation: 
scalar performance:
{'acc': 0.87287146, 'precision': 0.5802909, 'recall': 0.7954235, 'specificity': 0.7954235, 'f1': 0.6037315, 'auroc': 0.8803921, 'binary_precision': 0.17205109, 'binary_recall': 0.7122862, 'binary_specificity': 0.8785608, 'binary_f1_score': 0.27715582}
confusion matrix:
       0     1
0  15945  2204
1    185   458
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85778207, 'precision': 0.59820724, 'recall': 0.8470059, 'specificity': 0.8470059, 'f1': 0.62463653, 'auroc': 0.92270017, 'binary_precision': 0.20469484, 'binary_recall': 0.83524907, 'binary_specificity': 0.85876274, 'binary_f1_score': 0.32880843}
confusion matrix:
      0    1
0  5150  847
1    43  218
early stop counter: 18
val acc:0.872871458530426, best validation acc: 0.884472131729126, corresponding to test acc:                         0.8913390636444092 / 0.8913390636444092
after epoch: 19,now: 2024-08-03 02:29:57.217009,epoch time: 0:19:08.163377,used: 6:04:08.160687,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_20_25_48_seed_0_24046978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9674512, 'precision': 0.9676801, 'recall': 0.96745825, 'specificity': 0.96745825, 'f1': 0.9674475, 'auroc': 0.99416816, 'binary_precision': 0.9781857, 'binary_recall': 0.9562687, 'binary_specificity': 0.9786477, 'binary_f1_score': 0.96710306}
confusion matrix:
       0      1
0  28050    612
1   1255  27443
---- Validation: 
scalar performance:
{'acc': 0.8540868, 'precision': 0.57512784, 'recall': 0.8119503, 'specificity': 0.8119503, 'f1': 0.5917474, 'auroc': 0.8850701, 'binary_precision': 0.1598055, 'binary_recall': 0.7667185, 'binary_specificity': 0.8571822, 'binary_f1_score': 0.26448497}
confusion matrix:
       0     1
0  15557  2592
1    150   493
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.838287, 'precision': 0.58867496, 'recall': 0.8423311, 'specificity': 0.8423311, 'f1': 0.6062523, 'auroc': 0.9232375, 'binary_precision': 0.18524727, 'binary_recall': 0.8467433, 'binary_specificity': 0.83791894, 'binary_f1_score': 0.303989}
confusion matrix:
      0    1
0  5025  972
1    40  221
early stop counter: 19
val acc:0.8540868163108826, best validation acc: 0.884472131729126, corresponding to test acc:                         0.8913390636444092 / 0.8913390636444092
after epoch: 20,now: 2024-08-03 02:48:57.462648,epoch time: 0:19:00.245639,used: 6:23:08.406326,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_20_25_48_seed_0_24046978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 6:23:08.406326 at 2024-08-03 02:48:57.462648
persisted model performance metric: 

scalar performance:
{'acc': 0.89133906, 'precision': 0.55172545, 'recall': 0.6079879, 'specificity': 0.6079879, 'f1': 0.5641918, 'auroc': 0.768896, 'binary_precision': 0.13565217, 'binary_recall': 0.29885057, 'binary_specificity': 0.9171252, 'binary_f1_score': 0.18660286}
confusion matrix:
      0    1
0  5500  497
1   183   78
oracle model performance metric: 

scalar performance:
{'acc': 0.89133906, 'precision': 0.55172545, 'recall': 0.6079879, 'specificity': 0.6079879, 'f1': 0.5641918, 'auroc': 0.768896, 'binary_precision': 0.13565217, 'binary_recall': 0.29885057, 'binary_specificity': 0.9171252, 'binary_f1_score': 0.18660286}
confusion matrix:
      0    1
0  5500  497
1   183   78
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_halffreeze_seed3_2024-08-02_13-31-15/rule_results/2.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_halffreeze_seed3_2024-08-02_13-31-15/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_halffreeze_seed3_2024-08-02_13-31-15/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 198153 KiB |   7828 MiB | 478504 GiB | 478504 GiB |
|       from large pool | 180662 KiB |   7805 MiB | 471283 GiB | 471283 GiB |
|       from small pool |  17491 KiB |     37 MiB |   7221 GiB |   7221 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 198153 KiB |   7828 MiB | 478504 GiB | 478504 GiB |
|       from large pool | 180662 KiB |   7805 MiB | 471283 GiB | 471283 GiB |
|       from small pool |  17491 KiB |     37 MiB |   7221 GiB |   7221 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195461 KiB |   7827 MiB | 478478 GiB | 478477 GiB |
|       from large pool | 178979 KiB |   7804 MiB | 471273 GiB | 471273 GiB |
|       from small pool |  16482 KiB |     36 MiB |   7204 GiB |   7204 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8530 MiB |   8530 MiB |   8530 MiB |      0 B   |
|       from large pool |   8486 MiB |   8486 MiB |   8486 MiB |      0 B   |
|       from small pool |     44 MiB |     44 MiB |     44 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  59895 KiB | 732464 KiB | 269417 GiB | 269417 GiB |
|       from large pool |  50762 KiB | 730714 KiB | 262193 GiB | 262193 GiB |
|       from small pool |   9133 KiB |  11093 KiB |   7223 GiB |   7223 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2978    |    7665    |   92081 K  |   92078 K  |
|       from large pool |      79    |     762    |   44500 K  |   44500 K  |
|       from small pool |    2899    |    7584    |   47580 K  |   47577 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2978    |    7665    |   92081 K  |   92078 K  |
|       from large pool |      79    |     762    |   44500 K  |   44500 K  |
|       from small pool |    2899    |    7584    |   47580 K  |   47577 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     371    |     371    |     371    |       0    |
|       from large pool |     349    |     349    |     349    |       0    |
|       from small pool |      22    |      22    |      22    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      34    |    3606    |   53673 K  |   53673 K  |
|       from large pool |      10    |     350    |   33590 K  |   33590 K  |
|       from small pool |      24    |    3596    |   20082 K  |   20082 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB | 478504 GiB | 478504 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 471283 GiB | 471283 GiB |
|       from small pool |      0 KiB |     37 MiB |   7221 GiB |   7221 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB | 478504 GiB | 478504 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 471283 GiB | 471283 GiB |
|       from small pool |      0 KiB |     37 MiB |   7221 GiB |   7221 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB | 478478 GiB | 478478 GiB |
|       from large pool |  16640 KiB |   7804 MiB | 471273 GiB | 471273 GiB |
|       from small pool |      0 KiB |     36 MiB |   7204 GiB |   7204 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 258048 KiB |   8530 MiB |   8530 MiB |   8278 MiB |
|       from large pool | 231424 KiB |   8486 MiB |   8486 MiB |   8260 MiB |
|       from small pool |  26624 KiB |     44 MiB |     44 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB | 269417 GiB | 269417 GiB |
|       from large pool |  30464 KiB | 730714 KiB | 262193 GiB | 262193 GiB |
|       from small pool |      0 KiB |  23272 KiB |   7223 GiB |   7223 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7665    |   92081 K  |   92081 K  |
|       from large pool |       2    |     762    |   44500 K  |   44500 K  |
|       from small pool |       0    |    7584    |   47580 K  |   47580 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7665    |   92081 K  |   92081 K  |
|       from large pool |       2    |     762    |   44500 K  |   44500 K  |
|       from small pool |       0    |    7584    |   47580 K  |   47580 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |     371    |     371    |     347    |
|       from large pool |      11    |     349    |     349    |     338    |
|       from small pool |      13    |      22    |      22    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3606    |   53674 K  |   53674 K  |
|       from large pool |       3    |     350    |   33590 K  |   33590 K  |
|       from small pool |       0    |    3596    |   20084 K  |   20084 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB | 478504 GiB | 478504 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 471283 GiB | 471283 GiB |
|       from small pool |      0 KiB |     37 MiB |   7221 GiB |   7221 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB | 478504 GiB | 478504 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 471283 GiB | 471283 GiB |
|       from small pool |      0 KiB |     37 MiB |   7221 GiB |   7221 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB | 478478 GiB | 478478 GiB |
|       from large pool |  16640 KiB |   7804 MiB | 471273 GiB | 471273 GiB |
|       from small pool |      0 KiB |     36 MiB |   7204 GiB |   7204 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 258048 KiB |   8530 MiB |   8530 MiB |   8278 MiB |
|       from large pool | 231424 KiB |   8486 MiB |   8486 MiB |   8260 MiB |
|       from small pool |  26624 KiB |     44 MiB |     44 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB | 269417 GiB | 269417 GiB |
|       from large pool |  30464 KiB | 730714 KiB | 262193 GiB | 262193 GiB |
|       from small pool |      0 KiB |  23272 KiB |   7223 GiB |   7223 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7665    |   92081 K  |   92081 K  |
|       from large pool |       2    |     762    |   44500 K  |   44500 K  |
|       from small pool |       0    |    7584    |   47580 K  |   47580 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7665    |   92081 K  |   92081 K  |
|       from large pool |       2    |     762    |   44500 K  |   44500 K  |
|       from small pool |       0    |    7584    |   47580 K  |   47580 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |     371    |     371    |     347    |
|       from large pool |      11    |     349    |     349    |     338    |
|       from small pool |      13    |      22    |      22    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3606    |   53674 K  |   53674 K  |
|       from large pool |       3    |     350    |   33590 K  |   33590 K  |
|       from small pool |       0    |    3596    |   20084 K  |   20084 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_02_58_54_seed_1_24046978

 Experiment start at: 2024-08-03 02:58:54.523210
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.6474379897117615
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.83398706, 'precision': 0.83574, 'recall': 0.8340134, 'specificity': 0.8340134, 'f1': 0.83377767, 'auroc': 0.9003632, 'binary_precision': 0.86018246, 'binary_recall': 0.7979118, 'binary_specificity': 0.870115, 'binary_f1_score': 0.8278778}
confusion matrix:
       0      1
0  25048   3739
1   5826  23003
---- Validation: 
scalar performance:
{'acc': 0.88164353, 'precision': 0.5039885, 'recall': 0.509457, 'specificity': 0.509457, 'f1': 0.4992988, 'auroc': 0.7203908, 'binary_precision': 0.043169722, 'binary_recall': 0.10846954, 'binary_specificity': 0.91044444, 'binary_f1_score': 0.061759736}
confusion matrix:
       0     1
0  16449  1618
1    600    73
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9067032, 'precision': 0.52335876, 'recall': 0.5338618, 'specificity': 0.5338618, 'f1': 0.5265601, 'auroc': 0.7835811, 'binary_precision': 0.08571429, 'binary_recall': 0.12692308, 'binary_specificity': 0.94080055, 'binary_f1_score': 0.10232559}
confusion matrix:
      0    1
0  5594  352
1   227   33
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-03 03:18:46.602286,epoch time: 0:19:52.079076,used: 0:19:52.079076,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_02_58_54_seed_1_24046978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.88848585, 'precision': 0.893966, 'recall': 0.8885268, 'specificity': 0.8885268, 'f1': 0.88810414, 'auroc': 0.9442911, 'binary_precision': 0.940605, 'binary_recall': 0.82950604, 'binary_specificity': 0.9475476, 'binary_f1_score': 0.88156897}
confusion matrix:
       0      1
0  27278   1510
1   4915  23913
---- Validation: 
scalar performance:
{'acc': 0.8946638, 'precision': 0.5234601, 'recall': 0.5512577, 'specificity': 0.5512577, 'f1': 0.5270141, 'auroc': 0.7739802, 'binary_precision': 0.078964405, 'binary_recall': 0.18127786, 'binary_specificity': 0.9212376, 'binary_f1_score': 0.11000902}
confusion matrix:
       0     1
0  16644  1423
1    551   122
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90976477, 'precision': 0.5464316, 'recall': 0.5704003, 'specificity': 0.5704003, 'f1': 0.5544794, 'auroc': 0.8301314, 'binary_precision': 0.12871288, 'binary_recall': 0.2, 'binary_specificity': 0.94080055, 'binary_f1_score': 0.15662651}
confusion matrix:
      0    1
0  5594  352
1   208   52
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-03 03:38:08.133684,epoch time: 0:19:21.531398,used: 0:39:13.610474,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_02_58_54_seed_1_24046978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9104589, 'precision': 0.9161558, 'recall': 0.9105016, 'specificity': 0.9105016, 'f1': 0.91015756, 'auroc': 0.9637134, 'binary_precision': 0.9650295, 'binary_recall': 0.85191995, 'binary_specificity': 0.96908325, 'binary_f1_score': 0.9049541}
confusion matrix:
       0      1
0  27897    890
1   4269  24560
---- Validation: 
scalar performance:
{'acc': 0.90480256, 'precision': 0.5488801, 'recall': 0.60300833, 'specificity': 0.60300833, 'f1': 0.56140095, 'auroc': 0.8085008, 'binary_precision': 0.12592593, 'binary_recall': 0.2778603, 'binary_specificity': 0.9281563, 'binary_f1_score': 0.17330863}
confusion matrix:
       0     1
0  16769  1298
1    486   187
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9179826, 'precision': 0.58144546, 'recall': 0.6243415, 'specificity': 0.6243415, 'f1': 0.59677196, 'auroc': 0.8620016, 'binary_precision': 0.1941032, 'binary_recall': 0.30384615, 'binary_specificity': 0.94483685, 'binary_f1_score': 0.23688155}
confusion matrix:
      0    1
0  5618  328
1   181   79
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-03 03:57:24.036272,epoch time: 0:19:15.902588,used: 0:58:29.513062,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_02_58_54_seed_1_24046978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9212024, 'precision': 0.9255533, 'recall': 0.92124116, 'specificity': 0.92124116, 'f1': 0.92100537, 'auroc': 0.97214603, 'binary_precision': 0.96877414, 'binary_recall': 0.8705862, 'binary_specificity': 0.97189605, 'binary_f1_score': 0.9170595}
confusion matrix:
       0      1
0  27977    809
1   3731  25099
---- Validation: 
scalar performance:
{'acc': 0.90613663, 'precision': 0.5714848, 'recall': 0.66378266, 'specificity': 0.66378266, 'f1': 0.59277415, 'auroc': 0.82969356, 'binary_precision': 0.16646191, 'binary_recall': 0.4026746, 'binary_specificity': 0.9248907, 'binary_f1_score': 0.23554976}
confusion matrix:
       0     1
0  16710  1357
1    402   271
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92184985, 'precision': 0.6192171, 'recall': 0.7091141, 'specificity': 0.7091141, 'f1': 0.64840406, 'auroc': 0.8789923, 'binary_precision': 0.26215646, 'binary_recall': 0.47692308, 'binary_specificity': 0.9413051, 'binary_f1_score': 0.3383356}
confusion matrix:
      0    1
0  5597  349
1   136  124
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-03 04:16:35.322612,epoch time: 0:19:11.286340,used: 1:17:40.799402,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_02_58_54_seed_1_24046978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9282838, 'precision': 0.9330732, 'recall': 0.9283204, 'specificity': 0.9283204, 'f1': 0.92808914, 'auroc': 0.9786062, 'binary_precision': 0.9787902, 'binary_recall': 0.87564176, 'binary_specificity': 0.98099905, 'binary_f1_score': 0.92434734}
confusion matrix:
       0      1
0  28241    547
1   3585  25243
---- Validation: 
scalar performance:
{'acc': 0.92145145, 'precision': 0.5943555, 'recall': 0.6860306, 'specificity': 0.6860306, 'f1': 0.6208991, 'auroc': 0.8456756, 'binary_precision': 0.21071687, 'binary_recall': 0.43239227, 'binary_specificity': 0.939669, 'binary_f1_score': 0.28334954}
confusion matrix:
       0     1
0  16977  1090
1    382   291
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9310345, 'precision': 0.6416936, 'recall': 0.7286191, 'specificity': 0.7286191, 'f1': 0.672492, 'auroc': 0.88916147, 'binary_precision': 0.30555555, 'binary_recall': 0.50769234, 'binary_specificity': 0.9495459, 'binary_f1_score': 0.38150287}
confusion matrix:
      0    1
0  5646  300
1   128  132
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-03 04:35:53.307800,epoch time: 0:19:17.985188,used: 1:36:58.784590,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_02_58_54_seed_1_24046978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9374132, 'precision': 0.9406538, 'recall': 0.93744606, 'specificity': 0.93744606, 'f1': 0.9373011, 'auroc': 0.9828459, 'binary_precision': 0.97863376, 'binary_recall': 0.89445025, 'binary_specificity': 0.98044187, 'binary_f1_score': 0.9346502}
confusion matrix:
       0      1
0  28223    563
1   3043  25787
---- Validation: 
scalar performance:
{'acc': 0.9258805, 'precision': 0.613644, 'recall': 0.7283826, 'specificity': 0.7283826, 'f1': 0.64696634, 'auroc': 0.86073184, 'binary_precision': 0.2460993, 'binary_recall': 0.51560175, 'binary_specificity': 0.9411634, 'binary_f1_score': 0.3331733}
confusion matrix:
       0     1
0  17004  1063
1    326   347
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.931679, 'precision': 0.65655106, 'recall': 0.7804471, 'specificity': 0.7804471, 'f1': 0.6968844, 'auroc': 0.9015427, 'binary_precision': 0.3305785, 'binary_recall': 0.61538464, 'binary_specificity': 0.9455096, 'binary_f1_score': 0.43010753}
confusion matrix:
      0    1
0  5622  324
1   100  160
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-08-03 04:55:09.601669,epoch time: 0:19:16.293869,used: 1:56:15.078459,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_02_58_54_seed_1_24046978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.94475496, 'precision': 0.94627136, 'recall': 0.94477725, 'specificity': 0.94477725, 'f1': 0.9447099, 'auroc': 0.98536587, 'binary_precision': 0.9724771, 'binary_recall': 0.9155047, 'binary_specificity': 0.97404987, 'binary_f1_score': 0.94313127}
confusion matrix:
       0      1
0  28039    747
1   2436  26394
---- Validation: 
scalar performance:
{'acc': 0.9278015, 'precision': 0.6219266, 'recall': 0.7472606, 'specificity': 0.7472606, 'f1': 0.6582769, 'auroc': 0.8696897, 'binary_precision': 0.26123595, 'binary_recall': 0.55274886, 'binary_specificity': 0.9417723, 'binary_f1_score': 0.35479254}
confusion matrix:
       0     1
0  17015  1052
1    301   372
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9321624, 'precision': 0.66177285, 'recall': 0.7990892, 'specificity': 0.7990892, 'f1': 0.70532316, 'auroc': 0.909629, 'binary_precision': 0.33932135, 'binary_recall': 0.65384614, 'binary_specificity': 0.9443323, 'binary_f1_score': 0.44678053}
confusion matrix:
      0    1
0  5615  331
1    90  170
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-08-03 05:14:29.687785,epoch time: 0:19:20.086116,used: 2:15:35.164575,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_02_58_54_seed_1_24046978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.94577897, 'precision': 0.94742084, 'recall': 0.94580007, 'specificity': 0.94580007, 'f1': 0.9457309, 'auroc': 0.9867176, 'binary_precision': 0.97469896, 'binary_recall': 0.9153948, 'binary_specificity': 0.97620535, 'binary_f1_score': 0.9441165}
confusion matrix:
       0      1
0  28103    685
1   2439  26389
---- Validation: 
scalar performance:
{'acc': 0.9258271, 'precision': 0.62464607, 'recall': 0.76912516, 'specificity': 0.76912516, 'f1': 0.664105, 'auroc': 0.8757062, 'binary_precision': 0.26491803, 'binary_recall': 0.60029715, 'binary_specificity': 0.9379532, 'binary_f1_score': 0.3676069}
confusion matrix:
       0     1
0  16946  1121
1    269   404
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9282952, 'precision': 0.65807176, 'recall': 0.8154609, 'specificity': 0.8154609, 'f1': 0.704433, 'auroc': 0.91480315, 'binary_precision': 0.33027524, 'binary_recall': 0.6923077, 'binary_specificity': 0.9386142, 'binary_f1_score': 0.44720495}
confusion matrix:
      0    1
0  5581  365
1    80  180
early stop counter: 1
val acc:0.9258270859718323, best validation acc: 0.9278014898300171, corresponding to test acc:                         0.9321624040603638 / 0.9321624040603638
after epoch: 8,now: 2024-08-03 05:33:53.070290,epoch time: 0:19:23.382505,used: 2:34:58.547080,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_02_58_54_seed_1_24046978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9508296, 'precision': 0.95190847, 'recall': 0.9508475, 'specificity': 0.9508475, 'f1': 0.9508016, 'auroc': 0.9881426, 'binary_precision': 0.9741719, 'binary_recall': 0.9262895, 'binary_specificity': 0.9754056, 'binary_f1_score': 0.94962746}
confusion matrix:
       0      1
0  28079    708
1   2125  26704
---- Validation: 
scalar performance:
{'acc': 0.9254536, 'precision': 0.6267297, 'recall': 0.77966046, 'specificity': 0.77966046, 'f1': 0.6676536, 'auroc': 0.8809273, 'binary_precision': 0.26824585, 'binary_recall': 0.6225854, 'binary_specificity': 0.9367355, 'binary_f1_score': 0.3749441}
confusion matrix:
       0     1
0  16924  1143
1    254   419
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92346114, 'precision': 0.65303457, 'recall': 0.8294891, 'specificity': 0.8294891, 'f1': 0.7010242, 'auroc': 0.91976637, 'binary_precision': 0.31871837, 'binary_recall': 0.72692305, 'binary_specificity': 0.9320552, 'binary_f1_score': 0.44314185}
confusion matrix:
      0    1
0  5542  404
1    71  189
early stop counter: 2
val acc:0.9254536032676697, best validation acc: 0.9278014898300171, corresponding to test acc:                         0.9321624040603638 / 0.9321624040603638
after epoch: 9,now: 2024-08-03 05:53:09.642140,epoch time: 0:19:16.571850,used: 2:54:15.118930,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_02_58_54_seed_1_24046978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9531554, 'precision': 0.954239, 'recall': 0.9531741, 'specificity': 0.9531741, 'f1': 0.9531288, 'auroc': 0.98952943, 'binary_precision': 0.9766169, 'binary_recall': 0.92861605, 'binary_specificity': 0.97773224, 'binary_f1_score': 0.9520118}
confusion matrix:
       0      1
0  28145    641
1   2058  26772
---- Validation: 
scalar performance:
{'acc': 0.92385274, 'precision': 0.62867236, 'recall': 0.7974272, 'specificity': 0.7974272, 'f1': 0.6717675, 'auroc': 0.8859408, 'binary_precision': 0.27068126, 'binary_recall': 0.6612184, 'binary_specificity': 0.9336359, 'binary_f1_score': 0.38411736}
confusion matrix:
       0     1
0  16868  1199
1    228   445
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9189494, 'precision': 0.6497455, 'recall': 0.84552443, 'specificity': 0.84552443, 'f1': 0.69901705, 'auroc': 0.92412674, 'binary_precision': 0.31045243, 'binary_recall': 0.7653846, 'binary_specificity': 0.9256643, 'binary_f1_score': 0.44173142}
confusion matrix:
      0    1
0  5504  442
1    61  199
early stop counter: 3
val acc:0.9238527417182922, best validation acc: 0.9278014898300171, corresponding to test acc:                         0.9321624040603638 / 0.9321624040603638
after epoch: 10,now: 2024-08-03 06:12:25.385030,epoch time: 0:19:15.742890,used: 3:13:30.861820,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_02_58_54_seed_1_24046978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9546827, 'precision': 0.95573986, 'recall': 0.95470035, 'specificity': 0.95470035, 'f1': 0.9546576, 'auroc': 0.99040836, 'binary_precision': 0.97787255, 'binary_recall': 0.9304867, 'binary_specificity': 0.9789141, 'binary_f1_score': 0.9535913}
confusion matrix:
       0      1
0  28180    607
1   2004  26825
---- Validation: 
scalar performance:
{'acc': 0.9266809, 'precision': 0.63403153, 'recall': 0.80247027, 'specificity': 0.80247027, 'f1': 0.6783754, 'auroc': 0.88740873, 'binary_precision': 0.28107432, 'binary_recall': 0.6686478, 'binary_specificity': 0.9362927, 'binary_f1_score': 0.39577833}
confusion matrix:
       0     1
0  16916  1151
1    223   450
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9194328, 'precision': 0.6512401, 'recall': 0.84945476, 'specificity': 0.84945476, 'f1': 0.7011179, 'auroc': 0.92523026, 'binary_precision': 0.31308413, 'binary_recall': 0.77307695, 'binary_specificity': 0.9258325, 'binary_f1_score': 0.44567627}
confusion matrix:
      0    1
0  5505  441
1    59  201
early stop counter: 4
val acc:0.9266809225082397, best validation acc: 0.9278014898300171, corresponding to test acc:                         0.9321624040603638 / 0.9321624040603638
after epoch: 11,now: 2024-08-03 06:31:56.620777,epoch time: 0:19:31.235747,used: 3:33:02.097567,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_02_58_54_seed_1_24046978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9555158, 'precision': 0.9563875, 'recall': 0.95553267, 'specificity': 0.95553267, 'f1': 0.9554957, 'auroc': 0.9904971, 'binary_precision': 0.9765248, 'binary_recall': 0.9335415, 'binary_specificity': 0.9775238, 'binary_f1_score': 0.9545495}
confusion matrix:
       0      1
0  28139    647
1   1916  26914
---- Validation: 
scalar performance:
{'acc': 0.92684096, 'precision': 0.6344614, 'recall': 0.80326855, 'specificity': 0.80326855, 'f1': 0.67894566, 'auroc': 0.88715863, 'binary_precision': 0.281875, 'binary_recall': 0.6701337, 'binary_specificity': 0.9364034, 'binary_f1_score': 0.39683238}
confusion matrix:
       0     1
0  16918  1149
1    222   451
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91782147, 'precision': 0.6495905, 'recall': 0.8522918, 'specificity': 0.8522918, 'f1': 0.6994341, 'auroc': 0.9248493, 'binary_precision': 0.30945122, 'binary_recall': 0.7807692, 'binary_specificity': 0.92381436, 'binary_f1_score': 0.44323143}
confusion matrix:
      0    1
0  5493  453
1    57  203
early stop counter: 5
val acc:0.9268409609794617, best validation acc: 0.9278014898300171, corresponding to test acc:                         0.9321624040603638 / 0.9321624040603638
after epoch: 12,now: 2024-08-03 06:51:07.885764,epoch time: 0:19:11.264987,used: 3:52:13.362554,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_02_58_54_seed_1_24046978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.95909125, 'precision': 0.9595307, 'recall': 0.9591031, 'specificity': 0.9591031, 'f1': 0.9590821, 'auroc': 0.9917259, 'binary_precision': 0.9739339, 'binary_recall': 0.94349635, 'binary_specificity': 0.9747099, 'binary_f1_score': 0.95847356}
confusion matrix:
       0      1
0  28058    728
1   1629  27201
---- Validation: 
scalar performance:
{'acc': 0.9226254, 'precision': 0.6331215, 'recall': 0.82468605, 'specificity': 0.82468605, 'f1': 0.6794877, 'auroc': 0.8903233, 'binary_precision': 0.2773639, 'binary_recall': 0.7191679, 'binary_specificity': 0.9302042, 'binary_f1_score': 0.40033084}
confusion matrix:
       0     1
0  16806  1261
1    189   484
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90364164, 'precision': 0.6339336, 'recall': 0.8577647, 'specificity': 0.8577647, 'f1': 0.68004495, 'auroc': 0.9287355, 'binary_precision': 0.27704486, 'binary_recall': 0.8076923, 'binary_specificity': 0.9078372, 'binary_f1_score': 0.41257367}
confusion matrix:
      0    1
0  5398  548
1    50  210
early stop counter: 6
val acc:0.9226254224777222, best validation acc: 0.9278014898300171, corresponding to test acc:                         0.9321624040603638 / 0.9321624040603638
after epoch: 13,now: 2024-08-03 07:10:27.479424,epoch time: 0:19:19.593660,used: 4:11:32.956214,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_02_58_54_seed_1_24046978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.95829284, 'precision': 0.9588362, 'recall': 0.9583055, 'specificity': 0.9583055, 'f1': 0.9582813, 'auroc': 0.9916729, 'binary_precision': 0.9748095, 'binary_recall': 0.94096226, 'binary_specificity': 0.9756487, 'binary_f1_score': 0.95758694}
confusion matrix:
       0      1
0  28086    701
1   1702  27127
---- Validation: 
scalar performance:
{'acc': 0.9195304, 'precision': 0.6283261, 'recall': 0.8216504, 'specificity': 0.8216504, 'f1': 0.6734459, 'auroc': 0.8912911, 'binary_precision': 0.26792663, 'binary_recall': 0.7161961, 'binary_specificity': 0.92710465, 'binary_f1_score': 0.38996765}
confusion matrix:
       0     1
0  16750  1317
1    191   482
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89993554, 'precision': 0.6309874, 'recall': 0.8613477, 'specificity': 0.8613477, 'f1': 0.67611766, 'auroc': 0.9300654, 'binary_precision': 0.27064803, 'binary_recall': 0.8192308, 'binary_specificity': 0.9034645, 'binary_f1_score': 0.4068768}
confusion matrix:
      0    1
0  5372  574
1    47  213
early stop counter: 7
val acc:0.9195303916931152, best validation acc: 0.9278014898300171, corresponding to test acc:                         0.9321624040603638 / 0.9321624040603638
after epoch: 14,now: 2024-08-03 07:29:37.240307,epoch time: 0:19:09.760883,used: 4:30:42.717097,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_02_58_54_seed_1_24046978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9619203, 'precision': 0.96216935, 'recall': 0.9619285, 'specificity': 0.9619285, 'f1': 0.9619156, 'auroc': 0.992814, 'binary_precision': 0.9730728, 'binary_recall': 0.9501873, 'binary_specificity': 0.9736696, 'binary_f1_score': 0.9614939}
confusion matrix:
       0      1
0  28030    758
1   1436  27392
---- Validation: 
scalar performance:
{'acc': 0.91307366, 'precision': 0.6225039, 'recall': 0.83046126, 'specificity': 0.83046126, 'f1': 0.666581, 'auroc': 0.89257586, 'binary_precision': 0.2553736, 'binary_recall': 0.74145615, 'binary_specificity': 0.91946644, 'binary_f1_score': 0.37990102}
confusion matrix:
       0     1
0  16612  1455
1    174   499
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8875282, 'precision': 0.6203959, 'recall': 0.86222863, 'specificity': 0.86222863, 'f1': 0.6607564, 'auroc': 0.9330021, 'binary_precision': 0.2488532, 'binary_recall': 0.8346154, 'binary_specificity': 0.8898419, 'binary_f1_score': 0.3833922}
confusion matrix:
      0    1
0  5291  655
1    43  217
early stop counter: 8
val acc:0.9130736589431763, best validation acc: 0.9278014898300171, corresponding to test acc:                         0.9321624040603638 / 0.9321624040603638
after epoch: 15,now: 2024-08-03 07:48:54.643985,epoch time: 0:19:17.403678,used: 4:50:00.120775,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_02_58_54_seed_1_24046978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9620418, 'precision': 0.96232164, 'recall': 0.9620513, 'specificity': 0.9620513, 'f1': 0.9620366, 'auroc': 0.9929528, 'binary_precision': 0.97388923, 'binary_recall': 0.9496011, 'binary_specificity': 0.9745015, 'binary_f1_score': 0.96159184}
confusion matrix:
       0      1
0  28052    734
1   1453  27377
---- Validation: 
scalar performance:
{'acc': 0.9129669, 'precision': 0.6220635, 'recall': 0.82897544, 'specificity': 0.82897544, 'f1': 0.6659364, 'auroc': 0.89334, 'binary_precision': 0.25461066, 'binary_recall': 0.7384844, 'binary_specificity': 0.91946644, 'binary_f1_score': 0.37866667}
confusion matrix:
       0     1
0  16612  1455
1    176   497
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8893007, 'precision': 0.62275136, 'recall': 0.8668316, 'specificity': 0.8668316, 'f1': 0.6642334, 'auroc': 0.93360436, 'binary_precision': 0.2531792, 'binary_recall': 0.8423077, 'binary_specificity': 0.8913555, 'binary_f1_score': 0.38933334}
confusion matrix:
      0    1
0  5300  646
1    41  219
early stop counter: 9
val acc:0.9129669070243835, best validation acc: 0.9278014898300171, corresponding to test acc:                         0.9321624040603638 / 0.9321624040603638
after epoch: 16,now: 2024-08-03 08:08:14.382674,epoch time: 0:19:19.738689,used: 5:09:19.859464,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_02_58_54_seed_1_24046978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9641419, 'precision': 0.9644753, 'recall': 0.9641522, 'specificity': 0.9641522, 'f1': 0.964136, 'auroc': 0.99343944, 'binary_precision': 0.9771107, 'binary_recall': 0.950607, 'binary_specificity': 0.9776975, 'binary_f1_score': 0.96367663}
confusion matrix:
       0      1
0  28144    642
1   1424  27406
---- Validation: 
scalar performance:
{'acc': 0.91990393, 'precision': 0.6299492, 'recall': 0.826851, 'specificity': 0.826851, 'f1': 0.67581475, 'auroc': 0.89378357, 'binary_precision': 0.2707641, 'binary_recall': 0.7265973, 'binary_specificity': 0.92710465, 'binary_f1_score': 0.3945139}
confusion matrix:
       0     1
0  16750  1317
1    184   489
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8986465, 'precision': 0.63076115, 'recall': 0.86619186, 'specificity': 0.86619186, 'f1': 0.6758747, 'auroc': 0.9337907, 'binary_precision': 0.26966292, 'binary_recall': 0.83076924, 'binary_specificity': 0.90161455, 'binary_f1_score': 0.40716305}
confusion matrix:
      0    1
0  5361  585
1    44  216
early stop counter: 10
val acc:0.9199039340019226, best validation acc: 0.9278014898300171, corresponding to test acc:                         0.9321624040603638 / 0.9321624040603638
after epoch: 17,now: 2024-08-03 08:27:28.610051,epoch time: 0:19:14.227377,used: 5:28:34.086841,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_02_58_54_seed_1_24046978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9643849, 'precision': 0.96465045, 'recall': 0.96439326, 'specificity': 0.96439326, 'f1': 0.96438026, 'auroc': 0.99375975, 'binary_precision': 0.9759332, 'binary_recall': 0.9523033, 'binary_specificity': 0.9764833, 'binary_f1_score': 0.96397346}
confusion matrix:
       0      1
0  28111    677
1   1375  27453
---- Validation: 
scalar performance:
{'acc': 0.9163821, 'precision': 0.6263988, 'recall': 0.8307466, 'specificity': 0.8307466, 'f1': 0.67162716, 'auroc': 0.89330196, 'binary_precision': 0.26324153, 'binary_recall': 0.7384844, 'binary_specificity': 0.9230088, 'binary_f1_score': 0.38812965}
confusion matrix:
       0     1
0  16676  1391
1    176   497
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8912343, 'precision': 0.62378395, 'recall': 0.86416274, 'specificity': 0.86416274, 'f1': 0.66581243, 'auroc': 0.9316567, 'binary_precision': 0.25559482, 'binary_recall': 0.8346154, 'binary_specificity': 0.8937101, 'binary_f1_score': 0.39134356}
confusion matrix:
      0    1
0  5314  632
1    43  217
early stop counter: 11
val acc:0.9163820743560791, best validation acc: 0.9278014898300171, corresponding to test acc:                         0.9321624040603638 / 0.9321624040603638
after epoch: 18,now: 2024-08-03 08:46:52.111460,epoch time: 0:19:23.501409,used: 5:47:57.588250,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_02_58_54_seed_1_24046978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9659122, 'precision': 0.96620685, 'recall': 0.9659215, 'specificity': 0.9659215, 'f1': 0.96590734, 'auroc': 0.9937545, 'binary_precision': 0.97810996, 'binary_recall': 0.95320684, 'binary_specificity': 0.9786362, 'binary_f1_score': 0.9654978}
confusion matrix:
       0      1
0  28172    615
1   1349  27480
---- Validation: 
scalar performance:
{'acc': 0.91120595, 'precision': 0.62101555, 'recall': 0.83306897, 'specificity': 0.83306897, 'f1': 0.6647202, 'auroc': 0.8936688, 'binary_precision': 0.25212607, 'binary_recall': 0.7488856, 'binary_specificity': 0.9172524, 'binary_f1_score': 0.37724552}
confusion matrix:
       0     1
0  16572  1495
1    169   504
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88511115, 'precision': 0.6190386, 'recall': 0.86464524, 'specificity': 0.86464524, 'f1': 0.6586114, 'auroc': 0.93212306, 'binary_precision': 0.24579124, 'binary_recall': 0.8423077, 'binary_specificity': 0.88698286, 'binary_f1_score': 0.38053867}
confusion matrix:
      0    1
0  5274  672
1    41  219
early stop counter: 12
val acc:0.9112059473991394, best validation acc: 0.9278014898300171, corresponding to test acc:                         0.9321624040603638 / 0.9321624040603638
after epoch: 19,now: 2024-08-03 09:06:07.308145,epoch time: 0:19:15.196685,used: 6:07:12.784935,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_02_58_54_seed_1_24046978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9665718, 'precision': 0.9668037, 'recall': 0.96658003, 'specificity': 0.96658003, 'f1': 0.966568, 'auroc': 0.9942106, 'binary_precision': 0.9773929, 'binary_recall': 0.95528805, 'binary_specificity': 0.97787195, 'binary_f1_score': 0.9662141}
confusion matrix:
       0      1
0  28150    637
1   1289  27540
---- Validation: 
scalar performance:
{'acc': 0.9057097, 'precision': 0.6152658, 'recall': 0.8323643, 'specificity': 0.8323643, 'f1': 0.6568467, 'auroc': 0.89383113, 'binary_precision': 0.24051234, 'binary_recall': 0.7533432, 'binary_specificity': 0.9113854, 'binary_f1_score': 0.36461705}
confusion matrix:
       0     1
0  16466  1601
1    166   507
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87334836, 'precision': 0.61080426, 'recall': 0.8640236, 'specificity': 0.8640236, 'f1': 0.64534205, 'auroc': 0.9325979, 'binary_precision': 0.22886598, 'binary_recall': 0.85384613, 'binary_specificity': 0.8742011, 'binary_f1_score': 0.3609756}
confusion matrix:
      0    1
0  5198  748
1    38  222
early stop counter: 13
val acc:0.9057096838951111, best validation acc: 0.9278014898300171, corresponding to test acc:                         0.9321624040603638 / 0.9321624040603638
after epoch: 20,now: 2024-08-03 09:25:54.136063,epoch time: 0:19:46.827918,used: 6:26:59.612853,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_02_58_54_seed_1_24046978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 6:26:59.612853 at 2024-08-03 09:25:54.136063
persisted model performance metric: 

scalar performance:
{'acc': 0.9321624, 'precision': 0.66177285, 'recall': 0.7990892, 'specificity': 0.7990892, 'f1': 0.70532316, 'auroc': 0.909629, 'binary_precision': 0.33932135, 'binary_recall': 0.65384614, 'binary_specificity': 0.9443323, 'binary_f1_score': 0.44678053}
confusion matrix:
      0    1
0  5615  331
1    90  170
oracle model performance metric: 

scalar performance:
{'acc': 0.9321624, 'precision': 0.66177285, 'recall': 0.7990892, 'specificity': 0.7990892, 'f1': 0.70532316, 'auroc': 0.909629, 'binary_precision': 0.33932135, 'binary_recall': 0.65384614, 'binary_specificity': 0.9443323, 'binary_f1_score': 0.44678053}
confusion matrix:
      0    1
0  5615  331
1    90  170
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_halffreeze_seed3_2024-08-02_13-31-15/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_halffreeze_seed3_2024-08-02_13-31-15/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 196690 KiB |   7828 MiB |    941 TiB |    941 TiB |
|       from large pool | 179211 KiB |   7805 MiB |    926 TiB |    926 TiB |
|       from small pool |  17479 KiB |     37 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 196690 KiB |   7828 MiB |    941 TiB |    941 TiB |
|       from large pool | 179211 KiB |   7805 MiB |    926 TiB |    926 TiB |
|       from small pool |  17479 KiB |     37 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195459 KiB |   7827 MiB |    941 TiB |    941 TiB |
|       from large pool | 178979 KiB |   7804 MiB |    926 TiB |    926 TiB |
|       from small pool |  16480 KiB |     36 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8512 MiB |   8530 MiB |  16790 MiB |   8278 MiB |
|       from large pool |   8472 MiB |   8486 MiB |  16732 MiB |   8260 MiB |
|       from small pool |     40 MiB |     44 MiB |     58 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  38830 KiB | 732464 KiB | 522212 GiB | 522212 GiB |
|       from large pool |  31733 KiB | 730714 KiB | 507687 GiB | 507687 GiB |
|       from small pool |   7097 KiB |  23272 KiB |  14524 GiB |  14524 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2954    |    7697    |  184999 K  |  184996 K  |
|       from large pool |      79    |     762    |   89600 K  |   89600 K  |
|       from small pool |    2875    |    7616    |   95398 K  |   95395 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2954    |    7697    |  184999 K  |  184996 K  |
|       from large pool |      79    |     762    |   89600 K  |   89600 K  |
|       from small pool |    2875    |    7616    |   95398 K  |   95395 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     368    |     371    |     715    |     347    |
|       from large pool |     348    |     349    |     686    |     338    |
|       from small pool |      20    |      22    |      29    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      35    |    3623    |  103503 K  |  103503 K  |
|       from large pool |      11    |     351    |   62532 K  |   62532 K  |
|       from small pool |      24    |    3613    |   40970 K  |   40970 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |    941 TiB |    941 TiB |
|       from large pool |  16640 KiB |   7805 MiB |    926 TiB |    926 TiB |
|       from small pool |      0 KiB |     37 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |    941 TiB |    941 TiB |
|       from large pool |  16640 KiB |   7805 MiB |    926 TiB |    926 TiB |
|       from small pool |      0 KiB |     37 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |    941 TiB |    941 TiB |
|       from large pool |  16640 KiB |   7804 MiB |    926 TiB |    926 TiB |
|       from small pool |      0 KiB |     36 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 235520 KiB |   8530 MiB |  16790 MiB |  16560 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  16732 MiB |  16526 MiB |
|       from small pool |  24576 KiB |     44 MiB |     58 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB | 522212 GiB | 522212 GiB |
|       from large pool |  30464 KiB | 730714 KiB | 507687 GiB | 507687 GiB |
|       from small pool |      0 KiB |  23272 KiB |  14524 GiB |  14524 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7697    |  184999 K  |  184999 K  |
|       from large pool |       2    |     762    |   89600 K  |   89600 K  |
|       from small pool |       0    |    7616    |   95398 K  |   95398 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7697    |  184999 K  |  184999 K  |
|       from large pool |       2    |     762    |   89600 K  |   89600 K  |
|       from small pool |       0    |    7616    |   95398 K  |   95398 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |     371    |     715    |     693    |
|       from large pool |      10    |     349    |     686    |     676    |
|       from small pool |      12    |      22    |      29    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3623    |  103504 K  |  103504 K  |
|       from large pool |       3    |     351    |   62532 K  |   62532 K  |
|       from small pool |       0    |    3613    |   40971 K  |   40971 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |    941 TiB |    941 TiB |
|       from large pool |  16640 KiB |   7805 MiB |    926 TiB |    926 TiB |
|       from small pool |      0 KiB |     37 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |    941 TiB |    941 TiB |
|       from large pool |  16640 KiB |   7805 MiB |    926 TiB |    926 TiB |
|       from small pool |      0 KiB |     37 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |    941 TiB |    941 TiB |
|       from large pool |  16640 KiB |   7804 MiB |    926 TiB |    926 TiB |
|       from small pool |      0 KiB |     36 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 235520 KiB |   8530 MiB |  16790 MiB |  16560 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  16732 MiB |  16526 MiB |
|       from small pool |  24576 KiB |     44 MiB |     58 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB | 522212 GiB | 522212 GiB |
|       from large pool |  30464 KiB | 730714 KiB | 507687 GiB | 507687 GiB |
|       from small pool |      0 KiB |  23272 KiB |  14524 GiB |  14524 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7697    |  184999 K  |  184999 K  |
|       from large pool |       2    |     762    |   89600 K  |   89600 K  |
|       from small pool |       0    |    7616    |   95398 K  |   95398 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7697    |  184999 K  |  184999 K  |
|       from large pool |       2    |     762    |   89600 K  |   89600 K  |
|       from small pool |       0    |    7616    |   95398 K  |   95398 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |     371    |     715    |     693    |
|       from large pool |      10    |     349    |     686    |     676    |
|       from small pool |      12    |      22    |      29    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3623    |  103504 K  |  103504 K  |
|       from large pool |       3    |     351    |   62532 K  |   62532 K  |
|       from small pool |       0    |    3613    |   40971 K  |   40971 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_09_35_51_seed_2_24046978

 Experiment start at: 2024-08-03 09:35:51.550610
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.754768431186676
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.8648806, 'precision': 0.86644113, 'recall': 0.8648862, 'specificity': 0.8648862, 'f1': 0.8647379, 'auroc': 0.9301807, 'binary_precision': 0.89039737, 'binary_recall': 0.832253, 'binary_specificity': 0.89751947, 'binary_f1_score': 0.86034393}
confusion matrix:
       0      1
0  26160   2987
1   4891  24266
---- Validation: 
scalar performance:
{'acc': 0.8517019, 'precision': 0.5453281, 'recall': 0.6848891, 'specificity': 0.6848891, 'f1': 0.5491055, 'auroc': 0.7503714, 'binary_precision': 0.10924069, 'binary_recall': 0.50664455, 'binary_specificity': 0.86313355, 'binary_f1_score': 0.17972893}
confusion matrix:
       0     1
0  15684  2487
1    297   305
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7054015, 'precision': 0.50325775, 'recall': 0.51762176, 'specificity': 0.51762176, 'f1': 0.45056704, 'auroc': 0.5533841, 'binary_precision': 0.04347826, 'binary_recall': 0.3140496, 'binary_specificity': 0.7211939, 'binary_f1_score': 0.076381914}
confusion matrix:
      0     1
0  4325  1672
1   166    76
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-03 09:56:36.882647,epoch time: 0:20:45.332037,used: 0:20:45.332037,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_09_35_51_seed_2_24046978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.905907, 'precision': 0.9093377, 'recall': 0.9059117, 'specificity': 0.9059117, 'f1': 0.9057101, 'auroc': 0.96093774, 'binary_precision': 0.94683784, 'binary_recall': 0.8601269, 'binary_specificity': 0.95169646, 'binary_f1_score': 0.9014019}
confusion matrix:
       0      1
0  27741   1408
1   4078  25077
---- Validation: 
scalar performance:
{'acc': 0.9123209, 'precision': 0.5630765, 'recall': 0.64794356, 'specificity': 0.64794356, 'f1': 0.5822558, 'auroc': 0.76986504, 'binary_precision': 0.14824797, 'binary_recall': 0.3654485, 'binary_specificity': 0.93043864, 'binary_f1_score': 0.21093}
confusion matrix:
       0     1
0  16907  1264
1    382   220
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8451675, 'precision': 0.5198621, 'recall': 0.5625664, 'specificity': 0.5625664, 'f1': 0.51446766, 'auroc': 0.65631366, 'binary_precision': 0.07311321, 'binary_recall': 0.25619835, 'binary_specificity': 0.86893445, 'binary_f1_score': 0.11376148}
confusion matrix:
      0    1
0  5211  786
1   180   62
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-03 10:16:41.334122,epoch time: 0:20:04.451475,used: 0:40:49.783512,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_09_35_51_seed_2_24046978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9195939, 'precision': 0.92060304, 'recall': 0.91959804, 'specificity': 0.91959804, 'f1': 0.9195461, 'auroc': 0.97019446, 'binary_precision': 0.9412486, 'binary_recall': 0.8950852, 'binary_specificity': 0.9441109, 'binary_f1_score': 0.9175867}
confusion matrix:
       0      1
0  27518   1629
1   3059  26098
---- Validation: 
scalar performance:
{'acc': 0.91839343, 'precision': 0.5733662, 'recall': 0.6631262, 'specificity': 0.6631262, 'f1': 0.5958319, 'auroc': 0.7881715, 'binary_precision': 0.16785714, 'binary_recall': 0.39036545, 'binary_specificity': 0.93588686, 'binary_f1_score': 0.23476523}
confusion matrix:
       0     1
0  17006  1165
1    367   235
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8567078, 'precision': 0.53375345, 'recall': 0.60227597, 'specificity': 0.60227597, 'f1': 0.5359737, 'auroc': 0.7211712, 'binary_precision': 0.097530864, 'binary_recall': 0.3264463, 'binary_specificity': 0.8781057, 'binary_f1_score': 0.15019011}
confusion matrix:
      0    1
0  5266  731
1   163   79
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-03 10:36:26.570938,epoch time: 0:19:45.236816,used: 1:00:35.020328,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_09_35_51_seed_2_24046978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9314627, 'precision': 0.9345225, 'recall': 0.9314684, 'specificity': 0.9314684, 'f1': 0.9313424, 'auroc': 0.97743285, 'binary_precision': 0.9710199, 'binary_recall': 0.889491, 'binary_specificity': 0.97344583, 'binary_f1_score': 0.9284691}
confusion matrix:
       0      1
0  28374    774
1   3222  25934
---- Validation: 
scalar performance:
{'acc': 0.93485326, 'precision': 0.5882299, 'recall': 0.64753723, 'specificity': 0.64753723, 'f1': 0.6085086, 'auroc': 0.79914296, 'binary_precision': 0.19883609, 'binary_recall': 0.34053156, 'binary_specificity': 0.95454293, 'binary_f1_score': 0.25107163}
confusion matrix:
       0    1
0  17345  826
1    397  205
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8861997, 'precision': 0.54925835, 'recall': 0.6195997, 'specificity': 0.6195997, 'f1': 0.5613717, 'auroc': 0.7597773, 'binary_precision': 0.12738854, 'binary_recall': 0.3305785, 'binary_specificity': 0.90862095, 'binary_f1_score': 0.18390805}
confusion matrix:
      0    1
0  5449  548
1   162   80
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-03 10:56:08.750370,epoch time: 0:19:42.179432,used: 1:20:17.199760,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_09_35_51_seed_2_24046978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.93882066, 'precision': 0.9405204, 'recall': 0.93882596, 'specificity': 0.93882596, 'f1': 0.93876207, 'auroc': 0.9814893, 'binary_precision': 0.96792716, 'binary_recall': 0.90774083, 'binary_specificity': 0.96991116, 'binary_f1_score': 0.9368683}
confusion matrix:
       0      1
0  28270    877
1   2690  26467
---- Validation: 
scalar performance:
{'acc': 0.9333085, 'precision': 0.6003315, 'recall': 0.6876948, 'specificity': 0.6876948, 'f1': 0.6276299, 'auroc': 0.81579906, 'binary_precision': 0.22030981, 'binary_recall': 0.42524916, 'binary_specificity': 0.95014036, 'binary_f1_score': 0.29024944}
confusion matrix:
       0    1
0  17265  906
1    346  256
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87754446, 'precision': 0.5632338, 'recall': 0.67854524, 'specificity': 0.67854524, 'f1': 0.580114, 'auroc': 0.7967627, 'binary_precision': 0.15013404, 'binary_recall': 0.46280992, 'binary_specificity': 0.8942805, 'binary_f1_score': 0.22672065}
confusion matrix:
      0    1
0  5363  634
1   130  112
early stop counter: 1
val acc:0.933308482170105, best validation acc: 0.9348532557487488, corresponding to test acc:                         0.8861997127532959 / 0.8861997127532959
after epoch: 5,now: 2024-08-03 11:15:54.311783,epoch time: 0:19:45.561413,used: 1:40:02.761173,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_09_35_51_seed_2_24046978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9455269, 'precision': 0.9467212, 'recall': 0.9455322, 'specificity': 0.9455322, 'f1': 0.94549096, 'auroc': 0.98438966, 'binary_precision': 0.9698712, 'binary_recall': 0.9196447, 'binary_specificity': 0.97141975, 'binary_f1_score': 0.9440905}
confusion matrix:
       0      1
0  28313    833
1   2343  26815
---- Validation: 
scalar performance:
{'acc': 0.9317104, 'precision': 0.60421634, 'recall': 0.70774853, 'specificity': 0.70774853, 'f1': 0.6348076, 'auroc': 0.8247384, 'binary_precision': 0.2266881, 'binary_recall': 0.46843854, 'binary_specificity': 0.9470585, 'binary_f1_score': 0.30552545}
confusion matrix:
       0    1
0  17209  962
1    320  282
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8682481, 'precision': 0.5699737, 'recall': 0.72129524, 'specificity': 0.72129524, 'f1': 0.5882112, 'auroc': 0.82358617, 'binary_precision': 0.15962441, 'binary_recall': 0.56198347, 'binary_specificity': 0.88060695, 'binary_f1_score': 0.24862888}
confusion matrix:
      0    1
0  5281  716
1   106  136
early stop counter: 2
val acc:0.931710422039032, best validation acc: 0.9348532557487488, corresponding to test acc:                         0.8861997127532959 / 0.8861997127532959
after epoch: 6,now: 2024-08-03 11:35:48.903399,epoch time: 0:19:54.591616,used: 1:59:57.352789,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_09_35_51_seed_2_24046978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9488028, 'precision': 0.95040596, 'recall': 0.94880694, 'specificity': 0.94880694, 'f1': 0.9487576, 'auroc': 0.98679495, 'binary_precision': 0.9773117, 'binary_recall': 0.91895324, 'binary_specificity': 0.97866064, 'binary_f1_score': 0.94723445}
confusion matrix:
       0      1
0  28526    622
1   2363  26793
---- Validation: 
scalar performance:
{'acc': 0.92787516, 'precision': 0.6025121, 'recall': 0.7210252, 'specificity': 0.7210252, 'f1': 0.63486326, 'auroc': 0.83061194, 'binary_precision': 0.22230428, 'binary_recall': 0.5, 'binary_specificity': 0.9420505, 'binary_f1_score': 0.30777097}
confusion matrix:
       0     1
0  17118  1053
1    301   301
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8615163, 'precision': 0.5745079, 'recall': 0.7534828, 'specificity': 0.7534828, 'f1': 0.59318954, 'auroc': 0.844332, 'binary_precision': 0.1655914, 'binary_recall': 0.6363636, 'binary_specificity': 0.87060195, 'binary_f1_score': 0.26279864}
confusion matrix:
      0    1
0  5221  776
1    88  154
early stop counter: 3
val acc:0.9278751611709595, best validation acc: 0.9348532557487488, corresponding to test acc:                         0.8861997127532959 / 0.8861997127532959
after epoch: 7,now: 2024-08-03 11:55:37.439247,epoch time: 0:19:48.535848,used: 2:19:45.888637,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_09_35_51_seed_2_24046978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9508439, 'precision': 0.9526114, 'recall': 0.95084924, 'specificity': 0.95084924, 'f1': 0.95079625, 'auroc': 0.98869383, 'binary_precision': 0.9809388, 'binary_recall': 0.91957337, 'binary_specificity': 0.9821251, 'binary_f1_score': 0.94926536}
confusion matrix:
       0      1
0  28626    521
1   2345  26812
---- Validation: 
scalar performance:
{'acc': 0.9369307, 'precision': 0.6124522, 'recall': 0.70562685, 'specificity': 0.70562685, 'f1': 0.64245445, 'auroc': 0.83272016, 'binary_precision': 0.24338624, 'binary_recall': 0.45847178, 'binary_specificity': 0.9527819, 'binary_f1_score': 0.31797233}
confusion matrix:
       0    1
0  17313  858
1    326  276
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8836352, 'precision': 0.58819133, 'recall': 0.76102304, 'specificity': 0.76102304, 'f1': 0.6158642, 'auroc': 0.8540012, 'binary_precision': 0.1928934, 'binary_recall': 0.6280992, 'binary_specificity': 0.89394695, 'binary_f1_score': 0.29514563}
confusion matrix:
      0    1
0  5361  636
1    90  152
better model found
persisted
after epoch: 8,now: 2024-08-03 12:15:24.471145,epoch time: 0:19:47.031898,used: 2:39:32.920535,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_09_35_51_seed_2_24046978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.95221597, 'precision': 0.9540291, 'recall': 0.9522203, 'specificity': 0.9522203, 'f1': 0.95216846, 'auroc': 0.9893747, 'binary_precision': 0.9827548, 'binary_recall': 0.9205995, 'binary_specificity': 0.98384106, 'binary_f1_score': 0.9506623}
confusion matrix:
       0      1
0  28677    471
1   2315  26841
---- Validation: 
scalar performance:
{'acc': 0.9387951, 'precision': 0.6173544, 'recall': 0.7098021, 'specificity': 0.7098021, 'f1': 0.6478076, 'auroc': 0.8377975, 'binary_precision': 0.25293586, 'binary_recall': 0.4651163, 'binary_specificity': 0.9544879, 'binary_f1_score': 0.32767698}
confusion matrix:
       0    1
0  17344  827
1    322  280
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89132875, 'precision': 0.59739876, 'recall': 0.7769215, 'specificity': 0.7769215, 'f1': 0.6294344, 'auroc': 0.86421096, 'binary_precision': 0.21010639, 'binary_recall': 0.6528926, 'binary_specificity': 0.9009505, 'binary_f1_score': 0.31790745}
confusion matrix:
      0    1
0  5403  594
1    84  158
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-08-03 12:35:13.845446,epoch time: 0:19:49.374301,used: 2:59:22.294836,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_09_35_51_seed_2_24046978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.95590353, 'precision': 0.9570091, 'recall': 0.95590943, 'specificity': 0.95590943, 'f1': 0.9558772, 'auroc': 0.9899466, 'binary_precision': 0.9795469, 'binary_recall': 0.93127334, 'binary_specificity': 0.9805455, 'binary_f1_score': 0.9548003}
confusion matrix:
       0      1
0  28578    567
1   2004  27155
---- Validation: 
scalar performance:
{'acc': 0.9359186, 'precision': 0.61747324, 'recall': 0.7283925, 'specificity': 0.7283925, 'f1': 0.6513963, 'auroc': 0.84161365, 'binary_precision': 0.25185797, 'binary_recall': 0.50664455, 'binary_specificity': 0.95014036, 'binary_f1_score': 0.3364589}
confusion matrix:
       0    1
0  17265  906
1    297  305
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8887642, 'precision': 0.60026354, 'recall': 0.7973976, 'specificity': 0.7973976, 'f1': 0.6334434, 'auroc': 0.8739376, 'binary_precision': 0.21392405, 'binary_recall': 0.6983471, 'binary_specificity': 0.8964482, 'binary_f1_score': 0.3275194}
confusion matrix:
      0    1
0  5376  621
1    73  169
early stop counter: 1
val acc:0.9359186291694641, best validation acc: 0.9387950897216797, corresponding to test acc:                         0.891328752040863 / 0.891328752040863
after epoch: 10,now: 2024-08-03 12:55:02.143983,epoch time: 0:19:48.298537,used: 3:19:10.593373,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_09_35_51_seed_2_24046978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.95830476, 'precision': 0.9589009, 'recall': 0.95830786, 'specificity': 0.95830786, 'f1': 0.9582914, 'auroc': 0.99040437, 'binary_precision': 0.9754839, 'binary_recall': 0.9402545, 'binary_specificity': 0.9763612, 'binary_f1_score': 0.9575453}
confusion matrix:
       0      1
0  28458    689
1   1742  27415
---- Validation: 
scalar performance:
{'acc': 0.92414635, 'precision': 0.6047526, 'recall': 0.74720585, 'specificity': 0.74720585, 'f1': 0.64022076, 'auroc': 0.84722686, 'binary_precision': 0.2248996, 'binary_recall': 0.55813956, 'binary_specificity': 0.9362721, 'binary_f1_score': 0.3206107}
confusion matrix:
       0     1
0  17013  1158
1    266   336
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8663247, 'precision': 0.590753, 'recall': 0.81744903, 'specificity': 0.81744903, 'f1': 0.6166667, 'auroc': 0.8809735, 'binary_precision': 0.1923077, 'binary_recall': 0.7644628, 'binary_specificity': 0.87043524, 'binary_f1_score': 0.30730897}
confusion matrix:
      0    1
0  5220  777
1    57  185
early stop counter: 2
val acc:0.9241463541984558, best validation acc: 0.9387950897216797, corresponding to test acc:                         0.891328752040863 / 0.891328752040863
after epoch: 11,now: 2024-08-03 13:14:50.524403,epoch time: 0:19:48.380420,used: 3:38:58.973793,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_09_35_51_seed_2_24046978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.95859635, 'precision': 0.9593836, 'recall': 0.9586013, 'specificity': 0.9586013, 'f1': 0.9585789, 'auroc': 0.9916383, 'binary_precision': 0.9784608, 'binary_recall': 0.9378579, 'binary_specificity': 0.97934467, 'binary_f1_score': 0.9577292}
confusion matrix:
       0      1
0  28543    602
1   1812  27347
---- Validation: 
scalar performance:
{'acc': 0.93016565, 'precision': 0.6105141, 'recall': 0.73746634, 'specificity': 0.73746634, 'f1': 0.64560294, 'auroc': 0.8480333, 'binary_precision': 0.23721275, 'binary_recall': 0.53156143, 'binary_specificity': 0.9433713, 'binary_f1_score': 0.3280369}
confusion matrix:
       0     1
0  17142  1029
1    282   320
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87594163, 'precision': 0.59552413, 'recall': 0.81452054, 'specificity': 0.81452054, 'f1': 0.62521, 'auroc': 0.88565636, 'binary_precision': 0.20246086, 'binary_recall': 0.74793386, 'binary_specificity': 0.8811072, 'binary_f1_score': 0.31866196}
confusion matrix:
      0    1
0  5284  713
1    61  181
early stop counter: 3
val acc:0.9301656484603882, best validation acc: 0.9387950897216797, corresponding to test acc:                         0.891328752040863 / 0.891328752040863
after epoch: 12,now: 2024-08-03 13:36:38.923592,epoch time: 0:21:48.399189,used: 4:00:47.372982,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_09_35_51_seed_2_24046978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.96074027, 'precision': 0.96147436, 'recall': 0.96074367, 'specificity': 0.96074367, 'f1': 0.96072483, 'auroc': 0.9921522, 'binary_precision': 0.97992283, 'binary_recall': 0.94076896, 'binary_specificity': 0.98071843, 'binary_f1_score': 0.9599468}
confusion matrix:
       0      1
0  28585    562
1   1727  27430
---- Validation: 
scalar performance:
{'acc': 0.92755556, 'precision': 0.6100268, 'recall': 0.7497699, 'specificity': 0.7497699, 'f1': 0.6465349, 'auroc': 0.8546958, 'binary_precision': 0.2353352, 'binary_recall': 0.5598007, 'binary_specificity': 0.93973917, 'binary_f1_score': 0.33136678}
confusion matrix:
       0     1
0  17076  1095
1    265   337
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8730566, 'precision': 0.59560156, 'recall': 0.8229335, 'specificity': 0.8229335, 'f1': 0.6247929, 'auroc': 0.8903667, 'binary_precision': 0.20173536, 'binary_recall': 0.76859504, 'binary_specificity': 0.87727195, 'binary_f1_score': 0.31958762}
confusion matrix:
      0    1
0  5261  736
1    56  186
early stop counter: 4
val acc:0.9275555610656738, best validation acc: 0.9387950897216797, corresponding to test acc:                         0.891328752040863 / 0.891328752040863
after epoch: 13,now: 2024-08-03 13:59:15.722145,epoch time: 0:22:36.798553,used: 4:23:24.171535,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_09_35_51_seed_2_24046978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9633644, 'precision': 0.9639375, 'recall': 0.96336627, 'specificity': 0.96336627, 'f1': 0.9633532, 'auroc': 0.9926119, 'binary_precision': 0.9802695, 'binary_recall': 0.9457726, 'binary_specificity': 0.9809599, 'binary_f1_score': 0.9627121}
confusion matrix:
       0      1
0  28594    555
1   1581  27574
---- Validation: 
scalar performance:
{'acc': 0.92345387, 'precision': 0.6081235, 'recall': 0.7637121, 'specificity': 0.7637121, 'f1': 0.6456699, 'auroc': 0.85935044, 'binary_precision': 0.23047127, 'binary_recall': 0.59302324, 'binary_specificity': 0.934401, 'binary_f1_score': 0.33193865}
confusion matrix:
       0     1
0  16979  1192
1    245   357
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8666453, 'precision': 0.59300363, 'recall': 0.82752943, 'specificity': 0.82752943, 'f1': 0.6198404, 'auroc': 0.89554626, 'binary_precision': 0.19587629, 'binary_recall': 0.78512394, 'binary_specificity': 0.869935, 'binary_f1_score': 0.31353134}
confusion matrix:
      0    1
0  5217  780
1    52  190
early stop counter: 5
val acc:0.9234538674354553, best validation acc: 0.9387950897216797, corresponding to test acc:                         0.891328752040863 / 0.891328752040863
after epoch: 14,now: 2024-08-03 14:21:29.249151,epoch time: 0:22:13.527006,used: 4:45:37.698541,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_09_35_51_seed_2_24046978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.96333015, 'precision': 0.9637208, 'recall': 0.9633321, 'specificity': 0.9633321, 'f1': 0.9633226, 'auroc': 0.9928426, 'binary_precision': 0.97721493, 'binary_recall': 0.9487927, 'binary_specificity': 0.97787154, 'binary_f1_score': 0.9627941}
confusion matrix:
       0      1
0  28503    645
1   1493  27663
---- Validation: 
scalar performance:
{'acc': 0.9262771, 'precision': 0.6126326, 'recall': 0.76677656, 'specificity': 0.76677656, 'f1': 0.651266, 'auroc': 0.86338925, 'binary_precision': 0.23933333, 'binary_recall': 0.59634554, 'binary_specificity': 0.93720764, 'binary_f1_score': 0.34157944}
confusion matrix:
       0     1
0  17030  1141
1    243   359
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86985093, 'precision': 0.594675, 'recall': 0.82721424, 'specificity': 0.82721424, 'f1': 0.62285614, 'auroc': 0.89865184, 'binary_precision': 0.19936709, 'binary_recall': 0.78099173, 'binary_specificity': 0.8734367, 'binary_f1_score': 0.31764707}
confusion matrix:
      0    1
0  5238  759
1    53  189
early stop counter: 6
val acc:0.9262771010398865, best validation acc: 0.9387950897216797, corresponding to test acc:                         0.891328752040863 / 0.891328752040863
after epoch: 15,now: 2024-08-03 14:43:29.102894,epoch time: 0:21:59.853743,used: 5:07:37.552284,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_09_35_51_seed_2_24046978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9652168, 'precision': 0.96572995, 'recall': 0.9652196, 'specificity': 0.9652196, 'f1': 0.96520734, 'auroc': 0.99330103, 'binary_precision': 0.98123246, 'binary_recall': 0.94858867, 'binary_specificity': 0.9818506, 'binary_f1_score': 0.9646345}
confusion matrix:
       0      1
0  28618    529
1   1499  27658
---- Validation: 
scalar performance:
{'acc': 0.92989933, 'precision': 0.61773413, 'recall': 0.7662386, 'specificity': 0.7662386, 'f1': 0.6570166, 'auroc': 0.86583936, 'binary_precision': 0.24964938, 'binary_recall': 0.5913621, 'binary_specificity': 0.94111496, 'binary_f1_score': 0.3510848}
confusion matrix:
       0     1
0  17101  1070
1    246   356
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8772239, 'precision': 0.59980184, 'recall': 0.83104944, 'specificity': 0.83104944, 'f1': 0.6314177, 'auroc': 0.9006872, 'binary_precision': 0.20953436, 'binary_recall': 0.78099173, 'binary_specificity': 0.8811072, 'binary_f1_score': 0.3304196}
confusion matrix:
      0    1
0  5284  713
1    53  189
early stop counter: 7
val acc:0.9298993349075317, best validation acc: 0.9387950897216797, corresponding to test acc:                         0.891328752040863 / 0.891328752040863
after epoch: 16,now: 2024-08-03 15:05:58.481214,epoch time: 0:22:29.378320,used: 5:30:06.930604,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_09_35_51_seed_2_24046978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.96173507, 'precision': 0.9628475, 'recall': 0.9617384, 'specificity': 0.9617384, 'f1': 0.96171224, 'auroc': 0.9929179, 'binary_precision': 0.9855726, 'binary_recall': 0.9371999, 'binary_specificity': 0.9862769, 'binary_f1_score': 0.9607778}
confusion matrix:
       0      1
0  28748    400
1   1831  27325
---- Validation: 
scalar performance:
{'acc': 0.92872745, 'precision': 0.6172419, 'recall': 0.77125454, 'specificity': 0.77125454, 'f1': 0.65701747, 'auroc': 0.86878467, 'binary_precision': 0.24829002, 'binary_recall': 0.60299003, 'binary_specificity': 0.939519, 'binary_f1_score': 0.3517442}
confusion matrix:
       0     1
0  17072  1099
1    239   363
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87626225, 'precision': 0.600338, 'recall': 0.8364974, 'specificity': 0.8364974, 'f1': 0.631997, 'auroc': 0.9025994, 'binary_precision': 0.21006565, 'binary_recall': 0.7933884, 'binary_specificity': 0.8796065, 'binary_f1_score': 0.3321799}
confusion matrix:
      0    1
0  5275  722
1    50  192
early stop counter: 8
val acc:0.9287274479866028, best validation acc: 0.9387950897216797, corresponding to test acc:                         0.891328752040863 / 0.891328752040863
after epoch: 17,now: 2024-08-03 15:28:35.609274,epoch time: 0:22:37.128060,used: 5:52:44.058664,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_09_35_51_seed_2_24046978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9665375, 'precision': 0.9670484, 'recall': 0.9665409, 'specificity': 0.9665409, 'f1': 0.96652853, 'auroc': 0.9939795, 'binary_precision': 0.98254764, 'binary_recall': 0.94996226, 'binary_specificity': 0.9831195, 'binary_f1_score': 0.96598023}
confusion matrix:
       0      1
0  28654    492
1   1459  27699
---- Validation: 
scalar performance:
{'acc': 0.9218026, 'precision': 0.60960585, 'recall': 0.77811706, 'specificity': 0.77811706, 'f1': 0.64859146, 'auroc': 0.86915815, 'binary_precision': 0.23238567, 'binary_recall': 0.62458473, 'binary_specificity': 0.9316493, 'binary_f1_score': 0.33873874}
confusion matrix:
       0     1
0  16929  1242
1    226   376
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86728644, 'precision': 0.59381926, 'recall': 0.8298457, 'specificity': 0.8298457, 'f1': 0.62111, 'auroc': 0.90208805, 'binary_precision': 0.19731405, 'binary_recall': 0.7892562, 'binary_specificity': 0.87043524, 'binary_f1_score': 0.3157025}
confusion matrix:
      0    1
0  5220  777
1    51  191
early stop counter: 9
val acc:0.9218025803565979, best validation acc: 0.9387950897216797, corresponding to test acc:                         0.891328752040863 / 0.891328752040863
after epoch: 18,now: 2024-08-03 15:48:37.316446,epoch time: 0:20:01.707172,used: 6:12:45.765836,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_09_35_51_seed_2_24046978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9666747, 'precision': 0.9672242, 'recall': 0.9666788, 'specificity': 0.9666788, 'f1': 0.966665, 'auroc': 0.9944132, 'binary_precision': 0.9833073, 'binary_recall': 0.9494839, 'binary_specificity': 0.9838737, 'binary_f1_score': 0.96609956}
confusion matrix:
       0      1
0  28675    470
1   1473  27686
---- Validation: 
scalar performance:
{'acc': 0.9158366, 'precision': 0.6041295, 'recall': 0.78386873, 'specificity': 0.78386873, 'f1': 0.64195275, 'auroc': 0.8686335, 'binary_precision': 0.22089042, 'binary_recall': 0.64285713, 'binary_specificity': 0.9248803, 'binary_f1_score': 0.32880208}
confusion matrix:
       0     1
0  16806  1365
1    215   387
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8579901, 'precision': 0.58938307, 'recall': 0.8309582, 'specificity': 0.8309582, 'f1': 0.6127368, 'auroc': 0.90434337, 'binary_precision': 0.1879845, 'binary_recall': 0.8016529, 'binary_specificity': 0.86026347, 'binary_f1_score': 0.3045526}
confusion matrix:
      0    1
0  5159  838
1    48  194
early stop counter: 10
val acc:0.9158365726470947, best validation acc: 0.9387950897216797, corresponding to test acc:                         0.891328752040863 / 0.891328752040863
after epoch: 19,now: 2024-08-03 16:08:46.994716,epoch time: 0:20:09.678270,used: 6:32:55.444106,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_09_35_51_seed_2_24046978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9712027, 'precision': 0.9715136, 'recall': 0.9712049, 'specificity': 0.9712049, 'f1': 0.97119796, 'auroc': 0.9951311, 'binary_precision': 0.9836654, 'binary_recall': 0.958329, 'binary_specificity': 0.9840807, 'binary_f1_score': 0.97083193}
confusion matrix:
       0      1
0  28683    464
1   1215  27942
---- Validation: 
scalar performance:
{'acc': 0.9197784, 'precision': 0.60826826, 'recall': 0.7826928, 'specificity': 0.7826928, 'f1': 0.6472268, 'auroc': 0.87294424, 'binary_precision': 0.22934131, 'binary_recall': 0.63621265, 'binary_specificity': 0.9291729, 'binary_f1_score': 0.3371479}
confusion matrix:
       0     1
0  16884  1287
1    219   383
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8684084, 'precision': 0.59535456, 'recall': 0.8343948, 'specificity': 0.8343948, 'f1': 0.6234797, 'auroc': 0.90725386, 'binary_precision': 0.2, 'binary_recall': 0.79752064, 'binary_specificity': 0.871269, 'binary_f1_score': 0.31980118}
confusion matrix:
      0    1
0  5225  772
1    49  193
early stop counter: 11
val acc:0.9197784066200256, best validation acc: 0.9387950897216797, corresponding to test acc:                         0.891328752040863 / 0.891328752040863
after epoch: 20,now: 2024-08-03 16:29:22.298509,epoch time: 0:20:35.303793,used: 6:53:30.747899,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_09_35_51_seed_2_24046978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 6:53:30.747899 at 2024-08-03 16:29:22.298509
persisted model performance metric: 

scalar performance:
{'acc': 0.89132875, 'precision': 0.59739876, 'recall': 0.7769215, 'specificity': 0.7769215, 'f1': 0.6294344, 'auroc': 0.86421096, 'binary_precision': 0.21010639, 'binary_recall': 0.6528926, 'binary_specificity': 0.9009505, 'binary_f1_score': 0.31790745}
confusion matrix:
      0    1
0  5403  594
1    84  158
oracle model performance metric: 

scalar performance:
{'acc': 0.89132875, 'precision': 0.59739876, 'recall': 0.7769215, 'specificity': 0.7769215, 'f1': 0.6294344, 'auroc': 0.86421096, 'binary_precision': 0.21010639, 'binary_recall': 0.6528926, 'binary_specificity': 0.9009505, 'binary_f1_score': 0.31790745}
confusion matrix:
      0    1
0  5403  594
1    84  158
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_halffreeze_seed3_2024-08-02_13-31-15/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_halffreeze_seed3_2024-08-02_13-31-15/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 196696 KiB |   7828 MiB |   1433 TiB |   1433 TiB |
|       from large pool | 179211 KiB |   7805 MiB |   1412 TiB |   1412 TiB |
|       from small pool |  17485 KiB |     37 MiB |     21 TiB |     21 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 196696 KiB |   7828 MiB |   1433 TiB |   1433 TiB |
|       from large pool | 179211 KiB |   7805 MiB |   1412 TiB |   1412 TiB |
|       from small pool |  17485 KiB |     37 MiB |     21 TiB |     21 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195460 KiB |   7827 MiB |   1433 TiB |   1433 TiB |
|       from large pool | 178979 KiB |   7804 MiB |   1412 TiB |   1412 TiB |
|       from small pool |  16481 KiB |     36 MiB |     21 TiB |     21 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8512 MiB |   8530 MiB |  25072 MiB |  16560 MiB |
|       from large pool |   8472 MiB |   8486 MiB |  24998 MiB |  16526 MiB |
|       from small pool |     40 MiB |     44 MiB |     74 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  40872 KiB | 732464 KiB | 784859 GiB | 784859 GiB |
|       from large pool |  31733 KiB | 730714 KiB | 762850 GiB | 762850 GiB |
|       from small pool |   9139 KiB |  23272 KiB |  22009 GiB |  22009 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2966    |    7783    |  280478 K  |  280475 K  |
|       from large pool |      79    |     762    |  136426 K  |  136426 K  |
|       from small pool |    2887    |    7702    |  144052 K  |  144049 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2966    |    7783    |  280478 K  |  280475 K  |
|       from large pool |      79    |     762    |  136426 K  |  136426 K  |
|       from small pool |    2887    |    7702    |  144052 K  |  144049 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     368    |     371    |    1061    |     693    |
|       from large pool |     348    |     349    |    1024    |     676    |
|       from small pool |      20    |      22    |      37    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      35    |    3667    |  154246 K  |  154246 K  |
|       from large pool |      11    |     351    |   92769 K  |   92769 K  |
|       from small pool |      24    |    3657    |   61477 K  |   61477 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |   1433 TiB |   1433 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   1412 TiB |   1412 TiB |
|       from small pool |      0 KiB |     37 MiB |     21 TiB |     21 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |   1433 TiB |   1433 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   1412 TiB |   1412 TiB |
|       from small pool |      0 KiB |     37 MiB |     21 TiB |     21 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |   1433 TiB |   1433 TiB |
|       from large pool |  16640 KiB |   7804 MiB |   1412 TiB |   1412 TiB |
|       from small pool |      0 KiB |     36 MiB |     21 TiB |     21 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 237568 KiB |   8530 MiB |  25072 MiB |  24840 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  24998 MiB |  24792 MiB |
|       from small pool |  26624 KiB |     44 MiB |     74 MiB |     48 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB | 784860 GiB | 784860 GiB |
|       from large pool |  30464 KiB | 730714 KiB | 762850 GiB | 762850 GiB |
|       from small pool |      0 KiB |  23272 KiB |  22009 GiB |  22009 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7783    |  280478 K  |  280478 K  |
|       from large pool |       2    |     762    |  136426 K  |  136426 K  |
|       from small pool |       0    |    7702    |  144052 K  |  144052 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7783    |  280478 K  |  280478 K  |
|       from large pool |       2    |     762    |  136426 K  |  136426 K  |
|       from small pool |       0    |    7702    |  144052 K  |  144052 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |     371    |    1061    |    1038    |
|       from large pool |      10    |     349    |    1024    |    1014    |
|       from small pool |      13    |      22    |      37    |      24    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3667    |  154247 K  |  154247 K  |
|       from large pool |       3    |     351    |   92769 K  |   92769 K  |
|       from small pool |       0    |    3657    |   61478 K  |   61478 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |   1433 TiB |   1433 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   1412 TiB |   1412 TiB |
|       from small pool |      0 KiB |     37 MiB |     21 TiB |     21 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |   1433 TiB |   1433 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   1412 TiB |   1412 TiB |
|       from small pool |      0 KiB |     37 MiB |     21 TiB |     21 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |   1433 TiB |   1433 TiB |
|       from large pool |  16640 KiB |   7804 MiB |   1412 TiB |   1412 TiB |
|       from small pool |      0 KiB |     36 MiB |     21 TiB |     21 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 237568 KiB |   8530 MiB |  25072 MiB |  24840 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  24998 MiB |  24792 MiB |
|       from small pool |  26624 KiB |     44 MiB |     74 MiB |     48 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB | 784860 GiB | 784860 GiB |
|       from large pool |  30464 KiB | 730714 KiB | 762850 GiB | 762850 GiB |
|       from small pool |      0 KiB |  23272 KiB |  22009 GiB |  22009 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7783    |  280478 K  |  280478 K  |
|       from large pool |       2    |     762    |  136426 K  |  136426 K  |
|       from small pool |       0    |    7702    |  144052 K  |  144052 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7783    |  280478 K  |  280478 K  |
|       from large pool |       2    |     762    |  136426 K  |  136426 K  |
|       from small pool |       0    |    7702    |  144052 K  |  144052 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |     371    |    1061    |    1038    |
|       from large pool |      10    |     349    |    1024    |    1014    |
|       from small pool |      13    |      22    |      37    |      24    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3667    |  154247 K  |  154247 K  |
|       from large pool |       3    |     351    |   92769 K  |   92769 K  |
|       from small pool |       0    |    3657    |   61478 K  |   61478 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_16_39_57_seed_3_24046978

 Experiment start at: 2024-08-03 16:39:57.296446
before training, model accuracy: 0.7207813262939453
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.86185217, 'precision': 0.8679726, 'recall': 0.8619083, 'specificity': 0.8619083, 'f1': 0.8612884, 'auroc': 0.93446517, 'binary_precision': 0.91564775, 'binary_recall': 0.79740405, 'binary_specificity': 0.92641264, 'binary_f1_score': 0.852445}
confusion matrix:
       0      1
0  26576   2111
1   5822  22915
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.9111289, 'precision': 0.51172894, 'recall': 0.5206805, 'specificity': 0.5206805, 'f1': 0.51279575, 'auroc': 0.63194215, 'binary_precision': 0.056034483, 'binary_recall': 0.10172144, 'binary_specificity': 0.9396395, 'binary_f1_score': 0.07226237}
confusion matrix:
       0     1
0  17046  1095
1    574    65
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92651296, 'precision': 0.5578412, 'recall': 0.55255973, 'specificity': 0.55255973, 'f1': 0.55501133, 'auroc': 0.5651375, 'binary_precision': 0.15625, 'binary_recall': 0.14134276, 'binary_specificity': 0.96377665, 'binary_f1_score': 0.148423}
confusion matrix:
      0    1
0  5747  216
1   243   40
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-03 17:02:48.468863,epoch time: 0:22:51.172417,used: 0:22:51.172417,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_16_39_57_seed_3_24046978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.8928671, 'precision': 0.9012077, 'recall': 0.8929349, 'specificity': 0.8929349, 'f1': 0.8923192, 'auroc': 0.95869464, 'binary_precision': 0.95929074, 'binary_recall': 0.8207662, 'binary_specificity': 0.9651037, 'binary_f1_score': 0.8846385}
confusion matrix:
       0      1
0  27684   1001
1   5151  23588
---- Validation: 
scalar performance:
{'acc': 0.9260383, 'precision': 0.53068614, 'recall': 0.543496, 'specificity': 0.543496, 'f1': 0.535231, 'auroc': 0.7106428, 'binary_precision': 0.092391305, 'binary_recall': 0.13302034, 'binary_specificity': 0.9539717, 'binary_f1_score': 0.109044254}
confusion matrix:
       0    1
0  17306  835
1    554   85
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9345181, 'precision': 0.59384465, 'recall': 0.57694745, 'specificity': 0.57694745, 'f1': 0.58429295, 'auroc': 0.70777863, 'binary_precision': 0.22608696, 'binary_recall': 0.18374558, 'binary_specificity': 0.9701493, 'binary_f1_score': 0.20272903}
confusion matrix:
      0    1
0  5785  178
1   231   52
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-03 17:25:18.554934,epoch time: 0:22:30.086071,used: 0:45:21.258488,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_16_39_57_seed_3_24046978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9186925, 'precision': 0.92269504, 'recall': 0.91873837, 'specificity': 0.91873837, 'f1': 0.91850543, 'auroc': 0.97077656, 'binary_precision': 0.96406263, 'binary_recall': 0.86996764, 'binary_specificity': 0.96750915, 'binary_f1_score': 0.9146013}
confusion matrix:
       0      1
0  27753    932
1   3737  25002
---- Validation: 
scalar performance:
{'acc': 0.9267306, 'precision': 0.56805927, 'recall': 0.6133061, 'specificity': 0.6133061, 'f1': 0.58311033, 'auroc': 0.7622274, 'binary_precision': 0.16223648, 'binary_recall': 0.2769953, 'binary_specificity': 0.9496169, 'binary_f1_score': 0.20462428}
confusion matrix:
       0    1
0  17227  914
1    462  177
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92971504, 'precision': 0.59936976, 'recall': 0.60304177, 'specificity': 0.60304177, 'f1': 0.6011619, 'auroc': 0.7833574, 'binary_precision': 0.23469388, 'binary_recall': 0.24381626, 'binary_specificity': 0.96226734, 'binary_f1_score': 0.23916811}
confusion matrix:
      0    1
0  5738  225
1   214   69
better model found
persisted
after epoch: 3,now: 2024-08-03 17:49:41.095243,epoch time: 0:24:22.540309,used: 1:09:43.798797,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_16_39_57_seed_3_24046978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9305691, 'precision': 0.93347174, 'recall': 0.9306077, 'specificity': 0.9306077, 'f1': 0.9304569, 'auroc': 0.9776933, 'binary_precision': 0.96917886, 'binary_recall': 0.8895577, 'binary_specificity': 0.97165763, 'binary_f1_score': 0.92766297}
confusion matrix:
       0      1
0  27872    813
1   3174  25565
---- Validation: 
scalar performance:
{'acc': 0.9254526, 'precision': 0.58168775, 'recall': 0.65039015, 'specificity': 0.65039015, 'f1': 0.60283345, 'auroc': 0.79866076, 'binary_precision': 0.18683128, 'binary_recall': 0.35524258, 'binary_specificity': 0.94553775, 'binary_f1_score': 0.24487597}
confusion matrix:
       0    1
0  17153  988
1    412  227
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92619276, 'precision': 0.6020164, 'recall': 0.6213923, 'specificity': 0.6213923, 'f1': 0.6105957, 'auroc': 0.82792234, 'binary_precision': 0.2382353, 'binary_recall': 0.2862191, 'binary_specificity': 0.9565655, 'binary_f1_score': 0.26003212}
confusion matrix:
      0    1
0  5704  259
1   202   81
early stop counter: 1
val acc:0.9254525899887085, best validation acc: 0.9267305731773376, corresponding to test acc:                         0.9297150373458862 / 0.9345180988311768
after epoch: 4,now: 2024-08-03 18:18:52.441386,epoch time: 0:29:11.346143,used: 1:38:55.144940,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_16_39_57_seed_3_24046978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9358979, 'precision': 0.9391091, 'recall': 0.93593824, 'specificity': 0.93593824, 'f1': 0.93578446, 'auroc': 0.9810538, 'binary_precision': 0.9768956, 'binary_recall': 0.8930373, 'binary_specificity': 0.9788391, 'binary_f1_score': 0.9330861}
confusion matrix:
       0      1
0  28078    607
1   3074  25665
---- Validation: 
scalar performance:
{'acc': 0.9328008, 'precision': 0.5916559, 'recall': 0.64890933, 'specificity': 0.64890933, 'f1': 0.6116625, 'auroc': 0.8196422, 'binary_precision': 0.20696142, 'binary_recall': 0.34428796, 'binary_specificity': 0.95353067, 'binary_f1_score': 0.25851938}
confusion matrix:
       0    1
0  17298  843
1    419  220
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93243676, 'precision': 0.62554204, 'recall': 0.6414918, 'specificity': 0.6414918, 'f1': 0.6329133, 'auroc': 0.8475007, 'binary_precision': 0.2834891, 'binary_recall': 0.32155478, 'binary_specificity': 0.9614288, 'binary_f1_score': 0.30132452}
confusion matrix:
      0    1
0  5733  230
1   192   91
better model found
persisted
after epoch: 5,now: 2024-08-03 18:46:56.309882,epoch time: 0:28:03.868496,used: 2:06:59.013436,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_16_39_57_seed_3_24046978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.94314224, 'precision': 0.9450282, 'recall': 0.943173, 'specificity': 0.943173, 'f1': 0.9430846, 'auroc': 0.98309577, 'binary_precision': 0.9742349, 'binary_recall': 0.91047007, 'binary_specificity': 0.9758759, 'binary_f1_score': 0.9412738}
confusion matrix:
       0      1
0  27993    692
1   2573  26166
---- Validation: 
scalar performance:
{'acc': 0.9282215, 'precision': 0.60251373, 'recall': 0.6993828, 'specificity': 0.6993828, 'f1': 0.6314994, 'auroc': 0.83265257, 'binary_precision': 0.22498061, 'binary_recall': 0.45383412, 'binary_specificity': 0.9449314, 'binary_f1_score': 0.3008299}
confusion matrix:
       0    1
0  17142  999
1    349  290
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93243676, 'precision': 0.64930385, 'recall': 0.70544326, 'specificity': 0.70544326, 'f1': 0.6718427, 'auroc': 0.8632367, 'binary_precision': 0.32493702, 'binary_recall': 0.4558304, 'binary_specificity': 0.9550562, 'binary_f1_score': 0.37941176}
confusion matrix:
      0    1
0  5695  268
1   154  129
early stop counter: 1
val acc:0.9282215237617493, best validation acc: 0.932800829410553, corresponding to test acc:                         0.9324367642402649 / 0.9345180988311768
after epoch: 6,now: 2024-08-03 19:10:20.013608,epoch time: 0:23:23.703726,used: 2:30:22.717162,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_16_39_57_seed_3_24046978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.94862777, 'precision': 0.9493642, 'recall': 0.9486462, 'specificity': 0.9486462, 'f1': 0.9486081, 'auroc': 0.9851916, 'binary_precision': 0.96778405, 'binary_recall': 0.9282483, 'binary_specificity': 0.96904415, 'binary_f1_score': 0.94760394}
confusion matrix:
       0      1
0  27798    888
1   2062  26676
---- Validation: 
scalar performance:
{'acc': 0.9124601, 'precision': 0.5985078, 'recall': 0.7531271, 'specificity': 0.7531271, 'f1': 0.632408, 'auroc': 0.84811074, 'binary_precision': 0.21269296, 'binary_recall': 0.58215964, 'binary_specificity': 0.9240946, 'binary_f1_score': 0.31155777}
confusion matrix:
       0     1
0  16764  1377
1    267   372
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92347103, 'precision': 0.64682996, 'recall': 0.7613333, 'specificity': 0.7613333, 'f1': 0.6837526, 'auroc': 0.87505877, 'binary_precision': 0.31428573, 'binary_recall': 0.58303887, 'binary_specificity': 0.9396277, 'binary_f1_score': 0.40841585}
confusion matrix:
      0    1
0  5603  360
1   118  165
early stop counter: 2
val acc:0.9124600887298584, best validation acc: 0.932800829410553, corresponding to test acc:                         0.9324367642402649 / 0.9345180988311768
after epoch: 7,now: 2024-08-03 19:29:27.766987,epoch time: 0:19:07.753379,used: 2:49:30.470541,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_16_39_57_seed_3_24046978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.94826204, 'precision': 0.949852, 'recall': 0.94829017, 'specificity': 0.94829017, 'f1': 0.9482185, 'auroc': 0.9861377, 'binary_precision': 0.976832, 'binary_recall': 0.91840357, 'binary_specificity': 0.9781768, 'binary_f1_score': 0.94671714}
confusion matrix:
       0      1
0  28059    626
1   2345  26394
---- Validation: 
scalar performance:
{'acc': 0.9300852, 'precision': 0.61307794, 'recall': 0.7245046, 'specificity': 0.7245046, 'f1': 0.6460981, 'auroc': 0.8518348, 'binary_precision': 0.24430956, 'binary_recall': 0.5039124, 'binary_specificity': 0.94509673, 'binary_f1_score': 0.32907513}
confusion matrix:
       0    1
0  17145  996
1    317  322
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93852067, 'precision': 0.67797565, 'recall': 0.75406885, 'specificity': 0.75406885, 'f1': 0.7078612, 'auroc': 0.8812625, 'binary_precision': 0.37772396, 'binary_recall': 0.55123675, 'binary_specificity': 0.9569009, 'binary_f1_score': 0.44827586}
confusion matrix:
      0    1
0  5706  257
1   127  156
new oracle model saved
early stop counter: 3
val acc:0.9300851821899414, best validation acc: 0.932800829410553, corresponding to test acc:                         0.9324367642402649 / 0.9385206699371338
after epoch: 8,now: 2024-08-03 19:48:39.256939,epoch time: 0:19:11.489952,used: 3:08:41.960493,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_16_39_57_seed_3_24046978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.95395654, 'precision': 0.9548659, 'recall': 0.9539777, 'specificity': 0.9539777, 'f1': 0.953935, 'auroc': 0.9878063, 'binary_precision': 0.97544, 'binary_recall': 0.93145204, 'binary_specificity': 0.9765034, 'binary_f1_score': 0.9529387}
confusion matrix:
       0      1
0  28011    674
1   1970  26769
---- Validation: 
scalar performance:
{'acc': 0.928115, 'precision': 0.61255276, 'recall': 0.7332986, 'specificity': 0.7332986, 'f1': 0.64684886, 'auroc': 0.85779774, 'binary_precision': 0.24257784, 'binary_recall': 0.52425665, 'binary_specificity': 0.94234055, 'binary_f1_score': 0.33168313}
confusion matrix:
       0     1
0  17095  1046
1    304   335
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93627924, 'precision': 0.6752226, 'recall': 0.7680413, 'specificity': 0.7680413, 'f1': 0.70973235, 'auroc': 0.88673794, 'binary_precision': 0.37078652, 'binary_recall': 0.58303887, 'binary_specificity': 0.95304376, 'binary_f1_score': 0.45329672}
confusion matrix:
      0    1
0  5683  280
1   118  165
early stop counter: 4
val acc:0.9281150102615356, best validation acc: 0.932800829410553, corresponding to test acc:                         0.9324367642402649 / 0.9385206699371338
after epoch: 9,now: 2024-08-03 20:17:03.001872,epoch time: 0:28:23.744933,used: 3:37:05.705426,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_16_39_57_seed_3_24046978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9553845, 'precision': 0.9564439, 'recall': 0.95540816, 'specificity': 0.95540816, 'f1': 0.9553602, 'auroc': 0.9887289, 'binary_precision': 0.97867906, 'binary_recall': 0.93114126, 'binary_specificity': 0.97967505, 'binary_f1_score': 0.9543185}
confusion matrix:
       0      1
0  28101    583
1   1979  26761
---- Validation: 
scalar performance:
{'acc': 0.9348243, 'precision': 0.6210805, 'recall': 0.7239379, 'specificity': 0.7239379, 'f1': 0.6538249, 'auroc': 0.8611227, 'binary_precision': 0.26044226, 'binary_recall': 0.4976526, 'binary_specificity': 0.95022327, 'binary_f1_score': 0.3419355}
confusion matrix:
       0    1
0  17238  903
1    321  318
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94332373, 'precision': 0.6965406, 'recall': 0.77677953, 'specificity': 0.77677953, 'f1': 0.7284808, 'auroc': 0.88959956, 'binary_precision': 0.4127764, 'binary_recall': 0.59363955, 'binary_specificity': 0.9599195, 'binary_f1_score': 0.4869565}
confusion matrix:
      0    1
0  5724  239
1   115  168
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-08-03 20:48:01.361457,epoch time: 0:30:58.359585,used: 4:08:04.065011,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_16_39_57_seed_3_24046978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.95541936, 'precision': 0.9561994, 'recall': 0.9554397, 'specificity': 0.9554397, 'f1': 0.95540166, 'auroc': 0.9892833, 'binary_precision': 0.97530866, 'binary_recall': 0.9345859, 'binary_specificity': 0.9762934, 'binary_f1_score': 0.95451313}
confusion matrix:
       0      1
0  28004    680
1   1880  26860
---- Validation: 
scalar performance:
{'acc': 0.9327476, 'precision': 0.6241027, 'recall': 0.7477751, 'specificity': 0.7477751, 'f1': 0.66088474, 'auroc': 0.8682393, 'binary_precision': 0.2647059, 'binary_recall': 0.5492958, 'binary_specificity': 0.9462543, 'binary_f1_score': 0.35725194}
confusion matrix:
       0    1
0  17166  975
1    288  351
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9417227, 'precision': 0.6928185, 'recall': 0.78267276, 'specificity': 0.78267276, 'f1': 0.72749317, 'auroc': 0.89293474, 'binary_precision': 0.40470588, 'binary_recall': 0.60777384, 'binary_specificity': 0.9575717, 'binary_f1_score': 0.4858757}
confusion matrix:
      0    1
0  5710  253
1   111  172
early stop counter: 1
val acc:0.9327476024627686, best validation acc: 0.9348242878913879, corresponding to test acc:                         0.9433237314224243 / 0.9433237314224243
after epoch: 11,now: 2024-08-03 21:38:44.307049,epoch time: 0:50:42.945592,used: 4:58:47.010603,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_16_39_57_seed_3_24046978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9576135, 'precision': 0.957793, 'recall': 0.9576223, 'specificity': 0.9576223, 'f1': 0.9576099, 'auroc': 0.9895922, 'binary_precision': 0.96707743, 'binary_recall': 0.9475589, 'binary_specificity': 0.9676857, 'binary_f1_score': 0.95721865}
confusion matrix:
       0      1
0  27760    927
1   1507  27230
---- Validation: 
scalar performance:
{'acc': 0.93423855, 'precision': 0.625734, 'recall': 0.7440173, 'specificity': 0.7440173, 'f1': 0.6618923, 'auroc': 0.86864245, 'binary_precision': 0.2682737, 'binary_recall': 0.5399061, 'binary_specificity': 0.9481285, 'binary_f1_score': 0.35844156}
confusion matrix:
       0    1
0  17200  941
1    294  345
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94252324, 'precision': 0.69523567, 'recall': 0.783092, 'specificity': 0.783092, 'f1': 0.7294397, 'auroc': 0.893556, 'binary_precision': 0.40952381, 'binary_recall': 0.60777384, 'binary_specificity': 0.9584102, 'binary_f1_score': 0.48933145}
confusion matrix:
      0    1
0  5715  248
1   111  172
early stop counter: 2
val acc:0.9342385530471802, best validation acc: 0.9348242878913879, corresponding to test acc:                         0.9433237314224243 / 0.9433237314224243
after epoch: 12,now: 2024-08-03 22:36:52.035006,epoch time: 0:58:07.727957,used: 5:56:54.738560,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_16_39_57_seed_3_24046978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.962002, 'precision': 0.9623573, 'recall': 0.9620147, 'specificity': 0.9620147, 'f1': 0.9619953, 'auroc': 0.9918366, 'binary_precision': 0.9754028, 'binary_recall': 0.94797826, 'binary_specificity': 0.97605103, 'binary_f1_score': 0.961495}
confusion matrix:
       0      1
0  27999    687
1   1495  27243
---- Validation: 
scalar performance:
{'acc': 0.93556976, 'precision': 0.6273626, 'recall': 0.7409318, 'specificity': 0.7409318, 'f1': 0.6629331, 'auroc': 0.87312603, 'binary_precision': 0.27178258, 'binary_recall': 0.53208137, 'binary_specificity': 0.94978225, 'binary_f1_score': 0.35978836}
confusion matrix:
       0    1
0  17230  911
1    299  340
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94508487, 'precision': 0.7033711, 'recall': 0.7844336, 'specificity': 0.7844336, 'f1': 0.73583615, 'auroc': 0.8962003, 'binary_precision': 0.42574257, 'binary_recall': 0.60777384, 'binary_specificity': 0.9610934, 'binary_f1_score': 0.50072783}
confusion matrix:
      0    1
0  5731  232
1   111  172
new oracle model saved
better model found
persisted
after epoch: 13,now: 2024-08-03 23:42:15.684566,epoch time: 1:05:23.649560,used: 7:02:18.388120,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_16_39_57_seed_3_24046978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9602605, 'precision': 0.9610182, 'recall': 0.96027905, 'specificity': 0.96027905, 'f1': 0.96024525, 'auroc': 0.99123096, 'binary_precision': 0.9799361, 'binary_recall': 0.9398358, 'binary_specificity': 0.9807223, 'binary_f1_score': 0.9594671}
confusion matrix:
       0      1
0  28133    553
1   1729  27009
---- Validation: 
scalar performance:
{'acc': 0.93466455, 'precision': 0.62383044, 'recall': 0.734424, 'specificity': 0.734424, 'f1': 0.6583687, 'auroc': 0.8726554, 'binary_precision': 0.26517573, 'binary_recall': 0.5195618, 'binary_specificity': 0.94928616, 'binary_f1_score': 0.35113695}
confusion matrix:
       0    1
0  17221  920
1    307  332
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9436439, 'precision': 0.6992833, 'recall': 0.7870449, 'specificity': 0.7870449, 'f1': 0.7336461, 'auroc': 0.8965322, 'binary_precision': 0.4172662, 'binary_recall': 0.614841, 'binary_specificity': 0.9592487, 'binary_f1_score': 0.4971429}
confusion matrix:
      0    1
0  5720  243
1   109  174
early stop counter: 1
val acc:0.9346645474433899, best validation acc: 0.9355697631835938, corresponding to test acc:                         0.9450848698616028 / 0.9450848698616028
after epoch: 14,now: 2024-08-04 00:48:57.240711,epoch time: 1:06:41.556145,used: 8:08:59.944265,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_16_39_57_seed_3_24046978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.96322095, 'precision': 0.9635967, 'recall': 0.96323454, 'specificity': 0.96323454, 'f1': 0.9632142, 'auroc': 0.9921956, 'binary_precision': 0.9770325, 'binary_recall': 0.9488152, 'binary_specificity': 0.9776538, 'binary_f1_score': 0.9627171}
confusion matrix:
       0      1
0  28044    641
1   1471  27268
---- Validation: 
scalar performance:
{'acc': 0.9298189, 'precision': 0.62203455, 'recall': 0.75833774, 'specificity': 0.75833774, 'f1': 0.6602907, 'auroc': 0.87530696, 'binary_precision': 0.25973105, 'binary_recall': 0.5743349, 'binary_specificity': 0.94234055, 'binary_f1_score': 0.3576998}
confusion matrix:
       0     1
0  17095  1046
1    272   367
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9415626, 'precision': 0.6970335, 'recall': 0.80951583, 'specificity': 0.80951583, 'f1': 0.7381805, 'auroc': 0.8996266, 'binary_precision': 0.41048035, 'binary_recall': 0.66431093, 'binary_specificity': 0.9547208, 'binary_f1_score': 0.5074223}
confusion matrix:
      0    1
0  5693  270
1    95  188
early stop counter: 2
val acc:0.9298189282417297, best validation acc: 0.9355697631835938, corresponding to test acc:                         0.9450848698616028 / 0.9450848698616028
after epoch: 15,now: 2024-08-04 01:49:05.676255,epoch time: 1:00:08.435544,used: 9:09:08.379809,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_16_39_57_seed_3_24046978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.96262884, 'precision': 0.9633516, 'recall': 0.9626469, 'specificity': 0.9626469, 'f1': 0.9626153, 'auroc': 0.99250686, 'binary_precision': 0.9818788, 'binary_recall': 0.94272393, 'binary_specificity': 0.9825699, 'binary_f1_score': 0.9619031}
confusion matrix:
       0      1
0  28186    500
1   1646  27092
---- Validation: 
scalar performance:
{'acc': 0.94233227, 'precision': 0.6352657, 'recall': 0.7180103, 'specificity': 0.7180103, 'f1': 0.6650561, 'auroc': 0.8756349, 'binary_precision': 0.28937382, 'binary_recall': 0.4773083, 'binary_specificity': 0.9587123, 'binary_f1_score': 0.36030716}
confusion matrix:
       0    1
0  17392  749
1    334  305
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9505283, 'precision': 0.72209054, 'recall': 0.77886987, 'specificity': 0.77886987, 'f1': 0.746681, 'auroc': 0.8991985, 'binary_precision': 0.46388888, 'binary_recall': 0.590106, 'binary_specificity': 0.9676337, 'binary_f1_score': 0.5194401}
confusion matrix:
      0    1
0  5770  193
1   116  167
new oracle model saved
better model found
persisted
after epoch: 16,now: 2024-08-04 02:46:23.200806,epoch time: 0:57:17.524551,used: 10:06:25.904360,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_16_39_57_seed_3_24046978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9647186, 'precision': 0.9650918, 'recall': 0.96473205, 'specificity': 0.96473205, 'f1': 0.9647122, 'auroc': 0.99299014, 'binary_precision': 0.97850466, 'binary_recall': 0.95038104, 'binary_specificity': 0.9790831, 'binary_f1_score': 0.9642378}
confusion matrix:
       0      1
0  28085    600
1   1426  27313
---- Validation: 
scalar performance:
{'acc': 0.93556976, 'precision': 0.62757224, 'recall': 0.7416867, 'specificity': 0.7416867, 'f1': 0.6632706, 'auroc': 0.8771492, 'binary_precision': 0.27214685, 'binary_recall': 0.53364635, 'binary_specificity': 0.9497271, 'binary_f1_score': 0.36046514}
confusion matrix:
       0    1
0  17229  912
1    298  341
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94540507, 'precision': 0.7067223, 'recall': 0.7997477, 'specificity': 0.7997477, 'f1': 0.7430054, 'auroc': 0.90001106, 'binary_precision': 0.43095237, 'binary_recall': 0.63957596, 'binary_specificity': 0.9599195, 'binary_f1_score': 0.51493603}
confusion matrix:
      0    1
0  5724  239
1   102  181
early stop counter: 1
val acc:0.9355697631835938, best validation acc: 0.9423322677612305, corresponding to test acc:                         0.9505283236503601 / 0.9505283236503601
after epoch: 17,now: 2024-08-04 03:43:13.798993,epoch time: 0:56:50.598187,used: 11:03:16.502547,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_16_39_57_seed_3_24046978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.96646, 'precision': 0.96685517, 'recall': 0.9664739, 'specificity': 0.9664739, 'f1': 0.96645355, 'auroc': 0.9934411, 'binary_precision': 0.98067474, 'binary_recall': 0.95173806, 'binary_specificity': 0.9812097, 'binary_f1_score': 0.9659897}
confusion matrix:
       0      1
0  28146    539
1   1387  27352
---- Validation: 
scalar performance:
{'acc': 0.9361555, 'precision': 0.6268775, 'recall': 0.73519576, 'specificity': 0.73519576, 'f1': 0.66141313, 'auroc': 0.8752487, 'binary_precision': 0.27124184, 'binary_recall': 0.5195618, 'binary_specificity': 0.9508296, 'binary_f1_score': 0.3564144}
confusion matrix:
       0    1
0  17249  892
1    307  332
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.946846, 'precision': 0.7109961, 'recall': 0.79713655, 'specificity': 0.79713655, 'f1': 0.7453549, 'auroc': 0.90122366, 'binary_precision': 0.43980345, 'binary_recall': 0.6325088, 'binary_specificity': 0.9617642, 'binary_f1_score': 0.5188406}
confusion matrix:
      0    1
0  5735  228
1   104  179
early stop counter: 2
val acc:0.9361554980278015, best validation acc: 0.9423322677612305, corresponding to test acc:                         0.9505283236503601 / 0.9505283236503601
after epoch: 18,now: 2024-08-04 04:34:57.898741,epoch time: 0:51:44.099748,used: 11:55:00.602295,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_16_39_57_seed_3_24046978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.96652967, 'precision': 0.9667531, 'recall': 0.9665394, 'specificity': 0.9665394, 'f1': 0.96652615, 'auroc': 0.9935267, 'binary_precision': 0.9771862, 'binary_recall': 0.9554233, 'binary_specificity': 0.9776554, 'binary_f1_score': 0.9661822}
confusion matrix:
       0      1
0  28046    641
1   1281  27456
---- Validation: 
scalar performance:
{'acc': 0.93541, 'precision': 0.6266147, 'recall': 0.7393393, 'specificity': 0.7393393, 'f1': 0.661928, 'auroc': 0.875975, 'binary_precision': 0.2704, 'binary_recall': 0.52895147, 'binary_specificity': 0.9497271, 'binary_f1_score': 0.35786128}
confusion matrix:
       0    1
0  17229  912
1    301  338
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94636565, 'precision': 0.7091445, 'recall': 0.795202, 'specificity': 0.795202, 'f1': 0.743404, 'auroc': 0.9021664, 'binary_precision': 0.4362745, 'binary_recall': 0.6289753, 'binary_specificity': 0.9614288, 'binary_f1_score': 0.51519537}
confusion matrix:
      0    1
0  5733  230
1   105  178
early stop counter: 3
val acc:0.9354100227355957, best validation acc: 0.9423322677612305, corresponding to test acc:                         0.9505283236503601 / 0.9505283236503601
after epoch: 19,now: 2024-08-04 05:24:54.828549,epoch time: 0:49:56.929808,used: 12:44:57.532103,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_16_39_57_seed_3_24046978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.96738297, 'precision': 0.96783984, 'recall': 0.96739674, 'specificity': 0.96739674, 'f1': 0.96737564, 'auroc': 0.9936317, 'binary_precision': 0.9826793, 'binary_recall': 0.9515955, 'binary_specificity': 0.983198, 'binary_f1_score': 0.96688765}
confusion matrix:
       0      1
0  28205    482
1   1391  27346
---- Validation: 
scalar performance:
{'acc': 0.9344515, 'precision': 0.62636185, 'recall': 0.74488246, 'specificity': 0.74488246, 'f1': 0.66265583, 'auroc': 0.8775146, 'binary_precision': 0.2694704, 'binary_recall': 0.54147106, 'binary_specificity': 0.9482939, 'binary_f1_score': 0.3598544}
confusion matrix:
       0    1
0  17203  938
1    293  346
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94636565, 'precision': 0.7100879, 'recall': 0.80193377, 'specificity': 0.80193377, 'f1': 0.7461687, 'auroc': 0.9019816, 'binary_precision': 0.4375, 'binary_recall': 0.64310956, 'binary_specificity': 0.96075803, 'binary_f1_score': 0.52074397}
confusion matrix:
      0    1
0  5729  234
1   101  182
early stop counter: 4
val acc:0.9344515204429626, best validation acc: 0.9423322677612305, corresponding to test acc:                         0.9505283236503601 / 0.9505283236503601
after epoch: 20,now: 2024-08-04 06:13:50.707517,epoch time: 0:48:55.878968,used: 13:33:53.411071,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_16_39_57_seed_3_24046978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 13:33:53.411071 at 2024-08-04 06:13:50.707517
persisted model performance metric: 

scalar performance:
{'acc': 0.9505283, 'precision': 0.72209054, 'recall': 0.77886987, 'specificity': 0.77886987, 'f1': 0.746681, 'auroc': 0.8991985, 'binary_precision': 0.46388888, 'binary_recall': 0.590106, 'binary_specificity': 0.9676337, 'binary_f1_score': 0.5194401}
confusion matrix:
      0    1
0  5770  193
1   116  167
oracle model performance metric: 

scalar performance:
{'acc': 0.9505283, 'precision': 0.72209054, 'recall': 0.77886987, 'specificity': 0.77886987, 'f1': 0.746681, 'auroc': 0.8991985, 'binary_precision': 0.46388888, 'binary_recall': 0.590106, 'binary_specificity': 0.9676337, 'binary_f1_score': 0.5194401}
confusion matrix:
      0    1
0  5770  193
1   116  167
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_halffreeze_seed3_2024-08-02_13-31-15/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_halffreeze_seed3_2024-08-02_13-31-15/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 196699 KiB |   7828 MiB |   1894 TiB |   1894 TiB |
|       from large pool | 179211 KiB |   7805 MiB |   1865 TiB |   1865 TiB |
|       from small pool |  17488 KiB |     37 MiB |     28 TiB |     28 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 196699 KiB |   7828 MiB |   1894 TiB |   1894 TiB |
|       from large pool | 179211 KiB |   7805 MiB |   1865 TiB |   1865 TiB |
|       from small pool |  17488 KiB |     37 MiB |     28 TiB |     28 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195461 KiB |   7827 MiB |   1893 TiB |   1893 TiB |
|       from large pool | 178979 KiB |   7804 MiB |   1865 TiB |   1865 TiB |
|       from small pool |  16482 KiB |     36 MiB |     28 TiB |     28 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8512 MiB |   8530 MiB |  33352 MiB |  24840 MiB |
|       from large pool |   8472 MiB |   8486 MiB |  33264 MiB |  24792 MiB |
|       from small pool |     40 MiB |     44 MiB |     88 MiB |     48 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  40869 KiB | 732464 KiB |   1006 TiB |   1006 TiB |
|       from large pool |  31733 KiB | 730714 KiB |    977 TiB |    977 TiB |
|       from small pool |   9136 KiB |  23272 KiB |     28 TiB |     28 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    2972    |    7783    |  371759 K  |  371756 K  |
|       from large pool |      79    |     762    |  180306 K  |  180306 K  |
|       from small pool |    2893    |    7702    |  191453 K  |  191450 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2972    |    7783    |  371759 K  |  371756 K  |
|       from large pool |      79    |     762    |  180306 K  |  180306 K  |
|       from small pool |    2893    |    7702    |  191453 K  |  191450 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     368    |     371    |    1406    |    1038    |
|       from large pool |     348    |     349    |    1362    |    1014    |
|       from small pool |      20    |      22    |      44    |      24    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      38    |    3667    |  202905 K  |  202905 K  |
|       from large pool |      11    |     351    |  120764 K  |  120764 K  |
|       from small pool |      27    |    3657    |   82141 K  |   82141 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |   1894 TiB |   1894 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   1865 TiB |   1865 TiB |
|       from small pool |      0 KiB |     37 MiB |     28 TiB |     28 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |   1894 TiB |   1894 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   1865 TiB |   1865 TiB |
|       from small pool |      0 KiB |     37 MiB |     28 TiB |     28 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |   1893 TiB |   1893 TiB |
|       from large pool |  16640 KiB |   7804 MiB |   1865 TiB |   1865 TiB |
|       from small pool |      0 KiB |     36 MiB |     28 TiB |     28 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 237568 KiB |   8530 MiB |  33352 MiB |  33120 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  33264 MiB |  33058 MiB |
|       from small pool |  26624 KiB |     44 MiB |     88 MiB |     62 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB |   1006 TiB |   1006 TiB |
|       from large pool |  30464 KiB | 730714 KiB |    977 TiB |    977 TiB |
|       from small pool |      0 KiB |  23275 KiB |     28 TiB |     28 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7783    |  371759 K  |  371759 K  |
|       from large pool |       2    |     762    |  180306 K  |  180306 K  |
|       from small pool |       0    |    7702    |  191453 K  |  191453 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7783    |  371759 K  |  371759 K  |
|       from large pool |       2    |     762    |  180306 K  |  180306 K  |
|       from small pool |       0    |    7702    |  191453 K  |  191453 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |     371    |    1406    |    1383    |
|       from large pool |      10    |     349    |    1362    |    1352    |
|       from small pool |      13    |      22    |      44    |      31    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3667    |  202906 K  |  202906 K  |
|       from large pool |       3    |     351    |  120764 K  |  120764 K  |
|       from small pool |       0    |    3657    |   82142 K  |   82142 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sun Aug  4 06:15:19 2024]
Finished job 0.
1 of 1 steps (100%) done
