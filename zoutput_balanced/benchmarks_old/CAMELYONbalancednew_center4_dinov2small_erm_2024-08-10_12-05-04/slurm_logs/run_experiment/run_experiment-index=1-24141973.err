Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sun Aug 11 00:21:14 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-10_12-05-04/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-10_12-05-04/rule_results/1.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=1
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_00_28_41_seed_0_24141973

 Experiment start at: 2024-08-11 00:28:42.688936
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.11637334525585175
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/autograd/graph.py:744: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.957162, 'precision': 0.95786667, 'recall': 0.95717293, 'specificity': 0.95717293, 'f1': 0.9571463, 'auroc': 0.98954964, 'binary_precision': 0.97596747, 'binary_recall': 0.9374556, 'binary_specificity': 0.97689027, 'binary_f1_score': 0.956324}
confusion matrix:
       0      1
0  24729    585
1   1585  23757
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.9508923, 'precision': 0.61467284, 'recall': 0.7234011, 'specificity': 0.7234011, 'f1': 0.64883655, 'auroc': 0.8552154, 'binary_precision': 0.2424608, 'binary_recall': 0.48433736, 'binary_specificity': 0.96246487, 'binary_f1_score': 0.32315114}
confusion matrix:
       0    1
0  16103  628
1    214  201
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9006328, 'precision': 0.68999016, 'recall': 0.79648566, 'specificity': 0.79648566, 'f1': 0.726643, 'auroc': 0.89851606, 'binary_precision': 0.4084839, 'binary_recall': 0.6735751, 'binary_specificity': 0.9193963, 'binary_f1_score': 0.50855744}
confusion matrix:
      0    1
0  8589  753
1   252  520
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-11 01:04:36.033665,epoch time: 0:35:53.344729,used: 0:35:53.344729,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_00_28_41_seed_0_24141973
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9696186, 'precision': 0.969739, 'recall': 0.96962506, 'specificity': 0.96962506, 'f1': 0.9696169, 'auroc': 0.9945084, 'binary_precision': 0.9774596, 'binary_recall': 0.96145654, 'binary_specificity': 0.9777936, 'binary_f1_score': 0.969392}
confusion matrix:
       0      1
0  24746    562
1    977  24371
---- Validation: 
scalar performance:
{'acc': 0.9333372, 'precision': 0.5927206, 'recall': 0.75552857, 'specificity': 0.75552857, 'f1': 0.62864065, 'auroc': 0.873152, 'binary_precision': 0.19666667, 'binary_recall': 0.5686747, 'binary_specificity': 0.9423824, 'binary_f1_score': 0.29226008}
confusion matrix:
       0    1
0  15767  964
1    179  236
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8813526, 'precision': 0.6700845, 'recall': 0.81635046, 'specificity': 0.81635046, 'f1': 0.71026295, 'auroc': 0.90077233, 'binary_precision': 0.36369428, 'binary_recall': 0.7396373, 'binary_specificity': 0.8930636, 'binary_f1_score': 0.48761746}
confusion matrix:
      0    1
0  8343  999
1   201  571
early stop counter: 1
val acc:0.9333372116088867, best validation acc: 0.9508923292160034, corresponding to test acc:                         0.9006327986717224 / 0.9006327986717224
after epoch: 2,now: 2024-08-11 01:39:26.069837,epoch time: 0:34:50.036172,used: 1:10:43.380901,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_00_28_41_seed_0_24141973
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.973705, 'precision': 0.9740455, 'recall': 0.97371304, 'specificity': 0.97371304, 'f1': 0.9737005, 'auroc': 0.99592054, 'binary_precision': 0.98690027, 'binary_recall': 0.96018624, 'binary_specificity': 0.9872398, 'binary_f1_score': 0.97335994}
confusion matrix:
       0      1
0  24990    323
1   1009  24334
---- Validation: 
scalar performance:
{'acc': 0.9588825, 'precision': 0.63601196, 'recall': 0.71809584, 'specificity': 0.71809584, 'f1': 0.6662848, 'auroc': 0.88050234, 'binary_precision': 0.28550297, 'binary_recall': 0.46506023, 'binary_specificity': 0.97113144, 'binary_f1_score': 0.35380387}
confusion matrix:
       0    1
0  16248  483
1    222  193
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9138817, 'precision': 0.7128575, 'recall': 0.79474545, 'specificity': 0.79474545, 'f1': 0.7447374, 'auroc': 0.90692866, 'binary_precision': 0.45536518, 'binary_recall': 0.65414506, 'binary_specificity': 0.93534577, 'binary_f1_score': 0.53694844}
confusion matrix:
      0    1
0  8738  604
1   267  505
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-11 02:14:14.340542,epoch time: 0:34:48.270705,used: 1:45:31.651606,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_00_28_41_seed_0_24141973
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9776335, 'precision': 0.97794366, 'recall': 0.9776416, 'specificity': 0.9776416, 'f1': 0.9776301, 'auroc': 0.99726284, 'binary_precision': 0.99027985, 'binary_recall': 0.96476483, 'binary_specificity': 0.99051833, 'binary_f1_score': 0.97735584}
confusion matrix:
       0      1
0  25072    240
1    893  24451
---- Validation: 
scalar performance:
{'acc': 0.9626152, 'precision': 0.64859915, 'recall': 0.7117839, 'specificity': 0.7117839, 'f1': 0.6739823, 'auroc': 0.884915, 'binary_precision': 0.3110368, 'binary_recall': 0.44819278, 'binary_specificity': 0.97537506, 'binary_f1_score': 0.3672261}
confusion matrix:
       0    1
0  16319  412
1    229  186
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9176389, 'precision': 0.7181955, 'recall': 0.7759841, 'specificity': 0.7759841, 'f1': 0.742519, 'auroc': 0.90441847, 'binary_precision': 0.46953046, 'binary_recall': 0.6088083, 'binary_specificity': 0.94315994, 'binary_f1_score': 0.53017485}
confusion matrix:
      0    1
0  8811  531
1   302  470
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-11 02:48:58.702666,epoch time: 0:34:44.362124,used: 2:20:16.013730,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_00_28_41_seed_0_24141973
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9794496, 'precision': 0.9795524, 'recall': 0.97945344, 'specificity': 0.97945344, 'f1': 0.9794487, 'auroc': 0.997241, 'binary_precision': 0.98670083, 'binary_recall': 0.97202164, 'binary_specificity': 0.98688525, 'binary_f1_score': 0.9793063}
confusion matrix:
       0      1
0  24983    332
1    709  24632
---- Validation: 
scalar performance:
{'acc': 0.94972587, 'precision': 0.6151374, 'recall': 0.73455274, 'specificity': 0.73455274, 'f1': 0.65127283, 'auroc': 0.88726723, 'binary_precision': 0.24280782, 'binary_recall': 0.50843376, 'binary_specificity': 0.9606718, 'binary_f1_score': 0.32866046}
confusion matrix:
       0    1
0  16073  658
1    204  211
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9093336, 'precision': 0.7056107, 'recall': 0.80297804, 'specificity': 0.80297804, 'f1': 0.74132633, 'auroc': 0.9051428, 'binary_precision': 0.4391268, 'binary_recall': 0.67746115, 'binary_specificity': 0.928495, 'binary_f1_score': 0.5328579}
confusion matrix:
      0    1
0  8674  668
1   249  523
early stop counter: 1
val acc:0.949725866317749, best validation acc: 0.9626151919364929, corresponding to test acc:                         0.917638897895813 / 0.917638897895813
after epoch: 5,now: 2024-08-11 03:23:42.166619,epoch time: 0:34:43.463953,used: 2:54:59.477683,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_00_28_41_seed_0_24141973
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9810289, 'precision': 0.9811053, 'recall': 0.98103297, 'specificity': 0.98103297, 'f1': 0.98102826, 'auroc': 0.9976437, 'binary_precision': 0.9873286, 'binary_recall': 0.97458965, 'binary_specificity': 0.9874763, 'binary_f1_score': 0.98091775}
confusion matrix:
       0      1
0  24995    317
1    644  24700
---- Validation: 
scalar performance:
{'acc': 0.9476263, 'precision': 0.61502624, 'recall': 0.75110096, 'specificity': 0.75110096, 'f1': 0.6537774, 'auroc': 0.8928721, 'binary_precision': 0.24171123, 'binary_recall': 0.5445783, 'binary_specificity': 0.9576236, 'binary_f1_score': 0.3348148}
confusion matrix:
       0    1
0  16022  709
1    189  226
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8997429, 'precision': 0.6905483, 'recall': 0.8055104, 'specificity': 0.8055104, 'f1': 0.72900486, 'auroc': 0.9035635, 'binary_precision': 0.40791476, 'binary_recall': 0.69430053, 'binary_specificity': 0.9167202, 'binary_f1_score': 0.5139022}
confusion matrix:
      0    1
0  8564  778
1   236  536
early stop counter: 2
val acc:0.9476262927055359, best validation acc: 0.9626151919364929, corresponding to test acc:                         0.917638897895813 / 0.917638897895813
after epoch: 6,now: 2024-08-11 03:58:23.957384,epoch time: 0:34:41.790765,used: 3:29:41.268448,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_00_28_41_seed_0_24141973
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9822134, 'precision': 0.9822591, 'recall': 0.9822167, 'specificity': 0.9822167, 'f1': 0.982213, 'auroc': 0.9976932, 'binary_precision': 0.98712635, 'binary_recall': 0.9771947, 'binary_specificity': 0.98723876, 'binary_f1_score': 0.9821354}
confusion matrix:
       0      1
0  24988    323
1    578  24767
---- Validation: 
scalar performance:
{'acc': 0.9541584, 'precision': 0.6302873, 'recall': 0.7497483, 'specificity': 0.7497483, 'f1': 0.66860104, 'auroc': 0.8937241, 'binary_precision': 0.27239263, 'binary_recall': 0.53493977, 'binary_specificity': 0.9645568, 'binary_f1_score': 0.36097562}
confusion matrix:
       0    1
0  16138  593
1    193  222
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9007317, 'precision': 0.6916384, 'recall': 0.803669, 'specificity': 0.803669, 'f1': 0.7296102, 'auroc': 0.9019066, 'binary_precision': 0.41049382, 'binary_recall': 0.68911916, 'binary_specificity': 0.9182188, 'binary_f1_score': 0.51450676}
confusion matrix:
      0    1
0  8578  764
1   240  532
early stop counter: 3
val acc:0.9541584253311157, best validation acc: 0.9626151919364929, corresponding to test acc:                         0.917638897895813 / 0.917638897895813
after epoch: 7,now: 2024-08-11 04:33:16.686731,epoch time: 0:34:52.729347,used: 4:04:33.997795,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_00_28_41_seed_0_24141973
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 7 with time: 4:04:33.997795 at 2024-08-11 04:33:16.686731
persisted model performance metric: 

scalar performance:
{'acc': 0.9176389, 'precision': 0.7181955, 'recall': 0.7759841, 'specificity': 0.7759841, 'f1': 0.742519, 'auroc': 0.90441847, 'binary_precision': 0.46953046, 'binary_recall': 0.6088083, 'binary_specificity': 0.94315994, 'binary_f1_score': 0.53017485}
confusion matrix:
      0    1
0  8811  531
1   302  470
oracle model performance metric: 

scalar performance:
{'acc': 0.9176389, 'precision': 0.7181955, 'recall': 0.7759841, 'specificity': 0.7759841, 'f1': 0.742519, 'auroc': 0.90441847, 'binary_precision': 0.46953046, 'binary_recall': 0.6088083, 'binary_specificity': 0.94315994, 'binary_f1_score': 0.53017485}
confusion matrix:
      0    1
0  8811  531
1   302  470
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-10_12-05-04/rule_results/1.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-10_12-05-04/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-10_12-05-04/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1920 MiB |   6572 MiB | 593539 GiB | 593537 GiB |
|       from large pool |   1876 MiB |   6528 MiB | 587781 GiB | 587779 GiB |
|       from small pool |     44 MiB |     85 MiB |   5757 GiB |   5757 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1920 MiB |   6572 MiB | 593539 GiB | 593537 GiB |
|       from large pool |   1876 MiB |   6528 MiB | 587781 GiB | 587779 GiB |
|       from small pool |     44 MiB |     85 MiB |   5757 GiB |   5757 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1917 MiB |   6568 MiB | 593080 GiB | 593078 GiB |
|       from large pool |   1874 MiB |   6525 MiB | 587330 GiB | 587328 GiB |
|       from small pool |     42 MiB |     83 MiB |   5749 GiB |   5749 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   7006 MiB |   7006 MiB |   7006 MiB |      0 B   |
|       from large pool |   6918 MiB |   6918 MiB |   6918 MiB |      0 B   |
|       from small pool |     88 MiB |     88 MiB |     88 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 781441 KiB |    904 MiB | 380181 GiB | 380180 GiB |
|       from large pool | 769540 KiB |    902 MiB | 374320 GiB | 374319 GiB |
|       from small pool |  11901 KiB |     16 MiB |   5861 GiB |   5861 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    5080    |    7463    |   76634 K  |   76629 K  |
|       from large pool |     176    |     456    |   43625 K  |   43624 K  |
|       from small pool |    4904    |    7286    |   33009 K  |   33004 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    5080    |    7463    |   76634 K  |   76629 K  |
|       from large pool |     176    |     456    |   43625 K  |   43624 K  |
|       from small pool |    4904    |    7286    |   33009 K  |   33004 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     172    |     172    |     172    |       0    |
|       from large pool |     128    |     128    |     128    |       0    |
|       from small pool |      44    |      44    |      44    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      71    |    3207    |   46909 K  |   46908 K  |
|       from large pool |      32    |     117    |   29156 K  |   29156 K  |
|       from small pool |      39    |    3175    |   17752 K  |   17752 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6572 MiB | 593539 GiB | 593539 GiB |
|       from large pool |  16640 KiB |   6528 MiB | 587781 GiB | 587781 GiB |
|       from small pool |      0 KiB |     85 MiB |   5757 GiB |   5757 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6572 MiB | 593539 GiB | 593539 GiB |
|       from large pool |  16640 KiB |   6528 MiB | 587781 GiB | 587781 GiB |
|       from small pool |      0 KiB |     85 MiB |   5757 GiB |   5757 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6568 MiB | 593080 GiB | 593080 GiB |
|       from large pool |  16640 KiB |   6525 MiB | 587330 GiB | 587330 GiB |
|       from small pool |      0 KiB |     83 MiB |   5749 GiB |   5749 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2684 MiB |   7006 MiB |   7006 MiB |   4322 MiB |
|       from large pool |   2628 MiB |   6918 MiB |   6918 MiB |   4290 MiB |
|       from small pool |     56 MiB |     88 MiB |     88 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 204544 KiB |    904 MiB | 380181 GiB | 380181 GiB |
|       from large pool | 204544 KiB |    902 MiB | 374320 GiB | 374320 GiB |
|       from small pool |      0 KiB |     30 MiB |   5861 GiB |   5861 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7463    |   76634 K  |   76634 K  |
|       from large pool |       2    |     456    |   43625 K  |   43625 K  |
|       from small pool |       0    |    7286    |   33009 K  |   33009 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7463    |   76634 K  |   76634 K  |
|       from large pool |       2    |     456    |   43625 K  |   43625 K  |
|       from small pool |       0    |    7286    |   33009 K  |   33009 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      66    |     172    |     172    |     106    |
|       from large pool |      38    |     128    |     128    |      90    |
|       from small pool |      28    |      44    |      44    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3207    |   46911 K  |   46911 K  |
|       from large pool |       4    |     117    |   29156 K  |   29156 K  |
|       from small pool |       0    |    3175    |   17754 K  |   17754 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6572 MiB | 593539 GiB | 593539 GiB |
|       from large pool |  16640 KiB |   6528 MiB | 587781 GiB | 587781 GiB |
|       from small pool |      0 KiB |     85 MiB |   5757 GiB |   5757 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6572 MiB | 593539 GiB | 593539 GiB |
|       from large pool |  16640 KiB |   6528 MiB | 587781 GiB | 587781 GiB |
|       from small pool |      0 KiB |     85 MiB |   5757 GiB |   5757 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6568 MiB | 593080 GiB | 593080 GiB |
|       from large pool |  16640 KiB |   6525 MiB | 587330 GiB | 587330 GiB |
|       from small pool |      0 KiB |     83 MiB |   5749 GiB |   5749 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2684 MiB |   7006 MiB |   7006 MiB |   4322 MiB |
|       from large pool |   2628 MiB |   6918 MiB |   6918 MiB |   4290 MiB |
|       from small pool |     56 MiB |     88 MiB |     88 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 204544 KiB |    904 MiB | 380181 GiB | 380181 GiB |
|       from large pool | 204544 KiB |    902 MiB | 374320 GiB | 374320 GiB |
|       from small pool |      0 KiB |     30 MiB |   5861 GiB |   5861 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7463    |   76634 K  |   76634 K  |
|       from large pool |       2    |     456    |   43625 K  |   43625 K  |
|       from small pool |       0    |    7286    |   33009 K  |   33009 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7463    |   76634 K  |   76634 K  |
|       from large pool |       2    |     456    |   43625 K  |   43625 K  |
|       from small pool |       0    |    7286    |   33009 K  |   33009 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      66    |     172    |     172    |     106    |
|       from large pool |      38    |     128    |     128    |      90    |
|       from small pool |      28    |      44    |      44    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3207    |   46911 K  |   46911 K  |
|       from large pool |       4    |     117    |   29156 K  |   29156 K  |
|       from small pool |       0    |    3175    |   17754 K  |   17754 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_04_43_13_seed_1_24141973

 Experiment start at: 2024-08-11 04:43:14.221532
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.0762065201997757
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96567124, 'precision': 0.9659668, 'recall': 0.9656807, 'specificity': 0.9656807, 'f1': 0.9656663, 'auroc': 0.9924017, 'binary_precision': 0.97789073, 'binary_recall': 0.95293885, 'binary_specificity': 0.97842264, 'binary_f1_score': 0.9652536}
confusion matrix:
       0      1
0  24849    548
1   1197  24238
---- Validation: 
scalar performance:
{'acc': 0.91537696, 'precision': 0.5765458, 'recall': 0.752041, 'specificity': 0.752041, 'f1': 0.6058384, 'auroc': 0.85367906, 'binary_precision': 0.16469038, 'binary_recall': 0.5800464, 'binary_specificity': 0.9240355, 'binary_f1_score': 0.2565418}
confusion matrix:
       0     1
0  15424  1268
1    181   250
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89138836, 'precision': 0.6699219, 'recall': 0.7768107, 'specificity': 0.7768107, 'f1': 0.70475686, 'auroc': 0.89520025, 'binary_precision': 0.3707094, 'binary_recall': 0.64200795, 'binary_specificity': 0.91161346, 'binary_f1_score': 0.47001934}
confusion matrix:
      0    1
0  8509  825
1   271  486
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-11 05:19:08.305632,epoch time: 0:35:54.084100,used: 0:35:54.084100,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_04_43_13_seed_1_24141973
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9719665, 'precision': 0.97248876, 'recall': 0.97198033, 'specificity': 0.97198033, 'f1': 0.9719593, 'auroc': 0.99544156, 'binary_precision': 0.9884061, 'binary_recall': 0.9551834, 'binary_specificity': 0.98877734, 'binary_f1_score': 0.9715108}
confusion matrix:
       0      1
0  25110    285
1   1140  24297
---- Validation: 
scalar performance:
{'acc': 0.9402558, 'precision': 0.60125697, 'recall': 0.73541796, 'specificity': 0.73541796, 'f1': 0.63667095, 'auroc': 0.8630867, 'binary_precision': 0.21538462, 'binary_recall': 0.51972157, 'binary_specificity': 0.9511143, 'binary_f1_score': 0.30455473}
confusion matrix:
       0    1
0  15876  816
1    207  224
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9100188, 'precision': 0.69769835, 'recall': 0.7680664, 'specificity': 0.7680664, 'f1': 0.72555274, 'auroc': 0.89419496, 'binary_precision': 0.42884073, 'binary_recall': 0.6010568, 'binary_specificity': 0.93507606, 'binary_f1_score': 0.50055003}
confusion matrix:
      0    1
0  8728  606
1   302  455
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-11 05:54:04.387157,epoch time: 0:34:56.081525,used: 1:10:50.165625,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_04_43_13_seed_1_24141973
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9764125, 'precision': 0.97692597, 'recall': 0.97642756, 'specificity': 0.97642756, 'f1': 0.97640663, 'auroc': 0.9971046, 'binary_precision': 0.9928031, 'binary_recall': 0.95982546, 'binary_specificity': 0.9930296, 'binary_f1_score': 0.9760358}
confusion matrix:
       0      1
0  25216    177
1   1022  24417
---- Validation: 
scalar performance:
{'acc': 0.92548037, 'precision': 0.58342904, 'recall': 0.7414011, 'specificity': 0.7414011, 'f1': 0.61537945, 'auroc': 0.86432797, 'binary_precision': 0.17919514, 'binary_recall': 0.5475638, 'binary_specificity': 0.9352384, 'binary_f1_score': 0.27002287}
confusion matrix:
       0     1
0  15611  1081
1    195   236
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90337926, 'precision': 0.68687207, 'recall': 0.7735814, 'specificity': 0.7735814, 'f1': 0.7187434, 'auroc': 0.8917304, 'binary_precision': 0.4058722, 'binary_recall': 0.62087184, 'binary_specificity': 0.926291, 'binary_f1_score': 0.49086162}
confusion matrix:
      0    1
0  8646  688
1   287  470
early stop counter: 1
val acc:0.9254803657531738, best validation acc: 0.9402558207511902, corresponding to test acc:                         0.910018801689148 / 0.910018801689148
after epoch: 3,now: 2024-08-11 06:29:00.513408,epoch time: 0:34:56.126251,used: 1:45:46.291876,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_04_43_13_seed_1_24141973
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98003227, 'precision': 0.9803338, 'recall': 0.98004276, 'specificity': 0.98004276, 'f1': 0.98002946, 'auroc': 0.9973595, 'binary_precision': 0.9925777, 'binary_recall': 0.96733105, 'binary_specificity': 0.99275446, 'binary_f1_score': 0.97979176}
confusion matrix:
       0      1
0  25211    184
1    831  24606
---- Validation: 
scalar performance:
{'acc': 0.9041056, 'precision': 0.5745826, 'recall': 0.78242415, 'specificity': 0.78242415, 'f1': 0.602209, 'auroc': 0.8722303, 'binary_precision': 0.15887325, 'binary_recall': 0.65429235, 'binary_specificity': 0.91055596, 'binary_f1_score': 0.25566638}
confusion matrix:
       0     1
0  15199  1493
1    149   282
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8917848, 'precision': 0.6813025, 'recall': 0.82315195, 'specificity': 0.82315195, 'f1': 0.7232194, 'auroc': 0.89679146, 'binary_precision': 0.38519534, 'binary_recall': 0.7424042, 'binary_specificity': 0.9038997, 'binary_f1_score': 0.5072202}
confusion matrix:
      0    1
0  8437  897
1   195  562
early stop counter: 2
val acc:0.9041056036949158, best validation acc: 0.9402558207511902, corresponding to test acc:                         0.910018801689148 / 0.910018801689148
after epoch: 4,now: 2024-08-11 07:03:46.290965,epoch time: 0:34:45.777557,used: 2:20:32.069433,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_04_43_13_seed_1_24141973
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9806815, 'precision': 0.98069394, 'recall': 0.9806795, 'specificity': 0.9806795, 'f1': 0.98068124, 'auroc': 0.9979261, 'binary_precision': 0.97844034, 'binary_recall': 0.9830562, 'binary_specificity': 0.97830284, 'binary_f1_score': 0.9807428}
confusion matrix:
       0      1
0  24844    551
1    431  25006
---- Validation: 
scalar performance:
{'acc': 0.81632894, 'precision': 0.54861, 'recall': 0.8165122, 'specificity': 0.8165122, 'f1': 0.5397203, 'auroc': 0.8886492, 'binary_precision': 0.102984205, 'binary_recall': 0.81670535, 'binary_specificity': 0.81631917, 'binary_f1_score': 0.18290466}
confusion matrix:
       0     1
0  13626  3066
1     79   352
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8438212, 'precision': 0.6443635, 'recall': 0.84153146, 'specificity': 0.84153146, 'f1': 0.6776656, 'auroc': 0.898857, 'binary_precision': 0.3039732, 'binary_recall': 0.8388375, 'binary_specificity': 0.8442254, 'binary_f1_score': 0.44624034}
confusion matrix:
      0     1
0  7880  1454
1   122   635
early stop counter: 3
val acc:0.8163289427757263, best validation acc: 0.9402558207511902, corresponding to test acc:                         0.910018801689148 / 0.910018801689148
after epoch: 5,now: 2024-08-11 07:38:24.207781,epoch time: 0:34:37.916816,used: 2:55:09.986249,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_04_43_13_seed_1_24141973
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 5 with time: 2:55:09.986249 at 2024-08-11 07:38:24.207781
persisted model performance metric: 

scalar performance:
{'acc': 0.9100188, 'precision': 0.69769835, 'recall': 0.7680664, 'specificity': 0.7680664, 'f1': 0.72555274, 'auroc': 0.89419496, 'binary_precision': 0.42884073, 'binary_recall': 0.6010568, 'binary_specificity': 0.93507606, 'binary_f1_score': 0.50055003}
confusion matrix:
      0    1
0  8728  606
1   302  455
oracle model performance metric: 

scalar performance:
{'acc': 0.9100188, 'precision': 0.69769835, 'recall': 0.7680664, 'specificity': 0.7680664, 'f1': 0.72555274, 'auroc': 0.89419496, 'binary_precision': 0.42884073, 'binary_recall': 0.6010568, 'binary_specificity': 0.93507606, 'binary_f1_score': 0.50055003}
confusion matrix:
      0    1
0  8728  606
1   302  455
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-10_12-05-04/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-10_12-05-04/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1921 MiB |   6573 MiB |    996 TiB |    996 TiB |
|       from large pool |   1877 MiB |   6530 MiB |    986 TiB |    986 TiB |
|       from small pool |     44 MiB |     85 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1921 MiB |   6573 MiB |    996 TiB |    996 TiB |
|       from large pool |   1877 MiB |   6530 MiB |    986 TiB |    986 TiB |
|       from small pool |     44 MiB |     85 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1917 MiB |   6568 MiB |    995 TiB |    995 TiB |
|       from large pool |   1874 MiB |   6525 MiB |    985 TiB |    985 TiB |
|       from small pool |     42 MiB |     83 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   6820 MiB |   7006 MiB |  11142 MiB |   4322 MiB |
|       from large pool |   6734 MiB |   6918 MiB |  11024 MiB |   4290 MiB |
|       from small pool |     86 MiB |     88 MiB |    118 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 397641 KiB |    949 MiB | 730722 GiB | 730722 GiB |
|       from large pool | 383686 KiB |    948 MiB | 720626 GiB | 720625 GiB |
|       from small pool |  13955 KiB |     30 MiB |  10096 GiB |  10096 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    5068    |    7485    |  131829 K  |  131824 K  |
|       from large pool |     176    |     456    |   75009 K  |   75009 K  |
|       from small pool |    4892    |    7308    |   56820 K  |   56815 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    5068    |    7485    |  131829 K  |  131824 K  |
|       from large pool |     176    |     456    |   75009 K  |   75009 K  |
|       from small pool |    4892    |    7308    |   56820 K  |   56815 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     130    |     172    |     236    |     106    |
|       from large pool |      87    |     128    |     177    |      90    |
|       from small pool |      43    |      44    |      59    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      76    |    3218    |   77426 K  |   77426 K  |
|       from large pool |      31    |     117    |   46290 K  |   46290 K  |
|       from small pool |      45    |    3187    |   31135 K  |   31135 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6573 MiB |    996 TiB |    996 TiB |
|       from large pool |  16640 KiB |   6530 MiB |    986 TiB |    986 TiB |
|       from small pool |      0 KiB |     85 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6573 MiB |    996 TiB |    996 TiB |
|       from large pool |  16640 KiB |   6530 MiB |    986 TiB |    986 TiB |
|       from small pool |      0 KiB |     85 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6568 MiB |    995 TiB |    995 TiB |
|       from large pool |  16640 KiB |   6525 MiB |    985 TiB |    985 TiB |
|       from small pool |      0 KiB |     83 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2310 MiB |   7006 MiB |  11142 MiB |   8832 MiB |
|       from large pool |   2252 MiB |   6918 MiB |  11024 MiB |   8772 MiB |
|       from small pool |     58 MiB |     88 MiB |    118 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 204544 KiB |    949 MiB | 730723 GiB | 730722 GiB |
|       from large pool | 204544 KiB |    948 MiB | 720626 GiB | 720626 GiB |
|       from small pool |      0 KiB |     33 MiB |  10096 GiB |  10096 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7485    |  131829 K  |  131829 K  |
|       from large pool |       2    |     456    |   75009 K  |   75009 K  |
|       from small pool |       0    |    7308    |   56820 K  |   56820 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7485    |  131829 K  |  131829 K  |
|       from large pool |       2    |     456    |   75009 K  |   75009 K  |
|       from small pool |       0    |    7308    |   56820 K  |   56820 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      65    |     172    |     236    |     171    |
|       from large pool |      36    |     128    |     177    |     141    |
|       from small pool |      29    |      44    |      59    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3218    |   77428 K  |   77428 K  |
|       from large pool |       4    |     117    |   46290 K  |   46290 K  |
|       from small pool |       0    |    3187    |   31137 K  |   31137 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6573 MiB |    996 TiB |    996 TiB |
|       from large pool |  16640 KiB |   6530 MiB |    986 TiB |    986 TiB |
|       from small pool |      0 KiB |     85 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6573 MiB |    996 TiB |    996 TiB |
|       from large pool |  16640 KiB |   6530 MiB |    986 TiB |    986 TiB |
|       from small pool |      0 KiB |     85 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6568 MiB |    995 TiB |    995 TiB |
|       from large pool |  16640 KiB |   6525 MiB |    985 TiB |    985 TiB |
|       from small pool |      0 KiB |     83 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2310 MiB |   7006 MiB |  11142 MiB |   8832 MiB |
|       from large pool |   2252 MiB |   6918 MiB |  11024 MiB |   8772 MiB |
|       from small pool |     58 MiB |     88 MiB |    118 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 204544 KiB |    949 MiB | 730723 GiB | 730722 GiB |
|       from large pool | 204544 KiB |    948 MiB | 720626 GiB | 720626 GiB |
|       from small pool |      0 KiB |     33 MiB |  10096 GiB |  10096 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7485    |  131829 K  |  131829 K  |
|       from large pool |       2    |     456    |   75009 K  |   75009 K  |
|       from small pool |       0    |    7308    |   56820 K  |   56820 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7485    |  131829 K  |  131829 K  |
|       from large pool |       2    |     456    |   75009 K  |   75009 K  |
|       from small pool |       0    |    7308    |   56820 K  |   56820 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      65    |     172    |     236    |     171    |
|       from large pool |      36    |     128    |     177    |     141    |
|       from small pool |      29    |      44    |      59    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3218    |   77428 K  |   77428 K  |
|       from large pool |       4    |     117    |   46290 K  |   46290 K  |
|       from small pool |       0    |    3187    |   31137 K  |   31137 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_07_48_23_seed_2_24141973

 Experiment start at: 2024-08-11 07:48:24.461065
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.07946888357400894
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96421385, 'precision': 0.96458507, 'recall': 0.9642155, 'specificity': 0.9642155, 'f1': 0.9642068, 'auroc': 0.99160266, 'binary_precision': 0.97774595, 'binary_recall': 0.95005995, 'binary_specificity': 0.9783711, 'binary_f1_score': 0.96370417}
confusion matrix:
       0      1
0  25286    559
1   1291  24560
---- Validation: 
scalar performance:
{'acc': 0.90265125, 'precision': 0.5704083, 'recall': 0.77633756, 'specificity': 0.77633756, 'f1': 0.59598356, 'auroc': 0.863333, 'binary_precision': 0.15053162, 'binary_recall': 0.6435407, 'binary_specificity': 0.90913445, 'binary_f1_score': 0.24399094}
confusion matrix:
       0     1
0  15188  1518
1    149   269
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8634562, 'precision': 0.65079963, 'recall': 0.7910875, 'specificity': 0.7910875, 'f1': 0.68565416, 'auroc': 0.86289966, 'binary_precision': 0.32961878, 'binary_recall': 0.7051443, 'binary_specificity': 0.8770307, 'binary_f1_score': 0.44924062}
confusion matrix:
      0     1
0  8152  1143
1   235   562
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-11 08:24:54.565925,epoch time: 0:36:30.104860,used: 0:36:30.104860,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_07_48_23_seed_2_24141973
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9719901, 'precision': 0.97203505, 'recall': 0.9719908, 'specificity': 0.9719908, 'f1': 0.97198945, 'auroc': 0.9950986, 'binary_precision': 0.9766779, 'binary_recall': 0.96708184, 'binary_specificity': 0.97689986, 'binary_f1_score': 0.9718562}
confusion matrix:
       0      1
0  25247    597
1    851  25001
---- Validation: 
scalar performance:
{'acc': 0.9035272, 'precision': 0.57241297, 'recall': 0.7837839, 'specificity': 0.7837839, 'f1': 0.599111, 'auroc': 0.87022436, 'binary_precision': 0.15414798, 'binary_recall': 0.65789473, 'binary_specificity': 0.90967315, 'binary_f1_score': 0.24977294}
confusion matrix:
       0     1
0  15197  1509
1    143   275
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8648434, 'precision': 0.65093803, 'recall': 0.78725207, 'specificity': 0.78725207, 'f1': 0.68560505, 'auroc': 0.8618195, 'binary_precision': 0.33074626, 'binary_recall': 0.6951066, 'binary_specificity': 0.8793975, 'binary_f1_score': 0.44822004}
confusion matrix:
      0     1
0  8174  1121
1   243   554
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-11 09:00:22.329537,epoch time: 0:35:27.763612,used: 1:11:57.868472,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_07_48_23_seed_2_24141973
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97713554, 'precision': 0.97744465, 'recall': 0.97713804, 'specificity': 0.97713804, 'f1': 0.97713196, 'auroc': 0.9962181, 'binary_precision': 0.98964, 'binary_recall': 0.9643755, 'binary_specificity': 0.9899005, 'binary_f1_score': 0.97684443}
confusion matrix:
       0      1
0  25582    261
1    921  24932
---- Validation: 
scalar performance:
{'acc': 0.92274004, 'precision': 0.5877091, 'recall': 0.7831345, 'specificity': 0.7831345, 'f1': 0.6229751, 'auroc': 0.8743012, 'binary_precision': 0.18510786, 'binary_recall': 0.6363636, 'binary_specificity': 0.9299054, 'binary_f1_score': 0.28679246}
confusion matrix:
       0     1
0  15535  1171
1    152   266
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8862465, 'precision': 0.6702727, 'recall': 0.7765024, 'specificity': 0.7765024, 'f1': 0.7045772, 'auroc': 0.8638262, 'binary_precision': 0.3729182, 'binary_recall': 0.6461731, 'binary_specificity': 0.9068316, 'binary_f1_score': 0.47291088}
confusion matrix:
      0    1
0  8429  866
1   282  515
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-11 09:35:55.325484,epoch time: 0:35:32.995947,used: 1:47:30.864419,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_07_48_23_seed_2_24141973
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97982436, 'precision': 0.9798799, 'recall': 0.9798256, 'specificity': 0.9798256, 'f1': 0.9798238, 'auroc': 0.99689186, 'binary_precision': 0.98510146, 'binary_recall': 0.9743947, 'binary_specificity': 0.98525655, 'binary_f1_score': 0.9797188}
confusion matrix:
       0      1
0  25461    381
1    662  25192
---- Validation: 
scalar performance:
{'acc': 0.9208713, 'precision': 0.5900625, 'recall': 0.80316913, 'specificity': 0.80316913, 'f1': 0.62672687, 'auroc': 0.8824232, 'binary_precision': 0.18870431, 'binary_recall': 0.67942584, 'binary_specificity': 0.9269125, 'binary_f1_score': 0.29537183}
confusion matrix:
       0     1
0  15485  1221
1    134   284
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86078084, 'precision': 0.6541892, 'recall': 0.81200397, 'specificity': 0.81200397, 'f1': 0.6905662, 'auroc': 0.8774202, 'binary_precision': 0.33204418, 'binary_recall': 0.7540778, 'binary_specificity': 0.8699301, 'binary_f1_score': 0.4610663}
confusion matrix:
      0     1
0  8086  1209
1   196   601
early stop counter: 1
val acc:0.9208713173866272, best validation acc: 0.9227400422096252, corresponding to test acc:                         0.8862465023994446 / 0.8862465023994446
after epoch: 4,now: 2024-08-11 10:11:23.036481,epoch time: 0:35:27.710997,used: 2:22:58.575416,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_07_48_23_seed_2_24141973
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9805207, 'precision': 0.9807558, 'recall': 0.9805237, 'specificity': 0.9805237, 'f1': 0.98051846, 'auroc': 0.9975885, 'binary_precision': 0.9914557, 'binary_recall': 0.9694063, 'binary_specificity': 0.99164116, 'binary_f1_score': 0.9803071}
confusion matrix:
       0      1
0  25625    216
1    791  25064
---- Validation: 
scalar performance:
{'acc': 0.92933893, 'precision': 0.5974252, 'recall': 0.79468024, 'specificity': 0.79468024, 'f1': 0.636847, 'auroc': 0.88294244, 'binary_precision': 0.20403588, 'binary_recall': 0.65311, 'binary_specificity': 0.93625045, 'binary_f1_score': 0.31093395}
confusion matrix:
       0     1
0  15641  1065
1    145   273
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8754459, 'precision': 0.6647595, 'recall': 0.8021848, 'specificity': 0.8021848, 'f1': 0.70246243, 'auroc': 0.87008595, 'binary_precision': 0.35625, 'binary_recall': 0.71518195, 'binary_specificity': 0.88918775, 'binary_f1_score': 0.47559452}
confusion matrix:
      0     1
0  8265  1030
1   227   570
better model found
persisted
after epoch: 5,now: 2024-08-11 10:46:49.703919,epoch time: 0:35:26.667438,used: 2:58:25.242854,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_07_48_23_seed_2_24141973
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98286134, 'precision': 0.98298025, 'recall': 0.9828629, 'specificity': 0.9828629, 'f1': 0.9828603, 'auroc': 0.998012, 'binary_precision': 0.9906072, 'binary_recall': 0.9749739, 'binary_specificity': 0.99075186, 'binary_f1_score': 0.98272836}
confusion matrix:
       0      1
0  25604    239
1    647  25206
---- Validation: 
scalar performance:
{'acc': 0.92922217, 'precision': 0.5941983, 'recall': 0.78062546, 'specificity': 0.78062546, 'f1': 0.63188094, 'auroc': 0.88235426, 'binary_precision': 0.19832827, 'binary_recall': 0.6244019, 'binary_specificity': 0.93684906, 'binary_f1_score': 0.3010381}
confusion matrix:
       0     1
0  15651  1055
1    157   261
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86444706, 'precision': 0.65531385, 'recall': 0.8048173, 'specificity': 0.8048173, 'f1': 0.6917341, 'auroc': 0.87842244, 'binary_precision': 0.3360138, 'binary_recall': 0.73400253, 'binary_specificity': 0.87563205, 'binary_f1_score': 0.4609929}
confusion matrix:
      0     1
0  8139  1156
1   212   585
early stop counter: 1
val acc:0.9292221665382385, best validation acc: 0.9293389320373535, corresponding to test acc:                         0.8754459023475647 / 0.8862465023994446
after epoch: 6,now: 2024-08-11 11:22:14.479866,epoch time: 0:35:24.775947,used: 3:33:50.018801,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_07_48_23_seed_2_24141973
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9833449, 'precision': 0.9834702, 'recall': 0.9833468, 'specificity': 0.9833468, 'f1': 0.98334396, 'auroc': 0.99795264, 'binary_precision': 0.9913112, 'binary_recall': 0.9752456, 'binary_specificity': 0.99144804, 'binary_f1_score': 0.98321277}
confusion matrix:
       0      1
0  25621    221
1    640  25214
---- Validation: 
scalar performance:
{'acc': 0.9230904, 'precision': 0.5948918, 'recall': 0.8159689, 'specificity': 0.8159689, 'f1': 0.6339708, 'auroc': 0.8907114, 'binary_precision': 0.19771352, 'binary_recall': 0.7033493, 'binary_specificity': 0.9285885, 'binary_f1_score': 0.30866143}
confusion matrix:
       0     1
0  15513  1193
1    124   294
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86078084, 'precision': 0.6556835, 'recall': 0.81773955, 'specificity': 0.81773955, 'f1': 0.6925721, 'auroc': 0.8805565, 'binary_precision': 0.33387977, 'binary_recall': 0.76662487, 'binary_specificity': 0.8688542, 'binary_f1_score': 0.46516937}
confusion matrix:
      0     1
0  8076  1219
1   186   611
early stop counter: 2
val acc:0.923090398311615, best validation acc: 0.9293389320373535, corresponding to test acc:                         0.8754459023475647 / 0.8862465023994446
after epoch: 7,now: 2024-08-11 11:57:45.704882,epoch time: 0:35:31.225016,used: 4:09:21.243817,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_07_48_23_seed_2_24141973
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.984138, 'precision': 0.98419905, 'recall': 0.9841389, 'specificity': 0.9841389, 'f1': 0.98413754, 'auroc': 0.9980732, 'binary_precision': 0.98967135, 'binary_recall': 0.978493, 'binary_specificity': 0.98978484, 'binary_f1_score': 0.98405045}
confusion matrix:
       0      1
0  25580    264
1    556  25296
---- Validation: 
scalar performance:
{'acc': 0.923616, 'precision': 0.59407526, 'recall': 0.8092408, 'specificity': 0.8092408, 'f1': 0.6326586, 'auroc': 0.8893315, 'binary_precision': 0.19645293, 'binary_recall': 0.68899524, 'binary_specificity': 0.9294864, 'binary_f1_score': 0.3057325}
confusion matrix:
       0     1
0  15528  1178
1    130   288
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8528538, 'precision': 0.6476624, 'recall': 0.8099948, 'specificity': 0.8099948, 'f1': 0.68203455, 'auroc': 0.8706554, 'binary_precision': 0.31875658, 'binary_recall': 0.7590966, 'binary_specificity': 0.86089295, 'binary_f1_score': 0.4489796}
confusion matrix:
      0     1
0  8002  1293
1   192   605
early stop counter: 3
val acc:0.9236159920692444, best validation acc: 0.9293389320373535, corresponding to test acc:                         0.8754459023475647 / 0.8862465023994446
after epoch: 8,now: 2024-08-11 12:33:14.222351,epoch time: 0:35:28.517469,used: 4:44:49.761286,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_07_48_23_seed_2_24141973
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 8 with time: 4:44:49.761286 at 2024-08-11 12:33:14.222351
persisted model performance metric: 

scalar performance:
{'acc': 0.8754459, 'precision': 0.6647595, 'recall': 0.8021848, 'specificity': 0.8021848, 'f1': 0.70246243, 'auroc': 0.87008595, 'binary_precision': 0.35625, 'binary_recall': 0.71518195, 'binary_specificity': 0.88918775, 'binary_f1_score': 0.47559452}
confusion matrix:
      0     1
0  8265  1030
1   227   570
oracle model performance metric: 

scalar performance:
{'acc': 0.8862465, 'precision': 0.6702727, 'recall': 0.7765024, 'specificity': 0.7765024, 'f1': 0.7045772, 'auroc': 0.8638262, 'binary_precision': 0.3729182, 'binary_recall': 0.6461731, 'binary_specificity': 0.9068316, 'binary_f1_score': 0.47291088}
confusion matrix:
      0    1
0  8429  866
1   282  515
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-10_12-05-04/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-10_12-05-04/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1921 MiB |   6573 MiB |   1670 TiB |   1670 TiB |
|       from large pool |   1876 MiB |   6530 MiB |   1654 TiB |   1654 TiB |
|       from small pool |     44 MiB |     85 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1921 MiB |   6573 MiB |   1670 TiB |   1670 TiB |
|       from large pool |   1876 MiB |   6530 MiB |   1654 TiB |   1654 TiB |
|       from small pool |     44 MiB |     85 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1917 MiB |   6568 MiB |   1669 TiB |   1669 TiB |
|       from large pool |   1874 MiB |   6525 MiB |   1653 TiB |   1653 TiB |
|       from small pool |     42 MiB |     83 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   6958 MiB |   7006 MiB |  15790 MiB |   8832 MiB |
|       from large pool |   6874 MiB |   6918 MiB |  15646 MiB |   8772 MiB |
|       from small pool |     84 MiB |     88 MiB |    144 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 750513 KiB |   1001 MiB |   1225 TiB |   1225 TiB |
|       from large pool | 740654 KiB |    998 MiB |   1208 TiB |   1208 TiB |
|       from small pool |   9859 KiB |     33 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    5068    |    7593    |  220833 K  |  220828 K  |
|       from large pool |     176    |     456    |  125746 K  |  125745 K  |
|       from small pool |    4892    |    7416    |   95087 K  |   95082 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    5068    |    7593    |  220833 K  |  220828 K  |
|       from large pool |     176    |     456    |  125746 K  |  125745 K  |
|       from small pool |    4892    |    7416    |   95087 K  |   95082 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     140    |     172    |     311    |     171    |
|       from large pool |      98    |     128    |     239    |     141    |
|       from small pool |      42    |      44    |      72    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      76    |    3275    |  126653 K  |  126653 K  |
|       from large pool |      33    |     117    |   74685 K  |   74685 K  |
|       from small pool |      43    |    3242    |   51968 K  |   51967 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6573 MiB |   1670 TiB |   1670 TiB |
|       from large pool |  16640 KiB |   6530 MiB |   1654 TiB |   1654 TiB |
|       from small pool |      0 KiB |     85 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6573 MiB |   1670 TiB |   1670 TiB |
|       from large pool |  16640 KiB |   6530 MiB |   1654 TiB |   1654 TiB |
|       from small pool |      0 KiB |     85 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6568 MiB |   1669 TiB |   1669 TiB |
|       from large pool |  16640 KiB |   6525 MiB |   1653 TiB |   1653 TiB |
|       from small pool |      0 KiB |     83 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2654 MiB |   7006 MiB |  15790 MiB |  13136 MiB |
|       from large pool |   2600 MiB |   6918 MiB |  15646 MiB |  13046 MiB |
|       from small pool |     54 MiB |     88 MiB |    144 MiB |     90 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 204544 KiB |   1001 MiB |   1225 TiB |   1225 TiB |
|       from large pool | 204544 KiB |    998 MiB |   1208 TiB |   1208 TiB |
|       from small pool |      0 KiB |     33 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7593    |  220833 K  |  220833 K  |
|       from large pool |       2    |     456    |  125746 K  |  125746 K  |
|       from small pool |       0    |    7416    |   95087 K  |   95087 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7593    |  220833 K  |  220833 K  |
|       from large pool |       2    |     456    |  125746 K  |  125746 K  |
|       from small pool |       0    |    7416    |   95087 K  |   95087 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      65    |     172    |     311    |     246    |
|       from large pool |      38    |     128    |     239    |     201    |
|       from small pool |      27    |      44    |      72    |      45    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3275    |  126655 K  |  126655 K  |
|       from large pool |       4    |     117    |   74685 K  |   74685 K  |
|       from small pool |       0    |    3242    |   51970 K  |   51970 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sun Aug 11 12:35:24 2024]
Finished job 0.
1 of 1 steps (100%) done
