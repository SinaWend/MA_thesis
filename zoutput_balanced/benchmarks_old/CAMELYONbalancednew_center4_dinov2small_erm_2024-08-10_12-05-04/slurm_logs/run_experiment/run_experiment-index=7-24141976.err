Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sun Aug 11 00:39:29 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-10_12-05-04/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-10_12-05-04/rule_results/7.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=7
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_00_47_06_seed_0_24141976

 Experiment start at: 2024-08-11 00:47:07.705388
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.2947399616241455
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.89004266, 'precision': 0.8908397, 'recall': 0.8900578, 'specificity': 0.8900578, 'f1': 0.88998926, 'auroc': 0.9564321, 'binary_precision': 0.9086588, 'binary_recall': 0.8674295, 'binary_specificity': 0.91268617, 'binary_f1_score': 0.8875657}
confusion matrix:
       0      1
0  23101   2210
1   3360  21985
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.88154674, 'precision': 0.55251557, 'recall': 0.7395654, 'specificity': 0.7395654, 'f1': 0.56522053, 'auroc': 0.80650747, 'binary_precision': 0.11633428, 'binary_recall': 0.5903614, 'binary_specificity': 0.8887693, 'binary_f1_score': 0.19436732}
confusion matrix:
       0     1
0  14870  1861
1    170   245
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8218311, 'precision': 0.62639064, 'recall': 0.8114611, 'specificity': 0.8114611, 'f1': 0.65081984, 'auroc': 0.8622557, 'binary_precision': 0.2725265, 'binary_recall': 0.7992228, 'binary_specificity': 0.8236994, 'binary_f1_score': 0.40645587}
confusion matrix:
      0     1
0  7695  1647
1   155   617
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-11 01:05:54.025838,epoch time: 0:18:46.320450,used: 0:18:46.320450,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_00_47_06_seed_0_24141976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.92755055, 'precision': 0.92876244, 'recall': 0.9275642, 'specificity': 0.9275642, 'f1': 0.92750084, 'auroc': 0.9764528, 'binary_precision': 0.9516862, 'binary_recall': 0.90091157, 'binary_specificity': 0.95421684, 'binary_f1_score': 0.9256031}
confusion matrix:
       0      1
0  24156   1159
1   2511  22830
---- Validation: 
scalar performance:
{'acc': 0.9203313, 'precision': 0.5758934, 'recall': 0.7429896, 'specificity': 0.7429896, 'f1': 0.6053289, 'auroc': 0.82398134, 'binary_precision': 0.16348195, 'binary_recall': 0.5566265, 'binary_specificity': 0.9293527, 'binary_f1_score': 0.25273523}
confusion matrix:
       0     1
0  15549  1182
1    184   231
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.873245, 'precision': 0.6640455, 'recall': 0.82443875, 'specificity': 0.82443875, 'f1': 0.7039766, 'auroc': 0.8887837, 'binary_precision': 0.3494687, 'binary_recall': 0.7668394, 'binary_specificity': 0.8820381, 'binary_f1_score': 0.48012975}
confusion matrix:
      0     1
0  8240  1102
1   180   592
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-11 01:23:54.177868,epoch time: 0:18:00.152030,used: 0:36:46.472480,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_00_47_06_seed_0_24141976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9428301, 'precision': 0.944533, 'recall': 0.94285333, 'specificity': 0.94285333, 'f1': 0.9427773, 'auroc': 0.98341095, 'binary_precision': 0.9722351, 'binary_recall': 0.9117844, 'binary_specificity': 0.9739223, 'binary_f1_score': 0.9410399}
confusion matrix:
       0      1
0  24649    660
1   2236  23111
---- Validation: 
scalar performance:
{'acc': 0.9373615, 'precision': 0.5946195, 'recall': 0.7411415, 'specificity': 0.7411415, 'f1': 0.62986016, 'auroc': 0.8371768, 'binary_precision': 0.20126927, 'binary_recall': 0.53493977, 'binary_specificity': 0.94734323, 'binary_f1_score': 0.29249012}
confusion matrix:
       0    1
0  15850  881
1    193  222
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8922286, 'precision': 0.68458104, 'recall': 0.82520854, 'specificity': 0.82520854, 'f1': 0.7266121, 'auroc': 0.8992735, 'binary_precision': 0.39183673, 'binary_recall': 0.746114, 'binary_specificity': 0.90430313, 'binary_f1_score': 0.51382697}
confusion matrix:
      0    1
0  8448  894
1   196  576
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-11 01:41:35.947402,epoch time: 0:17:41.769534,used: 0:54:28.242014,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_00_47_06_seed_0_24141976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.94999605, 'precision': 0.9515277, 'recall': 0.950011, 'specificity': 0.950011, 'f1': 0.94995475, 'auroc': 0.98656964, 'binary_precision': 0.97795475, 'binary_recall': 0.92080027, 'binary_specificity': 0.9792218, 'binary_f1_score': 0.9485173}
confusion matrix:
       0      1
0  24789    526
1   2007  23334
---- Validation: 
scalar performance:
{'acc': 0.9350869, 'precision': 0.59666955, 'recall': 0.7622998, 'specificity': 0.7622998, 'f1': 0.6340773, 'auroc': 0.8499267, 'binary_precision': 0.20423728, 'binary_recall': 0.58072287, 'binary_specificity': 0.9438766, 'binary_f1_score': 0.30219436}
confusion matrix:
       0    1
0  15792  939
1    174  241
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8946015, 'precision': 0.6891096, 'recall': 0.83243454, 'specificity': 0.83243454, 'f1': 0.7322134, 'auroc': 0.90436614, 'binary_precision': 0.39972714, 'binary_recall': 0.75906736, 'binary_specificity': 0.9058018, 'binary_f1_score': 0.5236818}
confusion matrix:
      0    1
0  8462  880
1   186  586
new oracle model saved
early stop counter: 1
val acc:0.9350869059562683, best validation acc: 0.937361478805542, corresponding to test acc:                         0.8922286033630371 / 0.8946015238761902
after epoch: 4,now: 2024-08-11 01:59:34.417453,epoch time: 0:17:58.470051,used: 1:12:26.712065,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_00_47_06_seed_0_24141976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9543391, 'precision': 0.95559865, 'recall': 0.9543557, 'specificity': 0.9543557, 'f1': 0.9543086, 'auroc': 0.98928463, 'binary_precision': 0.97971255, 'binary_recall': 0.9279514, 'binary_specificity': 0.9807601, 'binary_f1_score': 0.95312977}
confusion matrix:
       0      1
0  24825    487
1   1826  23518
---- Validation: 
scalar performance:
{'acc': 0.9415024, 'precision': 0.60806245, 'recall': 0.7691119, 'specificity': 0.7691119, 'f1': 0.6483594, 'auroc': 0.85941243, 'binary_precision': 0.2267658, 'binary_recall': 0.5879518, 'binary_specificity': 0.95027196, 'binary_f1_score': 0.3272971}
confusion matrix:
       0    1
0  15899  832
1    171  244
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9010283, 'precision': 0.6978945, 'recall': 0.8329427, 'specificity': 0.8329427, 'f1': 0.7409029, 'auroc': 0.9075, 'binary_precision': 0.41768512, 'binary_recall': 0.75259066, 'binary_specificity': 0.9132948, 'binary_f1_score': 0.53721684}
confusion matrix:
      0    1
0  8532  810
1   191  581
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-11 02:17:18.177393,epoch time: 0:17:43.759940,used: 1:30:10.472005,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_00_47_06_seed_0_24141976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96225524, 'precision': 0.9628402, 'recall': 0.9622637, 'specificity': 0.9622637, 'f1': 0.9622438, 'auroc': 0.9915391, 'binary_precision': 0.9794139, 'binary_recall': 0.9443962, 'binary_specificity': 0.98013115, 'binary_f1_score': 0.96158636}
confusion matrix:
       0      1
0  24813    503
1   1409  23931
---- Validation: 
scalar performance:
{'acc': 0.9270384, 'precision': 0.59250045, 'recall': 0.787549, 'specificity': 0.787549, 'f1': 0.629946, 'auroc': 0.86583304, 'binary_precision': 0.19444445, 'binary_recall': 0.64096385, 'binary_specificity': 0.93413424, 'binary_f1_score': 0.29837352}
confusion matrix:
       0     1
0  15629  1102
1    149   266
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89450264, 'precision': 0.68983537, 'recall': 0.8365401, 'specificity': 0.8365401, 'f1': 0.7335245, 'auroc': 0.90623045, 'binary_precision': 0.40040514, 'binary_recall': 0.7681347, 'binary_specificity': 0.90494543, 'binary_f1_score': 0.5264092}
confusion matrix:
      0    1
0  8454  888
1   179  593
early stop counter: 1
val acc:0.9270383715629578, best validation acc: 0.9415023922920227, corresponding to test acc:                         0.9010282754898071 / 0.9010282754898071
after epoch: 6,now: 2024-08-11 02:35:19.031398,epoch time: 0:18:00.854005,used: 1:48:11.326010,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_00_47_06_seed_0_24141976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9630646, 'precision': 0.96398973, 'recall': 0.9630761, 'specificity': 0.9630761, 'f1': 0.9630468, 'auroc': 0.99201524, 'binary_precision': 0.98483723, 'binary_recall': 0.94064957, 'binary_specificity': 0.98550266, 'binary_f1_score': 0.96223634}
confusion matrix:
       0      1
0  24948    367
1   1504  23837
---- Validation: 
scalar performance:
{'acc': 0.9376531, 'precision': 0.6064146, 'recall': 0.78828835, 'specificity': 0.78828835, 'f1': 0.6481235, 'auroc': 0.87229335, 'binary_precision': 0.22241087, 'binary_recall': 0.6313253, 'binary_specificity': 0.94525135, 'binary_f1_score': 0.3289391}
confusion matrix:
       0    1
0  15815  916
1    153  262
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9019181, 'precision': 0.6991534, 'recall': 0.8328303, 'specificity': 0.8328303, 'f1': 0.74207705, 'auroc': 0.90651155, 'binary_precision': 0.42028984, 'binary_recall': 0.7512953, 'binary_specificity': 0.91436523, 'binary_f1_score': 0.5390335}
confusion matrix:
      0    1
0  8542  800
1   192  580
new oracle model saved
early stop counter: 2
val acc:0.937653124332428, best validation acc: 0.9415023922920227, corresponding to test acc:                         0.9010282754898071 / 0.9019181132316589
after epoch: 7,now: 2024-08-11 02:53:04.413112,epoch time: 0:17:45.381714,used: 2:05:56.707724,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_00_47_06_seed_0_24141976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.96468335, 'precision': 0.96518534, 'recall': 0.9646932, 'specificity': 0.9646932, 'f1': 0.96467435, 'auroc': 0.9924715, 'binary_precision': 0.98061544, 'binary_recall': 0.94815135, 'binary_specificity': 0.98123497, 'binary_f1_score': 0.9641102}
confusion matrix:
       0      1
0  24838    475
1   1314  24029
---- Validation: 
scalar performance:
{'acc': 0.9333372, 'precision': 0.60138476, 'recall': 0.79312646, 'specificity': 0.79312646, 'f1': 0.6420951, 'auroc': 0.8771856, 'binary_precision': 0.21202531, 'binary_recall': 0.6457831, 'binary_specificity': 0.9404698, 'binary_f1_score': 0.31923765}
confusion matrix:
       0    1
0  15735  996
1    147  268
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8996441, 'precision': 0.69567937, 'recall': 0.8315993, 'specificity': 0.8315993, 'f1': 0.738555, 'auroc': 0.908195, 'binary_precision': 0.41339985, 'binary_recall': 0.7512953, 'binary_specificity': 0.91190326, 'binary_f1_score': 0.53333336}
confusion matrix:
      0    1
0  8519  823
1   192  580
early stop counter: 3
val acc:0.9333372116088867, best validation acc: 0.9415023922920227, corresponding to test acc:                         0.9010282754898071 / 0.9019181132316589
after epoch: 8,now: 2024-08-11 03:11:06.122691,epoch time: 0:18:01.709579,used: 2:23:58.417303,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_00_47_06_seed_0_24141976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9668549, 'precision': 0.9672774, 'recall': 0.96686685, 'specificity': 0.96686685, 'f1': 0.966848, 'auroc': 0.9934299, 'binary_precision': 0.98152745, 'binary_recall': 0.95167273, 'binary_specificity': 0.982061, 'binary_f1_score': 0.96636957}
confusion matrix:
       0      1
0  24854    454
1   1225  24123
---- Validation: 
scalar performance:
{'acc': 0.93281233, 'precision': 0.600374, 'recall': 0.7916826, 'specificity': 0.7916826, 'f1': 0.64069754, 'auroc': 0.88164115, 'binary_precision': 0.2100708, 'binary_recall': 0.6433735, 'binary_specificity': 0.93999165, 'binary_f1_score': 0.31672597}
confusion matrix:
       0     1
0  15727  1004
1    148   267
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9027091, 'precision': 0.6998321, 'recall': 0.8302877, 'specificity': 0.8302877, 'f1': 0.7422557, 'auroc': 0.9076334, 'binary_precision': 0.42217326, 'binary_recall': 0.7448186, 'binary_specificity': 0.9157568, 'binary_f1_score': 0.53889406}
confusion matrix:
      0    1
0  8555  787
1   197  575
new oracle model saved
early stop counter: 4
val acc:0.9328123331069946, best validation acc: 0.9415023922920227, corresponding to test acc:                         0.9010282754898071 / 0.9027091264724731
after epoch: 9,now: 2024-08-11 03:29:05.150854,epoch time: 0:17:59.028163,used: 2:41:57.445466,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_00_47_06_seed_0_24141976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9691843, 'precision': 0.96962, 'recall': 0.96919405, 'specificity': 0.96919405, 'f1': 0.9691776, 'auroc': 0.99439716, 'binary_precision': 0.98408306, 'binary_recall': 0.95383525, 'binary_specificity': 0.9845528, 'binary_f1_score': 0.9687231}
confusion matrix:
       0      1
0  24921    391
1   1170  24174
---- Validation: 
scalar performance:
{'acc': 0.93567014, 'precision': 0.6043385, 'recall': 0.791972, 'specificity': 0.791972, 'f1': 0.6458035, 'auroc': 0.8833426, 'binary_precision': 0.21803279, 'binary_recall': 0.64096385, 'binary_specificity': 0.9429801, 'binary_f1_score': 0.32538226}
confusion matrix:
       0    1
0  15777  954
1    149  266
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90359896, 'precision': 0.70091724, 'recall': 0.828987, 'specificity': 0.828987, 'f1': 0.74301827, 'auroc': 0.9097471, 'binary_precision': 0.42464736, 'binary_recall': 0.74093264, 'binary_specificity': 0.9170413, 'binary_f1_score': 0.5398773}
confusion matrix:
      0    1
0  8567  775
1   200  572
new oracle model saved
early stop counter: 5
val acc:0.9356701374053955, best validation acc: 0.9415023922920227, corresponding to test acc:                         0.9010282754898071 / 0.903598964214325
after epoch: 10,now: 2024-08-11 03:47:09.228057,epoch time: 0:18:04.077203,used: 3:00:01.522669,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_00_47_06_seed_0_24141976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.97046745, 'precision': 0.97086823, 'recall': 0.97047615, 'specificity': 0.97047615, 'f1': 0.9704616, 'auroc': 0.9947419, 'binary_precision': 0.98475426, 'binary_recall': 0.95576686, 'binary_specificity': 0.9851855, 'binary_f1_score': 0.9700441}
confusion matrix:
       0      1
0  24938    375
1   1121  24222
---- Validation: 
scalar performance:
{'acc': 0.9410358, 'precision': 0.6105665, 'recall': 0.78297204, 'specificity': 0.78297204, 'f1': 0.6526632, 'auroc': 0.87875617, 'binary_precision': 0.23104693, 'binary_recall': 0.6168675, 'binary_specificity': 0.9490766, 'binary_f1_score': 0.33617863}
confusion matrix:
       0    1
0  15879  852
1    159  256
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9089381, 'precision': 0.70704466, 'recall': 0.81524104, 'specificity': 0.81524104, 'f1': 0.7455057, 'auroc': 0.90624005, 'binary_precision': 0.43977365, 'binary_recall': 0.7046632, 'binary_specificity': 0.92581886, 'binary_f1_score': 0.54156303}
confusion matrix:
      0    1
0  8649  693
1   228  544
new oracle model saved
early stop counter: 6
val acc:0.941035807132721, best validation acc: 0.9415023922920227, corresponding to test acc:                         0.9010282754898071 / 0.9089381098747253
after epoch: 11,now: 2024-08-11 04:05:13.474117,epoch time: 0:18:04.246060,used: 3:18:05.768729,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_00_47_06_seed_0_24141976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.97234285, 'precision': 0.972621, 'recall': 0.97235155, 'specificity': 0.97235155, 'f1': 0.97233915, 'auroc': 0.9950079, 'binary_precision': 0.9842657, 'binary_recall': 0.9600726, 'binary_specificity': 0.9846306, 'binary_f1_score': 0.9720186}
confusion matrix:
       0      1
0  24921    389
1   1012  24334
---- Validation: 
scalar performance:
{'acc': 0.92593026, 'precision': 0.592921, 'recall': 0.7952058, 'specificity': 0.7952058, 'f1': 0.6307775, 'auroc': 0.88307667, 'binary_precision': 0.19486082, 'binary_recall': 0.6578313, 'binary_specificity': 0.93258023, 'binary_f1_score': 0.3006608}
confusion matrix:
       0     1
0  15603  1128
1    142   273
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9008305, 'precision': 0.69736314, 'recall': 0.8316474, 'specificity': 0.8316474, 'f1': 0.7401737, 'auroc': 0.9092814, 'binary_precision': 0.41684666, 'binary_recall': 0.75, 'binary_specificity': 0.9132948, 'binary_f1_score': 0.53586304}
confusion matrix:
      0    1
0  8532  810
1   193  579
early stop counter: 7
val acc:0.9259302616119385, best validation acc: 0.9415023922920227, corresponding to test acc:                         0.9010282754898071 / 0.9089381098747253
after epoch: 12,now: 2024-08-11 04:23:14.291548,epoch time: 0:18:00.817431,used: 3:36:06.586160,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_00_47_06_seed_0_24141976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.97402084, 'precision': 0.9743054, 'recall': 0.9740287, 'specificity': 0.9740287, 'f1': 0.97401726, 'auroc': 0.9957837, 'binary_precision': 0.9860819, 'binary_recall': 0.96164775, 'binary_specificity': 0.9864096, 'binary_f1_score': 0.9737116}
confusion matrix:
       0      1
0  24968    344
1    972  24372
---- Validation: 
scalar performance:
{'acc': 0.93409544, 'precision': 0.60144717, 'recall': 0.78881526, 'specificity': 0.78881526, 'f1': 0.6419147, 'auroc': 0.8820073, 'binary_precision': 0.21238938, 'binary_recall': 0.6361446, 'binary_specificity': 0.9414859, 'binary_f1_score': 0.31845596}
confusion matrix:
       0    1
0  15752  979
1    151  264
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90725726, 'precision': 0.704885, 'recall': 0.81908435, 'specificity': 0.81908435, 'f1': 0.74453413, 'auroc': 0.9083376, 'binary_precision': 0.43464568, 'binary_recall': 0.7150259, 'binary_specificity': 0.9231428, 'binary_f1_score': 0.54064643}
confusion matrix:
      0    1
0  8624  718
1   220  552
early stop counter: 8
val acc:0.9340954422950745, best validation acc: 0.9415023922920227, corresponding to test acc:                         0.9010282754898071 / 0.9089381098747253
after epoch: 13,now: 2024-08-11 04:41:17.525917,epoch time: 0:18:03.234369,used: 3:54:09.820529,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_00_47_06_seed_0_24141976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.97338915, 'precision': 0.97367054, 'recall': 0.97339594, 'specificity': 0.97339594, 'f1': 0.97338545, 'auroc': 0.9958677, 'binary_precision': 0.9853548, 'binary_recall': 0.96109223, 'binary_specificity': 0.9856996, 'binary_f1_score': 0.9730723}
confusion matrix:
       0      1
0  24952    362
1    986  24356
---- Validation: 
scalar performance:
{'acc': 0.9433104, 'precision': 0.61669064, 'recall': 0.7923621, 'specificity': 0.7923621, 'f1': 0.66074765, 'auroc': 0.8848022, 'binary_precision': 0.24284396, 'binary_recall': 0.63373494, 'binary_specificity': 0.9509892, 'binary_f1_score': 0.35113484}
confusion matrix:
       0    1
0  15911  820
1    152  263
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90972906, 'precision': 0.70888674, 'recall': 0.81804585, 'specificity': 0.81804585, 'f1': 0.7477163, 'auroc': 0.9105828, 'binary_precision': 0.4430073, 'binary_recall': 0.7098446, 'binary_specificity': 0.92624706, 'binary_f1_score': 0.5455451}
confusion matrix:
      0    1
0  8653  689
1   224  548
new oracle model saved
better model found
persisted
after epoch: 14,now: 2024-08-11 04:59:20.389473,epoch time: 0:18:02.863556,used: 4:12:12.684085,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_00_47_06_seed_0_24141976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9746723, 'precision': 0.9748227, 'recall': 0.9746769, 'specificity': 0.9746769, 'f1': 0.97467047, 'auroc': 0.99568737, 'binary_precision': 0.98340297, 'binary_recall': 0.96566826, 'binary_specificity': 0.98368555, 'binary_f1_score': 0.974455}
confusion matrix:
       0      1
0  24902    413
1    870  24471
---- Validation: 
scalar performance:
{'acc': 0.92668843, 'precision': 0.59433544, 'recall': 0.7979442, 'specificity': 0.7979442, 'f1': 0.6328386, 'auroc': 0.88481504, 'binary_precision': 0.19755746, 'binary_recall': 0.6626506, 'binary_specificity': 0.93323773, 'binary_f1_score': 0.3043719}
confusion matrix:
       0     1
0  15614  1117
1    140   275
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9009294, 'precision': 0.69728535, 'recall': 0.83051264, 'specificity': 0.83051264, 'f1': 0.73990273, 'auroc': 0.9083071, 'binary_precision': 0.41690752, 'binary_recall': 0.74740934, 'binary_specificity': 0.91361594, 'binary_f1_score': 0.5352504}
confusion matrix:
      0    1
0  8535  807
1   195  577
early stop counter: 1
val acc:0.9266884326934814, best validation acc: 0.9433103799819946, corresponding to test acc:                         0.9097290635108948 / 0.9097290635108948
after epoch: 15,now: 2024-08-11 05:17:17.498682,epoch time: 0:17:57.109209,used: 4:30:09.793294,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_00_47_06_seed_0_24141976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 4:30:09.793294 at 2024-08-11 05:17:17.498682
persisted model performance metric: 

scalar performance:
{'acc': 0.90972906, 'precision': 0.70888674, 'recall': 0.81804585, 'specificity': 0.81804585, 'f1': 0.7477163, 'auroc': 0.9105828, 'binary_precision': 0.4430073, 'binary_recall': 0.7098446, 'binary_specificity': 0.92624706, 'binary_f1_score': 0.5455451}
confusion matrix:
      0    1
0  8653  689
1   224  548
oracle model performance metric: 

scalar performance:
{'acc': 0.90972906, 'precision': 0.70888674, 'recall': 0.81804585, 'specificity': 0.81804585, 'f1': 0.7477163, 'auroc': 0.9105828, 'binary_precision': 0.4430073, 'binary_recall': 0.7098446, 'binary_specificity': 0.92624706, 'binary_f1_score': 0.5455451}
confusion matrix:
      0    1
0  8653  689
1   224  548
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-10_12-05-04/rule_results/7.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-10_12-05-04/rule_results/7.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-10_12-05-04/confusion_matrix/7.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1144 MiB |   8781 MiB | 351634 GiB | 351633 GiB |
|       from large pool |   1106 MiB |   8737 MiB | 346055 GiB | 346054 GiB |
|       from small pool |     38 MiB |     79 MiB |   5579 GiB |   5579 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1144 MiB |   8781 MiB | 351634 GiB | 351633 GiB |
|       from large pool |   1106 MiB |   8737 MiB | 346055 GiB | 346054 GiB |
|       from small pool |     38 MiB |     79 MiB |   5579 GiB |   5579 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1142 MiB |   8778 MiB | 351493 GiB | 351492 GiB |
|       from large pool |   1105 MiB |   8734 MiB | 345926 GiB | 345925 GiB |
|       from small pool |     36 MiB |     77 MiB |   5567 GiB |   5567 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9458 MiB |   9458 MiB |   9458 MiB |      0 B   |
|       from large pool |   9372 MiB |   9372 MiB |   9372 MiB |      0 B   |
|       from small pool |     86 MiB |     86 MiB |     86 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  85354 KiB |   1146 MiB | 218259 GiB | 218259 GiB |
|       from large pool |  65366 KiB |   1143 MiB | 212669 GiB | 212669 GiB |
|       from small pool |  19988 KiB |     21 MiB |   5589 GiB |   5589 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4918    |    7321    |   68996 K  |   68991 K  |
|       from large pool |     161    |     844    |   32633 K  |   32633 K  |
|       from small pool |    4757    |    7158    |   36362 K  |   36358 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4918    |    7321    |   68996 K  |   68991 K  |
|       from large pool |     161    |     844    |   32633 K  |   32633 K  |
|       from small pool |    4757    |    7158    |   36362 K  |   36358 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     333    |     333    |     333    |       0    |
|       from large pool |     290    |     290    |     290    |       0    |
|       from small pool |      43    |      43    |      43    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      77    |    3202    |   38367 K  |   38367 K  |
|       from large pool |      23    |     295    |   21436 K  |   21436 K  |
|       from small pool |      54    |    3180    |   16930 K  |   16930 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8781 MiB | 351634 GiB | 351634 GiB |
|       from large pool |  16640 KiB |   8737 MiB | 346055 GiB | 346055 GiB |
|       from small pool |      0 KiB |     79 MiB |   5579 GiB |   5579 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8781 MiB | 351634 GiB | 351634 GiB |
|       from large pool |  16640 KiB |   8737 MiB | 346055 GiB | 346055 GiB |
|       from small pool |      0 KiB |     79 MiB |   5579 GiB |   5579 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8778 MiB | 351493 GiB | 351493 GiB |
|       from large pool |  16640 KiB |   8734 MiB | 345926 GiB | 345926 GiB |
|       from small pool |      0 KiB |     77 MiB |   5567 GiB |   5567 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1228 MiB |   9458 MiB |   9458 MiB |   8230 MiB |
|       from large pool |   1170 MiB |   9372 MiB |   9372 MiB |   8202 MiB |
|       from small pool |     58 MiB |     86 MiB |     86 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB |   1146 MiB | 218259 GiB | 218259 GiB |
|       from large pool |  30464 KiB |   1143 MiB | 212669 GiB | 212669 GiB |
|       from small pool |      0 KiB |     34 MiB |   5589 GiB |   5589 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7321    |   68996 K  |   68996 K  |
|       from large pool |       2    |     844    |   32633 K  |   32633 K  |
|       from small pool |       0    |    7158    |   36362 K  |   36362 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7321    |   68996 K  |   68996 K  |
|       from large pool |       2    |     844    |   32633 K  |   32633 K  |
|       from small pool |       0    |    7158    |   36362 K  |   36362 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      56    |     333    |     333    |     277    |
|       from large pool |      27    |     290    |     290    |     263    |
|       from small pool |      29    |      43    |      43    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    3202    |   38369 K  |   38369 K  |
|       from large pool |       2    |     295    |   21436 K  |   21436 K  |
|       from small pool |       0    |    3180    |   16932 K  |   16932 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8781 MiB | 351634 GiB | 351634 GiB |
|       from large pool |  16640 KiB |   8737 MiB | 346055 GiB | 346055 GiB |
|       from small pool |      0 KiB |     79 MiB |   5579 GiB |   5579 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8781 MiB | 351634 GiB | 351634 GiB |
|       from large pool |  16640 KiB |   8737 MiB | 346055 GiB | 346055 GiB |
|       from small pool |      0 KiB |     79 MiB |   5579 GiB |   5579 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8778 MiB | 351493 GiB | 351493 GiB |
|       from large pool |  16640 KiB |   8734 MiB | 345926 GiB | 345926 GiB |
|       from small pool |      0 KiB |     77 MiB |   5567 GiB |   5567 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1228 MiB |   9458 MiB |   9458 MiB |   8230 MiB |
|       from large pool |   1170 MiB |   9372 MiB |   9372 MiB |   8202 MiB |
|       from small pool |     58 MiB |     86 MiB |     86 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB |   1146 MiB | 218259 GiB | 218259 GiB |
|       from large pool |  30464 KiB |   1143 MiB | 212669 GiB | 212669 GiB |
|       from small pool |      0 KiB |     34 MiB |   5589 GiB |   5589 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7321    |   68996 K  |   68996 K  |
|       from large pool |       2    |     844    |   32633 K  |   32633 K  |
|       from small pool |       0    |    7158    |   36362 K  |   36362 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7321    |   68996 K  |   68996 K  |
|       from large pool |       2    |     844    |   32633 K  |   32633 K  |
|       from small pool |       0    |    7158    |   36362 K  |   36362 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      56    |     333    |     333    |     277    |
|       from large pool |      27    |     290    |     290    |     263    |
|       from small pool |      29    |      43    |      43    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    3202    |   38369 K  |   38369 K  |
|       from large pool |       2    |     295    |   21436 K  |   21436 K  |
|       from small pool |       0    |    3180    |   16932 K  |   16932 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_05_27_32_seed_1_24141976

 Experiment start at: 2024-08-11 05:27:33.766326
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.7581012845039368
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.89675796, 'precision': 0.8996222, 'recall': 0.8967947, 'specificity': 0.8967947, 'f1': 0.8965788, 'auroc': 0.9599366, 'binary_precision': 0.9336713, 'binary_recall': 0.8543911, 'binary_specificity': 0.93919826, 'binary_f1_score': 0.8922736}
confusion matrix:
       0      1
0  23850   1544
1   3704  21734
---- Validation: 
scalar performance:
{'acc': 0.92548037, 'precision': 0.51617855, 'recall': 0.53458583, 'specificity': 0.53458583, 'f1': 0.5189369, 'auroc': 0.68123716, 'binary_precision': 0.05573081, 'binary_recall': 0.122969836, 'binary_specificity': 0.9462018, 'binary_f1_score': 0.076700434}
confusion matrix:
       0    1
0  15794  898
1    378   53
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8992171, 'precision': 0.5449303, 'recall': 0.5237023, 'specificity': 0.5237023, 'f1': 0.5276328, 'auroc': 0.7413171, 'binary_precision': 0.16145833, 'binary_recall': 0.08190224, 'binary_specificity': 0.96550244, 'binary_f1_score': 0.10867659}
confusion matrix:
      0    1
0  9012  322
1   695   62
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-11 05:46:48.917555,epoch time: 0:19:15.151229,used: 0:19:15.151229,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_05_27_32_seed_1_24141976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9295916, 'precision': 0.9318023, 'recall': 0.9296198, 'specificity': 0.9296198, 'f1': 0.9295044, 'auroc': 0.9776261, 'binary_precision': 0.9628955, 'binary_recall': 0.89373326, 'binary_specificity': 0.9655064, 'binary_f1_score': 0.92702615}
confusion matrix:
       0      1
0  24520    876
1   2703  22733
---- Validation: 
scalar performance:
{'acc': 0.91374177, 'precision': 0.5480855, 'recall': 0.64270896, 'specificity': 0.64270896, 'f1': 0.5635241, 'auroc': 0.7828393, 'binary_precision': 0.11373708, 'binary_recall': 0.3573086, 'binary_specificity': 0.9281093, 'binary_f1_score': 0.17254902}
confusion matrix:
       0     1
0  15492  1200
1    277   154
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89188385, 'precision': 0.6463628, 'recall': 0.6933216, 'specificity': 0.6933216, 'f1': 0.66508496, 'auroc': 0.84038156, 'binary_precision': 0.33786407, 'binary_recall': 0.45970938, 'binary_specificity': 0.92693377, 'binary_f1_score': 0.38947958}
confusion matrix:
      0    1
0  8652  682
1   409  348
early stop counter: 1
val acc:0.9137417674064636, best validation acc: 0.9254803657531738, corresponding to test acc:                         0.8992171287536621 / 0.8992171287536621
after epoch: 2,now: 2024-08-11 06:05:03.524158,epoch time: 0:18:14.606603,used: 0:37:29.757832,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_05_27_32_seed_1_24141976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9460576, 'precision': 0.94740695, 'recall': 0.9460826, 'specificity': 0.9460826, 'f1': 0.94601893, 'auroc': 0.9847816, 'binary_precision': 0.97220486, 'binary_recall': 0.91847163, 'binary_specificity': 0.97369355, 'binary_f1_score': 0.9445747}
confusion matrix:
       0      1
0  24725    668
1   2074  23365
---- Validation: 
scalar performance:
{'acc': 0.9232027, 'precision': 0.56570095, 'recall': 0.68146574, 'specificity': 0.68146574, 'f1': 0.58913696, 'auroc': 0.8267294, 'binary_precision': 0.14696486, 'binary_recall': 0.42691416, 'binary_specificity': 0.9360173, 'binary_f1_score': 0.21865718}
confusion matrix:
       0     1
0  15624  1068
1    247   184
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8966406, 'precision': 0.6547391, 'recall': 0.6958928, 'specificity': 0.6958928, 'f1': 0.67183864, 'auroc': 0.8567916, 'binary_precision': 0.35437882, 'binary_recall': 0.45970938, 'binary_specificity': 0.9320763, 'binary_f1_score': 0.40023}
confusion matrix:
      0    1
0  8700  634
1   409  348
early stop counter: 2
val acc:0.9232026934623718, best validation acc: 0.9254803657531738, corresponding to test acc:                         0.8992171287536621 / 0.8992171287536621
after epoch: 3,now: 2024-08-11 06:23:19.307504,epoch time: 0:18:15.783346,used: 0:55:45.541178,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_05_27_32_seed_1_24141976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.95040524, 'precision': 0.9522164, 'recall': 0.950429, 'specificity': 0.950429, 'f1': 0.9503573, 'auroc': 0.98760986, 'binary_precision': 0.9810228, 'binary_recall': 0.9186554, 'binary_specificity': 0.98220265, 'binary_f1_score': 0.9488153}
confusion matrix:
       0      1
0  24945    452
1   2069  23366
---- Validation: 
scalar performance:
{'acc': 0.91853064, 'precision': 0.5732765, 'recall': 0.7265352, 'specificity': 0.7265352, 'f1': 0.60083216, 'auroc': 0.85259426, 'binary_precision': 0.15960452, 'binary_recall': 0.52436197, 'binary_specificity': 0.9287084, 'binary_f1_score': 0.24472116}
confusion matrix:
       0     1
0  15502  1190
1    205   226
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89852345, 'precision': 0.65691066, 'recall': 0.69266206, 'specificity': 0.69266206, 'f1': 0.6721711, 'auroc': 0.86060905, 'binary_precision': 0.35932562, 'binary_recall': 0.45046234, 'binary_specificity': 0.9348618, 'binary_f1_score': 0.39976552}
confusion matrix:
      0    1
0  8726  608
1   416  341
early stop counter: 3
val acc:0.9185306429862976, best validation acc: 0.9254803657531738, corresponding to test acc:                         0.8992171287536621 / 0.8992171287536621
after epoch: 4,now: 2024-08-11 06:41:32.601643,epoch time: 0:18:13.294139,used: 1:13:58.835317,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_05_27_32_seed_1_24141976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9591399, 'precision': 0.9598781, 'recall': 0.95915496, 'specificity': 0.95915496, 'f1': 0.95912445, 'auroc': 0.98986465, 'binary_precision': 0.97849065, 'binary_recall': 0.9389817, 'binary_specificity': 0.9793283, 'binary_f1_score': 0.95832914}
confusion matrix:
       0      1
0  24872    525
1   1552  23883
---- Validation: 
scalar performance:
{'acc': 0.8891549, 'precision': 0.5608623, 'recall': 0.7555435, 'specificity': 0.7555435, 'f1': 0.57931745, 'auroc': 0.8614247, 'binary_precision': 0.13269904, 'binary_recall': 0.6148492, 'binary_specificity': 0.89623773, 'binary_f1_score': 0.21828665}
confusion matrix:
       0     1
0  14960  1732
1    166   265
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.888019, 'precision': 0.6559136, 'recall': 0.74100107, 'specificity': 0.74100107, 'f1': 0.6850228, 'auroc': 0.8679872, 'binary_precision': 0.3487429, 'binary_recall': 0.5680317, 'binary_specificity': 0.9139704, 'binary_f1_score': 0.43216082}
confusion matrix:
      0    1
0  8531  803
1   327  430
early stop counter: 4
val acc:0.8891549110412598, best validation acc: 0.9254803657531738, corresponding to test acc:                         0.8992171287536621 / 0.8992171287536621
after epoch: 5,now: 2024-08-11 06:59:45.972631,epoch time: 0:18:13.370988,used: 1:32:12.206305,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_05_27_32_seed_1_24141976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96307445, 'precision': 0.96373224, 'recall': 0.9630901, 'specificity': 0.9630901, 'f1': 0.96306217, 'auroc': 0.9918641, 'binary_precision': 0.9814058, 'binary_recall': 0.94409716, 'binary_specificity': 0.9820831, 'binary_f1_score': 0.96239}
confusion matrix:
       0      1
0  24940    455
1   1422  24015
---- Validation: 
scalar performance:
{'acc': 0.8708754, 'precision': 0.5562787, 'recall': 0.7721609, 'specificity': 0.7721609, 'f1': 0.56819594, 'auroc': 0.8672228, 'binary_precision': 0.12224109, 'binary_recall': 0.6682135, 'binary_specificity': 0.8761083, 'binary_f1_score': 0.20667385}
confusion matrix:
       0     1
0  14624  2068
1    143   288
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88326234, 'precision': 0.65555847, 'recall': 0.7602794, 'specificity': 0.7602794, 'f1': 0.68826115, 'auroc': 0.8734778, 'binary_precision': 0.3444198, 'binary_recall': 0.61558783, 'binary_specificity': 0.90497106, 'binary_f1_score': 0.44170612}
confusion matrix:
      0    1
0  8447  887
1   291  466
early stop counter: 5
val acc:0.8708754181861877, best validation acc: 0.9254803657531738, corresponding to test acc:                         0.8992171287536621 / 0.8992171287536621
after epoch: 6,now: 2024-08-11 07:17:59.192020,epoch time: 0:18:13.219389,used: 1:50:25.425694,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_05_27_32_seed_1_24141976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.965022, 'precision': 0.96558416, 'recall': 0.96503514, 'specificity': 0.96503514, 'f1': 0.9650122, 'auroc': 0.9931483, 'binary_precision': 0.98195004, 'binary_recall': 0.9475133, 'binary_specificity': 0.982557, 'binary_f1_score': 0.9644243}
confusion matrix:
       0      1
0  24954    443
1   1335  24100
---- Validation: 
scalar performance:
{'acc': 0.8560416, 'precision': 0.55314714, 'recall': 0.7826347, 'specificity': 0.7826347, 'f1': 0.5593887, 'auroc': 0.86955947, 'binary_precision': 0.115064345, 'binary_recall': 0.70533645, 'binary_specificity': 0.8599329, 'binary_f1_score': 0.19785227}
confusion matrix:
       0     1
0  14354  2338
1    127   304
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8795957, 'precision': 0.65361845, 'recall': 0.7680084, 'specificity': 0.7680084, 'f1': 0.687458, 'auroc': 0.8736774, 'binary_precision': 0.33895922, 'binary_recall': 0.63672394, 'binary_specificity': 0.8992929, 'binary_f1_score': 0.44240478}
confusion matrix:
      0    1
0  8394  940
1   275  482
early stop counter: 6
val acc:0.8560416102409363, best validation acc: 0.9254803657531738, corresponding to test acc:                         0.8992171287536621 / 0.8992171287536621
after epoch: 7,now: 2024-08-11 07:36:11.749305,epoch time: 0:18:12.557285,used: 2:08:37.982979,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_05_27_32_seed_1_24141976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9663401, 'precision': 0.96721154, 'recall': 0.96635723, 'specificity': 0.96635723, 'f1': 0.9663253, 'auroc': 0.99360645, 'binary_precision': 0.98758686, 'binary_recall': 0.94460607, 'binary_specificity': 0.98810834, 'binary_f1_score': 0.96561843}
confusion matrix:
       0      1
0  25094    302
1   1409  24027
---- Validation: 
scalar performance:
{'acc': 0.88366526, 'precision': 0.5622052, 'recall': 0.77646065, 'specificity': 0.77646065, 'f1': 0.58010703, 'auroc': 0.8776972, 'binary_precision': 0.13408345, 'binary_recall': 0.6635731, 'binary_specificity': 0.8893482, 'binary_f1_score': 0.22308892}
confusion matrix:
       0     1
0  14845  1847
1    145   286
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89713603, 'precision': 0.67205447, 'recall': 0.7532125, 'specificity': 0.7532125, 'f1': 0.70154595, 'auroc': 0.8771968, 'binary_precision': 0.37939915, 'binary_recall': 0.58388376, 'binary_specificity': 0.92254126, 'binary_f1_score': 0.45993754}
confusion matrix:
      0    1
0  8611  723
1   315  442
early stop counter: 7
val acc:0.8836652636528015, best validation acc: 0.9254803657531738, corresponding to test acc:                         0.8992171287536621 / 0.8992171287536621
after epoch: 8,now: 2024-08-11 07:54:24.529667,epoch time: 0:18:12.780362,used: 2:26:50.763341,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_05_27_32_seed_1_24141976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9688582, 'precision': 0.9695005, 'recall': 0.96887213, 'specificity': 0.96887213, 'f1': 0.9688482, 'auroc': 0.99478567, 'binary_precision': 0.9870538, 'binary_recall': 0.95022607, 'binary_specificity': 0.9875182, 'binary_f1_score': 0.96828985}
confusion matrix:
       0      1
0  25080    317
1   1266  24169
---- Validation: 
scalar performance:
{'acc': 0.89733106, 'precision': 0.567476, 'recall': 0.76764804, 'specificity': 0.76764804, 'f1': 0.5906412, 'auroc': 0.8775339, 'binary_precision': 0.1453768, 'binary_recall': 0.63109046, 'binary_specificity': 0.9042056, 'binary_f1_score': 0.23631625}
confusion matrix:
       0     1
0  15093  1599
1    159   272
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9059558, 'precision': 0.6815491, 'recall': 0.73066795, 'specificity': 0.73066795, 'f1': 0.70203465, 'auroc': 0.8759109, 'binary_precision': 0.40263692, 'binary_recall': 0.52443856, 'binary_specificity': 0.93689734, 'binary_f1_score': 0.4555364}
confusion matrix:
      0    1
0  8745  589
1   360  397
new oracle model saved
early stop counter: 8
val acc:0.8973310589790344, best validation acc: 0.9254803657531738, corresponding to test acc:                         0.8992171287536621 / 0.9059557914733887
after epoch: 9,now: 2024-08-11 08:12:37.005547,epoch time: 0:18:12.475880,used: 2:45:03.239221,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_05_27_32_seed_1_24141976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.970432, 'precision': 0.9708068, 'recall': 0.97044384, 'specificity': 0.97044384, 'f1': 0.9704266, 'auroc': 0.9951277, 'binary_precision': 0.9842979, 'binary_recall': 0.9561662, 'binary_specificity': 0.9847214, 'binary_f1_score': 0.9700281}
confusion matrix:
       0      1
0  25007    388
1   1115  24322
---- Validation: 
scalar performance:
{'acc': 0.8766571, 'precision': 0.55997825, 'recall': 0.7807771, 'specificity': 0.7807771, 'f1': 0.5751262, 'auroc': 0.87832534, 'binary_precision': 0.1292457, 'binary_recall': 0.6798144, 'binary_specificity': 0.88173974, 'binary_f1_score': 0.21719792}
confusion matrix:
       0     1
0  14718  1974
1    138   293
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9003072, 'precision': 0.67821574, 'recall': 0.75796133, 'specificity': 0.75796133, 'f1': 0.7077498, 'auroc': 0.88085276, 'binary_precision': 0.39107612, 'binary_recall': 0.5904888, 'binary_specificity': 0.9254339, 'binary_f1_score': 0.47052634}
confusion matrix:
      0    1
0  8638  696
1   310  447
early stop counter: 9
val acc:0.8766571283340454, best validation acc: 0.9254803657531738, corresponding to test acc:                         0.8992171287536621 / 0.9059557914733887
after epoch: 10,now: 2024-08-11 08:30:47.726846,epoch time: 0:18:10.721299,used: 3:03:13.960520,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_05_27_32_seed_1_24141976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9715927, 'precision': 0.9719945, 'recall': 0.9716055, 'specificity': 0.9716055, 'f1': 0.9715872, 'auroc': 0.99548584, 'binary_precision': 0.98598397, 'binary_recall': 0.9568362, 'binary_specificity': 0.98637474, 'binary_f1_score': 0.97119147}
confusion matrix:
       0      1
0  25048    346
1   1098  24340
---- Validation: 
scalar performance:
{'acc': 0.88395727, 'precision': 0.5623643, 'recall': 0.7766104, 'specificity': 0.7766104, 'f1': 0.5804088, 'auroc': 0.8788046, 'binary_precision': 0.13439849, 'binary_recall': 0.6635731, 'binary_specificity': 0.8896477, 'binary_f1_score': 0.2235248}
confusion matrix:
       0     1
0  14850  1842
1    145   286
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90873057, 'precision': 0.68860096, 'recall': 0.73702335, 'specificity': 0.73702335, 'f1': 0.7090108, 'auroc': 0.88182265, 'binary_precision': 0.4158111, 'binary_recall': 0.5350066, 'binary_specificity': 0.93904006, 'binary_f1_score': 0.4679376}
confusion matrix:
      0    1
0  8765  569
1   352  405
new oracle model saved
early stop counter: 10
val acc:0.8839572668075562, best validation acc: 0.9254803657531738, corresponding to test acc:                         0.8992171287536621 / 0.9087305665016174
after epoch: 11,now: 2024-08-11 08:48:59.356596,epoch time: 0:18:11.629750,used: 3:21:25.590270,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_05_27_32_seed_1_24141976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9734616, 'precision': 0.9737729, 'recall': 0.9734718, 'specificity': 0.9734718, 'f1': 0.97345763, 'auroc': 0.99558854, 'binary_precision': 0.98611504, 'binary_recall': 0.9604891, 'binary_specificity': 0.98645455, 'binary_f1_score': 0.9731334}
confusion matrix:
       0      1
0  25052    344
1   1005  24431
---- Validation: 
scalar performance:
{'acc': 0.8636921, 'precision': 0.557474, 'recall': 0.79446965, 'specificity': 0.79446965, 'f1': 0.5679135, 'auroc': 0.8839891, 'binary_precision': 0.12316832, 'binary_recall': 0.7215777, 'binary_specificity': 0.8673616, 'binary_f1_score': 0.21041949}
confusion matrix:
       0     1
0  14478  2214
1    120   311
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90456843, 'precision': 0.685668, 'recall': 0.75905085, 'specificity': 0.75905085, 'f1': 0.71388125, 'auroc': 0.8832836, 'binary_precision': 0.4060219, 'binary_recall': 0.58784676, 'binary_specificity': 0.930255, 'binary_f1_score': 0.48030218}
confusion matrix:
      0    1
0  8683  651
1   312  445
early stop counter: 11
val acc:0.8636921048164368, best validation acc: 0.9254803657531738, corresponding to test acc:                         0.8992171287536621 / 0.9087305665016174
after epoch: 12,now: 2024-08-11 09:07:12.307933,epoch time: 0:18:12.951337,used: 3:39:38.541607,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_05_27_32_seed_1_24141976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.97293043, 'precision': 0.9733082, 'recall': 0.97294223, 'specificity': 0.97294223, 'f1': 0.97292554, 'auroc': 0.9957734, 'binary_precision': 0.9868874, 'binary_recall': 0.9586429, 'binary_specificity': 0.98724157, 'binary_f1_score': 0.9725601}
confusion matrix:
       0      1
0  25071    324
1   1052  24385
---- Validation: 
scalar performance:
{'acc': 0.8757811, 'precision': 0.5616872, 'recall': 0.7927593, 'specificity': 0.7927593, 'f1': 0.57740164, 'auroc': 0.88369894, 'binary_precision': 0.13194445, 'binary_recall': 0.70533645, 'binary_specificity': 0.88018215, 'binary_f1_score': 0.2223035}
confusion matrix:
       0     1
0  14692  2000
1    127   304
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90783864, 'precision': 0.6896832, 'recall': 0.7498938, 'specificity': 0.7498938, 'f1': 0.71407527, 'auroc': 0.8827038, 'binary_precision': 0.4157741, 'binary_recall': 0.5640687, 'binary_specificity': 0.9357189, 'binary_f1_score': 0.47869954}
confusion matrix:
      0    1
0  8734  600
1   330  427
early stop counter: 12
val acc:0.8757811188697815, best validation acc: 0.9254803657531738, corresponding to test acc:                         0.8992171287536621 / 0.9087305665016174
after epoch: 13,now: 2024-08-11 09:25:24.703149,epoch time: 0:18:12.395216,used: 3:57:50.936823,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_05_27_32_seed_1_24141976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9754289, 'precision': 0.9755331, 'recall': 0.97543544, 'specificity': 0.97543544, 'f1': 0.97542775, 'auroc': 0.9963523, 'binary_precision': 0.9827951, 'binary_recall': 0.9678434, 'binary_specificity': 0.98302746, 'binary_f1_score': 0.975262}
confusion matrix:
       0      1
0  24963    431
1    818  24620
---- Validation: 
scalar performance:
{'acc': 0.869941, 'precision': 0.560416, 'recall': 0.79880494, 'specificity': 0.79880494, 'f1': 0.5739678, 'auroc': 0.8879458, 'binary_precision': 0.12892562, 'binary_recall': 0.72389793, 'binary_specificity': 0.87371194, 'binary_f1_score': 0.21887058}
confusion matrix:
       0     1
0  14584  2108
1    119   312
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9074423, 'precision': 0.68913686, 'recall': 0.75089335, 'specificity': 0.75089335, 'f1': 0.7140031, 'auroc': 0.88127303, 'binary_precision': 0.41449276, 'binary_recall': 0.5667107, 'binary_specificity': 0.93507606, 'binary_f1_score': 0.47879466}
confusion matrix:
      0    1
0  8728  606
1   328  429
early stop counter: 13
val acc:0.869940996170044, best validation acc: 0.9254803657531738, corresponding to test acc:                         0.8992171287536621 / 0.9087305665016174
after epoch: 14,now: 2024-08-11 09:43:39.596999,epoch time: 0:18:14.893850,used: 4:16:05.830673,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_05_27_32_seed_1_24141976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9765109, 'precision': 0.97670954, 'recall': 0.97651863, 'specificity': 0.97651863, 'f1': 0.97650874, 'auroc': 0.99638164, 'binary_precision': 0.98663026, 'binary_recall': 0.96614903, 'binary_specificity': 0.98688823, 'binary_f1_score': 0.97628224}
confusion matrix:
       0      1
0  25064    333
1    861  24574
---- Validation: 
scalar performance:
{'acc': 0.84751505, 'precision': 0.55422324, 'recall': 0.80538464, 'specificity': 0.80538464, 'f1': 0.55825645, 'auroc': 0.8814634, 'binary_precision': 0.115655854, 'binary_recall': 0.7610209, 'binary_specificity': 0.8497484, 'binary_f1_score': 0.20079584}
confusion matrix:
       0     1
0  14184  2508
1    103   328
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90377563, 'precision': 0.6834799, 'recall': 0.75558764, 'specificity': 0.75558764, 'f1': 0.71122414, 'auroc': 0.87805665, 'binary_precision': 0.40219378, 'binary_recall': 0.5812417, 'binary_specificity': 0.92993355, 'binary_f1_score': 0.4754187}
confusion matrix:
      0    1
0  8680  654
1   317  440
early stop counter: 14
val acc:0.8475150465965271, best validation acc: 0.9254803657531738, corresponding to test acc:                         0.8992171287536621 / 0.9087305665016174
after epoch: 15,now: 2024-08-11 10:01:56.564006,epoch time: 0:18:16.967007,used: 4:34:22.797680,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_05_27_32_seed_1_24141976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 4:34:22.797680 at 2024-08-11 10:01:56.564006
persisted model performance metric: 

scalar performance:
{'acc': 0.8992171, 'precision': 0.5449303, 'recall': 0.5237023, 'specificity': 0.5237023, 'f1': 0.5276328, 'auroc': 0.7413171, 'binary_precision': 0.16145833, 'binary_recall': 0.08190224, 'binary_specificity': 0.96550244, 'binary_f1_score': 0.10867659}
confusion matrix:
      0    1
0  9012  322
1   695   62
oracle model performance metric: 

scalar performance:
{'acc': 0.90873057, 'precision': 0.68860096, 'recall': 0.73702335, 'specificity': 0.73702335, 'f1': 0.7090108, 'auroc': 0.88182265, 'binary_precision': 0.4158111, 'binary_recall': 0.5350066, 'binary_specificity': 0.93904006, 'binary_f1_score': 0.4679376}
confusion matrix:
      0    1
0  8765  569
1   352  405
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-10_12-05-04/rule_results/7.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-10_12-05-04/confusion_matrix/7.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1146 MiB |   8782 MiB | 708185 GiB | 708184 GiB |
|       from large pool |   1107 MiB |   8738 MiB | 696978 GiB | 696977 GiB |
|       from small pool |     38 MiB |     79 MiB |  11206 GiB |  11206 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1146 MiB |   8782 MiB | 708185 GiB | 708184 GiB |
|       from large pool |   1107 MiB |   8738 MiB | 696978 GiB | 696977 GiB |
|       from small pool |     38 MiB |     79 MiB |  11206 GiB |  11206 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1142 MiB |   8778 MiB | 707942 GiB | 707941 GiB |
|       from large pool |   1105 MiB |   8734 MiB | 696759 GiB | 696757 GiB |
|       from small pool |     36 MiB |     77 MiB |  11183 GiB |  11183 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9434 MiB |   9458 MiB |  17664 MiB |   8230 MiB |
|       from large pool |   9354 MiB |   9372 MiB |  17556 MiB |   8202 MiB |
|       from small pool |     80 MiB |     86 MiB |    108 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 253843 KiB |   1146 MiB | 436547 GiB | 436547 GiB |
|       from large pool | 244088 KiB |   1143 MiB | 425321 GiB | 425321 GiB |
|       from small pool |   9754 KiB |     34 MiB |  11226 GiB |  11226 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4906    |    7343    |  138623 K  |  138618 K  |
|       from large pool |     161    |     844    |   65711 K  |   65711 K  |
|       from small pool |    4745    |    7180    |   72911 K  |   72907 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4906    |    7343    |  138623 K  |  138618 K  |
|       from large pool |     161    |     844    |   65711 K  |   65711 K  |
|       from small pool |    4745    |    7180    |   72911 K  |   72907 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     330    |     333    |     607    |     277    |
|       from large pool |     290    |     290    |     553    |     263    |
|       from small pool |      40    |      43    |      54    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      71    |    3214    |   76101 K  |   76101 K  |
|       from large pool |      22    |     295    |   42236 K  |   42236 K  |
|       from small pool |      49    |    3193    |   33865 K  |   33865 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8782 MiB | 708185 GiB | 708185 GiB |
|       from large pool |  16640 KiB |   8738 MiB | 696978 GiB | 696978 GiB |
|       from small pool |      0 KiB |     79 MiB |  11206 GiB |  11206 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8782 MiB | 708185 GiB | 708185 GiB |
|       from large pool |  16640 KiB |   8738 MiB | 696978 GiB | 696978 GiB |
|       from small pool |      0 KiB |     79 MiB |  11206 GiB |  11206 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8778 MiB | 707942 GiB | 707942 GiB |
|       from large pool |  16640 KiB |   8734 MiB | 696759 GiB | 696759 GiB |
|       from small pool |      0 KiB |     77 MiB |  11183 GiB |  11183 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1394 MiB |   9458 MiB |  17664 MiB |  16270 MiB |
|       from large pool |   1346 MiB |   9372 MiB |  17556 MiB |  16210 MiB |
|       from small pool |     48 MiB |     86 MiB |    108 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB |   1146 MiB | 436548 GiB | 436548 GiB |
|       from large pool |  30464 KiB |   1143 MiB | 425321 GiB | 425321 GiB |
|       from small pool |      0 KiB |     34 MiB |  11226 GiB |  11226 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7343    |  138623 K  |  138623 K  |
|       from large pool |       2    |     844    |   65711 K  |   65711 K  |
|       from small pool |       0    |    7180    |   72911 K  |   72911 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7343    |  138623 K  |  138623 K  |
|       from large pool |       2    |     844    |   65711 K  |   65711 K  |
|       from small pool |       0    |    7180    |   72911 K  |   72911 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      51    |     333    |     607    |     556    |
|       from large pool |      27    |     290    |     553    |     526    |
|       from small pool |      24    |      43    |      54    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    3214    |   76103 K  |   76103 K  |
|       from large pool |       2    |     295    |   42236 K  |   42236 K  |
|       from small pool |       0    |    3193    |   33867 K  |   33867 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8782 MiB | 708185 GiB | 708185 GiB |
|       from large pool |  16640 KiB |   8738 MiB | 696978 GiB | 696978 GiB |
|       from small pool |      0 KiB |     79 MiB |  11206 GiB |  11206 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8782 MiB | 708185 GiB | 708185 GiB |
|       from large pool |  16640 KiB |   8738 MiB | 696978 GiB | 696978 GiB |
|       from small pool |      0 KiB |     79 MiB |  11206 GiB |  11206 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8778 MiB | 707942 GiB | 707942 GiB |
|       from large pool |  16640 KiB |   8734 MiB | 696759 GiB | 696759 GiB |
|       from small pool |      0 KiB |     77 MiB |  11183 GiB |  11183 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1394 MiB |   9458 MiB |  17664 MiB |  16270 MiB |
|       from large pool |   1346 MiB |   9372 MiB |  17556 MiB |  16210 MiB |
|       from small pool |     48 MiB |     86 MiB |    108 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB |   1146 MiB | 436548 GiB | 436548 GiB |
|       from large pool |  30464 KiB |   1143 MiB | 425321 GiB | 425321 GiB |
|       from small pool |      0 KiB |     34 MiB |  11226 GiB |  11226 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7343    |  138623 K  |  138623 K  |
|       from large pool |       2    |     844    |   65711 K  |   65711 K  |
|       from small pool |       0    |    7180    |   72911 K  |   72911 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7343    |  138623 K  |  138623 K  |
|       from large pool |       2    |     844    |   65711 K  |   65711 K  |
|       from small pool |       0    |    7180    |   72911 K  |   72911 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      51    |     333    |     607    |     556    |
|       from large pool |      27    |     290    |     553    |     526    |
|       from small pool |      24    |      43    |      54    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    3214    |   76103 K  |   76103 K  |
|       from large pool |       2    |     295    |   42236 K  |   42236 K  |
|       from small pool |       0    |    3193    |   33867 K  |   33867 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_10_12_12_seed_2_24141976

 Experiment start at: 2024-08-11 10:12:13.106154
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.2606024444103241
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.88873416, 'precision': 0.8892549, 'recall': 0.8887391, 'specificity': 0.8887391, 'f1': 0.8886978, 'auroc': 0.9561889, 'binary_precision': 0.90356123, 'binary_recall': 0.87043124, 'binary_specificity': 0.9070469, 'binary_f1_score': 0.88668686}
confusion matrix:
       0      1
0  23439   2402
1   3350  22505
---- Validation: 
scalar performance:
{'acc': 0.87561315, 'precision': 0.5249611, 'recall': 0.60736996, 'specificity': 0.60736996, 'f1': 0.52317727, 'auroc': 0.7037109, 'binary_precision': 0.06854839, 'binary_recall': 0.32535884, 'binary_specificity': 0.88938105, 'binary_f1_score': 0.113238975}
confusion matrix:
       0     1
0  14858  1848
1    282   136
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9044788, 'precision': 0.64187783, 'recall': 0.5999931, 'specificity': 0.5999931, 'f1': 0.6157851, 'auroc': 0.7845949, 'binary_precision': 0.34734917, 'binary_recall': 0.23839398, 'binary_specificity': 0.96159226, 'binary_f1_score': 0.2827381}
confusion matrix:
      0    1
0  8938  357
1   607  190
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-11 10:32:01.234455,epoch time: 0:19:48.128301,used: 0:19:48.128301,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_10_12_12_seed_2_24141976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.92730576, 'precision': 0.9323195, 'recall': 0.92730784, 'specificity': 0.92730784, 'f1': 0.9270947, 'auroc': 0.977975, 'binary_precision': 0.97888577, 'binary_recall': 0.8734574, 'binary_specificity': 0.9811584, 'binary_f1_score': 0.9231713}
confusion matrix:
       0      1
0  25360    487
1   3271  22578
---- Validation: 
scalar performance:
{'acc': 0.9586545, 'precision': 0.59739214, 'recall': 0.6172747, 'specificity': 0.6172747, 'f1': 0.6062601, 'auroc': 0.79025865, 'binary_precision': 0.21343873, 'binary_recall': 0.2583732, 'binary_specificity': 0.9761762, 'binary_f1_score': 0.23376623}
confusion matrix:
       0    1
0  16308  398
1    310  108
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92043203, 'precision': 0.70571464, 'recall': 0.5490034, 'specificity': 0.5490034, 'f1': 0.5673034, 'auroc': 0.8225089, 'binary_precision': 0.48314607, 'binary_recall': 0.10790464, 'binary_specificity': 0.99010223, 'binary_f1_score': 0.17641026}
confusion matrix:
      0   1
0  9203  92
1   711  86
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-11 10:50:28.418272,epoch time: 0:18:27.183817,used: 0:38:15.312118,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_10_12_12_seed_2_24141976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9395311, 'precision': 0.942664, 'recall': 0.93954414, 'specificity': 0.93954414, 'f1': 0.9394252, 'auroc': 0.9839166, 'binary_precision': 0.9799814, 'binary_recall': 0.8974319, 'binary_specificity': 0.9816564, 'binary_f1_score': 0.93689185}
confusion matrix:
       0      1
0  25366    474
1   2652  23204
---- Validation: 
scalar performance:
{'acc': 0.9567858, 'precision': 0.613783, 'recall': 0.6687979, 'specificity': 0.6687979, 'f1': 0.6351276, 'auroc': 0.8251029, 'binary_precision': 0.24363057, 'binary_recall': 0.3660287, 'binary_specificity': 0.9715671, 'binary_f1_score': 0.29254302}
confusion matrix:
       0    1
0  16231  475
1    265  153
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91914386, 'precision': 0.7024164, 'recall': 0.5867327, 'specificity': 0.5867327, 'f1': 0.61495984, 'auroc': 0.8308206, 'binary_precision': 0.47076923, 'binary_recall': 0.19196989, 'binary_specificity': 0.98149544, 'binary_f1_score': 0.27272728}
confusion matrix:
      0    1
0  9123  172
1   644  153
early stop counter: 1
val acc:0.9567857980728149, best validation acc: 0.958654522895813, corresponding to test acc:                         0.9204320311546326 / 0.9204320311546326
after epoch: 3,now: 2024-08-11 11:09:16.205116,epoch time: 0:18:47.786844,used: 0:57:03.098962,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_10_12_12_seed_2_24141976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.94769424, 'precision': 0.9499899, 'recall': 0.9476997, 'specificity': 0.9476997, 'f1': 0.9476279, 'auroc': 0.9878031, 'binary_precision': 0.9821696, 'binary_recall': 0.91196036, 'binary_specificity': 0.9834391, 'binary_f1_score': 0.9457638}
confusion matrix:
       0      1
0  25416    428
1   2276  23576
---- Validation: 
scalar performance:
{'acc': 0.96291757, 'precision': 0.642004, 'recall': 0.68243665, 'specificity': 0.68243665, 'f1': 0.6593883, 'auroc': 0.837644, 'binary_precision': 0.29944548, 'binary_recall': 0.3875598, 'binary_specificity': 0.9773135, 'binary_f1_score': 0.33785194}
confusion matrix:
       0    1
0  16327  379
1    256  162
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9199366, 'precision': 0.70636165, 'recall': 0.57626534, 'specificity': 0.57626534, 'f1': 0.60339236, 'auroc': 0.83450973, 'binary_precision': 0.48028675, 'binary_recall': 0.16813049, 'binary_specificity': 0.9844002, 'binary_f1_score': 0.24907063}
confusion matrix:
      0    1
0  9150  145
1   663  134
better model found
persisted
after epoch: 4,now: 2024-08-11 11:27:55.838550,epoch time: 0:18:39.633434,used: 1:15:42.732396,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_10_12_12_seed_2_24141976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.95322657, 'precision': 0.95465195, 'recall': 0.95323306, 'specificity': 0.95323306, 'f1': 0.9531903, 'auroc': 0.98964727, 'binary_precision': 0.9801672, 'binary_recall': 0.92519534, 'binary_specificity': 0.9812708, 'binary_f1_score': 0.9518882}
confusion matrix:
       0      1
0  25358    484
1   1934  23920
---- Validation: 
scalar performance:
{'acc': 0.95258117, 'precision': 0.615046, 'recall': 0.7074615, 'specificity': 0.7074615, 'f1': 0.64596844, 'auroc': 0.84653974, 'binary_precision': 0.24415584, 'binary_recall': 0.44976076, 'binary_specificity': 0.9651622, 'binary_f1_score': 0.3164983}
confusion matrix:
       0    1
0  16124  582
1    230  188
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9203329, 'precision': 0.71507776, 'recall': 0.6160562, 'specificity': 0.6160562, 'f1': 0.6465817, 'auroc': 0.83360046, 'binary_precision': 0.4915254, 'binary_recall': 0.25470513, 'binary_specificity': 0.9774072, 'binary_f1_score': 0.33553717}
confusion matrix:
      0    1
0  9085  210
1   594  203
early stop counter: 1
val acc:0.9525811672210693, best validation acc: 0.9629175662994385, corresponding to test acc:                         0.9199365973472595 / 0.9204320311546326
after epoch: 5,now: 2024-08-11 11:46:36.451298,epoch time: 0:18:40.612748,used: 1:34:23.345144,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_10_12_12_seed_2_24141976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.95823663, 'precision': 0.95941794, 'recall': 0.9582415, 'specificity': 0.9582415, 'f1': 0.9582101, 'auroc': 0.99101555, 'binary_precision': 0.9827628, 'binary_recall': 0.93285114, 'binary_specificity': 0.9836319, 'binary_f1_score': 0.9571568}
confusion matrix:
       0      1
0  25420    423
1   1736  24117
---- Validation: 
scalar performance:
{'acc': 0.9550339, 'precision': 0.623184, 'recall': 0.7122172, 'specificity': 0.7122172, 'f1': 0.65416574, 'auroc': 0.84887826, 'binary_precision': 0.260218, 'binary_recall': 0.4569378, 'binary_specificity': 0.9674967, 'binary_f1_score': 0.3315972}
confusion matrix:
       0    1
0  16163  543
1    227  191
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9198375, 'precision': 0.7101968, 'recall': 0.6025953, 'specificity': 0.6025953, 'f1': 0.6327051, 'auroc': 0.82900274, 'binary_precision': 0.48387095, 'binary_recall': 0.22584693, 'binary_specificity': 0.9793437, 'binary_f1_score': 0.30795553}
confusion matrix:
      0    1
0  9103  192
1   617  180
early stop counter: 2
val acc:0.9550338983535767, best validation acc: 0.9629175662994385, corresponding to test acc:                         0.9199365973472595 / 0.9204320311546326
after epoch: 6,now: 2024-08-11 12:05:18.839633,epoch time: 0:18:42.388335,used: 1:53:05.733479,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_10_12_12_seed_2_24141976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96195066, 'precision': 0.96278536, 'recall': 0.9619564, 'specificity': 0.9619564, 'f1': 0.96193385, 'auroc': 0.99148655, 'binary_precision': 0.9825079, 'binary_recall': 0.9406691, 'binary_specificity': 0.9832437, 'binary_f1_score': 0.9611334}
confusion matrix:
       0      1
0  25408    433
1   1534  24321
---- Validation: 
scalar performance:
{'acc': 0.94411355, 'precision': 0.60622764, 'recall': 0.7404415, 'specificity': 0.7404415, 'f1': 0.64291453, 'auroc': 0.8595711, 'binary_precision': 0.2247191, 'binary_recall': 0.5263158, 'binary_specificity': 0.9545672, 'binary_f1_score': 0.31496066}
confusion matrix:
       0    1
0  15947  759
1    198  220
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91854936, 'precision': 0.7125399, 'recall': 0.66211987, 'specificity': 0.66211987, 'f1': 0.6828704, 'auroc': 0.8319124, 'binary_precision': 0.4789916, 'binary_recall': 0.35759097, 'binary_specificity': 0.96664876, 'binary_f1_score': 0.40948278}
confusion matrix:
      0    1
0  8985  310
1   512  285
early stop counter: 3
val acc:0.944113552570343, best validation acc: 0.9629175662994385, corresponding to test acc:                         0.9199365973472595 / 0.9204320311546326
after epoch: 7,now: 2024-08-11 12:23:59.822356,epoch time: 0:18:40.982723,used: 2:11:46.716202,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_10_12_12_seed_2_24141976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9632854, 'precision': 0.964016, 'recall': 0.9632892, 'specificity': 0.9632892, 'f1': 0.9632711, 'auroc': 0.9925822, 'binary_precision': 0.98247737, 'binary_recall': 0.9434108, 'binary_specificity': 0.9831676, 'binary_f1_score': 0.96254784}
confusion matrix:
       0      1
0  25408    435
1   1463  24390
---- Validation: 
scalar performance:
{'acc': 0.9439967, 'precision': 0.60723394, 'recall': 0.7450466, 'specificity': 0.7450466, 'f1': 0.6446034, 'auroc': 0.8619142, 'binary_precision': 0.2264914, 'binary_recall': 0.53588516, 'binary_specificity': 0.9542081, 'binary_f1_score': 0.31840798}
confusion matrix:
       0    1
0  15941  765
1    194  224
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9196393, 'precision': 0.71681136, 'recall': 0.6604173, 'specificity': 0.6604173, 'f1': 0.6831048, 'auroc': 0.83225596, 'binary_precision': 0.4878472, 'binary_recall': 0.35257214, 'binary_specificity': 0.9682625, 'binary_f1_score': 0.40932265}
confusion matrix:
      0    1
0  9000  295
1   516  281
early stop counter: 4
val acc:0.9439967274665833, best validation acc: 0.9629175662994385, corresponding to test acc:                         0.9199365973472595 / 0.9204320311546326
after epoch: 8,now: 2024-08-11 12:42:50.024799,epoch time: 0:18:50.202443,used: 2:30:36.918645,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_10_12_12_seed_2_24141976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9659161, 'precision': 0.9665484, 'recall': 0.9659169, 'specificity': 0.9659169, 'f1': 0.9659046, 'auroc': 0.99355793, 'binary_precision': 0.983733, 'binary_recall': 0.9475028, 'binary_specificity': 0.9843309, 'binary_f1_score': 0.965278}
confusion matrix:
       0      1
0  25442    405
1   1357  24492
---- Validation: 
scalar performance:
{'acc': 0.9578369, 'precision': 0.6386862, 'recall': 0.7358125, 'specificity': 0.7358125, 'f1': 0.6729836, 'auroc': 0.86479867, 'binary_precision': 0.29005525, 'binary_recall': 0.50239235, 'binary_specificity': 0.9692326, 'binary_f1_score': 0.36777586}
confusion matrix:
       0    1
0  16192  514
1    208  210
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92112565, 'precision': 0.7206394, 'recall': 0.62566346, 'specificity': 0.62566346, 'f1': 0.656469, 'auroc': 0.83383, 'binary_precision': 0.5011442, 'binary_recall': 0.27478042, 'binary_specificity': 0.9765465, 'binary_f1_score': 0.3549433}
confusion matrix:
      0    1
0  9077  218
1   578  219
new oracle model saved
early stop counter: 5
val acc:0.957836925983429, best validation acc: 0.9629175662994385, corresponding to test acc:                         0.9199365973472595 / 0.9211256504058838
after epoch: 9,now: 2024-08-11 13:01:40.063188,epoch time: 0:18:50.038389,used: 2:49:26.957034,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_10_12_12_seed_2_24141976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.96794724, 'precision': 0.968146, 'recall': 0.9679493, 'specificity': 0.9679493, 'f1': 0.9679439, 'auroc': 0.99417794, 'binary_precision': 0.97784185, 'binary_recall': 0.9576065, 'binary_specificity': 0.978292, 'binary_f1_score': 0.96761835}
confusion matrix:
       0      1
0  25282    561
1   1096  24757
---- Validation: 
scalar performance:
{'acc': 0.93395233, 'precision': 0.59556085, 'recall': 0.76089114, 'specificity': 0.76089114, 'f1': 0.6325161, 'auroc': 0.87002224, 'binary_precision': 0.2021721, 'binary_recall': 0.57894737, 'binary_specificity': 0.9428349, 'binary_f1_score': 0.2996904}
confusion matrix:
       0    1
0  15751  955
1    176  242
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9142885, 'precision': 0.70335996, 'recall': 0.6942204, 'specificity': 0.6942204, 'f1': 0.69864845, 'auroc': 0.840081, 'binary_precision': 0.45514512, 'binary_recall': 0.43287328, 'binary_specificity': 0.95556754, 'binary_f1_score': 0.4437299}
confusion matrix:
      0    1
0  8882  413
1   452  345
early stop counter: 6
val acc:0.9339523315429688, best validation acc: 0.9629175662994385, corresponding to test acc:                         0.9199365973472595 / 0.9211256504058838
after epoch: 10,now: 2024-08-11 13:20:33.617583,epoch time: 0:18:53.554395,used: 3:08:20.511429,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_10_12_12_seed_2_24141976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.97096485, 'precision': 0.97126484, 'recall': 0.9709678, 'specificity': 0.9709678, 'f1': 0.9709604, 'auroc': 0.9945921, 'binary_precision': 0.9832136, 'binary_recall': 0.95830435, 'binary_specificity': 0.9836313, 'binary_f1_score': 0.9705992}
confusion matrix:
       0      1
0  25419    423
1   1078  24776
---- Validation: 
scalar performance:
{'acc': 0.933602, 'precision': 0.5956112, 'recall': 0.76304406, 'specificity': 0.76304406, 'f1': 0.6327275, 'auroc': 0.8691257, 'binary_precision': 0.2021541, 'binary_recall': 0.58373207, 'binary_specificity': 0.94235605, 'binary_f1_score': 0.3003077}
confusion matrix:
       0    1
0  15743  963
1    174  244
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9142885, 'precision': 0.70504516, 'recall': 0.7033974, 'specificity': 0.7033974, 'f1': 0.7042167, 'auroc': 0.8414265, 'binary_precision': 0.45696202, 'binary_recall': 0.45294857, 'binary_specificity': 0.95384616, 'binary_f1_score': 0.45494646}
confusion matrix:
      0    1
0  8866  429
1   436  361
early stop counter: 7
val acc:0.933601975440979, best validation acc: 0.9629175662994385, corresponding to test acc:                         0.9199365973472595 / 0.9211256504058838
after epoch: 11,now: 2024-08-11 13:39:19.510617,epoch time: 0:18:45.893034,used: 3:27:06.404463,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_10_12_12_seed_2_24141976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9735376, 'precision': 0.97381425, 'recall': 0.973539, 'specificity': 0.973539, 'f1': 0.9735338, 'auroc': 0.9953335, 'binary_precision': 0.9852924, 'binary_recall': 0.9614328, 'binary_specificity': 0.9856452, 'binary_f1_score': 0.9732164}
confusion matrix:
       0      1
0  25474    371
1    997  24854
---- Validation: 
scalar performance:
{'acc': 0.93856573, 'precision': 0.60301477, 'recall': 0.7644218, 'specificity': 0.7644218, 'f1': 0.6419167, 'auroc': 0.87213385, 'binary_precision': 0.21696429, 'binary_recall': 0.5813397, 'binary_specificity': 0.94750386, 'binary_f1_score': 0.3159948}
confusion matrix:
       0    1
0  15829  877
1    175  243
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9168649, 'precision': 0.71228987, 'recall': 0.70078105, 'specificity': 0.70078105, 'f1': 0.706321, 'auroc': 0.84425783, 'binary_precision': 0.472, 'binary_recall': 0.44416562, 'binary_specificity': 0.95739645, 'binary_f1_score': 0.45766}
confusion matrix:
      0    1
0  8899  396
1   443  354
early stop counter: 8
val acc:0.938565731048584, best validation acc: 0.9629175662994385, corresponding to test acc:                         0.9199365973472595 / 0.9211256504058838
after epoch: 12,now: 2024-08-11 13:58:01.032342,epoch time: 0:18:41.521725,used: 3:45:47.926188,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_10_12_12_seed_2_24141976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.97270584, 'precision': 0.9731122, 'recall': 0.9727075, 'specificity': 0.9727075, 'f1': 0.97270006, 'auroc': 0.9956615, 'binary_precision': 0.9870078, 'binary_recall': 0.9580287, 'binary_specificity': 0.98738635, 'binary_f1_score': 0.97230244}
confusion matrix:
       0      1
0  25519    326
1   1085  24766
---- Validation: 
scalar performance:
{'acc': 0.94300395, 'precision': 0.610363, 'recall': 0.76436394, 'specificity': 0.76436394, 'f1': 0.6504123, 'auroc': 0.87361944, 'binary_precision': 0.23173077, 'binary_recall': 0.576555, 'binary_specificity': 0.9521729, 'binary_f1_score': 0.33058986}
confusion matrix:
       0    1
0  15907  799
1    177  241
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9183512, 'precision': 0.7161052, 'recall': 0.6935581, 'specificity': 0.6935581, 'f1': 0.70400816, 'auroc': 0.84608567, 'binary_precision': 0.48090523, 'binary_recall': 0.42659974, 'binary_specificity': 0.9605164, 'binary_f1_score': 0.45212767}
confusion matrix:
      0    1
0  8928  367
1   457  340
early stop counter: 9
val acc:0.9430039525032043, best validation acc: 0.9629175662994385, corresponding to test acc:                         0.9199365973472595 / 0.9211256504058838
after epoch: 13,now: 2024-08-11 14:16:48.023760,epoch time: 0:18:46.991418,used: 4:04:34.917606,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_10_12_12_seed_2_24141976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9728606, 'precision': 0.97332156, 'recall': 0.97286355, 'specificity': 0.97286355, 'f1': 0.9728541, 'auroc': 0.99545234, 'binary_precision': 0.9881409, 'binary_recall': 0.95721966, 'binary_specificity': 0.9885075, 'binary_f1_score': 0.9724345}
confusion matrix:
       0      1
0  25546    297
1   1106  24747
---- Validation: 
scalar performance:
{'acc': 0.9487853, 'precision': 0.62023574, 'recall': 0.75799704, 'specificity': 0.75799704, 'f1': 0.66016597, 'auroc': 0.874372, 'binary_precision': 0.25189188, 'binary_recall': 0.55741626, 'binary_specificity': 0.95857775, 'binary_f1_score': 0.34698436}
confusion matrix:
       0    1
0  16014  692
1    185  233
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91874754, 'precision': 0.7165465, 'recall': 0.68631697, 'specificity': 0.68631697, 'f1': 0.6999319, 'auroc': 0.85033065, 'binary_precision': 0.4830133, 'binary_recall': 0.41028857, 'binary_specificity': 0.96234536, 'binary_f1_score': 0.44369063}
confusion matrix:
      0    1
0  8945  350
1   470  327
early stop counter: 10
val acc:0.9487853050231934, best validation acc: 0.9629175662994385, corresponding to test acc:                         0.9199365973472595 / 0.9211256504058838
after epoch: 14,now: 2024-08-11 14:35:29.160405,epoch time: 0:18:41.136645,used: 4:23:16.054251,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_10_12_12_seed_2_24141976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9720675, 'precision': 0.9727055, 'recall': 0.97207105, 'specificity': 0.97207105, 'f1': 0.9720582, 'auroc': 0.9957335, 'binary_precision': 0.9901209, 'binary_recall': 0.9536611, 'binary_specificity': 0.99048096, 'binary_f1_score': 0.97154903}
confusion matrix:
       0      1
0  25597    246
1   1198  24655
---- Validation: 
scalar performance:
{'acc': 0.9518804, 'precision': 0.6257998, 'recall': 0.75141954, 'specificity': 0.75141954, 'f1': 0.6646206, 'auroc': 0.8734075, 'binary_precision': 0.26340327, 'binary_recall': 0.54066986, 'binary_specificity': 0.9621693, 'binary_f1_score': 0.354232}
confusion matrix:
       0    1
0  16074  632
1    192  226
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9223147, 'precision': 0.73001635, 'recall': 0.6848121, 'specificity': 0.6848121, 'f1': 0.7042074, 'auroc': 0.85147953, 'binary_precision': 0.51033384, 'binary_recall': 0.40276036, 'binary_specificity': 0.96686393, 'binary_f1_score': 0.4502104}
confusion matrix:
      0    1
0  8987  308
1   476  321
new oracle model saved
early stop counter: 11
val acc:0.9518803954124451, best validation acc: 0.9629175662994385, corresponding to test acc:                         0.9199365973472595 / 0.9223147034645081
after epoch: 15,now: 2024-08-11 14:54:08.049155,epoch time: 0:18:38.888750,used: 4:41:54.943001,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_10_12_12_seed_2_24141976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 4:41:54.943001 at 2024-08-11 14:54:08.049155
persisted model performance metric: 

scalar performance:
{'acc': 0.9199366, 'precision': 0.70636165, 'recall': 0.57626534, 'specificity': 0.57626534, 'f1': 0.60339236, 'auroc': 0.83450973, 'binary_precision': 0.48028675, 'binary_recall': 0.16813049, 'binary_specificity': 0.9844002, 'binary_f1_score': 0.24907063}
confusion matrix:
      0    1
0  9150  145
1   663  134
oracle model performance metric: 

scalar performance:
{'acc': 0.9223147, 'precision': 0.73001635, 'recall': 0.6848121, 'specificity': 0.6848121, 'f1': 0.7042074, 'auroc': 0.85147953, 'binary_precision': 0.51033384, 'binary_recall': 0.40276036, 'binary_specificity': 0.96686393, 'binary_f1_score': 0.4502104}
confusion matrix:
      0    1
0  8987  308
1   476  321
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-10_12-05-04/rule_results/7.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-10_12-05-04/confusion_matrix/7.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1146 MiB |   8782 MiB |   1054 TiB |   1054 TiB |
|       from large pool |   1107 MiB |   8738 MiB |   1037 TiB |   1037 TiB |
|       from small pool |     38 MiB |     79 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1146 MiB |   8782 MiB |   1054 TiB |   1054 TiB |
|       from large pool |   1107 MiB |   8738 MiB |   1037 TiB |   1037 TiB |
|       from small pool |     38 MiB |     79 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1142 MiB |   8778 MiB |   1053 TiB |   1053 TiB |
|       from large pool |   1105 MiB |   8734 MiB |   1037 TiB |   1037 TiB |
|       from small pool |     36 MiB |     77 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9418 MiB |   9458 MiB |  25688 MiB |  16270 MiB |
|       from large pool |   9338 MiB |   9372 MiB |  25548 MiB |  16210 MiB |
|       from small pool |     80 MiB |     86 MiB |    140 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 257939 KiB |   1146 MiB | 668523 GiB | 668523 GiB |
|       from large pool | 244088 KiB |   1143 MiB | 651492 GiB | 651492 GiB |
|       from small pool |  13850 KiB |     34 MiB |  17031 GiB |  17031 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4906    |    7451    |  210314 K  |  210309 K  |
|       from large pool |     161    |     844    |  100109 K  |  100109 K  |
|       from small pool |    4745    |    7288    |  110205 K  |  110200 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4906    |    7451    |  210314 K  |  210309 K  |
|       from large pool |     161    |     844    |  100109 K  |  100109 K  |
|       from small pool |    4745    |    7288    |  110205 K  |  110200 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     325    |     333    |     881    |     556    |
|       from large pool |     285    |     290    |     811    |     526    |
|       from small pool |      40    |      43    |      70    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      73    |    3267    |  114483 K  |  114482 K  |
|       from large pool |      22    |     295    |   64041 K  |   64041 K  |
|       from small pool |      51    |    3246    |   50441 K  |   50441 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8782 MiB |   1054 TiB |   1054 TiB |
|       from large pool |  16640 KiB |   8738 MiB |   1037 TiB |   1037 TiB |
|       from small pool |      0 KiB |     79 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8782 MiB |   1054 TiB |   1054 TiB |
|       from large pool |  16640 KiB |   8738 MiB |   1037 TiB |   1037 TiB |
|       from small pool |      0 KiB |     79 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8778 MiB |   1053 TiB |   1053 TiB |
|       from large pool |  16640 KiB |   8734 MiB |   1037 TiB |   1037 TiB |
|       from small pool |      0 KiB |     77 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1398 MiB |   9458 MiB |  25688 MiB |  24290 MiB |
|       from large pool |   1346 MiB |   9372 MiB |  25548 MiB |  24202 MiB |
|       from small pool |     52 MiB |     86 MiB |    140 MiB |     88 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB |   1146 MiB | 668523 GiB | 668523 GiB |
|       from large pool |  30464 KiB |   1143 MiB | 651492 GiB | 651492 GiB |
|       from small pool |      0 KiB |     34 MiB |  17031 GiB |  17031 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7451    |  210314 K  |  210314 K  |
|       from large pool |       2    |     844    |  100109 K  |  100109 K  |
|       from small pool |       0    |    7288    |  110205 K  |  110205 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7451    |  210314 K  |  210314 K  |
|       from large pool |       2    |     844    |  100109 K  |  100109 K  |
|       from small pool |       0    |    7288    |  110205 K  |  110205 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      53    |     333    |     881    |     828    |
|       from large pool |      27    |     290    |     811    |     784    |
|       from small pool |      26    |      43    |      70    |      44    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    3267    |  114485 K  |  114485 K  |
|       from large pool |       2    |     295    |   64041 K  |   64041 K  |
|       from small pool |       0    |    3246    |   50443 K  |   50443 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sun Aug 11 14:56:23 2024]
Finished job 0.
1 of 1 steps (100%) done
