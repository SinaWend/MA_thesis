Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Thu Aug  1 02:58:45 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_dannratio_10seeds_nofreeze_2024-07-31_19-22-31/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_dannratio_10seeds_nofreeze_2024-07-31_19-22-31/rule_results/0.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=0
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_03_14_06_seed_0_23917130

 Experiment start at: 2024-08-01 03:14:07.089763
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.7297859191894531
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9914052, 'precision': 0.99141455, 'recall': 0.9914067, 'specificity': 0.9914067, 'f1': 0.9914051, 'auroc': 0.99935365, 'binary_precision': 0.99373335, 'binary_recall': 0.98905885, 'binary_specificity': 0.99375457, 'binary_f1_score': 0.9913906}
confusion matrix:
       0      1
0  28482    179
1    314  28385
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.9008621, 'precision': 0.6082981, 'recall': 0.84141695, 'specificity': 0.84141695, 'f1': 0.6478138, 'auroc': 0.90814793, 'binary_precision': 0.22522523, 'binary_recall': 0.777605, 'binary_specificity': 0.9052289, 'binary_f1_score': 0.34928393}
confusion matrix:
       0     1
0  16429  1720
1    143   500
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93144774, 'precision': 0.67274296, 'recall': 0.86345375, 'specificity': 0.86345375, 'f1': 0.7265739, 'auroc': 0.93083966, 'binary_precision': 0.35517243, 'binary_recall': 0.789272, 'binary_specificity': 0.9376355, 'binary_f1_score': 0.48989296}
confusion matrix:
      0    1
0  5623  374
1    55  206
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-01 03:53:02.727640,epoch time: 0:38:55.637877,used: 0:38:55.637877,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_03_14_06_seed_0_23917130
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9932357, 'precision': 0.99326324, 'recall': 0.99323887, 'specificity': 0.99323887, 'f1': 0.9932356, 'auroc': 0.999637, 'binary_precision': 0.9971556, 'binary_recall': 0.98930424, 'binary_specificity': 0.9971735, 'binary_f1_score': 0.99321437}
confusion matrix:
       0      1
0  28576     81
1    307  28396
---- Validation: 
scalar performance:
{'acc': 0.9522137, 'precision': 0.6852118, 'recall': 0.80649793, 'specificity': 0.80649793, 'f1': 0.7285367, 'auroc': 0.9287766, 'binary_precision': 0.38313475, 'binary_recall': 0.65007776, 'binary_specificity': 0.96291804, 'binary_f1_score': 0.48212224}
confusion matrix:
       0    1
0  17476  673
1    225  418
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96276766, 'precision': 0.76614976, 'recall': 0.7826816, 'specificity': 0.7826816, 'f1': 0.774132, 'auroc': 0.9295026, 'binary_precision': 0.5503597, 'binary_recall': 0.5862069, 'binary_specificity': 0.97915626, 'binary_f1_score': 0.567718}
confusion matrix:
      0    1
0  5872  125
1   108  153
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-01 04:26:09.981061,epoch time: 0:33:07.253421,used: 1:12:02.891298,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_03_14_06_seed_0_23917130
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9930788, 'precision': 0.9931351, 'recall': 0.9930829, 'specificity': 0.9930829, 'f1': 0.9930786, 'auroc': 0.9997123, 'binary_precision': 0.99859077, 'binary_recall': 0.9875614, 'binary_specificity': 0.9986043, 'binary_f1_score': 0.99304545}
confusion matrix:
       0      1
0  28619     40
1    357  28344
---- Validation: 
scalar performance:
{'acc': 0.95992976, 'precision': 0.70812297, 'recall': 0.76098895, 'specificity': 0.76098895, 'f1': 0.7311708, 'auroc': 0.93685806, 'binary_precision': 0.43243244, 'binary_recall': 0.5474339, 'binary_specificity': 0.97454405, 'binary_f1_score': 0.48318464}
confusion matrix:
       0    1
0  17687  462
1    291  352
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97235537, 'precision': 0.8568895, 'recall': 0.76019907, 'specificity': 0.76019907, 'f1': 0.8001814, 'auroc': 0.9526481, 'binary_precision': 0.7340425, 'binary_recall': 0.52873564, 'binary_specificity': 0.9916625, 'binary_f1_score': 0.61469936}
confusion matrix:
      0    1
0  5947   50
1   123  138
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-01 04:57:25.637051,epoch time: 0:31:15.655990,used: 1:43:18.547288,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_03_14_06_seed_0_23917130
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9871862, 'precision': 0.9874271, 'recall': 0.9871778, 'specificity': 0.9871778, 'f1': 0.9871844, 'auroc': 0.99978405, 'binary_precision': 0.97678065, 'binary_recall': 0.9981186, 'binary_specificity': 0.976237, 'binary_f1_score': 0.9873343}
confusion matrix:
       0      1
0  27977    681
1     54  28648
---- Validation: 
scalar performance:
{'acc': 0.8565347, 'precision': 0.5800046, 'recall': 0.8327191, 'specificity': 0.8327191, 'f1': 0.59917027, 'auroc': 0.9026004, 'binary_precision': 0.16790682, 'binary_recall': 0.80715394, 'binary_specificity': 0.8582842, 'binary_f1_score': 0.27798608}
confusion matrix:
       0     1
0  15577  2572
1    124   519
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8592202, 'precision': 0.6042086, 'recall': 0.8734089, 'specificity': 0.8734089, 'f1': 0.6330583, 'auroc': 0.9250653, 'binary_precision': 0.21402214, 'binary_recall': 0.8888889, 'binary_specificity': 0.857929, 'binary_f1_score': 0.34498143}
confusion matrix:
      0    1
0  5145  852
1    29  232
early stop counter: 1
val acc:0.8565347194671631, best validation acc: 0.9599297642707825, corresponding to test acc:                         0.9723553657531738 / 0.9723553657531738
after epoch: 4,now: 2024-08-01 05:27:44.202567,epoch time: 0:30:18.565516,used: 2:13:37.112804,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_03_14_06_seed_0_23917130
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9972455, 'precision': 0.9972495, 'recall': 0.99724686, 'specificity': 0.99724686, 'f1': 0.9972455, 'auroc': 0.99986315, 'binary_precision': 0.9988815, 'binary_recall': 0.99561036, 'binary_specificity': 0.9988833, 'binary_f1_score': 0.9972433}
confusion matrix:
       0      1
0  28624     32
1    126  28578
---- Validation: 
scalar performance:
{'acc': 0.96620905, 'precision': 0.7457546, 'recall': 0.7994925, 'specificity': 0.7994925, 'f1': 0.7696542, 'auroc': 0.95455, 'binary_precision': 0.5050633, 'binary_recall': 0.62052876, 'binary_specificity': 0.97845614, 'binary_f1_score': 0.5568737}
confusion matrix:
       0    1
0  17758  391
1    244  399
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9747523, 'precision': 0.8623726, 'recall': 0.79809636, 'specificity': 0.79809636, 'f1': 0.8267729, 'auroc': 0.9513303, 'binary_precision': 0.74178404, 'binary_recall': 0.60536397, 'binary_specificity': 0.99082875, 'binary_f1_score': 0.6666667}
confusion matrix:
      0    1
0  5942   55
1   103  158
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-01 05:58:07.887832,epoch time: 0:30:23.685265,used: 2:44:00.798069,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_03_14_06_seed_0_23917130
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9940202, 'precision': 0.99407756, 'recall': 0.9940249, 'specificity': 0.9940249, 'f1': 0.9940201, 'auroc': 0.99973094, 'binary_precision': 0.99961245, 'binary_recall': 0.98843366, 'binary_specificity': 0.99961615, 'binary_f1_score': 0.9939916}
confusion matrix:
       0      1
0  28645     11
1    332  28372
---- Validation: 
scalar performance:
{'acc': 0.96674114, 'precision': 0.74836475, 'recall': 0.7442638, 'specificity': 0.7442638, 'f1': 0.7462953, 'auroc': 0.94695044, 'binary_precision': 0.5142405, 'binary_recall': 0.5054432, 'binary_specificity': 0.98308444, 'binary_f1_score': 0.5098039}
confusion matrix:
       0    1
0  17842  307
1    318  325
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96596354, 'precision': 0.8596641, 'recall': 0.63593006, 'specificity': 0.63593006, 'f1': 0.69292176, 'auroc': 0.9266982, 'binary_precision': 0.75, 'binary_recall': 0.27586207, 'binary_specificity': 0.995998, 'binary_f1_score': 0.40336132}
confusion matrix:
      0   1
0  5973  24
1   189  72
better model found
persisted
after epoch: 6,now: 2024-08-01 06:28:05.503278,epoch time: 0:29:57.615446,used: 3:13:58.413515,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_03_14_06_seed_0_23917130
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9956416, 'precision': 0.9956428, 'recall': 0.995641, 'specificity': 0.995641, 'f1': 0.9956415, 'auroc': 0.99984574, 'binary_precision': 0.99505895, 'binary_recall': 0.9962376, 'binary_specificity': 0.99504447, 'binary_f1_score': 0.9956479}
confusion matrix:
       0      1
0  28513    142
1    108  28597
---- Validation: 
scalar performance:
{'acc': 0.9475841, 'precision': 0.65969276, 'recall': 0.75309736, 'specificity': 0.75309736, 'f1': 0.6939961, 'auroc': 0.91949785, 'binary_precision': 0.33589253, 'binary_recall': 0.5443235, 'binary_specificity': 0.9618712, 'binary_f1_score': 0.41543028}
confusion matrix:
       0    1
0  17457  692
1    293  350
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9603707, 'precision': 0.7531515, 'recall': 0.7044729, 'specificity': 0.7044729, 'f1': 0.72587633, 'auroc': 0.9392527, 'binary_precision': 0.53110045, 'binary_recall': 0.42528737, 'binary_specificity': 0.9836585, 'binary_f1_score': 0.4723404}
confusion matrix:
      0    1
0  5899   98
1   150  111
early stop counter: 1
val acc:0.9475840926170349, best validation acc: 0.966741144657135, corresponding to test acc:                         0.9659635424613953 / 0.9747523069381714
after epoch: 7,now: 2024-08-01 06:57:58.193376,epoch time: 0:29:52.690098,used: 3:43:51.103613,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_03_14_06_seed_0_23917130
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9964261, 'precision': 0.99642813, 'recall': 0.99642706, 'specificity': 0.99642706, 'f1': 0.9964261, 'auroc': 0.9998704, 'binary_precision': 0.99766, 'binary_recall': 0.9951921, 'binary_specificity': 0.997662, 'binary_f1_score': 0.99642456}
confusion matrix:
       0      1
0  28590     67
1    138  28565
---- Validation: 
scalar performance:
{'acc': 0.96290976, 'precision': 0.71439564, 'recall': 0.6830259, 'specificity': 0.6830259, 'f1': 0.69732106, 'auroc': 0.9238226, 'binary_precision': 0.45054945, 'binary_recall': 0.38258165, 'binary_specificity': 0.98347014, 'binary_f1_score': 0.41379312}
confusion matrix:
       0    1
0  17849  300
1    397  246
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93847877, 'precision': 0.52855057, 'recall': 0.51714647, 'specificity': 0.51714647, 'f1': 0.5202368, 'auroc': 0.8987736, 'binary_precision': 0.097402595, 'binary_recall': 0.057471264, 'binary_specificity': 0.9768217, 'binary_f1_score': 0.072289154}
confusion matrix:
      0    1
0  5858  139
1   246   15
early stop counter: 2
val acc:0.9629097580909729, best validation acc: 0.966741144657135, corresponding to test acc:                         0.9659635424613953 / 0.9747523069381714
after epoch: 8,now: 2024-08-01 07:28:40.044576,epoch time: 0:30:41.851200,used: 4:14:32.954813,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_03_14_06_seed_0_23917130
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.99614716, 'precision': 0.99616283, 'recall': 0.99614954, 'specificity': 0.99614954, 'f1': 0.99614716, 'auroc': 0.9998766, 'binary_precision': 0.9991588, 'binary_recall': 0.9931366, 'binary_specificity': 0.9991625, 'binary_f1_score': 0.9961386}
confusion matrix:
       0      1
0  28633     24
1    197  28506
---- Validation: 
scalar performance:
{'acc': 0.96397406, 'precision': 0.6880092, 'recall': 0.5545674, 'specificity': 0.5545674, 'f1': 0.5804883, 'auroc': 0.92256874, 'binary_precision': 0.4065934, 'binary_recall': 0.115085535, 'binary_specificity': 0.99404925, 'binary_f1_score': 0.17939395}
confusion matrix:
       0    1
0  18041  108
1    569   74
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95669544, 'precision': 0.4791133, 'recall': 0.49916625, 'specificity': 0.49916625, 'f1': 0.48893425, 'auroc': 0.9440022, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5987  10
1   261   0
early stop counter: 3
val acc:0.9639740586280823, best validation acc: 0.966741144657135, corresponding to test acc:                         0.9659635424613953 / 0.9747523069381714
after epoch: 9,now: 2024-08-01 07:59:44.463880,epoch time: 0:31:04.419304,used: 4:45:37.374117,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_03_14_06_seed_0_23917130
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 9 with time: 4:45:37.374117 at 2024-08-01 07:59:44.463880
persisted model performance metric: 

scalar performance:
{'acc': 0.96596354, 'precision': 0.8596641, 'recall': 0.63593006, 'specificity': 0.63593006, 'f1': 0.69292176, 'auroc': 0.9266982, 'binary_precision': 0.75, 'binary_recall': 0.27586207, 'binary_specificity': 0.995998, 'binary_f1_score': 0.40336132}
confusion matrix:
      0   1
0  5973  24
1   189  72
oracle model performance metric: 

scalar performance:
{'acc': 0.9747523, 'precision': 0.8623726, 'recall': 0.79809636, 'specificity': 0.79809636, 'f1': 0.8267729, 'auroc': 0.9513303, 'binary_precision': 0.74178404, 'binary_recall': 0.60536397, 'binary_specificity': 0.99082875, 'binary_f1_score': 0.6666667}
confusion matrix:
      0    1
0  5942   55
1   103  158
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_dannratio_10seeds_nofreeze_2024-07-31_19-22-31/rule_results/0.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_dannratio_10seeds_nofreeze_2024-07-31_19-22-31/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_dannratio_10seeds_nofreeze_2024-07-31_19-22-31/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 454140 KiB |   2002 MiB | 355590 GiB | 355589 GiB |
|       from large pool | 412453 KiB |   1969 MiB | 351110 GiB | 351110 GiB |
|       from small pool |  41687 KiB |     61 MiB |   4479 GiB |   4479 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 454140 KiB |   2002 MiB | 355590 GiB | 355589 GiB |
|       from large pool | 412453 KiB |   1969 MiB | 351110 GiB | 351110 GiB |
|       from small pool |  41687 KiB |     61 MiB |   4479 GiB |   4479 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447754 KiB |   1998 MiB | 355433 GiB | 355433 GiB |
|       from large pool | 407075 KiB |   1966 MiB | 350963 GiB | 350962 GiB |
|       from small pool |  40679 KiB |     60 MiB |   4470 GiB |   4470 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2282 MiB |   2282 MiB |   2282 MiB |      0 B   |
|       from large pool |   2212 MiB |   2212 MiB |   2212 MiB |      0 B   |
|       from small pool |     70 MiB |     70 MiB |     70 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 371203 KiB | 417585 KiB | 270907 GiB | 270907 GiB |
|       from large pool | 363739 KiB | 410867 KiB | 266195 GiB | 266194 GiB |
|       from small pool |   7464 KiB |  12776 KiB |   4712 GiB |   4712 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3488    |    8155    |   66981 K  |   66978 K  |
|       from large pool |     187    |     311    |   32597 K  |   32597 K  |
|       from small pool |    3301    |    7967    |   34384 K  |   34381 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3488    |    8155    |   66981 K  |   66978 K  |
|       from large pool |     187    |     311    |   32597 K  |   32597 K  |
|       from small pool |    3301    |    7967    |   34384 K  |   34381 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     127    |     127    |     127    |       0    |
|       from large pool |      92    |      92    |      92    |       0    |
|       from small pool |      35    |      35    |      35    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      70    |    3638    |   32964 K  |   32964 K  |
|       from large pool |      39    |      91    |   19732 K  |   19732 K  |
|       from small pool |      31    |    3599    |   13231 K  |   13231 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2002 MiB | 355590 GiB | 355590 GiB |
|       from large pool |  16640 KiB |   1969 MiB | 351110 GiB | 351110 GiB |
|       from small pool |      0 KiB |     61 MiB |   4479 GiB |   4479 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2002 MiB | 355590 GiB | 355590 GiB |
|       from large pool |  16640 KiB |   1969 MiB | 351110 GiB | 351110 GiB |
|       from small pool |      0 KiB |     61 MiB |   4479 GiB |   4479 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB | 355433 GiB | 355433 GiB |
|       from large pool |  16640 KiB |   1966 MiB | 350963 GiB | 350963 GiB |
|       from small pool |      0 KiB |     60 MiB |   4470 GiB |   4470 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    806 MiB |   2282 MiB |   2282 MiB |   1476 MiB |
|       from large pool |    758 MiB |   2212 MiB |   2212 MiB |   1454 MiB |
|       from small pool |     48 MiB |     70 MiB |     70 MiB |     22 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 450656 KiB | 270908 GiB | 270908 GiB |
|       from large pool |  24320 KiB | 429400 KiB | 266195 GiB | 266195 GiB |
|       from small pool |      0 KiB |  23037 KiB |   4712 GiB |   4712 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8155    |   66981 K  |   66981 K  |
|       from large pool |       2    |     311    |   32597 K  |   32597 K  |
|       from small pool |       0    |    7967    |   34384 K  |   34384 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8155    |   66981 K  |   66981 K  |
|       from large pool |       2    |     311    |   32597 K  |   32597 K  |
|       from small pool |       0    |    7967    |   34384 K  |   34384 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      58    |     127    |     127    |      69    |
|       from large pool |      34    |      92    |      92    |      58    |
|       from small pool |      24    |      35    |      35    |      11    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3638    |   32965 K  |   32965 K  |
|       from large pool |       4    |      91    |   19732 K  |   19732 K  |
|       from small pool |       0    |    3599    |   13232 K  |   13232 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2002 MiB | 355590 GiB | 355590 GiB |
|       from large pool |  16640 KiB |   1969 MiB | 351110 GiB | 351110 GiB |
|       from small pool |      0 KiB |     61 MiB |   4479 GiB |   4479 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2002 MiB | 355590 GiB | 355590 GiB |
|       from large pool |  16640 KiB |   1969 MiB | 351110 GiB | 351110 GiB |
|       from small pool |      0 KiB |     61 MiB |   4479 GiB |   4479 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB | 355433 GiB | 355433 GiB |
|       from large pool |  16640 KiB |   1966 MiB | 350963 GiB | 350963 GiB |
|       from small pool |      0 KiB |     60 MiB |   4470 GiB |   4470 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    806 MiB |   2282 MiB |   2282 MiB |   1476 MiB |
|       from large pool |    758 MiB |   2212 MiB |   2212 MiB |   1454 MiB |
|       from small pool |     48 MiB |     70 MiB |     70 MiB |     22 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 450656 KiB | 270908 GiB | 270908 GiB |
|       from large pool |  24320 KiB | 429400 KiB | 266195 GiB | 266195 GiB |
|       from small pool |      0 KiB |  23037 KiB |   4712 GiB |   4712 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8155    |   66981 K  |   66981 K  |
|       from large pool |       2    |     311    |   32597 K  |   32597 K  |
|       from small pool |       0    |    7967    |   34384 K  |   34384 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8155    |   66981 K  |   66981 K  |
|       from large pool |       2    |     311    |   32597 K  |   32597 K  |
|       from small pool |       0    |    7967    |   34384 K  |   34384 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      58    |     127    |     127    |      69    |
|       from large pool |      34    |      92    |      92    |      58    |
|       from small pool |      24    |      35    |      35    |      11    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3638    |   32965 K  |   32965 K  |
|       from large pool |       4    |      91    |   19732 K  |   19732 K  |
|       from small pool |       0    |    3599    |   13232 K  |   13232 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_08_10_34_seed_1_23917130

 Experiment start at: 2024-08-01 08:10:34.771627
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.6474379897117615
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9854728, 'precision': 0.98566365, 'recall': 0.98546565, 'specificity': 0.98546565, 'f1': 0.9854712, 'auroc': 0.9993336, 'binary_precision': 0.9762164, 'binary_recall': 0.99521315, 'binary_specificity': 0.9757182, 'binary_f1_score': 0.9856232}
confusion matrix:
       0      1
0  28088    699
1    138  28691
---- Validation: 
scalar performance:
{'acc': 0.85522944, 'precision': 0.58077466, 'recall': 0.82191986, 'specificity': 0.82191986, 'f1': 0.6000396, 'auroc': 0.8845507, 'binary_precision': 0.17075533, 'binary_recall': 0.7860327, 'binary_specificity': 0.85780704, 'binary_f1_score': 0.2805622}
confusion matrix:
       0     1
0  15498  2569
1    144   529
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89107317, 'precision': 0.62438977, 'recall': 0.8677566, 'specificity': 0.8677566, 'f1': 0.6666721, 'auroc': 0.92873555, 'binary_precision': 0.25644028, 'binary_recall': 0.8423077, 'binary_specificity': 0.8932055, 'binary_f1_score': 0.39317772}
confusion matrix:
      0    1
0  5311  635
1    41  219
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-01 08:40:36.025778,epoch time: 0:30:01.254151,used: 0:30:01.254151,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_08_10_34_seed_1_23917130
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.98755556, 'precision': 0.98764837, 'recall': 0.9875504, 'specificity': 0.9875504, 'f1': 0.9875548, 'auroc': 0.9992017, 'binary_precision': 0.9811069, 'binary_recall': 0.9942768, 'binary_specificity': 0.980824, 'binary_f1_score': 0.9876479}
confusion matrix:
       0      1
0  28234    552
1    165  28665
---- Validation: 
scalar performance:
{'acc': 0.84450376, 'precision': 0.58159083, 'recall': 0.8492595, 'specificity': 0.8492595, 'f1': 0.59788436, 'auroc': 0.9074589, 'binary_precision': 0.1695665, 'binary_recall': 0.85438335, 'binary_specificity': 0.8441357, 'binary_f1_score': 0.28297246}
confusion matrix:
       0     1
0  15251  2816
1     98   575
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92346114, 'precision': 0.66399586, 'recall': 0.8846587, 'specificity': 0.8846587, 'f1': 0.71921456, 'auroc': 0.940202, 'binary_precision': 0.3353752, 'binary_recall': 0.8423077, 'binary_specificity': 0.92700976, 'binary_f1_score': 0.4797371}
confusion matrix:
      0    1
0  5512  434
1    41  219
new oracle model saved
early stop counter: 1
val acc:0.8445037603378296, best validation acc: 0.8552294373512268, corresponding to test acc:                         0.8910731673240662 / 0.9234611392021179
after epoch: 2,now: 2024-08-01 09:09:10.561944,epoch time: 0:28:34.536166,used: 0:58:35.790317,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_08_10_34_seed_1_23917130
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9929186, 'precision': 0.99293095, 'recall': 0.99291694, 'specificity': 0.99291694, 'f1': 0.99291855, 'auroc': 0.9997051, 'binary_precision': 0.99064326, 'binary_recall': 0.99524784, 'binary_specificity': 0.99058604, 'binary_f1_score': 0.9929402}
confusion matrix:
       0      1
0  28516    271
1    137  28692
---- Validation: 
scalar performance:
{'acc': 0.9344717, 'precision': 0.66044986, 'recall': 0.86659324, 'specificity': 0.86659324, 'f1': 0.7151273, 'auroc': 0.94090784, 'binary_precision': 0.32902032, 'binary_recall': 0.7934621, 'binary_specificity': 0.9397244, 'binary_f1_score': 0.4651568}
confusion matrix:
       0     1
0  16978  1089
1    139   534
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97147924, 'precision': 0.81208014, 'recall': 0.86558187, 'specificity': 0.86558187, 'f1': 0.83644384, 'auroc': 0.95124596, 'binary_precision': 0.63517916, 'binary_recall': 0.75, 'binary_specificity': 0.9811638, 'binary_f1_score': 0.6878307}
confusion matrix:
      0    1
0  5834  112
1    65  195
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-01 09:39:50.429433,epoch time: 0:30:39.867489,used: 1:29:15.657806,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_08_10_34_seed_1_23917130
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9882671, 'precision': 0.9883877, 'recall': 0.9882613, 'specificity': 0.9882613, 'f1': 0.9882663, 'auroc': 0.9995953, 'binary_precision': 0.98090327, 'binary_recall': 0.9959417, 'binary_specificity': 0.98058087, 'binary_f1_score': 0.98836523}
confusion matrix:
       0      1
0  28227    559
1    117  28713
---- Validation: 
scalar performance:
{'acc': 0.91878337, 'precision': 0.64035034, 'recall': 0.8849217, 'specificity': 0.8849217, 'f1': 0.6924815, 'auroc': 0.9421985, 'binary_precision': 0.28679055, 'binary_recall': 0.8484398, 'binary_specificity': 0.92140365, 'binary_f1_score': 0.4286787}
confusion matrix:
       0     1
0  16647  1420
1    102   571
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97582984, 'precision': 0.85745966, 'recall': 0.83107257, 'specificity': 0.83107257, 'f1': 0.8437038, 'auroc': 0.95717484, 'binary_precision': 0.7291667, 'binary_recall': 0.6730769, 'binary_specificity': 0.98906827, 'binary_f1_score': 0.7}
confusion matrix:
      0    1
0  5881   65
1    85  175
new oracle model saved
early stop counter: 1
val acc:0.9187833666801453, best validation acc: 0.9344717264175415, corresponding to test acc:                         0.9714792370796204 / 0.9758298397064209
after epoch: 4,now: 2024-08-01 10:10:09.408066,epoch time: 0:30:18.978633,used: 1:59:34.636439,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_08_10_34_seed_1_23917130
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9955741, 'precision': 0.99558425, 'recall': 0.9955759, 'specificity': 0.9955759, 'f1': 0.9955741, 'auroc': 0.9997803, 'binary_precision': 0.9980131, 'binary_recall': 0.99313194, 'binary_specificity': 0.99801993, 'binary_f1_score': 0.99556655}
confusion matrix:
       0      1
0  28730     57
1    198  28631
---- Validation: 
scalar performance:
{'acc': 0.9548026, 'precision': 0.68075204, 'recall': 0.69903576, 'specificity': 0.69903576, 'f1': 0.68938583, 'auroc': 0.92583513, 'binary_precision': 0.3830645, 'binary_recall': 0.42347696, 'binary_specificity': 0.9745946, 'binary_f1_score': 0.40225828}
confusion matrix:
       0    1
0  17608  459
1    388  285
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9693845, 'precision': 0.8130833, 'recall': 0.7946072, 'specificity': 0.7946072, 'f1': 0.8035301, 'auroc': 0.9547051, 'binary_precision': 0.64344263, 'binary_recall': 0.60384613, 'binary_specificity': 0.9853683, 'binary_f1_score': 0.62301594}
confusion matrix:
      0    1
0  5859   87
1   103  157
better model found
persisted
after epoch: 5,now: 2024-08-01 10:40:55.883214,epoch time: 0:30:46.475148,used: 2:30:21.111587,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_08_10_34_seed_1_23917130
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9961816, 'precision': 0.9961828, 'recall': 0.9961823, 'specificity': 0.9961823, 'f1': 0.9961816, 'auroc': 0.99986184, 'binary_precision': 0.9971501, 'binary_recall': 0.99521315, 'binary_specificity': 0.9971515, 'binary_f1_score': 0.9961807}
confusion matrix:
       0      1
0  28705     82
1    138  28691
---- Validation: 
scalar performance:
{'acc': 0.95218784, 'precision': 0.65476364, 'recall': 0.65476364, 'specificity': 0.65476364, 'f1': 0.65476364, 'auroc': 0.910764, 'binary_precision': 0.3343239, 'binary_recall': 0.3343239, 'binary_specificity': 0.9752034, 'binary_f1_score': 0.3343239}
confusion matrix:
       0    1
0  17619  448
1    448  225
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95617145, 'precision': 0.6550519, 'recall': 0.5247367, 'specificity': 0.5247367, 'f1': 0.5354381, 'auroc': 0.9335597, 'binary_precision': 0.35, 'binary_recall': 0.053846154, 'binary_specificity': 0.9956273, 'binary_f1_score': 0.093333334}
confusion matrix:
      0   1
0  5920  26
1   246  14
early stop counter: 1
val acc:0.9521878361701965, best validation acc: 0.9548025727272034, corresponding to test acc:                         0.969384491443634 / 0.9758298397064209
after epoch: 6,now: 2024-08-01 11:12:33.557670,epoch time: 0:31:37.674456,used: 3:01:58.786043,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_08_10_34_seed_1_23917130
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.99517494, 'precision': 0.99518895, 'recall': 0.99517703, 'specificity': 0.99517703, 'f1': 0.99517494, 'auroc': 0.9998437, 'binary_precision': 0.9980115, 'binary_recall': 0.9923341, 'binary_specificity': 0.99801993, 'binary_f1_score': 0.9951647}
confusion matrix:
       0      1
0  28730     57
1    221  28608
---- Validation: 
scalar performance:
{'acc': 0.95832443, 'precision': 0.71059793, 'recall': 0.7680974, 'specificity': 0.7680974, 'f1': 0.73539877, 'auroc': 0.93207633, 'binary_precision': 0.43764433, 'binary_recall': 0.56315005, 'binary_specificity': 0.97304475, 'binary_f1_score': 0.49252757}
confusion matrix:
       0    1
0  17580  487
1    294  379
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9653561, 'precision': 0.8242711, 'recall': 0.66193694, 'specificity': 0.66193694, 'f1': 0.7132825, 'auroc': 0.9420464, 'binary_precision': 0.6771653, 'binary_recall': 0.33076924, 'binary_specificity': 0.99310464, 'binary_f1_score': 0.44444445}
confusion matrix:
      0   1
0  5905  41
1   174  86
better model found
persisted
after epoch: 7,now: 2024-08-01 11:44:40.242727,epoch time: 0:32:06.685057,used: 3:34:05.471100,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_08_10_34_seed_1_23917130
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.99724036, 'precision': 0.9972404, 'recall': 0.99724066, 'specificity': 0.99724066, 'f1': 0.9972403, 'auroc': 0.99989253, 'binary_precision': 0.9976393, 'binary_recall': 0.99684334, 'binary_specificity': 0.9976379, 'binary_f1_score': 0.99724114}
confusion matrix:
       0      1
0  28720     68
1     91  28737
---- Validation: 
scalar performance:
{'acc': 0.95384204, 'precision': 0.6958717, 'recall': 0.79223764, 'specificity': 0.79223764, 'f1': 0.73305166, 'auroc': 0.9417622, 'binary_precision': 0.40625, 'binary_recall': 0.61812776, 'binary_specificity': 0.96634746, 'binary_f1_score': 0.4902769}
confusion matrix:
       0    1
0  17459  608
1    257  416
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9685788, 'precision': 0.80532354, 'recall': 0.7997037, 'specificity': 0.7997037, 'f1': 0.8024843, 'auroc': 0.9516752, 'binary_precision': 0.627451, 'binary_recall': 0.61538464, 'binary_specificity': 0.98402286, 'binary_f1_score': 0.6213593}
confusion matrix:
      0    1
0  5851   95
1   100  160
early stop counter: 1
val acc:0.953842043876648, best validation acc: 0.9583244323730469, corresponding to test acc:                         0.9653561115264893 / 0.9758298397064209
after epoch: 8,now: 2024-08-01 12:16:18.040539,epoch time: 0:31:37.797812,used: 4:05:43.268912,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_08_10_34_seed_1_23917130
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.99425507, 'precision': 0.99425966, 'recall': 0.9942563, 'specificity': 0.9942563, 'f1': 0.99425507, 'auroc': 0.99971986, 'binary_precision': 0.9959624, 'binary_recall': 0.9925422, 'binary_specificity': 0.9959704, 'binary_f1_score': 0.9942493}
confusion matrix:
       0      1
0  28671    116
1    215  28614
---- Validation: 
scalar performance:
{'acc': 0.95325506, 'precision': 0.64453673, 'recall': 0.6195538, 'specificity': 0.6195538, 'f1': 0.6306592, 'auroc': 0.9317975, 'binary_precision': 0.3164557, 'binary_recall': 0.2600297, 'binary_specificity': 0.9790779, 'binary_f1_score': 0.2854812}
confusion matrix:
       0    1
0  17689  378
1    498  175
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95391554, 'precision': 0.5943657, 'recall': 0.5180425, 'specificity': 0.5180425, 'f1': 0.5239, 'auroc': 0.94150007, 'binary_precision': 0.22916667, 'binary_recall': 0.042307694, 'binary_specificity': 0.99377733, 'binary_f1_score': 0.071428575}
confusion matrix:
      0   1
0  5909  37
1   249  11
early stop counter: 2
val acc:0.9532550573348999, best validation acc: 0.9583244323730469, corresponding to test acc:                         0.9653561115264893 / 0.9758298397064209
after epoch: 9,now: 2024-08-01 12:46:51.857066,epoch time: 0:30:33.816527,used: 4:36:17.085439,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_08_10_34_seed_1_23917130
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9930054, 'precision': 0.99309325, 'recall': 0.9930104, 'specificity': 0.9930104, 'f1': 0.99300516, 'auroc': 0.9998946, 'binary_precision': 0.99985933, 'binary_recall': 0.98615974, 'binary_specificity': 0.99986106, 'binary_f1_score': 0.9929623}
confusion matrix:
       0      1
0  28783      4
1    399  28430
---- Validation: 
scalar performance:
{'acc': 0.9582711, 'precision': 0.5589709, 'recall': 0.51414984, 'specificity': 0.51414984, 'f1': 0.5182472, 'auroc': 0.9224756, 'binary_precision': 0.15286624, 'binary_recall': 0.035661217, 'binary_specificity': 0.9926385, 'binary_f1_score': 0.05783132}
confusion matrix:
       0    1
0  17934  133
1    649   24
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9465034, 'precision': 0.47880664, 'recall': 0.4939455, 'specificity': 0.4939455, 'f1': 0.48625827, 'auroc': 0.8746294, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.987891, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5874  72
1   260   0
early stop counter: 3
val acc:0.9582710862159729, best validation acc: 0.9583244323730469, corresponding to test acc:                         0.9653561115264893 / 0.9758298397064209
after epoch: 10,now: 2024-08-01 13:18:44.302701,epoch time: 0:31:52.445635,used: 5:08:09.531074,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_08_10_34_seed_1_23917130
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 10 with time: 5:08:09.531074 at 2024-08-01 13:18:44.302701
persisted model performance metric: 

scalar performance:
{'acc': 0.9653561, 'precision': 0.8242711, 'recall': 0.66193694, 'specificity': 0.66193694, 'f1': 0.7132825, 'auroc': 0.9420464, 'binary_precision': 0.6771653, 'binary_recall': 0.33076924, 'binary_specificity': 0.99310464, 'binary_f1_score': 0.44444445}
confusion matrix:
      0   1
0  5905  41
1   174  86
oracle model performance metric: 

scalar performance:
{'acc': 0.97582984, 'precision': 0.85745966, 'recall': 0.83107257, 'specificity': 0.83107257, 'f1': 0.8437038, 'auroc': 0.95717484, 'binary_precision': 0.7291667, 'binary_recall': 0.6730769, 'binary_specificity': 0.98906827, 'binary_f1_score': 0.7}
confusion matrix:
      0    1
0  5881   65
1    85  175
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_dannratio_10seeds_nofreeze_2024-07-31_19-22-31/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_dannratio_10seeds_nofreeze_2024-07-31_19-22-31/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456389 KiB |   2003 MiB | 751818 GiB | 751817 GiB |
|       from large pool | 414714 KiB |   1970 MiB | 742355 GiB | 742354 GiB |
|       from small pool |  41675 KiB |     61 MiB |   9462 GiB |   9462 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 456389 KiB |   2003 MiB | 751818 GiB | 751817 GiB |
|       from large pool | 414714 KiB |   1970 MiB | 742355 GiB | 742354 GiB |
|       from small pool |  41675 KiB |     61 MiB |   9462 GiB |   9462 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447751 KiB |   1998 MiB | 751444 GiB | 751443 GiB |
|       from large pool | 407075 KiB |   1966 MiB | 741999 GiB | 741999 GiB |
|       from small pool |  40676 KiB |     60 MiB |   9444 GiB |   9444 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2270 MiB |   2282 MiB |   3746 MiB |   1476 MiB |
|       from large pool |   2206 MiB |   2212 MiB |   3660 MiB |   1454 MiB |
|       from small pool |     64 MiB |     70 MiB |     86 MiB |     22 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 407866 KiB | 450656 KiB | 578880 GiB | 578879 GiB |
|       from large pool | 400390 KiB | 429400 KiB | 568969 GiB | 568968 GiB |
|       from small pool |   7476 KiB |  23037 KiB |   9910 GiB |   9910 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3464    |    8187    |  141569 K  |  141565 K  |
|       from large pool |     187    |     311    |   68913 K  |   68913 K  |
|       from small pool |    3277    |    7999    |   72655 K  |   72652 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3464    |    8187    |  141569 K  |  141565 K  |
|       from large pool |     187    |     311    |   68913 K  |   68913 K  |
|       from small pool |    3277    |    7999    |   72655 K  |   72652 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     124    |     127    |     193    |      69    |
|       from large pool |      92    |      92    |     150    |      58    |
|       from small pool |      32    |      35    |      43    |      11    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      66    |    3651    |   70130 K  |   70130 K  |
|       from large pool |      35    |      91    |   42079 K  |   42079 K  |
|       from small pool |      31    |    3616    |   28050 K  |   28050 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2003 MiB | 751818 GiB | 751818 GiB |
|       from large pool |  16640 KiB |   1970 MiB | 742355 GiB | 742355 GiB |
|       from small pool |      0 KiB |     61 MiB |   9462 GiB |   9462 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2003 MiB | 751818 GiB | 751818 GiB |
|       from large pool |  16640 KiB |   1970 MiB | 742355 GiB | 742355 GiB |
|       from small pool |      0 KiB |     61 MiB |   9462 GiB |   9462 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB | 751444 GiB | 751444 GiB |
|       from large pool |  16640 KiB |   1966 MiB | 741999 GiB | 741999 GiB |
|       from small pool |      0 KiB |     60 MiB |   9444 GiB |   9444 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    844 MiB |   2282 MiB |   3746 MiB |   2902 MiB |
|       from large pool |    796 MiB |   2212 MiB |   3660 MiB |   2864 MiB |
|       from small pool |     48 MiB |     70 MiB |     86 MiB |     38 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 490201 KiB | 578880 GiB | 578880 GiB |
|       from large pool |  24320 KiB | 476433 KiB | 568969 GiB | 568969 GiB |
|       from small pool |      0 KiB |  23037 KiB |   9911 GiB |   9911 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8187    |  141569 K  |  141569 K  |
|       from large pool |       2    |     311    |   68913 K  |   68913 K  |
|       from small pool |       0    |    7999    |   72655 K  |   72655 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8187    |  141569 K  |  141569 K  |
|       from large pool |       2    |     311    |   68913 K  |   68913 K  |
|       from small pool |       0    |    7999    |   72655 K  |   72655 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      59    |     127    |     193    |     134    |
|       from large pool |      35    |      92    |     150    |     115    |
|       from small pool |      24    |      35    |      43    |      19    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3651    |   70131 K  |   70131 K  |
|       from large pool |       4    |      91    |   42079 K  |   42079 K  |
|       from small pool |       0    |    3616    |   28051 K  |   28051 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2003 MiB | 751818 GiB | 751818 GiB |
|       from large pool |  16640 KiB |   1970 MiB | 742355 GiB | 742355 GiB |
|       from small pool |      0 KiB |     61 MiB |   9462 GiB |   9462 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2003 MiB | 751818 GiB | 751818 GiB |
|       from large pool |  16640 KiB |   1970 MiB | 742355 GiB | 742355 GiB |
|       from small pool |      0 KiB |     61 MiB |   9462 GiB |   9462 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB | 751444 GiB | 751444 GiB |
|       from large pool |  16640 KiB |   1966 MiB | 741999 GiB | 741999 GiB |
|       from small pool |      0 KiB |     60 MiB |   9444 GiB |   9444 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    844 MiB |   2282 MiB |   3746 MiB |   2902 MiB |
|       from large pool |    796 MiB |   2212 MiB |   3660 MiB |   2864 MiB |
|       from small pool |     48 MiB |     70 MiB |     86 MiB |     38 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 490201 KiB | 578880 GiB | 578880 GiB |
|       from large pool |  24320 KiB | 476433 KiB | 568969 GiB | 568969 GiB |
|       from small pool |      0 KiB |  23037 KiB |   9911 GiB |   9911 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8187    |  141569 K  |  141569 K  |
|       from large pool |       2    |     311    |   68913 K  |   68913 K  |
|       from small pool |       0    |    7999    |   72655 K  |   72655 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8187    |  141569 K  |  141569 K  |
|       from large pool |       2    |     311    |   68913 K  |   68913 K  |
|       from small pool |       0    |    7999    |   72655 K  |   72655 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      59    |     127    |     193    |     134    |
|       from large pool |      35    |      92    |     150    |     115    |
|       from small pool |      24    |      35    |      43    |      19    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3651    |   70131 K  |   70131 K  |
|       from large pool |       4    |      91    |   42079 K  |   42079 K  |
|       from small pool |       0    |    3616    |   28051 K  |   28051 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_13_32_26_seed_2_23917130

 Experiment start at: 2024-08-01 13:32:26.835939
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.754768431186676
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9841692, 'precision': 0.98461735, 'recall': 0.9841718, 'specificity': 0.9841718, 'f1': 0.98416555, 'auroc': 0.99924856, 'binary_precision': 0.9993986, 'binary_recall': 0.96892685, 'binary_specificity': 0.99941677, 'binary_f1_score': 0.9839269}
confusion matrix:
       0      1
0  29130     17
1    906  28251
---- Validation: 
scalar performance:
{'acc': 0.95301765, 'precision': 0.65700865, 'recall': 0.7147398, 'specificity': 0.7147398, 'f1': 0.68068427, 'auroc': 0.8949535, 'binary_precision': 0.3321343, 'binary_recall': 0.4601329, 'binary_specificity': 0.96934676, 'binary_f1_score': 0.3857939}
confusion matrix:
       0    1
0  17614  557
1    325  277
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.73730004, 'recall': 0.67448115, 'specificity': 0.67448115, 'f1': 0.7004931, 'auroc': 0.91354835, 'binary_precision': 0.5, 'binary_recall': 0.36363637, 'binary_specificity': 0.985326, 'binary_f1_score': 0.42105263}
confusion matrix:
      0   1
0  5909  88
1   154  88
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-01 14:05:42.226776,epoch time: 0:33:15.390837,used: 0:33:15.390837,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_13_32_26_seed_2_23917130
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.99315655, 'precision': 0.9931568, 'recall': 0.9931567, 'specificity': 0.9931567, 'f1': 0.99315655, 'auroc': 0.99966526, 'binary_precision': 0.9935471, 'binary_recall': 0.99276334, 'binary_specificity': 0.99354994, 'binary_f1_score': 0.993155}
confusion matrix:
       0      1
0  28959    188
1    211  28946
---- Validation: 
scalar performance:
{'acc': 0.8654983, 'precision': 0.5815907, 'recall': 0.84459496, 'specificity': 0.84459496, 'f1': 0.6037265, 'auroc': 0.91481775, 'binary_precision': 0.16992791, 'binary_recall': 0.8222591, 'binary_specificity': 0.86693084, 'binary_f1_score': 0.28165007}
confusion matrix:
       0     1
0  15753  2418
1    107   495
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8523802, 'precision': 0.5893805, 'recall': 0.843902, 'specificity': 0.843902, 'f1': 0.6111635, 'auroc': 0.9139687, 'binary_precision': 0.18651892, 'binary_recall': 0.8347107, 'binary_specificity': 0.8530932, 'binary_f1_score': 0.30490565}
confusion matrix:
      0    1
0  5116  881
1    40  202
early stop counter: 1
val acc:0.8654983043670654, best validation acc: 0.9530176520347595, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 2,now: 2024-08-01 14:37:49.317145,epoch time: 0:32:07.090369,used: 1:05:22.481206,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_13_32_26_seed_2_23917130
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9802758, 'precision': 0.98028743, 'recall': 0.9802752, 'specificity': 0.9802752, 'f1': 0.98027563, 'auroc': 0.9985601, 'binary_precision': 0.9779856, 'binary_recall': 0.98268116, 'binary_specificity': 0.9778693, 'binary_f1_score': 0.9803278}
confusion matrix:
       0      1
0  28500    645
1    505  28654
---- Validation: 
scalar performance:
{'acc': 0.9633516, 'precision': 0.700247, 'recall': 0.68153167, 'specificity': 0.68153167, 'f1': 0.6903749, 'auroc': 0.92033625, 'binary_precision': 0.4209559, 'binary_recall': 0.38039866, 'binary_specificity': 0.9826647, 'binary_f1_score': 0.39965096}
confusion matrix:
       0    1
0  17856  315
1    373  229
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.956243, 'precision': 0.50922906, 'recall': 0.50138086, 'specificity': 0.50138086, 'f1': 0.4960326, 'auroc': 0.9096975, 'binary_precision': 0.057142857, 'binary_recall': 0.008264462, 'binary_specificity': 0.99449724, 'binary_f1_score': 0.014440432}
confusion matrix:
      0   1
0  5964  33
1   240   2
better model found
persisted
after epoch: 3,now: 2024-08-01 15:12:13.252476,epoch time: 0:34:23.935331,used: 1:39:46.416537,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_13_32_26_seed_2_23917130
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9905495, 'precision': 0.9906143, 'recall': 0.99054796, 'specificity': 0.99054796, 'f1': 0.9905492, 'auroc': 0.9995854, 'binary_precision': 0.98504627, 'binary_recall': 0.9962277, 'binary_specificity': 0.9848682, 'binary_f1_score': 0.9906054}
confusion matrix:
       0      1
0  28703    441
1    110  29050
---- Validation: 
scalar performance:
{'acc': 0.91061634, 'precision': 0.6098416, 'recall': 0.8341733, 'specificity': 0.8341733, 'f1': 0.6513121, 'auroc': 0.911322, 'binary_precision': 0.22855702, 'binary_recall': 0.7524917, 'binary_specificity': 0.91585493, 'binary_f1_score': 0.35061923}
confusion matrix:
       0     1
0  16642  1529
1    149   453
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91969866, 'precision': 0.6452327, 'recall': 0.8610748, 'specificity': 0.8610748, 'f1': 0.6959758, 'auroc': 0.9076921, 'binary_precision': 0.2992248, 'binary_recall': 0.79752064, 'binary_specificity': 0.924629, 'binary_f1_score': 0.4351747}
confusion matrix:
      0    1
0  5545  452
1    49  193
early stop counter: 1
val acc:0.9106163382530212, best validation acc: 0.9633516073226929, corresponding to test acc:                         0.9562429785728455 / 0.9612117409706116
after epoch: 4,now: 2024-08-01 15:45:23.681116,epoch time: 0:33:10.428640,used: 2:12:56.845177,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_13_32_26_seed_2_23917130
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.99329376, 'precision': 0.9933388, 'recall': 0.9932946, 'specificity': 0.9932946, 'f1': 0.99329364, 'auroc': 0.9996388, 'binary_precision': 0.99809533, 'binary_recall': 0.98847616, 'binary_specificity': 0.99811304, 'binary_f1_score': 0.9932624}
confusion matrix:
       0      1
0  29092     55
1    336  28821
---- Validation: 
scalar performance:
{'acc': 0.96058166, 'precision': 0.6636579, 'recall': 0.62709963, 'specificity': 0.62709963, 'f1': 0.6427655, 'auroc': 0.900034, 'binary_precision': 0.35129312, 'binary_recall': 0.2707641, 'binary_specificity': 0.98343515, 'binary_f1_score': 0.30581614}
confusion matrix:
       0    1
0  17870  301
1    439  163
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9381311, 'precision': 0.54845464, 'recall': 0.53954524, 'specificity': 0.53954524, 'f1': 0.5433308, 'auroc': 0.8830432, 'binary_precision': 0.13265306, 'binary_recall': 0.10743801, 'binary_specificity': 0.9716525, 'binary_f1_score': 0.118721455}
confusion matrix:
      0    1
0  5827  170
1   216   26
early stop counter: 2
val acc:0.9605816602706909, best validation acc: 0.9633516073226929, corresponding to test acc:                         0.9562429785728455 / 0.9612117409706116
after epoch: 5,now: 2024-08-01 16:16:59.756937,epoch time: 0:31:36.075821,used: 2:44:32.920998,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_13_32_26_seed_2_23917130
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97996706, 'precision': 0.9806525, 'recall': 0.9799632, 'specificity': 0.9799632, 'f1': 0.9799598, 'auroc': 0.999799, 'binary_precision': 0.9625529, 'binary_recall': 0.9987996, 'binary_specificity': 0.96112674, 'binary_f1_score': 0.9803413}
confusion matrix:
       0      1
0  28013   1133
1     35  29123
---- Validation: 
scalar performance:
{'acc': 0.8957013, 'precision': 0.6049677, 'recall': 0.8746516, 'specificity': 0.8746516, 'f1': 0.643591, 'auroc': 0.9259381, 'binary_precision': 0.21536525, 'binary_recall': 0.85215944, 'binary_specificity': 0.8971438, 'binary_f1_score': 0.3438338}
confusion matrix:
       0     1
0  16302  1869
1     89   513
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9283539, 'precision': 0.6600775, 'recall': 0.8715253, 'specificity': 0.8715253, 'f1': 0.71440876, 'auroc': 0.92927986, 'binary_precision': 0.3283082, 'binary_recall': 0.80991733, 'binary_specificity': 0.93313324, 'binary_f1_score': 0.46722284}
confusion matrix:
      0    1
0  5596  401
1    46  196
early stop counter: 3
val acc:0.8957012891769409, best validation acc: 0.9633516073226929, corresponding to test acc:                         0.9562429785728455 / 0.9612117409706116
after epoch: 6,now: 2024-08-01 16:49:48.440660,epoch time: 0:32:48.683723,used: 3:17:21.604721,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_13_32_26_seed_2_23917130
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 6 with time: 3:17:21.604721 at 2024-08-01 16:49:48.440660
persisted model performance metric: 

scalar performance:
{'acc': 0.956243, 'precision': 0.50922906, 'recall': 0.50138086, 'specificity': 0.50138086, 'f1': 0.4960326, 'auroc': 0.9096975, 'binary_precision': 0.057142857, 'binary_recall': 0.008264462, 'binary_specificity': 0.99449724, 'binary_f1_score': 0.014440432}
confusion matrix:
      0   1
0  5964  33
1   240   2
oracle model performance metric: 

scalar performance:
{'acc': 0.96121174, 'precision': 0.73730004, 'recall': 0.67448115, 'specificity': 0.67448115, 'f1': 0.7004931, 'auroc': 0.91354835, 'binary_precision': 0.5, 'binary_recall': 0.36363637, 'binary_specificity': 0.985326, 'binary_f1_score': 0.42105263}
confusion matrix:
      0   1
0  5909  88
1   154  88
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_dannratio_10seeds_nofreeze_2024-07-31_19-22-31/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_dannratio_10seeds_nofreeze_2024-07-31_19-22-31/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455071 KiB |   2003 MiB |    970 TiB |    970 TiB |
|       from large pool | 413389 KiB |   1971 MiB |    958 TiB |    958 TiB |
|       from small pool |  41681 KiB |     61 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 455071 KiB |   2003 MiB |    970 TiB |    970 TiB |
|       from large pool | 413389 KiB |   1971 MiB |    958 TiB |    958 TiB |
|       from small pool |  41681 KiB |     61 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447753 KiB |   1998 MiB |    969 TiB |    969 TiB |
|       from large pool | 407075 KiB |   1966 MiB |    957 TiB |    957 TiB |
|       from small pool |  40678 KiB |     60 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2276 MiB |   2282 MiB |   5178 MiB |   2902 MiB |
|       from large pool |   2212 MiB |   2212 MiB |   5076 MiB |   2864 MiB |
|       from small pool |     64 MiB |     70 MiB |    102 MiB |     38 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 376417 KiB | 490201 KiB | 763597 GiB | 763597 GiB |
|       from large pool | 368946 KiB | 476433 KiB | 750509 GiB | 750508 GiB |
|       from small pool |   7470 KiB |  23037 KiB |  13088 GiB |  13088 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3476    |    8273    |  187049 K  |  187046 K  |
|       from large pool |     187    |     311    |   91050 K  |   91050 K  |
|       from small pool |    3289    |    8085    |   95999 K  |   95995 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3476    |    8273    |  187049 K  |  187046 K  |
|       from large pool |     187    |     311    |   91050 K  |   91050 K  |
|       from small pool |    3289    |    8085    |   95999 K  |   95995 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     124    |     127    |     258    |     134    |
|       from large pool |      92    |      92    |     207    |     115    |
|       from small pool |      32    |      35    |      51    |      19    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      69    |    3697    |   94382 K  |   94382 K  |
|       from large pool |      39    |      92    |   57314 K  |   57314 K  |
|       from small pool |      30    |    3658    |   37067 K  |   37067 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2003 MiB |    970 TiB |    970 TiB |
|       from large pool |  16640 KiB |   1971 MiB |    958 TiB |    958 TiB |
|       from small pool |      0 KiB |     61 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2003 MiB |    970 TiB |    970 TiB |
|       from large pool |  16640 KiB |   1971 MiB |    958 TiB |    958 TiB |
|       from small pool |      0 KiB |     61 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB |    969 TiB |    969 TiB |
|       from large pool |  16640 KiB |   1966 MiB |    957 TiB |    957 TiB |
|       from small pool |      0 KiB |     60 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    812 MiB |   2282 MiB |   5178 MiB |   4366 MiB |
|       from large pool |    764 MiB |   2212 MiB |   5076 MiB |   4312 MiB |
|       from small pool |     48 MiB |     70 MiB |    102 MiB |     54 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 490201 KiB | 763598 GiB | 763598 GiB |
|       from large pool |  24320 KiB | 476433 KiB | 750509 GiB | 750509 GiB |
|       from small pool |      0 KiB |  25283 KiB |  13088 GiB |  13088 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8273    |  187049 K  |  187049 K  |
|       from large pool |       2    |     311    |   91050 K  |   91050 K  |
|       from small pool |       0    |    8085    |   95999 K  |   95999 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8273    |  187049 K  |  187049 K  |
|       from large pool |       2    |     311    |   91050 K  |   91050 K  |
|       from small pool |       0    |    8085    |   95999 K  |   95999 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      58    |     127    |     258    |     200    |
|       from large pool |      34    |      92    |     207    |     173    |
|       from small pool |      24    |      35    |      51    |      27    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3697    |   94383 K  |   94383 K  |
|       from large pool |       4    |      92    |   57314 K  |   57314 K  |
|       from small pool |       0    |    3658    |   37068 K  |   37068 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Thu Aug  1 16:51:25 2024]
Finished job 0.
1 of 1 steps (100%) done
