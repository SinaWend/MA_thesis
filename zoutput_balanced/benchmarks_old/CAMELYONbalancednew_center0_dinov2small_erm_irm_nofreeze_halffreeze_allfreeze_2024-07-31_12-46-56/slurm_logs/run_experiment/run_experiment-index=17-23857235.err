Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Wed Jul 31 12:55:53 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_12-46-56/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_12-46-56/rule_results/17.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=17
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_04_15_seed_0_23857235

 Experiment start at: 2024-07-31 13:04:15.970596
before training, model accuracy: 0.7297859191894531
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.70285916, 'precision': 0.70360625, 'recall': 0.7028378, 'specificity': 0.7028378, 'f1': 0.70257205, 'auroc': 0.76646584, 'binary_precision': 0.691446, 'binary_recall': 0.73341465, 'binary_specificity': 0.672261, 'binary_f1_score': 0.7118122}
confusion matrix:
       0      1
0  19267   9393
1   7651  21049
---- Validation: 
scalar performance:
{'acc': 0.772616, 'precision': 0.53643453, 'recall': 0.6985165, 'specificity': 0.6985165, 'f1': 0.5128083, 'auroc': 0.77649176, 'binary_precision': 0.08992318, 'binary_recall': 0.61897355, 'binary_specificity': 0.7780594, 'binary_f1_score': 0.15703294}
confusion matrix:
       0     1
0  14121  4028
1    245   398
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7532758, 'precision': 0.5401127, 'recall': 0.6917002, 'specificity': 0.6917002, 'f1': 0.5146503, 'auroc': 0.75903535, 'binary_precision': 0.10130516, 'binary_recall': 0.6245211, 'binary_specificity': 0.7588794, 'binary_f1_score': 0.17433155}
confusion matrix:
      0     1
0  4551  1446
1    98   163
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-31 13:26:00.877274,epoch time: 0:21:44.906678,used: 0:21:44.906678,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_04_15_seed_0_23857235
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.8101813, 'precision': 0.81040096, 'recall': 0.8101928, 'specificity': 0.8101928, 'f1': 0.8101516, 'auroc': 0.8866317, 'binary_precision': 0.8188782, 'binary_recall': 0.7969692, 'binary_specificity': 0.82341653, 'binary_f1_score': 0.80777514}
confusion matrix:
       0      1
0  23595   5060
1   5828  22877
---- Validation: 
scalar performance:
{'acc': 0.8561622, 'precision': 0.55672574, 'recall': 0.71701777, 'specificity': 0.71701777, 'f1': 0.56674683, 'auroc': 0.80589974, 'binary_precision': 0.13082437, 'binary_recall': 0.5676516, 'binary_specificity': 0.86638385, 'binary_f1_score': 0.21264201}
confusion matrix:
       0     1
0  15724  2425
1    278   365
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8443592, 'precision': 0.5643308, 'recall': 0.71906835, 'specificity': 0.71906835, 'f1': 0.57560074, 'auroc': 0.82008755, 'binary_precision': 0.1494592, 'binary_recall': 0.58237547, 'binary_specificity': 0.85576123, 'binary_f1_score': 0.23787169}
confusion matrix:
      0    1
0  5132  865
1   109  152
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-31 13:48:59.574749,epoch time: 0:22:58.697475,used: 0:44:43.604153,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_04_15_seed_0_23857235
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.84393305, 'precision': 0.8442992, 'recall': 0.8439467, 'specificity': 0.8439467, 'f1': 0.8438951, 'auroc': 0.9204516, 'binary_precision': 0.85573804, 'binary_recall': 0.82765466, 'binary_specificity': 0.8602387, 'binary_f1_score': 0.8414621}
confusion matrix:
       0      1
0  24651   4005
1   4947  23757
---- Validation: 
scalar performance:
{'acc': 0.87984246, 'precision': 0.5697257, 'recall': 0.7307775, 'specificity': 0.7307775, 'f1': 0.5900228, 'auroc': 0.8189256, 'binary_precision': 0.1562367, 'binary_recall': 0.57076204, 'binary_specificity': 0.8907929, 'binary_f1_score': 0.24532084}
confusion matrix:
       0     1
0  16167  1982
1    276   367
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8675296, 'precision': 0.58467215, 'recall': 0.7623074, 'specificity': 0.7623074, 'f1': 0.6082927, 'auroc': 0.85071015, 'binary_precision': 0.18653421, 'binary_recall': 0.6475096, 'binary_specificity': 0.87710524, 'binary_f1_score': 0.28963152}
confusion matrix:
      0    1
0  5260  737
1    92  169
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-31 14:14:22.636851,epoch time: 0:25:23.062102,used: 1:10:06.666255,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_04_15_seed_0_23857235
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.8627266, 'precision': 0.86289024, 'recall': 0.8627348, 'specificity': 0.8627348, 'f1': 0.862713, 'auroc': 0.9362309, 'binary_precision': 0.8707897, 'binary_recall': 0.8521009, 'binary_specificity': 0.8733687, 'binary_f1_score': 0.8613439}
confusion matrix:
       0      1
0  25029   3629
1   4245  24457
---- Validation: 
scalar performance:
{'acc': 0.88580245, 'precision': 0.5747652, 'recall': 0.7383634, 'specificity': 0.7383634, 'f1': 0.59804714, 'auroc': 0.8265381, 'binary_precision': 0.16585149, 'binary_recall': 0.5800933, 'binary_specificity': 0.89663345, 'binary_f1_score': 0.257953}
confusion matrix:
       0     1
0  16273  1876
1    270   373
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87040585, 'precision': 0.5925902, 'recall': 0.7894608, 'specificity': 0.7894608, 'f1': 0.6197185, 'auroc': 0.8680381, 'binary_precision': 0.19978166, 'binary_recall': 0.7011494, 'binary_specificity': 0.8777722, 'binary_f1_score': 0.31096005}
confusion matrix:
      0    1
0  5264  733
1    78  183
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-31 14:37:24.469044,epoch time: 0:23:01.832193,used: 1:33:08.498448,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_04_15_seed_0_23857235
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.87449443, 'precision': 0.8750656, 'recall': 0.87451005, 'specificity': 0.87451005, 'f1': 0.87444985, 'auroc': 0.9436908, 'binary_precision': 0.88990426, 'binary_recall': 0.8549629, 'binary_specificity': 0.8940573, 'binary_f1_score': 0.8720837}
confusion matrix:
       0      1
0  25621   3036
1   4163  24540
---- Validation: 
scalar performance:
{'acc': 0.89330566, 'precision': 0.58128864, 'recall': 0.74599814, 'specificity': 0.74599814, 'f1': 0.60811853, 'auroc': 0.8322685, 'binary_precision': 0.17847025, 'binary_recall': 0.58786935, 'binary_specificity': 0.90412694, 'binary_f1_score': 0.27381384}
confusion matrix:
       0     1
0  16409  1740
1    265   378
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8766379, 'precision': 0.59959406, 'recall': 0.8037064, 'specificity': 0.8037064, 'f1': 0.6303869, 'auroc': 0.88061845, 'binary_precision': 0.21259843, 'binary_recall': 0.7241379, 'binary_specificity': 0.883275, 'binary_f1_score': 0.32869565}
confusion matrix:
      0    1
0  5297  700
1    72  189
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-31 14:58:45.780686,epoch time: 0:21:21.311642,used: 1:54:29.810090,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_04_15_seed_0_23857235
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.88410044, 'precision': 0.88449454, 'recall': 0.8841127, 'specificity': 0.8841127, 'f1': 0.884073, 'auroc': 0.95060897, 'binary_precision': 0.8969974, 'binary_recall': 0.86805797, 'binary_specificity': 0.90016747, 'binary_f1_score': 0.8822904}
confusion matrix:
       0      1
0  25797   2861
1   3787  24915
---- Validation: 
scalar performance:
{'acc': 0.8875053, 'precision': 0.578456, 'recall': 0.7497457, 'specificity': 0.7497457, 'f1': 0.60353816, 'auroc': 0.83382, 'binary_precision': 0.17238307, 'binary_recall': 0.60186625, 'binary_specificity': 0.8976252, 'binary_f1_score': 0.26800552}
confusion matrix:
       0     1
0  16291  1858
1    256   387
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8696069, 'precision': 0.59935635, 'recall': 0.82202595, 'specificity': 0.82202595, 'f1': 0.62891203, 'auroc': 0.88780785, 'binary_precision': 0.21003135, 'binary_recall': 0.77011496, 'binary_specificity': 0.87393695, 'binary_f1_score': 0.33004925}
confusion matrix:
      0    1
0  5241  756
1    60  201
early stop counter: 1
val acc:0.887505292892456, best validation acc: 0.8933056592941284, corresponding to test acc:                         0.876637876033783 / 0.876637876033783
after epoch: 6,now: 2024-07-31 15:17:50.924412,epoch time: 0:19:05.143726,used: 2:13:34.953816,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_04_15_seed_0_23857235
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.8905683, 'precision': 0.8907508, 'recall': 0.8905778, 'specificity': 0.8905778, 'f1': 0.89055717, 'auroc': 0.95523596, 'binary_precision': 0.89941585, 'binary_recall': 0.8797074, 'binary_specificity': 0.90144825, 'binary_f1_score': 0.8894524}
confusion matrix:
       0      1
0  25831   2824
1   3453  25252
---- Validation: 
scalar performance:
{'acc': 0.87776715, 'precision': 0.5747293, 'recall': 0.7574551, 'specificity': 0.7574551, 'f1': 0.5968026, 'auroc': 0.8374971, 'binary_precision': 0.16409424, 'binary_recall': 0.62830484, 'binary_specificity': 0.8866053, 'binary_f1_score': 0.26022545}
confusion matrix:
       0     1
0  16091  2058
1    239   404
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8533078, 'precision': 0.59066975, 'recall': 0.8208511, 'specificity': 0.8208511, 'f1': 0.6133414, 'auroc': 0.8949347, 'binary_precision': 0.19212747, 'binary_recall': 0.7854406, 'binary_specificity': 0.8562615, 'binary_f1_score': 0.30873495}
confusion matrix:
      0    1
0  5135  862
1    56  205
early stop counter: 2
val acc:0.8777671456336975, best validation acc: 0.8933056592941284, corresponding to test acc:                         0.876637876033783 / 0.876637876033783
after epoch: 7,now: 2024-07-31 15:38:48.545424,epoch time: 0:20:57.621012,used: 2:34:32.574828,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_04_15_seed_0_23857235
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.8990411, 'precision': 0.9000366, 'recall': 0.89906037, 'specificity': 0.89906037, 'f1': 0.89898133, 'auroc': 0.960286, 'binary_precision': 0.92018485, 'binary_recall': 0.8740506, 'binary_specificity': 0.92407006, 'binary_f1_score': 0.8965246}
confusion matrix:
       0      1
0  26482   2176
1   3615  25087
---- Validation: 
scalar performance:
{'acc': 0.8935185, 'precision': 0.5816402, 'recall': 0.74685836, 'specificity': 0.74685836, 'f1': 0.60863924, 'auroc': 0.8387166, 'binary_precision': 0.17911153, 'binary_recall': 0.58942455, 'binary_specificity': 0.9042922, 'binary_f1_score': 0.2747372}
confusion matrix:
       0     1
0  16412  1737
1    264   379
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.880473, 'precision': 0.6082564, 'recall': 0.8313601, 'specificity': 0.8313601, 'f1': 0.64299315, 'auroc': 0.89954877, 'binary_precision': 0.22732362, 'binary_recall': 0.7777778, 'binary_specificity': 0.8849425, 'binary_f1_score': 0.35181975}
confusion matrix:
      0    1
0  5307  690
1    58  203
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-07-31 15:59:35.668072,epoch time: 0:20:47.122648,used: 2:55:19.697476,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_04_15_seed_0_23857235
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.90127265, 'precision': 0.90276986, 'recall': 0.90129614, 'specificity': 0.90129614, 'f1': 0.90118456, 'auroc': 0.9616442, 'binary_precision': 0.927519, 'binary_recall': 0.8707407, 'binary_specificity': 0.9318515, 'binary_f1_score': 0.89823353}
confusion matrix:
       0      1
0  26705   1953
1   3710  24992
---- Validation: 
scalar performance:
{'acc': 0.8984142, 'precision': 0.5850184, 'recall': 0.7463927, 'specificity': 0.7463927, 'f1': 0.61370045, 'auroc': 0.84062135, 'binary_precision': 0.18601191, 'binary_recall': 0.58320373, 'binary_specificity': 0.9095818, 'binary_f1_score': 0.28206092}
confusion matrix:
       0     1
0  16508  1641
1    268   375
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88558644, 'precision': 0.6133052, 'recall': 0.8376928, 'specificity': 0.8376928, 'f1': 0.6506293, 'auroc': 0.90346646, 'binary_precision': 0.23699422, 'binary_recall': 0.7854406, 'binary_specificity': 0.889945, 'binary_f1_score': 0.36412078}
confusion matrix:
      0    1
0  5337  660
1    56  205
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-07-31 16:20:49.270920,epoch time: 0:21:13.602848,used: 3:16:33.300324,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_04_15_seed_0_23857235
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.90516037, 'precision': 0.90553933, 'recall': 0.90517324, 'specificity': 0.90517324, 'f1': 0.90514016, 'auroc': 0.9649197, 'binary_precision': 0.91814655, 'binary_recall': 0.8898063, 'binary_specificity': 0.9205402, 'binary_f1_score': 0.90375423}
confusion matrix:
       0      1
0  26379   2277
1   3163  25541
---- Validation: 
scalar performance:
{'acc': 0.88495106, 'precision': 0.5788683, 'recall': 0.75817406, 'specificity': 0.75817406, 'f1': 0.6038209, 'auroc': 0.84199524, 'binary_precision': 0.17248814, 'binary_recall': 0.62208396, 'binary_specificity': 0.89426416, 'binary_f1_score': 0.27008778}
confusion matrix:
       0     1
0  16230  1919
1    243   400
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8673698, 'precision': 0.60055816, 'recall': 0.83368504, 'specificity': 0.83368504, 'f1': 0.6301108, 'auroc': 0.9056508, 'binary_precision': 0.21116751, 'binary_recall': 0.79693484, 'binary_specificity': 0.87043524, 'binary_f1_score': 0.33386838}
confusion matrix:
      0    1
0  5220  777
1    53  208
early stop counter: 1
val acc:0.8849510550498962, best validation acc: 0.8984141945838928, corresponding to test acc:                         0.8855864405632019 / 0.8855864405632019
after epoch: 10,now: 2024-07-31 16:42:21.720338,epoch time: 0:21:32.449418,used: 3:38:05.749742,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_04_15_seed_0_23857235
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.904341, 'precision': 0.9056431, 'recall': 0.9043618, 'specificity': 0.9043618, 'f1': 0.9042673, 'auroc': 0.9655906, 'binary_precision': 0.9288089, 'binary_recall': 0.8759625, 'binary_specificity': 0.9327611, 'binary_f1_score': 0.901612}
confusion matrix:
       0      1
0  26732   1927
1   3560  25141
---- Validation: 
scalar performance:
{'acc': 0.8960728, 'precision': 0.5844677, 'recall': 0.751181, 'specificity': 0.751181, 'f1': 0.6128526, 'auroc': 0.84151083, 'binary_precision': 0.1844894, 'binary_recall': 0.5956454, 'binary_specificity': 0.90671664, 'binary_f1_score': 0.28172123}
confusion matrix:
       0     1
0  16456  1693
1    260   383
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8839885, 'precision': 0.61154604, 'recall': 0.83502674, 'specificity': 0.83502674, 'f1': 0.64800173, 'auroc': 0.9076417, 'binary_precision': 0.23367697, 'binary_recall': 0.7816092, 'binary_specificity': 0.88844424, 'binary_f1_score': 0.35978833}
confusion matrix:
      0    1
0  5328  669
1    57  204
early stop counter: 2
val acc:0.8960728049278259, best validation acc: 0.8984141945838928, corresponding to test acc:                         0.8855864405632019 / 0.8855864405632019
after epoch: 11,now: 2024-07-31 17:03:19.970269,epoch time: 0:20:58.249931,used: 3:59:03.999673,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_04_15_seed_0_23857235
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9123082, 'precision': 0.91286373, 'recall': 0.9123243, 'specificity': 0.9123243, 'f1': 0.9122809, 'auroc': 0.9685917, 'binary_precision': 0.9282278, 'binary_recall': 0.8938861, 'binary_specificity': 0.9307625, 'binary_f1_score': 0.91073334}
confusion matrix:
       0      1
0  26671   1984
1   3046  25659
---- Validation: 
scalar performance:
{'acc': 0.87329715, 'precision': 0.5732895, 'recall': 0.7611413, 'specificity': 0.7611413, 'f1': 0.59392047, 'auroc': 0.8417052, 'binary_precision': 0.16081187, 'binary_recall': 0.6407465, 'binary_specificity': 0.8815362, 'binary_f1_score': 0.2570983}
confusion matrix:
       0     1
0  15999  2150
1    231   412
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85107064, 'precision': 0.59205836, 'recall': 0.8325101, 'specificity': 0.8325101, 'f1': 0.6145859, 'auroc': 0.9097953, 'binary_precision': 0.1936073, 'binary_recall': 0.8122605, 'binary_specificity': 0.8527597, 'binary_f1_score': 0.31268436}
confusion matrix:
      0    1
0  5114  883
1    49  212
early stop counter: 3
val acc:0.8732971549034119, best validation acc: 0.8984141945838928, corresponding to test acc:                         0.8855864405632019 / 0.8855864405632019
after epoch: 12,now: 2024-07-31 17:24:36.070456,epoch time: 0:21:16.100187,used: 4:20:20.099860,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_04_15_seed_0_23857235
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9139121, 'precision': 0.91550976, 'recall': 0.91393816, 'specificity': 0.91393816, 'f1': 0.9138329, 'auroc': 0.97011197, 'binary_precision': 0.94148463, 'binary_recall': 0.8828386, 'binary_specificity': 0.94503766, 'binary_f1_score': 0.911219}
confusion matrix:
       0      1
0  27081   1575
1   3363  25341
---- Validation: 
scalar performance:
{'acc': 0.8975628, 'precision': 0.5857419, 'recall': 0.7519524, 'specificity': 0.7519524, 'f1': 0.6147419, 'auroc': 0.8418118, 'binary_precision': 0.18701172, 'binary_recall': 0.5956454, 'binary_specificity': 0.9082594, 'binary_f1_score': 0.28465256}
confusion matrix:
       0     1
0  16484  1665
1    260   383
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8870246, 'precision': 0.61534697, 'recall': 0.84210783, 'specificity': 0.84210783, 'f1': 0.6536342, 'auroc': 0.91090566, 'binary_precision': 0.24069767, 'binary_recall': 0.79310346, 'binary_specificity': 0.8911122, 'binary_f1_score': 0.36931312}
confusion matrix:
      0    1
0  5344  653
1    54  207
new oracle model saved
early stop counter: 4
val acc:0.8975628018379211, best validation acc: 0.8984141945838928, corresponding to test acc:                         0.8855864405632019 / 0.8870245814323425
after epoch: 13,now: 2024-07-31 17:47:26.920928,epoch time: 0:22:50.850472,used: 4:43:10.950332,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_04_15_seed_0_23857235
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.91835773, 'precision': 0.91895187, 'recall': 0.9183723, 'specificity': 0.9183723, 'f1': 0.91833067, 'auroc': 0.97167873, 'binary_precision': 0.934922, 'binary_recall': 0.8994495, 'binary_specificity': 0.937295, 'binary_f1_score': 0.91684276}
confusion matrix:
       0      1
0  26861   1797
1   2886  25816
---- Validation: 
scalar performance:
{'acc': 0.87281823, 'precision': 0.57381207, 'recall': 0.76464367, 'specificity': 0.76464367, 'f1': 0.5945636, 'auroc': 0.8433145, 'binary_precision': 0.16156529, 'binary_recall': 0.64852256, 'binary_specificity': 0.8807648, 'binary_f1_score': 0.25868487}
confusion matrix:
       0     1
0  15985  2164
1    226   417
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85043144, 'precision': 0.59170234, 'recall': 0.83217657, 'specificity': 0.83217657, 'f1': 0.61393183, 'auroc': 0.91281915, 'binary_precision': 0.19290264, 'binary_recall': 0.8122605, 'binary_specificity': 0.8520927, 'binary_f1_score': 0.3117647}
confusion matrix:
      0    1
0  5110  887
1    49  212
early stop counter: 5
val acc:0.8728182315826416, best validation acc: 0.8984141945838928, corresponding to test acc:                         0.8855864405632019 / 0.8870245814323425
after epoch: 14,now: 2024-07-31 18:09:18.503015,epoch time: 0:21:51.582087,used: 5:05:02.532419,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_04_15_seed_0_23857235
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.919735, 'precision': 0.92031544, 'recall': 0.9197513, 'specificity': 0.9197513, 'f1': 0.9197093, 'auroc': 0.9726701, 'binary_precision': 0.93615407, 'binary_recall': 0.90106255, 'binary_specificity': 0.9384401, 'binary_f1_score': 0.9182732}
confusion matrix:
       0      1
0  26891   1764
1   2840  25865
---- Validation: 
scalar performance:
{'acc': 0.865315, 'precision': 0.57206595, 'recall': 0.77276003, 'specificity': 0.77276003, 'f1': 0.59044844, 'auroc': 0.8463198, 'binary_precision': 0.15722585, 'binary_recall': 0.6734059, 'binary_specificity': 0.8721142, 'binary_f1_score': 0.25493082}
confusion matrix:
       0     1
0  15828  2321
1    210   433
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8443592, 'precision': 0.5899226, 'recall': 0.8363377, 'specificity': 0.8363377, 'f1': 0.60979295, 'auroc': 0.9156308, 'binary_precision': 0.18864629, 'binary_recall': 0.82758623, 'binary_specificity': 0.8450892, 'binary_f1_score': 0.30725464}
confusion matrix:
      0    1
0  5068  929
1    45  216
early stop counter: 6
val acc:0.8653150200843811, best validation acc: 0.8984141945838928, corresponding to test acc:                         0.8855864405632019 / 0.8870245814323425
after epoch: 15,now: 2024-07-31 18:30:45.984927,epoch time: 0:21:27.481912,used: 5:26:30.014331,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_04_15_seed_0_23857235
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.92219317, 'precision': 0.9225956, 'recall': 0.92220616, 'specificity': 0.92220616, 'f1': 0.92217624, 'auroc': 0.9745306, 'binary_precision': 0.9358481, 'binary_recall': 0.90666807, 'binary_specificity': 0.93774426, 'binary_f1_score': 0.921027}
confusion matrix:
       0      1
0  26872   1784
1   2679  26025
---- Validation: 
scalar performance:
{'acc': 0.8572265, 'precision': 0.5692479, 'recall': 0.775323, 'specificity': 0.775323, 'f1': 0.5844775, 'auroc': 0.84658694, 'binary_precision': 0.15116279, 'binary_recall': 0.6874028, 'binary_specificity': 0.86324316, 'binary_f1_score': 0.2478273}
confusion matrix:
       0     1
0  15667  2482
1    201   442
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83700866, 'precision': 0.5873293, 'recall': 0.83799946, 'specificity': 0.83799946, 'f1': 0.6040853, 'auroc': 0.91620904, 'binary_precision': 0.1829574, 'binary_recall': 0.83908045, 'binary_specificity': 0.8369185, 'binary_f1_score': 0.30041152}
confusion matrix:
      0    1
0  5019  978
1    42  219
early stop counter: 7
val acc:0.8572264909744263, best validation acc: 0.8984141945838928, corresponding to test acc:                         0.8855864405632019 / 0.8870245814323425
after epoch: 16,now: 2024-07-31 18:52:07.672510,epoch time: 0:21:21.687583,used: 5:47:51.701914,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_04_15_seed_0_23857235
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.92278594, 'precision': 0.9237567, 'recall': 0.9228027, 'specificity': 0.9228027, 'f1': 0.9227437, 'auroc': 0.9747877, 'binary_precision': 0.94421464, 'binary_recall': 0.89878047, 'binary_specificity': 0.94682485, 'binary_f1_score': 0.92093754}
confusion matrix:
       0      1
0  27136   1524
1   2905  25795
---- Validation: 
scalar performance:
{'acc': 0.86808217, 'precision': 0.5737559, 'recall': 0.77494264, 'specificity': 0.77494264, 'f1': 0.59346485, 'auroc': 0.8477485, 'binary_precision': 0.16050296, 'binary_recall': 0.6749611, 'binary_specificity': 0.87492424, 'binary_f1_score': 0.2593367}
confusion matrix:
       0     1
0  15879  2270
1    209   434
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84707576, 'precision': 0.5920955, 'recall': 0.84141976, 'specificity': 0.84141976, 'f1': 0.6134778, 'auroc': 0.91728044, 'binary_precision': 0.19257951, 'binary_recall': 0.83524907, 'binary_specificity': 0.84759045, 'binary_f1_score': 0.31299353}
confusion matrix:
      0    1
0  5083  914
1    43  218
early stop counter: 8
val acc:0.8680821657180786, best validation acc: 0.8984141945838928, corresponding to test acc:                         0.8855864405632019 / 0.8870245814323425
after epoch: 17,now: 2024-07-31 19:10:08.990699,epoch time: 0:18:01.318189,used: 6:05:53.020103,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_04_15_seed_0_23857235
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.92405856, 'precision': 0.9244161, 'recall': 0.9240703, 'specificity': 0.9240703, 'f1': 0.9240439, 'auroc': 0.97555625, 'binary_precision': 0.9369369, 'binary_recall': 0.90945196, 'binary_specificity': 0.93868864, 'binary_f1_score': 0.9229899}
confusion matrix:
       0      1
0  26900   1757
1   2599  26104
---- Validation: 
scalar performance:
{'acc': 0.84732866, 'precision': 0.5663961, 'recall': 0.77919936, 'specificity': 0.77919936, 'f1': 0.5777692, 'auroc': 0.8490703, 'binary_precision': 0.1448628, 'binary_recall': 0.7060653, 'binary_specificity': 0.8523335, 'binary_f1_score': 0.24040246}
confusion matrix:
       0     1
0  15469  2680
1    189   454
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8286993, 'precision': 0.58419234, 'recall': 0.8373286, 'specificity': 0.8373286, 'f1': 0.5972525, 'auroc': 0.91837174, 'binary_precision': 0.1763767, 'binary_recall': 0.8467433, 'binary_specificity': 0.82791394, 'binary_f1_score': 0.29194188}
confusion matrix:
      0     1
0  4965  1032
1    40   221
early stop counter: 9
val acc:0.8473286628723145, best validation acc: 0.8984141945838928, corresponding to test acc:                         0.8855864405632019 / 0.8870245814323425
after epoch: 18,now: 2024-07-31 19:30:29.572885,epoch time: 0:20:20.582186,used: 6:26:13.602289,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_04_15_seed_0_23857235
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.92648184, 'precision': 0.92695606, 'recall': 0.9264947, 'specificity': 0.9264947, 'f1': 0.9264629, 'auroc': 0.97695005, 'binary_precision': 0.94137794, 'binary_recall': 0.9097276, 'binary_specificity': 0.9432619, 'binary_f1_score': 0.9252822}
confusion matrix:
       0      1
0  27032   1626
1   2591  26111
---- Validation: 
scalar performance:
{'acc': 0.85701364, 'precision': 0.5695921, 'recall': 0.77746296, 'specificity': 0.77746296, 'f1': 0.58489937, 'auroc': 0.84903157, 'binary_precision': 0.15167007, 'binary_recall': 0.69206846, 'binary_specificity': 0.86285746, 'binary_f1_score': 0.24881183}
confusion matrix:
       0     1
0  15660  2489
1    198   445
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.839086, 'precision': 0.588707, 'recall': 0.8409157, 'specificity': 0.8409157, 'f1': 0.60655135, 'auroc': 0.9187384, 'binary_precision': 0.18549748, 'binary_recall': 0.8429119, 'binary_specificity': 0.83891946, 'binary_f1_score': 0.30407742}
confusion matrix:
      0    1
0  5031  966
1    41  220
early stop counter: 10
val acc:0.8570136427879333, best validation acc: 0.8984141945838928, corresponding to test acc:                         0.8855864405632019 / 0.8870245814323425
after epoch: 19,now: 2024-07-31 19:49:13.704997,epoch time: 0:18:44.132112,used: 6:44:57.734401,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_04_15_seed_0_23857235
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.92726636, 'precision': 0.92810524, 'recall': 0.9272858, 'specificity': 0.9272858, 'f1': 0.927233, 'auroc': 0.97737336, 'binary_precision': 0.9472744, 'binary_recall': 0.90503395, 'binary_specificity': 0.9495376, 'binary_f1_score': 0.9256726}
confusion matrix:
       0      1
0  27209   1446
1   2726  25979
---- Validation: 
scalar performance:
{'acc': 0.8621222, 'precision': 0.57173973, 'recall': 0.77785754, 'specificity': 0.77785754, 'f1': 0.5892131, 'auroc': 0.8502661, 'binary_precision': 0.15607345, 'binary_recall': 0.6874028, 'binary_specificity': 0.8683123, 'binary_f1_score': 0.2543885}
confusion matrix:
       0     1
0  15759  2390
1    201   442
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8432407, 'precision': 0.59080637, 'recall': 0.84308344, 'specificity': 0.84308344, 'f1': 0.61061144, 'auroc': 0.91961694, 'binary_precision': 0.18965517, 'binary_recall': 0.8429119, 'binary_specificity': 0.843255, 'binary_f1_score': 0.3096411}
confusion matrix:
      0    1
0  5057  940
1    41  220
early stop counter: 11
val acc:0.8621221780776978, best validation acc: 0.8984141945838928, corresponding to test acc:                         0.8855864405632019 / 0.8870245814323425
after epoch: 20,now: 2024-07-31 20:06:36.066258,epoch time: 0:17:22.361261,used: 7:02:20.095662,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_04_15_seed_0_23857235
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 7:02:20.095662 at 2024-07-31 20:06:36.066258
persisted model performance metric: 

scalar performance:
{'acc': 0.88558644, 'precision': 0.6133052, 'recall': 0.8376928, 'specificity': 0.8376928, 'f1': 0.6506293, 'auroc': 0.90346646, 'binary_precision': 0.23699422, 'binary_recall': 0.7854406, 'binary_specificity': 0.889945, 'binary_f1_score': 0.36412078}
confusion matrix:
      0    1
0  5337  660
1    56  205
oracle model performance metric: 

scalar performance:
{'acc': 0.8870246, 'precision': 0.61534697, 'recall': 0.84210783, 'specificity': 0.84210783, 'f1': 0.6536342, 'auroc': 0.91090566, 'binary_precision': 0.24069767, 'binary_recall': 0.79310346, 'binary_specificity': 0.8911122, 'binary_f1_score': 0.36931312}
confusion matrix:
      0    1
0  5344  653
1    54  207
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_12-46-56/rule_results/17.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_12-46-56/rule_results/17.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_12-46-56/confusion_matrix/17.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 191877 KiB | 461507 KiB | 349766 GiB | 349766 GiB |
|       from large pool | 174400 KiB | 427880 KiB | 342577 GiB | 342577 GiB |
|       from small pool |  17477 KiB |  38507 KiB |   7189 GiB |   7189 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 191877 KiB | 461507 KiB | 349766 GiB | 349766 GiB |
|       from large pool | 174400 KiB | 427880 KiB | 342577 GiB | 342577 GiB |
|       from small pool |  17477 KiB |  38507 KiB |   7189 GiB |   7189 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 189283 KiB | 457564 KiB | 349745 GiB | 349745 GiB |
|       from large pool | 172814 KiB | 424940 KiB | 342572 GiB | 342572 GiB |
|       from small pool |  16469 KiB |  37503 KiB |   7172 GiB |   7172 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 509952 KiB | 509952 KiB | 509952 KiB |      0 B   |
|       from large pool | 466944 KiB | 466944 KiB | 466944 KiB |      0 B   |
|       from small pool |  43008 KiB |  43008 KiB |  43008 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  37498 KiB |  87761 KiB | 184829 GiB | 184829 GiB |
|       from large pool |  30400 KiB |  79704 KiB | 177629 GiB | 177629 GiB |
|       from small pool |   7098 KiB |   9902 KiB |   7200 GiB |   7200 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2966    |    7653    |   81090 K  |   81087 K  |
|       from large pool |      76    |     158    |   33765 K  |   33765 K  |
|       from small pool |    2890    |    7575    |   47324 K  |   47321 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2966    |    7653    |   81090 K  |   81087 K  |
|       from large pool |      76    |     158    |   33765 K  |   33765 K  |
|       from small pool |    2890    |    7575    |   47324 K  |   47321 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      42    |      42    |      42    |       0    |
|       from large pool |      21    |      21    |      21    |       0    |
|       from small pool |      21    |      21    |      21    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      30    |    3602    |   44609 K  |   44609 K  |
|       from large pool |       9    |      18    |   23011 K  |   23011 K  |
|       from small pool |      21    |    3594    |   21598 K  |   21598 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 461507 KiB | 349766 GiB | 349766 GiB |
|       from large pool |  17088 KiB | 427880 KiB | 342577 GiB | 342577 GiB |
|       from small pool |      0 KiB |  38507 KiB |   7189 GiB |   7189 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 461507 KiB | 349766 GiB | 349766 GiB |
|       from large pool |  17088 KiB | 427880 KiB | 342577 GiB | 342577 GiB |
|       from small pool |      0 KiB |  38507 KiB |   7189 GiB |   7189 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457564 KiB | 349745 GiB | 349745 GiB |
|       from large pool |  16640 KiB | 424940 KiB | 342572 GiB | 342572 GiB |
|       from small pool |      0 KiB |  37503 KiB |   7172 GiB |   7172 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 229376 KiB | 509952 KiB | 509952 KiB | 280576 KiB |
|       from large pool | 204800 KiB | 466944 KiB | 466944 KiB | 262144 KiB |
|       from small pool |  24576 KiB |  43008 KiB |  43008 KiB |  18432 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  87761 KiB | 184829 GiB | 184829 GiB |
|       from large pool |  23872 KiB |  79704 KiB | 177629 GiB | 177629 GiB |
|       from small pool |      0 KiB |  18293 KiB |   7200 GiB |   7200 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7653    |   81090 K  |   81090 K  |
|       from large pool |       2    |     158    |   33765 K  |   33765 K  |
|       from small pool |       0    |    7575    |   47324 K  |   47324 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7653    |   81090 K  |   81090 K  |
|       from large pool |       2    |     158    |   33765 K  |   33765 K  |
|       from small pool |       0    |    7575    |   47324 K  |   47324 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |      42    |      42    |      20    |
|       from large pool |      10    |      21    |      21    |      11    |
|       from small pool |      12    |      21    |      21    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3602    |   44610 K  |   44610 K  |
|       from large pool |       3    |      18    |   23011 K  |   23011 K  |
|       from small pool |       0    |    3594    |   21599 K  |   21599 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 461507 KiB | 349766 GiB | 349766 GiB |
|       from large pool |  17088 KiB | 427880 KiB | 342577 GiB | 342577 GiB |
|       from small pool |      0 KiB |  38507 KiB |   7189 GiB |   7189 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 461507 KiB | 349766 GiB | 349766 GiB |
|       from large pool |  17088 KiB | 427880 KiB | 342577 GiB | 342577 GiB |
|       from small pool |      0 KiB |  38507 KiB |   7189 GiB |   7189 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457564 KiB | 349745 GiB | 349745 GiB |
|       from large pool |  16640 KiB | 424940 KiB | 342572 GiB | 342572 GiB |
|       from small pool |      0 KiB |  37503 KiB |   7172 GiB |   7172 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 229376 KiB | 509952 KiB | 509952 KiB | 280576 KiB |
|       from large pool | 204800 KiB | 466944 KiB | 466944 KiB | 262144 KiB |
|       from small pool |  24576 KiB |  43008 KiB |  43008 KiB |  18432 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  87761 KiB | 184829 GiB | 184829 GiB |
|       from large pool |  23872 KiB |  79704 KiB | 177629 GiB | 177629 GiB |
|       from small pool |      0 KiB |  18293 KiB |   7200 GiB |   7200 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7653    |   81090 K  |   81090 K  |
|       from large pool |       2    |     158    |   33765 K  |   33765 K  |
|       from small pool |       0    |    7575    |   47324 K  |   47324 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7653    |   81090 K  |   81090 K  |
|       from large pool |       2    |     158    |   33765 K  |   33765 K  |
|       from small pool |       0    |    7575    |   47324 K  |   47324 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |      42    |      42    |      20    |
|       from large pool |      10    |      21    |      21    |      11    |
|       from small pool |      12    |      21    |      21    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3602    |   44610 K  |   44610 K  |
|       from large pool |       3    |      18    |   23011 K  |   23011 K  |
|       from small pool |       0    |    3594    |   21599 K  |   21599 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_20_15_50_seed_1_23857235

 Experiment start at: 2024-07-31 20:15:51.104190
before training, model accuracy: 0.6474379897117615
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.6278291, 'precision': 0.6291903, 'recall': 0.62779117, 'specificity': 0.62779117, 'f1': 0.6268044, 'auroc': 0.6637534, 'binary_precision': 0.61611015, 'binary_recall': 0.6797322, 'binary_specificity': 0.5758502, 'binary_f1_score': 0.6463593}
confusion matrix:
       0      1
0  16577  12210
1   9233  19596
---- Validation: 
scalar performance:
{'acc': 0.8583778, 'precision': 0.50082034, 'recall': 0.50239766, 'specificity': 0.50239766, 'f1': 0.49014968, 'auroc': 0.70307666, 'binary_precision': 0.037365716, 'binary_recall': 0.11887073, 'binary_specificity': 0.88592464, 'binary_f1_score': 0.056858562}
confusion matrix:
       0     1
0  16006  2061
1    593    80
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8822108, 'precision': 0.5381428, 'recall': 0.58360565, 'specificity': 0.58360565, 'f1': 0.5458034, 'auroc': 0.7906543, 'binary_precision': 0.1107438, 'binary_recall': 0.2576923, 'binary_specificity': 0.909519, 'binary_f1_score': 0.15491329}
confusion matrix:
      0    1
0  5408  538
1   193   67
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-31 20:33:56.622633,epoch time: 0:18:05.518443,used: 0:18:05.518443,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_20_15_50_seed_1_23857235
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.7593724, 'precision': 0.7601477, 'recall': 0.75935334, 'specificity': 0.75935334, 'f1': 0.7591838, 'auroc': 0.8282908, 'binary_precision': 0.7461184, 'binary_recall': 0.7868045, 'binary_specificity': 0.7319022, 'binary_f1_score': 0.7659215}
confusion matrix:
       0      1
0  21070   7718
1   6146  22682
---- Validation: 
scalar performance:
{'acc': 0.868143, 'precision': 0.524608, 'recall': 0.5718362, 'specificity': 0.5718362, 'f1': 0.52483964, 'auroc': 0.76549363, 'binary_precision': 0.079513565, 'binary_recall': 0.25260028, 'binary_specificity': 0.8910721, 'binary_f1_score': 0.12095339}
confusion matrix:
       0     1
0  16099  1968
1    503   170
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88736707, 'precision': 0.57457066, 'recall': 0.6800848, 'specificity': 0.6800848, 'f1': 0.59575105, 'auroc': 0.83790135, 'binary_precision': 0.17481482, 'binary_recall': 0.45384616, 'binary_specificity': 0.90632355, 'binary_f1_score': 0.25240642}
confusion matrix:
      0    1
0  5389  557
1   142  118
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-31 20:51:04.650222,epoch time: 0:17:08.027589,used: 0:35:13.546032,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_20_15_50_seed_1_23857235
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.8115107, 'precision': 0.81155, 'recall': 0.81151456, 'specificity': 0.81151456, 'f1': 0.81150603, 'auroc': 0.89052975, 'binary_precision': 0.81522804, 'binary_recall': 0.80595255, 'binary_specificity': 0.81707656, 'binary_f1_score': 0.8105638}
confusion matrix:
       0      1
0  23522   5266
1   5594  23234
---- Validation: 
scalar performance:
{'acc': 0.8902882, 'precision': 0.5504421, 'recall': 0.6298136, 'specificity': 0.6298136, 'f1': 0.56362236, 'auroc': 0.7993722, 'binary_precision': 0.12682137, 'binary_recall': 0.34918275, 'binary_specificity': 0.91044444, 'binary_f1_score': 0.18606491}
confusion matrix:
       0     1
0  16449  1618
1    438   235
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89961326, 'precision': 0.59379154, 'recall': 0.7122215, 'specificity': 0.7122215, 'f1': 0.621788, 'auroc': 0.8637565, 'binary_precision': 0.21052632, 'binary_recall': 0.50769234, 'binary_specificity': 0.9167507, 'binary_f1_score': 0.29763246}
confusion matrix:
      0    1
0  5451  495
1   128  132
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-31 21:08:09.490081,epoch time: 0:17:04.839859,used: 0:52:18.385891,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_20_15_50_seed_1_23857235
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.8466051, 'precision': 0.84671104, 'recall': 0.84661174, 'specificity': 0.84661174, 'f1': 0.84659505, 'auroc': 0.92279714, 'binary_precision': 0.8529661, 'binary_recall': 0.8378772, 'binary_specificity': 0.8553463, 'binary_f1_score': 0.8453544}
confusion matrix:
       0      1
0  24622   4164
1   4674  24156
---- Validation: 
scalar performance:
{'acc': 0.89951974, 'precision': 0.5724939, 'recall': 0.6832395, 'specificity': 0.6832395, 'f1': 0.5948287, 'auroc': 0.81794846, 'binary_precision': 0.16685022, 'binary_recall': 0.45022288, 'binary_specificity': 0.9162561, 'binary_f1_score': 0.24347126}
confusion matrix:
       0     1
0  16554  1513
1    370   303
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9029971, 'precision': 0.60593, 'recall': 0.7434112, 'specificity': 0.7434112, 'f1': 0.6386686, 'auroc': 0.87945616, 'binary_precision': 0.23197491, 'binary_recall': 0.5692308, 'binary_specificity': 0.91759163, 'binary_f1_score': 0.32962137}
confusion matrix:
      0    1
0  5456  490
1   112  148
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-31 21:25:05.987629,epoch time: 0:16:56.497548,used: 1:09:14.883439,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_20_15_50_seed_1_23857235
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.86710286, 'precision': 0.86710966, 'recall': 0.8671045, 'specificity': 0.8671045, 'f1': 0.86710256, 'auroc': 0.9402394, 'binary_precision': 0.86887586, 'binary_recall': 0.86492765, 'binary_specificity': 0.8692813, 'binary_f1_score': 0.8668972}
confusion matrix:
       0      1
0  25024   3763
1   3894  24935
---- Validation: 
scalar performance:
{'acc': 0.89983994, 'precision': 0.5842485, 'recall': 0.7241758, 'specificity': 0.7241758, 'f1': 0.6117173, 'auroc': 0.8301778, 'binary_precision': 0.18711019, 'binary_recall': 0.53491825, 'binary_specificity': 0.9134333, 'binary_f1_score': 0.277243}
confusion matrix:
       0     1
0  16503  1564
1    313   360
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8981631, 'precision': 0.6138855, 'recall': 0.79238015, 'specificity': 0.79238015, 'f1': 0.6512104, 'auroc': 0.89158905, 'binary_precision': 0.24309392, 'binary_recall': 0.6769231, 'binary_specificity': 0.9078372, 'binary_f1_score': 0.3577236}
confusion matrix:
      0    1
0  5398  548
1    84  176
better model found
persisted
after epoch: 5,now: 2024-07-31 21:41:43.450401,epoch time: 0:16:37.462772,used: 1:25:52.346211,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_20_15_50_seed_1_23857235
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.8803631, 'precision': 0.880515, 'recall': 0.8803704, 'specificity': 0.8803704, 'f1': 0.8803525, 'auroc': 0.95057166, 'binary_precision': 0.88830274, 'binary_recall': 0.8703389, 'binary_specificity': 0.8904019, 'binary_f1_score': 0.87922907}
confusion matrix:
       0      1
0  25632   3155
1   3738  25091
---- Validation: 
scalar performance:
{'acc': 0.90192103, 'precision': 0.5886797, 'recall': 0.7345536, 'specificity': 0.7345536, 'f1': 0.61801445, 'auroc': 0.8359059, 'binary_precision': 0.19518577, 'binary_recall': 0.55423474, 'binary_specificity': 0.9148724, 'binary_f1_score': 0.2886997}
confusion matrix:
       0     1
0  16529  1538
1    300   373
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8973574, 'precision': 0.61780953, 'recall': 0.8121885, 'specificity': 0.8121885, 'f1': 0.6570292, 'auroc': 0.8999728, 'binary_precision': 0.24900132, 'binary_recall': 0.7192308, 'binary_specificity': 0.9051463, 'binary_f1_score': 0.36993074}
confusion matrix:
      0    1
0  5382  564
1    73  187
better model found
persisted
after epoch: 6,now: 2024-07-31 21:58:54.684278,epoch time: 0:17:11.233877,used: 1:43:03.580088,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_20_15_50_seed_1_23857235
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.89200914, 'precision': 0.8926687, 'recall': 0.89202344, 'specificity': 0.89202344, 'f1': 0.8919663, 'auroc': 0.9579617, 'binary_precision': 0.9089363, 'binary_recall': 0.8714791, 'binary_specificity': 0.91256773, 'binary_f1_score': 0.8898137}
confusion matrix:
       0      1
0  26271   2517
1   3705  25123
---- Validation: 
scalar performance:
{'acc': 0.91067237, 'precision': 0.59811944, 'recall': 0.7398075, 'specificity': 0.7398075, 'f1': 0.6305431, 'auroc': 0.8398663, 'binary_precision': 0.21383648, 'binary_recall': 0.5557206, 'binary_specificity': 0.9238944, 'binary_f1_score': 0.30883566}
confusion matrix:
       0     1
0  16692  1375
1    299   374
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9058975, 'precision': 0.6289964, 'recall': 0.8240013, 'specificity': 0.8240013, 'f1': 0.67221147, 'auroc': 0.90657914, 'binary_precision': 0.27053824, 'binary_recall': 0.7346154, 'binary_specificity': 0.9133872, 'binary_f1_score': 0.3954451}
confusion matrix:
      0    1
0  5431  515
1    69  191
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-07-31 22:16:24.966957,epoch time: 0:17:30.282679,used: 2:00:33.862767,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_20_15_50_seed_1_23857235
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.8988649, 'precision': 0.89975727, 'recall': 0.89888215, 'specificity': 0.89888215, 'f1': 0.8988112, 'auroc': 0.9605253, 'binary_precision': 0.9188274, 'binary_recall': 0.87519515, 'binary_specificity': 0.9225692, 'binary_f1_score': 0.8964807}
confusion matrix:
       0      1
0  26558   2229
1   3598  25231
---- Validation: 
scalar performance:
{'acc': 0.90955174, 'precision': 0.5989253, 'recall': 0.7470943, 'specificity': 0.7470943, 'f1': 0.6319827, 'auroc': 0.8432101, 'binary_precision': 0.21484375, 'binary_recall': 0.57206535, 'binary_specificity': 0.9221232, 'binary_f1_score': 0.31237322}
confusion matrix:
       0     1
0  16660  1407
1    288   385
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90734774, 'precision': 0.63359904, 'recall': 0.837631, 'specificity': 0.837631, 'f1': 0.6787846, 'auroc': 0.91208243, 'binary_precision': 0.278481, 'binary_recall': 0.76153845, 'binary_specificity': 0.9137235, 'binary_f1_score': 0.40782696}
confusion matrix:
      0    1
0  5433  513
1    62  198
new oracle model saved
early stop counter: 1
val acc:0.909551739692688, best validation acc: 0.9106723666191101, corresponding to test acc:                         0.9058974981307983 / 0.9073477387428284
after epoch: 8,now: 2024-07-31 22:34:13.991460,epoch time: 0:17:49.024503,used: 2:18:22.887270,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_20_15_50_seed_1_23857235
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.903985, 'precision': 0.9051002, 'recall': 0.9040051, 'specificity': 0.9040051, 'f1': 0.90392196, 'auroc': 0.9647192, 'binary_precision': 0.92654705, 'binary_recall': 0.8776969, 'binary_specificity': 0.93031335, 'binary_f1_score': 0.9014607}
confusion matrix:
       0      1
0  26780   2006
1   3526  25304
---- Validation: 
scalar performance:
{'acc': 0.91168624, 'precision': 0.6021486, 'recall': 0.75106233, 'specificity': 0.75106233, 'f1': 0.63627374, 'auroc': 0.845662, 'binary_precision': 0.22102273, 'binary_recall': 0.5780089, 'binary_specificity': 0.9241158, 'binary_f1_score': 0.3197698}
confusion matrix:
       0     1
0  16696  1371
1    284   389
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9123429, 'precision': 0.64115727, 'recall': 0.84575474, 'specificity': 0.84575474, 'f1': 0.6887512, 'auroc': 0.9155515, 'binary_precision': 0.2930029, 'binary_recall': 0.77307695, 'binary_specificity': 0.91843253, 'binary_f1_score': 0.42494714}
confusion matrix:
      0    1
0  5461  485
1    59  201
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-07-31 22:51:42.478535,epoch time: 0:17:28.487075,used: 2:35:51.374345,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_20_15_50_seed_1_23857235
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.90710914, 'precision': 0.90836287, 'recall': 0.90712845, 'specificity': 0.90712845, 'f1': 0.9070406, 'auroc': 0.96675587, 'binary_precision': 0.93116367, 'binary_recall': 0.8793534, 'binary_specificity': 0.93490344, 'binary_f1_score': 0.90451723}
confusion matrix:
       0      1
0  26914   1874
1   3478  25350
---- Validation: 
scalar performance:
{'acc': 0.90805763, 'precision': 0.6000264, 'recall': 0.75704837, 'specificity': 0.75704837, 'f1': 0.6338969, 'auroc': 0.84774446, 'binary_precision': 0.21621622, 'binary_recall': 0.5943536, 'binary_specificity': 0.9197432, 'binary_f1_score': 0.31708285}
confusion matrix:
       0     1
0  16617  1450
1    273   400
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91024816, 'precision': 0.6403633, 'recall': 0.8538565, 'specificity': 0.8538565, 'f1': 0.68825233, 'auroc': 0.9180212, 'binary_precision': 0.29055008, 'binary_recall': 0.7923077, 'binary_specificity': 0.91540533, 'binary_f1_score': 0.4251806}
confusion matrix:
      0    1
0  5443  503
1    54  206
early stop counter: 1
val acc:0.9080576300621033, best validation acc: 0.9116862416267395, corresponding to test acc:                         0.91234290599823 / 0.91234290599823
after epoch: 10,now: 2024-07-31 23:08:54.276391,epoch time: 0:17:11.797856,used: 2:53:03.172201,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_20_15_50_seed_1_23857235
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9107019, 'precision': 0.91244924, 'recall': 0.9107245, 'specificity': 0.9107245, 'f1': 0.9106104, 'auroc': 0.9697639, 'binary_precision': 0.9394693, 'binary_recall': 0.8781046, 'binary_specificity': 0.9433445, 'binary_f1_score': 0.907751}
confusion matrix:
       0      1
0  27157   1631
1   3514  25314
---- Validation: 
scalar performance:
{'acc': 0.91168624, 'precision': 0.6034488, 'recall': 0.7560692, 'specificity': 0.7560692, 'f1': 0.6382102, 'auroc': 0.8483443, 'binary_precision': 0.22322436, 'binary_recall': 0.5884101, 'binary_specificity': 0.92372835, 'binary_f1_score': 0.32366163}
confusion matrix:
       0     1
0  16689  1378
1    277   396
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91508216, 'precision': 0.6464295, 'recall': 0.8545402, 'specificity': 0.8545402, 'f1': 0.6958204, 'auroc': 0.9192398, 'binary_precision': 0.3028065, 'binary_recall': 0.78846157, 'binary_specificity': 0.9206189, 'binary_f1_score': 0.4375667}
confusion matrix:
      0    1
0  5474  472
1    55  205
new oracle model saved
early stop counter: 2
val acc:0.9116862416267395, best validation acc: 0.9116862416267395, corresponding to test acc:                         0.91234290599823 / 0.9150821566581726
after epoch: 11,now: 2024-07-31 23:26:14.387597,epoch time: 0:17:20.111206,used: 3:10:23.283407,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_20_15_50_seed_1_23857235
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9143988, 'precision': 0.91568744, 'recall': 0.91441816, 'specificity': 0.91441816, 'f1': 0.914335, 'auroc': 0.9706466, 'binary_precision': 0.93900645, 'binary_recall': 0.8864992, 'binary_specificity': 0.9423371, 'binary_f1_score': 0.9119977}
confusion matrix:
       0      1
0  27128   1660
1   3272  25556
---- Validation: 
scalar performance:
{'acc': 0.905603, 'precision': 0.59828335, 'recall': 0.75935173, 'specificity': 0.75935173, 'f1': 0.6316945, 'auroc': 0.848868, 'binary_precision': 0.21248688, 'binary_recall': 0.60178304, 'binary_specificity': 0.91692036, 'binary_f1_score': 0.3140752}
confusion matrix:
       0     1
0  16566  1501
1    268   405
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9123429, 'precision': 0.6434696, 'recall': 0.85678864, 'specificity': 0.85678864, 'f1': 0.692328, 'auroc': 0.9205322, 'binary_precision': 0.2965616, 'binary_recall': 0.79615384, 'binary_specificity': 0.9174235, 'binary_f1_score': 0.4321503}
confusion matrix:
      0    1
0  5455  491
1    53  207
early stop counter: 3
val acc:0.9056029915809631, best validation acc: 0.9116862416267395, corresponding to test acc:                         0.91234290599823 / 0.9150821566581726
after epoch: 12,now: 2024-07-31 23:43:37.224234,epoch time: 0:17:22.836637,used: 3:27:46.120044,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_20_15_50_seed_1_23857235
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9167245, 'precision': 0.91811943, 'recall': 0.9167446, 'specificity': 0.9167446, 'f1': 0.9166577, 'auroc': 0.97254807, 'binary_precision': 0.94244367, 'binary_recall': 0.8877827, 'binary_specificity': 0.94570655, 'binary_f1_score': 0.9142969}
confusion matrix:
       0      1
0  27225   1563
1   3235  25593
---- Validation: 
scalar performance:
{'acc': 0.90090716, 'precision': 0.5951412, 'recall': 0.7633537, 'specificity': 0.7633537, 'f1': 0.62750506, 'auroc': 0.84937537, 'binary_precision': 0.20576541, 'binary_recall': 0.615156, 'binary_specificity': 0.9115515, 'binary_f1_score': 0.3083799}
confusion matrix:
       0     1
0  16469  1598
1    259   414
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90767, 'precision': 0.6382973, 'recall': 0.85802805, 'specificity': 0.85802805, 'f1': 0.6858127, 'auroc': 0.9214315, 'binary_precision': 0.2859097, 'binary_recall': 0.8038462, 'binary_specificity': 0.91220987, 'binary_f1_score': 0.42179617}
confusion matrix:
      0    1
0  5424  522
1    51  209
early stop counter: 4
val acc:0.9009071588516235, best validation acc: 0.9116862416267395, corresponding to test acc:                         0.91234290599823 / 0.9150821566581726
after epoch: 13,now: 2024-08-01 00:01:11.977032,epoch time: 0:17:34.752798,used: 3:45:20.872842,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_20_15_50_seed_1_23857235
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9201437, 'precision': 0.921167, 'recall': 0.9201626, 'specificity': 0.9201626, 'f1': 0.92009753, 'auroc': 0.97396433, 'binary_precision': 0.9421189, 'binary_recall': 0.89542145, 'binary_specificity': 0.9449038, 'binary_f1_score': 0.91817683}
confusion matrix:
       0      1
0  27200   1586
1   3015  25815
---- Validation: 
scalar performance:
{'acc': 0.9006937, 'precision': 0.5959809, 'recall': 0.7675346, 'specificity': 0.7675346, 'f1': 0.6287433, 'auroc': 0.85140204, 'binary_precision': 0.20710059, 'binary_recall': 0.6240713, 'binary_specificity': 0.9109979, 'binary_f1_score': 0.31099594}
confusion matrix:
       0     1
0  16459  1608
1    253   420
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90750885, 'precision': 0.6381012, 'recall': 0.85794395, 'specificity': 0.85794395, 'f1': 0.68555415, 'auroc': 0.9230504, 'binary_precision': 0.28551912, 'binary_recall': 0.8038462, 'binary_specificity': 0.9120417, 'binary_f1_score': 0.42137098}
confusion matrix:
      0    1
0  5423  523
1    51  209
early stop counter: 5
val acc:0.9006937146186829, best validation acc: 0.9116862416267395, corresponding to test acc:                         0.91234290599823 / 0.9150821566581726
after epoch: 14,now: 2024-08-01 00:18:28.448077,epoch time: 0:17:16.471045,used: 4:02:37.343887,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_20_15_50_seed_1_23857235
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.92028254, 'precision': 0.92128956, 'recall': 0.9203005, 'specificity': 0.9203005, 'f1': 0.9202372, 'auroc': 0.97422194, 'binary_precision': 0.9420692, 'binary_recall': 0.8957647, 'binary_specificity': 0.9448362, 'binary_f1_score': 0.9183336}
confusion matrix:
       0      1
0  27199   1588
1   3005  25824
---- Validation: 
scalar performance:
{'acc': 0.89172894, 'precision': 0.58983606, 'recall': 0.7707532, 'specificity': 0.7707532, 'f1': 0.61975324, 'auroc': 0.8520572, 'binary_precision': 0.1943192, 'binary_recall': 0.640416, 'binary_specificity': 0.9010904, 'binary_f1_score': 0.29816672}
confusion matrix:
       0     1
0  16280  1787
1    242   431
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89848536, 'precision': 0.62945014, 'recall': 0.8605908, 'specificity': 0.8605908, 'f1': 0.6739659, 'auroc': 0.9239844, 'binary_precision': 0.26758793, 'binary_recall': 0.8192308, 'binary_specificity': 0.9019509, 'binary_f1_score': 0.4034091}
confusion matrix:
      0    1
0  5363  583
1    47  213
early stop counter: 6
val acc:0.891728937625885, best validation acc: 0.9116862416267395, corresponding to test acc:                         0.91234290599823 / 0.9150821566581726
after epoch: 15,now: 2024-08-01 00:35:33.366537,epoch time: 0:17:04.918460,used: 4:19:42.262347,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_20_15_50_seed_1_23857235
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.92484725, 'precision': 0.9255898, 'recall': 0.92486256, 'specificity': 0.92486256, 'f1': 0.92481625, 'auroc': 0.9758798, 'binary_precision': 0.9435493, 'binary_recall': 0.9038815, 'binary_specificity': 0.94584364, 'binary_f1_score': 0.92328954}
confusion matrix:
       0      1
0  27228   1559
1   2771  26058
---- Validation: 
scalar performance:
{'acc': 0.8847919, 'precision': 0.585869, 'recall': 0.7735929, 'specificity': 0.7735929, 'f1': 0.613441, 'auroc': 0.8546053, 'binary_precision': 0.18596788, 'binary_recall': 0.653789, 'binary_specificity': 0.8933968, 'binary_f1_score': 0.28956893}
confusion matrix:
       0     1
0  16141  1926
1    233   440
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88833386, 'precision': 0.619971, 'recall': 0.85713214, 'specificity': 0.85713214, 'f1': 0.6602128, 'auroc': 0.92486095, 'binary_precision': 0.2485482, 'binary_recall': 0.8230769, 'binary_specificity': 0.89118737, 'binary_f1_score': 0.38180193}
confusion matrix:
      0    1
0  5299  647
1    46  214
early stop counter: 7
val acc:0.884791910648346, best validation acc: 0.9116862416267395, corresponding to test acc:                         0.91234290599823 / 0.9150821566581726
after epoch: 16,now: 2024-08-01 00:52:44.875105,epoch time: 0:17:11.508568,used: 4:36:53.770915,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_20_15_50_seed_1_23857235
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9230769, 'precision': 0.92427886, 'recall': 0.9230964, 'specificity': 0.9230964, 'f1': 0.9230248, 'auroc': 0.9770293, 'binary_precision': 0.9470444, 'binary_recall': 0.89638907, 'binary_specificity': 0.9498037, 'binary_f1_score': 0.9210208}
confusion matrix:
       0      1
0  27342   1445
1   2987  25842
---- Validation: 
scalar performance:
{'acc': 0.9004803, 'precision': 0.5971533, 'recall': 0.77314603, 'specificity': 0.77314603, 'f1': 0.63046753, 'auroc': 0.8546535, 'binary_precision': 0.20898438, 'binary_recall': 0.6359584, 'binary_specificity': 0.91033375, 'binary_f1_score': 0.31459022}
confusion matrix:
       0     1
0  16447  1620
1    245   428
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90638095, 'precision': 0.6382655, 'recall': 0.8647113, 'specificity': 0.8647113, 'f1': 0.6860481, 'auroc': 0.92490494, 'binary_precision': 0.28514057, 'binary_recall': 0.8192308, 'binary_specificity': 0.9101917, 'binary_f1_score': 0.42303875}
confusion matrix:
      0    1
0  5412  534
1    47  213
early stop counter: 8
val acc:0.9004802703857422, best validation acc: 0.9116862416267395, corresponding to test acc:                         0.91234290599823 / 0.9150821566581726
after epoch: 17,now: 2024-08-01 01:09:52.593003,epoch time: 0:17:07.717898,used: 4:54:01.488813,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_20_15_50_seed_1_23857235
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9258539, 'precision': 0.9266906, 'recall': 0.92586935, 'specificity': 0.92586935, 'f1': 0.92581934, 'auroc': 0.976823, 'binary_precision': 0.94575953, 'binary_recall': 0.9036354, 'binary_specificity': 0.94810337, 'binary_f1_score': 0.9242177}
confusion matrix:
       0      1
0  27294   1494
1   2778  26050
---- Validation: 
scalar performance:
{'acc': 0.8871398, 'precision': 0.5879762, 'recall': 0.7762411, 'specificity': 0.7762411, 'f1': 0.6167134, 'auroc': 0.85633636, 'binary_precision': 0.19002579, 'binary_recall': 0.65676075, 'binary_specificity': 0.8957215, 'binary_f1_score': 0.2947649}
confusion matrix:
       0     1
0  16183  1884
1    231   442
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8904286, 'precision': 0.6218866, 'recall': 0.8582253, 'specificity': 0.8582253, 'f1': 0.66306293, 'auroc': 0.925956, 'binary_precision': 0.2523585, 'binary_recall': 0.8230769, 'binary_specificity': 0.89337367, 'binary_f1_score': 0.38628158}
confusion matrix:
      0    1
0  5312  634
1    46  214
early stop counter: 9
val acc:0.8871397972106934, best validation acc: 0.9116862416267395, corresponding to test acc:                         0.91234290599823 / 0.9150821566581726
after epoch: 18,now: 2024-08-01 01:27:11.060171,epoch time: 0:17:18.467168,used: 5:11:19.955981,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_20_15_50_seed_1_23857235
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9267738, 'precision': 0.9281864, 'recall': 0.9267938, 'specificity': 0.9267938, 'f1': 0.9267157, 'auroc': 0.9778879, 'binary_precision': 0.9529542, 'binary_recall': 0.8979811, 'binary_specificity': 0.9556065, 'binary_f1_score': 0.9246513}
confusion matrix:
       0      1
0  27510   1278
1   2941  25887
---- Validation: 
scalar performance:
{'acc': 0.8989861, 'precision': 0.5952185, 'recall': 0.7702254, 'specificity': 0.7702254, 'f1': 0.6276922, 'auroc': 0.8545995, 'binary_precision': 0.20531401, 'binary_recall': 0.6315007, 'binary_specificity': 0.90895003, 'binary_f1_score': 0.30987966}
confusion matrix:
       0     1
0  16422  1645
1    248   425
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90605867, 'precision': 0.6371244, 'recall': 0.8608651, 'specificity': 0.8608651, 'f1': 0.68439573, 'auroc': 0.9257115, 'binary_precision': 0.28322148, 'binary_recall': 0.81153846, 'binary_specificity': 0.9101917, 'binary_f1_score': 0.4199005}
confusion matrix:
      0    1
0  5412  534
1    49  211
early stop counter: 10
val acc:0.8989861011505127, best validation acc: 0.9116862416267395, corresponding to test acc:                         0.91234290599823 / 0.9150821566581726
after epoch: 19,now: 2024-08-01 01:44:24.012545,epoch time: 0:17:12.952374,used: 5:28:32.908355,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_20_15_50_seed_1_23857235
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.92996734, 'precision': 0.93038046, 'recall': 0.9299782, 'specificity': 0.9299782, 'f1': 0.9299517, 'auroc': 0.9793092, 'binary_precision': 0.94388944, 'binary_recall': 0.9143888, 'binary_specificity': 0.9455676, 'binary_f1_score': 0.92890495}
confusion matrix:
       0      1
0  27221   1567
1   2468  26360
---- Validation: 
scalar performance:
{'acc': 0.8773746, 'precision': 0.5837972, 'recall': 0.7840514, 'specificity': 0.7840514, 'f1': 0.6094103, 'auroc': 0.85677123, 'binary_precision': 0.18074656, 'binary_recall': 0.68350667, 'binary_specificity': 0.8845962, 'binary_f1_score': 0.28589183}
confusion matrix:
       0     1
0  15982  2085
1    213   460
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88059944, 'precision': 0.61489534, 'recall': 0.86045176, 'specificity': 0.86045176, 'f1': 0.6522394, 'auroc': 0.9267516, 'binary_precision': 0.23773174, 'binary_recall': 0.8384615, 'binary_specificity': 0.882442, 'binary_f1_score': 0.37043333}
confusion matrix:
      0    1
0  5247  699
1    42  218
early stop counter: 11
val acc:0.8773745894432068, best validation acc: 0.9116862416267395, corresponding to test acc:                         0.91234290599823 / 0.9150821566581726
after epoch: 20,now: 2024-08-01 02:01:33.895400,epoch time: 0:17:09.882855,used: 5:45:42.791210,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_20_15_50_seed_1_23857235
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 5:45:42.791210 at 2024-08-01 02:01:33.895400
persisted model performance metric: 

scalar performance:
{'acc': 0.9123429, 'precision': 0.64115727, 'recall': 0.84575474, 'specificity': 0.84575474, 'f1': 0.6887512, 'auroc': 0.9155515, 'binary_precision': 0.2930029, 'binary_recall': 0.77307695, 'binary_specificity': 0.91843253, 'binary_f1_score': 0.42494714}
confusion matrix:
      0    1
0  5461  485
1    59  201
oracle model performance metric: 

scalar performance:
{'acc': 0.91508216, 'precision': 0.6464295, 'recall': 0.8545402, 'specificity': 0.8545402, 'f1': 0.6958204, 'auroc': 0.9192398, 'binary_precision': 0.3028065, 'binary_recall': 0.78846157, 'binary_specificity': 0.9206189, 'binary_f1_score': 0.4375667}
confusion matrix:
      0    1
0  5474  472
1    55  205
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_12-46-56/rule_results/17.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_12-46-56/confusion_matrix/17.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 190959 KiB | 461507 KiB | 702663 GiB | 702663 GiB |
|       from large pool | 173494 KiB | 427880 KiB | 688224 GiB | 688224 GiB |
|       from small pool |  17465 KiB |  38507 KiB |  14439 GiB |  14439 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 190959 KiB | 461507 KiB | 702663 GiB | 702663 GiB |
|       from large pool | 173494 KiB | 427880 KiB | 688224 GiB | 688224 GiB |
|       from small pool |  17465 KiB |  38507 KiB |  14439 GiB |  14439 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 189280 KiB | 457564 KiB | 702623 GiB | 702623 GiB |
|       from large pool | 172814 KiB | 424940 KiB | 688216 GiB | 688216 GiB |
|       from small pool |  16466 KiB |  37503 KiB |  14406 GiB |  14406 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 526336 KiB | 526336 KiB |    788 MiB | 280576 KiB |
|       from large pool | 487424 KiB | 487424 KiB |    732 MiB | 262144 KiB |
|       from small pool |  38912 KiB |  43008 KiB |     56 MiB |  18432 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  42512 KiB |  87761 KiB | 381862 GiB | 381862 GiB |
|       from large pool |  31306 KiB |  79704 KiB | 367400 GiB | 367400 GiB |
|       from small pool |  11206 KiB |  18293 KiB |  14461 GiB |  14461 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2942    |    7685    |  162711 K  |  162708 K  |
|       from large pool |      76    |     158    |   67835 K  |   67835 K  |
|       from small pool |    2866    |    7607    |   94876 K  |   94873 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2942    |    7685    |  162711 K  |  162708 K  |
|       from large pool |      76    |     158    |   67835 K  |   67835 K  |
|       from small pool |    2866    |    7607    |   94876 K  |   94873 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      41    |      42    |      61    |      20    |
|       from large pool |      22    |      22    |      33    |      11    |
|       from small pool |      19    |      21    |      28    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      35    |    3620    |   85000 K  |   85000 K  |
|       from large pool |      10    |      23    |   42044 K  |   42044 K  |
|       from small pool |      25    |    3610    |   42956 K  |   42956 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 461507 KiB | 702663 GiB | 702663 GiB |
|       from large pool |  17088 KiB | 427880 KiB | 688224 GiB | 688224 GiB |
|       from small pool |      0 KiB |  38507 KiB |  14439 GiB |  14439 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 461507 KiB | 702663 GiB | 702663 GiB |
|       from large pool |  17088 KiB | 427880 KiB | 688224 GiB | 688224 GiB |
|       from small pool |      0 KiB |  38507 KiB |  14439 GiB |  14439 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457564 KiB | 702623 GiB | 702623 GiB |
|       from large pool |  16640 KiB | 424940 KiB | 688216 GiB | 688216 GiB |
|       from small pool |      0 KiB |  37503 KiB |  14406 GiB |  14406 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 233472 KiB | 526336 KiB |    788 MiB | 573440 KiB |
|       from large pool | 204800 KiB | 487424 KiB |    732 MiB | 544768 KiB |
|       from small pool |  28672 KiB |  43008 KiB |     56 MiB |  28672 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  87761 KiB | 381862 GiB | 381862 GiB |
|       from large pool |  23872 KiB |  79704 KiB | 367400 GiB | 367400 GiB |
|       from small pool |      0 KiB |  21236 KiB |  14461 GiB |  14461 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7685    |  162711 K  |  162711 K  |
|       from large pool |       2    |     158    |   67835 K  |   67835 K  |
|       from small pool |       0    |    7607    |   94876 K  |   94876 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7685    |  162711 K  |  162711 K  |
|       from large pool |       2    |     158    |   67835 K  |   67835 K  |
|       from small pool |       0    |    7607    |   94876 K  |   94876 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |      42    |      61    |      37    |
|       from large pool |      10    |      22    |      33    |      23    |
|       from small pool |      14    |      21    |      28    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3620    |   85001 K  |   85001 K  |
|       from large pool |       3    |      23    |   42044 K  |   42044 K  |
|       from small pool |       0    |    3610    |   42957 K  |   42957 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 461507 KiB | 702663 GiB | 702663 GiB |
|       from large pool |  17088 KiB | 427880 KiB | 688224 GiB | 688224 GiB |
|       from small pool |      0 KiB |  38507 KiB |  14439 GiB |  14439 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 461507 KiB | 702663 GiB | 702663 GiB |
|       from large pool |  17088 KiB | 427880 KiB | 688224 GiB | 688224 GiB |
|       from small pool |      0 KiB |  38507 KiB |  14439 GiB |  14439 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457564 KiB | 702623 GiB | 702623 GiB |
|       from large pool |  16640 KiB | 424940 KiB | 688216 GiB | 688216 GiB |
|       from small pool |      0 KiB |  37503 KiB |  14406 GiB |  14406 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 233472 KiB | 526336 KiB |    788 MiB | 573440 KiB |
|       from large pool | 204800 KiB | 487424 KiB |    732 MiB | 544768 KiB |
|       from small pool |  28672 KiB |  43008 KiB |     56 MiB |  28672 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  87761 KiB | 381862 GiB | 381862 GiB |
|       from large pool |  23872 KiB |  79704 KiB | 367400 GiB | 367400 GiB |
|       from small pool |      0 KiB |  21236 KiB |  14461 GiB |  14461 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7685    |  162711 K  |  162711 K  |
|       from large pool |       2    |     158    |   67835 K  |   67835 K  |
|       from small pool |       0    |    7607    |   94876 K  |   94876 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7685    |  162711 K  |  162711 K  |
|       from large pool |       2    |     158    |   67835 K  |   67835 K  |
|       from small pool |       0    |    7607    |   94876 K  |   94876 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |      42    |      61    |      37    |
|       from large pool |      10    |      22    |      33    |      23    |
|       from small pool |      14    |      21    |      28    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3620    |   85001 K  |   85001 K  |
|       from large pool |       3    |      23    |   42044 K  |   42044 K  |
|       from small pool |       0    |    3610    |   42957 K  |   42957 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_02_09_59_seed_2_23857235

 Experiment start at: 2024-08-01 02:09:59.714378
before training, model accuracy: 0.754768431186676
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.7367076, 'precision': 0.7372143, 'recall': 0.73671234, 'specificity': 0.73671234, 'f1': 0.7365695, 'auroc': 0.80987227, 'binary_precision': 0.74822915, 'binary_recall': 0.71366346, 'binary_specificity': 0.7597612, 'binary_f1_score': 0.7305377}
confusion matrix:
       0      1
0  22144   7002
1   8349  20809
---- Validation: 
scalar performance:
{'acc': 0.66446495, 'precision': 0.5256434, 'recall': 0.687747, 'specificity': 0.687747, 'f1': 0.4563018, 'auroc': 0.7511084, 'binary_precision': 0.06544623, 'binary_recall': 0.7126246, 'binary_specificity': 0.6628694, 'binary_f1_score': 0.11988264}
confusion matrix:
       0     1
0  12045  6126
1    173   429
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.39782017, 'precision': 0.50005996, 'recall': 0.5003824, 'specificity': 0.5003824, 'f1': 0.3135488, 'auroc': 0.48704654, 'binary_precision': 0.03883495, 'binary_recall': 0.61157024, 'binary_specificity': 0.3891946, 'binary_f1_score': 0.07303233}
confusion matrix:
      0     1
0  2334  3663
1    94   148
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-01 02:28:17.197378,epoch time: 0:18:17.483000,used: 0:18:17.483000,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_02_09_59_seed_2_23857235
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.8154329, 'precision': 0.81549585, 'recall': 0.8154341, 'specificity': 0.8154341, 'f1': 0.8154241, 'auroc': 0.8940855, 'binary_precision': 0.8199972, 'binary_recall': 0.8083822, 'binary_specificity': 0.82248604, 'binary_f1_score': 0.8141483}
confusion matrix:
       0      1
0  23973   5174
1   5587  23570
---- Validation: 
scalar performance:
{'acc': 0.7192777, 'precision': 0.5321735, 'recall': 0.71525824, 'specificity': 0.71525824, 'f1': 0.4860024, 'auroc': 0.7828117, 'binary_precision': 0.077480085, 'binary_recall': 0.7109634, 'binary_specificity': 0.7195531, 'binary_f1_score': 0.13973229}
confusion matrix:
       0     1
0  13075  5096
1    174   428
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5507293, 'precision': 0.5179243, 'recall': 0.61957705, 'specificity': 0.61957705, 'f1': 0.40345067, 'auroc': 0.63965523, 'binary_precision': 0.057991024, 'binary_recall': 0.6942149, 'binary_specificity': 0.54493916, 'binary_f1_score': 0.10704046}
confusion matrix:
      0     1
0  3268  2729
1    74   168
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-01 02:45:54.832296,epoch time: 0:17:37.634918,used: 0:35:55.117918,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_02_09_59_seed_2_23857235
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.84599686, 'precision': 0.845997, 'recall': 0.8459968, 'specificity': 0.8459968, 'f1': 0.84599686, 'auroc': 0.9222076, 'binary_precision': 0.84584534, 'binary_recall': 0.84628046, 'binary_specificity': 0.84571314, 'binary_f1_score': 0.84606284}
confusion matrix:
       0      1
0  24650   4497
1   4482  24675
---- Validation: 
scalar performance:
{'acc': 0.76380974, 'precision': 0.5384952, 'recall': 0.7318376, 'specificity': 0.7318376, 'f1': 0.51093864, 'auroc': 0.8002211, 'binary_precision': 0.08989726, 'binary_recall': 0.6976744, 'binary_specificity': 0.76600075, 'binary_f1_score': 0.1592719}
confusion matrix:
       0     1
0  13919  4252
1    182   420
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6321526, 'precision': 0.5261599, 'recall': 0.665897, 'specificity': 0.665897, 'f1': 0.44793582, 'auroc': 0.71220803, 'binary_precision': 0.07104053, 'binary_recall': 0.70247936, 'binary_specificity': 0.62931466, 'binary_f1_score': 0.12903227}
confusion matrix:
      0     1
0  3774  2223
1    72   170
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-01 03:03:29.204029,epoch time: 0:17:34.371733,used: 0:53:29.489651,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_02_09_59_seed_2_23857235
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.86242795, 'precision': 0.8624323, 'recall': 0.8624284, 'specificity': 0.8624284, 'f1': 0.86242765, 'auroc': 0.93635786, 'binary_precision': 0.86374587, 'binary_recall': 0.8606948, 'binary_specificity': 0.86416197, 'binary_f1_score': 0.86221766}
confusion matrix:
       0      1
0  25186   3959
1   4062  25097
---- Validation: 
scalar performance:
{'acc': 0.7937996, 'precision': 0.5445111, 'recall': 0.74492013, 'specificity': 0.74492013, 'f1': 0.5296936, 'auroc': 0.81344235, 'binary_precision': 0.10163295, 'binary_recall': 0.692691, 'binary_specificity': 0.7971493, 'binary_f1_score': 0.17725825}
confusion matrix:
       0     1
0  14485  3686
1    185   417
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.68616766, 'precision': 0.5355903, 'recall': 0.7118391, 'specificity': 0.7118391, 'f1': 0.4809491, 'auroc': 0.7617769, 'binary_precision': 0.086306654, 'binary_recall': 0.73966944, 'binary_specificity': 0.68400866, 'binary_f1_score': 0.15457685}
confusion matrix:
      0     1
0  4102  1895
1    63   179
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-01 03:20:43.489307,epoch time: 0:17:14.285278,used: 1:10:43.774929,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_02_09_59_seed_2_23857235
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.8735764, 'precision': 0.8735776, 'recall': 0.8735763, 'specificity': 0.8735763, 'f1': 0.8735763, 'auroc': 0.9450475, 'binary_precision': 0.87297565, 'binary_recall': 0.8744427, 'binary_specificity': 0.8727098, 'binary_f1_score': 0.87370855}
confusion matrix:
       0      1
0  25436   3710
1   3661  25497
---- Validation: 
scalar performance:
{'acc': 0.8040803, 'precision': 0.5468343, 'recall': 0.74862474, 'specificity': 0.74862474, 'f1': 0.5363954, 'auroc': 0.8226523, 'binary_precision': 0.1062468, 'binary_recall': 0.6893688, 'binary_specificity': 0.8078807, 'binary_f1_score': 0.18411712}
confusion matrix:
       0     1
0  14680  3491
1    187   415
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7081263, 'precision': 0.5424194, 'recall': 0.74507153, 'specificity': 0.74507153, 'f1': 0.4977285, 'auroc': 0.7952454, 'binary_precision': 0.09698826, 'binary_recall': 0.78512394, 'binary_specificity': 0.7050192, 'binary_f1_score': 0.17264879}
confusion matrix:
      0     1
0  4228  1769
1    52   190
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-01 03:37:55.080969,epoch time: 0:17:11.591662,used: 1:27:55.366591,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_02_09_59_seed_2_23857235
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.88350713, 'precision': 0.8839588, 'recall': 0.8835107, 'specificity': 0.8835107, 'f1': 0.8834736, 'auroc': 0.9513552, 'binary_precision': 0.89718, 'binary_recall': 0.86634886, 'binary_specificity': 0.9006725, 'binary_f1_score': 0.881495}
confusion matrix:
       0      1
0  26251   2895
1   3897  25261
---- Validation: 
scalar performance:
{'acc': 0.8349225, 'precision': 0.55369544, 'recall': 0.7501018, 'specificity': 0.7501018, 'f1': 0.5559345, 'auroc': 0.82843834, 'binary_precision': 0.12063203, 'binary_recall': 0.6594684, 'binary_specificity': 0.84073526, 'binary_f1_score': 0.20395581}
confusion matrix:
       0     1
0  15277  2894
1    205   397
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7582946, 'precision': 0.5493192, 'recall': 0.755306, 'specificity': 0.755306, 'f1': 0.5261304, 'auroc': 0.817049, 'binary_precision': 0.11165644, 'binary_recall': 0.75206614, 'binary_specificity': 0.75854594, 'binary_f1_score': 0.19444445}
confusion matrix:
      0     1
0  4549  1448
1    60   182
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-08-01 03:55:27.887836,epoch time: 0:17:32.806867,used: 1:45:28.173458,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_02_09_59_seed_2_23857235
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.89059067, 'precision': 0.8912716, 'recall': 0.8905964, 'specificity': 0.8905964, 'f1': 0.89054406, 'auroc': 0.9564438, 'binary_precision': 0.9076626, 'binary_recall': 0.8697188, 'binary_specificity': 0.91147405, 'binary_f1_score': 0.88828564}
confusion matrix:
       0      1
0  26564   2580
1   3799  25361
---- Validation: 
scalar performance:
{'acc': 0.84909177, 'precision': 0.5569563, 'recall': 0.7461785, 'specificity': 0.7461785, 'f1': 0.56469166, 'auroc': 0.8332406, 'binary_precision': 0.12779446, 'binary_recall': 0.63621265, 'binary_specificity': 0.8561444, 'binary_f1_score': 0.2128369}
confusion matrix:
       0     1
0  15557  2614
1    219   383
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.78201634, 'precision': 0.555097, 'recall': 0.76764554, 'specificity': 0.76764554, 'f1': 0.54233617, 'auroc': 0.83370817, 'binary_precision': 0.12280702, 'binary_recall': 0.75206614, 'binary_specificity': 0.78322494, 'binary_f1_score': 0.21113689}
confusion matrix:
      0     1
0  4697  1300
1    60   182
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-08-01 04:13:08.027469,epoch time: 0:17:40.139633,used: 2:03:08.313091,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_02_09_59_seed_2_23857235
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.8960792, 'precision': 0.89638007, 'recall': 0.89608157, 'specificity': 0.89608157, 'f1': 0.8960599, 'auroc': 0.95897055, 'binary_precision': 0.9073434, 'binary_recall': 0.8822924, 'binary_specificity': 0.9098707, 'binary_f1_score': 0.8946426}
confusion matrix:
       0      1
0  26520   2627
1   3432  25725
---- Validation: 
scalar performance:
{'acc': 0.8422735, 'precision': 0.5559437, 'recall': 0.75148994, 'specificity': 0.75148994, 'f1': 0.561289, 'auroc': 0.83716196, 'binary_precision': 0.1251986, 'binary_recall': 0.65448505, 'binary_specificity': 0.8484948, 'binary_f1_score': 0.21018939}
confusion matrix:
       0     1
0  15418  2753
1    208   394
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77416253, 'precision': 0.5551707, 'recall': 0.7754566, 'specificity': 0.7754566, 'f1': 0.5394379, 'auroc': 0.84662163, 'binary_precision': 0.121840574, 'binary_recall': 0.7768595, 'binary_specificity': 0.7740537, 'binary_f1_score': 0.21064426}
confusion matrix:
      0     1
0  4642  1355
1    54   188
early stop counter: 1
val acc:0.842273473739624, best validation acc: 0.8490917682647705, corresponding to test acc:                         0.7820163369178772 / 0.7820163369178772
after epoch: 8,now: 2024-08-01 04:30:40.794943,epoch time: 0:17:32.767474,used: 2:20:41.080565,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_02_09_59_seed_2_23857235
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.900813, 'precision': 0.90191984, 'recall': 0.9008157, 'specificity': 0.9008157, 'f1': 0.9007451, 'auroc': 0.96247697, 'binary_precision': 0.92303795, 'binary_recall': 0.874567, 'binary_specificity': 0.9270644, 'binary_f1_score': 0.89814895}
confusion matrix:
       0      1
0  27023   2126
1   3657  25498
---- Validation: 
scalar performance:
{'acc': 0.86134344, 'precision': 0.5623673, 'recall': 0.7525073, 'specificity': 0.7525073, 'f1': 0.5756025, 'auroc': 0.83975816, 'binary_precision': 0.13841707, 'binary_recall': 0.63621265, 'binary_specificity': 0.86880195, 'binary_f1_score': 0.22736719}
confusion matrix:
       0     1
0  15787  2384
1    219   383
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80349416, 'precision': 0.5617438, 'recall': 0.7808005, 'specificity': 0.7808005, 'f1': 0.5586389, 'auroc': 0.8556055, 'binary_precision': 0.13555555, 'binary_recall': 0.75619835, 'binary_specificity': 0.8054027, 'binary_f1_score': 0.22989948}
confusion matrix:
      0     1
0  4830  1167
1    59   183
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-08-01 04:48:12.352053,epoch time: 0:17:31.557110,used: 2:38:12.637675,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_02_09_59_seed_2_23857235
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9066616, 'precision': 0.90715003, 'recall': 0.9066652, 'specificity': 0.9066652, 'f1': 0.9066342, 'auroc': 0.9657395, 'binary_precision': 0.9213032, 'binary_recall': 0.8893271, 'binary_specificity': 0.9240033, 'binary_f1_score': 0.9050328}
confusion matrix:
       0      1
0  26931   2215
1   3227  25931
---- Validation: 
scalar performance:
{'acc': 0.8545251, 'precision': 0.5609761, 'recall': 0.7578187, 'specificity': 0.7578187, 'f1': 0.5718337, 'auroc': 0.8439682, 'binary_precision': 0.13507028, 'binary_recall': 0.65448505, 'binary_specificity': 0.8611524, 'binary_f1_score': 0.22392727}
confusion matrix:
       0     1
0  15648  2523
1    208   394
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7967623, 'precision': 0.5618268, 'recall': 0.7891952, 'specificity': 0.7891952, 'f1': 0.55629355, 'auroc': 0.86495936, 'binary_precision': 0.13461539, 'binary_recall': 0.78099173, 'binary_specificity': 0.7973987, 'binary_f1_score': 0.22964765}
confusion matrix:
      0     1
0  4782  1215
1    53   189
early stop counter: 1
val acc:0.854525089263916, best validation acc: 0.8613434433937073, corresponding to test acc:                         0.8034941554069519 / 0.8034941554069519
after epoch: 10,now: 2024-08-01 05:05:58.537122,epoch time: 0:17:46.185069,used: 2:55:58.822744,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_02_09_59_seed_2_23857235
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.91151553, 'precision': 0.9127661, 'recall': 0.9115212, 'specificity': 0.9115212, 'f1': 0.9114492, 'auroc': 0.9682363, 'binary_precision': 0.93553776, 'binary_recall': 0.88397694, 'binary_specificity': 0.9390654, 'binary_f1_score': 0.9090268}
confusion matrix:
       0      1
0  27370   1776
1   3383  25775
---- Validation: 
scalar performance:
{'acc': 0.8656049, 'precision': 0.56478804, 'recall': 0.7563147, 'specificity': 0.7563147, 'f1': 0.58008575, 'auroc': 0.8454772, 'binary_precision': 0.14306949, 'binary_recall': 0.6395349, 'binary_specificity': 0.8730945, 'binary_f1_score': 0.23382932}
confusion matrix:
       0     1
0  15865  2306
1    217   385
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8147139, 'precision': 0.5655356, 'recall': 0.78663677, 'specificity': 0.78663677, 'f1': 0.56748, 'auroc': 0.8710202, 'binary_precision': 0.14296874, 'binary_recall': 0.75619835, 'binary_specificity': 0.8170752, 'binary_f1_score': 0.24047306}
confusion matrix:
      0     1
0  4900  1097
1    59   183
new oracle model saved
better model found
persisted
after epoch: 11,now: 2024-08-01 05:23:40.900502,epoch time: 0:17:42.363380,used: 3:13:41.186124,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_02_09_59_seed_2_23857235
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.91245884, 'precision': 0.9132084, 'recall': 0.9124632, 'specificity': 0.9124632, 'f1': 0.91241974, 'auroc': 0.9698125, 'binary_precision': 0.9308591, 'binary_recall': 0.8911448, 'binary_specificity': 0.9337816, 'binary_f1_score': 0.91056913}
confusion matrix:
       0      1
0  27216   1930
1   3174  25984
---- Validation: 
scalar performance:
{'acc': 0.85079634, 'precision': 0.5610497, 'recall': 0.7647261, 'specificity': 0.7647261, 'f1': 0.5708872, 'auroc': 0.8482902, 'binary_precision': 0.13459621, 'binary_recall': 0.67275745, 'binary_specificity': 0.85669476, 'binary_f1_score': 0.22431459}
confusion matrix:
       0     1
0  15567  2604
1    197   405
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79531974, 'precision': 0.5631825, 'recall': 0.79835856, 'specificity': 0.79835856, 'f1': 0.5574672, 'auroc': 0.87729955, 'binary_precision': 0.13633169, 'binary_recall': 0.8016529, 'binary_specificity': 0.7950642, 'binary_f1_score': 0.23303303}
confusion matrix:
      0     1
0  4768  1229
1    48   194
early stop counter: 1
val acc:0.8507963418960571, best validation acc: 0.8656048774719238, corresponding to test acc:                         0.8147138953208923 / 0.8147138953208923
after epoch: 12,now: 2024-08-01 05:46:16.416646,epoch time: 0:22:35.516144,used: 3:36:16.702268,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_02_09_59_seed_2_23857235
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.91573477, 'precision': 0.91644824, 'recall': 0.91573906, 'specificity': 0.91573906, 'f1': 0.91569924, 'auroc': 0.97105336, 'binary_precision': 0.93373644, 'binary_recall': 0.89502025, 'binary_specificity': 0.9364578, 'binary_f1_score': 0.9139685}
confusion matrix:
       0      1
0  27294   1852
1   3061  26097
---- Validation: 
scalar performance:
{'acc': 0.85591006, 'precision': 0.5633054, 'recall': 0.76736766, 'specificity': 0.76736766, 'f1': 0.5754773, 'auroc': 0.8499826, 'binary_precision': 0.13903193, 'binary_recall': 0.67275745, 'binary_specificity': 0.8619779, 'binary_f1_score': 0.23044097}
confusion matrix:
       0     1
0  15663  2508
1    197   405
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80782175, 'precision': 0.56684995, 'recall': 0.80287904, 'specificity': 0.80287904, 'f1': 0.5667312, 'auroc': 0.88142145, 'binary_precision': 0.14370811, 'binary_recall': 0.79752064, 'binary_specificity': 0.80823743, 'binary_f1_score': 0.2435331}
confusion matrix:
      0     1
0  4847  1150
1    49   193
early stop counter: 2
val acc:0.855910062789917, best validation acc: 0.8656048774719238, corresponding to test acc:                         0.8147138953208923 / 0.8147138953208923
after epoch: 13,now: 2024-08-01 06:08:57.450935,epoch time: 0:22:41.034289,used: 3:58:57.736557,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_02_09_59_seed_2_23857235
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.91566616, 'precision': 0.9167417, 'recall': 0.9156705, 'specificity': 0.9156705, 'f1': 0.9156123, 'auroc': 0.97169185, 'binary_precision': 0.9379562, 'binary_recall': 0.8902493, 'binary_specificity': 0.9410917, 'binary_f1_score': 0.9134803}
confusion matrix:
       0      1
0  27430   1717
1   3200  25957
---- Validation: 
scalar performance:
{'acc': 0.86864114, 'precision': 0.5683197, 'recall': 0.7675197, 'specificity': 0.7675197, 'f1': 0.5858169, 'auroc': 0.8512056, 'binary_precision': 0.14936042, 'binary_recall': 0.6594684, 'binary_specificity': 0.87557095, 'binary_f1_score': 0.24355827}
confusion matrix:
       0     1
0  15910  2261
1    205   397
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82753646, 'precision': 0.5726988, 'recall': 0.8052032, 'specificity': 0.8052032, 'f1': 0.5811836, 'auroc': 0.8843974, 'binary_precision': 0.15594059, 'binary_recall': 0.78099173, 'binary_specificity': 0.8294147, 'binary_f1_score': 0.25997248}
confusion matrix:
      0     1
0  4974  1023
1    53   189
new oracle model saved
better model found
persisted
after epoch: 14,now: 2024-08-01 06:31:20.944770,epoch time: 0:22:23.493835,used: 4:21:21.230392,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_02_09_59_seed_2_23857235
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9185819, 'precision': 0.91952443, 'recall': 0.91858435, 'specificity': 0.91858435, 'f1': 0.9185365, 'auroc': 0.9735886, 'binary_precision': 0.9394354, 'binary_recall': 0.89487225, 'binary_specificity': 0.9422965, 'binary_f1_score': 0.9166125}
confusion matrix:
       0      1
0  27467   1682
1   3065  26090
---- Validation: 
scalar performance:
{'acc': 0.86283493, 'precision': 0.5669185, 'recall': 0.77255094, 'specificity': 0.77255094, 'f1': 0.58240086, 'auroc': 0.8544179, 'binary_precision': 0.14603516, 'binary_recall': 0.67607975, 'binary_specificity': 0.8690221, 'binary_f1_score': 0.24018885}
confusion matrix:
       0     1
0  15791  2380
1    195   407
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8217663, 'precision': 0.57116467, 'recall': 0.80616724, 'specificity': 0.80616724, 'f1': 0.5772256, 'auroc': 0.8891891, 'binary_precision': 0.15255591, 'binary_recall': 0.7892562, 'binary_specificity': 0.8230782, 'binary_f1_score': 0.2556894}
confusion matrix:
      0     1
0  4936  1061
1    51   191
early stop counter: 1
val acc:0.8628349304199219, best validation acc: 0.8686411380767822, corresponding to test acc:                         0.8275364637374878 / 0.8275364637374878
after epoch: 15,now: 2024-08-01 06:54:06.095715,epoch time: 0:22:45.150945,used: 4:44:06.381337,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_02_09_59_seed_2_23857235
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.92319566, 'precision': 0.92374074, 'recall': 0.92319936, 'specificity': 0.92319936, 'f1': 0.9231714, 'auroc': 0.9740857, 'binary_precision': 0.9389897, 'binary_recall': 0.9052404, 'binary_specificity': 0.9411583, 'binary_f1_score': 0.9218062}
confusion matrix:
       0      1
0  27431   1715
1   2763  26395
---- Validation: 
scalar performance:
{'acc': 0.85559046, 'precision': 0.56515527, 'recall': 0.7776422, 'specificity': 0.7776422, 'f1': 0.5779772, 'auroc': 0.85623384, 'binary_precision': 0.14193548, 'binary_recall': 0.69435215, 'binary_specificity': 0.86093223, 'binary_f1_score': 0.23569214}
confusion matrix:
       0     1
0  15644  2527
1    184   418
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81086713, 'precision': 0.56936365, 'recall': 0.81239414, 'specificity': 0.81239414, 'f1': 0.5710502, 'auroc': 0.89170617, 'binary_precision': 0.1478979, 'binary_recall': 0.8140496, 'binary_specificity': 0.8107387, 'binary_f1_score': 0.25031766}
confusion matrix:
      0     1
0  4862  1135
1    45   197
early stop counter: 2
val acc:0.8555904626846313, best validation acc: 0.8686411380767822, corresponding to test acc:                         0.8275364637374878 / 0.8275364637374878
after epoch: 16,now: 2024-08-01 07:15:34.128427,epoch time: 0:21:28.032712,used: 5:05:34.414049,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_02_09_59_seed_2_23857235
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.92379594, 'precision': 0.9242252, 'recall': 0.92379814, 'specificity': 0.92379814, 'f1': 0.923777, 'auroc': 0.97530466, 'binary_precision': 0.93775463, 'binary_recall': 0.9078749, 'binary_specificity': 0.9397214, 'binary_f1_score': 0.922573}
confusion matrix:
       0      1
0  27391   1757
1   2686  26470
---- Validation: 
scalar performance:
{'acc': 0.85777444, 'precision': 0.5658651, 'recall': 0.7771643, 'specificity': 0.7771643, 'f1': 0.5795753, 'auroc': 0.8567096, 'binary_precision': 0.14344828, 'binary_recall': 0.6910299, 'binary_specificity': 0.86329865, 'binary_f1_score': 0.23757851}
confusion matrix:
       0     1
0  15687  2484
1    186   416
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.816477, 'precision': 0.5702851, 'recall': 0.8093641, 'specificity': 0.8093641, 'f1': 0.57424223, 'auroc': 0.89285624, 'binary_precision': 0.1502711, 'binary_recall': 0.8016529, 'binary_specificity': 0.8170752, 'binary_f1_score': 0.2530985}
confusion matrix:
      0     1
0  4900  1097
1    48   194
early stop counter: 3
val acc:0.8577744364738464, best validation acc: 0.8686411380767822, corresponding to test acc:                         0.8275364637374878 / 0.8275364637374878
after epoch: 17,now: 2024-08-01 07:34:55.279641,epoch time: 0:19:21.151214,used: 5:24:55.565263,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_02_09_59_seed_2_23857235
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.92470497, 'precision': 0.92538726, 'recall': 0.9247091, 'specificity': 0.9247091, 'f1': 0.9246752, 'auroc': 0.9764359, 'binary_precision': 0.9424753, 'binary_recall': 0.90465736, 'binary_specificity': 0.94476086, 'binary_f1_score': 0.9231792}
confusion matrix:
       0      1
0  27536   1610
1   2780  26378
---- Validation: 
scalar performance:
{'acc': 0.870399, 'precision': 0.57040805, 'recall': 0.77404904, 'specificity': 0.77404904, 'f1': 0.58919156, 'auroc': 0.85737884, 'binary_precision': 0.15308829, 'binary_recall': 0.6710963, 'binary_specificity': 0.8770018, 'binary_f1_score': 0.24930577}
confusion matrix:
       0     1
0  15936  2235
1    198   404
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83587116, 'precision': 0.57740474, 'recall': 0.8154869, 'specificity': 0.8154869, 'f1': 0.5901125, 'auroc': 0.8943659, 'binary_precision': 0.16466552, 'binary_recall': 0.7933884, 'binary_specificity': 0.83758545, 'binary_f1_score': 0.27272725}
confusion matrix:
      0    1
0  5023  974
1    50  192
new oracle model saved
better model found
persisted
after epoch: 18,now: 2024-08-01 07:53:56.044337,epoch time: 0:19:00.764696,used: 5:43:56.329959,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_02_09_59_seed_2_23857235
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9259399, 'precision': 0.9264599, 'recall': 0.9259429, 'specificity': 0.9259429, 'f1': 0.9259177, 'auroc': 0.97713494, 'binary_precision': 0.9413939, 'binary_recall': 0.9084611, 'binary_specificity': 0.9434247, 'binary_f1_score': 0.92463434}
confusion matrix:
       0      1
0  27498   1649
1   2669  26488
---- Validation: 
scalar performance:
{'acc': 0.8600117, 'precision': 0.56708926, 'recall': 0.779123, 'specificity': 0.779123, 'f1': 0.5818988, 'auroc': 0.8581322, 'binary_precision': 0.1458042, 'binary_recall': 0.692691, 'binary_specificity': 0.865555, 'binary_f1_score': 0.24090122}
confusion matrix:
       0     1
0  15728  2443
1    185   417
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82401025, 'precision': 0.5735438, 'recall': 0.8152654, 'specificity': 0.8152654, 'f1': 0.5810939, 'auroc': 0.89599824, 'binary_precision': 0.1565008, 'binary_recall': 0.8057851, 'binary_specificity': 0.8247457, 'binary_f1_score': 0.2620968}
confusion matrix:
      0     1
0  4946  1051
1    47   195
early stop counter: 1
val acc:0.8600116968154907, best validation acc: 0.870398998260498, corresponding to test acc:                         0.835871160030365 / 0.835871160030365
after epoch: 19,now: 2024-08-01 08:13:00.702235,epoch time: 0:19:04.657898,used: 6:03:00.987857,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_02_09_59_seed_2_23857235
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9274492, 'precision': 0.9278805, 'recall': 0.9274525, 'specificity': 0.9274525, 'f1': 0.92743134, 'auroc': 0.9780047, 'binary_precision': 0.9415161, 'binary_recall': 0.9115509, 'binary_specificity': 0.9433541, 'binary_f1_score': 0.9262912}
confusion matrix:
       0      1
0  27495   1651
1   2579  26579
---- Validation: 
scalar performance:
{'acc': 0.8514356, 'precision': 0.56449586, 'recall': 0.7819203, 'specificity': 0.7819203, 'f1': 0.5758712, 'auroc': 0.86026937, 'binary_precision': 0.1401777, 'binary_recall': 0.7076412, 'binary_specificity': 0.85619944, 'binary_f1_score': 0.23400167}
confusion matrix:
       0     1
0  15558  2613
1    176   426
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80958486, 'precision': 0.5703635, 'recall': 0.8196581, 'specificity': 0.8196581, 'f1': 0.5718596, 'auroc': 0.8975301, 'binary_precision': 0.1491098, 'binary_recall': 0.8305785, 'binary_specificity': 0.8087377, 'binary_f1_score': 0.25283018}
confusion matrix:
      0     1
0  4850  1147
1    41   201
early stop counter: 2
val acc:0.8514356017112732, best validation acc: 0.870398998260498, corresponding to test acc:                         0.835871160030365 / 0.835871160030365
after epoch: 20,now: 2024-08-01 08:31:44.779862,epoch time: 0:18:44.077627,used: 6:21:45.065484,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_02_09_59_seed_2_23857235
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 6:21:45.065484 at 2024-08-01 08:31:44.779862
persisted model performance metric: 

scalar performance:
{'acc': 0.83587116, 'precision': 0.57740474, 'recall': 0.8154869, 'specificity': 0.8154869, 'f1': 0.5901125, 'auroc': 0.8943659, 'binary_precision': 0.16466552, 'binary_recall': 0.7933884, 'binary_specificity': 0.83758545, 'binary_f1_score': 0.27272725}
confusion matrix:
      0    1
0  5023  974
1    50  192
oracle model performance metric: 

scalar performance:
{'acc': 0.83587116, 'precision': 0.57740474, 'recall': 0.8154869, 'specificity': 0.8154869, 'f1': 0.5901125, 'auroc': 0.8943659, 'binary_precision': 0.16466552, 'binary_recall': 0.7933884, 'binary_specificity': 0.83758545, 'binary_f1_score': 0.27272725}
confusion matrix:
      0    1
0  5023  974
1    50  192
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_12-46-56/rule_results/17.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_12-46-56/confusion_matrix/17.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 190965 KiB | 461507 KiB |   1040 TiB |   1040 TiB |
|       from large pool | 173494 KiB | 427880 KiB |   1018 TiB |   1018 TiB |
|       from small pool |  17471 KiB |  38507 KiB |     21 TiB |     21 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 190965 KiB | 461507 KiB |   1040 TiB |   1040 TiB |
|       from large pool | 173494 KiB | 427880 KiB |   1018 TiB |   1018 TiB |
|       from small pool |  17471 KiB |  38507 KiB |     21 TiB |     21 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 189282 KiB | 457564 KiB |   1040 TiB |   1040 TiB |
|       from large pool | 172814 KiB | 424940 KiB |   1018 TiB |   1018 TiB |
|       from small pool |  16468 KiB |  37503 KiB |     21 TiB |     21 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 526336 KiB | 526336 KiB |   1074 MiB | 573440 KiB |
|       from large pool | 487424 KiB | 487424 KiB |   1008 MiB | 544768 KiB |
|       from small pool |  38912 KiB |  43008 KiB |     66 MiB |  28672 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  40458 KiB |  87761 KiB | 584884 GiB | 584884 GiB |
|       from large pool |  31306 KiB |  79704 KiB | 562794 GiB | 562794 GiB |
|       from small pool |   9152 KiB |  21236 KiB |  22089 GiB |  22089 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2954    |    7771    |  246078 K  |  246075 K  |
|       from large pool |      76    |     158    |  102832 K  |  102832 K  |
|       from small pool |    2878    |    7693    |  143246 K  |  143243 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2954    |    7771    |  246078 K  |  246075 K  |
|       from large pool |      76    |     158    |  102832 K  |  102832 K  |
|       from small pool |    2878    |    7693    |  143246 K  |  143243 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      41    |      42    |      78    |      37    |
|       from large pool |      22    |      22    |      45    |      23    |
|       from small pool |      19    |      21    |      33    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      31    |    3665    |  130231 K  |  130231 K  |
|       from large pool |      10    |      23    |   61653 K  |   61653 K  |
|       from small pool |      21    |    3655    |   68578 K  |   68578 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 461507 KiB |   1040 TiB |   1040 TiB |
|       from large pool |  17088 KiB | 427880 KiB |   1018 TiB |   1018 TiB |
|       from small pool |      0 KiB |  38507 KiB |     21 TiB |     21 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 461507 KiB |   1040 TiB |   1040 TiB |
|       from large pool |  17088 KiB | 427880 KiB |   1018 TiB |   1018 TiB |
|       from small pool |      0 KiB |  38507 KiB |     21 TiB |     21 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457564 KiB |   1040 TiB |   1040 TiB |
|       from large pool |  16640 KiB | 424940 KiB |   1018 TiB |   1018 TiB |
|       from small pool |      0 KiB |  37503 KiB |     21 TiB |     21 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 231424 KiB | 526336 KiB |   1074 MiB |    848 MiB |
|       from large pool | 204800 KiB | 487424 KiB |   1008 MiB |    808 MiB |
|       from small pool |  26624 KiB |  43008 KiB |     66 MiB |     40 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  87761 KiB | 584884 GiB | 584884 GiB |
|       from large pool |  23872 KiB |  79704 KiB | 562794 GiB | 562794 GiB |
|       from small pool |      0 KiB |  21236 KiB |  22089 GiB |  22089 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7771    |  246078 K  |  246078 K  |
|       from large pool |       2    |     158    |  102832 K  |  102832 K  |
|       from small pool |       0    |    7693    |  143246 K  |  143246 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7771    |  246078 K  |  246078 K  |
|       from large pool |       2    |     158    |  102832 K  |  102832 K  |
|       from small pool |       0    |    7693    |  143246 K  |  143246 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |      42    |      78    |      55    |
|       from large pool |      10    |      22    |      45    |      35    |
|       from small pool |      13    |      21    |      33    |      20    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3665    |  130233 K  |  130233 K  |
|       from large pool |       3    |      23    |   61653 K  |   61653 K  |
|       from small pool |       0    |    3655    |   68580 K  |   68580 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Thu Aug  1 08:33:12 2024]
Finished job 0.
1 of 1 steps (100%) done
