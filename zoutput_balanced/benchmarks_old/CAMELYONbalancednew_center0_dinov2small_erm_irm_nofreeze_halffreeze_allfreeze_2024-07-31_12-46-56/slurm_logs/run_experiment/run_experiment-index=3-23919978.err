Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Thu Aug  1 05:36:56 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_12-46-56/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_12-46-56/rule_results/3.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=3
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_05_44_56_seed_0_23919978

 Experiment start at: 2024-08-01 05:44:57.167709
before training, model accuracy: 0.7297859191894531
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.98690724, 'precision': 0.98700535, 'recall': 0.9869133, 'specificity': 0.9869133, 'f1': 0.98690665, 'auroc': 0.9990927, 'binary_precision': 0.99413115, 'binary_recall': 0.97961956, 'binary_specificity': 0.99420714, 'binary_f1_score': 0.986822}
confusion matrix:
       0      1
0  28490    166
1    585  28119
---- Validation: 
scalar performance:
{'acc': 0.9371009, 'precision': 0.6550966, 'recall': 0.8436771, 'specificity': 0.8436771, 'f1': 0.7069002, 'auroc': 0.9252708, 'binary_precision': 0.31973243, 'binary_recall': 0.7433904, 'binary_specificity': 0.9439638, 'binary_f1_score': 0.44714686}
confusion matrix:
       0     1
0  17132  1017
1    165   478
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9496644, 'precision': 0.713697, 'recall': 0.8509705, 'specificity': 0.8509705, 'f1': 0.7626274, 'auroc': 0.93546134, 'binary_precision': 0.43891403, 'binary_recall': 0.743295, 'binary_specificity': 0.958646, 'binary_f1_score': 0.55192035}
confusion matrix:
      0    1
0  5749  248
1    67  194
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-01 06:05:30.690302,epoch time: 0:20:33.522593,used: 0:20:33.522593,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_05_44_56_seed_0_23919978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.98572177, 'precision': 0.98575175, 'recall': 0.98571885, 'specificity': 0.98571885, 'f1': 0.98572147, 'auroc': 0.9989716, 'binary_precision': 0.9821212, 'binary_recall': 0.9894781, 'binary_specificity': 0.98195964, 'binary_f1_score': 0.98578596}
confusion matrix:
       0      1
0  28141    517
1    302  28400
---- Validation: 
scalar performance:
{'acc': 0.8738293, 'precision': 0.59816504, 'recall': 0.885926, 'specificity': 0.885926, 'f1': 0.6290693, 'auroc': 0.9367959, 'binary_precision': 0.20041609, 'binary_recall': 0.89891136, 'binary_specificity': 0.87294066, 'binary_f1_score': 0.3277573}
confusion matrix:
       0     1
0  15843  2306
1     65   578
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8702461, 'precision': 0.6104305, 'recall': 0.8736648, 'specificity': 0.8736648, 'f1': 0.6442132, 'auroc': 0.9426508, 'binary_precision': 0.22695738, 'binary_recall': 0.8773946, 'binary_specificity': 0.869935, 'binary_f1_score': 0.36062992}
confusion matrix:
      0    1
0  5217  780
1    32  229
early stop counter: 1
val acc:0.8738293051719666, best validation acc: 0.937100887298584, corresponding to test acc:                         0.9496644139289856 / 0.9496644139289856
after epoch: 2,now: 2024-08-01 06:25:06.971694,epoch time: 0:19:36.281392,used: 0:40:09.803985,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_05_44_56_seed_0_23919978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9908473, 'precision': 0.9908507, 'recall': 0.9908484, 'specificity': 0.9908484, 'f1': 0.99084723, 'auroc': 0.99945486, 'binary_precision': 0.99234664, 'binary_recall': 0.9893387, 'binary_specificity': 0.99235815, 'binary_f1_score': 0.9908404}
confusion matrix:
       0      1
0  28439    219
1    306  28396
---- Validation: 
scalar performance:
{'acc': 0.93992126, 'precision': 0.66242266, 'recall': 0.85263777, 'specificity': 0.85263777, 'f1': 0.7159181, 'auroc': 0.91918486, 'binary_precision': 0.33378932, 'binary_recall': 0.7589425, 'binary_specificity': 0.9463331, 'binary_f1_score': 0.46365795}
confusion matrix:
       0    1
0  17175  974
1    155  488
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.7541409, 'recall': 0.8804604, 'specificity': 0.8804604, 'f1': 0.8027443, 'auroc': 0.9470687, 'binary_precision': 0.5175, 'binary_recall': 0.79310346, 'binary_specificity': 0.96781725, 'binary_f1_score': 0.62632376}
confusion matrix:
      0    1
0  5804  193
1    54  207
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-01 06:44:44.440452,epoch time: 0:19:37.468758,used: 0:59:47.272743,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_05_44_56_seed_0_23919978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9895746, 'precision': 0.98965746, 'recall': 0.98957974, 'specificity': 0.98957974, 'f1': 0.98957425, 'auroc': 0.998948, 'binary_precision': 0.9962215, 'binary_recall': 0.98289317, 'binary_specificity': 0.9962663, 'binary_f1_score': 0.98951244}
confusion matrix:
       0      1
0  28551    107
1    491  28211
---- Validation: 
scalar performance:
{'acc': 0.9002767, 'precision': 0.6068161, 'recall': 0.83661354, 'specificity': 0.83661354, 'f1': 0.64562076, 'auroc': 0.8943199, 'binary_precision': 0.2226228, 'binary_recall': 0.7682737, 'binary_specificity': 0.9049534, 'binary_f1_score': 0.34521312}
confusion matrix:
       0     1
0  16424  1725
1    149   494
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95158195, 'precision': 0.7226896, 'recall': 0.87945604, 'specificity': 0.87945604, 'f1': 0.77703077, 'auroc': 0.9413066, 'binary_precision': 0.45434782, 'binary_recall': 0.8007663, 'binary_specificity': 0.95814574, 'binary_f1_score': 0.57975036}
confusion matrix:
      0    1
0  5746  251
1    52  209
early stop counter: 1
val acc:0.9002767205238342, best validation acc: 0.9399212598800659, corresponding to test acc:                         0.9605305194854736 / 0.9605305194854736
after epoch: 4,now: 2024-08-01 07:04:28.862308,epoch time: 0:19:44.421856,used: 1:19:31.694599,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_05_44_56_seed_0_23919978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9821827, 'precision': 0.9825874, 'recall': 0.9821717, 'specificity': 0.9821717, 'f1': 0.9821787, 'auroc': 0.99950296, 'binary_precision': 0.9688029, 'binary_recall': 0.99648106, 'binary_specificity': 0.96786237, 'binary_f1_score': 0.9824471}
confusion matrix:
       0      1
0  27737    921
1    101  28601
---- Validation: 
scalar performance:
{'acc': 0.8621222, 'precision': 0.59209174, 'recall': 0.8858655, 'specificity': 0.8858655, 'f1': 0.6174222, 'auroc': 0.9386818, 'binary_precision': 0.18782051, 'binary_recall': 0.91135305, 'binary_specificity': 0.86037797, 'binary_f1_score': 0.31145364}
confusion matrix:
       0     1
0  15615  2534
1     57   586
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86001915, 'precision': 0.6021676, 'recall': 0.86099946, 'specificity': 0.86099946, 'f1': 0.63054115, 'auroc': 0.9360293, 'binary_precision': 0.2112676, 'binary_recall': 0.86206895, 'binary_specificity': 0.85993, 'binary_f1_score': 0.3393665}
confusion matrix:
      0    1
0  5157  840
1    36  225
early stop counter: 2
val acc:0.8621221780776978, best validation acc: 0.9399212598800659, corresponding to test acc:                         0.9605305194854736 / 0.9605305194854736
after epoch: 5,now: 2024-08-01 07:24:09.449454,epoch time: 0:19:40.587146,used: 1:39:12.281745,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_05_44_56_seed_0_23919978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.99330544, 'precision': 0.99333394, 'recall': 0.9933088, 'specificity': 0.9933088, 'f1': 0.9933053, 'auroc': 0.99954396, 'binary_precision': 0.9972958, 'binary_recall': 0.9893046, 'binary_specificity': 0.99731296, 'binary_f1_score': 0.9932841}
confusion matrix:
       0      1
0  28579     77
1    307  28397
---- Validation: 
scalar performance:
{'acc': 0.9266177, 'precision': 0.64292765, 'recall': 0.87050223, 'specificity': 0.87050223, 'f1': 0.6955917, 'auroc': 0.9338928, 'binary_precision': 0.29302588, 'binary_recall': 0.8102644, 'binary_specificity': 0.93074, 'binary_f1_score': 0.43040067}
confusion matrix:
       0     1
0  16892  1257
1    122   521
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9495046, 'precision': 0.71386766, 'recall': 0.85638416, 'specificity': 0.85638416, 'f1': 0.7640817, 'auroc': 0.9439043, 'binary_precision': 0.43875277, 'binary_recall': 0.7547893, 'binary_specificity': 0.95797896, 'binary_f1_score': 0.55492955}
confusion matrix:
      0    1
0  5745  252
1    64  197
early stop counter: 3
val acc:0.9266176819801331, best validation acc: 0.9399212598800659, corresponding to test acc:                         0.9605305194854736 / 0.9605305194854736
after epoch: 6,now: 2024-08-01 07:43:41.757892,epoch time: 0:19:32.308438,used: 1:58:44.590183,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_05_44_56_seed_0_23919978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98675036, 'precision': 0.9869059, 'recall': 0.98674357, 'specificity': 0.98674357, 'f1': 0.98674905, 'auroc': 0.9993911, 'binary_precision': 0.9783934, 'binary_recall': 0.9955055, 'binary_specificity': 0.9779817, 'binary_f1_score': 0.98687524}
confusion matrix:
       0      1
0  28027    631
1    129  28573
---- Validation: 
scalar performance:
{'acc': 0.9211367, 'precision': 0.6410178, 'recall': 0.89991695, 'specificity': 0.89991695, 'f1': 0.6949048, 'auroc': 0.94868255, 'binary_precision': 0.28673106, 'binary_recall': 0.87713844, 'binary_specificity': 0.92269546, 'binary_f1_score': 0.43218392}
confusion matrix:
       0     1
0  16746  1403
1     79   564
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9613295, 'precision': 0.75735474, 'recall': 0.8753802, 'specificity': 0.8753802, 'f1': 0.80364895, 'auroc': 0.9586406, 'binary_precision': 0.5244216, 'binary_recall': 0.7816092, 'binary_specificity': 0.96915126, 'binary_f1_score': 0.6276923}
confusion matrix:
      0    1
0  5812  185
1    57  204
new oracle model saved
early stop counter: 4
val acc:0.9211366772651672, best validation acc: 0.9399212598800659, corresponding to test acc:                         0.9605305194854736 / 0.9613295197486877
after epoch: 7,now: 2024-08-01 08:03:14.450128,epoch time: 0:19:32.692236,used: 2:18:17.282419,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_05_44_56_seed_0_23919978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98575664, 'precision': 0.9860201, 'recall': 0.9857661, 'specificity': 0.9857661, 'f1': 0.98575485, 'auroc': 0.9990443, 'binary_precision': 0.99753785, 'binary_recall': 0.97394, 'binary_specificity': 0.9975922, 'binary_f1_score': 0.98559767}
confusion matrix:
       0      1
0  28588     69
1    748  27955
---- Validation: 
scalar performance:
{'acc': 0.96392083, 'precision': 0.7283811, 'recall': 0.7420536, 'specificity': 0.7420536, 'f1': 0.73499423, 'auroc': 0.94952726, 'binary_precision': 0.47437775, 'binary_recall': 0.503888, 'binary_specificity': 0.9802193, 'binary_f1_score': 0.48868778}
confusion matrix:
       0    1
0  17790  359
1    319  324
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.98178333, 'precision': 0.9367826, 'recall': 0.8200882, 'specificity': 0.8200882, 'f1': 0.8686093, 'auroc': 0.9563155, 'binary_precision': 0.8888889, 'binary_recall': 0.6436782, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.7466667}
confusion matrix:
      0    1
0  5976   21
1    93  168
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-08-01 08:22:41.450679,epoch time: 0:19:27.000551,used: 2:37:44.282970,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_05_44_56_seed_0_23919978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98779637, 'precision': 0.98781693, 'recall': 0.98779875, 'specificity': 0.98779875, 'f1': 0.98779625, 'auroc': 0.99930036, 'binary_precision': 0.99115914, 'binary_recall': 0.98439026, 'binary_specificity': 0.99120724, 'binary_f1_score': 0.98776305}
confusion matrix:
       0      1
0  28408    252
1    448  28252
---- Validation: 
scalar performance:
{'acc': 0.95843977, 'precision': 0.71911573, 'recall': 0.9049783, 'specificity': 0.9049783, 'f1': 0.78035367, 'auroc': 0.9606845, 'binary_precision': 0.4438111, 'binary_recall': 0.84758943, 'binary_specificity': 0.96236706, 'binary_f1_score': 0.58257616}
confusion matrix:
       0    1
0  17466  683
1     98  545
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9795462, 'precision': 0.863056, 'recall': 0.8922143, 'specificity': 0.8922143, 'f1': 0.8770071, 'auroc': 0.97146654, 'binary_precision': 0.7349823, 'binary_recall': 0.79693484, 'binary_specificity': 0.98749375, 'binary_f1_score': 0.7647059}
confusion matrix:
      0    1
0  5922   75
1    53  208
early stop counter: 1
val acc:0.9584397673606873, best validation acc: 0.9639208316802979, corresponding to test acc:                         0.9817833304405212 / 0.9817833304405212
after epoch: 9,now: 2024-08-01 08:42:15.363598,epoch time: 0:19:33.912919,used: 2:57:18.195889,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_05_44_56_seed_0_23919978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99475247, 'precision': 0.9947564, 'recall': 0.9947535, 'specificity': 0.9947535, 'f1': 0.9947524, 'auroc': 0.9997623, 'binary_precision': 0.9963297, 'binary_recall': 0.9931705, 'binary_specificity': 0.99633646, 'binary_f1_score': 0.9947476}
confusion matrix:
       0      1
0  28556    105
1    196  28503
---- Validation: 
scalar performance:
{'acc': 0.9072478, 'precision': 0.62133324, 'recall': 0.87772536, 'specificity': 0.87772536, 'f1': 0.66708124, 'auroc': 0.93861914, 'binary_precision': 0.24862888, 'binary_recall': 0.8460342, 'binary_specificity': 0.9094165, 'binary_f1_score': 0.38431647}
confusion matrix:
       0     1
0  16505  1644
1     99   544
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8946948, 'precision': 0.6240612, 'recall': 0.8534392, 'specificity': 0.8534392, 'f1': 0.6663746, 'auroc': 0.93269944, 'binary_precision': 0.25731707, 'binary_recall': 0.8084291, 'binary_specificity': 0.89844924, 'binary_f1_score': 0.39037928}
confusion matrix:
      0    1
0  5388  609
1    50  211
early stop counter: 2
val acc:0.90724778175354, best validation acc: 0.9639208316802979, corresponding to test acc:                         0.9817833304405212 / 0.9817833304405212
after epoch: 10,now: 2024-08-01 09:01:53.355840,epoch time: 0:19:37.992242,used: 3:16:56.188131,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_05_44_56_seed_0_23919978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99595535, 'precision': 0.9959732, 'recall': 0.995958, 'specificity': 0.995958, 'f1': 0.99595535, 'auroc': 0.9998255, 'binary_precision': 0.99915844, 'binary_recall': 0.9927534, 'binary_specificity': 0.9991625, 'binary_f1_score': 0.9959456}
confusion matrix:
       0      1
0  28633     24
1    208  28495
---- Validation: 
scalar performance:
{'acc': 0.9598233, 'precision': 0.72048235, 'recall': 0.8689418, 'specificity': 0.8689418, 'f1': 0.7733815, 'auroc': 0.9602987, 'binary_precision': 0.44927537, 'binary_recall': 0.7713841, 'binary_specificity': 0.9664995, 'binary_f1_score': 0.56783056}
confusion matrix:
       0    1
0  17541  608
1    147  496
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9755513, 'precision': 0.84398794, 'recall': 0.85531557, 'specificity': 0.85531557, 'f1': 0.8495492, 'auroc': 0.9593245, 'binary_precision': 0.7, 'binary_recall': 0.7241379, 'binary_specificity': 0.98649323, 'binary_f1_score': 0.71186435}
confusion matrix:
      0    1
0  5916   81
1    72  189
early stop counter: 3
val acc:0.9598233103752136, best validation acc: 0.9639208316802979, corresponding to test acc:                         0.9817833304405212 / 0.9817833304405212
after epoch: 11,now: 2024-08-01 09:21:35.064062,epoch time: 0:19:41.708222,used: 3:36:37.896353,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_05_44_56_seed_0_23919978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9968096, 'precision': 0.9968126, 'recall': 0.99681085, 'specificity': 0.99681085, 'f1': 0.9968096, 'auroc': 0.9998984, 'binary_precision': 0.99825305, 'binary_recall': 0.9953665, 'binary_specificity': 0.9982552, 'binary_f1_score': 0.9968077}
confusion matrix:
       0      1
0  28606     50
1    133  28571
---- Validation: 
scalar performance:
{'acc': 0.9657301, 'precision': 0.7422674, 'recall': 0.7819932, 'specificity': 0.7819932, 'f1': 0.760443, 'auroc': 0.95316255, 'binary_precision': 0.499336, 'binary_recall': 0.58475894, 'binary_specificity': 0.9792275, 'binary_f1_score': 0.5386819}
confusion matrix:
       0    1
0  17772  377
1    267  376
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614893, 'precision': 0.82802624, 'recall': 0.5676315, 'specificity': 0.5676315, 'f1': 0.60514134, 'auroc': 0.9525337, 'binary_precision': 0.6923077, 'binary_recall': 0.13793103, 'binary_specificity': 0.997332, 'binary_f1_score': 0.23003194}
confusion matrix:
      0   1
0  5981  16
1   225  36
better model found
persisted
after epoch: 12,now: 2024-08-01 09:41:36.180408,epoch time: 0:20:01.116346,used: 3:56:39.012699,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_05_44_56_seed_0_23919978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9909519, 'precision': 0.9909626, 'recall': 0.99095374, 'specificity': 0.99095374, 'f1': 0.9909519, 'auroc': 0.99932873, 'binary_precision': 0.9934515, 'binary_recall': 0.98843247, 'binary_specificity': 0.993475, 'binary_f1_score': 0.9909356}
confusion matrix:
       0      1
0  28472    187
1    332  28369
---- Validation: 
scalar performance:
{'acc': 0.951788, 'precision': 0.65216535, 'recall': 0.6780181, 'specificity': 0.6780181, 'f1': 0.66390926, 'auroc': 0.8881975, 'binary_precision': 0.32628798, 'binary_recall': 0.38413686, 'binary_specificity': 0.9718993, 'binary_f1_score': 0.35285714}
confusion matrix:
       0    1
0  17639  510
1    396  247
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9485459, 'precision': 0.56615126, 'recall': 0.5242315, 'specificity': 0.5242315, 'f1': 0.5319598, 'auroc': 0.85878253, 'binary_precision': 0.17204301, 'binary_recall': 0.06130268, 'binary_specificity': 0.98716027, 'binary_f1_score': 0.09039547}
confusion matrix:
      0   1
0  5920  77
1   245  16
early stop counter: 1
val acc:0.9517880082130432, best validation acc: 0.9657300710678101, corresponding to test acc:                         0.9614893198013306 / 0.9817833304405212
after epoch: 13,now: 2024-08-01 10:01:17.313731,epoch time: 0:19:41.133323,used: 4:16:20.146022,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_05_44_56_seed_0_23919978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99215484, 'precision': 0.99218154, 'recall': 0.99215186, 'specificity': 0.99215186, 'f1': 0.9921547, 'auroc': 0.99968976, 'binary_precision': 0.9887559, 'binary_recall': 0.9956452, 'binary_specificity': 0.98865855, 'binary_f1_score': 0.99218863}
confusion matrix:
       0      1
0  28331    325
1    125  28579
---- Validation: 
scalar performance:
{'acc': 0.9415709, 'precision': 0.66837275, 'recall': 0.86624277, 'specificity': 0.86624277, 'f1': 0.7240883, 'auroc': 0.94951093, 'binary_precision': 0.3447099, 'binary_recall': 0.785381, 'binary_specificity': 0.9471045, 'binary_f1_score': 0.47912714}
confusion matrix:
       0    1
0  17189  960
1    138  505
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9745925, 'precision': 0.83521664, 'recall': 0.85848, 'specificity': 0.85848, 'f1': 0.8464111, 'auroc': 0.97278523, 'binary_precision': 0.68214285, 'binary_recall': 0.7318008, 'binary_specificity': 0.9851592, 'binary_f1_score': 0.7060998}
confusion matrix:
      0    1
0  5908   89
1    70  191
early stop counter: 2
val acc:0.9415708780288696, best validation acc: 0.9657300710678101, corresponding to test acc:                         0.9614893198013306 / 0.9817833304405212
after epoch: 14,now: 2024-08-01 10:21:32.372470,epoch time: 0:20:15.058739,used: 4:36:35.204761,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_05_44_56_seed_0_23919978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9951534, 'precision': 0.9951856, 'recall': 0.9951571, 'specificity': 0.9951571, 'f1': 0.99515337, 'auroc': 0.99978805, 'binary_precision': 0.9994027, 'binary_recall': 0.9909075, 'binary_specificity': 0.99940675, 'binary_f1_score': 0.995137}
confusion matrix:
       0      1
0  28638     17
1    261  28444
---- Validation: 
scalar performance:
{'acc': 0.9732865, 'precision': 0.7929165, 'recall': 0.8279084, 'specificity': 0.8279084, 'f1': 0.8093216, 'auroc': 0.96158457, 'binary_precision': 0.5975104, 'binary_recall': 0.6718507, 'binary_specificity': 0.98396605, 'binary_f1_score': 0.6325037}
confusion matrix:
       0    1
0  17858  291
1    211  432
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9704378, 'precision': 0.85043097, 'recall': 0.73171353, 'specificity': 0.73171353, 'f1': 0.7777287, 'auroc': 0.9623103, 'binary_precision': 0.7235294, 'binary_recall': 0.47126436, 'binary_specificity': 0.99216276, 'binary_f1_score': 0.5707657}
confusion matrix:
      0    1
0  5950   47
1   138  123
better model found
persisted
after epoch: 15,now: 2024-08-01 10:41:56.577730,epoch time: 0:20:24.205260,used: 4:56:59.410021,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_05_44_56_seed_0_23919978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9963389, 'precision': 0.99633896, 'recall': 0.99633884, 'specificity': 0.99633884, 'f1': 0.99633896, 'auroc': 0.9998392, 'binary_precision': 0.9963068, 'binary_recall': 0.99637616, 'binary_specificity': 0.9963016, 'binary_f1_score': 0.99634147}
confusion matrix:
       0      1
0  28555    106
1    104  28595
---- Validation: 
scalar performance:
{'acc': 0.9656237, 'precision': 0.74125016, 'recall': 0.7729375, 'specificity': 0.7729375, 'f1': 0.75599974, 'auroc': 0.9391778, 'binary_precision': 0.49794802, 'binary_recall': 0.5660964, 'binary_specificity': 0.9797785, 'binary_f1_score': 0.5298399}
confusion matrix:
       0    1
0  17782  367
1    279  364
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9683605, 'precision': 0.8273896, 'recall': 0.7251327, 'specificity': 0.7251327, 'f1': 0.7657759, 'auroc': 0.9561832, 'binary_precision': 0.6779661, 'binary_recall': 0.4597701, 'binary_specificity': 0.99049526, 'binary_f1_score': 0.54794526}
confusion matrix:
      0    1
0  5940   57
1   141  120
early stop counter: 1
val acc:0.965623676776886, best validation acc: 0.973286509513855, corresponding to test acc:                         0.9704378247261047 / 0.9817833304405212
after epoch: 16,now: 2024-08-01 11:03:57.800454,epoch time: 0:22:01.222724,used: 5:19:00.632745,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_05_44_56_seed_0_23919978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99651325, 'precision': 0.99652505, 'recall': 0.99651504, 'specificity': 0.99651504, 'f1': 0.99651325, 'auroc': 0.99985814, 'binary_precision': 0.99912435, 'binary_recall': 0.99390244, 'binary_specificity': 0.9991277, 'binary_f1_score': 0.99650663}
confusion matrix:
       0      1
0  28635     25
1    175  28525
---- Validation: 
scalar performance:
{'acc': 0.9626437, 'precision': 0.7140106, 'recall': 0.69338894, 'specificity': 0.69338894, 'f1': 0.703113, 'auroc': 0.9388343, 'binary_precision': 0.4490501, 'binary_recall': 0.4043546, 'binary_specificity': 0.98242325, 'binary_f1_score': 0.42553192}
confusion matrix:
       0    1
0  17830  319
1    383  260
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9405561, 'precision': 0.6010367, 'recall': 0.58236206, 'specificity': 0.58236206, 'f1': 0.5904888, 'auroc': 0.9126632, 'binary_precision': 0.23696682, 'binary_recall': 0.19157088, 'binary_specificity': 0.97315323, 'binary_f1_score': 0.2118644}
confusion matrix:
      0    1
0  5836  161
1   211   50
early stop counter: 2
val acc:0.9626436829566956, best validation acc: 0.973286509513855, corresponding to test acc:                         0.9704378247261047 / 0.9817833304405212
after epoch: 17,now: 2024-08-01 11:24:02.720264,epoch time: 0:20:04.919810,used: 5:39:05.552555,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_05_44_56_seed_0_23919978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9957113, 'precision': 0.99571145, 'recall': 0.99571174, 'specificity': 0.99571174, 'f1': 0.9957113, 'auroc': 0.9998667, 'binary_precision': 0.99626803, 'binary_recall': 0.9951573, 'binary_specificity': 0.9962662, 'binary_f1_score': 0.9957124}
confusion matrix:
       0      1
0  28550    107
1    139  28564
---- Validation: 
scalar performance:
{'acc': 0.94481695, 'precision': 0.6739195, 'recall': 0.8566725, 'specificity': 0.8566725, 'f1': 0.72835696, 'auroc': 0.94908476, 'binary_precision': 0.356623, 'binary_recall': 0.7620529, 'binary_specificity': 0.9512921, 'binary_f1_score': 0.4858701}
confusion matrix:
       0    1
0  17265  884
1    153  490
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96276766, 'precision': 0.7740119, 'recall': 0.7038912, 'specificity': 0.7038912, 'f1': 0.733168, 'auroc': 0.9464763, 'binary_precision': 0.5729167, 'binary_recall': 0.42145595, 'binary_specificity': 0.9863265, 'binary_f1_score': 0.48565125}
confusion matrix:
      0    1
0  5915   82
1   151  110
early stop counter: 3
val acc:0.9448169469833374, best validation acc: 0.973286509513855, corresponding to test acc:                         0.9704378247261047 / 0.9817833304405212
after epoch: 18,now: 2024-08-01 11:43:59.639194,epoch time: 0:19:56.918930,used: 5:59:02.471485,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_05_44_56_seed_0_23919978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99492675, 'precision': 0.9949721, 'recall': 0.9949304, 'specificity': 0.9949304, 'f1': 0.9949267, 'auroc': 0.99989843, 'binary_precision': 0.99989444, 'binary_recall': 0.9899655, 'binary_specificity': 0.99989533, 'binary_f1_score': 0.99490523}
confusion matrix:
       0      1
0  28656      3
1    288  28413
---- Validation: 
scalar performance:
{'acc': 0.97020006, 'precision': 0.89646596, 'recall': 0.5817925, 'specificity': 0.5817925, 'f1': 0.62969947, 'auroc': 0.95949566, 'binary_precision': 0.8217054, 'binary_recall': 0.16485226, 'binary_specificity': 0.9987327, 'binary_f1_score': 0.27461138}
confusion matrix:
       0    1
0  18126   23
1    537  106
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9603707, 'precision': 0.9468845, 'recall': 0.52673656, 'specificity': 0.52673656, 'f1': 0.5405939, 'auroc': 0.96680534, 'binary_precision': 0.93333334, 'binary_recall': 0.053639848, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.10144928}
confusion matrix:
      0   1
0  5996   1
1   247  14
early stop counter: 4
val acc:0.9702000617980957, best validation acc: 0.973286509513855, corresponding to test acc:                         0.9704378247261047 / 0.9817833304405212
after epoch: 19,now: 2024-08-01 12:03:47.913460,epoch time: 0:19:48.274266,used: 6:18:50.745751,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_05_44_56_seed_0_23919978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.997106, 'precision': 0.99711585, 'recall': 0.99710804, 'specificity': 0.99710804, 'f1': 0.99710596, 'auroc': 0.99993193, 'binary_precision': 0.99954486, 'binary_recall': 0.99466974, 'binary_specificity': 0.99954635, 'binary_f1_score': 0.99710137}
confusion matrix:
       0      1
0  28643     13
1    153  28551
---- Validation: 
scalar performance:
{'acc': 0.97259474, 'precision': 0.83047533, 'recall': 0.68278956, 'specificity': 0.68278956, 'f1': 0.7336476, 'auroc': 0.9572923, 'binary_precision': 0.68285716, 'binary_recall': 0.3716952, 'binary_specificity': 0.99388397, 'binary_f1_score': 0.4813696}
confusion matrix:
       0    1
0  18038  111
1    404  239
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96356666, 'precision': 0.859807, 'recall': 0.59253573, 'specificity': 0.59253573, 'f1': 0.6409548, 'auroc': 0.97056377, 'binary_precision': 0.75384617, 'binary_recall': 0.18773946, 'binary_specificity': 0.997332, 'binary_f1_score': 0.30061346}
confusion matrix:
      0   1
0  5981  16
1   212  49
early stop counter: 5
val acc:0.9725947380065918, best validation acc: 0.973286509513855, corresponding to test acc:                         0.9704378247261047 / 0.9817833304405212
after epoch: 20,now: 2024-08-01 12:23:22.432957,epoch time: 0:19:34.519497,used: 6:38:25.265248,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_05_44_56_seed_0_23919978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 6:38:25.265248 at 2024-08-01 12:23:22.432957
persisted model performance metric: 

scalar performance:
{'acc': 0.9704378, 'precision': 0.85043097, 'recall': 0.73171353, 'specificity': 0.73171353, 'f1': 0.7777287, 'auroc': 0.9623103, 'binary_precision': 0.7235294, 'binary_recall': 0.47126436, 'binary_specificity': 0.99216276, 'binary_f1_score': 0.5707657}
confusion matrix:
      0    1
0  5950   47
1   138  123
oracle model performance metric: 

scalar performance:
{'acc': 0.98178333, 'precision': 0.9367826, 'recall': 0.8200882, 'specificity': 0.8200882, 'f1': 0.8686093, 'auroc': 0.9563155, 'binary_precision': 0.8888889, 'binary_recall': 0.6436782, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.7466667}
confusion matrix:
      0    1
0  5976   21
1    93  168
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_12-46-56/rule_results/3.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_12-46-56/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_12-46-56/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 458481 KiB |  13220 MiB | 551249 GiB | 551249 GiB |
|       from large pool | 416794 KiB |  13181 MiB | 543639 GiB | 543639 GiB |
|       from small pool |  41687 KiB |     61 MiB |   7610 GiB |   7610 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 458481 KiB |  13220 MiB | 551249 GiB | 551249 GiB |
|       from large pool | 416794 KiB |  13181 MiB | 543639 GiB | 543639 GiB |
|       from small pool |  41687 KiB |     61 MiB |   7610 GiB |   7610 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447754 KiB |  13213 MiB | 550777 GiB | 550777 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 543185 GiB | 543184 GiB |
|       from small pool |  40679 KiB |     60 MiB |   7592 GiB |   7592 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14484 MiB |  14484 MiB |  14484 MiB |      0 B   |
|       from large pool |  14412 MiB |  14412 MiB |  14412 MiB |      0 B   |
|       from small pool |     72 MiB |     72 MiB |     72 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 416014 KiB |   1235 MiB | 439416 GiB | 439415 GiB |
|       from large pool | 406502 KiB |   1232 MiB | 431776 GiB | 431776 GiB |
|       from small pool |   9512 KiB |     15 MiB |   7639 GiB |   7639 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3488    |    8175    |  107516 K  |  107513 K  |
|       from large pool |     187    |    1413    |   50376 K  |   50376 K  |
|       from small pool |    3301    |    7986    |   57140 K  |   57137 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3488    |    8175    |  107516 K  |  107513 K  |
|       from large pool |     187    |    1413    |   50376 K  |   50376 K  |
|       from small pool |    3301    |    7986    |   57140 K  |   57137 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     638    |     638    |     638    |       0    |
|       from large pool |     602    |     602    |     602    |       0    |
|       from small pool |      36    |      36    |      36    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      73    |    3640    |   64574 K  |   64574 K  |
|       from large pool |      30    |     604    |   36795 K  |   36795 K  |
|       from small pool |      43    |    3609    |   27778 K  |   27778 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13220 MiB | 551249 GiB | 551249 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 543639 GiB | 543639 GiB |
|       from small pool |      0 KiB |     61 MiB |   7610 GiB |   7610 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13220 MiB | 551249 GiB | 551249 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 543639 GiB | 543639 GiB |
|       from small pool |      0 KiB |     61 MiB |   7610 GiB |   7610 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 550777 GiB | 550777 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 543185 GiB | 543184 GiB |
|       from small pool |      0 KiB |     60 MiB |   7592 GiB |   7592 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    854 MiB |  14484 MiB |  14484 MiB |  13630 MiB |
|       from large pool |    804 MiB |  14412 MiB |  14412 MiB |  13608 MiB |
|       from small pool |     50 MiB |     72 MiB |     72 MiB |     22 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1235 MiB | 439416 GiB | 439416 GiB |
|       from large pool |  24320 KiB |   1232 MiB | 431777 GiB | 431777 GiB |
|       from small pool |      0 KiB |     38 MiB |   7639 GiB |   7639 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8175    |  107516 K  |  107516 K  |
|       from large pool |       2    |    1413    |   50376 K  |   50376 K  |
|       from small pool |       0    |    7986    |   57140 K  |   57140 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8175    |  107516 K  |  107516 K  |
|       from large pool |       2    |    1413    |   50376 K  |   50376 K  |
|       from small pool |       0    |    7986    |   57140 K  |   57140 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      61    |     638    |     638    |     577    |
|       from large pool |      36    |     602    |     602    |     566    |
|       from small pool |      25    |      36    |      36    |      11    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3640    |   64575 K  |   64575 K  |
|       from large pool |       3    |     604    |   36795 K  |   36795 K  |
|       from small pool |       0    |    3609    |   27779 K  |   27779 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13220 MiB | 551249 GiB | 551249 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 543639 GiB | 543639 GiB |
|       from small pool |      0 KiB |     61 MiB |   7610 GiB |   7610 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13220 MiB | 551249 GiB | 551249 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 543639 GiB | 543639 GiB |
|       from small pool |      0 KiB |     61 MiB |   7610 GiB |   7610 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 550777 GiB | 550777 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 543185 GiB | 543184 GiB |
|       from small pool |      0 KiB |     60 MiB |   7592 GiB |   7592 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    854 MiB |  14484 MiB |  14484 MiB |  13630 MiB |
|       from large pool |    804 MiB |  14412 MiB |  14412 MiB |  13608 MiB |
|       from small pool |     50 MiB |     72 MiB |     72 MiB |     22 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1235 MiB | 439416 GiB | 439416 GiB |
|       from large pool |  24320 KiB |   1232 MiB | 431777 GiB | 431777 GiB |
|       from small pool |      0 KiB |     38 MiB |   7639 GiB |   7639 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8175    |  107516 K  |  107516 K  |
|       from large pool |       2    |    1413    |   50376 K  |   50376 K  |
|       from small pool |       0    |    7986    |   57140 K  |   57140 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8175    |  107516 K  |  107516 K  |
|       from large pool |       2    |    1413    |   50376 K  |   50376 K  |
|       from small pool |       0    |    7986    |   57140 K  |   57140 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      61    |     638    |     638    |     577    |
|       from large pool |      36    |     602    |     602    |     566    |
|       from small pool |      25    |      36    |      36    |      11    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3640    |   64575 K  |   64575 K  |
|       from large pool |       3    |     604    |   36795 K  |   36795 K  |
|       from small pool |       0    |    3609    |   27779 K  |   27779 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_12_31_12_seed_1_23919978

 Experiment start at: 2024-08-01 12:31:12.802431
before training, model accuracy: 0.6474379897117615
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9851083, 'precision': 0.9854202, 'recall': 0.9851172, 'specificity': 0.9851172, 'f1': 0.9851061, 'auroc': 0.9990011, 'binary_precision': 0.9978995, 'binary_recall': 0.9722839, 'binary_specificity': 0.99795055, 'binary_f1_score': 0.98492515}
confusion matrix:
       0      1
0  28729     59
1    799  28029
---- Validation: 
scalar performance:
{'acc': 0.94098186, 'precision': 0.6685179, 'recall': 0.8406436, 'specificity': 0.8406436, 'f1': 0.7200329, 'auroc': 0.9269514, 'binary_precision': 0.34742776, 'binary_recall': 0.73254085, 'binary_specificity': 0.9487463, 'binary_f1_score': 0.4713193}
confusion matrix:
       0    1
0  17141  926
1    180  493
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94875926, 'precision': 0.7096313, 'recall': 0.8353353, 'specificity': 0.8353353, 'f1': 0.7553334, 'auroc': 0.9275067, 'binary_precision': 0.432243, 'binary_recall': 0.71153843, 'binary_specificity': 0.9591322, 'binary_f1_score': 0.53779066}
confusion matrix:
      0    1
0  5703  243
1    75  185
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-01 12:51:31.767152,epoch time: 0:20:18.964721,used: 0:20:18.964721,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_12_31_12_seed_1_23919978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.98889196, 'precision': 0.9888971, 'recall': 0.9888933, 'specificity': 0.9888933, 'f1': 0.98889196, 'auroc': 0.9991868, 'binary_precision': 0.99067014, 'binary_recall': 0.9870963, 'binary_specificity': 0.99069023, 'binary_f1_score': 0.98888}
confusion matrix:
       0      1
0  28519    268
1    372  28457
---- Validation: 
scalar performance:
{'acc': 0.9505336, 'precision': 0.6897285, 'recall': 0.8212783, 'specificity': 0.8212783, 'f1': 0.7357736, 'auroc': 0.9205078, 'binary_precision': 0.39163822, 'binary_recall': 0.6820208, 'binary_specificity': 0.96053576, 'binary_f1_score': 0.49756098}
confusion matrix:
       0    1
0  17354  713
1    214  459
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9550435, 'precision': 0.72541463, 'recall': 0.7705723, 'specificity': 0.7705723, 'f1': 0.7456063, 'auroc': 0.9159317, 'binary_precision': 0.46984127, 'binary_recall': 0.5692308, 'binary_specificity': 0.9719139, 'binary_f1_score': 0.51478267}
confusion matrix:
      0    1
0  5779  167
1   112  148
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-01 13:11:13.420589,epoch time: 0:19:41.653437,used: 0:40:00.618158,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_12_31_12_seed_1_23919978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.99008954, 'precision': 0.99009013, 'recall': 0.9900901, 'specificity': 0.9900901, 'f1': 0.99008954, 'auroc': 0.99915916, 'binary_precision': 0.9908289, 'binary_recall': 0.989351, 'binary_specificity': 0.99082917, 'binary_f1_score': 0.9900894}
confusion matrix:
       0      1
0  28523    264
1    307  28522
---- Validation: 
scalar performance:
{'acc': 0.9448239, 'precision': 0.6830623, 'recall': 0.8733927, 'specificity': 0.8733927, 'f1': 0.7398957, 'auroc': 0.94645584, 'binary_precision': 0.37404048, 'binary_recall': 0.79643387, 'binary_specificity': 0.9503515, 'binary_f1_score': 0.5090219}
confusion matrix:
       0    1
0  17170  897
1    137  536
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97180146, 'precision': 0.81454164, 'recall': 0.8639111, 'specificity': 0.8639111, 'f1': 0.837198, 'auroc': 0.95467544, 'binary_precision': 0.64026403, 'binary_recall': 0.74615383, 'binary_specificity': 0.98166835, 'binary_f1_score': 0.6891652}
confusion matrix:
      0    1
0  5837  109
1    66  194
new oracle model saved
early stop counter: 1
val acc:0.9448239207267761, best validation acc: 0.9505336284637451, corresponding to test acc:                         0.9550434947013855 / 0.9718014597892761
after epoch: 3,now: 2024-08-01 13:31:59.009488,epoch time: 0:20:45.588899,used: 1:00:46.207057,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_12_31_12_seed_1_23919978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98974246, 'precision': 0.98981225, 'recall': 0.98974717, 'specificity': 0.98974717, 'f1': 0.98974216, 'auroc': 0.9994632, 'binary_precision': 0.995856, 'binary_recall': 0.98359346, 'binary_specificity': 0.9959008, 'binary_f1_score': 0.9896867}
confusion matrix:
       0      1
0  28668    118
1    473  28357
---- Validation: 
scalar performance:
{'acc': 0.9678762, 'precision': 0.7864913, 'recall': 0.6571779, 'specificity': 0.6571779, 'f1': 0.7012002, 'auroc': 0.9416082, 'binary_precision': 0.59779614, 'binary_recall': 0.32243684, 'binary_specificity': 0.991919, 'binary_f1_score': 0.41891888}
confusion matrix:
       0    1
0  17921  146
1    456  217
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95939416, 'precision': 0.8964858, 'recall': 0.5190626, 'specificity': 0.5190626, 'f1': 0.5263858, 'auroc': 0.93785596, 'binary_precision': 0.8333333, 'binary_recall': 0.03846154, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.073529415}
confusion matrix:
      0   1
0  5944   2
1   250  10
better model found
persisted
after epoch: 4,now: 2024-08-01 13:52:16.353276,epoch time: 0:20:17.343788,used: 1:21:03.550845,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_12_31_12_seed_1_23919978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.99088794, 'precision': 0.9908934, 'recall': 0.9908869, 'specificity': 0.9908869, 'f1': 0.9908879, 'auroc': 0.99953896, 'binary_precision': 0.98941725, 'binary_recall': 0.9924032, 'binary_specificity': 0.9893706, 'binary_f1_score': 0.99090797}
confusion matrix:
       0      1
0  28482    306
1    219  28609
---- Validation: 
scalar performance:
{'acc': 0.931857, 'precision': 0.65843666, 'recall': 0.8802578, 'specificity': 0.8802578, 'f1': 0.7143149, 'auroc': 0.937348, 'binary_precision': 0.32380396, 'binary_recall': 0.82466567, 'binary_specificity': 0.9358499, 'binary_f1_score': 0.4650188}
confusion matrix:
       0     1
0  16908  1159
1    118   555
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9518208, 'precision': 0.7231428, 'recall': 0.8700348, 'specificity': 0.8700348, 'f1': 0.7751731, 'auroc': 0.94694424, 'binary_precision': 0.45617977, 'binary_recall': 0.7807692, 'binary_specificity': 0.9593004, 'binary_f1_score': 0.57588655}
confusion matrix:
      0    1
0  5704  242
1    57  203
early stop counter: 1
val acc:0.9318569898605347, best validation acc: 0.9678761959075928, corresponding to test acc:                         0.9593941569328308 / 0.9718014597892761
after epoch: 5,now: 2024-08-01 14:12:20.390824,epoch time: 0:20:04.037548,used: 1:41:07.588393,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_12_31_12_seed_1_23919978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9919814, 'precision': 0.9920818, 'recall': 0.99198675, 'specificity': 0.99198675, 'f1': 0.991981, 'auroc': 0.99970216, 'binary_precision': 0.99929595, 'binary_recall': 0.9846682, 'binary_specificity': 0.99930525, 'binary_f1_score': 0.9919281}
confusion matrix:
       0      1
0  28767     20
1    442  28387
---- Validation: 
scalar performance:
{'acc': 0.9624333, 'precision': 0.73717326, 'recall': 0.8496231, 'specificity': 0.8496231, 'f1': 0.7811404, 'auroc': 0.9520812, 'binary_precision': 0.48466864, 'binary_recall': 0.7280832, 'binary_specificity': 0.9711629, 'binary_f1_score': 0.58194774}
confusion matrix:
       0    1
0  17546  521
1    183  490
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9769578, 'precision': 0.8627614, 'recall': 0.8426951, 'specificity': 0.8426951, 'f1': 0.8524109, 'auroc': 0.9612644, 'binary_precision': 0.7387755, 'binary_recall': 0.6961538, 'binary_specificity': 0.9892365, 'binary_f1_score': 0.7168316}
confusion matrix:
      0    1
0  5882   64
1    79  181
new oracle model saved
early stop counter: 2
val acc:0.9624332785606384, best validation acc: 0.9678761959075928, corresponding to test acc:                         0.9593941569328308 / 0.9769577980041504
after epoch: 6,now: 2024-08-01 14:32:52.946283,epoch time: 0:20:32.555459,used: 2:01:40.143852,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_12_31_12_seed_1_23919978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.99401206, 'precision': 0.9940206, 'recall': 0.9940138, 'specificity': 0.9940138, 'f1': 0.99401206, 'auroc': 0.9997188, 'binary_precision': 0.99627167, 'binary_recall': 0.9917447, 'binary_specificity': 0.99628294, 'binary_f1_score': 0.994003}
confusion matrix:
       0      1
0  28679    107
1    238  28592
---- Validation: 
scalar performance:
{'acc': 0.9696905, 'precision': 0.78521717, 'recall': 0.7532494, 'specificity': 0.7532494, 'f1': 0.7681825, 'auroc': 0.94777334, 'binary_precision': 0.5882353, 'binary_recall': 0.5200594, 'binary_specificity': 0.98643935, 'binary_f1_score': 0.5520505}
confusion matrix:
       0    1
0  17822  245
1    323  350
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96455044, 'precision': 0.8451693, 'recall': 0.62289774, 'specificity': 0.62289774, 'f1': 0.67659473, 'auroc': 0.9532776, 'binary_precision': 0.7222222, 'binary_recall': 0.25, 'binary_specificity': 0.9957955, 'binary_f1_score': 0.37142858}
confusion matrix:
      0   1
0  5921  25
1   195  65
better model found
persisted
after epoch: 7,now: 2024-08-01 14:53:11.104912,epoch time: 0:20:18.158629,used: 2:21:58.302481,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_12_31_12_seed_1_23919978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98446614, 'precision': 0.9846283, 'recall': 0.9844595, 'specificity': 0.9844595, 'f1': 0.98446465, 'auroc': 0.99912107, 'binary_precision': 0.9759422, 'binary_recall': 0.9934441, 'binary_specificity': 0.975475, 'binary_f1_score': 0.9846153}
confusion matrix:
       0      1
0  28081    706
1    189  28640
---- Validation: 
scalar performance:
{'acc': 0.9229989, 'precision': 0.62531906, 'recall': 0.7884011, 'specificity': 0.7884011, 'f1': 0.667013, 'auroc': 0.9241922, 'binary_precision': 0.26466992, 'binary_recall': 0.6433878, 'binary_specificity': 0.9334145, 'binary_f1_score': 0.37505415}
confusion matrix:
       0     1
0  16864  1203
1    240   433
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93409604, 'precision': 0.61244774, 'recall': 0.6309115, 'specificity': 0.6309115, 'f1': 0.6207913, 'auroc': 0.8704785, 'binary_precision': 0.2557377, 'binary_recall': 0.3, 'binary_specificity': 0.96182305, 'binary_f1_score': 0.27610618}
confusion matrix:
      0    1
0  5719  227
1   182   78
early stop counter: 1
val acc:0.9229989051818848, best validation acc: 0.9696905016899109, corresponding to test acc:                         0.9645504355430603 / 0.9769577980041504
after epoch: 8,now: 2024-08-01 15:13:26.565800,epoch time: 0:20:15.460888,used: 2:42:13.763369,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_12_31_12_seed_1_23919978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.99437654, 'precision': 0.9943843, 'recall': 0.99437803, 'specificity': 0.99437803, 'f1': 0.99437654, 'auroc': 0.99971914, 'binary_precision': 0.99651617, 'binary_recall': 0.99222976, 'binary_specificity': 0.9965263, 'binary_f1_score': 0.9943683}
confusion matrix:
       0      1
0  28688    100
1    224  28604
---- Validation: 
scalar performance:
{'acc': 0.95373535, 'precision': 0.70115525, 'recall': 0.8286609, 'specificity': 0.8286609, 'f1': 0.74715036, 'auroc': 0.94783473, 'binary_precision': 0.4140071, 'binary_recall': 0.69390786, 'binary_specificity': 0.96341395, 'binary_f1_score': 0.51860076}
confusion matrix:
       0    1
0  17406  661
1    206  467
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9663229, 'precision': 0.7913242, 'recall': 0.7838146, 'specificity': 0.7838146, 'f1': 0.7875141, 'auroc': 0.9490679, 'binary_precision': 0.6007905, 'binary_recall': 0.5846154, 'binary_specificity': 0.9830138, 'binary_f1_score': 0.5925926}
confusion matrix:
      0    1
0  5845  101
1   108  152
early stop counter: 2
val acc:0.9537353515625, best validation acc: 0.9696905016899109, corresponding to test acc:                         0.9645504355430603 / 0.9769577980041504
after epoch: 9,now: 2024-08-01 15:34:04.276902,epoch time: 0:20:37.711102,used: 3:02:51.474471,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_12_31_12_seed_1_23919978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99668497, 'precision': 0.9966925, 'recall': 0.9966865, 'specificity': 0.9966865, 'f1': 0.9966849, 'auroc': 0.99988544, 'binary_precision': 0.9988156, 'binary_recall': 0.9945541, 'binary_specificity': 0.99881893, 'binary_f1_score': 0.99668026}
confusion matrix:
       0      1
0  28753     34
1    157  28672
---- Validation: 
scalar performance:
{'acc': 0.96915686, 'precision': 0.8180749, 'recall': 0.641391, 'specificity': 0.641391, 'f1': 0.69291335, 'auroc': 0.95480055, 'binary_precision': 0.66211605, 'binary_recall': 0.2882615, 'binary_specificity': 0.9945204, 'binary_f1_score': 0.4016563}
confusion matrix:
       0    1
0  17968   99
1    479  194
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584273, 'precision': 0.9792069, 'recall': 0.50384617, 'specificity': 0.50384617, 'f1': 0.4970163, 'auroc': 0.954592, 'binary_precision': 1.0, 'binary_recall': 0.0076923077, 'binary_specificity': 1.0, 'binary_f1_score': 0.015267175}
confusion matrix:
      0  1
0  5946  0
1   258  2
early stop counter: 3
val acc:0.9691568613052368, best validation acc: 0.9696905016899109, corresponding to test acc:                         0.9645504355430603 / 0.9769577980041504
after epoch: 10,now: 2024-08-01 15:54:00.780360,epoch time: 0:19:56.503458,used: 3:22:47.977929,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_12_31_12_seed_1_23919978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9913392, 'precision': 0.99139583, 'recall': 0.9913354, 'specificity': 0.9913354, 'f1': 0.99133885, 'auroc': 0.9997196, 'binary_precision': 0.98630184, 'binary_recall': 0.99653125, 'binary_specificity': 0.9861396, 'binary_f1_score': 0.9913901}
confusion matrix:
       0      1
0  28388    399
1    100  28729
---- Validation: 
scalar performance:
{'acc': 0.9470651, 'precision': 0.6856397, 'recall': 0.8552428, 'specificity': 0.8552428, 'f1': 0.7392502, 'auroc': 0.9463706, 'binary_precision': 0.38070306, 'binary_recall': 0.756315, 'binary_specificity': 0.9541706, 'binary_f1_score': 0.50646764}
confusion matrix:
       0    1
0  17239  828
1    164  509
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9550435, 'precision': 0.7194418, 'recall': 0.7154027, 'specificity': 0.7154027, 'f1': 0.71740055, 'auroc': 0.910292, 'binary_precision': 0.4627451, 'binary_recall': 0.45384616, 'binary_specificity': 0.9769593, 'binary_f1_score': 0.45825243}
confusion matrix:
      0    1
0  5809  137
1   142  118
early stop counter: 4
val acc:0.9470651149749756, best validation acc: 0.9696905016899109, corresponding to test acc:                         0.9645504355430603 / 0.9769577980041504
after epoch: 11,now: 2024-08-01 16:13:57.291973,epoch time: 0:19:56.511613,used: 3:42:44.489542,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_12_31_12_seed_1_23919978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9932831, 'precision': 0.993312, 'recall': 0.993286, 'specificity': 0.993286, 'f1': 0.99328303, 'auroc': 0.9996567, 'binary_precision': 0.99727255, 'binary_recall': 0.98928165, 'binary_specificity': 0.99729043, 'binary_f1_score': 0.99326104}
confusion matrix:
       0      1
0  28709     78
1    309  28520
---- Validation: 
scalar performance:
{'acc': 0.9540555, 'precision': 0.70503414, 'recall': 0.8488544, 'specificity': 0.8488544, 'f1': 0.75534016, 'auroc': 0.9510008, 'binary_precision': 0.42020375, 'binary_recall': 0.7355126, 'binary_specificity': 0.9621963, 'binary_f1_score': 0.534846}
confusion matrix:
       0    1
0  17384  683
1    178  495
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9535933, 'precision': 0.7203431, 'recall': 0.78268844, 'specificity': 0.78268844, 'f1': 0.7470084, 'auroc': 0.92442775, 'binary_precision': 0.45857987, 'binary_recall': 0.59615386, 'binary_specificity': 0.969223, 'binary_f1_score': 0.51839465}
confusion matrix:
      0    1
0  5763  183
1   105  155
early stop counter: 5
val acc:0.9540554881095886, best validation acc: 0.9696905016899109, corresponding to test acc:                         0.9645504355430603 / 0.9769577980041504
after epoch: 12,now: 2024-08-01 16:34:36.013373,epoch time: 0:20:38.721400,used: 4:03:23.210942,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_12_31_12_seed_1_23919978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9944807, 'precision': 0.99452925, 'recall': 0.9944844, 'specificity': 0.9944844, 'f1': 0.9944806, 'auroc': 0.9998215, 'binary_precision': 0.9996145, 'binary_recall': 0.989351, 'binary_specificity': 0.9996179, 'binary_f1_score': 0.99445623}
confusion matrix:
       0      1
0  28776     11
1    307  28522
---- Validation: 
scalar performance:
{'acc': 0.95624334, 'precision': 0.69091004, 'recall': 0.7126578, 'specificity': 0.7126578, 'f1': 0.7011106, 'auroc': 0.92406976, 'binary_precision': 0.40239045, 'binary_recall': 0.45022288, 'binary_specificity': 0.9750927, 'binary_f1_score': 0.42496493}
confusion matrix:
       0    1
0  17617  450
1    370  303
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95955527, 'precision': 0.75234663, 'recall': 0.6221299, 'specificity': 0.6221299, 'f1': 0.6618906, 'auroc': 0.9317998, 'binary_precision': 0.5365854, 'binary_recall': 0.25384617, 'binary_specificity': 0.9904137, 'binary_f1_score': 0.34464753}
confusion matrix:
      0   1
0  5889  57
1   194  66
early stop counter: 6
val acc:0.9562433362007141, best validation acc: 0.9696905016899109, corresponding to test acc:                         0.9645504355430603 / 0.9769577980041504
after epoch: 13,now: 2024-08-01 16:54:34.392050,epoch time: 0:19:58.378677,used: 4:23:21.589619,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_12_31_12_seed_1_23919978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9890829, 'precision': 0.9891708, 'recall': 0.9890882, 'specificity': 0.9890882, 'f1': 0.98908246, 'auroc': 0.9992751, 'binary_precision': 0.99592024, 'binary_recall': 0.98220605, 'binary_specificity': 0.99597025, 'binary_f1_score': 0.9890156}
confusion matrix:
       0      1
0  28670    116
1    513  28317
---- Validation: 
scalar performance:
{'acc': 0.9627001, 'precision': 0.737602, 'recall': 0.8361713, 'specificity': 0.8361713, 'f1': 0.7772682, 'auroc': 0.93396246, 'binary_precision': 0.48657024, 'binary_recall': 0.6998514, 'binary_specificity': 0.97249126, 'binary_f1_score': 0.5740402}
confusion matrix:
       0    1
0  17570  497
1    202  471
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9737351, 'precision': 0.8429946, 'recall': 0.8189455, 'specificity': 0.8189455, 'f1': 0.83048296, 'auroc': 0.94711375, 'binary_precision': 0.70124483, 'binary_recall': 0.65, 'binary_specificity': 0.987891, 'binary_f1_score': 0.67465067}
confusion matrix:
      0    1
0  5874   72
1    91  169
early stop counter: 7
val acc:0.9627001285552979, best validation acc: 0.9696905016899109, corresponding to test acc:                         0.9645504355430603 / 0.9769577980041504
after epoch: 14,now: 2024-08-01 17:16:10.140575,epoch time: 0:21:35.748525,used: 4:44:57.338144,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_12_31_12_seed_1_23919978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99578243, 'precision': 0.9957925, 'recall': 0.99578416, 'specificity': 0.99578416, 'f1': 0.9957824, 'auroc': 0.9997151, 'binary_precision': 0.99822223, 'binary_recall': 0.99334, 'binary_specificity': 0.9982284, 'binary_f1_score': 0.99577516}
confusion matrix:
       0      1
0  28736     51
1    192  28637
---- Validation: 
scalar performance:
{'acc': 0.9655283, 'precision': 0.75131416, 'recall': 0.72677165, 'specificity': 0.72677165, 'f1': 0.7383392, 'auroc': 0.947048, 'binary_precision': 0.5223141, 'binary_recall': 0.46953937, 'binary_specificity': 0.98400396, 'binary_f1_score': 0.4945227}
confusion matrix:
       0    1
0  17778  289
1    357  316
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584273, 'precision': 0.74370265, 'recall': 0.5369479, 'specificity': 0.5369479, 'f1': 0.55646527, 'auroc': 0.96288323, 'binary_precision': 0.5263158, 'binary_recall': 0.07692308, 'binary_specificity': 0.99697274, 'binary_f1_score': 0.1342282}
confusion matrix:
      0   1
0  5928  18
1   240  20
early stop counter: 8
val acc:0.9655283093452454, best validation acc: 0.9696905016899109, corresponding to test acc:                         0.9645504355430603 / 0.9769577980041504
after epoch: 15,now: 2024-08-01 17:36:02.693118,epoch time: 0:19:52.552543,used: 5:04:49.890687,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_12_31_12_seed_1_23919978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99442863, 'precision': 0.99445754, 'recall': 0.99443156, 'specificity': 0.99443156, 'f1': 0.9944285, 'auroc': 0.9997256, 'binary_precision': 0.99842644, 'binary_recall': 0.9904263, 'binary_specificity': 0.9984368, 'binary_f1_score': 0.9944103}
confusion matrix:
       0      1
0  28742     45
1    276  28553
---- Validation: 
scalar performance:
{'acc': 0.9698506, 'precision': 0.78392786, 'recall': 0.7704988, 'specificity': 0.7704988, 'f1': 0.77703285, 'auroc': 0.95724344, 'binary_precision': 0.584375, 'binary_recall': 0.5557206, 'binary_specificity': 0.985277, 'binary_f1_score': 0.5696877}
confusion matrix:
       0    1
0  17801  266
1    299  374
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9477925, 'precision': 0.6474502, 'recall': 0.6067964, 'specificity': 0.6067964, 'f1': 0.62323296, 'auroc': 0.92207056, 'binary_precision': 0.32795697, 'binary_recall': 0.23461539, 'binary_specificity': 0.97897744, 'binary_f1_score': 0.2735426}
confusion matrix:
      0    1
0  5821  125
1   199   61
better model found
persisted
after epoch: 16,now: 2024-08-01 17:56:15.815704,epoch time: 0:20:13.122586,used: 5:25:03.013273,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_12_31_12_seed_1_23919978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99159956, 'precision': 0.99170196, 'recall': 0.9915947, 'specificity': 0.9915947, 'f1': 0.991599, 'auroc': 0.99984634, 'binary_precision': 0.984778, 'binary_recall': 0.99864715, 'binary_specificity': 0.9845422, 'binary_f1_score': 0.99166405}
confusion matrix:
       0      1
0  28343    445
1     39  28789
---- Validation: 
scalar performance:
{'acc': 0.94397014, 'precision': 0.68296957, 'recall': 0.8851094, 'specificity': 0.8851094, 'f1': 0.74163103, 'auroc': 0.9553989, 'binary_precision': 0.3728928, 'binary_recall': 0.8216939, 'binary_specificity': 0.94852495, 'binary_f1_score': 0.51298696}
confusion matrix:
       0    1
0  17137  930
1    120  553
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96165, 'precision': 0.7618902, 'recall': 0.7464352, 'specificity': 0.7464352, 'f1': 0.75389564, 'auroc': 0.949956, 'binary_precision': 0.545082, 'binary_recall': 0.51153845, 'binary_specificity': 0.981332, 'binary_f1_score': 0.5277778}
confusion matrix:
      0    1
0  5835  111
1   127  133
early stop counter: 1
val acc:0.9439701437950134, best validation acc: 0.9698505997657776, corresponding to test acc:                         0.9477924704551697 / 0.9769577980041504
after epoch: 17,now: 2024-08-01 18:17:15.209453,epoch time: 0:20:59.393749,used: 5:46:02.407022,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_12_31_12_seed_1_23919978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9944981, 'precision': 0.99455166, 'recall': 0.9945022, 'specificity': 0.9945022, 'f1': 0.9944979, 'auroc': 0.9998961, 'binary_precision': 0.9998948, 'binary_recall': 0.98910856, 'binary_specificity': 0.9998958, 'binary_f1_score': 0.9944724}
confusion matrix:
       0      1
0  28783      3
1    314  28516
---- Validation: 
scalar performance:
{'acc': 0.9726788, 'precision': 0.82340324, 'recall': 0.735487, 'specificity': 0.735487, 'f1': 0.7718811, 'auroc': 0.95031035, 'binary_precision': 0.6659794, 'binary_recall': 0.47994056, 'binary_specificity': 0.9910334, 'binary_f1_score': 0.5578584}
confusion matrix:
       0    1
0  17905  162
1    350  323
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611666, 'precision': 0.82485944, 'recall': 0.56596226, 'specificity': 0.56596226, 'f1': 0.60258234, 'auroc': 0.95016336, 'binary_precision': 0.6862745, 'binary_recall': 0.13461539, 'binary_specificity': 0.9973091, 'binary_f1_score': 0.2250804}
confusion matrix:
      0   1
0  5930  16
1   225  35
better model found
persisted
after epoch: 18,now: 2024-08-01 18:37:13.728600,epoch time: 0:19:58.519147,used: 6:06:00.926169,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_12_31_12_seed_1_23919978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99409884, 'precision': 0.9941341, 'recall': 0.99410206, 'specificity': 0.99410206, 'f1': 0.9940988, 'auroc': 0.99974865, 'binary_precision': 0.99849516, 'binary_recall': 0.9896979, 'binary_specificity': 0.99850625, 'binary_f1_score': 0.994077}
confusion matrix:
       0      1
0  28744     43
1    297  28532
---- Validation: 
scalar performance:
{'acc': 0.97065103, 'precision': 0.792307, 'recall': 0.7637613, 'specificity': 0.7637613, 'f1': 0.77722377, 'auroc': 0.9538264, 'binary_precision': 0.6016529, 'binary_recall': 0.5408618, 'binary_specificity': 0.9866608, 'binary_f1_score': 0.5696401}
confusion matrix:
       0    1
0  17826  241
1    309  364
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9535933, 'precision': 0.613483, 'recall': 0.5270693, 'specificity': 0.5270693, 'f1': 0.5380913, 'auroc': 0.9118478, 'binary_precision': 0.26666668, 'binary_recall': 0.06153846, 'binary_specificity': 0.9926001, 'binary_f1_score': 0.1}
confusion matrix:
      0   1
0  5902  44
1   244  16
early stop counter: 1
val acc:0.9706510305404663, best validation acc: 0.9726787805557251, corresponding to test acc:                         0.9611666202545166 / 0.9769577980041504
after epoch: 19,now: 2024-08-01 18:57:20.374909,epoch time: 0:20:06.646309,used: 6:26:07.572478,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_12_31_12_seed_1_23919978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9956262, 'precision': 0.99565375, 'recall': 0.9956292, 'specificity': 0.9956292, 'f1': 0.99562615, 'auroc': 0.9998388, 'binary_precision': 0.9995455, 'binary_recall': 0.99171, 'binary_specificity': 0.9995484, 'binary_f1_score': 0.9956123}
confusion matrix:
       0      1
0  28773     13
1    239  28591
---- Validation: 
scalar performance:
{'acc': 0.97230524, 'precision': 0.8392558, 'recall': 0.6966688, 'specificity': 0.6966688, 'f1': 0.74736917, 'auroc': 0.9544523, 'binary_precision': 0.7005208, 'binary_recall': 0.39970282, 'binary_specificity': 0.9936348, 'binary_f1_score': 0.50898767}
confusion matrix:
       0    1
0  17952  115
1    404  269
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579439, 'precision': 0.7178851, 'recall': 0.5183058, 'specificity': 0.5183058, 'f1': 0.5248296, 'auroc': 0.94291866, 'binary_precision': 0.47619048, 'binary_recall': 0.03846154, 'binary_specificity': 0.99815, 'binary_f1_score': 0.07117438}
confusion matrix:
      0   1
0  5935  11
1   250  10
early stop counter: 2
val acc:0.9723052382469177, best validation acc: 0.9726787805557251, corresponding to test acc:                         0.9611666202545166 / 0.9769577980041504
after epoch: 20,now: 2024-08-01 19:17:27.301254,epoch time: 0:20:06.926345,used: 6:46:14.498823,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_12_31_12_seed_1_23919978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 6:46:14.498823 at 2024-08-01 19:17:27.301254
persisted model performance metric: 

scalar performance:
{'acc': 0.9611666, 'precision': 0.82485944, 'recall': 0.56596226, 'specificity': 0.56596226, 'f1': 0.60258234, 'auroc': 0.95016336, 'binary_precision': 0.6862745, 'binary_recall': 0.13461539, 'binary_specificity': 0.9973091, 'binary_f1_score': 0.2250804}
confusion matrix:
      0   1
0  5930  16
1   225  35
oracle model performance metric: 

scalar performance:
{'acc': 0.9769578, 'precision': 0.8627614, 'recall': 0.8426951, 'specificity': 0.8426951, 'f1': 0.8524109, 'auroc': 0.9612644, 'binary_precision': 0.7387755, 'binary_recall': 0.6961538, 'binary_specificity': 0.9892365, 'binary_f1_score': 0.7168316}
confusion matrix:
      0    1
0  5882   64
1    79  181
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_12-46-56/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_12-46-56/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456826 KiB |  13220 MiB |   1085 TiB |   1085 TiB |
|       from large pool | 415151 KiB |  13181 MiB |   1070 TiB |   1070 TiB |
|       from small pool |  41675 KiB |     61 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 456826 KiB |  13220 MiB |   1085 TiB |   1085 TiB |
|       from large pool | 415151 KiB |  13181 MiB |   1070 TiB |   1070 TiB |
|       from small pool |  41675 KiB |     61 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447751 KiB |  13213 MiB |   1084 TiB |   1084 TiB |
|       from large pool | 407075 KiB |  13175 MiB |   1069 TiB |   1069 TiB |
|       from small pool |  40676 KiB |     60 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14472 MiB |  14484 MiB |  28102 MiB |  13630 MiB |
|       from large pool |  14406 MiB |  14412 MiB |  28014 MiB |  13608 MiB |
|       from small pool |     66 MiB |     72 MiB |     88 MiB |     22 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 466821 KiB |   1235 MiB |    839 TiB |    839 TiB |
|       from large pool | 455249 KiB |   1232 MiB |    824 TiB |    824 TiB |
|       from small pool |  11572 KiB |     38 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3464    |    8207    |  216289 K  |  216286 K  |
|       from large pool |     187    |    1413    |  101512 K  |  101512 K  |
|       from small pool |    3277    |    8018    |  114777 K  |  114774 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3464    |    8207    |  216289 K  |  216286 K  |
|       from large pool |     187    |    1413    |  101512 K  |  101512 K  |
|       from small pool |    3277    |    8018    |  114777 K  |  114774 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     635    |     638    |    1212    |     577    |
|       from large pool |     602    |     602    |    1168    |     566    |
|       from small pool |      33    |      36    |      44    |      11    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      77    |    3660    |  127495 K  |  127495 K  |
|       from large pool |      36    |     605    |   71590 K  |   71590 K  |
|       from small pool |      41    |    3624    |   55904 K  |   55904 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13220 MiB |   1085 TiB |   1085 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1070 TiB |   1070 TiB |
|       from small pool |      0 KiB |     61 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13220 MiB |   1085 TiB |   1085 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1070 TiB |   1070 TiB |
|       from small pool |      0 KiB |     61 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   1084 TiB |   1084 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   1069 TiB |   1069 TiB |
|       from small pool |      0 KiB |     60 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    902 MiB |  14484 MiB |  28102 MiB |  27200 MiB |
|       from large pool |    850 MiB |  14412 MiB |  28014 MiB |  27164 MiB |
|       from small pool |     52 MiB |     72 MiB |     88 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1235 MiB |    839 TiB |    839 TiB |
|       from large pool |  24320 KiB |   1232 MiB |    824 TiB |    824 TiB |
|       from small pool |      0 KiB |     42 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8207    |  216289 K  |  216289 K  |
|       from large pool |       2    |    1413    |  101512 K  |  101512 K  |
|       from small pool |       0    |    8018    |  114777 K  |  114777 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8207    |  216289 K  |  216289 K  |
|       from large pool |       2    |    1413    |  101512 K  |  101512 K  |
|       from small pool |       0    |    8018    |  114777 K  |  114777 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      64    |     638    |    1212    |    1148    |
|       from large pool |      38    |     602    |    1168    |    1130    |
|       from small pool |      26    |      36    |      44    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3660    |  127496 K  |  127496 K  |
|       from large pool |       3    |     605    |   71590 K  |   71590 K  |
|       from small pool |       0    |    3624    |   55906 K  |   55906 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13220 MiB |   1085 TiB |   1085 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1070 TiB |   1070 TiB |
|       from small pool |      0 KiB |     61 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13220 MiB |   1085 TiB |   1085 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1070 TiB |   1070 TiB |
|       from small pool |      0 KiB |     61 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   1084 TiB |   1084 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   1069 TiB |   1069 TiB |
|       from small pool |      0 KiB |     60 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    902 MiB |  14484 MiB |  28102 MiB |  27200 MiB |
|       from large pool |    850 MiB |  14412 MiB |  28014 MiB |  27164 MiB |
|       from small pool |     52 MiB |     72 MiB |     88 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1235 MiB |    839 TiB |    839 TiB |
|       from large pool |  24320 KiB |   1232 MiB |    824 TiB |    824 TiB |
|       from small pool |      0 KiB |     42 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8207    |  216289 K  |  216289 K  |
|       from large pool |       2    |    1413    |  101512 K  |  101512 K  |
|       from small pool |       0    |    8018    |  114777 K  |  114777 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8207    |  216289 K  |  216289 K  |
|       from large pool |       2    |    1413    |  101512 K  |  101512 K  |
|       from small pool |       0    |    8018    |  114777 K  |  114777 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      64    |     638    |    1212    |    1148    |
|       from large pool |      38    |     602    |    1168    |    1130    |
|       from small pool |      26    |      36    |      44    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3660    |  127496 K  |  127496 K  |
|       from large pool |       3    |     605    |   71590 K  |   71590 K  |
|       from small pool |       0    |    3624    |   55906 K  |   55906 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_19_25_11_seed_2_23919978

 Experiment start at: 2024-08-01 19:25:11.656579
before training, model accuracy: 0.754768431186676
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9846494, 'precision': 0.9848639, 'recall': 0.98465085, 'specificity': 0.98465085, 'f1': 0.98464775, 'auroc': 0.99834824, 'binary_precision': 0.9950948, 'binary_recall': 0.9741048, 'binary_specificity': 0.99519694, 'binary_f1_score': 0.9844879}
confusion matrix:
       0      1
0  29008    140
1    755  28401
---- Validation: 
scalar performance:
{'acc': 0.9500346, 'precision': 0.6680739, 'recall': 0.8007312, 'specificity': 0.8007312, 'f1': 0.71264356, 'auroc': 0.9080989, 'binary_precision': 0.34837544, 'binary_recall': 0.641196, 'binary_specificity': 0.96026635, 'binary_f1_score': 0.45146197}
confusion matrix:
       0    1
0  17449  722
1    216  386
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96730244, 'precision': 0.7763486, 'recall': 0.826355, 'specificity': 0.826355, 'f1': 0.79901016, 'auroc': 0.91070056, 'binary_precision': 0.5659722, 'binary_recall': 0.6735537, 'binary_specificity': 0.97915626, 'binary_f1_score': 0.6150943}
confusion matrix:
      0    1
0  5872  125
1    79  163
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-01 19:46:18.973757,epoch time: 0:21:07.317178,used: 0:21:07.317178,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_19_25_11_seed_2_23919978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9848038, 'precision': 0.9851943, 'recall': 0.9848067, 'specificity': 0.9848067, 'f1': 0.9848008, 'auroc': 0.99925625, 'binary_precision': 0.9990116, 'binary_recall': 0.97057414, 'binary_specificity': 0.9990393, 'binary_f1_score': 0.9845876}
confusion matrix:
       0      1
0  29118     28
1    858  28300
---- Validation: 
scalar performance:
{'acc': 0.9696905, 'precision': 0.75746185, 'recall': 0.7121098, 'specificity': 0.7121098, 'f1': 0.73237765, 'auroc': 0.92599475, 'binary_precision': 0.53346854, 'binary_recall': 0.43687707, 'binary_specificity': 0.9873425, 'binary_f1_score': 0.4803653}
confusion matrix:
       0    1
0  17941  230
1    339  263
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97627825, 'precision': 0.88234514, 'recall': 0.7655935, 'specificity': 0.7655935, 'f1': 0.81249654, 'auroc': 0.93259925, 'binary_precision': 0.78313255, 'binary_recall': 0.5371901, 'binary_specificity': 0.993997, 'binary_f1_score': 0.6372549}
confusion matrix:
      0    1
0  5961   36
1   112  130
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-01 20:06:56.319662,epoch time: 0:20:37.345905,used: 0:41:44.663083,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_19_25_11_seed_2_23919978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.98916024, 'precision': 0.9893291, 'recall': 0.98916185, 'specificity': 0.98916185, 'f1': 0.98915935, 'auroc': 0.9992641, 'binary_precision': 0.99846226, 'binary_recall': 0.9798333, 'binary_specificity': 0.9984904, 'binary_f1_score': 0.98906004}
confusion matrix:
       0      1
0  29103     44
1    588  28569
---- Validation: 
scalar performance:
{'acc': 0.9620199, 'precision': 0.7144448, 'recall': 0.8229834, 'specificity': 0.8229834, 'f1': 0.7563325, 'auroc': 0.9350524, 'binary_precision': 0.43987, 'binary_recall': 0.6744186, 'binary_specificity': 0.9715481, 'binary_f1_score': 0.5324591}
confusion matrix:
       0    1
0  17654  517
1    196  406
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.967623, 'precision': 0.8421438, 'recall': 0.6361786, 'specificity': 0.6361786, 'f1': 0.69108653, 'auroc': 0.9316261, 'binary_precision': 0.71276593, 'binary_recall': 0.2768595, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.3988095}
confusion matrix:
      0   1
0  5970  27
1   175  67
early stop counter: 1
val acc:0.9620199203491211, best validation acc: 0.9696905016899109, corresponding to test acc:                         0.9762782454490662 / 0.9762782454490662
after epoch: 3,now: 2024-08-01 20:27:32.197347,epoch time: 0:20:35.877685,used: 1:02:20.540768,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_19_25_11_seed_2_23919978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9939798, 'precision': 0.9940032, 'recall': 0.9939804, 'specificity': 0.9939804, 'f1': 0.9939798, 'auroc': 0.9997674, 'binary_precision': 0.9974442, 'binary_recall': 0.99049973, 'binary_specificity': 0.99746114, 'binary_f1_score': 0.99395984}
confusion matrix:
       0      1
0  29073     74
1    277  28880
---- Validation: 
scalar performance:
{'acc': 0.96063495, 'precision': 0.7096311, 'recall': 0.83190453, 'specificity': 0.83190453, 'f1': 0.7551247, 'auroc': 0.9357153, 'binary_precision': 0.42959917, 'binary_recall': 0.69435215, 'binary_specificity': 0.96945685, 'binary_f1_score': 0.53079367}
confusion matrix:
       0    1
0  17616  555
1    184  418
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9554416, 'precision': 0.7139382, 'recall': 0.78251314, 'specificity': 0.78251314, 'f1': 0.742748, 'auroc': 0.8979311, 'binary_precision': 0.44444445, 'binary_recall': 0.59504133, 'binary_specificity': 0.969985, 'binary_f1_score': 0.50883394}
confusion matrix:
      0    1
0  5817  180
1    98  144
early stop counter: 2
val acc:0.9606349468231201, best validation acc: 0.9696905016899109, corresponding to test acc:                         0.9762782454490662 / 0.9762782454490662
after epoch: 4,now: 2024-08-01 20:48:17.601739,epoch time: 0:20:45.404392,used: 1:23:05.945160,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_19_25_11_seed_2_23919978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98190516, 'precision': 0.98241043, 'recall': 0.9819024, 'specificity': 0.9819024, 'f1': 0.98190045, 'auroc': 0.99968266, 'binary_precision': 0.96684164, 'binary_recall': 0.9980451, 'binary_specificity': 0.96575975, 'binary_f1_score': 0.9821957}
confusion matrix:
       0      1
0  28149    998
1     57  29100
---- Validation: 
scalar performance:
{'acc': 0.8783892, 'precision': 0.5928545, 'recall': 0.8705271, 'specificity': 0.8705271, 'f1': 0.62292546, 'auroc': 0.9287648, 'binary_precision': 0.190879, 'binary_recall': 0.86212623, 'binary_specificity': 0.87892795, 'binary_f1_score': 0.31255648}
confusion matrix:
       0     1
0  15971  2200
1     83   519
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.855105, 'precision': 0.5893265, 'recall': 0.8373884, 'specificity': 0.8373884, 'f1': 0.6118711, 'auroc': 0.90172553, 'binary_precision': 0.18714556, 'binary_recall': 0.8181818, 'binary_specificity': 0.856595, 'binary_f1_score': 0.30461538}
confusion matrix:
      0    1
0  5137  860
1    44  198
early stop counter: 3
val acc:0.8783891797065735, best validation acc: 0.9696905016899109, corresponding to test acc:                         0.9762782454490662 / 0.9762782454490662
after epoch: 5,now: 2024-08-01 21:09:13.265278,epoch time: 0:20:55.663539,used: 1:44:01.608699,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_19_25_11_seed_2_23919978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9921789, 'precision': 0.99228525, 'recall': 0.9921797, 'specificity': 0.9921797, 'f1': 0.99217844, 'auroc': 0.9998065, 'binary_precision': 0.9995474, 'binary_recall': 0.98480535, 'binary_specificity': 0.99955404, 'binary_f1_score': 0.9921216}
confusion matrix:
       0      1
0  29136     13
1    443  28712
---- Validation: 
scalar performance:
{'acc': 0.9678261, 'precision': 0.73127806, 'recall': 0.54732484, 'specificity': 0.54732484, 'f1': 0.5735163, 'auroc': 0.9364549, 'binary_precision': 0.49166667, 'binary_recall': 0.09800664, 'binary_specificity': 0.996643, 'binary_f1_score': 0.1634349}
confusion matrix:
       0   1
0  18110  61
1    543  59
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9626543, 'precision': 0.9813002, 'recall': 0.51859504, 'specificity': 0.51859504, 'f1': 0.52632844, 'auroc': 0.9344218, 'binary_precision': 1.0, 'binary_recall': 0.037190083, 'binary_specificity': 1.0, 'binary_f1_score': 0.07171315}
confusion matrix:
      0  1
0  5997  0
1   233  9
early stop counter: 4
val acc:0.9678261280059814, best validation acc: 0.9696905016899109, corresponding to test acc:                         0.9762782454490662 / 0.9762782454490662
after epoch: 6,now: 2024-08-01 21:29:45.589854,epoch time: 0:20:32.324576,used: 2:04:33.933275,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_19_25_11_seed_2_23919978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.99379116, 'precision': 0.99380815, 'recall': 0.9937918, 'specificity': 0.9937918, 'f1': 0.99379116, 'auroc': 0.99962115, 'binary_precision': 0.99675685, 'binary_recall': 0.9908087, 'binary_specificity': 0.99677485, 'binary_f1_score': 0.99377394}
confusion matrix:
       0      1
0  29052     94
1    268  28890
---- Validation: 
scalar performance:
{'acc': 0.9688382, 'precision': 0.7490097, 'recall': 0.7486097, 'specificity': 0.7486097, 'f1': 0.7488095, 'auroc': 0.94419205, 'binary_precision': 0.5141431, 'binary_recall': 0.51328903, 'binary_specificity': 0.9839304, 'binary_f1_score': 0.5137157}
confusion matrix:
       0    1
0  17879  292
1    293  309
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9721109, 'precision': 0.87306064, 'recall': 0.69799536, 'specificity': 0.69799536, 'f1': 0.7564028, 'auroc': 0.9299169, 'binary_precision': 0.76984125, 'binary_recall': 0.40082645, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.52717394}
confusion matrix:
      0   1
0  5968  29
1   145  97
early stop counter: 5
val acc:0.9688382148742676, best validation acc: 0.9696905016899109, corresponding to test acc:                         0.9762782454490662 / 0.9762782454490662
after epoch: 7,now: 2024-08-01 21:50:08.046176,epoch time: 0:20:22.456322,used: 2:24:56.389597,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_19_25_11_seed_2_23919978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.993208, 'precision': 0.9932777, 'recall': 0.9932095, 'specificity': 0.9932095, 'f1': 0.9932078, 'auroc': 0.9997693, 'binary_precision': 0.99920166, 'binary_recall': 0.98720807, 'binary_specificity': 0.99921083, 'binary_f1_score': 0.99316865}
confusion matrix:
       0      1
0  29122     23
1    373  28786
---- Validation: 
scalar performance:
{'acc': 0.9690513, 'precision': 0.7765644, 'recall': 0.56080645, 'specificity': 0.56080645, 'f1': 0.5947083, 'auroc': 0.9472288, 'binary_precision': 0.5813953, 'binary_recall': 0.12458472, 'binary_specificity': 0.99702823, 'binary_f1_score': 0.20519835}
confusion matrix:
       0   1
0  18117  54
1    527  75
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96297485, 'precision': 0.9149368, 'recall': 0.52669275, 'specificity': 0.52669275, 'f1': 0.5411327, 'auroc': 0.9303278, 'binary_precision': 0.8666667, 'binary_recall': 0.053719006, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.101167314}
confusion matrix:
      0   1
0  5995   2
1   229  13
early stop counter: 6
val acc:0.9690513014793396, best validation acc: 0.9696905016899109, corresponding to test acc:                         0.9762782454490662 / 0.9762782454490662
after epoch: 8,now: 2024-08-01 22:10:56.002827,epoch time: 0:20:47.956651,used: 2:45:44.346248,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_19_25_11_seed_2_23919978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9936711, 'precision': 0.993726, 'recall': 0.99367166, 'specificity': 0.99367166, 'f1': 0.99367094, 'auroc': 0.99972856, 'binary_precision': 0.99896, 'binary_recall': 0.9883725, 'binary_specificity': 0.9989708, 'binary_f1_score': 0.99363804}
confusion matrix:
       0      1
0  29119     30
1    339  28816
---- Validation: 
scalar performance:
{'acc': 0.9720343, 'precision': 0.8447958, 'recall': 0.60490894, 'specificity': 0.60490894, 'f1': 0.65675247, 'auroc': 0.9535279, 'binary_precision': 0.7150838, 'binary_recall': 0.21262458, 'binary_specificity': 0.99719334, 'binary_f1_score': 0.32778487}
confusion matrix:
       0    1
0  18120   51
1    474  128
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9623337, 'precision': 0.89038503, 'recall': 0.5184283, 'specificity': 0.5184283, 'f1': 0.52596164, 'auroc': 0.94416994, 'binary_precision': 0.8181818, 'binary_recall': 0.037190083, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.07114624}
confusion matrix:
      0  1
0  5995  2
1   233  9
better model found
persisted
after epoch: 9,now: 2024-08-01 22:31:25.002434,epoch time: 0:20:28.999607,used: 3:06:13.345855,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_19_25_11_seed_2_23919978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99473447, 'precision': 0.99474496, 'recall': 0.994735, 'specificity': 0.994735, 'f1': 0.99473447, 'auroc': 0.9996929, 'binary_precision': 0.9970711, 'binary_recall': 0.9923863, 'binary_specificity': 0.99708366, 'binary_f1_score': 0.99472314}
confusion matrix:
       0      1
0  29061     85
1    222  28936
---- Validation: 
scalar performance:
{'acc': 0.96052843, 'precision': 0.65319616, 'recall': 0.6061928, 'specificity': 0.6061928, 'f1': 0.62483335, 'auroc': 0.91965675, 'binary_precision': 0.33171913, 'binary_recall': 0.22757475, 'binary_specificity': 0.98481095, 'binary_f1_score': 0.26995075}
confusion matrix:
       0    1
0  17895  276
1    465  137
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9108831, 'precision': 0.5290343, 'recall': 0.5451989, 'specificity': 0.5451989, 'f1': 0.5338649, 'auroc': 0.8534925, 'binary_precision': 0.09326425, 'binary_recall': 0.14876033, 'binary_specificity': 0.94163746, 'binary_f1_score': 0.11464968}
confusion matrix:
      0    1
0  5647  350
1   206   36
early stop counter: 1
val acc:0.9605284333229065, best validation acc: 0.9720342755317688, corresponding to test acc:                         0.9623336791992188 / 0.9762782454490662
after epoch: 10,now: 2024-08-01 22:51:57.515833,epoch time: 0:20:32.513399,used: 3:26:45.859254,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_19_25_11_seed_2_23919978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9941342, 'precision': 0.99419737, 'recall': 0.99413514, 'specificity': 0.99413514, 'f1': 0.99413407, 'auroc': 0.99973273, 'binary_precision': 0.99982655, 'binary_recall': 0.9884419, 'binary_specificity': 0.99982846, 'binary_f1_score': 0.9941017}
confusion matrix:
       0      1
0  29142      5
1    337  28820
---- Validation: 
scalar performance:
{'acc': 0.9692644, 'precision': 0.759466, 'recall': 0.62756956, 'specificity': 0.62756956, 'f1': 0.6690606, 'auroc': 0.941314, 'binary_precision': 0.54295534, 'binary_recall': 0.26245847, 'binary_specificity': 0.99268067, 'binary_f1_score': 0.3538634}
confusion matrix:
       0    1
0  18038  133
1    444  158
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9560827, 'precision': 0.55711395, 'recall': 0.5112112, 'specificity': 0.5112112, 'f1': 0.5130669, 'auroc': 0.9087762, 'binary_precision': 0.1521739, 'binary_recall': 0.02892562, 'binary_specificity': 0.9934968, 'binary_f1_score': 0.048611112}
confusion matrix:
      0   1
0  5958  39
1   235   7
early stop counter: 2
val acc:0.9692643880844116, best validation acc: 0.9720342755317688, corresponding to test acc:                         0.9623336791992188 / 0.9762782454490662
after epoch: 11,now: 2024-08-01 23:13:04.054228,epoch time: 0:21:06.538395,used: 3:47:52.397649,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_19_25_11_seed_2_23919978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9933967, 'precision': 0.9934009, 'recall': 0.9933965, 'specificity': 0.9933965, 'f1': 0.99339664, 'auroc': 0.99972475, 'binary_precision': 0.991997, 'binary_recall': 0.99482095, 'binary_specificity': 0.991972, 'binary_f1_score': 0.99340695}
confusion matrix:
       0      1
0  28914    234
1    151  29005
---- Validation: 
scalar performance:
{'acc': 0.93634474, 'precision': 0.652794, 'recall': 0.87878263, 'specificity': 0.87878263, 'f1': 0.70889735, 'auroc': 0.95373815, 'binary_precision': 0.31198478, 'binary_recall': 0.81727576, 'binary_specificity': 0.9402895, 'binary_f1_score': 0.45158327}
confusion matrix:
       0     1
0  17086  1085
1    110   492
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9604103, 'precision': 0.73359853, 'recall': 0.7196673, 'specificity': 0.7196673, 'f1': 0.72638977, 'auroc': 0.9293194, 'binary_precision': 0.4889868, 'binary_recall': 0.45867768, 'binary_specificity': 0.980657, 'binary_f1_score': 0.47334754}
confusion matrix:
      0    1
0  5881  116
1   131  111
early stop counter: 3
val acc:0.9363447427749634, best validation acc: 0.9720342755317688, corresponding to test acc:                         0.9623336791992188 / 0.9762782454490662
after epoch: 12,now: 2024-08-01 23:33:35.409301,epoch time: 0:20:31.355073,used: 4:08:23.752722,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_19_25_11_seed_2_23919978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9942028, 'precision': 0.99425244, 'recall': 0.99420345, 'specificity': 0.99420345, 'f1': 0.9942027, 'auroc': 0.99972856, 'binary_precision': 0.9992378, 'binary_recall': 0.98916173, 'binary_specificity': 0.9992452, 'binary_f1_score': 0.99417424}
confusion matrix:
       0      1
0  29126     22
1    316  28840
---- Validation: 
scalar performance:
{'acc': 0.9694774, 'precision': 0.75382435, 'recall': 0.7850771, 'specificity': 0.7850771, 'f1': 0.76844645, 'auroc': 0.95343816, 'binary_precision': 0.5213549, 'binary_recall': 0.5880399, 'binary_specificity': 0.9821144, 'binary_f1_score': 0.5526932}
confusion matrix:
       0    1
0  17846  325
1    248  354
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96666133, 'precision': 0.88069665, 'recall': 0.5940408, 'specificity': 0.5940408, 'f1': 0.64479333, 'auroc': 0.93834794, 'binary_precision': 0.79310346, 'binary_recall': 0.19008264, 'binary_specificity': 0.997999, 'binary_f1_score': 0.30666664}
confusion matrix:
      0   1
0  5985  12
1   196  46
early stop counter: 4
val acc:0.9694774150848389, best validation acc: 0.9720342755317688, corresponding to test acc:                         0.9623336791992188 / 0.9762782454490662
after epoch: 13,now: 2024-08-01 23:54:02.185407,epoch time: 0:20:26.776106,used: 4:28:50.528828,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_19_25_11_seed_2_23919978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99452865, 'precision': 0.99457514, 'recall': 0.9945295, 'specificity': 0.9945295, 'f1': 0.99452853, 'auroc': 0.99979305, 'binary_precision': 0.99941117, 'binary_recall': 0.98964226, 'binary_specificity': 0.99941677, 'binary_f1_score': 0.99450266}
confusion matrix:
       0      1
0  29130     17
1    302  28855
---- Validation: 
scalar performance:
{'acc': 0.9737389, 'precision': 0.7889219, 'recall': 0.7856723, 'specificity': 0.7856723, 'f1': 0.787287, 'auroc': 0.96068656, 'binary_precision': 0.59159666, 'binary_recall': 0.58471763, 'binary_specificity': 0.98662704, 'binary_f1_score': 0.588137}
confusion matrix:
       0    1
0  17928  243
1    250  352
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.98333067, 'precision': 0.939013, 'recall': 0.82279605, 'specificity': 0.82279605, 'f1': 0.8712863, 'auroc': 0.9419278, 'binary_precision': 0.89204544, 'binary_recall': 0.6487603, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.7511961}
confusion matrix:
      0    1
0  5978   19
1    85  157
new oracle model saved
better model found
persisted
after epoch: 14,now: 2024-08-02 00:14:26.193481,epoch time: 0:20:24.008074,used: 4:49:14.536902,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_19_25_11_seed_2_23919978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9963467, 'precision': 0.99635404, 'recall': 0.9963471, 'specificity': 0.9963471, 'f1': 0.9963467, 'auroc': 0.9997614, 'binary_precision': 0.99831283, 'binary_recall': 0.99437547, 'binary_specificity': 0.9983188, 'binary_f1_score': 0.9963403}
confusion matrix:
       0      1
0  29097     49
1    164  28994
---- Validation: 
scalar performance:
{'acc': 0.9455601, 'precision': 0.6674237, 'recall': 0.8570423, 'specificity': 0.8570423, 'f1': 0.7222464, 'auroc': 0.9489285, 'binary_precision': 0.34304932, 'binary_recall': 0.76245844, 'binary_specificity': 0.95162624, 'binary_f1_score': 0.47319588}
confusion matrix:
       0    1
0  17292  879
1    143  459
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9523962, 'precision': 0.6902418, 'recall': 0.71946406, 'specificity': 0.71946406, 'f1': 0.7036396, 'auroc': 0.9038657, 'binary_precision': 0.40213522, 'binary_recall': 0.46694216, 'binary_specificity': 0.971986, 'binary_f1_score': 0.43212235}
confusion matrix:
      0    1
0  5829  168
1   129  113
early stop counter: 1
val acc:0.945560097694397, best validation acc: 0.9737389087677002, corresponding to test acc:                         0.9833306670188904 / 0.9833306670188904
after epoch: 15,now: 2024-08-02 00:35:04.285460,epoch time: 0:20:38.091979,used: 5:09:52.628881,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_19_25_11_seed_2_23919978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9915443, 'precision': 0.99167955, 'recall': 0.9915452, 'specificity': 0.9915452, 'f1': 0.9915437, 'auroc': 0.9996846, 'binary_precision': 0.99986047, 'binary_recall': 0.98322755, 'binary_specificity': 0.9998628, 'binary_f1_score': 0.9914742}
confusion matrix:
       0      1
0  29145      4
1    489  28666
---- Validation: 
scalar performance:
{'acc': 0.9704363, 'precision': 0.79345345, 'recall': 0.6040835, 'specificity': 0.6040835, 'f1': 0.6502757, 'auroc': 0.91952896, 'binary_precision': 0.61244017, 'binary_recall': 0.21262458, 'binary_specificity': 0.99554235, 'binary_f1_score': 0.31565964}
confusion matrix:
       0    1
0  18090   81
1    474  128
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9591281, 'precision': 0.48056537, 'recall': 0.49891612, 'specificity': 0.49891612, 'f1': 0.48956886, 'auroc': 0.92554915, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5984  13
1   242   0
early stop counter: 2
val acc:0.9704362750053406, best validation acc: 0.9737389087677002, corresponding to test acc:                         0.9833306670188904 / 0.9833306670188904
after epoch: 16,now: 2024-08-02 00:55:30.349155,epoch time: 0:20:26.063695,used: 5:30:18.692576,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_19_25_11_seed_2_23919978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9944772, 'precision': 0.9944853, 'recall': 0.99447775, 'specificity': 0.99447775, 'f1': 0.9944772, 'auroc': 0.99975586, 'binary_precision': 0.9965562, 'binary_recall': 0.9923868, 'binary_specificity': 0.99656874, 'binary_f1_score': 0.99446714}
confusion matrix:
       0      1
0  29044    100
1    222  28938
---- Validation: 
scalar performance:
{'acc': 0.9704363, 'precision': 0.7763254, 'recall': 0.64503896, 'specificity': 0.64503896, 'f1': 0.6884818, 'auroc': 0.9433797, 'binary_precision': 0.5755627, 'binary_recall': 0.29734218, 'binary_specificity': 0.9927357, 'binary_f1_score': 0.39211392}
confusion matrix:
       0    1
0  18039  132
1    423  179
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9679436, 'precision': 0.8938633, 'recall': 0.6105698, 'specificity': 0.6105698, 'f1': 0.6671077, 'auroc': 0.9532583, 'binary_precision': 0.8181818, 'binary_recall': 0.2231405, 'binary_specificity': 0.997999, 'binary_f1_score': 0.35064933}
confusion matrix:
      0   1
0  5985  12
1   188  54
early stop counter: 3
val acc:0.9704362750053406, best validation acc: 0.9737389087677002, corresponding to test acc:                         0.9833306670188904 / 0.9833306670188904
after epoch: 17,now: 2024-08-02 01:16:00.076535,epoch time: 0:20:29.727380,used: 5:50:48.419956,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_19_25_11_seed_2_23919978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99708426, 'precision': 0.99709886, 'recall': 0.9970846, 'specificity': 0.9970846, 'f1': 0.99708426, 'auroc': 0.99991083, 'binary_precision': 0.99982756, 'binary_recall': 0.9943408, 'binary_specificity': 0.99982846, 'binary_f1_score': 0.99707663}
confusion matrix:
       0      1
0  29143      5
1    165  28991
---- Validation: 
scalar performance:
{'acc': 0.97144836, 'precision': 0.78352803, 'recall': 0.67928976, 'specificity': 0.67928976, 'f1': 0.71864253, 'auroc': 0.9617717, 'binary_precision': 0.58776593, 'binary_recall': 0.36710963, 'binary_specificity': 0.9914699, 'binary_f1_score': 0.4519427}
confusion matrix:
       0    1
0  18016  155
1    381  221
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95832664, 'precision': 0.5904448, 'recall': 0.51237845, 'specificity': 0.51237845, 'f1': 0.5148952, 'auroc': 0.94887716, 'binary_precision': 0.21875, 'binary_recall': 0.02892562, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.051094886}
confusion matrix:
      0   1
0  5972  25
1   235   7
early stop counter: 4
val acc:0.9714483618736267, best validation acc: 0.9737389087677002, corresponding to test acc:                         0.9833306670188904 / 0.9833306670188904
after epoch: 18,now: 2024-08-02 01:36:36.314612,epoch time: 0:20:36.238077,used: 6:11:24.658033,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_19_25_11_seed_2_23919978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99228185, 'precision': 0.99236333, 'recall': 0.99228317, 'specificity': 0.99228317, 'f1': 0.9922815, 'auroc': 0.9996727, 'binary_precision': 0.99874914, 'binary_recall': 0.9858015, 'binary_specificity': 0.9987648, 'binary_f1_score': 0.99223304}
confusion matrix:
       0      1
0  29110     36
1    414  28744
---- Validation: 
scalar performance:
{'acc': 0.9695307, 'precision': 0.81533253, 'recall': 0.5506145, 'specificity': 0.5506145, 'f1': 0.5813193, 'auroc': 0.9408833, 'binary_precision': 0.65957445, 'binary_recall': 0.10299003, 'binary_specificity': 0.998239, 'binary_f1_score': 0.17816092}
confusion matrix:
       0   1
0  18139  32
1    540  62
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9604103, 'precision': 0.4805903, 'recall': 0.49958313, 'specificity': 0.49958313, 'f1': 0.4899027, 'auroc': 0.9276277, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5992  5
1   242  0
early stop counter: 5
val acc:0.9695307016372681, best validation acc: 0.9737389087677002, corresponding to test acc:                         0.9833306670188904 / 0.9833306670188904
after epoch: 19,now: 2024-08-02 01:57:22.874543,epoch time: 0:20:46.559931,used: 6:32:11.217964,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_19_25_11_seed_2_23919978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9969127, 'precision': 0.9969231, 'recall': 0.9969132, 'specificity': 0.9969132, 'f1': 0.9969127, 'auroc': 0.9998648, 'binary_precision': 0.99924195, 'binary_recall': 0.9945812, 'binary_specificity': 0.99924517, 'binary_f1_score': 0.99690616}
confusion matrix:
       0      1
0  29124     22
1    158  29000
---- Validation: 
scalar performance:
{'acc': 0.9701699, 'precision': 0.782003, 'recall': 0.6127794, 'specificity': 0.6127794, 'f1': 0.6582433, 'auroc': 0.9406126, 'binary_precision': 0.58898306, 'binary_recall': 0.23089701, 'binary_specificity': 0.9946618, 'binary_f1_score': 0.33174223}
confusion matrix:
       0    1
0  18074   97
1    463  139
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.7311988, 'recall': 0.5158619, 'specificity': 0.5158619, 'f1': 0.52110595, 'auroc': 0.95208275, 'binary_precision': 0.5, 'binary_recall': 0.03305785, 'binary_specificity': 0.998666, 'binary_f1_score': 0.0620155}
confusion matrix:
      0  1
0  5989  8
1   234  8
early stop counter: 6
val acc:0.9701699018478394, best validation acc: 0.9737389087677002, corresponding to test acc:                         0.9833306670188904 / 0.9833306670188904
after epoch: 20,now: 2024-08-02 02:18:34.530732,epoch time: 0:21:11.656189,used: 6:53:22.874153,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_19_25_11_seed_2_23919978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 6:53:22.874153 at 2024-08-02 02:18:34.530732
persisted model performance metric: 

scalar performance:
{'acc': 0.98333067, 'precision': 0.939013, 'recall': 0.82279605, 'specificity': 0.82279605, 'f1': 0.8712863, 'auroc': 0.9419278, 'binary_precision': 0.89204544, 'binary_recall': 0.6487603, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.7511961}
confusion matrix:
      0    1
0  5978   19
1    85  157
oracle model performance metric: 

scalar performance:
{'acc': 0.98333067, 'precision': 0.939013, 'recall': 0.82279605, 'specificity': 0.82279605, 'f1': 0.8712863, 'auroc': 0.9419278, 'binary_precision': 0.89204544, 'binary_recall': 0.6487603, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.7511961}
confusion matrix:
      0    1
0  5978   19
1    85  157
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_12-46-56/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_12-46-56/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456832 KiB |  13220 MiB |   1655 TiB |   1655 TiB |
|       from large pool | 415151 KiB |  13181 MiB |   1633 TiB |   1633 TiB |
|       from small pool |  41681 KiB |     61 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 456832 KiB |  13220 MiB |   1655 TiB |   1655 TiB |
|       from large pool | 415151 KiB |  13181 MiB |   1633 TiB |   1633 TiB |
|       from small pool |  41681 KiB |     61 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447753 KiB |  13213 MiB |   1654 TiB |   1654 TiB |
|       from large pool | 407075 KiB |  13175 MiB |   1631 TiB |   1631 TiB |
|       from small pool |  40678 KiB |     60 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14472 MiB |  14484 MiB |  41672 MiB |  27200 MiB |
|       from large pool |  14406 MiB |  14412 MiB |  41570 MiB |  27164 MiB |
|       from small pool |     66 MiB |     72 MiB |    102 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 464767 KiB |   1235 MiB |   1264 TiB |   1264 TiB |
|       from large pool | 455249 KiB |   1232 MiB |   1242 TiB |   1242 TiB |
|       from small pool |   9518 KiB |     42 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3476    |    8293    |  328774 K  |  328771 K  |
|       from large pool |     187    |    1413    |  154813 K  |  154812 K  |
|       from small pool |    3289    |    8104    |  173961 K  |  173958 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3476    |    8293    |  328774 K  |  328771 K  |
|       from large pool |     187    |    1413    |  154813 K  |  154812 K  |
|       from small pool |    3289    |    8104    |  173961 K  |  173958 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     635    |     638    |    1783    |    1148    |
|       from large pool |     602    |     602    |    1732    |    1130    |
|       from small pool |      33    |      36    |      51    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      74    |    3704    |  193687 K  |  193687 K  |
|       from large pool |      36    |     605    |  107973 K  |  107973 K  |
|       from small pool |      38    |    3668    |   85713 K  |   85713 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13220 MiB |   1655 TiB |   1655 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1633 TiB |   1633 TiB |
|       from small pool |      0 KiB |     61 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13220 MiB |   1655 TiB |   1655 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1633 TiB |   1633 TiB |
|       from small pool |      0 KiB |     61 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   1654 TiB |   1654 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   1631 TiB |   1631 TiB |
|       from small pool |      0 KiB |     60 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    900 MiB |  14484 MiB |  41672 MiB |  40772 MiB |
|       from large pool |    850 MiB |  14412 MiB |  41570 MiB |  40720 MiB |
|       from small pool |     50 MiB |     72 MiB |    102 MiB |     52 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1235 MiB |   1264 TiB |   1264 TiB |
|       from large pool |  24320 KiB |   1232 MiB |   1242 TiB |   1242 TiB |
|       from small pool |      0 KiB |     44 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8293    |  328774 K  |  328774 K  |
|       from large pool |       2    |    1413    |  154813 K  |  154813 K  |
|       from small pool |       0    |    8104    |  173961 K  |  173961 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8293    |  328774 K  |  328774 K  |
|       from large pool |       2    |    1413    |  154813 K  |  154813 K  |
|       from small pool |       0    |    8104    |  173961 K  |  173961 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     638    |    1783    |    1720    |
|       from large pool |      38    |     602    |    1732    |    1694    |
|       from small pool |      25    |      36    |      51    |      26    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3704    |  193688 K  |  193688 K  |
|       from large pool |       3    |     605    |  107973 K  |  107973 K  |
|       from small pool |       0    |    3668    |   85715 K  |   85715 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Fri Aug  2 02:19:57 2024]
Finished job 0.
1 of 1 steps (100%) done
