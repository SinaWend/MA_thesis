Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Wed Jul 31 12:55:23 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_12-46-56/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_12-46-56/rule_results/16.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=16
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_01_04_seed_0_23857232

 Experiment start at: 2024-07-31 13:01:04.598185
before training, model accuracy: 0.7297859191894531
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.7030509, 'precision': 0.7030629, 'recall': 0.7030535, 'specificity': 0.7030535, 'f1': 0.7030481, 'auroc': 0.7652955, 'binary_precision': 0.70481676, 'binary_recall': 0.6994878, 'binary_specificity': 0.7066192, 'binary_f1_score': 0.7021422}
confusion matrix:
       0      1
0  20251   8408
1   8625  20076
---- Validation: 
scalar performance:
{'acc': 0.7786824, 'precision': 0.53666455, 'recall': 0.69565666, 'specificity': 0.69565666, 'f1': 0.5152629, 'auroc': 0.7755865, 'binary_precision': 0.09078212, 'binary_recall': 0.60653186, 'binary_specificity': 0.7847815, 'binary_f1_score': 0.15792671}
confusion matrix:
       0     1
0  14243  3906
1    253   390
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75854903, 'precision': 0.53947085, 'recall': 0.68529, 'specificity': 0.68529, 'f1': 0.5158004, 'auroc': 0.7584661, 'binary_precision': 0.100894, 'binary_recall': 0.60536397, 'binary_specificity': 0.76521593, 'binary_f1_score': 0.17296115}
confusion matrix:
      0     1
0  4589  1408
1   103   158
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-31 13:17:37.905647,epoch time: 0:16:33.307462,used: 0:16:33.307462,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_01_04_seed_0_23857232
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.80899584, 'precision': 0.80901134, 'recall': 0.80899304, 'specificity': 0.80899304, 'f1': 0.8089924, 'auroc': 0.8848146, 'binary_precision': 0.80700296, 'binary_recall': 0.8126263, 'binary_specificity': 0.8053598, 'binary_f1_score': 0.80980486}
confusion matrix:
       0      1
0  23080   5578
1   5378  23324
---- Validation: 
scalar performance:
{'acc': 0.8340783, 'precision': 0.5533851, 'recall': 0.73258656, 'specificity': 0.73258656, 'f1': 0.55598533, 'auroc': 0.8062783, 'binary_precision': 0.12236802, 'binary_recall': 0.62363917, 'binary_specificity': 0.84153396, 'binary_f1_score': 0.20459183}
confusion matrix:
       0     1
0  15273  2876
1    242   401
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82070947, 'precision': 0.56177694, 'recall': 0.73971087, 'specificity': 0.73971087, 'f1': 0.5655282, 'auroc': 0.8173229, 'binary_precision': 0.14154871, 'binary_recall': 0.651341, 'binary_specificity': 0.8280807, 'binary_f1_score': 0.23255815}
confusion matrix:
      0     1
0  4966  1031
1    91   170
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-31 13:33:28.840698,epoch time: 0:15:50.935051,used: 0:32:24.242513,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_01_04_seed_0_23857232
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.8405509, 'precision': 0.8406414, 'recall': 0.8405577, 'specificity': 0.8405577, 'f1': 0.84054214, 'auroc': 0.9176234, 'binary_precision': 0.84640455, 'binary_recall': 0.83242756, 'binary_specificity': 0.8486879, 'binary_f1_score': 0.8393579}
confusion matrix:
       0      1
0  24320   4336
1   4810  23894
---- Validation: 
scalar performance:
{'acc': 0.8660068, 'precision': 0.56396735, 'recall': 0.73336524, 'specificity': 0.73336524, 'f1': 0.5792252, 'auroc': 0.8185495, 'binary_precision': 0.14421253, 'binary_recall': 0.59097975, 'binary_specificity': 0.8757507, 'binary_f1_score': 0.23184869}
confusion matrix:
       0     1
0  15894  2255
1    263   380
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8525088, 'precision': 0.5790941, 'recall': 0.7691288, 'specificity': 0.7691288, 'f1': 0.5975437, 'auroc': 0.84733295, 'binary_precision': 0.1742126, 'binary_recall': 0.6781609, 'binary_specificity': 0.8600967, 'binary_f1_score': 0.27721223}
confusion matrix:
      0    1
0  5158  839
1    84  177
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-31 13:49:18.903606,epoch time: 0:15:50.062908,used: 0:48:14.305421,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_01_04_seed_0_23857232
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.8613145, 'precision': 0.861333, 'recall': 0.8613174, 'specificity': 0.8613174, 'f1': 0.86131334, 'auroc': 0.93474853, 'binary_precision': 0.86412776, 'binary_recall': 0.85771525, 'binary_specificity': 0.86491954, 'binary_f1_score': 0.8609095}
confusion matrix:
       0      1
0  24786   3871
1   4084  24619
---- Validation: 
scalar performance:
{'acc': 0.87031716, 'precision': 0.5679576, 'recall': 0.7430973, 'specificity': 0.7430973, 'f1': 0.58577543, 'auroc': 0.8264003, 'binary_precision': 0.15151516, 'binary_recall': 0.60653186, 'binary_specificity': 0.8796628, 'binary_f1_score': 0.24246193}
confusion matrix:
       0     1
0  15965  2184
1    253   390
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85027164, 'precision': 0.5827407, 'recall': 0.78994954, 'specificity': 0.78994954, 'f1': 0.6018996, 'auroc': 0.8659585, 'binary_precision': 0.1793169, 'binary_recall': 0.7241379, 'binary_specificity': 0.85576123, 'binary_f1_score': 0.2874525}
confusion matrix:
      0    1
0  5132  865
1    72  189
better model found
persisted
after epoch: 4,now: 2024-07-31 14:05:49.050224,epoch time: 0:16:30.146618,used: 1:04:44.452039,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_01_04_seed_0_23857232
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.8734484, 'precision': 0.874147, 'recall': 0.8734658, 'specificity': 0.8734658, 'f1': 0.8733929, 'auroc': 0.9444419, 'binary_precision': 0.89051574, 'binary_recall': 0.8518273, 'binary_specificity': 0.89510417, 'binary_f1_score': 0.870742}
confusion matrix:
       0      1
0  25651   3006
1   4253  24450
---- Validation: 
scalar performance:
{'acc': 0.89149636, 'precision': 0.5805796, 'recall': 0.74806166, 'specificity': 0.74806166, 'f1': 0.60697055, 'auroc': 0.8305508, 'binary_precision': 0.17685185, 'binary_recall': 0.5940902, 'binary_specificity': 0.90203315, 'binary_f1_score': 0.2725651}
confusion matrix:
       0     1
0  16371  1778
1    261   382
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87216365, 'precision': 0.5963131, 'recall': 0.80137193, 'specificity': 0.80137193, 'f1': 0.6251618, 'auroc': 0.87818766, 'binary_precision': 0.20610687, 'binary_recall': 0.7241379, 'binary_specificity': 0.87860596, 'binary_f1_score': 0.32088283}
confusion matrix:
      0    1
0  5269  728
1    72  189
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-31 14:21:51.301121,epoch time: 0:16:02.250897,used: 1:20:46.702936,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_01_04_seed_0_23857232
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.8831067, 'precision': 0.8832114, 'recall': 0.883114, 'specificity': 0.883114, 'f1': 0.88310003, 'auroc': 0.95130193, 'binary_precision': 0.8897669, 'binary_recall': 0.8747953, 'binary_specificity': 0.8914326, 'binary_f1_score': 0.8822176}
confusion matrix:
       0      1
0  25544   3111
1   3594  25111
---- Validation: 
scalar performance:
{'acc': 0.87712854, 'precision': 0.57332706, 'recall': 0.75262415, 'specificity': 0.75262415, 'f1': 0.5946962, 'auroc': 0.8346146, 'binary_precision': 0.16165718, 'binary_recall': 0.61897355, 'binary_specificity': 0.88627476, 'binary_f1_score': 0.2563607}
confusion matrix:
       0     1
0  16085  2064
1    245   398
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85107064, 'precision': 0.58787674, 'recall': 0.81235445, 'specificity': 0.81235445, 'f1': 0.60900056, 'auroc': 0.8872131, 'binary_precision': 0.18732525, 'binary_recall': 0.77011496, 'binary_specificity': 0.854594, 'binary_f1_score': 0.30134934}
confusion matrix:
      0    1
0  5125  872
1    60  201
early stop counter: 1
val acc:0.877128541469574, best validation acc: 0.8914963603019714, corresponding to test acc:                         0.8721636533737183 / 0.8721636533737183
after epoch: 6,now: 2024-07-31 14:38:01.664143,epoch time: 0:16:10.363022,used: 1:36:57.065958,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_01_04_seed_0_23857232
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.89030683, 'precision': 0.8910706, 'recall': 0.8903207, 'specificity': 0.8903207, 'f1': 0.8902557, 'auroc': 0.95600617, 'binary_precision': 0.9085108, 'binary_recall': 0.86817896, 'binary_specificity': 0.9124625, 'binary_f1_score': 0.8878871}
confusion matrix:
       0      1
0  26153   2509
1   3783  24915
---- Validation: 
scalar performance:
{'acc': 0.88809067, 'precision': 0.5792361, 'recall': 0.7515489, 'specificity': 0.7515489, 'f1': 0.60472256, 'auroc': 0.83622086, 'binary_precision': 0.1738159, 'binary_recall': 0.60497665, 'binary_specificity': 0.8981211, 'binary_f1_score': 0.27004513}
confusion matrix:
       0     1
0  16300  1849
1    254   389
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8684883, 'precision': 0.5985863, 'recall': 0.82144237, 'specificity': 0.82144237, 'f1': 0.6276367, 'auroc': 0.89369714, 'binary_precision': 0.20850623, 'binary_recall': 0.77011496, 'binary_specificity': 0.8727697, 'binary_f1_score': 0.32816327}
confusion matrix:
      0    1
0  5234  763
1    60  201
early stop counter: 2
val acc:0.8880906701087952, best validation acc: 0.8914963603019714, corresponding to test acc:                         0.8721636533737183 / 0.8721636533737183
after epoch: 7,now: 2024-07-31 14:54:40.754188,epoch time: 0:16:39.090045,used: 1:53:36.156003,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_01_04_seed_0_23857232
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.8965307, 'precision': 0.89675236, 'recall': 0.89654064, 'specificity': 0.89654064, 'f1': 0.8965179, 'auroc': 0.9593948, 'binary_precision': 0.90634257, 'binary_recall': 0.88465023, 'binary_specificity': 0.90843105, 'binary_f1_score': 0.89536506}
confusion matrix:
       0      1
0  26032   2624
1   3311  25393
---- Validation: 
scalar performance:
{'acc': 0.87100893, 'precision': 0.57290727, 'recall': 0.764457, 'specificity': 0.764457, 'f1': 0.5929103, 'auroc': 0.838902, 'binary_precision': 0.15972488, 'binary_recall': 0.65007776, 'binary_specificity': 0.8788363, 'binary_f1_score': 0.2564417}
confusion matrix:
       0     1
0  15950  2199
1    225   418
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8449984, 'precision': 0.5884042, 'recall': 0.8275095, 'specificity': 0.8275095, 'f1': 0.607981, 'auroc': 0.89884984, 'binary_precision': 0.18656057, 'binary_recall': 0.8084291, 'binary_specificity': 0.84659, 'binary_f1_score': 0.30316094}
confusion matrix:
      0    1
0  5077  920
1    50  211
early stop counter: 3
val acc:0.8710089325904846, best validation acc: 0.8914963603019714, corresponding to test acc:                         0.8721636533737183 / 0.8721636533737183
after epoch: 8,now: 2024-07-31 15:11:02.183643,epoch time: 0:16:21.429455,used: 2:09:57.585458,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_01_04_seed_0_23857232
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.90148187, 'precision': 0.902112, 'recall': 0.9014957, 'specificity': 0.9014957, 'f1': 0.90144545, 'auroc': 0.9623943, 'binary_precision': 0.9182059, 'binary_recall': 0.88163763, 'binary_specificity': 0.9213538, 'binary_f1_score': 0.8995503}
confusion matrix:
       0      1
0  26406   2254
1   3397  25303
---- Validation: 
scalar performance:
{'acc': 0.88394, 'precision': 0.5776474, 'recall': 0.7554004, 'specificity': 0.7554004, 'f1': 0.6019362, 'auroc': 0.8388064, 'binary_precision': 0.17024013, 'binary_recall': 0.61741835, 'binary_specificity': 0.89338255, 'binary_f1_score': 0.26689076}
confusion matrix:
       0     1
0  16214  1935
1    246   397
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8640141, 'precision': 0.5975623, 'recall': 0.8282695, 'specificity': 0.8282695, 'f1': 0.6252916, 'auroc': 0.9019753, 'binary_precision': 0.20558882, 'binary_recall': 0.789272, 'binary_specificity': 0.86726695, 'binary_f1_score': 0.32620743}
confusion matrix:
      0    1
0  5201  796
1    55  206
early stop counter: 4
val acc:0.8839399814605713, best validation acc: 0.8914963603019714, corresponding to test acc:                         0.8721636533737183 / 0.8721636533737183
after epoch: 9,now: 2024-07-31 15:27:01.510140,epoch time: 0:15:59.326497,used: 2:25:56.911955,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_01_04_seed_0_23857232
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9066597, 'precision': 0.9071009, 'recall': 0.9066712, 'specificity': 0.9066712, 'f1': 0.90663606, 'auroc': 0.9650301, 'binary_precision': 0.920679, 'binary_recall': 0.8901394, 'binary_specificity': 0.92320305, 'binary_f1_score': 0.9051516}
confusion matrix:
       0      1
0  26459   2201
1   3153  25547
---- Validation: 
scalar performance:
{'acc': 0.8717007, 'precision': 0.57266843, 'recall': 0.76181495, 'specificity': 0.76181495, 'f1': 0.59271747, 'auroc': 0.84083885, 'binary_precision': 0.15947612, 'binary_recall': 0.64385694, 'binary_specificity': 0.87977296, 'binary_f1_score': 0.25563446}
confusion matrix:
       0     1
0  15967  2182
1    229   414
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84595716, 'precision': 0.589652, 'recall': 0.83167446, 'specificity': 0.83167446, 'f1': 0.60991544, 'auroc': 0.90506816, 'binary_precision': 0.18866253, 'binary_recall': 0.81609195, 'binary_specificity': 0.84725696, 'binary_f1_score': 0.30647478}
confusion matrix:
      0    1
0  5081  916
1    48  213
early stop counter: 5
val acc:0.8717007040977478, best validation acc: 0.8914963603019714, corresponding to test acc:                         0.8721636533737183 / 0.8721636533737183
after epoch: 10,now: 2024-07-31 15:42:50.859927,epoch time: 0:15:49.349787,used: 2:41:46.261742,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_01_04_seed_0_23857232
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9106869, 'precision': 0.9115131, 'recall': 0.9107065, 'specificity': 0.9107065, 'f1': 0.91064477, 'auroc': 0.96705204, 'binary_precision': 0.9301715, 'binary_recall': 0.8882076, 'binary_specificity': 0.93320537, 'binary_f1_score': 0.9087053}
confusion matrix:
       0      1
0  26741   1914
1   3209  25496
---- Validation: 
scalar performance:
{'acc': 0.88080037, 'precision': 0.5765315, 'recall': 0.7582754, 'specificity': 0.7582754, 'f1': 0.5998766, 'auroc': 0.8408211, 'binary_precision': 0.16770703, 'binary_recall': 0.62674963, 'binary_specificity': 0.8898011, 'binary_f1_score': 0.2646093}
confusion matrix:
       0     1
0  16149  2000
1    240   403
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86193675, 'precision': 0.59776825, 'recall': 0.834515, 'specificity': 0.834515, 'f1': 0.6250899, 'auroc': 0.90717256, 'binary_precision': 0.20527859, 'binary_recall': 0.8045977, 'binary_specificity': 0.8644322, 'binary_f1_score': 0.3271028}
confusion matrix:
      0    1
0  5184  813
1    51  210
early stop counter: 6
val acc:0.8808003664016724, best validation acc: 0.8914963603019714, corresponding to test acc:                         0.8721636533737183 / 0.8721636533737183
after epoch: 11,now: 2024-07-31 15:58:43.969244,epoch time: 0:15:53.109317,used: 2:57:39.371059,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_01_04_seed_0_23857232
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9113668, 'precision': 0.91264796, 'recall': 0.9113863, 'specificity': 0.9113863, 'f1': 0.91130066, 'auroc': 0.9685637, 'binary_precision': 0.93581605, 'binary_recall': 0.8834495, 'binary_specificity': 0.9393231, 'binary_f1_score': 0.9088791}
confusion matrix:
       0      1
0  26921   1739
1   3345  25355
---- Validation: 
scalar performance:
{'acc': 0.88527036, 'precision': 0.57858115, 'recall': 0.7560892, 'specificity': 0.7560892, 'f1': 0.6034508, 'auroc': 0.84169996, 'binary_precision': 0.17208496, 'binary_recall': 0.61741835, 'binary_specificity': 0.89476, 'binary_f1_score': 0.26915252}
confusion matrix:
       0     1
0  16239  1910
1    246   397
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8665708, 'precision': 0.6004054, 'recall': 0.83510053, 'specificity': 0.83510053, 'f1': 0.6297314, 'auroc': 0.90872824, 'binary_precision': 0.21068548, 'binary_recall': 0.8007663, 'binary_specificity': 0.8694347, 'binary_f1_score': 0.33359936}
confusion matrix:
      0    1
0  5214  783
1    52  209
early stop counter: 7
val acc:0.885270357131958, best validation acc: 0.8914963603019714, corresponding to test acc:                         0.8721636533737183 / 0.8721636533737183
after epoch: 12,now: 2024-07-31 16:14:50.424160,epoch time: 0:16:06.454916,used: 3:13:45.825975,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_01_04_seed_0_23857232
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9152371, 'precision': 0.9162923, 'recall': 0.9152547, 'specificity': 0.9152547, 'f1': 0.9151857, 'auroc': 0.97085506, 'binary_precision': 0.9374266, 'binary_recall': 0.89, 'binary_specificity': 0.94050944, 'binary_f1_score': 0.91309786}
confusion matrix:
       0      1
0  26955   1705
1   3157  25543
---- Validation: 
scalar performance:
{'acc': 0.88793105, 'precision': 0.5801635, 'recall': 0.75596654, 'specificity': 0.75596654, 'f1': 0.6060387, 'auroc': 0.8439108, 'binary_precision': 0.17532179, 'binary_recall': 0.61430794, 'binary_specificity': 0.8976252, 'binary_f1_score': 0.27279007}
confusion matrix:
       0     1
0  16291  1858
1    248   395
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87040585, 'precision': 0.6030396, 'recall': 0.83710146, 'specificity': 0.83710146, 'f1': 0.63413066, 'auroc': 0.91071403, 'binary_precision': 0.2159091, 'binary_recall': 0.8007663, 'binary_specificity': 0.8734367, 'binary_f1_score': 0.3401139}
confusion matrix:
      0    1
0  5238  759
1    52  209
early stop counter: 8
val acc:0.8879310488700867, best validation acc: 0.8914963603019714, corresponding to test acc:                         0.8721636533737183 / 0.8721636533737183
after epoch: 13,now: 2024-07-31 16:30:38.691804,epoch time: 0:15:48.267644,used: 3:29:34.093619,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_01_04_seed_0_23857232
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.91694564, 'precision': 0.917665, 'recall': 0.91696304, 'specificity': 0.91696304, 'f1': 0.9169121, 'auroc': 0.9716022, 'binary_precision': 0.93520945, 'binary_recall': 0.896112, 'binary_specificity': 0.93781406, 'binary_f1_score': 0.9152434}
confusion matrix:
       0      1
0  26874   1782
1   2982  25722
---- Validation: 
scalar performance:
{'acc': 0.8761707, 'precision': 0.57553446, 'recall': 0.7648792, 'specificity': 0.7648792, 'f1': 0.5976578, 'auroc': 0.84678227, 'binary_precision': 0.16507557, 'binary_recall': 0.64541215, 'binary_specificity': 0.88434625, 'binary_f1_score': 0.2629078}
confusion matrix:
       0     1
0  16050  2099
1    228   415
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8526686, 'precision': 0.59370893, 'recall': 0.8370086, 'specificity': 0.8370086, 'f1': 0.6172325, 'auroc': 0.91310537, 'binary_precision': 0.19651055, 'binary_recall': 0.8199234, 'binary_specificity': 0.85409373, 'binary_f1_score': 0.31703705}
confusion matrix:
      0    1
0  5122  875
1    47  214
early stop counter: 9
val acc:0.8761706948280334, best validation acc: 0.8914963603019714, corresponding to test acc:                         0.8721636533737183 / 0.8721636533737183
after epoch: 14,now: 2024-07-31 16:46:31.982618,epoch time: 0:15:53.290814,used: 3:45:27.384433,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_01_04_seed_0_23857232
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9204149, 'precision': 0.9211826, 'recall': 0.92043066, 'specificity': 0.92043066, 'f1': 0.9203806, 'auroc': 0.9732082, 'binary_precision': 0.9393476, 'binary_recall': 0.8989931, 'binary_specificity': 0.9418682, 'binary_f1_score': 0.9187274}
confusion matrix:
       0      1
0  26993   1666
1   2899  25802
---- Validation: 
scalar performance:
{'acc': 0.87462753, 'precision': 0.57490504, 'recall': 0.76558036, 'specificity': 0.76558036, 'f1': 0.59647083, 'auroc': 0.84669375, 'binary_precision': 0.16372202, 'binary_recall': 0.64852256, 'binary_specificity': 0.88263816, 'binary_f1_score': 0.261442}
confusion matrix:
       0     1
0  16019  2130
1    226   417
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8517098, 'precision': 0.5931653, 'recall': 0.8365083, 'specificity': 0.8365083, 'f1': 0.61624, 'auroc': 0.91443074, 'binary_precision': 0.1954338, 'binary_recall': 0.8199234, 'binary_specificity': 0.8530932, 'binary_f1_score': 0.3156342}
confusion matrix:
      0    1
0  5116  881
1    47  214
early stop counter: 10
val acc:0.8746275305747986, best validation acc: 0.8914963603019714, corresponding to test acc:                         0.8721636533737183 / 0.8721636533737183
after epoch: 15,now: 2024-07-31 17:02:20.130763,epoch time: 0:15:48.148145,used: 4:01:15.532578,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_01_04_seed_0_23857232
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.92095536, 'precision': 0.9213238, 'recall': 0.9209678, 'specificity': 0.9209678, 'f1': 0.92093956, 'auroc': 0.9735869, 'binary_precision': 0.9339941, 'binary_recall': 0.90607584, 'binary_specificity': 0.93585986, 'binary_f1_score': 0.91982317}
confusion matrix:
       0      1
0  26818   1838
1   2696  26008
---- Validation: 
scalar performance:
{'acc': 0.85445935, 'precision': 0.5682039, 'recall': 0.7753905, 'specificity': 0.7753905, 'f1': 0.58228356, 'auroc': 0.8481461, 'binary_precision': 0.14899328, 'binary_recall': 0.6905132, 'binary_specificity': 0.86026776, 'binary_f1_score': 0.24510072}
confusion matrix:
       0     1
0  15613  2536
1    199   444
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.831256, 'precision': 0.5849876, 'recall': 0.8368303, 'specificity': 0.8368303, 'f1': 0.59914595, 'auroc': 0.91595674, 'binary_precision': 0.17813765, 'binary_recall': 0.8429119, 'binary_specificity': 0.83074874, 'binary_f1_score': 0.29411766}
confusion matrix:
      0     1
0  4982  1015
1    41   220
early stop counter: 11
val acc:0.8544593453407288, best validation acc: 0.8914963603019714, corresponding to test acc:                         0.8721636533737183 / 0.8721636533737183
after epoch: 16,now: 2024-07-31 17:18:11.982439,epoch time: 0:15:51.851676,used: 4:17:07.384254,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_01_04_seed_0_23857232
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9212343, 'precision': 0.92172486, 'recall': 0.9212487, 'specificity': 0.9212487, 'f1': 0.92121315, 'auroc': 0.97409, 'binary_precision': 0.9363184, 'binary_recall': 0.90409005, 'binary_specificity': 0.9384073, 'binary_f1_score': 0.91992205}
confusion matrix:
       0      1
0  26891   1765
1   2753  25951
---- Validation: 
scalar performance:
{'acc': 0.8600468, 'precision': 0.5697545, 'recall': 0.7722828, 'specificity': 0.7722828, 'f1': 0.5859169, 'auroc': 0.8481184, 'binary_precision': 0.15250087, 'binary_recall': 0.67807156, 'binary_specificity': 0.866494, 'binary_f1_score': 0.24900056}
confusion matrix:
       0     1
0  15726  2423
1    207   436
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8384468, 'precision': 0.58766663, 'recall': 0.8369175, 'specificity': 0.8369175, 'f1': 0.60498846, 'auroc': 0.9167342, 'binary_precision': 0.18381113, 'binary_recall': 0.83524907, 'binary_specificity': 0.838586, 'binary_f1_score': 0.3013131}
confusion matrix:
      0    1
0  5029  968
1    43  218
early stop counter: 12
val acc:0.8600468039512634, best validation acc: 0.8914963603019714, corresponding to test acc:                         0.8721636533737183 / 0.8721636533737183
after epoch: 17,now: 2024-07-31 17:34:01.661646,epoch time: 0:15:49.679207,used: 4:32:57.063461,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_01_04_seed_0_23857232
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.92440724, 'precision': 0.9245788, 'recall': 0.9244154, 'specificity': 0.9244154, 'f1': 0.92440057, 'auroc': 0.9750323, 'binary_precision': 0.9333144, 'binary_recall': 0.91425985, 'binary_specificity': 0.93457097, 'binary_f1_score': 0.9236889}
confusion matrix:
       0      1
0  26782   1875
1   2461  26242
---- Validation: 
scalar performance:
{'acc': 0.84956366, 'precision': 0.5663756, 'recall': 0.7751061, 'specificity': 0.7751061, 'f1': 0.5783873, 'auroc': 0.8486686, 'binary_precision': 0.14522417, 'binary_recall': 0.69517887, 'binary_specificity': 0.85503334, 'binary_f1_score': 0.24025801}
confusion matrix:
       0     1
0  15518  2631
1    196   447
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83077663, 'precision': 0.5847693, 'recall': 0.83658016, 'specificity': 0.83658016, 'f1': 0.59870243, 'auroc': 0.9173252, 'binary_precision': 0.17770597, 'binary_recall': 0.8429119, 'binary_specificity': 0.8302485, 'binary_f1_score': 0.29352903}
confusion matrix:
      0     1
0  4979  1018
1    41   220
early stop counter: 13
val acc:0.8495636582374573, best validation acc: 0.8914963603019714, corresponding to test acc:                         0.8721636533737183 / 0.8721636533737183
after epoch: 18,now: 2024-07-31 17:49:54.768215,epoch time: 0:15:53.106569,used: 4:48:50.170030,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_01_04_seed_0_23857232
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.92425036, 'precision': 0.925091, 'recall': 0.92426825, 'specificity': 0.92426825, 'f1': 0.92421496, 'auroc': 0.976257, 'binary_precision': 0.94419724, 'binary_recall': 0.90192664, 'binary_specificity': 0.9466099, 'binary_f1_score': 0.922578}
confusion matrix:
       0      1
0  27127   1530
1   2815  25888
---- Validation: 
scalar performance:
{'acc': 0.86696464, 'precision': 0.57156664, 'recall': 0.7668636, 'specificity': 0.7668636, 'f1': 0.5901315, 'auroc': 0.84836036, 'binary_precision': 0.15674676, 'binary_recall': 0.65940905, 'binary_specificity': 0.8743181, 'binary_f1_score': 0.25328553}
confusion matrix:
       0     1
0  15868  2281
1    219   424
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8480345, 'precision': 0.59261346, 'recall': 0.84192, 'specificity': 0.84192, 'f1': 0.6144476, 'auroc': 0.9171329, 'binary_precision': 0.19360569, 'binary_recall': 0.83524907, 'binary_specificity': 0.84859097, 'binary_f1_score': 0.3143475}
confusion matrix:
      0    1
0  5089  908
1    43  218
early stop counter: 14
val acc:0.8669646382331848, best validation acc: 0.8914963603019714, corresponding to test acc:                         0.8721636533737183 / 0.8721636533737183
after epoch: 19,now: 2024-07-31 18:05:48.476054,epoch time: 0:15:53.707839,used: 5:04:43.877869,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_01_04_seed_0_23857232
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.92703974, 'precision': 0.9276764, 'recall': 0.92705667, 'specificity': 0.92705667, 'f1': 0.9270145, 'auroc': 0.9774103, 'binary_precision': 0.94439614, 'binary_recall': 0.9076468, 'binary_specificity': 0.94646657, 'binary_f1_score': 0.92565686}
confusion matrix:
       0      1
0  27121   1534
1   2651  26054
---- Validation: 
scalar performance:
{'acc': 0.8595147, 'precision': 0.5691805, 'recall': 0.77050716, 'specificity': 0.77050716, 'f1': 0.58498025, 'auroc': 0.8499353, 'binary_precision': 0.15148342, 'binary_recall': 0.6749611, 'binary_specificity': 0.8660532, 'binary_f1_score': 0.24743444}
confusion matrix:
       0     1
0  15718  2431
1    209   434
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8413231, 'precision': 0.59055066, 'recall': 0.8457476, 'specificity': 0.8457476, 'f1': 0.609674, 'auroc': 0.9187728, 'binary_precision': 0.18877551, 'binary_recall': 0.85057473, 'binary_specificity': 0.84092045, 'binary_f1_score': 0.308977}
confusion matrix:
      0    1
0  5043  954
1    39  222
early stop counter: 15
val acc:0.8595147132873535, best validation acc: 0.8914963603019714, corresponding to test acc:                         0.8721636533737183 / 0.8721636533737183
after epoch: 20,now: 2024-07-31 18:21:53.426923,epoch time: 0:16:04.950869,used: 5:20:48.828738,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_01_04_seed_0_23857232
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 5:20:48.828738 at 2024-07-31 18:21:53.426923
persisted model performance metric: 

scalar performance:
{'acc': 0.87216365, 'precision': 0.5963131, 'recall': 0.80137193, 'specificity': 0.80137193, 'f1': 0.6251618, 'auroc': 0.87818766, 'binary_precision': 0.20610687, 'binary_recall': 0.7241379, 'binary_specificity': 0.87860596, 'binary_f1_score': 0.32088283}
confusion matrix:
      0    1
0  5269  728
1    72  189
oracle model performance metric: 

scalar performance:
{'acc': 0.87216365, 'precision': 0.5963131, 'recall': 0.80137193, 'specificity': 0.80137193, 'f1': 0.6251618, 'auroc': 0.87818766, 'binary_precision': 0.20610687, 'binary_recall': 0.7241379, 'binary_specificity': 0.87860596, 'binary_f1_score': 0.32088283}
confusion matrix:
      0    1
0  5269  728
1    72  189
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_12-46-56/rule_results/16.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_12-46-56/rule_results/16.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_12-46-56/confusion_matrix/16.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 191877 KiB | 461507 KiB | 349766 GiB | 349765 GiB |
|       from large pool | 174400 KiB | 427880 KiB | 342576 GiB | 342576 GiB |
|       from small pool |  17477 KiB |  38507 KiB |   7189 GiB |   7189 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 191877 KiB | 461507 KiB | 349766 GiB | 349765 GiB |
|       from large pool | 174400 KiB | 427880 KiB | 342576 GiB | 342576 GiB |
|       from small pool |  17477 KiB |  38507 KiB |   7189 GiB |   7189 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 189283 KiB | 457564 KiB | 349745 GiB | 349744 GiB |
|       from large pool | 172814 KiB | 424940 KiB | 342572 GiB | 342572 GiB |
|       from small pool |  16469 KiB |  37503 KiB |   7172 GiB |   7172 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 509952 KiB | 509952 KiB | 509952 KiB |      0 B   |
|       from large pool | 466944 KiB | 466944 KiB | 466944 KiB |      0 B   |
|       from small pool |  43008 KiB |  43008 KiB |  43008 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  37498 KiB |  87761 KiB | 184828 GiB | 184828 GiB |
|       from large pool |  30400 KiB |  79704 KiB | 177628 GiB | 177628 GiB |
|       from small pool |   7098 KiB |   9902 KiB |   7200 GiB |   7200 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2966    |    7653    |   81088 K  |   81085 K  |
|       from large pool |      76    |     158    |   33765 K  |   33765 K  |
|       from small pool |    2890    |    7575    |   47322 K  |   47319 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2966    |    7653    |   81088 K  |   81085 K  |
|       from large pool |      76    |     158    |   33765 K  |   33765 K  |
|       from small pool |    2890    |    7575    |   47322 K  |   47319 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      42    |      42    |      42    |       0    |
|       from large pool |      21    |      21    |      21    |       0    |
|       from small pool |      21    |      21    |      21    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      30    |    3602    |   44608 K  |   44608 K  |
|       from large pool |       9    |      18    |   23011 K  |   23011 K  |
|       from small pool |      21    |    3594    |   21596 K  |   21596 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 461507 KiB | 349766 GiB | 349766 GiB |
|       from large pool |  17088 KiB | 427880 KiB | 342576 GiB | 342576 GiB |
|       from small pool |      0 KiB |  38507 KiB |   7189 GiB |   7189 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 461507 KiB | 349766 GiB | 349766 GiB |
|       from large pool |  17088 KiB | 427880 KiB | 342576 GiB | 342576 GiB |
|       from small pool |      0 KiB |  38507 KiB |   7189 GiB |   7189 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457564 KiB | 349745 GiB | 349745 GiB |
|       from large pool |  16640 KiB | 424940 KiB | 342572 GiB | 342572 GiB |
|       from small pool |      0 KiB |  37503 KiB |   7172 GiB |   7172 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 229376 KiB | 509952 KiB | 509952 KiB | 280576 KiB |
|       from large pool | 204800 KiB | 466944 KiB | 466944 KiB | 262144 KiB |
|       from small pool |  24576 KiB |  43008 KiB |  43008 KiB |  18432 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  87761 KiB | 184828 GiB | 184828 GiB |
|       from large pool |  23872 KiB |  79704 KiB | 177628 GiB | 177628 GiB |
|       from small pool |      0 KiB |  18293 KiB |   7200 GiB |   7200 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7653    |   81088 K  |   81088 K  |
|       from large pool |       2    |     158    |   33765 K  |   33765 K  |
|       from small pool |       0    |    7575    |   47322 K  |   47322 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7653    |   81088 K  |   81088 K  |
|       from large pool |       2    |     158    |   33765 K  |   33765 K  |
|       from small pool |       0    |    7575    |   47322 K  |   47322 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |      42    |      42    |      20    |
|       from large pool |      10    |      21    |      21    |      11    |
|       from small pool |      12    |      21    |      21    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3602    |   44609 K  |   44609 K  |
|       from large pool |       3    |      18    |   23011 K  |   23011 K  |
|       from small pool |       0    |    3594    |   21598 K  |   21598 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 461507 KiB | 349766 GiB | 349766 GiB |
|       from large pool |  17088 KiB | 427880 KiB | 342576 GiB | 342576 GiB |
|       from small pool |      0 KiB |  38507 KiB |   7189 GiB |   7189 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 461507 KiB | 349766 GiB | 349766 GiB |
|       from large pool |  17088 KiB | 427880 KiB | 342576 GiB | 342576 GiB |
|       from small pool |      0 KiB |  38507 KiB |   7189 GiB |   7189 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457564 KiB | 349745 GiB | 349745 GiB |
|       from large pool |  16640 KiB | 424940 KiB | 342572 GiB | 342572 GiB |
|       from small pool |      0 KiB |  37503 KiB |   7172 GiB |   7172 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 229376 KiB | 509952 KiB | 509952 KiB | 280576 KiB |
|       from large pool | 204800 KiB | 466944 KiB | 466944 KiB | 262144 KiB |
|       from small pool |  24576 KiB |  43008 KiB |  43008 KiB |  18432 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  87761 KiB | 184828 GiB | 184828 GiB |
|       from large pool |  23872 KiB |  79704 KiB | 177628 GiB | 177628 GiB |
|       from small pool |      0 KiB |  18293 KiB |   7200 GiB |   7200 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7653    |   81088 K  |   81088 K  |
|       from large pool |       2    |     158    |   33765 K  |   33765 K  |
|       from small pool |       0    |    7575    |   47322 K  |   47322 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7653    |   81088 K  |   81088 K  |
|       from large pool |       2    |     158    |   33765 K  |   33765 K  |
|       from small pool |       0    |    7575    |   47322 K  |   47322 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |      42    |      42    |      20    |
|       from large pool |      10    |      21    |      21    |      11    |
|       from small pool |      12    |      21    |      21    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3602    |   44609 K  |   44609 K  |
|       from large pool |       3    |      18    |   23011 K  |   23011 K  |
|       from small pool |       0    |    3594    |   21598 K  |   21598 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_18_29_38_seed_1_23857232

 Experiment start at: 2024-07-31 18:29:38.514210
before training, model accuracy: 0.6474379897117615
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.6290614, 'precision': 0.6305473, 'recall': 0.6290239, 'specificity': 0.6290239, 'f1': 0.627962, 'auroc': 0.6629245, 'binary_precision': 0.61679196, 'binary_recall': 0.68294716, 'binary_specificity': 0.5751007, 'binary_f1_score': 0.6481859}
confusion matrix:
       0      1
0  16556  12232
1   9140  19688
---- Validation: 
scalar performance:
{'acc': 0.8632871, 'precision': 0.49972135, 'recall': 0.49922162, 'specificity': 0.49922162, 'f1': 0.48976967, 'auroc': 0.7031267, 'binary_precision': 0.035415642, 'binary_recall': 0.106983654, 'binary_specificity': 0.8914596, 'binary_f1_score': 0.053215075}
confusion matrix:
       0     1
0  16106  1961
1    601    72
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88495004, 'precision': 0.5383081, 'recall': 0.58135724, 'specificity': 0.58135724, 'f1': 0.5461532, 'auroc': 0.7898652, 'binary_precision': 0.11130137, 'binary_recall': 0.25, 'binary_specificity': 0.9127144, 'binary_f1_score': 0.15402845}
confusion matrix:
      0    1
0  5427  519
1   195   65
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-31 18:47:59.713480,epoch time: 0:18:21.199270,used: 0:18:21.199270,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_18_29_38_seed_1_23857232
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.75843513, 'precision': 0.7585924, 'recall': 0.7584261, 'specificity': 0.7584261, 'f1': 0.758394, 'auroc': 0.8294896, 'binary_precision': 0.75239515, 'binary_recall': 0.7709251, 'binary_specificity': 0.745927, 'binary_f1_score': 0.7615475}
confusion matrix:
       0      1
0  21473   7314
1   6604  22225
---- Validation: 
scalar performance:
{'acc': 0.8800961, 'precision': 0.52068424, 'recall': 0.553001, 'specificity': 0.553001, 'f1': 0.5215013, 'auroc': 0.766838, 'binary_precision': 0.07321041, 'binary_recall': 0.20059435, 'binary_specificity': 0.90540767, 'binary_f1_score': 0.10727056}
confusion matrix:
       0     1
0  16358  1709
1    538   135
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8965517, 'precision': 0.5723317, 'recall': 0.65361524, 'specificity': 0.65361524, 'f1': 0.59191924, 'auroc': 0.83972156, 'binary_precision': 0.1729452, 'binary_recall': 0.38846153, 'binary_specificity': 0.91876894, 'binary_f1_score': 0.23933648}
confusion matrix:
      0    1
0  5463  483
1   159  101
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-31 19:04:10.438611,epoch time: 0:16:10.725131,used: 0:34:31.924401,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_18_29_38_seed_1_23857232
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.8150514, 'precision': 0.8150601, 'recall': 0.8150494, 'specificity': 0.8150494, 'f1': 0.81504935, 'auroc': 0.89426553, 'binary_precision': 0.8135763, 'binary_recall': 0.81775296, 'binary_specificity': 0.81234586, 'binary_f1_score': 0.8156593}
confusion matrix:
       0      1
0  23385   5402
1   5254  23575
---- Validation: 
scalar performance:
{'acc': 0.89364994, 'precision': 0.55295587, 'recall': 0.63227236, 'specificity': 0.63227236, 'f1': 0.5672811, 'auroc': 0.80199826, 'binary_precision': 0.13169643, 'binary_recall': 0.35066864, 'binary_specificity': 0.9138761, 'binary_f1_score': 0.19148074}
confusion matrix:
       0     1
0  16511  1556
1    437   236
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90331936, 'precision': 0.59729433, 'recall': 0.71231663, 'specificity': 0.71231663, 'f1': 0.62599814, 'auroc': 0.8655715, 'binary_precision': 0.21760798, 'binary_recall': 0.50384617, 'binary_specificity': 0.9207871, 'binary_f1_score': 0.30394432}
confusion matrix:
      0    1
0  5475  471
1   129  131
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-31 19:20:51.660341,epoch time: 0:16:41.221730,used: 0:51:13.146131,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_18_29_38_seed_1_23857232
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.8492433, 'precision': 0.84925187, 'recall': 0.84924144, 'specificity': 0.84924144, 'f1': 0.8492418, 'auroc': 0.9255899, 'binary_precision': 0.84768873, 'binary_recall': 0.8517465, 'binary_specificity': 0.8467364, 'binary_f1_score': 0.8497128}
confusion matrix:
       0      1
0  24375   4412
1   4274  24555
---- Validation: 
scalar performance:
{'acc': 0.8922092, 'precision': 0.57313234, 'recall': 0.7030519, 'specificity': 0.7030519, 'f1': 0.59578127, 'auroc': 0.82274956, 'binary_precision': 0.16641901, 'binary_recall': 0.49925706, 'binary_specificity': 0.90684676, 'binary_f1_score': 0.24962851}
confusion matrix:
       0     1
0  16384  1683
1    337   336
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8965517, 'precision': 0.60860974, 'recall': 0.77682734, 'specificity': 0.77682734, 'f1': 0.64370495, 'auroc': 0.88364446, 'binary_precision': 0.2339833, 'binary_recall': 0.64615387, 'binary_specificity': 0.90750086, 'binary_f1_score': 0.34355828}
confusion matrix:
      0    1
0  5396  550
1    92  168
early stop counter: 1
val acc:0.8922091722488403, best validation acc: 0.8936499357223511, corresponding to test acc:                         0.9033193588256836 / 0.9033193588256836
after epoch: 4,now: 2024-07-31 19:40:42.032253,epoch time: 0:19:50.371912,used: 1:11:03.518043,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_18_29_38_seed_1_23857232
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.8663392, 'precision': 0.86699116, 'recall': 0.8663546, 'specificity': 0.8663546, 'f1': 0.8662832, 'auroc': 0.94003665, 'binary_precision': 0.8826427, 'binary_recall': 0.84525996, 'binary_specificity': 0.8874492, 'binary_f1_score': 0.8635469}
confusion matrix:
       0      1
0  25547   3240
1   4461  24368
---- Validation: 
scalar performance:
{'acc': 0.91120595, 'precision': 0.5907397, 'recall': 0.7114736, 'specificity': 0.7114736, 'f1': 0.6195533, 'auroc': 0.83296657, 'binary_precision': 0.2013261, 'binary_recall': 0.4962853, 'binary_specificity': 0.92666185, 'binary_f1_score': 0.2864494}
confusion matrix:
       0     1
0  16742  1325
1    339   334
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90976477, 'precision': 0.6242734, 'recall': 0.7855617, 'specificity': 0.7855617, 'f1': 0.6638777, 'auroc': 0.894333, 'binary_precision': 0.26489028, 'binary_recall': 0.65, 'binary_specificity': 0.92112345, 'binary_f1_score': 0.37639195}
confusion matrix:
      0    1
0  5477  469
1    91  169
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-31 19:56:52.294649,epoch time: 0:16:10.262396,used: 1:27:13.780439,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_18_29_38_seed_1_23857232
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.87866217, 'precision': 0.879694, 'recall': 0.8786812, 'specificity': 0.8786812, 'f1': 0.87858343, 'auroc': 0.9493749, 'binary_precision': 0.89967054, 'binary_recall': 0.852579, 'binary_specificity': 0.9047834, 'binary_f1_score': 0.875492}
confusion matrix:
       0      1
0  26046   2741
1   4250  24579
---- Validation: 
scalar performance:
{'acc': 0.91584843, 'precision': 0.6008925, 'recall': 0.7296171, 'specificity': 0.7296171, 'f1': 0.6331202, 'auroc': 0.8392296, 'binary_precision': 0.22029702, 'binary_recall': 0.5289747, 'binary_specificity': 0.9302596, 'binary_f1_score': 0.31105286}
confusion matrix:
       0     1
0  16807  1260
1    317   356
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9126652, 'precision': 0.6325674, 'recall': 0.8054652, 'specificity': 0.8054652, 'f1': 0.6753482, 'auroc': 0.9021456, 'binary_precision': 0.2796875, 'binary_recall': 0.68846154, 'binary_specificity': 0.9224689, 'binary_f1_score': 0.39777777}
confusion matrix:
      0    1
0  5485  461
1    81  179
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-31 20:12:47.852805,epoch time: 0:15:55.558156,used: 1:43:09.338595,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_18_29_38_seed_1_23857232
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.889128, 'precision': 0.89064425, 'recall': 0.88914967, 'specificity': 0.88914967, 'f1': 0.88902426, 'auroc': 0.9563304, 'binary_precision': 0.91515577, 'binary_recall': 0.8579506, 'binary_specificity': 0.92034876, 'binary_f1_score': 0.8856304}
confusion matrix:
       0      1
0  26495   2293
1   4095  24733
---- Validation: 
scalar performance:
{'acc': 0.9164354, 'precision': 0.6044324, 'recall': 0.7399353, 'specificity': 0.7399353, 'f1': 0.63819027, 'auroc': 0.84405476, 'binary_precision': 0.22657685, 'binary_recall': 0.5497771, 'binary_specificity': 0.9300935, 'binary_f1_score': 0.320902}
confusion matrix:
       0     1
0  16804  1263
1    303   370
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9131486, 'precision': 0.63702613, 'recall': 0.82226837, 'specificity': 0.82226837, 'f1': 0.6820235, 'auroc': 0.9091717, 'binary_precision': 0.2870229, 'binary_recall': 0.72307694, 'binary_specificity': 0.9214598, 'binary_f1_score': 0.41092893}
confusion matrix:
      0    1
0  5479  467
1    72  188
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-07-31 20:28:38.825381,epoch time: 0:15:50.972576,used: 1:59:00.311171,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_18_29_38_seed_1_23857232
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.8983442, 'precision': 0.89918625, 'recall': 0.89836097, 'specificity': 0.89836097, 'f1': 0.89829326, 'auroc': 0.96126544, 'binary_precision': 0.9177031, 'binary_recall': 0.87533385, 'binary_specificity': 0.92138815, 'binary_f1_score': 0.89601785}
confusion matrix:
       0      1
0  26524   2263
1   3594  25235
---- Validation: 
scalar performance:
{'acc': 0.91211313, 'precision': 0.60209423, 'recall': 0.74913794, 'specificity': 0.74913794, 'f1': 0.6360824, 'auroc': 0.8453423, 'binary_precision': 0.22107674, 'binary_recall': 0.57355124, 'binary_specificity': 0.92472464, 'binary_f1_score': 0.31914014}
confusion matrix:
       0     1
0  16707  1360
1    287   386
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91121495, 'precision': 0.63809013, 'recall': 0.83781016, 'specificity': 0.83781016, 'f1': 0.6844402, 'auroc': 0.9126682, 'binary_precision': 0.28759125, 'binary_recall': 0.75769234, 'binary_specificity': 0.91792804, 'binary_f1_score': 0.41693124}
confusion matrix:
      0    1
0  5458  488
1    63  197
early stop counter: 1
val acc:0.9121131300926208, best validation acc: 0.9164354205131531, corresponding to test acc:                         0.9131485819816589 / 0.9131485819816589
after epoch: 8,now: 2024-07-31 20:44:35.927586,epoch time: 0:15:57.102205,used: 2:14:57.413376,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_18_29_38_seed_1_23857232
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9016419, 'precision': 0.9025032, 'recall': 0.9016596, 'specificity': 0.9016596, 'f1': 0.901592, 'auroc': 0.96357787, 'binary_precision': 0.921314, 'binary_recall': 0.87845993, 'binary_specificity': 0.9248593, 'binary_f1_score': 0.89937675}
confusion matrix:
       0      1
0  26623   2163
1   3504  25326
---- Validation: 
scalar performance:
{'acc': 0.9083778, 'precision': 0.59909797, 'recall': 0.7522076, 'specificity': 0.7522076, 'f1': 0.6324669, 'auroc': 0.8463907, 'binary_precision': 0.2147541, 'binary_recall': 0.5839524, 'binary_specificity': 0.9204627, 'binary_f1_score': 0.31402317}
confusion matrix:
       0     1
0  16630  1437
1    280   393
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9104093, 'precision': 0.64018416, 'recall': 0.8521016, 'specificity': 0.8521016, 'f1': 0.68792737, 'auroc': 0.9151375, 'binary_precision': 0.29036826, 'binary_recall': 0.78846157, 'binary_specificity': 0.9157417, 'binary_f1_score': 0.42443067}
confusion matrix:
      0    1
0  5445  501
1    55  205
early stop counter: 2
val acc:0.9083778262138367, best validation acc: 0.9164354205131531, corresponding to test acc:                         0.9131485819816589 / 0.9131485819816589
after epoch: 9,now: 2024-07-31 21:00:35.310798,epoch time: 0:15:59.383212,used: 2:30:56.796588,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_18_29_38_seed_1_23857232
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.90714383, 'precision': 0.90899444, 'recall': 0.9071684, 'specificity': 0.9071684, 'f1': 0.9070423, 'auroc': 0.9670867, 'binary_precision': 0.9366886, 'binary_recall': 0.87346077, 'binary_specificity': 0.94087607, 'binary_f1_score': 0.9039704}
confusion matrix:
       0      1
0  27085   1702
1   3648  25181
---- Validation: 
scalar performance:
{'acc': 0.9157951, 'precision': 0.60667646, 'recall': 0.7510475, 'specificity': 0.7510475, 'f1': 0.6417959, 'auroc': 0.84726894, 'binary_precision': 0.23017293, 'binary_recall': 0.57355124, 'binary_specificity': 0.92854375, 'binary_f1_score': 0.32851064}
confusion matrix:
       0     1
0  16776  1291
1    287   386
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9197551, 'precision': 0.65248466, 'recall': 0.85330087, 'specificity': 0.85330087, 'f1': 0.70292044, 'auroc': 0.917776, 'binary_precision': 0.3152174, 'binary_recall': 0.7807692, 'binary_specificity': 0.9258325, 'binary_f1_score': 0.44911507}
confusion matrix:
      0    1
0  5505  441
1    57  203
new oracle model saved
early stop counter: 3
val acc:0.915795087814331, best validation acc: 0.9164354205131531, corresponding to test acc:                         0.9131485819816589 / 0.9197551012039185
after epoch: 10,now: 2024-07-31 21:16:33.310046,epoch time: 0:15:57.999248,used: 2:46:54.795836,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_18_29_38_seed_1_23857232
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9107192, 'precision': 0.91234577, 'recall': 0.9107433, 'specificity': 0.9107433, 'f1': 0.9106345, 'auroc': 0.9682807, 'binary_precision': 0.9384348, 'binary_recall': 0.87925774, 'binary_specificity': 0.94222885, 'binary_f1_score': 0.907883}
confusion matrix:
       0      1
0  27123   1663
1   3481  25349
---- Validation: 
scalar performance:
{'acc': 0.90256137, 'precision': 0.59570533, 'recall': 0.75992, 'specificity': 0.75992, 'f1': 0.62822145, 'auroc': 0.84901905, 'binary_precision': 0.20721178, 'binary_recall': 0.6062407, 'binary_specificity': 0.9135994, 'binary_f1_score': 0.30885693}
confusion matrix:
       0     1
0  16506  1561
1    265   408
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90702546, 'precision': 0.63674664, 'recall': 0.8540137, 'specificity': 0.8540137, 'f1': 0.68361944, 'auroc': 0.9200704, 'binary_precision': 0.28317374, 'binary_recall': 0.79615384, 'binary_specificity': 0.9118735, 'binary_f1_score': 0.41775984}
confusion matrix:
      0    1
0  5422  524
1    53  207
early stop counter: 4
val acc:0.902561366558075, best validation acc: 0.9164354205131531, corresponding to test acc:                         0.9131485819816589 / 0.9197551012039185
after epoch: 11,now: 2024-07-31 21:32:34.392177,epoch time: 0:16:01.082131,used: 3:02:55.877967,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_18_29_38_seed_1_23857232
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9161691, 'precision': 0.91653335, 'recall': 0.9161794, 'specificity': 0.9161794, 'f1': 0.91615206, 'auroc': 0.9709952, 'binary_precision': 0.929026, 'binary_recall': 0.9013112, 'binary_specificity': 0.9310477, 'binary_f1_score': 0.9149587}
confusion matrix:
       0      1
0  26803   1985
1   2845  25983
---- Validation: 
scalar performance:
{'acc': 0.888207, 'precision': 0.5874954, 'recall': 0.7710725, 'specificity': 0.7710725, 'f1': 0.6161258, 'auroc': 0.8512486, 'binary_precision': 0.18951964, 'binary_recall': 0.6448737, 'binary_specificity': 0.8972713, 'binary_f1_score': 0.29294634}
confusion matrix:
       0     1
0  16211  1856
1    239   434
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89284563, 'precision': 0.6234014, 'recall': 0.85580873, 'specificity': 0.85580873, 'f1': 0.665309, 'auroc': 0.92176247, 'binary_precision': 0.2557298, 'binary_recall': 0.8153846, 'binary_specificity': 0.8962328, 'binary_f1_score': 0.38934803}
confusion matrix:
      0    1
0  5329  617
1    48  212
early stop counter: 5
val acc:0.8882070183753967, best validation acc: 0.9164354205131531, corresponding to test acc:                         0.9131485819816589 / 0.9197551012039185
after epoch: 12,now: 2024-07-31 21:48:32.434658,epoch time: 0:15:58.042481,used: 3:18:53.920448,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_18_29_38_seed_1_23857232
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9158567, 'precision': 0.91688037, 'recall': 0.91587484, 'specificity': 0.91587484, 'f1': 0.91580737, 'auroc': 0.9725785, 'binary_precision': 0.9377213, 'binary_recall': 0.89101255, 'binary_specificity': 0.9407371, 'binary_f1_score': 0.9137704}
confusion matrix:
       0      1
0  27081   1706
1   3142  25687
---- Validation: 
scalar performance:
{'acc': 0.905016, 'precision': 0.5982053, 'recall': 0.76119304, 'specificity': 0.76119304, 'f1': 0.63165176, 'auroc': 0.8510934, 'binary_precision': 0.21216848, 'binary_recall': 0.6062407, 'binary_specificity': 0.91614544, 'binary_f1_score': 0.3143297}
confusion matrix:
       0     1
0  16552  1515
1    265   408
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91121495, 'precision': 0.6427518, 'recall': 0.859878, 'specificity': 0.859878, 'f1': 0.6916104, 'auroc': 0.9227457, 'binary_precision': 0.2947814, 'binary_recall': 0.8038462, 'binary_specificity': 0.9159098, 'binary_f1_score': 0.43137255}
confusion matrix:
      0    1
0  5446  500
1    51  209
early stop counter: 6
val acc:0.9050160050392151, best validation acc: 0.9164354205131531, corresponding to test acc:                         0.9131485819816589 / 0.9197551012039185
after epoch: 13,now: 2024-07-31 22:04:26.392588,epoch time: 0:15:53.957930,used: 3:34:47.878378,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_18_29_38_seed_1_23857232
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9203867, 'precision': 0.9212482, 'recall': 0.92040247, 'specificity': 0.92040247, 'f1': 0.9203479, 'auroc': 0.9731028, 'binary_precision': 0.94047314, 'binary_recall': 0.89770365, 'binary_specificity': 0.9431013, 'binary_f1_score': 0.91859084}
confusion matrix:
       0      1
0  27150   1638
1   2949  25879
---- Validation: 
scalar performance:
{'acc': 0.89124864, 'precision': 0.5891049, 'recall': 0.7690736, 'specificity': 0.7690736, 'f1': 0.6186709, 'auroc': 0.85260975, 'binary_precision': 0.19298245, 'binary_recall': 0.63744426, 'binary_specificity': 0.90070295, 'binary_f1_score': 0.2962707}
confusion matrix:
       0     1
0  16273  1794
1    244   429
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8980019, 'precision': 0.6289454, 'recall': 0.86033857, 'specificity': 0.86033857, 'f1': 0.6732551, 'auroc': 0.92413336, 'binary_precision': 0.26658323, 'binary_recall': 0.8192308, 'binary_specificity': 0.90144634, 'binary_f1_score': 0.4022663}
confusion matrix:
      0    1
0  5360  586
1    47  213
early stop counter: 7
val acc:0.8912486433982849, best validation acc: 0.9164354205131531, corresponding to test acc:                         0.9131485819816589 / 0.9197551012039185
after epoch: 14,now: 2024-07-31 22:20:23.371773,epoch time: 0:15:56.979185,used: 3:50:44.857563,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_18_29_38_seed_1_23857232
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9214801, 'precision': 0.92206824, 'recall': 0.9214938, 'specificity': 0.9214938, 'f1': 0.9214545, 'auroc': 0.9741187, 'binary_precision': 0.9380068, 'binary_recall': 0.90273684, 'binary_specificity': 0.9402508, 'binary_f1_score': 0.92003393}
confusion matrix:
       0      1
0  27067   1720
1   2804  26025
---- Validation: 
scalar performance:
{'acc': 0.89311635, 'precision': 0.5908321, 'recall': 0.7707575, 'specificity': 0.7707575, 'f1': 0.62126124, 'auroc': 0.85385275, 'binary_precision': 0.19634703, 'binary_recall': 0.63893014, 'binary_specificity': 0.90258485, 'binary_f1_score': 0.30038422}
confusion matrix:
       0     1
0  16307  1760
1    243   430
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89961326, 'precision': 0.6306428, 'recall': 0.8611795, 'specificity': 0.8611795, 'f1': 0.675637, 'auroc': 0.9245466, 'binary_precision': 0.26996198, 'binary_recall': 0.8192308, 'binary_specificity': 0.90312815, 'binary_f1_score': 0.40610108}
confusion matrix:
      0    1
0  5370  576
1    47  213
early stop counter: 8
val acc:0.8931163549423218, best validation acc: 0.9164354205131531, corresponding to test acc:                         0.9131485819816589 / 0.9197551012039185
after epoch: 15,now: 2024-07-31 22:36:26.440929,epoch time: 0:16:03.069156,used: 4:06:47.926719,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_18_29_38_seed_1_23857232
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9233893, 'precision': 0.9239322, 'recall': 0.923403, 'specificity': 0.923403, 'f1': 0.9233664, 'auroc': 0.9752059, 'binary_precision': 0.9392947, 'binary_recall': 0.905411, 'binary_specificity': 0.9413951, 'binary_f1_score': 0.92204165}
confusion matrix:
       0      1
0  27099   1687
1   2727  26103
---- Validation: 
scalar performance:
{'acc': 0.88676625, 'precision': 0.5867078, 'recall': 0.7717558, 'specificity': 0.7717558, 'f1': 0.6148585, 'auroc': 0.8523708, 'binary_precision': 0.18785006, 'binary_recall': 0.64784545, 'binary_specificity': 0.8956661, 'binary_f1_score': 0.29124916}
confusion matrix:
       0     1
0  16182  1885
1    237   436
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8949404, 'precision': 0.6262175, 'recall': 0.86057985, 'specificity': 0.86057985, 'f1': 0.66938007, 'auroc': 0.92489266, 'binary_precision': 0.2609756, 'binary_recall': 0.8230769, 'binary_specificity': 0.89808273, 'binary_f1_score': 0.39629626}
confusion matrix:
      0    1
0  5340  606
1    46  214
early stop counter: 9
val acc:0.886766254901886, best validation acc: 0.9164354205131531, corresponding to test acc:                         0.9131485819816589 / 0.9197551012039185
after epoch: 16,now: 2024-07-31 22:52:31.568748,epoch time: 0:16:05.127819,used: 4:22:53.054538,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_18_29_38_seed_1_23857232
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9249861, 'precision': 0.92561215, 'recall': 0.92500085, 'specificity': 0.92500085, 'f1': 0.92496026, 'auroc': 0.97660637, 'binary_precision': 0.9421273, 'binary_recall': 0.9057232, 'binary_specificity': 0.9442785, 'binary_f1_score': 0.9235666}
confusion matrix:
       0      1
0  27182   1604
1   2718  26112
---- Validation: 
scalar performance:
{'acc': 0.8835112, 'precision': 0.5852482, 'recall': 0.7743592, 'specificity': 0.7743592, 'f1': 0.6123971, 'auroc': 0.85327244, 'binary_precision': 0.18462823, 'binary_recall': 0.65676075, 'binary_specificity': 0.8919577, 'binary_f1_score': 0.28822953}
confusion matrix:
       0     1
0  16115  1952
1    231   442
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88833386, 'precision': 0.619971, 'recall': 0.85713214, 'specificity': 0.85713214, 'f1': 0.6602128, 'auroc': 0.9255744, 'binary_precision': 0.2485482, 'binary_recall': 0.8230769, 'binary_specificity': 0.89118737, 'binary_f1_score': 0.38180193}
confusion matrix:
      0    1
0  5299  647
1    46  214
early stop counter: 10
val acc:0.8835111856460571, best validation acc: 0.9164354205131531, corresponding to test acc:                         0.9131485819816589 / 0.9197551012039185
after epoch: 17,now: 2024-07-31 23:08:31.873707,epoch time: 0:16:00.304959,used: 4:38:53.359497,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_18_29_38_seed_1_23857232
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.92783254, 'precision': 0.9284073, 'recall': 0.92784595, 'specificity': 0.92784595, 'f1': 0.92780983, 'auroc': 0.976941, 'binary_precision': 0.94428235, 'binary_recall': 0.90943146, 'binary_specificity': 0.94626045, 'binary_f1_score': 0.9265293}
confusion matrix:
       0      1
0  27240   1547
1   2611  26218
---- Validation: 
scalar performance:
{'acc': 0.8807364, 'precision': 0.58406234, 'recall': 0.77649647, 'specificity': 0.77649647, 'f1': 0.61032534, 'auroc': 0.85397804, 'binary_precision': 0.18200326, 'binary_recall': 0.6641902, 'binary_specificity': 0.88880277, 'binary_f1_score': 0.2857143}
confusion matrix:
       0     1
0  16058  2009
1    226   447
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8865614, 'precision': 0.61916006, 'recall': 0.8598851, 'specificity': 0.8598851, 'f1': 0.6589241, 'auroc': 0.9258461, 'binary_precision': 0.24657534, 'binary_recall': 0.83076924, 'binary_specificity': 0.889001, 'binary_f1_score': 0.3802817}
confusion matrix:
      0    1
0  5286  660
1    44  216
early stop counter: 11
val acc:0.8807364106178284, best validation acc: 0.9164354205131531, corresponding to test acc:                         0.9131485819816589 / 0.9197551012039185
after epoch: 18,now: 2024-07-31 23:24:25.089596,epoch time: 0:15:53.215889,used: 4:54:46.575386,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_18_29_38_seed_1_23857232
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.927659, 'precision': 0.9283993, 'recall': 0.92767346, 'specificity': 0.92767346, 'f1': 0.9276293, 'auroc': 0.9776652, 'binary_precision': 0.9463833, 'binary_recall': 0.906792, 'binary_specificity': 0.94855493, 'binary_f1_score': 0.9261647}
confusion matrix:
       0      1
0  27307   1481
1   2687  26141
---- Validation: 
scalar performance:
{'acc': 0.8915155, 'precision': 0.5903259, 'recall': 0.77350354, 'specificity': 0.77350354, 'f1': 0.62044686, 'auroc': 0.8539418, 'binary_precision': 0.19506727, 'binary_recall': 0.64635956, 'binary_specificity': 0.9006476, 'binary_f1_score': 0.29968998}
confusion matrix:
       0     1
0  16272  1795
1    238   435
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8983242, 'precision': 0.6292815, 'recall': 0.8605068, 'specificity': 0.8605068, 'f1': 0.6737286, 'auroc': 0.9255063, 'binary_precision': 0.2672522, 'binary_recall': 0.8192308, 'binary_specificity': 0.9017827, 'binary_f1_score': 0.40302745}
confusion matrix:
      0    1
0  5362  584
1    47  213
early stop counter: 12
val acc:0.8915154933929443, best validation acc: 0.9164354205131531, corresponding to test acc:                         0.9131485819816589 / 0.9197551012039185
after epoch: 19,now: 2024-07-31 23:40:28.042321,epoch time: 0:16:02.952725,used: 5:10:49.528111,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_18_29_38_seed_1_23857232
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9279367, 'precision': 0.9286145, 'recall': 0.92795056, 'specificity': 0.92795056, 'f1': 0.92790973, 'auroc': 0.97796035, 'binary_precision': 0.9458336, 'binary_recall': 0.90797144, 'binary_specificity': 0.9479297, 'binary_f1_score': 0.9265159}
confusion matrix:
       0      1
0  27289   1499
1   2653  26175
---- Validation: 
scalar performance:
{'acc': 0.88543224, 'precision': 0.58715874, 'recall': 0.77750134, 'specificity': 0.77750134, 'f1': 0.61535877, 'auroc': 0.85623837, 'binary_precision': 0.18824027, 'binary_recall': 0.6612184, 'binary_specificity': 0.8937842, 'binary_f1_score': 0.29305235}
confusion matrix:
       0     1
0  16148  1919
1    228   445
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88785046, 'precision': 0.61953706, 'recall': 0.85687983, 'specificity': 0.85687983, 'f1': 0.6595623, 'auroc': 0.9261992, 'binary_precision': 0.24768518, 'binary_recall': 0.8230769, 'binary_specificity': 0.8906828, 'binary_f1_score': 0.38078293}
confusion matrix:
      0    1
0  5296  650
1    46  214
early stop counter: 13
val acc:0.885432243347168, best validation acc: 0.9164354205131531, corresponding to test acc:                         0.9131485819816589 / 0.9197551012039185
after epoch: 20,now: 2024-07-31 23:56:27.809871,epoch time: 0:15:59.767550,used: 5:26:49.295661,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_18_29_38_seed_1_23857232
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 5:26:49.295661 at 2024-07-31 23:56:27.809871
persisted model performance metric: 

scalar performance:
{'acc': 0.9131486, 'precision': 0.63702613, 'recall': 0.82226837, 'specificity': 0.82226837, 'f1': 0.6820235, 'auroc': 0.9091717, 'binary_precision': 0.2870229, 'binary_recall': 0.72307694, 'binary_specificity': 0.9214598, 'binary_f1_score': 0.41092893}
confusion matrix:
      0    1
0  5479  467
1    72  188
oracle model performance metric: 

scalar performance:
{'acc': 0.9197551, 'precision': 0.65248466, 'recall': 0.85330087, 'specificity': 0.85330087, 'f1': 0.70292044, 'auroc': 0.917776, 'binary_precision': 0.3152174, 'binary_recall': 0.7807692, 'binary_specificity': 0.9258325, 'binary_f1_score': 0.44911507}
confusion matrix:
      0    1
0  5505  441
1    57  203
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_12-46-56/rule_results/16.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_12-46-56/confusion_matrix/16.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 190959 KiB | 461507 KiB | 702663 GiB | 702662 GiB |
|       from large pool | 173494 KiB | 427880 KiB | 688223 GiB | 688223 GiB |
|       from small pool |  17465 KiB |  38507 KiB |  14439 GiB |  14439 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 190959 KiB | 461507 KiB | 702663 GiB | 702662 GiB |
|       from large pool | 173494 KiB | 427880 KiB | 688223 GiB | 688223 GiB |
|       from small pool |  17465 KiB |  38507 KiB |  14439 GiB |  14439 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 189280 KiB | 457564 KiB | 702622 GiB | 702622 GiB |
|       from large pool | 172814 KiB | 424940 KiB | 688216 GiB | 688216 GiB |
|       from small pool |  16466 KiB |  37503 KiB |  14406 GiB |  14406 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 526336 KiB | 526336 KiB |    788 MiB | 280576 KiB |
|       from large pool | 487424 KiB | 487424 KiB |    732 MiB | 262144 KiB |
|       from small pool |  38912 KiB |  43008 KiB |     56 MiB |  18432 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  42512 KiB |  87761 KiB | 381861 GiB | 381861 GiB |
|       from large pool |  31306 KiB |  79704 KiB | 367399 GiB | 367399 GiB |
|       from small pool |  11206 KiB |  18293 KiB |  14461 GiB |  14461 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2942    |    7685    |  162708 K  |  162705 K  |
|       from large pool |      76    |     158    |   67834 K  |   67834 K  |
|       from small pool |    2866    |    7607    |   94873 K  |   94870 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2942    |    7685    |  162708 K  |  162705 K  |
|       from large pool |      76    |     158    |   67834 K  |   67834 K  |
|       from small pool |    2866    |    7607    |   94873 K  |   94870 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      41    |      42    |      61    |      20    |
|       from large pool |      22    |      22    |      33    |      11    |
|       from small pool |      19    |      21    |      28    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      35    |    3620    |   84998 K  |   84998 K  |
|       from large pool |      10    |      23    |   42044 K  |   42044 K  |
|       from small pool |      25    |    3610    |   42954 K  |   42954 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 461507 KiB | 702663 GiB | 702663 GiB |
|       from large pool |  17088 KiB | 427880 KiB | 688223 GiB | 688223 GiB |
|       from small pool |      0 KiB |  38507 KiB |  14439 GiB |  14439 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 461507 KiB | 702663 GiB | 702663 GiB |
|       from large pool |  17088 KiB | 427880 KiB | 688223 GiB | 688223 GiB |
|       from small pool |      0 KiB |  38507 KiB |  14439 GiB |  14439 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457564 KiB | 702622 GiB | 702622 GiB |
|       from large pool |  16640 KiB | 424940 KiB | 688216 GiB | 688216 GiB |
|       from small pool |      0 KiB |  37503 KiB |  14406 GiB |  14406 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 233472 KiB | 526336 KiB |    788 MiB | 573440 KiB |
|       from large pool | 204800 KiB | 487424 KiB |    732 MiB | 544768 KiB |
|       from small pool |  28672 KiB |  43008 KiB |     56 MiB |  28672 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  87761 KiB | 381861 GiB | 381861 GiB |
|       from large pool |  23872 KiB |  79704 KiB | 367399 GiB | 367399 GiB |
|       from small pool |      0 KiB |  21236 KiB |  14461 GiB |  14461 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7685    |  162708 K  |  162708 K  |
|       from large pool |       2    |     158    |   67834 K  |   67834 K  |
|       from small pool |       0    |    7607    |   94873 K  |   94873 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7685    |  162708 K  |  162708 K  |
|       from large pool |       2    |     158    |   67834 K  |   67834 K  |
|       from small pool |       0    |    7607    |   94873 K  |   94873 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |      42    |      61    |      37    |
|       from large pool |      10    |      22    |      33    |      23    |
|       from small pool |      14    |      21    |      28    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3620    |   84999 K  |   84999 K  |
|       from large pool |       3    |      23    |   42044 K  |   42044 K  |
|       from small pool |       0    |    3610    |   42955 K  |   42955 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 461507 KiB | 702663 GiB | 702663 GiB |
|       from large pool |  17088 KiB | 427880 KiB | 688223 GiB | 688223 GiB |
|       from small pool |      0 KiB |  38507 KiB |  14439 GiB |  14439 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 461507 KiB | 702663 GiB | 702663 GiB |
|       from large pool |  17088 KiB | 427880 KiB | 688223 GiB | 688223 GiB |
|       from small pool |      0 KiB |  38507 KiB |  14439 GiB |  14439 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457564 KiB | 702622 GiB | 702622 GiB |
|       from large pool |  16640 KiB | 424940 KiB | 688216 GiB | 688216 GiB |
|       from small pool |      0 KiB |  37503 KiB |  14406 GiB |  14406 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 233472 KiB | 526336 KiB |    788 MiB | 573440 KiB |
|       from large pool | 204800 KiB | 487424 KiB |    732 MiB | 544768 KiB |
|       from small pool |  28672 KiB |  43008 KiB |     56 MiB |  28672 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  87761 KiB | 381861 GiB | 381861 GiB |
|       from large pool |  23872 KiB |  79704 KiB | 367399 GiB | 367399 GiB |
|       from small pool |      0 KiB |  21236 KiB |  14461 GiB |  14461 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7685    |  162708 K  |  162708 K  |
|       from large pool |       2    |     158    |   67834 K  |   67834 K  |
|       from small pool |       0    |    7607    |   94873 K  |   94873 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7685    |  162708 K  |  162708 K  |
|       from large pool |       2    |     158    |   67834 K  |   67834 K  |
|       from small pool |       0    |    7607    |   94873 K  |   94873 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |      42    |      61    |      37    |
|       from large pool |      10    |      22    |      33    |      23    |
|       from small pool |      14    |      21    |      28    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3620    |   84999 K  |   84999 K  |
|       from large pool |       3    |      23    |   42044 K  |   42044 K  |
|       from small pool |       0    |    3610    |   42955 K  |   42955 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_00_04_19_seed_2_23857232

 Experiment start at: 2024-08-01 00:04:19.784683
before training, model accuracy: 0.754768431186676
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.73754805, 'precision': 0.7376113, 'recall': 0.7375466, 'specificity': 0.7375466, 'f1': 0.73752975, 'auroc': 0.8139947, 'binary_precision': 0.7337765, 'binary_recall': 0.74575573, 'binary_specificity': 0.7293375, 'binary_f1_score': 0.7397176}
confusion matrix:
       0      1
0  21258   7889
1   7413  21744
---- Validation: 
scalar performance:
{'acc': 0.62914824, 'precision': 0.5244931, 'recall': 0.6871707, 'specificity': 0.6871707, 'f1': 0.44007346, 'auroc': 0.7566823, 'binary_precision': 0.062104102, 'binary_recall': 0.7491694, 'binary_specificity': 0.62517196, 'binary_f1_score': 0.1146999}
confusion matrix:
       0     1
0  11360  6811
1    151   451
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.35823047, 'precision': 0.5035457, 'recall': 0.5214263, 'specificity': 0.5214263, 'f1': 0.2928553, 'auroc': 0.49810648, 'binary_precision': 0.041219514, 'binary_recall': 0.6983471, 'binary_specificity': 0.34450558, 'binary_f1_score': 0.07784431}
confusion matrix:
      0     1
0  2066  3931
1    73   169
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-01 00:21:09.737553,epoch time: 0:16:49.952870,used: 0:16:49.952870,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_00_04_19_seed_2_23857232
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.82061267, 'precision': 0.8207234, 'recall': 0.8206146, 'specificity': 0.8206146, 'f1': 0.82059777, 'auroc': 0.8970115, 'binary_precision': 0.82673424, 'binary_recall': 0.81133825, 'binary_specificity': 0.8298909, 'binary_f1_score': 0.8189639}
confusion matrix:
       0      1
0  24188   4958
1   5501  23657
---- Validation: 
scalar performance:
{'acc': 0.72694826, 'precision': 0.5330519, 'recall': 0.71761453, 'specificity': 0.71761453, 'f1': 0.4900715, 'auroc': 0.7847003, 'binary_precision': 0.079241075, 'binary_recall': 0.7076412, 'binary_specificity': 0.72758794, 'binary_f1_score': 0.14252257}
confusion matrix:
       0     1
0  13221  4950
1    176   426
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5595448, 'precision': 0.51718444, 'recall': 0.61424893, 'specificity': 0.61424893, 'f1': 0.4069173, 'auroc': 0.6448885, 'binary_precision': 0.0575565, 'binary_recall': 0.6735537, 'binary_specificity': 0.55494416, 'binary_f1_score': 0.10605075}
confusion matrix:
      0     1
0  3328  2669
1    79   163
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-01 00:38:38.537163,epoch time: 0:17:28.799610,used: 0:34:18.752480,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_00_04_19_seed_2_23857232
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.84793496, 'precision': 0.8484813, 'recall': 0.847939, 'specificity': 0.847939, 'f1': 0.8478764, 'auroc': 0.923293, 'binary_precision': 0.8623313, 'binary_recall': 0.82814324, 'binary_specificity': 0.86773485, 'binary_f1_score': 0.84489155}
confusion matrix:
       0      1
0  25291   3855
1   5011  24147
---- Validation: 
scalar performance:
{'acc': 0.77606136, 'precision': 0.5400474, 'recall': 0.732545, 'specificity': 0.732545, 'f1': 0.51746225, 'auroc': 0.801563, 'binary_precision': 0.0932701, 'binary_recall': 0.68604654, 'binary_specificity': 0.77904356, 'binary_f1_score': 0.1642147}
confusion matrix:
       0     1
0  14156  4015
1    189   413
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6558743, 'precision': 0.5288484, 'recall': 0.6782365, 'specificity': 0.6782365, 'f1': 0.46090877, 'auroc': 0.7224141, 'binary_precision': 0.075723834, 'binary_recall': 0.70247936, 'binary_specificity': 0.65399367, 'binary_f1_score': 0.1367109}
confusion matrix:
      0     1
0  3922  2075
1    72   170
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-01 00:54:54.868424,epoch time: 0:16:16.331261,used: 0:50:35.083741,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_00_04_19_seed_2_23857232
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.8668016, 'precision': 0.86735135, 'recall': 0.86680627, 'specificity': 0.86680627, 'f1': 0.86675274, 'auroc': 0.93985033, 'binary_precision': 0.8816226, 'binary_recall': 0.84745705, 'binary_specificity': 0.8861554, 'binary_f1_score': 0.86420226}
confusion matrix:
       0      1
0  25827   3318
1   4448  24711
---- Validation: 
scalar performance:
{'acc': 0.8166516, 'precision': 0.5474329, 'recall': 0.73825455, 'specificity': 0.73825455, 'f1': 0.54148734, 'auroc': 0.8143219, 'binary_precision': 0.10859978, 'binary_recall': 0.65448505, 'binary_specificity': 0.8220241, 'binary_f1_score': 0.18628843}
confusion matrix:
       0     1
0  14937  3234
1    208   394
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7154993, 'precision': 0.5368068, 'recall': 0.70726925, 'specificity': 0.70726925, 'f1': 0.49435636, 'auroc': 0.76632875, 'binary_precision': 0.090326026, 'binary_recall': 0.6983471, 'binary_specificity': 0.7161914, 'binary_f1_score': 0.15996213}
confusion matrix:
      0     1
0  4295  1702
1    73   169
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-01 01:11:07.948765,epoch time: 0:16:13.080341,used: 1:06:48.164082,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_00_04_19_seed_2_23857232
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.8760977, 'precision': 0.8764814, 'recall': 0.8760999, 'specificity': 0.8760999, 'f1': 0.87606657, 'auroc': 0.9468615, 'binary_precision': 0.8885346, 'binary_recall': 0.8601317, 'binary_specificity': 0.8920681, 'binary_f1_score': 0.8741025}
confusion matrix:
       0      1
0  26002   3146
1   4078  25078
---- Validation: 
scalar performance:
{'acc': 0.82544076, 'precision': 0.5502374, 'recall': 0.74359787, 'specificity': 0.74359787, 'f1': 0.5481821, 'auroc': 0.8230423, 'binary_precision': 0.11399712, 'binary_recall': 0.65614617, 'binary_specificity': 0.8310495, 'binary_f1_score': 0.19424638}
confusion matrix:
       0     1
0  15101  3070
1    207   395
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7387402, 'precision': 0.54391307, 'recall': 0.7372033, 'specificity': 0.7372033, 'f1': 0.5119492, 'auroc': 0.7979541, 'binary_precision': 0.10206422, 'binary_recall': 0.7355372, 'binary_specificity': 0.7388694, 'binary_f1_score': 0.17925477}
confusion matrix:
      0     1
0  4431  1566
1    64   178
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-01 01:27:27.144846,epoch time: 0:16:19.196081,used: 1:23:07.360163,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_00_04_19_seed_2_23857232
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.886097, 'precision': 0.88711864, 'recall': 0.88610053, 'specificity': 0.88610053, 'f1': 0.88602245, 'auroc': 0.9532074, 'binary_precision': 0.9070398, 'binary_recall': 0.8604061, 'binary_specificity': 0.91179496, 'binary_f1_score': 0.8831077}
confusion matrix:
       0      1
0  26577   2571
1   4070  25086
---- Validation: 
scalar performance:
{'acc': 0.84317905, 'precision': 0.5553845, 'recall': 0.74713945, 'specificity': 0.74713945, 'f1': 0.5607843, 'auroc': 0.8305005, 'binary_precision': 0.12443874, 'binary_recall': 0.64451826, 'binary_specificity': 0.8497606, 'binary_f1_score': 0.20860215}
confusion matrix:
       0     1
0  15441  2730
1    214   388
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7682321, 'precision': 0.5512637, 'recall': 0.7584925, 'specificity': 0.7584925, 'f1': 0.53235054, 'auroc': 0.8219482, 'binary_precision': 0.115581095, 'binary_recall': 0.74793386, 'binary_specificity': 0.7690512, 'binary_f1_score': 0.20022124}
confusion matrix:
      0     1
0  4612  1385
1    61   181
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-08-01 01:43:41.606278,epoch time: 0:16:14.461432,used: 1:39:21.821595,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_00_04_19_seed_2_23857232
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.8909166, 'precision': 0.8921916, 'recall': 0.8909215, 'specificity': 0.8909215, 'f1': 0.89082867, 'auroc': 0.95626724, 'binary_precision': 0.91459644, 'binary_recall': 0.8624001, 'binary_specificity': 0.91944283, 'binary_f1_score': 0.8877317}
confusion matrix:
       0      1
0  26799   2348
1   4012  25145
---- Validation: 
scalar performance:
{'acc': 0.85527086, 'precision': 0.55957973, 'recall': 0.74937046, 'specificity': 0.74937046, 'f1': 0.57008064, 'auroc': 0.8359593, 'binary_precision': 0.13293995, 'binary_recall': 0.63621265, 'binary_specificity': 0.8625282, 'binary_f1_score': 0.21992534}
confusion matrix:
       0     1
0  15673  2498
1    219   383
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7877865, 'precision': 0.5566731, 'recall': 0.77064705, 'specificity': 0.77064705, 'f1': 0.5464668, 'auroc': 0.8373491, 'binary_precision': 0.12586446, 'binary_recall': 0.75206614, 'binary_specificity': 0.78922796, 'binary_f1_score': 0.21563981}
confusion matrix:
      0     1
0  4733  1264
1    60   182
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-08-01 02:00:01.485997,epoch time: 0:16:19.879719,used: 1:55:41.701314,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_00_04_19_seed_2_23857232
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.89717686, 'precision': 0.8976313, 'recall': 0.8971792, 'specificity': 0.8971792, 'f1': 0.8971478, 'auroc': 0.96170247, 'binary_precision': 0.91110796, 'binary_recall': 0.88026476, 'binary_specificity': 0.9140936, 'binary_f1_score': 0.8954208}
confusion matrix:
       0      1
0  26644   2504
1   3491  25665
---- Validation: 
scalar performance:
{'acc': 0.8469078, 'precision': 0.55851996, 'recall': 0.75789917, 'specificity': 0.75789917, 'f1': 0.5662383, 'auroc': 0.84031945, 'binary_precision': 0.12996742, 'binary_recall': 0.6627907, 'binary_specificity': 0.85300756, 'binary_f1_score': 0.21732026}
confusion matrix:
       0     1
0  15500  2671
1    203   399
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7773682, 'precision': 0.55634564, 'recall': 0.77910686, 'specificity': 0.77910686, 'f1': 0.54212105, 'auroc': 0.8513975, 'binary_precision': 0.123934425, 'binary_recall': 0.78099173, 'binary_specificity': 0.7772219, 'binary_f1_score': 0.21392189}
confusion matrix:
      0     1
0  4661  1336
1    53   189
early stop counter: 1
val acc:0.8469077944755554, best validation acc: 0.8552708625793457, corresponding to test acc:                         0.7877864837646484 / 0.7877864837646484
after epoch: 8,now: 2024-08-01 02:16:17.507512,epoch time: 0:16:16.021515,used: 2:11:57.722829,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_00_04_19_seed_2_23857232
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.90347147, 'precision': 0.90383315, 'recall': 0.9034735, 'specificity': 0.9034735, 'f1': 0.90345013, 'auroc': 0.96341383, 'binary_precision': 0.91595364, 'binary_recall': 0.88849634, 'binary_specificity': 0.91845065, 'binary_f1_score': 0.90201604}
confusion matrix:
       0      1
0  26771   2377
1   3251  25905
---- Validation: 
scalar performance:
{'acc': 0.84301925, 'precision': 0.55802596, 'recall': 0.7615118, 'specificity': 0.7615118, 'f1': 0.564396, 'auroc': 0.84321994, 'binary_precision': 0.1286031, 'binary_recall': 0.6744186, 'binary_specificity': 0.8486049, 'binary_f1_score': 0.21601489}
confusion matrix:
       0     1
0  15420  2751
1    196   406
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77832985, 'precision': 0.5569481, 'recall': 0.7815898, 'specificity': 0.7815898, 'f1': 0.5432351, 'auroc': 0.8606955, 'binary_precision': 0.12491782, 'binary_recall': 0.78512394, 'binary_specificity': 0.77805567, 'binary_f1_score': 0.21554169}
confusion matrix:
      0     1
0  4666  1331
1    52   190
early stop counter: 2
val acc:0.8430192470550537, best validation acc: 0.8552708625793457, corresponding to test acc:                         0.7877864837646484 / 0.7877864837646484
after epoch: 9,now: 2024-08-01 02:32:38.273497,epoch time: 0:16:20.765985,used: 2:28:18.488814,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_00_04_19_seed_2_23857232
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9040546, 'precision': 0.9045, 'recall': 0.9040586, 'specificity': 0.9040586, 'f1': 0.90402883, 'auroc': 0.96478826, 'binary_precision': 0.9179822, 'binary_recall': 0.8874447, 'binary_specificity': 0.9206725, 'binary_f1_score': 0.9024553}
confusion matrix:
       0      1
0  26833   2312
1   3282  25877
---- Validation: 
scalar performance:
{'acc': 0.8452565, 'precision': 0.5592091, 'recall': 0.7642735, 'specificity': 0.7642735, 'f1': 0.5667063, 'auroc': 0.8452027, 'binary_precision': 0.13081115, 'binary_recall': 0.6777409, 'binary_specificity': 0.85080624, 'binary_f1_score': 0.21929589}
confusion matrix:
       0     1
0  15460  2711
1    194   408
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.785222, 'precision': 0.5598745, 'recall': 0.79112315, 'specificity': 0.79112315, 'f1': 0.54950523, 'auroc': 0.86776304, 'binary_precision': 0.13005391, 'binary_recall': 0.79752064, 'binary_specificity': 0.7847257, 'binary_f1_score': 0.22363847}
confusion matrix:
      0     1
0  4706  1291
1    49   193
early stop counter: 3
val acc:0.845256507396698, best validation acc: 0.8552708625793457, corresponding to test acc:                         0.7877864837646484 / 0.7877864837646484
after epoch: 10,now: 2024-08-01 02:49:00.120079,epoch time: 0:16:21.846582,used: 2:44:40.335396,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_00_04_19_seed_2_23857232
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.90986896, 'precision': 0.91112083, 'recall': 0.9098747, 'specificity': 0.9098747, 'f1': 0.9098011, 'auroc': 0.9677268, 'binary_precision': 0.9338585, 'binary_recall': 0.8822622, 'binary_specificity': 0.9374871, 'binary_f1_score': 0.9073274}
confusion matrix:
       0      1
0  27324   1822
1   3433  25725
---- Validation: 
scalar performance:
{'acc': 0.8707718, 'precision': 0.56733775, 'recall': 0.75818074, 'specificity': 0.75818074, 'f1': 0.5849145, 'auroc': 0.847451, 'binary_precision': 0.14814815, 'binary_recall': 0.63787377, 'binary_specificity': 0.8784877, 'binary_f1_score': 0.24045084}
confusion matrix:
       0     1
0  15963  2208
1    218   384
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82288826, 'precision': 0.56856257, 'recall': 0.7908889, 'specificity': 0.7908889, 'f1': 0.5742098, 'auroc': 0.8730302, 'binary_precision': 0.14890155, 'binary_recall': 0.75619835, 'binary_specificity': 0.82557946, 'binary_f1_score': 0.24881035}
confusion matrix:
      0     1
0  4951  1046
1    59   183
new oracle model saved
better model found
persisted
after epoch: 11,now: 2024-08-01 03:05:19.971664,epoch time: 0:16:19.851585,used: 3:01:00.186981,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_00_04_19_seed_2_23857232
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.91189283, 'precision': 0.9128546, 'recall': 0.911897, 'specificity': 0.911897, 'f1': 0.9118421, 'auroc': 0.969522, 'binary_precision': 0.932824, 'binary_recall': 0.8877457, 'binary_specificity': 0.9360483, 'binary_f1_score': 0.90972674}
confusion matrix:
       0      1
0  27283   1864
1   3273  25884
---- Validation: 
scalar performance:
{'acc': 0.86912054, 'precision': 0.56743544, 'recall': 0.762146, 'specificity': 0.762146, 'f1': 0.584675, 'auroc': 0.85060346, 'binary_precision': 0.14800759, 'binary_recall': 0.64784056, 'binary_specificity': 0.8764515, 'binary_f1_score': 0.24096385}
confusion matrix:
       0     1
0  15926  2245
1    212   390
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8208046, 'precision': 0.5696658, 'recall': 0.79971874, 'specificity': 0.79971874, 'f1': 0.5749445, 'auroc': 0.87869555, 'binary_precision': 0.15015975, 'binary_recall': 0.7768595, 'binary_specificity': 0.82257795, 'binary_f1_score': 0.25167337}
confusion matrix:
      0     1
0  4933  1064
1    54   188
early stop counter: 1
val acc:0.8691205382347107, best validation acc: 0.8707718253135681, corresponding to test acc:                         0.8228882551193237 / 0.8228882551193237
after epoch: 12,now: 2024-08-01 03:21:40.262787,epoch time: 0:16:20.291123,used: 3:17:20.478104,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_00_04_19_seed_2_23857232
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9170554, 'precision': 0.9173511, 'recall': 0.9170577, 'specificity': 0.9170577, 'f1': 0.917041, 'auroc': 0.9717516, 'binary_precision': 0.92850345, 'binary_recall': 0.90372807, 'binary_specificity': 0.9303873, 'binary_f1_score': 0.9159482}
confusion matrix:
       0      1
0  27118   2029
1   2807  26350
---- Validation: 
scalar performance:
{'acc': 0.84946465, 'precision': 0.56244564, 'recall': 0.77447784, 'specificity': 0.77447784, 'f1': 0.5724442, 'auroc': 0.8531776, 'binary_precision': 0.13660131, 'binary_recall': 0.69435215, 'binary_specificity': 0.85460347, 'binary_f1_score': 0.22829056}
confusion matrix:
       0     1
0  15529  2642
1    184   418
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79868567, 'precision': 0.5649423, 'recall': 0.8040749, 'specificity': 0.8040749, 'f1': 0.5609449, 'auroc': 0.88406634, 'binary_precision': 0.13940255, 'binary_recall': 0.80991733, 'binary_specificity': 0.79823244, 'binary_f1_score': 0.23786406}
confusion matrix:
      0     1
0  4787  1210
1    46   196
early stop counter: 2
val acc:0.8494646549224854, best validation acc: 0.8707718253135681, corresponding to test acc:                         0.8228882551193237 / 0.8228882551193237
after epoch: 13,now: 2024-08-01 03:37:54.922786,epoch time: 0:16:14.659999,used: 3:33:35.138103,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_00_04_19_seed_2_23857232
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9180159, 'precision': 0.9189068, 'recall': 0.91801906, 'specificity': 0.91801906, 'f1': 0.91797274, 'auroc': 0.9730266, 'binary_precision': 0.9382596, 'binary_recall': 0.8949444, 'binary_specificity': 0.94109374, 'binary_f1_score': 0.9160903}
confusion matrix:
       0      1
0  27431   1717
1   3063  26093
---- Validation: 
scalar performance:
{'acc': 0.8710915, 'precision': 0.56981623, 'recall': 0.76958853, 'specificity': 0.76958853, 'f1': 0.58851004, 'auroc': 0.85290444, 'binary_precision': 0.15225707, 'binary_recall': 0.6611296, 'binary_specificity': 0.87804747, 'binary_f1_score': 0.24751243}
confusion matrix:
       0     1
0  15955  2216
1    204   398
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8297804, 'precision': 0.5740069, 'recall': 0.8083532, 'specificity': 0.8083532, 'f1': 0.5836462, 'auroc': 0.88574797, 'binary_precision': 0.15833333, 'binary_recall': 0.78512394, 'binary_specificity': 0.8315825, 'binary_f1_score': 0.2635229}
confusion matrix:
      0     1
0  4987  1010
1    52   190
new oracle model saved
better model found
persisted
after epoch: 14,now: 2024-08-01 03:54:12.721054,epoch time: 0:16:17.798268,used: 3:49:52.936371,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_00_04_19_seed_2_23857232
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9204343, 'precision': 0.9210743, 'recall': 0.9204383, 'specificity': 0.9204383, 'f1': 0.92040455, 'auroc': 0.97355723, 'binary_precision': 0.9375424, 'binary_recall': 0.90091914, 'binary_specificity': 0.93995744, 'binary_f1_score': 0.918866}
confusion matrix:
       0      1
0  27396   1750
1   2889  26269
---- Validation: 
scalar performance:
{'acc': 0.8525009, 'precision': 0.5634607, 'recall': 0.77444017, 'specificity': 0.77444017, 'f1': 0.5747369, 'auroc': 0.8548, 'binary_precision': 0.1387129, 'binary_recall': 0.6910299, 'binary_specificity': 0.85785043, 'binary_f1_score': 0.23104693}
confusion matrix:
       0     1
0  15588  2583
1    186   416
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80541754, 'precision': 0.5678519, 'recall': 0.81154215, 'specificity': 0.81154215, 'f1': 0.5671293, 'auroc': 0.88949776, 'binary_precision': 0.14473684, 'binary_recall': 0.8181818, 'binary_specificity': 0.80490243, 'binary_f1_score': 0.24596272}
confusion matrix:
      0     1
0  4827  1170
1    44   198
early stop counter: 1
val acc:0.8525009155273438, best validation acc: 0.8710914850234985, corresponding to test acc:                         0.8297803997993469 / 0.8297803997993469
after epoch: 15,now: 2024-08-01 04:11:02.253770,epoch time: 0:16:49.532716,used: 4:06:42.469087,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_00_04_19_seed_2_23857232
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.91981685, 'precision': 0.920755, 'recall': 0.9198217, 'specificity': 0.9198217, 'f1': 0.91977274, 'auroc': 0.9740402, 'binary_precision': 0.9406746, 'binary_recall': 0.8961863, 'binary_specificity': 0.94345707, 'binary_f1_score': 0.9178917}
confusion matrix:
       0      1
0  27498   1648
1   3027  26131
---- Validation: 
scalar performance:
{'acc': 0.8583604, 'precision': 0.56598824, 'recall': 0.7766639, 'specificity': 0.7766639, 'f1': 0.5799078, 'auroc': 0.85574764, 'binary_precision': 0.14374784, 'binary_recall': 0.6893688, 'binary_specificity': 0.8639591, 'binary_f1_score': 0.2378905}
confusion matrix:
       0     1
0  15699  2472
1    187   415
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81503445, 'precision': 0.5701248, 'recall': 0.8105964, 'specificity': 0.8105964, 'f1': 0.5735242, 'auroc': 0.89194465, 'binary_precision': 0.14976959, 'binary_recall': 0.8057851, 'binary_specificity': 0.8154077, 'binary_f1_score': 0.2525907}
confusion matrix:
      0     1
0  4890  1107
1    47   195
early stop counter: 2
val acc:0.8583604097366333, best validation acc: 0.8710914850234985, corresponding to test acc:                         0.8297803997993469 / 0.8297803997993469
after epoch: 16,now: 2024-08-01 04:27:18.258484,epoch time: 0:16:16.004714,used: 4:22:58.473801,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_00_04_19_seed_2_23857232
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9241047, 'precision': 0.92459446, 'recall': 0.92410874, 'specificity': 0.92410874, 'f1': 0.9240833, 'auroc': 0.9751018, 'binary_precision': 0.93907547, 'binary_recall': 0.90709555, 'binary_specificity': 0.941122, 'binary_f1_score': 0.9228085}
confusion matrix:
       0      1
0  27429   1716
1   2709  26450
---- Validation: 
scalar performance:
{'acc': 0.8528738, 'precision': 0.5649836, 'recall': 0.78186023, 'specificity': 0.78186023, 'f1': 0.5769667, 'auroc': 0.8585119, 'binary_precision': 0.14119601, 'binary_recall': 0.70598006, 'binary_specificity': 0.85774034, 'binary_f1_score': 0.23532669}
confusion matrix:
       0     1
0  15586  2585
1    177   425
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8084629, 'precision': 0.56925064, 'recall': 0.815109, 'specificity': 0.815109, 'f1': 0.5700295, 'auroc': 0.8949262, 'binary_precision': 0.14729829, 'binary_recall': 0.822314, 'binary_specificity': 0.80790395, 'binary_f1_score': 0.24984306}
confusion matrix:
      0     1
0  4845  1152
1    43   199
early stop counter: 3
val acc:0.8528738021850586, best validation acc: 0.8710914850234985, corresponding to test acc:                         0.8297803997993469 / 0.8297803997993469
after epoch: 17,now: 2024-08-01 04:43:34.768334,epoch time: 0:16:16.509850,used: 4:39:14.983651,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_00_04_19_seed_2_23857232
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9253911, 'precision': 0.9266032, 'recall': 0.9253956, 'specificity': 0.9253956, 'f1': 0.92533857, 'auroc': 0.97677606, 'binary_precision': 0.9493859, 'binary_recall': 0.89872074, 'binary_specificity': 0.95207053, 'binary_f1_score': 0.92335886}
confusion matrix:
       0      1
0  27750   1397
1   2953  26204
---- Validation: 
scalar performance:
{'acc': 0.8774304, 'precision': 0.5743228, 'recall': 0.7768782, 'specificity': 0.7768782, 'f1': 0.59630024, 'auroc': 0.8586637, 'binary_precision': 0.16087824, 'binary_recall': 0.6694352, 'binary_specificity': 0.88432115, 'binary_f1_score': 0.25941423}
confusion matrix:
       0     1
0  16069  2102
1    199   403
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8443661, 'precision': 0.58059454, 'recall': 0.8159403, 'specificity': 0.8159403, 'f1': 0.59700394, 'auroc': 0.8955325, 'binary_precision': 0.17132552, 'binary_recall': 0.78512394, 'binary_specificity': 0.8467567, 'binary_f1_score': 0.28127313}
confusion matrix:
      0    1
0  5078  919
1    52  190
new oracle model saved
better model found
persisted
after epoch: 18,now: 2024-08-01 04:59:52.260363,epoch time: 0:16:17.492029,used: 4:55:32.475680,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_00_04_19_seed_2_23857232
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9278437, 'precision': 0.9287776, 'recall': 0.9278485, 'specificity': 0.9278485, 'f1': 0.92780495, 'auroc': 0.977134, 'binary_precision': 0.9488397, 'binary_recall': 0.9044859, 'binary_specificity': 0.95121115, 'binary_f1_score': 0.926132}
confusion matrix:
       0      1
0  27724   1422
1   2785  26373
---- Validation: 
scalar performance:
{'acc': 0.8758323, 'precision': 0.57368827, 'recall': 0.7776588, 'specificity': 0.7776588, 'f1': 0.5950639, 'auroc': 0.860268, 'binary_precision': 0.15951163, 'binary_recall': 0.67275745, 'binary_specificity': 0.88256013, 'binary_f1_score': 0.25787967}
confusion matrix:
       0     1
0  16037  2134
1    197   405
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8418016, 'precision': 0.5801386, 'recall': 0.8185718, 'specificity': 0.8185718, 'f1': 0.5956123, 'auroc': 0.8972875, 'binary_precision': 0.170062, 'binary_recall': 0.7933884, 'binary_specificity': 0.8437552, 'binary_f1_score': 0.28008753}
confusion matrix:
      0    1
0  5060  937
1    50  192
early stop counter: 1
val acc:0.8758323192596436, best validation acc: 0.8774303793907166, corresponding to test acc:                         0.8443660736083984 / 0.8443660736083984
after epoch: 19,now: 2024-08-01 05:16:08.731041,epoch time: 0:16:16.470678,used: 5:11:48.946358,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_00_04_19_seed_2_23857232
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9286841, 'precision': 0.92893255, 'recall': 0.9286866, 'specificity': 0.9286866, 'f1': 0.9286741, 'auroc': 0.9777366, 'binary_precision': 0.93930554, 'binary_recall': 0.91662663, 'binary_specificity': 0.9407466, 'binary_f1_score': 0.92782754}
confusion matrix:
       0      1
0  27419   1727
1   2431  26727
---- Validation: 
scalar performance:
{'acc': 0.84903854, 'precision': 0.5643455, 'recall': 0.7855004, 'specificity': 0.7855004, 'f1': 0.57495624, 'auroc': 0.86198324, 'binary_precision': 0.13953489, 'binary_recall': 0.717608, 'binary_specificity': 0.8533928, 'binary_f1_score': 0.2336398}
confusion matrix:
       0     1
0  15507  2664
1    170   432
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80477643, 'precision': 0.5690723, 'recall': 0.8191396, 'specificity': 0.8191396, 'f1': 0.5684396, 'auroc': 0.89930224, 'binary_precision': 0.14637682, 'binary_recall': 0.8347107, 'binary_specificity': 0.8035684, 'binary_f1_score': 0.24907522}
confusion matrix:
      0     1
0  4819  1178
1    40   202
early stop counter: 2
val acc:0.8490385413169861, best validation acc: 0.8774303793907166, corresponding to test acc:                         0.8443660736083984 / 0.8443660736083984
after epoch: 20,now: 2024-08-01 05:32:27.195915,epoch time: 0:16:18.464874,used: 5:28:07.411232,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_00_04_19_seed_2_23857232
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 5:28:07.411232 at 2024-08-01 05:32:27.195915
persisted model performance metric: 

scalar performance:
{'acc': 0.8443661, 'precision': 0.58059454, 'recall': 0.8159403, 'specificity': 0.8159403, 'f1': 0.59700394, 'auroc': 0.8955325, 'binary_precision': 0.17132552, 'binary_recall': 0.78512394, 'binary_specificity': 0.8467567, 'binary_f1_score': 0.28127313}
confusion matrix:
      0    1
0  5078  919
1    52  190
oracle model performance metric: 

scalar performance:
{'acc': 0.8443661, 'precision': 0.58059454, 'recall': 0.8159403, 'specificity': 0.8159403, 'f1': 0.59700394, 'auroc': 0.8955325, 'binary_precision': 0.17132552, 'binary_recall': 0.78512394, 'binary_specificity': 0.8467567, 'binary_f1_score': 0.28127313}
confusion matrix:
      0    1
0  5078  919
1    52  190
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_12-46-56/rule_results/16.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_12-46-56/confusion_matrix/16.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 190965 KiB | 461507 KiB |   1040 TiB |   1040 TiB |
|       from large pool | 173494 KiB | 427880 KiB |   1018 TiB |   1018 TiB |
|       from small pool |  17471 KiB |  38507 KiB |     21 TiB |     21 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 190965 KiB | 461507 KiB |   1040 TiB |   1040 TiB |
|       from large pool | 173494 KiB | 427880 KiB |   1018 TiB |   1018 TiB |
|       from small pool |  17471 KiB |  38507 KiB |     21 TiB |     21 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 189282 KiB | 457564 KiB |   1040 TiB |   1040 TiB |
|       from large pool | 172814 KiB | 424940 KiB |   1018 TiB |   1018 TiB |
|       from small pool |  16468 KiB |  37503 KiB |     21 TiB |     21 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 526336 KiB | 526336 KiB |   1074 MiB | 573440 KiB |
|       from large pool | 487424 KiB | 487424 KiB |   1008 MiB | 544768 KiB |
|       from small pool |  38912 KiB |  43008 KiB |     66 MiB |  28672 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  40458 KiB |  87761 KiB | 584882 GiB | 584882 GiB |
|       from large pool |  31306 KiB |  79704 KiB | 562793 GiB | 562793 GiB |
|       from small pool |   9152 KiB |  21236 KiB |  22089 GiB |  22089 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2954    |    7771    |  246074 K  |  246071 K  |
|       from large pool |      76    |     158    |  102831 K  |  102831 K  |
|       from small pool |    2878    |    7693    |  143242 K  |  143239 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2954    |    7771    |  246074 K  |  246071 K  |
|       from large pool |      76    |     158    |  102831 K  |  102831 K  |
|       from small pool |    2878    |    7693    |  143242 K  |  143239 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      41    |      42    |      78    |      37    |
|       from large pool |      22    |      22    |      45    |      23    |
|       from small pool |      19    |      21    |      33    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      31    |    3665    |  130229 K  |  130229 K  |
|       from large pool |      10    |      23    |   61653 K  |   61652 K  |
|       from small pool |      21    |    3655    |   68576 K  |   68576 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 461507 KiB |   1040 TiB |   1040 TiB |
|       from large pool |  17088 KiB | 427880 KiB |   1018 TiB |   1018 TiB |
|       from small pool |      0 KiB |  38507 KiB |     21 TiB |     21 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 461507 KiB |   1040 TiB |   1040 TiB |
|       from large pool |  17088 KiB | 427880 KiB |   1018 TiB |   1018 TiB |
|       from small pool |      0 KiB |  38507 KiB |     21 TiB |     21 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457564 KiB |   1040 TiB |   1040 TiB |
|       from large pool |  16640 KiB | 424940 KiB |   1018 TiB |   1018 TiB |
|       from small pool |      0 KiB |  37503 KiB |     21 TiB |     21 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 231424 KiB | 526336 KiB |   1074 MiB |    848 MiB |
|       from large pool | 204800 KiB | 487424 KiB |   1008 MiB |    808 MiB |
|       from small pool |  26624 KiB |  43008 KiB |     66 MiB |     40 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  87761 KiB | 584882 GiB | 584882 GiB |
|       from large pool |  23872 KiB |  79704 KiB | 562793 GiB | 562793 GiB |
|       from small pool |      0 KiB |  21236 KiB |  22089 GiB |  22089 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7771    |  246074 K  |  246074 K  |
|       from large pool |       2    |     158    |  102831 K  |  102831 K  |
|       from small pool |       0    |    7693    |  143242 K  |  143242 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7771    |  246074 K  |  246074 K  |
|       from large pool |       2    |     158    |  102831 K  |  102831 K  |
|       from small pool |       0    |    7693    |  143242 K  |  143242 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |      42    |      78    |      55    |
|       from large pool |      10    |      22    |      45    |      35    |
|       from small pool |      13    |      21    |      33    |      20    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3665    |  130230 K  |  130230 K  |
|       from large pool |       3    |      23    |   61653 K  |   61653 K  |
|       from small pool |       0    |    3655    |   68577 K  |   68577 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Thu Aug  1 05:33:49 2024]
Finished job 0.
1 of 1 steps (100%) done
