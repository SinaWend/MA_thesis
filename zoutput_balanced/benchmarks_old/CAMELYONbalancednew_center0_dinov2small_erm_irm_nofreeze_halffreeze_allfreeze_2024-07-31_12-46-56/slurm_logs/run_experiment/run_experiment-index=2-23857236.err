Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Wed Jul 31 17:24:35 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_12-46-56/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_12-46-56/rule_results/2.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=2
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_17_35_38_seed_0_23857236

 Experiment start at: 2024-07-31 17:35:38.685168
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.7297859191894531
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9827406, 'precision': 0.98279595, 'recall': 0.98274565, 'specificity': 0.98274565, 'f1': 0.98274016, 'auroc': 0.9983437, 'binary_precision': 0.9881984, 'binary_recall': 0.97718245, 'binary_specificity': 0.9883088, 'binary_f1_score': 0.9826595}
confusion matrix:
       0      1
0  28319    335
1    655  28051
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.8598872, 'precision': 0.58343434, 'recall': 0.84345543, 'specificity': 0.84345543, 'f1': 0.6048603, 'auroc': 0.9076904, 'binary_precision': 0.17398427, 'binary_recall': 0.8258165, 'binary_specificity': 0.8610943, 'binary_f1_score': 0.28741542}
confusion matrix:
       0     1
0  15628  2521
1    112   531
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.809364, 'precision': 0.5777122, 'recall': 0.8345696, 'specificity': 0.8345696, 'f1': 0.58208394, 'auroc': 0.92661846, 'binary_precision': 0.16280752, 'binary_recall': 0.86206895, 'binary_specificity': 0.8070702, 'binary_f1_score': 0.2738892}
confusion matrix:
      0     1
0  4840  1157
1    36   225
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-31 17:57:16.746277,epoch time: 0:21:38.061109,used: 0:21:38.061109,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_17_35_38_seed_0_23857236
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.99103904, 'precision': 0.9910636, 'recall': 0.9910425, 'specificity': 0.9910425, 'f1': 0.99103904, 'auroc': 0.9994979, 'binary_precision': 0.9947701, 'binary_recall': 0.9872849, 'binary_specificity': 0.99480003, 'binary_f1_score': 0.9910134}
confusion matrix:
       0      1
0  28505    149
1    365  28341
---- Validation: 
scalar performance:
{'acc': 0.94449764, 'precision': 0.67138505, 'recall': 0.84675646, 'specificity': 0.84675646, 'f1': 0.72420406, 'auroc': 0.93746793, 'binary_precision': 0.3522895, 'binary_recall': 0.7418352, 'binary_specificity': 0.9516778, 'binary_f1_score': 0.47771657}
confusion matrix:
       0    1
0  17272  877
1    166  477
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.75129044, 'recall': 0.79783857, 'specificity': 0.79783857, 'f1': 0.772298, 'auroc': 0.9284897, 'binary_precision': 0.5192308, 'binary_recall': 0.62068963, 'binary_specificity': 0.9749875, 'binary_f1_score': 0.56544495}
confusion matrix:
      0    1
0  5847  150
1    99  162
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-31 18:17:33.474876,epoch time: 0:20:16.728599,used: 0:41:54.789708,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_17_35_38_seed_0_23857236
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9875349, 'precision': 0.9876681, 'recall': 0.9875284, 'specificity': 0.9875284, 'f1': 0.98753387, 'auroc': 0.9994911, 'binary_precision': 0.97980523, 'binary_recall': 0.99561024, 'binary_specificity': 0.97944653, 'binary_f1_score': 0.9876445}
confusion matrix:
       0      1
0  28068    589
1    126  28577
---- Validation: 
scalar performance:
{'acc': 0.87931037, 'precision': 0.60337734, 'recall': 0.89701426, 'specificity': 0.89701426, 'f1': 0.63770473, 'auroc': 0.94465214, 'binary_precision': 0.210132, 'binary_recall': 0.91601866, 'binary_specificity': 0.8780098, 'binary_f1_score': 0.34184563}
confusion matrix:
       0     1
0  15935  2214
1     54   589
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.78571427, 'precision': 0.57271516, 'recall': 0.8387211, 'specificity': 0.8387211, 'f1': 0.5667307, 'auroc': 0.91873264, 'binary_precision': 0.15116279, 'binary_recall': 0.8965517, 'binary_specificity': 0.78089046, 'binary_f1_score': 0.25870648}
confusion matrix:
      0     1
0  4683  1314
1    27   234
early stop counter: 1
val acc:0.8793103694915771, best validation acc: 0.9444976449012756, corresponding to test acc:                         0.960210919380188 / 0.960210919380188
after epoch: 3,now: 2024-07-31 18:37:43.535763,epoch time: 0:20:10.060887,used: 1:02:04.850595,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_17_35_38_seed_0_23857236
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9890342, 'precision': 0.98908865, 'recall': 0.9890381, 'specificity': 0.9890381, 'f1': 0.98903394, 'auroc': 0.99933875, 'binary_precision': 0.9944343, 'binary_recall': 0.9835894, 'binary_specificity': 0.99448687, 'binary_f1_score': 0.9889821}
confusion matrix:
       0      1
0  28501    158
1    471  28230
---- Validation: 
scalar performance:
{'acc': 0.96322906, 'precision': 0.7193468, 'recall': 0.7011925, 'specificity': 0.7011925, 'f1': 0.7098298, 'auroc': 0.9450836, 'binary_precision': 0.45918366, 'binary_recall': 0.41990668, 'binary_specificity': 0.9824784, 'binary_f1_score': 0.43866777}
confusion matrix:
       0    1
0  17831  318
1    373  270
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.965644, 'precision': 0.8891538, 'recall': 0.6137753, 'specificity': 0.6137753, 'f1': 0.67027926, 'auroc': 0.94016135, 'binary_precision': 0.8108108, 'binary_recall': 0.22988506, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.35820895}
confusion matrix:
      0   1
0  5983  14
1   201  60
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-31 18:57:20.397711,epoch time: 0:19:36.861948,used: 1:21:41.712543,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_17_35_38_seed_0_23857236
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9943863, 'precision': 0.99441046, 'recall': 0.9943893, 'specificity': 0.9943893, 'f1': 0.9943863, 'auroc': 0.9997257, 'binary_precision': 0.9980696, 'binary_recall': 0.99069786, 'binary_specificity': 0.99808073, 'binary_f1_score': 0.9943701}
confusion matrix:
       0      1
0  28602     55
1    267  28436
---- Validation: 
scalar performance:
{'acc': 0.94678587, 'precision': 0.67949975, 'recall': 0.8614421, 'specificity': 0.8614421, 'f1': 0.7346964, 'auroc': 0.93583566, 'binary_precision': 0.3674833, 'binary_recall': 0.7698289, 'binary_specificity': 0.95305526, 'binary_f1_score': 0.49748743}
confusion matrix:
       0    1
0  17297  852
1    148  495
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95302016, 'precision': 0.7174276, 'recall': 0.78492504, 'specificity': 0.78492504, 'f1': 0.74587905, 'auroc': 0.9235418, 'binary_precision': 0.45244956, 'binary_recall': 0.6015326, 'binary_specificity': 0.9683175, 'binary_f1_score': 0.51644737}
confusion matrix:
      0    1
0  5807  190
1   104  157
early stop counter: 1
val acc:0.9467858672142029, best validation acc: 0.9632290601730347, corresponding to test acc:                         0.9656440019607544 / 0.9656440019607544
after epoch: 5,now: 2024-07-31 19:16:51.813824,epoch time: 0:19:31.416113,used: 1:41:13.128656,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_17_35_38_seed_0_23857236
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9907427, 'precision': 0.99077743, 'recall': 0.99074626, 'specificity': 0.99074626, 'f1': 0.99074256, 'auroc': 0.9993157, 'binary_precision': 0.9951142, 'binary_recall': 0.9863429, 'binary_specificity': 0.99514955, 'binary_f1_score': 0.9907091}
confusion matrix:
       0      1
0  28518    139
1    392  28311
---- Validation: 
scalar performance:
{'acc': 0.9641869, 'precision': 0.722499, 'recall': 0.66418564, 'specificity': 0.66418564, 'f1': 0.68843746, 'auroc': 0.8825017, 'binary_precision': 0.4680851, 'binary_recall': 0.3421462, 'binary_specificity': 0.9862251, 'binary_f1_score': 0.39532793}
confusion matrix:
       0    1
0  17899  250
1    423  220
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.7397362, 'recall': 0.69989115, 'specificity': 0.69989115, 'f1': 0.71775484, 'auroc': 0.9102777, 'binary_precision': 0.5046296, 'binary_recall': 0.41762453, 'binary_specificity': 0.98215777, 'binary_f1_score': 0.45702305}
confusion matrix:
      0    1
0  5890  107
1   152  109
better model found
persisted
after epoch: 6,now: 2024-07-31 19:36:53.259772,epoch time: 0:20:01.445948,used: 2:01:14.574604,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_17_35_38_seed_0_23857236
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98995817, 'precision': 0.98995817, 'recall': 0.9899584, 'specificity': 0.9899584, 'f1': 0.98995817, 'auroc': 0.9995645, 'binary_precision': 0.99030685, 'binary_recall': 0.98961675, 'binary_specificity': 0.99030006, 'binary_f1_score': 0.9899617}
confusion matrix:
       0      1
0  28382    278
1    298  28402
---- Validation: 
scalar performance:
{'acc': 0.9643465, 'precision': 0.73697007, 'recall': 0.83078057, 'specificity': 0.83078057, 'f1': 0.7751295, 'auroc': 0.9480406, 'binary_precision': 0.48518112, 'binary_recall': 0.6874028, 'binary_specificity': 0.97415835, 'binary_f1_score': 0.5688546}
confusion matrix:
       0    1
0  17680  469
1    201  442
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.98130393, 'precision': 0.96073306, 'recall': 0.7941854, 'specificity': 0.7941854, 'f1': 0.8575146, 'auroc': 0.9628358, 'binary_precision': 0.9390244, 'binary_recall': 0.5900383, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.7247058}
confusion matrix:
      0    1
0  5987   10
1   107  154
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-07-31 19:56:38.628896,epoch time: 0:19:45.369124,used: 2:20:59.943728,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_17_35_38_seed_0_23857236
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.992242, 'precision': 0.9922705, 'recall': 0.992239, 'specificity': 0.992239, 'f1': 0.9922418, 'auroc': 0.9996593, 'binary_precision': 0.988724, 'binary_recall': 0.99585426, 'binary_specificity': 0.9886237, 'binary_f1_score': 0.9922763}
confusion matrix:
       0      1
0  28330    326
1    119  28585
---- Validation: 
scalar performance:
{'acc': 0.9557791, 'precision': 0.6999345, 'recall': 0.82259476, 'specificity': 0.82259476, 'f1': 0.7447244, 'auroc': 0.9384167, 'binary_precision': 0.41148776, 'binary_recall': 0.67962676, 'binary_specificity': 0.9655628, 'binary_f1_score': 0.51260996}
confusion matrix:
       0    1
0  17524  625
1    206  437
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.73286784, 'recall': 0.5916167, 'specificity': 0.5916167, 'f1': 0.6277678, 'auroc': 0.928056, 'binary_precision': 0.5, 'binary_recall': 0.19157088, 'binary_specificity': 0.9916625, 'binary_f1_score': 0.2770083}
confusion matrix:
      0   1
0  5947  50
1   211  50
early stop counter: 1
val acc:0.9557790756225586, best validation acc: 0.9643465280532837, corresponding to test acc:                         0.9813039302825928 / 0.9813039302825928
after epoch: 8,now: 2024-07-31 20:16:52.481334,epoch time: 0:20:13.852438,used: 2:41:13.796166,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_17_35_38_seed_0_23857236
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9932706, 'precision': 0.993284, 'recall': 0.9932685, 'specificity': 0.9932685, 'f1': 0.9932705, 'auroc': 0.99965775, 'binary_precision': 0.9909163, 'binary_recall': 0.9956802, 'binary_specificity': 0.99085677, 'binary_f1_score': 0.9932925}
confusion matrix:
       0      1
0  28393    262
1    124  28581
---- Validation: 
scalar performance:
{'acc': 0.95434225, 'precision': 0.689546, 'recall': 0.79034865, 'specificity': 0.79034865, 'f1': 0.72774655, 'auroc': 0.9275589, 'binary_precision': 0.39303482, 'binary_recall': 0.61430794, 'binary_specificity': 0.96638936, 'binary_f1_score': 0.4793689}
confusion matrix:
       0    1
0  17539  610
1    248  395
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.924257, 'precision': 0.615348, 'recall': 0.6874625, 'specificity': 0.6874625, 'f1': 0.6404043, 'auroc': 0.89174414, 'binary_precision': 0.2562929, 'binary_recall': 0.42911878, 'binary_specificity': 0.94580626, 'binary_f1_score': 0.3209169}
confusion matrix:
      0    1
0  5672  325
1   149  112
early stop counter: 2
val acc:0.954342246055603, best validation acc: 0.9643465280532837, corresponding to test acc:                         0.9813039302825928 / 0.9813039302825928
after epoch: 9,now: 2024-07-31 20:37:25.124829,epoch time: 0:20:32.643495,used: 3:01:46.439661,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_17_35_38_seed_0_23857236
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9938285, 'precision': 0.9938334, 'recall': 0.99382746, 'specificity': 0.99382746, 'f1': 0.9938284, 'auroc': 0.9997659, 'binary_precision': 0.99242556, 'binary_recall': 0.99526113, 'binary_specificity': 0.99239385, 'binary_f1_score': 0.99384135}
confusion matrix:
       0      1
0  28443    218
1    136  28563
---- Validation: 
scalar performance:
{'acc': 0.95902514, 'precision': 0.7145189, 'recall': 0.8415266, 'specificity': 0.8415266, 'f1': 0.76146334, 'auroc': 0.9507754, 'binary_precision': 0.43935052, 'binary_recall': 0.7153966, 'binary_specificity': 0.9676566, 'binary_f1_score': 0.5443787}
confusion matrix:
       0    1
0  17562  587
1    183  460
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96756154, 'precision': 0.8608352, 'recall': 0.6642488, 'specificity': 0.6642488, 'f1': 0.7224077, 'auroc': 0.9628058, 'binary_precision': 0.75, 'binary_recall': 0.33333334, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.46153843}
confusion matrix:
      0   1
0  5968  29
1   174  87
early stop counter: 3
val acc:0.9590251445770264, best validation acc: 0.9643465280532837, corresponding to test acc:                         0.9813039302825928 / 0.9813039302825928
after epoch: 10,now: 2024-07-31 20:58:07.980773,epoch time: 0:20:42.855944,used: 3:22:29.295605,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_17_35_38_seed_0_23857236
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99314857, 'precision': 0.99323016, 'recall': 0.99315405, 'specificity': 0.99315405, 'f1': 0.99314827, 'auroc': 0.99978304, 'binary_precision': 0.99978817, 'binary_recall': 0.98651755, 'binary_specificity': 0.9997906, 'binary_f1_score': 0.9931085}
confusion matrix:
       0      1
0  28650      6
1    387  28317
---- Validation: 
scalar performance:
{'acc': 0.9699872, 'precision': 0.79241717, 'recall': 0.6694387, 'specificity': 0.6694387, 'f1': 0.7130817, 'auroc': 0.9403361, 'binary_precision': 0.6076294, 'binary_recall': 0.34681183, 'binary_specificity': 0.99206567, 'binary_f1_score': 0.44158417}
confusion matrix:
       0    1
0  18005  144
1    420  223
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590924, 'precision': 0.8035006, 'recall': 0.52057254, 'specificity': 0.52057254, 'f1': 0.5291091, 'auroc': 0.949803, 'binary_precision': 0.64705884, 'binary_recall': 0.042145595, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.07913669}
confusion matrix:
      0   1
0  5991   6
1   250  11
better model found
persisted
after epoch: 11,now: 2024-07-31 21:18:49.196224,epoch time: 0:20:41.215451,used: 3:43:10.511056,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_17_35_38_seed_0_23857236
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9951534, 'precision': 0.9951664, 'recall': 0.9951558, 'specificity': 0.9951558, 'f1': 0.9951534, 'auroc': 0.999793, 'binary_precision': 0.9979331, 'binary_recall': 0.99237067, 'binary_specificity': 0.997941, 'binary_f1_score': 0.9951441}
confusion matrix:
       0      1
0  28596     59
1    219  28486
---- Validation: 
scalar performance:
{'acc': 0.96961474, 'precision': 0.76880157, 'recall': 0.7885047, 'specificity': 0.7885047, 'f1': 0.7782662, 'auroc': 0.9511211, 'binary_precision': 0.5520231, 'binary_recall': 0.5940902, 'binary_specificity': 0.98291916, 'binary_f1_score': 0.5722846}
confusion matrix:
       0    1
0  17839  310
1    261  382
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.7422133, 'recall': 0.5423104, 'specificity': 0.5423104, 'f1': 0.5648046, 'auroc': 0.95764625, 'binary_precision': 0.52272725, 'binary_recall': 0.08812261, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.15081967}
confusion matrix:
      0   1
0  5976  21
1   238  23
early stop counter: 1
val acc:0.9696147441864014, best validation acc: 0.9699872136116028, corresponding to test acc:                         0.959092378616333 / 0.9813039302825928
after epoch: 12,now: 2024-07-31 21:39:26.840016,epoch time: 0:20:37.643792,used: 4:03:48.154848,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_17_35_38_seed_0_23857236
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9960948, 'precision': 0.9961057, 'recall': 0.99609685, 'specificity': 0.99609685, 'f1': 0.9960948, 'auroc': 0.9998315, 'binary_precision': 0.99863434, 'binary_recall': 0.99355465, 'binary_specificity': 0.99863905, 'binary_f1_score': 0.9960881}
confusion matrix:
       0      1
0  28618     39
1    185  28518
---- Validation: 
scalar performance:
{'acc': 0.96392083, 'precision': 0.71580756, 'recall': 0.6370459, 'specificity': 0.6370459, 'f1': 0.6666302, 'auroc': 0.936607, 'binary_precision': 0.4565757, 'binary_recall': 0.28615862, 'binary_specificity': 0.9879332, 'binary_f1_score': 0.35181645}
confusion matrix:
       0    1
0  17930  219
1    459  184
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97331417, 'precision': 0.8973272, 'recall': 0.72954965, 'specificity': 0.72954965, 'f1': 0.7889467, 'auroc': 0.9564316, 'binary_precision': 0.8175676, 'binary_recall': 0.46360153, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.591687}
confusion matrix:
      0    1
0  5970   27
1   140  121
early stop counter: 2
val acc:0.9639208316802979, best validation acc: 0.9699872136116028, corresponding to test acc:                         0.959092378616333 / 0.9813039302825928
after epoch: 13,now: 2024-07-31 21:59:57.288755,epoch time: 0:20:30.448739,used: 4:24:18.603587,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_17_35_38_seed_0_23857236
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9948396, 'precision': 0.99487805, 'recall': 0.9948431, 'specificity': 0.9948431, 'f1': 0.99483955, 'auroc': 0.9998504, 'binary_precision': 0.9994374, 'binary_recall': 0.99024457, 'binary_specificity': 0.9994417, 'binary_f1_score': 0.99481976}
confusion matrix:
       0      1
0  28642     16
1    280  28422
---- Validation: 
scalar performance:
{'acc': 0.96897614, 'precision': 0.79639006, 'recall': 0.6186616, 'specificity': 0.6186616, 'f1': 0.66635656, 'auroc': 0.9468962, 'binary_precision': 0.61904764, 'binary_recall': 0.24261275, 'binary_specificity': 0.99471045, 'binary_f1_score': 0.34860337}
confusion matrix:
       0    1
0  18053   96
1    487  156
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.76272094, 'recall': 0.52407044, 'specificity': 0.52407044, 'f1': 0.53522855, 'auroc': 0.954232, 'binary_precision': 0.5652174, 'binary_recall': 0.049808428, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.09154929}
confusion matrix:
      0   1
0  5987  10
1   248  13
early stop counter: 3
val acc:0.9689761400222778, best validation acc: 0.9699872136116028, corresponding to test acc:                         0.959092378616333 / 0.9813039302825928
after epoch: 14,now: 2024-07-31 22:20:49.358303,epoch time: 0:20:52.069548,used: 4:45:10.673135,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_17_35_38_seed_0_23857236
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99524057, 'precision': 0.9952407, 'recall': 0.99524057, 'specificity': 0.99524057, 'f1': 0.99524057, 'auroc': 0.99980867, 'binary_precision': 0.9951573, 'binary_recall': 0.9953307, 'binary_specificity': 0.9951504, 'binary_f1_score': 0.99524397}
confusion matrix:
       0      1
0  28523    139
1    134  28564
---- Validation: 
scalar performance:
{'acc': 0.96243083, 'precision': 0.7099528, 'recall': 0.6782776, 'specificity': 0.6782776, 'f1': 0.69266254, 'auroc': 0.9423669, 'binary_precision': 0.44198895, 'binary_recall': 0.3732504, 'binary_specificity': 0.98330486, 'binary_f1_score': 0.40472177}
confusion matrix:
       0    1
0  17846  303
1    403  240
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95637584, 'precision': 0.47910663, 'recall': 0.4989995, 'specificity': 0.4989995, 'f1': 0.48885077, 'auroc': 0.94745994, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.997999, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5985  12
1   261   0
early stop counter: 4
val acc:0.9624308347702026, best validation acc: 0.9699872136116028, corresponding to test acc:                         0.959092378616333 / 0.9813039302825928
after epoch: 15,now: 2024-07-31 22:41:18.593364,epoch time: 0:20:29.235061,used: 5:05:39.908196,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_17_35_38_seed_0_23857236
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9926604, 'precision': 0.9926925, 'recall': 0.99266374, 'specificity': 0.99266374, 'f1': 0.9926603, 'auroc': 0.99963033, 'binary_precision': 0.9968728, 'binary_recall': 0.98843324, 'binary_specificity': 0.9968943, 'binary_f1_score': 0.9926351}
confusion matrix:
       0      1
0  28568     89
1    332  28371
---- Validation: 
scalar performance:
{'acc': 0.963708, 'precision': 0.7306036, 'recall': 0.78544664, 'specificity': 0.78544664, 'f1': 0.75474095, 'auroc': 0.94353455, 'binary_precision': 0.47571605, 'binary_recall': 0.5940902, 'binary_specificity': 0.9768031, 'binary_f1_score': 0.52835405}
confusion matrix:
       0    1
0  17728  421
1    261  382
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97203577, 'precision': 0.8564757, 'recall': 0.7545353, 'specificity': 0.7545353, 'f1': 0.7961221, 'auroc': 0.9500222, 'binary_precision': 0.7336956, 'binary_recall': 0.51724136, 'binary_specificity': 0.9918293, 'binary_f1_score': 0.60674155}
confusion matrix:
      0    1
0  5948   49
1   126  135
early stop counter: 5
val acc:0.9637079834938049, best validation acc: 0.9699872136116028, corresponding to test acc:                         0.959092378616333 / 0.9813039302825928
after epoch: 16,now: 2024-07-31 23:01:40.805384,epoch time: 0:20:22.212020,used: 5:26:02.120216,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_17_35_38_seed_0_23857236
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99470013, 'precision': 0.9947178, 'recall': 0.99470294, 'specificity': 0.99470294, 'f1': 0.9947001, 'auroc': 0.9998467, 'binary_precision': 0.9978963, 'binary_recall': 0.9914997, 'binary_specificity': 0.99790615, 'binary_f1_score': 0.9946877}
confusion matrix:
       0      1
0  28595     60
1    244  28461
---- Validation: 
scalar performance:
{'acc': 0.94109195, 'precision': 0.62870383, 'recall': 0.7039829, 'specificity': 0.7039829, 'f1': 0.6560951, 'auroc': 0.905346, 'binary_precision': 0.27735126, 'binary_recall': 0.44945568, 'binary_specificity': 0.9585101, 'binary_f1_score': 0.34302673}
confusion matrix:
       0    1
0  17396  753
1    354  289
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93240654, 'precision': 0.6474699, 'recall': 0.74118763, 'specificity': 0.74118763, 'f1': 0.6803872, 'auroc': 0.92420924, 'binary_precision': 0.3159091, 'binary_recall': 0.532567, 'binary_specificity': 0.94980824, 'binary_f1_score': 0.39657632}
confusion matrix:
      0    1
0  5696  301
1   122  139
early stop counter: 6
val acc:0.9410919547080994, best validation acc: 0.9699872136116028, corresponding to test acc:                         0.959092378616333 / 0.9813039302825928
after epoch: 17,now: 2024-07-31 23:22:03.421403,epoch time: 0:20:22.616019,used: 5:46:24.736235,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_17_35_38_seed_0_23857236
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9940028, 'precision': 0.9940037, 'recall': 0.9940024, 'specificity': 0.9940024, 'f1': 0.99400276, 'auroc': 0.9997196, 'binary_precision': 0.99349135, 'binary_recall': 0.9945298, 'binary_specificity': 0.993475, 'binary_f1_score': 0.99401027}
confusion matrix:
       0      1
0  28472    187
1    157  28544
---- Validation: 
scalar performance:
{'acc': 0.96514475, 'precision': 0.72324276, 'recall': 0.5851757, 'specificity': 0.5851757, 'f1': 0.62018186, 'auroc': 0.9380442, 'binary_precision': 0.475, 'binary_recall': 0.17729394, 'binary_specificity': 0.9930575, 'binary_f1_score': 0.25821066}
confusion matrix:
       0    1
0  18023  126
1    529  114
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579738, 'precision': 0.71870977, 'recall': 0.53647995, 'specificity': 0.53647995, 'f1': 0.55523944, 'auroc': 0.93305767, 'binary_precision': 0.47619048, 'binary_recall': 0.07662835, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.1320132}
confusion matrix:
      0   1
0  5975  22
1   241  20
early stop counter: 7
val acc:0.9651447534561157, best validation acc: 0.9699872136116028, corresponding to test acc:                         0.959092378616333 / 0.9813039302825928
after epoch: 18,now: 2024-07-31 23:42:36.954991,epoch time: 0:20:33.533588,used: 6:06:58.269823,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_17_35_38_seed_0_23857236
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99614716, 'precision': 0.99617004, 'recall': 0.99615014, 'specificity': 0.99615014, 'f1': 0.9961471, 'auroc': 0.9998209, 'binary_precision': 0.99975437, 'binary_recall': 0.9925446, 'binary_specificity': 0.99975574, 'binary_f1_score': 0.9961364}
confusion matrix:
       0      1
0  28649      7
1    214  28490
---- Validation: 
scalar performance:
{'acc': 0.96961474, 'precision': 0.8112804, 'recall': 0.6197423, 'specificity': 0.6197423, 'f1': 0.66962165, 'auroc': 0.9626634, 'binary_precision': 0.6487603, 'binary_recall': 0.24416797, 'binary_specificity': 0.99531657, 'binary_f1_score': 0.35480228}
confusion matrix:
       0    1
0  18064   85
1    486  157
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9576542, 'precision': 0.6460935, 'recall': 0.50699586, 'specificity': 0.50699586, 'f1': 0.5038295, 'auroc': 0.9649426, 'binary_precision': 0.33333334, 'binary_recall': 0.01532567, 'binary_specificity': 0.998666, 'binary_f1_score': 0.029304028}
confusion matrix:
      0  1
0  5989  8
1   257  4
early stop counter: 8
val acc:0.9696147441864014, best validation acc: 0.9699872136116028, corresponding to test acc:                         0.959092378616333 / 0.9813039302825928
after epoch: 19,now: 2024-08-01 00:02:26.847215,epoch time: 0:19:49.892224,used: 6:26:48.162047,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_17_35_38_seed_0_23857236
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99435145, 'precision': 0.99440885, 'recall': 0.99435496, 'specificity': 0.99435496, 'f1': 0.9943513, 'auroc': 0.9998628, 'binary_precision': 0.9998943, 'binary_recall': 0.98881453, 'binary_specificity': 0.99989533, 'binary_f1_score': 0.99432355}
confusion matrix:
       0      1
0  28659      3
1    321  28377
---- Validation: 
scalar performance:
{'acc': 0.9703065, 'precision': 0.80842996, 'recall': 0.64710236, 'specificity': 0.64710236, 'f1': 0.69683456, 'auroc': 0.95407605, 'binary_precision': 0.641196, 'binary_recall': 0.30015552, 'binary_specificity': 0.99404925, 'binary_f1_score': 0.40889832}
confusion matrix:
       0    1
0  18041  108
1    450  193
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95733464, 'precision': 0.6994263, 'recall': 0.53797877, 'specificity': 0.53797877, 'f1': 0.55702484, 'auroc': 0.93266124, 'binary_precision': 0.4375, 'binary_recall': 0.08045977, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.13592233}
confusion matrix:
      0   1
0  5970  27
1   240  21
better model found
persisted
after epoch: 20,now: 2024-08-01 00:22:11.412263,epoch time: 0:19:44.565048,used: 6:46:32.727095,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_17_35_38_seed_0_23857236
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 6:46:32.727095 at 2024-08-01 00:22:11.412263
persisted model performance metric: 

scalar performance:
{'acc': 0.95733464, 'precision': 0.6994263, 'recall': 0.53797877, 'specificity': 0.53797877, 'f1': 0.55702484, 'auroc': 0.93266124, 'binary_precision': 0.4375, 'binary_recall': 0.08045977, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.13592233}
confusion matrix:
      0   1
0  5970  27
1   240  21
oracle model performance metric: 

scalar performance:
{'acc': 0.98130393, 'precision': 0.96073306, 'recall': 0.7941854, 'specificity': 0.7941854, 'f1': 0.8575146, 'auroc': 0.9628358, 'binary_precision': 0.9390244, 'binary_recall': 0.5900383, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.7247058}
confusion matrix:
      0    1
0  5987   10
1   107  154
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_12-46-56/rule_results/2.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_12-46-56/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_12-46-56/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 458481 KiB |  13220 MiB | 553672 GiB | 553671 GiB |
|       from large pool | 416794 KiB |  13181 MiB | 546060 GiB | 546059 GiB |
|       from small pool |  41687 KiB |     61 MiB |   7611 GiB |   7611 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 458481 KiB |  13220 MiB | 553672 GiB | 553671 GiB |
|       from large pool | 416794 KiB |  13181 MiB | 546060 GiB | 546059 GiB |
|       from small pool |  41687 KiB |     61 MiB |   7611 GiB |   7611 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447754 KiB |  13213 MiB | 553142 GiB | 553141 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 545547 GiB | 545547 GiB |
|       from small pool |  40679 KiB |     60 MiB |   7594 GiB |   7594 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14492 MiB |  14492 MiB |  14492 MiB |      0 B   |
|       from large pool |  14422 MiB |  14422 MiB |  14422 MiB |      0 B   |
|       from small pool |     70 MiB |     70 MiB |     70 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 418062 KiB |   1258 MiB | 441906 GiB | 441906 GiB |
|       from large pool | 406502 KiB |   1252 MiB | 434264 GiB | 434264 GiB |
|       from small pool |  11560 KiB |     16 MiB |   7641 GiB |   7641 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3488    |    8175    |  107517 K  |  107514 K  |
|       from large pool |     187    |    1413    |   50335 K  |   50335 K  |
|       from small pool |    3301    |    7986    |   57182 K  |   57178 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3488    |    8175    |  107517 K  |  107514 K  |
|       from large pool |     187    |    1413    |   50335 K  |   50335 K  |
|       from small pool |    3301    |    7986    |   57182 K  |   57178 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     637    |     637    |     637    |       0    |
|       from large pool |     602    |     602    |     602    |       0    |
|       from small pool |      35    |      35    |      35    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      75    |    3639    |   63439 K  |   63439 K  |
|       from large pool |      30    |     604    |   35602 K  |   35602 K  |
|       from small pool |      45    |    3608    |   27836 K  |   27836 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13220 MiB | 553672 GiB | 553672 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 546060 GiB | 546060 GiB |
|       from small pool |      0 KiB |     61 MiB |   7611 GiB |   7611 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13220 MiB | 553672 GiB | 553672 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 546060 GiB | 546060 GiB |
|       from small pool |      0 KiB |     61 MiB |   7611 GiB |   7611 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 553142 GiB | 553142 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 545547 GiB | 545547 GiB |
|       from small pool |      0 KiB |     60 MiB |   7594 GiB |   7594 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    856 MiB |  14492 MiB |  14492 MiB |  13636 MiB |
|       from large pool |    804 MiB |  14422 MiB |  14422 MiB |  13618 MiB |
|       from small pool |     52 MiB |     70 MiB |     70 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1258 MiB | 441906 GiB | 441906 GiB |
|       from large pool |  24320 KiB |   1252 MiB | 434265 GiB | 434265 GiB |
|       from small pool |      0 KiB |     42 MiB |   7641 GiB |   7641 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8175    |  107517 K  |  107517 K  |
|       from large pool |       2    |    1413    |   50335 K  |   50335 K  |
|       from small pool |       0    |    7986    |   57182 K  |   57182 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8175    |  107517 K  |  107517 K  |
|       from large pool |       2    |    1413    |   50335 K  |   50335 K  |
|       from small pool |       0    |    7986    |   57182 K  |   57182 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     637    |     637    |     575    |
|       from large pool |      36    |     602    |     602    |     566    |
|       from small pool |      26    |      35    |      35    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3639    |   63440 K  |   63440 K  |
|       from large pool |       3    |     604    |   35602 K  |   35602 K  |
|       from small pool |       0    |    3608    |   27838 K  |   27838 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13220 MiB | 553672 GiB | 553672 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 546060 GiB | 546060 GiB |
|       from small pool |      0 KiB |     61 MiB |   7611 GiB |   7611 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13220 MiB | 553672 GiB | 553672 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 546060 GiB | 546060 GiB |
|       from small pool |      0 KiB |     61 MiB |   7611 GiB |   7611 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 553142 GiB | 553142 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 545547 GiB | 545547 GiB |
|       from small pool |      0 KiB |     60 MiB |   7594 GiB |   7594 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    856 MiB |  14492 MiB |  14492 MiB |  13636 MiB |
|       from large pool |    804 MiB |  14422 MiB |  14422 MiB |  13618 MiB |
|       from small pool |     52 MiB |     70 MiB |     70 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1258 MiB | 441906 GiB | 441906 GiB |
|       from large pool |  24320 KiB |   1252 MiB | 434265 GiB | 434265 GiB |
|       from small pool |      0 KiB |     42 MiB |   7641 GiB |   7641 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8175    |  107517 K  |  107517 K  |
|       from large pool |       2    |    1413    |   50335 K  |   50335 K  |
|       from small pool |       0    |    7986    |   57182 K  |   57182 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8175    |  107517 K  |  107517 K  |
|       from large pool |       2    |    1413    |   50335 K  |   50335 K  |
|       from small pool |       0    |    7986    |   57182 K  |   57182 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     637    |     637    |     575    |
|       from large pool |      36    |     602    |     602    |     566    |
|       from small pool |      26    |      35    |      35    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3639    |   63440 K  |   63440 K  |
|       from large pool |       3    |     604    |   35602 K  |   35602 K  |
|       from small pool |       0    |    3608    |   27838 K  |   27838 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_00_32_10_seed_1_23857236

 Experiment start at: 2024-08-01 00:32:11.089155
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.6474379897117615
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9794328, 'precision': 0.9798455, 'recall': 0.9794436, 'specificity': 0.9794436, 'f1': 0.97942865, 'auroc': 0.99810934, 'binary_precision': 0.99410164, 'binary_recall': 0.964619, 'binary_specificity': 0.99426824, 'binary_f1_score': 0.9791384}
confusion matrix:
       0      1
0  28622    165
1   1020  27809
---- Validation: 
scalar performance:
{'acc': 0.9085913, 'precision': 0.5910747, 'recall': 0.7215618, 'specificity': 0.7215618, 'f1': 0.620623, 'auroc': 0.8377426, 'binary_precision': 0.20114942, 'binary_recall': 0.5200594, 'binary_specificity': 0.9230642, 'binary_f1_score': 0.2900953}
confusion matrix:
       0     1
0  16677  1390
1    323   350
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8485337, 'precision': 0.5878958, 'recall': 0.816133, 'specificity': 0.816133, 'f1': 0.6083448, 'auroc': 0.88422537, 'binary_precision': 0.18692449, 'binary_recall': 0.7807692, 'binary_specificity': 0.8514968, 'binary_f1_score': 0.3016345}
confusion matrix:
      0    1
0  5063  883
1    57  203
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-01 00:53:28.896015,epoch time: 0:21:17.806860,used: 0:21:17.806860,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_00_32_10_seed_1_23857236
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.98222715, 'precision': 0.9827492, 'recall': 0.98223984, 'specificity': 0.98223984, 'f1': 0.9822227, 'auroc': 0.99904513, 'binary_precision': 0.998816, 'binary_recall': 0.96562606, 'binary_specificity': 0.9988536, 'binary_f1_score': 0.9819407}
confusion matrix:
       0      1
0  28753     33
1    991  27839
---- Validation: 
scalar performance:
{'acc': 0.93356454, 'precision': 0.6571009, 'recall': 0.85753953, 'specificity': 0.85753953, 'f1': 0.710358, 'auroc': 0.9313043, 'binary_precision': 0.3230198, 'binary_recall': 0.7756315, 'binary_specificity': 0.93944764, 'binary_f1_score': 0.45609438}
confusion matrix:
       0     1
0  16973  1094
1    151   522
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89590716, 'precision': 0.6232898, 'recall': 0.8426945, 'specificity': 0.8426945, 'f1': 0.6651103, 'auroc': 0.91665953, 'binary_precision': 0.25692695, 'binary_recall': 0.7846154, 'binary_specificity': 0.90077364, 'binary_f1_score': 0.3870968}
confusion matrix:
      0    1
0  5356  590
1    56  204
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-01 01:13:46.732796,epoch time: 0:20:17.836781,used: 0:41:35.643641,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_00_32_10_seed_1_23857236
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9919467, 'precision': 0.99195683, 'recall': 0.99194854, 'specificity': 0.99194854, 'f1': 0.9919467, 'auroc': 0.9995502, 'binary_precision': 0.9943879, 'binary_recall': 0.9894901, 'binary_specificity': 0.994407, 'binary_f1_score': 0.991933}
confusion matrix:
       0      1
0  28625    161
1    303  28527
---- Validation: 
scalar performance:
{'acc': 0.9464248, 'precision': 0.6827383, 'recall': 0.84775805, 'specificity': 0.84775805, 'f1': 0.73510116, 'auroc': 0.9410989, 'binary_precision': 0.37547028, 'binary_recall': 0.74145615, 'binary_specificity': 0.9540599, 'binary_f1_score': 0.4985015}
confusion matrix:
       0    1
0  17237  830
1    174  499
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9690622, 'precision': 0.8034581, 'recall': 0.82570183, 'specificity': 0.82570183, 'f1': 0.8141359, 'auroc': 0.93386364, 'binary_precision': 0.62142855, 'binary_recall': 0.66923076, 'binary_specificity': 0.9821729, 'binary_f1_score': 0.6444444}
confusion matrix:
      0    1
0  5840  106
1    86  174
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-01 01:33:48.444291,epoch time: 0:20:01.711495,used: 1:01:37.355136,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_00_32_10_seed_1_23857236
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9865836, 'precision': 0.9865846, 'recall': 0.98658425, 'specificity': 0.98658425, 'f1': 0.9865836, 'auroc': 0.99900484, 'binary_precision': 0.9874896, 'binary_recall': 0.98567414, 'binary_specificity': 0.98749435, 'binary_f1_score': 0.986581}
confusion matrix:
       0      1
0  28427    360
1    413  28416
---- Validation: 
scalar performance:
{'acc': 0.96643543, 'precision': 0.7607661, 'recall': 0.69863147, 'specificity': 0.69863147, 'f1': 0.7250361, 'auroc': 0.9328996, 'binary_precision': 0.54330707, 'binary_recall': 0.410104, 'binary_specificity': 0.9871589, 'binary_f1_score': 0.46740046}
confusion matrix:
       0    1
0  17835  232
1    397  276
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9634225, 'precision': 0.84924525, 'recall': 0.5984023, 'specificity': 0.5984023, 'f1': 0.6477048, 'auroc': 0.92676103, 'binary_precision': 0.73239434, 'binary_recall': 0.2, 'binary_specificity': 0.9968046, 'binary_f1_score': 0.31419942}
confusion matrix:
      0   1
0  5927  19
1   208  52
better model found
persisted
after epoch: 4,now: 2024-08-01 01:53:48.073556,epoch time: 0:19:59.629265,used: 1:21:36.984401,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_00_32_10_seed_1_23857236
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9866183, 'precision': 0.98695606, 'recall': 0.98662806, 'specificity': 0.98662806, 'f1': 0.98661613, 'auroc': 0.99951386, 'binary_precision': 0.99996436, 'binary_recall': 0.9732908, 'binary_specificity': 0.99996525, 'binary_f1_score': 0.9864473}
confusion matrix:
       0      1
0  28786      1
1    770  28059
---- Validation: 
scalar performance:
{'acc': 0.9677695, 'precision': 0.7766734, 'recall': 0.6893096, 'specificity': 0.6893096, 'f1': 0.72396183, 'auroc': 0.938618, 'binary_precision': 0.5758242, 'binary_recall': 0.38930163, 'binary_specificity': 0.98931754, 'binary_f1_score': 0.46453902}
confusion matrix:
       0    1
0  17874  193
1    411  262
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9695456, 'precision': 0.8989028, 'recall': 0.6714792, 'specificity': 0.6714792, 'f1': 0.7360556, 'auroc': 0.953485, 'binary_precision': 0.82568806, 'binary_recall': 0.34615386, 'binary_specificity': 0.9968046, 'binary_f1_score': 0.48780492}
confusion matrix:
      0   1
0  5927  19
1   170  90
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-01 02:13:40.533422,epoch time: 0:19:52.459866,used: 1:41:29.444267,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_00_32_10_seed_1_23857236
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9925368, 'precision': 0.99256134, 'recall': 0.9925395, 'specificity': 0.9925395, 'f1': 0.9925368, 'auroc': 0.999597, 'binary_precision': 0.9962258, 'binary_recall': 0.9888307, 'binary_specificity': 0.9962483, 'binary_f1_score': 0.9925145}
confusion matrix:
       0      1
0  28679    108
1    322  28507
---- Validation: 
scalar performance:
{'acc': 0.9545891, 'precision': 0.7057024, 'recall': 0.840548, 'specificity': 0.840548, 'f1': 0.75389165, 'auroc': 0.94074667, 'binary_precision': 0.4222028, 'binary_recall': 0.717682, 'binary_specificity': 0.96341395, 'binary_f1_score': 0.53164554}
confusion matrix:
       0    1
0  17406  661
1    190  483
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9703513, 'precision': 0.8101469, 'recall': 0.8374085, 'specificity': 0.8374085, 'f1': 0.82313037, 'auroc': 0.9363546, 'binary_precision': 0.63380283, 'binary_recall': 0.6923077, 'binary_specificity': 0.98250926, 'binary_f1_score': 0.6617647}
confusion matrix:
      0    1
0  5842  104
1    80  180
new oracle model saved
early stop counter: 1
val acc:0.9545891284942627, best validation acc: 0.9677695035934448, corresponding to test acc:                         0.9695456027984619 / 0.9703512787818909
after epoch: 6,now: 2024-08-01 02:33:28.937230,epoch time: 0:19:48.403808,used: 2:01:17.848075,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_00_32_10_seed_1_23857236
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.994203, 'precision': 0.9942473, 'recall': 0.9942068, 'specificity': 0.9942068, 'f1': 0.99420285, 'auroc': 0.9997605, 'binary_precision': 0.9991242, 'binary_recall': 0.989282, 'binary_specificity': 0.9991315, 'binary_f1_score': 0.9941788}
confusion matrix:
       0      1
0  28761     25
1    309  28521
---- Validation: 
scalar performance:
{'acc': 0.9666489, 'precision': 0.75892353, 'recall': 0.7666925, 'specificity': 0.7666925, 'f1': 0.76274383, 'auroc': 0.9402282, 'binary_precision': 0.53458214, 'binary_recall': 0.551263, 'binary_specificity': 0.9821221, 'binary_f1_score': 0.54279447}
confusion matrix:
       0    1
0  17744  323
1    302  371
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97905254, 'precision': 0.9411864, 'recall': 0.7794238, 'specificity': 0.7794238, 'f1': 0.8405504, 'auroc': 0.94048876, 'binary_precision': 0.90123457, 'binary_recall': 0.56153846, 'binary_specificity': 0.9973091, 'binary_f1_score': 0.6919431}
confusion matrix:
      0    1
0  5930   16
1   114  146
new oracle model saved
early stop counter: 2
val acc:0.9666488766670227, best validation acc: 0.9677695035934448, corresponding to test acc:                         0.9695456027984619 / 0.9790525436401367
after epoch: 7,now: 2024-08-01 02:53:20.249944,epoch time: 0:19:51.312714,used: 2:21:09.160789,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_00_32_10_seed_1_23857236
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.993665, 'precision': 0.993665, 'recall': 0.993665, 'specificity': 0.993665, 'f1': 0.993665, 'auroc': 0.9996711, 'binary_precision': 0.9936869, 'binary_recall': 0.99365246, 'binary_specificity': 0.9936775, 'binary_f1_score': 0.9936697}
confusion matrix:
       0      1
0  28604    182
1    183  28647
---- Validation: 
scalar performance:
{'acc': 0.9314301, 'precision': 0.6605357, 'recall': 0.8957722, 'specificity': 0.8957722, 'f1': 0.7182367, 'auroc': 0.94453263, 'binary_precision': 0.32672706, 'binary_recall': 0.8573551, 'binary_specificity': 0.9341894, 'binary_f1_score': 0.47314474}
confusion matrix:
       0     1
0  16878  1189
1     96   577
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621334, 'precision': 0.76174927, 'recall': 0.92323023, 'specificity': 0.92323023, 'f1': 0.82042086, 'auroc': 0.9658413, 'binary_precision': 0.5288684, 'binary_recall': 0.88076925, 'binary_specificity': 0.9656912, 'binary_f1_score': 0.6608947}
confusion matrix:
      0    1
0  5742  204
1    31  229
early stop counter: 3
val acc:0.9314301013946533, best validation acc: 0.9677695035934448, corresponding to test acc:                         0.9695456027984619 / 0.9790525436401367
after epoch: 8,now: 2024-08-01 03:14:00.462609,epoch time: 0:20:40.212665,used: 2:41:49.373454,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_00_32_10_seed_1_23857236
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9931963, 'precision': 0.99320734, 'recall': 0.9931947, 'specificity': 0.9931947, 'f1': 0.99319625, 'auroc': 0.9997569, 'binary_precision': 0.9910551, 'binary_recall': 0.9953866, 'binary_specificity': 0.99100286, 'binary_f1_score': 0.9932161}
confusion matrix:
       0      1
0  28528    259
1    133  28696
---- Validation: 
scalar performance:
{'acc': 0.92508006, 'precision': 0.6437435, 'recall': 0.8588614, 'specificity': 0.8588614, 'f1': 0.6950494, 'auroc': 0.93189573, 'binary_precision': 0.29592407, 'binary_recall': 0.78751856, 'binary_specificity': 0.9302042, 'binary_f1_score': 0.4301948}
confusion matrix:
       0     1
0  16806  1261
1    143   530
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9505317, 'precision': 0.7197028, 'recall': 0.874879, 'specificity': 0.874879, 'f1': 0.77338153, 'auroc': 0.9491373, 'binary_precision': 0.44880176, 'binary_recall': 0.7923077, 'binary_specificity': 0.9574504, 'binary_f1_score': 0.5730181}
confusion matrix:
      0    1
0  5693  253
1    54  206
early stop counter: 4
val acc:0.9250800609588623, best validation acc: 0.9677695035934448, corresponding to test acc:                         0.9695456027984619 / 0.9790525436401367
after epoch: 9,now: 2024-08-01 03:34:34.193419,epoch time: 0:20:33.730810,used: 3:02:23.104264,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_00_32_10_seed_1_23857236
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99246734, 'precision': 0.99254173, 'recall': 0.99247175, 'specificity': 0.99247175, 'f1': 0.99246716, 'auroc': 0.99961364, 'binary_precision': 0.99877036, 'binary_recall': 0.98615927, 'binary_specificity': 0.99878424, 'binary_f1_score': 0.9924248}
confusion matrix:
       0      1
0  28753     35
1    399  28429
---- Validation: 
scalar performance:
{'acc': 0.9632337, 'precision': 0.72946894, 'recall': 0.6640687, 'specificity': 0.6640687, 'f1': 0.69069177, 'auroc': 0.9290105, 'binary_precision': 0.48319328, 'binary_recall': 0.34175333, 'binary_specificity': 0.98638403, 'binary_f1_score': 0.4003481}
confusion matrix:
       0    1
0  17821  246
1    443  230
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95681596, 'precision': 0.69878036, 'recall': 0.54897994, 'specificity': 0.54897994, 'f1': 0.5727674, 'auroc': 0.92049617, 'binary_precision': 0.43548387, 'binary_recall': 0.103846155, 'binary_specificity': 0.9941137, 'binary_f1_score': 0.16770187}
confusion matrix:
      0   1
0  5911  35
1   233  27
early stop counter: 5
val acc:0.9632337093353271, best validation acc: 0.9677695035934448, corresponding to test acc:                         0.9695456027984619 / 0.9790525436401367
after epoch: 10,now: 2024-08-01 03:54:38.862927,epoch time: 0:20:04.669508,used: 3:22:27.773772,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_00_32_10_seed_1_23857236
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9928318, 'precision': 0.9928386, 'recall': 0.9928307, 'specificity': 0.9928307, 'f1': 0.9928318, 'auroc': 0.99970776, 'binary_precision': 0.9911841, 'binary_recall': 0.99451923, 'binary_specificity': 0.99114215, 'binary_f1_score': 0.9928489}
confusion matrix:
       0      1
0  28533    255
1    158  28670
---- Validation: 
scalar performance:
{'acc': 0.96360725, 'precision': 0.7419564, 'recall': 0.8366418, 'specificity': 0.8366418, 'f1': 0.78051436, 'auroc': 0.948605, 'binary_precision': 0.49526814, 'binary_recall': 0.6998514, 'binary_specificity': 0.97343224, 'binary_f1_score': 0.5800493}
confusion matrix:
       0    1
0  17587  480
1    202  471
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9742185, 'precision': 0.8516197, 'recall': 0.81000286, 'specificity': 0.81000286, 'f1': 0.82935643, 'auroc': 0.95580703, 'binary_precision': 0.71929824, 'binary_recall': 0.63076925, 'binary_specificity': 0.9892365, 'binary_f1_score': 0.6721312}
confusion matrix:
      0    1
0  5882   64
1    96  164
early stop counter: 6
val acc:0.9636072516441345, best validation acc: 0.9677695035934448, corresponding to test acc:                         0.9695456027984619 / 0.9790525436401367
after epoch: 11,now: 2024-08-01 04:14:56.191096,epoch time: 0:20:17.328169,used: 3:42:45.101941,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_00_32_10_seed_1_23857236
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9781658, 'precision': 0.9785005, 'recall': 0.97815627, 'specificity': 0.97815627, 'f1': 0.9781616, 'auroc': 0.9987979, 'binary_precision': 0.9660255, 'binary_recall': 0.9912241, 'binary_specificity': 0.9650884, 'binary_f1_score': 0.9784625}
confusion matrix:
       0      1
0  27782   1005
1    253  28576
---- Validation: 
scalar performance:
{'acc': 0.8744397, 'precision': 0.59153175, 'recall': 0.8290217, 'specificity': 0.8290217, 'f1': 0.6197509, 'auroc': 0.9159952, 'binary_precision': 0.1923077, 'binary_recall': 0.78008914, 'binary_specificity': 0.8779543, 'binary_f1_score': 0.30855128}
confusion matrix:
       0     1
0  15862  2205
1    148   525
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91411537, 'precision': 0.5511237, 'recall': 0.5726707, 'specificity': 0.5726707, 'f1': 0.559, 'auroc': 0.82547754, 'binary_precision': 0.13793103, 'binary_recall': 0.2, 'binary_specificity': 0.9453414, 'binary_f1_score': 0.1632653}
confusion matrix:
      0    1
0  5621  325
1   208   52
early stop counter: 7
val acc:0.8744397163391113, best validation acc: 0.9677695035934448, corresponding to test acc:                         0.9695456027984619 / 0.9790525436401367
after epoch: 12,now: 2024-08-01 04:35:04.525021,epoch time: 0:20:08.333925,used: 4:02:53.435866,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_00_32_10_seed_1_23857236
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9936476, 'precision': 0.9936949, 'recall': 0.99365115, 'specificity': 0.99365115, 'f1': 0.9936475, 'auroc': 0.99967515, 'binary_precision': 0.9987034, 'binary_recall': 0.9885875, 'binary_specificity': 0.99871475, 'binary_f1_score': 0.99361974}
confusion matrix:
       0      1
0  28751     37
1    329  28499
---- Validation: 
scalar performance:
{'acc': 0.97049093, 'precision': 0.80205333, 'recall': 0.7186164, 'specificity': 0.7186164, 'f1': 0.75299424, 'auroc': 0.953568, 'binary_precision': 0.6244813, 'binary_recall': 0.4472511, 'binary_specificity': 0.9899817, 'binary_f1_score': 0.52121216}
confusion matrix:
       0    1
0  17886  181
1    372  301
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96084434, 'precision': 0.9803684, 'recall': 0.5326923, 'specificity': 0.5326923, 'f1': 0.55135953, 'auroc': 0.95860755, 'binary_precision': 1.0, 'binary_recall': 0.06538462, 'binary_specificity': 1.0, 'binary_f1_score': 0.12274369}
confusion matrix:
      0   1
0  5946   0
1   243  17
better model found
persisted
after epoch: 13,now: 2024-08-01 04:55:13.000332,epoch time: 0:20:08.475311,used: 4:23:01.911177,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_00_32_10_seed_1_23857236
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9950361, 'precision': 0.99506235, 'recall': 0.99503875, 'specificity': 0.99503875, 'f1': 0.995036, 'auroc': 0.9997678, 'binary_precision': 0.9988465, 'binary_recall': 0.9912238, 'binary_specificity': 0.9988537, 'binary_f1_score': 0.9950205}
confusion matrix:
       0      1
0  28755     33
1    253  28575
---- Validation: 
scalar performance:
{'acc': 0.96798295, 'precision': 0.7752639, 'recall': 0.7108783, 'specificity': 0.7108783, 'f1': 0.7383563, 'auroc': 0.95397043, 'binary_precision': 0.5714286, 'binary_recall': 0.43387815, 'binary_specificity': 0.98787844, 'binary_f1_score': 0.49324325}
confusion matrix:
       0    1
0  17848  219
1    381  292
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96310025, 'precision': 0.83920693, 'recall': 0.5982341, 'specificity': 0.5982341, 'f1': 0.6466769, 'auroc': 0.957497, 'binary_precision': 0.7123288, 'binary_recall': 0.2, 'binary_specificity': 0.9964682, 'binary_f1_score': 0.3123123}
confusion matrix:
      0   1
0  5925  21
1   208  52
early stop counter: 1
val acc:0.9679829478263855, best validation acc: 0.9704909324645996, corresponding to test acc:                         0.9608443379402161 / 0.9790525436401367
after epoch: 14,now: 2024-08-01 05:15:23.072924,epoch time: 0:20:10.072592,used: 4:43:11.983769,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_00_32_10_seed_1_23857236
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99369967, 'precision': 0.9937153, 'recall': 0.9937018, 'specificity': 0.9937018, 'f1': 0.9936996, 'auroc': 0.999606, 'binary_precision': 0.9966848, 'binary_recall': 0.9907038, 'binary_specificity': 0.99669987, 'binary_f1_score': 0.9936853}
confusion matrix:
       0      1
0  28692     95
1    268  28561
---- Validation: 
scalar performance:
{'acc': 0.96451443, 'precision': 0.74317783, 'recall': 0.71837795, 'specificity': 0.71837795, 'f1': 0.7300319, 'auroc': 0.94783163, 'binary_precision': 0.50664455, 'binary_recall': 0.45319465, 'binary_specificity': 0.9835612, 'binary_f1_score': 0.47843137}
confusion matrix:
       0    1
0  17770  297
1    368  305
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96052206, 'precision': 0.81846845, 'recall': 0.55459195, 'specificity': 0.55459195, 'f1': 0.58559316, 'auroc': 0.953485, 'binary_precision': 0.6744186, 'binary_recall': 0.11153846, 'binary_specificity': 0.9976455, 'binary_f1_score': 0.19141914}
confusion matrix:
      0   1
0  5932  14
1   231  29
early stop counter: 2
val acc:0.964514434337616, best validation acc: 0.9704909324645996, corresponding to test acc:                         0.9608443379402161 / 0.9790525436401367
after epoch: 15,now: 2024-08-01 05:35:49.533269,epoch time: 0:20:26.460345,used: 5:03:38.444114,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_00_32_10_seed_1_23857236
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9930228, 'precision': 0.9930563, 'recall': 0.99302006, 'specificity': 0.99302006, 'f1': 0.9930226, 'auroc': 0.99981904, 'binary_precision': 0.98915887, 'binary_recall': 0.9969821, 'binary_specificity': 0.98905796, 'binary_f1_score': 0.9930551}
confusion matrix:
       0      1
0  28473    315
1     87  28741
---- Validation: 
scalar performance:
{'acc': 0.9542156, 'precision': 0.70769745, 'recall': 0.86538863, 'specificity': 0.86538863, 'f1': 0.76144, 'auroc': 0.9529568, 'binary_precision': 0.42424244, 'binary_recall': 0.76968795, 'binary_specificity': 0.96108925, 'binary_f1_score': 0.5469905}
confusion matrix:
       0    1
0  17364  703
1    155  518
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9767966, 'precision': 0.85953593, 'recall': 0.84628904, 'specificity': 0.84628904, 'f1': 0.85277414, 'auroc': 0.9539993, 'binary_precision': 0.732, 'binary_recall': 0.70384616, 'binary_specificity': 0.9887319, 'binary_f1_score': 0.71764714}
confusion matrix:
      0    1
0  5879   67
1    77  183
early stop counter: 3
val acc:0.9542155861854553, best validation acc: 0.9704909324645996, corresponding to test acc:                         0.9608443379402161 / 0.9790525436401367
after epoch: 16,now: 2024-08-01 05:57:00.557349,epoch time: 0:21:11.024080,used: 5:24:49.468194,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_00_32_10_seed_1_23857236
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99684113, 'precision': 0.9968469, 'recall': 0.9968426, 'specificity': 0.9968426, 'f1': 0.9968411, 'auroc': 0.9999025, 'binary_precision': 0.9987465, 'binary_recall': 0.9949358, 'binary_specificity': 0.9987494, 'binary_f1_score': 0.99683744}
confusion matrix:
       0      1
0  28750     36
1    146  28684
---- Validation: 
scalar performance:
{'acc': 0.9681964, 'precision': 0.7670506, 'recall': 0.82686234, 'specificity': 0.82686234, 'f1': 0.7935784, 'auroc': 0.95630383, 'binary_precision': 0.54632974, 'binary_recall': 0.67459136, 'binary_specificity': 0.97913325, 'binary_f1_score': 0.6037234}
confusion matrix:
       0    1
0  17690  377
1    219  454
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9626168, 'precision': 0.7930524, 'recall': 0.63843954, 'specificity': 0.63843954, 'f1': 0.6850959, 'auroc': 0.9493287, 'binary_precision': 0.6166667, 'binary_recall': 0.2846154, 'binary_specificity': 0.99226373, 'binary_f1_score': 0.3894737}
confusion matrix:
      0   1
0  5900  46
1   186  74
early stop counter: 4
val acc:0.9681963920593262, best validation acc: 0.9704909324645996, corresponding to test acc:                         0.9608443379402161 / 0.9790525436401367
after epoch: 17,now: 2024-08-01 06:17:48.350391,epoch time: 0:20:47.793042,used: 5:45:37.261236,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_00_32_10_seed_1_23857236
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9956783, 'precision': 0.99569845, 'recall': 0.99568087, 'specificity': 0.99568087, 'f1': 0.99567825, 'auroc': 0.9998312, 'binary_precision': 0.9990571, 'binary_recall': 0.9922997, 'binary_specificity': 0.99906206, 'binary_f1_score': 0.9956669}
confusion matrix:
       0      1
0  28759     27
1    222  28608
---- Validation: 
scalar performance:
{'acc': 0.96558166, 'precision': 0.7514492, 'recall': 0.7818749, 'specificity': 0.7818749, 'f1': 0.765687, 'auroc': 0.94971645, 'binary_precision': 0.51846963, 'binary_recall': 0.5839524, 'binary_specificity': 0.9797974, 'binary_f1_score': 0.5492663}
confusion matrix:
       0    1
0  17702  365
1    280  393
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9692233, 'precision': 0.81032884, 'recall': 0.8000401, 'specificity': 0.8000401, 'f1': 0.8050871, 'auroc': 0.95865226, 'binary_precision': 0.6374502, 'binary_recall': 0.61538464, 'binary_specificity': 0.9846956, 'binary_f1_score': 0.62622315}
confusion matrix:
      0    1
0  5855   91
1   100  160
early stop counter: 5
val acc:0.9655816555023193, best validation acc: 0.9704909324645996, corresponding to test acc:                         0.9608443379402161 / 0.9790525436401367
after epoch: 18,now: 2024-08-01 06:38:26.649972,epoch time: 0:20:38.299581,used: 6:06:15.560817,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_00_32_10_seed_1_23857236
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99600804, 'precision': 0.9960121, 'recall': 0.9960093, 'specificity': 0.9960093, 'f1': 0.99600804, 'auroc': 0.9998258, 'binary_precision': 0.99763364, 'binary_recall': 0.99438083, 'binary_specificity': 0.99763775, 'binary_f1_score': 0.9960046}
confusion matrix:
       0      1
0  28718     68
1    162  28668
---- Validation: 
scalar performance:
{'acc': 0.93303096, 'precision': 0.6634893, 'recall': 0.89731777, 'specificity': 0.89731777, 'f1': 0.7218412, 'auroc': 0.95956194, 'binary_precision': 0.33256617, 'binary_recall': 0.858841, 'binary_specificity': 0.93579453, 'binary_f1_score': 0.4794691}
confusion matrix:
       0     1
0  16907  1160
1     95   578
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9255559, 'precision': 0.6618497, 'recall': 0.8563281, 'specificity': 0.8563281, 'f1': 0.7138606, 'auroc': 0.9338139, 'binary_precision': 0.3338816, 'binary_recall': 0.7807692, 'binary_specificity': 0.931887, 'binary_f1_score': 0.4677419}
confusion matrix:
      0    1
0  5541  405
1    57  203
early stop counter: 6
val acc:0.9330309629440308, best validation acc: 0.9704909324645996, corresponding to test acc:                         0.9608443379402161 / 0.9790525436401367
after epoch: 19,now: 2024-08-01 06:59:37.189542,epoch time: 0:21:10.539570,used: 6:27:26.100387,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_00_32_10_seed_1_23857236
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9962684, 'precision': 0.99626863, 'recall': 0.99626875, 'specificity': 0.99626875, 'f1': 0.9962684, 'auroc': 0.9998839, 'binary_precision': 0.99680525, 'binary_recall': 0.9957333, 'binary_specificity': 0.99680424, 'binary_f1_score': 0.996269}
confusion matrix:
       0      1
0  28696     92
1    123  28705
---- Validation: 
scalar performance:
{'acc': 0.9608858, 'precision': 0.72437656, 'recall': 0.7787243, 'specificity': 0.7787243, 'f1': 0.7482137, 'auroc': 0.94352204, 'binary_precision': 0.46445498, 'binary_recall': 0.58246654, 'binary_specificity': 0.974982, 'binary_f1_score': 0.51680946}
confusion matrix:
       0    1
0  17615  452
1    281  392
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9510152, 'precision': 0.68719697, 'recall': 0.66364783, 'specificity': 0.66364783, 'f1': 0.67449754, 'auroc': 0.93262, 'binary_precision': 0.40265486, 'binary_recall': 0.35, 'binary_specificity': 0.97729564, 'binary_f1_score': 0.37448558}
confusion matrix:
      0    1
0  5811  135
1   169   91
early stop counter: 7
val acc:0.9608858227729797, best validation acc: 0.9704909324645996, corresponding to test acc:                         0.9608443379402161 / 0.9790525436401367
after epoch: 20,now: 2024-08-01 07:20:50.216491,epoch time: 0:21:13.026949,used: 6:48:39.127336,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_00_32_10_seed_1_23857236
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 6:48:39.127336 at 2024-08-01 07:20:50.216491
persisted model performance metric: 

scalar performance:
{'acc': 0.96084434, 'precision': 0.9803684, 'recall': 0.5326923, 'specificity': 0.5326923, 'f1': 0.55135953, 'auroc': 0.95860755, 'binary_precision': 1.0, 'binary_recall': 0.06538462, 'binary_specificity': 1.0, 'binary_f1_score': 0.12274369}
confusion matrix:
      0   1
0  5946   0
1   243  17
oracle model performance metric: 

scalar performance:
{'acc': 0.97905254, 'precision': 0.9411864, 'recall': 0.7794238, 'specificity': 0.7794238, 'f1': 0.8405504, 'auroc': 0.94048876, 'binary_precision': 0.90123457, 'binary_recall': 0.56153846, 'binary_specificity': 0.9973091, 'binary_f1_score': 0.6919431}
confusion matrix:
      0    1
0  5930   16
1   114  146
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_12-46-56/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_12-46-56/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456559 KiB |  13220 MiB |   1089 TiB |   1089 TiB |
|       from large pool | 414883 KiB |  13181 MiB |   1074 TiB |   1074 TiB |
|       from small pool |  41675 KiB |     61 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 456559 KiB |  13220 MiB |   1089 TiB |   1089 TiB |
|       from large pool | 414883 KiB |  13181 MiB |   1074 TiB |   1074 TiB |
|       from small pool |  41675 KiB |     61 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447751 KiB |  13213 MiB |   1088 TiB |   1088 TiB |
|       from large pool | 407075 KiB |  13175 MiB |   1073 TiB |   1073 TiB |
|       from small pool |  40676 KiB |     60 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14468 MiB |  14492 MiB |  28104 MiB |  13636 MiB |
|       from large pool |  14402 MiB |  14422 MiB |  28020 MiB |  13618 MiB |
|       from small pool |     66 MiB |     70 MiB |     84 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 487569 KiB |   1258 MiB |    871 TiB |    871 TiB |
|       from large pool | 475996 KiB |   1252 MiB |    856 TiB |    856 TiB |
|       from small pool |  11572 KiB |     42 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3464    |    8207    |  216291 K  |  216287 K  |
|       from large pool |     187    |    1413    |  101429 K  |  101429 K  |
|       from small pool |    3277    |    8018    |  114861 K  |  114858 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3464    |    8207    |  216291 K  |  216287 K  |
|       from large pool |     187    |    1413    |  101429 K  |  101429 K  |
|       from small pool |    3277    |    8018    |  114861 K  |  114858 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     634    |     637    |    1209    |     575    |
|       from large pool |     601    |     602    |    1167    |     566    |
|       from small pool |      33    |      35    |      42    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      86    |    3668    |  132752 K  |  132752 K  |
|       from large pool |      41    |     604    |   76559 K  |   76559 K  |
|       from small pool |      45    |    3625    |   56192 K  |   56192 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13220 MiB |   1089 TiB |   1089 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1074 TiB |   1074 TiB |
|       from small pool |      0 KiB |     61 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13220 MiB |   1089 TiB |   1089 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1074 TiB |   1074 TiB |
|       from small pool |      0 KiB |     61 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   1088 TiB |   1088 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   1073 TiB |   1073 TiB |
|       from small pool |      0 KiB |     60 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    922 MiB |  14492 MiB |  28104 MiB |  27182 MiB |
|       from large pool |    870 MiB |  14422 MiB |  28020 MiB |  27150 MiB |
|       from small pool |     52 MiB |     70 MiB |     84 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1258 MiB |    871 TiB |    871 TiB |
|       from large pool |  24320 KiB |   1252 MiB |    856 TiB |    856 TiB |
|       from small pool |      0 KiB |     42 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8207    |  216291 K  |  216291 K  |
|       from large pool |       2    |    1413    |  101429 K  |  101429 K  |
|       from small pool |       0    |    8018    |  114861 K  |  114861 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8207    |  216291 K  |  216291 K  |
|       from large pool |       2    |    1413    |  101429 K  |  101429 K  |
|       from small pool |       0    |    8018    |  114861 K  |  114861 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      65    |     637    |    1209    |    1144    |
|       from large pool |      39    |     602    |    1167    |    1128    |
|       from small pool |      26    |      35    |      42    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3668    |  132753 K  |  132753 K  |
|       from large pool |       3    |     604    |   76559 K  |   76559 K  |
|       from small pool |       0    |    3625    |   56194 K  |   56194 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13220 MiB |   1089 TiB |   1089 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1074 TiB |   1074 TiB |
|       from small pool |      0 KiB |     61 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13220 MiB |   1089 TiB |   1089 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1074 TiB |   1074 TiB |
|       from small pool |      0 KiB |     61 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   1088 TiB |   1088 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   1073 TiB |   1073 TiB |
|       from small pool |      0 KiB |     60 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    922 MiB |  14492 MiB |  28104 MiB |  27182 MiB |
|       from large pool |    870 MiB |  14422 MiB |  28020 MiB |  27150 MiB |
|       from small pool |     52 MiB |     70 MiB |     84 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1258 MiB |    871 TiB |    871 TiB |
|       from large pool |  24320 KiB |   1252 MiB |    856 TiB |    856 TiB |
|       from small pool |      0 KiB |     42 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8207    |  216291 K  |  216291 K  |
|       from large pool |       2    |    1413    |  101429 K  |  101429 K  |
|       from small pool |       0    |    8018    |  114861 K  |  114861 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8207    |  216291 K  |  216291 K  |
|       from large pool |       2    |    1413    |  101429 K  |  101429 K  |
|       from small pool |       0    |    8018    |  114861 K  |  114861 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      65    |     637    |    1209    |    1144    |
|       from large pool |      39    |     602    |    1167    |    1128    |
|       from small pool |      26    |      35    |      42    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3668    |  132753 K  |  132753 K  |
|       from large pool |       3    |     604    |   76559 K  |   76559 K  |
|       from small pool |       0    |    3625    |   56194 K  |   56194 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_07_31_26_seed_2_23857236

 Experiment start at: 2024-08-01 07:31:26.660604
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.754768431186676
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.98368895, 'precision': 0.98392665, 'recall': 0.9836912, 'specificity': 0.9836912, 'f1': 0.98368704, 'auroc': 0.998348, 'binary_precision': 0.9947034, 'binary_recall': 0.97256327, 'binary_specificity': 0.99481916, 'binary_f1_score': 0.98350877}
confusion matrix:
       0      1
0  28995    151
1    800  28358
---- Validation: 
scalar performance:
{'acc': 0.8245885, 'precision': 0.5664418, 'recall': 0.8403264, 'specificity': 0.8403264, 'f1': 0.56974435, 'auroc': 0.9089347, 'binary_precision': 0.1385979, 'binary_recall': 0.85714287, 'binary_specificity': 0.82351, 'binary_f1_score': 0.23861271}
confusion matrix:
       0     1
0  14964  3207
1     86   516
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6581183, 'precision': 0.5458758, 'recall': 0.7884545, 'specificity': 0.7884545, 'f1': 0.4793263, 'auroc': 0.92288566, 'binary_precision': 0.09611277, 'binary_recall': 0.92975205, 'binary_specificity': 0.6471569, 'binary_f1_score': 0.17421603}
confusion matrix:
      0     1
0  3881  2116
1    17   225
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-01 07:53:49.596805,epoch time: 0:22:22.936201,used: 0:22:22.936201,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_07_31_26_seed_2_23857236
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9857128, 'precision': 0.98602647, 'recall': 0.98571503, 'specificity': 0.98571503, 'f1': 0.9857105, 'auroc': 0.99862194, 'binary_precision': 0.99841624, 'binary_recall': 0.9729739, 'binary_specificity': 0.9984561, 'binary_f1_score': 0.98553085}
confusion matrix:
       0      1
0  29102     45
1    788  28369
---- Validation: 
scalar performance:
{'acc': 0.94817024, 'precision': 0.6680742, 'recall': 0.8262687, 'specificity': 0.8262687, 'f1': 0.71774983, 'auroc': 0.91565394, 'binary_precision': 0.34656742, 'binary_recall': 0.6960133, 'binary_specificity': 0.95652413, 'binary_f1_score': 0.4627278}
confusion matrix:
       0    1
0  17381  790
1    183  419
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9338035, 'precision': 0.6624868, 'recall': 0.83470523, 'specificity': 0.83470523, 'f1': 0.71243536, 'auroc': 0.90631455, 'binary_precision': 0.33652008, 'binary_recall': 0.72727275, 'binary_specificity': 0.9421377, 'binary_f1_score': 0.46013072}
confusion matrix:
      0    1
0  5650  347
1    66  176
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-01 08:15:33.201379,epoch time: 0:21:43.604574,used: 0:44:06.540775,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_07_31_26_seed_2_23857236
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9904809, 'precision': 0.99063826, 'recall': 0.9904828, 'specificity': 0.9904828, 'f1': 0.99048024, 'auroc': 0.99942243, 'binary_precision': 0.99947613, 'binary_recall': 0.98148024, 'binary_specificity': 0.9994854, 'binary_f1_score': 0.9903965}
confusion matrix:
       0      1
0  29131     15
1    540  28618
---- Validation: 
scalar performance:
{'acc': 0.9640974, 'precision': 0.7200315, 'recall': 0.78229797, 'specificity': 0.78229797, 'f1': 0.7468319, 'auroc': 0.9338397, 'binary_precision': 0.45384616, 'binary_recall': 0.5880399, 'binary_specificity': 0.97655606, 'binary_f1_score': 0.512301}
confusion matrix:
       0    1
0  17745  426
1    248  354
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9706684, 'precision': 0.87007284, 'recall': 0.6734521, 'specificity': 0.6734521, 'f1': 0.7332468, 'auroc': 0.9539267, 'binary_precision': 0.7657658, 'binary_recall': 0.35123968, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.48158643}
confusion matrix:
      0   1
0  5971  26
1   157  85
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-01 08:37:14.661524,epoch time: 0:21:41.460145,used: 1:05:48.000920,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_07_31_26_seed_2_23857236
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97883505, 'precision': 0.9794528, 'recall': 0.978832, 'specificity': 0.978832, 'f1': 0.9788282, 'auroc': 0.9994726, 'binary_precision': 0.962286, 'binary_recall': 0.9967418, 'binary_specificity': 0.96092224, 'binary_f1_score': 0.9792109}
confusion matrix:
       0      1
0  28008   1139
1     95  29062
---- Validation: 
scalar performance:
{'acc': 0.8469611, 'precision': 0.57573885, 'recall': 0.8542924, 'specificity': 0.8542924, 'f1': 0.58999413, 'auroc': 0.920623, 'binary_precision': 0.15684497, 'binary_recall': 0.86212623, 'binary_specificity': 0.8464586, 'binary_f1_score': 0.26540527}
confusion matrix:
       0     1
0  15381  2790
1     83   519
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8987017, 'precision': 0.62551147, 'recall': 0.8779111, 'specificity': 0.8779111, 'f1': 0.670255, 'auroc': 0.92943513, 'binary_precision': 0.25746268, 'binary_recall': 0.8553719, 'binary_specificity': 0.9004502, 'binary_f1_score': 0.3957935}
confusion matrix:
      0    1
0  5400  597
1    35  207
early stop counter: 1
val acc:0.8469610810279846, best validation acc: 0.9640973806381226, corresponding to test acc:                         0.970668375492096 / 0.970668375492096
after epoch: 4,now: 2024-08-01 08:59:37.599872,epoch time: 0:22:22.938348,used: 1:28:10.939268,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_07_31_26_seed_2_23857236
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9896748, 'precision': 0.9898789, 'recall': 0.98967695, 'specificity': 0.98967695, 'f1': 0.98967373, 'auroc': 0.9994988, 'binary_precision': 0.99992996, 'binary_recall': 0.97942245, 'binary_specificity': 0.9999314, 'binary_f1_score': 0.9895699}
confusion matrix:
       0      1
0  29144      2
1    600  28558
---- Validation: 
scalar performance:
{'acc': 0.96500295, 'precision': 0.5798505, 'recall': 0.5121384, 'specificity': 0.5121384, 'f1': 0.5156887, 'auroc': 0.8948234, 'binary_precision': 0.19101124, 'binary_recall': 0.028239202, 'binary_specificity': 0.99603766, 'binary_f1_score': 0.049204048}
confusion matrix:
       0   1
0  18099  72
1    585  17
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96105146, 'precision': 0.6807507, 'recall': 0.5038821, 'specificity': 0.5038821, 'f1': 0.49816337, 'auroc': 0.935976, 'binary_precision': 0.4, 'binary_recall': 0.008264462, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.016194332}
confusion matrix:
      0  1
0  5994  3
1   240  2
better model found
persisted
after epoch: 5,now: 2024-08-01 09:21:20.851062,epoch time: 0:21:43.251190,used: 1:49:54.190458,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_07_31_26_seed_2_23857236
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.99471736, 'precision': 0.99472064, 'recall': 0.9947176, 'specificity': 0.9947176, 'f1': 0.99471736, 'auroc': 0.9996642, 'binary_precision': 0.9960454, 'binary_recall': 0.9933809, 'binary_specificity': 0.99605435, 'binary_f1_score': 0.99471134}
confusion matrix:
       0      1
0  29031    115
1    193  28965
---- Validation: 
scalar performance:
{'acc': 0.9577052, 'precision': 0.6874825, 'recall': 0.76695025, 'specificity': 0.76695025, 'f1': 0.7192937, 'auroc': 0.91795635, 'binary_precision': 0.38965517, 'binary_recall': 0.5631229, 'binary_specificity': 0.97077763, 'binary_f1_score': 0.4605978}
confusion matrix:
       0    1
0  17640  531
1    263  339
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9296362, 'precision': 0.63841426, 'recall': 0.7631416, 'specificity': 0.7631416, 'f1': 0.676892, 'auroc': 0.87835586, 'binary_precision': 0.29436326, 'binary_recall': 0.58264464, 'binary_specificity': 0.9436385, 'binary_f1_score': 0.39112344}
confusion matrix:
      0    1
0  5659  338
1   101  141
early stop counter: 1
val acc:0.9577051997184753, best validation acc: 0.9650029540061951, corresponding to test acc:                         0.9610514640808105 / 0.970668375492096
after epoch: 6,now: 2024-08-01 09:42:48.258918,epoch time: 0:21:27.407856,used: 2:11:21.598314,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_07_31_26_seed_2_23857236
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9951118, 'precision': 0.9951134, 'recall': 0.9951117, 'specificity': 0.9951117, 'f1': 0.9951118, 'auroc': 0.9997987, 'binary_precision': 0.994282, 'binary_recall': 0.99595296, 'binary_specificity': 0.99427044, 'binary_f1_score': 0.9951168}
confusion matrix:
       0      1
0  28980    167
1    118  29039
---- Validation: 
scalar performance:
{'acc': 0.9521121, 'precision': 0.6622603, 'recall': 0.746394, 'specificity': 0.746394, 'f1': 0.69430244, 'auroc': 0.9160593, 'binary_precision': 0.3404941, 'binary_recall': 0.52657807, 'binary_specificity': 0.9662099, 'binary_f1_score': 0.41356814}
confusion matrix:
       0    1
0  17557  614
1    285  317
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9713095, 'precision': 0.81593513, 'recall': 0.7768881, 'specificity': 0.7768881, 'f1': 0.7949854, 'auroc': 0.9436096, 'binary_precision': 0.6492891, 'binary_recall': 0.5661157, 'binary_specificity': 0.98766047, 'binary_f1_score': 0.6048565}
confusion matrix:
      0    1
0  5923   74
1   105  137
new oracle model saved
early stop counter: 2
val acc:0.952112078666687, best validation acc: 0.9650029540061951, corresponding to test acc:                         0.9610514640808105 / 0.9713094830513
after epoch: 7,now: 2024-08-01 10:04:25.554324,epoch time: 0:21:37.295406,used: 2:32:58.893720,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_07_31_26_seed_2_23857236
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9938255, 'precision': 0.9938776, 'recall': 0.9938263, 'specificity': 0.9938263, 'f1': 0.9938253, 'auroc': 0.99966943, 'binary_precision': 0.99899495, 'binary_recall': 0.98864764, 'binary_specificity': 0.999005, 'binary_f1_score': 0.9937944}
confusion matrix:
       0      1
0  29118     29
1    331  28826
---- Validation: 
scalar performance:
{'acc': 0.9636712, 'precision': 0.70372474, 'recall': 0.6873181, 'specificity': 0.6873181, 'f1': 0.69513583, 'auroc': 0.9304497, 'binary_precision': 0.42753622, 'binary_recall': 0.39202657, 'binary_specificity': 0.9826096, 'binary_f1_score': 0.40901214}
confusion matrix:
       0    1
0  17855  316
1    366  236
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597692, 'precision': 0.6991626, 'recall': 0.5567491, 'specificity': 0.5567491, 'f1': 0.58353806, 'auroc': 0.9525889, 'binary_precision': 0.43283582, 'binary_recall': 0.11983471, 'binary_specificity': 0.9936635, 'binary_f1_score': 0.18770227}
confusion matrix:
      0   1
0  5959  38
1   213  29
early stop counter: 3
val acc:0.9636712074279785, best validation acc: 0.9650029540061951, corresponding to test acc:                         0.9610514640808105 / 0.9713094830513
after epoch: 8,now: 2024-08-01 10:25:34.576839,epoch time: 0:21:09.022515,used: 2:54:07.916235,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_07_31_26_seed_2_23857236
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.99337953, 'precision': 0.993381, 'recall': 0.9933798, 'specificity': 0.9933798, 'f1': 0.99337953, 'auroc': 0.9995909, 'binary_precision': 0.9942965, 'binary_recall': 0.9924552, 'binary_specificity': 0.99430436, 'binary_f1_score': 0.993375}
confusion matrix:
       0      1
0  28979    166
1    220  28939
---- Validation: 
scalar performance:
{'acc': 0.91706175, 'precision': 0.61578953, 'recall': 0.8302754, 'specificity': 0.8302754, 'f1': 0.6594162, 'auroc': 0.9222811, 'binary_precision': 0.24091156, 'binary_recall': 0.73754156, 'binary_specificity': 0.9230092, 'binary_f1_score': 0.36319017}
confusion matrix:
       0     1
0  16772  1399
1    158   444
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94662607, 'precision': 0.6986214, 'recall': 0.8790473, 'specificity': 0.8790473, 'f1': 0.7555454, 'auroc': 0.9393459, 'binary_precision': 0.4054054, 'binary_recall': 0.8057851, 'binary_specificity': 0.9523095, 'binary_f1_score': 0.5394191}
confusion matrix:
      0    1
0  5711  286
1    47  195
early stop counter: 4
val acc:0.9170617461204529, best validation acc: 0.9650029540061951, corresponding to test acc:                         0.9610514640808105 / 0.9713094830513
after epoch: 9,now: 2024-08-01 10:46:58.561989,epoch time: 0:21:23.985150,used: 3:15:31.901385,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_07_31_26_seed_2_23857236
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98979485, 'precision': 0.9898556, 'recall': 0.9897958, 'specificity': 0.9897958, 'f1': 0.9897946, 'auroc': 0.9993094, 'binary_precision': 0.9953521, 'binary_recall': 0.98418903, 'binary_specificity': 0.99540263, 'binary_f1_score': 0.9897391}
confusion matrix:
       0      1
0  29013    134
1    461  28696
---- Validation: 
scalar performance:
{'acc': 0.9631385, 'precision': 0.6466492, 'recall': 0.56257045, 'specificity': 0.56257045, 'f1': 0.5854179, 'auroc': 0.88657093, 'binary_precision': 0.32142857, 'binary_recall': 0.1345515, 'binary_specificity': 0.9905894, 'binary_f1_score': 0.18969555}
confusion matrix:
       0    1
0  18000  171
1    521   81
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9604103, 'precision': 0.68133247, 'recall': 0.51941055, 'specificity': 0.51941055, 'f1': 0.5273394, 'auroc': 0.9134776, 'binary_precision': 0.4, 'binary_recall': 0.041322313, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.074906364}
confusion matrix:
      0   1
0  5982  15
1   232  10
early stop counter: 5
val acc:0.9631385207176208, best validation acc: 0.9650029540061951, corresponding to test acc:                         0.9610514640808105 / 0.9713094830513
after epoch: 10,now: 2024-08-01 11:08:21.769047,epoch time: 0:21:23.207058,used: 3:36:55.108443,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_07_31_26_seed_2_23857236
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9942028, 'precision': 0.994256, 'recall': 0.9942033, 'specificity': 0.9942033, 'f1': 0.9942026, 'auroc': 0.9997745, 'binary_precision': 0.99941075, 'binary_recall': 0.9889899, 'binary_specificity': 0.99941677, 'binary_f1_score': 0.994173}
confusion matrix:
       0      1
0  29132     17
1    321  28834
---- Validation: 
scalar performance:
{'acc': 0.97256696, 'precision': 0.7895177, 'recall': 0.71680784, 'specificity': 0.71680784, 'f1': 0.74747276, 'auroc': 0.9488677, 'binary_precision': 0.59731543, 'binary_recall': 0.4435216, 'binary_specificity': 0.9900941, 'binary_f1_score': 0.5090562}
confusion matrix:
       0    1
0  17991  180
1    335  267
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9713095, 'precision': 0.92164445, 'recall': 0.6519754, 'specificity': 0.6519754, 'f1': 0.71893406, 'auroc': 0.94514406, 'binary_precision': 0.87058824, 'binary_recall': 0.30578512, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.4525994}
confusion matrix:
      0   1
0  5986  11
1   168  74
better model found
persisted
after epoch: 11,now: 2024-08-01 11:29:13.226732,epoch time: 0:20:51.457685,used: 3:57:46.566128,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_07_31_26_seed_2_23857236
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9883884, 'precision': 0.9884112, 'recall': 0.9883894, 'specificity': 0.9883894, 'f1': 0.98838836, 'auroc': 0.9990667, 'binary_precision': 0.99181545, 'binary_recall': 0.98491085, 'binary_specificity': 0.99186796, 'binary_f1_score': 0.9883511}
confusion matrix:
       0      1
0  28907    237
1    440  28720
---- Validation: 
scalar performance:
{'acc': 0.9590369, 'precision': 0.6908797, 'recall': 0.7547894, 'specificity': 0.7547894, 'f1': 0.7176267, 'auroc': 0.9337419, 'binary_precision': 0.39729398, 'binary_recall': 0.53654486, 'binary_specificity': 0.97303396, 'binary_f1_score': 0.4565371}
confusion matrix:
       0    1
0  17681  490
1    279  323
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96185285, 'precision': 0.7815083, 'recall': 0.5241264, 'specificity': 0.5241264, 'f1': 0.5360602, 'auroc': 0.94586515, 'binary_precision': 0.6, 'binary_recall': 0.049586777, 'binary_specificity': 0.998666, 'binary_f1_score': 0.09160305}
confusion matrix:
      0   1
0  5989   8
1   230  12
early stop counter: 1
val acc:0.9590368866920471, best validation acc: 0.9725669622421265, corresponding to test acc:                         0.9713094830513 / 0.9713094830513
after epoch: 12,now: 2024-08-01 11:50:22.474505,epoch time: 0:21:09.247773,used: 4:18:55.813901,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_07_31_26_seed_2_23857236
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99602085, 'precision': 0.99602324, 'recall': 0.99602073, 'specificity': 0.99602073, 'f1': 0.99602085, 'auroc': 0.9998331, 'binary_precision': 0.99496883, 'binary_recall': 0.9970847, 'binary_specificity': 0.9949568, 'binary_f1_score': 0.9960256}
confusion matrix:
       0      1
0  29001    147
1     85  29071
---- Validation: 
scalar performance:
{'acc': 0.9467853, 'precision': 0.66824526, 'recall': 0.8456295, 'specificity': 0.8456295, 'f1': 0.7212864, 'auroc': 0.9400039, 'binary_precision': 0.3455253, 'binary_recall': 0.73754156, 'binary_specificity': 0.95371747, 'binary_f1_score': 0.47058827}
confusion matrix:
       0    1
0  17330  841
1    158  444
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96281457, 'precision': 0.7515203, 'recall': 0.8398824, 'specificity': 0.8398824, 'f1': 0.7881648, 'auroc': 0.92994153, 'binary_precision': 0.51506025, 'binary_recall': 0.7066116, 'binary_specificity': 0.97315323, 'binary_f1_score': 0.5958188}
confusion matrix:
      0    1
0  5836  161
1    71  171
early stop counter: 2
val acc:0.9467852711677551, best validation acc: 0.9725669622421265, corresponding to test acc:                         0.9713094830513 / 0.9713094830513
after epoch: 13,now: 2024-08-01 12:10:38.877753,epoch time: 0:20:16.403248,used: 4:39:12.217149,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_07_31_26_seed_2_23857236
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99488884, 'precision': 0.9949347, 'recall': 0.99489, 'specificity': 0.99489, 'f1': 0.9948888, 'auroc': 0.999758, 'binary_precision': 0.9997576, 'binary_recall': 0.9900202, 'binary_specificity': 0.9997598, 'binary_f1_score': 0.9948651}
confusion matrix:
       0      1
0  29138      7
1    291  28868
---- Validation: 
scalar performance:
{'acc': 0.9705961, 'precision': 0.77611053, 'recall': 0.6563642, 'specificity': 0.6563642, 'f1': 0.69821763, 'auroc': 0.9453398, 'binary_precision': 0.5744048, 'binary_recall': 0.320598, 'binary_specificity': 0.99213034, 'binary_f1_score': 0.41151384}
confusion matrix:
       0    1
0  18028  143
1    409  193
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96297485, 'precision': 0.78687245, 'recall': 0.5623821, 'specificity': 0.5623821, 'f1': 0.5963232, 'auroc': 0.95021355, 'binary_precision': 0.60784316, 'binary_recall': 0.12809917, 'binary_specificity': 0.996665, 'binary_f1_score': 0.21160409}
confusion matrix:
      0   1
0  5977  20
1   211  31
early stop counter: 3
val acc:0.9705960750579834, best validation acc: 0.9725669622421265, corresponding to test acc:                         0.9713094830513 / 0.9713094830513
after epoch: 14,now: 2024-08-01 12:30:51.758868,epoch time: 0:20:12.881115,used: 4:59:25.098264,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_07_31_26_seed_2_23857236
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99439144, 'precision': 0.99439543, 'recall': 0.99439174, 'specificity': 0.99439174, 'f1': 0.99439144, 'auroc': 0.999605, 'binary_precision': 0.9958379, 'binary_recall': 0.9929348, 'binary_specificity': 0.99584866, 'binary_f1_score': 0.9943842}
confusion matrix:
       0      1
0  29026    121
1    206  28951
---- Validation: 
scalar performance:
{'acc': 0.963618, 'precision': 0.702857, 'recall': 0.68488145, 'specificity': 0.68488145, 'f1': 0.6934024, 'auroc': 0.91672766, 'binary_precision': 0.42595977, 'binary_recall': 0.38704318, 'binary_specificity': 0.9827197, 'binary_f1_score': 0.40557006}
confusion matrix:
       0    1
0  17857  314
1    369  233
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9658599, 'precision': 0.7752769, 'recall': 0.7324158, 'specificity': 0.7324158, 'f1': 0.75182354, 'auroc': 0.9324907, 'binary_precision': 0.5714286, 'binary_recall': 0.47933885, 'binary_specificity': 0.98549277, 'binary_f1_score': 0.52134836}
confusion matrix:
      0    1
0  5910   87
1   126  116
early stop counter: 4
val acc:0.9636179804801941, best validation acc: 0.9725669622421265, corresponding to test acc:                         0.9713094830513 / 0.9713094830513
after epoch: 15,now: 2024-08-01 12:50:41.391735,epoch time: 0:19:49.632867,used: 5:19:14.731131,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_07_31_26_seed_2_23857236
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9923161, 'precision': 0.992362, 'recall': 0.99231696, 'specificity': 0.99231696, 'f1': 0.992316, 'auroc': 0.9997064, 'binary_precision': 0.99715996, 'binary_recall': 0.98744726, 'binary_specificity': 0.99718666, 'binary_f1_score': 0.9922798}
confusion matrix:
       0      1
0  29065     82
1    366  28791
---- Validation: 
scalar performance:
{'acc': 0.9573323, 'precision': 0.69296247, 'recall': 0.80610704, 'specificity': 0.80610704, 'f1': 0.7349022, 'auroc': 0.9429493, 'binary_precision': 0.3979487, 'binary_recall': 0.64451826, 'binary_specificity': 0.9676958, 'binary_f1_score': 0.49207357}
confusion matrix:
       0    1
0  17584  587
1    214  388
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96185285, 'precision': 0.74311256, 'recall': 0.67283195, 'specificity': 0.67283195, 'f1': 0.7013026, 'auroc': 0.9339956, 'binary_precision': 0.5117647, 'binary_recall': 0.35950413, 'binary_specificity': 0.98615974, 'binary_f1_score': 0.42233008}
confusion matrix:
      0   1
0  5914  83
1   155  87
early stop counter: 5
val acc:0.9573323130607605, best validation acc: 0.9725669622421265, corresponding to test acc:                         0.9713094830513 / 0.9713094830513
after epoch: 16,now: 2024-08-01 13:11:04.671130,epoch time: 0:20:23.279395,used: 5:39:38.010526,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_07_31_26_seed_2_23857236
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99471736, 'precision': 0.9947324, 'recall': 0.9947176, 'specificity': 0.9947176, 'f1': 0.9947173, 'auroc': 0.9997292, 'binary_precision': 0.9974822, 'binary_recall': 0.9919396, 'binary_specificity': 0.99749565, 'binary_f1_score': 0.9947031}
confusion matrix:
       0      1
0  29076     73
1    235  28920
---- Validation: 
scalar performance:
{'acc': 0.9449742, 'precision': 0.6458, 'recall': 0.76197994, 'specificity': 0.76197994, 'f1': 0.6844189, 'auroc': 0.9217608, 'binary_precision': 0.30637917, 'binary_recall': 0.5664452, 'binary_specificity': 0.9575147, 'binary_f1_score': 0.39766765}
confusion matrix:
       0    1
0  17399  772
1    261  341
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97002727, 'precision': 0.7996147, 'recall': 0.7960485, 'specificity': 0.7960485, 'f1': 0.79781973, 'auroc': 0.92884874, 'binary_precision': 0.6150628, 'binary_recall': 0.607438, 'binary_specificity': 0.984659, 'binary_f1_score': 0.6112266}
confusion matrix:
      0    1
0  5905   92
1    95  147
early stop counter: 6
val acc:0.9449741840362549, best validation acc: 0.9725669622421265, corresponding to test acc:                         0.9713094830513 / 0.9713094830513
after epoch: 17,now: 2024-08-01 13:32:20.392042,epoch time: 0:21:15.720912,used: 6:00:53.731438,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_07_31_26_seed_2_23857236
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9944086, 'precision': 0.99446565, 'recall': 0.99440974, 'specificity': 0.99440974, 'f1': 0.9944085, 'auroc': 0.9999192, 'binary_precision': 0.99982667, 'binary_recall': 0.988991, 'binary_specificity': 0.99982846, 'binary_f1_score': 0.99437934}
confusion matrix:
       0      1
0  29141      5
1    321  28837
---- Validation: 
scalar performance:
{'acc': 0.96601504, 'precision': 0.72915787, 'recall': 0.7591971, 'specificity': 0.7591971, 'f1': 0.7431464, 'auroc': 0.9450903, 'binary_precision': 0.47368422, 'binary_recall': 0.538206, 'binary_specificity': 0.9801882, 'binary_f1_score': 0.503888}
confusion matrix:
       0    1
0  17811  360
1    278  324
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.961372, 'precision': 0.73707604, 'recall': 0.6111169, 'specificity': 0.6111169, 'f1': 0.6487021, 'auroc': 0.94879055, 'binary_precision': 0.5045045, 'binary_recall': 0.23140496, 'binary_specificity': 0.99082875, 'binary_f1_score': 0.31728047}
confusion matrix:
      0   1
0  5942  55
1   186  56
early stop counter: 7
val acc:0.9660150408744812, best validation acc: 0.9725669622421265, corresponding to test acc:                         0.9713094830513 / 0.9713094830513
after epoch: 18,now: 2024-08-01 13:53:53.480571,epoch time: 0:21:33.088529,used: 6:22:26.819967,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_07_31_26_seed_2_23857236
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99672407, 'precision': 0.9967252, 'recall': 0.99672425, 'specificity': 0.99672425, 'f1': 0.99672407, 'auroc': 0.99987495, 'binary_precision': 0.9975267, 'binary_recall': 0.9959188, 'binary_specificity': 0.9975297, 'binary_f1_score': 0.9967221}
confusion matrix:
       0      1
0  29074     72
1    119  29039
---- Validation: 
scalar performance:
{'acc': 0.94998133, 'precision': 0.6839381, 'recall': 0.89144814, 'specificity': 0.89144814, 'f1': 0.74442995, 'auroc': 0.9574195, 'binary_precision': 0.37378278, 'binary_recall': 0.8289037, 'binary_specificity': 0.9539926, 'binary_f1_score': 0.51522976}
confusion matrix:
       0    1
0  17335  836
1    103  499
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97451514, 'precision': 0.8125815, 'recall': 0.89950275, 'specificity': 0.89950275, 'f1': 0.85008895, 'auroc': 0.96033365, 'binary_precision': 0.63258785, 'binary_recall': 0.8181818, 'binary_specificity': 0.98082376, 'binary_f1_score': 0.7135135}
confusion matrix:
      0    1
0  5882  115
1    44  198
new oracle model saved
early stop counter: 8
val acc:0.9499813318252563, best validation acc: 0.9725669622421265, corresponding to test acc:                         0.9713094830513 / 0.9745151400566101
after epoch: 19,now: 2024-08-01 14:14:08.846742,epoch time: 0:20:15.366171,used: 6:42:42.186138,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_07_31_26_seed_2_23857236
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99444294, 'precision': 0.9944949, 'recall': 0.994444, 'specificity': 0.994444, 'f1': 0.99444276, 'auroc': 0.99982953, 'binary_precision': 0.99961877, 'binary_recall': 0.9892654, 'binary_specificity': 0.9996226, 'binary_f1_score': 0.9944151}
confusion matrix:
       0      1
0  29135     11
1    313  28845
---- Validation: 
scalar performance:
{'acc': 0.9648964, 'precision': 0.6889763, 'recall': 0.5947974, 'specificity': 0.5947974, 'f1': 0.62449044, 'auroc': 0.9175641, 'binary_precision': 0.4040404, 'binary_recall': 0.19933555, 'binary_specificity': 0.99025923, 'binary_f1_score': 0.2669633}
confusion matrix:
       0    1
0  17994  177
1    482  120
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9543196, 'precision': 0.58833444, 'recall': 0.52813876, 'specificity': 0.52813876, 'f1': 0.5387554, 'auroc': 0.9204046, 'binary_precision': 0.21333334, 'binary_recall': 0.0661157, 'binary_specificity': 0.9901618, 'binary_f1_score': 0.10094637}
confusion matrix:
      0   1
0  5938  59
1   226  16
early stop counter: 9
val acc:0.9648963809013367, best validation acc: 0.9725669622421265, corresponding to test acc:                         0.9713094830513 / 0.9745151400566101
after epoch: 20,now: 2024-08-01 14:34:32.800691,epoch time: 0:20:23.953949,used: 7:03:06.140087,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_07_31_26_seed_2_23857236
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 7:03:06.140087 at 2024-08-01 14:34:32.800691
persisted model performance metric: 

scalar performance:
{'acc': 0.9713095, 'precision': 0.92164445, 'recall': 0.6519754, 'specificity': 0.6519754, 'f1': 0.71893406, 'auroc': 0.94514406, 'binary_precision': 0.87058824, 'binary_recall': 0.30578512, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.4525994}
confusion matrix:
      0   1
0  5986  11
1   168  74
oracle model performance metric: 

scalar performance:
{'acc': 0.97451514, 'precision': 0.8125815, 'recall': 0.89950275, 'specificity': 0.89950275, 'f1': 0.85008895, 'auroc': 0.96033365, 'binary_precision': 0.63258785, 'binary_recall': 0.8181818, 'binary_specificity': 0.98082376, 'binary_f1_score': 0.7135135}
confusion matrix:
      0    1
0  5882  115
1    44  198
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_12-46-56/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_12-46-56/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455233 KiB |  13220 MiB |   1665 TiB |   1665 TiB |
|       from large pool | 413552 KiB |  13181 MiB |   1642 TiB |   1642 TiB |
|       from small pool |  41681 KiB |     61 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 455233 KiB |  13220 MiB |   1665 TiB |   1665 TiB |
|       from large pool | 413552 KiB |  13181 MiB |   1642 TiB |   1642 TiB |
|       from small pool |  41681 KiB |     61 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447753 KiB |  13213 MiB |   1661 TiB |   1661 TiB |
|       from large pool | 407075 KiB |  13175 MiB |   1639 TiB |   1639 TiB |
|       from small pool |  40678 KiB |     60 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14476 MiB |  14492 MiB |  41658 MiB |  27182 MiB |
|       from large pool |  14410 MiB |  14422 MiB |  41560 MiB |  27150 MiB |
|       from small pool |     66 MiB |     70 MiB |     98 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 460222 KiB |   1258 MiB |   1295 TiB |   1295 TiB |
|       from large pool | 450704 KiB |   1252 MiB |   1272 TiB |   1272 TiB |
|       from small pool |   9518 KiB |     42 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3476    |    8293    |  328777 K  |  328773 K  |
|       from large pool |     187    |    1413    |  154685 K  |  154685 K  |
|       from small pool |    3289    |    8104    |  174091 K  |  174088 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3476    |    8293    |  328777 K  |  328773 K  |
|       from large pool |     187    |    1413    |  154685 K  |  154685 K  |
|       from small pool |    3289    |    8104    |  174091 K  |  174088 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     635    |     637    |    1779    |    1144    |
|       from large pool |     602    |     602    |    1730    |    1128    |
|       from small pool |      33    |      35    |      49    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      79    |    3705    |  201080 K  |  201080 K  |
|       from large pool |      38    |     604    |  113730 K  |  113730 K  |
|       from small pool |      41    |    3666    |   87349 K  |   87349 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13220 MiB |   1665 TiB |   1665 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1642 TiB |   1642 TiB |
|       from small pool |      0 KiB |     61 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13220 MiB |   1665 TiB |   1665 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1642 TiB |   1642 TiB |
|       from small pool |      0 KiB |     61 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   1661 TiB |   1661 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   1639 TiB |   1639 TiB |
|       from small pool |      0 KiB |     60 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    894 MiB |  14492 MiB |  41658 MiB |  40764 MiB |
|       from large pool |    844 MiB |  14422 MiB |  41560 MiB |  40716 MiB |
|       from small pool |     50 MiB |     70 MiB |     98 MiB |     48 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1258 MiB |   1295 TiB |   1295 TiB |
|       from large pool |  24320 KiB |   1252 MiB |   1272 TiB |   1272 TiB |
|       from small pool |      0 KiB |     44 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8293    |  328777 K  |  328777 K  |
|       from large pool |       2    |    1413    |  154685 K  |  154685 K  |
|       from small pool |       0    |    8104    |  174091 K  |  174091 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8293    |  328777 K  |  328777 K  |
|       from large pool |       2    |    1413    |  154685 K  |  154685 K  |
|       from small pool |       0    |    8104    |  174091 K  |  174091 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     637    |    1779    |    1716    |
|       from large pool |      38    |     602    |    1730    |    1692    |
|       from small pool |      25    |      35    |      49    |      24    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3705    |  201081 K  |  201081 K  |
|       from large pool |       3    |     604    |  113730 K  |  113730 K  |
|       from small pool |       0    |    3666    |   87350 K  |   87350 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Thu Aug  1 14:35:55 2024]
Finished job 0.
1 of 1 steps (100%) done
