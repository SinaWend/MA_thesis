Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Wed Jul 31 12:55:12 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_12-46-56/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_12-46-56/rule_results/15.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=15
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_00_58_seed_0_23857230

 Experiment start at: 2024-07-31 13:00:58.549340
before training, model accuracy: 0.7297859191894531
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.70575315, 'precision': 0.7057555, 'recall': 0.7057543, 'specificity': 0.7057543, 'f1': 0.7057529, 'auroc': 0.7670906, 'binary_precision': 0.7066699, 'binary_recall': 0.7043063, 'binary_specificity': 0.7072022, 'binary_f1_score': 0.7054862}
confusion matrix:
       0      1
0  20267   8391
1   8487  20215
---- Validation: 
scalar performance:
{'acc': 0.78128994, 'precision': 0.53657013, 'recall': 0.6932564, 'specificity': 0.6932564, 'f1': 0.5160571, 'auroc': 0.7757832, 'binary_precision': 0.09086618, 'binary_recall': 0.59875584, 'binary_specificity': 0.7877569, 'binary_f1_score': 0.15778688}
confusion matrix:
       0     1
0  14297  3852
1    258   385
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7611058, 'precision': 0.5400289, 'recall': 0.68662393, 'specificity': 0.68662393, 'f1': 0.51741743, 'auroc': 0.7568714, 'binary_precision': 0.10193548, 'binary_recall': 0.60536397, 'binary_specificity': 0.76788396, 'binary_f1_score': 0.17448923}
confusion matrix:
      0     1
0  4605  1392
1   103   158
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-31 13:17:37.919038,epoch time: 0:16:39.369698,used: 0:16:39.369698,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_00_58_seed_0_23857230
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.8063982, 'precision': 0.80670893, 'recall': 0.80638593, 'specificity': 0.80638593, 'f1': 0.80634475, 'auroc': 0.8853277, 'binary_precision': 0.7971362, 'binary_recall': 0.82238173, 'binary_specificity': 0.79039013, 'binary_f1_score': 0.8095622}
confusion matrix:
       0      1
0  22651   6007
1   5098  23604
---- Validation: 
scalar performance:
{'acc': 0.8199234, 'precision': 0.5497793, 'recall': 0.73125875, 'specificity': 0.73125875, 'f1': 0.5466486, 'auroc': 0.8069128, 'binary_precision': 0.11491992, 'binary_recall': 0.63608086, 'binary_specificity': 0.8264367, 'binary_f1_score': 0.1946692}
confusion matrix:
       0     1
0  14999  3150
1    234   409
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80425054, 'precision': 0.557516, 'recall': 0.73845255, 'specificity': 0.73845255, 'f1': 0.5546448, 'auroc': 0.81971765, 'binary_precision': 0.13262194, 'binary_recall': 0.6666667, 'binary_specificity': 0.8102385, 'binary_f1_score': 0.22123331}
confusion matrix:
      0     1
0  4859  1138
1    87   174
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-31 13:33:36.147321,epoch time: 0:15:58.228283,used: 0:32:37.597981,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_00_58_seed_0_23857230
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.8422943, 'precision': 0.842508, 'recall': 0.842303, 'specificity': 0.842303, 'f1': 0.8422719, 'auroc': 0.9176763, 'binary_precision': 0.8512403, 'binary_recall': 0.82982576, 'binary_specificity': 0.8547802, 'binary_f1_score': 0.8403966}
confusion matrix:
       0      1
0  24498   4162
1   4884  23816
---- Validation: 
scalar performance:
{'acc': 0.86840147, 'precision': 0.5649098, 'recall': 0.7331049, 'specificity': 0.7331049, 'f1': 0.5810723, 'auroc': 0.818666, 'binary_precision': 0.14617169, 'binary_recall': 0.58786935, 'binary_specificity': 0.8783404, 'binary_f1_score': 0.2341282}
confusion matrix:
       0     1
0  15941  2208
1    265   378
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85634387, 'precision': 0.58082134, 'recall': 0.7692975, 'specificity': 0.7692975, 'f1': 0.60078514, 'auroc': 0.85016453, 'binary_precision': 0.17777778, 'binary_recall': 0.6743295, 'binary_specificity': 0.86426544, 'binary_f1_score': 0.2813749}
confusion matrix:
      0    1
0  5183  814
1    85  176
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-31 13:49:29.856279,epoch time: 0:15:53.708958,used: 0:48:31.306939,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_00_58_seed_0_23857230
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.8606869, 'precision': 0.86092854, 'recall': 0.8606968, 'specificity': 0.8606968, 'f1': 0.8606658, 'auroc': 0.9340354, 'binary_precision': 0.8704611, 'binary_recall': 0.8477458, 'binary_specificity': 0.87364787, 'binary_f1_score': 0.85895324}
confusion matrix:
       0      1
0  25037   3621
1   4370  24332
---- Validation: 
scalar performance:
{'acc': 0.87984246, 'precision': 0.5718173, 'recall': 0.73977816, 'specificity': 0.73977816, 'f1': 0.59300286, 'auroc': 0.8252822, 'binary_precision': 0.15971345, 'binary_recall': 0.58942455, 'binary_specificity': 0.8901317, 'binary_f1_score': 0.25132626}
confusion matrix:
       0     1
0  16155  1994
1    264   379
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86529243, 'precision': 0.59041417, 'recall': 0.79228985, 'specificity': 0.79228985, 'f1': 0.6157888, 'auroc': 0.8664198, 'binary_precision': 0.19496855, 'binary_recall': 0.7126437, 'binary_specificity': 0.87193596, 'binary_f1_score': 0.30617285}
confusion matrix:
      0    1
0  5229  768
1    75  186
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-31 14:05:49.184209,epoch time: 0:16:19.327930,used: 1:04:50.634869,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_00_58_seed_0_23857230
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.8729254, 'precision': 0.87341356, 'recall': 0.87294054, 'specificity': 0.87294054, 'f1': 0.872887, 'auroc': 0.9446237, 'binary_precision': 0.8871254, 'binary_recall': 0.8548286, 'binary_specificity': 0.8910525, 'binary_f1_score': 0.8706776}
confusion matrix:
       0      1
0  25534   3122
1   4167  24537
---- Validation: 
scalar performance:
{'acc': 0.88356745, 'precision': 0.5754977, 'recall': 0.746957, 'specificity': 0.746957, 'f1': 0.5988088, 'auroc': 0.8293327, 'binary_precision': 0.16659473, 'binary_recall': 0.60031104, 'binary_specificity': 0.89360297, 'binary_f1_score': 0.2608108}
confusion matrix:
       0     1
0  16218  1931
1    257   386
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8662512, 'precision': 0.5938919, 'recall': 0.8056164, 'specificity': 0.8056164, 'f1': 0.6207503, 'auroc': 0.8785018, 'binary_precision': 0.2006237, 'binary_recall': 0.7394636, 'binary_specificity': 0.8717692, 'binary_f1_score': 0.31561735}
confusion matrix:
      0    1
0  5228  769
1    68  193
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-31 14:21:51.309337,epoch time: 0:16:02.125128,used: 1:20:52.759997,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_00_58_seed_0_23857230
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.8825488, 'precision': 0.8829427, 'recall': 0.8825634, 'specificity': 0.8825634, 'f1': 0.8825214, 'auroc': 0.9503443, 'binary_precision': 0.8954531, 'binary_recall': 0.8664739, 'binary_specificity': 0.8986529, 'binary_f1_score': 0.8807252}
confusion matrix:
       0      1
0  25750   2904
1   3833  24873
---- Validation: 
scalar performance:
{'acc': 0.8812793, 'precision': 0.5746458, 'recall': 0.74877256, 'specificity': 0.74877256, 'f1': 0.59726, 'auroc': 0.83235395, 'binary_precision': 0.16469595, 'binary_recall': 0.60653186, 'binary_specificity': 0.89101326, 'binary_f1_score': 0.25905013}
confusion matrix:
       0     1
0  16171  1978
1    253   390
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8625759, 'precision': 0.59469295, 'recall': 0.81835747, 'specificity': 0.81835747, 'f1': 0.6210624, 'auroc': 0.8869828, 'binary_precision': 0.2007992, 'binary_recall': 0.77011496, 'binary_specificity': 0.8666, 'binary_f1_score': 0.318542}
confusion matrix:
      0    1
0  5197  800
1    60  201
early stop counter: 1
val acc:0.8812792897224426, best validation acc: 0.8835674524307251, corresponding to test acc:                         0.8662511706352234 / 0.8662511706352234
after epoch: 6,now: 2024-07-31 14:38:00.341693,epoch time: 0:16:09.032356,used: 1:37:01.792353,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_00_58_seed_0_23857230
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.88927823, 'precision': 0.8896438, 'recall': 0.8892879, 'specificity': 0.8892879, 'f1': 0.889254, 'auroc': 0.95444715, 'binary_precision': 0.9017366, 'binary_recall': 0.8739285, 'binary_specificity': 0.9046473, 'binary_f1_score': 0.88761485}
confusion matrix:
       0      1
0  25929   2733
1   3618  25080
---- Validation: 
scalar performance:
{'acc': 0.8875053, 'precision': 0.57915485, 'recall': 0.7527459, 'specificity': 0.7527459, 'f1': 0.60454214, 'auroc': 0.836275, 'binary_precision': 0.17354639, 'binary_recall': 0.60808706, 'binary_specificity': 0.8974048, 'binary_f1_score': 0.27002764}
confusion matrix:
       0     1
0  16287  1862
1    252   391
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8692873, 'precision': 0.5995297, 'recall': 0.8236915, 'specificity': 0.8236915, 'f1': 0.6290889, 'auroc': 0.8943373, 'binary_precision': 0.21019772, 'binary_recall': 0.77394634, 'binary_specificity': 0.8734367, 'binary_f1_score': 0.33060557}
confusion matrix:
      0    1
0  5238  759
1    59  202
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-07-31 14:54:41.066415,epoch time: 0:16:40.724722,used: 1:53:42.517075,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_00_58_seed_0_23857230
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.8954847, 'precision': 0.89603424, 'recall': 0.8954997, 'specificity': 0.8954997, 'f1': 0.89545083, 'auroc': 0.95790493, 'binary_precision': 0.91098964, 'binary_recall': 0.87680733, 'binary_specificity': 0.914192, 'binary_f1_score': 0.8935717}
confusion matrix:
       0      1
0  26198   2459
1   3536  25167
---- Validation: 
scalar performance:
{'acc': 0.88356745, 'precision': 0.57773036, 'recall': 0.75670767, 'specificity': 0.75670767, 'f1': 0.6020032, 'auroc': 0.83868444, 'binary_precision': 0.1702945, 'binary_recall': 0.62052876, 'binary_specificity': 0.89288664, 'binary_f1_score': 0.26724714}
confusion matrix:
       0     1
0  16205  1944
1    244   399
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8635347, 'precision': 0.59763867, 'recall': 0.82985175, 'specificity': 0.82985175, 'f1': 0.62528694, 'auroc': 0.8995352, 'binary_precision': 0.20556107, 'binary_recall': 0.79310346, 'binary_specificity': 0.8666, 'binary_f1_score': 0.32649842}
confusion matrix:
      0    1
0  5197  800
1    54  207
early stop counter: 1
val acc:0.8835674524307251, best validation acc: 0.887505292892456, corresponding to test acc:                         0.8692873120307922 / 0.8692873120307922
after epoch: 8,now: 2024-07-31 15:10:52.304678,epoch time: 0:16:11.238263,used: 2:09:53.755338,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_00_58_seed_0_23857230
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9025976, 'precision': 0.90329593, 'recall': 0.90261585, 'specificity': 0.90261585, 'f1': 0.90255827, 'auroc': 0.9627376, 'binary_precision': 0.9202967, 'binary_recall': 0.88172793, 'binary_specificity': 0.92350376, 'binary_f1_score': 0.9005996}
confusion matrix:
       0      1
0  26463   2192
1   3395  25310
---- Validation: 
scalar performance:
{'acc': 0.88505745, 'precision': 0.57945484, 'recall': 0.76047933, 'specificity': 0.76047933, 'f1': 0.6046756, 'auroc': 0.84051764, 'binary_precision': 0.17348257, 'binary_recall': 0.62674963, 'binary_specificity': 0.894209, 'binary_f1_score': 0.2717465}
confusion matrix:
       0     1
0  16229  1920
1    240   403
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86497283, 'precision': 0.5981875, 'recall': 0.82876974, 'specificity': 0.82876974, 'f1': 0.6263567, 'auroc': 0.90287733, 'binary_precision': 0.20682731, 'binary_recall': 0.789272, 'binary_specificity': 0.8682675, 'binary_f1_score': 0.3277645}
confusion matrix:
      0    1
0  5207  790
1    55  206
early stop counter: 2
val acc:0.8850574493408203, best validation acc: 0.887505292892456, corresponding to test acc:                         0.8692873120307922 / 0.8692873120307922
after epoch: 9,now: 2024-07-31 15:27:01.515538,epoch time: 0:16:09.210860,used: 2:26:02.966198,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_00_58_seed_0_23857230
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9046025, 'precision': 0.9055699, 'recall': 0.90462303, 'specificity': 0.90462303, 'f1': 0.9045487, 'auroc': 0.9643034, 'binary_precision': 0.925588, 'binary_recall': 0.88012123, 'binary_specificity': 0.9291248, 'binary_f1_score': 0.90228224}
confusion matrix:
       0      1
0  26625   2031
1   3441  25263
---- Validation: 
scalar performance:
{'acc': 0.8900596, 'precision': 0.58106583, 'recall': 0.7540683, 'specificity': 0.7540683, 'f1': 0.60755074, 'auroc': 0.84194994, 'binary_precision': 0.17732427, 'binary_recall': 0.60808706, 'binary_specificity': 0.90004957, 'binary_f1_score': 0.27457866}
confusion matrix:
       0     1
0  16335  1814
1    252   391
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87583894, 'precision': 0.6058319, 'recall': 0.8344393, 'specificity': 0.8344393, 'f1': 0.6389563, 'auroc': 0.90618426, 'binary_precision': 0.22198276, 'binary_recall': 0.789272, 'binary_specificity': 0.8796065, 'binary_f1_score': 0.34650967}
confusion matrix:
      0    1
0  5275  722
1    55  206
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-07-31 15:42:56.489293,epoch time: 0:15:54.973755,used: 2:41:57.939953,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_00_58_seed_0_23857230
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.91042536, 'precision': 0.91099155, 'recall': 0.9104377, 'specificity': 0.9104377, 'f1': 0.9103963, 'auroc': 0.96710676, 'binary_precision': 0.9264126, 'binary_recall': 0.8918081, 'binary_specificity': 0.9290674, 'binary_f1_score': 0.90878105}
confusion matrix:
       0      1
0  26628   2033
1   3105  25594
---- Validation: 
scalar performance:
{'acc': 0.8739357, 'precision': 0.57432204, 'recall': 0.7644721, 'specificity': 0.7644721, 'f1': 0.59550923, 'auroc': 0.8442996, 'binary_precision': 0.16262706, 'binary_recall': 0.64696735, 'binary_specificity': 0.88197696, 'binary_f1_score': 0.25991878}
confusion matrix:
       0     1
0  16007  2142
1    227   416
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8493129, 'precision': 0.5914589, 'recall': 0.83342534, 'specificity': 0.83342534, 'f1': 0.61328965, 'auroc': 0.9086887, 'binary_precision': 0.19223827, 'binary_recall': 0.81609195, 'binary_specificity': 0.85075873, 'binary_f1_score': 0.31117603}
confusion matrix:
      0    1
0  5102  895
1    48  213
early stop counter: 1
val acc:0.8739356994628906, best validation acc: 0.8900595903396606, corresponding to test acc:                         0.8758389353752136 / 0.8758389353752136
after epoch: 11,now: 2024-07-31 15:58:50.454897,epoch time: 0:15:53.965604,used: 2:57:51.905557,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_00_58_seed_0_23857230
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9140167, 'precision': 0.9145452, 'recall': 0.91402924, 'specificity': 0.91402924, 'f1': 0.91399103, 'auroc': 0.9693682, 'binary_precision': 0.92952144, 'binary_recall': 0.89609754, 'binary_specificity': 0.93196094, 'binary_f1_score': 0.91250354}
confusion matrix:
       0      1
0  26710   1950
1   2982  25718
---- Validation: 
scalar performance:
{'acc': 0.8718604, 'precision': 0.5738859, 'recall': 0.767148, 'specificity': 0.767148, 'f1': 0.5944712, 'auroc': 0.8460398, 'binary_precision': 0.1614883, 'binary_recall': 0.6547434, 'binary_specificity': 0.8795526, 'binary_f1_score': 0.2590769}
confusion matrix:
       0     1
0  15963  2186
1    222   421
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8440396, 'precision': 0.58938813, 'recall': 0.83433867, 'specificity': 0.83433867, 'f1': 0.6089917, 'auroc': 0.9110603, 'binary_precision': 0.18777293, 'binary_recall': 0.8237548, 'binary_specificity': 0.8449225, 'binary_f1_score': 0.30583215}
confusion matrix:
      0    1
0  5067  930
1    46  215
early stop counter: 2
val acc:0.8718603849411011, best validation acc: 0.8900595903396606, corresponding to test acc:                         0.8758389353752136 / 0.8758389353752136
after epoch: 12,now: 2024-07-31 16:14:56.253434,epoch time: 0:16:05.798537,used: 3:13:57.704094,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_00_58_seed_0_23857230
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.91616106, 'precision': 0.9166347, 'recall': 0.91617286, 'specificity': 0.91617286, 'f1': 0.9161388, 'auroc': 0.97069, 'binary_precision': 0.93085665, 'binary_recall': 0.89923346, 'binary_specificity': 0.9331123, 'binary_f1_score': 0.9147719}
confusion matrix:
       0      1
0  26743   1917
1   2892  25808
---- Validation: 
scalar performance:
{'acc': 0.8750532, 'precision': 0.5751664, 'recall': 0.7658007, 'specificity': 0.7658007, 'f1': 0.5969237, 'auroc': 0.8471924, 'binary_precision': 0.16423789, 'binary_recall': 0.64852256, 'binary_specificity': 0.88307893, 'binary_f1_score': 0.2620993}
confusion matrix:
       0     1
0  16027  2122
1    226   417
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84995204, 'precision': 0.59255564, 'recall': 0.8374235, 'specificity': 0.8374235, 'f1': 0.61493, 'auroc': 0.9125457, 'binary_precision': 0.19404332, 'binary_recall': 0.8237548, 'binary_specificity': 0.8510922, 'binary_f1_score': 0.31409788}
confusion matrix:
      0    1
0  5104  893
1    46  215
early stop counter: 3
val acc:0.8750532269477844, best validation acc: 0.8900595903396606, corresponding to test acc:                         0.8758389353752136 / 0.8758389353752136
after epoch: 13,now: 2024-07-31 16:30:47.370641,epoch time: 0:15:51.117207,used: 3:29:48.821301,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_00_58_seed_0_23857230
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.91644, 'precision': 0.9170996, 'recall': 0.9164547, 'specificity': 0.9164547, 'f1': 0.9164089, 'auroc': 0.9716604, 'binary_precision': 0.9338705, 'binary_recall': 0.89648443, 'binary_specificity': 0.93642485, 'binary_f1_score': 0.91479564}
confusion matrix:
       0      1
0  26837   1822
1   2971  25730
---- Validation: 
scalar performance:
{'acc': 0.8769157, 'precision': 0.57616603, 'recall': 0.76601493, 'specificity': 0.76601493, 'f1': 0.59869236, 'auroc': 0.84688485, 'binary_precision': 0.166267, 'binary_recall': 0.64696735, 'binary_specificity': 0.8850625, 'binary_f1_score': 0.2645469}
confusion matrix:
       0     1
0  16063  2086
1    227   416
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8545861, 'precision': 0.5944392, 'recall': 0.83617675, 'specificity': 0.83617675, 'f1': 0.61873347, 'auroc': 0.913658, 'binary_precision': 0.19813953, 'binary_recall': 0.81609195, 'binary_specificity': 0.8562615, 'binary_f1_score': 0.3188623}
confusion matrix:
      0    1
0  5135  862
1    48  213
early stop counter: 4
val acc:0.876915693283081, best validation acc: 0.8900595903396606, corresponding to test acc:                         0.8758389353752136 / 0.8758389353752136
after epoch: 14,now: 2024-07-31 16:46:41.220736,epoch time: 0:15:53.850095,used: 3:45:42.671396,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_00_58_seed_0_23857230
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.91961294, 'precision': 0.919985, 'recall': 0.919625, 'specificity': 0.919625, 'f1': 0.9195967, 'auroc': 0.97221386, 'binary_precision': 0.9326868, 'binary_recall': 0.90464413, 'binary_specificity': 0.93460584, 'binary_f1_score': 0.9184515}
confusion matrix:
       0      1
0  26783   1874
1   2737  25966
---- Validation: 
scalar performance:
{'acc': 0.8654215, 'precision': 0.5721239, 'recall': 0.7728151, 'specificity': 0.7728151, 'f1': 0.59055495, 'auroc': 0.84907806, 'binary_precision': 0.15734011, 'binary_recall': 0.6734059, 'binary_specificity': 0.8722244, 'binary_f1_score': 0.255081}
confusion matrix:
       0     1
0  15830  2319
1    210   433
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84084374, 'precision': 0.5881254, 'recall': 0.8345035, 'specificity': 0.8345035, 'f1': 0.60634714, 'auroc': 0.9153785, 'binary_precision': 0.18508998, 'binary_recall': 0.82758623, 'binary_specificity': 0.8414207, 'binary_f1_score': 0.30252102}
confusion matrix:
      0    1
0  5046  951
1    45  216
early stop counter: 5
val acc:0.86542147397995, best validation acc: 0.8900595903396606, corresponding to test acc:                         0.8758389353752136 / 0.8758389353752136
after epoch: 15,now: 2024-07-31 17:02:32.864811,epoch time: 0:15:51.644075,used: 4:01:34.315471,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_00_58_seed_0_23857230
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9216004, 'precision': 0.9218919, 'recall': 0.9216106, 'specificity': 0.9216106, 'f1': 0.9215881, 'auroc': 0.9737581, 'binary_precision': 0.93317586, 'binary_recall': 0.90836877, 'binary_specificity': 0.9348524, 'binary_f1_score': 0.92060524}
confusion matrix:
       0      1
0  26791   1867
1   2630  26072
---- Validation: 
scalar performance:
{'acc': 0.86057895, 'precision': 0.57063425, 'recall': 0.7755585, 'specificity': 0.7755585, 'f1': 0.5872798, 'auroc': 0.8491659, 'binary_precision': 0.1540077, 'binary_recall': 0.6842924, 'binary_specificity': 0.8668246, 'binary_f1_score': 0.25142857}
confusion matrix:
       0     1
0  15732  2417
1    203   440
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83940554, 'precision': 0.58850247, 'recall': 0.8392501, 'specificity': 0.8392501, 'f1': 0.6063865, 'auroc': 0.91636693, 'binary_precision': 0.18527919, 'binary_recall': 0.83908045, 'binary_specificity': 0.8394197, 'binary_f1_score': 0.30353427}
confusion matrix:
      0    1
0  5034  963
1    42  219
early stop counter: 6
val acc:0.8605789542198181, best validation acc: 0.8900595903396606, corresponding to test acc:                         0.8758389353752136 / 0.8758389353752136
after epoch: 16,now: 2024-07-31 17:18:25.646054,epoch time: 0:15:52.781243,used: 4:17:27.096714,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_00_58_seed_0_23857230
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9225244, 'precision': 0.9229256, 'recall': 0.9225358, 'specificity': 0.9225358, 'f1': 0.9225074, 'auroc': 0.973647, 'binary_precision': 0.93613577, 'binary_recall': 0.90704155, 'binary_specificity': 0.93802994, 'binary_f1_score': 0.92135906}
confusion matrix:
       0      1
0  26883   1776
1   2668  26033
---- Validation: 
scalar performance:
{'acc': 0.8660068, 'precision': 0.572754, 'recall': 0.77461827, 'specificity': 0.77461827, 'f1': 0.5915771, 'auroc': 0.8486053, 'binary_precision': 0.15846995, 'binary_recall': 0.67651635, 'binary_specificity': 0.87272024, 'binary_f1_score': 0.25678864}
confusion matrix:
       0     1
0  15839  2310
1    208   435
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84659636, 'precision': 0.5918385, 'recall': 0.8411696, 'specificity': 0.8411696, 'f1': 0.61299497, 'auroc': 0.91735524, 'binary_precision': 0.19207048, 'binary_recall': 0.83524907, 'binary_specificity': 0.8470902, 'binary_f1_score': 0.31232092}
confusion matrix:
      0    1
0  5080  917
1    43  218
early stop counter: 7
val acc:0.8660067915916443, best validation acc: 0.8900595903396606, corresponding to test acc:                         0.8758389353752136 / 0.8758389353752136
after epoch: 17,now: 2024-07-31 17:34:20.360853,epoch time: 0:15:54.714799,used: 4:33:21.811513,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_00_58_seed_0_23857230
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.92278594, 'precision': 0.9234502, 'recall': 0.92280114, 'specificity': 0.92280114, 'f1': 0.92275745, 'auroc': 0.974841, 'binary_precision': 0.9404144, 'binary_recall': 0.9028987, 'binary_specificity': 0.9427036, 'binary_f1_score': 0.9212748}
confusion matrix:
       0      1
0  27016   1642
1   2787  25915
---- Validation: 
scalar performance:
{'acc': 0.86659217, 'precision': 0.57229996, 'recall': 0.7711711, 'specificity': 0.7711711, 'f1': 0.5910763, 'auroc': 0.848526, 'binary_precision': 0.15785609, 'binary_recall': 0.6687403, 'binary_specificity': 0.87360185, 'binary_f1_score': 0.25542027}
confusion matrix:
       0     1
0  15855  2294
1    213   430
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8486737, 'precision': 0.59332955, 'recall': 0.8440858, 'specificity': 0.8440858, 'f1': 0.6155839, 'auroc': 0.9183129, 'binary_precision': 0.19483986, 'binary_recall': 0.83908045, 'binary_specificity': 0.84909123, 'binary_f1_score': 0.3162455}
confusion matrix:
      0    1
0  5092  905
1    42  219
early stop counter: 8
val acc:0.8665921688079834, best validation acc: 0.8900595903396606, corresponding to test acc:                         0.8758389353752136 / 0.8758389353752136
after epoch: 18,now: 2024-07-31 17:50:14.980955,epoch time: 0:15:54.620102,used: 4:49:16.431615,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_00_58_seed_0_23857230
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.92377967, 'precision': 0.92443955, 'recall': 0.92379487, 'specificity': 0.92379487, 'f1': 0.92375183, 'auroc': 0.9752717, 'binary_precision': 0.9413686, 'binary_recall': 0.9039788, 'binary_specificity': 0.94361085, 'binary_f1_score': 0.9222949}
confusion matrix:
       0      1
0  27042   1616
1   2756  25946
---- Validation: 
scalar performance:
{'acc': 0.86015326, 'precision': 0.5708698, 'recall': 0.77758825, 'specificity': 0.77758825, 'f1': 0.5874995, 'auroc': 0.8508844, 'binary_precision': 0.15430164, 'binary_recall': 0.688958, 'binary_specificity': 0.8662185, 'binary_f1_score': 0.25213432}
confusion matrix:
       0     1
0  15721  2428
1    200   443
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8418025, 'precision': 0.5904322, 'recall': 0.8441654, 'specificity': 0.8441654, 'f1': 0.60967064, 'auroc': 0.9191403, 'binary_precision': 0.18872759, 'binary_recall': 0.8467433, 'binary_specificity': 0.8415875, 'binary_f1_score': 0.30865926}
confusion matrix:
      0    1
0  5047  950
1    40  221
early stop counter: 9
val acc:0.8601532578468323, best validation acc: 0.8900595903396606, corresponding to test acc:                         0.8758389353752136 / 0.8758389353752136
after epoch: 19,now: 2024-07-31 18:06:08.790535,epoch time: 0:15:53.809580,used: 5:05:10.241195,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_00_58_seed_0_23857230
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9274407, 'precision': 0.92811567, 'recall': 0.927456, 'specificity': 0.927456, 'f1': 0.9274138, 'auroc': 0.9771278, 'binary_precision': 0.9453074, 'binary_recall': 0.90749776, 'binary_specificity': 0.94741434, 'binary_f1_score': 0.92601675}
confusion matrix:
       0      1
0  27151   1507
1   2655  26047
---- Validation: 
scalar performance:
{'acc': 0.8625479, 'precision': 0.57150674, 'recall': 0.77582777, 'specificity': 0.77582777, 'f1': 0.58899355, 'auroc': 0.8522823, 'binary_precision': 0.15578425, 'binary_recall': 0.6827372, 'binary_specificity': 0.8689184, 'binary_f1_score': 0.25368392}
confusion matrix:
       0     1
0  15770  2379
1    204   439
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8440396, 'precision': 0.5919479, 'recall': 0.847165, 'specificity': 0.847165, 'f1': 0.6123582, 'auroc': 0.9202187, 'binary_precision': 0.19154443, 'binary_recall': 0.85057473, 'binary_specificity': 0.8437552, 'binary_f1_score': 0.31267604}
confusion matrix:
      0    1
0  5060  937
1    39  222
early stop counter: 10
val acc:0.8625478744506836, best validation acc: 0.8900595903396606, corresponding to test acc:                         0.8758389353752136 / 0.8758389353752136
after epoch: 20,now: 2024-07-31 18:22:11.601201,epoch time: 0:16:02.810666,used: 5:21:13.051861,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_00_58_seed_0_23857230
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 5:21:13.051861 at 2024-07-31 18:22:11.601201
persisted model performance metric: 

scalar performance:
{'acc': 0.87583894, 'precision': 0.6058319, 'recall': 0.8344393, 'specificity': 0.8344393, 'f1': 0.6389563, 'auroc': 0.90618426, 'binary_precision': 0.22198276, 'binary_recall': 0.789272, 'binary_specificity': 0.8796065, 'binary_f1_score': 0.34650967}
confusion matrix:
      0    1
0  5275  722
1    55  206
oracle model performance metric: 

scalar performance:
{'acc': 0.87583894, 'precision': 0.6058319, 'recall': 0.8344393, 'specificity': 0.8344393, 'f1': 0.6389563, 'auroc': 0.90618426, 'binary_precision': 0.22198276, 'binary_recall': 0.789272, 'binary_specificity': 0.8796065, 'binary_f1_score': 0.34650967}
confusion matrix:
      0    1
0  5275  722
1    55  206
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_12-46-56/rule_results/15.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_12-46-56/rule_results/15.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_12-46-56/confusion_matrix/15.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 191877 KiB | 461507 KiB | 349766 GiB | 349766 GiB |
|       from large pool | 174400 KiB | 427880 KiB | 342577 GiB | 342577 GiB |
|       from small pool |  17477 KiB |  38507 KiB |   7189 GiB |   7189 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 191877 KiB | 461507 KiB | 349766 GiB | 349766 GiB |
|       from large pool | 174400 KiB | 427880 KiB | 342577 GiB | 342577 GiB |
|       from small pool |  17477 KiB |  38507 KiB |   7189 GiB |   7189 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 189283 KiB | 457564 KiB | 349745 GiB | 349745 GiB |
|       from large pool | 172814 KiB | 424940 KiB | 342572 GiB | 342572 GiB |
|       from small pool |  16469 KiB |  37503 KiB |   7172 GiB |   7172 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 509952 KiB | 509952 KiB | 509952 KiB |      0 B   |
|       from large pool | 466944 KiB | 466944 KiB | 466944 KiB |      0 B   |
|       from small pool |  43008 KiB |  43008 KiB |  43008 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  37498 KiB |  87761 KiB | 184829 GiB | 184829 GiB |
|       from large pool |  30400 KiB |  79704 KiB | 177629 GiB | 177629 GiB |
|       from small pool |   7098 KiB |   9902 KiB |   7200 GiB |   7200 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2966    |    7653    |   81090 K  |   81087 K  |
|       from large pool |      76    |     158    |   33765 K  |   33765 K  |
|       from small pool |    2890    |    7575    |   47324 K  |   47321 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2966    |    7653    |   81090 K  |   81087 K  |
|       from large pool |      76    |     158    |   33765 K  |   33765 K  |
|       from small pool |    2890    |    7575    |   47324 K  |   47321 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      42    |      42    |      42    |       0    |
|       from large pool |      21    |      21    |      21    |       0    |
|       from small pool |      21    |      21    |      21    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      30    |    3602    |   44609 K  |   44609 K  |
|       from large pool |       9    |      18    |   23011 K  |   23011 K  |
|       from small pool |      21    |    3594    |   21597 K  |   21597 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 461507 KiB | 349766 GiB | 349766 GiB |
|       from large pool |  17088 KiB | 427880 KiB | 342577 GiB | 342577 GiB |
|       from small pool |      0 KiB |  38507 KiB |   7189 GiB |   7189 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 461507 KiB | 349766 GiB | 349766 GiB |
|       from large pool |  17088 KiB | 427880 KiB | 342577 GiB | 342577 GiB |
|       from small pool |      0 KiB |  38507 KiB |   7189 GiB |   7189 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457564 KiB | 349745 GiB | 349745 GiB |
|       from large pool |  16640 KiB | 424940 KiB | 342572 GiB | 342572 GiB |
|       from small pool |      0 KiB |  37503 KiB |   7172 GiB |   7172 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 229376 KiB | 509952 KiB | 509952 KiB | 280576 KiB |
|       from large pool | 204800 KiB | 466944 KiB | 466944 KiB | 262144 KiB |
|       from small pool |  24576 KiB |  43008 KiB |  43008 KiB |  18432 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  87761 KiB | 184829 GiB | 184829 GiB |
|       from large pool |  23872 KiB |  79704 KiB | 177629 GiB | 177629 GiB |
|       from small pool |      0 KiB |  18293 KiB |   7200 GiB |   7200 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7653    |   81090 K  |   81090 K  |
|       from large pool |       2    |     158    |   33765 K  |   33765 K  |
|       from small pool |       0    |    7575    |   47324 K  |   47324 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7653    |   81090 K  |   81090 K  |
|       from large pool |       2    |     158    |   33765 K  |   33765 K  |
|       from small pool |       0    |    7575    |   47324 K  |   47324 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |      42    |      42    |      20    |
|       from large pool |      10    |      21    |      21    |      11    |
|       from small pool |      12    |      21    |      21    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3602    |   44610 K  |   44610 K  |
|       from large pool |       3    |      18    |   23011 K  |   23011 K  |
|       from small pool |       0    |    3594    |   21599 K  |   21599 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 461507 KiB | 349766 GiB | 349766 GiB |
|       from large pool |  17088 KiB | 427880 KiB | 342577 GiB | 342577 GiB |
|       from small pool |      0 KiB |  38507 KiB |   7189 GiB |   7189 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 461507 KiB | 349766 GiB | 349766 GiB |
|       from large pool |  17088 KiB | 427880 KiB | 342577 GiB | 342577 GiB |
|       from small pool |      0 KiB |  38507 KiB |   7189 GiB |   7189 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457564 KiB | 349745 GiB | 349745 GiB |
|       from large pool |  16640 KiB | 424940 KiB | 342572 GiB | 342572 GiB |
|       from small pool |      0 KiB |  37503 KiB |   7172 GiB |   7172 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 229376 KiB | 509952 KiB | 509952 KiB | 280576 KiB |
|       from large pool | 204800 KiB | 466944 KiB | 466944 KiB | 262144 KiB |
|       from small pool |  24576 KiB |  43008 KiB |  43008 KiB |  18432 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  87761 KiB | 184829 GiB | 184829 GiB |
|       from large pool |  23872 KiB |  79704 KiB | 177629 GiB | 177629 GiB |
|       from small pool |      0 KiB |  18293 KiB |   7200 GiB |   7200 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7653    |   81090 K  |   81090 K  |
|       from large pool |       2    |     158    |   33765 K  |   33765 K  |
|       from small pool |       0    |    7575    |   47324 K  |   47324 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7653    |   81090 K  |   81090 K  |
|       from large pool |       2    |     158    |   33765 K  |   33765 K  |
|       from small pool |       0    |    7575    |   47324 K  |   47324 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |      42    |      42    |      20    |
|       from large pool |      10    |      21    |      21    |      11    |
|       from small pool |      12    |      21    |      21    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3602    |   44610 K  |   44610 K  |
|       from large pool |       3    |      18    |   23011 K  |   23011 K  |
|       from small pool |       0    |    3594    |   21599 K  |   21599 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_18_29_38_seed_1_23857230

 Experiment start at: 2024-07-31 18:29:38.492180
before training, model accuracy: 0.6474379897117615
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.63284504, 'precision': 0.6346514, 'recall': 0.63280445, 'specificity': 0.63280445, 'f1': 0.6315665, 'auroc': 0.66491115, 'binary_precision': 0.6192281, 'binary_recall': 0.6912724, 'binary_specificity': 0.5743365, 'binary_f1_score': 0.65326995}
confusion matrix:
       0      1
0  16534  12254
1   8900  19928
---- Validation: 
scalar performance:
{'acc': 0.8675027, 'precision': 0.49758112, 'recall': 0.49354, 'specificity': 0.49354, 'f1': 0.48781797, 'auroc': 0.7022991, 'binary_precision': 0.0315735, 'binary_recall': 0.09063893, 'binary_specificity': 0.89644104, 'binary_f1_score': 0.046833016}
confusion matrix:
       0     1
0  16196  1871
1    612    61
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88913953, 'precision': 0.5378626, 'recall': 0.5761876, 'specificity': 0.5761876, 'f1': 0.5456586, 'auroc': 0.7894176, 'binary_precision': 0.11090909, 'binary_recall': 0.23461539, 'binary_specificity': 0.91775984, 'binary_f1_score': 0.15061729}
confusion matrix:
      0    1
0  5457  489
1   199   61
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-31 18:47:59.713470,epoch time: 0:18:21.221290,used: 0:18:21.221290,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_18_29_38_seed_1_23857230
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.758331, 'precision': 0.75899494, 'recall': 0.75831157, 'specificity': 0.75831157, 'f1': 0.7581667, 'auroc': 0.8304355, 'binary_precision': 0.74607104, 'binary_recall': 0.7838016, 'binary_specificity': 0.7328215, 'binary_f1_score': 0.76447105}
confusion matrix:
       0      1
0  21095   7691
1   6233  22597
---- Validation: 
scalar performance:
{'acc': 0.88046956, 'precision': 0.52004844, 'recall': 0.55104893, 'specificity': 0.55104893, 'f1': 0.5206937, 'auroc': 0.7656741, 'binary_precision': 0.07209175, 'binary_recall': 0.1961367, 'binary_specificity': 0.90596116, 'binary_f1_score': 0.1054313}
confusion matrix:
       0     1
0  16368  1699
1    541   132
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8963906, 'precision': 0.568916, 'recall': 0.6443362, 'specificity': 0.6443362, 'f1': 0.58719945, 'auroc': 0.83870023, 'binary_precision': 0.16695653, 'binary_recall': 0.36923078, 'binary_specificity': 0.91944164, 'binary_f1_score': 0.22994013}
confusion matrix:
      0    1
0  5467  479
1   164   96
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-31 19:04:07.494458,epoch time: 0:16:07.780988,used: 0:34:29.002278,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_18_29_38_seed_1_23857230
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.81546795, 'precision': 0.81556296, 'recall': 0.8154619, 'specificity': 0.8154619, 'f1': 0.815452, 'auroc': 0.8952737, 'binary_precision': 0.8102578, 'binary_recall': 0.8241987, 'binary_specificity': 0.806725, 'binary_f1_score': 0.8171688}
confusion matrix:
       0      1
0  23224   5564
1   5068  23760
---- Validation: 
scalar performance:
{'acc': 0.8903415, 'precision': 0.55252576, 'recall': 0.6362787, 'specificity': 0.6362787, 'f1': 0.5665396, 'auroc': 0.8004539, 'binary_precision': 0.13048129, 'binary_recall': 0.3625557, 'binary_specificity': 0.91000164, 'binary_f1_score': 0.19189933}
confusion matrix:
       0     1
0  16441  1626
1    429   244
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9007412, 'precision': 0.5955414, 'recall': 0.71464914, 'specificity': 0.71464914, 'f1': 0.6240808, 'auroc': 0.86530244, 'binary_precision': 0.21382637, 'binary_recall': 0.51153845, 'binary_specificity': 0.91775984, 'binary_f1_score': 0.3015873}
confusion matrix:
      0    1
0  5457  489
1   127  133
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-31 19:20:51.674145,epoch time: 0:16:44.179687,used: 0:51:13.181965,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_18_29_38_seed_1_23857230
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.8474035, 'precision': 0.84748304, 'recall': 0.847409, 'specificity': 0.847409, 'f1': 0.84739614, 'auroc': 0.9253365, 'binary_precision': 0.85292566, 'binary_recall': 0.83984876, 'binary_specificity': 0.85496926, 'binary_f1_score': 0.8463367}
confusion matrix:
       0      1
0  24612   4175
1   4617  24212
---- Validation: 
scalar performance:
{'acc': 0.9008538, 'precision': 0.5736745, 'recall': 0.6839314, 'specificity': 0.6839314, 'f1': 0.5964401, 'auroc': 0.819332, 'binary_precision': 0.16917923, 'binary_recall': 0.45022288, 'binary_specificity': 0.9176399, 'binary_f1_score': 0.24594155}
confusion matrix:
       0     1
0  16579  1488
1    370   303
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90315825, 'precision': 0.6076215, 'recall': 0.74901223, 'specificity': 0.74901223, 'f1': 0.6411104, 'auroc': 0.88115084, 'binary_precision': 0.2348367, 'binary_recall': 0.58076924, 'binary_specificity': 0.9172553, 'binary_f1_score': 0.33444077}
confusion matrix:
      0    1
0  5454  492
1   109  151
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-31 19:40:42.220844,epoch time: 0:19:50.546699,used: 1:11:03.728664,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_18_29_38_seed_1_23857230
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.8660268, 'precision': 0.86606973, 'recall': 0.86603075, 'specificity': 0.86603075, 'f1': 0.86602366, 'auroc': 0.94022787, 'binary_precision': 0.87022096, 'binary_recall': 0.86059177, 'binary_specificity': 0.87146974, 'binary_f1_score': 0.8653796}
confusion matrix:
       0      1
0  25087   3700
1   4019  24810
---- Validation: 
scalar performance:
{'acc': 0.9042689, 'precision': 0.58576286, 'recall': 0.71645904, 'specificity': 0.71645904, 'f1': 0.6135465, 'auroc': 0.8301228, 'binary_precision': 0.19084391, 'binary_recall': 0.51411587, 'binary_specificity': 0.91880226, 'binary_f1_score': 0.27835882}
confusion matrix:
       0     1
0  16600  1467
1    327   346
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90364164, 'precision': 0.6185844, 'recall': 0.7897222, 'specificity': 0.7897222, 'f1': 0.65719014, 'auroc': 0.892906, 'binary_precision': 0.25292397, 'binary_recall': 0.6653846, 'binary_specificity': 0.9140599, 'binary_f1_score': 0.36652538}
confusion matrix:
      0    1
0  5435  511
1    87  173
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-31 19:56:57.041021,epoch time: 0:16:14.820177,used: 1:27:18.548841,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_18_29_38_seed_1_23857230
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.8807276, 'precision': 0.8816354, 'recall': 0.8807446, 'specificity': 0.8807446, 'f1': 0.88065994, 'auroc': 0.9505577, 'binary_precision': 0.9004231, 'binary_recall': 0.85632026, 'binary_specificity': 0.90516883, 'binary_f1_score': 0.8778181}
confusion matrix:
       0      1
0  26058   2730
1   4142  24686
---- Validation: 
scalar performance:
{'acc': 0.9118997, 'precision': 0.5966258, 'recall': 0.729715, 'specificity': 0.729715, 'f1': 0.6280296, 'auroc': 0.83682024, 'binary_precision': 0.21167453, 'binary_recall': 0.53343236, 'binary_specificity': 0.9259977, 'binary_f1_score': 0.30308145}
confusion matrix:
       0     1
0  16730  1337
1    314   359
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9094425, 'precision': 0.6291678, 'recall': 0.8074614, 'specificity': 0.8074614, 'f1': 0.6714272, 'auroc': 0.90110195, 'binary_precision': 0.27259037, 'binary_recall': 0.6961538, 'binary_specificity': 0.91876894, 'binary_f1_score': 0.39177492}
confusion matrix:
      0    1
0  5463  483
1    79  181
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-31 20:12:58.798911,epoch time: 0:16:01.757890,used: 1:43:20.306731,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_18_29_38_seed_1_23857230
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.88907593, 'precision': 0.8903832, 'recall': 0.88909805, 'specificity': 0.88909805, 'f1': 0.888987, 'auroc': 0.9561788, 'binary_precision': 0.91316515, 'binary_recall': 0.860111, 'binary_specificity': 0.91808516, 'binary_f1_score': 0.88584447}
confusion matrix:
       0      1
0  26428   2358
1   4033  24797
---- Validation: 
scalar performance:
{'acc': 0.91558164, 'precision': 0.6031293, 'recall': 0.7387773, 'specificity': 0.7387773, 'f1': 0.63655454, 'auroc': 0.84175956, 'binary_precision': 0.22404371, 'binary_recall': 0.5482912, 'binary_specificity': 0.9292633, 'binary_f1_score': 0.31810343}
confusion matrix:
       0     1
0  16789  1278
1    304   369
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9118595, 'precision': 0.6348698, 'recall': 0.8197566, 'specificity': 0.8197566, 'f1': 0.6792389, 'auroc': 0.9073055, 'binary_precision': 0.28290468, 'binary_recall': 0.7192308, 'binary_specificity': 0.92028254, 'binary_f1_score': 0.40608034}
confusion matrix:
      0    1
0  5472  474
1    73  187
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-07-31 20:28:58.418842,epoch time: 0:15:59.619931,used: 1:59:19.926662,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_18_29_38_seed_1_23857230
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.89579284, 'precision': 0.89662325, 'recall': 0.89580953, 'specificity': 0.89580953, 'f1': 0.89574105, 'auroc': 0.9615469, 'binary_precision': 0.9149547, 'binary_recall': 0.87287104, 'binary_specificity': 0.918748, 'binary_f1_score': 0.8934176}
confusion matrix:
       0      1
0  26448   2339
1   3665  25164
---- Validation: 
scalar performance:
{'acc': 0.90464246, 'precision': 0.5951075, 'recall': 0.75027037, 'specificity': 0.75027037, 'f1': 0.6271434, 'auroc': 0.844106, 'binary_precision': 0.20684211, 'binary_recall': 0.5839524, 'binary_specificity': 0.91658825, 'binary_f1_score': 0.30547997}
confusion matrix:
       0     1
0  16560  1507
1    280   393
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89945215, 'precision': 0.62577826, 'recall': 0.8390275, 'specificity': 0.8390275, 'f1': 0.66850436, 'auroc': 0.91190517, 'binary_precision': 0.2624021, 'binary_recall': 0.77307695, 'binary_specificity': 0.90497816, 'binary_f1_score': 0.39181286}
confusion matrix:
      0    1
0  5381  565
1    59  201
early stop counter: 1
val acc:0.9046424627304077, best validation acc: 0.9155816435813904, corresponding to test acc:                         0.9118595123291016 / 0.9118595123291016
after epoch: 8,now: 2024-07-31 20:45:04.156033,epoch time: 0:16:05.737191,used: 2:15:25.663853,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_18_29_38_seed_1_23857230
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9051305, 'precision': 0.9058205, 'recall': 0.90514565, 'specificity': 0.90514565, 'f1': 0.9050925, 'auroc': 0.9653379, 'binary_precision': 0.9227373, 'binary_recall': 0.88445663, 'binary_specificity': 0.9258346, 'binary_f1_score': 0.90319145}
confusion matrix:
       0      1
0  26652   2135
1   3331  25498
---- Validation: 
scalar performance:
{'acc': 0.9074173, 'precision': 0.5989596, 'recall': 0.75528574, 'specificity': 0.75528574, 'f1': 0.6324282, 'auroc': 0.84622705, 'binary_precision': 0.21420883, 'binary_recall': 0.59138185, 'binary_specificity': 0.9191897, 'binary_f1_score': 0.31450018}
confusion matrix:
       0     1
0  16607  1460
1    275   398
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90686435, 'precision': 0.63577664, 'recall': 0.8502517, 'specificity': 0.8502517, 'f1': 0.6821922, 'auroc': 0.9153671, 'binary_precision': 0.2815934, 'binary_recall': 0.78846157, 'binary_specificity': 0.9120417, 'binary_f1_score': 0.41497976}
confusion matrix:
      0    1
0  5423  523
1    55  205
early stop counter: 2
val acc:0.9074172973632812, best validation acc: 0.9155816435813904, corresponding to test acc:                         0.9118595123291016 / 0.9118595123291016
after epoch: 9,now: 2024-07-31 21:01:04.159700,epoch time: 0:16:00.003667,used: 2:31:25.667520,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_18_29_38_seed_1_23857230
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9085671, 'precision': 0.90944946, 'recall': 0.90858483, 'specificity': 0.90858483, 'f1': 0.90852034, 'auroc': 0.9668952, 'binary_precision': 0.9286494, 'binary_recall': 0.8852931, 'binary_specificity': 0.9318766, 'binary_f1_score': 0.9064531}
confusion matrix:
       0      1
0  26825   1961
1   3307  25523
---- Validation: 
scalar performance:
{'acc': 0.90176094, 'precision': 0.5959733, 'recall': 0.7637965, 'specificity': 0.7637965, 'f1': 0.62867147, 'auroc': 0.84974074, 'binary_precision': 0.20741484, 'binary_recall': 0.615156, 'binary_specificity': 0.912437, 'binary_f1_score': 0.31022856}
confusion matrix:
       0     1
0  16485  1582
1    259   414
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.901708, 'precision': 0.6306017, 'recall': 0.8512387, 'specificity': 0.8512387, 'f1': 0.67536587, 'auroc': 0.91798234, 'binary_precision': 0.27094242, 'binary_recall': 0.79615384, 'binary_specificity': 0.90632355, 'binary_f1_score': 0.4042969}
confusion matrix:
      0    1
0  5389  557
1    53  207
early stop counter: 3
val acc:0.9017609357833862, best validation acc: 0.9155816435813904, corresponding to test acc:                         0.9118595123291016 / 0.9118595123291016
after epoch: 10,now: 2024-07-31 21:17:05.150016,epoch time: 0:16:00.990316,used: 2:47:26.657836,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_18_29_38_seed_1_23857230
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9129235, 'precision': 0.9137213, 'recall': 0.9129388, 'specificity': 0.9129388, 'f1': 0.91288364, 'auroc': 0.9695804, 'binary_precision': 0.93206316, 'binary_recall': 0.89090466, 'binary_specificity': 0.9349729, 'binary_f1_score': 0.9110193}
confusion matrix:
       0      1
0  26916   1872
1   3145  25683
---- Validation: 
scalar performance:
{'acc': 0.90256137, 'precision': 0.59641325, 'recall': 0.76278114, 'specificity': 0.76278114, 'f1': 0.62925863, 'auroc': 0.84925175, 'binary_precision': 0.20839655, 'binary_recall': 0.6121842, 'binary_specificity': 0.913378, 'binary_f1_score': 0.3109434}
confusion matrix:
       0     1
0  16502  1565
1    261   412
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90654206, 'precision': 0.6361653, 'recall': 0.85376143, 'specificity': 0.85376143, 'f1': 0.68285096, 'auroc': 0.9195218, 'binary_precision': 0.28201634, 'binary_recall': 0.79615384, 'binary_specificity': 0.91136897, 'binary_f1_score': 0.416499}
confusion matrix:
      0    1
0  5419  527
1    53  207
early stop counter: 4
val acc:0.902561366558075, best validation acc: 0.9155816435813904, corresponding to test acc:                         0.9118595123291016 / 0.9118595123291016
after epoch: 11,now: 2024-07-31 21:32:59.062805,epoch time: 0:15:53.912789,used: 3:03:20.570625,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_18_29_38_seed_1_23857230
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.91642946, 'precision': 0.91708314, 'recall': 0.91644394, 'specificity': 0.91644394, 'f1': 0.91639864, 'auroc': 0.9719362, 'binary_precision': 0.9337789, 'binary_recall': 0.8965625, 'binary_specificity': 0.93632543, 'binary_f1_score': 0.9147924}
confusion matrix:
       0      1
0  26954   1833
1   2982  25847
---- Validation: 
scalar performance:
{'acc': 0.8941836, 'precision': 0.5915773, 'recall': 0.77059567, 'specificity': 0.77059567, 'f1': 0.6223793, 'auroc': 0.8520527, 'binary_precision': 0.19787823, 'binary_recall': 0.63744426, 'binary_specificity': 0.90374714, 'binary_f1_score': 0.3020063}
confusion matrix:
       0     1
0  16328  1739
1    244   429
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8973574, 'precision': 0.6275089, 'recall': 0.8563242, 'specificity': 0.8563242, 'f1': 0.6711903, 'auroc': 0.9213996, 'binary_precision': 0.2640801, 'binary_recall': 0.81153846, 'binary_specificity': 0.90111, 'binary_f1_score': 0.39848918}
confusion matrix:
      0    1
0  5358  588
1    49  211
early stop counter: 5
val acc:0.8941835761070251, best validation acc: 0.9155816435813904, corresponding to test acc:                         0.9118595123291016 / 0.9118595123291016
after epoch: 12,now: 2024-07-31 21:48:59.052751,epoch time: 0:15:59.989946,used: 3:19:20.560571,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_18_29_38_seed_1_23857230
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9179221, 'precision': 0.91853106, 'recall': 0.9179354, 'specificity': 0.9179354, 'f1': 0.917894, 'auroc': 0.9722329, 'binary_precision': 0.93467045, 'binary_recall': 0.898779, 'binary_specificity': 0.9370918, 'binary_f1_score': 0.91637343}
confusion matrix:
       0      1
0  26977   1811
1   2918  25910
---- Validation: 
scalar performance:
{'acc': 0.8904482, 'precision': 0.58911824, 'recall': 0.77151954, 'specificity': 0.77151954, 'f1': 0.6186373, 'auroc': 0.8521651, 'binary_precision': 0.19278717, 'binary_recall': 0.6433878, 'binary_specificity': 0.8996513, 'binary_f1_score': 0.29667693}
confusion matrix:
       0     1
0  16254  1813
1    240   433
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8941347, 'precision': 0.62542266, 'recall': 0.8601594, 'specificity': 0.8601594, 'f1': 0.6682335, 'auroc': 0.92223346, 'binary_precision': 0.25939393, 'binary_recall': 0.8230769, 'binary_specificity': 0.89724183, 'binary_f1_score': 0.39447}
confusion matrix:
      0    1
0  5335  611
1    46  214
early stop counter: 6
val acc:0.8904482126235962, best validation acc: 0.9155816435813904, corresponding to test acc:                         0.9118595123291016 / 0.9118595123291016
after epoch: 13,now: 2024-07-31 22:04:53.317740,epoch time: 0:15:54.264989,used: 3:35:14.825560,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_18_29_38_seed_1_23857230
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9209074, 'precision': 0.9219337, 'recall': 0.92092454, 'specificity': 0.92092454, 'f1': 0.92086136, 'auroc': 0.9743302, 'binary_precision': 0.94291764, 'binary_recall': 0.89617735, 'binary_specificity': 0.9456718, 'binary_f1_score': 0.91895354}
confusion matrix:
       0      1
0  27224   1564
1   2993  25835
---- Validation: 
scalar performance:
{'acc': 0.89786553, 'precision': 0.59451973, 'recall': 0.7710748, 'specificity': 0.7710748, 'f1': 0.6266933, 'auroc': 0.8526505, 'binary_precision': 0.20381862, 'binary_recall': 0.6344725, 'binary_specificity': 0.907677, 'binary_f1_score': 0.30852604}
confusion matrix:
       0     1
0  16399  1668
1    246   427
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90315825, 'precision': 0.63453203, 'recall': 0.8630295, 'specificity': 0.8630295, 'f1': 0.68100584, 'auroc': 0.9233743, 'binary_precision': 0.27770534, 'binary_recall': 0.8192308, 'binary_specificity': 0.9068281, 'binary_f1_score': 0.4148004}
confusion matrix:
      0    1
0  5392  554
1    47  213
early stop counter: 7
val acc:0.8978655338287354, best validation acc: 0.9155816435813904, corresponding to test acc:                         0.9118595123291016 / 0.9118595123291016
after epoch: 14,now: 2024-07-31 22:20:49.671940,epoch time: 0:15:56.354200,used: 3:51:11.179760,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_18_29_38_seed_1_23857230
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9200396, 'precision': 0.92084515, 'recall': 0.9200556, 'specificity': 0.9200556, 'f1': 0.9200033, 'auroc': 0.97347033, 'binary_precision': 0.9394412, 'binary_recall': 0.89808875, 'binary_specificity': 0.94202244, 'binary_f1_score': 0.91829973}
confusion matrix:
       0      1
0  27118   1669
1   2938  25891
---- Validation: 
scalar performance:
{'acc': 0.88746, 'precision': 0.5870781, 'recall': 0.77140033, 'specificity': 0.77140033, 'f1': 0.6154578, 'auroc': 0.8538872, 'binary_precision': 0.18863833, 'binary_recall': 0.64635956, 'binary_specificity': 0.89644104, 'binary_f1_score': 0.29204428}
confusion matrix:
       0     1
0  16196  1871
1    238   435
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89107317, 'precision': 0.6224878, 'recall': 0.85856164, 'specificity': 0.85856164, 'f1': 0.6639502, 'auroc': 0.9244049, 'binary_precision': 0.2535545, 'binary_recall': 0.8230769, 'binary_specificity': 0.8940464, 'binary_f1_score': 0.38768113}
confusion matrix:
      0    1
0  5316  630
1    46  214
early stop counter: 8
val acc:0.8874599933624268, best validation acc: 0.9155816435813904, corresponding to test acc:                         0.9118595123291016 / 0.9118595123291016
after epoch: 15,now: 2024-07-31 22:36:53.195013,epoch time: 0:16:03.523073,used: 4:07:14.702833,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_18_29_38_seed_1_23857230
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.92349344, 'precision': 0.9241251, 'recall': 0.9235069, 'specificity': 0.9235069, 'f1': 0.92346656, 'auroc': 0.97536075, 'binary_precision': 0.940667, 'binary_recall': 0.904121, 'binary_specificity': 0.94289285, 'binary_f1_score': 0.922032}
confusion matrix:
       0      1
0  27144   1644
1   2764  26064
---- Validation: 
scalar performance:
{'acc': 0.8798292, 'precision': 0.583747, 'recall': 0.7774565, 'specificity': 0.7774565, 'f1': 0.6097404, 'auroc': 0.85529506, 'binary_precision': 0.18126766, 'binary_recall': 0.66716194, 'binary_specificity': 0.88775116, 'binary_f1_score': 0.28507936}
confusion matrix:
       0     1
0  16039  2028
1    224   449
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88011605, 'precision': 0.61298, 'recall': 0.8528435, 'specificity': 0.8528435, 'f1': 0.64949775, 'auroc': 0.92510927, 'binary_precision': 0.23464912, 'binary_recall': 0.8230769, 'binary_specificity': 0.88261014, 'binary_f1_score': 0.36518773}
confusion matrix:
      0    1
0  5248  698
1    46  214
early stop counter: 9
val acc:0.8798292279243469, best validation acc: 0.9155816435813904, corresponding to test acc:                         0.9118595123291016 / 0.9118595123291016
after epoch: 16,now: 2024-07-31 22:52:58.331318,epoch time: 0:16:05.136305,used: 4:23:19.839138,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_18_29_38_seed_1_23857230
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.92555887, 'precision': 0.926167, 'recall': 0.92557275, 'specificity': 0.92557275, 'f1': 0.9255339, 'auroc': 0.9764241, 'binary_precision': 0.94244915, 'binary_recall': 0.9065871, 'binary_specificity': 0.9445583, 'binary_f1_score': 0.9241704}
confusion matrix:
       0      1
0  27191   1596
1   2693  26136
---- Validation: 
scalar performance:
{'acc': 0.87940234, 'precision': 0.5839262, 'recall': 0.7793809, 'specificity': 0.7793809, 'f1': 0.6099279, 'auroc': 0.85603, 'binary_precision': 0.18145323, 'binary_recall': 0.6716196, 'binary_specificity': 0.8871423, 'binary_f1_score': 0.28571427}
confusion matrix:
       0     1
0  16028  2039
1    221   452
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8815662, 'precision': 0.61492217, 'recall': 0.85727835, 'specificity': 0.85727835, 'f1': 0.6524087, 'auroc': 0.9256669, 'binary_precision': 0.23814774, 'binary_recall': 0.83076924, 'binary_specificity': 0.8837874, 'binary_f1_score': 0.37017992}
confusion matrix:
      0    1
0  5255  691
1    44  216
early stop counter: 10
val acc:0.8794023394584656, best validation acc: 0.9155816435813904, corresponding to test acc:                         0.9118595123291016 / 0.9118595123291016
after epoch: 17,now: 2024-07-31 23:08:58.688643,epoch time: 0:16:00.357325,used: 4:39:20.196463,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_18_29_38_seed_1_23857230
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9263052, 'precision': 0.9271422, 'recall': 0.9263214, 'specificity': 0.9263214, 'f1': 0.92627096, 'auroc': 0.9774536, 'binary_precision': 0.94623345, 'binary_recall': 0.9040896, 'binary_specificity': 0.94855314, 'binary_f1_score': 0.9246816}
confusion matrix:
       0      1
0  27306   1481
1   2765  26064
---- Validation: 
scalar performance:
{'acc': 0.879936, 'precision': 0.5846117, 'recall': 0.78108823, 'specificity': 0.78108823, 'f1': 0.6109841, 'auroc': 0.85676, 'binary_precision': 0.18269618, 'binary_recall': 0.67459136, 'binary_specificity': 0.8875851, 'binary_f1_score': 0.28752375}
confusion matrix:
       0     1
0  16036  2031
1    219   454
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8822108, 'precision': 0.6154527, 'recall': 0.8576147, 'specificity': 0.8576147, 'f1': 0.6532348, 'auroc': 0.9263655, 'binary_precision': 0.23920266, 'binary_recall': 0.83076924, 'binary_specificity': 0.88446015, 'binary_f1_score': 0.37145314}
confusion matrix:
      0    1
0  5259  687
1    44  216
early stop counter: 11
val acc:0.8799359798431396, best validation acc: 0.9155816435813904, corresponding to test acc:                         0.9118595123291016 / 0.9118595123291016
after epoch: 18,now: 2024-07-31 23:24:55.582345,epoch time: 0:15:56.893702,used: 4:55:17.090165,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_18_29_38_seed_1_23857230
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9269821, 'precision': 0.9273738, 'recall': 0.9269932, 'specificity': 0.9269932, 'f1': 0.92696655, 'auroc': 0.97730875, 'binary_precision': 0.9404966, 'binary_recall': 0.9117555, 'binary_specificity': 0.9422309, 'binary_f1_score': 0.9259031}
confusion matrix:
       0      1
0  27124   1663
1   2544  26285
---- Validation: 
scalar performance:
{'acc': 0.8739594, 'precision': 0.58186233, 'recall': 0.78371084, 'specificity': 0.78371084, 'f1': 0.60605824, 'auroc': 0.85665905, 'binary_precision': 0.17680827, 'binary_recall': 0.68647844, 'binary_specificity': 0.8809432, 'binary_f1_score': 0.28119293}
confusion matrix:
       0     1
0  15916  2151
1    211   462
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.877699, 'precision': 0.6125935, 'recall': 0.8589381, 'specificity': 0.8589381, 'f1': 0.6485942, 'auroc': 0.9268758, 'binary_precision': 0.23315509, 'binary_recall': 0.8384615, 'binary_specificity': 0.87941474, 'binary_f1_score': 0.36485353}
confusion matrix:
      0    1
0  5229  717
1    42  218
early stop counter: 12
val acc:0.8739594221115112, best validation acc: 0.9155816435813904, corresponding to test acc:                         0.9118595123291016 / 0.9118595123291016
after epoch: 19,now: 2024-07-31 23:40:56.321856,epoch time: 0:16:00.739511,used: 5:11:17.829676,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_18_29_38_seed_1_23857230
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9304707, 'precision': 0.93095237, 'recall': 0.930483, 'specificity': 0.930483, 'f1': 0.9304526, 'auroc': 0.97884315, 'binary_precision': 0.9455433, 'binary_recall': 0.9136633, 'binary_specificity': 0.9473026, 'binary_f1_score': 0.92932993}
confusion matrix:
       0      1
0  27270   1517
1   2489  26340
---- Validation: 
scalar performance:
{'acc': 0.8876201, 'precision': 0.58883727, 'recall': 0.778636, 'specificity': 0.778636, 'f1': 0.6179955, 'auroc': 0.85688317, 'binary_precision': 0.19156264, 'binary_recall': 0.6612184, 'binary_specificity': 0.89605355, 'binary_f1_score': 0.29706275}
confusion matrix:
       0     1
0  16189  1878
1    228   445
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89155656, 'precision': 0.62332535, 'recall': 0.8606529, 'specificity': 0.8606529, 'f1': 0.6651678, 'auroc': 0.9269185, 'binary_precision': 0.2550415, 'binary_recall': 0.8269231, 'binary_specificity': 0.8943828, 'binary_f1_score': 0.38984585}
confusion matrix:
      0    1
0  5318  628
1    45  215
early stop counter: 13
val acc:0.8876200914382935, best validation acc: 0.9155816435813904, corresponding to test acc:                         0.9118595123291016 / 0.9118595123291016
after epoch: 20,now: 2024-07-31 23:56:57.578858,epoch time: 0:16:01.257002,used: 5:27:19.086678,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_18_29_38_seed_1_23857230
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 5:27:19.086678 at 2024-07-31 23:56:57.578858
persisted model performance metric: 

scalar performance:
{'acc': 0.9118595, 'precision': 0.6348698, 'recall': 0.8197566, 'specificity': 0.8197566, 'f1': 0.6792389, 'auroc': 0.9073055, 'binary_precision': 0.28290468, 'binary_recall': 0.7192308, 'binary_specificity': 0.92028254, 'binary_f1_score': 0.40608034}
confusion matrix:
      0    1
0  5472  474
1    73  187
oracle model performance metric: 

scalar performance:
{'acc': 0.9118595, 'precision': 0.6348698, 'recall': 0.8197566, 'specificity': 0.8197566, 'f1': 0.6792389, 'auroc': 0.9073055, 'binary_precision': 0.28290468, 'binary_recall': 0.7192308, 'binary_specificity': 0.92028254, 'binary_f1_score': 0.40608034}
confusion matrix:
      0    1
0  5472  474
1    73  187
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_12-46-56/rule_results/15.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_12-46-56/confusion_matrix/15.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 190959 KiB | 461507 KiB | 702663 GiB | 702663 GiB |
|       from large pool | 173494 KiB | 427880 KiB | 688224 GiB | 688224 GiB |
|       from small pool |  17465 KiB |  38507 KiB |  14439 GiB |  14439 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 190959 KiB | 461507 KiB | 702663 GiB | 702663 GiB |
|       from large pool | 173494 KiB | 427880 KiB | 688224 GiB | 688224 GiB |
|       from small pool |  17465 KiB |  38507 KiB |  14439 GiB |  14439 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 189280 KiB | 457564 KiB | 702623 GiB | 702623 GiB |
|       from large pool | 172814 KiB | 424940 KiB | 688216 GiB | 688216 GiB |
|       from small pool |  16466 KiB |  37503 KiB |  14406 GiB |  14406 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 526336 KiB | 526336 KiB |    788 MiB | 280576 KiB |
|       from large pool | 487424 KiB | 487424 KiB |    732 MiB | 262144 KiB |
|       from small pool |  38912 KiB |  43008 KiB |     56 MiB |  18432 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  42512 KiB |  87761 KiB | 381862 GiB | 381862 GiB |
|       from large pool |  31306 KiB |  79704 KiB | 367400 GiB | 367400 GiB |
|       from small pool |  11206 KiB |  18293 KiB |  14461 GiB |  14461 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2942    |    7685    |  162710 K  |  162707 K  |
|       from large pool |      76    |     158    |   67835 K  |   67835 K  |
|       from small pool |    2866    |    7607    |   94875 K  |   94872 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2942    |    7685    |  162710 K  |  162707 K  |
|       from large pool |      76    |     158    |   67835 K  |   67835 K  |
|       from small pool |    2866    |    7607    |   94875 K  |   94872 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      41    |      42    |      61    |      20    |
|       from large pool |      22    |      22    |      33    |      11    |
|       from small pool |      19    |      21    |      28    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      35    |    3620    |   84999 K  |   84999 K  |
|       from large pool |      10    |      23    |   42044 K  |   42044 K  |
|       from small pool |      25    |    3610    |   42955 K  |   42955 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 461507 KiB | 702663 GiB | 702663 GiB |
|       from large pool |  17088 KiB | 427880 KiB | 688224 GiB | 688224 GiB |
|       from small pool |      0 KiB |  38507 KiB |  14439 GiB |  14439 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 461507 KiB | 702663 GiB | 702663 GiB |
|       from large pool |  17088 KiB | 427880 KiB | 688224 GiB | 688224 GiB |
|       from small pool |      0 KiB |  38507 KiB |  14439 GiB |  14439 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457564 KiB | 702623 GiB | 702623 GiB |
|       from large pool |  16640 KiB | 424940 KiB | 688216 GiB | 688216 GiB |
|       from small pool |      0 KiB |  37503 KiB |  14406 GiB |  14406 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 233472 KiB | 526336 KiB |    788 MiB | 573440 KiB |
|       from large pool | 204800 KiB | 487424 KiB |    732 MiB | 544768 KiB |
|       from small pool |  28672 KiB |  43008 KiB |     56 MiB |  28672 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  87761 KiB | 381862 GiB | 381862 GiB |
|       from large pool |  23872 KiB |  79704 KiB | 367400 GiB | 367400 GiB |
|       from small pool |      0 KiB |  21236 KiB |  14461 GiB |  14461 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7685    |  162710 K  |  162710 K  |
|       from large pool |       2    |     158    |   67835 K  |   67835 K  |
|       from small pool |       0    |    7607    |   94875 K  |   94875 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7685    |  162710 K  |  162710 K  |
|       from large pool |       2    |     158    |   67835 K  |   67835 K  |
|       from small pool |       0    |    7607    |   94875 K  |   94875 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |      42    |      61    |      37    |
|       from large pool |      10    |      22    |      33    |      23    |
|       from small pool |      14    |      21    |      28    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3620    |   85001 K  |   85001 K  |
|       from large pool |       3    |      23    |   42044 K  |   42044 K  |
|       from small pool |       0    |    3610    |   42956 K  |   42956 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 461507 KiB | 702663 GiB | 702663 GiB |
|       from large pool |  17088 KiB | 427880 KiB | 688224 GiB | 688224 GiB |
|       from small pool |      0 KiB |  38507 KiB |  14439 GiB |  14439 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 461507 KiB | 702663 GiB | 702663 GiB |
|       from large pool |  17088 KiB | 427880 KiB | 688224 GiB | 688224 GiB |
|       from small pool |      0 KiB |  38507 KiB |  14439 GiB |  14439 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457564 KiB | 702623 GiB | 702623 GiB |
|       from large pool |  16640 KiB | 424940 KiB | 688216 GiB | 688216 GiB |
|       from small pool |      0 KiB |  37503 KiB |  14406 GiB |  14406 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 233472 KiB | 526336 KiB |    788 MiB | 573440 KiB |
|       from large pool | 204800 KiB | 487424 KiB |    732 MiB | 544768 KiB |
|       from small pool |  28672 KiB |  43008 KiB |     56 MiB |  28672 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  87761 KiB | 381862 GiB | 381862 GiB |
|       from large pool |  23872 KiB |  79704 KiB | 367400 GiB | 367400 GiB |
|       from small pool |      0 KiB |  21236 KiB |  14461 GiB |  14461 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7685    |  162710 K  |  162710 K  |
|       from large pool |       2    |     158    |   67835 K  |   67835 K  |
|       from small pool |       0    |    7607    |   94875 K  |   94875 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7685    |  162710 K  |  162710 K  |
|       from large pool |       2    |     158    |   67835 K  |   67835 K  |
|       from small pool |       0    |    7607    |   94875 K  |   94875 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |      42    |      61    |      37    |
|       from large pool |      10    |      22    |      33    |      23    |
|       from small pool |      14    |      21    |      28    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3620    |   85001 K  |   85001 K  |
|       from large pool |       3    |      23    |   42044 K  |   42044 K  |
|       from small pool |       0    |    3610    |   42956 K  |   42956 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_00_04_23_seed_2_23857230

 Experiment start at: 2024-08-01 00:04:23.959504
before training, model accuracy: 0.754768431186676
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.73662186, 'precision': 0.7367991, 'recall': 0.73661804, 'specificity': 0.73661804, 'f1': 0.7365705, 'auroc': 0.81217384, 'binary_precision': 0.73038924, 'binary_recall': 0.75037724, 'binary_specificity': 0.7228589, 'binary_f1_score': 0.7402483}
confusion matrix:
       0      1
0  21067   8077
1   7279  21881
---- Validation: 
scalar performance:
{'acc': 0.63575345, 'precision': 0.5246901, 'recall': 0.68737054, 'specificity': 0.68737054, 'f1': 0.44313407, 'auroc': 0.75472736, 'binary_precision': 0.06269285, 'binary_recall': 0.7425249, 'binary_specificity': 0.63221616, 'binary_f1_score': 0.11562339}
confusion matrix:
       0     1
0  11488  6683
1    155   447
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.36239782, 'precision': 0.5028997, 'recall': 0.51764584, 'specificity': 0.51764584, 'f1': 0.29500383, 'auroc': 0.49167973, 'binary_precision': 0.040806293, 'binary_recall': 0.6859504, 'binary_specificity': 0.34934133, 'binary_f1_score': 0.07703017}
confusion matrix:
      0     1
0  2095  3902
1    76   166
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-01 00:21:24.064765,epoch time: 0:17:00.105261,used: 0:17:00.105261,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_00_04_23_seed_2_23857230
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.81814283, 'precision': 0.8188677, 'recall': 0.81814694, 'specificity': 0.81814694, 'f1': 0.8180407, 'auroc': 0.8944222, 'binary_precision': 0.83411366, 'binary_recall': 0.7943204, 'binary_specificity': 0.8419734, 'binary_f1_score': 0.81373084}
confusion matrix:
       0      1
0  24541   4606
1   5997  23160
---- Validation: 
scalar performance:
{'acc': 0.74633783, 'precision': 0.53396624, 'recall': 0.71317565, 'specificity': 0.71317565, 'f1': 0.49866375, 'auroc': 0.7807746, 'binary_precision': 0.08199357, 'binary_recall': 0.6777409, 'binary_specificity': 0.74861044, 'binary_f1_score': 0.14628899}
confusion matrix:
       0     1
0  13603  4568
1    194   408
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.582946, 'precision': 0.515642, 'recall': 0.6026288, 'specificity': 0.6026288, 'f1': 0.4161084, 'auroc': 0.637269, 'binary_precision': 0.05672427, 'binary_recall': 0.62396693, 'binary_specificity': 0.58129066, 'binary_f1_score': 0.103994496}
confusion matrix:
      0     1
0  3486  2511
1    91   151
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-01 00:38:40.049485,epoch time: 0:17:15.984720,used: 0:34:16.089981,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_00_04_23_seed_2_23857230
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.84657997, 'precision': 0.846936, 'recall': 0.8465822, 'specificity': 0.8465822, 'f1': 0.84654117, 'auroc': 0.9230256, 'binary_precision': 0.8580844, 'binary_recall': 0.8305666, 'binary_specificity': 0.86259776, 'binary_f1_score': 0.84410125}
confusion matrix:
       0      1
0  25143   4005
1   4940  24216
---- Validation: 
scalar performance:
{'acc': 0.7784584, 'precision': 0.5401672, 'recall': 0.73137414, 'specificity': 0.73137414, 'f1': 0.5184929, 'auroc': 0.7996423, 'binary_precision': 0.09367146, 'binary_recall': 0.6810631, 'binary_specificity': 0.7816851, 'binary_f1_score': 0.1646917}
confusion matrix:
       0     1
0  14204  3967
1    192   410
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6541112, 'precision': 0.5270901, 'recall': 0.66740566, 'specificity': 0.66740566, 'f1': 0.45831028, 'auroc': 0.7144619, 'binary_precision': 0.07346394, 'binary_recall': 0.6818182, 'binary_specificity': 0.65299314, 'binary_f1_score': 0.13263667}
confusion matrix:
      0     1
0  3916  2081
1    77   165
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-01 00:55:11.392995,epoch time: 0:16:31.343510,used: 0:50:47.433491,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_00_04_23_seed_2_23857230
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.8636629, 'precision': 0.8636694, 'recall': 0.8636632, 'specificity': 0.8636632, 'f1': 0.8636623, 'auroc': 0.9380564, 'binary_precision': 0.8652475, 'binary_recall': 0.86153793, 'binary_specificity': 0.8657884, 'binary_f1_score': 0.8633887}
confusion matrix:
       0      1
0  25236   3912
1   4037  25119
---- Validation: 
scalar performance:
{'acc': 0.7965695, 'precision': 0.5442656, 'recall': 0.7407297, 'specificity': 0.7407297, 'f1': 0.53035396, 'auroc': 0.8118226, 'binary_precision': 0.10156056, 'binary_recall': 0.6810631, 'binary_specificity': 0.80039626, 'binary_f1_score': 0.17676224}
confusion matrix:
       0     1
0  14544  3627
1    192   410
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.68921304, 'precision': 0.5341176, 'recall': 0.70152676, 'specificity': 0.70152676, 'f1': 0.48059687, 'auroc': 0.75939274, 'binary_precision': 0.084679395, 'binary_recall': 0.71487606, 'binary_specificity': 0.6881774, 'binary_f1_score': 0.15142232}
confusion matrix:
      0     1
0  4127  1870
1    69   173
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-01 01:11:36.679207,epoch time: 0:16:25.286212,used: 1:07:12.719703,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_00_04_23_seed_2_23857230
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.87338775, 'precision': 0.8736523, 'recall': 0.8733909, 'specificity': 0.8733909, 'f1': 0.873366, 'auroc': 0.94491416, 'binary_precision': 0.88365453, 'binary_recall': 0.8600775, 'binary_specificity': 0.8867044, 'binary_f1_score': 0.87170666}
confusion matrix:
       0      1
0  25843   3302
1   4080  25079
---- Validation: 
scalar performance:
{'acc': 0.8137751, 'precision': 0.54799616, 'recall': 0.74479914, 'specificity': 0.74479914, 'f1': 0.54128206, 'auroc': 0.8221555, 'binary_precision': 0.109130196, 'binary_recall': 0.6710963, 'binary_specificity': 0.818502, 'binary_f1_score': 0.18773234}
confusion matrix:
       0     1
0  14873  3298
1    198   404
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.71998715, 'precision': 0.5421507, 'recall': 0.73736215, 'specificity': 0.73736215, 'f1': 0.50233275, 'auroc': 0.7940644, 'binary_precision': 0.09780866, 'binary_recall': 0.75619835, 'binary_specificity': 0.71852595, 'binary_f1_score': 0.17321345}
confusion matrix:
      0     1
0  4309  1688
1    59   183
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-01 01:28:00.724699,epoch time: 0:16:24.045492,used: 1:23:36.765195,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_00_04_23_seed_2_23857230
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.88398737, 'precision': 0.8848451, 'recall': 0.8839914, 'specificity': 0.8839914, 'f1': 0.8839235, 'auroc': 0.9519478, 'binary_precision': 0.90305626, 'binary_recall': 0.8603766, 'binary_specificity': 0.90760624, 'binary_f1_score': 0.88119996}
confusion matrix:
       0      1
0  26454   2693
1   4071  25086
---- Validation: 
scalar performance:
{'acc': 0.841581, 'precision': 0.55462754, 'recall': 0.74551094, 'specificity': 0.74551094, 'f1': 0.5592584, 'auroc': 0.82930326, 'binary_precision': 0.12301335, 'binary_recall': 0.64285713, 'binary_specificity': 0.8481647, 'binary_f1_score': 0.20651014}
confusion matrix:
       0     1
0  15412  2759
1    215   387
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76614845, 'precision': 0.5507697, 'recall': 0.7574086, 'specificity': 0.7574086, 'f1': 0.5309433, 'auroc': 0.8189584, 'binary_precision': 0.114629515, 'binary_recall': 0.74793386, 'binary_specificity': 0.76688343, 'binary_f1_score': 0.19879188}
confusion matrix:
      0     1
0  4599  1398
1    61   181
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-08-01 01:44:20.953541,epoch time: 0:16:20.228842,used: 1:39:56.994037,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_00_04_23_seed_2_23857230
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.89247733, 'precision': 0.8934718, 'recall': 0.89248085, 'specificity': 0.89248085, 'f1': 0.89241, 'auroc': 0.9576683, 'binary_precision': 0.91328686, 'binary_recall': 0.86733437, 'binary_specificity': 0.9176273, 'binary_f1_score': 0.88971764}
confusion matrix:
       0      1
0  26747   2401
1   3868  25288
---- Validation: 
scalar performance:
{'acc': 0.8473339, 'precision': 0.5577799, 'recall': 0.75330096, 'specificity': 0.75330096, 'f1': 0.5653334, 'auroc': 0.8357651, 'binary_precision': 0.12885246, 'binary_recall': 0.6528239, 'binary_specificity': 0.853778, 'binary_f1_score': 0.21522452}
confusion matrix:
       0     1
0  15514  2657
1    209   393
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77768874, 'precision': 0.5543165, 'recall': 0.76737714, 'specificity': 0.76737714, 'f1': 0.5397305, 'auroc': 0.83776873, 'binary_precision': 0.12111185, 'binary_recall': 0.75619835, 'binary_specificity': 0.7785559, 'binary_f1_score': 0.20878494}
confusion matrix:
      0     1
0  4669  1328
1    59   183
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-08-01 02:00:45.450279,epoch time: 0:16:24.496738,used: 1:56:21.490775,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_00_04_23_seed_2_23857230
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.897983, 'precision': 0.898353, 'recall': 0.8979851, 'specificity': 0.8979851, 'f1': 0.89795965, 'auroc': 0.9608917, 'binary_precision': 0.91052854, 'binary_recall': 0.88273424, 'binary_specificity': 0.9132359, 'binary_f1_score': 0.89641607}
confusion matrix:
       0      1
0  26619   2529
1   3419  25737
---- Validation: 
scalar performance:
{'acc': 0.83742607, 'precision': 0.55576706, 'recall': 0.7578195, 'specificity': 0.7578195, 'f1': 0.55956453, 'auroc': 0.8394135, 'binary_precision': 0.12423313, 'binary_recall': 0.67275745, 'binary_specificity': 0.8428815, 'binary_f1_score': 0.20973587}
confusion matrix:
       0     1
0  15316  2855
1    197   405
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7682321, 'precision': 0.55438936, 'recall': 0.7763372, 'specificity': 0.7763372, 'f1': 0.536178, 'auroc': 0.8498099, 'binary_precision': 0.1199495, 'binary_recall': 0.78512394, 'binary_specificity': 0.76755047, 'binary_f1_score': 0.20810513}
confusion matrix:
      0     1
0  4603  1394
1    52   190
early stop counter: 1
val acc:0.8374260663986206, best validation acc: 0.8473339080810547, corresponding to test acc:                         0.77768874168396 / 0.77768874168396
after epoch: 8,now: 2024-08-01 02:17:07.783204,epoch time: 0:16:22.332925,used: 2:12:43.823700,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_00_04_23_seed_2_23857230
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9024252, 'precision': 0.9032706, 'recall': 0.90242994, 'specificity': 0.90242994, 'f1': 0.9023748, 'auroc': 0.9636838, 'binary_precision': 0.9217857, 'binary_recall': 0.8795185, 'binary_specificity': 0.92534137, 'binary_f1_score': 0.9001562}
confusion matrix:
       0      1
0  26970   2176
1   3513  25645
---- Validation: 
scalar performance:
{'acc': 0.8580408, 'precision': 0.5616187, 'recall': 0.75481653, 'specificity': 0.75481653, 'f1': 0.57368743, 'auroc': 0.8411621, 'binary_precision': 0.13666785, 'binary_recall': 0.64451826, 'binary_specificity': 0.86511475, 'binary_f1_score': 0.22551584}
confusion matrix:
       0     1
0  15720  2451
1    214   388
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79916656, 'precision': 0.56147903, 'recall': 0.7844976, 'specificity': 0.7844976, 'f1': 0.5567356, 'auroc': 0.8580558, 'binary_precision': 0.13449024, 'binary_recall': 0.76859504, 'binary_specificity': 0.8004002, 'binary_f1_score': 0.22892307}
confusion matrix:
      0     1
0  4800  1197
1    56   186
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-08-01 02:33:34.188433,epoch time: 0:16:26.405229,used: 2:29:10.228929,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_00_04_23_seed_2_23857230
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9069018, 'precision': 0.90734684, 'recall': 0.9069052, 'specificity': 0.9069052, 'f1': 0.9068768, 'auroc': 0.96522987, 'binary_precision': 0.92086405, 'binary_recall': 0.890356, 'binary_specificity': 0.92345434, 'binary_f1_score': 0.90535307}
confusion matrix:
       0      1
0  26915   2231
1   3197  25961
---- Validation: 
scalar performance:
{'acc': 0.85010386, 'precision': 0.5601456, 'recall': 0.7611562, 'specificity': 0.7611562, 'f1': 0.56942827, 'auroc': 0.8453349, 'binary_precision': 0.1330458, 'binary_recall': 0.66611296, 'binary_specificity': 0.85619944, 'binary_f1_score': 0.22179204}
confusion matrix:
       0     1
0  15558  2613
1    201   401
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79163325, 'precision': 0.5613626, 'recall': 0.79247546, 'specificity': 0.79247546, 'f1': 0.55379564, 'auroc': 0.86690044, 'binary_precision': 0.1331484, 'binary_recall': 0.7933884, 'binary_specificity': 0.79156244, 'binary_f1_score': 0.2280285}
confusion matrix:
      0     1
0  4747  1250
1    50   192
early stop counter: 1
val acc:0.8501038551330566, best validation acc: 0.8580408096313477, corresponding to test acc:                         0.7991665601730347 / 0.7991665601730347
after epoch: 10,now: 2024-08-01 02:50:01.013105,epoch time: 0:16:26.824672,used: 2:45:37.053601,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_00_04_23_seed_2_23857230
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9104693, 'precision': 0.91103053, 'recall': 0.9104737, 'specificity': 0.9104737, 'f1': 0.91043925, 'auroc': 0.9678309, 'binary_precision': 0.9262794, 'binary_recall': 0.8919716, 'binary_specificity': 0.9289758, 'binary_f1_score': 0.9088018}
confusion matrix:
       0      1
0  27075   2070
1   3150  26009
---- Validation: 
scalar performance:
{'acc': 0.86176956, 'precision': 0.5638559, 'recall': 0.7591518, 'specificity': 0.7591518, 'f1': 0.5778102, 'auroc': 0.84639966, 'binary_precision': 0.1409009, 'binary_recall': 0.6495017, 'binary_specificity': 0.86880195, 'binary_f1_score': 0.23156647}
confusion matrix:
       0     1
0  15787  2384
1    211   391
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80974513, 'precision': 0.5652976, 'recall': 0.7919831, 'specificity': 0.7919831, 'f1': 0.5654303, 'auroc': 0.87215984, 'binary_precision': 0.14177407, 'binary_recall': 0.77272725, 'binary_specificity': 0.81123894, 'binary_f1_score': 0.23959}
confusion matrix:
      0     1
0  4865  1132
1    55   187
new oracle model saved
better model found
persisted
after epoch: 11,now: 2024-08-01 03:06:23.940793,epoch time: 0:16:22.927688,used: 3:01:59.981289,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_00_04_23_seed_2_23857230
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.91388243, 'precision': 0.91440034, 'recall': 0.9138861, 'specificity': 0.9138861, 'f1': 0.91385597, 'auroc': 0.9704489, 'binary_precision': 0.92910224, 'binary_recall': 0.8961863, 'binary_specificity': 0.9315858, 'binary_f1_score': 0.9123475}
confusion matrix:
       0      1
0  27152   1994
1   3027  26131
---- Validation: 
scalar performance:
{'acc': 0.8565493, 'precision': 0.56313205, 'recall': 0.7652887, 'specificity': 0.7652887, 'f1': 0.5754097, 'auroc': 0.8492395, 'binary_precision': 0.1388601, 'binary_recall': 0.6677741, 'binary_specificity': 0.86280334, 'binary_f1_score': 0.22991134}
confusion matrix:
       0     1
0  15678  2493
1    200   402
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80461615, 'precision': 0.56504685, 'recall': 0.7972461, 'specificity': 0.7972461, 'f1': 0.5632648, 'auroc': 0.87781775, 'binary_precision': 0.14054452, 'binary_recall': 0.7892562, 'binary_specificity': 0.8052359, 'binary_f1_score': 0.23860088}
confusion matrix:
      0     1
0  4829  1168
1    51   191
early stop counter: 1
val acc:0.8565493226051331, best validation acc: 0.8617695569992065, corresponding to test acc:                         0.8097451329231262 / 0.8097451329231262
after epoch: 12,now: 2024-08-01 03:22:50.412758,epoch time: 0:16:26.471965,used: 3:18:26.453254,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_00_04_23_seed_2_23857230
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9144827, 'precision': 0.91512245, 'recall': 0.91448545, 'specificity': 0.91448545, 'f1': 0.9144501, 'auroc': 0.9706292, 'binary_precision': 0.93145305, 'binary_recall': 0.89484155, 'binary_specificity': 0.9341293, 'binary_f1_score': 0.9127803}
confusion matrix:
       0      1
0  27228   1920
1   3066  26090
---- Validation: 
scalar performance:
{'acc': 0.84914505, 'precision': 0.5611074, 'recall': 0.7678883, 'specificity': 0.7678883, 'f1': 0.57049, 'auroc': 0.85071075, 'binary_precision': 0.13442624, 'binary_recall': 0.6810631, 'binary_specificity': 0.85471356, 'binary_f1_score': 0.22453451}
confusion matrix:
       0     1
0  15531  2640
1    192   410
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79980767, 'precision': 0.56529796, 'recall': 0.80465853, 'specificity': 0.80465853, 'f1': 0.5618127, 'auroc': 0.8819003, 'binary_precision': 0.14010008, 'binary_recall': 0.80991733, 'binary_specificity': 0.7993997, 'binary_f1_score': 0.23887874}
confusion matrix:
      0     1
0  4794  1203
1    46   196
early stop counter: 2
val acc:0.8491450548171997, best validation acc: 0.8617695569992065, corresponding to test acc:                         0.8097451329231262 / 0.8097451329231262
after epoch: 13,now: 2024-08-01 03:39:09.626311,epoch time: 0:16:19.213553,used: 3:34:45.666807,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_00_04_23_seed_2_23857230
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9180502, 'precision': 0.91926, 'recall': 0.9180548, 'specificity': 0.9180548, 'f1': 0.9179917, 'auroc': 0.97299254, 'binary_precision': 0.9418246, 'binary_recall': 0.8911754, 'binary_specificity': 0.9449343, 'binary_f1_score': 0.9158003}
confusion matrix:
       0      1
0  27542   1605
1   3173  25984
---- Validation: 
scalar performance:
{'acc': 0.8714643, 'precision': 0.56969625, 'recall': 0.768175, 'specificity': 0.768175, 'f1': 0.588424, 'auroc': 0.8514898, 'binary_precision': 0.15213215, 'binary_recall': 0.6578073, 'binary_specificity': 0.8785427, 'binary_f1_score': 0.24711388}
confusion matrix:
       0     1
0  15964  2207
1    206   396
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82945985, 'precision': 0.573108, 'recall': 0.80422103, 'specificity': 0.80422103, 'f1': 0.5823584, 'auroc': 0.88494456, 'binary_precision': 0.15692821, 'binary_recall': 0.7768595, 'binary_specificity': 0.8315825, 'binary_f1_score': 0.2611111}
confusion matrix:
      0     1
0  4987  1010
1    54   188
new oracle model saved
better model found
persisted
after epoch: 14,now: 2024-08-01 03:55:33.989501,epoch time: 0:16:24.363190,used: 3:51:10.029997,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_00_04_23_seed_2_23857230
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.91949093, 'precision': 0.92035854, 'recall': 0.91949403, 'specificity': 0.91949403, 'f1': 0.9194498, 'auroc': 0.9732499, 'binary_precision': 0.9394898, 'binary_recall': 0.89676225, 'binary_specificity': 0.9422259, 'binary_f1_score': 0.91762894}
confusion matrix:
       0      1
0  27464   1684
1   3010  26146
---- Validation: 
scalar performance:
{'acc': 0.8567091, 'precision': 0.5644441, 'recall': 0.77179563, 'specificity': 0.77179563, 'f1': 0.57729214, 'auroc': 0.8528254, 'binary_precision': 0.14099038, 'binary_recall': 0.6810631, 'binary_specificity': 0.8625282, 'binary_f1_score': 0.23361823}
confusion matrix:
       0     1
0  15673  2498
1    192   410
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8129508, 'precision': 0.56863636, 'recall': 0.80554706, 'specificity': 0.80554706, 'f1': 0.570866, 'auroc': 0.887944, 'binary_precision': 0.14721587, 'binary_recall': 0.79752064, 'binary_specificity': 0.8135735, 'binary_f1_score': 0.2485512}
confusion matrix:
      0     1
0  4879  1118
1    49   193
early stop counter: 1
val acc:0.8567091226577759, best validation acc: 0.8714643120765686, corresponding to test acc:                         0.8294598460197449 / 0.8294598460197449
after epoch: 15,now: 2024-08-01 04:11:56.527681,epoch time: 0:16:22.538180,used: 4:07:32.568177,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_00_04_23_seed_2_23857230
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.92177206, 'precision': 0.9224379, 'recall': 0.9217748, 'specificity': 0.9217748, 'f1': 0.9217416, 'auroc': 0.974856, 'binary_precision': 0.9392435, 'binary_recall': 0.90190697, 'binary_specificity': 0.94164264, 'binary_f1_score': 0.92019665}
confusion matrix:
       0      1
0  27447   1701
1   2860  26296
---- Validation: 
scalar performance:
{'acc': 0.8637405, 'precision': 0.5673731, 'recall': 0.7730187, 'specificity': 0.7730187, 'f1': 0.58327377, 'auroc': 0.85496616, 'binary_precision': 0.14693141, 'binary_recall': 0.67607975, 'binary_specificity': 0.8699576, 'binary_f1_score': 0.24139978}
confusion matrix:
       0     1
0  15808  2363
1    195   407
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82577336, 'precision': 0.5734994, 'recall': 0.81221706, 'specificity': 0.81221706, 'f1': 0.5816385, 'auroc': 0.8913231, 'binary_precision': 0.1567831, 'binary_recall': 0.79752064, 'binary_specificity': 0.8269135, 'binary_f1_score': 0.26205024}
confusion matrix:
      0     1
0  4959  1038
1    49   193
early stop counter: 2
val acc:0.8637405037879944, best validation acc: 0.8714643120765686, corresponding to test acc:                         0.8294598460197449 / 0.8294598460197449
after epoch: 16,now: 2024-08-01 04:28:18.650409,epoch time: 0:16:22.122728,used: 4:23:54.690905,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_00_04_23_seed_2_23857230
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9240875, 'precision': 0.92469263, 'recall': 0.92409015, 'specificity': 0.92409015, 'f1': 0.9240608, 'auroc': 0.9758567, 'binary_precision': 0.9407571, 'binary_recall': 0.9051996, 'binary_specificity': 0.94298065, 'binary_f1_score': 0.92263585}
confusion matrix:
       0      1
0  27486   1662
1   2764  26392
---- Validation: 
scalar performance:
{'acc': 0.8571885, 'precision': 0.56589663, 'recall': 0.77846766, 'specificity': 0.77846766, 'f1': 0.57945836, 'auroc': 0.8577875, 'binary_precision': 0.14339623, 'binary_recall': 0.69435215, 'binary_specificity': 0.8625832, 'binary_f1_score': 0.23770258}
confusion matrix:
       0     1
0  15674  2497
1    184   418
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8163167, 'precision': 0.5709642, 'recall': 0.81324613, 'specificity': 0.81324613, 'f1': 0.5750616, 'auroc': 0.8940593, 'binary_precision': 0.15123457, 'binary_recall': 0.80991733, 'binary_specificity': 0.81657493, 'binary_f1_score': 0.25487646}
confusion matrix:
      0     1
0  4897  1100
1    46   196
early stop counter: 3
val acc:0.8571885228157043, best validation acc: 0.8714643120765686, corresponding to test acc:                         0.8294598460197449 / 0.8294598460197449
after epoch: 17,now: 2024-08-01 04:44:38.774269,epoch time: 0:16:20.123860,used: 4:40:14.814765,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_00_04_23_seed_2_23857230
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.92463636, 'precision': 0.9253446, 'recall': 0.9246406, 'specificity': 0.9246406, 'f1': 0.9246055, 'auroc': 0.97667193, 'binary_precision': 0.9427519, 'binary_recall': 0.9042115, 'binary_specificity': 0.9450697, 'binary_f1_score': 0.92307955}
confusion matrix:
       0      1
0  27545   1601
1   2793  26365
---- Validation: 
scalar performance:
{'acc': 0.8595323, 'precision': 0.5670115, 'recall': 0.7796784, 'specificity': 0.7796784, 'f1': 0.5816607, 'auroc': 0.8588729, 'binary_precision': 0.14559387, 'binary_recall': 0.69435215, 'binary_specificity': 0.86500466, 'binary_f1_score': 0.24071406}
confusion matrix:
       0     1
0  15718  2453
1    184   418
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82048404, 'precision': 0.57253665, 'recall': 0.8154139, 'specificity': 0.8154139, 'f1': 0.5785627, 'auroc': 0.89589286, 'binary_precision': 0.15433072, 'binary_recall': 0.80991733, 'binary_specificity': 0.82091045, 'binary_f1_score': 0.25925925}
confusion matrix:
      0     1
0  4923  1074
1    46   196
early stop counter: 4
val acc:0.8595322966575623, best validation acc: 0.8714643120765686, corresponding to test acc:                         0.8294598460197449 / 0.8294598460197449
after epoch: 18,now: 2024-08-01 05:01:00.323152,epoch time: 0:16:21.548883,used: 4:56:36.363648,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_00_04_23_seed_2_23857230
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9285641, 'precision': 0.9291959, 'recall': 0.928568, 'specificity': 0.928568, 'f1': 0.9285382, 'auroc': 0.9773134, 'binary_precision': 0.9457146, 'binary_recall': 0.90935594, 'binary_specificity': 0.94778013, 'binary_f1_score': 0.9271789}
confusion matrix:
       0      1
0  27624   1522
1   2643  26515
---- Validation: 
scalar performance:
{'acc': 0.86342084, 'precision': 0.56878126, 'recall': 0.780884, 'specificity': 0.780884, 'f1': 0.58517677, 'auroc': 0.8592533, 'binary_precision': 0.14914162, 'binary_recall': 0.692691, 'binary_specificity': 0.8690771, 'binary_f1_score': 0.24543849}
confusion matrix:
       0     1
0  15792  2379
1    185   417
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8281776, 'precision': 0.57523584, 'recall': 0.8174331, 'specificity': 0.8174331, 'f1': 0.58472246, 'auroc': 0.8972213, 'binary_precision': 0.15983607, 'binary_recall': 0.8057851, 'binary_specificity': 0.8290812, 'binary_f1_score': 0.26675788}
confusion matrix:
      0     1
0  4972  1025
1    47   195
early stop counter: 5
val acc:0.863420844078064, best validation acc: 0.8714643120765686, corresponding to test acc:                         0.8294598460197449 / 0.8294598460197449
after epoch: 19,now: 2024-08-01 05:17:21.840274,epoch time: 0:16:21.517122,used: 5:12:57.880770,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_00_04_23_seed_2_23857230
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9278266, 'precision': 0.9285507, 'recall': 0.9278294, 'specificity': 0.9278294, 'f1': 0.92779636, 'auroc': 0.97742736, 'binary_precision': 0.94620115, 'binary_recall': 0.9072575, 'binary_specificity': 0.9484013, 'binary_f1_score': 0.9263202}
confusion matrix:
       0      1
0  27644   1504
1   2704  26452
---- Validation: 
scalar performance:
{'acc': 0.8657114, 'precision': 0.5698044, 'recall': 0.7812642, 'specificity': 0.7812642, 'f1': 0.58720374, 'auroc': 0.85986894, 'binary_precision': 0.15121774, 'binary_recall': 0.6910299, 'binary_specificity': 0.8714985, 'binary_f1_score': 0.248136}
confusion matrix:
       0     1
0  15836  2335
1    186   416
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8317038, 'precision': 0.5763446, 'recall': 0.8172847, 'specificity': 0.8172847, 'f1': 0.58735526, 'auroc': 0.8988344, 'binary_precision': 0.16220737, 'binary_recall': 0.8016529, 'binary_specificity': 0.83291644, 'binary_f1_score': 0.2698192}
confusion matrix:
      0     1
0  4995  1002
1    48   194
new oracle model saved
early stop counter: 6
val acc:0.8657113909721375, best validation acc: 0.8714643120765686, corresponding to test acc:                         0.8294598460197449 / 0.831703782081604
after epoch: 20,now: 2024-08-01 05:33:44.006432,epoch time: 0:16:22.166158,used: 5:29:20.046928,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_00_04_23_seed_2_23857230
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 5:29:20.046928 at 2024-08-01 05:33:44.006432
persisted model performance metric: 

scalar performance:
{'acc': 0.82945985, 'precision': 0.573108, 'recall': 0.80422103, 'specificity': 0.80422103, 'f1': 0.5823584, 'auroc': 0.88494456, 'binary_precision': 0.15692821, 'binary_recall': 0.7768595, 'binary_specificity': 0.8315825, 'binary_f1_score': 0.2611111}
confusion matrix:
      0     1
0  4987  1010
1    54   188
oracle model performance metric: 

scalar performance:
{'acc': 0.8317038, 'precision': 0.5763446, 'recall': 0.8172847, 'specificity': 0.8172847, 'f1': 0.58735526, 'auroc': 0.8988344, 'binary_precision': 0.16220737, 'binary_recall': 0.8016529, 'binary_specificity': 0.83291644, 'binary_f1_score': 0.2698192}
confusion matrix:
      0     1
0  4995  1002
1    48   194
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_12-46-56/rule_results/15.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_12-46-56/confusion_matrix/15.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 190965 KiB | 461507 KiB |   1040 TiB |   1040 TiB |
|       from large pool | 173494 KiB | 427880 KiB |   1018 TiB |   1018 TiB |
|       from small pool |  17471 KiB |  38507 KiB |     21 TiB |     21 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 190965 KiB | 461507 KiB |   1040 TiB |   1040 TiB |
|       from large pool | 173494 KiB | 427880 KiB |   1018 TiB |   1018 TiB |
|       from small pool |  17471 KiB |  38507 KiB |     21 TiB |     21 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 189282 KiB | 457564 KiB |   1040 TiB |   1040 TiB |
|       from large pool | 172814 KiB | 424940 KiB |   1018 TiB |   1018 TiB |
|       from small pool |  16468 KiB |  37503 KiB |     21 TiB |     21 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 526336 KiB | 526336 KiB |   1074 MiB | 573440 KiB |
|       from large pool | 487424 KiB | 487424 KiB |   1008 MiB | 544768 KiB |
|       from small pool |  38912 KiB |  43008 KiB |     66 MiB |  28672 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  40458 KiB |  87761 KiB | 584883 GiB | 584883 GiB |
|       from large pool |  31306 KiB |  79704 KiB | 562794 GiB | 562794 GiB |
|       from small pool |   9152 KiB |  21236 KiB |  22089 GiB |  22089 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2954    |    7771    |  246076 K  |  246073 K  |
|       from large pool |      76    |     158    |  102832 K  |  102831 K  |
|       from small pool |    2878    |    7693    |  143244 K  |  143242 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2954    |    7771    |  246076 K  |  246073 K  |
|       from large pool |      76    |     158    |  102832 K  |  102831 K  |
|       from small pool |    2878    |    7693    |  143244 K  |  143242 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      41    |      42    |      78    |      37    |
|       from large pool |      22    |      22    |      45    |      23    |
|       from small pool |      19    |      21    |      33    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      31    |    3665    |  130231 K  |  130231 K  |
|       from large pool |      10    |      23    |   61653 K  |   61653 K  |
|       from small pool |      21    |    3655    |   68578 K  |   68578 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 461507 KiB |   1040 TiB |   1040 TiB |
|       from large pool |  17088 KiB | 427880 KiB |   1018 TiB |   1018 TiB |
|       from small pool |      0 KiB |  38507 KiB |     21 TiB |     21 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 461507 KiB |   1040 TiB |   1040 TiB |
|       from large pool |  17088 KiB | 427880 KiB |   1018 TiB |   1018 TiB |
|       from small pool |      0 KiB |  38507 KiB |     21 TiB |     21 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457564 KiB |   1040 TiB |   1040 TiB |
|       from large pool |  16640 KiB | 424940 KiB |   1018 TiB |   1018 TiB |
|       from small pool |      0 KiB |  37503 KiB |     21 TiB |     21 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 231424 KiB | 526336 KiB |   1074 MiB |    848 MiB |
|       from large pool | 204800 KiB | 487424 KiB |   1008 MiB |    808 MiB |
|       from small pool |  26624 KiB |  43008 KiB |     66 MiB |     40 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  87761 KiB | 584883 GiB | 584883 GiB |
|       from large pool |  23872 KiB |  79704 KiB | 562794 GiB | 562794 GiB |
|       from small pool |      0 KiB |  21236 KiB |  22089 GiB |  22089 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7771    |  246076 K  |  246076 K  |
|       from large pool |       2    |     158    |  102832 K  |  102832 K  |
|       from small pool |       0    |    7693    |  143244 K  |  143244 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7771    |  246076 K  |  246076 K  |
|       from large pool |       2    |     158    |  102832 K  |  102832 K  |
|       from small pool |       0    |    7693    |  143244 K  |  143244 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |      42    |      78    |      55    |
|       from large pool |      10    |      22    |      45    |      35    |
|       from small pool |      13    |      21    |      33    |      20    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3665    |  130232 K  |  130232 K  |
|       from large pool |       3    |      23    |   61653 K  |   61653 K  |
|       from small pool |       0    |    3655    |   68579 K  |   68579 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Thu Aug  1 05:35:05 2024]
Finished job 0.
1 of 1 steps (100%) done
