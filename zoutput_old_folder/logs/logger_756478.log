Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0




!!!: not committed yet



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_11_13_seed_0_21512107

 Experiment start at: 2024-06-19 23:11:13.605520
before training, model accuracy: 0.31128156185150146
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9442209, 'precision': 0.96809053, 'recall': 0.7059189, 'specificity': 0.7059189, 'f1': 0.77637637, 'auroc': 0.9437456, 'binary_precision': 0.99398905, 'binary_recall': 0.41209787, 'binary_specificity': 0.99974, 'binary_f1_score': 0.58263934}
confusion matrix:
       0     1
0  42295    11
1   2595  1819
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.7329165, 'recall': 0.50075006, 'specificity': 0.50075006, 'f1': 0.49284685, 'auroc': 0.5519755, 'binary_precision': 0.5, 'binary_recall': 0.00155521, 'binary_specificity': 0.9999449, 'binary_f1_score': 0.0031007752}
confusion matrix:
       0  1
0  18148  1
1    642  1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579738, 'precision': 0.47914, 'recall': 0.49983326, 'specificity': 0.49983326, 'f1': 0.48926792, 'auroc': 0.59763217, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5995  2
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512107_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-19 23:47:08.158995,epoch time: 0:35:54.553475,used: 0:35:54.553475,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_11_13_seed_0_21512107
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9692423, 'precision': 0.9810858, 'recall': 0.83877283, 'specificity': 0.83877283, 'f1': 0.8948015, 'auroc': 0.9750849, 'binary_precision': 0.9946791, 'binary_recall': 0.67792386, 'binary_specificity': 0.9996218, 'binary_f1_score': 0.8063082}
confusion matrix:
       0     1
0  42292    16
1   1421  2991
---- Validation: 
scalar performance:
{'acc': 0.9661026, 'precision': 0.77508533, 'recall': 0.51591647, 'specificity': 0.51591647, 'f1': 0.52229756, 'auroc': 0.64042544, 'binary_precision': 0.5833333, 'binary_recall': 0.032659408, 'binary_specificity': 0.9991735, 'binary_f1_score': 0.06185567}
confusion matrix:
       0   1
0  18134  15
1    622  21
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.75766563, 'recall': 0.5184901, 'specificity': 0.5184901, 'f1': 0.5252596, 'auroc': 0.679753, 'binary_precision': 0.5555556, 'binary_recall': 0.038314175, 'binary_specificity': 0.998666, 'binary_f1_score': 0.071684584}
confusion matrix:
      0   1
0  5989   8
1   251  10
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512107_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-20 00:23:01.793919,epoch time: 0:35:53.634924,used: 1:11:48.188399,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_11_13_seed_0_21512107
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97643405, 'precision': 0.9818614, 'recall': 0.8793415, 'specificity': 0.8793415, 'f1': 0.9230578, 'auroc': 0.98363274, 'binary_precision': 0.98821104, 'binary_recall': 0.7596285, 'binary_specificity': 0.9990545, 'binary_f1_score': 0.8589727}
confusion matrix:
       0     1
0  42266    40
1   1061  3353
---- Validation: 
scalar performance:
{'acc': 0.96647507, 'precision': 0.76372874, 'recall': 0.5468616, 'specificity': 0.5468616, 'f1': 0.57367533, 'auroc': 0.69801164, 'binary_precision': 0.5585586, 'binary_recall': 0.096423015, 'binary_specificity': 0.99730015, 'binary_f1_score': 0.16445623}
confusion matrix:
       0   1
0  18100  49
1    581  62
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608501, 'precision': 0.8312641, 'recall': 0.55263937, 'specificity': 0.55263937, 'f1': 0.58299464, 'auroc': 0.7245256, 'binary_precision': 0.7, 'binary_recall': 0.107279696, 'binary_specificity': 0.997999, 'binary_f1_score': 0.18604651}
confusion matrix:
      0   1
0  5985  12
1   233  28
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512107_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-20 00:57:45.703025,epoch time: 0:34:43.909106,used: 1:46:32.097505,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_11_13_seed_0_21512107
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9803724, 'precision': 0.9800613, 'recall': 0.9036122, 'specificity': 0.9036122, 'f1': 0.93772304, 'auroc': 0.98602843, 'binary_precision': 0.97969264, 'binary_recall': 0.8089735, 'binary_specificity': 0.9982509, 'binary_f1_score': 0.88618594}
confusion matrix:
       0     1
0  42233    74
1    843  3570
---- Validation: 
scalar performance:
{'acc': 0.9664219, 'precision': 0.75517154, 'recall': 0.56033504, 'specificity': 0.56033504, 'f1': 0.5925628, 'auroc': 0.73928666, 'binary_precision': 0.5405405, 'binary_recall': 0.1244168, 'binary_specificity': 0.99625325, 'binary_f1_score': 0.20227562}
confusion matrix:
       0   1
0  18081  68
1    563  80
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.8122984, 'recall': 0.56929713, 'specificity': 0.56929713, 'f1': 0.6067594, 'auroc': 0.7600558, 'binary_precision': 0.66071427, 'binary_recall': 0.14176245, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.23343849}
confusion matrix:
      0   1
0  5978  19
1   224  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512107_4.png
new oracle model saved
early stop counter: 1
val acc:0.966421902179718, best validation acc: 0.9664750695228577, corresponding to test acc:                         0.9608501195907593 / 0.9611697196960449
after epoch: 4,now: 2024-06-20 01:30:50.085024,epoch time: 0:33:04.381999,used: 2:19:36.479504,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_11_13_seed_0_21512107
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9833048, 'precision': 0.98234355, 'recall': 0.9188483, 'specificity': 0.9188483, 'f1': 0.9478062, 'auroc': 0.9891707, 'binary_precision': 0.98119706, 'binary_recall': 0.8393747, 'binary_specificity': 0.9983218, 'binary_f1_score': 0.9047619}
confusion matrix:
       0     1
0  42235    71
1    709  3705
---- Validation: 
scalar performance:
{'acc': 0.9668476, 'precision': 0.7640724, 'recall': 0.5733063, 'specificity': 0.5733063, 'f1': 0.61025476, 'auroc': 0.7496712, 'binary_precision': 0.5574713, 'binary_recall': 0.15085536, 'binary_specificity': 0.99575734, 'binary_f1_score': 0.2374541}
confusion matrix:
       0   1
0  18072  77
1    546  97
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96244806, 'precision': 0.8256464, 'recall': 0.5901198, 'specificity': 0.5901198, 'f1': 0.63537216, 'auroc': 0.7707764, 'binary_precision': 0.6857143, 'binary_recall': 0.18390805, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.2900302}
confusion matrix:
      0   1
0  5975  22
1   213  48
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512107_5.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-06-20 02:03:50.058877,epoch time: 0:32:59.973853,used: 2:52:36.453357,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_11_13_seed_0_21512107
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9851027, 'precision': 0.9810329, 'recall': 0.93051815, 'specificity': 0.93051815, 'f1': 0.9540249, 'auroc': 0.9907825, 'binary_precision': 0.9761477, 'binary_recall': 0.8632343, 'binary_specificity': 0.997802, 'binary_f1_score': 0.9162253}
confusion matrix:
       0     1
0  42218    93
1    603  3806
---- Validation: 
scalar performance:
{'acc': 0.96695405, 'precision': 0.76270425, 'recall': 0.5853623, 'specificity': 0.5853623, 'f1': 0.6249601, 'auroc': 0.7684826, 'binary_precision': 0.5539216, 'binary_recall': 0.17573872, 'binary_specificity': 0.99498594, 'binary_f1_score': 0.2668241}
confusion matrix:
       0    1
0  18058   91
1    530  113
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96196866, 'precision': 0.81154805, 'recall': 0.5898696, 'specificity': 0.5898696, 'f1': 0.6339441, 'auroc': 0.776569, 'binary_precision': 0.65753424, 'binary_recall': 0.18390805, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.28742516}
confusion matrix:
      0   1
0  5972  25
1   213  48
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512107_6.png
better model found
persisted
after epoch: 6,now: 2024-06-20 02:35:53.555963,epoch time: 0:32:03.497086,used: 3:24:39.950443,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_11_13_seed_0_21512107
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98662245, 'precision': 0.9814272, 'recall': 0.9392333, 'specificity': 0.9392333, 'f1': 0.9591185, 'auroc': 0.99191344, 'binary_precision': 0.97516304, 'binary_recall': 0.8808067, 'binary_specificity': 0.99766, 'binary_f1_score': 0.92558634}
confusion matrix:
       0     1
0  42208    99
1    526  3887
---- Validation: 
scalar performance:
{'acc': 0.96647507, 'precision': 0.7493267, 'recall': 0.59786534, 'specificity': 0.59786534, 'f1': 0.6374829, 'auroc': 0.78303134, 'binary_precision': 0.5263158, 'binary_recall': 0.2021773, 'binary_specificity': 0.99355334, 'binary_f1_score': 0.29213485}
confusion matrix:
       0    1
0  18032  117
1    513  130
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.8170396, 'recall': 0.6124413, 'specificity': 0.6124413, 'f1': 0.66144574, 'auroc': 0.7903025, 'binary_precision': 0.6666667, 'binary_recall': 0.22988506, 'binary_specificity': 0.9949975, 'binary_f1_score': 0.34188035}
confusion matrix:
      0   1
0  5967  30
1   201  60
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512107_7.png
new oracle model saved
early stop counter: 1
val acc:0.9664750695228577, best validation acc: 0.9669540524482727, corresponding to test acc:                         0.9619686603546143 / 0.963087260723114
after epoch: 7,now: 2024-06-20 03:06:55.273145,epoch time: 0:31:01.717182,used: 3:55:41.667625,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_11_13_seed_0_21512107
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9860659, 'precision': 0.98061526, 'recall': 0.93670744, 'specificity': 0.93670744, 'f1': 0.9573446, 'auroc': 0.9924786, 'binary_precision': 0.97404885, 'binary_recall': 0.87584955, 'binary_specificity': 0.9975653, 'binary_f1_score': 0.92234284}
confusion matrix:
       0     1
0  42203   103
1    548  3866
---- Validation: 
scalar performance:
{'acc': 0.96631545, 'precision': 0.7464559, 'recall': 0.5940324, 'specificity': 0.5940324, 'f1': 0.6329391, 'auroc': 0.78726304, 'binary_precision': 0.5208333, 'binary_recall': 0.19440125, 'binary_specificity': 0.99366355, 'binary_f1_score': 0.2831257}
confusion matrix:
       0    1
0  18034  115
1    518  125
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96180886, 'precision': 0.78980756, 'recall': 0.61177427, 'specificity': 0.61177427, 'f1': 0.6573012, 'auroc': 0.7884124, 'binary_precision': 0.6122449, 'binary_recall': 0.22988506, 'binary_specificity': 0.9936635, 'binary_f1_score': 0.33426183}
confusion matrix:
      0   1
0  5959  38
1   201  60
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512107_8.png
early stop counter: 2
val acc:0.9663154482841492, best validation acc: 0.9669540524482727, corresponding to test acc:                         0.9619686603546143 / 0.963087260723114
after epoch: 8,now: 2024-06-20 03:38:21.298079,epoch time: 0:31:26.024934,used: 4:27:07.692559,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_11_13_seed_0_21512107
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98707193, 'precision': 0.98097825, 'recall': 0.94228476, 'specificity': 0.94228476, 'f1': 0.9606146, 'auroc': 0.994263, 'binary_precision': 0.9736187, 'binary_recall': 0.8870748, 'binary_specificity': 0.9974947, 'binary_f1_score': 0.9283341}
confusion matrix:
       0     1
0  42204   106
1    498  3912
---- Validation: 
scalar performance:
{'acc': 0.9669008, 'precision': 0.7597015, 'recall': 0.59133524, 'specificity': 0.59133524, 'f1': 0.6315768, 'auroc': 0.79358286, 'binary_precision': 0.54751134, 'binary_recall': 0.1881804, 'binary_specificity': 0.99449, 'binary_f1_score': 0.2800926}
confusion matrix:
       0    1
0  18049  100
1    522  121
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96340686, 'precision': 0.8246206, 'recall': 0.612608, 'specificity': 0.612608, 'f1': 0.6625091, 'auroc': 0.791664, 'binary_precision': 0.6818182, 'binary_recall': 0.22988506, 'binary_specificity': 0.995331, 'binary_f1_score': 0.34383956}
confusion matrix:
      0   1
0  5969  28
1   201  60
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512107_9.png
new oracle model saved
early stop counter: 3
val acc:0.9669008255004883, best validation acc: 0.9669540524482727, corresponding to test acc:                         0.9619686603546143 / 0.9634068608283997
after epoch: 9,now: 2024-06-20 04:09:55.564261,epoch time: 0:31:34.266182,used: 4:58:41.958741,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_11_13_seed_0_21512107
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9880565, 'precision': 0.9842272, 'recall': 0.9451115, 'specificity': 0.9451115, 'f1': 0.9636375, 'auroc': 0.99397355, 'binary_precision': 0.979602, 'binary_recall': 0.8921613, 'binary_specificity': 0.9980617, 'binary_f1_score': 0.93383926}
confusion matrix:
       0     1
0  42224    82
1    476  3938
---- Validation: 
scalar performance:
{'acc': 0.9671669, 'precision': 0.76530516, 'recall': 0.5937231, 'specificity': 0.5937231, 'f1': 0.63495094, 'auroc': 0.79235303, 'binary_precision': 0.5585586, 'binary_recall': 0.19284603, 'binary_specificity': 0.99460024, 'binary_f1_score': 0.2867052}
confusion matrix:
       0    1
0  18051   98
1    519  124
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606903, 'precision': 0.7790549, 'recall': 0.58920264, 'specificity': 0.58920264, 'f1': 0.63024735, 'auroc': 0.7881099, 'binary_precision': 0.5925926, 'binary_recall': 0.18390805, 'binary_specificity': 0.99449724, 'binary_f1_score': 0.28070176}
confusion matrix:
      0   1
0  5964  33
1   213  48
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512107_10.png
better model found
persisted
after epoch: 10,now: 2024-06-20 04:42:01.631931,epoch time: 0:32:06.067670,used: 5:30:48.026411,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_11_13_seed_0_21512107
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9883776, 'precision': 0.97982156, 'recall': 0.95126414, 'specificity': 0.95126414, 'f1': 0.96499205, 'auroc': 0.99452174, 'binary_precision': 0.9694323, 'binary_recall': 0.90550643, 'binary_specificity': 0.9970218, 'binary_f1_score': 0.93637955}
confusion matrix:
       0     1
0  42181   126
1    417  3996
---- Validation: 
scalar performance:
{'acc': 0.9665815, 'precision': 0.7506583, 'recall': 0.6046709, 'specificity': 0.6046709, 'f1': 0.6448606, 'auroc': 0.79651606, 'binary_precision': 0.5285171, 'binary_recall': 0.21617419, 'binary_specificity': 0.99316764, 'binary_f1_score': 0.30684328}
confusion matrix:
       0    1
0  18025  124
1    504  139
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9613295, 'precision': 0.7807068, 'recall': 0.61152416, 'specificity': 0.61152416, 'f1': 0.6557903, 'auroc': 0.78613186, 'binary_precision': 0.5940594, 'binary_recall': 0.22988506, 'binary_specificity': 0.9931632, 'binary_f1_score': 0.33149174}
confusion matrix:
      0   1
0  5956  41
1   201  60
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512107_11.png
early stop counter: 1
val acc:0.9665815234184265, best validation acc: 0.9671669006347656, corresponding to test acc:                         0.9606903195381165 / 0.9634068608283997
after epoch: 11,now: 2024-06-20 05:14:05.064291,epoch time: 0:32:03.432360,used: 6:02:51.458771,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_11_13_seed_0_21512107
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9890197, 'precision': 0.98412126, 'recall': 0.95093, 'specificity': 0.95093, 'f1': 0.9667862, 'auroc': 0.9944415, 'binary_precision': 0.97818625, 'binary_recall': 0.90396374, 'binary_specificity': 0.99789625, 'binary_f1_score': 0.93961155}
confusion matrix:
       0     1
0  42216    89
1    424  3991
---- Validation: 
scalar performance:
{'acc': 0.96695405, 'precision': 0.7589537, 'recall': 0.59961337, 'specificity': 0.59961337, 'f1': 0.6406918, 'auroc': 0.8150004, 'binary_precision': 0.54545456, 'binary_recall': 0.20528771, 'binary_specificity': 0.99393904, 'binary_f1_score': 0.2983051}
confusion matrix:
       0    1
0  18039  110
1    511  132
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96180886, 'precision': 0.7932403, 'recall': 0.6062773, 'specificity': 0.6062773, 'f1': 0.6516482, 'auroc': 0.8108888, 'binary_precision': 0.6195652, 'binary_recall': 0.21839081, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.32294616}
confusion matrix:
      0   1
0  5962  35
1   204  57
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512107_12.png
early stop counter: 2
val acc:0.9669540524482727, best validation acc: 0.9671669006347656, corresponding to test acc:                         0.9606903195381165 / 0.9634068608283997
after epoch: 12,now: 2024-06-20 05:46:00.927119,epoch time: 0:31:55.862828,used: 6:34:47.321599,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_11_13_seed_0_21512107
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98953336, 'precision': 0.98615295, 'recall': 0.9519931, 'specificity': 0.9519931, 'f1': 0.968293, 'auroc': 0.9957205, 'binary_precision': 0.9820595, 'binary_recall': 0.9057117, 'binary_specificity': 0.99827456, 'binary_f1_score': 0.94234174}
confusion matrix:
       0     1
0  42235    73
1    416  3996
---- Validation: 
scalar performance:
{'acc': 0.9671137, 'precision': 0.7649932, 'recall': 0.5906954, 'specificity': 0.5906954, 'f1': 0.6314465, 'auroc': 0.8002306, 'binary_precision': 0.55813956, 'binary_recall': 0.1866252, 'binary_specificity': 0.9947656, 'binary_f1_score': 0.2797203}
confusion matrix:
       0    1
0  18054   95
1    523  120
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589326, 'precision': 0.74586433, 'recall': 0.5699622, 'specificity': 0.5699622, 'f1': 0.60356665, 'auroc': 0.79322433, 'binary_precision': 0.5277778, 'binary_recall': 0.14559387, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.22822823}
confusion matrix:
      0   1
0  5963  34
1   223  38
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512107_13.png
early stop counter: 3
val acc:0.9671136736869812, best validation acc: 0.9671669006347656, corresponding to test acc:                         0.9606903195381165 / 0.9634068608283997
after epoch: 13,now: 2024-06-20 06:19:02.276059,epoch time: 0:33:01.348940,used: 7:07:48.670539,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_11_13_seed_0_21512107
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.989619, 'precision': 0.98557365, 'recall': 0.9530763, 'specificity': 0.9530763, 'f1': 0.9686189, 'auroc': 0.99502206, 'binary_precision': 0.9806704, 'binary_recall': 0.90801996, 'binary_specificity': 0.99813265, 'binary_f1_score': 0.9429479}
confusion matrix:
       0     1
0  42227    79
1    406  4008
---- Validation: 
scalar performance:
{'acc': 0.96706045, 'precision': 0.7646673, 'recall': 0.5876676, 'specificity': 0.5876676, 'f1': 0.62788457, 'auroc': 0.80627334, 'binary_precision': 0.5576923, 'binary_recall': 0.18040435, 'binary_specificity': 0.99493086, 'binary_f1_score': 0.27262044}
confusion matrix:
       0    1
0  18057   92
1    527  116
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9592522, 'precision': 0.75340986, 'recall': 0.5701289, 'specificity': 0.5701289, 'f1': 0.60433996, 'auroc': 0.79073876, 'binary_precision': 0.54285717, 'binary_recall': 0.14559387, 'binary_specificity': 0.994664, 'binary_f1_score': 0.22960725}
confusion matrix:
      0   1
0  5965  32
1   223  38
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512107_14.png
early stop counter: 4
val acc:0.9670604467391968, best validation acc: 0.9671669006347656, corresponding to test acc:                         0.9606903195381165 / 0.9634068608283997
after epoch: 14,now: 2024-06-20 06:52:16.090890,epoch time: 0:33:13.814831,used: 7:41:02.485370,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_11_13_seed_0_21512107
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9903895, 'precision': 0.9844017, 'recall': 0.95875037, 'specificity': 0.95875037, 'f1': 0.9711375, 'auroc': 0.9955522, 'binary_precision': 0.97711945, 'binary_recall': 0.9197461, 'binary_specificity': 0.99775463, 'binary_f1_score': 0.9475651}
confusion matrix:
       0     1
0  42214    95
1    354  4057
---- Validation: 
scalar performance:
{'acc': 0.96631545, 'precision': 0.7473084, 'recall': 0.58503175, 'specificity': 0.58503175, 'f1': 0.62293017, 'auroc': 0.8045137, 'binary_precision': 0.5231481, 'binary_recall': 0.17573872, 'binary_specificity': 0.99432474, 'binary_f1_score': 0.26309663}
confusion matrix:
       0    1
0  18046  103
1    530  113
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9600511, 'precision': 0.77838147, 'recall': 0.5650488, 'specificity': 0.5650488, 'f1': 0.59912574, 'auroc': 0.78535914, 'binary_precision': 0.59322035, 'binary_recall': 0.13409962, 'binary_specificity': 0.995998, 'binary_f1_score': 0.21875001}
confusion matrix:
      0   1
0  5973  24
1   226  35
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512107_15.png
early stop counter: 5
val acc:0.9663154482841492, best validation acc: 0.9671669006347656, corresponding to test acc:                         0.9606903195381165 / 0.9634068608283997
after epoch: 15,now: 2024-06-20 07:25:35.199431,epoch time: 0:33:19.108541,used: 8:14:21.593911,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_11_13_seed_0_21512107
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9907962, 'precision': 0.9863417, 'recall': 0.9593065, 'specificity': 0.9593065, 'f1': 0.97233856, 'auroc': 0.995824, 'binary_precision': 0.9809271, 'binary_recall': 0.9204803, 'binary_specificity': 0.99813265, 'binary_f1_score': 0.9497429}
confusion matrix:
       0     1
0  42227    79
1    351  4063
---- Validation: 
scalar performance:
{'acc': 0.9669008, 'precision': 0.75880027, 'recall': 0.5950855, 'specificity': 0.5950855, 'f1': 0.63569295, 'auroc': 0.81795514, 'binary_precision': 0.54545456, 'binary_recall': 0.19595645, 'binary_specificity': 0.99421453, 'binary_f1_score': 0.2883295}
confusion matrix:
       0    1
0  18044  105
1    517  126
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959412, 'precision': 0.7595373, 'recall': 0.5647153, 'specificity': 0.5647153, 'f1': 0.5976081, 'auroc': 0.79325867, 'binary_precision': 0.5555556, 'binary_recall': 0.13409962, 'binary_specificity': 0.995331, 'binary_f1_score': 0.2160494}
confusion matrix:
      0   1
0  5969  28
1   226  35
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512107_16.png
early stop counter: 6
val acc:0.9669008255004883, best validation acc: 0.9671669006347656, corresponding to test acc:                         0.9606903195381165 / 0.9634068608283997
after epoch: 16,now: 2024-06-20 07:59:07.043863,epoch time: 0:33:31.844432,used: 8:47:53.438343,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_11_13_seed_0_21512107
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9911815, 'precision': 0.98504686, 'recall': 0.9628754, 'specificity': 0.9628754, 'f1': 0.97363496, 'auroc': 0.9955015, 'binary_precision': 0.977571, 'binary_recall': 0.9279728, 'binary_specificity': 0.99777806, 'binary_f1_score': 0.95212644}
confusion matrix:
       0     1
0  42211    94
1    318  4097
---- Validation: 
scalar performance:
{'acc': 0.96706045, 'precision': 0.76104677, 'recall': 0.60041857, 'specificity': 0.60041857, 'f1': 0.641849, 'auroc': 0.81983525, 'binary_precision': 0.5495868, 'binary_recall': 0.20684293, 'binary_specificity': 0.9939942, 'binary_f1_score': 0.30056497}
confusion matrix:
       0    1
0  18040  109
1    510  133
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.7318888, 'recall': 0.56779635, 'specificity': 0.56779635, 'f1': 0.5997343, 'auroc': 0.79724413, 'binary_precision': 0.5, 'binary_recall': 0.14176245, 'binary_specificity': 0.99383026, 'binary_f1_score': 0.22089553}
confusion matrix:
      0   1
0  5960  37
1   224  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512107_17.png
early stop counter: 7
val acc:0.9670604467391968, best validation acc: 0.9671669006347656, corresponding to test acc:                         0.9606903195381165 / 0.9634068608283997
after epoch: 17,now: 2024-06-20 08:32:45.559664,epoch time: 0:33:38.515801,used: 9:21:31.954144,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_11_13_seed_0_21512107
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99083906, 'precision': 0.98710394, 'recall': 0.95882285, 'specificity': 0.95882285, 'f1': 0.9724325, 'auroc': 0.99595475, 'binary_precision': 0.9825666, 'binary_recall': 0.9193475, 'binary_specificity': 0.9982981, 'binary_f1_score': 0.9499064}
confusion matrix:
       0     1
0  42234    72
1    356  4058
---- Validation: 
scalar performance:
{'acc': 0.9670072, 'precision': 0.764588, 'recall': 0.5838898, 'specificity': 0.5838898, 'f1': 0.62339175, 'auroc': 0.80907905, 'binary_precision': 0.55778897, 'binary_recall': 0.1726283, 'binary_specificity': 0.9951512, 'binary_f1_score': 0.26365796}
confusion matrix:
       0    1
0  18061   88
1    532  111
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.7394076, 'recall': 0.5606338, 'specificity': 0.5606338, 'f1': 0.59091586, 'auroc': 0.79262733, 'binary_precision': 0.515625, 'binary_recall': 0.12643678, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.20307693}
confusion matrix:
      0   1
0  5966  31
1   228  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512107_18.png
early stop counter: 8
val acc:0.9670072197914124, best validation acc: 0.9671669006347656, corresponding to test acc:                         0.9606903195381165 / 0.9634068608283997
after epoch: 18,now: 2024-06-20 09:09:05.462606,epoch time: 0:36:19.902942,used: 9:57:51.857086,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_11_13_seed_0_21512107
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99092466, 'precision': 0.9880041, 'recall': 0.95846426, 'specificity': 0.95846426, 'f1': 0.97265553, 'auroc': 0.9963887, 'binary_precision': 0.98445845, 'binary_recall': 0.9184413, 'binary_specificity': 0.99848723, 'binary_f1_score': 0.9503047}
confusion matrix:
       0     1
0  42242    64
1    360  4054
---- Validation: 
scalar performance:
{'acc': 0.96722007, 'precision': 0.7696669, 'recall': 0.58550006, 'specificity': 0.58550006, 'f1': 0.6258215, 'auroc': 0.81407124, 'binary_precision': 0.5678392, 'binary_recall': 0.17573872, 'binary_specificity': 0.99526143, 'binary_f1_score': 0.26840854}
confusion matrix:
       0    1
0  18063   86
1    530  113
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9592522, 'precision': 0.7582433, 'recall': 0.5573026, 'specificity': 0.5573026, 'f1': 0.5873401, 'auroc': 0.79568136, 'binary_precision': 0.5535714, 'binary_recall': 0.118773945, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.1955836}
confusion matrix:
      0   1
0  5972  25
1   230  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512107_19.png
better model found
persisted
after epoch: 19,now: 2024-06-20 09:47:32.313315,epoch time: 0:38:26.850709,used: 10:36:18.707795,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_11_13_seed_0_21512107
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9910317, 'precision': 0.98546064, 'recall': 0.9615755, 'specificity': 0.9615755, 'f1': 0.97313935, 'auroc': 0.9963782, 'binary_precision': 0.9786775, 'binary_recall': 0.9252548, 'binary_specificity': 0.99789625, 'binary_f1_score': 0.9512167}
confusion matrix:
       0     1
0  42216    89
1    330  4085
---- Validation: 
scalar performance:
{'acc': 0.96722007, 'precision': 0.7649281, 'recall': 0.5990011, 'specificity': 0.5990011, 'f1': 0.64081174, 'auroc': 0.82390076, 'binary_precision': 0.55744684, 'binary_recall': 0.2037325, 'binary_specificity': 0.99426967, 'binary_f1_score': 0.29840547}
confusion matrix:
       0    1
0  18045  104
1    512  131
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581336, 'precision': 0.72803783, 'recall': 0.562216, 'specificity': 0.562216, 'f1': 0.59228027, 'auroc': 0.8007885, 'binary_precision': 0.49275362, 'binary_recall': 0.1302682, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.2060606}
confusion matrix:
      0   1
0  5962  35
1   227  34
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512107_20.png
early stop counter: 1
val acc:0.9672200679779053, best validation acc: 0.9672200679779053, corresponding to test acc:                         0.9592521786689758 / 0.9634068608283997
after epoch: 20,now: 2024-06-20 10:27:34.256517,epoch time: 0:40:01.943202,used: 11:16:20.650997,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_11_13_seed_0_21512107
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9921661, 'precision': 0.9887861, 'recall': 0.9650265, 'specificity': 0.9650265, 'f1': 0.9765345, 'auroc': 0.99682873, 'binary_precision': 0.98467064, 'binary_recall': 0.9315658, 'binary_specificity': 0.99848723, 'binary_f1_score': 0.9573824}
confusion matrix:
       0     1
0  42243    64
1    302  4111
---- Validation: 
scalar performance:
{'acc': 0.96722007, 'precision': 0.770312, 'recall': 0.584, 'specificity': 0.584, 'f1': 0.62407637, 'auroc': 0.8173708, 'binary_precision': 0.5692308, 'binary_recall': 0.1726283, 'binary_specificity': 0.99537164, 'binary_f1_score': 0.26491648}
confusion matrix:
       0    1
0  18065   84
1    532  111
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.7410728, 'recall': 0.54780746, 'specificity': 0.54780746, 'f1': 0.5729909, 'auroc': 0.7853633, 'binary_precision': 0.52, 'binary_recall': 0.099616855, 'binary_specificity': 0.995998, 'binary_f1_score': 0.16720255}
confusion matrix:
      0   1
0  5973  24
1   235  26
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512107_21.png
early stop counter: 2
val acc:0.9672200679779053, best validation acc: 0.9672200679779053, corresponding to test acc:                         0.9592521786689758 / 0.9634068608283997
after epoch: 21,now: 2024-06-20 11:11:59.059415,epoch time: 0:44:24.802898,used: 12:00:45.453895,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_11_13_seed_0_21512107
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.991845, 'precision': 0.9858958, 'recall': 0.965973, 'specificity': 0.965973, 'f1': 0.97567207, 'auroc': 0.99644434, 'binary_precision': 0.9786376, 'binary_recall': 0.9340734, 'binary_specificity': 0.99787265, 'binary_f1_score': 0.95583636}
confusion matrix:
       0     1
0  42216    90
1    291  4123
---- Validation: 
scalar performance:
{'acc': 0.9665283, 'precision': 0.74996877, 'recall': 0.60164315, 'specificity': 0.60164315, 'f1': 0.6415938, 'auroc': 0.8232304, 'binary_precision': 0.52734375, 'binary_recall': 0.20995334, 'binary_specificity': 0.993333, 'binary_f1_score': 0.3003337}
confusion matrix:
       0    1
0  18028  121
1    508  135
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95733464, 'precision': 0.71073794, 'recall': 0.5599668, 'specificity': 0.5599668, 'f1': 0.5881412, 'auroc': 0.80330646, 'binary_precision': 0.45833334, 'binary_recall': 0.12643678, 'binary_specificity': 0.9934968, 'binary_f1_score': 0.1981982}
confusion matrix:
      0   1
0  5958  39
1   228  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512107_22.png
early stop counter: 3
val acc:0.9665282964706421, best validation acc: 0.9672200679779053, corresponding to test acc:                         0.9592521786689758 / 0.9634068608283997
after epoch: 22,now: 2024-06-20 11:54:55.535484,epoch time: 0:42:56.476069,used: 12:43:41.929964,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_11_13_seed_0_21512107
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99248713, 'precision': 0.98622334, 'recall': 0.9694794, 'specificity': 0.9694794, 'f1': 0.9776666, 'auroc': 0.99759686, 'binary_precision': 0.9785681, 'binary_recall': 0.94110984, 'binary_specificity': 0.9978489, 'binary_f1_score': 0.9594735}
confusion matrix:
       0     1
0  42214    91
1    260  4155
---- Validation: 
scalar performance:
{'acc': 0.9663687, 'precision': 0.7469125, 'recall': 0.6015605, 'specificity': 0.6015605, 'f1': 0.6410528, 'auroc': 0.82727087, 'binary_precision': 0.5212355, 'binary_recall': 0.20995334, 'binary_specificity': 0.99316764, 'binary_f1_score': 0.2993348}
confusion matrix:
       0    1
0  18025  124
1    508  135
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579738, 'precision': 0.72505116, 'recall': 0.56579727, 'specificity': 0.56579727, 'f1': 0.5966672, 'auroc': 0.8018078, 'binary_precision': 0.4864865, 'binary_recall': 0.13793103, 'binary_specificity': 0.9936635, 'binary_f1_score': 0.21492536}
confusion matrix:
      0   1
0  5959  38
1   225  36
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512107_23.png
early stop counter: 4
val acc:0.9663686752319336, best validation acc: 0.9672200679779053, corresponding to test acc:                         0.9592521786689758 / 0.9634068608283997
after epoch: 23,now: 2024-06-20 12:34:46.454856,epoch time: 0:39:50.919372,used: 13:23:32.849336,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_11_13_seed_0_21512107
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9925086, 'precision': 0.990675, 'recall': 0.9651769, 'specificity': 0.9651769, 'f1': 0.977499, 'auroc': 0.9967867, 'binary_precision': 0.98844486, 'binary_recall': 0.9314882, 'binary_specificity': 0.99886554, 'binary_f1_score': 0.9591217}
confusion matrix:
       0     1
0  42264    48
1    302  4106
---- Validation: 
scalar performance:
{'acc': 0.9672733, 'precision': 0.7673282, 'recall': 0.5952783, 'specificity': 0.5952783, 'f1': 0.63695383, 'auroc': 0.8290043, 'binary_precision': 0.5625, 'binary_recall': 0.19595645, 'binary_specificity': 0.99460024, 'binary_f1_score': 0.29065743}
confusion matrix:
       0    1
0  18051   98
1    517  126
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.7441605, 'recall': 0.5570525, 'specificity': 0.5570525, 'f1': 0.58629775, 'auroc': 0.79965013, 'binary_precision': 0.5254237, 'binary_recall': 0.118773945, 'binary_specificity': 0.995331, 'binary_f1_score': 0.19375001}
confusion matrix:
      0   1
0  5969  28
1   230  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512107_24.png
better model found
persisted
after epoch: 24,now: 2024-06-20 13:12:51.311423,epoch time: 0:38:04.856567,used: 14:01:37.705903,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_11_13_seed_0_21512107
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.991738, 'precision': 0.9870583, 'recall': 0.9641892, 'specificity': 0.9641892, 'f1': 0.97527814, 'auroc': 0.9970562, 'binary_precision': 0.9813576, 'binary_recall': 0.93022203, 'binary_specificity': 0.9981563, 'binary_f1_score': 0.95510584}
confusion matrix:
       0     1
0  42228    78
1    308  4106
---- Validation: 
scalar performance:
{'acc': 0.9667944, 'precision': 0.75462735, 'recall': 0.6055312, 'specificity': 0.6055312, 'f1': 0.64636123, 'auroc': 0.83212787, 'binary_precision': 0.5363985, 'binary_recall': 0.21772939, 'binary_specificity': 0.993333, 'binary_f1_score': 0.30973452}
confusion matrix:
       0    1
0  18028  121
1    503  140
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9574944, 'precision': 0.71276796, 'recall': 0.55638546, 'specificity': 0.55638546, 'f1': 0.5835998, 'auroc': 0.80452645, 'binary_precision': 0.46268657, 'binary_recall': 0.118773945, 'binary_specificity': 0.993997, 'binary_f1_score': 0.18902439}
confusion matrix:
      0   1
0  5961  36
1   230  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512107_25.png
early stop counter: 1
val acc:0.9667943716049194, best validation acc: 0.9672732949256897, corresponding to test acc:                         0.9587727785110474 / 0.9634068608283997
after epoch: 25,now: 2024-06-20 13:51:23.715821,epoch time: 0:38:32.404398,used: 14:40:10.110301,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_11_13_seed_0_21512107
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99205905, 'precision': 0.9889264, 'recall': 0.96424913, 'specificity': 0.96424913, 'f1': 0.9761865, 'auroc': 0.99735296, 'binary_precision': 0.98511404, 'binary_recall': 0.9299637, 'binary_specificity': 0.99853456, 'binary_f1_score': 0.9567448}
confusion matrix:
       0     1
0  42246    62
1    309  4103
---- Validation: 
scalar performance:
{'acc': 0.9667944, 'precision': 0.7577575, 'recall': 0.58902997, 'specificity': 0.58902997, 'f1': 0.6287135, 'auroc': 0.82295847, 'binary_precision': 0.5437788, 'binary_recall': 0.18351477, 'binary_specificity': 0.99454516, 'binary_f1_score': 0.2744186}
confusion matrix:
       0    1
0  18050   99
1    525  118
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.73609734, 'recall': 0.54589176, 'specificity': 0.54589176, 'f1': 0.5699946, 'auroc': 0.8000183, 'binary_precision': 0.5102041, 'binary_recall': 0.09578544, 'binary_specificity': 0.995998, 'binary_f1_score': 0.16129032}
confusion matrix:
      0   1
0  5973  24
1   236  25
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512107_26.png
early stop counter: 2
val acc:0.9667943716049194, best validation acc: 0.9672732949256897, corresponding to test acc:                         0.9587727785110474 / 0.9634068608283997
after epoch: 26,now: 2024-06-20 14:35:47.697206,epoch time: 0:44:23.981385,used: 15:24:34.091686,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_11_13_seed_0_21512107
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9922303, 'precision': 0.98727715, 'recall': 0.9669032, 'specificity': 0.9669032, 'f1': 0.97681653, 'auroc': 0.99635255, 'binary_precision': 0.98123515, 'binary_recall': 0.93567383, 'binary_specificity': 0.9981326, 'binary_f1_score': 0.95791304}
confusion matrix:
       0     1
0  42226    79
1    284  4131
---- Validation: 
scalar performance:
{'acc': 0.9668476, 'precision': 0.7574651, 'recall': 0.595808, 'specificity': 0.595808, 'f1': 0.6363257, 'auroc': 0.82570827, 'binary_precision': 0.54273504, 'binary_recall': 0.19751166, 'binary_specificity': 0.9941044, 'binary_f1_score': 0.2896237}
confusion matrix:
       0    1
0  18042  107
1    516  127
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579738, 'precision': 0.7239326, 'recall': 0.5584679, 'specificity': 0.5584679, 'f1': 0.58707094, 'auroc': 0.79827124, 'binary_precision': 0.4848485, 'binary_recall': 0.12260536, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.19571865}
confusion matrix:
      0   1
0  5963  34
1   229  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512107_27.png
early stop counter: 3
val acc:0.9668475985527039, best validation acc: 0.9672732949256897, corresponding to test acc:                         0.9587727785110474 / 0.9634068608283997
after epoch: 27,now: 2024-06-20 15:21:38.032339,epoch time: 0:45:50.335133,used: 16:10:24.426819,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_11_13_seed_0_21512107
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9925514, 'precision': 0.9906032, 'recall': 0.9655514, 'specificity': 0.9655514, 'f1': 0.9776652, 'auroc': 0.99697447, 'binary_precision': 0.9882325, 'binary_recall': 0.932261, 'binary_specificity': 0.99884176, 'binary_f1_score': 0.9594311}
confusion matrix:
       0     1
0  42257    49
1    299  4115
---- Validation: 
scalar performance:
{'acc': 0.96722007, 'precision': 0.7699859, 'recall': 0.58475006, 'specificity': 0.58475006, 'f1': 0.624951, 'auroc': 0.82725203, 'binary_precision': 0.56852794, 'binary_recall': 0.17418352, 'binary_specificity': 0.99531657, 'binary_f1_score': 0.26666668}
confusion matrix:
       0    1
0  18064   85
1    531  112
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581336, 'precision': 0.7263467, 'recall': 0.5475573, 'specificity': 0.5475573, 'f1': 0.5720666, 'auroc': 0.80596924, 'binary_precision': 0.49056605, 'binary_recall': 0.099616855, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.16560508}
confusion matrix:
      0   1
0  5970  27
1   235  26
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512107_28.png
early stop counter: 4
val acc:0.9672200679779053, best validation acc: 0.9672732949256897, corresponding to test acc:                         0.9587727785110474 / 0.9634068608283997
after epoch: 28,now: 2024-06-20 15:44:29.343176,epoch time: 0:22:51.310837,used: 16:33:15.737656,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_11_13_seed_0_21512107
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9926156, 'precision': 0.9892811, 'recall': 0.9672174, 'specificity': 0.9672174, 'f1': 0.97792935, 'auroc': 0.9969881, 'binary_precision': 0.985217, 'binary_recall': 0.93590033, 'binary_specificity': 0.99853444, 'binary_f1_score': 0.95992565}
confusion matrix:
       0     1
0  42243    62
1    283  4132
---- Validation: 
scalar performance:
{'acc': 0.96663475, 'precision': 0.7516676, 'recall': 0.6046985, 'specificity': 0.6046985, 'f1': 0.645044, 'auroc': 0.8327509, 'binary_precision': 0.5305343, 'binary_recall': 0.21617419, 'binary_specificity': 0.9932228, 'binary_f1_score': 0.3071823}
confusion matrix:
       0    1
0  18026  123
1    504  139
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9576542, 'precision': 0.71729153, 'recall': 0.5601335, 'specificity': 0.5601335, 'f1': 0.58882385, 'auroc': 0.8039155, 'binary_precision': 0.47142857, 'binary_recall': 0.12643678, 'binary_specificity': 0.99383026, 'binary_f1_score': 0.19939578}
confusion matrix:
      0   1
0  5960  37
1   228  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512107_29.png
early stop counter: 5
val acc:0.9666347503662109, best validation acc: 0.9672732949256897, corresponding to test acc:                         0.9587727785110474 / 0.9634068608283997
after epoch: 29,now: 2024-06-20 16:10:13.719580,epoch time: 0:25:44.376404,used: 16:59:00.114060,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_11_13_seed_0_21512107
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9921019, 'precision': 0.98749447, 'recall': 0.96588945, 'specificity': 0.96588945, 'f1': 0.97638416, 'auroc': 0.9968813, 'binary_precision': 0.9818789, 'binary_recall': 0.93357515, 'binary_specificity': 0.9982037, 'binary_f1_score': 0.957118}
confusion matrix:
       0     1
0  42233    76
1    293  4118
---- Validation: 
scalar performance:
{'acc': 0.9668476, 'precision': 0.75553834, 'recall': 0.6063088, 'specificity': 0.6063088, 'f1': 0.64730847, 'auroc': 0.84106135, 'binary_precision': 0.53816795, 'binary_recall': 0.21928461, 'binary_specificity': 0.993333, 'binary_f1_score': 0.31160223}
confusion matrix:
       0    1
0  18028  121
1    502  141
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95669544, 'precision': 0.69204825, 'recall': 0.5486393, 'specificity': 0.5486393, 'f1': 0.5719621, 'auroc': 0.80306166, 'binary_precision': 0.421875, 'binary_recall': 0.10344828, 'binary_specificity': 0.99383026, 'binary_f1_score': 0.16615385}
confusion matrix:
      0   1
0  5960  37
1   234  27
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512107_30.png
early stop counter: 6
val acc:0.9668475985527039, best validation acc: 0.9672732949256897, corresponding to test acc:                         0.9587727785110474 / 0.9634068608283997
after epoch: 30,now: 2024-06-20 16:31:59.181013,epoch time: 0:21:45.461433,used: 17:20:45.575493,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_11_13_seed_0_21512107
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 17:20:45.575493 at 2024-06-20 16:31:59.181013
persisted model performance metric: 

scalar performance:
{'acc': 0.9587728, 'precision': 0.7441605, 'recall': 0.5570525, 'specificity': 0.5570525, 'f1': 0.58629775, 'auroc': 0.79965013, 'binary_precision': 0.5254237, 'binary_recall': 0.118773945, 'binary_specificity': 0.995331, 'binary_f1_score': 0.19375001}
confusion matrix:
      0   1
0  5969  28
1   230  31
oracle model performance metric: 

scalar performance:
{'acc': 0.96340686, 'precision': 0.8246206, 'recall': 0.612608, 'specificity': 0.612608, 'f1': 0.6625091, 'auroc': 0.791664, 'binary_precision': 0.6818182, 'binary_recall': 0.22988506, 'binary_specificity': 0.995331, 'binary_f1_score': 0.34383956}
confusion matrix:
      0   1
0  5969  28
1   201  60
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_irm_resnet_different_bs128_lre4_classbalancing/rule_results/2.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_irm_resnet_different_bs128_lre4_classbalancing/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_irm_resnet_different_bs128_lre4_classbalancing/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204097 KiB |   1730 MiB | 377598 GiB | 377597 GiB |
|       from large pool | 167936 KiB |   1660 MiB | 377491 GiB | 377491 GiB |
|       from small pool |  36161 KiB |     72 MiB |    106 GiB |    106 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 204097 KiB |   1730 MiB | 377598 GiB | 377597 GiB |
|       from large pool | 167936 KiB |   1660 MiB | 377491 GiB | 377491 GiB |
|       from small pool |  36161 KiB |     72 MiB |    106 GiB |    106 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201088 KiB |   1723 MiB | 377581 GiB | 377581 GiB |
|       from large pool | 165120 KiB |   1653 MiB | 377477 GiB | 377477 GiB |
|       from small pool |  35968 KiB |     71 MiB |    104 GiB |    104 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1876 MiB |   1876 MiB |   1876 MiB |      0 B   |
|       from large pool |   1802 MiB |   1802 MiB |   1802 MiB |      0 B   |
|       from small pool |     74 MiB |     74 MiB |     74 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 404158 KiB | 758032 KiB | 265696 GiB | 265696 GiB |
|       from large pool | 397312 KiB | 756864 KiB | 265587 GiB | 265586 GiB |
|       from small pool |   6846 KiB |  12716 KiB |    109 GiB |    109 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1194    |    1851    |   11324 K  |   11323 K  |
|       from large pool |      36    |      76    |    3587 K  |    3587 K  |
|       from small pool |    1158    |    1780    |    7736 K  |    7735 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1194    |    1851    |   11324 K  |   11323 K  |
|       from large pool |      36    |      76    |    3587 K  |    3587 K  |
|       from small pool |    1158    |    1780    |    7736 K  |    7735 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      50    |      50    |      50    |       0    |
|       from large pool |      13    |      13    |      13    |       0    |
|       from small pool |      37    |      37    |      37    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      28    |     378    |    5676 K  |    5676 K  |
|       from large pool |       5    |      10    |    1353 K  |    1353 K  |
|       from small pool |      23    |     373    |    4323 K  |    4323 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1730 MiB | 377598 GiB | 377598 GiB |
|       from large pool |  16640 KiB |   1660 MiB | 377491 GiB | 377491 GiB |
|       from small pool |      0 KiB |     72 MiB |    106 GiB |    106 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1730 MiB | 377598 GiB | 377598 GiB |
|       from large pool |  16640 KiB |   1660 MiB | 377491 GiB | 377491 GiB |
|       from small pool |      0 KiB |     72 MiB |    106 GiB |    106 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1723 MiB | 377581 GiB | 377581 GiB |
|       from large pool |  16640 KiB |   1653 MiB | 377477 GiB | 377477 GiB |
|       from small pool |      0 KiB |     71 MiB |    104 GiB |    104 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 608256 KiB |   1876 MiB |   1876 MiB |   1282 MiB |
|       from large pool | 565248 KiB |   1802 MiB |   1802 MiB |   1250 MiB |
|       from small pool |  43008 KiB |     74 MiB |     74 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 384768 KiB | 758032 KiB | 265696 GiB | 265696 GiB |
|       from large pool | 384768 KiB | 756864 KiB | 265587 GiB | 265586 GiB |
|       from small pool |      0 KiB |  14441 KiB |    109 GiB |    109 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1851    |   11324 K  |   11324 K  |
|       from large pool |       2    |      76    |    3587 K  |    3587 K  |
|       from small pool |       0    |    1780    |    7736 K  |    7736 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1851    |   11324 K  |   11324 K  |
|       from large pool |       2    |      76    |    3587 K  |    3587 K  |
|       from small pool |       0    |    1780    |    7736 K  |    7736 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      30    |      50    |      50    |      20    |
|       from large pool |       9    |      13    |      13    |       4    |
|       from small pool |      21    |      37    |      37    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     378    |    5676 K  |    5676 K  |
|       from large pool |       1    |      11    |    1353 K  |    1353 K  |
|       from small pool |       0    |     373    |    4323 K  |    4323 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1730 MiB | 377598 GiB | 377598 GiB |
|       from large pool |  16640 KiB |   1660 MiB | 377491 GiB | 377491 GiB |
|       from small pool |      0 KiB |     72 MiB |    106 GiB |    106 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1730 MiB | 377598 GiB | 377598 GiB |
|       from large pool |  16640 KiB |   1660 MiB | 377491 GiB | 377491 GiB |
|       from small pool |      0 KiB |     72 MiB |    106 GiB |    106 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1723 MiB | 377581 GiB | 377581 GiB |
|       from large pool |  16640 KiB |   1653 MiB | 377477 GiB | 377477 GiB |
|       from small pool |      0 KiB |     71 MiB |    104 GiB |    104 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 608256 KiB |   1876 MiB |   1876 MiB |   1282 MiB |
|       from large pool | 565248 KiB |   1802 MiB |   1802 MiB |   1250 MiB |
|       from small pool |  43008 KiB |     74 MiB |     74 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 384768 KiB | 758032 KiB | 265696 GiB | 265696 GiB |
|       from large pool | 384768 KiB | 756864 KiB | 265587 GiB | 265586 GiB |
|       from small pool |      0 KiB |  14441 KiB |    109 GiB |    109 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1851    |   11324 K  |   11324 K  |
|       from large pool |       2    |      76    |    3587 K  |    3587 K  |
|       from small pool |       0    |    1780    |    7736 K  |    7736 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1851    |   11324 K  |   11324 K  |
|       from large pool |       2    |      76    |    3587 K  |    3587 K  |
|       from small pool |       0    |    1780    |    7736 K  |    7736 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      30    |      50    |      50    |      20    |
|       from large pool |       9    |      13    |      13    |       4    |
|       from small pool |      21    |      37    |      37    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     378    |    5676 K  |    5676 K  |
|       from large pool |       1    |      11    |    1353 K  |    1353 K  |
|       from small pool |       0    |     373    |    4323 K  |    4323 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0




!!!: not committed yet



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_38_28_seed_1_21512107

 Experiment start at: 2024-06-20 16:38:28.116803
before training, model accuracy: 0.1456654816865921
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9364512, 'precision': 0.92369676, 'recall': 0.6723065, 'specificity': 0.6723065, 'f1': 0.7348237, 'auroc': 0.9344106, 'binary_precision': 0.9099698, 'binary_recall': 0.3481276, 'binary_specificity': 0.99648535, 'binary_f1_score': 0.5035947}
confusion matrix:
       0     1
0  42245   149
1   2820  1506
---- Validation: 
scalar performance:
{'acc': 0.9636606, 'precision': 0.48203608, 'recall': 0.4997786, 'specificity': 0.4997786, 'f1': 0.49074703, 'auroc': 0.51761717, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9995572, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18059  8
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.5262311, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512107_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-20 16:59:27.889011,epoch time: 0:20:59.772208,used: 0:20:59.772208,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_38_28_seed_1_21512107
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96680224, 'precision': 0.97786546, 'recall': 0.8234966, 'specificity': 0.8234966, 'f1': 0.88259643, 'auroc': 0.9729059, 'binary_precision': 0.9904526, 'binary_recall': 0.64763004, 'binary_specificity': 0.9993631, 'binary_f1_score': 0.78316784}
confusion matrix:
       0     1
0  42368    27
1   1524  2801
---- Validation: 
scalar performance:
{'acc': 0.9648346, 'precision': 0.85757804, 'recall': 0.51540804, 'specificity': 0.51540804, 'f1': 0.5209983, 'auroc': 0.63260055, 'binary_precision': 0.75, 'binary_recall': 0.031203566, 'binary_specificity': 0.99961257, 'binary_f1_score': 0.059914406}
confusion matrix:
       0   1
0  18060   7
1    652  21
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9574605, 'precision': 0.60418683, 'recall': 0.5033416, 'specificity': 0.5033416, 'f1': 0.49659312, 'auroc': 0.6871749, 'binary_precision': 0.25, 'binary_recall': 0.0076923077, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.014925373}
confusion matrix:
      0  1
0  5940  6
1   258  2
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512107_2.png
better model found
persisted
after epoch: 2,now: 2024-06-20 17:16:17.318980,epoch time: 0:16:49.429969,used: 0:37:49.202177,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_38_28_seed_1_21512107
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97816783, 'precision': 0.98001736, 'recall': 0.88833666, 'specificity': 0.88833666, 'f1': 0.92820823, 'auroc': 0.98238885, 'binary_precision': 0.9821846, 'binary_recall': 0.778112, 'binary_specificity': 0.99856126, 'binary_f1_score': 0.86831915}
confusion matrix:
       0     1
0  42337    61
1    959  3363
---- Validation: 
scalar performance:
{'acc': 0.965635, 'precision': 0.7878209, 'recall': 0.5594545, 'specificity': 0.5594545, 'f1': 0.5927046, 'auroc': 0.70194507, 'binary_precision': 0.6074074, 'binary_recall': 0.121842496, 'binary_specificity': 0.9970665, 'binary_f1_score': 0.2029703}
confusion matrix:
       0   1
0  18014  53
1    591  82
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96003866, 'precision': 0.8142085, 'recall': 0.5451448, 'specificity': 0.5451448, 'f1': 0.5708467, 'auroc': 0.7477789, 'binary_precision': 0.6666667, 'binary_recall': 0.092307694, 'binary_specificity': 0.99798185, 'binary_f1_score': 0.16216217}
confusion matrix:
      0   1
0  5934  12
1   236  24
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512107_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-20 17:33:47.154995,epoch time: 0:17:29.836015,used: 0:55:19.038192,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_38_28_seed_1_21512107
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9803724, 'precision': 0.981578, 'recall': 0.90024006, 'specificity': 0.90024006, 'f1': 0.93627226, 'auroc': 0.9860519, 'binary_precision': 0.982998, 'binary_recall': 0.8018955, 'binary_specificity': 0.9985847, 'binary_f1_score': 0.8832591}
confusion matrix:
       0     1
0  42334    60
1    857  3469
---- Validation: 
scalar performance:
{'acc': 0.966222, 'precision': 0.79943955, 'recall': 0.5704879, 'specificity': 0.5704879, 'f1': 0.60865635, 'auroc': 0.7227552, 'binary_precision': 0.6298701, 'binary_recall': 0.14413075, 'binary_specificity': 0.99684507, 'binary_f1_score': 0.23458283}
confusion matrix:
       0   1
0  18010  57
1    576  97
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96165, 'precision': 0.8512211, 'recall': 0.5643755, 'specificity': 0.5643755, 'f1': 0.6012813, 'auroc': 0.75201607, 'binary_precision': 0.73913044, 'binary_recall': 0.13076924, 'binary_specificity': 0.99798185, 'binary_f1_score': 0.22222224}
confusion matrix:
      0   1
0  5934  12
1   226  34
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512107_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-20 17:49:58.930776,epoch time: 0:16:11.775781,used: 1:11:30.813973,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_38_28_seed_1_21512107
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9838827, 'precision': 0.98180306, 'recall': 0.92092353, 'specificity': 0.92092353, 'f1': 0.94881487, 'auroc': 0.9899559, 'binary_precision': 0.9793289, 'binary_recall': 0.8436633, 'binary_specificity': 0.9981838, 'binary_f1_score': 0.906448}
confusion matrix:
       0     1
0  42319    77
1    676  3648
---- Validation: 
scalar performance:
{'acc': 0.96627533, 'precision': 0.79031515, 'recall': 0.58195984, 'specificity': 0.58195984, 'f1': 0.6230729, 'auroc': 0.75972486, 'binary_precision': 0.6108108, 'binary_recall': 0.1679049, 'binary_specificity': 0.99601483, 'binary_f1_score': 0.26340327}
confusion matrix:
       0    1
0  17995   72
1    560  113
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96310025, 'precision': 0.86386776, 'recall': 0.58536124, 'specificity': 0.58536124, 'f1': 0.6315975, 'auroc': 0.7845048, 'binary_precision': 0.7627119, 'binary_recall': 0.17307693, 'binary_specificity': 0.9976455, 'binary_f1_score': 0.28213164}
confusion matrix:
      0   1
0  5932  14
1   215  45
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512107_5.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-06-20 18:05:43.454223,epoch time: 0:15:44.523447,used: 1:27:15.337420,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_38_28_seed_1_21512107
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98467463, 'precision': 0.9819833, 'recall': 0.92553043, 'specificity': 0.92553043, 'f1': 0.95157504, 'auroc': 0.98938787, 'binary_precision': 0.9787742, 'binary_recall': 0.85294795, 'binary_specificity': 0.998113, 'binary_f1_score': 0.91153944}
confusion matrix:
       0     1
0  42315    80
1    636  3689
---- Validation: 
scalar performance:
{'acc': 0.9663287, 'precision': 0.7876133, 'recall': 0.58770967, 'specificity': 0.58770967, 'f1': 0.62998396, 'auroc': 0.7690885, 'binary_precision': 0.605, 'binary_recall': 0.17979197, 'binary_specificity': 0.9956274, 'binary_f1_score': 0.27720505}
confusion matrix:
       0    1
0  17988   79
1    552  121
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96471155, 'precision': 0.870193, 'recall': 0.6101089, 'specificity': 0.6101089, 'f1': 0.6640675, 'auroc': 0.78852165, 'binary_precision': 0.7733333, 'binary_recall': 0.22307692, 'binary_specificity': 0.99714094, 'binary_f1_score': 0.34626865}
confusion matrix:
      0   1
0  5929  17
1   202  58
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512107_6.png
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-06-20 18:22:49.685892,epoch time: 0:17:06.231669,used: 1:44:21.569089,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_38_28_seed_1_21512107
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98559505, 'precision': 0.9797828, 'recall': 0.933112, 'specificity': 0.933112, 'f1': 0.9549611, 'auroc': 0.9929285, 'binary_precision': 0.97281903, 'binary_recall': 0.86870086, 'binary_specificity': 0.99752325, 'binary_f1_score': 0.9178166}
confusion matrix:
       0     1
0  42289   105
1    568  3758
---- Validation: 
scalar performance:
{'acc': 0.96600854, 'precision': 0.7761953, 'recall': 0.5925505, 'specificity': 0.5925505, 'f1': 0.63463175, 'auroc': 0.7819737, 'binary_precision': 0.58181816, 'binary_recall': 0.19019316, 'binary_specificity': 0.99490786, 'binary_f1_score': 0.2866741}
confusion matrix:
       0    1
0  17975   92
1    545  128
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96471155, 'precision': 0.8544961, 'recall': 0.6193039, 'specificity': 0.6193039, 'f1': 0.6735344, 'auroc': 0.81146467, 'binary_precision': 0.7411765, 'binary_recall': 0.2423077, 'binary_specificity': 0.99630004, 'binary_f1_score': 0.3652174}
confusion matrix:
      0   1
0  5924  22
1   197  63
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512107_7.png
early stop counter: 1
val acc:0.9660085439682007, best validation acc: 0.9663286805152893, corresponding to test acc:                         0.9647115468978882 / 0.9647115468978882
after epoch: 7,now: 2024-06-20 18:39:00.950987,epoch time: 0:16:11.265095,used: 2:00:32.834184,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_38_28_seed_1_21512107
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98557365, 'precision': 0.98303354, 'recall': 0.9299228, 'specificity': 0.9299228, 'f1': 0.9545578, 'auroc': 0.99142456, 'binary_precision': 0.98, 'binary_recall': 0.8616381, 'binary_specificity': 0.99820745, 'binary_f1_score': 0.9170155}
confusion matrix:
       0     1
0  42322    76
1    598  3724
---- Validation: 
scalar performance:
{'acc': 0.966809, 'precision': 0.80469126, 'recall': 0.5850977, 'specificity': 0.5850977, 'f1': 0.6281905, 'auroc': 0.7710595, 'binary_precision': 0.6393443, 'binary_recall': 0.17384844, 'binary_specificity': 0.99634695, 'binary_f1_score': 0.27336445}
confusion matrix:
       0    1
0  18001   66
1    556  117
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9639059, 'precision': 0.85820836, 'recall': 0.60233253, 'specificity': 0.60233253, 'f1': 0.6533791, 'auroc': 0.7874317, 'binary_precision': 0.75, 'binary_recall': 0.20769231, 'binary_specificity': 0.99697274, 'binary_f1_score': 0.3253012}
confusion matrix:
      0   1
0  5928  18
1   206  54
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512107_8.png
better model found
persisted
after epoch: 8,now: 2024-06-20 18:55:55.207775,epoch time: 0:16:54.256788,used: 2:17:27.090972,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_38_28_seed_1_21512107
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98784244, 'precision': 0.9835288, 'recall': 0.9431336, 'specificity': 0.9431336, 'f1': 0.9622338, 'auroc': 0.99264276, 'binary_precision': 0.97834396, 'binary_recall': 0.88827205, 'binary_specificity': 0.99799514, 'binary_f1_score': 0.9311348}
confusion matrix:
       0     1
0  42312    85
1    483  3840
---- Validation: 
scalar performance:
{'acc': 0.9670224, 'precision': 0.7962044, 'recall': 0.6023748, 'specificity': 0.6023748, 'f1': 0.6482194, 'auroc': 0.7899647, 'binary_precision': 0.62114537, 'binary_recall': 0.20950966, 'binary_specificity': 0.9952399, 'binary_f1_score': 0.31333333}
confusion matrix:
       0    1
0  17981   86
1    532  141
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96406704, 'precision': 0.8356222, 'recall': 0.6208065, 'specificity': 0.6208065, 'f1': 0.67309153, 'auroc': 0.8058467, 'binary_precision': 0.7032967, 'binary_recall': 0.24615385, 'binary_specificity': 0.99545914, 'binary_f1_score': 0.36467236}
confusion matrix:
      0   1
0  5919  27
1   196  64
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512107_9.png
better model found
persisted
after epoch: 9,now: 2024-06-20 19:13:00.914223,epoch time: 0:17:05.706448,used: 2:34:32.797420,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_38_28_seed_1_21512107
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9883562, 'precision': 0.9835461, 'recall': 0.9462332, 'specificity': 0.9462332, 'f1': 0.96395576, 'auroc': 0.9933393, 'binary_precision': 0.9777553, 'binary_recall': 0.8945421, 'binary_specificity': 0.9979243, 'binary_f1_score': 0.9342995}
confusion matrix:
       0     1
0  42308    88
1    456  3868
---- Validation: 
scalar performance:
{'acc': 0.9667022, 'precision': 0.799883, 'recall': 0.58647287, 'specificity': 0.58647287, 'f1': 0.62953067, 'auroc': 0.7893799, 'binary_precision': 0.6296296, 'binary_recall': 0.1768202, 'binary_specificity': 0.9961255, 'binary_f1_score': 0.2761021}
confusion matrix:
       0    1
0  17997   70
1    554  119
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9622946, 'precision': 0.818479, 'recall': 0.5959747, 'specificity': 0.5959747, 'f1': 0.64209706, 'auroc': 0.7950865, 'binary_precision': 0.67105263, 'binary_recall': 0.19615385, 'binary_specificity': 0.9957955, 'binary_f1_score': 0.30357143}
confusion matrix:
      0   1
0  5921  25
1   209  51
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512107_10.png
early stop counter: 1
val acc:0.9667022228240967, best validation acc: 0.9670224189758301, corresponding to test acc:                         0.9640670418739319 / 0.9647115468978882
after epoch: 10,now: 2024-06-20 19:31:04.540934,epoch time: 0:18:03.626711,used: 2:52:36.424131,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_38_28_seed_1_21512107
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.988292, 'precision': 0.9856043, 'recall': 0.94391334, 'specificity': 0.94391334, 'f1': 0.9635942, 'auroc': 0.99331886, 'binary_precision': 0.9823755, 'binary_recall': 0.8894542, 'binary_specificity': 0.9983725, 'binary_f1_score': 0.9336084}
confusion matrix:
       0     1
0  42327    69
1    478  3846
---- Validation: 
scalar performance:
{'acc': 0.96643543, 'precision': 0.7941026, 'recall': 0.58347344, 'specificity': 0.58347344, 'f1': 0.62528867, 'auroc': 0.795887, 'binary_precision': 0.6182796, 'binary_recall': 0.17087667, 'binary_specificity': 0.9960702, 'binary_f1_score': 0.26775318}
confusion matrix:
       0    1
0  17996   71
1    558  115
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9618111, 'precision': 0.8265243, 'recall': 0.57917154, 'specificity': 0.57917154, 'f1': 0.62104046, 'auroc': 0.8117632, 'binary_precision': 0.6885246, 'binary_recall': 0.16153847, 'binary_specificity': 0.9968046, 'binary_f1_score': 0.26168224}
confusion matrix:
      0   1
0  5927  19
1   218  42
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512107_11.png
early stop counter: 2
val acc:0.966435432434082, best validation acc: 0.9670224189758301, corresponding to test acc:                         0.9640670418739319 / 0.9647115468978882
after epoch: 11,now: 2024-06-20 19:48:15.007179,epoch time: 0:17:10.466245,used: 3:09:46.890376,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_38_28_seed_1_21512107
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98874146, 'precision': 0.9820827, 'recall': 0.9499873, 'specificity': 0.9499873, 'f1': 0.9653447, 'auroc': 0.99568415, 'binary_precision': 0.9740454, 'binary_recall': 0.90242773, 'binary_specificity': 0.99754685, 'binary_f1_score': 0.9368698}
confusion matrix:
       0     1
0  42291   104
1    422  3903
---- Validation: 
scalar performance:
{'acc': 0.9668623, 'precision': 0.8015239, 'recall': 0.59013224, 'specificity': 0.59013224, 'f1': 0.63421166, 'auroc': 0.7995871, 'binary_precision': 0.63265306, 'binary_recall': 0.18424962, 'binary_specificity': 0.99601483, 'binary_f1_score': 0.2853855}
confusion matrix:
       0    1
0  17995   72
1    549  124
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96165, 'precision': 0.8157438, 'recall': 0.5827654, 'specificity': 0.5827654, 'f1': 0.62512326, 'auroc': 0.79765713, 'binary_precision': 0.6666667, 'binary_recall': 0.16923077, 'binary_specificity': 0.99630004, 'binary_f1_score': 0.26993868}
confusion matrix:
      0   1
0  5924  22
1   216  44
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512107_12.png
early stop counter: 3
val acc:0.9668623208999634, best validation acc: 0.9670224189758301, corresponding to test acc:                         0.9640670418739319 / 0.9647115468978882
after epoch: 12,now: 2024-06-20 20:04:20.870259,epoch time: 0:16:05.863080,used: 3:25:52.753456,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_38_28_seed_1_21512107
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9883134, 'precision': 0.9848365, 'recall': 0.94474334, 'specificity': 0.94474334, 'f1': 0.96371245, 'auroc': 0.9940318, 'binary_precision': 0.9806567, 'binary_recall': 0.8912792, 'binary_specificity': 0.99820745, 'binary_f1_score': 0.93383425}
confusion matrix:
       0     1
0  42321    76
1    470  3853
---- Validation: 
scalar performance:
{'acc': 0.9663821, 'precision': 0.79365456, 'recall': 0.5820152, 'specificity': 0.5820152, 'f1': 0.62340844, 'auroc': 0.802324, 'binary_precision': 0.61748636, 'binary_recall': 0.1679049, 'binary_specificity': 0.9961255, 'binary_f1_score': 0.26401868}
confusion matrix:
       0    1
0  17997   70
1    560  113
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96132773, 'precision': 0.8154355, 'recall': 0.57524127, 'specificity': 0.57524127, 'f1': 0.6150761, 'auroc': 0.80159885, 'binary_precision': 0.6666667, 'binary_recall': 0.15384616, 'binary_specificity': 0.9966364, 'binary_f1_score': 0.25000003}
confusion matrix:
      0   1
0  5926  20
1   220  40
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512107_13.png
early stop counter: 4
val acc:0.9663820862770081, best validation acc: 0.9670224189758301, corresponding to test acc:                         0.9640670418739319 / 0.9647115468978882
after epoch: 13,now: 2024-06-20 20:22:43.470529,epoch time: 0:18:22.600270,used: 3:44:15.353726,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_38_28_seed_1_21512107
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9896832, 'precision': 0.98464346, 'recall': 0.9531631, 'specificity': 0.9531631, 'f1': 0.96824366, 'auroc': 0.9952427, 'binary_precision': 0.97855896, 'binary_recall': 0.9083545, 'binary_specificity': 0.99797165, 'binary_f1_score': 0.9421507}
confusion matrix:
       0     1
0  42313    86
1    396  3925
---- Validation: 
scalar performance:
{'acc': 0.9668623, 'precision': 0.802855, 'recall': 0.58870167, 'specificity': 0.58870167, 'f1': 0.6325603, 'auroc': 0.81141907, 'binary_precision': 0.6354167, 'binary_recall': 0.18127786, 'binary_specificity': 0.9961255, 'binary_f1_score': 0.28208092}
confusion matrix:
       0    1
0  17997   70
1    551  122
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96165, 'precision': 0.8302468, 'recall': 0.5735705, 'specificity': 0.5735705, 'f1': 0.61357975, 'auroc': 0.80928755, 'binary_precision': 0.6964286, 'binary_recall': 0.15, 'binary_specificity': 0.99714094, 'binary_f1_score': 0.24683544}
confusion matrix:
      0   1
0  5929  17
1   221  39
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512107_14.png
early stop counter: 5
val acc:0.9668623208999634, best validation acc: 0.9670224189758301, corresponding to test acc:                         0.9640670418739319 / 0.9647115468978882
after epoch: 14,now: 2024-06-20 20:41:33.964183,epoch time: 0:18:50.493654,used: 4:03:05.847380,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_38_28_seed_1_21512107
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98994005, 'precision': 0.97970396, 'recall': 0.9596795, 'specificity': 0.9596795, 'f1': 0.96942425, 'auroc': 0.99625766, 'binary_precision': 0.9672727, 'binary_recall': 0.92254335, 'binary_specificity': 0.9968157, 'binary_f1_score': 0.9443787}
confusion matrix:
       0     1
0  42260   135
1    335  3990
---- Validation: 
scalar performance:
{'acc': 0.9671825, 'precision': 0.7931031, 'recall': 0.61318684, 'specificity': 0.61318684, 'f1': 0.6598723, 'auroc': 0.82129306, 'binary_precision': 0.61417323, 'binary_recall': 0.23179792, 'binary_specificity': 0.99457574, 'binary_f1_score': 0.33656955}
confusion matrix:
       0    1
0  17969   98
1    517  156
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614889, 'precision': 0.79626787, 'recall': 0.5973932, 'specificity': 0.5973932, 'f1': 0.64170206, 'auroc': 0.81451136, 'binary_precision': 0.62650603, 'binary_recall': 0.2, 'binary_specificity': 0.9947864, 'binary_f1_score': 0.303207}
confusion matrix:
      0   1
0  5915  31
1   208  52
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512107_15.png
better model found
persisted
after epoch: 15,now: 2024-06-20 21:02:55.274285,epoch time: 0:21:21.310102,used: 4:24:27.157482,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_38_28_seed_1_21512107
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9904538, 'precision': 0.98666537, 'recall': 0.95588386, 'specificity': 0.95588386, 'f1': 0.97064734, 'auroc': 0.99463904, 'binary_precision': 0.9820896, 'binary_recall': 0.913466, 'binary_specificity': 0.9983018, 'binary_f1_score': 0.94653565}
confusion matrix:
       0     1
0  42326    72
1    374  3948
---- Validation: 
scalar performance:
{'acc': 0.9668623, 'precision': 0.79358876, 'recall': 0.60014594, 'specificity': 0.60014594, 'f1': 0.64535856, 'auroc': 0.8204775, 'binary_precision': 0.6160714, 'binary_recall': 0.205052, 'binary_specificity': 0.9952399, 'binary_f1_score': 0.30769232}
confusion matrix:
       0    1
0  17981   86
1    535  138
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9619723, 'precision': 0.8160526, 'recall': 0.59028953, 'specificity': 0.59028953, 'f1': 0.6348101, 'auroc': 0.8279781, 'binary_precision': 0.6666667, 'binary_recall': 0.18461539, 'binary_specificity': 0.9959637, 'binary_f1_score': 0.28915665}
confusion matrix:
      0   1
0  5922  24
1   212  48
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512107_16.png
early stop counter: 1
val acc:0.9668623208999634, best validation acc: 0.9671825170516968, corresponding to test acc:                         0.9614889025688171 / 0.9647115468978882
after epoch: 16,now: 2024-06-20 21:20:00.559261,epoch time: 0:17:05.284976,used: 4:41:32.442458,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_38_28_seed_1_21512107
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9910745, 'precision': 0.9849385, 'recall': 0.9613167, 'specificity': 0.9613167, 'f1': 0.97275895, 'auroc': 0.995334, 'binary_precision': 0.9775006, 'binary_recall': 0.9248033, 'binary_specificity': 0.9978301, 'binary_f1_score': 0.95042205}
confusion matrix:
       0     1
0  42306    92
1    325  3997
---- Validation: 
scalar performance:
{'acc': 0.966222, 'precision': 0.7760191, 'recall': 0.6041055, 'specificity': 0.6041055, 'f1': 0.6476945, 'auroc': 0.8301562, 'binary_precision': 0.58064514, 'binary_recall': 0.21396731, 'binary_specificity': 0.9942436, 'binary_f1_score': 0.31270358}
confusion matrix:
       0    1
0  17963  104
1    529  144
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9619723, 'precision': 0.80301905, 'recall': 0.6031624, 'specificity': 0.6031624, 'f1': 0.64918, 'auroc': 0.8313495, 'binary_precision': 0.6395349, 'binary_recall': 0.21153846, 'binary_specificity': 0.9947864, 'binary_f1_score': 0.31791908}
confusion matrix:
      0   1
0  5915  31
1   205  55
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512107_17.png
early stop counter: 2
val acc:0.9662219882011414, best validation acc: 0.9671825170516968, corresponding to test acc:                         0.9614889025688171 / 0.9647115468978882
after epoch: 17,now: 2024-06-20 21:36:12.760789,epoch time: 0:16:12.201528,used: 4:57:44.643986,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_38_28_seed_1_21512107
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99098885, 'precision': 0.9872328, 'recall': 0.95859635, 'specificity': 0.95859635, 'f1': 0.97237325, 'auroc': 0.9969405, 'binary_precision': 0.9826904, 'binary_recall': 0.9188439, 'binary_specificity': 0.99834883, 'binary_f1_score': 0.9496953}
confusion matrix:
       0     1
0  42325    70
1    351  3974
---- Validation: 
scalar performance:
{'acc': 0.9663287, 'precision': 0.7876133, 'recall': 0.58770967, 'specificity': 0.58770967, 'f1': 0.62998396, 'auroc': 0.8223836, 'binary_precision': 0.605, 'binary_recall': 0.17979197, 'binary_specificity': 0.9956274, 'binary_f1_score': 0.27720505}
confusion matrix:
       0    1
0  17988   79
1    552  121
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96100545, 'precision': 0.80953157, 'recall': 0.5713951, 'specificity': 0.5713951, 'f1': 0.6094919, 'auroc': 0.809281, 'binary_precision': 0.6551724, 'binary_recall': 0.14615385, 'binary_specificity': 0.9966364, 'binary_f1_score': 0.23899372}
confusion matrix:
      0   1
0  5926  20
1   222  38
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512107_18.png
early stop counter: 3
val acc:0.9663286805152893, best validation acc: 0.9671825170516968, corresponding to test acc:                         0.9614889025688171 / 0.9647115468978882
after epoch: 18,now: 2024-06-20 21:50:19.614579,epoch time: 0:14:06.853790,used: 5:11:51.497776,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_38_28_seed_1_21512107
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99101025, 'precision': 0.9854284, 'recall': 0.96046793, 'specificity': 0.96046793, 'f1': 0.97253644, 'auroc': 0.9959394, 'binary_precision': 0.978666, 'binary_recall': 0.922988, 'binary_specificity': 0.99794793, 'binary_f1_score': 0.95001197}
confusion matrix:
       0     1
0  42309    87
1    333  3991
---- Validation: 
scalar performance:
{'acc': 0.96627533, 'precision': 0.7825506, 'recall': 0.5934041, 'specificity': 0.5934041, 'f1': 0.6363076, 'auroc': 0.8298258, 'binary_precision': 0.59447, 'binary_recall': 0.19167905, 'binary_specificity': 0.9951292, 'binary_f1_score': 0.2898876}
confusion matrix:
       0    1
0  17979   88
1    544  129
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590719, 'precision': 0.75333863, 'recall': 0.57038605, 'specificity': 0.57038605, 'f1': 0.60464, 'auroc': 0.8266331, 'binary_precision': 0.54285717, 'binary_recall': 0.14615385, 'binary_specificity': 0.99461824, 'binary_f1_score': 0.23030303}
confusion matrix:
      0   1
0  5914  32
1   222  38
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512107_19.png
early stop counter: 4
val acc:0.9662753343582153, best validation acc: 0.9671825170516968, corresponding to test acc:                         0.9614889025688171 / 0.9647115468978882
after epoch: 19,now: 2024-06-20 22:05:46.821583,epoch time: 0:15:27.207004,used: 5:27:18.704780,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_38_28_seed_1_21512107
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9912243, 'precision': 0.9870579, 'recall': 0.96016157, 'specificity': 0.96016157, 'f1': 0.9731327, 'auroc': 0.9965352, 'binary_precision': 0.98201525, 'binary_recall': 0.9220449, 'binary_specificity': 0.9982782, 'binary_f1_score': 0.9510857}
confusion matrix:
       0     1
0  42324    73
1    337  3986
---- Validation: 
scalar performance:
{'acc': 0.9667556, 'precision': 0.8083706, 'recall': 0.5800631, 'specificity': 0.5800631, 'f1': 0.621984, 'auroc': 0.81979454, 'binary_precision': 0.64705884, 'binary_recall': 0.16344725, 'binary_specificity': 0.996679, 'binary_f1_score': 0.2609727}
confusion matrix:
       0    1
0  18007   60
1    563  110
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96019983, 'precision': 0.79772985, 'recall': 0.5581018, 'specificity': 0.5581018, 'f1': 0.59011954, 'auroc': 0.80909646, 'binary_precision': 0.63265306, 'binary_recall': 0.11923077, 'binary_specificity': 0.99697274, 'binary_f1_score': 0.20064726}
confusion matrix:
      0   1
0  5928  18
1   229  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512107_20.png
early stop counter: 5
val acc:0.9667556285858154, best validation acc: 0.9671825170516968, corresponding to test acc:                         0.9614889025688171 / 0.9647115468978882
after epoch: 20,now: 2024-06-20 22:20:04.905199,epoch time: 0:14:18.083616,used: 5:41:36.788396,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_38_28_seed_1_21512107
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9918664, 'precision': 0.98704845, 'recall': 0.96404684, 'specificity': 0.96404684, 'f1': 0.97519994, 'auroc': 0.9964917, 'binary_precision': 0.98120576, 'binary_recall': 0.92990977, 'binary_specificity': 0.99818385, 'binary_f1_score': 0.9548694}
confusion matrix:
       0     1
0  42320    77
1    303  4020
---- Validation: 
scalar performance:
{'acc': 0.96616864, 'precision': 0.78600585, 'recall': 0.58333504, 'specificity': 0.58333504, 'f1': 0.6244444, 'auroc': 0.82571435, 'binary_precision': 0.60209423, 'binary_recall': 0.17087667, 'binary_specificity': 0.99579346, 'binary_f1_score': 0.26620367}
confusion matrix:
       0    1
0  17991   76
1    558  115
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96036094, 'precision': 0.785115, 'recall': 0.5747367, 'specificity': 0.5747367, 'f1': 0.61252236, 'auroc': 0.8098052, 'binary_precision': 0.6060606, 'binary_recall': 0.15384616, 'binary_specificity': 0.9956273, 'binary_f1_score': 0.24539877}
confusion matrix:
      0   1
0  5920  26
1   220  40
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512107_21.png
early stop counter: 6
val acc:0.9661686420440674, best validation acc: 0.9671825170516968, corresponding to test acc:                         0.9614889025688171 / 0.9647115468978882
after epoch: 21,now: 2024-06-20 22:36:27.279284,epoch time: 0:16:22.374085,used: 5:57:59.162481,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_38_28_seed_1_21512107
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9915454, 'precision': 0.9880216, 'recall': 0.9611957, 'specificity': 0.9611957, 'f1': 0.97413516, 'auroc': 0.9965776, 'binary_precision': 0.9837558, 'binary_recall': 0.9239482, 'binary_specificity': 0.9984432, 'binary_f1_score': 0.95291454}
confusion matrix:
       0     1
0  42328    66
1    329  3997
---- Validation: 
scalar performance:
{'acc': 0.96611524, 'precision': 0.79185796, 'recall': 0.5740089, 'specificity': 0.5740089, 'f1': 0.6129081, 'auroc': 0.8268447, 'binary_precision': 0.61445785, 'binary_recall': 0.15156017, 'binary_specificity': 0.99645764, 'binary_f1_score': 0.2431466}
confusion matrix:
       0    1
0  18003   64
1    571  102
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587496, 'precision': 0.74765575, 'recall': 0.56102294, 'specificity': 0.56102294, 'f1': 0.59189725, 'auroc': 0.81247854, 'binary_precision': 0.5322581, 'binary_recall': 0.12692308, 'binary_specificity': 0.9951228, 'binary_f1_score': 0.20496894}
confusion matrix:
      0   1
0  5917  29
1   227  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512107_22.png
early stop counter: 7
val acc:0.9661152362823486, best validation acc: 0.9671825170516968, corresponding to test acc:                         0.9614889025688171 / 0.9647115468978882
after epoch: 22,now: 2024-06-20 22:52:40.975306,epoch time: 0:16:13.696022,used: 6:14:12.858503,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_38_28_seed_1_21512107
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99238014, 'precision': 0.98908454, 'recall': 0.9651765, 'specificity': 0.9651765, 'f1': 0.9767563, 'auroc': 0.9963194, 'binary_precision': 0.98508924, 'binary_recall': 0.9317919, 'binary_specificity': 0.99856114, 'binary_f1_score': 0.95769966}
confusion matrix:
       0     1
0  42334    61
1    295  4030
---- Validation: 
scalar performance:
{'acc': 0.966222, 'precision': 0.785566, 'recall': 0.5862238, 'specificity': 0.5862238, 'f1': 0.62797916, 'auroc': 0.824271, 'binary_precision': 0.6010101, 'binary_recall': 0.1768202, 'binary_specificity': 0.9956274, 'binary_f1_score': 0.27324912}
confusion matrix:
       0    1
0  17988   79
1    554  119
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9585885, 'precision': 0.7448589, 'recall': 0.55358285, 'specificity': 0.55358285, 'f1': 0.58144104, 'auroc': 0.7992285, 'binary_precision': 0.5272727, 'binary_recall': 0.11153846, 'binary_specificity': 0.9956273, 'binary_f1_score': 0.18412699}
confusion matrix:
      0   1
0  5920  26
1   231  29
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512107_23.png
early stop counter: 8
val acc:0.9662219882011414, best validation acc: 0.9671825170516968, corresponding to test acc:                         0.9614889025688171 / 0.9647115468978882
after epoch: 23,now: 2024-06-20 23:09:07.266327,epoch time: 0:16:26.291021,used: 6:30:39.149524,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_38_28_seed_1_21512107
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9921875, 'precision': 0.9872641, 'recall': 0.96580476, 'specificity': 0.96580476, 'f1': 0.9762323, 'auroc': 0.99690896, 'binary_precision': 0.98128796, 'binary_recall': 0.9334258, 'binary_specificity': 0.9981837, 'binary_f1_score': 0.9567587}
confusion matrix:
       0     1
0  42317    77
1    288  4038
---- Validation: 
scalar performance:
{'acc': 0.966809, 'precision': 0.8005558, 'recall': 0.58938926, 'specificity': 0.58938926, 'f1': 0.63321054, 'auroc': 0.8362206, 'binary_precision': 0.63076925, 'binary_recall': 0.18276374, 'binary_specificity': 0.99601483, 'binary_f1_score': 0.28341013}
confusion matrix:
       0    1
0  17995   72
1    550  123
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587496, 'precision': 0.7486174, 'recall': 0.557345, 'specificity': 0.557345, 'f1': 0.58690053, 'auroc': 0.8191198, 'binary_precision': 0.5344828, 'binary_recall': 0.11923077, 'binary_specificity': 0.99545914, 'binary_f1_score': 0.19496855}
confusion matrix:
      0   1
0  5919  27
1   229  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512107_24.png
early stop counter: 9
val acc:0.9668089747428894, best validation acc: 0.9671825170516968, corresponding to test acc:                         0.9614889025688171 / 0.9647115468978882
after epoch: 24,now: 2024-06-20 23:23:12.847168,epoch time: 0:14:05.580841,used: 6:44:44.730365,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_38_28_seed_1_21512107
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9929367, 'precision': 0.9889048, 'recall': 0.96870136, 'specificity': 0.96870136, 'f1': 0.9785365, 'auroc': 0.99715865, 'binary_precision': 0.9840078, 'binary_recall': 0.93895954, 'binary_specificity': 0.9984432, 'binary_f1_score': 0.960956}
confusion matrix:
       0     1
0  42329    66
1    264  4061
---- Validation: 
scalar performance:
{'acc': 0.96723586, 'precision': 0.8023515, 'recall': 0.6017702, 'specificity': 0.6017702, 'f1': 0.6482084, 'auroc': 0.84283173, 'binary_precision': 0.6334842, 'binary_recall': 0.20802377, 'binary_specificity': 0.9955167, 'binary_f1_score': 0.3131991}
confusion matrix:
       0    1
0  17986   81
1    533  140
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9585885, 'precision': 0.7431376, 'recall': 0.5627778, 'specificity': 0.5627778, 'f1': 0.5939841, 'auroc': 0.8188145, 'binary_precision': 0.52307695, 'binary_recall': 0.13076924, 'binary_specificity': 0.9947864, 'binary_f1_score': 0.20923077}
confusion matrix:
      0   1
0  5915  31
1   226  34
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512107_25.png
better model found
persisted
after epoch: 25,now: 2024-06-20 23:39:12.516410,epoch time: 0:15:59.669242,used: 7:00:44.399607,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_38_28_seed_1_21512107
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99203765, 'precision': 0.9883312, 'recall': 0.96383774, 'specificity': 0.96383774, 'f1': 0.9756907, 'auroc': 0.9969871, 'binary_precision': 0.9838394, 'binary_recall': 0.9292322, 'binary_specificity': 0.99844325, 'binary_f1_score': 0.95575637}
confusion matrix:
       0     1
0  42330    66
1    306  4018
---- Validation: 
scalar performance:
{'acc': 0.9663821, 'precision': 0.7969236, 'recall': 0.5784389, 'specificity': 0.5784389, 'f1': 0.619061, 'auroc': 0.8278323, 'binary_precision': 0.6242775, 'binary_recall': 0.16047548, 'binary_specificity': 0.99640226, 'binary_f1_score': 0.25531912}
confusion matrix:
       0    1
0  18002   65
1    565  108
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9585885, 'precision': 0.7468797, 'recall': 0.5462269, 'specificity': 0.5462269, 'f1': 0.5708178, 'auroc': 0.8007769, 'binary_precision': 0.5319149, 'binary_recall': 0.09615385, 'binary_specificity': 0.99630004, 'binary_f1_score': 0.16286644}
confusion matrix:
      0   1
0  5924  22
1   235  25
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512107_26.png
early stop counter: 1
val acc:0.9663820862770081, best validation acc: 0.9672358632087708, corresponding to test acc:                         0.9585884809494019 / 0.9647115468978882
after epoch: 26,now: 2024-06-20 23:59:14.685160,epoch time: 0:20:02.168750,used: 7:20:46.568357,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_38_28_seed_1_21512107
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9921875, 'precision': 0.9878924, 'recall': 0.9651585, 'specificity': 0.9651585, 'f1': 0.9761865, 'auroc': 0.9966891, 'binary_precision': 0.98268294, 'binary_recall': 0.9319917, 'binary_specificity': 0.99832535, 'binary_f1_score': 0.9566663}
confusion matrix:
       0     1
0  42326    71
1    294  4029
---- Validation: 
scalar performance:
{'acc': 0.9670224, 'precision': 0.8011923, 'recall': 0.5959374, 'specificity': 0.5959374, 'f1': 0.64121675, 'auroc': 0.84569305, 'binary_precision': 0.6315789, 'binary_recall': 0.1961367, 'binary_specificity': 0.9957381, 'binary_f1_score': 0.2993197}
confusion matrix:
       0    1
0  17990   77
1    541  132
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582662, 'precision': 0.7354653, 'recall': 0.55709267, 'specificity': 0.55709267, 'f1': 0.58586276, 'auroc': 0.8252661, 'binary_precision': 0.5081967, 'binary_recall': 0.11923077, 'binary_specificity': 0.9949546, 'binary_f1_score': 0.19314642}
confusion matrix:
      0   1
0  5916  30
1   229  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512107_27.png
early stop counter: 2
val acc:0.9670224189758301, best validation acc: 0.9672358632087708, corresponding to test acc:                         0.9585884809494019 / 0.9647115468978882
after epoch: 27,now: 2024-06-21 00:20:05.694225,epoch time: 0:20:51.009065,used: 7:41:37.577422,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_38_28_seed_1_21512107
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9928296, 'precision': 0.9870565, 'recall': 0.9698949, 'specificity': 0.9698949, 'f1': 0.978283, 'auroc': 0.9970769, 'binary_precision': 0.9800337, 'binary_recall': 0.94174755, 'binary_specificity': 0.99804217, 'binary_f1_score': 0.9605092}
confusion matrix:
       0     1
0  42311    83
1    252  4074
---- Validation: 
scalar performance:
{'acc': 0.9667556, 'precision': 0.7943357, 'recall': 0.5950838, 'specificity': 0.5950838, 'f1': 0.6395105, 'auroc': 0.8436834, 'binary_precision': 0.6179245, 'binary_recall': 0.19465081, 'binary_specificity': 0.9955167, 'binary_f1_score': 0.29604518}
confusion matrix:
       0    1
0  17986   81
1    542  131
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582662, 'precision': 0.7354653, 'recall': 0.55709267, 'specificity': 0.55709267, 'f1': 0.58586276, 'auroc': 0.8206079, 'binary_precision': 0.5081967, 'binary_recall': 0.11923077, 'binary_specificity': 0.9949546, 'binary_f1_score': 0.19314642}
confusion matrix:
      0   1
0  5916  30
1   229  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512107_28.png
early stop counter: 3
val acc:0.9667556285858154, best validation acc: 0.9672358632087708, corresponding to test acc:                         0.9585884809494019 / 0.9647115468978882
after epoch: 28,now: 2024-06-21 00:41:48.749646,epoch time: 0:21:43.055421,used: 8:03:20.632843,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_38_28_seed_1_21512107
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.992637, 'precision': 0.9881853, 'recall': 0.96760195, 'specificity': 0.96760195, 'f1': 0.9776164, 'auroc': 0.99689347, 'binary_precision': 0.9827795, 'binary_recall': 0.9368786, 'binary_specificity': 0.9983253, 'binary_f1_score': 0.9592803}
confusion matrix:
       0     1
0  42324    71
1    273  4052
---- Validation: 
scalar performance:
{'acc': 0.9663821, 'precision': 0.783222, 'recall': 0.5970358, 'specificity': 0.5970358, 'f1': 0.6406097, 'auroc': 0.8524358, 'binary_precision': 0.59555554, 'binary_recall': 0.19910847, 'binary_specificity': 0.99496317, 'binary_f1_score': 0.29844096}
confusion matrix:
       0    1
0  17976   91
1    539  134
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9574605, 'precision': 0.71507215, 'recall': 0.55299425, 'specificity': 0.55299425, 'f1': 0.579144, 'auroc': 0.83959967, 'binary_precision': 0.46774194, 'binary_recall': 0.11153846, 'binary_specificity': 0.99445003, 'binary_f1_score': 0.18012422}
confusion matrix:
      0   1
0  5913  33
1   231  29
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512107_29.png
early stop counter: 4
val acc:0.9663820862770081, best validation acc: 0.9672358632087708, corresponding to test acc:                         0.9585884809494019 / 0.9647115468978882
after epoch: 29,now: 2024-06-21 01:02:58.765190,epoch time: 0:21:10.015544,used: 8:24:30.648387,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_38_28_seed_1_21512107
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9928938, 'precision': 0.989406, 'recall': 0.9679439, 'specificity': 0.9679439, 'f1': 0.9783742, 'auroc': 0.9975227, 'binary_precision': 0.98517257, 'binary_recall': 0.93732655, 'binary_specificity': 0.9985612, 'binary_f1_score': 0.96065414}
confusion matrix:
       0     1
0  42335    61
1    271  4053
---- Validation: 
scalar performance:
{'acc': 0.96734256, 'precision': 0.80586195, 'recall': 0.6011103, 'specificity': 0.6011103, 'f1': 0.64781684, 'auroc': 0.8463609, 'binary_precision': 0.640553, 'binary_recall': 0.20653789, 'binary_specificity': 0.9956827, 'binary_f1_score': 0.31235957}
confusion matrix:
       0    1
0  17989   78
1    534  139
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9585885, 'precision': 0.7463033, 'recall': 0.5480659, 'specificity': 0.5480659, 'f1': 0.5735252, 'auroc': 0.81734115, 'binary_precision': 0.53061223, 'binary_recall': 0.1, 'binary_specificity': 0.99613184, 'binary_f1_score': 0.16828479}
confusion matrix:
      0   1
0  5923  23
1   234  26
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512107_30.png
better model found
persisted
after epoch: 30,now: 2024-06-21 01:24:31.677185,epoch time: 0:21:32.911995,used: 8:46:03.560382,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_38_28_seed_1_21512107
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 8:46:03.560382 at 2024-06-21 01:24:31.677185
persisted model performance metric: 

scalar performance:
{'acc': 0.9585885, 'precision': 0.7463033, 'recall': 0.5480659, 'specificity': 0.5480659, 'f1': 0.5735252, 'auroc': 0.81734115, 'binary_precision': 0.53061223, 'binary_recall': 0.1, 'binary_specificity': 0.99613184, 'binary_f1_score': 0.16828479}
confusion matrix:
      0   1
0  5923  23
1   234  26
oracle model performance metric: 

scalar performance:
{'acc': 0.96471155, 'precision': 0.870193, 'recall': 0.6101089, 'specificity': 0.6101089, 'f1': 0.6640675, 'auroc': 0.78852165, 'binary_precision': 0.7733333, 'binary_recall': 0.22307692, 'binary_specificity': 0.99714094, 'binary_f1_score': 0.34626865}
confusion matrix:
      0   1
0  5929  17
1   202  58
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_irm_resnet_different_bs128_lre4_classbalancing/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_irm_resnet_different_bs128_lre4_classbalancing/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204094 KiB |   1730 MiB | 754681 GiB | 754681 GiB |
|       from large pool | 167936 KiB |   1660 MiB | 754469 GiB | 754469 GiB |
|       from small pool |  36158 KiB |     72 MiB |    212 GiB |    212 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 204094 KiB |   1730 MiB | 754681 GiB | 754681 GiB |
|       from large pool | 167936 KiB |   1660 MiB | 754469 GiB | 754469 GiB |
|       from small pool |  36158 KiB |     72 MiB |    212 GiB |    212 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201086 KiB |   1723 MiB | 754663 GiB | 754663 GiB |
|       from large pool | 165120 KiB |   1653 MiB | 754454 GiB | 754454 GiB |
|       from small pool |  35966 KiB |     71 MiB |    208 GiB |    208 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1802 MiB |   1876 MiB |   3084 MiB |   1282 MiB |
|       from large pool |   1728 MiB |   1802 MiB |   2978 MiB |   1250 MiB |
|       from small pool |     74 MiB |     74 MiB |    106 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 404161 KiB |    900 MiB | 534397 GiB | 534397 GiB |
|       from large pool | 397312 KiB |    899 MiB | 534178 GiB | 534178 GiB |
|       from small pool |   6849 KiB |     14 MiB |    218 GiB |    218 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1194    |    1851    |   22649 K  |   22647 K  |
|       from large pool |      36    |      76    |    7175 K  |    7175 K  |
|       from small pool |    1158    |    1780    |   15474 K  |   15472 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1194    |    1851    |   22649 K  |   22647 K  |
|       from large pool |      36    |      76    |    7175 K  |    7175 K  |
|       from small pool |    1158    |    1780    |   15474 K  |   15472 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      49    |      50    |      69    |      20    |
|       from large pool |      12    |      13    |      16    |       4    |
|       from small pool |      37    |      37    |      53    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      34    |     380    |   11517 K  |   11517 K  |
|       from large pool |       5    |      11    |    2823 K  |    2823 K  |
|       from small pool |      29    |     375    |    8694 K  |    8694 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1730 MiB | 754681 GiB | 754681 GiB |
|       from large pool |  16640 KiB |   1660 MiB | 754469 GiB | 754469 GiB |
|       from small pool |      0 KiB |     72 MiB |    212 GiB |    212 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1730 MiB | 754681 GiB | 754681 GiB |
|       from large pool |  16640 KiB |   1660 MiB | 754469 GiB | 754469 GiB |
|       from small pool |      0 KiB |     72 MiB |    212 GiB |    212 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1723 MiB | 754663 GiB | 754663 GiB |
|       from large pool |  16640 KiB |   1653 MiB | 754454 GiB | 754454 GiB |
|       from small pool |      0 KiB |     71 MiB |    208 GiB |    208 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 608256 KiB |   1876 MiB |   3084 MiB |   2490 MiB |
|       from large pool | 565248 KiB |   1802 MiB |   2978 MiB |   2426 MiB |
|       from small pool |  43008 KiB |     74 MiB |    106 MiB |     64 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 384768 KiB |    900 MiB | 534397 GiB | 534397 GiB |
|       from large pool | 384768 KiB |    899 MiB | 534178 GiB | 534178 GiB |
|       from small pool |      0 KiB |     14 MiB |    218 GiB |    218 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1851    |   22649 K  |   22649 K  |
|       from large pool |       2    |      76    |    7175 K  |    7175 K  |
|       from small pool |       0    |    1780    |   15474 K  |   15474 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1851    |   22649 K  |   22649 K  |
|       from large pool |       2    |      76    |    7175 K  |    7175 K  |
|       from small pool |       0    |    1780    |   15474 K  |   15474 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      30    |      50    |      69    |      39    |
|       from large pool |       9    |      13    |      16    |       7    |
|       from small pool |      21    |      37    |      53    |      32    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     380    |   11517 K  |   11517 K  |
|       from large pool |       1    |      11    |    2823 K  |    2823 K  |
|       from small pool |       0    |     375    |    8694 K  |    8694 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1730 MiB | 754681 GiB | 754681 GiB |
|       from large pool |  16640 KiB |   1660 MiB | 754469 GiB | 754469 GiB |
|       from small pool |      0 KiB |     72 MiB |    212 GiB |    212 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1730 MiB | 754681 GiB | 754681 GiB |
|       from large pool |  16640 KiB |   1660 MiB | 754469 GiB | 754469 GiB |
|       from small pool |      0 KiB |     72 MiB |    212 GiB |    212 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1723 MiB | 754663 GiB | 754663 GiB |
|       from large pool |  16640 KiB |   1653 MiB | 754454 GiB | 754454 GiB |
|       from small pool |      0 KiB |     71 MiB |    208 GiB |    208 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 608256 KiB |   1876 MiB |   3084 MiB |   2490 MiB |
|       from large pool | 565248 KiB |   1802 MiB |   2978 MiB |   2426 MiB |
|       from small pool |  43008 KiB |     74 MiB |    106 MiB |     64 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 384768 KiB |    900 MiB | 534397 GiB | 534397 GiB |
|       from large pool | 384768 KiB |    899 MiB | 534178 GiB | 534178 GiB |
|       from small pool |      0 KiB |     14 MiB |    218 GiB |    218 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1851    |   22649 K  |   22649 K  |
|       from large pool |       2    |      76    |    7175 K  |    7175 K  |
|       from small pool |       0    |    1780    |   15474 K  |   15474 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1851    |   22649 K  |   22649 K  |
|       from large pool |       2    |      76    |    7175 K  |    7175 K  |
|       from small pool |       0    |    1780    |   15474 K  |   15474 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      30    |      50    |      69    |      39    |
|       from large pool |       9    |      13    |      16    |       7    |
|       from small pool |      21    |      37    |      53    |      32    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     380    |   11517 K  |   11517 K  |
|       from large pool |       1    |      11    |    2823 K  |    2823 K  |
|       from small pool |       0    |     375    |    8694 K  |    8694 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0




!!!: not committed yet



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_01_31_21_seed_2_21512107

 Experiment start at: 2024-06-21 01:31:21.577441
before training, model accuracy: 0.0544959120452404
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9414489, 'precision': 0.96533704, 'recall': 0.6994144, 'specificity': 0.6994144, 'f1': 0.7688874, 'auroc': 0.94321537, 'binary_precision': 0.99124724, 'binary_recall': 0.39920688, 'binary_specificity': 0.9996218, 'binary_f1_score': 0.56918484}
confusion matrix:
       0     1
0  42293    16
1   2727  1812
---- Validation: 
scalar performance:
{'acc': 0.9675598, 'precision': 0.48396036, 'recall': 0.4998074, 'specificity': 0.4998074, 'f1': 0.49175623, 'auroc': 0.5736258, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9996148, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18164  7
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96105146, 'precision': 0.48060277, 'recall': 0.4999166, 'specificity': 0.4999166, 'f1': 0.49006948, 'auroc': 0.6194246, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5996  1
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512107_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-21 02:00:28.787931,epoch time: 0:29:07.210490,used: 0:29:07.210490,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_01_31_21_seed_2_21512107
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9656976, 'precision': 0.9779295, 'recall': 0.82530034, 'specificity': 0.82530034, 'f1': 0.88378537, 'auroc': 0.97088325, 'binary_precision': 0.9919436, 'binary_recall': 0.6511679, 'binary_specificity': 0.99943274, 'binary_f1_score': 0.786218}
confusion matrix:
       0     1
0  42286    24
1   1583  2955
---- Validation: 
scalar performance:
{'acc': 0.9684121, 'precision': 0.78694916, 'recall': 0.5211269, 'specificity': 0.5211269, 'f1': 0.5322751, 'auroc': 0.6469386, 'binary_precision': 0.60465115, 'binary_recall': 0.04318937, 'binary_specificity': 0.99906445, 'binary_f1_score': 0.080620155}
confusion matrix:
       0   1
0  18154  17
1    576  26
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96025, 'precision': 0.6237407, 'recall': 0.50743073, 'specificity': 0.50743073, 'f1': 0.50547934, 'auroc': 0.68379366, 'binary_precision': 0.2857143, 'binary_recall': 0.016528925, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.031249996}
confusion matrix:
      0   1
0  5987  10
1   238   4
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512107_2.png
better model found
persisted
after epoch: 2,now: 2024-06-21 02:25:51.434077,epoch time: 0:25:22.646146,used: 0:54:29.856636,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_01_31_21_seed_2_21512107
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97658384, 'precision': 0.9816134, 'recall': 0.8834853, 'specificity': 0.8834853, 'f1': 0.9256181, 'auroc': 0.98130083, 'binary_precision': 0.9875354, 'binary_recall': 0.76801056, 'binary_specificity': 0.99896, 'binary_f1_score': 0.8640476}
confusion matrix:
       0     1
0  42265    44
1   1053  3486
---- Validation: 
scalar performance:
{'acc': 0.9689448, 'precision': 0.77013916, 'recall': 0.56396365, 'specificity': 0.56396365, 'f1': 0.5986926, 'auroc': 0.717329, 'binary_precision': 0.5683453, 'binary_recall': 0.13122924, 'binary_specificity': 0.996698, 'binary_f1_score': 0.21322538}
confusion matrix:
       0   1
0  18111  60
1    523  79
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9648982, 'precision': 0.8345394, 'recall': 0.58122724, 'specificity': 0.58122724, 'f1': 0.6247884, 'auroc': 0.7321216, 'binary_precision': 0.7017544, 'binary_recall': 0.16528925, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.26755852}
confusion matrix:
      0   1
0  5980  17
1   202  40
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512107_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-21 02:39:45.292098,epoch time: 0:13:53.858021,used: 1:08:23.714657,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_01_31_21_seed_2_21512107
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9792947, 'precision': 0.9815638, 'recall': 0.8988298, 'specificity': 0.8988298, 'f1': 0.93533766, 'auroc': 0.9850807, 'binary_precision': 0.98425627, 'binary_recall': 0.7990304, 'binary_specificity': 0.99862915, 'binary_f1_score': 0.8820238}
confusion matrix:
       0     1
0  42252    58
1    912  3626
---- Validation: 
scalar performance:
{'acc': 0.9686784, 'precision': 0.75966203, 'recall': 0.56543213, 'specificity': 0.56543213, 'f1': 0.60001, 'auroc': 0.73227906, 'binary_precision': 0.5472973, 'binary_recall': 0.1345515, 'binary_specificity': 0.9963128, 'binary_f1_score': 0.216}
confusion matrix:
       0   1
0  18104  67
1    521  81
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9661805, 'precision': 0.87481916, 'recall': 0.58784246, 'specificity': 0.58784246, 'f1': 0.6361201, 'auroc': 0.7366266, 'binary_precision': 0.7818182, 'binary_recall': 0.17768595, 'binary_specificity': 0.997999, 'binary_f1_score': 0.28956228}
confusion matrix:
      0   1
0  5985  12
1   199  43
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512107_4.png
new oracle model saved
early stop counter: 1
val acc:0.9686784148216248, best validation acc: 0.968944787979126, corresponding to test acc:                         0.9648982286453247 / 0.9661805033683777
after epoch: 4,now: 2024-06-21 03:01:01.790500,epoch time: 0:21:16.498402,used: 1:29:40.213059,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_01_31_21_seed_2_21512107
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9831583, 'precision': 0.97876817, 'recall': 0.9234121, 'specificity': 0.9234121, 'f1': 0.9489523, 'auroc': 0.9886919, 'binary_precision': 0.9734849, 'binary_recall': 0.849306, 'binary_specificity': 0.99751824, 'binary_f1_score': 0.9071655}
confusion matrix:
       0     1
0  42204   105
1    684  3855
---- Validation: 
scalar performance:
{'acc': 0.9678794, 'precision': 0.7363266, 'recall': 0.6051718, 'specificity': 0.6051718, 'f1': 0.64322555, 'auroc': 0.7747526, 'binary_precision': 0.49809885, 'binary_recall': 0.21760798, 'binary_specificity': 0.9927357, 'binary_f1_score': 0.30289015}
confusion matrix:
       0    1
0  18039  132
1    471  131
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96890527, 'precision': 0.86926603, 'recall': 0.6408111, 'specificity': 0.6408111, 'f1': 0.6998452, 'auroc': 0.7855107, 'binary_precision': 0.76666665, 'binary_recall': 0.28512397, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.41566268}
confusion matrix:
      0   1
0  5976  21
1   173  69
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512107_5.png
new oracle model saved
early stop counter: 2
val acc:0.9678794145584106, best validation acc: 0.968944787979126, corresponding to test acc:                         0.9648982286453247 / 0.9689052700996399
after epoch: 5,now: 2024-06-21 03:26:56.794616,epoch time: 0:25:55.004116,used: 1:55:35.217175,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_01_31_21_seed_2_21512107
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98426825, 'precision': 0.97710884, 'recall': 0.9313873, 'specificity': 0.9313873, 'f1': 0.95279604, 'auroc': 0.9901222, 'binary_precision': 0.9684496, 'binary_recall': 0.8657999, 'binary_specificity': 0.9969747, 'binary_f1_score': 0.91425246}
confusion matrix:
       0     1
0  42182   128
1    609  3929
---- Validation: 
scalar performance:
{'acc': 0.9681457, 'precision': 0.74117815, 'recall': 0.6020972, 'specificity': 0.6020972, 'f1': 0.6409126, 'auroc': 0.78062975, 'binary_precision': 0.508, 'binary_recall': 0.21096346, 'binary_specificity': 0.993231, 'binary_f1_score': 0.29812208}
confusion matrix:
       0    1
0  18048  123
1    475  127
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96730244, 'precision': 0.83674324, 'recall': 0.63402915, 'specificity': 0.63402915, 'f1': 0.688028, 'auroc': 0.7751968, 'binary_precision': 0.70212764, 'binary_recall': 0.27272728, 'binary_specificity': 0.995331, 'binary_f1_score': 0.39285713}
confusion matrix:
      0   1
0  5969  28
1   176  66
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512107_6.png
early stop counter: 3
val acc:0.9681457281112671, best validation acc: 0.968944787979126, corresponding to test acc:                         0.9648982286453247 / 0.9689052700996399
after epoch: 6,now: 2024-06-21 03:54:26.565877,epoch time: 0:27:29.771261,used: 2:23:04.988436,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_01_31_21_seed_2_21512107
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9852715, 'precision': 0.981501, 'recall': 0.9331231, 'specificity': 0.9331231, 'f1': 0.9556998, 'auroc': 0.99028426, 'binary_precision': 0.97694594, 'binary_recall': 0.86844426, 'binary_specificity': 0.99780196, 'binary_f1_score': 0.9195054}
confusion matrix:
       0     1
0  42217    93
1    597  3941
---- Validation: 
scalar performance:
{'acc': 0.9690513, 'precision': 0.76645017, 'recall': 0.57927656, 'specificity': 0.57927656, 'f1': 0.61822546, 'auroc': 0.7759317, 'binary_precision': 0.56, 'binary_recall': 0.1627907, 'binary_specificity': 0.99576247, 'binary_f1_score': 0.25225225}
confusion matrix:
       0   1
0  18094  77
1    504  98
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96730244, 'precision': 0.86329323, 'recall': 0.6142017, 'specificity': 0.6142017, 'f1': 0.66882837, 'auroc': 0.76650035, 'binary_precision': 0.7567568, 'binary_recall': 0.23140496, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.35443038}
confusion matrix:
      0   1
0  5979  18
1   186  56
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512107_7.png
better model found
persisted
after epoch: 7,now: 2024-06-21 04:22:16.711145,epoch time: 0:27:50.145268,used: 2:50:55.133704,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_01_31_21_seed_2_21512107
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98584783, 'precision': 0.98285085, 'recall': 0.93522674, 'specificity': 0.93522674, 'f1': 0.95748234, 'auroc': 0.991637, 'binary_precision': 0.9792285, 'binary_recall': 0.87243885, 'binary_specificity': 0.9980146, 'binary_f1_score': 0.9227543}
confusion matrix:
       0     1
0  42225    84
1    579  3960
---- Validation: 
scalar performance:
{'acc': 0.9691046, 'precision': 0.7647921, 'recall': 0.5881376, 'specificity': 0.5881376, 'f1': 0.6286999, 'auroc': 0.7911076, 'binary_precision': 0.5561224, 'binary_recall': 0.18106312, 'binary_specificity': 0.99521214, 'binary_f1_score': 0.27318293}
confusion matrix:
       0    1
0  18084   87
1    493  109
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9661805, 'precision': 0.8436718, 'recall': 0.6037044, 'specificity': 0.6037044, 'f1': 0.6542669, 'auroc': 0.780928, 'binary_precision': 0.7183099, 'binary_recall': 0.2107438, 'binary_specificity': 0.996665, 'binary_f1_score': 0.3258786}
confusion matrix:
      0   1
0  5977  20
1   191  51
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512107_8.png
better model found
persisted
after epoch: 8,now: 2024-06-21 04:50:50.208081,epoch time: 0:28:33.496936,used: 3:19:28.630640,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_01_31_21_seed_2_21512107
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98796105, 'precision': 0.9844514, 'recall': 0.94593555, 'specificity': 0.94593555, 'f1': 0.9641871, 'auroc': 0.99399555, 'binary_precision': 0.9801884, 'binary_recall': 0.8938092, 'binary_specificity': 0.9980619, 'binary_f1_score': 0.93500805}
confusion matrix:
       0     1
0  42227    82
1    482  4057
---- Validation: 
scalar performance:
{'acc': 0.9691578, 'precision': 0.7651587, 'recall': 0.5913773, 'specificity': 0.5913773, 'f1': 0.63249314, 'auroc': 0.80218494, 'binary_precision': 0.5566502, 'binary_recall': 0.18770765, 'binary_specificity': 0.99504703, 'binary_f1_score': 0.28074533}
confusion matrix:
       0    1
0  18081   90
1    489  113
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96650106, 'precision': 0.83445287, 'recall': 0.61775035, 'specificity': 0.61775035, 'f1': 0.66986287, 'auroc': 0.7911385, 'binary_precision': 0.6987952, 'binary_recall': 0.23966943, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.35692307}
confusion matrix:
      0   1
0  5972  25
1   184  58
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512107_9.png
better model found
persisted
after epoch: 9,now: 2024-06-21 05:07:22.415553,epoch time: 0:16:32.207472,used: 3:36:00.838112,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_01_31_21_seed_2_21512107
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9884947, 'precision': 0.9860532, 'recall': 0.947498, 'specificity': 0.947498, 'f1': 0.96577096, 'auroc': 0.99294937, 'binary_precision': 0.9830877, 'binary_recall': 0.8966505, 'binary_specificity': 0.99834555, 'binary_f1_score': 0.9378817}
confusion matrix:
       0     1
0  42240    70
1    469  4069
---- Validation: 
scalar performance:
{'acc': 0.9690513, 'precision': 0.76337993, 'recall': 0.5881101, 'specificity': 0.5881101, 'f1': 0.6285151, 'auroc': 0.8002111, 'binary_precision': 0.5532995, 'binary_recall': 0.18106312, 'binary_specificity': 0.9951571, 'binary_f1_score': 0.27284104}
confusion matrix:
       0    1
0  18083   88
1    493  109
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96730244, 'precision': 0.8483918, 'recall': 0.6241154, 'specificity': 0.6241154, 'f1': 0.67872286, 'auroc': 0.78477323, 'binary_precision': 0.72619045, 'binary_recall': 0.2520661, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.3742331}
confusion matrix:
      0   1
0  5974  23
1   181  61
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512107_10.png
early stop counter: 1
val acc:0.9690513014793396, best validation acc: 0.9691578149795532, corresponding to test acc:                         0.9665010571479797 / 0.9689052700996399
after epoch: 10,now: 2024-06-21 05:42:37.820945,epoch time: 0:35:15.405392,used: 4:11:16.243504,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_01_31_21_seed_2_21512107
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9883026, 'precision': 0.98220766, 'recall': 0.9500582, 'specificity': 0.9500582, 'f1': 0.9654318, 'auroc': 0.99487364, 'binary_precision': 0.9747799, 'binary_recall': 0.90262175, 'binary_specificity': 0.99749464, 'binary_f1_score': 0.93731415}
confusion matrix:
       0     1
0  42203   106
1    442  4097
---- Validation: 
scalar performance:
{'acc': 0.9689448, 'precision': 0.76173365, 'recall': 0.58403987, 'specificity': 0.58403987, 'f1': 0.62354827, 'auroc': 0.80443275, 'binary_precision': 0.55026454, 'binary_recall': 0.17275748, 'binary_specificity': 0.9953222, 'binary_f1_score': 0.2629583}
confusion matrix:
       0    1
0  18086   85
1    498  104
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9658599, 'precision': 0.82224214, 'recall': 0.61345136, 'specificity': 0.61345136, 'f1': 0.6635444, 'auroc': 0.7859066, 'binary_precision': 0.67469877, 'binary_recall': 0.23140496, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.3446154}
confusion matrix:
      0   1
0  5970  27
1   186  56
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512107_11.png
early stop counter: 2
val acc:0.968944787979126, best validation acc: 0.9691578149795532, corresponding to test acc:                         0.9665010571479797 / 0.9689052700996399
after epoch: 11,now: 2024-06-21 06:22:13.999200,epoch time: 0:39:36.178255,used: 4:50:52.421759,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_01_31_21_seed_2_21512107
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98890024, 'precision': 0.9836291, 'recall': 0.95215917, 'specificity': 0.95215917, 'f1': 0.96722496, 'auroc': 0.99338317, 'binary_precision': 0.9772026, 'binary_recall': 0.90658736, 'binary_specificity': 0.997731, 'binary_f1_score': 0.9405714}
confusion matrix:
       0     1
0  42213    96
1    424  4115
---- Validation: 
scalar performance:
{'acc': 0.9694242, 'precision': 0.7725259, 'recall': 0.5907119, 'specificity': 0.5907119, 'f1': 0.63254094, 'auroc': 0.8100238, 'binary_precision': 0.5714286, 'binary_recall': 0.18604651, 'binary_specificity': 0.99537724, 'binary_f1_score': 0.28070176}
confusion matrix:
       0    1
0  18087   84
1    490  112
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650585, 'precision': 0.83066607, 'recall': 0.5872589, 'specificity': 0.5872589, 'f1': 0.63249385, 'auroc': 0.783399, 'binary_precision': 0.6935484, 'binary_recall': 0.17768595, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.28289476}
confusion matrix:
      0   1
0  5978  19
1   199  43
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512107_12.png
better model found
persisted
after epoch: 12,now: 2024-06-21 07:01:37.155253,epoch time: 0:39:23.156053,used: 5:30:15.577812,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_01_31_21_seed_2_21512107
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9894766, 'precision': 0.98626626, 'recall': 0.9529699, 'specificity': 0.9529699, 'f1': 0.9688725, 'auroc': 0.9948571, 'binary_precision': 0.9823558, 'binary_recall': 0.9076889, 'binary_specificity': 0.99825096, 'binary_f1_score': 0.9435475}
confusion matrix:
       0     1
0  42235    74
1    419  4120
---- Validation: 
scalar performance:
{'acc': 0.9693709, 'precision': 0.76817214, 'recall': 0.5987148, 'specificity': 0.5987148, 'f1': 0.64113414, 'auroc': 0.82259464, 'binary_precision': 0.562212, 'binary_recall': 0.2026578, 'binary_specificity': 0.9947719, 'binary_f1_score': 0.29792428}
confusion matrix:
       0    1
0  18076   95
1    480  122
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9648982, 'precision': 0.81745005, 'recall': 0.5931237, 'specificity': 0.5931237, 'f1': 0.63891023, 'auroc': 0.80112803, 'binary_precision': 0.6666667, 'binary_recall': 0.19008264, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.29581997}
confusion matrix:
      0   1
0  5974  23
1   196  46
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512107_13.png
early stop counter: 1
val acc:0.9693709015846252, best validation acc: 0.9694241881370544, corresponding to test acc:                         0.9650585055351257 / 0.9689052700996399
after epoch: 13,now: 2024-06-21 07:39:03.053597,epoch time: 0:37:25.898344,used: 6:07:41.476156,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_01_31_21_seed_2_21512107
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98870814, 'precision': 0.9830928, 'recall': 0.9515611, 'specificity': 0.9515611, 'f1': 0.9666543, 'auroc': 0.994193, 'binary_precision': 0.976247, 'binary_recall': 0.9054858, 'binary_specificity': 0.99763644, 'binary_f1_score': 0.939536}
confusion matrix:
       0     1
0  42209   100
1    429  4110
---- Validation: 
scalar performance:
{'acc': 0.9697438, 'precision': 0.7798472, 'recall': 0.59408915, 'specificity': 0.59408915, 'f1': 0.6372713, 'auroc': 0.82409275, 'binary_precision': 0.5858586, 'binary_recall': 0.19269103, 'binary_specificity': 0.99548733, 'binary_f1_score': 0.29}
confusion matrix:
       0    1
0  18089   82
1    486  116
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96473795, 'precision': 0.8225206, 'recall': 0.58510935, 'specificity': 0.58510935, 'f1': 0.62912226, 'auroc': 0.79679424, 'binary_precision': 0.67741936, 'binary_recall': 0.17355372, 'binary_specificity': 0.996665, 'binary_f1_score': 0.27631578}
confusion matrix:
      0   1
0  5977  20
1   200  42
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512107_14.png
better model found
persisted
after epoch: 14,now: 2024-06-21 08:21:43.715109,epoch time: 0:42:40.661512,used: 6:50:22.137668,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_01_31_21_seed_2_21512107
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99024504, 'precision': 0.9862482, 'recall': 0.95742726, 'specificity': 0.95742726, 'f1': 0.9712812, 'auroc': 0.9958093, 'binary_precision': 0.98136795, 'binary_recall': 0.91672176, 'binary_specificity': 0.99813277, 'binary_f1_score': 0.947944}
confusion matrix:
       0     1
0  42230    79
1    378  4161
---- Validation: 
scalar performance:
{'acc': 0.9691578, 'precision': 0.7689884, 'recall': 0.58093774, 'specificity': 0.58093774, 'f1': 0.6204958, 'auroc': 0.8207999, 'binary_precision': 0.56497175, 'binary_recall': 0.16611296, 'binary_specificity': 0.99576247, 'binary_f1_score': 0.2567394}
confusion matrix:
       0    1
0  18094   77
1    502  100
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642571, 'precision': 0.81683385, 'recall': 0.57692826, 'specificity': 0.57692826, 'f1': 0.6179352, 'auroc': 0.7897502, 'binary_precision': 0.6666667, 'binary_recall': 0.1570248, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.2541806}
confusion matrix:
      0   1
0  5978  19
1   204  38
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512107_15.png
early stop counter: 1
val acc:0.9691578149795532, best validation acc: 0.9697437882423401, corresponding to test acc:                         0.9647379517555237 / 0.9689052700996399
after epoch: 15,now: 2024-06-21 09:03:13.204109,epoch time: 0:41:29.489000,used: 7:31:51.626668,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_01_31_21_seed_2_21512107
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9904585, 'precision': 0.9863864, 'recall': 0.9585288, 'specificity': 0.9585288, 'f1': 0.9719382, 'auroc': 0.9950521, 'binary_precision': 0.98141176, 'binary_recall': 0.91892487, 'binary_specificity': 0.99813277, 'binary_f1_score': 0.94914097}
confusion matrix:
       0     1
0  42230    79
1    368  4171
---- Validation: 
scalar performance:
{'acc': 0.9688915, 'precision': 0.7614734, 'recall': 0.57999706, 'specificity': 0.57999706, 'f1': 0.6186559, 'auroc': 0.8147499, 'binary_precision': 0.55, 'binary_recall': 0.16445182, 'binary_specificity': 0.99554235, 'binary_f1_score': 0.25319692}
confusion matrix:
       0   1
0  18090  81
1    503  99
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96361595, 'precision': 0.7969736, 'recall': 0.574612, 'specificity': 0.574612, 'f1': 0.61360276, 'auroc': 0.7855799, 'binary_precision': 0.62711865, 'binary_recall': 0.15289256, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.24584718}
confusion matrix:
      0   1
0  5975  22
1   205  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512107_16.png
early stop counter: 2
val acc:0.9688915014266968, best validation acc: 0.9697437882423401, corresponding to test acc:                         0.9647379517555237 / 0.9689052700996399
after epoch: 16,now: 2024-06-21 09:43:30.298661,epoch time: 0:40:17.094552,used: 8:12:08.721220,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_01_31_21_seed_2_21512107
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9900743, 'precision': 0.9846164, 'recall': 0.95802104, 'specificity': 0.95802104, 'f1': 0.9708439, 'auroc': 0.99606836, 'binary_precision': 0.9779446, 'binary_recall': 0.9182639, 'binary_specificity': 0.99777824, 'binary_f1_score': 0.9471651}
confusion matrix:
       0     1
0  42215    94
1    371  4168
---- Validation: 
scalar performance:
{'acc': 0.9688915, 'precision': 0.75984746, 'recall': 0.58561844, 'specificity': 0.58561844, 'f1': 0.62522024, 'auroc': 0.82373285, 'binary_precision': 0.5463917, 'binary_recall': 0.17607974, 'binary_specificity': 0.9951571, 'binary_f1_score': 0.26633164}
confusion matrix:
       0    1
0  18083   88
1    496  106
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96297485, 'precision': 0.7757868, 'recall': 0.5762613, 'specificity': 0.5762613, 'f1': 0.61428875, 'auroc': 0.7870518, 'binary_precision': 0.5846154, 'binary_recall': 0.1570248, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.24755701}
confusion matrix:
      0   1
0  5970  27
1   204  38
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512107_17.png
early stop counter: 3
val acc:0.9688915014266968, best validation acc: 0.9697437882423401, corresponding to test acc:                         0.9647379517555237 / 0.9689052700996399
after epoch: 17,now: 2024-06-21 10:10:55.964906,epoch time: 0:27:25.666245,used: 8:39:34.387465,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_01_31_21_seed_2_21512107
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99075735, 'precision': 0.9834853, 'recall': 0.96311176, 'specificity': 0.96311176, 'f1': 0.97302055, 'auroc': 0.9962338, 'binary_precision': 0.97456646, 'binary_recall': 0.9288233, 'binary_specificity': 0.99740016, 'binary_f1_score': 0.95114523}
confusion matrix:
       0     1
0  42200   110
1    323  4215
---- Validation: 
scalar performance:
{'acc': 0.9685186, 'precision': 0.7496158, 'recall': 0.59104717, 'specificity': 0.59104717, 'f1': 0.6302655, 'auroc': 0.830455, 'binary_precision': 0.5255814, 'binary_recall': 0.18770765, 'binary_specificity': 0.9943867, 'binary_f1_score': 0.2766218}
confusion matrix:
       0    1
0  18069  102
1    489  113
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9632954, 'precision': 0.77523017, 'recall': 0.5922899, 'specificity': 0.5922899, 'f1': 0.6338837, 'auroc': 0.79656565, 'binary_precision': 0.5822785, 'binary_recall': 0.19008264, 'binary_specificity': 0.99449724, 'binary_f1_score': 0.28660434}
confusion matrix:
      0   1
0  5964  33
1   196  46
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512107_18.png
