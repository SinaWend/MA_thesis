Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0




!!!: not committed yet



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395448

 Experiment start at: 2024-06-18 03:17:06.819822
before training, model accuracy: 0.31128156185150146
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9663927, 'precision': 0.48319635, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49145457, 'auroc': 0.7340903, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42328  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.68806136, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.70643556, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395448_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-18 03:40:44.570318,epoch time: 0:23:37.750496,used: 0:23:37.750496,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395448
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9665525, 'precision': 0.7741631, 'recall': 0.5082792, 'specificity': 0.5082792, 'f1': 0.50799257, 'auroc': 0.8603717, 'binary_precision': 0.5813953, 'binary_recall': 0.016983695, 'binary_specificity': 0.9995747, 'binary_f1_score': 0.0330033}
confusion matrix:
       0   1
0  42310  18
1   1447  25
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.84158367, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.8331803, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395448_2.png
early stop counter: 1
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 2,now: 2024-06-18 04:03:06.858404,epoch time: 0:22:22.288086,used: 0:46:00.038582,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395448
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9662557, 'precision': 0.72786057, 'recall': 0.5415851, 'specificity': 0.5415851, 'f1': 0.5647194, 'auroc': 0.8910222, 'binary_precision': 0.48659003, 'binary_recall': 0.08633582, 'binary_specificity': 0.99683434, 'binary_f1_score': 0.14665127}
confusion matrix:
       0    1
0  42195  134
1   1344  127
---- Validation: 
scalar performance:
{'acc': 0.9656237, 'precision': 0.7118577, 'recall': 0.51191825, 'specificity': 0.51191825, 'f1': 0.5148468, 'auroc': 0.88308454, 'binary_precision': 0.45714286, 'binary_recall': 0.02488336, 'binary_specificity': 0.9989531, 'binary_f1_score': 0.04719764}
confusion matrix:
       0   1
0  18130  19
1    627  16
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.98022103, 'recall': 0.52681994, 'specificity': 0.52681994, 'f1': 0.54082, 'auroc': 0.8683181, 'binary_precision': 1.0, 'binary_recall': 0.053639848, 'binary_specificity': 1.0, 'binary_f1_score': 0.10181818}
confusion matrix:
      0   1
0  5997   0
1   247  14
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395448_3.png
new oracle model saved
early stop counter: 2
val acc:0.965623676776886, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9605305194854736
after epoch: 3,now: 2024-06-18 04:23:44.463352,epoch time: 0:20:37.604948,used: 1:06:37.643530,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395448
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9670548, 'precision': 0.7505331, 'recall': 0.58722585, 'specificity': 0.58722585, 'f1': 0.62588716, 'auroc': 0.9024083, 'binary_precision': 0.5289421, 'binary_recall': 0.18002717, 'binary_specificity': 0.9944245, 'binary_f1_score': 0.26862645}
confusion matrix:
       0    1
0  42092  236
1   1207  265
---- Validation: 
scalar performance:
{'acc': 0.9669008, 'precision': 0.7795037, 'recall': 0.55233234, 'specificity': 0.55233234, 'f1': 0.5823439, 'auroc': 0.8980251, 'binary_precision': 0.5897436, 'binary_recall': 0.10730949, 'binary_specificity': 0.9973552, 'binary_f1_score': 0.18157896}
confusion matrix:
       0   1
0  18101  48
1    574  69
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645254, 'precision': 0.9821515, 'recall': 0.57471263, 'specificity': 0.57471263, 'f1': 0.6209135, 'auroc': 0.8784592, 'binary_precision': 1.0, 'binary_recall': 0.14942528, 'binary_specificity': 1.0, 'binary_f1_score': 0.26}
confusion matrix:
      0   1
0  5997   0
1   222  39
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395448_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-18 04:45:54.141684,epoch time: 0:22:09.678332,used: 1:28:47.321862,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395448
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9663242, 'precision': 0.7352356, 'recall': 0.5993066, 'specificity': 0.5993066, 'f1': 0.6369793, 'auroc': 0.9106531, 'binary_precision': 0.49753696, 'binary_recall': 0.20584239, 'binary_specificity': 0.99277073, 'binary_f1_score': 0.29120615}
confusion matrix:
       0    1
0  42022  306
1   1169  303
---- Validation: 
scalar performance:
{'acc': 0.9671669, 'precision': 0.78804034, 'recall': 0.55622035, 'specificity': 0.55622035, 'f1': 0.5883532, 'auroc': 0.90614426, 'binary_precision': 0.60655737, 'binary_recall': 0.115085535, 'binary_specificity': 0.9973552, 'binary_f1_score': 0.19346406}
confusion matrix:
       0   1
0  18101  48
1    569  74
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964046, 'precision': 0.981919, 'recall': 0.5689655, 'specificity': 0.5689655, 'f1': 0.6120051, 'auroc': 0.87973297, 'binary_precision': 1.0, 'binary_recall': 0.13793103, 'binary_specificity': 1.0, 'binary_f1_score': 0.24242425}
confusion matrix:
      0   1
0  5997   0
1   225  36
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395448_5.png
better model found
persisted
after epoch: 5,now: 2024-06-18 05:08:59.533246,epoch time: 0:23:05.391562,used: 1:51:52.713424,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395448
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9676712, 'precision': 0.755769, 'recall': 0.6370518, 'specificity': 0.6370518, 'f1': 0.6767583, 'auroc': 0.9212446, 'binary_precision': 0.53608245, 'binary_recall': 0.2826087, 'binary_specificity': 0.991495, 'binary_f1_score': 0.37010673}
confusion matrix:
       0    1
0  41968  360
1   1056  416
---- Validation: 
scalar performance:
{'acc': 0.96695405, 'precision': 0.76697284, 'recall': 0.5741115, 'specificity': 0.5741115, 'f1': 0.611506, 'auroc': 0.9149819, 'binary_precision': 0.5632184, 'binary_recall': 0.15241058, 'binary_specificity': 0.9958124, 'binary_f1_score': 0.23990211}
confusion matrix:
       0   1
0  18073  76
1    545  98
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96644294, 'precision': 0.9737248, 'recall': 0.59953344, 'specificity': 0.59953344, 'f1': 0.6569999, 'auroc': 0.887432, 'binary_precision': 0.9811321, 'binary_recall': 0.19923371, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.33121017}
confusion matrix:
      0   1
0  5996   1
1   209  52
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395448_6.png
new oracle model saved
early stop counter: 1
val acc:0.9669540524482727, best validation acc: 0.9671669006347656, corresponding to test acc:                         0.9640460014343262 / 0.9664429426193237
after epoch: 6,now: 2024-06-18 05:29:51.640050,epoch time: 0:20:52.106804,used: 2:12:44.820228,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395448
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9672146, 'precision': 0.75060904, 'recall': 0.614521, 'specificity': 0.614521, 'f1': 0.6548262, 'auroc': 0.9220936, 'binary_precision': 0.5272727, 'binary_recall': 0.23641305, 'binary_specificity': 0.992629, 'binary_f1_score': 0.326454}
confusion matrix:
       0    1
0  42016  312
1   1124  348
---- Validation: 
scalar performance:
{'acc': 0.9671137, 'precision': 0.7745226, 'recall': 0.5696938, 'specificity': 0.5696938, 'f1': 0.6063124, 'auroc': 0.9161356, 'binary_precision': 0.5786164, 'binary_recall': 0.14307931, 'binary_specificity': 0.9963083, 'binary_f1_score': 0.22942644}
confusion matrix:
       0   1
0  18082  67
1    551  92
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96596354, 'precision': 0.98285025, 'recall': 0.591954, 'specificity': 0.591954, 'f1': 0.64661527, 'auroc': 0.88871384, 'binary_precision': 1.0, 'binary_recall': 0.18390805, 'binary_specificity': 1.0, 'binary_f1_score': 0.3106796}
confusion matrix:
      0   1
0  5997   0
1   213  48
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395448_7.png
early stop counter: 2
val acc:0.9671136736869812, best validation acc: 0.9671669006347656, corresponding to test acc:                         0.9640460014343262 / 0.9664429426193237
after epoch: 7,now: 2024-06-18 05:51:05.416668,epoch time: 0:21:13.776618,used: 2:33:58.596846,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395448
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.96762556, 'precision': 0.75603527, 'recall': 0.6285038, 'specificity': 0.6285038, 'f1': 0.6691321, 'auroc': 0.922799, 'binary_precision': 0.5371901, 'binary_recall': 0.26494566, 'binary_specificity': 0.992062, 'binary_f1_score': 0.35486808}
confusion matrix:
       0    1
0  41992  336
1   1082  390
---- Validation: 
scalar performance:
{'acc': 0.9671137, 'precision': 0.7799262, 'recall': 0.5621933, 'specificity': 0.5621933, 'f1': 0.596463, 'auroc': 0.91841894, 'binary_precision': 0.58992803, 'binary_recall': 0.12752722, 'binary_specificity': 0.9968593, 'binary_f1_score': 0.20971866}
confusion matrix:
       0   1
0  18092  57
1    561  82
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96356666, 'precision': 0.9816867, 'recall': 0.5632184, 'specificity': 0.5632184, 'f1': 0.60291743, 'auroc': 0.88457096, 'binary_precision': 1.0, 'binary_recall': 0.12643678, 'binary_specificity': 1.0, 'binary_f1_score': 0.2244898}
confusion matrix:
      0   1
0  5997   0
1   228  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395448_8.png
early stop counter: 3
val acc:0.9671136736869812, best validation acc: 0.9671669006347656, corresponding to test acc:                         0.9640460014343262 / 0.9664429426193237
after epoch: 8,now: 2024-06-18 06:14:38.394953,epoch time: 0:23:32.978285,used: 2:57:31.575131,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395448
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9681735, 'precision': 0.7639481, 'recall': 0.63534456, 'specificity': 0.63534456, 'f1': 0.6770223, 'auroc': 0.923193, 'binary_precision': 0.5525606, 'binary_recall': 0.2785326, 'binary_specificity': 0.9921565, 'binary_f1_score': 0.3703704}
confusion matrix:
       0    1
0  41996  332
1   1062  410
---- Validation: 
scalar performance:
{'acc': 0.9671669, 'precision': 0.7768566, 'recall': 0.56897134, 'specificity': 0.56897134, 'f1': 0.60550576, 'auroc': 0.92461526, 'binary_precision': 0.5833333, 'binary_recall': 0.1415241, 'binary_specificity': 0.99641854, 'binary_f1_score': 0.22778472}
confusion matrix:
       0   1
0  18084  65
1    552  91
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96356666, 'precision': 0.9816867, 'recall': 0.5632184, 'specificity': 0.5632184, 'f1': 0.60291743, 'auroc': 0.89069754, 'binary_precision': 1.0, 'binary_recall': 0.12643678, 'binary_specificity': 1.0, 'binary_f1_score': 0.2244898}
confusion matrix:
      0   1
0  5997   0
1   228  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395448_9.png
early stop counter: 4
val acc:0.9671669006347656, best validation acc: 0.9671669006347656, corresponding to test acc:                         0.9640460014343262 / 0.9664429426193237
after epoch: 9,now: 2024-06-18 06:38:17.690209,epoch time: 0:23:39.295256,used: 3:21:10.870387,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395448
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9666438, 'precision': 0.74099874, 'recall': 0.6270123, 'specificity': 0.6270123, 'f1': 0.664597, 'auroc': 0.9243108, 'binary_precision': 0.5072084, 'binary_recall': 0.2629076, 'binary_specificity': 0.991117, 'binary_f1_score': 0.34630874}
confusion matrix:
       0    1
0  41952  376
1   1085  387
---- Validation: 
scalar performance:
{'acc': 0.96748614, 'precision': 0.7791027, 'recall': 0.58188754, 'specificity': 0.58188754, 'f1': 0.6222812, 'auroc': 0.92772794, 'binary_precision': 0.5869565, 'binary_recall': 0.16796267, 'binary_specificity': 0.9958124, 'binary_f1_score': 0.261185}
confusion matrix:
       0    1
0  18073   76
1    535  108
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9643656, 'precision': 0.98207396, 'recall': 0.57279694, 'specificity': 0.57279694, 'f1': 0.6179637, 'auroc': 0.8932904, 'binary_precision': 1.0, 'binary_recall': 0.14559387, 'binary_specificity': 1.0, 'binary_f1_score': 0.25418058}
confusion matrix:
      0   1
0  5997   0
1   223  38
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395448_10.png
better model found
persisted
after epoch: 10,now: 2024-06-18 06:58:41.059808,epoch time: 0:20:23.369599,used: 3:41:34.239986,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395448
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96812785, 'precision': 0.7591945, 'recall': 0.6651563, 'specificity': 0.6651563, 'f1': 0.7007318, 'auroc': 0.9303445, 'binary_precision': 0.5410367, 'binary_recall': 0.34035325, 'binary_specificity': 0.98995936, 'binary_f1_score': 0.4178482}
confusion matrix:
       0    1
0  41903  425
1    971  501
---- Validation: 
scalar performance:
{'acc': 0.96737975, 'precision': 0.76665264, 'recall': 0.6050842, 'specificity': 0.6050842, 'f1': 0.64765143, 'auroc': 0.9325913, 'binary_precision': 0.5604839, 'binary_recall': 0.21617419, 'binary_specificity': 0.9939942, 'binary_f1_score': 0.31200898}
confusion matrix:
       0    1
0  18040  109
1    504  139
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96596354, 'precision': 0.9729253, 'recall': 0.59378636, 'specificity': 0.59378636, 'f1': 0.64883035, 'auroc': 0.8943268, 'binary_precision': 0.98, 'binary_recall': 0.18773946, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.31511253}
confusion matrix:
      0   1
0  5996   1
1   212  49
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395448_11.png
early stop counter: 1
val acc:0.9673797488212585, best validation acc: 0.9674861431121826, corresponding to test acc:                         0.9643656015396118 / 0.9664429426193237
after epoch: 11,now: 2024-06-18 07:21:02.217743,epoch time: 0:22:21.157935,used: 4:03:55.397921,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395448
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9691096, 'precision': 0.77804875, 'recall': 0.6423861, 'specificity': 0.6423861, 'f1': 0.6863836, 'auroc': 0.93399704, 'binary_precision': 0.5802969, 'binary_recall': 0.29211956, 'binary_specificity': 0.9926526, 'binary_f1_score': 0.38861275}
confusion matrix:
       0    1
0  42017  311
1   1042  430
---- Validation: 
scalar performance:
{'acc': 0.9673265, 'precision': 0.7792832, 'recall': 0.5735543, 'specificity': 0.5735543, 'f1': 0.61170167, 'auroc': 0.93078005, 'binary_precision': 0.58787876, 'binary_recall': 0.15085536, 'binary_specificity': 0.99625325, 'binary_f1_score': 0.240099}
confusion matrix:
       0   1
0  18081  68
1    546  97
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96356666, 'precision': 0.9816867, 'recall': 0.5632184, 'specificity': 0.5632184, 'f1': 0.60291743, 'auroc': 0.89139223, 'binary_precision': 1.0, 'binary_recall': 0.12643678, 'binary_specificity': 1.0, 'binary_f1_score': 0.2244898}
confusion matrix:
      0   1
0  5997   0
1   228  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395448_12.png
early stop counter: 2
val acc:0.9673265218734741, best validation acc: 0.9674861431121826, corresponding to test acc:                         0.9643656015396118 / 0.9664429426193237
after epoch: 12,now: 2024-06-18 07:44:30.430118,epoch time: 0:23:28.212375,used: 4:27:23.610296,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395448
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.968105, 'precision': 0.760432, 'recall': 0.64917195, 'specificity': 0.64917195, 'f1': 0.6882475, 'auroc': 0.93204886, 'binary_precision': 0.5445783, 'binary_recall': 0.30727395, 'binary_specificity': 0.99107, 'binary_f1_score': 0.39287266}
confusion matrix:
       0    1
0  41951  378
1   1019  452
---- Validation: 
scalar performance:
{'acc': 0.9675926, 'precision': 0.7823293, 'recall': 0.5819427, 'specificity': 0.5819427, 'f1': 0.6226254, 'auroc': 0.93305314, 'binary_precision': 0.5934066, 'binary_recall': 0.16796267, 'binary_specificity': 0.9959226, 'binary_f1_score': 0.26181817}
confusion matrix:
       0    1
0  18075   74
1    535  108
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96356666, 'precision': 0.9816867, 'recall': 0.5632184, 'specificity': 0.5632184, 'f1': 0.60291743, 'auroc': 0.8932986, 'binary_precision': 1.0, 'binary_recall': 0.12643678, 'binary_specificity': 1.0, 'binary_f1_score': 0.2244898}
confusion matrix:
      0   1
0  5997   0
1   228  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395448_13.png
better model found
persisted
after epoch: 13,now: 2024-06-18 08:04:21.720012,epoch time: 0:19:51.289894,used: 4:47:14.900190,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395448
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9693379, 'precision': 0.7785597, 'recall': 0.65276265, 'specificity': 0.65276265, 'f1': 0.69566303, 'auroc': 0.93318784, 'binary_precision': 0.58060455, 'binary_recall': 0.31339225, 'binary_specificity': 0.9921331, 'binary_f1_score': 0.407064}
confusion matrix:
       0    1
0  41996  333
1   1010  461
---- Validation: 
scalar performance:
{'acc': 0.967433, 'precision': 0.7736821, 'recall': 0.5893606, 'specificity': 0.5893606, 'f1': 0.6308212, 'auroc': 0.9361245, 'binary_precision': 0.57560974, 'binary_recall': 0.18351477, 'binary_specificity': 0.99520636, 'binary_f1_score': 0.2783019}
confusion matrix:
       0    1
0  18062   87
1    525  118
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9638862, 'precision': 0.98184156, 'recall': 0.5670498, 'specificity': 0.5670498, 'f1': 0.60899615, 'auroc': 0.8958627, 'binary_precision': 1.0, 'binary_recall': 0.13409962, 'binary_specificity': 1.0, 'binary_f1_score': 0.2364865}
confusion matrix:
      0   1
0  5997   0
1   226  35
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395448_14.png
early stop counter: 1
val acc:0.967432975769043, best validation acc: 0.9675925970077515, corresponding to test acc:                         0.9635666608810425 / 0.9664429426193237
after epoch: 14,now: 2024-06-18 08:26:39.264818,epoch time: 0:22:17.544806,used: 5:09:32.444996,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395448
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.96892697, 'precision': 0.7665827, 'recall': 0.6850312, 'specificity': 0.6850312, 'f1': 0.71772075, 'auroc': 0.9358798, 'binary_precision': 0.55445546, 'binary_recall': 0.3806934, 'binary_specificity': 0.989369, 'binary_f1_score': 0.45143092}
confusion matrix:
       0    1
0  41879  450
1    911  560
---- Validation: 
scalar performance:
{'acc': 0.96780545, 'precision': 0.7739967, 'recall': 0.61055493, 'specificity': 0.61055493, 'f1': 0.6545194, 'auroc': 0.9377576, 'binary_precision': 0.5748032, 'binary_recall': 0.22706065, 'binary_specificity': 0.99404925, 'binary_f1_score': 0.32552955}
confusion matrix:
       0    1
0  18041  108
1    497  146
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96756154, 'precision': 0.983629, 'recall': 0.6111111, 'specificity': 0.6111111, 'f1': 0.6734965, 'auroc': 0.8958608, 'binary_precision': 1.0, 'binary_recall': 0.22222222, 'binary_specificity': 1.0, 'binary_f1_score': 0.36363637}
confusion matrix:
      0   1
0  5997   0
1   203  58
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395448_15.png
new oracle model saved
better model found
persisted
after epoch: 15,now: 2024-06-18 08:49:46.946674,epoch time: 0:23:07.681856,used: 5:32:40.126852,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395448
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9696347, 'precision': 0.7824384, 'recall': 0.6570837, 'specificity': 0.6570837, 'f1': 0.7002833, 'auroc': 0.9348978, 'binary_precision': 0.58808935, 'binary_recall': 0.32201087, 'binary_specificity': 0.9921565, 'binary_f1_score': 0.41615453}
confusion matrix:
       0    1
0  41996  332
1    998  474
---- Validation: 
scalar performance:
{'acc': 0.9677522, 'precision': 0.7878629, 'recall': 0.5812752, 'specificity': 0.5812752, 'f1': 0.622246, 'auroc': 0.93688464, 'binary_precision': 0.6045198, 'binary_recall': 0.16640747, 'binary_specificity': 0.99614304, 'binary_f1_score': 0.26097563}
confusion matrix:
       0    1
0  18079   70
1    536  107
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96340686, 'precision': 0.98160934, 'recall': 0.56130266, 'specificity': 0.56130266, 'f1': 0.59984744, 'auroc': 0.89592093, 'binary_precision': 1.0, 'binary_recall': 0.12260536, 'binary_specificity': 1.0, 'binary_f1_score': 0.21843004}
confusion matrix:
      0   1
0  5997   0
1   229  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395448_16.png
early stop counter: 1
val acc:0.96775221824646, best validation acc: 0.9678054451942444, corresponding to test acc:                         0.9675615429878235 / 0.9675615429878235
after epoch: 16,now: 2024-06-18 09:12:12.360040,epoch time: 0:22:25.413366,used: 5:55:05.540218,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395448
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.96949774, 'precision': 0.77671564, 'recall': 0.66990614, 'specificity': 0.66990614, 'f1': 0.70935196, 'auroc': 0.93698144, 'binary_precision': 0.57575756, 'binary_recall': 0.34874237, 'binary_specificity': 0.99107, 'binary_f1_score': 0.43437767}
confusion matrix:
       0    1
0  41951  378
1    958  513
---- Validation: 
scalar performance:
{'acc': 0.9683908, 'precision': 0.79322314, 'recall': 0.60035723, 'specificity': 0.60035723, 'f1': 0.6457593, 'auroc': 0.93837404, 'binary_precision': 0.6139535, 'binary_recall': 0.20528771, 'binary_specificity': 0.9954268, 'binary_f1_score': 0.30769232}
confusion matrix:
       0    1
0  18066   83
1    511  132
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9637264, 'precision': 0.98176414, 'recall': 0.5651341, 'specificity': 0.5651341, 'f1': 0.6059669, 'auroc': 0.8975053, 'binary_precision': 1.0, 'binary_recall': 0.1302682, 'binary_specificity': 1.0, 'binary_f1_score': 0.23050848}
confusion matrix:
      0   1
0  5997   0
1   227  34
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395448_17.png
better model found
persisted
after epoch: 17,now: 2024-06-18 09:37:47.237194,epoch time: 0:25:34.877154,used: 6:20:40.417372,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395448
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9699543, 'precision': 0.78338456, 'recall': 0.67101926, 'specificity': 0.67101926, 'f1': 0.7120432, 'auroc': 0.9358345, 'binary_precision': 0.5890411, 'binary_recall': 0.35054347, 'binary_specificity': 0.991495, 'binary_f1_score': 0.43952298}
confusion matrix:
       0    1
0  41968  360
1    956  516
---- Validation: 
scalar performance:
{'acc': 0.968444, 'precision': 0.7973946, 'recall': 0.5966345, 'specificity': 0.5966345, 'f1': 0.6418701, 'auroc': 0.9386787, 'binary_precision': 0.622549, 'binary_recall': 0.19751166, 'binary_specificity': 0.99575734, 'binary_f1_score': 0.29988194}
confusion matrix:
       0    1
0  18072   77
1    516  127
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.98145473, 'recall': 0.5574713, 'specificity': 0.5574713, 'f1': 0.5936449, 'auroc': 0.8945464, 'binary_precision': 1.0, 'binary_recall': 0.11494253, 'binary_specificity': 1.0, 'binary_f1_score': 0.20618556}
confusion matrix:
      0   1
0  5997   0
1   231  30
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395448_18.png
better model found
persisted
after epoch: 18,now: 2024-06-18 10:01:43.785730,epoch time: 0:23:56.548536,used: 6:44:36.965908,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395448
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9692922, 'precision': 0.7787504, 'recall': 0.64823735, 'specificity': 0.64823735, 'f1': 0.69176435, 'auroc': 0.9366745, 'binary_precision': 0.5812744, 'binary_recall': 0.30408162, 'binary_specificity': 0.9923931, 'binary_f1_score': 0.3992854}
confusion matrix:
       0    1
0  42008  322
1   1023  447
---- Validation: 
scalar performance:
{'acc': 0.9683908, 'precision': 0.7982005, 'recall': 0.5936067, 'specificity': 0.5936067, 'f1': 0.6383456, 'auroc': 0.9412885, 'binary_precision': 0.6243655, 'binary_recall': 0.19129083, 'binary_specificity': 0.9959226, 'binary_f1_score': 0.29285714}
confusion matrix:
       0    1
0  18075   74
1    520  123
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96164906, 'precision': 0.98076, 'recall': 0.5402299, 'specificity': 0.5402299, 'f1': 0.56465936, 'auroc': 0.8947563, 'binary_precision': 1.0, 'binary_recall': 0.08045977, 'binary_specificity': 1.0, 'binary_f1_score': 0.14893617}
confusion matrix:
      0   1
0  5997   0
1   240  21
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395448_19.png
early stop counter: 1
val acc:0.9683908224105835, best validation acc: 0.9684439897537231, corresponding to test acc:                         0.963087260723114 / 0.9675615429878235
after epoch: 19,now: 2024-06-18 10:23:45.524397,epoch time: 0:22:01.738667,used: 7:06:38.704575,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395448
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.97041094, 'precision': 0.7874267, 'recall': 0.6804356, 'specificity': 0.6804356, 'f1': 0.7205837, 'auroc': 0.9372455, 'binary_precision': 0.5964912, 'binary_recall': 0.36956522, 'binary_specificity': 0.991306, 'binary_f1_score': 0.45637584}
confusion matrix:
       0    1
0  41960  368
1    928  544
---- Validation: 
scalar performance:
{'acc': 0.96855044, 'precision': 0.7992792, 'recall': 0.5981897, 'specificity': 0.5981897, 'f1': 0.6438994, 'auroc': 0.9411025, 'binary_precision': 0.6262136, 'binary_recall': 0.20062208, 'binary_specificity': 0.99575734, 'binary_f1_score': 0.30388692}
confusion matrix:
       0    1
0  18072   77
1    514  129
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96228826, 'precision': 0.9810685, 'recall': 0.5478927, 'specificity': 0.5478927, 'f1': 0.57776415, 'auroc': 0.89282894, 'binary_precision': 1.0, 'binary_recall': 0.09578544, 'binary_specificity': 1.0, 'binary_f1_score': 0.17482518}
confusion matrix:
      0   1
0  5997   0
1   236  25
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395448_20.png
better model found
persisted
after epoch: 20,now: 2024-06-18 10:44:43.726034,epoch time: 0:20:58.201637,used: 7:27:36.906212,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395448
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.97034246, 'precision': 0.7840656, 'recall': 0.6883883, 'specificity': 0.6883883, 'f1': 0.7256385, 'auroc': 0.93865174, 'binary_precision': 0.58921164, 'binary_recall': 0.38613188, 'binary_specificity': 0.9906447, 'binary_f1_score': 0.4665298}
confusion matrix:
       0    1
0  41933  396
1    903  568
---- Validation: 
scalar performance:
{'acc': 0.96961474, 'precision': 0.80392504, 'recall': 0.63024306, 'specificity': 0.63024306, 'f1': 0.67950916, 'auroc': 0.94460344, 'binary_precision': 0.6333333, 'binary_recall': 0.2659409, 'binary_specificity': 0.99454516, 'binary_f1_score': 0.37458926}
confusion matrix:
       0    1
0  18050   99
1    472  171
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642058, 'precision': 0.9819965, 'recall': 0.57088125, 'specificity': 0.57088125, 'f1': 0.6149943, 'auroc': 0.89872396, 'binary_precision': 1.0, 'binary_recall': 0.14176245, 'binary_specificity': 1.0, 'binary_f1_score': 0.24832213}
confusion matrix:
      0   1
0  5997   0
1   224  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395448_21.png
better model found
persisted
after epoch: 21,now: 2024-06-18 11:07:30.436427,epoch time: 0:22:46.710393,used: 7:50:23.616605,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395448
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.97, 'precision': 0.78189206, 'recall': 0.6792394, 'specificity': 0.6792394, 'f1': 0.7180821, 'auroc': 0.9386611, 'binary_precision': 0.58549786, 'binary_recall': 0.3675272, 'binary_specificity': 0.9909516, 'binary_f1_score': 0.451586}
confusion matrix:
       0    1
0  41945  383
1    931  541
---- Validation: 
scalar performance:
{'acc': 0.9691358, 'precision': 0.79736656, 'recall': 0.6232446, 'specificity': 0.6232446, 'f1': 0.6712973, 'auroc': 0.9434712, 'binary_precision': 0.62068963, 'binary_recall': 0.251944, 'binary_specificity': 0.99454516, 'binary_f1_score': 0.35840705}
confusion matrix:
       0    1
0  18050   99
1    481  162
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964046, 'precision': 0.981919, 'recall': 0.5689655, 'specificity': 0.5689655, 'f1': 0.6120051, 'auroc': 0.8976898, 'binary_precision': 1.0, 'binary_recall': 0.13793103, 'binary_specificity': 1.0, 'binary_f1_score': 0.24242425}
confusion matrix:
      0   1
0  5997   0
1   225  36
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395448_22.png
early stop counter: 1
val acc:0.9691358208656311, best validation acc: 0.9696147441864014, corresponding to test acc:                         0.964205801486969 / 0.9675615429878235
after epoch: 22,now: 2024-06-18 11:32:25.281068,epoch time: 0:24:54.844641,used: 8:15:18.461246,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395448
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.969726, 'precision': 0.7768266, 'recall': 0.685327, 'specificity': 0.685327, 'f1': 0.7211593, 'auroc': 0.94015706, 'binary_precision': 0.57494867, 'binary_recall': 0.38043478, 'binary_specificity': 0.99021924, 'binary_f1_score': 0.45789042}
confusion matrix:
       0    1
0  41914  414
1    912  560
---- Validation: 
scalar performance:
{'acc': 0.9692422, 'precision': 0.8058655, 'recall': 0.61429906, 'specificity': 0.61429906, 'f1': 0.6629694, 'auroc': 0.9424797, 'binary_precision': 0.63829786, 'binary_recall': 0.2332815, 'binary_specificity': 0.99531657, 'binary_f1_score': 0.34168562}
confusion matrix:
       0    1
0  18064   85
1    493  150
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964046, 'precision': 0.981919, 'recall': 0.5689655, 'specificity': 0.5689655, 'f1': 0.6120051, 'auroc': 0.8974724, 'binary_precision': 1.0, 'binary_recall': 0.13793103, 'binary_specificity': 1.0, 'binary_f1_score': 0.24242425}
confusion matrix:
      0   1
0  5997   0
1   225  36
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395448_23.png
early stop counter: 2
val acc:0.9692422151565552, best validation acc: 0.9696147441864014, corresponding to test acc:                         0.964205801486969 / 0.9675615429878235
after epoch: 23,now: 2024-06-18 11:58:27.267253,epoch time: 0:26:01.986185,used: 8:41:20.447431,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395448
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.97009134, 'precision': 0.78733224, 'recall': 0.6648607, 'specificity': 0.6648607, 'f1': 0.70803267, 'auroc': 0.9415761, 'binary_precision': 0.5973558, 'binary_recall': 0.33763587, 'binary_specificity': 0.99208564, 'binary_f1_score': 0.4314236}
confusion matrix:
       0    1
0  41993  335
1    975  497
---- Validation: 
scalar performance:
{'acc': 0.969189, 'precision': 0.8086095, 'recall': 0.60902107, 'specificity': 0.60902107, 'f1': 0.65743375, 'auroc': 0.94389784, 'binary_precision': 0.6441441, 'binary_recall': 0.22239502, 'binary_specificity': 0.99564713, 'binary_f1_score': 0.33063585}
confusion matrix:
       0    1
0  18070   79
1    500  143
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96276766, 'precision': 0.9813002, 'recall': 0.5536398, 'specificity': 0.5536398, 'f1': 0.5873577, 'auroc': 0.8953364, 'binary_precision': 1.0, 'binary_recall': 0.107279696, 'binary_specificity': 1.0, 'binary_f1_score': 0.19377163}
confusion matrix:
      0   1
0  5997   0
1   233  28
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395448_24.png
early stop counter: 3
val acc:0.9691889882087708, best validation acc: 0.9696147441864014, corresponding to test acc:                         0.964205801486969 / 0.9675615429878235
after epoch: 24,now: 2024-06-18 12:22:56.333965,epoch time: 0:24:29.066712,used: 9:05:49.514143,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395448
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9703653, 'precision': 0.78989166, 'recall': 0.67024827, 'specificity': 0.67024827, 'f1': 0.7131295, 'auroc': 0.94183207, 'binary_precision': 0.60211265, 'binary_recall': 0.34850544, 'binary_specificity': 0.9919911, 'binary_f1_score': 0.44148022}
confusion matrix:
       0    1
0  41989  339
1    959  513
---- Validation: 
scalar performance:
{'acc': 0.96929544, 'precision': 0.80394363, 'recall': 0.6188269, 'specificity': 0.6188269, 'f1': 0.667616, 'auroc': 0.94459724, 'binary_precision': 0.63414633, 'binary_recall': 0.24261275, 'binary_specificity': 0.9950411, 'binary_f1_score': 0.35095614}
confusion matrix:
       0    1
0  18059   90
1    487  156
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964046, 'precision': 0.981919, 'recall': 0.5689655, 'specificity': 0.5689655, 'f1': 0.6120051, 'auroc': 0.8978482, 'binary_precision': 1.0, 'binary_recall': 0.13793103, 'binary_specificity': 1.0, 'binary_f1_score': 0.24242425}
confusion matrix:
      0   1
0  5997   0
1   225  36
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395448_25.png
early stop counter: 4
val acc:0.9692954421043396, best validation acc: 0.9696147441864014, corresponding to test acc:                         0.964205801486969 / 0.9675615429878235
after epoch: 25,now: 2024-06-18 12:45:14.276431,epoch time: 0:22:17.942466,used: 9:28:07.456609,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395448
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.97077626, 'precision': 0.7863786, 'recall': 0.7032471, 'specificity': 0.7032471, 'f1': 0.73709184, 'auroc': 0.94213414, 'binary_precision': 0.59284335, 'binary_recall': 0.41644022, 'binary_specificity': 0.9900539, 'binary_f1_score': 0.48922586}
confusion matrix:
       0    1
0  41907  421
1    859  613
---- Validation: 
scalar performance:
{'acc': 0.969934, 'precision': 0.8003788, 'recall': 0.6484096, 'specificity': 0.6484096, 'f1': 0.696476, 'auroc': 0.94477284, 'binary_precision': 0.625, 'binary_recall': 0.30326593, 'binary_specificity': 0.99355334, 'binary_f1_score': 0.40837696}
confusion matrix:
       0    1
0  18032  117
1    448  195
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9653244, 'precision': 0.9825394, 'recall': 0.5842912, 'specificity': 0.5842912, 'f1': 0.6353768, 'auroc': 0.9000428, 'binary_precision': 1.0, 'binary_recall': 0.16858238, 'binary_specificity': 1.0, 'binary_f1_score': 0.28852457}
confusion matrix:
      0   1
0  5997   0
1   217  44
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395448_26.png
better model found
persisted
after epoch: 26,now: 2024-06-18 13:08:48.193710,epoch time: 0:23:33.917279,used: 9:51:41.373888,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395448
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.97061646, 'precision': 0.78833187, 'recall': 0.68656147, 'specificity': 0.68656147, 'f1': 0.72554445, 'auroc': 0.9446529, 'binary_precision': 0.5978723, 'binary_recall': 0.38205302, 'binary_specificity': 0.99107, 'binary_f1_score': 0.46619657}
confusion matrix:
       0    1
0  41951  378
1    909  562
---- Validation: 
scalar performance:
{'acc': 0.96934867, 'precision': 0.8098111, 'recall': 0.612854, 'specificity': 0.612854, 'f1': 0.6618799, 'auroc': 0.9442071, 'binary_precision': 0.6462882, 'binary_recall': 0.23017107, 'binary_specificity': 0.9955369, 'binary_f1_score': 0.33944952}
confusion matrix:
       0    1
0  18068   81
1    495  148
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96244806, 'precision': 0.98114574, 'recall': 0.54980844, 'specificity': 0.54980844, 'f1': 0.580984, 'auroc': 0.89654946, 'binary_precision': 1.0, 'binary_recall': 0.099616855, 'binary_specificity': 1.0, 'binary_f1_score': 0.18118466}
confusion matrix:
      0   1
0  5997   0
1   235  26
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395448_27.png
early stop counter: 1
val acc:0.969348669052124, best validation acc: 0.9699339866638184, corresponding to test acc:                         0.9653244018554688 / 0.9675615429878235
after epoch: 27,now: 2024-06-18 13:32:05.473253,epoch time: 0:23:17.279543,used: 10:14:58.653431,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395448
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9703196, 'precision': 0.78558326, 'recall': 0.6823555, 'specificity': 0.6823555, 'f1': 0.72153753, 'auroc': 0.9444362, 'binary_precision': 0.5926724, 'binary_recall': 0.3736413, 'binary_specificity': 0.99106973, 'binary_f1_score': 0.45833334}
confusion matrix:
       0    1
0  41950  378
1    922  550
---- Validation: 
scalar performance:
{'acc': 0.9694019, 'precision': 0.8093938, 'recall': 0.61513174, 'specificity': 0.61513174, 'f1': 0.6643456, 'auroc': 0.9439156, 'binary_precision': 0.64529914, 'binary_recall': 0.2348367, 'binary_specificity': 0.9954268, 'binary_f1_score': 0.34435576}
confusion matrix:
       0    1
0  18066   83
1    492  151
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96292746, 'precision': 0.9813774, 'recall': 0.5555556, 'specificity': 0.5555556, 'f1': 0.59051204, 'auroc': 0.8978423, 'binary_precision': 1.0, 'binary_recall': 0.11111111, 'binary_specificity': 1.0, 'binary_f1_score': 0.19999999}
confusion matrix:
      0   1
0  5997   0
1   232  29
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395448_28.png
early stop counter: 2
val acc:0.9694018959999084, best validation acc: 0.9699339866638184, corresponding to test acc:                         0.9653244018554688 / 0.9675615429878235
after epoch: 28,now: 2024-06-18 13:55:20.115967,epoch time: 0:23:14.642714,used: 10:38:13.296145,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395448
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.97159815, 'precision': 0.79445106, 'recall': 0.71252453, 'specificity': 0.71252453, 'f1': 0.7462547, 'auroc': 0.9440268, 'binary_precision': 0.608365, 'binary_recall': 0.4347826, 'binary_specificity': 0.9902665, 'binary_f1_score': 0.5071316}
confusion matrix:
       0    1
0  41916  412
1    832  640
---- Validation: 
scalar performance:
{'acc': 0.9703065, 'precision': 0.81268895, 'recall': 0.6403519, 'specificity': 0.6403519, 'f1': 0.6910932, 'auroc': 0.9472253, 'binary_precision': 0.6501767, 'binary_recall': 0.28615862, 'binary_specificity': 0.99454516, 'binary_f1_score': 0.3974082}
confusion matrix:
       0    1
0  18050   99
1    459  184
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96580374, 'precision': 0.96331465, 'recall': 0.593703, 'specificity': 0.593703, 'f1': 0.64828366, 'auroc': 0.8989854, 'binary_precision': 0.9607843, 'binary_recall': 0.18773946, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.31410256}
confusion matrix:
      0   1
0  5995   2
1   212  49
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395448_29.png
better model found
persisted
after epoch: 29,now: 2024-06-18 14:21:22.710140,epoch time: 0:26:02.594173,used: 11:04:15.890318,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395448
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9707078, 'precision': 0.7872927, 'recall': 0.69599867, 'specificity': 0.69599867, 'f1': 0.7322215, 'auroc': 0.94316125, 'binary_precision': 0.59516615, 'binary_recall': 0.40149456, 'binary_specificity': 0.9905027, 'binary_f1_score': 0.47951317}
confusion matrix:
       0    1
0  41926  402
1    881  591
---- Validation: 
scalar performance:
{'acc': 0.97020006, 'precision': 0.82047135, 'recall': 0.6267958, 'specificity': 0.6267958, 'f1': 0.6784676, 'auroc': 0.9457946, 'binary_precision': 0.6666667, 'binary_recall': 0.25816485, 'binary_specificity': 0.9954268, 'binary_f1_score': 0.3721973}
confusion matrix:
       0    1
0  18066   83
1    477  166
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96228826, 'precision': 0.9810685, 'recall': 0.5478927, 'specificity': 0.5478927, 'f1': 0.57776415, 'auroc': 0.8945996, 'binary_precision': 1.0, 'binary_recall': 0.09578544, 'binary_specificity': 1.0, 'binary_f1_score': 0.17482518}
confusion matrix:
      0   1
0  5997   0
1   236  25
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395448_30.png
early stop counter: 1
val acc:0.9702000617980957, best validation acc: 0.9703065156936646, corresponding to test acc:                         0.9658037424087524 / 0.9675615429878235
after epoch: 30,now: 2024-06-18 14:45:59.132478,epoch time: 0:24:36.422338,used: 11:28:52.312656,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395448
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 11:28:52.312656 at 2024-06-18 14:45:59.132478
persisted model performance metric: 

scalar performance:
{'acc': 0.96580374, 'precision': 0.96331465, 'recall': 0.593703, 'specificity': 0.593703, 'f1': 0.64828366, 'auroc': 0.8989854, 'binary_precision': 0.9607843, 'binary_recall': 0.18773946, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.31410256}
confusion matrix:
      0   1
0  5995   2
1   212  49
oracle model performance metric: 

scalar performance:
{'acc': 0.96756154, 'precision': 0.983629, 'recall': 0.6111111, 'specificity': 0.6111111, 'f1': 0.6734965, 'auroc': 0.8958608, 'binary_precision': 1.0, 'binary_recall': 0.22222222, 'binary_specificity': 1.0, 'binary_f1_score': 0.36363637}
confusion matrix:
      0   1
0  5997   0
1   203  58
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4_rest/rule_results/3.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4_rest/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4_rest/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204178 KiB |   1436 MiB | 395293 GiB | 395293 GiB |
|       from large pool | 167936 KiB |   1366 MiB | 395172 GiB | 395172 GiB |
|       from small pool |  36242 KiB |     72 MiB |    120 GiB |    120 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 204178 KiB |   1436 MiB | 395293 GiB | 395293 GiB |
|       from large pool | 167936 KiB |   1366 MiB | 395172 GiB | 395172 GiB |
|       from small pool |  36242 KiB |     72 MiB |    120 GiB |    120 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201088 KiB |   1428 MiB | 395270 GiB | 395270 GiB |
|       from large pool | 165120 KiB |   1358 MiB | 395152 GiB | 395152 GiB |
|       from small pool |  35968 KiB |     71 MiB |    118 GiB |    118 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1524 MiB |   1524 MiB |   1524 MiB |      0 B   |
|       from large pool |   1450 MiB |   1450 MiB |   1450 MiB |      0 B   |
|       from small pool |     74 MiB |     74 MiB |     74 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 320109 KiB | 749313 KiB | 284057 GiB | 284057 GiB |
|       from large pool | 311296 KiB | 748328 KiB | 283918 GiB | 283918 GiB |
|       from small pool |   8813 KiB |  12610 KiB |    138 GiB |    138 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1278    |    1935    |   13819 K  |   13817 K  |
|       from large pool |      36    |      76    |    4630 K  |    4630 K  |
|       from small pool |    1242    |    1864    |    9189 K  |    9187 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1278    |    1935    |   13819 K  |   13817 K  |
|       from large pool |      36    |      76    |    4630 K  |    4630 K  |
|       from small pool |    1242    |    1864    |    9189 K  |    9187 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      50    |      50    |      50    |       0    |
|       from large pool |      13    |      13    |      13    |       0    |
|       from small pool |      37    |      37    |      37    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      35    |     452    |    7386 K  |    7386 K  |
|       from large pool |       5    |      10    |    1938 K  |    1938 K  |
|       from small pool |      30    |     447    |    5447 K  |    5447 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1436 MiB | 395293 GiB | 395293 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 395172 GiB | 395172 GiB |
|       from small pool |      0 KiB |     72 MiB |    120 GiB |    120 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1436 MiB | 395293 GiB | 395293 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 395172 GiB | 395172 GiB |
|       from small pool |      0 KiB |     72 MiB |    120 GiB |    120 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1428 MiB | 395270 GiB | 395270 GiB |
|       from large pool |  16640 KiB |   1358 MiB | 395152 GiB | 395152 GiB |
|       from small pool |      0 KiB |     71 MiB |    118 GiB |    118 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 524288 KiB |   1524 MiB |   1524 MiB |   1012 MiB |
|       from large pool | 479232 KiB |   1450 MiB |   1450 MiB |    982 MiB |
|       from small pool |  45056 KiB |     74 MiB |     74 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 298752 KiB | 749313 KiB | 284057 GiB | 284057 GiB |
|       from large pool | 298752 KiB | 748328 KiB | 283918 GiB | 283918 GiB |
|       from small pool |      0 KiB |  16408 KiB |    138 GiB |    138 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1935    |   13819 K  |   13819 K  |
|       from large pool |       2    |      76    |    4630 K  |    4630 K  |
|       from small pool |       0    |    1864    |    9189 K  |    9189 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1935    |   13819 K  |   13819 K  |
|       from large pool |       2    |      76    |    4630 K  |    4630 K  |
|       from small pool |       0    |    1864    |    9189 K  |    9189 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      50    |      50    |      19    |
|       from large pool |       9    |      13    |      13    |       4    |
|       from small pool |      22    |      37    |      37    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     452    |    7386 K  |    7386 K  |
|       from large pool |       1    |      11    |    1938 K  |    1938 K  |
|       from small pool |       0    |     447    |    5448 K  |    5448 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

