Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0




!!!: not committed yet



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512111

 Experiment start at: 2024-06-19 23:10:44.364460
before training, model accuracy: 0.31128156185150146
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.94092464, 'precision': 0.96763635, 'recall': 0.6880378, 'specificity': 0.6880378, 'f1': 0.75730383, 'auroc': 0.94375336, 'binary_precision': 0.9964007, 'binary_recall': 0.37621745, 'binary_specificity': 0.9998582, 'binary_f1_score': 0.5462019}
confusion matrix:
       0     1
0  42299     6
1   2754  1661
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.5154476, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.532709, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512111_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-19 23:29:13.268489,epoch time: 0:18:28.904029,used: 0:18:28.904029,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512111
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9716182, 'precision': 0.9802207, 'recall': 0.8530077, 'specificity': 0.8530077, 'f1': 0.90467346, 'auroc': 0.9770752, 'binary_precision': 0.990165, 'binary_recall': 0.7067482, 'binary_specificity': 0.9992672, 'binary_f1_score': 0.8247886}
confusion matrix:
       0     1
0  42273    31
1   1295  3121
---- Validation: 
scalar performance:
{'acc': 0.9663687, 'precision': 0.78372204, 'recall': 0.5250549, 'specificity': 0.5250549, 'f1': 0.538711, 'auroc': 0.65271735, 'binary_precision': 0.6, 'binary_recall': 0.051321927, 'binary_specificity': 0.9987878, 'binary_f1_score': 0.09455588}
confusion matrix:
       0   1
0  18127  22
1    610  33
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.73002887, 'recall': 0.52198803, 'specificity': 0.52198803, 'f1': 0.53143567, 'auroc': 0.6954823, 'binary_precision': 0.5, 'binary_recall': 0.04597701, 'binary_specificity': 0.997999, 'binary_f1_score': 0.08421053}
confusion matrix:
      0   1
0  5985  12
1   249  12
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512111_2.png
better model found
persisted
after epoch: 2,now: 2024-06-19 23:46:23.885415,epoch time: 0:17:10.616926,used: 0:35:39.520955,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512111
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97925943, 'precision': 0.98117137, 'recall': 0.89615154, 'specificity': 0.89615154, 'f1': 0.93354845, 'auroc': 0.985639, 'binary_precision': 0.983427, 'binary_recall': 0.7936976, 'binary_specificity': 0.9986055, 'binary_f1_score': 0.8784343}
confusion matrix:
       0     1
0  42250    59
1    910  3501
---- Validation: 
scalar performance:
{'acc': 0.9665815, 'precision': 0.7646521, 'recall': 0.5529171, 'specificity': 0.5529171, 'f1': 0.5826169, 'auroc': 0.7035741, 'binary_precision': 0.56, 'binary_recall': 0.108864695, 'binary_specificity': 0.9969695, 'binary_f1_score': 0.18229166}
confusion matrix:
       0   1
0  18094  55
1    573  70
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.7834197, 'recall': 0.54839104, 'specificity': 0.54839104, 'f1': 0.5752086, 'auroc': 0.7310507, 'binary_precision': 0.60465115, 'binary_recall': 0.099616855, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.17105263}
confusion matrix:
      0   1
0  5980  17
1   235  26
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512111_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-20 00:05:06.498692,epoch time: 0:18:42.613277,used: 0:54:22.134232,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512111
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98311216, 'precision': 0.98374206, 'recall': 0.91649103, 'specificity': 0.91649103, 'f1': 0.94698733, 'auroc': 0.9892419, 'binary_precision': 0.984492, 'binary_recall': 0.834353, 'binary_specificity': 0.9986291, 'binary_f1_score': 0.9032258}
confusion matrix:
       0     1
0  42249    58
1    731  3682
---- Validation: 
scalar performance:
{'acc': 0.9665283, 'precision': 0.7567096, 'recall': 0.5663906, 'specificity': 0.5663906, 'f1': 0.6007657, 'auroc': 0.750955, 'binary_precision': 0.54320985, 'binary_recall': 0.13685848, 'binary_specificity': 0.9959226, 'binary_f1_score': 0.21863356}
confusion matrix:
       0   1
0  18075  74
1    555  88
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.8047465, 'recall': 0.5747941, 'specificity': 0.5747941, 'f1': 0.61387426, 'auroc': 0.7699462, 'binary_precision': 0.6451613, 'binary_recall': 0.1532567, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.247678}
confusion matrix:
      0   1
0  5975  22
1   221  40
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512111_4.png
new oracle model saved
early stop counter: 1
val acc:0.9665282964706421, best validation acc: 0.9665815234184265, corresponding to test acc:                         0.9597315192222595 / 0.9611697196960449
after epoch: 4,now: 2024-06-20 00:22:21.066963,epoch time: 0:17:14.568271,used: 1:11:36.702503,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512111
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9825342, 'precision': 0.9819586, 'recall': 0.9146688, 'specificity': 0.9146688, 'f1': 0.9451672, 'auroc': 0.9897249, 'binary_precision': 0.9812734, 'binary_recall': 0.8309923, 'binary_specificity': 0.9983454, 'binary_f1_score': 0.8999019}
confusion matrix:
       0     1
0  42236    70
1    746  3668
---- Validation: 
scalar performance:
{'acc': 0.9670072, 'precision': 0.7726936, 'recall': 0.5666385, 'specificity': 0.5666385, 'f1': 0.6021261, 'auroc': 0.74517846, 'binary_precision': 0.5751634, 'binary_recall': 0.13685848, 'binary_specificity': 0.99641854, 'binary_f1_score': 0.22110553}
confusion matrix:
       0   1
0  18084  65
1    555  88
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96196866, 'precision': 0.8492281, 'recall': 0.56788164, 'specificity': 0.56788164, 'f1': 0.6063797, 'auroc': 0.76161647, 'binary_precision': 0.7346939, 'binary_recall': 0.13793103, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.23225807}
confusion matrix:
      0   1
0  5984  13
1   225  36
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512111_5.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-06-20 00:41:04.291173,epoch time: 0:18:43.224210,used: 1:30:19.926713,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512111
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9849529, 'precision': 0.9799403, 'recall': 0.93065405, 'specificity': 0.93065405, 'f1': 0.95362794, 'auroc': 0.9903834, 'binary_precision': 0.9739197, 'binary_recall': 0.8637188, 'binary_specificity': 0.99758923, 'binary_f1_score': 0.91551495}
confusion matrix:
       0     1
0  42208   102
1    601  3809
---- Validation: 
scalar performance:
{'acc': 0.9669008, 'precision': 0.76008856, 'recall': 0.5898351, 'specificity': 0.5898351, 'f1': 0.62990355, 'auroc': 0.76444846, 'binary_precision': 0.5483871, 'binary_recall': 0.18506998, 'binary_specificity': 0.99460024, 'binary_f1_score': 0.2767442}
confusion matrix:
       0    1
0  18051   98
1    524  119
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96356666, 'precision': 0.8378419, 'recall': 0.60536206, 'specificity': 0.60536206, 'f1': 0.6553432, 'auroc': 0.7725154, 'binary_precision': 0.70886075, 'binary_recall': 0.21455939, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.32941175}
confusion matrix:
      0   1
0  5974  23
1   205  56
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512111_6.png
new oracle model saved
early stop counter: 1
val acc:0.9669008255004883, best validation acc: 0.9670072197914124, corresponding to test acc:                         0.9619686603546143 / 0.9635666608810425
after epoch: 6,now: 2024-06-20 00:57:05.753065,epoch time: 0:16:01.461892,used: 1:46:21.388605,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512111
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98600173, 'precision': 0.9835306, 'recall': 0.93359864, 'specificity': 0.93359864, 'f1': 0.95686483, 'auroc': 0.9912659, 'binary_precision': 0.9805627, 'binary_recall': 0.86899364, 'binary_specificity': 0.99820364, 'binary_f1_score': 0.9214131}
confusion matrix:
       0     1
0  42232    76
1    578  3834
---- Validation: 
scalar performance:
{'acc': 0.9668476, 'precision': 0.7606659, 'recall': 0.5830571, 'specificity': 0.5830571, 'f1': 0.6220081, 'auroc': 0.77735484, 'binary_precision': 0.55, 'binary_recall': 0.1710731, 'binary_specificity': 0.9950411, 'binary_f1_score': 0.2609727}
confusion matrix:
       0    1
0  18059   90
1    533  110
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96276766, 'precision': 0.83016753, 'recall': 0.5939512, 'specificity': 0.5939512, 'f1': 0.6405876, 'auroc': 0.7773203, 'binary_precision': 0.6944444, 'binary_recall': 0.19157088, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.3003003}
confusion matrix:
      0   1
0  5975  22
1   211  50
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512111_7.png
early stop counter: 2
val acc:0.9668475985527039, best validation acc: 0.9670072197914124, corresponding to test acc:                         0.9619686603546143 / 0.9635666608810425
after epoch: 7,now: 2024-06-20 01:15:55.953426,epoch time: 0:18:50.200361,used: 2:05:11.588966,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512111
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98636556, 'precision': 0.9832225, 'recall': 0.9360755, 'specificity': 0.9360755, 'f1': 0.95813584, 'auroc': 0.99212176, 'binary_precision': 0.97944164, 'binary_recall': 0.8740657, 'binary_specificity': 0.9980853, 'binary_f1_score': 0.92375827}
confusion matrix:
       0     1
0  42224    81
1    556  3859
---- Validation: 
scalar performance:
{'acc': 0.9673265, 'precision': 0.7732629, 'recall': 0.58405507, 'specificity': 0.58405507, 'f1': 0.62442094, 'auroc': 0.77145815, 'binary_precision': 0.5751295, 'binary_recall': 0.1726283, 'binary_specificity': 0.99548185, 'binary_f1_score': 0.26555023}
confusion matrix:
       0    1
0  18067   82
1    532  111
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96212846, 'precision': 0.80993277, 'recall': 0.59545004, 'specificity': 0.59545004, 'f1': 0.64071107, 'auroc': 0.7700747, 'binary_precision': 0.65384614, 'binary_recall': 0.1954023, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.30088496}
confusion matrix:
      0   1
0  5970  27
1   210  51
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512111_8.png
better model found
persisted
after epoch: 8,now: 2024-06-20 01:32:06.116060,epoch time: 0:16:10.162634,used: 2:21:21.751600,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512111
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.987286, 'precision': 0.98209554, 'recall': 0.94254273, 'specificity': 0.94254273, 'f1': 0.9612584, 'auroc': 0.9930116, 'binary_precision': 0.9758285, 'binary_recall': 0.8873782, 'binary_specificity': 0.99770725, 'binary_f1_score': 0.9295039}
confusion matrix:
       0     1
0  42210    97
1    497  3916
---- Validation: 
scalar performance:
{'acc': 0.9667944, 'precision': 0.7558828, 'recall': 0.5980306, 'specificity': 0.5980306, 'f1': 0.6385575, 'auroc': 0.7916018, 'binary_precision': 0.5394191, 'binary_recall': 0.2021773, 'binary_specificity': 0.99388397, 'binary_f1_score': 0.29411766}
confusion matrix:
       0    1
0  18038  111
1    513  130
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96228826, 'precision': 0.8085401, 'recall': 0.6010304, 'specificity': 0.6010304, 'f1': 0.64728236, 'auroc': 0.79683137, 'binary_precision': 0.6506024, 'binary_recall': 0.20689656, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.31395352}
confusion matrix:
      0   1
0  5968  29
1   207  54
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512111_9.png
early stop counter: 1
val acc:0.9667943716049194, best validation acc: 0.9673265218734741, corresponding to test acc:                         0.9621284604072571 / 0.9635666608810425
after epoch: 9,now: 2024-06-20 01:47:59.275743,epoch time: 0:15:53.159683,used: 2:37:14.911283,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512111
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9886344, 'precision': 0.9853627, 'recall': 0.9474715, 'specificity': 0.9474715, 'f1': 0.9654523, 'auroc': 0.993642, 'binary_precision': 0.98140806, 'binary_recall': 0.89671576, 'binary_specificity': 0.9982272, 'binary_f1_score': 0.9371524}
confusion matrix:
       0     1
0  42230    75
1    456  3959
---- Validation: 
scalar performance:
{'acc': 0.96663475, 'precision': 0.7537738, 'recall': 0.5904474, 'specificity': 0.5904474, 'f1': 0.62987006, 'auroc': 0.7929448, 'binary_precision': 0.53571427, 'binary_recall': 0.1866252, 'binary_specificity': 0.99426967, 'binary_f1_score': 0.27681664}
confusion matrix:
       0    1
0  18045  104
1    523  120
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9600511, 'precision': 0.77838147, 'recall': 0.5650488, 'specificity': 0.5650488, 'f1': 0.59912574, 'auroc': 0.7799698, 'binary_precision': 0.59322035, 'binary_recall': 0.13409962, 'binary_specificity': 0.995998, 'binary_f1_score': 0.21875001}
confusion matrix:
      0   1
0  5973  24
1   226  35
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512111_10.png
early stop counter: 2
val acc:0.9666347503662109, best validation acc: 0.9673265218734741, corresponding to test acc:                         0.9621284604072571 / 0.9635666608810425
after epoch: 10,now: 2024-06-20 02:04:05.838385,epoch time: 0:16:06.562642,used: 2:53:21.473925,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512111
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98891264, 'precision': 0.98394144, 'recall': 0.95045424, 'specificity': 0.95045424, 'f1': 0.9664446, 'auroc': 0.99408555, 'binary_precision': 0.9779195, 'binary_recall': 0.9030358, 'binary_specificity': 0.99787265, 'binary_f1_score': 0.938987}
confusion matrix:
       0     1
0  42216    90
1    428  3986
---- Validation: 
scalar performance:
{'acc': 0.96722007, 'precision': 0.7649281, 'recall': 0.5990011, 'specificity': 0.5990011, 'f1': 0.64081174, 'auroc': 0.7966769, 'binary_precision': 0.55744684, 'binary_recall': 0.2037325, 'binary_specificity': 0.99426967, 'binary_f1_score': 0.29840547}
confusion matrix:
       0    1
0  18045  104
1    512  131
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9603707, 'precision': 0.77807623, 'recall': 0.5780419, 'specificity': 0.5780419, 'f1': 0.6163287, 'auroc': 0.78281176, 'binary_precision': 0.5915493, 'binary_recall': 0.16091955, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.25301206}
confusion matrix:
      0   1
0  5968  29
1   219  42
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512111_11.png
early stop counter: 3
val acc:0.9672200679779053, best validation acc: 0.9673265218734741, corresponding to test acc:                         0.9621284604072571 / 0.9635666608810425
after epoch: 11,now: 2024-06-20 02:20:51.102519,epoch time: 0:16:45.264134,used: 3:10:06.738059,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512111
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98985445, 'precision': 0.9839455, 'recall': 0.95604706, 'specificity': 0.95604706, 'f1': 0.969476, 'auroc': 0.99504054, 'binary_precision': 0.9767667, 'binary_recall': 0.9143634, 'binary_specificity': 0.9977308, 'binary_f1_score': 0.94453543}
confusion matrix:
       0     1
0  42210    96
1    378  4036
---- Validation: 
scalar performance:
{'acc': 0.9673265, 'precision': 0.7683266, 'recall': 0.5960559, 'specificity': 0.5960559, 'f1': 0.63795185, 'auroc': 0.80234945, 'binary_precision': 0.5644444, 'binary_recall': 0.19751166, 'binary_specificity': 0.99460024, 'binary_f1_score': 0.2926267}
confusion matrix:
       0    1
0  18051   98
1    516  127
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.7834983, 'recall': 0.5651322, 'specificity': 0.5651322, 'f1': 0.59951043, 'auroc': 0.79211044, 'binary_precision': 0.6034483, 'binary_recall': 0.13409962, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.21943574}
confusion matrix:
      0   1
0  5974  23
1   226  35
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512111_12.png
early stop counter: 4
val acc:0.9673265218734741, best validation acc: 0.9673265218734741, corresponding to test acc:                         0.9621284604072571 / 0.9635666608810425
after epoch: 12,now: 2024-06-20 02:36:25.006771,epoch time: 0:15:33.904252,used: 3:25:40.642311,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512111
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9893836, 'precision': 0.98352027, 'recall': 0.9536463, 'specificity': 0.9536463, 'f1': 0.96798515, 'auroc': 0.99564135, 'binary_precision': 0.9764048, 'binary_recall': 0.9095853, 'binary_specificity': 0.99770725, 'binary_f1_score': 0.9418113}
confusion matrix:
       0     1
0  42210    97
1    399  4014
---- Validation: 
scalar performance:
{'acc': 0.9669008, 'precision': 0.75724393, 'recall': 0.60258603, 'specificity': 0.60258603, 'f1': 0.64364886, 'auroc': 0.81479484, 'binary_precision': 0.5418327, 'binary_recall': 0.21150856, 'binary_specificity': 0.99366355, 'binary_f1_score': 0.30425057}
confusion matrix:
       0    1
0  18034  115
1    507  136
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606903, 'precision': 0.7882024, 'recall': 0.5763763, 'specificity': 0.5763763, 'f1': 0.6149081, 'auroc': 0.8076351, 'binary_precision': 0.6119403, 'binary_recall': 0.15708812, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.25}
confusion matrix:
      0   1
0  5971  26
1   220  41
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512111_13.png
early stop counter: 5
val acc:0.9669008255004883, best validation acc: 0.9673265218734741, corresponding to test acc:                         0.9621284604072571 / 0.9635666608810425
after epoch: 13,now: 2024-06-20 02:52:04.726705,epoch time: 0:15:39.719934,used: 3:41:20.362245,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512111
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99032533, 'precision': 0.98572195, 'recall': 0.9571283, 'specificity': 0.9571283, 'f1': 0.97088045, 'auroc': 0.9962857, 'binary_precision': 0.98013085, 'binary_recall': 0.9161948, 'binary_specificity': 0.9980617, 'binary_f1_score': 0.947085}
confusion matrix:
       0     1
0  42223    82
1    370  4045
---- Validation: 
scalar performance:
{'acc': 0.96706045, 'precision': 0.76518214, 'recall': 0.5861675, 'specificity': 0.5861675, 'f1': 0.626168, 'auroc': 0.8035525, 'binary_precision': 0.5588235, 'binary_recall': 0.17729394, 'binary_specificity': 0.9950411, 'binary_f1_score': 0.26918536}
confusion matrix:
       0    1
0  18059   90
1    529  114
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.7686506, 'recall': 0.56488204, 'specificity': 0.56488204, 'f1': 0.5983627, 'auroc': 0.79188204, 'binary_precision': 0.57377046, 'binary_recall': 0.13409962, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.21739131}
confusion matrix:
      0   1
0  5971  26
1   226  35
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512111_14.png
early stop counter: 6
val acc:0.9670604467391968, best validation acc: 0.9673265218734741, corresponding to test acc:                         0.9621284604072571 / 0.9635666608810425
after epoch: 14,now: 2024-06-20 03:07:37.346861,epoch time: 0:15:32.620156,used: 3:56:52.982401,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512111
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98976886, 'precision': 0.9831598, 'recall': 0.9562946, 'specificity': 0.9562946, 'f1': 0.96924436, 'auroc': 0.9949986, 'binary_precision': 0.9751268, 'binary_recall': 0.9150238, 'binary_specificity': 0.9975654, 'binary_f1_score': 0.94411975}
confusion matrix:
       0     1
0  42204   103
1    375  4038
---- Validation: 
scalar performance:
{'acc': 0.9672733, 'precision': 0.76440924, 'recall': 0.6050291, 'specificity': 0.6050291, 'f1': 0.6472743, 'auroc': 0.81544286, 'binary_precision': 0.556, 'binary_recall': 0.21617419, 'binary_specificity': 0.99388397, 'binary_f1_score': 0.3113102}
confusion matrix:
       0    1
0  18038  111
1    504  139
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589326, 'precision': 0.74618614, 'recall': 0.56812984, 'specificity': 0.56812984, 'f1': 0.6012367, 'auroc': 0.79355705, 'binary_precision': 0.5285714, 'binary_recall': 0.14176245, 'binary_specificity': 0.99449724, 'binary_f1_score': 0.22356497}
confusion matrix:
      0   1
0  5964  33
1   224  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512111_15.png
early stop counter: 7
val acc:0.9672732949256897, best validation acc: 0.9673265218734741, corresponding to test acc:                         0.9621284604072571 / 0.9635666608810425
after epoch: 15,now: 2024-06-20 03:23:18.420849,epoch time: 0:15:41.073988,used: 4:12:34.056389,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512111
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9910317, 'precision': 0.9877506, 'recall': 0.95931697, 'specificity': 0.95931697, 'f1': 0.9729979, 'auroc': 0.9951935, 'binary_precision': 0.9837654, 'binary_recall': 0.9202176, 'binary_specificity': 0.99841636, 'binary_f1_score': 0.95093095}
confusion matrix:
       0     1
0  42241    67
1    352  4060
---- Validation: 
scalar performance:
{'acc': 0.9671137, 'precision': 0.7652408, 'recall': 0.5899453, 'specificity': 0.5899453, 'f1': 0.63060546, 'auroc': 0.81766164, 'binary_precision': 0.5586854, 'binary_recall': 0.18506998, 'binary_specificity': 0.99482065, 'binary_f1_score': 0.27803737}
confusion matrix:
       0    1
0  18055   94
1    524  119
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.7410728, 'recall': 0.54780746, 'specificity': 0.54780746, 'f1': 0.5729909, 'auroc': 0.79255164, 'binary_precision': 0.52, 'binary_recall': 0.099616855, 'binary_specificity': 0.995998, 'binary_f1_score': 0.16720255}
confusion matrix:
      0   1
0  5973  24
1   235  26
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512111_16.png
early stop counter: 8
val acc:0.9671136736869812, best validation acc: 0.9673265218734741, corresponding to test acc:                         0.9621284604072571 / 0.9635666608810425
after epoch: 16,now: 2024-06-20 03:39:14.654981,epoch time: 0:15:56.234132,used: 4:28:30.290521,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512111
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9912243, 'precision': 0.98745227, 'recall': 0.96074295, 'specificity': 0.96074295, 'f1': 0.9736251, 'auroc': 0.9961479, 'binary_precision': 0.9828668, 'binary_recall': 0.92316407, 'binary_specificity': 0.99832183, 'binary_f1_score': 0.95208037}
confusion matrix:
       0     1
0  42237    71
1    339  4073
---- Validation: 
scalar performance:
{'acc': 0.96706045, 'precision': 0.765448, 'recall': 0.58541745, 'specificity': 0.58541745, 'f1': 0.6253035, 'auroc': 0.8154776, 'binary_precision': 0.5594059, 'binary_recall': 0.17573872, 'binary_specificity': 0.99509615, 'binary_f1_score': 0.2674556}
confusion matrix:
       0    1
0  18060   89
1    530  113
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.74022496, 'recall': 0.55330443, 'specificity': 0.55330443, 'f1': 0.58086705, 'auroc': 0.7966007, 'binary_precision': 0.51785713, 'binary_recall': 0.11111111, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.18296531}
confusion matrix:
      0   1
0  5970  27
1   232  29
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512111_17.png
early stop counter: 9
val acc:0.9670604467391968, best validation acc: 0.9673265218734741, corresponding to test acc:                         0.9621284604072571 / 0.9635666608810425
after epoch: 17,now: 2024-06-20 03:55:06.243947,epoch time: 0:15:51.588966,used: 4:44:21.879487,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512111
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9907748, 'precision': 0.986428, 'recall': 0.95907366, 'specificity': 0.95907366, 'f1': 0.9722538, 'auroc': 0.9958422, 'binary_precision': 0.98114574, 'binary_recall': 0.91999096, 'binary_specificity': 0.99815637, 'binary_f1_score': 0.9495848}
confusion matrix:
       0     1
0  42230    78
1    353  4059
---- Validation: 
scalar performance:
{'acc': 0.9671137, 'precision': 0.76277345, 'recall': 0.5981959, 'specificity': 0.5981959, 'f1': 0.6396456, 'auroc': 0.8277791, 'binary_precision': 0.5531915, 'binary_recall': 0.2021773, 'binary_specificity': 0.99421453, 'binary_f1_score': 0.29612756}
confusion matrix:
       0    1
0  18044  105
1    513  130
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9576542, 'precision': 0.71388763, 'recall': 0.5491395, 'specificity': 0.5491395, 'f1': 0.5737762, 'auroc': 0.7977661, 'binary_precision': 0.46551725, 'binary_recall': 0.10344828, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.169279}
confusion matrix:
      0   1
0  5966  31
1   234  27
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512111_18.png
early stop counter: 10
val acc:0.9671136736869812, best validation acc: 0.9673265218734741, corresponding to test acc:                         0.9621284604072571 / 0.9635666608810425
after epoch: 18,now: 2024-06-20 04:11:04.245786,epoch time: 0:15:58.001839,used: 5:00:19.881326,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512111
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9914598, 'precision': 0.9859477, 'recall': 0.9636297, 'specificity': 0.9636297, 'f1': 0.9744588, 'auroc': 0.99686325, 'binary_precision': 0.9792313, 'binary_recall': 0.9293158, 'binary_specificity': 0.9979436, 'binary_f1_score': 0.9536208}
confusion matrix:
       0     1
0  42219    87
1    312  4102
---- Validation: 
scalar performance:
{'acc': 0.9663687, 'precision': 0.74702805, 'recall': 0.6000604, 'specificity': 0.6000604, 'f1': 0.6394933, 'auroc': 0.8281621, 'binary_precision': 0.52156866, 'binary_recall': 0.20684293, 'binary_specificity': 0.99327785, 'binary_f1_score': 0.29621384}
confusion matrix:
       0    1
0  18027  122
1    510  133
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.7422465, 'recall': 0.5698788, 'specificity': 0.5698788, 'f1': 0.60318303, 'auroc': 0.8041792, 'binary_precision': 0.5205479, 'binary_recall': 0.14559387, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.2275449}
confusion matrix:
      0   1
0  5962  35
1   223  38
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512111_19.png
early stop counter: 11
val acc:0.9663686752319336, best validation acc: 0.9673265218734741, corresponding to test acc:                         0.9621284604072571 / 0.9635666608810425
after epoch: 19,now: 2024-06-20 04:26:55.985478,epoch time: 0:15:51.739692,used: 5:16:11.621018,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512111
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99197346, 'precision': 0.98803806, 'recall': 0.9646157, 'specificity': 0.9646157, 'f1': 0.975965, 'auroc': 0.9976984, 'binary_precision': 0.98324555, 'binary_recall': 0.93088603, 'binary_specificity': 0.99834543, 'binary_f1_score': 0.9563496}
confusion matrix:
       0     1
0  42237    70
1    305  4108
---- Validation: 
scalar performance:
{'acc': 0.9669008, 'precision': 0.7586306, 'recall': 0.59583557, 'specificity': 0.59583557, 'f1': 0.6365049, 'auroc': 0.82190585, 'binary_precision': 0.5450644, 'binary_recall': 0.19751166, 'binary_specificity': 0.99415946, 'binary_f1_score': 0.2899543}
confusion matrix:
       0    1
0  18043  106
1    516  127
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9576542, 'precision': 0.7157279, 'recall': 0.55463654, 'specificity': 0.55463654, 'f1': 0.581439, 'auroc': 0.79506135, 'binary_precision': 0.46875, 'binary_recall': 0.11494253, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.18461537}
confusion matrix:
      0   1
0  5963  34
1   231  30
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512111_20.png
early stop counter: 12
val acc:0.9669008255004883, best validation acc: 0.9673265218734741, corresponding to test acc:                         0.9621284604072571 / 0.9635666608810425
after epoch: 20,now: 2024-06-20 04:42:50.623557,epoch time: 0:15:54.638079,used: 5:32:06.259097,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512111
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9918664, 'precision': 0.9888071, 'recall': 0.96323735, 'specificity': 0.96323735, 'f1': 0.97559094, 'auroc': 0.9968953, 'binary_precision': 0.9850854, 'binary_recall': 0.9279402, 'binary_specificity': 0.9985345, 'binary_f1_score': 0.9556593}
confusion matrix:
       0     1
0  42245    62
1    318  4095
---- Validation: 
scalar performance:
{'acc': 0.96674114, 'precision': 0.7553015, 'recall': 0.59500283, 'specificity': 0.59500283, 'f1': 0.63515824, 'auroc': 0.8223782, 'binary_precision': 0.53846157, 'binary_recall': 0.19595645, 'binary_specificity': 0.99404925, 'binary_f1_score': 0.2873432}
confusion matrix:
       0    1
0  18041  108
1    517  126
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95701504, 'precision': 0.70096314, 'recall': 0.5524707, 'specificity': 0.5524707, 'f1': 0.5776505, 'auroc': 0.80224997, 'binary_precision': 0.43939394, 'binary_recall': 0.11111111, 'binary_specificity': 0.99383026, 'binary_f1_score': 0.17737004}
confusion matrix:
      0   1
0  5960  37
1   232  29
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512111_21.png
early stop counter: 13
val acc:0.966741144657135, best validation acc: 0.9673265218734741, corresponding to test acc:                         0.9621284604072571 / 0.9635666608810425
after epoch: 21,now: 2024-06-20 04:59:40.330158,epoch time: 0:16:49.706601,used: 5:48:55.965698,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512111
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99190927, 'precision': 0.98810315, 'recall': 0.96418226, 'specificity': 0.96418226, 'f1': 0.97576517, 'auroc': 0.99778694, 'binary_precision': 0.98346907, 'binary_recall': 0.9299955, 'binary_specificity': 0.99836904, 'binary_f1_score': 0.95598507}
confusion matrix:
       0     1
0  42237    69
1    309  4105
---- Validation: 
scalar performance:
{'acc': 0.96647507, 'precision': 0.7501319, 'recall': 0.5911148, 'specificity': 0.5911148, 'f1': 0.63018113, 'auroc': 0.82264054, 'binary_precision': 0.52838427, 'binary_recall': 0.1881804, 'binary_specificity': 0.99404925, 'binary_f1_score': 0.27752295}
confusion matrix:
       0    1
0  18041  108
1    522  121
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95733464, 'precision': 0.71006787, 'recall': 0.55813444, 'specificity': 0.55813444, 'f1': 0.58572066, 'auroc': 0.79622203, 'binary_precision': 0.45714286, 'binary_recall': 0.12260536, 'binary_specificity': 0.9936635, 'binary_f1_score': 0.19335347}
confusion matrix:
      0   1
0  5959  38
1   229  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512111_22.png
early stop counter: 14
val acc:0.9664750695228577, best validation acc: 0.9673265218734741, corresponding to test acc:                         0.9621284604072571 / 0.9635666608810425
after epoch: 22,now: 2024-06-20 05:15:59.487398,epoch time: 0:16:19.157240,used: 6:05:15.122938,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512111
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9916096, 'precision': 0.9897102, 'recall': 0.960889, 'specificity': 0.960889, 'f1': 0.97475123, 'auroc': 0.99586093, 'binary_precision': 0.9874031, 'binary_recall': 0.92300725, 'binary_specificity': 0.9987708, 'binary_f1_score': 0.95411986}
confusion matrix:
       0     1
0  42252    52
1    340  4076
---- Validation: 
scalar performance:
{'acc': 0.96695405, 'precision': 0.76697284, 'recall': 0.5741115, 'specificity': 0.5741115, 'f1': 0.611506, 'auroc': 0.8253349, 'binary_precision': 0.5632184, 'binary_recall': 0.15241058, 'binary_specificity': 0.9958124, 'binary_f1_score': 0.23990211}
confusion matrix:
       0   1
0  18073  76
1    545  98
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.7365863, 'recall': 0.5403947, 'specificity': 0.5403947, 'f1': 0.5617232, 'auroc': 0.79591155, 'binary_precision': 0.5116279, 'binary_recall': 0.08429119, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.14473684}
confusion matrix:
      0   1
0  5976  21
1   239  22
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512111_23.png
early stop counter: 15
val acc:0.9669540524482727, best validation acc: 0.9673265218734741, corresponding to test acc:                         0.9621284604072571 / 0.9635666608810425
after epoch: 23,now: 2024-06-20 05:32:20.736846,epoch time: 0:16:21.249448,used: 6:21:36.372386,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512111
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9915454, 'precision': 0.98818576, 'recall': 0.9619522, 'specificity': 0.9619522, 'f1': 0.9746141, 'auroc': 0.9965453, 'binary_precision': 0.9841002, 'binary_recall': 0.92546445, 'binary_specificity': 0.9984399, 'binary_f1_score': 0.9538821}
confusion matrix:
       0     1
0  42240    66
1    329  4085
---- Validation: 
scalar performance:
{'acc': 0.96695405, 'precision': 0.76508534, 'recall': 0.57861185, 'specificity': 0.57861185, 'f1': 0.6170045, 'auroc': 0.8284868, 'binary_precision': 0.5591398, 'binary_recall': 0.16174184, 'binary_specificity': 0.99548185, 'binary_f1_score': 0.2509047}
confusion matrix:
       0    1
0  18067   82
1    539  104
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.7307692, 'recall': 0.54031134, 'specificity': 0.54031134, 'f1': 0.56144404, 'auroc': 0.799477, 'binary_precision': 0.5, 'binary_recall': 0.08429119, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.14426228}
confusion matrix:
      0   1
0  5975  22
1   239  22
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512111_24.png
early stop counter: 16
val acc:0.9669540524482727, best validation acc: 0.9673265218734741, corresponding to test acc:                         0.9621284604072571 / 0.9635666608810425
after epoch: 24,now: 2024-06-20 05:48:24.005435,epoch time: 0:16:03.268589,used: 6:37:39.640975,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512111
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9932791, 'precision': 0.99021065, 'recall': 0.97020125, 'specificity': 0.97020125, 'f1': 0.9799439, 'auroc': 0.9967563, 'binary_precision': 0.98646724, 'binary_recall': 0.94174975, 'binary_specificity': 0.99865276, 'binary_f1_score': 0.96358997}
confusion matrix:
       0     1
0  42251    57
1    257  4155
---- Validation: 
scalar performance:
{'acc': 0.9665815, 'precision': 0.75200045, 'recall': 0.59417015, 'specificity': 0.59417015, 'f1': 0.6338145, 'auroc': 0.83294994, 'binary_precision': 0.5319149, 'binary_recall': 0.19440125, 'binary_specificity': 0.99393904, 'binary_f1_score': 0.28473803}
confusion matrix:
       0    1
0  18039  110
1    518  125
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9576542, 'precision': 0.7116748, 'recall': 0.5436425, 'specificity': 0.5436425, 'f1': 0.5658193, 'auroc': 0.7963792, 'binary_precision': 0.46153846, 'binary_recall': 0.09195402, 'binary_specificity': 0.995331, 'binary_f1_score': 0.15335463}
confusion matrix:
      0   1
0  5969  28
1   237  24
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512111_25.png
early stop counter: 17
val acc:0.9665815234184265, best validation acc: 0.9673265218734741, corresponding to test acc:                         0.9621284604072571 / 0.9635666608810425
after epoch: 25,now: 2024-06-20 06:06:34.925273,epoch time: 0:18:10.919838,used: 6:55:50.560813,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512111
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99240154, 'precision': 0.9906176, 'recall': 0.964657, 'specificity': 0.964657, 'f1': 0.97719437, 'auroc': 0.99668705, 'binary_precision': 0.98844767, 'binary_recall': 0.9304486, 'binary_specificity': 0.9988654, 'binary_f1_score': 0.9585716}
confusion matrix:
       0     1
0  42258    48
1    307  4107
---- Validation: 
scalar performance:
{'acc': 0.96706045, 'precision': 0.77063406, 'recall': 0.5734166, 'specificity': 0.5734166, 'f1': 0.61089426, 'auroc': 0.8171262, 'binary_precision': 0.57058823, 'binary_recall': 0.15085536, 'binary_specificity': 0.99597776, 'binary_f1_score': 0.23862238}
confusion matrix:
       0   1
0  18076  73
1    546  97
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9574944, 'precision': 0.69452035, 'recall': 0.52706814, 'specificity': 0.52706814, 'f1': 0.5397919, 'auroc': 0.7765441, 'binary_precision': 0.42857143, 'binary_recall': 0.057471264, 'binary_specificity': 0.996665, 'binary_f1_score': 0.10135135}
confusion matrix:
      0   1
0  5977  20
1   246  15
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512111_26.png
early stop counter: 18
val acc:0.9670604467391968, best validation acc: 0.9673265218734741, corresponding to test acc:                         0.9621284604072571 / 0.9635666608810425
after epoch: 26,now: 2024-06-20 06:22:17.525411,epoch time: 0:15:42.600138,used: 7:11:33.160951,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512111
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99302226, 'precision': 0.98952806, 'recall': 0.9693353, 'specificity': 0.9693353, 'f1': 0.9791645, 'auroc': 0.9969708, 'binary_precision': 0.98526615, 'binary_recall': 0.9401361, 'binary_specificity': 0.9985346, 'binary_f1_score': 0.9621722}
confusion matrix:
       0     1
0  42248    62
1    264  4146
---- Validation: 
scalar performance:
{'acc': 0.96706045, 'precision': 0.762391, 'recall': 0.5951682, 'specificity': 0.5951682, 'f1': 0.63623106, 'auroc': 0.8306211, 'binary_precision': 0.55263156, 'binary_recall': 0.19595645, 'binary_specificity': 0.9943799, 'binary_f1_score': 0.2893226}
confusion matrix:
       0    1
0  18047  102
1    517  126
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579738, 'precision': 0.72180134, 'recall': 0.5474739, 'specificity': 0.5474739, 'f1': 0.57176185, 'auroc': 0.79136133, 'binary_precision': 0.4814815, 'binary_recall': 0.099616855, 'binary_specificity': 0.995331, 'binary_f1_score': 0.16507937}
confusion matrix:
      0   1
0  5969  28
1   235  26
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512111_27.png
early stop counter: 19
val acc:0.9670604467391968, best validation acc: 0.9673265218734741, corresponding to test acc:                         0.9621284604072571 / 0.9635666608810425
after epoch: 27,now: 2024-06-20 06:38:04.039337,epoch time: 0:15:46.513926,used: 7:27:19.674877,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512111
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99310786, 'precision': 0.98876417, 'recall': 0.9706272, 'specificity': 0.9706272, 'f1': 0.97947997, 'auroc': 0.9979601, 'binary_precision': 0.98345935, 'binary_recall': 0.94290894, 'binary_specificity': 0.9983454, 'binary_f1_score': 0.96275735}
confusion matrix:
       0     1
0  42236    70
1    252  4162
---- Validation: 
scalar performance:
{'acc': 0.966688, 'precision': 0.75138927, 'recall': 0.61597687, 'specificity': 0.61597687, 'f1': 0.65634197, 'auroc': 0.83809054, 'binary_precision': 0.5292096, 'binary_recall': 0.23950233, 'binary_specificity': 0.99245137, 'binary_f1_score': 0.32976446}
confusion matrix:
       0    1
0  18012  137
1    489  154
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95653564, 'precision': 0.6901376, 'recall': 0.5503882, 'specificity': 0.5503882, 'f1': 0.5742073, 'auroc': 0.80202985, 'binary_precision': 0.41791046, 'binary_recall': 0.107279696, 'binary_specificity': 0.9934968, 'binary_f1_score': 0.17073171}
confusion matrix:
      0   1
0  5958  39
1   233  28
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512111_28.png
early stop counter: 20
val acc:0.9666879773139954, best validation acc: 0.9673265218734741, corresponding to test acc:                         0.9621284604072571 / 0.9635666608810425
after epoch: 28,now: 2024-06-20 06:53:34.263599,epoch time: 0:15:30.224262,used: 7:42:49.899139,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512111
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 28 with time: 7:42:49.899139 at 2024-06-20 06:53:34.263599
persisted model performance metric: 

scalar performance:
{'acc': 0.96212846, 'precision': 0.80993277, 'recall': 0.59545004, 'specificity': 0.59545004, 'f1': 0.64071107, 'auroc': 0.7700747, 'binary_precision': 0.65384614, 'binary_recall': 0.1954023, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.30088496}
confusion matrix:
      0   1
0  5970  27
1   210  51
oracle model performance metric: 

scalar performance:
{'acc': 0.96356666, 'precision': 0.8378419, 'recall': 0.60536206, 'specificity': 0.60536206, 'f1': 0.6553432, 'auroc': 0.7725154, 'binary_precision': 0.70886075, 'binary_recall': 0.21455939, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.32941175}
confusion matrix:
      0   1
0  5974  23
1   205  56
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_irm_resnet_different_bs128_lre4_classbalancing/rule_results/0.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_irm_resnet_different_bs128_lre4_classbalancing/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_irm_resnet_different_bs128_lre4_classbalancing/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204097 KiB |   1730 MiB | 352550 GiB | 352550 GiB |
|       from large pool | 167936 KiB |   1660 MiB | 352451 GiB | 352451 GiB |
|       from small pool |  36161 KiB |     72 MiB |     98 GiB |     98 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 204097 KiB |   1730 MiB | 352550 GiB | 352550 GiB |
|       from large pool | 167936 KiB |   1660 MiB | 352451 GiB | 352451 GiB |
|       from small pool |  36161 KiB |     72 MiB |     98 GiB |     98 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201088 KiB |   1723 MiB | 352535 GiB | 352535 GiB |
|       from large pool | 165120 KiB |   1653 MiB | 352437 GiB | 352437 GiB |
|       from small pool |  35968 KiB |     71 MiB |     97 GiB |     97 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1876 MiB |   1876 MiB |   1876 MiB |      0 B   |
|       from large pool |   1802 MiB |   1802 MiB |   1802 MiB |      0 B   |
|       from small pool |     74 MiB |     74 MiB |     74 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 404158 KiB | 758032 KiB | 248076 GiB | 248075 GiB |
|       from large pool | 397312 KiB | 756864 KiB | 247974 GiB | 247973 GiB |
|       from small pool |   6846 KiB |  12716 KiB |    102 GiB |    102 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1194    |    1851    |   10570 K  |   10569 K  |
|       from large pool |      36    |      76    |    3349 K  |    3349 K  |
|       from small pool |    1158    |    1780    |    7221 K  |    7219 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1194    |    1851    |   10570 K  |   10569 K  |
|       from large pool |      36    |      76    |    3349 K  |    3349 K  |
|       from small pool |    1158    |    1780    |    7221 K  |    7219 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      50    |      50    |      50    |       0    |
|       from large pool |      13    |      13    |      13    |       0    |
|       from small pool |      37    |      37    |      37    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      27    |     378    |    5289 K  |    5288 K  |
|       from large pool |       5    |      10    |    1263 K  |    1263 K  |
|       from small pool |      22    |     373    |    4025 K  |    4025 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1730 MiB | 352550 GiB | 352550 GiB |
|       from large pool |  16640 KiB |   1660 MiB | 352451 GiB | 352451 GiB |
|       from small pool |      0 KiB |     72 MiB |     98 GiB |     98 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1730 MiB | 352550 GiB | 352550 GiB |
|       from large pool |  16640 KiB |   1660 MiB | 352451 GiB | 352451 GiB |
|       from small pool |      0 KiB |     72 MiB |     98 GiB |     98 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1723 MiB | 352535 GiB | 352535 GiB |
|       from large pool |  16640 KiB |   1653 MiB | 352437 GiB | 352437 GiB |
|       from small pool |      0 KiB |     71 MiB |     97 GiB |     97 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 608256 KiB |   1876 MiB |   1876 MiB |   1282 MiB |
|       from large pool | 565248 KiB |   1802 MiB |   1802 MiB |   1250 MiB |
|       from small pool |  43008 KiB |     74 MiB |     74 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 384768 KiB | 758032 KiB | 248076 GiB | 248076 GiB |
|       from large pool | 384768 KiB | 756864 KiB | 247974 GiB | 247974 GiB |
|       from small pool |      0 KiB |  14441 KiB |    102 GiB |    102 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1851    |   10570 K  |   10570 K  |
|       from large pool |       2    |      76    |    3349 K  |    3349 K  |
|       from small pool |       0    |    1780    |    7221 K  |    7221 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1851    |   10570 K  |   10570 K  |
|       from large pool |       2    |      76    |    3349 K  |    3349 K  |
|       from small pool |       0    |    1780    |    7221 K  |    7221 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      30    |      50    |      50    |      20    |
|       from large pool |       9    |      13    |      13    |       4    |
|       from small pool |      21    |      37    |      37    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     378    |    5289 K  |    5289 K  |
|       from large pool |       1    |      11    |    1263 K  |    1263 K  |
|       from small pool |       0    |     373    |    4025 K  |    4025 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1730 MiB | 352550 GiB | 352550 GiB |
|       from large pool |  16640 KiB |   1660 MiB | 352451 GiB | 352451 GiB |
|       from small pool |      0 KiB |     72 MiB |     98 GiB |     98 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1730 MiB | 352550 GiB | 352550 GiB |
|       from large pool |  16640 KiB |   1660 MiB | 352451 GiB | 352451 GiB |
|       from small pool |      0 KiB |     72 MiB |     98 GiB |     98 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1723 MiB | 352535 GiB | 352535 GiB |
|       from large pool |  16640 KiB |   1653 MiB | 352437 GiB | 352437 GiB |
|       from small pool |      0 KiB |     71 MiB |     97 GiB |     97 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 608256 KiB |   1876 MiB |   1876 MiB |   1282 MiB |
|       from large pool | 565248 KiB |   1802 MiB |   1802 MiB |   1250 MiB |
|       from small pool |  43008 KiB |     74 MiB |     74 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 384768 KiB | 758032 KiB | 248076 GiB | 248076 GiB |
|       from large pool | 384768 KiB | 756864 KiB | 247974 GiB | 247974 GiB |
|       from small pool |      0 KiB |  14441 KiB |    102 GiB |    102 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1851    |   10570 K  |   10570 K  |
|       from large pool |       2    |      76    |    3349 K  |    3349 K  |
|       from small pool |       0    |    1780    |    7221 K  |    7221 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1851    |   10570 K  |   10570 K  |
|       from large pool |       2    |      76    |    3349 K  |    3349 K  |
|       from small pool |       0    |    1780    |    7221 K  |    7221 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      30    |      50    |      50    |      20    |
|       from large pool |       9    |      13    |      13    |       4    |
|       from small pool |      21    |      37    |      37    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     378    |    5289 K  |    5289 K  |
|       from large pool |       1    |      11    |    1263 K  |    1263 K  |
|       from small pool |       0    |     373    |    4025 K  |    4025 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0




!!!: not committed yet



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_00_22_seed_1_21512111

 Experiment start at: 2024-06-20 07:00:22.602244
before training, model accuracy: 0.1456654816865921
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9346961, 'precision': 0.9175694, 'recall': 0.6640743, 'specificity': 0.6640743, 'f1': 0.72501385, 'auroc': 0.92944, 'binary_precision': 0.89918596, 'binary_recall': 0.33194637, 'binary_specificity': 0.9962023, 'binary_f1_score': 0.48488945}
confusion matrix:
       0     1
0  42233   161
1   2890  1436
---- Validation: 
scalar performance:
{'acc': 0.963714, 'precision': 0.48203704, 'recall': 0.49980628, 'specificity': 0.49980628, 'f1': 0.49076086, 'auroc': 0.50231194, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99961257, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18060  7
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.4861109, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512111_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-20 07:16:41.299294,epoch time: 0:16:18.697050,used: 0:16:18.697050,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_00_22_seed_1_21512111
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9691781, 'precision': 0.98052585, 'recall': 0.83542246, 'specificity': 0.83542246, 'f1': 0.89225435, 'auroc': 0.9704932, 'binary_precision': 0.9934954, 'binary_recall': 0.6712931, 'binary_specificity': 0.99955183, 'binary_f1_score': 0.80121475}
confusion matrix:
       0     1
0  42378    19
1   1421  2902
---- Validation: 
scalar performance:
{'acc': 0.96451443, 'precision': 0.79139596, 'recall': 0.515242, 'specificity': 0.515242, 'f1': 0.520661, 'auroc': 0.62316346, 'binary_precision': 0.61764705, 'binary_recall': 0.031203566, 'binary_specificity': 0.99928045, 'binary_f1_score': 0.05940594}
confusion matrix:
       0   1
0  18054  13
1    652  21
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.72927415, 'recall': 0.50551695, 'specificity': 0.50551695, 'f1': 0.50057507, 'auroc': 0.6743221, 'binary_precision': 0.5, 'binary_recall': 0.011538462, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.022556392}
confusion matrix:
      0  1
0  5943  3
1   257  3
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512111_2.png
better model found
persisted
after epoch: 2,now: 2024-06-20 07:32:12.380386,epoch time: 0:15:31.081092,used: 0:31:49.778142,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_00_22_seed_1_21512111
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9759632, 'precision': 0.9812993, 'recall': 0.8743719, 'specificity': 0.8743719, 'f1': 0.91962534, 'auroc': 0.9810251, 'binary_precision': 0.98750764, 'binary_recall': 0.74971086, 'binary_specificity': 0.999033, 'binary_f1_score': 0.85233396}
confusion matrix:
       0     1
0  42356    41
1   1082  3241
---- Validation: 
scalar performance:
{'acc': 0.9655283, 'precision': 0.79459953, 'recall': 0.5501006, 'specificity': 0.5501006, 'f1': 0.5792082, 'auroc': 0.70993257, 'binary_precision': 0.6216216, 'binary_recall': 0.102526, 'binary_specificity': 0.9976753, 'binary_f1_score': 0.1760204}
confusion matrix:
       0   1
0  18025  42
1    604  69
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611666, 'precision': 0.8841975, 'recall': 0.5475724, 'specificity': 0.5475724, 'f1': 0.5759692, 'auroc': 0.7563307, 'binary_precision': 0.8064516, 'binary_recall': 0.09615385, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.1718213}
confusion matrix:
      0   1
0  5940   6
1   235  25
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512111_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-20 07:47:51.773329,epoch time: 0:15:39.392943,used: 0:47:29.171085,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_00_22_seed_1_21512111
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9812072, 'precision': 0.9801339, 'recall': 0.9063226, 'specificity': 0.9063226, 'f1': 0.9394235, 'auroc': 0.9849325, 'binary_precision': 0.9788654, 'binary_recall': 0.81443775, 'binary_specificity': 0.99820745, 'binary_f1_score': 0.8891134}
confusion matrix:
       0     1
0  42322    76
1    802  3520
---- Validation: 
scalar performance:
{'acc': 0.9655283, 'precision': 0.7708427, 'recall': 0.5772808, 'specificity': 0.5772808, 'f1': 0.61559826, 'auroc': 0.7306056, 'binary_precision': 0.5721925, 'binary_recall': 0.1589896, 'binary_specificity': 0.99557203, 'binary_f1_score': 0.2488372}
confusion matrix:
       0    1
0  17987   80
1    566  107
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621334, 'precision': 0.8382, 'recall': 0.5793397, 'specificity': 0.5793397, 'f1': 0.6219451, 'auroc': 0.75803643, 'binary_precision': 0.7118644, 'binary_recall': 0.16153847, 'binary_specificity': 0.99714094, 'binary_f1_score': 0.2633229}
confusion matrix:
      0   1
0  5929  17
1   218  42
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512111_4.png
new oracle model saved
early stop counter: 1
val acc:0.9655283093452454, best validation acc: 0.9655283093452454, corresponding to test acc:                         0.9611666202545166 / 0.9621334075927734
after epoch: 4,now: 2024-06-20 08:03:36.275699,epoch time: 0:15:44.502370,used: 1:03:13.673455,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_00_22_seed_1_21512111
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9825342, 'precision': 0.9784287, 'recall': 0.9158384, 'specificity': 0.9158384, 'f1': 0.94441354, 'auroc': 0.98838735, 'binary_precision': 0.97354925, 'binary_recall': 0.8339884, 'binary_specificity': 0.9976884, 'binary_f1_score': 0.89838105}
confusion matrix:
       0     1
0  42297    98
1    718  3607
---- Validation: 
scalar performance:
{'acc': 0.9659552, 'precision': 0.77299154, 'recall': 0.59681445, 'specificity': 0.59681445, 'f1': 0.6391808, 'auroc': 0.76666033, 'binary_precision': 0.5751073, 'binary_recall': 0.19910847, 'binary_specificity': 0.9945204, 'binary_f1_score': 0.29580572}
confusion matrix:
       0    1
0  17968   99
1    539  134
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9643893, 'precision': 0.8601443, 'recall': 0.60994077, 'specificity': 0.60994077, 'f1': 0.6629557, 'auroc': 0.7986338, 'binary_precision': 0.7532467, 'binary_recall': 0.22307692, 'binary_specificity': 0.9968046, 'binary_f1_score': 0.34421363}
confusion matrix:
      0   1
0  5927  19
1   202  58
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512111_5.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-06-20 08:19:34.599901,epoch time: 0:15:58.324202,used: 1:19:11.997657,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_00_22_seed_1_21512111
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9847175, 'precision': 0.97737336, 'recall': 0.92998636, 'specificity': 0.92998636, 'f1': 0.95213807, 'auroc': 0.99093294, 'binary_precision': 0.9685796, 'binary_recall': 0.86282676, 'binary_specificity': 0.997146, 'binary_f1_score': 0.91264987}
confusion matrix:
       0     1
0  42276   121
1    593  3730
---- Validation: 
scalar performance:
{'acc': 0.966222, 'precision': 0.7735202, 'recall': 0.6105429, 'specificity': 0.6105429, 'f1': 0.6542778, 'auroc': 0.7945193, 'binary_precision': 0.575188, 'binary_recall': 0.22734027, 'binary_specificity': 0.9937455, 'binary_f1_score': 0.32587856}
confusion matrix:
       0    1
0  17954  113
1    520  153
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9661618, 'precision': 0.8551972, 'recall': 0.6458065, 'specificity': 0.6458065, 'f1': 0.70282334, 'auroc': 0.82620454, 'binary_precision': 0.74038464, 'binary_recall': 0.29615384, 'binary_specificity': 0.99545914, 'binary_f1_score': 0.42307693}
confusion matrix:
      0   1
0  5919  27
1   183  77
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512111_6.png
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-06-20 08:37:00.660287,epoch time: 0:17:26.060386,used: 1:36:38.058043,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_00_22_seed_1_21512111
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98675084, 'precision': 0.98268855, 'recall': 0.937353, 'specificity': 0.937353, 'f1': 0.9586297, 'auroc': 0.99202967, 'binary_precision': 0.9778179, 'binary_recall': 0.8767345, 'binary_specificity': 0.99797153, 'binary_f1_score': 0.9245214}
confusion matrix:
       0     1
0  42310    86
1    533  3791
---- Validation: 
scalar performance:
{'acc': 0.9663821, 'precision': 0.77709067, 'recall': 0.6099106, 'specificity': 0.6099106, 'f1': 0.65412164, 'auroc': 0.78863454, 'binary_precision': 0.58237547, 'binary_recall': 0.22585438, 'binary_specificity': 0.9939669, 'binary_f1_score': 0.3254818}
confusion matrix:
       0    1
0  17958  109
1    521  152
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9655172, 'precision': 0.8543252, 'recall': 0.6344362, 'specificity': 0.6344362, 'f1': 0.69056296, 'auroc': 0.8034385, 'binary_precision': 0.7395833, 'binary_recall': 0.27307692, 'binary_specificity': 0.9957955, 'binary_f1_score': 0.3988764}
confusion matrix:
      0   1
0  5921  25
1   189  71
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512111_7.png
better model found
persisted
after epoch: 7,now: 2024-06-20 08:53:49.388056,epoch time: 0:16:48.727769,used: 1:53:26.785812,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_00_22_seed_1_21512111
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98679364, 'precision': 0.9841863, 'recall': 0.93626344, 'specificity': 0.93626344, 'f1': 0.9586723, 'auroc': 0.9915287, 'binary_precision': 0.98106354, 'binary_recall': 0.87424874, 'binary_specificity': 0.9982781, 'binary_f1_score': 0.9245813}
confusion matrix:
       0     1
0  42321    73
1    544  3782
---- Validation: 
scalar performance:
{'acc': 0.9667022, 'precision': 0.7955905, 'recall': 0.5914797, 'specificity': 0.5914797, 'f1': 0.63531196, 'auroc': 0.78642064, 'binary_precision': 0.62068963, 'binary_recall': 0.1872214, 'binary_specificity': 0.9957381, 'binary_f1_score': 0.2876712}
confusion matrix:
       0    1
0  17990   77
1    547  126
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96374476, 'precision': 0.84994835, 'recall': 0.6040874, 'specificity': 0.6040874, 'f1': 0.6548639, 'auroc': 0.7977808, 'binary_precision': 0.73333335, 'binary_recall': 0.21153846, 'binary_specificity': 0.9966364, 'binary_f1_score': 0.32835823}
confusion matrix:
      0   1
0  5926  20
1   205  55
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512111_8.png
better model found
persisted
after epoch: 8,now: 2024-06-20 09:11:59.184993,epoch time: 0:18:09.796937,used: 2:11:36.582749,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_00_22_seed_1_21512111
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98764986, 'precision': 0.9838413, 'recall': 0.9416639, 'specificity': 0.9416639, 'f1': 0.9615553, 'auroc': 0.99327135, 'binary_precision': 0.97926795, 'binary_recall': 0.8852383, 'binary_specificity': 0.99808955, 'binary_f1_score': 0.9298821}
confusion matrix:
       0     1
0  42317    81
1    496  3826
---- Validation: 
scalar performance:
{'acc': 0.9670224, 'precision': 0.7994326, 'recall': 0.5980832, 'specificity': 0.5980832, 'f1': 0.6435825, 'auroc': 0.79206556, 'binary_precision': 0.627907, 'binary_recall': 0.20059435, 'binary_specificity': 0.99557203, 'binary_f1_score': 0.30405405}
confusion matrix:
       0    1
0  17987   80
1    538  135
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96422815, 'precision': 0.8351934, 'recall': 0.6245686, 'specificity': 0.6245686, 'f1': 0.6772352, 'auroc': 0.80389404, 'binary_precision': 0.70212764, 'binary_recall': 0.25384617, 'binary_specificity': 0.99529094, 'binary_f1_score': 0.37288138}
confusion matrix:
      0   1
0  5918  28
1   194  66
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512111_9.png
better model found
persisted
after epoch: 9,now: 2024-06-20 09:29:34.671721,epoch time: 0:17:35.486728,used: 2:29:12.069477,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_00_22_seed_1_21512111
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98886985, 'precision': 0.98498315, 'recall': 0.94797003, 'specificity': 0.94797003, 'f1': 0.965561, 'auroc': 0.99339664, 'binary_precision': 0.98030305, 'binary_recall': 0.8977798, 'binary_specificity': 0.9981602, 'binary_f1_score': 0.93722844}
confusion matrix:
       0     1
0  42318    78
1    442  3882
---- Validation: 
scalar performance:
{'acc': 0.9670224, 'precision': 0.8191758, 'recall': 0.57948625, 'specificity': 0.57948625, 'f1': 0.62195027, 'auroc': 0.78414875, 'binary_precision': 0.66871166, 'binary_recall': 0.16196136, 'binary_specificity': 0.9970111, 'binary_f1_score': 0.26076555}
confusion matrix:
       0    1
0  18013   54
1    564  109
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9626168, 'precision': 0.841954, 'recall': 0.5869479, 'specificity': 0.5869479, 'f1': 0.63237906, 'auroc': 0.7894926, 'binary_precision': 0.71875, 'binary_recall': 0.17692308, 'binary_specificity': 0.99697274, 'binary_f1_score': 0.28395063}
confusion matrix:
      0   1
0  5928  18
1   214  46
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512111_10.png
early stop counter: 1
val acc:0.9670224189758301, best validation acc: 0.9670224189758301, corresponding to test acc:                         0.9642281532287598 / 0.9661617875099182
after epoch: 10,now: 2024-06-20 09:46:59.003337,epoch time: 0:17:24.331616,used: 2:46:36.401093,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_00_22_seed_1_21512111
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98814213, 'precision': 0.98296475, 'recall': 0.94549227, 'specificity': 0.94549227, 'f1': 0.9632852, 'auroc': 0.9938704, 'binary_precision': 0.97673243, 'binary_recall': 0.8931545, 'binary_specificity': 0.99783, 'binary_f1_score': 0.93307567}
confusion matrix:
       0     1
0  42304    92
1    462  3862
---- Validation: 
scalar performance:
{'acc': 0.9669691, 'precision': 0.8002805, 'recall': 0.59519446, 'specificity': 0.59519446, 'f1': 0.64023817, 'auroc': 0.8035531, 'binary_precision': 0.6298077, 'binary_recall': 0.19465081, 'binary_specificity': 0.9957381, 'binary_f1_score': 0.29738933}
confusion matrix:
       0    1
0  17990   77
1    542  131
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9629391, 'precision': 0.8400307, 'recall': 0.59447205, 'specificity': 0.59447205, 'f1': 0.64199686, 'auroc': 0.8094605, 'binary_precision': 0.71428573, 'binary_recall': 0.1923077, 'binary_specificity': 0.9966364, 'binary_f1_score': 0.3030303}
confusion matrix:
      0   1
0  5926  20
1   210  50
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512111_11.png
early stop counter: 2
val acc:0.9669690728187561, best validation acc: 0.9670224189758301, corresponding to test acc:                         0.9642281532287598 / 0.9661617875099182
after epoch: 11,now: 2024-06-20 10:04:09.322476,epoch time: 0:17:10.319139,used: 3:03:46.720232,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_00_22_seed_1_21512111
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98925513, 'precision': 0.9839252, 'recall': 0.9512645, 'specificity': 0.9512645, 'f1': 0.96688294, 'auroc': 0.9953619, 'binary_precision': 0.97749436, 'binary_recall': 0.9046517, 'binary_specificity': 0.9978773, 'binary_f1_score': 0.9396634}
confusion matrix:
       0     1
0  42309    90
1    412  3909
---- Validation: 
scalar performance:
{'acc': 0.9667022, 'precision': 0.79138505, 'recall': 0.5972019, 'specificity': 0.5972019, 'f1': 0.6416968, 'auroc': 0.8139804, 'binary_precision': 0.61187214, 'binary_recall': 0.19910847, 'binary_specificity': 0.9952953, 'binary_f1_score': 0.30044842}
confusion matrix:
       0    1
0  17982   85
1    539  134
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9619723, 'precision': 0.8138763, 'recall': 0.5921285, 'specificity': 0.5921285, 'f1': 0.6369368, 'auroc': 0.8265471, 'binary_precision': 0.6621622, 'binary_recall': 0.18846154, 'binary_specificity': 0.9957955, 'binary_f1_score': 0.2934132}
confusion matrix:
      0   1
0  5921  25
1   211  49
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512111_12.png
early stop counter: 3
val acc:0.9667022228240967, best validation acc: 0.9670224189758301, corresponding to test acc:                         0.9642281532287598 / 0.9661617875099182
after epoch: 12,now: 2024-06-20 10:21:48.296673,epoch time: 0:17:38.974197,used: 3:21:25.694429,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_00_22_seed_1_21512111
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98925513, 'precision': 0.98566973, 'recall': 0.9496132, 'specificity': 0.9496132, 'f1': 0.9667748, 'auroc': 0.9947803, 'binary_precision': 0.9813508, 'binary_recall': 0.9009718, 'binary_specificity': 0.99825466, 'binary_f1_score': 0.9394451}
confusion matrix:
       0     1
0  42324    74
1    428  3894
---- Validation: 
scalar performance:
{'acc': 0.966222, 'precision': 0.7903885, 'recall': 0.57978636, 'specificity': 0.57978636, 'f1': 0.62031543, 'auroc': 0.81194234, 'binary_precision': 0.6111111, 'binary_recall': 0.16344725, 'binary_specificity': 0.9961255, 'binary_f1_score': 0.25791323}
confusion matrix:
       0    1
0  17997   70
1    563  110
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9618111, 'precision': 0.83298814, 'recall': 0.5754936, 'specificity': 0.5754936, 'f1': 0.6163855, 'auroc': 0.8148328, 'binary_precision': 0.7017544, 'binary_recall': 0.15384616, 'binary_specificity': 0.99714094, 'binary_f1_score': 0.25236595}
confusion matrix:
      0   1
0  5929  17
1   220  40
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512111_13.png
early stop counter: 4
val acc:0.9662219882011414, best validation acc: 0.9670224189758301, corresponding to test acc:                         0.9642281532287598 / 0.9661617875099182
after epoch: 13,now: 2024-06-20 10:38:42.175866,epoch time: 0:16:53.879193,used: 3:38:19.573622,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_00_22_seed_1_21512111
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9901113, 'precision': 0.98633945, 'recall': 0.9541576, 'specificity': 0.9541576, 'f1': 0.96956134, 'auroc': 0.9961957, 'binary_precision': 0.98178643, 'binary_recall': 0.910037, 'binary_specificity': 0.99827814, 'binary_f1_score': 0.9445511}
confusion matrix:
       0     1
0  42323    73
1    389  3935
---- Validation: 
scalar performance:
{'acc': 0.9664888, 'precision': 0.78721285, 'recall': 0.5949454, 'specificity': 0.5949454, 'f1': 0.6386094, 'auroc': 0.81683284, 'binary_precision': 0.60368663, 'binary_recall': 0.19465081, 'binary_specificity': 0.9952399, 'binary_f1_score': 0.294382}
confusion matrix:
       0    1
0  17981   86
1    542  131
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611666, 'precision': 0.7943935, 'recall': 0.5898691, 'specificity': 0.5898691, 'f1': 0.6324539, 'auroc': 0.8211045, 'binary_precision': 0.6233766, 'binary_recall': 0.18461539, 'binary_specificity': 0.9951228, 'binary_f1_score': 0.28486648}
confusion matrix:
      0   1
0  5917  29
1   212  48
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512111_14.png
early stop counter: 5
val acc:0.966488778591156, best validation acc: 0.9670224189758301, corresponding to test acc:                         0.9642281532287598 / 0.9661617875099182
after epoch: 14,now: 2024-06-20 10:55:51.144069,epoch time: 0:17:08.968203,used: 3:55:28.541825,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_00_22_seed_1_21512111
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98996145, 'precision': 0.9855863, 'recall': 0.95395035, 'specificity': 0.95395035, 'f1': 0.9691036, 'auroc': 0.99403334, 'binary_precision': 0.9803042, 'binary_recall': 0.909764, 'binary_specificity': 0.9981367, 'binary_f1_score': 0.9437178}
confusion matrix:
       0     1
0  42319    79
1    390  3932
---- Validation: 
scalar performance:
{'acc': 0.96707577, 'precision': 0.80090046, 'recall': 0.59811085, 'specificity': 0.59811085, 'f1': 0.64376783, 'auroc': 0.82060385, 'binary_precision': 0.63084114, 'binary_recall': 0.20059435, 'binary_specificity': 0.9956274, 'binary_f1_score': 0.30439684}
confusion matrix:
       0    1
0  17988   79
1    538  135
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606832, 'precision': 0.79459053, 'recall': 0.5749049, 'specificity': 0.5749049, 'f1': 0.61336416, 'auroc': 0.8209784, 'binary_precision': 0.625, 'binary_recall': 0.15384616, 'binary_specificity': 0.9959637, 'binary_f1_score': 0.24691358}
confusion matrix:
      0   1
0  5922  24
1   220  40
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512111_15.png
better model found
persisted
after epoch: 15,now: 2024-06-20 11:15:13.244004,epoch time: 0:19:22.099935,used: 4:14:50.641760,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_00_22_seed_1_21512111
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9904966, 'precision': 0.9840297, 'recall': 0.9587404, 'specificity': 0.9587404, 'f1': 0.97096086, 'auroc': 0.9961346, 'binary_precision': 0.97619635, 'binary_recall': 0.9197688, 'binary_specificity': 0.997712, 'binary_f1_score': 0.9471429}
confusion matrix:
       0     1
0  42298    97
1    347  3978
---- Validation: 
scalar performance:
{'acc': 0.9666489, 'precision': 0.78952765, 'recall': 0.5978895, 'specificity': 0.5978895, 'f1': 0.6422962, 'auroc': 0.8196646, 'binary_precision': 0.6081081, 'binary_recall': 0.20059435, 'binary_specificity': 0.9951846, 'binary_f1_score': 0.30167598}
confusion matrix:
       0    1
0  17980   87
1    538  135
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96052206, 'precision': 0.7897799, 'recall': 0.5748208, 'specificity': 0.5748208, 'f1': 0.6129421, 'auroc': 0.80972874, 'binary_precision': 0.61538464, 'binary_recall': 0.15384616, 'binary_specificity': 0.9957955, 'binary_f1_score': 0.24615386}
confusion matrix:
      0   1
0  5921  25
1   220  40
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512111_16.png
early stop counter: 1
val acc:0.9666488766670227, best validation acc: 0.967075765132904, corresponding to test acc:                         0.9606832265853882 / 0.9661617875099182
after epoch: 16,now: 2024-06-20 11:34:09.514852,epoch time: 0:18:56.270848,used: 4:33:46.912608,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_00_22_seed_1_21512111
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99094605, 'precision': 0.98623675, 'recall': 0.9592903, 'specificity': 0.9592903, 'f1': 0.97228384, 'auroc': 0.9958844, 'binary_precision': 0.98053706, 'binary_recall': 0.920444, 'binary_specificity': 0.99813664, 'binary_f1_score': 0.94954073}
confusion matrix:
       0     1
0  42317    79
1    344  3980
---- Validation: 
scalar performance:
{'acc': 0.96627533, 'precision': 0.7870922, 'recall': 0.58625144, 'specificity': 0.58625144, 'f1': 0.62815005, 'auroc': 0.8205482, 'binary_precision': 0.6040609, 'binary_recall': 0.1768202, 'binary_specificity': 0.9956827, 'binary_f1_score': 0.2735632}
confusion matrix:
       0    1
0  17989   78
1    554  119
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96003866, 'precision': 0.77745783, 'recall': 0.5727296, 'specificity': 0.5727296, 'f1': 0.6093721, 'auroc': 0.8058328, 'binary_precision': 0.59090906, 'binary_recall': 0.15, 'binary_specificity': 0.99545914, 'binary_f1_score': 0.23926379}
confusion matrix:
      0   1
0  5919  27
1   221  39
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512111_17.png
early stop counter: 2
val acc:0.9662753343582153, best validation acc: 0.967075765132904, corresponding to test acc:                         0.9606832265853882 / 0.9661617875099182
after epoch: 17,now: 2024-06-20 11:53:18.623781,epoch time: 0:19:09.108929,used: 4:52:56.021537,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_00_22_seed_1_21512111
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9911173, 'precision': 0.98753095, 'recall': 0.9590824, 'specificity': 0.9590824, 'f1': 0.97277284, 'auroc': 0.99609905, 'binary_precision': 0.9831933, 'binary_recall': 0.9197688, 'binary_specificity': 0.99839604, 'binary_f1_score': 0.95042413}
confusion matrix:
       0     1
0  42327    68
1    347  3978
---- Validation: 
scalar performance:
{'acc': 0.9667556, 'precision': 0.80224794, 'recall': 0.58578527, 'specificity': 0.58578527, 'f1': 0.628863, 'auroc': 0.82421243, 'binary_precision': 0.6344086, 'binary_recall': 0.17533432, 'binary_specificity': 0.9962362, 'binary_f1_score': 0.27473804}
confusion matrix:
       0    1
0  17999   68
1    555  118
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95955527, 'precision': 0.76645875, 'recall': 0.5687993, 'specificity': 0.5687993, 'f1': 0.6034631, 'auroc': 0.8283422, 'binary_precision': 0.5692308, 'binary_recall': 0.1423077, 'binary_specificity': 0.99529094, 'binary_f1_score': 0.22769232}
confusion matrix:
      0   1
0  5918  28
1   223  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512111_18.png
early stop counter: 3
val acc:0.9667556285858154, best validation acc: 0.967075765132904, corresponding to test acc:                         0.9606832265853882 / 0.9661617875099182
after epoch: 18,now: 2024-06-20 12:14:22.302089,epoch time: 0:21:03.678308,used: 5:13:59.699845,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_00_22_seed_1_21512111
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9911387, 'precision': 0.9886259, 'recall': 0.95814085, 'specificity': 0.95814085, 'f1': 0.9727709, 'auroc': 0.9959582, 'binary_precision': 0.98559004, 'binary_recall': 0.9176498, 'binary_specificity': 0.99863195, 'binary_f1_score': 0.95040727}
confusion matrix:
       0     1
0  42339    58
1    356  3967
---- Validation: 
scalar performance:
{'acc': 0.9668623, 'precision': 0.8042449, 'recall': 0.58727115, 'specificity': 0.58727115, 'f1': 0.6308936, 'auroc': 0.8285769, 'binary_precision': 0.63829786, 'binary_recall': 0.17830609, 'binary_specificity': 0.9962362, 'binary_f1_score': 0.27874562}
confusion matrix:
       0    1
0  17999   68
1    553  120
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606832, 'precision': 0.8115627, 'recall': 0.562032, 'specificity': 0.562032, 'f1': 0.59637064, 'auroc': 0.81961256, 'binary_precision': 0.66, 'binary_recall': 0.12692308, 'binary_specificity': 0.99714094, 'binary_f1_score': 0.21290325}
confusion matrix:
      0   1
0  5929  17
1   227  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512111_19.png
early stop counter: 4
val acc:0.9668623208999634, best validation acc: 0.967075765132904, corresponding to test acc:                         0.9606832265853882 / 0.9661617875099182
after epoch: 19,now: 2024-06-20 12:32:56.407030,epoch time: 0:18:34.104941,used: 5:32:33.804786,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_00_22_seed_1_21512111
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99190927, 'precision': 0.9899765, 'recall': 0.9614737, 'specificity': 0.9614737, 'f1': 0.9751923, 'auroc': 0.99504817, 'binary_precision': 0.98763907, 'binary_recall': 0.92412674, 'binary_specificity': 0.99882066, 'binary_f1_score': 0.9548279}
confusion matrix:
       0     1
0  42347    50
1    328  3995
---- Validation: 
scalar performance:
{'acc': 0.96627533, 'precision': 0.7897479, 'recall': 0.5826751, 'specificity': 0.5826751, 'f1': 0.6239289, 'auroc': 0.82412344, 'binary_precision': 0.6096257, 'binary_recall': 0.16939078, 'binary_specificity': 0.99595946, 'binary_f1_score': 0.26511627}
confusion matrix:
       0    1
0  17994   73
1    559  114
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96036094, 'precision': 0.8014815, 'recall': 0.56002486, 'specificity': 0.56002486, 'f1': 0.5930622, 'auroc': 0.807676, 'binary_precision': 0.64, 'binary_recall': 0.12307692, 'binary_specificity': 0.99697274, 'binary_f1_score': 0.20645161}
confusion matrix:
      0   1
0  5928  18
1   228  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512111_20.png
early stop counter: 5
val acc:0.9662753343582153, best validation acc: 0.967075765132904, corresponding to test acc:                         0.9606832265853882 / 0.9661617875099182
after epoch: 20,now: 2024-06-20 12:50:58.277699,epoch time: 0:18:01.870669,used: 5:50:35.675455,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_00_22_seed_1_21512111
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9921875, 'precision': 0.9899305, 'recall': 0.9631851, 'specificity': 0.9631851, 'f1': 0.9760893, 'auroc': 0.9960952, 'binary_precision': 0.9871984, 'binary_recall': 0.92759657, 'binary_specificity': 0.9987735, 'binary_f1_score': 0.9564699}
confusion matrix:
       0     1
0  42345    52
1    313  4010
---- Validation: 
scalar performance:
{'acc': 0.96643543, 'precision': 0.79121196, 'recall': 0.5870498, 'specificity': 0.5870498, 'f1': 0.6294995, 'auroc': 0.8328932, 'binary_precision': 0.6122449, 'binary_recall': 0.17830609, 'binary_specificity': 0.99579346, 'binary_f1_score': 0.27617952}
confusion matrix:
       0    1
0  17991   76
1    553  120
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959233, 'precision': 0.76216215, 'recall': 0.5594362, 'specificity': 0.5594362, 'f1': 0.59048754, 'auroc': 0.8201412, 'binary_precision': 0.5614035, 'binary_recall': 0.12307692, 'binary_specificity': 0.9957955, 'binary_f1_score': 0.20189276}
confusion matrix:
      0   1
0  5921  25
1   228  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512111_21.png
early stop counter: 6
val acc:0.966435432434082, best validation acc: 0.967075765132904, corresponding to test acc:                         0.9606832265853882 / 0.9661617875099182
after epoch: 21,now: 2024-06-20 13:09:00.576402,epoch time: 0:18:02.298703,used: 6:08:37.974158,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_00_22_seed_1_21512111
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9922303, 'precision': 0.987926, 'recall': 0.9654132, 'specificity': 0.9654132, 'f1': 0.97633725, 'auroc': 0.9968662, 'binary_precision': 0.98270404, 'binary_recall': 0.93250114, 'binary_specificity': 0.9983252, 'binary_f1_score': 0.9569446}
confusion matrix:
       0     1
0  42323    71
1    292  4034
---- Validation: 
scalar performance:
{'acc': 0.96707577, 'precision': 0.79460883, 'recall': 0.60669404, 'specificity': 0.60669404, 'f1': 0.652925, 'auroc': 0.834861, 'binary_precision': 0.61764705, 'binary_recall': 0.21842496, 'binary_specificity': 0.99496317, 'binary_f1_score': 0.3227223}
confusion matrix:
       0    1
0  17976   91
1    526  147
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606832, 'precision': 0.8008295, 'recall': 0.5693879, 'specificity': 0.5693879, 'f1': 0.6062646, 'auroc': 0.81787324, 'binary_precision': 0.63793105, 'binary_recall': 0.1423077, 'binary_specificity': 0.9964682, 'binary_f1_score': 0.23270442}
confusion matrix:
      0   1
0  5925  21
1   223  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512111_22.png
early stop counter: 7
val acc:0.967075765132904, best validation acc: 0.967075765132904, corresponding to test acc:                         0.9606832265853882 / 0.9661617875099182
after epoch: 22,now: 2024-06-20 13:29:19.918417,epoch time: 0:20:19.342015,used: 6:28:57.316173,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_00_22_seed_1_21512111
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9921233, 'precision': 0.987535, 'recall': 0.9651309, 'specificity': 0.9651309, 'f1': 0.97600365, 'auroc': 0.99689615, 'binary_precision': 0.9819688, 'binary_recall': 0.9320074, 'binary_specificity': 0.99825454, 'binary_f1_score': 0.956336}
confusion matrix:
       0     1
0  42322    74
1    294  4030
---- Validation: 
scalar performance:
{'acc': 0.9668623, 'precision': 0.8015239, 'recall': 0.59013224, 'specificity': 0.59013224, 'f1': 0.63421166, 'auroc': 0.8338091, 'binary_precision': 0.63265306, 'binary_recall': 0.18424962, 'binary_specificity': 0.99601483, 'binary_f1_score': 0.2853855}
confusion matrix:
       0    1
0  17995   72
1    549  124
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95939416, 'precision': 0.77456594, 'recall': 0.5503254, 'specificity': 0.5503254, 'f1': 0.5778273, 'auroc': 0.8117014, 'binary_precision': 0.5869565, 'binary_recall': 0.103846155, 'binary_specificity': 0.9968046, 'binary_f1_score': 0.1764706}
confusion matrix:
      0   1
0  5927  19
1   233  27
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512111_23.png
early stop counter: 8
val acc:0.9668623208999634, best validation acc: 0.967075765132904, corresponding to test acc:                         0.9606832265853882 / 0.9661617875099182
after epoch: 23,now: 2024-06-20 13:49:19.743835,epoch time: 0:19:59.825418,used: 6:48:57.141591,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_00_22_seed_1_21512111
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99231595, 'precision': 0.98713523, 'recall': 0.96669835, 'specificity': 0.96669835, 'f1': 0.97664297, 'auroc': 0.99623036, 'binary_precision': 0.98084384, 'binary_recall': 0.9352601, 'binary_specificity': 0.9981366, 'binary_f1_score': 0.9575098}
confusion matrix:
       0     1
0  42316    79
1    280  4045
---- Validation: 
scalar performance:
{'acc': 0.96643543, 'precision': 0.7917652, 'recall': 0.58633447, 'specificity': 0.58633447, 'f1': 0.62866503, 'auroc': 0.8349345, 'binary_precision': 0.61340207, 'binary_recall': 0.1768202, 'binary_specificity': 0.9958488, 'binary_f1_score': 0.2745098}
confusion matrix:
       0    1
0  17992   75
1    554  119
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589107, 'precision': 0.75202155, 'recall': 0.56110704, 'specificity': 0.56110704, 'f1': 0.5922587, 'auroc': 0.8272051, 'binary_precision': 0.5409836, 'binary_recall': 0.12692308, 'binary_specificity': 0.99529094, 'binary_f1_score': 0.20560747}
confusion matrix:
      0   1
0  5918  28
1   227  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512111_24.png
early stop counter: 9
val acc:0.966435432434082, best validation acc: 0.967075765132904, corresponding to test acc:                         0.9606832265853882 / 0.9661617875099182
after epoch: 24,now: 2024-06-20 14:14:39.291270,epoch time: 0:25:19.547435,used: 7:14:16.689026,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_00_22_seed_1_21512111
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9925086, 'precision': 0.9895936, 'recall': 0.96545494, 'specificity': 0.96545494, 'f1': 0.9771431, 'auroc': 0.9968324, 'binary_precision': 0.98606014, 'binary_recall': 0.9322543, 'binary_specificity': 0.9986555, 'binary_f1_score': 0.95840263}
confusion matrix:
       0     1
0  42338    57
1    293  4032
---- Validation: 
scalar performance:
{'acc': 0.9668623, 'precision': 0.79784966, 'recall': 0.59442383, 'specificity': 0.59442383, 'f1': 0.63907576, 'auroc': 0.8380534, 'binary_precision': 0.625, 'binary_recall': 0.19316493, 'binary_specificity': 0.9956827, 'binary_f1_score': 0.29511917}
confusion matrix:
       0    1
0  17989   78
1    543  130
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584273, 'precision': 0.7425991, 'recall': 0.5406259, 'specificity': 0.5406259, 'f1': 0.5621953, 'auroc': 0.8081949, 'binary_precision': 0.52380955, 'binary_recall': 0.08461539, 'binary_specificity': 0.9966364, 'binary_f1_score': 0.14569537}
confusion matrix:
      0   1
0  5926  20
1   238  22
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512111_25.png
early stop counter: 10
val acc:0.9668623208999634, best validation acc: 0.967075765132904, corresponding to test acc:                         0.9606832265853882 / 0.9661617875099182
after epoch: 25,now: 2024-06-20 14:42:01.642797,epoch time: 0:27:22.351527,used: 7:41:39.040553,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_00_22_seed_1_21512111
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99240154, 'precision': 0.98909277, 'recall': 0.9652686, 'specificity': 0.9652686, 'f1': 0.97680914, 'auroc': 0.99700075, 'binary_precision': 0.9850819, 'binary_recall': 0.93197596, 'binary_specificity': 0.99856126, 'binary_f1_score': 0.95779335}
confusion matrix:
       0     1
0  42337    61
1    294  4028
---- Validation: 
scalar performance:
{'acc': 0.9669691, 'precision': 0.8041019, 'recall': 0.59090286, 'specificity': 0.59090286, 'f1': 0.63538975, 'auroc': 0.8327055, 'binary_precision': 0.6377551, 'binary_recall': 0.18573551, 'binary_specificity': 0.9960702, 'binary_f1_score': 0.287687}
confusion matrix:
       0    1
0  17996   71
1    548  125
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582662, 'precision': 0.73671395, 'recall': 0.5387028, 'specificity': 0.5387028, 'f1': 0.5590747, 'auroc': 0.80786824, 'binary_precision': 0.5121951, 'binary_recall': 0.08076923, 'binary_specificity': 0.9966364, 'binary_f1_score': 0.13953489}
confusion matrix:
      0   1
0  5926  20
1   239  21
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512111_26.png
early stop counter: 11
val acc:0.9669690728187561, best validation acc: 0.967075765132904, corresponding to test acc:                         0.9606832265853882 / 0.9661617875099182
after epoch: 26,now: 2024-06-20 15:09:52.430913,epoch time: 0:27:50.788116,used: 8:09:29.828669,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_00_22_seed_1_21512111
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9925514, 'precision': 0.987289, 'recall': 0.96797, 'specificity': 0.96797, 'f1': 0.97738504, 'auroc': 0.9969628, 'binary_precision': 0.9808948, 'binary_recall': 0.93780345, 'binary_specificity': 0.9981366, 'binary_f1_score': 0.9588652}
confusion matrix:
       0     1
0  42316    79
1    269  4056
---- Validation: 
scalar performance:
{'acc': 0.9671825, 'precision': 0.81074834, 'recall': 0.59101355, 'specificity': 0.59101355, 'f1': 0.6361105, 'auroc': 0.83837605, 'binary_precision': 0.6510417, 'binary_recall': 0.18573551, 'binary_specificity': 0.9962916, 'binary_f1_score': 0.28901735}
confusion matrix:
       0    1
0  18000   67
1    548  125
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582662, 'precision': 0.7372236, 'recall': 0.5350248, 'specificity': 0.5350248, 'f1': 0.5532838, 'auroc': 0.81139684, 'binary_precision': 0.5135135, 'binary_recall': 0.073076926, 'binary_specificity': 0.99697274, 'binary_f1_score': 0.12794614}
confusion matrix:
      0   1
0  5928  18
1   241  19
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512111_27.png
better model found
persisted
after epoch: 27,now: 2024-06-20 15:32:09.454571,epoch time: 0:22:17.023658,used: 8:31:46.852327,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_00_22_seed_1_21512111
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9928296, 'precision': 0.9915188, 'recall': 0.965528, 'specificity': 0.965528, 'f1': 0.9780828, 'auroc': 0.99722815, 'binary_precision': 0.9899312, 'binary_recall': 0.9320231, 'binary_specificity': 0.9990329, 'binary_f1_score': 0.96010476}
confusion matrix:
       0     1
0  42354    41
1    294  4031
---- Validation: 
scalar performance:
{'acc': 0.96659553, 'precision': 0.80127347, 'recall': 0.58141065, 'specificity': 0.58141065, 'f1': 0.6232198, 'auroc': 0.82907856, 'binary_precision': 0.63276833, 'binary_recall': 0.16641901, 'binary_specificity': 0.99640226, 'binary_f1_score': 0.2635294}
confusion matrix:
       0    1
0  18002   65
1    561  112
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9572994, 'precision': 0.6982471, 'recall': 0.5308423, 'specificity': 0.5308423, 'f1': 0.5459176, 'auroc': 0.80391765, 'binary_precision': 0.43589744, 'binary_recall': 0.06538462, 'binary_specificity': 0.99630004, 'binary_f1_score': 0.113712385}
confusion matrix:
      0   1
0  5924  22
1   243  17
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512111_28.png
early stop counter: 1
val acc:0.9665955305099487, best validation acc: 0.9671825170516968, corresponding to test acc:                         0.9582661986351013 / 0.9661617875099182
after epoch: 28,now: 2024-06-20 15:55:27.625796,epoch time: 0:23:18.171225,used: 8:55:05.023552,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_00_22_seed_1_21512111
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9931507, 'precision': 0.9896753, 'recall': 0.9692346, 'specificity': 0.9692346, 'f1': 0.9791825, 'auroc': 0.9966799, 'binary_precision': 0.98545456, 'binary_recall': 0.93988436, 'binary_specificity': 0.99858475, 'binary_f1_score': 0.9621301}
confusion matrix:
       0     1
0  42335    60
1    260  4065
---- Validation: 
scalar performance:
{'acc': 0.9668623, 'precision': 0.79902434, 'recall': 0.5929933, 'specificity': 0.5929933, 'f1': 0.6374692, 'auroc': 0.83903986, 'binary_precision': 0.627451, 'binary_recall': 0.19019316, 'binary_specificity': 0.99579346, 'binary_f1_score': 0.2919042}
confusion matrix:
       0    1
0  17991   76
1    545  128
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95762163, 'precision': 0.7161227, 'recall': 0.54388344, 'specificity': 0.54388344, 'f1': 0.56630355, 'auroc': 0.8085232, 'binary_precision': 0.47058824, 'binary_recall': 0.092307694, 'binary_specificity': 0.99545914, 'binary_f1_score': 0.15434083}
confusion matrix:
      0   1
0  5919  27
1   236  24
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512111_29.png
early stop counter: 2
val acc:0.9668623208999634, best validation acc: 0.9671825170516968, corresponding to test acc:                         0.9582661986351013 / 0.9661617875099182
after epoch: 29,now: 2024-06-20 16:20:25.631387,epoch time: 0:24:58.005591,used: 9:20:03.029143,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_00_22_seed_1_21512111
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99229455, 'precision': 0.9886012, 'recall': 0.9651215, 'specificity': 0.9651215, 'f1': 0.97650015, 'auroc': 0.9965532, 'binary_precision': 0.9841231, 'binary_recall': 0.9317761, 'binary_specificity': 0.99846685, 'binary_f1_score': 0.95723444}
confusion matrix:
       0     1
0  42331    65
1    295  4029
---- Validation: 
scalar performance:
{'acc': 0.9668623, 'precision': 0.8035424, 'recall': 0.5879864, 'specificity': 0.5879864, 'f1': 0.6317289, 'auroc': 0.834675, 'binary_precision': 0.63684213, 'binary_recall': 0.17979197, 'binary_specificity': 0.9961809, 'binary_f1_score': 0.28041714}
confusion matrix:
       0    1
0  17998   69
1    552  121
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9569771, 'precision': 0.689669, 'recall': 0.53251314, 'specificity': 0.53251314, 'f1': 0.5483811, 'auroc': 0.7991549, 'binary_precision': 0.41860464, 'binary_recall': 0.06923077, 'binary_specificity': 0.9957955, 'binary_f1_score': 0.11881188}
confusion matrix:
      0   1
0  5921  25
1   242  18
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512111_30.png
early stop counter: 3
val acc:0.9668623208999634, best validation acc: 0.9671825170516968, corresponding to test acc:                         0.9582661986351013 / 0.9661617875099182
after epoch: 30,now: 2024-06-20 16:47:44.920995,epoch time: 0:27:19.289608,used: 9:47:22.318751,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_00_22_seed_1_21512111
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 9:47:22.318751 at 2024-06-20 16:47:44.920995
persisted model performance metric: 

scalar performance:
{'acc': 0.9582662, 'precision': 0.7372236, 'recall': 0.5350248, 'specificity': 0.5350248, 'f1': 0.5532838, 'auroc': 0.81139684, 'binary_precision': 0.5135135, 'binary_recall': 0.073076926, 'binary_specificity': 0.99697274, 'binary_f1_score': 0.12794614}
confusion matrix:
      0   1
0  5928  18
1   241  19
oracle model performance metric: 

scalar performance:
{'acc': 0.9661618, 'precision': 0.8551972, 'recall': 0.6458065, 'specificity': 0.6458065, 'f1': 0.70282334, 'auroc': 0.82620454, 'binary_precision': 0.74038464, 'binary_recall': 0.29615384, 'binary_specificity': 0.99545914, 'binary_f1_score': 0.42307693}
confusion matrix:
      0   1
0  5919  27
1   183  77
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_irm_resnet_different_bs128_lre4_classbalancing/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_irm_resnet_different_bs128_lre4_classbalancing/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204094 KiB |   1730 MiB | 729633 GiB | 729633 GiB |
|       from large pool | 167936 KiB |   1660 MiB | 729428 GiB | 729428 GiB |
|       from small pool |  36158 KiB |     72 MiB |    204 GiB |    204 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 204094 KiB |   1730 MiB | 729633 GiB | 729633 GiB |
|       from large pool | 167936 KiB |   1660 MiB | 729428 GiB | 729428 GiB |
|       from small pool |  36158 KiB |     72 MiB |    204 GiB |    204 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201086 KiB |   1723 MiB | 729616 GiB | 729616 GiB |
|       from large pool | 165120 KiB |   1653 MiB | 729415 GiB | 729414 GiB |
|       from small pool |  35966 KiB |     71 MiB |    201 GiB |    201 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1802 MiB |   1876 MiB |   3084 MiB |   1282 MiB |
|       from large pool |   1728 MiB |   1802 MiB |   2978 MiB |   1250 MiB |
|       from small pool |     74 MiB |     74 MiB |    106 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 404161 KiB |    900 MiB | 516777 GiB | 516776 GiB |
|       from large pool | 397312 KiB |    899 MiB | 516565 GiB | 516565 GiB |
|       from small pool |   6849 KiB |     14 MiB |    211 GiB |    211 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1194    |    1851    |   21894 K  |   21893 K  |
|       from large pool |      36    |      76    |    6937 K  |    6937 K  |
|       from small pool |    1158    |    1780    |   14957 K  |   14956 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1194    |    1851    |   21894 K  |   21893 K  |
|       from large pool |      36    |      76    |    6937 K  |    6937 K  |
|       from small pool |    1158    |    1780    |   14957 K  |   14956 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      49    |      50    |      69    |      20    |
|       from large pool |      12    |      13    |      16    |       4    |
|       from small pool |      37    |      37    |      53    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      34    |     380    |   11129 K  |   11129 K  |
|       from large pool |       5    |      11    |    2733 K  |    2733 K  |
|       from small pool |      29    |     375    |    8396 K  |    8396 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1730 MiB | 729633 GiB | 729633 GiB |
|       from large pool |  16640 KiB |   1660 MiB | 729428 GiB | 729428 GiB |
|       from small pool |      0 KiB |     72 MiB |    204 GiB |    204 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1730 MiB | 729633 GiB | 729633 GiB |
|       from large pool |  16640 KiB |   1660 MiB | 729428 GiB | 729428 GiB |
|       from small pool |      0 KiB |     72 MiB |    204 GiB |    204 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1723 MiB | 729616 GiB | 729616 GiB |
|       from large pool |  16640 KiB |   1653 MiB | 729415 GiB | 729415 GiB |
|       from small pool |      0 KiB |     71 MiB |    201 GiB |    201 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 608256 KiB |   1876 MiB |   3084 MiB |   2490 MiB |
|       from large pool | 565248 KiB |   1802 MiB |   2978 MiB |   2426 MiB |
|       from small pool |  43008 KiB |     74 MiB |    106 MiB |     64 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 384768 KiB |    900 MiB | 516777 GiB | 516776 GiB |
|       from large pool | 384768 KiB |    899 MiB | 516565 GiB | 516565 GiB |
|       from small pool |      0 KiB |     14 MiB |    211 GiB |    211 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1851    |   21894 K  |   21894 K  |
|       from large pool |       2    |      76    |    6937 K  |    6937 K  |
|       from small pool |       0    |    1780    |   14957 K  |   14957 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1851    |   21894 K  |   21894 K  |
|       from large pool |       2    |      76    |    6937 K  |    6937 K  |
|       from small pool |       0    |    1780    |   14957 K  |   14957 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      30    |      50    |      69    |      39    |
|       from large pool |       9    |      13    |      16    |       7    |
|       from small pool |      21    |      37    |      53    |      32    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     380    |   11130 K  |   11130 K  |
|       from large pool |       1    |      11    |    2733 K  |    2733 K  |
|       from small pool |       0    |     375    |    8396 K  |    8396 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1730 MiB | 729633 GiB | 729633 GiB |
|       from large pool |  16640 KiB |   1660 MiB | 729428 GiB | 729428 GiB |
|       from small pool |      0 KiB |     72 MiB |    204 GiB |    204 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1730 MiB | 729633 GiB | 729633 GiB |
|       from large pool |  16640 KiB |   1660 MiB | 729428 GiB | 729428 GiB |
|       from small pool |      0 KiB |     72 MiB |    204 GiB |    204 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1723 MiB | 729616 GiB | 729616 GiB |
|       from large pool |  16640 KiB |   1653 MiB | 729415 GiB | 729415 GiB |
|       from small pool |      0 KiB |     71 MiB |    201 GiB |    201 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 608256 KiB |   1876 MiB |   3084 MiB |   2490 MiB |
|       from large pool | 565248 KiB |   1802 MiB |   2978 MiB |   2426 MiB |
|       from small pool |  43008 KiB |     74 MiB |    106 MiB |     64 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 384768 KiB |    900 MiB | 516777 GiB | 516776 GiB |
|       from large pool | 384768 KiB |    899 MiB | 516565 GiB | 516565 GiB |
|       from small pool |      0 KiB |     14 MiB |    211 GiB |    211 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1851    |   21894 K  |   21894 K  |
|       from large pool |       2    |      76    |    6937 K  |    6937 K  |
|       from small pool |       0    |    1780    |   14957 K  |   14957 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1851    |   21894 K  |   21894 K  |
|       from large pool |       2    |      76    |    6937 K  |    6937 K  |
|       from small pool |       0    |    1780    |   14957 K  |   14957 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      30    |      50    |      69    |      39    |
|       from large pool |       9    |      13    |      16    |       7    |
|       from small pool |      21    |      37    |      53    |      32    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     380    |   11130 K  |   11130 K  |
|       from large pool |       1    |      11    |    2733 K  |    2733 K  |
|       from small pool |       0    |     375    |    8396 K  |    8396 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0




!!!: not committed yet



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_03_51_seed_2_21512111

 Experiment start at: 2024-06-20 17:03:51.532395
before training, model accuracy: 0.0544959120452404
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.94375426, 'precision': 0.9662235, 'recall': 0.7115079, 'specificity': 0.7115079, 'f1': 0.7815447, 'auroc': 0.94349515, 'binary_precision': 0.99072164, 'binary_recall': 0.4234413, 'binary_specificity': 0.99957454, 'binary_f1_score': 0.5933015}
confusion matrix:
       0     1
0  42291    18
1   2617  1922
---- Validation: 
scalar performance:
{'acc': 0.9671869, 'precision': 0.48395437, 'recall': 0.49961478, 'specificity': 0.49961478, 'f1': 0.4916599, 'auroc': 0.5522073, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99922955, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18157  14
1    602   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9607309, 'precision': 0.48059654, 'recall': 0.49974987, 'specificity': 0.49974987, 'f1': 0.4899861, 'auroc': 0.59124756, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5994  3
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512111_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-20 17:33:40.154897,epoch time: 0:29:48.622502,used: 0:29:48.622502,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_03_51_seed_2_21512111
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9693263, 'precision': 0.97915256, 'recall': 0.8446554, 'specificity': 0.8446554, 'f1': 0.8983453, 'auroc': 0.9731958, 'binary_precision': 0.9905123, 'binary_recall': 0.69001985, 'binary_specificity': 0.99929094, 'binary_f1_score': 0.81340086}
confusion matrix:
       0     1
0  42279    30
1   1407  3132
---- Validation: 
scalar performance:
{'acc': 0.9682523, 'precision': 0.7739946, 'recall': 0.51783216, 'specificity': 0.51783216, 'f1': 0.52630043, 'auroc': 0.6434897, 'binary_precision': 0.57894737, 'binary_recall': 0.036544852, 'binary_specificity': 0.99911946, 'binary_f1_score': 0.06875}
confusion matrix:
       0   1
0  18155  16
1    580  22
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608912, 'precision': 0.6953299, 'recall': 0.5117297, 'specificity': 0.5117297, 'f1': 0.5134555, 'auroc': 0.67843914, 'binary_precision': 0.42857143, 'binary_recall': 0.024793388, 'binary_specificity': 0.998666, 'binary_f1_score': 0.046875}
confusion matrix:
      0  1
0  5989  8
1   236  6
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512111_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-20 18:03:22.618029,epoch time: 0:29:42.463132,used: 0:59:31.085634,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_03_51_seed_2_21512111
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97673327, 'precision': 0.9810706, 'recall': 0.8847228, 'specificity': 0.8847228, 'f1': 0.92621696, 'auroc': 0.97983205, 'binary_precision': 0.9861816, 'binary_recall': 0.7706038, 'binary_specificity': 0.9988419, 'binary_f1_score': 0.86516577}
confusion matrix:
       0     1
0  42261    49
1   1041  3497
---- Validation: 
scalar performance:
{'acc': 0.968998, 'precision': 0.78028136, 'recall': 0.5535515, 'specificity': 0.5535515, 'f1': 0.58453625, 'auroc': 0.69407284, 'binary_precision': 0.58928573, 'binary_recall': 0.10963455, 'binary_specificity': 0.9974685, 'binary_f1_score': 0.18487397}
confusion matrix:
       0   1
0  18125  46
1    536  66
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645777, 'precision': 0.85514665, 'recall': 0.56519854, 'specificity': 0.56519854, 'f1': 0.6032181, 'auroc': 0.7070174, 'binary_precision': 0.74418604, 'binary_recall': 0.1322314, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.2245614}
confusion matrix:
      0   1
0  5986  11
1   210  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512111_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-20 18:31:19.786066,epoch time: 0:27:57.168037,used: 1:27:28.253671,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_03_51_seed_2_21512111
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98059684, 'precision': 0.9803946, 'recall': 0.907223, 'specificity': 0.907223, 'f1': 0.9400296, 'auroc': 0.9854697, 'binary_precision': 0.9801535, 'binary_recall': 0.8162186, 'binary_specificity': 0.99822736, 'binary_f1_score': 0.8907058}
confusion matrix:
       0     1
0  42235    75
1    834  3704
---- Validation: 
scalar performance:
{'acc': 0.9685719, 'precision': 0.75259805, 'recall': 0.57983196, 'specificity': 0.57983196, 'f1': 0.6176091, 'auroc': 0.73906004, 'binary_precision': 0.5322581, 'binary_recall': 0.16445182, 'binary_specificity': 0.99521214, 'binary_f1_score': 0.25126904}
confusion matrix:
       0   1
0  18084  87
1    503  99
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96666133, 'precision': 0.85273206, 'recall': 0.60792005, 'specificity': 0.60792005, 'f1': 0.66023993, 'auroc': 0.7428363, 'binary_precision': 0.7361111, 'binary_recall': 0.21900827, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.3375796}
confusion matrix:
      0   1
0  5978  19
1   189  53
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512111_4.png
new oracle model saved
early stop counter: 1
val acc:0.9685719013214111, best validation acc: 0.9689980149269104, corresponding to test acc:                         0.9645776748657227 / 0.9666613340377808
after epoch: 4,now: 2024-06-20 18:55:23.581793,epoch time: 0:24:03.795727,used: 1:51:32.049398,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_03_51_seed_2_21512111
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98356384, 'precision': 0.9807887, 'recall': 0.9239317, 'specificity': 0.9239317, 'f1': 0.9501129, 'auroc': 0.9900108, 'binary_precision': 0.9774512, 'binary_recall': 0.84996694, 'binary_specificity': 0.99789643, 'binary_f1_score': 0.9092623}
confusion matrix:
       0     1
0  42220    89
1    681  3858
---- Validation: 
scalar performance:
{'acc': 0.9681457, 'precision': 0.74124694, 'recall': 0.59567285, 'specificity': 0.59567285, 'f1': 0.63419956, 'auroc': 0.78051347, 'binary_precision': 0.508547, 'binary_recall': 0.19767442, 'binary_specificity': 0.99367124, 'binary_f1_score': 0.28468898}
confusion matrix:
       0    1
0  18056  115
1    483  119
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96842444, 'precision': 0.8621769, 'recall': 0.6365955, 'specificity': 0.6365955, 'f1': 0.6943079, 'auroc': 0.78458637, 'binary_precision': 0.752809, 'binary_recall': 0.2768595, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.40483385}
confusion matrix:
      0   1
0  5975  22
1   175  67
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512111_5.png
new oracle model saved
early stop counter: 2
val acc:0.9681457281112671, best validation acc: 0.9689980149269104, corresponding to test acc:                         0.9645776748657227 / 0.9684244394302368
after epoch: 5,now: 2024-06-20 19:19:26.540759,epoch time: 0:24:02.958966,used: 2:15:35.008364,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_03_51_seed_2_21512111
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9844177, 'precision': 0.9824521, 'recall': 0.9273546, 'specificity': 0.9273546, 'f1': 0.95280457, 'auroc': 0.9896883, 'binary_precision': 0.98008573, 'binary_recall': 0.8565763, 'binary_specificity': 0.99813277, 'binary_f1_score': 0.91417825}
confusion matrix:
       0     1
0  42230    79
1    651  3888
---- Validation: 
scalar performance:
{'acc': 0.9685719, 'precision': 0.7508445, 'recall': 0.59107465, 'specificity': 0.59107465, 'f1': 0.6304488, 'auroc': 0.77325606, 'binary_precision': 0.52803737, 'binary_recall': 0.18770765, 'binary_specificity': 0.9944417, 'binary_f1_score': 0.2769608}
confusion matrix:
       0    1
0  18070  101
1    489  113
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9674627, 'precision': 0.8721651, 'recall': 0.61230236, 'specificity': 0.61230236, 'f1': 0.66737527, 'auroc': 0.76558644, 'binary_precision': 0.7746479, 'binary_recall': 0.22727273, 'binary_specificity': 0.997332, 'binary_f1_score': 0.35143772}
confusion matrix:
      0   1
0  5981  16
1   187  55
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512111_6.png
early stop counter: 3
val acc:0.9685719013214111, best validation acc: 0.9689980149269104, corresponding to test acc:                         0.9645776748657227 / 0.9684244394302368
after epoch: 6,now: 2024-06-20 19:42:27.893450,epoch time: 0:23:01.352691,used: 2:38:36.361055,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_03_51_seed_2_21512111
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9846098, 'precision': 0.9811655, 'recall': 0.9296243, 'specificity': 0.9296243, 'f1': 0.9535584, 'auroc': 0.9913516, 'binary_precision': 0.9770115, 'binary_recall': 0.8614232, 'binary_specificity': 0.9978255, 'binary_f1_score': 0.91558367}
confusion matrix:
       0     1
0  42217    92
1    629  3910
---- Validation: 
scalar performance:
{'acc': 0.968998, 'precision': 0.761755, 'recall': 0.58888566, 'specificity': 0.58888566, 'f1': 0.6292374, 'auroc': 0.77877057, 'binary_precision': 0.55, 'binary_recall': 0.18272425, 'binary_specificity': 0.99504703, 'binary_f1_score': 0.27431422}
confusion matrix:
       0    1
0  18081   90
1    492  110
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9668216, 'precision': 0.8405582, 'recall': 0.61989987, 'specificity': 0.61989987, 'f1': 0.67302203, 'auroc': 0.767767, 'binary_precision': 0.7108434, 'binary_recall': 0.24380165, 'binary_specificity': 0.995998, 'binary_f1_score': 0.36307693}
confusion matrix:
      0   1
0  5973  24
1   183  59
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512111_7.png
early stop counter: 4
val acc:0.9689980149269104, best validation acc: 0.9689980149269104, corresponding to test acc:                         0.9645776748657227 / 0.9684244394302368
after epoch: 7,now: 2024-06-20 20:03:45.424910,epoch time: 0:21:17.531460,used: 2:59:53.892515,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_03_51_seed_2_21512111
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9867871, 'precision': 0.98325866, 'recall': 0.9402703, 'specificity': 0.9402703, 'f1': 0.9605025, 'auroc': 0.9924395, 'binary_precision': 0.9789834, 'binary_recall': 0.88257325, 'binary_specificity': 0.99796736, 'binary_f1_score': 0.9282818}
confusion matrix:
       0     1
0  42223    86
1    533  4006
---- Validation: 
scalar performance:
{'acc': 0.9688915, 'precision': 0.76074326, 'recall': 0.5824062, 'specificity': 0.5824062, 'f1': 0.62149775, 'auroc': 0.7913939, 'binary_precision': 0.5483871, 'binary_recall': 0.16943522, 'binary_specificity': 0.99537724, 'binary_f1_score': 0.25888324}
confusion matrix:
       0    1
0  18087   84
1    500  102
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96602017, 'precision': 0.838681, 'recall': 0.603621, 'specificity': 0.603621, 'f1': 0.65370613, 'auroc': 0.7806663, 'binary_precision': 0.7083333, 'binary_recall': 0.2107438, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.32484075}
confusion matrix:
      0   1
0  5976  21
1   191  51
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512111_8.png
early stop counter: 5
val acc:0.9688915014266968, best validation acc: 0.9689980149269104, corresponding to test acc:                         0.9645776748657227 / 0.9684244394302368
after epoch: 8,now: 2024-06-20 20:23:47.864502,epoch time: 0:20:02.439592,used: 3:19:56.332107,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_03_51_seed_2_21512111
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9876836, 'precision': 0.9823992, 'recall': 0.94627357, 'specificity': 0.94627357, 'f1': 0.9634485, 'auroc': 0.9936814, 'binary_precision': 0.97597307, 'binary_recall': 0.89491075, 'binary_specificity': 0.99763644, 'binary_f1_score': 0.9336858}
confusion matrix:
       0     1
0  42209   100
1    477  4062
---- Validation: 
scalar performance:
{'acc': 0.9692644, 'precision': 0.76737386, 'recall': 0.59303844, 'specificity': 0.59303844, 'f1': 0.6346504, 'auroc': 0.79807556, 'binary_precision': 0.5609756, 'binary_recall': 0.1910299, 'binary_specificity': 0.99504703, 'binary_f1_score': 0.2850062}
confusion matrix:
       0    1
0  18081   90
1    487  115
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96650106, 'precision': 0.84475017, 'recall': 0.60981935, 'specificity': 0.60981935, 'f1': 0.66175395, 'auroc': 0.78335226, 'binary_precision': 0.72, 'binary_recall': 0.2231405, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.340694}
confusion matrix:
      0   1
0  5976  21
1   188  54
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512111_9.png
better model found
persisted
after epoch: 9,now: 2024-06-20 20:45:32.486869,epoch time: 0:21:44.622367,used: 3:41:40.954474,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_03_51_seed_2_21512111
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98706454, 'precision': 0.9824965, 'recall': 0.942575, 'specificity': 0.942575, 'f1': 0.9614484, 'auroc': 0.9925408, 'binary_precision': 0.9769529, 'binary_recall': 0.8873953, 'binary_specificity': 0.9977547, 'binary_f1_score': 0.9300231}
confusion matrix:
       0     1
0  42215    95
1    511  4027
---- Validation: 
scalar performance:
{'acc': 0.9693709, 'precision': 0.7738999, 'recall': 0.58426, 'specificity': 0.58426, 'f1': 0.62500215, 'auroc': 0.7910323, 'binary_precision': 0.5745856, 'binary_recall': 0.17275748, 'binary_specificity': 0.99576247, 'binary_f1_score': 0.26564497}
confusion matrix:
       0    1
0  18094   77
1    498  104
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96473795, 'precision': 0.8172958, 'recall': 0.58907485, 'specificity': 0.58907485, 'f1': 0.63381857, 'auroc': 0.773247, 'binary_precision': 0.6666667, 'binary_recall': 0.18181819, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.2857143}
confusion matrix:
      0   1
0  5975  22
1   198  44
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512111_10.png
better model found
persisted
after epoch: 10,now: 2024-06-20 21:05:33.806533,epoch time: 0:20:01.319664,used: 4:01:42.274138,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_03_51_seed_2_21512111
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9885374, 'precision': 0.98451734, 'recall': 0.9492048, 'specificity': 0.9492048, 'f1': 0.9660175, 'auroc': 0.99386007, 'binary_precision': 0.97962606, 'binary_recall': 0.9004186, 'binary_specificity': 0.99799097, 'binary_f1_score': 0.9383538}
confusion matrix:
       0     1
0  42224    85
1    452  4087
---- Validation: 
scalar performance:
{'acc': 0.9692644, 'precision': 0.77075875, 'recall': 0.584205, 'specificity': 0.584205, 'f1': 0.62463605, 'auroc': 0.79738396, 'binary_precision': 0.568306, 'binary_recall': 0.17275748, 'binary_specificity': 0.99565244, 'binary_f1_score': 0.26496816}
confusion matrix:
       0    1
0  18092   79
1    498  104
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650585, 'precision': 0.8277176, 'recall': 0.5892416, 'specificity': 0.5892416, 'f1': 0.6348359, 'auroc': 0.781747, 'binary_precision': 0.6875, 'binary_recall': 0.18181819, 'binary_specificity': 0.996665, 'binary_f1_score': 0.2875817}
confusion matrix:
      0   1
0  5977  20
1   198  44
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512111_11.png
early stop counter: 1
val acc:0.9692643880844116, best validation acc: 0.9693709015846252, corresponding to test acc:                         0.9647379517555237 / 0.9684244394302368
after epoch: 11,now: 2024-06-20 21:24:31.040529,epoch time: 0:18:57.233996,used: 4:20:39.508134,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_03_51_seed_2_21512111
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98851603, 'precision': 0.9811436, 'recall': 0.95232964, 'specificity': 0.95232964, 'f1': 0.96617365, 'auroc': 0.9939232, 'binary_precision': 0.97214353, 'binary_recall': 0.90744823, 'binary_specificity': 0.99721104, 'binary_f1_score': 0.9386825}
confusion matrix:
       0     1
0  42192   118
1    420  4118
---- Validation: 
scalar performance:
{'acc': 0.9687849, 'precision': 0.7538787, 'recall': 0.6032305, 'specificity': 0.6032305, 'f1': 0.64403623, 'auroc': 0.8156508, 'binary_precision': 0.53333336, 'binary_recall': 0.21262458, 'binary_specificity': 0.99383634, 'binary_f1_score': 0.304038}
confusion matrix:
       0    1
0  18059  112
1    474  128
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96553934, 'precision': 0.81429964, 'recall': 0.6132846, 'specificity': 0.6132846, 'f1': 0.6624068, 'auroc': 0.8017918, 'binary_precision': 0.65882355, 'binary_recall': 0.23140496, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.34250763}
confusion matrix:
      0   1
0  5968  29
1   186  56
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512111_12.png
early stop counter: 2
val acc:0.9687849283218384, best validation acc: 0.9693709015846252, corresponding to test acc:                         0.9647379517555237 / 0.9684244394302368
after epoch: 12,now: 2024-06-20 21:42:56.791390,epoch time: 0:18:25.750861,used: 4:39:05.258995,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_03_51_seed_2_21512111
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98851603, 'precision': 0.9859636, 'recall': 0.9477179, 'specificity': 0.9477179, 'f1': 0.96585214, 'auroc': 0.99462783, 'binary_precision': 0.98286265, 'binary_recall': 0.8971139, 'binary_specificity': 0.9983219, 'binary_f1_score': 0.9380327}
confusion matrix:
       0     1
0  42238    71
1    467  4072
---- Validation: 
scalar performance:
{'acc': 0.9689448, 'precision': 0.76328486, 'recall': 0.57922155, 'specificity': 0.57922155, 'f1': 0.617874, 'auroc': 0.8099655, 'binary_precision': 0.5536723, 'binary_recall': 0.1627907, 'binary_specificity': 0.99565244, 'binary_f1_score': 0.25160462}
confusion matrix:
       0   1
0  18092  79
1    504  98
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9648982, 'precision': 0.83813214, 'recall': 0.5792445, 'specificity': 0.5792445, 'f1': 0.6223237, 'auroc': 0.7936224, 'binary_precision': 0.7090909, 'binary_recall': 0.16115703, 'binary_specificity': 0.997332, 'binary_f1_score': 0.26262626}
confusion matrix:
      0   1
0  5981  16
1   203  39
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512111_13.png
early stop counter: 3
val acc:0.968944787979126, best validation acc: 0.9693709015846252, corresponding to test acc:                         0.9647379517555237 / 0.9684244394302368
after epoch: 13,now: 2024-06-20 22:01:14.767420,epoch time: 0:18:17.976030,used: 4:57:23.235025,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_03_51_seed_2_21512111
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9899462, 'precision': 0.98728913, 'recall': 0.9546952, 'specificity': 0.9546952, 'f1': 0.9702798, 'auroc': 0.99523246, 'binary_precision': 0.9840514, 'binary_recall': 0.910974, 'binary_specificity': 0.9984164, 'binary_f1_score': 0.94610363}
confusion matrix:
       0     1
0  42243    67
1    404  4134
---- Validation: 
scalar performance:
{'acc': 0.9688382, 'precision': 0.75864613, 'recall': 0.58478785, 'specificity': 0.58478785, 'f1': 0.62411654, 'auroc': 0.81058836, 'binary_precision': 0.54404145, 'binary_recall': 0.1744186, 'binary_specificity': 0.9951571, 'binary_f1_score': 0.26415092}
confusion matrix:
       0    1
0  18083   88
1    497  105
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96377623, 'precision': 0.7895024, 'recall': 0.5885746, 'specificity': 0.5885746, 'f1': 0.6308377, 'auroc': 0.7892453, 'binary_precision': 0.6111111, 'binary_recall': 0.18181819, 'binary_specificity': 0.995331, 'binary_f1_score': 0.28025478}
confusion matrix:
      0   1
0  5969  28
1   198  44
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512111_14.png
early stop counter: 4
val acc:0.9688382148742676, best validation acc: 0.9693709015846252, corresponding to test acc:                         0.9647379517555237 / 0.9684244394302368
after epoch: 14,now: 2024-06-20 22:19:53.927912,epoch time: 0:18:39.160492,used: 5:16:02.395517,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_03_51_seed_2_21512111
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98969007, 'precision': 0.9849686, 'recall': 0.95544827, 'specificity': 0.95544827, 'f1': 0.9696224, 'auroc': 0.99520946, 'binary_precision': 0.979206, 'binary_recall': 0.91297644, 'binary_specificity': 0.99792004, 'binary_f1_score': 0.9449321}
confusion matrix:
       0     1
0  42221    88
1    395  4144
---- Validation: 
scalar performance:
{'acc': 0.9688915, 'precision': 0.7596363, 'recall': 0.5864215, 'specificity': 0.5864215, 'f1': 0.6261392, 'auroc': 0.82247853, 'binary_precision': 0.54591835, 'binary_recall': 0.17774086, 'binary_specificity': 0.9951021, 'binary_f1_score': 0.26817042}
confusion matrix:
       0    1
0  18082   89
1    495  107
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9631351, 'precision': 0.7833307, 'recall': 0.5723792, 'specificity': 0.5723792, 'f1': 0.60976046, 'auroc': 0.7945421, 'binary_precision': 0.6, 'binary_recall': 0.14876033, 'binary_specificity': 0.995998, 'binary_f1_score': 0.2384106}
confusion matrix:
      0   1
0  5973  24
1   206  36
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512111_15.png
early stop counter: 5
val acc:0.9688915014266968, best validation acc: 0.9693709015846252, corresponding to test acc:                         0.9647379517555237 / 0.9684244394302368
after epoch: 15,now: 2024-06-20 22:37:51.793182,epoch time: 0:17:57.865270,used: 5:34:00.260787,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_03_51_seed_2_21512111
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9909708, 'precision': 0.987939, 'recall': 0.9599925, 'specificity': 0.9599925, 'f1': 0.9734449, 'auroc': 0.9960966, 'binary_precision': 0.9842353, 'binary_recall': 0.92156863, 'binary_specificity': 0.9984164, 'binary_f1_score': 0.95187163}
confusion matrix:
       0     1
0  42242    67
1    356  4183
---- Validation: 
scalar performance:
{'acc': 0.9691578, 'precision': 0.76707846, 'recall': 0.585756, 'specificity': 0.585756, 'f1': 0.62613106, 'auroc': 0.82016563, 'binary_precision': 0.56084657, 'binary_recall': 0.17607974, 'binary_specificity': 0.99543226, 'binary_f1_score': 0.26801518}
confusion matrix:
       0    1
0  18088   83
1    496  106
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.962494, 'precision': 0.76550233, 'recall': 0.57006294, 'specificity': 0.57006294, 'f1': 0.60552096, 'auroc': 0.7934918, 'binary_precision': 0.5645161, 'binary_recall': 0.1446281, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.23026314}
confusion matrix:
      0   1
0  5970  27
1   207  35
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512111_16.png
early stop counter: 6
val acc:0.9691578149795532, best validation acc: 0.9693709015846252, corresponding to test acc:                         0.9647379517555237 / 0.9684244394302368
after epoch: 16,now: 2024-06-20 22:56:00.869493,epoch time: 0:18:09.076311,used: 5:52:09.337098,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_03_51_seed_2_21512111
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99062926, 'precision': 0.98629415, 'recall': 0.95960677, 'specificity': 0.95960677, 'f1': 0.9724741, 'auroc': 0.99587417, 'binary_precision': 0.9809948, 'binary_recall': 0.921128, 'binary_specificity': 0.9980855, 'binary_f1_score': 0.9501193}
confusion matrix:
       0     1
0  42228    81
1    358  4181
---- Validation: 
scalar performance:
{'acc': 0.9694242, 'precision': 0.7725259, 'recall': 0.5907119, 'specificity': 0.5907119, 'f1': 0.63254094, 'auroc': 0.8255808, 'binary_precision': 0.5714286, 'binary_recall': 0.18604651, 'binary_specificity': 0.99537724, 'binary_f1_score': 0.28070176}
confusion matrix:
       0    1
0  18087   84
1    490  112
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96361595, 'precision': 0.7991282, 'recall': 0.5726293, 'specificity': 0.5726293, 'f1': 0.611082, 'auroc': 0.7926984, 'binary_precision': 0.6315789, 'binary_recall': 0.14876033, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.24080269}
confusion matrix:
      0   1
0  5976  21
1   206  36
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512111_17.png
better model found
persisted
after epoch: 17,now: 2024-06-20 23:14:52.988621,epoch time: 0:18:52.119128,used: 6:11:01.456226,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_03_51_seed_2_21512111
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9911202, 'precision': 0.9886487, 'recall': 0.9601736, 'specificity': 0.9601736, 'f1': 0.973871, 'auroc': 0.9965817, 'binary_precision': 0.98563015, 'binary_recall': 0.92178893, 'binary_specificity': 0.9985582, 'binary_f1_score': 0.9526412}
confusion matrix:
       0     1
0  42248    61
1    355  4184
---- Validation: 
scalar performance:
{'acc': 0.9688382, 'precision': 0.7592763, 'recall': 0.58237875, 'specificity': 0.58237875, 'f1': 0.6213199, 'auroc': 0.82290363, 'binary_precision': 0.54545456, 'binary_recall': 0.16943522, 'binary_specificity': 0.9953222, 'binary_f1_score': 0.25855514}
confusion matrix:
       0    1
0  18086   85
1    500  102
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9631351, 'precision': 0.7833307, 'recall': 0.5723792, 'specificity': 0.5723792, 'f1': 0.60976046, 'auroc': 0.78916883, 'binary_precision': 0.6, 'binary_recall': 0.14876033, 'binary_specificity': 0.995998, 'binary_f1_score': 0.2384106}
confusion matrix:
      0   1
0  5973  24
1   206  36
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512111_18.png
early stop counter: 1
val acc:0.9688382148742676, best validation acc: 0.9694241881370544, corresponding to test acc:                         0.9636159539222717 / 0.9684244394302368
after epoch: 18,now: 2024-06-20 23:33:22.778400,epoch time: 0:18:29.789779,used: 6:29:31.246005,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_03_51_seed_2_21512111
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9919527, 'precision': 0.9851798, 'recall': 0.9684032, 'specificity': 0.9684032, 'f1': 0.9766043, 'auroc': 0.99703246, 'binary_precision': 0.9768561, 'binary_recall': 0.93919367, 'binary_specificity': 0.9976128, 'binary_f1_score': 0.9576547}
confusion matrix:
       0     1
0  42208   101
1    276  4263
---- Validation: 
scalar performance:
{'acc': 0.9688915, 'precision': 0.75667626, 'recall': 0.60007334, 'specificity': 0.60007334, 'f1': 0.64108515, 'auroc': 0.8410792, 'binary_precision': 0.53913045, 'binary_recall': 0.20598006, 'binary_specificity': 0.99416655, 'binary_f1_score': 0.29807693}
confusion matrix:
       0    1
0  18065  106
1    478  124
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9631351, 'precision': 0.776566, 'recall': 0.5822929, 'specificity': 0.5822929, 'f1': 0.62195766, 'auroc': 0.7985761, 'binary_precision': 0.5857143, 'binary_recall': 0.1694215, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.26282054}
confusion matrix:
      0   1
0  5968  29
1   201  41
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512111_19.png
early stop counter: 2
val acc:0.9688915014266968, best validation acc: 0.9694241881370544, corresponding to test acc:                         0.9636159539222717 / 0.9684244394302368
after epoch: 19,now: 2024-06-20 23:57:57.220004,epoch time: 0:24:34.441604,used: 6:54:05.687609,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_03_51_seed_2_21512111
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9914191, 'precision': 0.9875121, 'recall': 0.9629942, 'specificity': 0.9629942, 'f1': 0.9748529, 'auroc': 0.9961716, 'binary_precision': 0.98273045, 'binary_recall': 0.9277374, 'binary_specificity': 0.99825096, 'binary_f1_score': 0.95444244}
confusion matrix:
       0     1
0  42235    74
1    328  4211
---- Validation: 
scalar performance:
{'acc': 0.9690513, 'precision': 0.76158214, 'recall': 0.5945345, 'specificity': 0.5945345, 'f1': 0.63564944, 'auroc': 0.8408587, 'binary_precision': 0.5492958, 'binary_recall': 0.19435216, 'binary_specificity': 0.9947169, 'binary_f1_score': 0.28711656}
confusion matrix:
       0    1
0  18075   96
1    485  117
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9623337, 'precision': 0.7658834, 'recall': 0.56006587, 'specificity': 0.56006587, 'f1': 0.5920503, 'auroc': 0.8007736, 'binary_precision': 0.5660377, 'binary_recall': 0.12396694, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.20338982}
confusion matrix:
      0   1
0  5974  23
1   212  30
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512111_20.png
early stop counter: 3
val acc:0.9690513014793396, best validation acc: 0.9694241881370544, corresponding to test acc:                         0.9636159539222717 / 0.9684244394302368
after epoch: 20,now: 2024-06-21 00:21:54.959863,epoch time: 0:23:57.739859,used: 7:18:03.427468,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_03_51_seed_2_21512111
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9914191, 'precision': 0.9874111, 'recall': 0.9630925, 'specificity': 0.9630925, 'f1': 0.97485805, 'auroc': 0.99707466, 'binary_precision': 0.98250526, 'binary_recall': 0.9279577, 'binary_specificity': 0.9982273, 'binary_f1_score': 0.95445275}
confusion matrix:
       0     1
0  42234    75
1    327  4212
---- Validation: 
scalar performance:
{'acc': 0.9689448, 'precision': 0.7601788, 'recall': 0.5896612, 'specificity': 0.5896612, 'f1': 0.6299543, 'auroc': 0.8378197, 'binary_precision': 0.54679805, 'binary_recall': 0.18438539, 'binary_specificity': 0.994937, 'binary_f1_score': 0.27577642}
confusion matrix:
       0    1
0  18079   92
1    491  111
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9623337, 'precision': 0.76371694, 'recall': 0.5640313, 'specificity': 0.5640313, 'f1': 0.5973757, 'auroc': 0.7951627, 'binary_precision': 0.5614035, 'binary_recall': 0.1322314, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.2140468}
confusion matrix:
      0   1
0  5972  25
1   210  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512111_21.png
early stop counter: 4
val acc:0.968944787979126, best validation acc: 0.9694241881370544, corresponding to test acc:                         0.9636159539222717 / 0.9684244394302368
after epoch: 21,now: 2024-06-21 00:45:20.064960,epoch time: 0:23:25.105097,used: 7:41:28.532565,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_03_51_seed_2_21512111
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99126965, 'precision': 0.98802596, 'recall': 0.961633, 'specificity': 0.961633, 'f1': 0.9743656, 'auroc': 0.99567604, 'binary_precision': 0.98406, 'binary_recall': 0.9248733, 'binary_specificity': 0.99839276, 'binary_f1_score': 0.9535491}
confusion matrix:
       0     1
0  42241    68
1    341  4198
---- Validation: 
scalar performance:
{'acc': 0.9694774, 'precision': 0.78088367, 'recall': 0.57789063, 'specificity': 0.57789063, 'f1': 0.6177009, 'auroc': 0.83214355, 'binary_precision': 0.5889571, 'binary_recall': 0.15946844, 'binary_specificity': 0.9963128, 'binary_f1_score': 0.2509804}
confusion matrix:
       0   1
0  18104  67
1    506  96
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621734, 'precision': 0.7738527, 'recall': 0.5421378, 'specificity': 0.5421378, 'f1': 0.5658674, 'auroc': 0.78080463, 'binary_precision': 0.5833333, 'binary_recall': 0.08677686, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.15107913}
confusion matrix:
      0   1
0  5982  15
1   221  21
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512111_22.png
better model found
persisted
after epoch: 22,now: 2024-06-21 01:12:45.181626,epoch time: 0:27:25.116666,used: 8:08:53.649231,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_03_51_seed_2_21512111
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99334013, 'precision': 0.99114144, 'recall': 0.97054815, 'specificity': 0.97054815, 'f1': 0.98056567, 'auroc': 0.9970076, 'binary_precision': 0.9884446, 'binary_recall': 0.942278, 'binary_specificity': 0.9988182, 'binary_f1_score': 0.9648093}
confusion matrix:
       0     1
0  42259    50
1    262  4277
---- Validation: 
scalar performance:
{'acc': 0.969584, 'precision': 0.7803953, 'recall': 0.58437, 'specificity': 0.58437, 'f1': 0.6257394, 'auroc': 0.8392544, 'binary_precision': 0.5875706, 'binary_recall': 0.17275748, 'binary_specificity': 0.9959826, 'binary_f1_score': 0.267009}
confusion matrix:
       0    1
0  18098   73
1    498  104
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9616926, 'precision': 0.7534563, 'recall': 0.5379222, 'specificity': 0.5379222, 'f1': 0.5587978, 'auroc': 0.783293, 'binary_precision': 0.54285717, 'binary_recall': 0.0785124, 'binary_specificity': 0.997332, 'binary_f1_score': 0.13718411}
confusion matrix:
      0   1
0  5981  16
1   223  19
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512111_23.png
better model found
persisted
after epoch: 23,now: 2024-06-21 01:41:49.563148,epoch time: 0:29:04.381522,used: 8:37:58.030753,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_03_51_seed_2_21512111
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9925717, 'precision': 0.9877527, 'recall': 0.96943426, 'specificity': 0.96943426, 'f1': 0.9783714, 'auroc': 0.9972786, 'binary_precision': 0.9818349, 'binary_recall': 0.9407358, 'binary_specificity': 0.99813277, 'binary_f1_score': 0.96084607}
confusion matrix:
       0     1
0  42230    79
1    269  4270
---- Validation: 
scalar performance:
{'acc': 0.9687317, 'precision': 0.755685, 'recall': 0.5855359, 'specificity': 0.5855359, 'f1': 0.6246788, 'auroc': 0.8428869, 'binary_precision': 0.53807104, 'binary_recall': 0.17607974, 'binary_specificity': 0.994992, 'binary_f1_score': 0.26533166}
confusion matrix:
       0    1
0  18080   91
1    496  106
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9626543, 'precision': 0.7787132, 'recall': 0.55824983, 'specificity': 0.55824983, 'f1': 0.59009695, 'auroc': 0.7937285, 'binary_precision': 0.59183675, 'binary_recall': 0.11983471, 'binary_specificity': 0.996665, 'binary_f1_score': 0.19931273}
confusion matrix:
      0   1
0  5977  20
1   213  29
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512111_24.png
early stop counter: 1
val acc:0.968731701374054, best validation acc: 0.9695839881896973, corresponding to test acc:                         0.9616925716400146 / 0.9684244394302368
after epoch: 24,now: 2024-06-21 02:09:57.463712,epoch time: 0:28:07.900564,used: 9:06:05.931317,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_03_51_seed_2_21512111
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9919527, 'precision': 0.9884566, 'recall': 0.9651506, 'specificity': 0.9651506, 'f1': 0.9764431, 'auroc': 0.99703825, 'binary_precision': 0.984175, 'binary_recall': 0.9319083, 'binary_specificity': 0.9983928, 'binary_f1_score': 0.9573288}
confusion matrix:
       0     1
0  42242    68
1    309  4229
---- Validation: 
scalar performance:
{'acc': 0.9690513, 'precision': 0.76814127, 'recall': 0.57526135, 'specificity': 0.57526135, 'f1': 0.6133531, 'auroc': 0.845533, 'binary_precision': 0.56363636, 'binary_recall': 0.15448505, 'binary_specificity': 0.99603766, 'binary_f1_score': 0.24250327}
confusion matrix:
       0   1
0  18099  72
1    509  93
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.961372, 'precision': 0.73787713, 'recall': 0.5456864, 'specificity': 0.5456864, 'f1': 0.57025504, 'auroc': 0.7924992, 'binary_precision': 0.51111114, 'binary_recall': 0.09504132, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.16027875}
confusion matrix:
      0   1
0  5975  22
1   219  23
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512111_25.png
early stop counter: 2
val acc:0.9690513014793396, best validation acc: 0.9695839881896973, corresponding to test acc:                         0.9616925716400146 / 0.9684244394302368
after epoch: 25,now: 2024-06-21 02:37:37.629254,epoch time: 0:27:40.165542,used: 9:33:46.096859,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_03_51_seed_2_21512111
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9923369, 'precision': 0.9878999, 'recall': 0.9679276, 'specificity': 0.9679276, 'f1': 0.97764945, 'auroc': 0.99765635, 'binary_precision': 0.98245615, 'binary_recall': 0.93765146, 'binary_specificity': 0.9982037, 'binary_f1_score': 0.959531}
confusion matrix:
       0     1
0  42233    76
1    283  4256
---- Validation: 
scalar performance:
{'acc': 0.9687317, 'precision': 0.7562065, 'recall': 0.5831267, 'specificity': 0.5831267, 'f1': 0.6219008, 'auroc': 0.8405034, 'binary_precision': 0.539267, 'binary_recall': 0.17109634, 'binary_specificity': 0.9951571, 'binary_f1_score': 0.25977302}
confusion matrix:
       0    1
0  18083   88
1    499  103
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608912, 'precision': 0.72443086, 'recall': 0.5573327, 'specificity': 0.5573327, 'f1': 0.5860068, 'auroc': 0.7897502, 'binary_precision': 0.48333332, 'binary_recall': 0.11983471, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.19205299}
confusion matrix:
      0   1
0  5966  31
1   213  29
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512111_26.png
early stop counter: 3
val acc:0.968731701374054, best validation acc: 0.9695839881896973, corresponding to test acc:                         0.9616925716400146 / 0.9684244394302368
after epoch: 26,now: 2024-06-21 03:04:56.025497,epoch time: 0:27:18.396243,used: 10:01:04.493102,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_03_51_seed_2_21512111
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9917392, 'precision': 0.990268, 'recall': 0.96218807, 'specificity': 0.96218807, 'f1': 0.9757049, 'auroc': 0.996518, 'binary_precision': 0.9884706, 'binary_recall': 0.92553425, 'binary_specificity': 0.9988419, 'binary_f1_score': 0.9559677}
confusion matrix:
       0     1
0  42260    49
1    338  4201
---- Validation: 
scalar performance:
{'acc': 0.9684653, 'precision': 0.7530577, 'recall': 0.56291294, 'specificity': 0.56291294, 'f1': 0.5962342, 'auroc': 0.83612144, 'binary_precision': 0.53424656, 'binary_recall': 0.1295681, 'binary_specificity': 0.9962578, 'binary_f1_score': 0.20855613}
confusion matrix:
       0   1
0  18103  68
1    524  78
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.7321688, 'recall': 0.54163754, 'specificity': 0.54163754, 'f1': 0.56402075, 'auroc': 0.7801375, 'binary_precision': 0.5, 'binary_recall': 0.08677686, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.14788732}
confusion matrix:
      0   1
0  5976  21
1   221  21
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512111_27.png
early stop counter: 4
val acc:0.9684653282165527, best validation acc: 0.9695839881896973, corresponding to test acc:                         0.9616925716400146 / 0.9684244394302368
after epoch: 27,now: 2024-06-21 03:31:29.325929,epoch time: 0:26:33.300432,used: 10:27:37.793534,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_03_51_seed_2_21512111
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99201673, 'precision': 0.98941207, 'recall': 0.9646035, 'specificity': 0.9646035, 'f1': 0.97659975, 'auroc': 0.99730575, 'binary_precision': 0.9862246, 'binary_recall': 0.9306015, 'binary_specificity': 0.9986055, 'binary_f1_score': 0.957606}
confusion matrix:
       0     1
0  42250    59
1    315  4224
---- Validation: 
scalar performance:
{'acc': 0.9692111, 'precision': 0.76826036, 'recall': 0.58658653, 'specificity': 0.58658653, 'f1': 0.62723786, 'auroc': 0.8418951, 'binary_precision': 0.5631579, 'binary_recall': 0.17774086, 'binary_specificity': 0.99543226, 'binary_f1_score': 0.270202}
confusion matrix:
       0    1
0  18088   83
1    495  107
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95992947, 'precision': 0.69214576, 'recall': 0.54097056, 'specificity': 0.54097056, 'f1': 0.5616602, 'auroc': 0.78674805, 'binary_precision': 0.42, 'binary_recall': 0.08677686, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.14383562}
confusion matrix:
      0   1
0  5968  29
1   221  21
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512111_28.png
early stop counter: 5
val acc:0.9692111015319824, best validation acc: 0.9695839881896973, corresponding to test acc:                         0.9616925716400146 / 0.9684244394302368
after epoch: 28,now: 2024-06-21 03:59:10.844101,epoch time: 0:27:41.518172,used: 10:55:19.311706,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_03_51_seed_2_21512111
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9919527, 'precision': 0.9864579, 'recall': 0.9671248, 'specificity': 0.9671248, 'f1': 0.97654295, 'auroc': 0.99709594, 'binary_precision': 0.97971416, 'binary_recall': 0.9363296, 'binary_specificity': 0.99792004, 'binary_f1_score': 0.95753074}
confusion matrix:
       0     1
0  42221    88
1    289  4250
---- Validation: 
scalar performance:
{'acc': 0.9686251, 'precision': 0.75356185, 'recall': 0.58226866, 'specificity': 0.58226866, 'f1': 0.6206125, 'auroc': 0.8418206, 'binary_precision': 0.5340314, 'binary_recall': 0.16943522, 'binary_specificity': 0.9951021, 'binary_f1_score': 0.25725096}
confusion matrix:
       0    1
0  18082   89
1    500  102
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96057063, 'precision': 0.7160166, 'recall': 0.55518323, 'specificity': 0.55518323, 'f1': 0.58261335, 'auroc': 0.789667, 'binary_precision': 0.46666667, 'binary_recall': 0.11570248, 'binary_specificity': 0.994664, 'binary_f1_score': 0.18543047}
confusion matrix:
      0   1
0  5965  32
1   214  28
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512111_29.png
early stop counter: 6
val acc:0.9686251282691956, best validation acc: 0.9695839881896973, corresponding to test acc:                         0.9616925716400146 / 0.9684244394302368
after epoch: 29,now: 2024-06-21 04:31:15.122820,epoch time: 0:32:04.278719,used: 11:27:23.590425,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_03_51_seed_2_21512111
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9917392, 'precision': 0.9872129, 'recall': 0.96513075, 'specificity': 0.96513075, 'f1': 0.9758476, 'auroc': 0.996946, 'binary_precision': 0.98166627, 'binary_recall': 0.93212867, 'binary_specificity': 0.9981328, 'binary_f1_score': 0.9562563}
confusion matrix:
       0     1
0  42231    79
1    308  4230
---- Validation: 
scalar performance:
{'acc': 0.968998, 'precision': 0.7626947, 'recall': 0.58567345, 'specificity': 0.58567345, 'f1': 0.6255833, 'auroc': 0.84371835, 'binary_precision': 0.5520833, 'binary_recall': 0.17607974, 'binary_specificity': 0.9952672, 'binary_f1_score': 0.26700252}
confusion matrix:
       0    1
0  18085   86
1    496  106
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9604103, 'precision': 0.71360046, 'recall': 0.55906534, 'specificity': 0.55906534, 'f1': 0.5875728, 'auroc': 0.79385024, 'binary_precision': 0.46153846, 'binary_recall': 0.12396694, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.19543973}
confusion matrix:
      0   1
0  5962  35
1   212  30
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512111_30.png
early stop counter: 7
val acc:0.9689980149269104, best validation acc: 0.9695839881896973, corresponding to test acc:                         0.9616925716400146 / 0.9684244394302368
after epoch: 30,now: 2024-06-21 05:07:30.730107,epoch time: 0:36:15.607287,used: 12:03:39.197712,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_03_51_seed_2_21512111
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 12:03:39.197712 at 2024-06-21 05:07:30.730107
persisted model performance metric: 

scalar performance:
{'acc': 0.9616926, 'precision': 0.7534563, 'recall': 0.5379222, 'specificity': 0.5379222, 'f1': 0.5587978, 'auroc': 0.783293, 'binary_precision': 0.54285717, 'binary_recall': 0.0785124, 'binary_specificity': 0.997332, 'binary_f1_score': 0.13718411}
confusion matrix:
      0   1
0  5981  16
1   223  19
oracle model performance metric: 

scalar performance:
{'acc': 0.96842444, 'precision': 0.8621769, 'recall': 0.6365955, 'specificity': 0.6365955, 'f1': 0.6943079, 'auroc': 0.78458637, 'binary_precision': 0.752809, 'binary_recall': 0.2768595, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.40483385}
confusion matrix:
      0   1
0  5975  22
1   175  67
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_irm_resnet_different_bs128_lre4_classbalancing/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_irm_resnet_different_bs128_lre4_classbalancing/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204097 KiB |   1730 MiB |   1081 TiB |   1081 TiB |
|       from large pool | 167936 KiB |   1660 MiB |   1081 TiB |   1081 TiB |
|       from small pool |  36161 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 204097 KiB |   1730 MiB |   1081 TiB |   1081 TiB |
|       from large pool | 167936 KiB |   1660 MiB |   1081 TiB |   1081 TiB |
|       from small pool |  36161 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201087 KiB |   1723 MiB |   1081 TiB |   1081 TiB |
|       from large pool | 165120 KiB |   1653 MiB |   1081 TiB |   1081 TiB |
|       from small pool |  35967 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1802 MiB |   1876 MiB |   4292 MiB |   2490 MiB |
|       from large pool |   1728 MiB |   1802 MiB |   4154 MiB |   2426 MiB |
|       from small pool |     74 MiB |     74 MiB |    138 MiB |     64 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 404158 KiB |    900 MiB | 786322 GiB | 786321 GiB |
|       from large pool | 397312 KiB |    899 MiB | 786000 GiB | 786000 GiB |
|       from small pool |   6846 KiB |     14 MiB |    321 GiB |    321 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1194    |    1851    |   33240 K  |   33239 K  |
|       from large pool |      36    |      76    |   10531 K  |   10531 K  |
|       from small pool |    1158    |    1780    |   22708 K  |   22707 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1194    |    1851    |   33240 K  |   33239 K  |
|       from large pool |      36    |      76    |   10531 K  |   10531 K  |
|       from small pool |    1158    |    1780    |   22708 K  |   22707 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      49    |      50    |      88    |      39    |
|       from large pool |      12    |      13    |      19    |       7    |
|       from small pool |      37    |      37    |      69    |      32    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      31    |     380    |   17053 K  |   17053 K  |
|       from large pool |       5    |      11    |    4206 K  |    4206 K  |
|       from small pool |      26    |     375    |   12846 K  |   12846 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1730 MiB |   1081 TiB |   1081 TiB |
|       from large pool |  16640 KiB |   1660 MiB |   1081 TiB |   1081 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1730 MiB |   1081 TiB |   1081 TiB |
|       from large pool |  16640 KiB |   1660 MiB |   1081 TiB |   1081 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1723 MiB |   1081 TiB |   1081 TiB |
|       from large pool |  16640 KiB |   1653 MiB |   1081 TiB |   1081 TiB |
|       from small pool |      0 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 608256 KiB |   1876 MiB |   4292 MiB |   3698 MiB |
|       from large pool | 565248 KiB |   1802 MiB |   4154 MiB |   3602 MiB |
|       from small pool |  43008 KiB |     74 MiB |    138 MiB |     96 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 384768 KiB |    900 MiB | 786322 GiB | 786322 GiB |
|       from large pool | 384768 KiB |    899 MiB | 786000 GiB | 786000 GiB |
|       from small pool |      0 KiB |     14 MiB |    321 GiB |    321 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1851    |   33240 K  |   33240 K  |
|       from large pool |       2    |      76    |   10531 K  |   10531 K  |
|       from small pool |       0    |    1780    |   22708 K  |   22708 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1851    |   33240 K  |   33240 K  |
|       from large pool |       2    |      76    |   10531 K  |   10531 K  |
|       from small pool |       0    |    1780    |   22708 K  |   22708 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      30    |      50    |      88    |      58    |
|       from large pool |       9    |      13    |      19    |      10    |
|       from small pool |      21    |      37    |      69    |      48    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     380    |   17053 K  |   17053 K  |
|       from large pool |       1    |      11    |    4206 K  |    4206 K  |
|       from small pool |       0    |     375    |   12846 K  |   12846 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

