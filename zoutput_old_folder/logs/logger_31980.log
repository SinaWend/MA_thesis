Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0




!!!: not committed yet



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324354

 Experiment start at: 2024-06-14 13:05:43.820176
before training, model accuracy: 0.3101629912853241
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9668204, 'precision': 0.7525232, 'recall': 0.54710835, 'specificity': 0.54710835, 'f1': 0.57376826, 'auroc': 0.8906535, 'binary_precision': 0.5355805, 'binary_recall': 0.09714674, 'binary_specificity': 0.99706995, 'binary_f1_score': 0.16446234}
confusion matrix:
       0    1
0  42196  124
1   1329  143
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.73358774, 'recall': 0.5210015, 'specificity': 0.5210015, 'f1': 0.53134096, 'auroc': 0.8883971, 'binary_precision': 0.5, 'binary_recall': 0.04354588, 'binary_specificity': 0.9984572, 'binary_f1_score': 0.08011445}
confusion matrix:
       0   1
0  18121  28
1    615  28
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96612334, 'precision': 0.98292804, 'recall': 0.59386975, 'specificity': 0.59386975, 'f1': 0.6493802, 'auroc': 0.8766101, 'binary_precision': 1.0, 'binary_recall': 0.18773946, 'binary_specificity': 1.0, 'binary_f1_score': 0.31612903}
confusion matrix:
      0   1
0  5997   0
1   212  49
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324354_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-14 13:27:55.612419,epoch time: 0:22:11.792243,used: 0:22:11.792243,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324354
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96729994, 'precision': 0.75113344, 'recall': 0.6218542, 'specificity': 0.6218542, 'f1': 0.66196704, 'auroc': 0.912102, 'binary_precision': 0.5278174, 'binary_recall': 0.25152957, 'binary_specificity': 0.9921788, 'binary_f1_score': 0.34069982}
confusion matrix:
       0    1
0  41990  331
1   1101  370
---- Validation: 
scalar performance:
{'acc': 0.966688, 'precision': 0.7567825, 'recall': 0.58222437, 'specificity': 0.58222437, 'f1': 0.6206276, 'auroc': 0.91384906, 'binary_precision': 0.54228854, 'binary_recall': 0.16951789, 'binary_specificity': 0.99493086, 'binary_f1_score': 0.25829384}
confusion matrix:
       0    1
0  18057   92
1    534  109
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97267497, 'precision': 0.9660367, 'recall': 0.6797432, 'specificity': 0.6797432, 'f1': 0.75480545, 'auroc': 0.8879285, 'binary_precision': 0.9591837, 'binary_recall': 0.36015326, 'binary_specificity': 0.999333, 'binary_f1_score': 0.52367693}
confusion matrix:
      0   1
0  5993   4
1   167  94
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324354_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-14 13:47:27.544841,epoch time: 0:19:31.932422,used: 0:41:43.724665,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324354
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96702594, 'precision': 0.7455928, 'recall': 0.66502035, 'specificity': 0.66502035, 'f1': 0.6965848, 'auroc': 0.9155098, 'binary_precision': 0.5138178, 'binary_recall': 0.34126446, 'binary_specificity': 0.98877627, 'binary_f1_score': 0.4101307}
confusion matrix:
       0    1
0  41846  475
1    969  502
---- Validation: 
scalar performance:
{'acc': 0.96647507, 'precision': 0.7470288, 'recall': 0.6301177, 'specificity': 0.6301177, 'f1': 0.66864944, 'auroc': 0.9245123, 'binary_precision': 0.5195195, 'binary_recall': 0.2690513, 'binary_specificity': 0.9911841, 'binary_f1_score': 0.3545082}
confusion matrix:
       0    1
0  17989  160
1    470  173
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9741131, 'precision': 0.94224304, 'recall': 0.70981085, 'specificity': 0.70981085, 'f1': 0.78128266, 'auroc': 0.8982549, 'binary_precision': 0.90909094, 'binary_recall': 0.42145595, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.5759163}
confusion matrix:
      0    1
0  5986   11
1   151  110
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324354_3.png
new oracle model saved
early stop counter: 1
val acc:0.9664750695228577, best validation acc: 0.9666879773139954, corresponding to test acc:                         0.9726749658584595 / 0.9741131067276001
after epoch: 3,now: 2024-06-14 14:06:53.898860,epoch time: 0:19:26.354019,used: 1:01:10.078684,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324354
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9672543, 'precision': 0.7488969, 'recall': 0.64643735, 'specificity': 0.64643735, 'f1': 0.68307066, 'auroc': 0.91908807, 'binary_precision': 0.52168816, 'binary_recall': 0.3025153, 'binary_specificity': 0.9903594, 'binary_f1_score': 0.38296038}
confusion matrix:
       0    1
0  41913  408
1   1026  445
---- Validation: 
scalar performance:
{'acc': 0.9676458, 'precision': 0.76971394, 'recall': 0.6134725, 'specificity': 0.6134725, 'f1': 0.65690947, 'auroc': 0.92337096, 'binary_precision': 0.5660377, 'binary_recall': 0.2332815, 'binary_specificity': 0.99366355, 'binary_f1_score': 0.33039647}
confusion matrix:
       0    1
0  18034  115
1    493  150
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9705976, 'precision': 0.97292227, 'recall': 0.65117425, 'specificity': 0.65117425, 'f1': 0.7234371, 'auroc': 0.8929936, 'binary_precision': 0.97530866, 'binary_recall': 0.30268198, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.46198833}
confusion matrix:
      0   1
0  5995   2
1   182  79
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324354_4.png
better model found
persisted
after epoch: 4,now: 2024-06-14 14:26:37.196806,epoch time: 0:19:43.297946,used: 1:20:53.376630,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324354
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9679622, 'precision': 0.75809795, 'recall': 0.65523684, 'specificity': 0.65523684, 'f1': 0.6926231, 'auroc': 0.92448866, 'binary_precision': 0.5395189, 'binary_recall': 0.3199728, 'binary_specificity': 0.9905009, 'binary_f1_score': 0.40170574}
confusion matrix:
       0    1
0  41918  402
1   1001  471
---- Validation: 
scalar performance:
{'acc': 0.9676458, 'precision': 0.76993954, 'recall': 0.6127225, 'specificity': 0.6127225, 'f1': 0.65617085, 'auroc': 0.92839146, 'binary_precision': 0.56653994, 'binary_recall': 0.23172629, 'binary_specificity': 0.9937187, 'binary_f1_score': 0.32891834}
confusion matrix:
       0    1
0  18035  114
1    494  149
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97203577, 'precision': 0.9748649, 'recall': 0.66841567, 'specificity': 0.66841567, 'f1': 0.7435195, 'auroc': 0.8935606, 'binary_precision': 0.9777778, 'binary_recall': 0.33716476, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.5014245}
confusion matrix:
      0   1
0  5995   2
1   173  88
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324354_5.png
early stop counter: 1
val acc:0.9676458239555359, best validation acc: 0.9676458239555359, corresponding to test acc:                         0.9705976247787476 / 0.9741131067276001
after epoch: 5,now: 2024-06-14 14:47:48.196233,epoch time: 0:21:10.999427,used: 1:42:04.376057,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324354
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9677567, 'precision': 0.752948, 'recall': 0.6858587, 'specificity': 0.6858587, 'f1': 0.71374565, 'auroc': 0.9303684, 'binary_precision': 0.5271028, 'binary_recall': 0.38367346, 'binary_specificity': 0.988044, 'binary_f1_score': 0.4440945}
confusion matrix:
       0    1
0  41816  506
1    906  564
---- Validation: 
scalar performance:
{'acc': 0.9676458, 'precision': 0.76308393, 'recall': 0.64347476, 'specificity': 0.64347476, 'f1': 0.6840008, 'auroc': 0.9296061, 'binary_precision': 0.5507246, 'binary_recall': 0.29548988, 'binary_specificity': 0.9914596, 'binary_f1_score': 0.38461536}
confusion matrix:
       0    1
0  17994  155
1    453  190
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.971077, 'precision': 0.97359896, 'recall': 0.6569214, 'specificity': 0.6569214, 'f1': 0.7302455, 'auroc': 0.8929229, 'binary_precision': 0.97619045, 'binary_recall': 0.31417623, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.47536233}
confusion matrix:
      0   1
0  5995   2
1   179  82
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324354_6.png
early stop counter: 2
val acc:0.9676458239555359, best validation acc: 0.9676458239555359, corresponding to test acc:                         0.9705976247787476 / 0.9741131067276001
after epoch: 6,now: 2024-06-14 15:10:56.928505,epoch time: 0:23:08.732272,used: 2:05:13.108329,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324354
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9684189, 'precision': 0.7601484, 'recall': 0.69067585, 'specificity': 0.69067585, 'f1': 0.71951765, 'auroc': 0.93303895, 'binary_precision': 0.5411985, 'binary_recall': 0.39292997, 'binary_specificity': 0.9884218, 'binary_f1_score': 0.45529735}
confusion matrix:
       0    1
0  41831  490
1    893  578
---- Validation: 
scalar performance:
{'acc': 0.9683908, 'precision': 0.771266, 'recall': 0.6588615, 'specificity': 0.6588615, 'f1': 0.69897914, 'auroc': 0.9338968, 'binary_precision': 0.5660377, 'binary_recall': 0.32659408, 'binary_specificity': 0.991129, 'binary_f1_score': 0.41420117}
confusion matrix:
       0    1
0  17988  161
1    433  210
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97315437, 'precision': 0.96248686, 'recall': 0.6873226, 'specificity': 0.6873226, 'f1': 0.7623183, 'auroc': 0.89660555, 'binary_precision': 0.9514563, 'binary_recall': 0.37547892, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.5384615}
confusion matrix:
      0   1
0  5992   5
1   163  98
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324354_7.png
better model found
persisted
after epoch: 7,now: 2024-06-14 15:31:51.317480,epoch time: 0:20:54.388975,used: 2:26:07.497304,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324354
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.96864724, 'precision': 0.7660887, 'recall': 0.6654271, 'specificity': 0.6654271, 'f1': 0.7028907, 'auroc': 0.9320977, 'binary_precision': 0.55481726, 'binary_recall': 0.34035325, 'binary_specificity': 0.9905009, 'binary_f1_score': 0.42189473}
confusion matrix:
       0    1
0  41918  402
1    971  501
---- Validation: 
scalar performance:
{'acc': 0.96796507, 'precision': 0.7676605, 'recall': 0.6451402, 'specificity': 0.6451402, 'f1': 0.6865017, 'auroc': 0.9381804, 'binary_precision': 0.55976677, 'binary_recall': 0.29860032, 'binary_specificity': 0.99167997, 'binary_f1_score': 0.38945234}
confusion matrix:
       0    1
0  17998  151
1    451  192
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97315437, 'precision': 0.9762189, 'recall': 0.6818256, 'specificity': 0.6818256, 'f1': 0.7584541, 'auroc': 0.8956642, 'binary_precision': 0.97938144, 'binary_recall': 0.36398467, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.53072625}
confusion matrix:
      0   1
0  5995   2
1   166  95
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324354_8.png
early stop counter: 1
val acc:0.9679650664329529, best validation acc: 0.9683908224105835, corresponding to test acc:                         0.9731543660163879 / 0.9741131067276001
after epoch: 8,now: 2024-06-14 15:54:38.907393,epoch time: 0:22:47.589913,used: 2:48:55.087217,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324354
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.96768814, 'precision': 0.7520478, 'recall': 0.7039461, 'specificity': 0.7039461, 'f1': 0.7251912, 'auroc': 0.933301, 'binary_precision': 0.5240913, 'binary_recall': 0.42119566, 'binary_specificity': 0.9866966, 'binary_f1_score': 0.4670433}
confusion matrix:
       0    1
0  41757  563
1    852  620
---- Validation: 
scalar performance:
{'acc': 0.96886975, 'precision': 0.7832829, 'recall': 0.6426083, 'specificity': 0.6426083, 'f1': 0.68764275, 'auroc': 0.9398919, 'binary_precision': 0.591195, 'binary_recall': 0.29237947, 'binary_specificity': 0.9928371, 'binary_f1_score': 0.3912591}
confusion matrix:
       0    1
0  18019  130
1    455  188
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.970278, 'precision': 0.97245264, 'recall': 0.6473428, 'specificity': 0.6473428, 'f1': 0.7188326, 'auroc': 0.8923415, 'binary_precision': 0.9746835, 'binary_recall': 0.29501915, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.45294115}
confusion matrix:
      0   1
0  5995   2
1   184  77
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324354_9.png
better model found
persisted
after epoch: 9,now: 2024-06-14 16:14:56.138004,epoch time: 0:20:17.230611,used: 3:09:12.317828,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324354
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.96960634, 'precision': 0.7735578, 'recall': 0.69543064, 'specificity': 0.69543064, 'f1': 0.72735417, 'auroc': 0.93462074, 'binary_precision': 0.56772333, 'binary_recall': 0.40149456, 'binary_specificity': 0.9893667, 'binary_f1_score': 0.47035417}
confusion matrix:
       0    1
0  41870  450
1    881  591
---- Validation: 
scalar performance:
{'acc': 0.96871006, 'precision': 0.7759222, 'recall': 0.65902686, 'specificity': 0.65902686, 'f1': 0.70029527, 'auroc': 0.9361425, 'binary_precision': 0.5753425, 'binary_recall': 0.32659408, 'binary_specificity': 0.9914596, 'binary_f1_score': 0.4166667}
confusion matrix:
       0    1
0  17994  155
1    433  210
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9694791, 'precision': 0.9776983, 'recall': 0.63593197, 'specificity': 0.63593197, 'f1': 0.7053744, 'auroc': 0.89444387, 'binary_precision': 0.9861111, 'binary_recall': 0.27203065, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.4264264}
confusion matrix:
      0   1
0  5996   1
1   190  71
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324354_10.png
early stop counter: 1
val acc:0.9687100648880005, best validation acc: 0.9688697457313538, corresponding to test acc:                         0.9702780246734619 / 0.9741131067276001
after epoch: 10,now: 2024-06-14 16:34:26.496333,epoch time: 0:19:30.358329,used: 3:28:42.676157,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324354
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9701315, 'precision': 0.77161914, 'recall': 0.75160253, 'specificity': 0.75160253, 'f1': 0.76118815, 'auroc': 0.9398531, 'binary_precision': 0.55997056, 'binary_recall': 0.5173351, 'binary_specificity': 0.9858699, 'binary_f1_score': 0.53780913}
confusion matrix:
       0    1
0  41723  598
1    710  761
---- Validation: 
scalar performance:
{'acc': 0.96823114, 'precision': 0.7641194, 'recall': 0.6932814, 'specificity': 0.6932814, 'f1': 0.72265494, 'auroc': 0.9426724, 'binary_precision': 0.5493562, 'binary_recall': 0.39813375, 'binary_specificity': 0.9884291, 'binary_f1_score': 0.4616772}
confusion matrix:
       0    1
0  17939  210
1    387  256
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97363377, 'precision': 0.9676883, 'recall': 0.6912374, 'specificity': 0.6912374, 'f1': 0.76718307, 'auroc': 0.9011206, 'binary_precision': 0.96153843, 'binary_recall': 0.38314176, 'binary_specificity': 0.999333, 'binary_f1_score': 0.5479452}
confusion matrix:
      0    1
0  5993    4
1   161  100
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324354_11.png
early stop counter: 2
val acc:0.9682311415672302, best validation acc: 0.9688697457313538, corresponding to test acc:                         0.9702780246734619 / 0.9741131067276001
after epoch: 11,now: 2024-06-14 16:53:13.442582,epoch time: 0:18:46.946249,used: 3:47:29.622406,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324354
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.969789, 'precision': 0.7759351, 'recall': 0.6945416, 'specificity': 0.6945416, 'f1': 0.7275196, 'auroc': 0.9377017, 'binary_precision': 0.57254136, 'binary_recall': 0.39945653, 'binary_specificity': 0.98962665, 'binary_f1_score': 0.47058827}
confusion matrix:
       0    1
0  41881  439
1    884  588
---- Validation: 
scalar performance:
{'acc': 0.9695083, 'precision': 0.7916318, 'recall': 0.65043944, 'specificity': 0.65043944, 'f1': 0.6965097, 'auroc': 0.94277054, 'binary_precision': 0.607362, 'binary_recall': 0.30793157, 'binary_specificity': 0.9929473, 'binary_f1_score': 0.40866873}
confusion matrix:
       0    1
0  18021  128
1    445  198
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96724194, 'precision': 0.97492766, 'recall': 0.609112, 'specificity': 0.609112, 'f1': 0.6702797, 'auroc': 0.90170884, 'binary_precision': 0.98275864, 'binary_recall': 0.21839081, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.35736677}
confusion matrix:
      0   1
0  5996   1
1   204  57
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324354_12.png
better model found
persisted
after epoch: 12,now: 2024-06-14 17:10:51.381816,epoch time: 0:17:37.939234,used: 4:05:07.561640,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324354
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9693551, 'precision': 0.77454686, 'recall': 0.6723505, 'specificity': 0.6723505, 'f1': 0.71066475, 'auroc': 0.93588305, 'binary_precision': 0.57127196, 'binary_recall': 0.35394022, 'binary_specificity': 0.99076086, 'binary_f1_score': 0.43708056}
confusion matrix:
       0    1
0  41929  391
1    951  521
---- Validation: 
scalar performance:
{'acc': 0.9688165, 'precision': 0.78235555, 'recall': 0.64258075, 'specificity': 0.64258075, 'f1': 0.68742555, 'auroc': 0.94246954, 'binary_precision': 0.5893417, 'binary_recall': 0.29237947, 'binary_specificity': 0.992782, 'binary_f1_score': 0.3908524}
confusion matrix:
       0    1
0  18018  131
1    455  188
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9689997, 'precision': 0.9771614, 'recall': 0.6301848, 'specificity': 0.6301848, 'f1': 0.6981006, 'auroc': 0.8958558, 'binary_precision': 0.98550725, 'binary_recall': 0.2605364, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.4121212}
confusion matrix:
      0   1
0  5996   1
1   193  68
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324354_13.png
early stop counter: 1
val acc:0.9688165187835693, best validation acc: 0.9695082902908325, corresponding to test acc:                         0.9672419428825378 / 0.9741131067276001
after epoch: 13,now: 2024-06-14 17:31:19.124220,epoch time: 0:20:27.742404,used: 4:25:35.304044,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324354
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9693551, 'precision': 0.76816344, 'recall': 0.71248615, 'specificity': 0.71248615, 'f1': 0.7367745, 'auroc': 0.93860745, 'binary_precision': 0.5557476, 'binary_recall': 0.4371176, 'binary_specificity': 0.9878547, 'binary_f1_score': 0.48934552}
confusion matrix:
       0    1
0  41807  514
1    828  643
---- Validation: 
scalar performance:
{'acc': 0.96828437, 'precision': 0.7672147, 'recall': 0.67380756, 'specificity': 0.67380756, 'f1': 0.7096449, 'auroc': 0.94344926, 'binary_precision': 0.55690074, 'binary_recall': 0.3576983, 'binary_specificity': 0.9899168, 'binary_f1_score': 0.43560606}
confusion matrix:
       0    1
0  17966  183
1    413  230
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97235537, 'precision': 0.96545357, 'recall': 0.6759117, 'specificity': 0.6759117, 'f1': 0.750589, 'auroc': 0.90112805, 'binary_precision': 0.9583333, 'binary_recall': 0.35249043, 'binary_specificity': 0.999333, 'binary_f1_score': 0.5154062}
confusion matrix:
      0   1
0  5993   4
1   169  92
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324354_14.png
early stop counter: 2
val acc:0.9682843685150146, best validation acc: 0.9695082902908325, corresponding to test acc:                         0.9672419428825378 / 0.9741131067276001
after epoch: 14,now: 2024-06-14 17:53:40.668554,epoch time: 0:22:21.544334,used: 4:47:56.848378,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324354
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.96962917, 'precision': 0.78293407, 'recall': 0.65544367, 'specificity': 0.65544367, 'f1': 0.6989956, 'auroc': 0.9356427, 'binary_precision': 0.58919597, 'binary_recall': 0.31861413, 'binary_specificity': 0.99227315, 'binary_f1_score': 0.41358024}
confusion matrix:
       0    1
0  41993  327
1   1003  469
---- Validation: 
scalar performance:
{'acc': 0.96855044, 'precision': 0.7939489, 'recall': 0.60569024, 'specificity': 0.60569024, 'f1': 0.6519055, 'auroc': 0.9447376, 'binary_precision': 0.61504424, 'binary_recall': 0.21617419, 'binary_specificity': 0.99520636, 'binary_f1_score': 0.31990793}
confusion matrix:
       0    1
0  18062   87
1    504  139
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96580374, 'precision': 0.96331465, 'recall': 0.593703, 'specificity': 0.593703, 'f1': 0.64828366, 'auroc': 0.89662266, 'binary_precision': 0.9607843, 'binary_recall': 0.18773946, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.31410256}
confusion matrix:
      0   1
0  5995   2
1   212  49
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324354_15.png
early stop counter: 3
val acc:0.968550443649292, best validation acc: 0.9695082902908325, corresponding to test acc:                         0.9672419428825378 / 0.9741131067276001
after epoch: 15,now: 2024-06-14 18:15:38.647271,epoch time: 0:21:57.978717,used: 5:09:54.827095,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324354
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.96949214, 'precision': 0.77527225, 'recall': 0.677995, 'specificity': 0.677995, 'f1': 0.7152085, 'auroc': 0.93934715, 'binary_precision': 0.5723404, 'binary_recall': 0.36548913, 'binary_specificity': 0.9905009, 'binary_f1_score': 0.4461028}
confusion matrix:
       0    1
0  41918  402
1    934  538
---- Validation: 
scalar performance:
{'acc': 0.9691358, 'precision': 0.7892252, 'recall': 0.63974583, 'specificity': 0.63974583, 'f1': 0.68617713, 'auroc': 0.9411857, 'binary_precision': 0.6032787, 'binary_recall': 0.28615862, 'binary_specificity': 0.993333, 'binary_f1_score': 0.38818562}
confusion matrix:
       0    1
0  18028  121
1    459  184
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9682007, 'precision': 0.98394126, 'recall': 0.61877394, 'specificity': 0.61877394, 'f1': 0.6837901, 'auroc': 0.89229465, 'binary_precision': 1.0, 'binary_recall': 0.23754789, 'binary_specificity': 1.0, 'binary_f1_score': 0.38390094}
confusion matrix:
      0   1
0  5997   0
1   199  62
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324354_16.png
early stop counter: 4
val acc:0.9691358208656311, best validation acc: 0.9695082902908325, corresponding to test acc:                         0.9672419428825378 / 0.9741131067276001
after epoch: 16,now: 2024-06-14 18:37:18.765671,epoch time: 0:21:40.118400,used: 5:31:34.945495,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324354
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.96942365, 'precision': 0.7694323, 'recall': 0.709762, 'specificity': 0.709762, 'f1': 0.7355095, 'auroc': 0.93813896, 'binary_precision': 0.55848724, 'binary_recall': 0.43138587, 'binary_specificity': 0.988138, 'binary_f1_score': 0.48677656}
confusion matrix:
       0    1
0  41818  502
1    837  635
---- Validation: 
scalar performance:
{'acc': 0.9698808, 'precision': 0.7861864, 'recall': 0.68438476, 'specificity': 0.68438476, 'f1': 0.7232419, 'auroc': 0.94239765, 'binary_precision': 0.594132, 'binary_recall': 0.377916, 'binary_specificity': 0.9908535, 'binary_f1_score': 0.46197715}
confusion matrix:
       0    1
0  17983  166
1    400  243
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9701182, 'precision': 0.97221184, 'recall': 0.6454271, 'specificity': 0.6454271, 'f1': 0.71651036, 'auroc': 0.9018412, 'binary_precision': 0.974359, 'binary_recall': 0.29118773, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.44837758}
confusion matrix:
      0   1
0  5995   2
1   185  76
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324354_17.png
better model found
persisted
after epoch: 17,now: 2024-06-14 19:00:15.780208,epoch time: 0:22:57.014537,used: 5:54:31.960032,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324354
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9698575, 'precision': 0.7705882, 'recall': 0.73851013, 'specificity': 0.73851013, 'f1': 0.7534345, 'auroc': 0.94274205, 'binary_precision': 0.5588235, 'binary_recall': 0.49048913, 'binary_specificity': 0.9865312, 'binary_f1_score': 0.5224313}
confusion matrix:
       0    1
0  41750  570
1    750  722
---- Validation: 
scalar performance:
{'acc': 0.9695083, 'precision': 0.7765366, 'recall': 0.7074436, 'specificity': 0.7074436, 'f1': 0.7365673, 'auroc': 0.94321537, 'binary_precision': 0.57322174, 'binary_recall': 0.42612752, 'binary_specificity': 0.9887597, 'binary_f1_score': 0.48884925}
confusion matrix:
       0    1
0  17945  204
1    369  274
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9701182, 'precision': 0.97837734, 'recall': 0.64359474, 'specificity': 0.64359474, 'f1': 0.71487474, 'auroc': 0.89413255, 'binary_precision': 0.9868421, 'binary_recall': 0.28735632, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.44510382}
confusion matrix:
      0   1
0  5996   1
1   186  75
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324354_18.png
early stop counter: 1
val acc:0.9695082902908325, best validation acc: 0.9698808193206787, corresponding to test acc:                         0.9701182246208191 / 0.9741131067276001
after epoch: 18,now: 2024-06-14 19:22:51.425141,epoch time: 0:22:35.644933,used: 6:17:07.604965,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324354
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9701772, 'precision': 0.78047955, 'recall': 0.69605386, 'specificity': 0.69605386, 'f1': 0.7300771, 'auroc': 0.9401668, 'binary_precision': 0.5815324, 'binary_recall': 0.4021739, 'binary_specificity': 0.98993385, 'binary_f1_score': 0.47550198}
confusion matrix:
       0    1
0  41894  426
1    880  592
---- Validation: 
scalar performance:
{'acc': 0.9690826, 'precision': 0.7809154, 'recall': 0.6614698, 'specificity': 0.6614698, 'f1': 0.7035772, 'auroc': 0.94801533, 'binary_precision': 0.58516484, 'binary_recall': 0.33125973, 'binary_specificity': 0.99167997, 'binary_f1_score': 0.42303875}
confusion matrix:
       0    1
0  17998  151
1    430  213
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9717162, 'precision': 0.96922827, 'recall': 0.6664165, 'specificity': 0.6664165, 'f1': 0.7405883, 'auroc': 0.8970132, 'binary_precision': 0.96666664, 'binary_recall': 0.33333334, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.49572653}
confusion matrix:
      0   1
0  5994   3
1   174  87
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324354_19.png
early stop counter: 2
val acc:0.9690825939178467, best validation acc: 0.9698808193206787, corresponding to test acc:                         0.9701182246208191 / 0.9741131067276001
after epoch: 19,now: 2024-06-14 19:42:21.725581,epoch time: 0:19:30.300440,used: 6:36:37.905405,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324354
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.96981186, 'precision': 0.7763958, 'recall': 0.69356984, 'specificity': 0.69356984, 'f1': 0.72698313, 'auroc': 0.93809664, 'binary_precision': 0.5735294, 'binary_recall': 0.39741847, 'binary_specificity': 0.9897212, 'binary_f1_score': 0.46950242}
confusion matrix:
       0    1
0  41885  435
1    887  585
---- Validation: 
scalar performance:
{'acc': 0.9691358, 'precision': 0.7880082, 'recall': 0.64274603, 'specificity': 0.64274603, 'f1': 0.68873525, 'auroc': 0.94723284, 'binary_precision': 0.600639, 'binary_recall': 0.29237947, 'binary_specificity': 0.99311256, 'binary_f1_score': 0.39330542}
confusion matrix:
       0    1
0  18024  125
1    455  188
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96580374, 'precision': 0.9726434, 'recall': 0.59187067, 'specificity': 0.59187067, 'f1': 0.6460725, 'auroc': 0.89318126, 'binary_precision': 0.97959185, 'binary_recall': 0.18390805, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.30967742}
confusion matrix:
      0   1
0  5996   1
1   213  48
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324354_20.png
early stop counter: 3
val acc:0.9691358208656311, best validation acc: 0.9698808193206787, corresponding to test acc:                         0.9701182246208191 / 0.9741131067276001
after epoch: 20,now: 2024-06-14 20:01:18.980614,epoch time: 0:18:57.255033,used: 6:55:35.160438,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324354
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9708851, 'precision': 0.783622, 'recall': 0.72232103, 'specificity': 0.72232103, 'f1': 0.74889755, 'auroc': 0.94033885, 'binary_precision': 0.5860262, 'binary_recall': 0.4558424, 'binary_specificity': 0.98879963, 'binary_f1_score': 0.51280093}
confusion matrix:
       0    1
0  41846  474
1    801  671
---- Validation: 
scalar performance:
{'acc': 0.969668, 'precision': 0.7884952, 'recall': 0.66627324, 'specificity': 0.66627324, 'f1': 0.7094699, 'auroc': 0.9466332, 'binary_precision': 0.6, 'binary_recall': 0.34059098, 'binary_specificity': 0.99195546, 'binary_f1_score': 0.43452382}
confusion matrix:
       0    1
0  18003  146
1    424  219
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9688399, 'precision': 0.9636477, 'recall': 0.6319338, 'specificity': 0.6319338, 'f1': 0.69920427, 'auroc': 0.8935598, 'binary_precision': 0.9583333, 'binary_recall': 0.26436782, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.41441444}
confusion matrix:
      0   1
0  5994   3
1   192  69
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324354_21.png
early stop counter: 4
val acc:0.9696679711341858, best validation acc: 0.9698808193206787, corresponding to test acc:                         0.9701182246208191 / 0.9741131067276001
after epoch: 21,now: 2024-06-14 20:20:12.524488,epoch time: 0:18:53.543874,used: 7:14:28.704312,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324354
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9704284, 'precision': 0.7810657, 'recall': 0.7083146, 'specificity': 0.7083146, 'f1': 0.73876196, 'auroc': 0.94035494, 'binary_precision': 0.58186865, 'binary_recall': 0.42730978, 'binary_specificity': 0.98931944, 'binary_f1_score': 0.49275365}
confusion matrix:
       0    1
0  41868  452
1    843  629
---- Validation: 
scalar performance:
{'acc': 0.969668, 'precision': 0.7938147, 'recall': 0.6520222, 'specificity': 0.6520222, 'f1': 0.69840163, 'auroc': 0.9477188, 'binary_precision': 0.6116208, 'binary_recall': 0.31104198, 'binary_specificity': 0.99300236, 'binary_f1_score': 0.41237113}
confusion matrix:
       0    1
0  18022  127
1    443  200
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9680409, 'precision': 0.97600216, 'recall': 0.61869055, 'specificity': 0.61869055, 'f1': 0.68315595, 'auroc': 0.89070475, 'binary_precision': 0.984127, 'binary_recall': 0.23754789, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.38271603}
confusion matrix:
      0   1
0  5996   1
1   199  62
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324354_22.png
early stop counter: 5
val acc:0.9696679711341858, best validation acc: 0.9698808193206787, corresponding to test acc:                         0.9701182246208191 / 0.9741131067276001
after epoch: 22,now: 2024-06-14 20:39:40.094011,epoch time: 0:19:27.569523,used: 7:33:56.273835,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324354
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9706111, 'precision': 0.7833755, 'recall': 0.7077534, 'specificity': 0.7077534, 'f1': 0.7391865, 'auroc': 0.94094646, 'binary_precision': 0.5865295, 'binary_recall': 0.4259511, 'binary_specificity': 0.9895558, 'binary_f1_score': 0.4935065}
confusion matrix:
       0    1
0  41878  442
1    845  627
---- Validation: 
scalar performance:
{'acc': 0.97009367, 'precision': 0.7967282, 'recall': 0.66274333, 'specificity': 0.66274333, 'f1': 0.7084828, 'auroc': 0.9478536, 'binary_precision': 0.6167147, 'binary_recall': 0.33281493, 'binary_specificity': 0.9926718, 'binary_f1_score': 0.43232325}
confusion matrix:
       0    1
0  18016  133
1    429  214
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96660274, 'precision': 0.9739773, 'recall': 0.6014492, 'specificity': 0.6014492, 'f1': 0.65968907, 'auroc': 0.8912643, 'binary_precision': 0.9814815, 'binary_recall': 0.20306513, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.33650795}
confusion matrix:
      0   1
0  5996   1
1   208  53
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324354_23.png
better model found
persisted
after epoch: 23,now: 2024-06-14 20:59:13.133192,epoch time: 0:19:33.039181,used: 7:53:29.313016,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324354
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9704056, 'precision': 0.783566, 'recall': 0.69313896, 'specificity': 0.69313896, 'f1': 0.728973, 'auroc': 0.93767834, 'binary_precision': 0.58787876, 'binary_recall': 0.39591837, 'binary_specificity': 0.9903596, 'binary_f1_score': 0.47317073}
confusion matrix:
       0    1
0  41914  408
1    888  582
---- Validation: 
scalar performance:
{'acc': 0.97009367, 'precision': 0.7938067, 'recall': 0.6702439, 'specificity': 0.6702439, 'f1': 0.71409917, 'auroc': 0.94749707, 'binary_precision': 0.61035424, 'binary_recall': 0.34836704, 'binary_specificity': 0.9921208, 'binary_f1_score': 0.44356436}
confusion matrix:
       0    1
0  18006  143
1    419  224
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.965644, 'precision': 0.9723531, 'recall': 0.5899549, 'specificity': 0.5899549, 'f1': 0.64329714, 'auroc': 0.88672376, 'binary_precision': 0.9791667, 'binary_recall': 0.18007663, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.30420712}
confusion matrix:
      0   1
0  5996   1
1   214  47
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324354_24.png
early stop counter: 1
val acc:0.9700936675071716, best validation acc: 0.9700936675071716, corresponding to test acc:                         0.9666027426719666 / 0.9741131067276001
after epoch: 24,now: 2024-06-14 21:19:28.537772,epoch time: 0:20:15.404580,used: 8:13:44.717596,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324354
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9712505, 'precision': 0.7827767, 'recall': 0.7490666, 'specificity': 0.7490666, 'f1': 0.7647464, 'auroc': 0.94474447, 'binary_precision': 0.5824942, 'binary_recall': 0.51086956, 'binary_specificity': 0.9872637, 'binary_f1_score': 0.54433584}
confusion matrix:
       0    1
0  41781  539
1    720  752
---- Validation: 
scalar performance:
{'acc': 0.97051936, 'precision': 0.7856714, 'recall': 0.71996796, 'specificity': 0.71996796, 'f1': 0.74813247, 'auroc': 0.950866, 'binary_precision': 0.59063137, 'binary_recall': 0.45101088, 'binary_specificity': 0.988925, 'binary_f1_score': 0.5114639}
confusion matrix:
       0    1
0  17948  201
1    353  290
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97331417, 'precision': 0.971684, 'recall': 0.68557364, 'specificity': 0.68557364, 'f1': 0.7618285, 'auroc': 0.8964418, 'binary_precision': 0.97, 'binary_recall': 0.3716475, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.53739613}
confusion matrix:
      0   1
0  5994   3
1   164  97
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324354_25.png
better model found
persisted
after epoch: 25,now: 2024-06-14 21:38:34.314467,epoch time: 0:19:05.776695,used: 8:32:50.494291,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324354
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.97150165, 'precision': 0.7940184, 'recall': 0.70900345, 'specificity': 0.70900345, 'f1': 0.74366313, 'auroc': 0.94156474, 'binary_precision': 0.6077295, 'binary_recall': 0.42760026, 'binary_specificity': 0.99040663, 'binary_f1_score': 0.50199515}
confusion matrix:
       0    1
0  41915  406
1    842  629
---- Validation: 
scalar performance:
{'acc': 0.96945506, 'precision': 0.80417216, 'recall': 0.62415993, 'specificity': 0.62415993, 'f1': 0.6732875, 'auroc': 0.94784015, 'binary_precision': 0.6342412, 'binary_recall': 0.2534992, 'binary_specificity': 0.99482065, 'binary_f1_score': 0.36222222}
confusion matrix:
       0    1
0  18055   94
1    480  163
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9638862, 'precision': 0.9684026, 'recall': 0.5688821, 'specificity': 0.5688821, 'f1': 0.6115567, 'auroc': 0.88227284, 'binary_precision': 0.972973, 'binary_recall': 0.13793103, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.24161074}
confusion matrix:
      0   1
0  5996   1
1   225  36
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324354_26.png
early stop counter: 1
val acc:0.9694550633430481, best validation acc: 0.9705193638801575, corresponding to test acc:                         0.9733141660690308 / 0.9741131067276001
after epoch: 26,now: 2024-06-14 21:57:31.660032,epoch time: 0:18:57.345565,used: 8:51:47.839856,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324354
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.96969765, 'precision': 0.7745024, 'recall': 0.6949465, 'specificity': 0.6949465, 'f1': 0.7273311, 'auroc': 0.9387493, 'binary_precision': 0.5696325, 'binary_recall': 0.40040788, 'binary_specificity': 0.98948514, 'binary_f1_score': 0.47025946}
confusion matrix:
       0    1
0  41876  445
1    882  589
---- Validation: 
scalar performance:
{'acc': 0.97004044, 'precision': 0.80570155, 'recall': 0.64246434, 'specificity': 0.64246434, 'f1': 0.6918917, 'auroc': 0.94847107, 'binary_precision': 0.6360544, 'binary_recall': 0.29082426, 'binary_specificity': 0.9941044, 'binary_f1_score': 0.3991462}
confusion matrix:
       0    1
0  18042  107
1    456  187
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9638862, 'precision': 0.9684026, 'recall': 0.5688821, 'specificity': 0.5688821, 'f1': 0.6115567, 'auroc': 0.8880398, 'binary_precision': 0.972973, 'binary_recall': 0.13793103, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.24161074}
confusion matrix:
      0   1
0  5996   1
1   225  36
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324354_27.png
early stop counter: 2
val acc:0.9700404405593872, best validation acc: 0.9705193638801575, corresponding to test acc:                         0.9733141660690308 / 0.9741131067276001
after epoch: 27,now: 2024-06-14 22:17:22.921687,epoch time: 0:19:51.261655,used: 9:11:39.101511,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324354
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9705197, 'precision': 0.7773012, 'recall': 0.7353989, 'specificity': 0.7353989, 'f1': 0.7544659, 'auroc': 0.9431346, 'binary_precision': 0.57246375, 'binary_recall': 0.48334467, 'binary_specificity': 0.98745304, 'binary_f1_score': 0.52414304}
confusion matrix:
       0    1
0  41790  531
1    760  711
---- Validation: 
scalar performance:
{'acc': 0.97004044, 'precision': 0.7911664, 'recall': 0.6754667, 'specificity': 0.6754667, 'f1': 0.717666, 'auroc': 0.94621396, 'binary_precision': 0.60471207, 'binary_recall': 0.3592535, 'binary_specificity': 0.99167997, 'binary_f1_score': 0.45073172}
confusion matrix:
       0    1
0  17998  151
1    412  231
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96612334, 'precision': 0.9731991, 'recall': 0.59570205, 'specificity': 0.59570205, 'f1': 0.6515707, 'auroc': 0.886196, 'binary_precision': 0.98039216, 'binary_recall': 0.19157088, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.32051283}
confusion matrix:
      0   1
0  5996   1
1   211  50
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324354_28.png
early stop counter: 3
val acc:0.9700404405593872, best validation acc: 0.9705193638801575, corresponding to test acc:                         0.9733141660690308 / 0.9741131067276001
after epoch: 28,now: 2024-06-14 22:36:55.205331,epoch time: 0:19:32.283644,used: 9:31:11.385155,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324354
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9709536, 'precision': 0.7881125, 'recall': 0.7056356, 'specificity': 0.7056356, 'f1': 0.7393393, 'auroc': 0.94441915, 'binary_precision': 0.59615386, 'binary_recall': 0.42119566, 'binary_specificity': 0.9900756, 'binary_f1_score': 0.4936306}
confusion matrix:
       0    1
0  41900  420
1    852  620
---- Validation: 
scalar performance:
{'acc': 0.969934, 'precision': 0.79821855, 'recall': 0.65291, 'specificity': 0.65291, 'f1': 0.70014435, 'auroc': 0.9499401, 'binary_precision': 0.6203704, 'binary_recall': 0.31259722, 'binary_specificity': 0.9932228, 'binary_f1_score': 0.41571873}
confusion matrix:
       0    1
0  18026  123
1    442  201
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96324706, 'precision': 0.9664549, 'recall': 0.5612193, 'specificity': 0.5612193, 'f1': 0.59943426, 'auroc': 0.89238775, 'binary_precision': 0.969697, 'binary_recall': 0.12260536, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.21768707}
confusion matrix:
      0   1
0  5996   1
1   229  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324354_29.png
early stop counter: 4
val acc:0.9699339866638184, best validation acc: 0.9705193638801575, corresponding to test acc:                         0.9733141660690308 / 0.9741131067276001
after epoch: 29,now: 2024-06-14 22:56:17.277772,epoch time: 0:19:22.072441,used: 9:50:33.457596,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324354
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9707937, 'precision': 0.7795852, 'recall': 0.7388215, 'specificity': 0.7388215, 'f1': 0.75744045, 'auroc': 0.9427371, 'binary_precision': 0.5768, 'binary_recall': 0.49014276, 'binary_specificity': 0.9875003, 'binary_f1_score': 0.5299522}
confusion matrix:
       0    1
0  41792  529
1    750  721
---- Validation: 
scalar performance:
{'acc': 0.97110474, 'precision': 0.7993591, 'recall': 0.6970193, 'specificity': 0.6970193, 'f1': 0.7366757, 'auroc': 0.94811517, 'binary_precision': 0.6196172, 'binary_recall': 0.40279937, 'binary_specificity': 0.9912392, 'binary_f1_score': 0.48821867}
confusion matrix:
       0    1
0  17990  159
1    384  259
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9651646, 'precision': 0.97142553, 'recall': 0.5842078, 'specificity': 0.5842078, 'f1': 0.63486373, 'auroc': 0.89328694, 'binary_precision': 0.9777778, 'binary_recall': 0.16858238, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.2875817}
confusion matrix:
      0   1
0  5996   1
1   217  44
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324354_30.png
better model found
persisted
after epoch: 30,now: 2024-06-14 23:15:15.121500,epoch time: 0:18:57.843728,used: 10:09:31.301324,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324354
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 10:09:31.301324 at 2024-06-14 23:15:15.121500
persisted model performance metric: 

scalar performance:
{'acc': 0.9651646, 'precision': 0.97142553, 'recall': 0.5842078, 'specificity': 0.5842078, 'f1': 0.63486373, 'auroc': 0.89328694, 'binary_precision': 0.9777778, 'binary_recall': 0.16858238, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.2875817}
confusion matrix:
      0   1
0  5996   1
1   217  44
oracle model performance metric: 

scalar performance:
{'acc': 0.9741131, 'precision': 0.94224304, 'recall': 0.70981085, 'specificity': 0.70981085, 'f1': 0.78128266, 'auroc': 0.8982549, 'binary_precision': 0.90909094, 'binary_recall': 0.42145595, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.5759163}
confusion matrix:
      0    1
0  5986   11
1   151  110
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_bs16_different_learningrates/rule_results/4.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_bs16_different_learningrates/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_resnet_bs16_different_learningrates/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204979 KiB | 640729 KiB |    942 TiB |    942 TiB |
|       from large pool | 167936 KiB | 568000 KiB |    942 TiB |    942 TiB |
|       from small pool |  37043 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 204979 KiB | 640729 KiB |    942 TiB |    942 TiB |
|       from large pool | 167936 KiB | 568000 KiB |    942 TiB |    942 TiB |
|       from small pool |  37043 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201088 KiB | 632296 KiB |    940 TiB |    940 TiB |
|       from large pool | 165120 KiB | 560704 KiB |    940 TiB |    940 TiB |
|       from small pool |  35968 KiB |  73944 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 755712 KiB | 755712 KiB | 755712 KiB |      0 B   |
|       from large pool | 679936 KiB | 679936 KiB | 679936 KiB |      0 B   |
|       from small pool |  75776 KiB |  75776 KiB |  75776 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  79692 KiB | 215750 KiB | 380568 GiB | 380568 GiB |
|       from large pool |  67584 KiB | 213792 KiB | 380264 GiB | 380264 GiB |
|       from small pool |  12108 KiB |  13958 KiB |    304 GiB |    304 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3252    |    6223    |   83716 K  |   83713 K  |
|       from large pool |      36    |      76    |   33845 K  |   33845 K  |
|       from small pool |    3216    |    6186    |   49871 K  |   49868 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3252    |    6223    |   83716 K  |   83713 K  |
|       from large pool |      36    |      76    |   33845 K  |   33845 K  |
|       from small pool |    3216    |    6186    |   49871 K  |   49868 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      51    |      51    |      51    |       0    |
|       from large pool |      14    |      14    |      14    |       0    |
|       from small pool |      37    |      37    |      37    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      38    |    2753    |   37622 K  |   37622 K  |
|       from large pool |       7    |      11    |   12103 K  |   12103 K  |
|       from small pool |      31    |    2746    |   25518 K  |   25518 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 640729 KiB |    942 TiB |    942 TiB |
|       from large pool |  16640 KiB | 568000 KiB |    942 TiB |    942 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 640729 KiB |    942 TiB |    942 TiB |
|       from large pool |  16640 KiB | 568000 KiB |    942 TiB |    942 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 632296 KiB |    940 TiB |    940 TiB |
|       from large pool |  16640 KiB | 560704 KiB |    940 TiB |    940 TiB |
|       from small pool |      0 KiB |  73944 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 284672 KiB | 755712 KiB | 755712 KiB | 471040 KiB |
|       from large pool | 235520 KiB | 679936 KiB | 679936 KiB | 444416 KiB |
|       from small pool |  49152 KiB |  75776 KiB |  75776 KiB |  26624 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  55040 KiB | 215750 KiB | 380569 GiB | 380568 GiB |
|       from large pool |  55040 KiB | 213792 KiB | 380264 GiB | 380264 GiB |
|       from small pool |      0 KiB |  19703 KiB |    304 GiB |    304 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6223    |   83716 K  |   83716 K  |
|       from large pool |       2    |      76    |   33845 K  |   33845 K  |
|       from small pool |       0    |    6186    |   49871 K  |   49871 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6223    |   83716 K  |   83716 K  |
|       from large pool |       2    |      76    |   33845 K  |   33845 K  |
|       from small pool |       0    |    6186    |   49871 K  |   49871 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      34    |      51    |      51    |      17    |
|       from large pool |      10    |      14    |      14    |       4    |
|       from small pool |      24    |      37    |      37    |      13    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2753    |   37623 K  |   37623 K  |
|       from large pool |       3    |      13    |   12103 K  |   12103 K  |
|       from small pool |       0    |    2746    |   25519 K  |   25519 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 640729 KiB |    942 TiB |    942 TiB |
|       from large pool |  16640 KiB | 568000 KiB |    942 TiB |    942 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 640729 KiB |    942 TiB |    942 TiB |
|       from large pool |  16640 KiB | 568000 KiB |    942 TiB |    942 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 632296 KiB |    940 TiB |    940 TiB |
|       from large pool |  16640 KiB | 560704 KiB |    940 TiB |    940 TiB |
|       from small pool |      0 KiB |  73944 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 284672 KiB | 755712 KiB | 755712 KiB | 471040 KiB |
|       from large pool | 235520 KiB | 679936 KiB | 679936 KiB | 444416 KiB |
|       from small pool |  49152 KiB |  75776 KiB |  75776 KiB |  26624 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  55040 KiB | 215750 KiB | 380569 GiB | 380568 GiB |
|       from large pool |  55040 KiB | 213792 KiB | 380264 GiB | 380264 GiB |
|       from small pool |      0 KiB |  19703 KiB |    304 GiB |    304 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6223    |   83716 K  |   83716 K  |
|       from large pool |       2    |      76    |   33845 K  |   33845 K  |
|       from small pool |       0    |    6186    |   49871 K  |   49871 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6223    |   83716 K  |   83716 K  |
|       from large pool |       2    |      76    |   33845 K  |   33845 K  |
|       from small pool |       0    |    6186    |   49871 K  |   49871 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      34    |      51    |      51    |      17    |
|       from large pool |      10    |      14    |      14    |       4    |
|       from small pool |      24    |      37    |      37    |      13    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2753    |   37623 K  |   37623 K  |
|       from large pool |       3    |      13    |   12103 K  |   12103 K  |
|       from small pool |       0    |    2746    |   25519 K  |   25519 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0




!!!: not committed yet



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_23_23_37_seed_1_21324354

 Experiment start at: 2024-06-14 23:23:37.867241
before training, model accuracy: 0.14647115767002106
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9668688, 'precision': 0.7199575, 'recall': 0.5296811, 'specificity': 0.5296811, 'f1': 0.54612803, 'auroc': 0.88892543, 'binary_precision': 0.47089946, 'binary_recall': 0.061719835, 'binary_specificity': 0.9976423, 'binary_f1_score': 0.1091355}
confusion matrix:
       0    1
0  42314  100
1   1353   89
---- Validation: 
scalar performance:
{'acc': 0.9638207, 'precision': 0.6727135, 'recall': 0.50558376, 'specificity': 0.50558376, 'f1': 0.5023119, 'auroc': 0.8852313, 'binary_precision': 0.3809524, 'binary_recall': 0.011887073, 'binary_specificity': 0.99928045, 'binary_f1_score': 0.023054756}
confusion matrix:
       0   1
0  18054  13
1    665   8
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95955527, 'precision': 0.97974825, 'recall': 0.5173077, 'specificity': 0.5173077, 'f1': 0.5231221, 'auroc': 0.8578107, 'binary_precision': 1.0, 'binary_recall': 0.034615386, 'binary_specificity': 1.0, 'binary_f1_score': 0.0669145}
confusion matrix:
      0  1
0  5946  0
1   251  9
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324354_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-14 23:42:54.600319,epoch time: 0:19:16.733078,used: 0:19:16.733078,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_23_23_37_seed_1_21324354
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96778095, 'precision': 0.74749565, 'recall': 0.6299683, 'specificity': 0.6299683, 'f1': 0.66869396, 'auroc': 0.91643083, 'binary_precision': 0.51946306, 'binary_recall': 0.26837724, 'binary_specificity': 0.9915594, 'binary_f1_score': 0.35390943}
confusion matrix:
       0    1
0  42056  358
1   1055  387
---- Validation: 
scalar performance:
{'acc': 0.9648346, 'precision': 0.75022775, 'recall': 0.5883653, 'specificity': 0.5883653, 'f1': 0.6269027, 'auroc': 0.9137, 'binary_precision': 0.5301724, 'binary_recall': 0.18276374, 'binary_specificity': 0.9939669, 'binary_f1_score': 0.2718232}
confusion matrix:
       0    1
0  17958  109
1    550  123
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97164035, 'precision': 0.9691901, 'recall': 0.6670554, 'specificity': 0.6670554, 'f1': 0.7412758, 'auroc': 0.8792362, 'binary_precision': 0.96666664, 'binary_recall': 0.33461538, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.49714285}
confusion matrix:
      0   1
0  5943   3
1   173  87
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324354_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-15 00:01:52.501300,epoch time: 0:18:57.900981,used: 0:38:14.634059,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_23_23_37_seed_1_21324354
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9668232, 'precision': 0.7317163, 'recall': 0.60301197, 'specificity': 0.60301197, 'f1': 0.64022565, 'auroc': 0.9172189, 'binary_precision': 0.48966613, 'binary_recall': 0.21359223, 'binary_specificity': 0.99243176, 'binary_f1_score': 0.29744083}
confusion matrix:
       0    1
0  42093  321
1   1134  308
---- Validation: 
scalar performance:
{'acc': 0.96510136, 'precision': 0.7619183, 'recall': 0.56919146, 'specificity': 0.56919146, 'f1': 0.60454905, 'auroc': 0.9204158, 'binary_precision': 0.5549133, 'binary_recall': 0.14264487, 'binary_specificity': 0.9957381, 'binary_f1_score': 0.22695035}
confusion matrix:
       0   1
0  17990  77
1    577  96
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9653561, 'precision': 0.9825516, 'recall': 0.58653843, 'specificity': 0.58653843, 'f1': 0.6386618, 'auroc': 0.8837685, 'binary_precision': 1.0, 'binary_recall': 0.17307693, 'binary_specificity': 1.0, 'binary_f1_score': 0.295082}
confusion matrix:
      0   1
0  5946   0
1   215  45
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324354_3.png
better model found
persisted
after epoch: 3,now: 2024-06-15 00:20:43.743013,epoch time: 0:18:51.241713,used: 0:57:05.875772,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_23_23_37_seed_1_21324354
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96787214, 'precision': 0.749599, 'recall': 0.619297, 'specificity': 0.619297, 'f1': 0.65930104, 'auroc': 0.92325765, 'binary_precision': 0.5243722, 'binary_recall': 0.24618585, 'binary_specificity': 0.99240816, 'binary_f1_score': 0.3350637}
confusion matrix:
       0    1
0  42092  322
1   1087  355
---- Validation: 
scalar performance:
{'acc': 0.96659553, 'precision': 0.80431473, 'recall': 0.57854956, 'specificity': 0.57854956, 'f1': 0.61972296, 'auroc': 0.91785485, 'binary_precision': 0.6390532, 'binary_recall': 0.16047548, 'binary_specificity': 0.9966237, 'binary_f1_score': 0.25653204}
confusion matrix:
       0    1
0  18006   61
1    565  108
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9648727, 'precision': 0.9823167, 'recall': 0.58076924, 'specificity': 0.58076924, 'f1': 0.630072, 'auroc': 0.8844225, 'binary_precision': 1.0, 'binary_recall': 0.16153847, 'binary_specificity': 1.0, 'binary_f1_score': 0.2781457}
confusion matrix:
      0   1
0  5946   0
1   218  42
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324354_4.png
better model found
persisted
after epoch: 4,now: 2024-06-15 00:39:25.847967,epoch time: 0:18:42.104954,used: 1:15:47.980726,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_23_23_37_seed_1_21324354
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96898943, 'precision': 0.76689315, 'recall': 0.6329378, 'specificity': 0.6329378, 'f1': 0.6754792, 'auroc': 0.92772686, 'binary_precision': 0.55807364, 'binary_recall': 0.27323163, 'binary_specificity': 0.99264395, 'binary_f1_score': 0.3668529}
confusion matrix:
       0    1
0  42102  312
1   1048  394
---- Validation: 
scalar performance:
{'acc': 0.96542156, 'precision': 0.76749253, 'recall': 0.5779407, 'specificity': 0.5779407, 'f1': 0.6161514, 'auroc': 0.92665493, 'binary_precision': 0.565445, 'binary_recall': 0.16047548, 'binary_specificity': 0.995406, 'binary_f1_score': 0.24999999}
confusion matrix:
       0    1
0  17984   83
1    565  108
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96841764, 'precision': 0.9840443, 'recall': 0.6230769, 'specificity': 0.6230769, 'f1': 0.6894237, 'auroc': 0.88705415, 'binary_precision': 1.0, 'binary_recall': 0.24615385, 'binary_specificity': 1.0, 'binary_f1_score': 0.39506173}
confusion matrix:
      0   1
0  5946   0
1   196  64
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324354_5.png
early stop counter: 1
val acc:0.9654215574264526, best validation acc: 0.9665955305099487, corresponding to test acc:                         0.9648727178573608 / 0.9716403484344482
after epoch: 5,now: 2024-06-15 00:58:17.331426,epoch time: 0:18:51.483459,used: 1:34:39.464185,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_23_23_37_seed_1_21324354
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9690806, 'precision': 0.7622391, 'recall': 0.67116946, 'specificity': 0.67116946, 'f1': 0.70622057, 'auroc': 0.92859435, 'binary_precision': 0.5462366, 'binary_recall': 0.35228848, 'binary_specificity': 0.99005044, 'binary_f1_score': 0.4283305}
confusion matrix:
       0    1
0  41992  422
1    934  508
---- Validation: 
scalar performance:
{'acc': 0.96766275, 'precision': 0.7945446, 'recall': 0.6291718, 'specificity': 0.6291718, 'f1': 0.67673385, 'auroc': 0.92623127, 'binary_precision': 0.61591697, 'binary_recall': 0.26448736, 'binary_specificity': 0.9938562, 'binary_f1_score': 0.37006235}
confusion matrix:
       0    1
0  17956  111
1    495  178
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96841764, 'precision': 0.9840443, 'recall': 0.6230769, 'specificity': 0.6230769, 'f1': 0.6894237, 'auroc': 0.88772106, 'binary_precision': 1.0, 'binary_recall': 0.24615385, 'binary_specificity': 1.0, 'binary_f1_score': 0.39506173}
confusion matrix:
      0   1
0  5946   0
1   196  64
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324354_6.png
better model found
persisted
after epoch: 6,now: 2024-06-15 01:17:05.395711,epoch time: 0:18:48.064285,used: 1:53:27.528470,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_23_23_37_seed_1_21324354
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9687158, 'precision': 0.7582097, 'recall': 0.66428185, 'specificity': 0.66428185, 'f1': 0.6998003, 'auroc': 0.9352035, 'binary_precision': 0.5386313, 'binary_recall': 0.33841887, 'binary_specificity': 0.9901448, 'binary_f1_score': 0.41567293}
confusion matrix:
       0    1
0  41996  418
1    954  488
---- Validation: 
scalar performance:
{'acc': 0.96750265, 'precision': 0.7955614, 'recall': 0.6212208, 'specificity': 0.6212208, 'f1': 0.66876036, 'auroc': 0.9299965, 'binary_precision': 0.61851853, 'binary_recall': 0.24814264, 'binary_specificity': 0.994299, 'binary_f1_score': 0.35418877}
confusion matrix:
       0    1
0  17964  103
1    506  167
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96696746, 'precision': 0.98333603, 'recall': 0.6057692, 'specificity': 0.6057692, 'f1': 0.66613, 'auroc': 0.88643944, 'binary_precision': 1.0, 'binary_recall': 0.21153846, 'binary_specificity': 1.0, 'binary_f1_score': 0.34920636}
confusion matrix:
      0   1
0  5946   0
1   205  55
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324354_7.png
early stop counter: 1
val acc:0.9675026535987854, best validation acc: 0.9676627516746521, corresponding to test acc:                         0.9684176445007324 / 0.9716403484344482
after epoch: 7,now: 2024-06-15 01:35:50.653226,epoch time: 0:18:45.257515,used: 2:12:12.785985,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_23_23_37_seed_1_21324354
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.969035, 'precision': 0.76025844, 'recall': 0.6852139, 'specificity': 0.6852139, 'f1': 0.71579474, 'auroc': 0.93640614, 'binary_precision': 0.54133856, 'binary_recall': 0.3814147, 'binary_specificity': 0.9890131, 'binary_f1_score': 0.44751832}
confusion matrix:
       0    1
0  41948  466
1    892  550
---- Validation: 
scalar performance:
{'acc': 0.9681964, 'precision': 0.7929436, 'recall': 0.65376765, 'specificity': 0.65376765, 'f1': 0.6996698, 'auroc': 0.93264467, 'binary_precision': 0.610951, 'binary_recall': 0.31500742, 'binary_specificity': 0.99252784, 'binary_f1_score': 0.41568628}
confusion matrix:
       0    1
0  17932  135
1    461  212
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9722849, 'precision': 0.9804647, 'recall': 0.67106974, 'specificity': 0.67106974, 'f1': 0.74715585, 'auroc': 0.89404786, 'binary_precision': 0.98888886, 'binary_recall': 0.3423077, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.5085714}
confusion matrix:
      0   1
0  5945   1
1   171  89
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324354_8.png
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-06-15 01:54:29.286286,epoch time: 0:18:38.633060,used: 2:30:51.419045,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_23_23_37_seed_1_21324354
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.96894383, 'precision': 0.75828433, 'recall': 0.69755995, 'specificity': 0.69755995, 'f1': 0.7234717, 'auroc': 0.93449867, 'binary_precision': 0.5365631, 'binary_recall': 0.4070735, 'binary_specificity': 0.9880464, 'binary_f1_score': 0.46293375}
confusion matrix:
       0    1
0  41907  507
1    855  587
---- Validation: 
scalar performance:
{'acc': 0.96792954, 'precision': 0.7830862, 'recall': 0.6707957, 'specificity': 0.6707957, 'f1': 0.7116902, 'auroc': 0.9349338, 'binary_precision': 0.59, 'binary_recall': 0.35066864, 'binary_specificity': 0.9909227, 'binary_f1_score': 0.43988815}
confusion matrix:
       0    1
0  17903  164
1    437  236
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9730905, 'precision': 0.9811548, 'recall': 0.68068516, 'specificity': 0.68068516, 'f1': 0.7578633, 'auroc': 0.89607865, 'binary_precision': 0.9894737, 'binary_recall': 0.36153847, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.52957743}
confusion matrix:
      0   1
0  5945   1
1   166  94
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324354_9.png
new oracle model saved
early stop counter: 1
val acc:0.9679295420646667, best validation acc: 0.9681963920593262, corresponding to test acc:                         0.9722849130630493 / 0.9730905294418335
after epoch: 9,now: 2024-06-15 02:13:13.177017,epoch time: 0:18:43.890731,used: 2:49:35.309776,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_23_23_37_seed_1_21324354
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.96914905, 'precision': 0.7647446, 'recall': 0.65914655, 'specificity': 0.65914655, 'f1': 0.6975652, 'auroc': 0.93587375, 'binary_precision': 0.5520468, 'binary_recall': 0.32732317, 'binary_specificity': 0.99096996, 'binary_f1_score': 0.4109708}
confusion matrix:
       0    1
0  42031  383
1    970  472
---- Validation: 
scalar performance:
{'acc': 0.9670224, 'precision': 0.7967174, 'recall': 0.60165954, 'specificity': 0.60165954, 'f1': 0.6474552, 'auroc': 0.9336542, 'binary_precision': 0.62222224, 'binary_recall': 0.20802377, 'binary_specificity': 0.9952953, 'binary_f1_score': 0.311804}
confusion matrix:
       0    1
0  17982   85
1    533  140
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650338, 'precision': 0.98239493, 'recall': 0.5826923, 'specificity': 0.5826923, 'f1': 0.6329539, 'auroc': 0.89440167, 'binary_precision': 1.0, 'binary_recall': 0.16538462, 'binary_specificity': 1.0, 'binary_f1_score': 0.28382838}
confusion matrix:
      0   1
0  5946   0
1   217  43
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324354_10.png
early stop counter: 2
val acc:0.9670224189758301, best validation acc: 0.9681963920593262, corresponding to test acc:                         0.9722849130630493 / 0.9730905294418335
after epoch: 10,now: 2024-06-15 02:32:00.881147,epoch time: 0:18:47.704130,used: 3:08:23.013906,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_23_23_37_seed_1_21324354
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96953666, 'precision': 0.765183, 'recall': 0.69451696, 'specificity': 0.69451696, 'f1': 0.7238885, 'auroc': 0.9369747, 'binary_precision': 0.5505725, 'binary_recall': 0.4001387, 'binary_specificity': 0.9888952, 'binary_f1_score': 0.4634538}
confusion matrix:
       0    1
0  41943  471
1    865  577
---- Validation: 
scalar performance:
{'acc': 0.96755606, 'precision': 0.7927874, 'recall': 0.62840116, 'specificity': 0.62840116, 'f1': 0.67566705, 'auroc': 0.9318685, 'binary_precision': 0.61245674, 'binary_recall': 0.26300147, 'binary_specificity': 0.9938009, 'binary_f1_score': 0.36798334}
confusion matrix:
       0    1
0  17955  112
1    496  177
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96648407, 'precision': 0.9831004, 'recall': 0.6, 'specificity': 0.6, 'f1': 0.65807164, 'auroc': 0.8956482, 'binary_precision': 1.0, 'binary_recall': 0.2, 'binary_specificity': 1.0, 'binary_f1_score': 0.3333333}
confusion matrix:
      0   1
0  5946   0
1   208  52
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324354_11.png
early stop counter: 3
val acc:0.9675560593605042, best validation acc: 0.9681963920593262, corresponding to test acc:                         0.9722849130630493 / 0.9730905294418335
after epoch: 11,now: 2024-06-15 02:50:47.879153,epoch time: 0:18:46.998006,used: 3:27:10.011912,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_23_23_37_seed_1_21324354
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9687614, 'precision': 0.75584424, 'recall': 0.70717925, 'specificity': 0.70717925, 'f1': 0.72869253, 'auroc': 0.9380983, 'binary_precision': 0.53103447, 'binary_recall': 0.42718446, 'binary_specificity': 0.98717403, 'binary_f1_score': 0.47348192}
confusion matrix:
       0    1
0  41870  544
1    826  616
---- Validation: 
scalar performance:
{'acc': 0.9677161, 'precision': 0.7818915, 'recall': 0.6642476, 'specificity': 0.6642476, 'f1': 0.70604753, 'auroc': 0.936658, 'binary_precision': 0.5880829, 'binary_recall': 0.33729568, 'binary_specificity': 0.99119943, 'binary_f1_score': 0.42870632}
confusion matrix:
       0    1
0  17908  159
1    446  227
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96777314, 'precision': 0.98372924, 'recall': 0.61538464, 'specificity': 0.61538464, 'f1': 0.6792301, 'auroc': 0.8917211, 'binary_precision': 1.0, 'binary_recall': 0.23076923, 'binary_specificity': 1.0, 'binary_f1_score': 0.375}
confusion matrix:
      0   1
0  5946   0
1   200  60
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324354_12.png
early stop counter: 4
val acc:0.9677160978317261, best validation acc: 0.9681963920593262, corresponding to test acc:                         0.9722849130630493 / 0.9730905294418335
after epoch: 12,now: 2024-06-15 03:09:33.486012,epoch time: 0:18:45.606859,used: 3:45:55.618771,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_23_23_37_seed_1_21324354
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.96919465, 'precision': 0.76272297, 'recall': 0.67737246, 'specificity': 0.67737246, 'f1': 0.7109748, 'auroc': 0.9355266, 'binary_precision': 0.54677755, 'binary_recall': 0.3650243, 'binary_specificity': 0.98972064, 'binary_f1_score': 0.43778613}
confusion matrix:
       0    1
0  41979  436
1    915  526
---- Validation: 
scalar performance:
{'acc': 0.9687834, 'precision': 0.791397, 'recall': 0.68268275, 'specificity': 0.68268275, 'f1': 0.7233673, 'auroc': 0.9346921, 'binary_precision': 0.6057692, 'binary_recall': 0.3744428, 'binary_specificity': 0.9909227, 'binary_f1_score': 0.46280992}
confusion matrix:
       0    1
0  17903  164
1    421  252
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9690622, 'precision': 0.96431875, 'recall': 0.6362862, 'specificity': 0.6362862, 'f1': 0.70462656, 'auroc': 0.89649266, 'binary_precision': 0.9594595, 'binary_recall': 0.27307692, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.4251497}
confusion matrix:
      0   1
0  5943   3
1   189  71
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324354_13.png
better model found
persisted
after epoch: 13,now: 2024-06-15 03:28:22.762996,epoch time: 0:18:49.276984,used: 4:04:44.895755,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_23_23_37_seed_1_21324354
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9699471, 'precision': 0.76863706, 'recall': 0.70511264, 'specificity': 0.70511264, 'f1': 0.73220015, 'auroc': 0.9358058, 'binary_precision': 0.5567766, 'binary_recall': 0.4216366, 'binary_specificity': 0.9885887, 'binary_f1_score': 0.47987372}
confusion matrix:
       0    1
0  41930  484
1    834  608
---- Validation: 
scalar performance:
{'acc': 0.96792954, 'precision': 0.7960569, 'recall': 0.6364628, 'specificity': 0.6364628, 'f1': 0.68419355, 'auroc': 0.93332744, 'binary_precision': 0.6184211, 'binary_recall': 0.2793462, 'binary_specificity': 0.99357945, 'binary_f1_score': 0.38485155}
confusion matrix:
       0    1
0  17951  116
1    485  188
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9655172, 'precision': 0.9826299, 'recall': 0.5884615, 'specificity': 0.5884615, 'f1': 0.6414882, 'auroc': 0.8929295, 'binary_precision': 1.0, 'binary_recall': 0.17692308, 'binary_specificity': 1.0, 'binary_f1_score': 0.3006536}
confusion matrix:
      0   1
0  5946   0
1   214  46
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324354_14.png
early stop counter: 1
val acc:0.9679295420646667, best validation acc: 0.9687833786010742, corresponding to test acc:                         0.9690622091293335 / 0.9730905294418335
after epoch: 14,now: 2024-06-15 03:47:13.698607,epoch time: 0:18:50.935611,used: 4:23:35.831366,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_23_23_37_seed_1_21324354
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9702891, 'precision': 0.7781371, 'recall': 0.6744739, 'specificity': 0.6744739, 'f1': 0.7133541, 'auroc': 0.9405883, 'binary_precision': 0.5778276, 'binary_recall': 0.35783634, 'binary_specificity': 0.9911114, 'binary_f1_score': 0.44197002}
confusion matrix:
       0    1
0  42037  377
1    926  516
---- Validation: 
scalar performance:
{'acc': 0.9681964, 'precision': 0.79927623, 'recall': 0.64017755, 'specificity': 0.64017755, 'f1': 0.68837285, 'auroc': 0.93801546, 'binary_precision': 0.62459546, 'binary_recall': 0.28677562, 'binary_specificity': 0.99357945, 'binary_f1_score': 0.39307535}
confusion matrix:
       0    1
0  17951  116
1    480  193
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9671286, 'precision': 0.98341465, 'recall': 0.6076923, 'specificity': 0.6076923, 'f1': 0.6687826, 'auroc': 0.9017659, 'binary_precision': 1.0, 'binary_recall': 0.21538462, 'binary_specificity': 1.0, 'binary_f1_score': 0.35443038}
confusion matrix:
      0   1
0  5946   0
1   204  56
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324354_15.png
early stop counter: 2
val acc:0.9681963920593262, best validation acc: 0.9687833786010742, corresponding to test acc:                         0.9690622091293335 / 0.9730905294418335
after epoch: 15,now: 2024-06-15 04:06:01.402829,epoch time: 0:18:47.704222,used: 4:42:23.535588,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_23_23_37_seed_1_21324354
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9707224, 'precision': 0.7785761, 'recall': 0.70015424, 'specificity': 0.70015424, 'f1': 0.732339, 'auroc': 0.9399314, 'binary_precision': 0.57699805, 'binary_recall': 0.4105409, 'binary_specificity': 0.98976755, 'binary_f1_score': 0.47974068}
confusion matrix:
       0    1
0  41980  434
1    850  592
---- Validation: 
scalar performance:
{'acc': 0.96835643, 'precision': 0.7959238, 'recall': 0.65313536, 'specificity': 0.65313536, 'f1': 0.69975066, 'auroc': 0.9370876, 'binary_precision': 0.61695904, 'binary_recall': 0.31352153, 'binary_specificity': 0.9927492, 'binary_f1_score': 0.41576353}
confusion matrix:
       0    1
0  17936  131
1    462  211
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9655172, 'precision': 0.9826299, 'recall': 0.5884615, 'specificity': 0.5884615, 'f1': 0.6414882, 'auroc': 0.89088917, 'binary_precision': 1.0, 'binary_recall': 0.17692308, 'binary_specificity': 1.0, 'binary_f1_score': 0.3006536}
confusion matrix:
      0   1
0  5946   0
1   214  46
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324354_16.png
early stop counter: 3
val acc:0.9683564305305481, best validation acc: 0.9687833786010742, corresponding to test acc:                         0.9690622091293335 / 0.9730905294418335
after epoch: 16,now: 2024-06-15 04:24:53.671639,epoch time: 0:18:52.268810,used: 5:01:15.804398,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_23_23_37_seed_1_21324354
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.97060835, 'precision': 0.7720045, 'recall': 0.73593515, 'specificity': 0.73593515, 'f1': 0.7525613, 'auroc': 0.94513744, 'binary_precision': 0.5614458, 'binary_recall': 0.48474342, 'binary_specificity': 0.9871269, 'binary_f1_score': 0.5202828}
confusion matrix:
       0    1
0  41868  546
1    743  699
---- Validation: 
scalar performance:
{'acc': 0.9689968, 'precision': 0.7995187, 'recall': 0.66920334, 'specificity': 0.66920334, 'f1': 0.71456707, 'auroc': 0.9351616, 'binary_precision': 0.62299466, 'binary_recall': 0.346211, 'binary_specificity': 0.9921957, 'binary_f1_score': 0.4450812}
confusion matrix:
       0    1
0  17926  141
1    440  233
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9653561, 'precision': 0.9825516, 'recall': 0.58653843, 'specificity': 0.58653843, 'f1': 0.6386618, 'auroc': 0.89184976, 'binary_precision': 1.0, 'binary_recall': 0.17307693, 'binary_specificity': 1.0, 'binary_f1_score': 0.295082}
confusion matrix:
      0   1
0  5946   0
1   215  45
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324354_17.png
better model found
persisted
after epoch: 17,now: 2024-06-15 04:43:48.787772,epoch time: 0:18:55.116133,used: 5:20:10.920531,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_23_23_37_seed_1_21324354
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.96953666, 'precision': 0.7627089, 'recall': 0.7216481, 'specificity': 0.7216481, 'f1': 0.7402614, 'auroc': 0.94640326, 'binary_precision': 0.54380167, 'binary_recall': 0.4563107, 'binary_specificity': 0.98698545, 'binary_f1_score': 0.4962293}
confusion matrix:
       0    1
0  41862  552
1    784  658
---- Validation: 
scalar performance:
{'acc': 0.96905017, 'precision': 0.7979982, 'recall': 0.67495316, 'specificity': 0.67495316, 'f1': 0.7189672, 'auroc': 0.93834937, 'binary_precision': 0.6195373, 'binary_recall': 0.35809806, 'binary_specificity': 0.9918083, 'binary_f1_score': 0.45386064}
confusion matrix:
       0    1
0  17919  148
1    432  241
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9661618, 'precision': 0.9829435, 'recall': 0.59615386, 'specificity': 0.59615386, 'f1': 0.65261406, 'auroc': 0.8904424, 'binary_precision': 1.0, 'binary_recall': 0.1923077, 'binary_specificity': 1.0, 'binary_f1_score': 0.32258064}
confusion matrix:
      0   1
0  5946   0
1   210  50
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324354_18.png
better model found
persisted
after epoch: 18,now: 2024-06-15 05:02:44.769922,epoch time: 0:18:55.982150,used: 5:39:06.902681,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_23_23_37_seed_1_21324354
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9696507, 'precision': 0.76266074, 'recall': 0.73811966, 'specificity': 0.73811966, 'f1': 0.7497268, 'auroc': 0.945465, 'binary_precision': 0.542594, 'binary_recall': 0.49029127, 'binary_specificity': 0.985948, 'binary_f1_score': 0.5151184}
confusion matrix:
       0    1
0  41818  596
1    735  707
---- Validation: 
scalar performance:
{'acc': 0.9688367, 'precision': 0.79144144, 'recall': 0.68485624, 'specificity': 0.68485624, 'f1': 0.7250645, 'auroc': 0.93754005, 'binary_precision': 0.60570073, 'binary_recall': 0.37890044, 'binary_specificity': 0.990812, 'binary_f1_score': 0.4661792}
confusion matrix:
       0    1
0  17901  166
1    418  255
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9705124, 'precision': 0.98507094, 'recall': 0.6480769, 'specificity': 0.6480769, 'f1': 0.720909, 'auroc': 0.8979281, 'binary_precision': 1.0, 'binary_recall': 0.29615384, 'binary_specificity': 1.0, 'binary_f1_score': 0.4569733}
confusion matrix:
      0   1
0  5946   0
1   183  77
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324354_19.png
early stop counter: 1
val acc:0.9688367247581482, best validation acc: 0.9690501689910889, corresponding to test acc:                         0.9661617875099182 / 0.9730905294418335
after epoch: 19,now: 2024-06-15 05:21:36.788334,epoch time: 0:18:52.018412,used: 5:57:58.921093,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_23_23_37_seed_1_21324354
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.97042596, 'precision': 0.7785449, 'recall': 0.6800202, 'specificity': 0.6800202, 'f1': 0.7177302, 'auroc': 0.9433814, 'binary_precision': 0.5782609, 'binary_recall': 0.36918807, 'binary_specificity': 0.9908523, 'binary_f1_score': 0.45065653}
confusion matrix:
       0    1
0  42027  388
1    909  532
---- Validation: 
scalar performance:
{'acc': 0.9694237, 'precision': 0.8164945, 'recall': 0.6515431, 'specificity': 0.6515431, 'f1': 0.7024622, 'auroc': 0.9386867, 'binary_precision': 0.65822786, 'binary_recall': 0.30906388, 'binary_specificity': 0.99402225, 'binary_f1_score': 0.42062688}
confusion matrix:
       0    1
0  17959  108
1    465  208
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96422815, 'precision': 0.9820039, 'recall': 0.5730769, 'specificity': 0.5730769, 'f1': 0.61835384, 'auroc': 0.8958045, 'binary_precision': 1.0, 'binary_recall': 0.14615385, 'binary_specificity': 1.0, 'binary_f1_score': 0.25503358}
confusion matrix:
      0   1
0  5946   0
1   222  38
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324354_20.png
better model found
persisted
after epoch: 20,now: 2024-06-15 05:40:27.263166,epoch time: 0:18:50.474832,used: 6:16:49.395925,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_23_23_37_seed_1_21324354
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.97065395, 'precision': 0.774862, 'recall': 0.71753633, 'specificity': 0.71753633, 'f1': 0.74253863, 'auroc': 0.94229454, 'binary_precision': 0.56840247, 'binary_recall': 0.44660193, 'binary_specificity': 0.9884708, 'binary_f1_score': 0.50019413}
confusion matrix:
       0    1
0  41925  489
1    798  644
---- Validation: 
scalar performance:
{'acc': 0.9691035, 'precision': 0.79686975, 'recall': 0.6799877, 'specificity': 0.6799877, 'f1': 0.7227455, 'auroc': 0.9388077, 'binary_precision': 0.6169154, 'binary_recall': 0.36849925, 'binary_specificity': 0.9914762, 'binary_f1_score': 0.46139535}
confusion matrix:
       0    1
0  17913  154
1    425  248
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96890104, 'precision': 0.9771108, 'recall': 0.63068515, 'specificity': 0.63068515, 'f1': 0.6987005, 'auroc': 0.89610434, 'binary_precision': 0.98550725, 'binary_recall': 0.26153848, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.4133739}
confusion matrix:
      0   1
0  5945   1
1   192  68
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324354_21.png
early stop counter: 1
val acc:0.9691035151481628, best validation acc: 0.9694237112998962, corresponding to test acc:                         0.9642281532287598 / 0.9730905294418335
after epoch: 21,now: 2024-06-15 05:59:15.285629,epoch time: 0:18:48.022463,used: 6:35:37.418388,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_23_23_37_seed_1_21324354
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9702891, 'precision': 0.77608716, 'recall': 0.6841875, 'specificity': 0.6841875, 'f1': 0.72011155, 'auroc': 0.93983525, 'binary_precision': 0.57308096, 'binary_recall': 0.3779473, 'binary_specificity': 0.9904277, 'binary_f1_score': 0.4554952}
confusion matrix:
       0    1
0  42008  406
1    897  545
---- Validation: 
scalar performance:
{'acc': 0.96808964, 'precision': 0.800739, 'recall': 0.63368475, 'specificity': 0.63368475, 'f1': 0.6822875, 'auroc': 0.9384501, 'binary_precision': 0.6279864, 'binary_recall': 0.27340266, 'binary_specificity': 0.9939669, 'binary_f1_score': 0.3809524}
confusion matrix:
       0    1
0  17958  109
1    489  184
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9655172, 'precision': 0.9826299, 'recall': 0.5884615, 'specificity': 0.5884615, 'f1': 0.6414882, 'auroc': 0.89603543, 'binary_precision': 1.0, 'binary_recall': 0.17692308, 'binary_specificity': 1.0, 'binary_f1_score': 0.3006536}
confusion matrix:
      0   1
0  5946   0
1   214  46
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324354_22.png
early stop counter: 2
val acc:0.9680896401405334, best validation acc: 0.9694237112998962, corresponding to test acc:                         0.9642281532287598 / 0.9730905294418335
after epoch: 22,now: 2024-06-15 06:17:56.732212,epoch time: 0:18:41.446583,used: 6:54:18.864971,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_23_23_37_seed_1_21324354
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.96971905, 'precision': 0.76498824, 'recall': 0.7163831, 'specificity': 0.7163831, 'f1': 0.7379861, 'auroc': 0.94095737, 'binary_precision': 0.548718, 'binary_recall': 0.445215, 'binary_specificity': 0.9875513, 'binary_f1_score': 0.49157733}
confusion matrix:
       0    1
0  41886  528
1    800  642
---- Validation: 
scalar performance:
{'acc': 0.96990395, 'precision': 0.8035909, 'recall': 0.6925624, 'specificity': 0.6925624, 'f1': 0.73448014, 'auroc': 0.94279206, 'binary_precision': 0.62945366, 'binary_recall': 0.39375928, 'binary_specificity': 0.9913655, 'binary_f1_score': 0.4844607}
confusion matrix:
       0    1
0  17911  156
1    408  265
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96825653, 'precision': 0.96919256, 'recall': 0.6248318, 'specificity': 0.6248318, 'f1': 0.69062614, 'auroc': 0.89868367, 'binary_precision': 0.9701493, 'binary_recall': 0.25, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.39755353}
confusion matrix:
      0   1
0  5944   2
1   195  65
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324354_23.png
better model found
persisted
after epoch: 23,now: 2024-06-15 06:36:43.474284,epoch time: 0:18:46.742072,used: 7:13:05.607043,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_23_23_37_seed_1_21324354
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.96971905, 'precision': 0.7648382, 'recall': 0.7180579, 'specificity': 0.7180579, 'f1': 0.7389548, 'auroc': 0.9453566, 'binary_precision': 0.5483051, 'binary_recall': 0.4486824, 'binary_specificity': 0.9874334, 'binary_f1_score': 0.49351645}
confusion matrix:
       0    1
0  41881  533
1    795  647
---- Validation: 
scalar performance:
{'acc': 0.96931696, 'precision': 0.8032886, 'recall': 0.6722305, 'specificity': 0.6722305, 'f1': 0.71803784, 'auroc': 0.94063675, 'binary_precision': 0.6303192, 'binary_recall': 0.35215452, 'binary_specificity': 0.9923064, 'binary_f1_score': 0.4518589}
confusion matrix:
       0    1
0  17928  139
1    436  237
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96745086, 'precision': 0.9753146, 'recall': 0.61337745, 'specificity': 0.61337745, 'f1': 0.67602235, 'auroc': 0.9001321, 'binary_precision': 0.98333335, 'binary_recall': 0.22692308, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.36875}
confusion matrix:
      0   1
0  5945   1
1   201  59
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324354_24.png
early stop counter: 1
val acc:0.9693169593811035, best validation acc: 0.9699039459228516, corresponding to test acc:                         0.9682565331459045 / 0.9730905294418335
after epoch: 24,now: 2024-06-15 06:55:30.490416,epoch time: 0:18:47.016132,used: 7:31:52.623175,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_23_23_37_seed_1_21324354
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.96967345, 'precision': 0.7662234, 'recall': 0.69927704, 'specificity': 0.69927704, 'f1': 0.72746557, 'auroc': 0.9432578, 'binary_precision': 0.55233645, 'binary_recall': 0.40984744, 'binary_specificity': 0.9887066, 'binary_f1_score': 0.47054142}
confusion matrix:
       0    1
0  41935  479
1    851  591
---- Validation: 
scalar performance:
{'acc': 0.9692636, 'precision': 0.7997544, 'recall': 0.6786402, 'specificity': 0.6786402, 'f1': 0.7224276, 'auroc': 0.94128907, 'binary_precision': 0.6227848, 'binary_recall': 0.36552748, 'binary_specificity': 0.9917529, 'binary_f1_score': 0.46067414}
confusion matrix:
       0    1
0  17918  149
1    427  246
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96841764, 'precision': 0.9694909, 'recall': 0.6267549, 'specificity': 0.6267549, 'f1': 0.69310963, 'auroc': 0.899619, 'binary_precision': 0.9705882, 'binary_recall': 0.25384617, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.40243903}
confusion matrix:
      0   1
0  5944   2
1   194  66
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324354_25.png
early stop counter: 2
val acc:0.9692636132240295, best validation acc: 0.9699039459228516, corresponding to test acc:                         0.9682565331459045 / 0.9730905294418335
after epoch: 25,now: 2024-06-15 07:14:10.359315,epoch time: 0:18:39.868899,used: 7:50:32.492074,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_23_23_37_seed_1_21324354
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9711328, 'precision': 0.78624594, 'recall': 0.6899829, 'specificity': 0.6899829, 'f1': 0.72750586, 'auroc': 0.9443407, 'binary_precision': 0.59302324, 'binary_recall': 0.389043, 'binary_specificity': 0.9909228, 'binary_f1_score': 0.46984926}
confusion matrix:
       0    1
0  42029  385
1    881  561
---- Validation: 
scalar performance:
{'acc': 0.9681964, 'precision': 0.80205286, 'recall': 0.63517064, 'specificity': 0.63517064, 'f1': 0.683987, 'auroc': 0.94061744, 'binary_precision': 0.6305085, 'binary_recall': 0.27637443, 'binary_specificity': 0.9939669, 'binary_f1_score': 0.38429755}
confusion matrix:
       0    1
0  17958  109
1    487  186
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9643893, 'precision': 0.982082, 'recall': 0.575, 'specificity': 0.575, 'f1': 0.6213124, 'auroc': 0.89929855, 'binary_precision': 1.0, 'binary_recall': 0.15, 'binary_specificity': 1.0, 'binary_f1_score': 0.2608696}
confusion matrix:
      0   1
0  5946   0
1   221  39
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324354_26.png
early stop counter: 3
val acc:0.9681963920593262, best validation acc: 0.9699039459228516, corresponding to test acc:                         0.9682565331459045 / 0.9730905294418335
after epoch: 26,now: 2024-06-15 07:32:45.960468,epoch time: 0:18:35.601153,used: 8:09:08.093227,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_23_23_37_seed_1_21324354
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.97090477, 'precision': 0.773406, 'recall': 0.7491516, 'specificity': 0.7491516, 'f1': 0.7606592, 'auroc': 0.94536173, 'binary_precision': 0.5633588, 'binary_recall': 0.5117892, 'binary_specificity': 0.9865139, 'binary_f1_score': 0.5363372}
confusion matrix:
       0    1
0  41842  572
1    704  738
---- Validation: 
scalar performance:
{'acc': 0.9694237, 'precision': 0.7974918, 'recall': 0.69088274, 'specificity': 0.69088274, 'f1': 0.73143345, 'auroc': 0.9418385, 'binary_precision': 0.6173709, 'binary_recall': 0.3907875, 'binary_specificity': 0.990978, 'binary_f1_score': 0.47861692}
confusion matrix:
       0    1
0  17904  163
1    410  263
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96745086, 'precision': 0.9835719, 'recall': 0.61153847, 'specificity': 0.61153847, 'f1': 0.67403865, 'auroc': 0.89709365, 'binary_precision': 1.0, 'binary_recall': 0.22307692, 'binary_specificity': 1.0, 'binary_f1_score': 0.36477986}
confusion matrix:
      0   1
0  5946   0
1   202  58
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324354_27.png
early stop counter: 4
val acc:0.9694237112998962, best validation acc: 0.9699039459228516, corresponding to test acc:                         0.9682565331459045 / 0.9730905294418335
after epoch: 27,now: 2024-06-15 07:51:19.984841,epoch time: 0:18:34.024373,used: 8:27:42.117600,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_23_23_37_seed_1_21324354
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9716572, 'precision': 0.7924082, 'recall': 0.6942735, 'specificity': 0.6942735, 'f1': 0.73256516, 'auroc': 0.94537985, 'binary_precision': 0.6050686, 'binary_recall': 0.39736477, 'binary_specificity': 0.99118215, 'binary_f1_score': 0.4796986}
confusion matrix:
       0    1
0  42040  374
1    869  573
---- Validation: 
scalar performance:
{'acc': 0.9699573, 'precision': 0.82008386, 'recall': 0.6618336, 'specificity': 0.6618336, 'f1': 0.71273875, 'auroc': 0.94101864, 'binary_precision': 0.66467065, 'binary_recall': 0.32986626, 'binary_specificity': 0.9938009, 'binary_f1_score': 0.44091362}
confusion matrix:
       0    1
0  17955  112
1    451  222
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650338, 'precision': 0.98239493, 'recall': 0.5826923, 'specificity': 0.5826923, 'f1': 0.6329539, 'auroc': 0.89469194, 'binary_precision': 1.0, 'binary_recall': 0.16538462, 'binary_specificity': 1.0, 'binary_f1_score': 0.28382838}
confusion matrix:
      0   1
0  5946   0
1   217  43
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324354_28.png
better model found
persisted
after epoch: 28,now: 2024-06-15 08:09:56.161660,epoch time: 0:18:36.176819,used: 8:46:18.294419,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_23_23_37_seed_1_21324354
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.97040313, 'precision': 0.7713295, 'recall': 0.7237708, 'specificity': 0.7237708, 'f1': 0.7450403, 'auroc': 0.9437791, 'binary_precision': 0.5609137, 'binary_recall': 0.4597781, 'binary_specificity': 0.98776346, 'binary_f1_score': 0.5053354}
confusion matrix:
       0    1
0  41895  519
1    779  663
---- Validation: 
scalar performance:
{'acc': 0.9694237, 'precision': 0.8018416, 'recall': 0.6794385, 'specificity': 0.6794385, 'f1': 0.7236221, 'auroc': 0.9425764, 'binary_precision': 0.62690353, 'binary_recall': 0.36701337, 'binary_specificity': 0.9918636, 'binary_f1_score': 0.46298033}
confusion matrix:
       0    1
0  17920  147
1    426  247
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9656784, 'precision': 0.9725797, 'recall': 0.5922236, 'specificity': 0.5922236, 'f1': 0.64654034, 'auroc': 0.9004682, 'binary_precision': 0.97959185, 'binary_recall': 0.18461539, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.31067964}
confusion matrix:
      0   1
0  5945   1
1   212  48
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324354_29.png
early stop counter: 1
val acc:0.9694237112998962, best validation acc: 0.9699572920799255, corresponding to test acc:                         0.9650338292121887 / 0.9730905294418335
after epoch: 29,now: 2024-06-15 08:28:34.894725,epoch time: 0:18:38.733065,used: 9:04:57.027484,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_23_23_37_seed_1_21324354
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.97085917, 'precision': 0.7876743, 'recall': 0.6707492, 'specificity': 0.6707492, 'f1': 0.71299225, 'auroc': 0.9461342, 'binary_precision': 0.5971564, 'binary_recall': 0.34951457, 'binary_specificity': 0.9919838, 'binary_f1_score': 0.44094488}
confusion matrix:
       0    1
0  42074  340
1    938  504
---- Validation: 
scalar performance:
{'acc': 0.96808964, 'precision': 0.815791, 'recall': 0.61294204, 'specificity': 0.61294204, 'f1': 0.66252923, 'auroc': 0.9409168, 'binary_precision': 0.65957445, 'binary_recall': 0.23031203, 'binary_specificity': 0.99557203, 'binary_f1_score': 0.34140968}
confusion matrix:
       0    1
0  17987   80
1    518  155
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96100545, 'precision': 0.980446, 'recall': 0.5346154, 'specificity': 0.5346154, 'f1': 0.55477625, 'auroc': 0.8987994, 'binary_precision': 1.0, 'binary_recall': 0.06923077, 'binary_specificity': 1.0, 'binary_f1_score': 0.12949641}
confusion matrix:
      0   1
0  5946   0
1   242  18
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324354_30.png
early stop counter: 2
val acc:0.9680896401405334, best validation acc: 0.9699572920799255, corresponding to test acc:                         0.9650338292121887 / 0.9730905294418335
after epoch: 30,now: 2024-06-15 08:47:19.343747,epoch time: 0:18:44.449022,used: 9:23:41.476506,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_23_23_37_seed_1_21324354
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 9:23:41.476506 at 2024-06-15 08:47:19.343747
persisted model performance metric: 

scalar performance:
{'acc': 0.9650338, 'precision': 0.98239493, 'recall': 0.5826923, 'specificity': 0.5826923, 'f1': 0.6329539, 'auroc': 0.89469194, 'binary_precision': 1.0, 'binary_recall': 0.16538462, 'binary_specificity': 1.0, 'binary_f1_score': 0.28382838}
confusion matrix:
      0   1
0  5946   0
1   217  43
oracle model performance metric: 

scalar performance:
{'acc': 0.9730905, 'precision': 0.9811548, 'recall': 0.68068516, 'specificity': 0.68068516, 'f1': 0.7578633, 'auroc': 0.89607865, 'binary_precision': 0.9894737, 'binary_recall': 0.36153847, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.52957743}
confusion matrix:
      0   1
0  5945   1
1   166  94
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_bs16_different_learningrates/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_resnet_bs16_different_learningrates/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204071 KiB | 640729 KiB |   1888 TiB |   1888 TiB |
|       from large pool | 167040 KiB | 568000 KiB |   1888 TiB |   1888 TiB |
|       from small pool |  37031 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 204071 KiB | 640729 KiB |   1888 TiB |   1888 TiB |
|       from large pool | 167040 KiB | 568000 KiB |   1888 TiB |   1888 TiB |
|       from small pool |  37031 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201086 KiB | 632296 KiB |   1880 TiB |   1880 TiB |
|       from large pool | 165120 KiB | 560704 KiB |   1880 TiB |   1880 TiB |
|       from small pool |  35966 KiB |  73944 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 675840 KiB | 755712 KiB |   1120 MiB | 471040 KiB |
|       from large pool | 600064 KiB | 679936 KiB |   1020 MiB | 444416 KiB |
|       from small pool |  75776 KiB |  75776 KiB |    100 MiB |  26624 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  80600 KiB | 218089 KiB | 709643 GiB | 709643 GiB |
|       from large pool |  68480 KiB | 217080 KiB | 709035 GiB | 709035 GiB |
|       from small pool |  12120 KiB |  19703 KiB |    608 GiB |    608 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3228    |    6231    |  167407 K  |  167404 K  |
|       from large pool |      36    |      76    |   67678 K  |   67678 K  |
|       from small pool |    3192    |    6194    |   99728 K  |   99725 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3228    |    6231    |  167407 K  |  167404 K  |
|       from large pool |      36    |      76    |   67678 K  |   67678 K  |
|       from small pool |    3192    |    6194    |   99728 K  |   99725 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      51    |      51    |      68    |      17    |
|       from large pool |      14    |      14    |      18    |       4    |
|       from small pool |      37    |      37    |      50    |      13    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      37    |    2755    |   76314 K  |   76314 K  |
|       from large pool |       5    |      13    |   25322 K  |   25322 K  |
|       from small pool |      32    |    2750    |   50992 K  |   50992 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 640729 KiB |   1888 TiB |   1888 TiB |
|       from large pool |  16640 KiB | 568000 KiB |   1888 TiB |   1888 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 640729 KiB |   1888 TiB |   1888 TiB |
|       from large pool |  16640 KiB | 568000 KiB |   1888 TiB |   1888 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 632296 KiB |   1880 TiB |   1880 TiB |
|       from large pool |  16640 KiB | 560704 KiB |   1880 TiB |   1880 TiB |
|       from small pool |      0 KiB |  73944 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 284672 KiB | 755712 KiB |   1120 MiB |    842 MiB |
|       from large pool | 235520 KiB | 679936 KiB |   1020 MiB |    790 MiB |
|       from small pool |  49152 KiB |  75776 KiB |    100 MiB |     52 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  55040 KiB | 218089 KiB | 709644 GiB | 709643 GiB |
|       from large pool |  55040 KiB | 217080 KiB | 709035 GiB | 709035 GiB |
|       from small pool |      0 KiB |  19715 KiB |    608 GiB |    608 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6231    |  167407 K  |  167407 K  |
|       from large pool |       2    |      76    |   67678 K  |   67678 K  |
|       from small pool |       0    |    6194    |   99728 K  |   99728 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6231    |  167407 K  |  167407 K  |
|       from large pool |       2    |      76    |   67678 K  |   67678 K  |
|       from small pool |       0    |    6194    |   99728 K  |   99728 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      34    |      51    |      68    |      34    |
|       from large pool |      10    |      14    |      18    |       8    |
|       from small pool |      24    |      37    |      50    |      26    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2755    |   76316 K  |   76316 K  |
|       from large pool |       3    |      13    |   25322 K  |   25322 K  |
|       from small pool |       0    |    2750    |   50993 K  |   50993 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 640729 KiB |   1888 TiB |   1888 TiB |
|       from large pool |  16640 KiB | 568000 KiB |   1888 TiB |   1888 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 640729 KiB |   1888 TiB |   1888 TiB |
|       from large pool |  16640 KiB | 568000 KiB |   1888 TiB |   1888 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 632296 KiB |   1880 TiB |   1880 TiB |
|       from large pool |  16640 KiB | 560704 KiB |   1880 TiB |   1880 TiB |
|       from small pool |      0 KiB |  73944 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 284672 KiB | 755712 KiB |   1120 MiB |    842 MiB |
|       from large pool | 235520 KiB | 679936 KiB |   1020 MiB |    790 MiB |
|       from small pool |  49152 KiB |  75776 KiB |    100 MiB |     52 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  55040 KiB | 218089 KiB | 709644 GiB | 709643 GiB |
|       from large pool |  55040 KiB | 217080 KiB | 709035 GiB | 709035 GiB |
|       from small pool |      0 KiB |  19715 KiB |    608 GiB |    608 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6231    |  167407 K  |  167407 K  |
|       from large pool |       2    |      76    |   67678 K  |   67678 K  |
|       from small pool |       0    |    6194    |   99728 K  |   99728 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6231    |  167407 K  |  167407 K  |
|       from large pool |       2    |      76    |   67678 K  |   67678 K  |
|       from small pool |       0    |    6194    |   99728 K  |   99728 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      34    |      51    |      68    |      34    |
|       from large pool |      10    |      14    |      18    |       8    |
|       from small pool |      24    |      37    |      50    |      26    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2755    |   76316 K  |   76316 K  |
|       from large pool |       3    |      13    |   25322 K  |   25322 K  |
|       from small pool |       0    |    2750    |   50993 K  |   50993 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0




!!!: not committed yet



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_08_54_37_seed_2_21324354

 Experiment start at: 2024-06-15 08:54:37.803325
before training, model accuracy: 0.0544959120452404
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9658178, 'precision': 0.7486863, 'recall': 0.5438326, 'specificity': 0.5438326, 'f1': 0.5685919, 'auroc': 0.8889546, 'binary_precision': 0.52895755, 'binary_recall': 0.09054858, 'binary_specificity': 0.99711657, 'binary_f1_score': 0.15462755}
confusion matrix:
       0    1
0  42189  122
1   1376  137
---- Validation: 
scalar performance:
{'acc': 0.9678261, 'precision': 0.7249741, 'recall': 0.5200212, 'specificity': 0.5200212, 'f1': 0.5300402, 'auroc': 0.88527507, 'binary_precision': 0.48076922, 'binary_recall': 0.04152824, 'binary_specificity': 0.9985141, 'binary_f1_score': 0.076452605}
confusion matrix:
       0   1
0  18144  27
1    577  25
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96714216, 'precision': 0.98347306, 'recall': 0.5764463, 'specificity': 0.5764463, 'f1': 0.6242141, 'auroc': 0.8646127, 'binary_precision': 1.0, 'binary_recall': 0.15289256, 'binary_specificity': 1.0, 'binary_f1_score': 0.26523295}
confusion matrix:
      0   1
0  5997   0
1   205  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324354_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-15 09:13:41.567877,epoch time: 0:19:03.764552,used: 0:19:03.764552,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_08_54_37_seed_2_21324354
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96563524, 'precision': 0.7390085, 'recall': 0.6084244, 'specificity': 0.6084244, 'f1': 0.6467243, 'auroc': 0.91496015, 'binary_precision': 0.50520056, 'binary_recall': 0.2247191, 'binary_specificity': 0.9921297, 'binary_f1_score': 0.31107044}
confusion matrix:
       0    1
0  41978  333
1   1173  340
---- Validation: 
scalar performance:
{'acc': 0.9688382, 'precision': 0.75885123, 'recall': 0.5839848, 'specificity': 0.5839848, 'f1': 0.623189, 'auroc': 0.913409, 'binary_precision': 0.5445026, 'binary_recall': 0.17275748, 'binary_specificity': 0.99521214, 'binary_f1_score': 0.26229507}
confusion matrix:
       0    1
0  18084   87
1    498  104
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97259176, 'precision': 0.96112835, 'recall': 0.6546252, 'specificity': 0.6546252, 'f1': 0.72661185, 'auroc': 0.8806473, 'binary_precision': 0.9493671, 'binary_recall': 0.30991736, 'binary_specificity': 0.999333, 'binary_f1_score': 0.4672897}
confusion matrix:
      0   1
0  5993   4
1   167  75
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324354_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-15 09:33:08.745021,epoch time: 0:19:27.177144,used: 0:38:30.941696,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_08_54_37_seed_2_21324354
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9672782, 'precision': 0.76208615, 'recall': 0.64177775, 'specificity': 0.64177775, 'f1': 0.68227893, 'auroc': 0.92256093, 'binary_precision': 0.54906833, 'binary_recall': 0.29213482, 'binary_specificity': 0.9914207, 'binary_f1_score': 0.38136324}
confusion matrix:
       0    1
0  41948  363
1   1071  442
---- Validation: 
scalar performance:
{'acc': 0.9684121, 'precision': 0.74799, 'recall': 0.5829616, 'specificity': 0.5829616, 'f1': 0.62084246, 'auroc': 0.9163685, 'binary_precision': 0.52284265, 'binary_recall': 0.17109634, 'binary_specificity': 0.9948269, 'binary_f1_score': 0.25782228}
confusion matrix:
       0    1
0  18077   94
1    499  103
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97323287, 'precision': 0.9739489, 'recall': 0.65892416, 'specificity': 0.65892416, 'f1': 0.7330069, 'auroc': 0.8838815, 'binary_precision': 0.9746835, 'binary_recall': 0.3181818, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.47975078}
confusion matrix:
      0   1
0  5995   2
1   165  77
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324354_3.png
new oracle model saved
early stop counter: 1
val acc:0.9684121012687683, best validation acc: 0.9688382148742676, corresponding to test acc:                         0.972591757774353 / 0.9732328653335571
after epoch: 3,now: 2024-06-15 09:52:18.074798,epoch time: 0:19:09.329777,used: 0:57:40.271473,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_08_54_37_seed_2_21324354
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96611446, 'precision': 0.74552846, 'recall': 0.64977866, 'specificity': 0.64977866, 'f1': 0.68484944, 'auroc': 0.9265579, 'binary_precision': 0.5153846, 'binary_recall': 0.30998018, 'binary_specificity': 0.9895772, 'binary_f1_score': 0.38712338}
confusion matrix:
       0    1
0  41870  441
1   1044  469
---- Validation: 
scalar performance:
{'acc': 0.9687317, 'precision': 0.75405335, 'recall': 0.5943694, 'specificity': 0.5943694, 'f1': 0.6345174, 'auroc': 0.91675353, 'binary_precision': 0.53424656, 'binary_recall': 0.19435216, 'binary_specificity': 0.9943867, 'binary_f1_score': 0.2850183}
confusion matrix:
       0    1
0  18069  102
1    485  117
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9706684, 'precision': 0.9694735, 'recall': 0.6258663, 'specificity': 0.6258663, 'f1': 0.6924833, 'auroc': 0.8855335, 'binary_precision': 0.96825397, 'binary_recall': 0.2520661, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.39999998}
confusion matrix:
      0   1
0  5995   2
1   181  61
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324354_4.png
early stop counter: 2
val acc:0.968731701374054, best validation acc: 0.9688382148742676, corresponding to test acc:                         0.972591757774353 / 0.9732328653335571
after epoch: 4,now: 2024-06-15 10:11:03.005935,epoch time: 0:18:44.931137,used: 1:16:25.202610,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_08_54_37_seed_2_21324354
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96746075, 'precision': 0.7729989, 'recall': 0.60968846, 'specificity': 0.60968846, 'f1': 0.65342945, 'auroc': 0.9317062, 'binary_precision': 0.57310927, 'binary_recall': 0.22538003, 'binary_specificity': 0.99399686, 'binary_f1_score': 0.32352942}
confusion matrix:
       0    1
0  42057  254
1   1172  341
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.7355726, 'recall': 0.5513951, 'specificity': 0.5513951, 'f1': 0.57949543, 'auroc': 0.92621005, 'binary_precision': 0.5, 'binary_recall': 0.10631229, 'binary_specificity': 0.9964779, 'binary_f1_score': 0.17534247}
confusion matrix:
       0   1
0  18107  64
1    538  64
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9677833, 'precision': 0.9837851, 'recall': 0.5847107, 'specificity': 0.5847107, 'f1': 0.63663524, 'auroc': 0.8856174, 'binary_precision': 1.0, 'binary_recall': 0.1694215, 'binary_specificity': 1.0, 'binary_f1_score': 0.28975266}
confusion matrix:
      0   1
0  5997   0
1   201  41
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324354_5.png
early stop counter: 3
val acc:0.9679326415061951, best validation acc: 0.9688382148742676, corresponding to test acc:                         0.972591757774353 / 0.9732328653335571
after epoch: 5,now: 2024-06-15 10:29:49.190085,epoch time: 0:18:46.184150,used: 1:35:11.386760,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_08_54_37_seed_2_21324354
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9679856, 'precision': 0.76368976, 'recall': 0.70077604, 'specificity': 0.70077604, 'f1': 0.727528, 'auroc': 0.93074787, 'binary_precision': 0.54816115, 'binary_recall': 0.41374752, 'binary_specificity': 0.9878046, 'binary_f1_score': 0.4715631}
confusion matrix:
       0    1
0  41795  516
1    887  626
---- Validation: 
scalar performance:
{'acc': 0.9691046, 'precision': 0.75898236, 'recall': 0.6122291, 'specificity': 0.6122291, 'f1': 0.6541002, 'auroc': 0.9252942, 'binary_precision': 0.54296875, 'binary_recall': 0.23089701, 'binary_specificity': 0.99356115, 'binary_f1_score': 0.32400933}
confusion matrix:
       0    1
0  18054  117
1    463  139
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9695464, 'precision': 0.98464525, 'recall': 0.607438, 'specificity': 0.607438, 'f1': 0.6690736, 'auroc': 0.881311, 'binary_precision': 1.0, 'binary_recall': 0.21487603, 'binary_specificity': 1.0, 'binary_f1_score': 0.35374147}
confusion matrix:
      0   1
0  5997   0
1   190  52
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324354_6.png
better model found
persisted
after epoch: 6,now: 2024-06-15 10:48:42.515465,epoch time: 0:18:53.325380,used: 1:54:04.712140,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_08_54_37_seed_2_21324354
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96720976, 'precision': 0.75961673, 'recall': 0.65257645, 'specificity': 0.65257645, 'f1': 0.6908193, 'auroc': 0.9359164, 'binary_precision': 0.543379, 'binary_recall': 0.31460676, 'binary_specificity': 0.99054617, 'binary_f1_score': 0.39849314}
confusion matrix:
       0    1
0  41911  400
1   1037  476
---- Validation: 
scalar performance:
{'acc': 0.9698503, 'precision': 0.76741445, 'recall': 0.63991797, 'specificity': 0.63991797, 'f1': 0.6819679, 'auroc': 0.9268894, 'binary_precision': 0.5580645, 'binary_recall': 0.28737542, 'binary_specificity': 0.9924605, 'binary_f1_score': 0.379386}
confusion matrix:
       0    1
0  18034  137
1    429  173
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97195065, 'precision': 0.9718915, 'recall': 0.64239526, 'specificity': 0.64239526, 'f1': 0.7132545, 'auroc': 0.8868104, 'binary_precision': 0.97183096, 'binary_recall': 0.28512397, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.44089457}
confusion matrix:
      0   1
0  5995   2
1   173  69
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324354_7.png
better model found
persisted
after epoch: 7,now: 2024-06-15 11:07:33.152666,epoch time: 0:18:50.637201,used: 2:12:55.349341,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_08_54_37_seed_2_21324354
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9674836, 'precision': 0.76036644, 'recall': 0.67757314, 'specificity': 0.67757314, 'f1': 0.710342, 'auroc': 0.9344593, 'binary_precision': 0.54313725, 'binary_recall': 0.36615995, 'binary_specificity': 0.9889863, 'binary_f1_score': 0.43742594}
confusion matrix:
       0    1
0  41845  466
1    959  554
---- Validation: 
scalar performance:
{'acc': 0.9698503, 'precision': 0.76860696, 'recall': 0.6342966, 'specificity': 0.6342966, 'f1': 0.6771331, 'auroc': 0.93103033, 'binary_precision': 0.5608108, 'binary_recall': 0.2757475, 'binary_specificity': 0.9928457, 'binary_f1_score': 0.36971045}
confusion matrix:
       0    1
0  18041  130
1    436  166
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.969867, 'precision': 0.98480195, 'recall': 0.61157024, 'specificity': 0.61157024, 'f1': 0.6747161, 'auroc': 0.8890628, 'binary_precision': 1.0, 'binary_recall': 0.2231405, 'binary_specificity': 1.0, 'binary_f1_score': 0.36486486}
confusion matrix:
      0   1
0  5997   0
1   188  54
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324354_8.png
early stop counter: 1
val acc:0.9698503017425537, best validation acc: 0.9698503017425537, corresponding to test acc:                         0.9719506502151489 / 0.9732328653335571
after epoch: 8,now: 2024-06-15 11:26:14.690637,epoch time: 0:18:41.537971,used: 2:31:36.887312,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_08_54_37_seed_2_21324354
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9678943, 'precision': 0.7641624, 'recall': 0.6867081, 'specificity': 0.6867081, 'f1': 0.7181021, 'auroc': 0.9406074, 'binary_precision': 0.55009454, 'binary_recall': 0.38466623, 'binary_specificity': 0.98875, 'binary_f1_score': 0.4527421}
confusion matrix:
       0    1
0  41835  476
1    931  582
---- Validation: 
scalar performance:
{'acc': 0.9697438, 'precision': 0.7631583, 'recall': 0.65512085, 'specificity': 0.65512085, 'f1': 0.69391984, 'auroc': 0.93376136, 'binary_precision': 0.5485714, 'binary_recall': 0.31893688, 'binary_specificity': 0.9913048, 'binary_f1_score': 0.40336135}
confusion matrix:
       0    1
0  18013  158
1    410  192
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9729123, 'precision': 0.9797058, 'recall': 0.65280914, 'specificity': 0.65280914, 'f1': 0.72649, 'auroc': 0.88925004, 'binary_precision': 0.9866667, 'binary_recall': 0.30578512, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.46687692}
confusion matrix:
      0   1
0  5996   1
1   168  74
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324354_9.png
early stop counter: 2
val acc:0.9697437882423401, best validation acc: 0.9698503017425537, corresponding to test acc:                         0.9719506502151489 / 0.9732328653335571
after epoch: 9,now: 2024-06-15 11:45:05.627468,epoch time: 0:18:50.936831,used: 2:50:27.824143,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_08_54_37_seed_2_21324354
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9683279, 'precision': 0.77392125, 'recall': 0.66080314, 'specificity': 0.66080314, 'f1': 0.7012404, 'auroc': 0.9375899, 'binary_precision': 0.5714286, 'binary_recall': 0.33046928, 'binary_specificity': 0.991137, 'binary_f1_score': 0.41876048}
confusion matrix:
       0    1
0  41936  375
1   1013  500
---- Validation: 
scalar performance:
{'acc': 0.9707026, 'precision': 0.7849486, 'recall': 0.63393384, 'specificity': 0.63393384, 'f1': 0.6799999, 'auroc': 0.92999166, 'binary_precision': 0.5935252, 'binary_recall': 0.2740864, 'binary_specificity': 0.9937813, 'binary_f1_score': 0.37500003}
confusion matrix:
       0    1
0  18058  113
1    437  165
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97018754, 'precision': 0.98495877, 'recall': 0.6157025, 'specificity': 0.6157025, 'f1': 0.68028396, 'auroc': 0.8901696, 'binary_precision': 1.0, 'binary_recall': 0.23140496, 'binary_specificity': 1.0, 'binary_f1_score': 0.3758389}
confusion matrix:
      0   1
0  5997   0
1   186  56
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324354_10.png
better model found
persisted
after epoch: 10,now: 2024-06-15 12:03:56.441772,epoch time: 0:18:50.814304,used: 3:09:18.638447,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_08_54_37_seed_2_21324354
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96823657, 'precision': 0.7722883, 'recall': 0.66234916, 'specificity': 0.66234916, 'f1': 0.70207685, 'auroc': 0.93999517, 'binary_precision': 0.568054, 'binary_recall': 0.33377397, 'binary_specificity': 0.99092436, 'binary_f1_score': 0.42048293}
confusion matrix:
       0    1
0  41927  384
1   1008  505
---- Validation: 
scalar performance:
{'acc': 0.9701167, 'precision': 0.77654934, 'recall': 0.6239946, 'specificity': 0.6239946, 'f1': 0.6688232, 'auroc': 0.93341446, 'binary_precision': 0.5773585, 'binary_recall': 0.25415283, 'binary_specificity': 0.99383634, 'binary_f1_score': 0.3529412}
confusion matrix:
       0    1
0  18059  112
1    449  153
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9693861, 'precision': 0.9845669, 'recall': 0.6053719, 'specificity': 0.6053719, 'f1': 0.6662239, 'auroc': 0.8854349, 'binary_precision': 1.0, 'binary_recall': 0.2107438, 'binary_specificity': 1.0, 'binary_f1_score': 0.34812286}
confusion matrix:
      0   1
0  5997   0
1   191  51
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324354_11.png
early stop counter: 1
val acc:0.9701166749000549, best validation acc: 0.970702588558197, corresponding to test acc:                         0.9701875448226929 / 0.9732328653335571
after epoch: 11,now: 2024-06-15 12:23:01.319868,epoch time: 0:19:04.878096,used: 3:28:23.516543,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_08_54_37_seed_2_21324354
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9676661, 'precision': 0.75978744, 'recall': 0.7085769, 'specificity': 0.7085769, 'f1': 0.731084, 'auroc': 0.93857855, 'binary_precision': 0.539801, 'binary_recall': 0.430271, 'binary_specificity': 0.98688287, 'binary_f1_score': 0.4788525}
confusion matrix:
       0    1
0  41756  555
1    862  651
---- Validation: 
scalar performance:
{'acc': 0.9694242, 'precision': 0.75621223, 'recall': 0.68306243, 'specificity': 0.68306243, 'f1': 0.712958, 'auroc': 0.9360442, 'binary_precision': 0.53286386, 'binary_recall': 0.37707642, 'binary_specificity': 0.9890485, 'binary_f1_score': 0.44163424}
confusion matrix:
       0    1
0  17972  199
1    375  227
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9741946, 'precision': 0.9753169, 'recall': 0.67132086, 'specificity': 0.67132086, 'f1': 0.7471976, 'auroc': 0.8912077, 'binary_precision': 0.9764706, 'binary_recall': 0.3429752, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.50764525}
confusion matrix:
      0   1
0  5995   2
1   159  83
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324354_12.png
new oracle model saved
early stop counter: 2
val acc:0.9694241881370544, best validation acc: 0.970702588558197, corresponding to test acc:                         0.9701875448226929 / 0.9741945862770081
after epoch: 12,now: 2024-06-15 12:41:47.867996,epoch time: 0:18:46.548128,used: 3:47:10.064671,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_08_54_37_seed_2_21324354
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.96894395, 'precision': 0.77271503, 'recall': 0.71083194, 'specificity': 0.71083194, 'f1': 0.7374089, 'auroc': 0.93793833, 'binary_precision': 0.56551725, 'binary_recall': 0.4335757, 'binary_specificity': 0.9880882, 'binary_f1_score': 0.49083427}
confusion matrix:
       0    1
0  41807  504
1    857  656
---- Validation: 
scalar performance:
{'acc': 0.9717147, 'precision': 0.7946152, 'recall': 0.6585481, 'specificity': 0.6585481, 'f1': 0.70447725, 'auroc': 0.9340607, 'binary_precision': 0.61128527, 'binary_recall': 0.32392028, 'binary_specificity': 0.9931759, 'binary_f1_score': 0.4234528}
confusion matrix:
       0    1
0  18047  124
1    407  195
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.968745, 'precision': 0.9842539, 'recall': 0.5971074, 'specificity': 0.5971074, 'f1': 0.6546308, 'auroc': 0.8865994, 'binary_precision': 1.0, 'binary_recall': 0.19421488, 'binary_specificity': 1.0, 'binary_f1_score': 0.32525954}
confusion matrix:
      0   1
0  5997   0
1   195  47
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324354_13.png
better model found
persisted
after epoch: 13,now: 2024-06-15 13:00:35.695756,epoch time: 0:18:47.827760,used: 4:05:57.892431,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_08_54_37_seed_2_21324354
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96880704, 'precision': 0.7697354, 'recall': 0.72318846, 'specificity': 0.72318846, 'f1': 0.7440341, 'auroc': 0.94073, 'binary_precision': 0.55868167, 'binary_recall': 0.45935228, 'binary_specificity': 0.98702466, 'binary_f1_score': 0.5041712}
confusion matrix:
       0    1
0  41762  549
1    818  695
---- Validation: 
scalar performance:
{'acc': 0.9707026, 'precision': 0.77868307, 'recall': 0.653207, 'specificity': 0.653207, 'f1': 0.6961538, 'auroc': 0.93617463, 'binary_precision': 0.5797546, 'binary_recall': 0.3139535, 'binary_specificity': 0.9924605, 'binary_f1_score': 0.40732756}
confusion matrix:
       0    1
0  18034  137
1    413  189
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9695464, 'precision': 0.98464525, 'recall': 0.607438, 'specificity': 0.607438, 'f1': 0.6690736, 'auroc': 0.88916135, 'binary_precision': 1.0, 'binary_recall': 0.21487603, 'binary_specificity': 1.0, 'binary_f1_score': 0.35374147}
confusion matrix:
      0   1
0  5997   0
1   190  52
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324354_14.png
early stop counter: 1
val acc:0.970702588558197, best validation acc: 0.9717146754264832, corresponding to test acc:                         0.9687449932098389 / 0.9741945862770081
after epoch: 14,now: 2024-06-15 13:19:32.675092,epoch time: 0:18:56.979336,used: 4:24:54.871767,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_08_54_37_seed_2_21324354
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.96928626, 'precision': 0.7857778, 'recall': 0.66926575, 'specificity': 0.66926575, 'f1': 0.711221, 'auroc': 0.9385108, 'binary_precision': 0.59456396, 'binary_recall': 0.34699273, 'binary_specificity': 0.9915388, 'binary_f1_score': 0.4382304}
confusion matrix:
       0    1
0  41953  358
1    988  525
---- Validation: 
scalar performance:
{'acc': 0.9702765, 'precision': 0.77713645, 'recall': 0.6321076, 'specificity': 0.6321076, 'f1': 0.6767791, 'auroc': 0.93648124, 'binary_precision': 0.5780142, 'binary_recall': 0.2707641, 'binary_specificity': 0.9934511, 'binary_f1_score': 0.36877826}
confusion matrix:
       0    1
0  18052  119
1    439  163
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9706684, 'precision': 0.9770736, 'recall': 0.62388355, 'specificity': 0.62388355, 'f1': 0.69050443, 'auroc': 0.8904025, 'binary_precision': 0.9836066, 'binary_recall': 0.24793388, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.3960396}
confusion matrix:
      0   1
0  5996   1
1   182  60
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324354_15.png
early stop counter: 2
val acc:0.9702764749526978, best validation acc: 0.9717146754264832, corresponding to test acc:                         0.9687449932098389 / 0.9741945862770081
after epoch: 15,now: 2024-06-15 13:38:15.762138,epoch time: 0:18:43.087046,used: 4:43:37.958813,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_08_54_37_seed_2_21324354
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.96848756, 'precision': 0.7645921, 'recall': 0.7481965, 'specificity': 0.7481965, 'f1': 0.7561035, 'auroc': 0.94131327, 'binary_precision': 0.5466102, 'binary_recall': 0.5115664, 'binary_specificity': 0.9848266, 'binary_f1_score': 0.52850807}
confusion matrix:
       0    1
0  41669  642
1    739  774
---- Validation: 
scalar performance:
{'acc': 0.9689448, 'precision': 0.75025356, 'recall': 0.70128495, 'specificity': 0.70128495, 'f1': 0.72284585, 'auroc': 0.9338844, 'binary_precision': 0.51975054, 'binary_recall': 0.4152824, 'binary_specificity': 0.98728746, 'binary_f1_score': 0.4616805}
confusion matrix:
       0    1
0  17940  231
1    352  250
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9722712, 'precision': 0.94940335, 'recall': 0.6544584, 'specificity': 0.6544584, 'f1': 0.72508174, 'auroc': 0.8905685, 'binary_precision': 0.9259259, 'binary_recall': 0.30991736, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.46439627}
confusion matrix:
      0   1
0  5991   6
1   167  75
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324354_16.png
early stop counter: 3
val acc:0.968944787979126, best validation acc: 0.9717146754264832, corresponding to test acc:                         0.9687449932098389 / 0.9741945862770081
after epoch: 16,now: 2024-06-15 13:57:01.270281,epoch time: 0:18:45.508143,used: 5:02:23.466956,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_08_54_37_seed_2_21324354
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.96914935, 'precision': 0.7735771, 'recall': 0.7201792, 'specificity': 0.7201792, 'f1': 0.74369335, 'auroc': 0.9452019, 'binary_precision': 0.56658393, 'binary_recall': 0.4527429, 'binary_specificity': 0.9876155, 'binary_f1_score': 0.5033064}
confusion matrix:
       0    1
0  41787  524
1    828  685
---- Validation: 
scalar performance:
{'acc': 0.971182, 'precision': 0.7791261, 'recall': 0.68156135, 'specificity': 0.68156135, 'f1': 0.719092, 'auroc': 0.93564177, 'binary_precision': 0.57881135, 'binary_recall': 0.37209302, 'binary_specificity': 0.9910297, 'binary_f1_score': 0.4529828}
confusion matrix:
       0    1
0  18008  163
1    378  224
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9729123, 'precision': 0.9734622, 'recall': 0.65479195, 'specificity': 0.65479195, 'f1': 0.72816014, 'auroc': 0.8905103, 'binary_precision': 0.97402596, 'binary_recall': 0.30991736, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.47021943}
confusion matrix:
      0   1
0  5995   2
1   167  75
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324354_17.png
early stop counter: 4
val acc:0.9711819887161255, best validation acc: 0.9717146754264832, corresponding to test acc:                         0.9687449932098389 / 0.9741945862770081
after epoch: 17,now: 2024-06-15 14:15:42.363884,epoch time: 0:18:41.093603,used: 5:21:04.560559,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_08_54_37_seed_2_21324354
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9703359, 'precision': 0.7851989, 'recall': 0.7262108, 'specificity': 0.7262108, 'f1': 0.75196326, 'auroc': 0.93818736, 'binary_precision': 0.5894207, 'binary_recall': 0.46397886, 'binary_specificity': 0.9884427, 'binary_f1_score': 0.5192308}
confusion matrix:
       0    1
0  41822  489
1    811  702
---- Validation: 
scalar performance:
{'acc': 0.9705428, 'precision': 0.7714895, 'recall': 0.6748068, 'specificity': 0.6748068, 'f1': 0.71172667, 'auroc': 0.9371399, 'binary_precision': 0.56396866, 'binary_recall': 0.358804, 'binary_specificity': 0.99080956, 'binary_f1_score': 0.4385787}
confusion matrix:
       0    1
0  18004  167
1    386  216
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9713095, 'precision': 0.9778924, 'recall': 0.632148, 'specificity': 0.632148, 'f1': 0.70111555, 'auroc': 0.8920929, 'binary_precision': 0.9846154, 'binary_recall': 0.2644628, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.4169381}
confusion matrix:
      0   1
0  5996   1
1   178  64
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324354_18.png
early stop counter: 5
val acc:0.9705427885055542, best validation acc: 0.9717146754264832, corresponding to test acc:                         0.9687449932098389 / 0.9741945862770081
after epoch: 18,now: 2024-06-15 14:34:18.074234,epoch time: 0:18:35.710350,used: 5:39:40.270909,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_08_54_37_seed_2_21324354
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9692178, 'precision': 0.77110875, 'recall': 0.74666274, 'specificity': 0.74666274, 'f1': 0.758247, 'auroc': 0.9483042, 'binary_precision': 0.55976677, 'binary_recall': 0.5076008, 'binary_specificity': 0.98572475, 'binary_f1_score': 0.532409}
confusion matrix:
       0    1
0  41707  604
1    745  768
---- Validation: 
scalar performance:
{'acc': 0.9700634, 'precision': 0.7633345, 'recall': 0.689014, 'specificity': 0.689014, 'f1': 0.7194892, 'auroc': 0.93926084, 'binary_precision': 0.54672897, 'binary_recall': 0.38870433, 'binary_specificity': 0.9893237, 'binary_f1_score': 0.45436895}
confusion matrix:
       0    1
0  17977  194
1    368  234
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9706684, 'precision': 0.9770736, 'recall': 0.62388355, 'specificity': 0.62388355, 'f1': 0.69050443, 'auroc': 0.8916459, 'binary_precision': 0.9836066, 'binary_recall': 0.24793388, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.3960396}
confusion matrix:
      0   1
0  5996   1
1   182  60
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324354_19.png
early stop counter: 6
val acc:0.9700633883476257, best validation acc: 0.9717146754264832, corresponding to test acc:                         0.9687449932098389 / 0.9741945862770081
after epoch: 19,now: 2024-06-15 14:52:52.523623,epoch time: 0:18:34.449389,used: 5:58:14.720298,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_08_54_37_seed_2_21324354
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9698795, 'precision': 0.7882002, 'recall': 0.6899668, 'specificity': 0.6899668, 'f1': 0.7280376, 'auroc': 0.9453666, 'binary_precision': 0.59796953, 'binary_recall': 0.3892928, 'binary_specificity': 0.99064076, 'binary_f1_score': 0.47157726}
confusion matrix:
       0    1
0  41915  396
1    924  589
---- Validation: 
scalar performance:
{'acc': 0.9705428, 'precision': 0.7848616, 'recall': 0.6258208, 'specificity': 0.6258208, 'f1': 0.6720685, 'auroc': 0.93607986, 'binary_precision': 0.59386975, 'binary_recall': 0.25747508, 'binary_specificity': 0.99416655, 'binary_f1_score': 0.35921204}
confusion matrix:
       0    1
0  18065  106
1    447  155
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9679436, 'precision': 0.9838631, 'recall': 0.58677685, 'specificity': 0.58677685, 'f1': 0.6396866, 'auroc': 0.88410133, 'binary_precision': 1.0, 'binary_recall': 0.17355372, 'binary_specificity': 1.0, 'binary_f1_score': 0.29577464}
confusion matrix:
      0   1
0  5997   0
1   200  42
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324354_20.png
early stop counter: 7
val acc:0.9705427885055542, best validation acc: 0.9717146754264832, corresponding to test acc:                         0.9687449932098389 / 0.9741945862770081
after epoch: 20,now: 2024-06-15 15:11:22.338867,epoch time: 0:18:29.815244,used: 6:16:44.535542,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_08_54_37_seed_2_21324354
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9685104, 'precision': 0.76541096, 'recall': 0.7396048, 'specificity': 0.7396048, 'f1': 0.7517772, 'auroc': 0.9378802, 'binary_precision': 0.54886115, 'binary_recall': 0.4937211, 'binary_specificity': 0.9854884, 'binary_f1_score': 0.51983297}
confusion matrix:
       0    1
0  41697  614
1    766  747
---- Validation: 
scalar performance:
{'acc': 0.9703297, 'precision': 0.7667701, 'recall': 0.6875455, 'specificity': 0.6875455, 'f1': 0.7196033, 'auroc': 0.9351472, 'binary_precision': 0.55369925, 'binary_recall': 0.38538206, 'binary_specificity': 0.9897089, 'binary_f1_score': 0.45445642}
confusion matrix:
       0    1
0  17984  187
1    370  232
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96970665, 'precision': 0.9673316, 'recall': 0.6134696, 'specificity': 0.6134696, 'f1': 0.6761873, 'auroc': 0.8873722, 'binary_precision': 0.9649123, 'binary_recall': 0.22727273, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.36789298}
confusion matrix:
      0   1
0  5995   2
1   187  55
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324354_21.png
early stop counter: 8
val acc:0.9703297019004822, best validation acc: 0.9717146754264832, corresponding to test acc:                         0.9687449932098389 / 0.9741945862770081
after epoch: 21,now: 2024-06-15 15:29:51.488820,epoch time: 0:18:29.149953,used: 6:35:13.685495,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_08_54_37_seed_2_21324354
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.96958286, 'precision': 0.7843817, 'recall': 0.6894945, 'specificity': 0.6894945, 'f1': 0.7265279, 'auroc': 0.94555116, 'binary_precision': 0.5903614, 'binary_recall': 0.38863185, 'binary_specificity': 0.9903571, 'binary_f1_score': 0.46871263}
confusion matrix:
       0    1
0  41903  408
1    925  588
---- Validation: 
scalar performance:
{'acc': 0.9713951, 'precision': 0.79741395, 'recall': 0.6383068, 'specificity': 0.6383068, 'f1': 0.6865204, 'auroc': 0.9369141, 'binary_precision': 0.6181818, 'binary_recall': 0.28239202, 'binary_specificity': 0.99422157, 'binary_f1_score': 0.3876853}
confusion matrix:
       0    1
0  18066  105
1    432  170
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9644174, 'precision': 0.9821515, 'recall': 0.5413223, 'specificity': 0.5413223, 'f1': 0.5672494, 'auroc': 0.8798983, 'binary_precision': 1.0, 'binary_recall': 0.08264463, 'binary_specificity': 1.0, 'binary_f1_score': 0.15267175}
confusion matrix:
      0   1
0  5997   0
1   222  20
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324354_22.png
early stop counter: 9
val acc:0.9713950753211975, best validation acc: 0.9717146754264832, corresponding to test acc:                         0.9687449932098389 / 0.9741945862770081
after epoch: 22,now: 2024-06-15 15:48:23.016796,epoch time: 0:18:31.527976,used: 6:53:45.213471,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_08_54_37_seed_2_21324354
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9691721, 'precision': 0.7705448, 'recall': 0.74823236, 'specificity': 0.74823236, 'f1': 0.7588573, 'auroc': 0.9472425, 'binary_precision': 0.55852604, 'binary_recall': 0.5109055, 'binary_specificity': 0.9855593, 'binary_f1_score': 0.5336555}
confusion matrix:
       0    1
0  41700  611
1    740  773
---- Validation: 
scalar performance:
{'acc': 0.9697438, 'precision': 0.76181656, 'recall': 0.6655605, 'specificity': 0.6655605, 'f1': 0.70184505, 'auroc': 0.93776417, 'binary_precision': 0.54521275, 'binary_recall': 0.34053156, 'binary_specificity': 0.9905894, 'binary_f1_score': 0.4192229}
confusion matrix:
       0    1
0  18000  171
1    397  205
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9668216, 'precision': 0.95782673, 'recall': 0.5762795, 'specificity': 0.5762795, 'f1': 0.6231869, 'auroc': 0.8865123, 'binary_precision': 0.94871795, 'binary_recall': 0.15289256, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.26334518}
confusion matrix:
      0   1
0  5995   2
1   205  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324354_23.png
early stop counter: 10
val acc:0.9697437882423401, best validation acc: 0.9717146754264832, corresponding to test acc:                         0.9687449932098389 / 0.9741945862770081
after epoch: 23,now: 2024-06-15 16:07:42.089376,epoch time: 0:19:19.072580,used: 7:13:04.286051,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_08_54_37_seed_2_21324354
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.96930903, 'precision': 0.7807933, 'recall': 0.68967134, 'specificity': 0.68967134, 'f1': 0.72555214, 'auroc': 0.94317806, 'binary_precision': 0.5831683, 'binary_recall': 0.3892928, 'binary_specificity': 0.9900499, 'binary_f1_score': 0.4669045}
confusion matrix:
       0    1
0  41890  421
1    924  589
---- Validation: 
scalar performance:
{'acc': 0.97224736, 'precision': 0.81321096, 'recall': 0.64356536, 'specificity': 0.64356536, 'f1': 0.6945003, 'auroc': 0.93649846, 'binary_precision': 0.6494465, 'binary_recall': 0.29235882, 'binary_specificity': 0.9947719, 'binary_f1_score': 0.40320733}
confusion matrix:
       0    1
0  18076   95
1    426  176
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9640968, 'precision': 0.9819965, 'recall': 0.5371901, 'specificity': 0.5371901, 'f1': 0.56006396, 'auroc': 0.8806082, 'binary_precision': 1.0, 'binary_recall': 0.07438017, 'binary_specificity': 1.0, 'binary_f1_score': 0.13846155}
confusion matrix:
      0   1
0  5997   0
1   224  18
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324354_24.png
better model found
persisted
after epoch: 24,now: 2024-06-15 16:26:28.626515,epoch time: 0:18:46.537139,used: 7:31:50.823190,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_08_54_37_seed_2_21324354
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9695601, 'precision': 0.7761272, 'recall': 0.7318634, 'specificity': 0.7318634, 'f1': 0.7518673, 'auroc': 0.9459319, 'binary_precision': 0.570863, 'binary_recall': 0.4765367, 'binary_specificity': 0.98719007, 'binary_f1_score': 0.51945245}
confusion matrix:
       0    1
0  41769  542
1    792  721
---- Validation: 
scalar performance:
{'acc': 0.9705428, 'precision': 0.7704155, 'recall': 0.68123114, 'specificity': 0.68123114, 'f1': 0.71621025, 'auroc': 0.93944275, 'binary_precision': 0.5614035, 'binary_recall': 0.37209302, 'binary_specificity': 0.99036926, 'binary_f1_score': 0.44755244}
confusion matrix:
       0    1
0  17996  175
1    378  224
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9669819, 'precision': 0.9585457, 'recall': 0.57834566, 'specificity': 0.57834566, 'f1': 0.62630635, 'auroc': 0.8864124, 'binary_precision': 0.95, 'binary_recall': 0.1570248, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.26950356}
confusion matrix:
      0   1
0  5995   2
1   204  38
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324354_25.png
early stop counter: 1
val acc:0.9705427885055542, best validation acc: 0.9722473621368408, corresponding to test acc:                         0.9640967845916748 / 0.9741945862770081
after epoch: 25,now: 2024-06-15 16:45:26.659001,epoch time: 0:18:58.032486,used: 7:50:48.855676,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_08_54_37_seed_2_21324354
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9696057, 'precision': 0.77658033, 'recall': 0.731887, 'specificity': 0.731887, 'f1': 0.75206655, 'auroc': 0.9435272, 'binary_precision': 0.57176846, 'binary_recall': 0.4765367, 'binary_specificity': 0.98723733, 'binary_f1_score': 0.519827}
confusion matrix:
       0    1
0  41771  540
1    792  721
---- Validation: 
scalar performance:
{'acc': 0.9702765, 'precision': 0.7661104, 'recall': 0.68751794, 'specificity': 0.68751794, 'f1': 0.719367, 'auroc': 0.9403734, 'binary_precision': 0.552381, 'binary_recall': 0.38538206, 'binary_specificity': 0.9896538, 'binary_f1_score': 0.45401177}
confusion matrix:
       0    1
0  17983  188
1    370  232
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9705081, 'precision': 0.9768585, 'recall': 0.62181747, 'specificity': 0.62181747, 'f1': 0.68780845, 'auroc': 0.8901638, 'binary_precision': 0.98333335, 'binary_recall': 0.24380165, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.3907285}
confusion matrix:
      0   1
0  5996   1
1   183  59
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324354_26.png
early stop counter: 2
val acc:0.9702764749526978, best validation acc: 0.9722473621368408, corresponding to test acc:                         0.9640967845916748 / 0.9741945862770081
after epoch: 26,now: 2024-06-15 17:04:25.500798,epoch time: 0:18:58.841797,used: 8:09:47.697473,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_08_54_37_seed_2_21324354
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9698339, 'precision': 0.77782, 'recall': 0.7390155, 'specificity': 0.7390155, 'f1': 0.75681, 'auroc': 0.94360614, 'binary_precision': 0.5737452, 'binary_recall': 0.49107733, 'binary_specificity': 0.98695374, 'binary_f1_score': 0.5292023}
confusion matrix:
       0    1
0  41759  552
1    770  743
---- Validation: 
scalar performance:
{'acc': 0.9710222, 'precision': 0.77706385, 'recall': 0.68067575, 'specificity': 0.68067575, 'f1': 0.71781194, 'auroc': 0.93519187, 'binary_precision': 0.57474226, 'binary_recall': 0.3704319, 'binary_specificity': 0.9909196, 'binary_f1_score': 0.45050508}
confusion matrix:
       0    1
0  18006  165
1    379  223
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96890527, 'precision': 0.9744078, 'recall': 0.6011563, 'specificity': 0.6011563, 'f1': 0.6598482, 'auroc': 0.88317436, 'binary_precision': 0.98, 'binary_recall': 0.20247933, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.3356164}
confusion matrix:
      0   1
0  5996   1
1   193  49
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324354_27.png
early stop counter: 3
val acc:0.9710221886634827, best validation acc: 0.9722473621368408, corresponding to test acc:                         0.9640967845916748 / 0.9741945862770081
after epoch: 27,now: 2024-06-15 17:23:36.399466,epoch time: 0:19:10.898668,used: 8:28:58.596141,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_08_54_37_seed_2_21324354
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.96940035, 'precision': 0.7748076, 'recall': 0.72986877, 'specificity': 0.72986877, 'f1': 0.75012994, 'auroc': 0.94553554, 'binary_precision': 0.5683625, 'binary_recall': 0.47257105, 'binary_specificity': 0.98716646, 'binary_f1_score': 0.51605916}
confusion matrix:
       0    1
0  41768  543
1    798  715
---- Validation: 
scalar performance:
{'acc': 0.9708624, 'precision': 0.7763198, 'recall': 0.6733658, 'specificity': 0.6733658, 'f1': 0.7120086, 'auroc': 0.9380338, 'binary_precision': 0.57372653, 'binary_recall': 0.3554817, 'binary_specificity': 0.9912498, 'binary_f1_score': 0.43897432}
confusion matrix:
       0    1
0  18012  159
1    388  214
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96890527, 'precision': 0.9567816, 'recall': 0.6051218, 'specificity': 0.6051218, 'f1': 0.6643347, 'auroc': 0.88945055, 'binary_precision': 0.9444444, 'binary_recall': 0.2107438, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.3445946}
confusion matrix:
      0   1
0  5994   3
1   191  51
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324354_28.png
early stop counter: 4
val acc:0.9708623886108398, best validation acc: 0.9722473621368408, corresponding to test acc:                         0.9640967845916748 / 0.9741945862770081
after epoch: 28,now: 2024-06-15 17:42:27.236402,epoch time: 0:18:50.836936,used: 8:47:49.433077,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_08_54_37_seed_2_21324354
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.97081506, 'precision': 0.78934276, 'recall': 0.73155737, 'specificity': 0.73155737, 'f1': 0.75692725, 'auroc': 0.9479387, 'binary_precision': 0.5973378, 'binary_recall': 0.47455385, 'binary_specificity': 0.9885609, 'binary_f1_score': 0.5289134}
confusion matrix:
       0    1
0  41827  484
1    795  718
---- Validation: 
scalar performance:
{'acc': 0.97192776, 'precision': 0.7978042, 'recall': 0.66026425, 'specificity': 0.66026425, 'f1': 0.7067034, 'auroc': 0.9409347, 'binary_precision': 0.61755484, 'binary_recall': 0.32724252, 'binary_specificity': 0.993286, 'binary_f1_score': 0.42779586}
confusion matrix:
       0    1
0  18049  122
1    405  197
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9668216, 'precision': 0.9698789, 'recall': 0.5742968, 'specificity': 0.5742968, 'f1': 0.62054795, 'auroc': 0.8849657, 'binary_precision': 0.972973, 'binary_recall': 0.14876033, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.25806454}
confusion matrix:
      0   1
0  5996   1
1   206  36
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324354_29.png
early stop counter: 5
val acc:0.9719277620315552, best validation acc: 0.9722473621368408, corresponding to test acc:                         0.9640967845916748 / 0.9741945862770081
after epoch: 29,now: 2024-06-15 18:01:08.781913,epoch time: 0:18:41.545511,used: 9:06:30.978588,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_08_54_37_seed_2_21324354
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9697654, 'precision': 0.7849916, 'recall': 0.69659936, 'specificity': 0.69659936, 'f1': 0.73190093, 'auroc': 0.9446173, 'binary_precision': 0.59108526, 'binary_recall': 0.4031725, 'binary_specificity': 0.99002624, 'binary_f1_score': 0.47937128}
confusion matrix:
       0    1
0  41889  422
1    903  610
---- Validation: 
scalar performance:
{'acc': 0.9709157, 'precision': 0.78043556, 'recall': 0.65974146, 'specificity': 0.65974146, 'f1': 0.70211667, 'auroc': 0.9408883, 'binary_precision': 0.58284026, 'binary_recall': 0.32724252, 'binary_specificity': 0.99224037, 'binary_f1_score': 0.41914895}
confusion matrix:
       0    1
0  18030  141
1    405  197
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9692258, 'precision': 0.974949, 'recall': 0.6052885, 'specificity': 0.6052885, 'f1': 0.66559017, 'auroc': 0.8926052, 'binary_precision': 0.9807692, 'binary_recall': 0.2107438, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.34693876}
confusion matrix:
      0   1
0  5996   1
1   191  51
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324354_30.png
early stop counter: 6
val acc:0.970915675163269, best validation acc: 0.9722473621368408, corresponding to test acc:                         0.9640967845916748 / 0.9741945862770081
after epoch: 30,now: 2024-06-15 18:20:01.607454,epoch time: 0:18:52.825541,used: 9:25:23.804129,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_08_54_37_seed_2_21324354
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 9:25:23.804129 at 2024-06-15 18:20:01.607454
persisted model performance metric: 

scalar performance:
{'acc': 0.9640968, 'precision': 0.9819965, 'recall': 0.5371901, 'specificity': 0.5371901, 'f1': 0.56006396, 'auroc': 0.8806082, 'binary_precision': 1.0, 'binary_recall': 0.07438017, 'binary_specificity': 1.0, 'binary_f1_score': 0.13846155}
confusion matrix:
      0   1
0  5997   0
1   224  18
oracle model performance metric: 

scalar performance:
{'acc': 0.9741946, 'precision': 0.9753169, 'recall': 0.67132086, 'specificity': 0.67132086, 'f1': 0.7471976, 'auroc': 0.8912077, 'binary_precision': 0.9764706, 'binary_recall': 0.3429752, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.50764525}
confusion matrix:
      0   1
0  5995   2
1   159  83
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_bs16_different_learningrates/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_resnet_bs16_different_learningrates/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204077 KiB | 640729 KiB |   2834 TiB |   2834 TiB |
|       from large pool | 167040 KiB | 568000 KiB |   2833 TiB |   2833 TiB |
|       from small pool |  37037 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 204077 KiB | 640729 KiB |   2834 TiB |   2834 TiB |
|       from large pool | 167040 KiB | 568000 KiB |   2833 TiB |   2833 TiB |
|       from small pool |  37037 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201087 KiB | 632296 KiB |   2820 TiB |   2820 TiB |
|       from large pool | 165120 KiB | 560704 KiB |   2820 TiB |   2820 TiB |
|       from small pool |  35967 KiB |  73944 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 675840 KiB | 755712 KiB |   1502 MiB |    842 MiB |
|       from large pool | 600064 KiB | 679936 KiB |   1376 MiB |    790 MiB |
|       from small pool |  75776 KiB |  75776 KiB |    126 MiB |     52 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  80594 KiB | 218089 KiB |   1014 TiB |   1014 TiB |
|       from large pool |  68480 KiB | 217080 KiB |   1013 TiB |   1013 TiB |
|       from small pool |  12114 KiB |  19715 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3240    |    6231    |  251114 K  |  251111 K  |
|       from large pool |      36    |      76    |  101521 K  |  101521 K  |
|       from small pool |    3204    |    6194    |  149593 K  |  149590 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3240    |    6231    |  251114 K  |  251111 K  |
|       from large pool |      36    |      76    |  101521 K  |  101521 K  |
|       from small pool |    3204    |    6194    |  149593 K  |  149590 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      51    |      51    |      85    |      34    |
|       from large pool |      14    |      14    |      22    |       8    |
|       from small pool |      37    |      37    |      63    |      26    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      37    |    2755    |  115118 K  |  115118 K  |
|       from large pool |       5    |      13    |   38544 K  |   38544 K  |
|       from small pool |      32    |    2750    |   76574 K  |   76574 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 640729 KiB |   2834 TiB |   2834 TiB |
|       from large pool |  16640 KiB | 568000 KiB |   2833 TiB |   2833 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 640729 KiB |   2834 TiB |   2834 TiB |
|       from large pool |  16640 KiB | 568000 KiB |   2833 TiB |   2833 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 632296 KiB |   2820 TiB |   2820 TiB |
|       from large pool |  16640 KiB | 560704 KiB |   2820 TiB |   2820 TiB |
|       from small pool |      0 KiB |  73944 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 284672 KiB | 755712 KiB |   1502 MiB |   1224 MiB |
|       from large pool | 235520 KiB | 679936 KiB |   1376 MiB |   1146 MiB |
|       from small pool |  49152 KiB |  75776 KiB |    126 MiB |     78 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  55040 KiB | 218089 KiB |   1014 TiB |   1014 TiB |
|       from large pool |  55040 KiB | 217080 KiB |   1013 TiB |   1013 TiB |
|       from small pool |      0 KiB |  19715 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6231    |  251114 K  |  251114 K  |
|       from large pool |       2    |      76    |  101521 K  |  101521 K  |
|       from small pool |       0    |    6194    |  149593 K  |  149593 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6231    |  251114 K  |  251114 K  |
|       from large pool |       2    |      76    |  101521 K  |  101521 K  |
|       from small pool |       0    |    6194    |  149593 K  |  149593 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      34    |      51    |      85    |      51    |
|       from large pool |      10    |      14    |      22    |      12    |
|       from small pool |      24    |      37    |      63    |      39    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2755    |  115120 K  |  115120 K  |
|       from large pool |       3    |      13    |   38544 K  |   38544 K  |
|       from small pool |       0    |    2750    |   76575 K  |   76575 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

