Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0




!!!: not committed yet



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316517

 Experiment start at: 2024-06-13 16:52:51.581367
before training, model accuracy: 0.7297859191894531
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96629524, 'precision': 0.6878331, 'recall': 0.50290346, 'specificity': 0.50290346, 'f1': 0.49745166, 'auroc': 0.8845788, 'binary_precision': 0.4090909, 'binary_recall': 0.0061141304, 'binary_specificity': 0.9996928, 'binary_f1_score': 0.012048192}
confusion matrix:
       0   1
0  42307  13
1   1463   9
---- Validation: 
scalar performance:
{'acc': 0.9656769, 'precision': 0.7295815, 'recall': 0.5396978, 'specificity': 0.5396978, 'f1': 0.5618169, 'auroc': 0.88146144, 'binary_precision': 0.49074075, 'binary_recall': 0.08242613, 'binary_specificity': 0.9969695, 'binary_f1_score': 0.14114515}
confusion matrix:
       0   1
0  18094  55
1    590  53
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.72973406, 'recall': 0.5146587, 'specificity': 0.5146587, 'f1': 0.5182182, 'auroc': 0.8821633, 'binary_precision': 0.5, 'binary_recall': 0.03065134, 'binary_specificity': 0.998666, 'binary_f1_score': 0.057761732}
confusion matrix:
      0  1
0  5989  8
1   253  8
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316517_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-13 17:14:22.988219,epoch time: 0:21:31.406852,used: 0:21:31.406852,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316517
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9667976, 'precision': 0.75657505, 'recall': 0.53432226, 'specificity': 0.53432226, 'f1': 0.55411404, 'auroc': 0.8993839, 'binary_precision': 0.5445026, 'binary_recall': 0.070700206, 'binary_specificity': 0.9979443, 'binary_f1_score': 0.12515041}
confusion matrix:
       0    1
0  42234   87
1   1367  104
---- Validation: 
scalar performance:
{'acc': 0.96376115, 'precision': 0.7182462, 'recall': 0.6617151, 'specificity': 0.6617151, 'f1': 0.6852822, 'auroc': 0.89990884, 'binary_precision': 0.45974576, 'binary_recall': 0.33748055, 'binary_specificity': 0.98594964, 'binary_f1_score': 0.38923767}
confusion matrix:
       0    1
0  17894  255
1    426  217
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9699584, 'precision': 0.8924672, 'recall': 0.6801581, 'specificity': 0.6801581, 'f1': 0.7435785, 'auroc': 0.9026339, 'binary_precision': 0.8119658, 'binary_recall': 0.36398467, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.5026455}
confusion matrix:
      0   1
0  5975  22
1   166  95
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316517_2.png
new oracle model saved
early stop counter: 1
val acc:0.9637611508369446, best validation acc: 0.9656769037246704, corresponding to test acc:                         0.9582933783531189 / 0.9699584245681763
after epoch: 2,now: 2024-06-13 17:33:20.990618,epoch time: 0:18:58.002399,used: 0:40:29.409251,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316517
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96650076, 'precision': 0.73841375, 'recall': 0.5767781, 'specificity': 0.5767781, 'f1': 0.6123662, 'auroc': 0.91045487, 'binary_precision': 0.5053996, 'binary_recall': 0.15896739, 'binary_specificity': 0.99458885, 'binary_f1_score': 0.24186048}
confusion matrix:
       0    1
0  42091  229
1   1238  234
---- Validation: 
scalar performance:
{'acc': 0.9633887, 'precision': 0.7172144, 'recall': 0.6765233, 'specificity': 0.6765233, 'f1': 0.69451386, 'auroc': 0.9076012, 'binary_precision': 0.4566474, 'binary_recall': 0.36858475, 'binary_specificity': 0.98446196, 'binary_f1_score': 0.40791738}
confusion matrix:
       0    1
0  17867  282
1    406  237
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97315437, 'precision': 0.89259315, 'recall': 0.7312986, 'specificity': 0.7312986, 'f1': 0.7891767, 'auroc': 0.91065836, 'binary_precision': 0.80794704, 'binary_recall': 0.46743295, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.592233}
confusion matrix:
      0    1
0  5968   29
1   139  122
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316517_3.png
new oracle model saved
early stop counter: 2
val acc:0.9633886814117432, best validation acc: 0.9656769037246704, corresponding to test acc:                         0.9582933783531189 / 0.9731543660163879
after epoch: 3,now: 2024-06-13 17:52:24.163943,epoch time: 0:19:03.173325,used: 0:59:32.582576,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316517
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9667063, 'precision': 0.7419889, 'recall': 0.6332762, 'specificity': 0.6332762, 'f1': 0.6703098, 'auroc': 0.9118834, 'binary_precision': 0.50877196, 'binary_recall': 0.27581522, 'binary_specificity': 0.99073726, 'binary_f1_score': 0.3577093}
confusion matrix:
       0    1
0  41928  392
1   1066  406
---- Validation: 
scalar performance:
{'acc': 0.9626437, 'precision': 0.7196215, 'recall': 0.73539203, 'specificity': 0.73539203, 'f1': 0.7271988, 'auroc': 0.9113631, 'binary_precision': 0.45730826, 'binary_recall': 0.49144635, 'binary_specificity': 0.9793377, 'binary_f1_score': 0.4737631}
confusion matrix:
       0    1
0  17774  375
1    327  316
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97666985, 'precision': 0.87577784, 'recall': 0.8119232, 'specificity': 0.8119232, 'f1': 0.8405755, 'auroc': 0.9131705, 'binary_precision': 0.76744187, 'binary_recall': 0.6321839, 'binary_specificity': 0.9916625, 'binary_f1_score': 0.6932773}
confusion matrix:
      0    1
0  5947   50
1    96  165
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316517_4.png
new oracle model saved
early stop counter: 3
val acc:0.9626436829566956, best validation acc: 0.9656769037246704, corresponding to test acc:                         0.9582933783531189 / 0.9766698479652405
after epoch: 4,now: 2024-06-13 18:11:27.946203,epoch time: 0:19:03.782260,used: 1:18:36.364836,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316517
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9670031, 'precision': 0.7479526, 'recall': 0.59676576, 'specificity': 0.59676576, 'f1': 0.63616866, 'auroc': 0.9109427, 'binary_precision': 0.52313167, 'binary_recall': 0.19986404, 'binary_specificity': 0.9936674, 'binary_f1_score': 0.28922775}
confusion matrix:
       0    1
0  42053  268
1   1177  294
---- Validation: 
scalar performance:
{'acc': 0.96317583, 'precision': 0.7172354, 'recall': 0.68841404, 'specificity': 0.68841404, 'f1': 0.7016762, 'auroc': 0.9145069, 'binary_precision': 0.45585585, 'binary_recall': 0.3934681, 'binary_specificity': 0.98336, 'binary_f1_score': 0.4223706}
confusion matrix:
       0    1
0  17847  302
1    390  253
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97682965, 'precision': 0.90713346, 'recall': 0.7753599, 'specificity': 0.7753599, 'f1': 0.82733226, 'auroc': 0.91682565, 'binary_precision': 0.8333333, 'binary_recall': 0.5555556, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.66666675}
confusion matrix:
      0    1
0  5968   29
1   116  145
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316517_5.png
new oracle model saved
early stop counter: 4
val acc:0.9631758332252502, best validation acc: 0.9656769037246704, corresponding to test acc:                         0.9582933783531189 / 0.9768296480178833
after epoch: 5,now: 2024-06-13 18:30:31.029760,epoch time: 0:19:03.083557,used: 1:37:39.448393,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316517
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9669803, 'precision': 0.7455871, 'recall': 0.6325158, 'specificity': 0.6325158, 'f1': 0.6704793, 'auroc': 0.9193353, 'binary_precision': 0.5160051, 'binary_recall': 0.2739633, 'binary_specificity': 0.99106824, 'binary_f1_score': 0.3579041}
confusion matrix:
       0    1
0  41943  378
1   1068  403
---- Validation: 
scalar performance:
{'acc': 0.96290976, 'precision': 0.7203461, 'recall': 0.7272792, 'specificity': 0.7272792, 'f1': 0.72375226, 'auroc': 0.9168495, 'binary_precision': 0.45933735, 'binary_recall': 0.47433904, 'binary_specificity': 0.9802193, 'binary_f1_score': 0.4667177}
confusion matrix:
       0    1
0  17790  359
1    338  305
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97762865, 'precision': 0.8908397, 'recall': 0.8069264, 'specificity': 0.8069264, 'f1': 0.8433298, 'auroc': 0.91831744, 'binary_precision': 0.79802954, 'binary_recall': 0.62068963, 'binary_specificity': 0.9931632, 'binary_f1_score': 0.69827586}
confusion matrix:
      0    1
0  5956   41
1    99  162
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316517_6.png
new oracle model saved
early stop counter: 5
val acc:0.9629097580909729, best validation acc: 0.9656769037246704, corresponding to test acc:                         0.9582933783531189 / 0.9776286482810974
after epoch: 6,now: 2024-06-13 18:49:37.607510,epoch time: 0:19:06.577750,used: 1:56:46.026143,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316517
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96656924, 'precision': 0.739414, 'recall': 0.58637047, 'specificity': 0.58637047, 'f1': 0.6236088, 'auroc': 0.9173901, 'binary_precision': 0.5067437, 'binary_recall': 0.17878994, 'binary_specificity': 0.993951, 'binary_f1_score': 0.26432163}
confusion matrix:
       0    1
0  42065  256
1   1208  263
---- Validation: 
scalar performance:
{'acc': 0.96408045, 'precision': 0.722639, 'recall': 0.6731312, 'specificity': 0.6731312, 'f1': 0.6944269, 'auroc': 0.91807765, 'binary_precision': 0.46774194, 'binary_recall': 0.3608087, 'binary_specificity': 0.9854537, 'binary_f1_score': 0.4073749}
confusion matrix:
       0    1
0  17885  264
1    411  232
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97682965, 'precision': 0.91690147, 'recall': 0.7661983, 'specificity': 0.7661983, 'f1': 0.8234155, 'auroc': 0.9195893, 'binary_precision': 0.85365856, 'binary_recall': 0.5363985, 'binary_specificity': 0.995998, 'binary_f1_score': 0.6588235}
confusion matrix:
      0    1
0  5973   24
1   121  140
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316517_7.png
early stop counter: 6
val acc:0.9640804529190063, best validation acc: 0.9656769037246704, corresponding to test acc:                         0.9582933783531189 / 0.9776286482810974
after epoch: 7,now: 2024-06-13 19:08:37.249609,epoch time: 0:18:59.642099,used: 2:15:45.668242,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316517
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.96761966, 'precision': 0.7558354, 'recall': 0.6301424, 'specificity': 0.6301424, 'f1': 0.6705905, 'auroc': 0.92070985, 'binary_precision': 0.5366848, 'binary_recall': 0.2683424, 'binary_specificity': 0.99194235, 'binary_f1_score': 0.35778987}
confusion matrix:
       0    1
0  41979  341
1   1077  395
---- Validation: 
scalar performance:
{'acc': 0.9634419, 'precision': 0.72092164, 'recall': 0.70130277, 'specificity': 0.70130277, 'f1': 0.7106009, 'auroc': 0.92015314, 'binary_precision': 0.46232876, 'binary_recall': 0.41990668, 'binary_specificity': 0.9826988, 'binary_f1_score': 0.4400978}
confusion matrix:
       0    1
0  17835  314
1    373  270
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97810805, 'precision': 0.90458834, 'recall': 0.7980149, 'specificity': 0.7980149, 'f1': 0.84243774, 'auroc': 0.92065364, 'binary_precision': 0.82631576, 'binary_recall': 0.6015326, 'binary_specificity': 0.99449724, 'binary_f1_score': 0.6962306}
confusion matrix:
      0    1
0  5964   33
1   104  157
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316517_8.png
new oracle model saved
early stop counter: 7
val acc:0.9634419083595276, best validation acc: 0.9656769037246704, corresponding to test acc:                         0.9582933783531189 / 0.9781080484390259
after epoch: 8,now: 2024-06-13 19:27:35.282541,epoch time: 0:18:58.032932,used: 2:34:43.701174,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316517
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9669346, 'precision': 0.7455074, 'recall': 0.6147753, 'specificity': 0.6147753, 'f1': 0.6541542, 'auroc': 0.92170656, 'binary_precision': 0.51703703, 'binary_recall': 0.23725356, 'binary_specificity': 0.992297, 'binary_f1_score': 0.3252563}
confusion matrix:
       0    1
0  41995  326
1   1122  349
---- Validation: 
scalar performance:
{'acc': 0.9634419, 'precision': 0.7220673, 'recall': 0.71105343, 'specificity': 0.71105343, 'f1': 0.7164032, 'auroc': 0.9214797, 'binary_precision': 0.46393442, 'binary_recall': 0.44012442, 'binary_specificity': 0.98198247, 'binary_f1_score': 0.4517159}
confusion matrix:
       0    1
0  17822  327
1    360  283
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9787472, 'precision': 0.90199405, 'recall': 0.81117475, 'specificity': 0.81117475, 'f1': 0.850232, 'auroc': 0.9216914, 'binary_precision': 0.82, 'binary_recall': 0.62835246, 'binary_specificity': 0.993997, 'binary_f1_score': 0.7114967}
confusion matrix:
      0    1
0  5961   36
1    97  164
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316517_9.png
new oracle model saved
early stop counter: 8
val acc:0.9634419083595276, best validation acc: 0.9656769037246704, corresponding to test acc:                         0.9582933783531189 / 0.9787471890449524
after epoch: 9,now: 2024-06-13 19:46:33.490982,epoch time: 0:18:58.208441,used: 2:53:41.909615,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316517
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.96723145, 'precision': 0.7533699, 'recall': 0.5955163, 'specificity': 0.5955163, 'f1': 0.63553554, 'auroc': 0.92625165, 'binary_precision': 0.53406996, 'binary_recall': 0.19701087, 'binary_specificity': 0.9940217, 'binary_f1_score': 0.2878412}
confusion matrix:
       0    1
0  42067  253
1   1182  290
---- Validation: 
scalar performance:
{'acc': 0.96365476, 'precision': 0.71849746, 'recall': 0.6699106, 'specificity': 0.6699106, 'f1': 0.6908053, 'auroc': 0.9221031, 'binary_precision': 0.45967743, 'binary_recall': 0.35458788, 'binary_specificity': 0.98523337, 'binary_f1_score': 0.40035117}
confusion matrix:
       0    1
0  17881  268
1    415  228
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97778845, 'precision': 0.9160007, 'recall': 0.78135717, 'specificity': 0.78135717, 'f1': 0.83447707, 'auroc': 0.92249316, 'binary_precision': 0.85057473, 'binary_recall': 0.5670498, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.6804598}
confusion matrix:
      0    1
0  5971   26
1   113  148
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316517_10.png
early stop counter: 9
val acc:0.9636547565460205, best validation acc: 0.9656769037246704, corresponding to test acc:                         0.9582933783531189 / 0.9787471890449524
after epoch: 10,now: 2024-06-13 20:05:32.267085,epoch time: 0:18:58.776103,used: 3:12:40.685718,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316517
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96743697, 'precision': 0.7600014, 'recall': 0.5867704, 'specificity': 0.5867704, 'f1': 0.62640727, 'auroc': 0.9226526, 'binary_precision': 0.54791665, 'binary_recall': 0.17866848, 'binary_specificity': 0.9948724, 'binary_f1_score': 0.2694672}
confusion matrix:
       0    1
0  42103  217
1   1209  263
---- Validation: 
scalar performance:
{'acc': 0.9642933, 'precision': 0.7214805, 'recall': 0.6484896, 'specificity': 0.6484896, 'f1': 0.67696726, 'auroc': 0.9229972, 'binary_precision': 0.46713614, 'binary_recall': 0.30948678, 'binary_specificity': 0.98749244, 'binary_f1_score': 0.3723106}
confusion matrix:
       0    1
0  17922  227
1    444  199
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97635025, 'precision': 0.9174254, 'recall': 0.7586188, 'specificity': 0.7586188, 'f1': 0.8176918, 'auroc': 0.92234755, 'binary_precision': 0.8553459, 'binary_recall': 0.5210728, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.64761907}
confusion matrix:
      0    1
0  5974   23
1   125  136
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316517_11.png
early stop counter: 10
val acc:0.9642933011054993, best validation acc: 0.9656769037246704, corresponding to test acc:                         0.9582933783531189 / 0.9787471890449524
after epoch: 11,now: 2024-06-13 20:24:36.868886,epoch time: 0:19:04.601801,used: 3:31:45.287519,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316517
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9671173, 'precision': 0.7479454, 'recall': 0.62536865, 'specificity': 0.62536865, 'f1': 0.6645918, 'auroc': 0.92564195, 'binary_precision': 0.5212038, 'binary_recall': 0.25900748, 'binary_specificity': 0.99172986, 'binary_f1_score': 0.346049}
confusion matrix:
       0    1
0  41971  350
1   1090  381
---- Validation: 
scalar performance:
{'acc': 0.96397406, 'precision': 0.72549146, 'recall': 0.7068286, 'specificity': 0.7068286, 'f1': 0.71570885, 'auroc': 0.923976, 'binary_precision': 0.47108844, 'binary_recall': 0.43079317, 'binary_specificity': 0.9828641, 'binary_f1_score': 0.45004064}
confusion matrix:
       0    1
0  17838  311
1    366  277
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97794825, 'precision': 0.9024238, 'recall': 0.79793155, 'specificity': 0.79793155, 'f1': 0.8416257, 'auroc': 0.9228395, 'binary_precision': 0.82198954, 'binary_recall': 0.6015326, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.6946903}
confusion matrix:
      0    1
0  5963   34
1   104  157
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316517_12.png
early stop counter: 11
val acc:0.9639740586280823, best validation acc: 0.9656769037246704, corresponding to test acc:                         0.9582933783531189 / 0.9787471890449524
after epoch: 12,now: 2024-06-13 20:43:36.351055,epoch time: 0:18:59.482169,used: 3:50:44.769688,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316517
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.96752834, 'precision': 0.75855386, 'recall': 0.6018992, 'specificity': 0.6018992, 'f1': 0.6431591, 'auroc': 0.92731977, 'binary_precision': 0.5440141, 'binary_recall': 0.20991848, 'binary_specificity': 0.99388, 'binary_f1_score': 0.30294117}
confusion matrix:
       0    1
0  42061  259
1   1163  309
---- Validation: 
scalar performance:
{'acc': 0.96408045, 'precision': 0.7228203, 'recall': 0.67463136, 'specificity': 0.67463136, 'f1': 0.6954628, 'auroc': 0.9248967, 'binary_precision': 0.468, 'binary_recall': 0.36391914, 'binary_specificity': 0.9853435, 'binary_f1_score': 0.4094488}
confusion matrix:
       0    1
0  17883  266
1    409  234
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97810805, 'precision': 0.91325545, 'recall': 0.7888532, 'specificity': 0.7888532, 'f1': 0.8389983, 'auroc': 0.9243901, 'binary_precision': 0.84444445, 'binary_recall': 0.58237547, 'binary_specificity': 0.995331, 'binary_f1_score': 0.6893424}
confusion matrix:
      0    1
0  5969   28
1   109  152
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316517_13.png
early stop counter: 12
val acc:0.9640804529190063, best validation acc: 0.9656769037246704, corresponding to test acc:                         0.9582933783531189 / 0.9787471890449524
after epoch: 13,now: 2024-06-13 21:02:47.108247,epoch time: 0:19:10.757192,used: 4:09:55.526880,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316517
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96704876, 'precision': 0.74720633, 'recall': 0.62558484, 'specificity': 0.62558484, 'f1': 0.6646349, 'auroc': 0.9235983, 'binary_precision': 0.5197279, 'binary_recall': 0.25951087, 'binary_specificity': 0.9916588, 'binary_f1_score': 0.3461713}
confusion matrix:
       0    1
0  41967  353
1   1090  382
---- Validation: 
scalar performance:
{'acc': 0.9641869, 'precision': 0.723143, 'recall': 0.66943604, 'specificity': 0.66943604, 'f1': 0.69218963, 'auroc': 0.9252704, 'binary_precision': 0.46900827, 'binary_recall': 0.35303265, 'binary_specificity': 0.9858394, 'binary_f1_score': 0.4028394}
confusion matrix:
       0    1
0  17892  257
1    416  227
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97778845, 'precision': 0.91222, 'recall': 0.7850218, 'specificity': 0.7850218, 'f1': 0.83593094, 'auroc': 0.92420816, 'binary_precision': 0.8426966, 'binary_recall': 0.57471263, 'binary_specificity': 0.995331, 'binary_f1_score': 0.6833713}
confusion matrix:
      0    1
0  5969   28
1   111  150
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316517_14.png
early stop counter: 13
val acc:0.9641869068145752, best validation acc: 0.9656769037246704, corresponding to test acc:                         0.9582933783531189 / 0.9787471890449524
after epoch: 14,now: 2024-06-13 21:21:46.528800,epoch time: 0:18:59.420553,used: 4:28:54.947433,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316517
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9683275, 'precision': 0.7656927, 'recall': 0.6381342, 'specificity': 0.6381342, 'f1': 0.6799099, 'auroc': 0.9267217, 'binary_precision': 0.55585104, 'binary_recall': 0.28416044, 'binary_specificity': 0.9921079, 'binary_f1_score': 0.37606838}
confusion matrix:
       0    1
0  41987  334
1   1053  418
---- Validation: 
scalar performance:
{'acc': 0.9642401, 'precision': 0.7236291, 'recall': 0.66946363, 'specificity': 0.66946363, 'f1': 0.6923825, 'auroc': 0.9258242, 'binary_precision': 0.4699793, 'binary_recall': 0.35303265, 'binary_specificity': 0.98589456, 'binary_f1_score': 0.40319717}
confusion matrix:
       0    1
0  17893  256
1    416  227
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97778845, 'precision': 0.9160007, 'recall': 0.78135717, 'specificity': 0.78135717, 'f1': 0.83447707, 'auroc': 0.924495, 'binary_precision': 0.85057473, 'binary_recall': 0.5670498, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.6804598}
confusion matrix:
      0    1
0  5971   26
1   113  148
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316517_15.png
early stop counter: 14
val acc:0.9642400741577148, best validation acc: 0.9656769037246704, corresponding to test acc:                         0.9582933783531189 / 0.9787471890449524
after epoch: 15,now: 2024-06-13 21:40:48.639636,epoch time: 0:19:02.110836,used: 4:47:57.058269,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316517
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.96741414, 'precision': 0.7546016, 'recall': 0.6120038, 'specificity': 0.6120038, 'f1': 0.6530196, 'auroc': 0.92648983, 'binary_precision': 0.53543305, 'binary_recall': 0.23097827, 'binary_specificity': 0.9930293, 'binary_f1_score': 0.32273373}
confusion matrix:
       0    1
0  42025  295
1   1132  340
---- Validation: 
scalar performance:
{'acc': 0.964453, 'precision': 0.72441953, 'recall': 0.659073, 'specificity': 0.659073, 'f1': 0.68554515, 'auroc': 0.9264537, 'binary_precision': 0.4722838, 'binary_recall': 0.33125973, 'binary_specificity': 0.9868863, 'binary_f1_score': 0.3893967}
confusion matrix:
       0    1
0  17911  238
1    430  213
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97762865, 'precision': 0.92153335, 'recall': 0.77394444, 'specificity': 0.77394444, 'f1': 0.8306577, 'auroc': 0.9250425, 'binary_precision': 0.8622754, 'binary_recall': 0.55172414, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.6728972}
confusion matrix:
      0    1
0  5974   23
1   117  144
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316517_16.png
early stop counter: 15
val acc:0.9644529819488525, best validation acc: 0.9656769037246704, corresponding to test acc:                         0.9582933783531189 / 0.9787471890449524
after epoch: 16,now: 2024-06-13 21:59:48.942870,epoch time: 0:19:00.303234,used: 5:06:57.361503,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316517
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.96780235, 'precision': 0.75701237, 'recall': 0.64433485, 'specificity': 0.64433485, 'f1': 0.6833359, 'auroc': 0.9302827, 'binary_precision': 0.53808355, 'binary_recall': 0.29755434, 'binary_specificity': 0.99111533, 'binary_f1_score': 0.3832021}
confusion matrix:
       0    1
0  41944  376
1   1034  438
---- Validation: 
scalar performance:
{'acc': 0.9641869, 'precision': 0.72578984, 'recall': 0.6934378, 'specificity': 0.6934378, 'f1': 0.70821804, 'auroc': 0.9270446, 'binary_precision': 0.47262773, 'binary_recall': 0.40279937, 'binary_specificity': 0.98407626, 'binary_f1_score': 0.4349286}
confusion matrix:
       0    1
0  17860  289
1    384  259
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9787472, 'precision': 0.9117284, 'recall': 0.80018073, 'specificity': 0.80018073, 'f1': 0.8463822, 'auroc': 0.92542505, 'binary_precision': 0.84042555, 'binary_recall': 0.60536397, 'binary_specificity': 0.9949975, 'binary_f1_score': 0.7037862}
confusion matrix:
      0    1
0  5967   30
1   103  158
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316517_17.png
early stop counter: 16
val acc:0.9641869068145752, best validation acc: 0.9656769037246704, corresponding to test acc:                         0.9582933783531189 / 0.9787471890449524
after epoch: 17,now: 2024-06-13 22:18:57.204867,epoch time: 0:19:08.261997,used: 5:26:05.623500,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316517
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.96789366, 'precision': 0.7596878, 'recall': 0.63421845, 'specificity': 0.63421845, 'f1': 0.675098, 'auroc': 0.9312962, 'binary_precision': 0.5441176, 'binary_recall': 0.27649456, 'binary_specificity': 0.99194235, 'binary_f1_score': 0.36666664}
confusion matrix:
       0    1
0  41979  341
1   1065  407
---- Validation: 
scalar performance:
{'acc': 0.9642401, 'precision': 0.72336215, 'recall': 0.66721344, 'specificity': 0.66721344, 'f1': 0.6907854, 'auroc': 0.9274893, 'binary_precision': 0.4696017, 'binary_recall': 0.34836704, 'binary_specificity': 0.98605984, 'binary_f1_score': 0.40000004}
confusion matrix:
       0    1
0  17896  253
1    419  224
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97794825, 'precision': 0.92046034, 'recall': 0.77960825, 'specificity': 0.77960825, 'f1': 0.8345677, 'auroc': 0.9257999, 'binary_precision': 0.8596491, 'binary_recall': 0.5632184, 'binary_specificity': 0.995998, 'binary_f1_score': 0.6805556}
confusion matrix:
      0    1
0  5973   24
1   114  147
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316517_18.png
early stop counter: 17
val acc:0.9642400741577148, best validation acc: 0.9656769037246704, corresponding to test acc:                         0.9582933783531189 / 0.9787471890449524
after epoch: 18,now: 2024-06-13 22:37:57.203247,epoch time: 0:18:59.998380,used: 5:45:05.621880,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316517
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.96807635, 'precision': 0.75986874, 'recall': 0.64859545, 'specificity': 0.64859545, 'f1': 0.6876265, 'auroc': 0.92771757, 'binary_precision': 0.54347825, 'binary_recall': 0.30612245, 'binary_specificity': 0.9910685, 'binary_f1_score': 0.39164492}
confusion matrix:
       0    1
0  41944  378
1   1020  450
---- Validation: 
scalar performance:
{'acc': 0.9641869, 'precision': 0.7260169, 'recall': 0.695688, 'specificity': 0.695688, 'f1': 0.70963275, 'auroc': 0.92868096, 'binary_precision': 0.47292417, 'binary_recall': 0.407465, 'binary_specificity': 0.983911, 'binary_f1_score': 0.43776107}
confusion matrix:
       0    1
0  17857  292
1    381  262
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9782678, 'precision': 0.9035082, 'recall': 0.80176294, 'specificity': 0.80176294, 'f1': 0.8445827, 'auroc': 0.92608297, 'binary_precision': 0.8238342, 'binary_recall': 0.6091954, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.70044047}
confusion matrix:
      0    1
0  5963   34
1   102  159
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316517_19.png
early stop counter: 18
val acc:0.9641869068145752, best validation acc: 0.9656769037246704, corresponding to test acc:                         0.9582933783531189 / 0.9787471890449524
after epoch: 19,now: 2024-06-13 22:56:59.871485,epoch time: 0:19:02.668238,used: 6:04:08.290118,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316517
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9675968, 'precision': 0.7544185, 'recall': 0.6402942, 'specificity': 0.6402942, 'f1': 0.67926615, 'auroc': 0.92937124, 'binary_precision': 0.53316647, 'binary_recall': 0.2894022, 'binary_specificity': 0.9911862, 'binary_f1_score': 0.37516513}
confusion matrix:
       0    1
0  41947  373
1   1046  426
---- Validation: 
scalar performance:
{'acc': 0.9645594, 'precision': 0.7278346, 'recall': 0.68237984, 'specificity': 0.68237984, 'f1': 0.7022977, 'auroc': 0.9287656, 'binary_precision': 0.4774951, 'binary_recall': 0.37947124, 'binary_specificity': 0.98528844, 'binary_f1_score': 0.42287695}
confusion matrix:
       0    1
0  17882  267
1    399  244
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9787472, 'precision': 0.9171013, 'recall': 0.79468375, 'specificity': 0.79468375, 'f1': 0.844379, 'auroc': 0.9262895, 'binary_precision': 0.85164833, 'binary_recall': 0.59386975, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.6997743}
confusion matrix:
      0    1
0  5970   27
1   106  155
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316517_20.png
early stop counter: 19
val acc:0.9645593762397766, best validation acc: 0.9656769037246704, corresponding to test acc:                         0.9582933783531189 / 0.9787471890449524
after epoch: 20,now: 2024-06-13 23:16:04.204558,epoch time: 0:19:04.333073,used: 6:23:12.623191,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316517
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.96800786, 'precision': 0.7567586, 'recall': 0.6737306, 'specificity': 0.6737306, 'f1': 0.70643526, 'auroc': 0.9300089, 'binary_precision': 0.53556913, 'binary_recall': 0.35825968, 'binary_specificity': 0.9892016, 'binary_f1_score': 0.4293279}
confusion matrix:
       0    1
0  41864  457
1    944  527
---- Validation: 
scalar performance:
{'acc': 0.9642401, 'precision': 0.7289048, 'recall': 0.7227175, 'specificity': 0.7227175, 'f1': 0.7257637, 'auroc': 0.929572, 'binary_precision': 0.4768, 'binary_recall': 0.46345258, 'binary_specificity': 0.98198247, 'binary_f1_score': 0.4700316}
confusion matrix:
       0    1
0  17822  327
1    345  298
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9793864, 'precision': 0.90560544, 'recall': 0.8170053, 'specificity': 0.8170053, 'f1': 0.85533977, 'auroc': 0.92589974, 'binary_precision': 0.8267327, 'binary_recall': 0.63984674, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.7213823}
confusion matrix:
      0    1
0  5962   35
1    94  167
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316517_21.png
new oracle model saved
early stop counter: 20
val acc:0.9642400741577148, best validation acc: 0.9656769037246704, corresponding to test acc:                         0.9582933783531189 / 0.9793863892555237
after epoch: 21,now: 2024-06-13 23:35:10.676938,epoch time: 0:19:06.472380,used: 6:42:19.095571,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316517
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 21 with time: 6:42:19.095571 at 2024-06-13 23:35:10.676938
persisted model performance metric: 

scalar performance:
{'acc': 0.9582934, 'precision': 0.72973406, 'recall': 0.5146587, 'specificity': 0.5146587, 'f1': 0.5182182, 'auroc': 0.8821633, 'binary_precision': 0.5, 'binary_recall': 0.03065134, 'binary_specificity': 0.998666, 'binary_f1_score': 0.057761732}
confusion matrix:
      0  1
0  5989  8
1   253  8
oracle model performance metric: 

scalar performance:
{'acc': 0.9793864, 'precision': 0.90560544, 'recall': 0.8170053, 'specificity': 0.8170053, 'f1': 0.85533977, 'auroc': 0.92589974, 'binary_precision': 0.8267327, 'binary_recall': 0.63984674, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.7213823}
confusion matrix:
      0    1
0  5962   35
1    94  167
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_vit_resnet_dinov2_bs16_different_learningrates/rule_results/2.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_vit_resnet_dinov2_bs16_different_learningrates/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_vit_resnet_dinov2_bs16_different_learningrates/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 191877 KiB | 461403 KiB | 379473 GiB | 379473 GiB |
|       from large pool | 174400 KiB | 428048 KiB | 371677 GiB | 371677 GiB |
|       from small pool |  17477 KiB |  38507 KiB |   7796 GiB |   7796 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 191877 KiB | 461403 KiB | 379473 GiB | 379473 GiB |
|       from large pool | 174400 KiB | 428048 KiB | 371677 GiB | 371677 GiB |
|       from small pool |  17477 KiB |  38507 KiB |   7796 GiB |   7796 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 189283 KiB | 457564 KiB | 379453 GiB | 379453 GiB |
|       from large pool | 172814 KiB | 424940 KiB | 371672 GiB | 371672 GiB |
|       from small pool |  16469 KiB |  37503 KiB |   7781 GiB |   7781 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 516096 KiB | 516096 KiB | 516096 KiB |      0 B   |
|       from large pool | 473088 KiB | 473088 KiB | 473088 KiB |      0 B   |
|       from small pool |  43008 KiB |  43008 KiB |  43008 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  39546 KiB |  74579 KiB | 212837 GiB | 212837 GiB |
|       from large pool |  30400 KiB |  70632 KiB | 205031 GiB | 205031 GiB |
|       from small pool |   9146 KiB |   9397 KiB |   7805 GiB |   7805 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2966    |    5937    |   81406 K  |   81403 K  |
|       from large pool |      76    |     158    |   36637 K  |   36637 K  |
|       from small pool |    2890    |    5860    |   44768 K  |   44765 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2966    |    5937    |   81406 K  |   81403 K  |
|       from large pool |      76    |     158    |   36637 K  |   36637 K  |
|       from small pool |    2890    |    5860    |   44768 K  |   44765 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      42    |      42    |      42    |       0    |
|       from large pool |      21    |      21    |      21    |       0    |
|       from small pool |      21    |      21    |      21    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      32    |    2756    |   42673 K  |   42673 K  |
|       from large pool |       9    |      19    |   24349 K  |   24349 K  |
|       from small pool |      23    |    2747    |   18323 K  |   18323 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 461403 KiB | 379473 GiB | 379473 GiB |
|       from large pool |  17088 KiB | 428048 KiB | 371677 GiB | 371677 GiB |
|       from small pool |      0 KiB |  38507 KiB |   7796 GiB |   7796 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 461403 KiB | 379473 GiB | 379473 GiB |
|       from large pool |  17088 KiB | 428048 KiB | 371677 GiB | 371677 GiB |
|       from small pool |      0 KiB |  38507 KiB |   7796 GiB |   7796 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457564 KiB | 379453 GiB | 379453 GiB |
|       from large pool |  16640 KiB | 424940 KiB | 371672 GiB | 371672 GiB |
|       from small pool |      0 KiB |  37503 KiB |   7781 GiB |   7781 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 231424 KiB | 516096 KiB | 516096 KiB | 284672 KiB |
|       from large pool | 204800 KiB | 473088 KiB | 473088 KiB | 268288 KiB |
|       from small pool |  26624 KiB |  43008 KiB |  43008 KiB |  16384 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  82786 KiB | 212837 GiB | 212837 GiB |
|       from large pool |  23872 KiB |  70632 KiB | 205031 GiB | 205031 GiB |
|       from small pool |      0 KiB |  20341 KiB |   7805 GiB |   7805 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    5937    |   81406 K  |   81406 K  |
|       from large pool |       2    |     158    |   36637 K  |   36637 K  |
|       from small pool |       0    |    5860    |   44768 K  |   44768 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    5937    |   81406 K  |   81406 K  |
|       from large pool |       2    |     158    |   36637 K  |   36637 K  |
|       from small pool |       0    |    5860    |   44768 K  |   44768 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |      42    |      42    |      19    |
|       from large pool |      10    |      21    |      21    |      11    |
|       from small pool |      13    |      21    |      21    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2756    |   42674 K  |   42674 K  |
|       from large pool |       3    |      19    |   24349 K  |   24349 K  |
|       from small pool |       0    |    2747    |   18324 K  |   18324 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 461403 KiB | 379473 GiB | 379473 GiB |
|       from large pool |  17088 KiB | 428048 KiB | 371677 GiB | 371677 GiB |
|       from small pool |      0 KiB |  38507 KiB |   7796 GiB |   7796 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 461403 KiB | 379473 GiB | 379473 GiB |
|       from large pool |  17088 KiB | 428048 KiB | 371677 GiB | 371677 GiB |
|       from small pool |      0 KiB |  38507 KiB |   7796 GiB |   7796 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457564 KiB | 379453 GiB | 379453 GiB |
|       from large pool |  16640 KiB | 424940 KiB | 371672 GiB | 371672 GiB |
|       from small pool |      0 KiB |  37503 KiB |   7781 GiB |   7781 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 231424 KiB | 516096 KiB | 516096 KiB | 284672 KiB |
|       from large pool | 204800 KiB | 473088 KiB | 473088 KiB | 268288 KiB |
|       from small pool |  26624 KiB |  43008 KiB |  43008 KiB |  16384 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  82786 KiB | 212837 GiB | 212837 GiB |
|       from large pool |  23872 KiB |  70632 KiB | 205031 GiB | 205031 GiB |
|       from small pool |      0 KiB |  20341 KiB |   7805 GiB |   7805 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    5937    |   81406 K  |   81406 K  |
|       from large pool |       2    |     158    |   36637 K  |   36637 K  |
|       from small pool |       0    |    5860    |   44768 K  |   44768 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    5937    |   81406 K  |   81406 K  |
|       from large pool |       2    |     158    |   36637 K  |   36637 K  |
|       from small pool |       0    |    5860    |   44768 K  |   44768 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |      42    |      42    |      19    |
|       from large pool |      10    |      21    |      21    |      11    |
|       from small pool |      13    |      21    |      21    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2756    |   42674 K  |   42674 K  |
|       from large pool |       3    |      19    |   24349 K  |   24349 K  |
|       from small pool |       0    |    2747    |   18324 K  |   18324 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0




!!!: not committed yet



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_23_44_01_seed_1_21316517

 Experiment start at: 2024-06-13 23:44:01.975887
before training, model accuracy: 0.6474379897117615
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.966618, 'precision': 0.52203447, 'recall': 0.50041056, 'specificity': 0.50041056, 'f1': 0.49287486, 'auroc': 0.8280278, 'binary_precision': 0.07692308, 'binary_recall': 0.0013869626, 'binary_specificity': 0.9994342, 'binary_f1_score': 0.0027247956}
confusion matrix:
       0   1
0  42390  24
1   1440   2
---- Validation: 
scalar performance:
{'acc': 0.9623266, 'precision': 0.52054805, 'recall': 0.5012325, 'specificity': 0.5012325, 'f1': 0.49461275, 'auroc': 0.8483434, 'binary_precision': 0.07692308, 'binary_recall': 0.004457652, 'binary_specificity': 0.9980074, 'binary_f1_score': 0.008426966}
confusion matrix:
       0   1
0  18031  36
1    670   3
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9555269, 'precision': 0.56262803, 'recall': 0.50601053, 'specificity': 0.50601053, 'f1': 0.5027059, 'auroc': 0.87056714, 'binary_precision': 0.16666667, 'binary_recall': 0.015384615, 'binary_specificity': 0.9966364, 'binary_f1_score': 0.028169014}
confusion matrix:
      0   1
0  5926  20
1   256   4
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316517_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-14 00:04:15.873233,epoch time: 0:20:13.897346,used: 0:20:13.897346,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_23_44_01_seed_1_21316517
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96650404, 'precision': 0.6731874, 'recall': 0.51374966, 'specificity': 0.51374966, 'f1': 0.5185195, 'auroc': 0.8870348, 'binary_precision': 0.3783784, 'binary_recall': 0.029126214, 'binary_specificity': 0.99837315, 'binary_f1_score': 0.05408886}
confusion matrix:
       0   1
0  42345  69
1   1400  42
---- Validation: 
scalar performance:
{'acc': 0.9630736, 'precision': 0.7217193, 'recall': 0.6117711, 'specificity': 0.6117711, 'f1': 0.64657736, 'auroc': 0.89036846, 'binary_precision': 0.47147146, 'binary_recall': 0.2332838, 'binary_specificity': 0.99025846, 'binary_f1_score': 0.31212723}
confusion matrix:
       0    1
0  17891  176
1    516  157
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9653561, 'precision': 0.87280726, 'recall': 0.61964023, 'specificity': 0.61964023, 'f1': 0.67584515, 'auroc': 0.89795, 'binary_precision': 0.7777778, 'binary_recall': 0.2423077, 'binary_specificity': 0.99697274, 'binary_f1_score': 0.36950147}
confusion matrix:
      0   1
0  5928  18
1   197  63
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316517_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-14 00:23:54.534441,epoch time: 0:19:38.661208,used: 0:39:52.558554,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_23_44_01_seed_1_21316517
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9665268, 'precision': 0.7172879, 'recall': 0.5556305, 'specificity': 0.5556305, 'f1': 0.584131, 'auroc': 0.90370536, 'binary_precision': 0.46388888, 'binary_recall': 0.11581137, 'binary_specificity': 0.9954496, 'binary_f1_score': 0.18534961}
confusion matrix:
       0    1
0  42221  193
1   1275  167
---- Validation: 
scalar performance:
{'acc': 0.96318036, 'precision': 0.73349094, 'recall': 0.7241235, 'specificity': 0.7241235, 'f1': 0.7286993, 'auroc': 0.9031085, 'binary_precision': 0.4868217, 'binary_recall': 0.4665676, 'binary_specificity': 0.9816793, 'binary_f1_score': 0.47647953}
confusion matrix:
       0    1
0  17736  331
1    359  314
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9722849, 'precision': 0.8700216, 'recall': 0.7427902, 'specificity': 0.7427902, 'f1': 0.7918892, 'auroc': 0.90885305, 'binary_precision': 0.7619048, 'binary_recall': 0.4923077, 'binary_specificity': 0.9932728, 'binary_f1_score': 0.5981308}
confusion matrix:
      0    1
0  5906   40
1   132  128
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316517_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-14 00:43:33.052025,epoch time: 0:19:38.517584,used: 0:59:31.076138,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_23_44_01_seed_1_21316517
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9664812, 'precision': 0.7188084, 'recall': 0.56465065, 'specificity': 0.56465065, 'f1': 0.5958523, 'auroc': 0.9058459, 'binary_precision': 0.46634614, 'binary_recall': 0.13453537, 'binary_specificity': 0.9947659, 'binary_f1_score': 0.20882669}
confusion matrix:
       0    1
0  42192  222
1   1248  194
---- Validation: 
scalar performance:
{'acc': 0.96403414, 'precision': 0.74013567, 'recall': 0.73601055, 'specificity': 0.73601055, 'f1': 0.738053, 'auroc': 0.90731966, 'binary_precision': 0.49924356, 'binary_recall': 0.49034175, 'binary_specificity': 0.9816793, 'binary_f1_score': 0.49475262}
confusion matrix:
       0    1
0  17736  331
1    343  330
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97260714, 'precision': 0.8646283, 'recall': 0.75583136, 'specificity': 0.75583136, 'f1': 0.79971826, 'auroc': 0.9129486, 'binary_precision': 0.75, 'binary_recall': 0.5192308, 'binary_specificity': 0.9924319, 'binary_f1_score': 0.6136363}
confusion matrix:
      0    1
0  5901   45
1   125  135
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316517_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-14 01:03:18.504868,epoch time: 0:19:45.452843,used: 1:19:16.528981,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_23_44_01_seed_1_21316517
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96680045, 'precision': 0.7279851, 'recall': 0.57184964, 'specificity': 0.57184964, 'f1': 0.6055156, 'auroc': 0.9128265, 'binary_precision': 0.48423424, 'binary_recall': 0.14909847, 'binary_specificity': 0.99460083, 'binary_f1_score': 0.22799575}
confusion matrix:
       0    1
0  42185  229
1   1227  215
---- Validation: 
scalar performance:
{'acc': 0.965048, 'precision': 0.74766225, 'recall': 0.751557, 'specificity': 0.751557, 'f1': 0.74959254, 'auroc': 0.9115763, 'binary_precision': 0.5131579, 'binary_recall': 0.5215453, 'binary_specificity': 0.98156863, 'binary_f1_score': 0.51731753}
confusion matrix:
       0    1
0  17734  333
1    322  351
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97486305, 'precision': 0.87745047, 'recall': 0.77907646, 'specificity': 0.77907646, 'f1': 0.82014596, 'auroc': 0.9169835, 'binary_precision': 0.7736842, 'binary_recall': 0.5653846, 'binary_specificity': 0.9927682, 'binary_f1_score': 0.6533333}
confusion matrix:
      0    1
0  5903   43
1   113  147
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316517_5.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-06-14 01:22:59.267212,epoch time: 0:19:40.762344,used: 1:38:57.291325,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_23_44_01_seed_1_21316517
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96664083, 'precision': 0.7294129, 'recall': 0.6102866, 'specificity': 0.6102866, 'f1': 0.64689374, 'auroc': 0.913149, 'binary_precision': 0.4845815, 'binary_recall': 0.22884881, 'binary_specificity': 0.99172443, 'binary_f1_score': 0.31088084}
confusion matrix:
       0    1
0  42063  351
1   1112  330
---- Validation: 
scalar performance:
{'acc': 0.9648879, 'precision': 0.74670106, 'recall': 0.76148766, 'specificity': 0.76148766, 'f1': 0.7538527, 'auroc': 0.91377974, 'binary_precision': 0.5104895, 'binary_recall': 0.54234767, 'binary_specificity': 0.98062766, 'binary_f1_score': 0.5259366}
confusion matrix:
       0    1
0  17717  350
1    308  365
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9747019, 'precision': 0.86911696, 'recall': 0.78818727, 'specificity': 0.78818727, 'f1': 0.82314956, 'auroc': 0.91883636, 'binary_precision': 0.7562189, 'binary_recall': 0.5846154, 'binary_specificity': 0.9917592, 'binary_f1_score': 0.659436}
confusion matrix:
      0    1
0  5897   49
1   108  152
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316517_6.png
early stop counter: 1
val acc:0.9648879170417786, best validation acc: 0.9650480151176453, corresponding to test acc:                         0.9748630523681641 / 0.9748630523681641
after epoch: 6,now: 2024-06-14 01:42:15.558936,epoch time: 0:19:16.291724,used: 1:58:13.583049,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_23_44_01_seed_1_21316517
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9669145, 'precision': 0.7312976, 'recall': 0.57760274, 'specificity': 0.57760274, 'f1': 0.61269283, 'auroc': 0.9194905, 'binary_precision': 0.49048626, 'binary_recall': 0.16088766, 'binary_specificity': 0.9943179, 'binary_f1_score': 0.24229766}
confusion matrix:
       0    1
0  42173  241
1   1210  232
---- Validation: 
scalar performance:
{'acc': 0.965048, 'precision': 0.7474669, 'recall': 0.7215157, 'specificity': 0.7215157, 'f1': 0.7336885, 'auroc': 0.9163484, 'binary_precision': 0.515, 'binary_recall': 0.45913818, 'binary_specificity': 0.9838933, 'binary_f1_score': 0.4854674}
confusion matrix:
       0    1
0  17776  291
1    364  309
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9756687, 'precision': 0.8942517, 'recall': 0.772141, 'specificity': 0.772141, 'f1': 0.8209263, 'auroc': 0.9215995, 'binary_precision': 0.8079096, 'binary_recall': 0.55, 'binary_specificity': 0.9942819, 'binary_f1_score': 0.6544622}
confusion matrix:
      0    1
0  5912   34
1   117  143
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316517_7.png
new oracle model saved
early stop counter: 2
val acc:0.9650480151176453, best validation acc: 0.9650480151176453, corresponding to test acc:                         0.9748630523681641 / 0.975668728351593
after epoch: 7,now: 2024-06-14 02:01:22.313635,epoch time: 0:19:06.754699,used: 2:17:20.337748,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_23_44_01_seed_1_21316517
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.96670926, 'precision': 0.73118865, 'recall': 0.6183608, 'specificity': 0.6183608, 'f1': 0.6547505, 'auroc': 0.9188268, 'binary_precision': 0.4876033, 'binary_recall': 0.24549237, 'binary_specificity': 0.9912293, 'binary_f1_score': 0.32656828}
confusion matrix:
       0    1
0  42042  372
1   1088  354
---- Validation: 
scalar performance:
{'acc': 0.9653148, 'precision': 0.7495623, 'recall': 0.7545564, 'specificity': 0.7545564, 'f1': 0.7520316, 'auroc': 0.91776204, 'binary_precision': 0.5167394, 'binary_recall': 0.5274888, 'binary_specificity': 0.98162395, 'binary_f1_score': 0.5220588}
confusion matrix:
       0    1
0  17735  332
1    318  355
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97502416, 'precision': 0.87949884, 'recall': 0.7791605, 'specificity': 0.7791605, 'f1': 0.82091594, 'auroc': 0.9221164, 'binary_precision': 0.7777778, 'binary_recall': 0.5653846, 'binary_specificity': 0.99293643, 'binary_f1_score': 0.65478843}
confusion matrix:
      0    1
0  5904   42
1   113  147
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316517_8.png
better model found
persisted
after epoch: 8,now: 2024-06-14 02:20:30.671152,epoch time: 0:19:08.357517,used: 2:36:28.695265,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_23_44_01_seed_1_21316517
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9671197, 'precision': 0.7368324, 'recall': 0.6014905, 'specificity': 0.6014905, 'f1': 0.6395326, 'auroc': 0.92312634, 'binary_precision': 0.5, 'binary_recall': 0.21012482, 'binary_specificity': 0.99285614, 'binary_f1_score': 0.2958984}
confusion matrix:
       0    1
0  42111  303
1   1139  303
---- Validation: 
scalar performance:
{'acc': 0.96542156, 'precision': 0.75033545, 'recall': 0.7438828, 'specificity': 0.7438828, 'f1': 0.7470619, 'auroc': 0.91969764, 'binary_precision': 0.519084, 'binary_recall': 0.50520056, 'binary_specificity': 0.9825649, 'binary_f1_score': 0.5120481}
confusion matrix:
       0    1
0  17752  315
1    333  340
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97534645, 'precision': 0.88662815, 'recall': 0.77565074, 'specificity': 0.77565074, 'f1': 0.82092226, 'auroc': 0.9241203, 'binary_precision': 0.79234976, 'binary_recall': 0.5576923, 'binary_specificity': 0.99360913, 'binary_f1_score': 0.6546275}
confusion matrix:
      0    1
0  5908   38
1   115  145
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316517_9.png
better model found
persisted
after epoch: 9,now: 2024-06-14 02:39:34.110425,epoch time: 0:19:03.439273,used: 2:55:32.134538,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_23_44_01_seed_1_21316517
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.96727926, 'precision': 0.7397677, 'recall': 0.6042526, 'specificity': 0.6042526, 'f1': 0.6428144, 'auroc': 0.9243805, 'binary_precision': 0.50569105, 'binary_recall': 0.21567267, 'binary_specificity': 0.99283254, 'binary_f1_score': 0.30238208}
confusion matrix:
       0    1
0  42110  304
1   1131  311
---- Validation: 
scalar performance:
{'acc': 0.9652081, 'precision': 0.7487933, 'recall': 0.71587664, 'specificity': 0.71587664, 'f1': 0.73103285, 'auroc': 0.92088443, 'binary_precision': 0.5180723, 'binary_recall': 0.4472511, 'binary_specificity': 0.98450214, 'binary_f1_score': 0.4800638}
confusion matrix:
       0    1
0  17787  280
1    372  301
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97550756, 'precision': 0.89198065, 'recall': 0.7720568, 'specificity': 0.7720568, 'f1': 0.8201369, 'auroc': 0.9249452, 'binary_precision': 0.8033708, 'binary_recall': 0.55, 'binary_specificity': 0.9941137, 'binary_f1_score': 0.65296805}
confusion matrix:
      0    1
0  5911   35
1   117  143
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316517_10.png
early stop counter: 1
val acc:0.965208113193512, best validation acc: 0.9654215574264526, corresponding to test acc:                         0.9753464460372925 / 0.975668728351593
after epoch: 10,now: 2024-06-14 02:58:17.889982,epoch time: 0:18:43.779557,used: 3:14:15.914095,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_23_44_01_seed_1_21316517
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9672565, 'precision': 0.73880917, 'recall': 0.5885499, 'specificity': 0.5885499, 'f1': 0.6260462, 'auroc': 0.9256419, 'binary_precision': 0.5047801, 'binary_recall': 0.18320611, 'binary_specificity': 0.9938937, 'binary_f1_score': 0.2688391}
confusion matrix:
       0    1
0  42156  259
1   1177  264
---- Validation: 
scalar performance:
{'acc': 0.9652081, 'precision': 0.74875444, 'recall': 0.7237446, 'specificity': 0.7237446, 'f1': 0.7355096, 'auroc': 0.92216766, 'binary_precision': 0.51741296, 'binary_recall': 0.46359584, 'binary_specificity': 0.9838933, 'binary_f1_score': 0.48902822}
confusion matrix:
       0    1
0  17776  291
1    361  312
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97582984, 'precision': 0.8932358, 'recall': 0.775903, 'specificity': 0.775903, 'f1': 0.8232808, 'auroc': 0.9259321, 'binary_precision': 0.8055556, 'binary_recall': 0.5576923, 'binary_specificity': 0.9941137, 'binary_f1_score': 0.6590909}
confusion matrix:
      0    1
0  5911   35
1   115  145
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316517_11.png
new oracle model saved
early stop counter: 2
val acc:0.965208113193512, best validation acc: 0.9654215574264526, corresponding to test acc:                         0.9753464460372925 / 0.9758298397064209
after epoch: 11,now: 2024-06-14 03:17:03.848619,epoch time: 0:18:45.958637,used: 3:33:01.872732,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_23_44_01_seed_1_21316517
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9669601, 'precision': 0.732523, 'recall': 0.579971, 'specificity': 0.579971, 'f1': 0.61558145, 'auroc': 0.92411613, 'binary_precision': 0.49278352, 'binary_recall': 0.16574202, 'binary_specificity': 0.99420005, 'binary_f1_score': 0.24805398}
confusion matrix:
       0    1
0  42168  246
1   1203  239
---- Validation: 
scalar performance:
{'acc': 0.9657951, 'precision': 0.75418293, 'recall': 0.705452, 'specificity': 0.705452, 'f1': 0.7269418, 'auroc': 0.9221809, 'binary_precision': 0.52962965, 'binary_recall': 0.42496285, 'binary_specificity': 0.98594123, 'binary_f1_score': 0.47155812}
confusion matrix:
       0    1
0  17813  254
1    387  286
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97534645, 'precision': 0.9037679, 'recall': 0.75726086, 'specificity': 0.75726086, 'f1': 0.8127681, 'auroc': 0.9254166, 'binary_precision': 0.82822084, 'binary_recall': 0.5192308, 'binary_specificity': 0.99529094, 'binary_f1_score': 0.63829786}
confusion matrix:
      0    1
0  5918   28
1   125  135
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316517_12.png
better model found
persisted
after epoch: 12,now: 2024-06-14 03:35:49.248789,epoch time: 0:18:45.400170,used: 3:51:47.272902,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_23_44_01_seed_1_21316517
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9676213, 'precision': 0.74582124, 'recall': 0.60945374, 'specificity': 0.60945374, 'f1': 0.64904535, 'auroc': 0.92588615, 'binary_precision': 0.51746035, 'binary_recall': 0.22607489, 'binary_specificity': 0.99283254, 'binary_f1_score': 0.3146718}
confusion matrix:
       0    1
0  42110  304
1   1116  326
---- Validation: 
scalar performance:
{'acc': 0.9647812, 'precision': 0.7453811, 'recall': 0.7249537, 'specificity': 0.7249537, 'f1': 0.73467076, 'auroc': 0.92349243, 'binary_precision': 0.5105691, 'binary_recall': 0.4665676, 'binary_specificity': 0.9833398, 'binary_f1_score': 0.48757762}
confusion matrix:
       0    1
0  17766  301
1    359  314
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9756687, 'precision': 0.8894434, 'recall': 0.77765787, 'specificity': 0.77765787, 'f1': 0.82326317, 'auroc': 0.92657447, 'binary_precision': 0.7978142, 'binary_recall': 0.56153846, 'binary_specificity': 0.99377733, 'binary_f1_score': 0.65914226}
confusion matrix:
      0    1
0  5909   37
1   114  146
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316517_13.png
early stop counter: 1
val acc:0.9647812247276306, best validation acc: 0.96579509973526, corresponding to test acc:                         0.9753464460372925 / 0.9758298397064209
after epoch: 13,now: 2024-06-14 03:54:37.493919,epoch time: 0:18:48.245130,used: 4:10:35.518032,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_23_44_01_seed_1_21316517
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96791774, 'precision': 0.74960613, 'recall': 0.63003904, 'specificity': 0.63003904, 'f1': 0.66921645, 'auroc': 0.92626655, 'binary_precision': 0.5236806, 'binary_recall': 0.26837724, 'binary_specificity': 0.9917008, 'binary_f1_score': 0.35488307}
confusion matrix:
       0    1
0  42062  352
1   1055  387
---- Validation: 
scalar performance:
{'acc': 0.96515477, 'precision': 0.7483563, 'recall': 0.74159855, 'specificity': 0.74159855, 'f1': 0.74492526, 'auroc': 0.9240914, 'binary_precision': 0.5152905, 'binary_recall': 0.5007429, 'binary_specificity': 0.9824542, 'binary_f1_score': 0.5079126}
confusion matrix:
       0    1
0  17750  317
1    336  337
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97631323, 'precision': 0.8919318, 'recall': 0.7853502, 'specificity': 0.7853502, 'f1': 0.82942754, 'auroc': 0.9267885, 'binary_precision': 0.80213904, 'binary_recall': 0.5769231, 'binary_specificity': 0.99377733, 'binary_f1_score': 0.6711409}
confusion matrix:
      0    1
0  5909   37
1   110  150
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316517_14.png
new oracle model saved
early stop counter: 2
val acc:0.965154767036438, best validation acc: 0.96579509973526, corresponding to test acc:                         0.9753464460372925 / 0.9763132333755493
after epoch: 14,now: 2024-06-14 04:13:25.754673,epoch time: 0:18:48.260754,used: 4:29:23.778786,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_23_44_01_seed_1_21316517
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9673933, 'precision': 0.7417015, 'recall': 0.63177764, 'specificity': 0.63177764, 'f1': 0.66898364, 'auroc': 0.9313139, 'binary_precision': 0.50775194, 'binary_recall': 0.27253816, 'binary_specificity': 0.9910171, 'binary_f1_score': 0.35469314}
confusion matrix:
       0    1
0  42033  381
1   1049  393
---- Validation: 
scalar performance:
{'acc': 0.9653682, 'precision': 0.7499478, 'recall': 0.7402787, 'specificity': 0.7402787, 'f1': 0.74500656, 'auroc': 0.92479604, 'binary_precision': 0.51857585, 'binary_recall': 0.49777117, 'binary_specificity': 0.9827863, 'binary_f1_score': 0.50796056}
confusion matrix:
       0    1
0  17756  311
1    338  335
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9764744, 'precision': 0.8925396, 'recall': 0.7872733, 'specificity': 0.7872733, 'f1': 0.8309519, 'auroc': 0.92718315, 'binary_precision': 0.8031915, 'binary_recall': 0.58076924, 'binary_specificity': 0.99377733, 'binary_f1_score': 0.67410713}
confusion matrix:
      0    1
0  5909   37
1   109  151
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316517_15.png
new oracle model saved
early stop counter: 3
val acc:0.9653682112693787, best validation acc: 0.96579509973526, corresponding to test acc:                         0.9753464460372925 / 0.976474404335022
after epoch: 15,now: 2024-06-14 04:32:10.808717,epoch time: 0:18:45.054044,used: 4:48:08.832830,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_23_44_01_seed_1_21316517
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9671653, 'precision': 0.7378286, 'recall': 0.6082131, 'specificity': 0.6082131, 'f1': 0.6464331, 'auroc': 0.92675984, 'binary_precision': 0.5015528, 'binary_recall': 0.22399445, 'binary_specificity': 0.99243176, 'binary_f1_score': 0.30968362}
confusion matrix:
       0    1
0  42093  321
1   1119  323
---- Validation: 
scalar performance:
{'acc': 0.9654749, 'precision': 0.7510981, 'recall': 0.7131539, 'specificity': 0.7131539, 'f1': 0.7303963, 'auroc': 0.924783, 'binary_precision': 0.52288735, 'binary_recall': 0.44130757, 'binary_specificity': 0.98500025, 'binary_f1_score': 0.47864628}
confusion matrix:
       0    1
0  17796  271
1    376  297
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9766355, 'precision': 0.9084352, 'recall': 0.7726455, 'specificity': 0.7726455, 'f1': 0.82573533, 'auroc': 0.9265392, 'binary_precision': 0.83625734, 'binary_recall': 0.55, 'binary_specificity': 0.99529094, 'binary_f1_score': 0.6635731}
confusion matrix:
      0    1
0  5918   28
1   117  143
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316517_16.png
new oracle model saved
early stop counter: 4
val acc:0.9654749035835266, best validation acc: 0.96579509973526, corresponding to test acc:                         0.9753464460372925 / 0.9766355156898499
after epoch: 16,now: 2024-06-14 04:51:00.075451,epoch time: 0:18:49.266734,used: 5:06:58.099564,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_23_44_01_seed_1_21316517
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9675301, 'precision': 0.743788, 'recall': 0.6251493, 'specificity': 0.6251493, 'f1': 0.66356605, 'auroc': 0.93151534, 'binary_precision': 0.51236266, 'binary_recall': 0.2586685, 'binary_specificity': 0.99163014, 'binary_f1_score': 0.34377882}
confusion matrix:
       0    1
0  42059  355
1   1069  373
---- Validation: 
scalar performance:
{'acc': 0.9653148, 'precision': 0.7497318, 'recall': 0.7123556, 'specificity': 0.7123556, 'f1': 0.7293568, 'auroc': 0.92521155, 'binary_precision': 0.5202109, 'binary_recall': 0.4398217, 'binary_specificity': 0.98488957, 'binary_f1_score': 0.47665057}
confusion matrix:
       0    1
0  17794  273
1    377  296
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97631323, 'precision': 0.90730387, 'recall': 0.7687993, 'specificity': 0.7687993, 'f1': 0.8225376, 'auroc': 0.92668843, 'binary_precision': 0.83431953, 'binary_recall': 0.5423077, 'binary_specificity': 0.99529094, 'binary_f1_score': 0.6573426}
confusion matrix:
      0    1
0  5918   28
1   119  141
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316517_17.png
early stop counter: 5
val acc:0.9653148055076599, best validation acc: 0.96579509973526, corresponding to test acc:                         0.9753464460372925 / 0.9766355156898499
after epoch: 17,now: 2024-06-14 05:09:48.790889,epoch time: 0:18:48.715438,used: 5:25:46.815002,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_23_44_01_seed_1_21316517
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9679861, 'precision': 0.75328887, 'recall': 0.6039482, 'specificity': 0.6039482, 'f1': 0.6446266, 'auroc': 0.9309405, 'binary_precision': 0.5327586, 'binary_recall': 0.21428572, 'binary_specificity': 0.9936106, 'binary_f1_score': 0.305638}
confusion matrix:
       0    1
0  42143  271
1   1133  309
---- Validation: 
scalar performance:
{'acc': 0.9653682, 'precision': 0.75102484, 'recall': 0.679481, 'specificity': 0.679481, 'f1': 0.70864874, 'auroc': 0.9252385, 'binary_precision': 0.5252101, 'binary_recall': 0.37147102, 'binary_specificity': 0.987491, 'binary_f1_score': 0.43516102}
confusion matrix:
       0    1
0  17841  226
1    423  250
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97550756, 'precision': 0.9191843, 'recall': 0.746311, 'specificity': 0.746311, 'f1': 0.80830187, 'auroc': 0.9264554, 'binary_precision': 0.86, 'binary_recall': 0.49615383, 'binary_specificity': 0.9964682, 'binary_f1_score': 0.6292683}
confusion matrix:
      0    1
0  5925   21
1   131  129
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316517_18.png
early stop counter: 6
val acc:0.9653682112693787, best validation acc: 0.96579509973526, corresponding to test acc:                         0.9753464460372925 / 0.9766355156898499
after epoch: 18,now: 2024-06-14 05:28:35.514270,epoch time: 0:18:46.723381,used: 5:44:33.538383,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_23_44_01_seed_1_21316517
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.96718806, 'precision': 0.7376441, 'recall': 0.5737248, 'specificity': 0.5737248, 'f1': 0.608701, 'auroc': 0.9314637, 'binary_precision': 0.5034325, 'binary_recall': 0.15256588, 'binary_specificity': 0.9948838, 'binary_f1_score': 0.23416711}
confusion matrix:
       0    1
0  42197  217
1   1222  220
---- Validation: 
scalar performance:
{'acc': 0.96568835, 'precision': 0.75568956, 'recall': 0.6610501, 'specificity': 0.6610501, 'f1': 0.69648117, 'auroc': 0.92558193, 'binary_precision': 0.53588516, 'binary_recall': 0.33283803, 'binary_specificity': 0.98926216, 'binary_f1_score': 0.41063246}
confusion matrix:
       0    1
0  17873  194
1    449  224
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97486305, 'precision': 0.92695224, 'recall': 0.7312628, 'specificity': 0.7312628, 'f1': 0.7975277, 'auroc': 0.9266913, 'binary_precision': 0.8768116, 'binary_recall': 0.4653846, 'binary_specificity': 0.99714094, 'binary_f1_score': 0.6080402}
confusion matrix:
      0    1
0  5929   17
1   139  121
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316517_19.png
early stop counter: 7
val acc:0.9656883478164673, best validation acc: 0.96579509973526, corresponding to test acc:                         0.9753464460372925 / 0.9766355156898499
after epoch: 19,now: 2024-06-14 05:47:27.258935,epoch time: 0:18:51.744665,used: 6:03:25.283048,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_23_44_01_seed_1_21316517
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9675301, 'precision': 0.74380624, 'recall': 0.62414443, 'specificity': 0.62414443, 'f1': 0.6626568, 'auroc': 0.93238074, 'binary_precision': 0.51246536, 'binary_recall': 0.25658807, 'binary_specificity': 0.9917008, 'binary_f1_score': 0.3419593}
confusion matrix:
       0    1
0  42062  352
1   1072  370
---- Validation: 
scalar performance:
{'acc': 0.96499467, 'precision': 0.74701583, 'recall': 0.7057522, 'specificity': 0.7057522, 'f1': 0.7242851, 'auroc': 0.9263605, 'binary_precision': 0.51526034, 'binary_recall': 0.42644873, 'binary_specificity': 0.9850556, 'binary_f1_score': 0.4666667}
confusion matrix:
       0    1
0  17797  270
1    386  287
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97631323, 'precision': 0.9111972, 'recall': 0.76512134, 'specificity': 0.76512134, 'f1': 0.82092714, 'auroc': 0.92681444, 'binary_precision': 0.8424242, 'binary_recall': 0.5346154, 'binary_specificity': 0.9956273, 'binary_f1_score': 0.65411764}
confusion matrix:
      0    1
0  5920   26
1   121  139
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316517_20.png
early stop counter: 8
val acc:0.9649946689605713, best validation acc: 0.96579509973526, corresponding to test acc:                         0.9753464460372925 / 0.9766355156898499
after epoch: 20,now: 2024-06-14 06:06:24.852560,epoch time: 0:18:57.593625,used: 6:22:22.876673,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_23_44_01_seed_1_21316517
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9675985, 'precision': 0.7450516, 'recall': 0.6184856, 'specificity': 0.6184856, 'f1': 0.65765977, 'auroc': 0.93447375, 'binary_precision': 0.51532847, 'binary_recall': 0.24479888, 'binary_specificity': 0.9921724, 'binary_f1_score': 0.3319229}
confusion matrix:
       0    1
0  42082  332
1   1089  353
---- Validation: 
scalar performance:
{'acc': 0.9653148, 'precision': 0.74982476, 'recall': 0.70591825, 'specificity': 0.70591825, 'f1': 0.7255131, 'auroc': 0.9266279, 'binary_precision': 0.52087116, 'binary_recall': 0.42644873, 'binary_specificity': 0.98538774, 'binary_f1_score': 0.46895427}
confusion matrix:
       0    1
0  17803  264
1    386  287
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97631323, 'precision': 0.91321856, 'recall': 0.76328236, 'specificity': 0.76328236, 'f1': 0.82011056, 'auroc': 0.92701745, 'binary_precision': 0.84662575, 'binary_recall': 0.5307692, 'binary_specificity': 0.9957955, 'binary_f1_score': 0.65248233}
confusion matrix:
      0    1
0  5921   25
1   122  138
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316517_21.png
early stop counter: 9
val acc:0.9653148055076599, best validation acc: 0.96579509973526, corresponding to test acc:                         0.9753464460372925 / 0.9766355156898499
after epoch: 21,now: 2024-06-14 06:25:27.152447,epoch time: 0:19:02.299887,used: 6:41:25.176560,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_23_44_01_seed_1_21316517
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.96709687, 'precision': 0.7369191, 'recall': 0.6152117, 'specificity': 0.6152117, 'f1': 0.65299594, 'auroc': 0.9320272, 'binary_precision': 0.4992743, 'binary_recall': 0.23855756, 'binary_specificity': 0.9918659, 'binary_f1_score': 0.32285312}
confusion matrix:
       0    1
0  42069  345
1   1098  344
---- Validation: 
scalar performance:
{'acc': 0.96526146, 'precision': 0.7494394, 'recall': 0.70016843, 'specificity': 0.70016843, 'f1': 0.7217951, 'auroc': 0.92696726, 'binary_precision': 0.5205224, 'binary_recall': 0.41456166, 'binary_specificity': 0.9857752, 'binary_f1_score': 0.46153843}
confusion matrix:
       0    1
0  17810  257
1    394  279
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97599095, 'precision': 0.91419256, 'recall': 0.7575972, 'specificity': 0.7575972, 'f1': 0.8159838, 'auroc': 0.92636627, 'binary_precision': 0.8490566, 'binary_recall': 0.5192308, 'binary_specificity': 0.9959637, 'binary_f1_score': 0.6443915}
confusion matrix:
      0    1
0  5922   24
1   125  135
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316517_22.png
early stop counter: 10
val acc:0.9652614593505859, best validation acc: 0.96579509973526, corresponding to test acc:                         0.9753464460372925 / 0.9766355156898499
after epoch: 22,now: 2024-06-14 06:44:29.981634,epoch time: 0:19:02.829187,used: 7:00:28.005747,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_23_44_01_seed_1_21316517
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9675529, 'precision': 0.7447151, 'recall': 0.6064038, 'specificity': 0.6064038, 'f1': 0.64580137, 'auroc': 0.93341094, 'binary_precision': 0.51544714, 'binary_recall': 0.21983357, 'binary_specificity': 0.99297404, 'binary_f1_score': 0.30821586}
confusion matrix:
       0    1
0  42116  298
1   1125  317
---- Validation: 
scalar performance:
{'acc': 0.96515477, 'precision': 0.74881685, 'recall': 0.6800856, 'specificity': 0.6800856, 'f1': 0.7083278, 'auroc': 0.9273153, 'binary_precision': 0.5207469, 'binary_recall': 0.3729569, 'binary_specificity': 0.98721427, 'binary_f1_score': 0.434632}
confusion matrix:
       0    1
0  17836  231
1    422  251
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97582984, 'precision': 0.92260015, 'recall': 0.7483182, 'specificity': 0.7483182, 'f1': 0.81082416, 'auroc': 0.9269353, 'binary_precision': 0.8666667, 'binary_recall': 0.5, 'binary_specificity': 0.9966364, 'binary_f1_score': 0.63414633}
confusion matrix:
      0    1
0  5926   20
1   130  130
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316517_23.png
early stop counter: 11
val acc:0.965154767036438, best validation acc: 0.96579509973526, corresponding to test acc:                         0.9753464460372925 / 0.9766355156898499
after epoch: 23,now: 2024-06-14 07:03:30.932608,epoch time: 0:19:00.950974,used: 7:19:28.956721,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_23_44_01_seed_1_21316517
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9674845, 'precision': 0.743183, 'recall': 0.6184267, 'specificity': 0.6184267, 'f1': 0.65724087, 'auroc': 0.93402445, 'binary_precision': 0.5115942, 'binary_recall': 0.24479888, 'binary_specificity': 0.9920545, 'binary_f1_score': 0.33114445}
confusion matrix:
       0    1
0  42077  337
1   1089  353
---- Validation: 
scalar performance:
{'acc': 0.96526146, 'precision': 0.749383, 'recall': 0.70374477, 'specificity': 0.70374477, 'f1': 0.7240013, 'auroc': 0.9276468, 'binary_precision': 0.52014655, 'binary_recall': 0.42199108, 'binary_specificity': 0.9854984, 'binary_f1_score': 0.46595573}
confusion matrix:
       0    1
0  17805  262
1    389  284
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9767966, 'precision': 0.9190024, 'recall': 0.7653736, 'specificity': 0.7653736, 'f1': 0.8233789, 'auroc': 0.9275856, 'binary_precision': 0.8580247, 'binary_recall': 0.5346154, 'binary_specificity': 0.99613184, 'binary_f1_score': 0.6587678}
confusion matrix:
      0    1
0  5923   23
1   121  139
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316517_24.png
new oracle model saved
early stop counter: 12
val acc:0.9652614593505859, best validation acc: 0.96579509973526, corresponding to test acc:                         0.9753464460372925 / 0.9767966270446777
after epoch: 24,now: 2024-06-14 07:22:34.223472,epoch time: 0:19:03.290864,used: 7:38:32.247585,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_23_44_01_seed_1_21316517
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9679405, 'precision': 0.75295377, 'recall': 0.5995702, 'specificity': 0.5995702, 'f1': 0.63994646, 'auroc': 0.93458056, 'binary_precision': 0.5323741, 'binary_recall': 0.20527045, 'binary_specificity': 0.99386996, 'binary_f1_score': 0.29629627}
confusion matrix:
       0    1
0  42154  260
1   1146  296
---- Validation: 
scalar performance:
{'acc': 0.9659018, 'precision': 0.7576593, 'recall': 0.6675982, 'specificity': 0.6675982, 'f1': 0.7020762, 'auroc': 0.92795837, 'binary_precision': 0.5393519, 'binary_recall': 0.346211, 'binary_specificity': 0.9889854, 'binary_f1_score': 0.42171946}
confusion matrix:
       0    1
0  17868  199
1    440  233
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9756687, 'precision': 0.9295088, 'recall': 0.74087816, 'specificity': 0.74087816, 'f1': 0.8063681, 'auroc': 0.92721575, 'binary_precision': 0.8811189, 'binary_recall': 0.4846154, 'binary_specificity': 0.99714094, 'binary_f1_score': 0.6253101}
confusion matrix:
      0    1
0  5929   17
1   134  126
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316517_25.png
better model found
persisted
after epoch: 25,now: 2024-06-14 07:41:34.431486,epoch time: 0:19:00.208014,used: 7:57:32.455599,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_23_44_01_seed_1_21316517
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9676669, 'precision': 0.748006, 'recall': 0.5917249, 'specificity': 0.5917249, 'f1': 0.6307336, 'auroc': 0.9330722, 'binary_precision': 0.5229885, 'binary_recall': 0.18932039, 'binary_specificity': 0.9941293, 'binary_f1_score': 0.27800405}
confusion matrix:
       0    1
0  42165  249
1   1169  273
---- Validation: 
scalar performance:
{'acc': 0.9659552, 'precision': 0.758151, 'recall': 0.6690564, 'specificity': 0.6690564, 'f1': 0.70332336, 'auroc': 0.92813385, 'binary_precision': 0.54022986, 'binary_recall': 0.34918275, 'binary_specificity': 0.9889301, 'binary_f1_score': 0.42418772}
confusion matrix:
       0    1
0  17867  200
1    438  235
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97550756, 'precision': 0.92900956, 'recall': 0.7389551, 'specificity': 0.7389551, 'f1': 0.8046173, 'auroc': 0.92725945, 'binary_precision': 0.8802817, 'binary_recall': 0.48076922, 'binary_specificity': 0.99714094, 'binary_f1_score': 0.6218906}
confusion matrix:
      0    1
0  5929   17
1   135  125
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316517_26.png
better model found
persisted
after epoch: 26,now: 2024-06-14 08:00:30.685780,epoch time: 0:18:56.254294,used: 8:16:28.709893,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_23_44_01_seed_1_21316517
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.96825975, 'precision': 0.7544161, 'recall': 0.636245, 'specificity': 0.636245, 'f1': 0.6757843, 'auroc': 0.9338058, 'binary_precision': 0.53289473, 'binary_recall': 0.28085992, 'binary_specificity': 0.99163014, 'binary_f1_score': 0.36784738}
confusion matrix:
       0    1
0  42059  355
1   1037  405
---- Validation: 
scalar performance:
{'acc': 0.9652081, 'precision': 0.74880314, 'recall': 0.71444607, 'specificity': 0.71444607, 'f1': 0.73020196, 'auroc': 0.9286442, 'binary_precision': 0.5181976, 'binary_recall': 0.44427934, 'binary_specificity': 0.9846128, 'binary_f1_score': 0.4784}
confusion matrix:
       0    1
0  17789  278
1    374  299
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97631323, 'precision': 0.9092263, 'recall': 0.7669604, 'specificity': 0.7669604, 'f1': 0.8217362, 'auroc': 0.9271122, 'binary_precision': 0.83832335, 'binary_recall': 0.53846157, 'binary_specificity': 0.99545914, 'binary_f1_score': 0.6557377}
confusion matrix:
      0    1
0  5919   27
1   120  140
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316517_27.png
early stop counter: 1
val acc:0.965208113193512, best validation acc: 0.9659551978111267, corresponding to test acc:                         0.9755075573921204 / 0.9767966270446777
after epoch: 27,now: 2024-06-14 08:19:26.768542,epoch time: 0:18:56.082762,used: 8:35:24.792655,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_23_44_01_seed_1_21316517
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.966732, 'precision': 0.73290443, 'recall': 0.636795, 'specificity': 0.636795, 'f1': 0.6710836, 'auroc': 0.9343401, 'binary_precision': 0.48982036, 'binary_recall': 0.28363383, 'binary_specificity': 0.98995614, 'binary_f1_score': 0.35924459}
confusion matrix:
       0    1
0  41988  426
1   1033  409
---- Validation: 
scalar performance:
{'acc': 0.9653682, 'precision': 0.7500638, 'recall': 0.722397, 'specificity': 0.722397, 'f1': 0.73532546, 'auroc': 0.92895323, 'binary_precision': 0.5201342, 'binary_recall': 0.46062407, 'binary_specificity': 0.98417, 'binary_f1_score': 0.48857367}
confusion matrix:
       0    1
0  17781  286
1    363  310
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9767966, 'precision': 0.9089924, 'recall': 0.77456856, 'specificity': 0.77456856, 'f1': 0.8273233, 'auroc': 0.9276417, 'binary_precision': 0.8372093, 'binary_recall': 0.5538462, 'binary_specificity': 0.99529094, 'binary_f1_score': 0.6666667}
confusion matrix:
      0    1
0  5918   28
1   116  144
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316517_28.png
early stop counter: 2
val acc:0.9653682112693787, best validation acc: 0.9659551978111267, corresponding to test acc:                         0.9755075573921204 / 0.9767966270446777
after epoch: 28,now: 2024-06-14 08:38:16.538596,epoch time: 0:18:49.770054,used: 8:54:14.562709,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_23_44_01_seed_1_21316517
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9679405, 'precision': 0.7494997, 'recall': 0.63775474, 'specificity': 0.63775474, 'f1': 0.67596334, 'auroc': 0.93628544, 'binary_precision': 0.5229592, 'binary_recall': 0.28432733, 'binary_specificity': 0.99118215, 'binary_f1_score': 0.36837375}
confusion matrix:
       0    1
0  42040  374
1   1032  410
---- Validation: 
scalar performance:
{'acc': 0.96499467, 'precision': 0.74701357, 'recall': 0.70789796, 'specificity': 0.70789796, 'f1': 0.72557807, 'auroc': 0.9291023, 'binary_precision': 0.5150977, 'binary_recall': 0.4309064, 'binary_specificity': 0.98488957, 'binary_f1_score': 0.46925566}
confusion matrix:
       0    1
0  17794  273
1    383  290
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9766355, 'precision': 0.9163688, 'recall': 0.76528955, 'specificity': 0.76528955, 'f1': 0.82255805, 'auroc': 0.9276398, 'binary_precision': 0.85276073, 'binary_recall': 0.5346154, 'binary_specificity': 0.9959637, 'binary_f1_score': 0.65721047}
confusion matrix:
      0    1
0  5922   24
1   121  139
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316517_29.png
early stop counter: 3
val acc:0.9649946689605713, best validation acc: 0.9659551978111267, corresponding to test acc:                         0.9755075573921204 / 0.9767966270446777
after epoch: 29,now: 2024-06-14 08:57:03.616075,epoch time: 0:18:47.077479,used: 9:13:01.640188,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_23_44_01_seed_1_21316517
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9672565, 'precision': 0.73941594, 'recall': 0.609935, 'specificity': 0.609935, 'f1': 0.64840186, 'auroc': 0.9362742, 'binary_precision': 0.50461537, 'binary_recall': 0.22746186, 'binary_specificity': 0.99240816, 'binary_f1_score': 0.3135755}
confusion matrix:
       0    1
0  42092  322
1   1114  328
---- Validation: 
scalar performance:
{'acc': 0.965048, 'precision': 0.7476613, 'recall': 0.6850371, 'specificity': 0.6850371, 'f1': 0.71130466, 'auroc': 0.92893314, 'binary_precision': 0.5180723, 'binary_recall': 0.3833581, 'binary_specificity': 0.9867161, 'binary_f1_score': 0.44064903}
confusion matrix:
       0    1
0  17827  240
1    415  258
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97599095, 'precision': 0.92796516, 'recall': 0.7465633, 'specificity': 0.7465633, 'f1': 0.8107475, 'auroc': 0.92698437, 'binary_precision': 0.877551, 'binary_recall': 0.49615383, 'binary_specificity': 0.99697274, 'binary_f1_score': 0.6339066}
confusion matrix:
      0    1
0  5928   18
1   131  129
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316517_30.png
early stop counter: 4
val acc:0.9650480151176453, best validation acc: 0.9659551978111267, corresponding to test acc:                         0.9755075573921204 / 0.9767966270446777
after epoch: 30,now: 2024-06-14 09:15:50.534604,epoch time: 0:18:46.918529,used: 9:31:48.558717,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_23_44_01_seed_1_21316517
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 9:31:48.558717 at 2024-06-14 09:15:50.534604
persisted model performance metric: 

scalar performance:
{'acc': 0.97550756, 'precision': 0.92900956, 'recall': 0.7389551, 'specificity': 0.7389551, 'f1': 0.8046173, 'auroc': 0.92725945, 'binary_precision': 0.8802817, 'binary_recall': 0.48076922, 'binary_specificity': 0.99714094, 'binary_f1_score': 0.6218906}
confusion matrix:
      0    1
0  5929   17
1   135  125
oracle model performance metric: 

scalar performance:
{'acc': 0.9767966, 'precision': 0.9190024, 'recall': 0.7653736, 'specificity': 0.7653736, 'f1': 0.8233789, 'auroc': 0.9275856, 'binary_precision': 0.8580247, 'binary_recall': 0.5346154, 'binary_specificity': 0.99613184, 'binary_f1_score': 0.6587678}
confusion matrix:
      0    1
0  5923   23
1   121  139
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_vit_resnet_dinov2_bs16_different_learningrates/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_vit_resnet_dinov2_bs16_different_learningrates/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 190959 KiB | 461403 KiB |    898 TiB |    898 TiB |
|       from large pool | 173494 KiB | 428048 KiB |    880 TiB |    880 TiB |
|       from small pool |  17465 KiB |  38507 KiB |     18 TiB |     18 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 190959 KiB | 461403 KiB |    898 TiB |    898 TiB |
|       from large pool | 173494 KiB | 428048 KiB |    880 TiB |    880 TiB |
|       from small pool |  17465 KiB |  38507 KiB |     18 TiB |     18 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 189280 KiB | 457564 KiB |    898 TiB |    898 TiB |
|       from large pool | 172814 KiB | 424940 KiB |    880 TiB |    880 TiB |
|       from small pool |  16466 KiB |  37503 KiB |     18 TiB |     18 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 526336 KiB | 526336 KiB |    792 MiB | 284672 KiB |
|       from large pool | 487424 KiB | 487424 KiB |    738 MiB | 268288 KiB |
|       from small pool |  38912 KiB |  43008 KiB |     54 MiB |  16384 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  38416 KiB |  85570 KiB | 554060 GiB | 554060 GiB |
|       from large pool |  31306 KiB |  79555 KiB | 534846 GiB | 534846 GiB |
|       from small pool |   7110 KiB |  20341 KiB |  19214 GiB |  19214 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2942    |    5945    |  197371 K  |  197368 K  |
|       from large pool |      76    |     158    |   88846 K  |   88846 K  |
|       from small pool |    2866    |    5868    |  108525 K  |  108522 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2942    |    5945    |  197371 K  |  197368 K  |
|       from large pool |      76    |     158    |   88846 K  |   88846 K  |
|       from small pool |    2866    |    5868    |  108525 K  |  108522 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      41    |      42    |      60    |      19    |
|       from large pool |      22    |      22    |      33    |      11    |
|       from small pool |      19    |      21    |      27    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      29    |    2758    |  110710 K  |  110710 K  |
|       from large pool |      10    |      22    |   58398 K  |   58398 K  |
|       from small pool |      19    |    2748    |   52312 K  |   52312 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 461403 KiB |    898 TiB |    898 TiB |
|       from large pool |  17088 KiB | 428048 KiB |    880 TiB |    880 TiB |
|       from small pool |      0 KiB |  38507 KiB |     18 TiB |     18 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 461403 KiB |    898 TiB |    898 TiB |
|       from large pool |  17088 KiB | 428048 KiB |    880 TiB |    880 TiB |
|       from small pool |      0 KiB |  38507 KiB |     18 TiB |     18 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457564 KiB |    898 TiB |    898 TiB |
|       from large pool |  16640 KiB | 424940 KiB |    880 TiB |    880 TiB |
|       from small pool |      0 KiB |  37503 KiB |     18 TiB |     18 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 229376 KiB | 526336 KiB |    792 MiB | 581632 KiB |
|       from large pool | 204800 KiB | 487424 KiB |    738 MiB | 550912 KiB |
|       from small pool |  24576 KiB |  43008 KiB |     54 MiB |  30720 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  85570 KiB | 554060 GiB | 554060 GiB |
|       from large pool |  23872 KiB |  79555 KiB | 534846 GiB | 534846 GiB |
|       from small pool |      0 KiB |  21236 KiB |  19214 GiB |  19214 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    5945    |  197371 K  |  197371 K  |
|       from large pool |       2    |     158    |   88846 K  |   88846 K  |
|       from small pool |       0    |    5868    |  108525 K  |  108525 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    5945    |  197371 K  |  197371 K  |
|       from large pool |       2    |     158    |   88846 K  |   88846 K  |
|       from small pool |       0    |    5868    |  108525 K  |  108525 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |      42    |      60    |      38    |
|       from large pool |      10    |      22    |      33    |      23    |
|       from small pool |      12    |      21    |      27    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2758    |  110712 K  |  110712 K  |
|       from large pool |       3    |      22    |   58398 K  |   58398 K  |
|       from small pool |       0    |    2748    |   52313 K  |   52313 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 461403 KiB |    898 TiB |    898 TiB |
|       from large pool |  17088 KiB | 428048 KiB |    880 TiB |    880 TiB |
|       from small pool |      0 KiB |  38507 KiB |     18 TiB |     18 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 461403 KiB |    898 TiB |    898 TiB |
|       from large pool |  17088 KiB | 428048 KiB |    880 TiB |    880 TiB |
|       from small pool |      0 KiB |  38507 KiB |     18 TiB |     18 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457564 KiB |    898 TiB |    898 TiB |
|       from large pool |  16640 KiB | 424940 KiB |    880 TiB |    880 TiB |
|       from small pool |      0 KiB |  37503 KiB |     18 TiB |     18 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 229376 KiB | 526336 KiB |    792 MiB | 581632 KiB |
|       from large pool | 204800 KiB | 487424 KiB |    738 MiB | 550912 KiB |
|       from small pool |  24576 KiB |  43008 KiB |     54 MiB |  30720 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  85570 KiB | 554060 GiB | 554060 GiB |
|       from large pool |  23872 KiB |  79555 KiB | 534846 GiB | 534846 GiB |
|       from small pool |      0 KiB |  21236 KiB |  19214 GiB |  19214 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    5945    |  197371 K  |  197371 K  |
|       from large pool |       2    |     158    |   88846 K  |   88846 K  |
|       from small pool |       0    |    5868    |  108525 K  |  108525 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    5945    |  197371 K  |  197371 K  |
|       from large pool |       2    |     158    |   88846 K  |   88846 K  |
|       from small pool |       0    |    5868    |  108525 K  |  108525 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |      42    |      60    |      38    |
|       from large pool |      10    |      22    |      33    |      23    |
|       from small pool |      12    |      21    |      27    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2758    |  110712 K  |  110712 K  |
|       from large pool |       3    |      22    |   58398 K  |   58398 K  |
|       from small pool |       0    |    2748    |   52313 K  |   52313 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0




!!!: not committed yet



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_09_24_21_seed_2_21316517

 Experiment start at: 2024-06-14 09:24:21.826577
before training, model accuracy: 0.754768431186676
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96545273, 'precision': 0.72577524, 'recall': 0.5054053, 'specificity': 0.5054053, 'f1': 0.5021898, 'auroc': 0.8587282, 'binary_precision': 0.4857143, 'binary_recall': 0.011235955, 'binary_specificity': 0.9995746, 'binary_f1_score': 0.021963825}
confusion matrix:
       0   1
0  42293  18
1   1496  17
---- Validation: 
scalar performance:
{'acc': 0.96681404, 'precision': 0.7055134, 'recall': 0.56045383, 'specificity': 0.56045383, 'f1': 0.5895932, 'auroc': 0.8603349, 'binary_precision': 0.43930635, 'binary_recall': 0.12624584, 'binary_specificity': 0.9946618, 'binary_f1_score': 0.19612902}
confusion matrix:
       0   1
0  18074  97
1    526  76
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96008974, 'precision': 0.6750239, 'recall': 0.5232093, 'specificity': 0.5232093, 'f1': 0.5337553, 'auroc': 0.7908148, 'binary_precision': 0.38709676, 'binary_recall': 0.049586777, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.08791209}
confusion matrix:
      0   1
0  5978  19
1   230  12
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316517_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-14 09:44:15.221789,epoch time: 0:19:53.395212,used: 0:19:53.395212,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_09_24_21_seed_2_21316517
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96611446, 'precision': 0.7599747, 'recall': 0.54655534, 'specificity': 0.54655534, 'f1': 0.57304364, 'auroc': 0.8866459, 'binary_precision': 0.5513308, 'binary_recall': 0.09589947, 'binary_specificity': 0.9972112, 'binary_f1_score': 0.1633803}
confusion matrix:
       0    1
0  42194  118
1   1367  145
---- Validation: 
scalar performance:
{'acc': 0.96532255, 'precision': 0.71053123, 'recall': 0.65283704, 'specificity': 0.65283704, 'f1': 0.6765921, 'auroc': 0.88727874, 'binary_precision': 0.44341803, 'binary_recall': 0.31893688, 'binary_specificity': 0.98673713, 'binary_f1_score': 0.3710145}
confusion matrix:
       0    1
0  17930  241
1    410  192
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96473795, 'precision': 0.81492054, 'recall': 0.5910576, 'specificity': 0.5910576, 'f1': 0.63612115, 'auroc': 0.8633771, 'binary_precision': 0.6617647, 'binary_recall': 0.18595041, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.29032257}
confusion matrix:
      0   1
0  5974  23
1   197  45
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316517_2.png
new oracle model saved
early stop counter: 1
val acc:0.9653225541114807, best validation acc: 0.9668140411376953, corresponding to test acc:                         0.9600897431373596 / 0.9647379517555237
after epoch: 2,now: 2024-06-14 10:03:05.592641,epoch time: 0:18:50.370852,used: 0:38:43.766064,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_09_24_21_seed_2_21316517
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9661829, 'precision': 0.7564261, 'recall': 0.56250346, 'specificity': 0.56250346, 'f1': 0.5955279, 'auroc': 0.89916813, 'binary_precision': 0.54317546, 'binary_recall': 0.12888302, 'binary_specificity': 0.9961239, 'binary_f1_score': 0.20833334}
confusion matrix:
       0    1
0  42147  164
1   1318  195
---- Validation: 
scalar performance:
{'acc': 0.9655356, 'precision': 0.7197023, 'recall': 0.69952387, 'specificity': 0.69952387, 'f1': 0.7090723, 'auroc': 0.8976098, 'binary_precision': 0.4587156, 'binary_recall': 0.4152824, 'binary_specificity': 0.98376536, 'binary_f1_score': 0.4359198}
confusion matrix:
       0    1
0  17876  295
1    352  250
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9713095, 'precision': 0.8601454, 'recall': 0.69559574, 'specificity': 0.69559574, 'f1': 0.7513677, 'auroc': 0.8836374, 'binary_precision': 0.74418604, 'binary_recall': 0.3966942, 'binary_specificity': 0.99449724, 'binary_f1_score': 0.51752025}
confusion matrix:
      0   1
0  5964  33
1   146  96
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316517_3.png
new oracle model saved
early stop counter: 2
val acc:0.965535581111908, best validation acc: 0.9668140411376953, corresponding to test acc:                         0.9600897431373596 / 0.9713094830513
after epoch: 3,now: 2024-06-14 10:21:58.672523,epoch time: 0:18:53.079882,used: 0:57:36.845946,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_09_24_21_seed_2_21316517
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96577215, 'precision': 0.74229795, 'recall': 0.57631147, 'specificity': 0.57631147, 'f1': 0.6120746, 'auroc': 0.90727365, 'binary_precision': 0.5139785, 'binary_recall': 0.1579643, 'binary_specificity': 0.9946586, 'binary_f1_score': 0.24165823}
confusion matrix:
       0    1
0  42085  226
1   1274  239
---- Validation: 
scalar performance:
{'acc': 0.96596175, 'precision': 0.7236582, 'recall': 0.7045623, 'specificity': 0.7045623, 'f1': 0.7136366, 'auroc': 0.9029902, 'binary_precision': 0.46630237, 'binary_recall': 0.42524916, 'binary_specificity': 0.9838754, 'binary_f1_score': 0.44483057}
confusion matrix:
       0    1
0  17878  293
1    346  256
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97339314, 'precision': 0.8677069, 'recall': 0.72840345, 'specificity': 0.72840345, 'f1': 0.7803132, 'auroc': 0.8916843, 'binary_precision': 0.7567568, 'binary_recall': 0.46280992, 'binary_specificity': 0.993997, 'binary_f1_score': 0.574359}
confusion matrix:
      0    1
0  5961   36
1   130  112
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316517_4.png
new oracle model saved
early stop counter: 3
val acc:0.965961754322052, best validation acc: 0.9668140411376953, corresponding to test acc:                         0.9600897431373596 / 0.9733931422233582
after epoch: 4,now: 2024-06-14 10:41:00.400722,epoch time: 0:19:01.728199,used: 1:16:38.574145,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_09_24_21_seed_2_21316517
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9654983, 'precision': 0.7373581, 'recall': 0.62683535, 'specificity': 0.62683535, 'f1': 0.663585, 'auroc': 0.9103563, 'binary_precision': 0.50062895, 'binary_recall': 0.26305354, 'binary_specificity': 0.9906171, 'binary_f1_score': 0.34488735}
confusion matrix:
       0    1
0  41914  397
1   1115  398
---- Validation: 
scalar performance:
{'acc': 0.96569544, 'precision': 0.72562456, 'recall': 0.74297106, 'specificity': 0.74297106, 'f1': 0.7339395, 'auroc': 0.9072264, 'binary_precision': 0.46769232, 'binary_recall': 0.50498337, 'binary_specificity': 0.9809587, 'binary_f1_score': 0.48562297}
confusion matrix:
       0    1
0  17825  346
1    298  304
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9741946, 'precision': 0.8515738, 'recall': 0.7684752, 'specificity': 0.7684752, 'f1': 0.8039094, 'auroc': 0.89737654, 'binary_precision': 0.72131145, 'binary_recall': 0.54545456, 'binary_specificity': 0.9914957, 'binary_f1_score': 0.6211765}
confusion matrix:
      0    1
0  5946   51
1   110  132
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316517_5.png
new oracle model saved
early stop counter: 4
val acc:0.9656954407691956, best validation acc: 0.9668140411376953, corresponding to test acc:                         0.9600897431373596 / 0.9741945862770081
after epoch: 5,now: 2024-06-14 11:00:24.504714,epoch time: 0:19:24.103992,used: 1:36:02.678137,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_09_24_21_seed_2_21316517
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
