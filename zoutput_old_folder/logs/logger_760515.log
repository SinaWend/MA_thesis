Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0




!!!: not committed yet



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_15_49_03_seed_0_21585201

 Experiment start at: 2024-06-26 15:49:03.731953
before training, model accuracy: 0.3804730176925659
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9657888, 'precision': 0.9334058, 'recall': 0.5065379, 'specificity': 0.5065379, 'f1': 0.5042333, 'auroc': 0.8656527, 'binary_precision': 0.9009901, 'binary_recall': 0.013127524, 'binary_specificity': 0.99994826, 'binary_f1_score': 0.025878003}
confusion matrix:
        0   1
0  193314  10
1    6841  91
---- Validation: 
scalar performance:
{'acc': 0.96481335, 'precision': 0.81576085, 'recall': 0.5012986, 'specificity': 0.5012986, 'f1': 0.49367997, 'auroc': 0.86764026, 'binary_precision': 0.6666667, 'binary_recall': 0.0026455026, 'binary_specificity': 0.9999517, 'binary_f1_score': 0.005270092}
confusion matrix:
       0  1
0  82800  4
1   3016  8
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96574384, 'precision': 0.8829216, 'recall': 0.50686234, 'specificity': 0.50686234, 'f1': 0.5048956, 'auroc': 0.8619449, 'binary_precision': 0.8, 'binary_recall': 0.013848817, 'binary_specificity': 0.99987584, 'binary_f1_score': 0.027226318}
confusion matrix:
       0   1
0  48325   6
1   1709  24
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21585201_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-26 18:25:22.342774,epoch time: 2:36:18.610821,used: 2:36:18.610821,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_15_49_03_seed_0_21585201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9671221, 'precision': 0.78362584, 'recall': 0.57551956, 'specificity': 0.57551956, 'f1': 0.61450684, 'auroc': 0.8988066, 'binary_precision': 0.5967742, 'binary_recall': 0.15478939, 'binary_specificity': 0.9962498, 'binary_f1_score': 0.24581903}
confusion matrix:
        0     1
0  192599   725
1    5859  1073
---- Validation: 
scalar performance:
{'acc': 0.9663047, 'precision': 0.80455685, 'recall': 0.54858875, 'specificity': 0.54858875, 'f1': 0.57731193, 'auroc': 0.8886273, 'binary_precision': 0.64102566, 'binary_recall': 0.09920635, 'binary_specificity': 0.9979711, 'binary_f1_score': 0.17182133}
confusion matrix:
       0    1
0  82636  168
1   2724  300
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96698225, 'precision': 0.77983916, 'recall': 0.57426494, 'specificity': 0.57426494, 'f1': 0.6126072, 'auroc': 0.9010538, 'binary_precision': 0.58928573, 'binary_recall': 0.15233698, 'binary_specificity': 0.99619293, 'binary_f1_score': 0.24209079}
confusion matrix:
       0    1
0  48147  184
1   1469  264
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21585201_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-26 20:48:17.053905,epoch time: 2:22:54.711131,used: 4:59:13.321952,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_15_49_03_seed_0_21585201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96746665, 'precision': 0.7927838, 'recall': 0.5786884, 'specificity': 0.5786884, 'f1': 0.6192717, 'auroc': 0.9056583, 'binary_precision': 0.61487603, 'binary_recall': 0.1609925, 'binary_specificity': 0.9963843, 'binary_f1_score': 0.2551732}
confusion matrix:
        0     1
0  192625   699
1    5816  1116
---- Validation: 
scalar performance:
{'acc': 0.96672416, 'precision': 0.81758165, 'recall': 0.5545411, 'specificity': 0.5545411, 'f1': 0.5867446, 'auroc': 0.8986566, 'binary_precision': 0.6666667, 'binary_recall': 0.11111111, 'binary_specificity': 0.9979711, 'binary_f1_score': 0.1904762}
confusion matrix:
       0    1
0  82636  168
1   2688  336
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9671221, 'precision': 0.78227895, 'recall': 0.5773972, 'specificity': 0.5773972, 'f1': 0.6168239, 'auroc': 0.9068835, 'binary_precision': 0.5939525, 'binary_recall': 0.15868436, 'binary_specificity': 0.99611014, 'binary_f1_score': 0.25045538}
confusion matrix:
       0    1
0  48143  188
1   1458  275
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21585201_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-26 22:50:11.345642,epoch time: 2:01:54.291737,used: 7:01:07.613689,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_15_49_03_seed_0_21585201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
