Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0




!!!: not committed yet



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_02_42_02_seed_0_21504945

 Experiment start at: 2024-06-19 02:42:02.255337
before training, model accuracy: 0.31622418761253357
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9055437, 'precision': 0.45277184, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.47521538, 'auroc': 0.56763124, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42307  0
1   4413  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.3391972, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88451326, 'precision': 0.44225663, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.469359, 'auroc': 0.29790822, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   783  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504945_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-19 03:05:42.514123,epoch time: 0:23:40.258786,used: 0:23:40.258786,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_02_42_02_seed_0_21504945
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9055437, 'precision': 0.45277184, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.47521538, 'auroc': 0.73378015, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42307  0
1   4413  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.3537317, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88451326, 'precision': 0.44225663, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.469359, 'auroc': 0.36073434, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   783  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504945_2.png
early stop counter: 1
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.884513258934021
after epoch: 2,now: 2024-06-19 03:21:13.932768,epoch time: 0:15:31.418645,used: 0:39:11.677431,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_02_42_02_seed_0_21504945
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9084118, 'precision': 0.9189142, 'recall': 0.5162987, 'specificity': 0.5162987, 'f1': 0.5076614, 'auroc': 0.8743937, 'binary_precision': 0.92948717, 'binary_recall': 0.032857466, 'binary_specificity': 0.99974, 'binary_f1_score': 0.06347122}
confusion matrix:
       0    1
0  42296   11
1   4268  145
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.43397555, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88451326, 'precision': 0.44225663, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.469359, 'auroc': 0.55771506, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   783  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504945_3.png
early stop counter: 2
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.884513258934021
after epoch: 3,now: 2024-06-19 03:37:57.981275,epoch time: 0:16:44.048507,used: 0:55:55.725938,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_02_42_02_seed_0_21504945
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.92422944, 'precision': 0.9480813, 'recall': 0.6014494, 'specificity': 0.6014494, 'f1': 0.648201, 'auroc': 0.90701485, 'binary_precision': 0.9729144, 'binary_recall': 0.20348969, 'binary_specificity': 0.9994091, 'binary_f1_score': 0.3365817}
confusion matrix:
       0    1
0  42282   25
1   3515  898
---- Validation: 
scalar performance:
{'acc': 0.96546406, 'precision': 0.4828862, 'recall': 0.49983472, 'specificity': 0.49983472, 'f1': 0.4912143, 'auroc': 0.46739924, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99966943, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18143  6
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88451326, 'precision': 0.44225663, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.469359, 'auroc': 0.5879408, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   783  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504945_4.png
early stop counter: 3
val acc:0.9654640555381775, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.884513258934021
after epoch: 4,now: 2024-06-19 03:52:23.760904,epoch time: 0:14:25.779629,used: 1:10:21.505567,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_02_42_02_seed_0_21504945
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.93589467, 'precision': 0.9437635, 'recall': 0.66834784, 'specificity': 0.66834784, 'f1': 0.7325848, 'auroc': 0.9225905, 'binary_precision': 0.95219886, 'binary_recall': 0.33846852, 'binary_specificity': 0.9982272, 'binary_f1_score': 0.499415}
confusion matrix:
       0     1
0  42231    75
1   2920  1494
---- Validation: 
scalar performance:
{'acc': 0.9648787, 'precision': 0.48287615, 'recall': 0.49953166, 'specificity': 0.49953166, 'f1': 0.4910627, 'auroc': 0.5245031, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9990633, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18132  17
1    643   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88672566, 'precision': 0.8324695, 'recall': 0.5129097, 'specificity': 0.5129097, 'f1': 0.49580827, 'auroc': 0.70597017, 'binary_precision': 0.7777778, 'binary_recall': 0.026819924, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.051851854}
confusion matrix:
      0   1
0  5991   6
1   762  21
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504945_5.png
new oracle model saved
early stop counter: 4
val acc:0.9648786783218384, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.886725664138794
after epoch: 5,now: 2024-06-19 04:07:01.858139,epoch time: 0:14:38.097235,used: 1:24:59.602802,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_02_42_02_seed_0_21504945
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9470248, 'precision': 0.9493944, 'recall': 0.73015296, 'specificity': 0.73015296, 'f1': 0.7971415, 'auroc': 0.93875074, 'binary_precision': 0.9520037, 'binary_recall': 0.46274066, 'binary_specificity': 0.9975653, 'binary_f1_score': 0.6227709}
confusion matrix:
       0     1
0  42202   103
1   2372  2043
---- Validation: 
scalar performance:
{'acc': 0.96392083, 'precision': 0.49639806, 'recall': 0.4997858, 'specificity': 0.4997858, 'f1': 0.4922846, 'auroc': 0.5458189, 'binary_precision': 0.027027028, 'binary_recall': 0.00155521, 'binary_specificity': 0.9980164, 'binary_f1_score': 0.0029411763}
confusion matrix:
       0   1
0  18113  36
1    642   1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8920354, 'precision': 0.8432124, 'recall': 0.5425606, 'specificity': 0.5425606, 'f1': 0.55046874, 'auroc': 0.7117562, 'binary_precision': 0.79310346, 'binary_recall': 0.08812261, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.15862069}
confusion matrix:
      0   1
0  5979  18
1   714  69
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504945_6.png
new oracle model saved
early stop counter: 5
val acc:0.9639208316802979, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.8920354247093201
after epoch: 6,now: 2024-06-19 04:21:21.427107,epoch time: 0:14:19.568968,used: 1:39:19.171770,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_02_42_02_seed_0_21504945
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9525471, 'precision': 0.9399655, 'recall': 0.7680377, 'specificity': 0.7680377, 'f1': 0.8284811, 'auroc': 0.94405746, 'binary_precision': 0.92582524, 'binary_recall': 0.5405896, 'binary_specificity': 0.9954857, 'binary_f1_score': 0.68260556}
confusion matrix:
       0     1
0  42119   191
1   2026  2384
---- Validation: 
scalar performance:
{'acc': 0.9626969, 'precision': 0.50635076, 'recall': 0.5006523, 'specificity': 0.5006523, 'f1': 0.49473873, 'auroc': 0.5590667, 'binary_precision': 0.046875, 'binary_recall': 0.00466563, 'binary_specificity': 0.99663895, 'binary_f1_score': 0.008486563}
confusion matrix:
       0   1
0  18088  61
1    640   3
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8960177, 'precision': 0.85358965, 'recall': 0.5631331, 'specificity': 0.5631331, 'f1': 0.5843478, 'auroc': 0.72432196, 'binary_precision': 0.8095238, 'binary_recall': 0.1302682, 'binary_specificity': 0.995998, 'binary_f1_score': 0.22442244}
confusion matrix:
      0    1
0  5973   24
1   681  102
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504945_7.png
new oracle model saved
early stop counter: 6
val acc:0.96269690990448, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.8960176706314087
after epoch: 7,now: 2024-06-19 04:36:16.724785,epoch time: 0:14:55.297678,used: 1:54:14.469448,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_02_42_02_seed_0_21504945
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.95753425, 'precision': 0.9348149, 'recall': 0.8027116, 'specificity': 0.8027116, 'f1': 0.8541281, 'auroc': 0.9548881, 'binary_precision': 0.9087849, 'binary_recall': 0.6118287, 'binary_specificity': 0.99359447, 'binary_f1_score': 0.7313109}
confusion matrix:
       0     1
0  42036   271
1   1713  2700
---- Validation: 
scalar performance:
{'acc': 0.959983, 'precision': 0.55040544, 'recall': 0.5119982, 'specificity': 0.5119982, 'f1': 0.51503295, 'auroc': 0.64423037, 'binary_precision': 0.13422818, 'binary_recall': 0.0311042, 'binary_specificity': 0.99289215, 'binary_f1_score': 0.050505057}
confusion matrix:
       0    1
0  18020  129
1    623   20
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9131268, 'precision': 0.87777257, 'recall': 0.64942145, 'specificity': 0.64942145, 'f1': 0.7009319, 'auroc': 0.79357684, 'binary_precision': 0.83916086, 'binary_recall': 0.3065134, 'binary_specificity': 0.9923295, 'binary_f1_score': 0.44901776}
confusion matrix:
      0    1
0  5951   46
1   543  240
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504945_8.png
new oracle model saved
early stop counter: 7
val acc:0.9599829912185669, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.9131268262863159
after epoch: 8,now: 2024-06-19 04:50:44.551829,epoch time: 0:14:27.827044,used: 2:08:42.296492,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_02_42_02_seed_0_21504945
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.95905393, 'precision': 0.9360256, 'recall': 0.8112214, 'specificity': 0.8112214, 'f1': 0.8607093, 'auroc': 0.9529562, 'binary_precision': 0.90953785, 'binary_recall': 0.62896645, 'binary_specificity': 0.9934764, 'binary_f1_score': 0.74366874}
confusion matrix:
       0     1
0  42032   276
1   1637  2775
---- Validation: 
scalar performance:
{'acc': 0.9600894, 'precision': 0.569383, 'recall': 0.5180537, 'specificity': 0.5180537, 'f1': 0.52454317, 'auroc': 0.6515659, 'binary_precision': 0.17177914, 'binary_recall': 0.04354588, 'binary_specificity': 0.9925616, 'binary_f1_score': 0.06947891}
confusion matrix:
       0    1
0  18014  135
1    615   28
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9123894, 'precision': 0.85893273, 'recall': 0.65566695, 'specificity': 0.65566695, 'f1': 0.7056758, 'auroc': 0.8009248, 'binary_precision': 0.8, 'binary_recall': 0.3218391, 'binary_specificity': 0.98949474, 'binary_f1_score': 0.45901647}
confusion matrix:
      0    1
0  5934   63
1   531  252
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504945_9.png
early stop counter: 8
val acc:0.960089385509491, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.9131268262863159
after epoch: 9,now: 2024-06-19 05:06:13.846875,epoch time: 0:15:29.295046,used: 2:24:11.591538,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_02_42_02_seed_0_21504945
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.96123713, 'precision': 0.934396, 'recall': 0.82643515, 'specificity': 0.82643515, 'f1': 0.87087923, 'auroc': 0.95564985, 'binary_precision': 0.9032558, 'binary_recall': 0.66024476, 'binary_specificity': 0.99262553, 'binary_f1_score': 0.76286495}
confusion matrix:
       0     1
0  41996   312
1   1499  2913
---- Validation: 
scalar performance:
{'acc': 0.9590783, 'precision': 0.5777872, 'recall': 0.52503085, 'specificity': 0.52503085, 'f1': 0.5345047, 'auroc': 0.6471786, 'binary_precision': 0.18811882, 'binary_recall': 0.05909798, 'binary_specificity': 0.9909637, 'binary_f1_score': 0.08994083}
confusion matrix:
       0    1
0  17985  164
1    605   38
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91504425, 'precision': 0.8606061, 'recall': 0.6704923, 'specificity': 0.6704923, 'f1': 0.7215148, 'auroc': 0.7955421, 'binary_precision': 0.8, 'binary_recall': 0.35249043, 'binary_specificity': 0.9884942, 'binary_f1_score': 0.48936173}
confusion matrix:
      0    1
0  5928   69
1   507  276
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504945_10.png
new oracle model saved
early stop counter: 9
val acc:0.959078311920166, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.9150442481040955
after epoch: 10,now: 2024-06-19 05:21:32.071245,epoch time: 0:15:18.224370,used: 2:39:29.815908,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_02_42_02_seed_0_21504945
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96014553, 'precision': 0.9372381, 'recall': 0.81718385, 'specificity': 0.81718385, 'f1': 0.86536115, 'auroc': 0.9561101, 'binary_precision': 0.91081774, 'binary_recall': 0.6409153, 'binary_specificity': 0.9934525, 'binary_f1_score': 0.7523936}
confusion matrix:
       0     1
0  42029   277
1   1585  2829
---- Validation: 
scalar performance:
{'acc': 0.9608876, 'precision': 0.5934634, 'recall': 0.5244674, 'specificity': 0.5244674, 'f1': 0.534617, 'auroc': 0.66374385, 'binary_precision': 0.2195122, 'binary_recall': 0.05598756, 'binary_specificity': 0.9929473, 'binary_f1_score': 0.089219324}
confusion matrix:
       0    1
0  18021  128
1    607   36
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91651917, 'precision': 0.88755995, 'recall': 0.6629982, 'specificity': 0.6629982, 'f1': 0.7171989, 'auroc': 0.80954266, 'binary_precision': 0.8557377, 'binary_recall': 0.33333334, 'binary_specificity': 0.992663, 'binary_f1_score': 0.4797794}
confusion matrix:
      0    1
0  5953   44
1   522  261
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504945_11.png
new oracle model saved
early stop counter: 10
val acc:0.960887610912323, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.9165191650390625
after epoch: 11,now: 2024-06-19 05:37:24.887884,epoch time: 0:15:52.816639,used: 2:55:22.632547,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_02_42_02_seed_0_21504945
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9651113, 'precision': 0.9427758, 'recall': 0.8434961, 'specificity': 0.8434961, 'f1': 0.8853277, 'auroc': 0.9622222, 'binary_precision': 0.9167166, 'binary_recall': 0.693563, 'binary_specificity': 0.9934291, 'binary_f1_score': 0.7896774}
confusion matrix:
       0     1
0  42030   278
1   1352  3060
---- Validation: 
scalar performance:
{'acc': 0.96030223, 'precision': 0.60050416, 'recall': 0.5309149, 'specificity': 0.5309149, 'f1': 0.54367757, 'auroc': 0.67750704, 'binary_precision': 0.23316061, 'binary_recall': 0.06998445, 'binary_specificity': 0.9918453, 'binary_f1_score': 0.10765551}
confusion matrix:
       0    1
0  18001  148
1    598   45
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9199115, 'precision': 0.87904984, 'recall': 0.6865684, 'specificity': 0.6865684, 'f1': 0.740602, 'auroc': 0.81219923, 'binary_precision': 0.8333333, 'binary_recall': 0.38314176, 'binary_specificity': 0.989995, 'binary_f1_score': 0.5249344}
confusion matrix:
      0    1
0  5937   60
1   483  300
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504945_12.png
new oracle model saved
early stop counter: 11
val acc:0.9603022336959839, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.9199115037918091
after epoch: 12,now: 2024-06-19 05:53:32.368924,epoch time: 0:16:07.481040,used: 3:11:30.113587,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_02_42_02_seed_0_21504945
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9635488, 'precision': 0.9290403, 'recall': 0.84652436, 'specificity': 0.84652436, 'f1': 0.88227427, 'auroc': 0.9627773, 'binary_precision': 0.88847476, 'binary_recall': 0.7022434, 'binary_specificity': 0.9908053, 'binary_f1_score': 0.7844576}
confusion matrix:
       0     1
0  41918   389
1   1314  3099
---- Validation: 
scalar performance:
{'acc': 0.9586526, 'precision': 0.59799564, 'recall': 0.5383114, 'specificity': 0.5383114, 'f1': 0.5524049, 'auroc': 0.670974, 'binary_precision': 0.22764228, 'binary_recall': 0.08709176, 'binary_specificity': 0.9895311, 'binary_f1_score': 0.12598427}
confusion matrix:
       0    1
0  17959  190
1    587   56
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9179941, 'precision': 0.8504548, 'recall': 0.69714355, 'specificity': 0.69714355, 'f1': 0.7454583, 'auroc': 0.8112281, 'binary_precision': 0.773494, 'binary_recall': 0.4099617, 'binary_specificity': 0.98432547, 'binary_f1_score': 0.53589314}
confusion matrix:
      0    1
0  5903   94
1   462  321
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504945_13.png
early stop counter: 12
val acc:0.9586526155471802, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.9199115037918091
after epoch: 13,now: 2024-06-19 06:09:03.131993,epoch time: 0:15:30.763069,used: 3:27:00.876656,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_02_42_02_seed_0_21504945
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96361303, 'precision': 0.91942054, 'recall': 0.857317, 'specificity': 0.857317, 'f1': 0.88522977, 'auroc': 0.9624722, 'binary_precision': 0.8669191, 'binary_recall': 0.7262633, 'binary_specificity': 0.9883707, 'binary_f1_score': 0.7903822}
confusion matrix:
       0     1
0  41815   492
1   1208  3205
---- Validation: 
scalar performance:
{'acc': 0.9574819, 'precision': 0.608039, 'recall': 0.5527065, 'specificity': 0.5527065, 'f1': 0.56901044, 'auroc': 0.68671864, 'binary_precision': 0.24675325, 'binary_recall': 0.11819596, 'binary_specificity': 0.98721695, 'binary_f1_score': 0.15983176}
confusion matrix:
       0    1
0  17917  232
1    567   76
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9237463, 'precision': 0.85968196, 'recall': 0.725379, 'specificity': 0.725379, 'f1': 0.7720369, 'auroc': 0.82469714, 'binary_precision': 0.7854077, 'binary_recall': 0.46743295, 'binary_specificity': 0.983325, 'binary_f1_score': 0.58606887}
confusion matrix:
      0    1
0  5897  100
1   417  366
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504945_14.png
new oracle model saved
early stop counter: 13
val acc:0.9574819207191467, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.9237462878227234
after epoch: 14,now: 2024-06-19 06:25:04.391871,epoch time: 0:16:01.259878,used: 3:43:02.136534,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_02_42_02_seed_0_21504945
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9677226, 'precision': 0.93460244, 'recall': 0.8682697, 'specificity': 0.8682697, 'f1': 0.8979872, 'auroc': 0.9689703, 'binary_precision': 0.8952951, 'binary_recall': 0.74563986, 'binary_specificity': 0.99089944, 'binary_f1_score': 0.81364316}
confusion matrix:
       0     1
0  41920   385
1   1123  3292
---- Validation: 
scalar performance:
{'acc': 0.9601426, 'precision': 0.62310624, 'recall': 0.5465834, 'specificity': 0.5465834, 'f1': 0.56471133, 'auroc': 0.6959462, 'binary_precision': 0.27731094, 'binary_recall': 0.102643855, 'binary_specificity': 0.9905229, 'binary_f1_score': 0.14982975}
confusion matrix:
       0    1
0  17977  172
1    577   66
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9241888, 'precision': 0.8841456, 'recall': 0.7073077, 'specificity': 0.7073077, 'f1': 0.7614441, 'auroc': 0.82090914, 'binary_precision': 0.83879095, 'binary_recall': 0.42528737, 'binary_specificity': 0.989328, 'binary_f1_score': 0.56440675}
confusion matrix:
      0    1
0  5933   64
1   450  333
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504945_15.png
new oracle model saved
early stop counter: 14
val acc:0.9601426124572754, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.9241887927055359
after epoch: 15,now: 2024-06-19 06:41:20.840841,epoch time: 0:16:16.448970,used: 3:59:18.585504,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_02_42_02_seed_0_21504945
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9647474, 'precision': 0.9161674, 'recall': 0.86913455, 'specificity': 0.86913455, 'f1': 0.8908615, 'auroc': 0.9670702, 'binary_precision': 0.857956, 'binary_recall': 0.75124604, 'binary_specificity': 0.9870231, 'binary_f1_score': 0.8010629}
confusion matrix:
       0     1
0  41757   549
1   1098  3316
---- Validation: 
scalar performance:
{'acc': 0.956258, 'precision': 0.60815275, 'recall': 0.56032336, 'specificity': 0.56032336, 'f1': 0.5761162, 'auroc': 0.71267104, 'binary_precision': 0.24645892, 'binary_recall': 0.13530326, 'binary_specificity': 0.9853435, 'binary_f1_score': 0.17469878}
confusion matrix:
       0    1
0  17883  266
1    556   87
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9280236, 'precision': 0.86759293, 'recall': 0.7444527, 'specificity': 0.7444527, 'f1': 0.7895053, 'auroc': 0.83254266, 'binary_precision': 0.7967807, 'binary_recall': 0.50574714, 'binary_specificity': 0.98315823, 'binary_f1_score': 0.61875}
confusion matrix:
      0    1
0  5896  101
1   387  396
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504945_16.png
new oracle model saved
early stop counter: 15
val acc:0.9562579989433289, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.9280235767364502
after epoch: 16,now: 2024-06-19 06:57:04.284618,epoch time: 0:15:43.443777,used: 4:15:02.029281,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_02_42_02_seed_0_21504945
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9659033, 'precision': 0.91642755, 'recall': 0.87679607, 'specificity': 0.87679607, 'f1': 0.8953518, 'auroc': 0.9678718, 'binary_precision': 0.85688955, 'binary_recall': 0.76694626, 'binary_specificity': 0.9866459, 'binary_f1_score': 0.80942696}
confusion matrix:
       0     1
0  41744   565
1   1028  3383
---- Validation: 
scalar performance:
{'acc': 0.9560983, 'precision': 0.6134926, 'recall': 0.56699127, 'specificity': 0.56699127, 'f1': 0.5831146, 'auroc': 0.71696377, 'binary_precision': 0.25668448, 'binary_recall': 0.14930016, 'binary_specificity': 0.9846824, 'binary_f1_score': 0.18879056}
confusion matrix:
       0    1
0  17871  278
1    547   96
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92831856, 'precision': 0.8616923, 'recall': 0.75294733, 'specificity': 0.75294733, 'f1': 0.7943866, 'auroc': 0.8404144, 'binary_precision': 0.7828571, 'binary_recall': 0.5249042, 'binary_specificity': 0.98099047, 'binary_f1_score': 0.6284403}
confusion matrix:
      0    1
0  5883  114
1   372  411
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504945_17.png
new oracle model saved
early stop counter: 16
val acc:0.9560983180999756, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.9283185601234436
after epoch: 17,now: 2024-06-19 07:13:02.660776,epoch time: 0:15:58.376158,used: 4:31:00.405439,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_02_42_02_seed_0_21504945
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9641695, 'precision': 0.9070442, 'recall': 0.8768282, 'specificity': 0.8768282, 'f1': 0.8911913, 'auroc': 0.9711566, 'binary_precision': 0.8379447, 'binary_recall': 0.769161, 'binary_specificity': 0.9844954, 'binary_f1_score': 0.80208087}
confusion matrix:
       0     1
0  41654   656
1   1018  3392
---- Validation: 
scalar performance:
{'acc': 0.956258, 'precision': 0.6138536, 'recall': 0.5663238, 'specificity': 0.5663238, 'f1': 0.5826354, 'auroc': 0.713991, 'binary_precision': 0.25745258, 'binary_recall': 0.14774494, 'binary_specificity': 0.98490274, 'binary_f1_score': 0.18774703}
confusion matrix:
       0    1
0  17875  274
1    548   95
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93082595, 'precision': 0.87818974, 'recall': 0.75103354, 'specificity': 0.75103354, 'f1': 0.79755914, 'auroc': 0.8416341, 'binary_precision': 0.81653225, 'binary_recall': 0.51724136, 'binary_specificity': 0.98482573, 'binary_f1_score': 0.6333073}
confusion matrix:
      0    1
0  5906   91
1   378  405
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504945_18.png
new oracle model saved
early stop counter: 17
val acc:0.9562579989433289, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.93082594871521
after epoch: 18,now: 2024-06-19 07:29:23.856994,epoch time: 0:16:21.196218,used: 4:47:21.601657,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_02_42_02_seed_0_21504945
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.96744436, 'precision': 0.9294537, 'recall': 0.8719149, 'specificity': 0.8719149, 'f1': 0.8980757, 'auroc': 0.96925604, 'binary_precision': 0.88416576, 'binary_recall': 0.7541355, 'binary_specificity': 0.98969436, 'binary_f1_score': 0.8139904}
confusion matrix:
       0     1
0  41871   436
1   1085  3328
---- Validation: 
scalar performance:
{'acc': 0.9578544, 'precision': 0.6188787, 'recall': 0.56039983, 'specificity': 0.56039983, 'f1': 0.57839787, 'auroc': 0.7082001, 'binary_precision': 0.26791278, 'binary_recall': 0.13374805, 'binary_specificity': 0.9870516, 'binary_f1_score': 0.17842323}
confusion matrix:
       0    1
0  17914  235
1    557   86
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.929941, 'precision': 0.8819847, 'recall': 0.7422054, 'specificity': 0.7422054, 'f1': 0.79145586, 'auroc': 0.8370207, 'binary_precision': 0.8262712, 'binary_recall': 0.49808428, 'binary_specificity': 0.9863265, 'binary_f1_score': 0.6215139}
confusion matrix:
      0    1
0  5915   82
1   393  390
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504945_19.png
early stop counter: 18
val acc:0.9578543901443481, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.93082594871521
after epoch: 19,now: 2024-06-19 07:45:42.892036,epoch time: 0:16:19.035042,used: 5:03:40.636699,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_02_42_02_seed_0_21504945
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9658818, 'precision': 0.90850747, 'recall': 0.88746893, 'specificity': 0.88746893, 'f1': 0.8976318, 'auroc': 0.97308207, 'binary_precision': 0.8387019, 'binary_recall': 0.7907978, 'binary_specificity': 0.9841401, 'binary_f1_score': 0.8140458}
confusion matrix:
       0     1
0  41637   671
1    923  3489
---- Validation: 
scalar performance:
{'acc': 0.95732224, 'precision': 0.62888145, 'recall': 0.5758755, 'specificity': 0.5758755, 'f1': 0.5943491, 'auroc': 0.7289972, 'binary_precision': 0.28686327, 'binary_recall': 0.16640747, 'binary_specificity': 0.9853435, 'binary_f1_score': 0.21062993}
confusion matrix:
       0    1
0  17883  266
1    536  107
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9318584, 'precision': 0.88589656, 'recall': 0.7499516, 'specificity': 0.7499516, 'f1': 0.79874593, 'auroc': 0.84345114, 'binary_precision': 0.83229816, 'binary_recall': 0.51341, 'binary_specificity': 0.98649323, 'binary_f1_score': 0.6350711}
confusion matrix:
      0    1
0  5916   81
1   381  402
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504945_20.png
new oracle model saved
early stop counter: 19
val acc:0.9573222398757935, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.9318584203720093
after epoch: 20,now: 2024-06-19 08:05:38.697808,epoch time: 0:19:55.805772,used: 5:23:36.442471,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_02_42_02_seed_0_21504945
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9656036, 'precision': 0.91039973, 'recall': 0.88294744, 'specificity': 0.88294744, 'f1': 0.89606595, 'auroc': 0.97294104, 'binary_precision': 0.8434825, 'binary_recall': 0.78102356, 'binary_specificity': 0.9848714, 'binary_f1_score': 0.8110523}
confusion matrix:
       0     1
0  41664   640
1    967  3449
---- Validation: 
scalar performance:
{'acc': 0.9569498, 'precision': 0.6237829, 'recall': 0.57268244, 'specificity': 0.57268244, 'f1': 0.59041655, 'auroc': 0.7284766, 'binary_precision': 0.27688172, 'binary_recall': 0.16018662, 'binary_specificity': 0.98517823, 'binary_f1_score': 0.20295566}
confusion matrix:
       0    1
0  17880  269
1    540  103
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93333334, 'precision': 0.88535887, 'recall': 0.75911325, 'specificity': 0.75911325, 'f1': 0.80584836, 'auroc': 0.8428426, 'binary_precision': 0.82902586, 'binary_recall': 0.532567, 'binary_specificity': 0.9856595, 'binary_f1_score': 0.64852256}
confusion matrix:
      0    1
0  5911   86
1   366  417
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504945_21.png
new oracle model saved
early stop counter: 20
val acc:0.956949770450592, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.9333333373069763
after epoch: 21,now: 2024-06-19 08:23:27.789515,epoch time: 0:17:49.091707,used: 5:41:25.534178,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_02_42_02_seed_0_21504945
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.96645975, 'precision': 0.9060254, 'recall': 0.8955243, 'specificity': 0.8955243, 'f1': 0.9006864, 'auroc': 0.9747425, 'binary_precision': 0.8320112, 'binary_recall': 0.8080671, 'binary_specificity': 0.98298156, 'binary_f1_score': 0.8198644}
confusion matrix:
       0     1
0  41587   720
1    847  3566
---- Validation: 
scalar performance:
{'acc': 0.9548744, 'precision': 0.6154925, 'recall': 0.57760847, 'specificity': 0.57760847, 'f1': 0.5921263, 'auroc': 0.72715545, 'binary_precision': 0.25995317, 'binary_recall': 0.1726283, 'binary_specificity': 0.9825886, 'binary_f1_score': 0.20747663}
confusion matrix:
       0    1
0  17833  316
1    532  111
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9309735, 'precision': 0.8639401, 'recall': 0.7677728, 'specificity': 0.7677728, 'f1': 0.8059664, 'auroc': 0.844074, 'binary_precision': 0.7837838, 'binary_recall': 0.5555556, 'binary_specificity': 0.97999, 'binary_f1_score': 0.65022427}
confusion matrix:
      0    1
0  5877  120
1   348  435
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504945_22.png
early stop counter: 21
val acc:0.9548743963241577, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.9333333373069763
after epoch: 22,now: 2024-06-19 08:43:41.911146,epoch time: 0:20:14.121631,used: 6:01:39.655809,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_02_42_02_seed_0_21504945
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9661173, 'precision': 0.91022974, 'recall': 0.8868344, 'specificity': 0.8868344, 'f1': 0.8980924, 'auroc': 0.9711503, 'binary_precision': 0.84232163, 'binary_recall': 0.7890802, 'binary_specificity': 0.9845885, 'binary_f1_score': 0.81483215}
confusion matrix:
       0     1
0  41654   652
1    931  3483
---- Validation: 
scalar performance:
{'acc': 0.9560983, 'precision': 0.62291026, 'recall': 0.57824206, 'specificity': 0.57824206, 'f1': 0.5947273, 'auroc': 0.7365568, 'binary_precision': 0.27475247, 'binary_recall': 0.1726283, 'binary_specificity': 0.98385584, 'binary_f1_score': 0.21203436}
confusion matrix:
       0    1
0  17856  293
1    532  111
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9342183, 'precision': 0.8851006, 'recall': 0.7646103, 'specificity': 0.7646103, 'f1': 0.8100109, 'auroc': 0.85170686, 'binary_precision': 0.82718444, 'binary_recall': 0.5440613, 'binary_specificity': 0.9851592, 'binary_f1_score': 0.6563944}
confusion matrix:
      0    1
0  5908   89
1   357  426
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504945_23.png
new oracle model saved
early stop counter: 22
val acc:0.9560983180999756, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.9342182874679565
after epoch: 23,now: 2024-06-19 09:03:06.470658,epoch time: 0:19:24.559512,used: 6:21:04.215321,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_02_42_02_seed_0_21504945
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9677012, 'precision': 0.91260874, 'recall': 0.8950138, 'specificity': 0.8950138, 'f1': 0.90356565, 'auroc': 0.97438776, 'binary_precision': 0.8454221, 'binary_recall': 0.8053919, 'binary_specificity': 0.9846358, 'binary_f1_score': 0.8249216}
confusion matrix:
       0     1
0  41656   650
1    859  3555
---- Validation: 
scalar performance:
{'acc': 0.9555662, 'precision': 0.61899567, 'recall': 0.57721657, 'specificity': 0.57721657, 'f1': 0.59283614, 'auroc': 0.71929777, 'binary_precision': 0.2669903, 'binary_recall': 0.1710731, 'binary_specificity': 0.98336, 'binary_f1_score': 0.20853081}
confusion matrix:
       0    1
0  17847  302
1    533  110
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9306785, 'precision': 0.86945593, 'recall': 0.7592781, 'specificity': 0.7592781, 'f1': 0.801427, 'auroc': 0.8412342, 'binary_precision': 0.79696393, 'binary_recall': 0.5363985, 'binary_specificity': 0.98215777, 'binary_f1_score': 0.6412214}
confusion matrix:
      0    1
0  5890  107
1   363  420
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504945_24.png
early stop counter: 23
val acc:0.9555662274360657, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.9342182874679565
after epoch: 24,now: 2024-06-19 09:24:13.019526,epoch time: 0:21:06.548868,used: 6:42:10.764189,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_02_42_02_seed_0_21504945
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.96684504, 'precision': 0.90023744, 'recall': 0.9079335, 'specificity': 0.9079335, 'f1': 0.90403795, 'auroc': 0.9762461, 'binary_precision': 0.81769794, 'binary_recall': 0.8352968, 'binary_specificity': 0.98057014, 'binary_f1_score': 0.8264037}
confusion matrix:
       0     1
0  41484   822
1    727  3687
---- Validation: 
scalar performance:
{'acc': 0.9533844, 'precision': 0.61782867, 'recall': 0.5910881, 'specificity': 0.5910881, 'f1': 0.6024195, 'auroc': 0.7458545, 'binary_precision': 0.2636917, 'binary_recall': 0.2021773, 'binary_specificity': 0.9799989, 'binary_f1_score': 0.22887325}
confusion matrix:
       0    1
0  17786  363
1    513  130
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93480825, 'precision': 0.87032676, 'recall': 0.78493077, 'specificity': 0.78493077, 'f1': 0.8200901, 'auroc': 0.8589721, 'binary_precision': 0.7924528, 'binary_recall': 0.5900383, 'binary_specificity': 0.97982323, 'binary_f1_score': 0.67642754}
confusion matrix:
      0    1
0  5876  121
1   321  462
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504945_25.png
new oracle model saved
early stop counter: 24
val acc:0.9533843994140625, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.9348082542419434
after epoch: 25,now: 2024-06-19 09:48:17.703801,epoch time: 0:24:04.684275,used: 7:06:15.448464,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_02_42_02_seed_0_21504945
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9691995, 'precision': 0.9111897, 'recall': 0.9080987, 'specificity': 0.9080987, 'f1': 0.90963674, 'auroc': 0.97832763, 'binary_precision': 0.83980805, 'binary_recall': 0.83276683, 'binary_specificity': 0.9834306, 'binary_f1_score': 0.83627266}
confusion matrix:
       0     1
0  41606   701
1    738  3675
---- Validation: 
scalar performance:
{'acc': 0.9555662, 'precision': 0.6288199, 'recall': 0.59071755, 'specificity': 0.59071755, 'f1': 0.605883, 'auroc': 0.73881596, 'binary_precision': 0.2857143, 'binary_recall': 0.19906688, 'binary_specificity': 0.9823682, 'binary_f1_score': 0.23464713}
confusion matrix:
       0    1
0  17829  320
1    515  128
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9340708, 'precision': 0.8810199, 'recall': 0.767858, 'specificity': 0.767858, 'f1': 0.81127304, 'auroc': 0.8477502, 'binary_precision': 0.8181818, 'binary_recall': 0.55172414, 'binary_specificity': 0.983992, 'binary_f1_score': 0.6590389}
confusion matrix:
      0    1
0  5901   96
1   351  432
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504945_26.png
early stop counter: 25
val acc:0.9555662274360657, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.9348082542419434
after epoch: 26,now: 2024-06-19 10:16:23.098877,epoch time: 0:28:05.395076,used: 7:34:20.843540,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_02_42_02_seed_0_21504945
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.96900684, 'precision': 0.91301227, 'recall': 0.90393305, 'specificity': 0.90393305, 'f1': 0.9084079, 'auroc': 0.9788422, 'binary_precision': 0.844367, 'binary_recall': 0.8237027, 'binary_specificity': 0.9841634, 'binary_f1_score': 0.8339069}
confusion matrix:
       0     1
0  41637   670
1    778  3635
---- Validation: 
scalar performance:
{'acc': 0.9554598, 'precision': 0.6291844, 'recall': 0.59216255, 'specificity': 0.59216255, 'f1': 0.60703516, 'auroc': 0.74532866, 'binary_precision': 0.2863436, 'binary_recall': 0.2021773, 'binary_specificity': 0.98214775, 'binary_f1_score': 0.23701002}
confusion matrix:
       0    1
0  17825  324
1    513  130
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93333334, 'precision': 0.88031024, 'recall': 0.76411, 'specificity': 0.76411, 'f1': 0.80824715, 'auroc': 0.85413015, 'binary_precision': 0.81765836, 'binary_recall': 0.5440613, 'binary_specificity': 0.98415875, 'binary_f1_score': 0.65337425}
confusion matrix:
      0    1
0  5902   95
1   357  426
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504945_27.png
early stop counter: 26
val acc:0.9554597735404968, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.9348082542419434
after epoch: 27,now: 2024-06-19 10:41:22.321413,epoch time: 0:24:59.222536,used: 7:59:20.066076,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_02_42_02_seed_0_21504945
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9677654, 'precision': 0.9037347, 'recall': 0.9091336, 'specificity': 0.9091336, 'f1': 0.90641093, 'auroc': 0.9779862, 'binary_precision': 0.8245144, 'binary_recall': 0.8368457, 'binary_specificity': 0.98142153, 'binary_f1_score': 0.8306343}
confusion matrix:
       0     1
0  41521   786
1    720  3693
---- Validation: 
scalar performance:
{'acc': 0.95498085, 'precision': 0.6283594, 'recall': 0.5949148, 'specificity': 0.5949148, 'f1': 0.6086887, 'auroc': 0.7539941, 'binary_precision': 0.28450108, 'binary_recall': 0.20839813, 'binary_specificity': 0.9814315, 'binary_f1_score': 0.24057451}
confusion matrix:
       0    1
0  17812  337
1    509  134
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93333334, 'precision': 0.8727293, 'recall': 0.77243793, 'specificity': 0.77243793, 'f1': 0.8120995, 'auroc': 0.85836405, 'binary_precision': 0.800363, 'binary_recall': 0.5632184, 'binary_specificity': 0.9816575, 'binary_f1_score': 0.6611694}
confusion matrix:
      0    1
0  5887  110
1   342  441
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504945_28.png
early stop counter: 27
val acc:0.9549808502197266, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.9348082542419434
after epoch: 28,now: 2024-06-19 11:00:04.569211,epoch time: 0:18:42.247798,used: 8:18:02.313874,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_02_42_02_seed_0_21504945
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.96543235, 'precision': 0.89591634, 'recall': 0.90417284, 'specificity': 0.90417284, 'f1': 0.89998937, 'auroc': 0.9757689, 'binary_precision': 0.8097453, 'binary_recall': 0.82864916, 'binary_specificity': 0.9796965, 'binary_f1_score': 0.81908816}
confusion matrix:
       0     1
0  41449   859
1    756  3656
---- Validation: 
scalar performance:
{'acc': 0.9555662, 'precision': 0.62932175, 'recall': 0.5914676, 'specificity': 0.5914676, 'f1': 0.60658264, 'auroc': 0.7363331, 'binary_precision': 0.28666666, 'binary_recall': 0.20062208, 'binary_specificity': 0.9823131, 'binary_f1_score': 0.23604757}
confusion matrix:
       0    1
0  17828  321
1    514  129
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9321534, 'precision': 0.86436105, 'recall': 0.77510214, 'specificity': 0.77510214, 'f1': 0.8112898, 'auroc': 0.8546401, 'binary_precision': 0.78283715, 'binary_recall': 0.57088125, 'binary_specificity': 0.97932297, 'binary_f1_score': 0.66026586}
confusion matrix:
      0    1
0  5873  124
1   336  447
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504945_29.png
early stop counter: 28
val acc:0.9555662274360657, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.9348082542419434
after epoch: 29,now: 2024-06-19 11:27:16.580361,epoch time: 0:27:12.011150,used: 8:45:14.325024,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_02_42_02_seed_0_21504945
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9691567, 'precision': 0.9071182, 'recall': 0.9141297, 'specificity': 0.9141297, 'f1': 0.9105853, 'auroc': 0.97589827, 'binary_precision': 0.8302936, 'binary_recall': 0.84629333, 'binary_specificity': 0.981966, 'binary_f1_score': 0.83821714}
confusion matrix:
       0     1
0  41546   763
1    678  3733
---- Validation: 
scalar performance:
{'acc': 0.95306516, 'precision': 0.6182314, 'recall': 0.59392303, 'specificity': 0.59392303, 'f1': 0.6044176, 'auroc': 0.7419702, 'binary_precision': 0.2642998, 'binary_recall': 0.20839813, 'binary_specificity': 0.9794479, 'binary_f1_score': 0.23304348}
confusion matrix:
       0    1
0  17776  373
1    509  134
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9353982, 'precision': 0.8730808, 'recall': 0.78526425, 'specificity': 0.78526425, 'f1': 0.8212533, 'auroc': 0.85840666, 'binary_precision': 0.79792744, 'binary_recall': 0.5900383, 'binary_specificity': 0.98049027, 'binary_f1_score': 0.6784141}
confusion matrix:
      0    1
0  5880  117
1   321  462
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504945_30.png
new oracle model saved
early stop counter: 29
val acc:0.9530651569366455, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.9353982210159302
after epoch: 30,now: 2024-06-19 11:59:58.018340,epoch time: 0:32:41.437979,used: 9:17:55.763003,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_02_42_02_seed_0_21504945
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 9:17:55.763003 at 2024-06-19 11:59:58.018340
persisted model performance metric: 

scalar performance:
{'acc': 0.88451326, 'precision': 0.44225663, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.469359, 'auroc': 0.29790822, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   783  0
oracle model performance metric: 

scalar performance:
{'acc': 0.9353982, 'precision': 0.8730808, 'recall': 0.78526425, 'specificity': 0.78526425, 'f1': 0.8212533, 'auroc': 0.85840666, 'binary_precision': 0.79792744, 'binary_recall': 0.5900383, 'binary_specificity': 0.98049027, 'binary_f1_score': 0.6784141}
confusion matrix:
      0    1
0  5880  117
1   321  462
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_resnet_different_bs128_lre4_classbalancing/rule_results/0.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_resnet_different_bs128_lre4_classbalancing/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_resnet_different_bs128_lre4_classbalancing/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204121 KiB |   1730 MiB | 427741 GiB | 427741 GiB |
|       from large pool | 167936 KiB |   1660 MiB | 427621 GiB | 427621 GiB |
|       from small pool |  36185 KiB |     72 MiB |    120 GiB |    120 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 204121 KiB |   1730 MiB | 427741 GiB | 427741 GiB |
|       from large pool | 167936 KiB |   1660 MiB | 427621 GiB | 427621 GiB |
|       from small pool |  36185 KiB |     72 MiB |    120 GiB |    120 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201112 KiB |   1723 MiB | 427735 GiB | 427735 GiB |
|       from large pool | 165120 KiB |   1653 MiB | 427617 GiB | 427617 GiB |
|       from small pool |  35992 KiB |     71 MiB |    118 GiB |    118 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1876 MiB |   1876 MiB |   1876 MiB |      0 B   |
|       from large pool |   1802 MiB |   1802 MiB |   1802 MiB |      0 B   |
|       from small pool |     74 MiB |     74 MiB |     74 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 404134 KiB | 758032 KiB | 303332 GiB | 303331 GiB |
|       from large pool | 397312 KiB | 756864 KiB | 303206 GiB | 303205 GiB |
|       from small pool |   6822 KiB |  12667 KiB |    125 GiB |    125 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1218    |    1875    |   12699 K  |   12698 K  |
|       from large pool |      36    |      76    |    4061 K  |    4061 K  |
|       from small pool |    1182    |    1804    |    8638 K  |    8637 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1218    |    1875    |   12699 K  |   12698 K  |
|       from large pool |      36    |      76    |    4061 K  |    4061 K  |
|       from small pool |    1182    |    1804    |    8638 K  |    8637 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      50    |      50    |      50    |       0    |
|       from large pool |      13    |      13    |      13    |       0    |
|       from small pool |      37    |      37    |      37    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      43    |     383    |    7258 K  |    7258 K  |
|       from large pool |       5    |      10    |    1608 K  |    1608 K  |
|       from small pool |      38    |     378    |    5649 K  |    5649 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1730 MiB | 427741 GiB | 427741 GiB |
|       from large pool |  16640 KiB |   1660 MiB | 427621 GiB | 427621 GiB |
|       from small pool |      0 KiB |     72 MiB |    120 GiB |    120 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1730 MiB | 427741 GiB | 427741 GiB |
|       from large pool |  16640 KiB |   1660 MiB | 427621 GiB | 427621 GiB |
|       from small pool |      0 KiB |     72 MiB |    120 GiB |    120 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1723 MiB | 427735 GiB | 427735 GiB |
|       from large pool |  16640 KiB |   1653 MiB | 427617 GiB | 427617 GiB |
|       from small pool |      0 KiB |     71 MiB |    118 GiB |    118 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 608256 KiB |   1876 MiB |   1876 MiB |   1282 MiB |
|       from large pool | 565248 KiB |   1802 MiB |   1802 MiB |   1250 MiB |
|       from small pool |  43008 KiB |     74 MiB |     74 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 384768 KiB | 758032 KiB | 303332 GiB | 303331 GiB |
|       from large pool | 384768 KiB | 756864 KiB | 303206 GiB | 303206 GiB |
|       from small pool |      0 KiB |  14417 KiB |    125 GiB |    125 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1875    |   12699 K  |   12699 K  |
|       from large pool |       2    |      76    |    4061 K  |    4061 K  |
|       from small pool |       0    |    1804    |    8638 K  |    8638 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1875    |   12699 K  |   12699 K  |
|       from large pool |       2    |      76    |    4061 K  |    4061 K  |
|       from small pool |       0    |    1804    |    8638 K  |    8638 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      30    |      50    |      50    |      20    |
|       from large pool |       9    |      13    |      13    |       4    |
|       from small pool |      21    |      37    |      37    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     383    |    7258 K  |    7258 K  |
|       from large pool |       1    |      11    |    1608 K  |    1608 K  |
|       from small pool |       0    |     378    |    5649 K  |    5649 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1730 MiB | 427741 GiB | 427741 GiB |
|       from large pool |  16640 KiB |   1660 MiB | 427621 GiB | 427621 GiB |
|       from small pool |      0 KiB |     72 MiB |    120 GiB |    120 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1730 MiB | 427741 GiB | 427741 GiB |
|       from large pool |  16640 KiB |   1660 MiB | 427621 GiB | 427621 GiB |
|       from small pool |      0 KiB |     72 MiB |    120 GiB |    120 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1723 MiB | 427735 GiB | 427735 GiB |
|       from large pool |  16640 KiB |   1653 MiB | 427617 GiB | 427617 GiB |
|       from small pool |      0 KiB |     71 MiB |    118 GiB |    118 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 608256 KiB |   1876 MiB |   1876 MiB |   1282 MiB |
|       from large pool | 565248 KiB |   1802 MiB |   1802 MiB |   1250 MiB |
|       from small pool |  43008 KiB |     74 MiB |     74 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 384768 KiB | 758032 KiB | 303332 GiB | 303331 GiB |
|       from large pool | 384768 KiB | 756864 KiB | 303206 GiB | 303206 GiB |
|       from small pool |      0 KiB |  14417 KiB |    125 GiB |    125 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1875    |   12699 K  |   12699 K  |
|       from large pool |       2    |      76    |    4061 K  |    4061 K  |
|       from small pool |       0    |    1804    |    8638 K  |    8638 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1875    |   12699 K  |   12699 K  |
|       from large pool |       2    |      76    |    4061 K  |    4061 K  |
|       from small pool |       0    |    1804    |    8638 K  |    8638 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      30    |      50    |      50    |      20    |
|       from large pool |       9    |      13    |      13    |       4    |
|       from small pool |      21    |      37    |      37    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     383    |    7258 K  |    7258 K  |
|       from large pool |       1    |      11    |    1608 K  |    1608 K  |
|       from small pool |       0    |     378    |    5649 K  |    5649 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0




!!!: not committed yet



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_12_12_13_seed_1_21504945

 Experiment start at: 2024-06-19 12:12:13.931970
before training, model accuracy: 0.20428188145160675
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9072774, 'precision': 0.4537261, 'recall': 0.49989387, 'specificity': 0.49989387, 'f1': 0.47569245, 'auroc': 0.54225135, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99978775, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42388  9
1   4323  0
---- Validation: 
scalar performance:
{'acc': 0.96376735, 'precision': 0.482038, 'recall': 0.49983394, 'specificity': 0.49983394, 'f1': 0.49077466, 'auroc': 0.336243, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9996679, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18061  6
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88403213, 'precision': 0.44201607, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4692235, 'auroc': 0.2155824, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   780  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504945_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-19 12:38:10.219329,epoch time: 0:25:56.287359,used: 0:25:56.287359,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_12_12_13_seed_1_21504945
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9068065, 'precision': 0.45368487, 'recall': 0.499658, 'specificity': 0.499658, 'f1': 0.47556293, 'auroc': 0.7207539, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.999316, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  42366  29
1   4325   0
---- Validation: 
scalar performance:
{'acc': 0.96387404, 'precision': 0.48203993, 'recall': 0.4998893, 'specificity': 0.4998893, 'f1': 0.49080238, 'auroc': 0.36073887, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9997786, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18063  4
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88403213, 'precision': 0.44201607, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4692235, 'auroc': 0.24786672, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   780  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504945_2.png
better model found
persisted
after epoch: 2,now: 2024-06-19 13:04:12.239862,epoch time: 0:26:02.020533,used: 0:51:58.307892,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_12_12_13_seed_1_21504945
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.90597177, 'precision': 0.59186226, 'recall': 0.5036408, 'specificity': 0.5036408, 'f1': 0.48490977, 'auroc': 0.84174645, 'binary_precision': 0.27564102, 'binary_recall': 0.009946796, 'binary_specificity': 0.9973347, 'binary_f1_score': 0.019200714}
confusion matrix:
       0    1
0  42284  113
1   4280   43
---- Validation: 
scalar performance:
{'acc': 0.9632337, 'precision': 0.48202842, 'recall': 0.4995572, 'specificity': 0.4995572, 'f1': 0.4906363, 'auroc': 0.40053165, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9991144, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18051  16
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88403213, 'precision': 0.44201607, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4692235, 'auroc': 0.35149747, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   780  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504945_3.png
