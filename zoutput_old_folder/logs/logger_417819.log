Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0




!!!: not committed yet



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504643

 Experiment start at: 2024-06-18 20:01:53.734182
before training, model accuracy: 0.31622418761253357
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9528908, 'precision': 0.9714519, 'recall': 0.75245094, 'specificity': 0.75245094, 'f1': 0.822104, 'auroc': 0.95581913, 'binary_precision': 0.9919893, 'binary_recall': 0.5053276, 'binary_specificity': 0.99957436, 'binary_f1_score': 0.66957045}
confusion matrix:
       0     1
0  42271    18
1   2182  2229
---- Validation: 
scalar performance:
{'acc': 0.9656769, 'precision': 0.6704642, 'recall': 0.50219506, 'specificity': 0.50219506, 'f1': 0.49587625, 'auroc': 0.56653863, 'binary_precision': 0.375, 'binary_recall': 0.00466563, 'binary_specificity': 0.9997245, 'binary_f1_score': 0.00921659}
confusion matrix:
       0  1
0  18144  5
1    640  3
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8839233, 'precision': 0.44222254, 'recall': 0.4996665, 'specificity': 0.4996665, 'f1': 0.46919283, 'auroc': 0.59918064, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.999333, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5993  4
1   783  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504643_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-18 20:26:56.238911,epoch time: 0:25:02.504729,used: 0:25:02.504729,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504643
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9755032, 'precision': 0.9815633, 'recall': 0.8742107, 'specificity': 0.8742107, 'f1': 0.9195719, 'auroc': 0.9803504, 'binary_precision': 0.9886364, 'binary_recall': 0.74932003, 'binary_specificity': 0.9991014, 'binary_f1_score': 0.8525013}
confusion matrix:
       0     1
0  42250    38
1   1106  3306
---- Validation: 
scalar performance:
{'acc': 0.9665283, 'precision': 0.767419, 'recall': 0.545389, 'specificity': 0.545389, 'f1': 0.5715687, 'auroc': 0.6924424, 'binary_precision': 0.5660377, 'binary_recall': 0.0933126, 'binary_specificity': 0.99746543, 'binary_f1_score': 0.16021362}
confusion matrix:
       0   1
0  18103  46
1    583  60
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89174044, 'precision': 0.84405893, 'recall': 0.5407282, 'specificity': 0.5407282, 'f1': 0.5473012, 'auroc': 0.72848666, 'binary_precision': 0.79518074, 'binary_recall': 0.08429119, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.15242495}
confusion matrix:
      0   1
0  5980  17
1   717  66
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504643_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-18 20:46:33.630485,epoch time: 0:19:37.391574,used: 0:44:39.896303,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504643
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9809208, 'precision': 0.9807818, 'recall': 0.9062321, 'specificity': 0.9062321, 'f1': 0.9396085, 'auroc': 0.9855547, 'binary_precision': 0.980617, 'binary_recall': 0.81414324, 'binary_specificity': 0.99832106, 'binary_f1_score': 0.8896594}
confusion matrix:
       0     1
0  42217    71
1    820  3592
---- Validation: 
scalar performance:
{'acc': 0.96695405, 'precision': 0.7708254, 'recall': 0.566611, 'specificity': 0.566611, 'f1': 0.60197353, 'auroc': 0.7144484, 'binary_precision': 0.5714286, 'binary_recall': 0.13685848, 'binary_specificity': 0.99636346, 'binary_f1_score': 0.22082812}
confusion matrix:
       0   1
0  18083  66
1    555  88
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8958702, 'precision': 0.85039485, 'recall': 0.56304973, 'specificity': 0.56304973, 'f1': 0.58418274, 'auroc': 0.7398342, 'binary_precision': 0.8031496, 'binary_recall': 0.1302682, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.22417583}
confusion matrix:
      0    1
0  5972   25
1   681  102
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504643_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-18 21:06:29.611940,epoch time: 0:19:55.981455,used: 1:04:35.877758,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504643
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98349035, 'precision': 0.98222667, 'recall': 0.9200165, 'specificity': 0.9200165, 'f1': 0.9484461, 'auroc': 0.9896621, 'binary_precision': 0.98071843, 'binary_recall': 0.84175926, 'binary_specificity': 0.9982738, 'binary_f1_score': 0.9059412}
confusion matrix:
       0     1
0  42216    73
1    698  3713
---- Validation: 
scalar performance:
{'acc': 0.967433, 'precision': 0.77511585, 'recall': 0.58636034, 'specificity': 0.58636034, 'f1': 0.6273864, 'auroc': 0.75134706, 'binary_precision': 0.5786802, 'binary_recall': 0.17729394, 'binary_specificity': 0.9954268, 'binary_f1_score': 0.27142859}
confusion matrix:
       0    1
0  18066   83
1    529  114
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9044248, 'precision': 0.887132, 'recall': 0.5995316, 'specificity': 0.5995316, 'f1': 0.6388697, 'auroc': 0.77196056, 'binary_precision': 0.86885244, 'binary_recall': 0.20306513, 'binary_specificity': 0.995998, 'binary_f1_score': 0.32919255}
confusion matrix:
      0    1
0  5973   24
1   624  159
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504643_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-18 21:26:40.380770,epoch time: 0:20:10.768830,used: 1:24:46.646588,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504643
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98415416, 'precision': 0.984159, 'recall': 0.92217565, 'specificity': 0.92217565, 'f1': 0.95052445, 'auroc': 0.99063575, 'binary_precision': 0.9841647, 'binary_recall': 0.84577, 'binary_specificity': 0.99858123, 'binary_f1_score': 0.90973413}
confusion matrix:
       0     1
0  42231    60
1    680  3729
---- Validation: 
scalar performance:
{'acc': 0.967433, 'precision': 0.78403705, 'recall': 0.5721093, 'specificity': 0.5721093, 'f1': 0.6101346, 'auroc': 0.7522348, 'binary_precision': 0.5974843, 'binary_recall': 0.14774494, 'binary_specificity': 0.9964736, 'binary_f1_score': 0.23690774}
confusion matrix:
       0   1
0  18085  64
1    548  95
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89896756, 'precision': 0.88002664, 'recall': 0.5731285, 'specificity': 0.5731285, 'f1': 0.60021794, 'auroc': 0.76146746, 'binary_precision': 0.8602941, 'binary_recall': 0.14942528, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.2546246}
confusion matrix:
      0    1
0  5978   19
1   666  117
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504643_5.png
early stop counter: 1
val acc:0.967432975769043, best validation acc: 0.967432975769043, corresponding to test acc:                         0.904424786567688 / 0.904424786567688
after epoch: 5,now: 2024-06-18 21:46:33.210808,epoch time: 0:19:52.830038,used: 1:44:39.476626,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504643
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9867024, 'precision': 0.9808234, 'recall': 0.9402287, 'specificity': 0.9402287, 'f1': 0.9594046, 'auroc': 0.9910984, 'binary_precision': 0.9737303, 'binary_recall': 0.8829401, 'binary_specificity': 0.9975173, 'binary_f1_score': 0.92611545}
confusion matrix:
       0     1
0  42187   105
1    516  3892
---- Validation: 
scalar performance:
{'acc': 0.9661558, 'precision': 0.7432053, 'recall': 0.5946998, 'specificity': 0.5946998, 'f1': 0.6332261, 'auroc': 0.7781136, 'binary_precision': 0.51428574, 'binary_recall': 0.19595645, 'binary_specificity': 0.9934432, 'binary_f1_score': 0.2837838}
confusion matrix:
       0    1
0  18030  119
1    517  126
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9076696, 'precision': 0.87781364, 'recall': 0.61968726, 'specificity': 0.61968726, 'f1': 0.6651588, 'auroc': 0.7851174, 'binary_precision': 0.845815, 'binary_recall': 0.24521072, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.38019803}
confusion matrix:
      0    1
0  5962   35
1   591  192
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504643_6.png
new oracle model saved
early stop counter: 2
val acc:0.9661558270454407, best validation acc: 0.967432975769043, corresponding to test acc:                         0.904424786567688 / 0.9076696038246155
after epoch: 6,now: 2024-06-18 22:08:27.164807,epoch time: 0:21:53.953999,used: 2:06:33.430625,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504643
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9878801, 'precision': 0.98465127, 'recall': 0.94368505, 'specificity': 0.94368505, 'f1': 0.9630356, 'auroc': 0.9934745, 'binary_precision': 0.9807548, 'binary_recall': 0.88919103, 'binary_specificity': 0.99817914, 'binary_f1_score': 0.93273115}
confusion matrix:
       0     1
0  42210    77
1    489  3924
---- Validation: 
scalar performance:
{'acc': 0.9670072, 'precision': 0.7640694, 'recall': 0.5853899, 'specificity': 0.5853899, 'f1': 0.6251316, 'auroc': 0.78592324, 'binary_precision': 0.5566502, 'binary_recall': 0.17573872, 'binary_specificity': 0.9950411, 'binary_f1_score': 0.26713946}
confusion matrix:
       0    1
0  18059   90
1    530  113
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9051622, 'precision': 0.88732135, 'recall': 0.6032796, 'specificity': 0.6032796, 'f1': 0.6440364, 'auroc': 0.7986784, 'binary_precision': 0.8684211, 'binary_recall': 0.21072797, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.33915725}
confusion matrix:
      0    1
0  5972   25
1   618  165
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504643_7.png
early stop counter: 3
val acc:0.9670072197914124, best validation acc: 0.967432975769043, corresponding to test acc:                         0.904424786567688 / 0.9076696038246155
after epoch: 7,now: 2024-06-18 22:30:49.676403,epoch time: 0:22:22.511596,used: 2:28:55.942221,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504643
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98751605, 'precision': 0.9825659, 'recall': 0.9434464, 'specificity': 0.9434464, 'f1': 0.96197015, 'auroc': 0.99330974, 'binary_precision': 0.9765878, 'binary_recall': 0.88911563, 'binary_specificity': 0.9977772, 'binary_f1_score': 0.93080115}
confusion matrix:
       0     1
0  42196    94
1    489  3921
---- Validation: 
scalar performance:
{'acc': 0.96706045, 'precision': 0.7637005, 'recall': 0.59066784, 'specificity': 0.59066784, 'f1': 0.6312698, 'auroc': 0.8021999, 'binary_precision': 0.5555556, 'binary_recall': 0.1866252, 'binary_specificity': 0.99471045, 'binary_f1_score': 0.27939466}
confusion matrix:
       0    1
0  18053   96
1    523  120
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90427727, 'precision': 0.88476384, 'recall': 0.5994482, 'specificity': 0.5994482, 'f1': 0.6386578, 'auroc': 0.8116019, 'binary_precision': 0.86413044, 'binary_recall': 0.20306513, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.32885212}
confusion matrix:
      0    1
0  5972   25
1   624  159
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504643_8.png
early stop counter: 4
val acc:0.9670604467391968, best validation acc: 0.967432975769043, corresponding to test acc:                         0.904424786567688 / 0.9076696038246155
after epoch: 8,now: 2024-06-18 22:52:20.671005,epoch time: 0:21:30.994602,used: 2:50:26.936823,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504643
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9890364, 'precision': 0.98380613, 'recall': 0.95130396, 'specificity': 0.95130396, 'f1': 0.966846, 'auroc': 0.9946164, 'binary_precision': 0.97746754, 'binary_recall': 0.9047835, 'binary_specificity': 0.9978245, 'binary_f1_score': 0.9397222}
confusion matrix:
       0     1
0  42197    92
1    420  3991
---- Validation: 
scalar performance:
{'acc': 0.966688, 'precision': 0.75162005, 'recall': 0.6137267, 'specificity': 0.6137267, 'f1': 0.6541767, 'auroc': 0.80242807, 'binary_precision': 0.52982455, 'binary_recall': 0.2348367, 'binary_specificity': 0.99261665, 'binary_f1_score': 0.32543105}
confusion matrix:
       0    1
0  18015  134
1    492  151
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9078171, 'precision': 0.88911796, 'recall': 0.61643946, 'specificity': 0.61643946, 'f1': 0.66168505, 'auroc': 0.79859984, 'binary_precision': 0.86915886, 'binary_recall': 0.23754789, 'binary_specificity': 0.995331, 'binary_f1_score': 0.37311935}
confusion matrix:
      0    1
0  5969   28
1   597  186
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504643_9.png
new oracle model saved
early stop counter: 5
val acc:0.9666879773139954, best validation acc: 0.967432975769043, corresponding to test acc:                         0.904424786567688 / 0.9078171253204346
after epoch: 9,now: 2024-06-18 23:15:09.922245,epoch time: 0:22:49.251240,used: 3:13:16.188063,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504643
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98940045, 'precision': 0.985749, 'recall': 0.95162797, 'specificity': 0.95162797, 'f1': 0.96790934, 'auroc': 0.9948784, 'binary_precision': 0.98132676, 'binary_recall': 0.90505326, 'binary_specificity': 0.99820274, 'binary_f1_score': 0.941648}
confusion matrix:
       0     1
0  42211    76
1    419  3994
---- Validation: 
scalar performance:
{'acc': 0.9665815, 'precision': 0.75137794, 'recall': 0.5986705, 'specificity': 0.5986705, 'f1': 0.6386338, 'auroc': 0.8030187, 'binary_precision': 0.5303644, 'binary_recall': 0.2037325, 'binary_specificity': 0.9936085, 'binary_f1_score': 0.29438204}
confusion matrix:
       0    1
0  18033  116
1    512  131
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9, 'precision': 0.85471165, 'recall': 0.58537126, 'specificity': 0.58537126, 'f1': 0.61776215, 'auroc': 0.80182254, 'binary_precision': 0.80701756, 'binary_recall': 0.17624521, 'binary_specificity': 0.99449724, 'binary_f1_score': 0.2893082}
confusion matrix:
      0    1
0  5964   33
1   645  138
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504643_10.png
early stop counter: 6
val acc:0.9665815234184265, best validation acc: 0.967432975769043, corresponding to test acc:                         0.904424786567688 / 0.9078171253204346
after epoch: 10,now: 2024-06-18 23:35:12.013754,epoch time: 0:20:02.091509,used: 3:33:18.279572,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504643
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98972166, 'precision': 0.985209, 'recall': 0.9540073, 'specificity': 0.9540073, 'f1': 0.96895754, 'auroc': 0.99550736, 'binary_precision': 0.9797363, 'binary_recall': 0.9099773, 'binary_specificity': 0.99803734, 'binary_f1_score': 0.94356924}
confusion matrix:
       0     1
0  42207    83
1    397  4013
---- Validation: 
scalar performance:
{'acc': 0.96674114, 'precision': 0.7540419, 'recall': 0.6025034, 'specificity': 0.6025034, 'f1': 0.6430985, 'auroc': 0.8090153, 'binary_precision': 0.53543305, 'binary_recall': 0.21150856, 'binary_specificity': 0.99349827, 'binary_f1_score': 0.303233}
confusion matrix:
       0    1
0  18031  118
1    507  136
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9023599, 'precision': 0.8657501, 'recall': 0.59503317, 'specificity': 0.59503317, 'f1': 0.6317713, 'auroc': 0.81229115, 'binary_precision': 0.827027, 'binary_recall': 0.1954023, 'binary_specificity': 0.994664, 'binary_f1_score': 0.31611568}
confusion matrix:
      0    1
0  5965   32
1   630  153
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504643_11.png
early stop counter: 7
val acc:0.966741144657135, best validation acc: 0.967432975769043, corresponding to test acc:                         0.904424786567688 / 0.9078171253204346
after epoch: 11,now: 2024-06-18 23:57:27.201589,epoch time: 0:22:15.187835,used: 3:55:33.467407,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504643
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99006426, 'precision': 0.98203546, 'recall': 0.9591994, 'specificity': 0.9591994, 'f1': 0.9702687, 'auroc': 0.99592304, 'binary_precision': 0.97225547, 'binary_recall': 0.9211421, 'binary_specificity': 0.9972568, 'binary_f1_score': 0.94600886}
confusion matrix:
       0     1
0  42171   116
1    348  4065
---- Validation: 
scalar performance:
{'acc': 0.966688, 'precision': 0.75221145, 'recall': 0.6084763, 'specificity': 0.6084763, 'f1': 0.6490137, 'auroc': 0.81876373, 'binary_precision': 0.53136533, 'binary_recall': 0.22395024, 'binary_specificity': 0.99300236, 'binary_f1_score': 0.3150985}
confusion matrix:
       0    1
0  18022  127
1    499  144
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8973451, 'precision': 0.836951, 'recall': 0.57554257, 'specificity': 0.57554257, 'f1': 0.6029936, 'auroc': 0.8055878, 'binary_precision': 0.7735849, 'binary_recall': 0.15708812, 'binary_specificity': 0.993997, 'binary_f1_score': 0.2611465}
confusion matrix:
      0    1
0  5961   36
1   660  123
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504643_12.png
early stop counter: 8
val acc:0.9666879773139954, best validation acc: 0.967432975769043, corresponding to test acc:                         0.904424786567688 / 0.9078171253204346
after epoch: 12,now: 2024-06-19 00:19:55.137297,epoch time: 0:22:27.935708,used: 4:18:01.403115,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504643
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9914133, 'precision': 0.9859129, 'recall': 0.96338654, 'specificity': 0.96338654, 'f1': 0.9743136, 'auroc': 0.9966133, 'binary_precision': 0.97921145, 'binary_recall': 0.92883044, 'binary_specificity': 0.9979427, 'binary_f1_score': 0.9533558}
confusion matrix:
       0     1
0  42201    87
1    314  4098
---- Validation: 
scalar performance:
{'acc': 0.9665815, 'precision': 0.7524611, 'recall': 0.59116995, 'specificity': 0.59116995, 'f1': 0.63052785, 'auroc': 0.8174628, 'binary_precision': 0.5330396, 'binary_recall': 0.1881804, 'binary_specificity': 0.99415946, 'binary_f1_score': 0.27816093}
confusion matrix:
       0    1
0  18043  106
1    522  121
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8957227, 'precision': 0.83488595, 'recall': 0.56629753, 'specificity': 0.56629753, 'f1': 0.58903635, 'auroc': 0.80316174, 'binary_precision': 0.7714286, 'binary_recall': 0.13793103, 'binary_specificity': 0.994664, 'binary_f1_score': 0.23401949}
confusion matrix:
      0    1
0  5965   32
1   675  108
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504643_13.png
early stop counter: 9
val acc:0.9665815234184265, best validation acc: 0.967432975769043, corresponding to test acc:                         0.904424786567688 / 0.9078171253204346
after epoch: 13,now: 2024-06-19 00:39:20.991389,epoch time: 0:19:25.854092,used: 4:37:27.257207,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504643
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9910707, 'precision': 0.98496556, 'recall': 0.96228385, 'specificity': 0.96228385, 'f1': 0.9732831, 'auroc': 0.9960104, 'binary_precision': 0.9775281, 'binary_recall': 0.9267906, 'binary_specificity': 0.99777716, 'binary_f1_score': 0.9514834}
confusion matrix:
       0     1
0  42194    94
1    323  4089
---- Validation: 
scalar performance:
{'acc': 0.96706045, 'precision': 0.76160073, 'recall': 0.5981684, 'specificity': 0.5981684, 'f1': 0.63946325, 'auroc': 0.81701195, 'binary_precision': 0.5508475, 'binary_recall': 0.2021773, 'binary_specificity': 0.99415946, 'binary_f1_score': 0.2957907}
confusion matrix:
       0    1
0  18043  106
1    513  130
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89778763, 'precision': 0.84441197, 'recall': 0.5757927, 'specificity': 0.5757927, 'f1': 0.6035362, 'auroc': 0.8022493, 'binary_precision': 0.78846157, 'binary_recall': 0.15708812, 'binary_specificity': 0.99449724, 'binary_f1_score': 0.26198083}
confusion matrix:
      0    1
0  5964   33
1   660  123
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504643_14.png
early stop counter: 10
val acc:0.9670604467391968, best validation acc: 0.967432975769043, corresponding to test acc:                         0.904424786567688 / 0.9078171253204346
after epoch: 14,now: 2024-06-19 01:01:11.535529,epoch time: 0:21:50.544140,used: 4:59:17.801347,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504643
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99132764, 'precision': 0.9870986, 'recall': 0.96170676, 'specificity': 0.96170676, 'f1': 0.9739758, 'auroc': 0.9964148, 'binary_precision': 0.9819538, 'binary_recall': 0.92518705, 'binary_specificity': 0.99822646, 'binary_f1_score': 0.9527256}
confusion matrix:
       0     1
0  42214    75
1    330  4081
---- Validation: 
scalar performance:
{'acc': 0.96663475, 'precision': 0.7543335, 'recall': 0.58744717, 'specificity': 0.58744717, 'f1': 0.6265043, 'auroc': 0.8121017, 'binary_precision': 0.537037, 'binary_recall': 0.18040435, 'binary_specificity': 0.99449, 'binary_f1_score': 0.27008146}
confusion matrix:
       0    1
0  18049  100
1    527  116
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89528024, 'precision': 0.8381023, 'recall': 0.56271625, 'specificity': 0.56271625, 'f1': 0.58352524, 'auroc': 0.79414773, 'binary_precision': 0.77862597, 'binary_recall': 0.1302682, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.22319476}
confusion matrix:
      0    1
0  5968   29
1   681  102
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504643_15.png
early stop counter: 11
val acc:0.9666347503662109, best validation acc: 0.967432975769043, corresponding to test acc:                         0.904424786567688 / 0.9078171253204346
after epoch: 15,now: 2024-06-19 01:23:02.094296,epoch time: 0:21:50.558767,used: 5:21:08.360114,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504643
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9912634, 'precision': 0.98716366, 'recall': 0.9612737, 'specificity': 0.9612737, 'f1': 0.97377473, 'auroc': 0.9955534, 'binary_precision': 0.98217726, 'binary_recall': 0.9242974, 'binary_specificity': 0.99825007, 'binary_f1_score': 0.9523587}
confusion matrix:
       0     1
0  42214    74
1    334  4078
---- Validation: 
scalar performance:
{'acc': 0.9668476, 'precision': 0.76022637, 'recall': 0.5845572, 'specificity': 0.5845572, 'f1': 0.6237522, 'auroc': 0.8220099, 'binary_precision': 0.54901963, 'binary_recall': 0.17418352, 'binary_specificity': 0.99493086, 'binary_f1_score': 0.2644628}
confusion matrix:
       0    1
0  18057   92
1    531  112
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89454275, 'precision': 0.83548915, 'recall': 0.5589682, 'specificity': 0.5589682, 'f1': 0.5775893, 'auroc': 0.8028016, 'binary_precision': 0.7741935, 'binary_recall': 0.12260536, 'binary_specificity': 0.995331, 'binary_f1_score': 0.21168686}
confusion matrix:
      0   1
0  5969  28
1   687  96
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504643_16.png
early stop counter: 12
val acc:0.9668475985527039, best validation acc: 0.967432975769043, corresponding to test acc:                         0.904424786567688 / 0.9078171253204346
after epoch: 16,now: 2024-06-19 01:48:05.376155,epoch time: 0:25:03.281859,used: 5:46:11.641973,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504643
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9914561, 'precision': 0.98823667, 'recall': 0.9614058, 'specificity': 0.9614058, 'f1': 0.9743451, 'auroc': 0.99657416, 'binary_precision': 0.98432225, 'binary_recall': 0.92434883, 'binary_specificity': 0.9984628, 'binary_f1_score': 0.9533933}
confusion matrix:
       0     1
0  42220    65
1    334  4081
---- Validation: 
scalar performance:
{'acc': 0.96674114, 'precision': 0.7591965, 'recall': 0.57850164, 'specificity': 0.57850164, 'f1': 0.6163468, 'auroc': 0.8166336, 'binary_precision': 0.5473684, 'binary_recall': 0.16174184, 'binary_specificity': 0.99526143, 'binary_f1_score': 0.24969988}
confusion matrix:
       0    1
0  18063   86
1    539  104
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8914454, 'precision': 0.81105983, 'recall': 0.5455582, 'specificity': 0.5455582, 'f1': 0.5556143, 'auroc': 0.79557526, 'binary_precision': 0.7281553, 'binary_recall': 0.09578544, 'binary_specificity': 0.995331, 'binary_f1_score': 0.16930021}
confusion matrix:
      0   1
0  5969  28
1   708  75
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504643_17.png
early stop counter: 13
val acc:0.966741144657135, best validation acc: 0.967432975769043, corresponding to test acc:                         0.904424786567688 / 0.9078171253204346
after epoch: 17,now: 2024-06-19 02:09:05.932121,epoch time: 0:21:00.555966,used: 6:07:12.197939,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504643
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99188435, 'precision': 0.98745185, 'recall': 0.9646306, 'specificity': 0.9646306, 'f1': 0.97569746, 'auroc': 0.99692273, 'binary_precision': 0.9820531, 'binary_recall': 0.9310345, 'binary_specificity': 0.99822664, 'binary_f1_score': 0.9558635}
confusion matrix:
       0     1
0  42217    75
1    304  4104
---- Validation: 
scalar performance:
{'acc': 0.96647507, 'precision': 0.74966526, 'recall': 0.5948651, 'specificity': 0.5948651, 'f1': 0.6342745, 'auroc': 0.82426983, 'binary_precision': 0.52719665, 'binary_recall': 0.19595645, 'binary_specificity': 0.99377376, 'binary_f1_score': 0.28571427}
confusion matrix:
       0    1
0  18036  113
1    517  126
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8941003, 'precision': 0.8156341, 'recall': 0.5620492, 'specificity': 0.5620492, 'f1': 0.5822227, 'auroc': 0.8018861, 'binary_precision': 0.7338129, 'binary_recall': 0.1302682, 'binary_specificity': 0.99383026, 'binary_f1_score': 0.22125813}
confusion matrix:
      0    1
0  5960   37
1   681  102
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504643_18.png
early stop counter: 14
val acc:0.9664750695228577, best validation acc: 0.967432975769043, corresponding to test acc:                         0.904424786567688 / 0.9078171253204346
after epoch: 18,now: 2024-06-19 02:32:17.970748,epoch time: 0:23:12.038627,used: 6:30:24.236566,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504643
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9919272, 'precision': 0.98779905, 'recall': 0.9645839, 'specificity': 0.9645839, 'f1': 0.9758358, 'auroc': 0.99706304, 'binary_precision': 0.982771, 'binary_recall': 0.93087035, 'binary_specificity': 0.9982974, 'binary_f1_score': 0.95611686}
confusion matrix:
       0     1
0  42216    72
1    305  4107
---- Validation: 
scalar performance:
{'acc': 0.96663475, 'precision': 0.75267446, 'recall': 0.5971979, 'specificity': 0.5971979, 'f1': 0.6372202, 'auroc': 0.8221219, 'binary_precision': 0.53305787, 'binary_recall': 0.20062208, 'binary_specificity': 0.99377376, 'binary_f1_score': 0.29152542}
confusion matrix:
       0    1
0  18036  113
1    514  129
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8926254, 'precision': 0.79865634, 'recall': 0.5578843, 'specificity': 0.5578843, 'f1': 0.5755503, 'auroc': 0.79803634, 'binary_precision': 0.7007299, 'binary_recall': 0.12260536, 'binary_specificity': 0.9931632, 'binary_f1_score': 0.20869564}
confusion matrix:
      0   1
0  5956  41
1   687  96
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504643_19.png
early stop counter: 15
val acc:0.9666347503662109, best validation acc: 0.967432975769043, corresponding to test acc:                         0.904424786567688 / 0.9078171253204346
after epoch: 19,now: 2024-06-19 02:53:21.830006,epoch time: 0:21:03.859258,used: 6:51:28.095824,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504643
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9922484, 'precision': 0.99009925, 'recall': 0.96426165, 'specificity': 0.96426165, 'f1': 0.9767412, 'auroc': 0.99698627, 'binary_precision': 0.98748493, 'binary_recall': 0.929753, 'binary_specificity': 0.9987703, 'binary_f1_score': 0.9577497}
confusion matrix:
       0     1
0  42235    52
1    310  4103
---- Validation: 
scalar performance:
{'acc': 0.9671137, 'precision': 0.76712745, 'recall': 0.5846949, 'specificity': 0.5846949, 'f1': 0.6246066, 'auroc': 0.82854354, 'binary_precision': 0.56281406, 'binary_recall': 0.17418352, 'binary_specificity': 0.99520636, 'binary_f1_score': 0.26603323}
confusion matrix:
       0    1
0  18062   87
1    531  112
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8914454, 'precision': 0.81105983, 'recall': 0.5455582, 'specificity': 0.5455582, 'f1': 0.5556143, 'auroc': 0.80530655, 'binary_precision': 0.7281553, 'binary_recall': 0.09578544, 'binary_specificity': 0.995331, 'binary_f1_score': 0.16930021}
confusion matrix:
      0   1
0  5969  28
1   708  75
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504643_20.png
early stop counter: 16
val acc:0.9671136736869812, best validation acc: 0.967432975769043, corresponding to test acc:                         0.904424786567688 / 0.9078171253204346
after epoch: 20,now: 2024-06-19 03:12:23.539750,epoch time: 0:19:01.709744,used: 7:10:29.805568,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504643
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99184155, 'precision': 0.9894202, 'recall': 0.96248984, 'specificity': 0.96248984, 'f1': 0.97547674, 'auroc': 0.99609756, 'binary_precision': 0.9864767, 'binary_recall': 0.92630386, 'binary_specificity': 0.9986758, 'binary_f1_score': 0.9554438}
confusion matrix:
       0     1
0  42234    56
1    325  4085
---- Validation: 
scalar performance:
{'acc': 0.9671137, 'precision': 0.7657516, 'recall': 0.5884452, 'specificity': 0.5884452, 'f1': 0.6289117, 'auroc': 0.82758987, 'binary_precision': 0.5598086, 'binary_recall': 0.18195957, 'binary_specificity': 0.99493086, 'binary_f1_score': 0.2746479}
confusion matrix:
       0    1
0  18057   92
1    526  117
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89277285, 'precision': 0.8164075, 'recall': 0.55297095, 'specificity': 0.55297095, 'f1': 0.5678446, 'auroc': 0.7965515, 'binary_precision': 0.7372881, 'binary_recall': 0.11111111, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.19311875}
confusion matrix:
      0   1
0  5966  31
1   696  87
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504643_21.png
early stop counter: 17
val acc:0.9671136736869812, best validation acc: 0.967432975769043, corresponding to test acc:                         0.904424786567688 / 0.9078171253204346
after epoch: 21,now: 2024-06-19 03:31:14.583127,epoch time: 0:18:51.043377,used: 7:29:20.848945,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504643
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9926981, 'precision': 0.9883943, 'recall': 0.9685552, 'specificity': 0.9685552, 'f1': 0.9782162, 'auroc': 0.99632394, 'binary_precision': 0.9831434, 'binary_recall': 0.93878937, 'binary_specificity': 0.99832106, 'binary_f1_score': 0.96045464}
confusion matrix:
       0     1
0  42218    71
1    270  4141
---- Validation: 
scalar performance:
{'acc': 0.9667944, 'precision': 0.7567629, 'recall': 0.5935303, 'specificity': 0.5935303, 'f1': 0.63370323, 'auroc': 0.82963705, 'binary_precision': 0.5414847, 'binary_recall': 0.19284603, 'binary_specificity': 0.99421453, 'binary_f1_score': 0.28440365}
confusion matrix:
       0    1
0  18044  105
1    519  124
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89085543, 'precision': 0.7922604, 'recall': 0.5468903, 'specificity': 0.5468903, 'f1': 0.5578369, 'auroc': 0.8000808, 'binary_precision': 0.6902655, 'binary_recall': 0.099616855, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.17410715}
confusion matrix:
      0   1
0  5962  35
1   705  78
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504643_22.png
early stop counter: 18
val acc:0.9667943716049194, best validation acc: 0.967432975769043, corresponding to test acc:                         0.904424786567688 / 0.9078171253204346
after epoch: 22,now: 2024-06-19 03:48:13.102860,epoch time: 0:16:58.519733,used: 7:46:19.368678,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504643
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99312633, 'precision': 0.9871421, 'recall': 0.97234523, 'specificity': 0.97234523, 'f1': 0.97959995, 'auroc': 0.9975898, 'binary_precision': 0.9798217, 'binary_recall': 0.9467241, 'binary_specificity': 0.99796635, 'binary_f1_score': 0.96298856}
confusion matrix:
       0     1
0  42203    86
1    235  4176
---- Validation: 
scalar performance:
{'acc': 0.96663475, 'precision': 0.75278676, 'recall': 0.5964478, 'specificity': 0.5964478, 'f1': 0.63641834, 'auroc': 0.8371134, 'binary_precision': 0.53333336, 'binary_recall': 0.19906688, 'binary_specificity': 0.99382883, 'binary_f1_score': 0.28992075}
confusion matrix:
       0    1
0  18037  112
1    515  128
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8920354, 'precision': 0.8065205, 'recall': 0.5508885, 'specificity': 0.5508885, 'f1': 0.5644234, 'auroc': 0.8045704, 'binary_precision': 0.71794873, 'binary_recall': 0.107279696, 'binary_specificity': 0.99449724, 'binary_f1_score': 0.18666667}
confusion matrix:
      0   1
0  5964  33
1   699  84
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504643_23.png
early stop counter: 19
val acc:0.9666347503662109, best validation acc: 0.967432975769043, corresponding to test acc:                         0.904424786567688 / 0.9078171253204346
after epoch: 23,now: 2024-06-19 04:05:23.030897,epoch time: 0:17:09.928037,used: 8:03:29.296715,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504643
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99233407, 'precision': 0.98632264, 'recall': 0.9684764, 'specificity': 0.9684764, 'f1': 0.97718954, 'auroc': 0.99760747, 'binary_precision': 0.9789797, 'binary_recall': 0.9390575, 'binary_specificity': 0.9978953, 'binary_f1_score': 0.95860314}
confusion matrix:
       0     1
0  42197    89
1    269  4145
---- Validation: 
scalar performance:
{'acc': 0.96663475, 'precision': 0.75148904, 'recall': 0.6061986, 'specificity': 0.6061986, 'f1': 0.64656746, 'auroc': 0.84037983, 'binary_precision': 0.5300752, 'binary_recall': 0.21928461, 'binary_specificity': 0.99311256, 'binary_f1_score': 0.31023106}
confusion matrix:
       0    1
0  18024  125
1    502  141
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88893807, 'precision': 0.76245916, 'recall': 0.5424753, 'specificity': 0.5424753, 'f1': 0.5505353, 'auroc': 0.8078327, 'binary_precision': 0.6315789, 'binary_recall': 0.09195402, 'binary_specificity': 0.9929965, 'binary_f1_score': 0.16053513}
confusion matrix:
      0   1
0  5955  42
1   711  72
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504643_24.png
early stop counter: 20
val acc:0.9666347503662109, best validation acc: 0.967432975769043, corresponding to test acc:                         0.904424786567688 / 0.9078171253204346
after epoch: 24,now: 2024-06-19 04:21:37.097400,epoch time: 0:16:14.066503,used: 8:19:43.363218,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504643
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 24 with time: 8:19:43.363218 at 2024-06-19 04:21:37.097400
persisted model performance metric: 

scalar performance:
{'acc': 0.9044248, 'precision': 0.887132, 'recall': 0.5995316, 'specificity': 0.5995316, 'f1': 0.6388697, 'auroc': 0.77196056, 'binary_precision': 0.86885244, 'binary_recall': 0.20306513, 'binary_specificity': 0.995998, 'binary_f1_score': 0.32919255}
confusion matrix:
      0    1
0  5973   24
1   624  159
oracle model performance metric: 

scalar performance:
{'acc': 0.9078171, 'precision': 0.88911796, 'recall': 0.61643946, 'specificity': 0.61643946, 'f1': 0.66168505, 'auroc': 0.79859984, 'binary_precision': 0.86915886, 'binary_recall': 0.23754789, 'binary_specificity': 0.995331, 'binary_f1_score': 0.37311935}
confusion matrix:
      0    1
0  5969   28
1   597  186
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4_classbalancing/rule_results/2.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4_classbalancing/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4_classbalancing/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204211 KiB |   1436 MiB | 334927 GiB | 334927 GiB |
|       from large pool | 167936 KiB |   1366 MiB | 334825 GiB | 334825 GiB |
|       from small pool |  36275 KiB |     72 MiB |    102 GiB |    102 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 204211 KiB |   1436 MiB | 334927 GiB | 334927 GiB |
|       from large pool | 167936 KiB |   1366 MiB | 334825 GiB | 334825 GiB |
|       from small pool |  36275 KiB |     72 MiB |    102 GiB |    102 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201112 KiB |   1428 MiB | 334908 GiB | 334908 GiB |
|       from large pool | 165120 KiB |   1358 MiB | 334808 GiB | 334808 GiB |
|       from small pool |  35992 KiB |     71 MiB |    100 GiB |    100 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1524 MiB |   1524 MiB |   1524 MiB |      0 B   |
|       from large pool |   1450 MiB |   1450 MiB |   1450 MiB |      0 B   |
|       from small pool |     74 MiB |     74 MiB |     74 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 320076 KiB | 628877 KiB | 240697 GiB | 240697 GiB |
|       from large pool | 311296 KiB | 627520 KiB | 240579 GiB | 240579 GiB |
|       from small pool |   8780 KiB |  12547 KiB |    118 GiB |    118 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1308    |    1965    |   11673 K  |   11671 K  |
|       from large pool |      36    |      76    |    3921 K  |    3921 K  |
|       from small pool |    1272    |    1894    |    7751 K  |    7750 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1308    |    1965    |   11673 K  |   11671 K  |
|       from large pool |      36    |      76    |    3921 K  |    3921 K  |
|       from small pool |    1272    |    1894    |    7751 K  |    7750 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      50    |      50    |      50    |       0    |
|       from large pool |      13    |      13    |      13    |       0    |
|       from small pool |      37    |      37    |      37    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      33    |     479    |    6197 K  |    6197 K  |
|       from large pool |       5    |      10    |    1642 K  |    1642 K  |
|       from small pool |      28    |     474    |    4555 K  |    4555 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1436 MiB | 334927 GiB | 334927 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 334825 GiB | 334825 GiB |
|       from small pool |      0 KiB |     72 MiB |    102 GiB |    102 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1436 MiB | 334927 GiB | 334927 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 334825 GiB | 334825 GiB |
|       from small pool |      0 KiB |     72 MiB |    102 GiB |    102 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1428 MiB | 334908 GiB | 334908 GiB |
|       from large pool |  16640 KiB |   1358 MiB | 334808 GiB | 334808 GiB |
|       from small pool |      0 KiB |     71 MiB |    100 GiB |    100 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 524288 KiB |   1524 MiB |   1524 MiB |   1012 MiB |
|       from large pool | 479232 KiB |   1450 MiB |   1450 MiB |    982 MiB |
|       from small pool |  45056 KiB |     74 MiB |     74 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 298752 KiB | 628877 KiB | 240698 GiB | 240697 GiB |
|       from large pool | 298752 KiB | 627520 KiB | 240579 GiB | 240579 GiB |
|       from small pool |      0 KiB |  16375 KiB |    118 GiB |    118 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1965    |   11673 K  |   11673 K  |
|       from large pool |       2    |      76    |    3921 K  |    3921 K  |
|       from small pool |       0    |    1894    |    7751 K  |    7751 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1965    |   11673 K  |   11673 K  |
|       from large pool |       2    |      76    |    3921 K  |    3921 K  |
|       from small pool |       0    |    1894    |    7751 K  |    7751 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      50    |      50    |      19    |
|       from large pool |       9    |      13    |      13    |       4    |
|       from small pool |      22    |      37    |      37    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     479    |    6198 K  |    6198 K  |
|       from large pool |       1    |      11    |    1642 K  |    1642 K  |
|       from small pool |       0    |     474    |    4555 K  |    4555 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1436 MiB | 334927 GiB | 334927 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 334825 GiB | 334825 GiB |
|       from small pool |      0 KiB |     72 MiB |    102 GiB |    102 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1436 MiB | 334927 GiB | 334927 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 334825 GiB | 334825 GiB |
|       from small pool |      0 KiB |     72 MiB |    102 GiB |    102 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1428 MiB | 334908 GiB | 334908 GiB |
|       from large pool |  16640 KiB |   1358 MiB | 334808 GiB | 334808 GiB |
|       from small pool |      0 KiB |     71 MiB |    100 GiB |    100 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 524288 KiB |   1524 MiB |   1524 MiB |   1012 MiB |
|       from large pool | 479232 KiB |   1450 MiB |   1450 MiB |    982 MiB |
|       from small pool |  45056 KiB |     74 MiB |     74 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 298752 KiB | 628877 KiB | 240698 GiB | 240697 GiB |
|       from large pool | 298752 KiB | 627520 KiB | 240579 GiB | 240579 GiB |
|       from small pool |      0 KiB |  16375 KiB |    118 GiB |    118 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1965    |   11673 K  |   11673 K  |
|       from large pool |       2    |      76    |    3921 K  |    3921 K  |
|       from small pool |       0    |    1894    |    7751 K  |    7751 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1965    |   11673 K  |   11673 K  |
|       from large pool |       2    |      76    |    3921 K  |    3921 K  |
|       from small pool |       0    |    1894    |    7751 K  |    7751 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      50    |      50    |      19    |
|       from large pool |       9    |      13    |      13    |       4    |
|       from small pool |      22    |      37    |      37    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     479    |    6198 K  |    6198 K  |
|       from large pool |       1    |      11    |    1642 K  |    1642 K  |
|       from small pool |       0    |     474    |    4555 K  |    4555 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0




!!!: not committed yet



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_04_30_53_seed_1_21504643

 Experiment start at: 2024-06-19 04:30:53.941055
before training, model accuracy: 0.20428188145160675
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9485867, 'precision': 0.9407429, 'recall': 0.73792225, 'specificity': 0.73792225, 'f1': 0.80275565, 'auroc': 0.9448, 'binary_precision': 0.9320738, 'binary_recall': 0.47940767, 'binary_specificity': 0.99643683, 'binary_f1_score': 0.6331551}
confusion matrix:
       0     1
0  42227   151
1   2250  2072
---- Validation: 
scalar performance:
{'acc': 0.96392745, 'precision': 0.6487819, 'recall': 0.50206274, 'specificity': 0.50206274, 'f1': 0.49521354, 'auroc': 0.54740745, 'binary_precision': 0.33333334, 'binary_recall': 0.004457652, 'binary_specificity': 0.9996679, 'binary_f1_score': 0.008797654}
confusion matrix:
       0  1
0  18061  6
1    670  3
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88403213, 'precision': 0.44201607, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4692235, 'auroc': 0.55936694, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   780  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504643_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-19 04:50:14.289412,epoch time: 0:19:20.348357,used: 0:19:20.348357,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_04_30_53_seed_1_21504643
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9720129, 'precision': 0.9798973, 'recall': 0.8524312, 'specificity': 0.8524312, 'f1': 0.90422046, 'auroc': 0.97446406, 'binary_precision': 0.9889825, 'binary_recall': 0.70566475, 'binary_specificity': 0.99919766, 'binary_f1_score': 0.8236405}
confusion matrix:
       0     1
0  42341    34
1   1273  3052
---- Validation: 
scalar performance:
{'acc': 0.96515477, 'precision': 0.81923866, 'recall': 0.5284489, 'specificity': 0.5284489, 'f1': 0.544467, 'auroc': 0.6596029, 'binary_precision': 0.67241377, 'binary_recall': 0.05794948, 'binary_specificity': 0.99894834, 'binary_f1_score': 0.10670314}
confusion matrix:
       0   1
0  18048  19
1    634  39
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8849242, 'precision': 0.77608824, 'recall': 0.5071878, 'specificity': 0.5071878, 'f1': 0.48445436, 'auroc': 0.69561565, 'binary_precision': 0.6666667, 'binary_recall': 0.015384615, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.030075189}
confusion matrix:
      0   1
0  5940   6
1   768  12
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504643_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-19 05:09:04.392681,epoch time: 0:18:50.103269,used: 0:38:10.451626,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_04_30_53_seed_1_21504643
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9781799, 'precision': 0.98346007, 'recall': 0.8858298, 'specificity': 0.8858298, 'f1': 0.92789453, 'auroc': 0.9848089, 'binary_precision': 0.9896327, 'binary_recall': 0.77248555, 'binary_specificity': 0.99917406, 'binary_f1_score': 0.8676795}
confusion matrix:
       0     1
0  42340    35
1    984  3341
---- Validation: 
scalar performance:
{'acc': 0.96616864, 'precision': 0.8109225, 'recall': 0.5604465, 'specificity': 0.5604465, 'f1': 0.5951077, 'auroc': 0.71539795, 'binary_precision': 0.6535433, 'binary_recall': 0.12332838, 'binary_specificity': 0.9975646, 'binary_f1_score': 0.2075}
confusion matrix:
       0   1
0  18023  44
1    590  83
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8950342, 'precision': 0.90757585, 'recall': 0.55133444, 'specificity': 0.55133444, 'f1': 0.5652665, 'auroc': 0.75606936, 'binary_precision': 0.92045456, 'binary_recall': 0.103846155, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.18663596}
confusion matrix:
      0   1
0  5939   7
1   699  81
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504643_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-19 05:26:24.717482,epoch time: 0:17:20.324801,used: 0:55:30.776427,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_04_30_53_seed_1_21504643
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98087794, 'precision': 0.9837886, 'recall': 0.901389, 'specificity': 0.901389, 'f1': 0.93785155, 'auroc': 0.98819304, 'binary_precision': 0.98721594, 'binary_recall': 0.8038399, 'binary_specificity': 0.9989381, 'binary_f1_score': 0.8861405}
confusion matrix:
       0     1
0  42332    45
1    848  3475
---- Validation: 
scalar performance:
{'acc': 0.9663821, 'precision': 0.8066294, 'recall': 0.5698557, 'specificity': 0.5698557, 'f1': 0.60819536, 'auroc': 0.73999673, 'binary_precision': 0.6442953, 'binary_recall': 0.14264487, 'binary_specificity': 0.9970665, 'binary_f1_score': 0.23357663}
confusion matrix:
       0   1
0  18014  53
1    577  96
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8996432, 'precision': 0.91298306, 'recall': 0.5723201, 'specificity': 0.5723201, 'f1': 0.5993513, 'auroc': 0.7612008, 'binary_precision': 0.9268293, 'binary_recall': 0.14615385, 'binary_specificity': 0.9984864, 'binary_f1_score': 0.2524917}
confusion matrix:
      0    1
0  5937    9
1   666  114
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504643_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-19 05:44:37.261670,epoch time: 0:18:12.544188,used: 1:13:43.320615,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_04_30_53_seed_1_21504643
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98473233, 'precision': 0.9800733, 'recall': 0.9276251, 'specificity': 0.9276251, 'f1': 0.9519639, 'auroc': 0.9897846, 'binary_precision': 0.9745072, 'binary_recall': 0.8575393, 'binary_specificity': 0.99771094, 'binary_f1_score': 0.9122893}
confusion matrix:
       0     1
0  42279    97
1    616  3708
---- Validation: 
scalar performance:
{'acc': 0.9667022, 'precision': 0.79340416, 'recall': 0.5943408, 'specificity': 0.5943408, 'f1': 0.6385333, 'auroc': 0.77209187, 'binary_precision': 0.6161137, 'binary_recall': 0.19316493, 'binary_specificity': 0.9955167, 'binary_f1_score': 0.29411763}
confusion matrix:
       0    1
0  17986   81
1    543  130
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90886116, 'precision': 0.90811336, 'recall': 0.61763304, 'specificity': 0.61763304, 'f1': 0.6642476, 'auroc': 0.7988939, 'binary_precision': 0.9073171, 'binary_recall': 0.23846154, 'binary_specificity': 0.9968046, 'binary_f1_score': 0.37766495}
confusion matrix:
      0    1
0  5927   19
1   594  186
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504643_5.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-06-19 06:03:08.690719,epoch time: 0:18:31.429049,used: 1:32:14.749664,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_04_30_53_seed_1_21504643
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98520344, 'precision': 0.9765256, 'recall': 0.93377346, 'specificity': 0.93377346, 'f1': 0.953897, 'auroc': 0.99179494, 'binary_precision': 0.9661104, 'binary_recall': 0.87066174, 'binary_specificity': 0.9968852, 'binary_f1_score': 0.915906}
confusion matrix:
       0     1
0  42246   132
1    559  3763
---- Validation: 
scalar performance:
{'acc': 0.966222, 'precision': 0.775722, 'recall': 0.6048207, 'specificity': 0.6048207, 'f1': 0.6484387, 'auroc': 0.78349006, 'binary_precision': 0.58, 'binary_recall': 0.2154532, 'binary_specificity': 0.9941883, 'binary_f1_score': 0.31419286}
confusion matrix:
       0    1
0  17962  105
1    528  145
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91109127, 'precision': 0.90200305, 'recall': 0.6305901, 'specificity': 0.6305901, 'f1': 0.6805101, 'auroc': 0.8036709, 'binary_precision': 0.89224136, 'binary_recall': 0.2653846, 'binary_specificity': 0.9957955, 'binary_f1_score': 0.4090909}
confusion matrix:
      0    1
0  5921   25
1   573  207
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504643_6.png
new oracle model saved
early stop counter: 1
val acc:0.9662219882011414, best validation acc: 0.9667022228240967, corresponding to test acc:                         0.9088611602783203 / 0.9110912680625916
after epoch: 6,now: 2024-06-19 06:21:24.940558,epoch time: 0:18:16.249839,used: 1:50:30.999503,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_04_30_53_seed_1_21504643
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98732334, 'precision': 0.9828576, 'recall': 0.94070923, 'specificity': 0.94070923, 'f1': 0.9605845, 'auroc': 0.99288905, 'binary_precision': 0.9774936, 'binary_recall': 0.88349515, 'binary_specificity': 0.99792325, 'binary_f1_score': 0.92812043}
confusion matrix:
       0     1
0  42286    88
1    504  3822
---- Validation: 
scalar performance:
{'acc': 0.96659553, 'precision': 0.78685915, 'recall': 0.6000076, 'specificity': 0.6000076, 'f1': 0.6444363, 'auroc': 0.7966653, 'binary_precision': 0.60262007, 'binary_recall': 0.205052, 'binary_specificity': 0.99496317, 'binary_f1_score': 0.3059867}
confusion matrix:
       0    1
0  17976   91
1    535  138
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90945584, 'precision': 0.8904922, 'recall': 0.62632346, 'specificity': 0.62632346, 'f1': 0.6743375, 'auroc': 0.81457365, 'binary_precision': 0.8701299, 'binary_recall': 0.2576923, 'binary_specificity': 0.9949546, 'binary_f1_score': 0.39762613}
confusion matrix:
      0    1
0  5916   30
1   579  201
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504643_7.png
early stop counter: 2
val acc:0.9665955305099487, best validation acc: 0.9667022228240967, corresponding to test acc:                         0.9088611602783203 / 0.9110912680625916
after epoch: 7,now: 2024-06-19 06:38:58.784690,epoch time: 0:17:33.844132,used: 2:08:04.843635,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_04_30_53_seed_1_21504643
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9868737, 'precision': 0.9813217, 'recall': 0.939355, 'specificity': 0.939355, 'f1': 0.959146, 'auroc': 0.99228907, 'binary_precision': 0.9746544, 'binary_recall': 0.88104606, 'binary_specificity': 0.9976639, 'binary_f1_score': 0.92548925}
confusion matrix:
       0     1
0  42280    99
1    514  3807
---- Validation: 
scalar performance:
{'acc': 0.966809, 'precision': 0.7922189, 'recall': 0.6001183, 'specificity': 0.6001183, 'f1': 0.6451734, 'auroc': 0.79147327, 'binary_precision': 0.61333334, 'binary_recall': 0.205052, 'binary_specificity': 0.9951846, 'binary_f1_score': 0.30734965}
confusion matrix:
       0    1
0  17980   87
1    535  138
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9103479, 'precision': 0.902135, 'recall': 0.626828, 'specificity': 0.626828, 'f1': 0.6757773, 'auroc': 0.8094162, 'binary_precision': 0.8933333, 'binary_recall': 0.2576923, 'binary_specificity': 0.9959637, 'binary_f1_score': 0.39999998}
confusion matrix:
      0    1
0  5922   24
1   579  201
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504643_8.png
better model found
persisted
after epoch: 8,now: 2024-06-19 06:56:30.297315,epoch time: 0:17:31.512625,used: 2:25:36.356260,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_04_30_53_seed_1_21504643
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98892933, 'precision': 0.98612034, 'recall': 0.94724214, 'specificity': 0.94724214, 'f1': 0.96567214, 'auroc': 0.99346495, 'binary_precision': 0.9827411, 'binary_recall': 0.89608884, 'binary_specificity': 0.99839544, 'binary_f1_score': 0.93741673}
confusion matrix:
       0     1
0  42311    68
1    449  3872
---- Validation: 
scalar performance:
{'acc': 0.96691567, 'precision': 0.79763323, 'recall': 0.5965973, 'specificity': 0.5965973, 'f1': 0.6416415, 'auroc': 0.8018838, 'binary_precision': 0.62441313, 'binary_recall': 0.19762258, 'binary_specificity': 0.99557203, 'binary_f1_score': 0.3002257}
confusion matrix:
       0    1
0  17987   80
1    540  133
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90454954, 'precision': 0.8942331, 'recall': 0.60015714, 'specificity': 0.60015714, 'f1': 0.6399286, 'auroc': 0.8158505, 'binary_precision': 0.8833333, 'binary_recall': 0.20384616, 'binary_specificity': 0.9964682, 'binary_f1_score': 0.33125}
confusion matrix:
      0    1
0  5925   21
1   621  159
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504643_9.png
better model found
persisted
after epoch: 9,now: 2024-06-19 07:13:45.280964,epoch time: 0:17:14.983649,used: 2:42:51.339909,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_04_30_53_seed_1_21504643
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98961455, 'precision': 0.9854702, 'recall': 0.9520059, 'specificity': 0.9520059, 'f1': 0.96799266, 'auroc': 0.9937074, 'binary_precision': 0.9804707, 'binary_recall': 0.90585244, 'binary_specificity': 0.9981594, 'binary_f1_score': 0.9416857}
confusion matrix:
       0     1
0  42299    78
1    407  3916
---- Validation: 
scalar performance:
{'acc': 0.9669691, 'precision': 0.7933997, 'recall': 0.6044929, 'specificity': 0.6044929, 'f1': 0.6503026, 'auroc': 0.8107738, 'binary_precision': 0.61538464, 'binary_recall': 0.21396731, 'binary_specificity': 0.99501854, 'binary_f1_score': 0.3175303}
confusion matrix:
       0    1
0  17977   90
1    529  144
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9046982, 'precision': 0.8848828, 'recall': 0.60358286, 'specificity': 0.60358286, 'f1': 0.6442489, 'auroc': 0.81934834, 'binary_precision': 0.8638743, 'binary_recall': 0.21153846, 'binary_specificity': 0.9956273, 'binary_f1_score': 0.33985582}
confusion matrix:
      0    1
0  5920   26
1   615  165
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504643_10.png
better model found
persisted
after epoch: 10,now: 2024-06-19 07:30:50.193914,epoch time: 0:17:04.912950,used: 2:59:56.252859,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_04_30_53_seed_1_21504643
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9894861, 'precision': 0.9835563, 'recall': 0.95309865, 'specificity': 0.95309865, 'f1': 0.9677088, 'auroc': 0.9938966, 'binary_precision': 0.9763917, 'binary_recall': 0.9084393, 'binary_specificity': 0.9977581, 'binary_f1_score': 0.9411906}
confusion matrix:
       0     1
0  42280    95
1    396  3929
---- Validation: 
scalar performance:
{'acc': 0.9667556, 'precision': 0.79180694, 'recall': 0.59866005, 'specificity': 0.59866005, 'f1': 0.6434409, 'auroc': 0.81033754, 'binary_precision': 0.6126126, 'binary_recall': 0.20208023, 'binary_specificity': 0.9952399, 'binary_f1_score': 0.3039106}
confusion matrix:
       0    1
0  17981   86
1    537  136
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9039548, 'precision': 0.87903917, 'recall': 0.60149163, 'specificity': 0.60149163, 'f1': 0.641133, 'auroc': 0.8128963, 'binary_precision': 0.85263157, 'binary_recall': 0.20769231, 'binary_specificity': 0.99529094, 'binary_f1_score': 0.33402064}
confusion matrix:
      0    1
0  5918   28
1   618  162
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504643_11.png
early stop counter: 1
val acc:0.9667556285858154, best validation acc: 0.9669690728187561, corresponding to test acc:                         0.9046981930732727 / 0.9110912680625916
after epoch: 11,now: 2024-06-19 07:52:08.473768,epoch time: 0:21:18.279854,used: 3:21:14.532713,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_04_30_53_seed_1_21504643
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9896574, 'precision': 0.9863743, 'recall': 0.9514173, 'specificity': 0.9514173, 'f1': 0.96808314, 'auroc': 0.9949596, 'binary_precision': 0.98241645, 'binary_recall': 0.9044866, 'binary_specificity': 0.9983481, 'binary_f1_score': 0.94184226}
confusion matrix:
       0     1
0  42306    70
1    413  3911
---- Validation: 
scalar performance:
{'acc': 0.9667556, 'precision': 0.8059398, 'recall': 0.58220893, 'specificity': 0.58220893, 'f1': 0.62459403, 'auroc': 0.8075181, 'binary_precision': 0.64204544, 'binary_recall': 0.1679049, 'binary_specificity': 0.996513, 'binary_f1_score': 0.2661955}
confusion matrix:
       0    1
0  18004   63
1    560  113
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89488554, 'precision': 0.851598, 'recall': 0.5596044, 'specificity': 0.5596044, 'f1': 0.5786247, 'auroc': 0.80842936, 'binary_precision': 0.8067227, 'binary_recall': 0.12307692, 'binary_specificity': 0.99613184, 'binary_f1_score': 0.21357064}
confusion matrix:
      0   1
0  5923  23
1   684  96
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504643_12.png
early stop counter: 2
val acc:0.9667556285858154, best validation acc: 0.9669690728187561, corresponding to test acc:                         0.9046981930732727 / 0.9110912680625916
after epoch: 12,now: 2024-06-19 08:12:11.228795,epoch time: 0:20:02.755027,used: 3:41:17.287740,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_04_30_53_seed_1_21504643
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9905782, 'precision': 0.98567, 'recall': 0.9576165, 'specificity': 0.9576165, 'f1': 0.97112215, 'auroc': 0.99603915, 'binary_precision': 0.97973305, 'binary_recall': 0.91716796, 'binary_specificity': 0.99806505, 'binary_f1_score': 0.94741875}
confusion matrix:
       0     1
0  42296    82
1    358  3964
---- Validation: 
scalar performance:
{'acc': 0.9667022, 'precision': 0.7967528, 'recall': 0.5900492, 'specificity': 0.5900492, 'f1': 0.6336791, 'auroc': 0.82331955, 'binary_precision': 0.6231156, 'binary_recall': 0.18424962, 'binary_specificity': 0.9958488, 'binary_f1_score': 0.28440365}
confusion matrix:
       0    1
0  17992   75
1    549  124
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89518285, 'precision': 0.86699146, 'recall': 0.5581018, 'specificity': 0.5581018, 'f1': 0.57631403, 'auroc': 0.8148306, 'binary_precision': 0.8378378, 'binary_recall': 0.11923077, 'binary_specificity': 0.99697274, 'binary_f1_score': 0.20875423}
confusion matrix:
      0   1
0  5928  18
1   687  93
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504643_13.png
early stop counter: 3
val acc:0.9667022228240967, best validation acc: 0.9669690728187561, corresponding to test acc:                         0.9046981930732727 / 0.9110912680625916
after epoch: 13,now: 2024-06-19 08:29:46.319182,epoch time: 0:17:35.090387,used: 3:58:52.378127,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_04_30_53_seed_1_21504643
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9907923, 'precision': 0.9840046, 'recall': 0.960513, 'specificity': 0.960513, 'f1': 0.9718934, 'auroc': 0.9959795, 'binary_precision': 0.97577685, 'binary_recall': 0.9233619, 'binary_specificity': 0.99766403, 'binary_f1_score': 0.94884604}
confusion matrix:
       0     1
0  42282    99
1    331  3988
---- Validation: 
scalar performance:
{'acc': 0.9667556, 'precision': 0.7882253, 'recall': 0.6043822, 'specificity': 0.6043822, 'f1': 0.64954996, 'auroc': 0.8257786, 'binary_precision': 0.60504204, 'binary_recall': 0.21396731, 'binary_specificity': 0.99479717, 'binary_f1_score': 0.31613612}
confusion matrix:
       0    1
0  17973   94
1    529  144
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89681834, 'precision': 0.8508313, 'recall': 0.5707224, 'specificity': 0.5707224, 'f1': 0.5959507, 'auroc': 0.8179455, 'binary_precision': 0.8028169, 'binary_recall': 0.14615385, 'binary_specificity': 0.99529094, 'binary_f1_score': 0.2472885}
confusion matrix:
      0    1
0  5918   28
1   666  114
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504643_14.png
early stop counter: 4
val acc:0.9667556285858154, best validation acc: 0.9669690728187561, corresponding to test acc:                         0.9046981930732727 / 0.9110912680625916
after epoch: 14,now: 2024-06-19 08:49:47.322039,epoch time: 0:20:01.002857,used: 4:18:53.380984,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_04_30_53_seed_1_21504643
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9910707, 'precision': 0.98526067, 'recall': 0.9610308, 'specificity': 0.9610308, 'f1': 0.9727578, 'auroc': 0.9950707, 'binary_precision': 0.9782183, 'binary_recall': 0.92416185, 'binary_specificity': 0.9978997, 'binary_f1_score': 0.95042205}
confusion matrix:
       0     1
0  42286    89
1    328  3997
---- Validation: 
scalar performance:
{'acc': 0.96643543, 'precision': 0.78496915, 'recall': 0.5963482, 'specificity': 0.5963482, 'f1': 0.64000696, 'auroc': 0.82875276, 'binary_precision': 0.5990991, 'binary_recall': 0.19762258, 'binary_specificity': 0.9950739, 'binary_f1_score': 0.2972067}
confusion matrix:
       0    1
0  17978   89
1    540  133
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8938448, 'precision': 0.8233621, 'recall': 0.5606866, 'specificity': 0.5606866, 'f1': 0.5800837, 'auroc': 0.8174298, 'binary_precision': 0.75, 'binary_recall': 0.12692308, 'binary_specificity': 0.99445003, 'binary_f1_score': 0.21710527}
confusion matrix:
      0   1
0  5913  33
1   681  99
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504643_15.png
early stop counter: 5
val acc:0.966435432434082, best validation acc: 0.9669690728187561, corresponding to test acc:                         0.9046981930732727 / 0.9110912680625916
after epoch: 15,now: 2024-06-19 09:10:45.572574,epoch time: 0:20:58.250535,used: 4:39:51.631519,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_04_30_53_seed_1_21504643
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9908565, 'precision': 0.98249614, 'recall': 0.96243656, 'specificity': 0.96243656, 'f1': 0.97219974, 'auroc': 0.9960325, 'binary_precision': 0.9723435, 'binary_recall': 0.9275631, 'binary_specificity': 0.99731, 'binary_f1_score': 0.9494255}
confusion matrix:
       0     1
0  42265   114
1    313  4008
---- Validation: 
scalar performance:
{'acc': 0.96691567, 'precision': 0.7954831, 'recall': 0.5994584, 'specificity': 0.5994584, 'f1': 0.6447707, 'auroc': 0.83452785, 'binary_precision': 0.6199095, 'binary_recall': 0.20356612, 'binary_specificity': 0.99535066, 'binary_f1_score': 0.30648768}
confusion matrix:
       0    1
0  17983   84
1    536  137
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8945882, 'precision': 0.8320404, 'recall': 0.5627778, 'specificity': 0.5627778, 'f1': 0.5834478, 'auroc': 0.82781076, 'binary_precision': 0.7669173, 'binary_recall': 0.13076924, 'binary_specificity': 0.9947864, 'binary_f1_score': 0.22343922}
confusion matrix:
      0    1
0  5915   31
1   678  102
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504643_16.png
early stop counter: 6
val acc:0.9669156670570374, best validation acc: 0.9669690728187561, corresponding to test acc:                         0.9046981930732727 / 0.9110912680625916
after epoch: 16,now: 2024-06-19 09:43:13.485283,epoch time: 0:32:27.912709,used: 5:12:19.544228,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_04_30_53_seed_1_21504643
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9916274, 'precision': 0.9845792, 'recall': 0.9650435, 'specificity': 0.9650435, 'f1': 0.97455984, 'auroc': 0.99568474, 'binary_precision': 0.9760174, 'binary_recall': 0.93242306, 'binary_specificity': 0.9976639, 'binary_f1_score': 0.9537223}
confusion matrix:
       0     1
0  42280    99
1    292  4029
---- Validation: 
scalar performance:
{'acc': 0.966222, 'precision': 0.775722, 'recall': 0.6048207, 'specificity': 0.6048207, 'f1': 0.6484387, 'auroc': 0.8341347, 'binary_precision': 0.58, 'binary_recall': 0.2154532, 'binary_specificity': 0.9941883, 'binary_f1_score': 0.31419286}
confusion matrix:
       0    1
0  17962  105
1    528  145
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8957776, 'precision': 0.82240427, 'recall': 0.5734754, 'specificity': 0.5734754, 'f1': 0.5995086, 'auroc': 0.823275, 'binary_precision': 0.7453416, 'binary_recall': 0.15384616, 'binary_specificity': 0.99310464, 'binary_f1_score': 0.25504783}
confusion matrix:
      0    1
0  5905   41
1   660  120
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504643_17.png
early stop counter: 7
val acc:0.9662219882011414, best validation acc: 0.9669690728187561, corresponding to test acc:                         0.9046981930732727 / 0.9110912680625916
after epoch: 17,now: 2024-06-19 10:02:57.477701,epoch time: 0:19:43.992418,used: 5:32:03.536646,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_04_30_53_seed_1_21504643
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99152035, 'precision': 0.98586875, 'recall': 0.9631223, 'specificity': 0.9631223, 'f1': 0.9741546, 'auroc': 0.99646807, 'binary_precision': 0.97901416, 'binary_recall': 0.928274, 'binary_specificity': 0.99797064, 'binary_f1_score': 0.9529692}
confusion matrix:
       0     1
0  42292    86
1    310  4012
---- Validation: 
scalar performance:
{'acc': 0.9667022, 'precision': 0.7909043, 'recall': 0.59791714, 'specificity': 0.59791714, 'f1': 0.6424788, 'auroc': 0.8371601, 'binary_precision': 0.61085975, 'binary_recall': 0.20059435, 'binary_specificity': 0.9952399, 'binary_f1_score': 0.3020134}
confusion matrix:
       0    1
0  17981   86
1    538  135
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89295274, 'precision': 0.8170022, 'recall': 0.5568404, 'specificity': 0.5568404, 'f1': 0.5739546, 'auroc': 0.82491964, 'binary_precision': 0.7380952, 'binary_recall': 0.11923077, 'binary_specificity': 0.99445003, 'binary_f1_score': 0.20529802}
confusion matrix:
      0   1
0  5913  33
1   687  93
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504643_18.png
early stop counter: 8
val acc:0.9667022228240967, best validation acc: 0.9669690728187561, corresponding to test acc:                         0.9046981930732727 / 0.9110912680625916
after epoch: 18,now: 2024-06-19 10:22:53.351529,epoch time: 0:19:55.873828,used: 5:51:59.410474,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_04_30_53_seed_1_21504643
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99201286, 'precision': 0.98693323, 'recall': 0.96506375, 'specificity': 0.96506375, 'f1': 0.9756843, 'auroc': 0.9964138, 'binary_precision': 0.9807692, 'binary_recall': 0.9319917, 'binary_specificity': 0.9981358, 'binary_f1_score': 0.95575845}
confusion matrix:
       0     1
0  42298    79
1    294  4029
---- Validation: 
scalar performance:
{'acc': 0.9669691, 'precision': 0.80150235, 'recall': 0.5937639, 'specificity': 0.5937639, 'f1': 0.63863677, 'auroc': 0.83496594, 'binary_precision': 0.63235295, 'binary_recall': 0.19167905, 'binary_specificity': 0.9958488, 'binary_f1_score': 0.2941847}
confusion matrix:
       0    1
0  17992   75
1    544  129
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.892804, 'precision': 0.83272934, 'recall': 0.5517439, 'specificity': 0.5517439, 'f1': 0.5657928, 'auroc': 0.82073116, 'binary_precision': 0.7706422, 'binary_recall': 0.10769231, 'binary_specificity': 0.9957955, 'binary_f1_score': 0.18897638}
confusion matrix:
      0   1
0  5921  25
1   696  84
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504643_19.png
early stop counter: 9
val acc:0.9669690728187561, best validation acc: 0.9669690728187561, corresponding to test acc:                         0.9046981930732727 / 0.9110912680625916
after epoch: 19,now: 2024-06-19 10:41:36.065112,epoch time: 0:18:42.713583,used: 6:10:42.124057,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_04_30_53_seed_1_21504643
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99186295, 'precision': 0.9848429, 'recall': 0.9662124, 'specificity': 0.9662124, 'f1': 0.97529924, 'auroc': 0.99662316, 'binary_precision': 0.9763113, 'binary_recall': 0.9347373, 'binary_specificity': 0.9976875, 'binary_f1_score': 0.9550721}
confusion matrix:
       0     1
0  42281    98
1    282  4039
---- Validation: 
scalar performance:
{'acc': 0.966809, 'precision': 0.7927017, 'recall': 0.599403, 'specificity': 0.599403, 'f1': 0.6444008, 'auroc': 0.83794224, 'binary_precision': 0.6143498, 'binary_recall': 0.20356612, 'binary_specificity': 0.9952399, 'binary_f1_score': 0.30580357}
confusion matrix:
       0    1
0  17981   86
1    536  137
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8945882, 'precision': 0.8449153, 'recall': 0.5594362, 'specificity': 0.5594362, 'f1': 0.5783035, 'auroc': 0.82152724, 'binary_precision': 0.7933884, 'binary_recall': 0.12307692, 'binary_specificity': 0.9957955, 'binary_f1_score': 0.21309656}
confusion matrix:
      0   1
0  5921  25
1   684  96
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504643_20.png
early stop counter: 10
val acc:0.9668089747428894, best validation acc: 0.9669690728187561, corresponding to test acc:                         0.9046981930732727 / 0.9110912680625916
after epoch: 20,now: 2024-06-19 11:00:14.050473,epoch time: 0:18:37.985361,used: 6:29:20.109418,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_04_30_53_seed_1_21504643
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9927623, 'precision': 0.9882583, 'recall': 0.9682667, 'specificity': 0.9682667, 'f1': 0.97800124, 'auroc': 0.99685234, 'binary_precision': 0.9827879, 'binary_recall': 0.93820876, 'binary_specificity': 0.99832463, 'binary_f1_score': 0.9599811}
confusion matrix:
       0     1
0  42308    71
1    267  4054
---- Validation: 
scalar performance:
{'acc': 0.9663287, 'precision': 0.78392744, 'recall': 0.59343183, 'specificity': 0.59343183, 'f1': 0.6364845, 'auroc': 0.84491324, 'binary_precision': 0.5972222, 'binary_recall': 0.19167905, 'binary_specificity': 0.9951846, 'binary_f1_score': 0.2902137}
confusion matrix:
       0    1
0  17980   87
1    544  129
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8935474, 'precision': 0.8128129, 'recall': 0.56218916, 'specificity': 0.56218916, 'f1': 0.5823027, 'auroc': 0.83060753, 'binary_precision': 0.7285714, 'binary_recall': 0.13076924, 'binary_specificity': 0.99360913, 'binary_f1_score': 0.22173914}
confusion matrix:
      0    1
0  5908   38
1   678  102
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504643_21.png
early stop counter: 11
val acc:0.9663286805152893, best validation acc: 0.9669690728187561, corresponding to test acc:                         0.9046981930732727 / 0.9110912680625916
after epoch: 21,now: 2024-06-19 11:27:20.925295,epoch time: 0:27:06.874822,used: 6:56:26.984240,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_04_30_53_seed_1_21504643
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9925054, 'precision': 0.98767734, 'recall': 0.9673158, 'specificity': 0.9673158, 'f1': 0.97722507, 'auroc': 0.99719715, 'binary_precision': 0.9818138, 'binary_recall': 0.9364015, 'binary_specificity': 0.99823016, 'binary_f1_score': 0.9585701}
confusion matrix:
       0     1
0  42301    75
1    275  4049
---- Validation: 
scalar performance:
{'acc': 0.9672892, 'precision': 0.80320317, 'recall': 0.6025132, 'specificity': 0.6025132, 'f1': 0.64916414, 'auroc': 0.8386683, 'binary_precision': 0.6351351, 'binary_recall': 0.20950966, 'binary_specificity': 0.9955167, 'binary_f1_score': 0.31508377}
confusion matrix:
       0    1
0  17986   81
1    532  141
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.891912, 'precision': 0.8334225, 'recall': 0.5462269, 'specificity': 0.5462269, 'f1': 0.55661225, 'auroc': 0.81771195, 'binary_precision': 0.77319586, 'binary_recall': 0.09615385, 'binary_specificity': 0.99630004, 'binary_f1_score': 0.17103763}
confusion matrix:
      0   1
0  5924  22
1   705  75
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504643_22.png
better model found
persisted
after epoch: 22,now: 2024-06-19 12:00:04.424676,epoch time: 0:32:43.499381,used: 7:29:10.483621,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_04_30_53_seed_1_21504643
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9926552, 'precision': 0.98850095, 'recall': 0.9673543, 'specificity': 0.9673543, 'f1': 0.97763526, 'auroc': 0.9969115, 'binary_precision': 0.983459, 'binary_recall': 0.9363131, 'binary_specificity': 0.99839556, 'binary_f1_score': 0.95930713}
confusion matrix:
       0     1
0  42314    68
1    275  4043
---- Validation: 
scalar performance:
{'acc': 0.966809, 'precision': 0.80255544, 'recall': 0.5872435, 'specificity': 0.5872435, 'f1': 0.63071805, 'auroc': 0.83290267, 'binary_precision': 0.63492066, 'binary_recall': 0.17830609, 'binary_specificity': 0.9961809, 'binary_f1_score': 0.27842227}
confusion matrix:
       0    1
0  17998   69
1    553  120
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88760036, 'precision': 0.77832884, 'recall': 0.5287511, 'specificity': 0.5287511, 'f1': 0.52633804, 'auroc': 0.8004135, 'binary_precision': 0.6666667, 'binary_recall': 0.06153846, 'binary_specificity': 0.9959637, 'binary_f1_score': 0.112676054}
confusion matrix:
      0   1
0  5922  24
1   732  48
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504643_23.png
early stop counter: 1
val acc:0.9668089747428894, best validation acc: 0.9672892093658447, corresponding to test acc:                         0.8919119834899902 / 0.9110912680625916
after epoch: 23,now: 2024-06-19 12:21:32.979312,epoch time: 0:21:28.554636,used: 7:50:39.038257,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_04_30_53_seed_1_21504643
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9922484, 'precision': 0.9876144, 'recall': 0.9658167, 'specificity': 0.9658167, 'f1': 0.97640395, 'auroc': 0.9972681, 'binary_precision': 0.98199075, 'binary_recall': 0.9333796, 'binary_specificity': 0.99825376, 'binary_f1_score': 0.9570683}
confusion matrix:
       0     1
0  42303    74
1    288  4035
---- Validation: 
scalar performance:
{'acc': 0.96611524, 'precision': 0.7849326, 'recall': 0.5825921, 'specificity': 0.5825921, 'f1': 0.6234265, 'auroc': 0.84324217, 'binary_precision': 0.6, 'binary_recall': 0.16939078, 'binary_specificity': 0.99579346, 'binary_f1_score': 0.26419467}
confusion matrix:
       0    1
0  17991   76
1    559  114
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8907226, 'precision': 0.8173721, 'recall': 0.5422126, 'specificity': 0.5422126, 'f1': 0.54982245, 'auroc': 0.8242566, 'binary_precision': 0.7419355, 'binary_recall': 0.08846154, 'binary_specificity': 0.9959637, 'binary_f1_score': 0.1580756}
confusion matrix:
      0   1
0  5922  24
1   711  69
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504643_24.png
