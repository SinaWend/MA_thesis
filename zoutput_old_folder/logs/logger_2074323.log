Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0




!!!: not committed yet



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327286

 Experiment start at: 2024-06-15 22:21:01.169282
before training, model accuracy: 0.3103227913379669
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9663927, 'precision': 0.48319635, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49145457, 'auroc': 0.47445422, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42328  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.39191306, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.41522932, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327286_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-15 22:38:18.829101,epoch time: 0:17:17.659819,used: 0:17:17.659819,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327286
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9663927, 'precision': 0.48319635, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49145457, 'auroc': 0.48641765, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42328  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.4137896, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.4212312, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327286_2.png
early stop counter: 1
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 2,now: 2024-06-15 22:54:43.407063,epoch time: 0:16:24.577962,used: 0:33:42.237781,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327286
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9663927, 'precision': 0.48319635, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49145457, 'auroc': 0.5169594, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42328  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.45035926, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.45695597, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327286_3.png
early stop counter: 2
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 3,now: 2024-06-15 23:10:54.848013,epoch time: 0:16:11.440950,used: 0:49:53.678731,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327286
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9663927, 'precision': 0.48319635, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49145457, 'auroc': 0.54208505, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42328  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.46893567, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.50205433, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327286_4.png
early stop counter: 3
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 4,now: 2024-06-15 23:27:12.721238,epoch time: 0:16:17.873225,used: 1:06:11.551956,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327286
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9663927, 'precision': 0.48319635, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49145457, 'auroc': 0.5919421, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42328  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.5224482, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.54588854, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327286_5.png
early stop counter: 4
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 5,now: 2024-06-15 23:43:42.156967,epoch time: 0:16:29.435729,used: 1:22:40.987685,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327286
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9663927, 'precision': 0.48319635, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49145457, 'auroc': 0.6474546, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42328  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.57934606, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.5813801, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327286_6.png
early stop counter: 5
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 6,now: 2024-06-16 00:00:56.844766,epoch time: 0:17:14.687799,used: 1:39:55.675484,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327286
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9663927, 'precision': 0.48319635, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49145457, 'auroc': 0.694559, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42328  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.6278126, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.653392, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327286_7.png
early stop counter: 6
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 7,now: 2024-06-16 00:18:16.235296,epoch time: 0:17:19.390530,used: 1:57:15.066014,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327286
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9663927, 'precision': 0.48319635, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49145457, 'auroc': 0.71565866, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42328  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.6647552, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.68190926, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327286_8.png
early stop counter: 7
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 8,now: 2024-06-16 00:35:49.787999,epoch time: 0:17:33.552703,used: 2:14:48.618717,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327286
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9663927, 'precision': 0.48319635, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49145457, 'auroc': 0.75512385, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42328  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.7211381, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.73094225, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327286_9.png
early stop counter: 8
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 9,now: 2024-06-16 00:53:10.824552,epoch time: 0:17:21.036553,used: 2:32:09.655270,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327286
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9663927, 'precision': 0.48319635, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49145457, 'auroc': 0.78789425, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42328  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.76479924, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.77472997, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327286_10.png
early stop counter: 9
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 10,now: 2024-06-16 01:10:36.617891,epoch time: 0:17:25.793339,used: 2:49:35.448609,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327286
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96636987, 'precision': 0.48319596, 'recall': 0.4999882, 'specificity': 0.4999882, 'f1': 0.49144867, 'auroc': 0.80500114, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42327  1
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.79185027, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.8026844, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327286_11.png
early stop counter: 10
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 11,now: 2024-06-16 01:27:42.547403,epoch time: 0:17:05.929512,used: 3:06:41.378121,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327286
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9664155, 'precision': 0.98320735, 'recall': 0.5003397, 'specificity': 0.5003397, 'f1': 0.4921392, 'auroc': 0.8264905, 'binary_precision': 1.0, 'binary_recall': 0.00067934784, 'binary_specificity': 1.0, 'binary_f1_score': 0.0013577732}
confusion matrix:
       0  1
0  42328  0
1   1471  1
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.8053862, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.80581737, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327286_12.png
early stop counter: 11
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 12,now: 2024-06-16 01:44:33.078683,epoch time: 0:16:50.531280,used: 3:23:31.909401,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327286
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9664155, 'precision': 0.98320735, 'recall': 0.5003397, 'specificity': 0.5003397, 'f1': 0.4921392, 'auroc': 0.8409718, 'binary_precision': 1.0, 'binary_recall': 0.00067934784, 'binary_specificity': 1.0, 'binary_f1_score': 0.0013577732}
confusion matrix:
       0  1
0  42328  0
1   1471  1
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.8260266, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.82549, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327286_13.png
early stop counter: 12
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 13,now: 2024-06-16 02:01:42.081651,epoch time: 0:17:09.002968,used: 3:40:40.912369,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327286
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9664155, 'precision': 0.73321843, 'recall': 0.5003281, 'specificity': 0.5003281, 'f1': 0.49213916, 'auroc': 0.8554369, 'binary_precision': 0.5, 'binary_recall': 0.00067980966, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.0013577733}
confusion matrix:
       0  1
0  42328  1
1   1470  1
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.83896077, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.8358145, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327286_14.png
early stop counter: 13
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 14,now: 2024-06-16 02:19:32.014212,epoch time: 0:17:49.932561,used: 3:58:30.844930,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327286
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.966484, 'precision': 0.8582618, 'recall': 0.5020144, 'specificity': 0.5020144, 'f1': 0.49553105, 'auroc': 0.8637923, 'binary_precision': 0.75, 'binary_recall': 0.004076087, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.008108108}
confusion matrix:
       0  1
0  42326  2
1   1466  6
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.84941113, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.84446263, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327286_15.png
early stop counter: 14
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 15,now: 2024-06-16 02:37:17.981539,epoch time: 0:17:45.967327,used: 4:16:16.812257,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327286
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9665525, 'precision': 0.8094458, 'recall': 0.5050006, 'specificity': 0.5050006, 'f1': 0.5015264, 'auroc': 0.8754066, 'binary_precision': 0.65217394, 'binary_recall': 0.010190218, 'binary_specificity': 0.999811, 'binary_f1_score': 0.02006689}
confusion matrix:
       0   1
0  42320   8
1   1457  15
---- Validation: 
scalar performance:
{'acc': 0.9657301, 'precision': 0.48289075, 'recall': 0.49997246, 'specificity': 0.49997246, 'f1': 0.4912832, 'auroc': 0.85812485, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9999449, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18148  1
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.8514824, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327286_16.png
early stop counter: 15
val acc:0.9657300710678101, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 16,now: 2024-06-16 02:55:15.350961,epoch time: 0:17:57.369422,used: 4:34:14.181679,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327286
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.96659815, 'precision': 0.79114795, 'recall': 0.507975, 'specificity': 0.507975, 'f1': 0.5073865, 'auroc': 0.87523997, 'binary_precision': 0.61538464, 'binary_recall': 0.016304348, 'binary_specificity': 0.99964565, 'binary_f1_score': 0.03176704}
confusion matrix:
       0   1
0  42313  15
1   1448  24
---- Validation: 
scalar performance:
{'acc': 0.9656769, 'precision': 0.48288983, 'recall': 0.4999449, 'specificity': 0.4999449, 'f1': 0.49126938, 'auroc': 0.8614086, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998898, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18147  2
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.85292375, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327286_17.png
early stop counter: 16
val acc:0.9656769037246704, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 17,now: 2024-06-16 03:13:02.054200,epoch time: 0:17:46.703239,used: 4:52:00.884918,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327286
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9665525, 'precision': 0.764242, 'recall': 0.5105743, 'specificity': 0.5105743, 'f1': 0.5124183, 'auroc': 0.871094, 'binary_precision': 0.5614035, 'binary_recall': 0.02173913, 'binary_specificity': 0.9994094, 'binary_f1_score': 0.041857425}
confusion matrix:
       0   1
0  42303  25
1   1440  32
---- Validation: 
scalar performance:
{'acc': 0.9656237, 'precision': 0.48288894, 'recall': 0.49991736, 'specificity': 0.49991736, 'f1': 0.4912556, 'auroc': 0.86589795, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998347, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18146  3
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.85689586, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327286_18.png
early stop counter: 17
val acc:0.965623676776886, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 18,now: 2024-06-16 03:30:18.449884,epoch time: 0:17:16.395684,used: 5:09:17.280602,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327286
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.966484, 'precision': 0.7406875, 'recall': 0.5184086, 'specificity': 0.5184086, 'f1': 0.5269101, 'auroc': 0.8822123, 'binary_precision': 0.51376146, 'binary_recall': 0.03806934, 'binary_specificity': 0.9987479, 'binary_f1_score': 0.070886075}
confusion matrix:
       0   1
0  42276  53
1   1415  56
---- Validation: 
scalar performance:
{'acc': 0.9655172, 'precision': 0.5543405, 'recall': 0.5006123, 'specificity': 0.5006123, 'f1': 0.49276605, 'auroc': 0.88133407, 'binary_precision': 0.14285715, 'binary_recall': 0.00155521, 'binary_specificity': 0.99966943, 'binary_f1_score': 0.0030769233}
confusion matrix:
       0  1
0  18143  6
1    642  1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589326, 'precision': 0.97945315, 'recall': 0.50766283, 'specificity': 0.50766283, 'f1': 0.5046054, 'auroc': 0.8665303, 'binary_precision': 1.0, 'binary_recall': 0.01532567, 'binary_specificity': 1.0, 'binary_f1_score': 0.030188678}
confusion matrix:
      0  1
0  5997  0
1   257  4
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327286_19.png
new oracle model saved
early stop counter: 18
val acc:0.9655172228813171, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9589325785636902
after epoch: 19,now: 2024-06-16 03:47:12.536268,epoch time: 0:16:54.086384,used: 5:26:11.366986,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327286
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9665525, 'precision': 0.7511021, 'recall': 0.5177872, 'specificity': 0.5177872, 'f1': 0.52581453, 'auroc': 0.88684833, 'binary_precision': 0.5346535, 'binary_recall': 0.03668478, 'binary_specificity': 0.9988896, 'binary_f1_score': 0.068658605}
confusion matrix:
       0   1
0  42281  47
1   1418  54
---- Validation: 
scalar performance:
{'acc': 0.96557045, 'precision': 0.6329624, 'recall': 0.50214, 'specificity': 0.50214, 'f1': 0.49583462, 'auroc': 0.8804549, 'binary_precision': 0.3, 'binary_recall': 0.00466563, 'binary_specificity': 0.9996143, 'binary_f1_score': 0.009188361}
confusion matrix:
       0  1
0  18142  7
1    640  3
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9592522, 'precision': 0.9796065, 'recall': 0.5114943, 'specificity': 0.5114943, 'f1': 0.5120629, 'auroc': 0.8649398, 'binary_precision': 1.0, 'binary_recall': 0.022988506, 'binary_specificity': 1.0, 'binary_f1_score': 0.044943817}
confusion matrix:
      0  1
0  5997  0
1   255  6
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327286_20.png
new oracle model saved
early stop counter: 19
val acc:0.9655704498291016, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9592521786689758
after epoch: 20,now: 2024-06-16 04:03:56.768052,epoch time: 0:16:44.231784,used: 5:42:55.598770,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327286
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9661187, 'precision': 0.7187011, 'recall': 0.52969366, 'specificity': 0.52969366, 'f1': 0.54598737, 'auroc': 0.8895328, 'binary_precision': 0.46907216, 'binary_recall': 0.061820652, 'binary_specificity': 0.99756664, 'binary_f1_score': 0.109243706}
confusion matrix:
       0    1
0  42225  103
1   1381   91
---- Validation: 
scalar performance:
{'acc': 0.9657301, 'precision': 0.72229415, 'recall': 0.50822306, 'specificity': 0.50822306, 'f1': 0.5077945, 'auroc': 0.88898736, 'binary_precision': 0.47826087, 'binary_recall': 0.01710731, 'binary_specificity': 0.9993388, 'binary_f1_score': 0.033033036}
confusion matrix:
       0   1
0  18137  12
1    632  11
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.9799136, 'recall': 0.5191571, 'specificity': 0.5191571, 'f1': 0.52665126, 'auroc': 0.8707093, 'binary_precision': 1.0, 'binary_recall': 0.038314175, 'binary_specificity': 1.0, 'binary_f1_score': 0.073800735}
confusion matrix:
      0   1
0  5997   0
1   251  10
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327286_21.png
new oracle model saved
early stop counter: 20
val acc:0.9657300710678101, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9598913192749023
after epoch: 21,now: 2024-06-16 04:20:33.738230,epoch time: 0:16:36.970178,used: 5:59:32.568948,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327286
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 21 with time: 5:59:32.568948 at 2024-06-16 04:20:33.738230
persisted model performance metric: 

scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.41522932, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
oracle model performance metric: 

scalar performance:
{'acc': 0.9598913, 'precision': 0.9799136, 'recall': 0.5191571, 'specificity': 0.5191571, 'f1': 0.52665126, 'auroc': 0.8707093, 'binary_precision': 1.0, 'binary_recall': 0.038314175, 'binary_specificity': 1.0, 'binary_f1_score': 0.073800735}
confusion matrix:
      0   1
0  5997   0
1   251  10
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_bs16_different_batchsizes/rule_results/3.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_bs16_different_batchsizes/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_resnet_bs16_different_batchsizes/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204178 KiB |   1436 MiB | 284107 GiB | 284107 GiB |
|       from large pool | 167936 KiB |   1366 MiB | 284055 GiB | 284055 GiB |
|       from small pool |  36242 KiB |     72 MiB |     52 GiB |     51 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 204178 KiB |   1436 MiB | 284107 GiB | 284107 GiB |
|       from large pool | 167936 KiB |   1366 MiB | 284055 GiB | 284055 GiB |
|       from small pool |  36242 KiB |     72 MiB |     52 GiB |     51 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201088 KiB |   1428 MiB | 284091 GiB | 284091 GiB |
|       from large pool | 165120 KiB |   1358 MiB | 284041 GiB | 284041 GiB |
|       from small pool |  35968 KiB |     71 MiB |     50 GiB |     50 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1524 MiB |   1524 MiB |   1524 MiB |      0 B   |
|       from large pool |   1450 MiB |   1450 MiB |   1450 MiB |      0 B   |
|       from small pool |     74 MiB |     74 MiB |     74 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 320109 KiB | 749313 KiB | 212041 GiB | 212040 GiB |
|       from large pool | 311296 KiB | 748328 KiB | 211983 GiB | 211983 GiB |
|       from small pool |   8813 KiB |  12610 KiB |     57 GiB |     57 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1278    |    1935    |    9363 K  |    9362 K  |
|       from large pool |      36    |      76    |    3727 K  |    3726 K  |
|       from small pool |    1242    |    1864    |    5636 K  |    5635 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1278    |    1935    |    9363 K  |    9362 K  |
|       from large pool |      36    |      76    |    3727 K  |    3726 K  |
|       from small pool |    1242    |    1864    |    5636 K  |    5635 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      50    |      50    |      50    |       0    |
|       from large pool |      13    |      13    |      13    |       0    |
|       from small pool |      37    |      37    |      37    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      35    |     452    |    4943 K  |    4943 K  |
|       from large pool |       5    |      10    |    1384 K  |    1384 K  |
|       from small pool |      30    |     447    |    3559 K  |    3559 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1436 MiB | 284107 GiB | 284107 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 284055 GiB | 284055 GiB |
|       from small pool |      0 KiB |     72 MiB |     52 GiB |     52 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1436 MiB | 284107 GiB | 284107 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 284055 GiB | 284055 GiB |
|       from small pool |      0 KiB |     72 MiB |     52 GiB |     52 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1428 MiB | 284091 GiB | 284091 GiB |
|       from large pool |  16640 KiB |   1358 MiB | 284041 GiB | 284041 GiB |
|       from small pool |      0 KiB |     71 MiB |     50 GiB |     50 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 524288 KiB |   1524 MiB |   1524 MiB |   1012 MiB |
|       from large pool | 479232 KiB |   1450 MiB |   1450 MiB |    982 MiB |
|       from small pool |  45056 KiB |     74 MiB |     74 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 298752 KiB | 749313 KiB | 212041 GiB | 212040 GiB |
|       from large pool | 298752 KiB | 748328 KiB | 211983 GiB | 211983 GiB |
|       from small pool |      0 KiB |  16408 KiB |     57 GiB |     57 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1935    |    9363 K  |    9363 K  |
|       from large pool |       2    |      76    |    3727 K  |    3727 K  |
|       from small pool |       0    |    1864    |    5636 K  |    5636 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1935    |    9363 K  |    9363 K  |
|       from large pool |       2    |      76    |    3727 K  |    3727 K  |
|       from small pool |       0    |    1864    |    5636 K  |    5636 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      50    |      50    |      19    |
|       from large pool |       9    |      13    |      13    |       4    |
|       from small pool |      22    |      37    |      37    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     452    |    4944 K  |    4944 K  |
|       from large pool |       1    |      11    |    1384 K  |    1384 K  |
|       from small pool |       0    |     447    |    3559 K  |    3559 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1436 MiB | 284107 GiB | 284107 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 284055 GiB | 284055 GiB |
|       from small pool |      0 KiB |     72 MiB |     52 GiB |     52 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1436 MiB | 284107 GiB | 284107 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 284055 GiB | 284055 GiB |
|       from small pool |      0 KiB |     72 MiB |     52 GiB |     52 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1428 MiB | 284091 GiB | 284091 GiB |
|       from large pool |  16640 KiB |   1358 MiB | 284041 GiB | 284041 GiB |
|       from small pool |      0 KiB |     71 MiB |     50 GiB |     50 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 524288 KiB |   1524 MiB |   1524 MiB |   1012 MiB |
|       from large pool | 479232 KiB |   1450 MiB |   1450 MiB |    982 MiB |
|       from small pool |  45056 KiB |     74 MiB |     74 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 298752 KiB | 749313 KiB | 212041 GiB | 212040 GiB |
|       from large pool | 298752 KiB | 748328 KiB | 211983 GiB | 211983 GiB |
|       from small pool |      0 KiB |  16408 KiB |     57 GiB |     57 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1935    |    9363 K  |    9363 K  |
|       from large pool |       2    |      76    |    3727 K  |    3727 K  |
|       from small pool |       0    |    1864    |    5636 K  |    5636 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1935    |    9363 K  |    9363 K  |
|       from large pool |       2    |      76    |    3727 K  |    3727 K  |
|       from small pool |       0    |    1864    |    5636 K  |    5636 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      50    |      50    |      19    |
|       from large pool |       9    |      13    |      13    |       4    |
|       from small pool |      22    |      37    |      37    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     452    |    4944 K  |    4944 K  |
|       from large pool |       1    |      11    |    1384 K  |    1384 K  |
|       from small pool |       0    |     447    |    3559 K  |    3559 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0




!!!: not committed yet



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_04_27_58_seed_1_21327286

 Experiment start at: 2024-06-16 04:27:58.211689
before training, model accuracy: 0.14631003141403198
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96678084, 'precision': 0.483556, 'recall': 0.49982294, 'specificity': 0.49982294, 'f1': 0.49155492, 'auroc': 0.42047, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9996459, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  42345  15
1   1440   0
---- Validation: 
scalar performance:
{'acc': 0.96286017, 'precision': 0.4820217, 'recall': 0.49936348, 'specificity': 0.49936348, 'f1': 0.49053937, 'auroc': 0.36877006, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99872696, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18044  23
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.33466262, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327286_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-16 04:44:56.615051,epoch time: 0:16:58.403362,used: 0:16:58.403362,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_04_27_58_seed_1_21327286
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96719176, 'precision': 0.48359588, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49166116, 'auroc': 0.44340345, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42363  0
1   1437  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.3804953, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.33739585, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327286_2.png
better model found
persisted
after epoch: 2,now: 2024-06-16 05:01:34.537010,epoch time: 0:16:37.921959,used: 0:33:36.325321,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_04_27_58_seed_1_21327286
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9671461, 'precision': 0.48357305, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49164933, 'auroc': 0.46943748, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42361  0
1   1439  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.41444737, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.36423936, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327286_3.png
early stop counter: 1
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 3,now: 2024-06-16 05:18:09.862611,epoch time: 0:16:35.325601,used: 0:50:11.650922,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_04_27_58_seed_1_21327286
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96710044, 'precision': 0.48355022, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49163756, 'auroc': 0.5037093, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42359  0
1   1441  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.4253518, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.40356815, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327286_4.png
early stop counter: 2
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 4,now: 2024-06-16 05:34:56.810847,epoch time: 0:16:46.948236,used: 1:06:58.599158,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_04_27_58_seed_1_21327286
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9671461, 'precision': 0.48357305, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49164933, 'auroc': 0.5491092, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42361  0
1   1439  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.4826923, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.45515066, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327286_5.png
early stop counter: 3
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 5,now: 2024-06-16 05:52:11.619550,epoch time: 0:17:14.808703,used: 1:24:13.407861,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_04_27_58_seed_1_21327286
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96710044, 'precision': 0.48355022, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49163756, 'auroc': 0.56620055, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42359  0
1   1441  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.4938884, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.5080793, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327286_6.png
early stop counter: 4
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 6,now: 2024-06-16 06:11:04.243794,epoch time: 0:18:52.624244,used: 1:43:06.032105,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_04_27_58_seed_1_21327286
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96710044, 'precision': 0.48355022, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49163756, 'auroc': 0.6300309, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42359  0
1   1441  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.56361216, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.5674211, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327286_7.png
early stop counter: 5
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 7,now: 2024-06-16 06:27:46.710037,epoch time: 0:16:42.466243,used: 1:59:48.498348,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_04_27_58_seed_1_21327286
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.96712327, 'precision': 0.48356164, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49164346, 'auroc': 0.6662468, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42360  0
1   1440  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.59262884, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.60578024, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327286_8.png
early stop counter: 6
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 8,now: 2024-06-16 06:44:29.490553,epoch time: 0:16:42.780516,used: 2:16:31.278864,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_04_27_58_seed_1_21327286
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.96712327, 'precision': 0.48356164, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49164346, 'auroc': 0.714375, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42360  0
1   1440  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.6548301, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.6788901, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327286_9.png
early stop counter: 7
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 9,now: 2024-06-16 07:01:13.144933,epoch time: 0:16:43.654380,used: 2:33:14.933244,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_04_27_58_seed_1_21327286
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9671461, 'precision': 0.48357305, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49164933, 'auroc': 0.75006634, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42361  0
1   1439  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.6989852, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.7152478, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327286_10.png
early stop counter: 8
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 10,now: 2024-06-16 07:17:41.855495,epoch time: 0:16:28.710562,used: 2:49:43.643806,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_04_27_58_seed_1_21327286
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96710044, 'precision': 0.48355022, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49163756, 'auroc': 0.7744323, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42359  0
1   1441  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.7379033, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.7562696, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327286_11.png
early stop counter: 9
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 11,now: 2024-06-16 07:34:24.799213,epoch time: 0:16:42.943718,used: 3:06:26.587524,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_04_27_58_seed_1_21327286
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9670776, 'precision': 0.4835388, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49163166, 'auroc': 0.79920316, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42358  0
1   1442  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.766751, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.7810042, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327286_12.png
early stop counter: 10
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 12,now: 2024-06-16 07:51:16.303842,epoch time: 0:16:51.504629,used: 3:23:18.092153,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_04_27_58_seed_1_21327286
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9671461, 'precision': 0.48357305, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49164933, 'auroc': 0.81560826, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42361  0
1   1439  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.79041165, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.79441786, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327286_13.png
early stop counter: 11
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 13,now: 2024-06-16 08:08:01.517368,epoch time: 0:16:45.213526,used: 3:40:03.305679,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_04_27_58_seed_1_21327286
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96710044, 'precision': 0.7335609, 'recall': 0.50033516, 'specificity': 0.50033516, 'f1': 0.49233034, 'auroc': 0.8353351, 'binary_precision': 0.5, 'binary_recall': 0.0006939625, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.0013860012}
confusion matrix:
       0  1
0  42358  1
1   1440  1
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.8120861, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.8142216, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327286_14.png
early stop counter: 12
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 14,now: 2024-06-16 08:24:39.312547,epoch time: 0:16:37.795179,used: 3:56:41.100858,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_04_27_58_seed_1_21327286
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9671689, 'precision': 0.78360546, 'recall': 0.50101876, 'specificity': 0.50101876, 'f1': 0.49373224, 'auroc': 0.84465325, 'binary_precision': 0.6, 'binary_recall': 0.0020847812, 'binary_specificity': 0.9999528, 'binary_f1_score': 0.004155125}
confusion matrix:
       0  1
0  42359  2
1   1436  3
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.82725364, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.8190572, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327286_15.png
early stop counter: 13
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 15,now: 2024-06-16 08:40:29.870089,epoch time: 0:15:50.557542,used: 4:12:31.658400,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_04_27_58_seed_1_21327286
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9672831, 'precision': 0.8258083, 'recall': 0.50444305, 'specificity': 0.50444305, 'f1': 0.50059247, 'auroc': 0.86405796, 'binary_precision': 0.68421054, 'binary_recall': 0.009027778, 'binary_specificity': 0.9998584, 'binary_f1_score': 0.017820425}
confusion matrix:
       0   1
0  42354   6
1   1427  13
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.8430668, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.82898283, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327286_16.png
early stop counter: 14
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 16,now: 2024-06-16 08:56:21.445945,epoch time: 0:15:51.575856,used: 4:28:23.234256,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_04_27_58_seed_1_21327286
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.96696347, 'precision': 0.6575574, 'recall': 0.5026007, 'specificity': 0.5026007, 'f1': 0.49706876, 'auroc': 0.8660404, 'binary_precision': 0.3478261, 'binary_recall': 0.0055555557, 'binary_specificity': 0.9996459, 'binary_f1_score': 0.010936432}
confusion matrix:
       0   1
0  42345  15
1   1432   8
---- Validation: 
scalar performance:
{'acc': 0.96403414, 'precision': 0.4820428, 'recall': 0.4999723, 'specificity': 0.4999723, 'f1': 0.49084386, 'auroc': 0.8500332, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9999446, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18066  1
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.83569944, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327286_17.png
early stop counter: 15
val acc:0.9640341401100159, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 17,now: 2024-06-16 09:12:12.748016,epoch time: 0:15:51.302071,used: 4:44:14.536327,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_04_27_58_seed_1_21327286
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9672375, 'precision': 0.76160824, 'recall': 0.5084445, 'specificity': 0.5084445, 'f1': 0.50850314, 'auroc': 0.87262744, 'binary_precision': 0.5555556, 'binary_recall': 0.017361112, 'binary_specificity': 0.9995279, 'binary_f1_score': 0.033670034}
confusion matrix:
       0   1
0  42340  20
1   1415  25
---- Validation: 
scalar performance:
{'acc': 0.96403414, 'precision': 0.6487342, 'recall': 0.5006876, 'specificity': 0.5006876, 'f1': 0.49232268, 'auroc': 0.84979784, 'binary_precision': 0.33333334, 'binary_recall': 0.0014858841, 'binary_specificity': 0.9998893, 'binary_f1_score': 0.0029585797}
confusion matrix:
       0  1
0  18065  2
1    672  1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.83732826, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327286_18.png
early stop counter: 16
val acc:0.9640341401100159, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 18,now: 2024-06-16 09:29:15.287841,epoch time: 0:17:02.539825,used: 5:01:17.076152,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_04_27_58_seed_1_21327286
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9672375, 'precision': 0.7573128, 'recall': 0.51381505, 'specificity': 0.51381505, 'f1': 0.518692, 'auroc': 0.8767881, 'binary_precision': 0.5466667, 'binary_recall': 0.028432732, 'binary_specificity': 0.9991973, 'binary_f1_score': 0.05405405}
confusion matrix:
       0   1
0  42324  34
1   1401  41
---- Validation: 
scalar performance:
{'acc': 0.96419424, 'precision': 0.7738858, 'recall': 0.5050622, 'specificity': 0.5050622, 'f1': 0.5011009, 'auroc': 0.86799383, 'binary_precision': 0.5833333, 'binary_recall': 0.010401188, 'binary_specificity': 0.99972326, 'binary_f1_score': 0.020437956}
confusion matrix:
       0  1
0  18062  5
1    666  7
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582662, 'precision': 0.97912973, 'recall': 0.5019231, 'specificity': 0.5019231, 'f1': 0.49317387, 'auroc': 0.849048, 'binary_precision': 1.0, 'binary_recall': 0.0038461538, 'binary_specificity': 1.0, 'binary_f1_score': 0.007662835}
confusion matrix:
      0  1
0  5946  0
1   259  1
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327286_19.png
new oracle model saved
better model found
persisted
after epoch: 19,now: 2024-06-16 09:46:46.745484,epoch time: 0:17:31.457643,used: 5:18:48.533795,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_04_27_58_seed_1_21327286
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9671689, 'precision': 0.74449134, 'recall': 0.516794, 'specificity': 0.516794, 'f1': 0.52415526, 'auroc': 0.8819306, 'binary_precision': 0.5208333, 'binary_recall': 0.034674063, 'binary_specificity': 0.998914, 'binary_f1_score': 0.0650195}
confusion matrix:
       0   1
0  42312  46
1   1392  50
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.73224205, 'recall': 0.5057221, 'specificity': 0.5057221, 'f1': 0.5024648, 'auroc': 0.8679545, 'binary_precision': 0.5, 'binary_recall': 0.011887073, 'binary_specificity': 0.9995572, 'binary_f1_score': 0.02322206}
confusion matrix:
       0  1
0  18059  8
1    665  8
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589107, 'precision': 0.9794388, 'recall': 0.50961536, 'specificity': 0.50961536, 'f1': 0.50837153, 'auroc': 0.84889376, 'binary_precision': 1.0, 'binary_recall': 0.01923077, 'binary_specificity': 1.0, 'binary_f1_score': 0.037735853}
confusion matrix:
      0  1
0  5946  0
1   255  5
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327286_20.png
new oracle model saved
early stop counter: 1
val acc:0.9640874862670898, best validation acc: 0.9641942381858826, corresponding to test acc:                         0.9582661986351013 / 0.9589107036590576
after epoch: 20,now: 2024-06-16 10:03:18.588003,epoch time: 0:16:31.842519,used: 5:35:20.376314,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_04_27_58_seed_1_21327286
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9667352, 'precision': 0.70004666, 'recall': 0.5199299, 'specificity': 0.5199299, 'f1': 0.52957827, 'auroc': 0.88533145, 'binary_precision': 0.43165466, 'binary_recall': 0.04172462, 'binary_specificity': 0.99813515, 'binary_f1_score': 0.076093845}
confusion matrix:
       0   1
0  42283  79
1   1378  60
---- Validation: 
scalar performance:
{'acc': 0.9641409, 'precision': 0.7423671, 'recall': 0.50932616, 'specificity': 0.50932616, 'f1': 0.5094897, 'auroc': 0.879323, 'binary_precision': 0.52, 'binary_recall': 0.019316493, 'binary_specificity': 0.9993358, 'binary_f1_score': 0.037249282}
confusion matrix:
       0   1
0  18055  12
1    660  13
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95939416, 'precision': 0.9796709, 'recall': 0.5153846, 'specificity': 0.5153846, 'f1': 0.5194752, 'auroc': 0.85488176, 'binary_precision': 1.0, 'binary_recall': 0.03076923, 'binary_specificity': 1.0, 'binary_f1_score': 0.05970149}
confusion matrix:
      0  1
0  5946  0
1   252  8
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327286_21.png
new oracle model saved
early stop counter: 2
val acc:0.9641408920288086, best validation acc: 0.9641942381858826, corresponding to test acc:                         0.9582661986351013 / 0.9593941569328308
after epoch: 21,now: 2024-06-16 10:19:27.280448,epoch time: 0:16:08.692445,used: 5:51:29.068759,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_04_27_58_seed_1_21327286
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.96703196, 'precision': 0.7307811, 'recall': 0.5324768, 'specificity': 0.5324768, 'f1': 0.5508195, 'auroc': 0.89406, 'binary_precision': 0.49238577, 'binary_recall': 0.067314364, 'binary_specificity': 0.99763924, 'binary_f1_score': 0.11843711}
confusion matrix:
       0    1
0  42259  100
1   1344   97
---- Validation: 
scalar performance:
{'acc': 0.96435434, 'precision': 0.76171404, 'recall': 0.5173048, 'specificity': 0.5173048, 'f1': 0.52443457, 'auroc': 0.8847731, 'binary_precision': 0.55813956, 'binary_recall': 0.035661217, 'binary_specificity': 0.99894834, 'binary_f1_score': 0.0670391}
confusion matrix:
       0   1
0  18048  19
1    649  24
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95987755, 'precision': 0.97990316, 'recall': 0.52115387, 'specificity': 0.52115387, 'f1': 0.5303359, 'auroc': 0.85672593, 'binary_precision': 1.0, 'binary_recall': 0.042307694, 'binary_specificity': 1.0, 'binary_f1_score': 0.08118081}
confusion matrix:
      0   1
0  5946   0
1   249  11
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327286_22.png
new oracle model saved
better model found
persisted
after epoch: 22,now: 2024-06-16 10:35:52.911851,epoch time: 0:16:25.631403,used: 6:07:54.700162,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_04_27_58_seed_1_21327286
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9668265, 'precision': 0.71979004, 'recall': 0.53675735, 'specificity': 0.53675735, 'f1': 0.5572953, 'auroc': 0.89180887, 'binary_precision': 0.47008547, 'binary_recall': 0.07644197, 'binary_specificity': 0.99707276, 'binary_f1_score': 0.1315003}
confusion matrix:
       0    1
0  42237  124
1   1329  110
---- Validation: 
scalar performance:
{'acc': 0.96435434, 'precision': 0.7563537, 'recall': 0.5208811, 'specificity': 0.5208811, 'f1': 0.53085744, 'auroc': 0.8879415, 'binary_precision': 0.5471698, 'binary_recall': 0.043090638, 'binary_specificity': 0.9986716, 'binary_f1_score': 0.079889804}
confusion matrix:
       0   1
0  18043  24
1    644  29
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96019983, 'precision': 0.98005813, 'recall': 0.525, 'specificity': 0.525, 'f1': 0.53744525, 'auroc': 0.8611523, 'binary_precision': 1.0, 'binary_recall': 0.05, 'binary_specificity': 1.0, 'binary_f1_score': 0.095238104}
confusion matrix:
      0   1
0  5946   0
1   247  13
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327286_23.png
new oracle model saved
early stop counter: 1
val acc:0.9643543362617493, best validation acc: 0.9643543362617493, corresponding to test acc:                         0.9598775506019592 / 0.9601998329162598
after epoch: 23,now: 2024-06-16 10:52:34.458507,epoch time: 0:16:41.546656,used: 6:24:36.246818,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_04_27_58_seed_1_21327286
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.96746576, 'precision': 0.7525525, 'recall': 0.5407453, 'specificity': 0.5407453, 'f1': 0.5642941, 'auroc': 0.89143723, 'binary_precision': 0.53539824, 'binary_recall': 0.08396947, 'binary_specificity': 0.99752116, 'binary_f1_score': 0.14517097}
confusion matrix:
       0    1
0  42254  105
1   1320  121
---- Validation: 
scalar performance:
{'acc': 0.964461, 'precision': 0.7733687, 'recall': 0.5180754, 'specificity': 0.5180754, 'f1': 0.52585846, 'auroc': 0.88335896, 'binary_precision': 0.5813953, 'binary_recall': 0.0371471, 'binary_specificity': 0.9990037, 'binary_f1_score': 0.0698324}
confusion matrix:
       0   1
0  18049  18
1    648  25
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96036094, 'precision': 0.9801357, 'recall': 0.52692306, 'specificity': 0.52692306, 'f1': 0.54096144, 'auroc': 0.85974395, 'binary_precision': 1.0, 'binary_recall': 0.053846154, 'binary_specificity': 1.0, 'binary_f1_score': 0.10218979}
confusion matrix:
      0   1
0  5946   0
1   246  14
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327286_24.png
new oracle model saved
better model found
persisted
after epoch: 24,now: 2024-06-16 11:08:29.442872,epoch time: 0:15:54.984365,used: 6:40:31.231183,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_04_27_58_seed_1_21327286
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9676484, 'precision': 0.7592259, 'recall': 0.5438759, 'specificity': 0.5438759, 'f1': 0.5692736, 'auroc': 0.8988522, 'binary_precision': 0.5485232, 'binary_recall': 0.090277776, 'binary_specificity': 0.997474, 'binary_f1_score': 0.15503876}
confusion matrix:
       0    1
0  42253  107
1   1310  130
---- Validation: 
scalar performance:
{'acc': 0.9644077, 'precision': 0.76057243, 'recall': 0.521624, 'specificity': 0.521624, 'f1': 0.5321914, 'auroc': 0.88814664, 'binary_precision': 0.5555556, 'binary_recall': 0.044576522, 'binary_specificity': 0.9986716, 'binary_f1_score': 0.082530946}
confusion matrix:
       0   1
0  18043  24
1    643  30
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96052206, 'precision': 0.9802132, 'recall': 0.52884614, 'specificity': 0.52884614, 'f1': 0.54445237, 'auroc': 0.86067283, 'binary_precision': 1.0, 'binary_recall': 0.057692308, 'binary_specificity': 1.0, 'binary_f1_score': 0.10909091}
confusion matrix:
      0   1
0  5946   0
1   245  15
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327286_25.png
new oracle model saved
early stop counter: 1
val acc:0.9644076824188232, best validation acc: 0.9644610285758972, corresponding to test acc:                         0.9603609442710876 / 0.9605220556259155
after epoch: 25,now: 2024-06-16 11:24:53.337292,epoch time: 0:16:23.894420,used: 6:56:55.125603,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_04_27_58_seed_1_21327286
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9674886, 'precision': 0.74972236, 'recall': 0.54882455, 'specificity': 0.54882455, 'f1': 0.57630736, 'auroc': 0.9026029, 'binary_precision': 0.5291971, 'binary_recall': 0.10069445, 'binary_specificity': 0.9969547, 'binary_f1_score': 0.16919488}
confusion matrix:
       0    1
0  42231  129
1   1295  145
---- Validation: 
scalar performance:
{'acc': 0.96451443, 'precision': 0.7615923, 'recall': 0.5281168, 'specificity': 0.5281168, 'f1': 0.5434391, 'auroc': 0.8932575, 'binary_precision': 0.55714285, 'binary_recall': 0.05794948, 'binary_specificity': 0.99828416, 'binary_f1_score': 0.104979806}
confusion matrix:
       0   1
0  18036  31
1    634  39
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606832, 'precision': 0.9802908, 'recall': 0.5307692, 'specificity': 0.5307692, 'f1': 0.5479183, 'auroc': 0.86420286, 'binary_precision': 1.0, 'binary_recall': 0.06153846, 'binary_specificity': 1.0, 'binary_f1_score': 0.11594203}
confusion matrix:
      0   1
0  5946   0
1   244  16
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327286_26.png
new oracle model saved
better model found
persisted
after epoch: 26,now: 2024-06-16 11:40:32.219744,epoch time: 0:15:38.882452,used: 7:12:34.008055,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_04_27_58_seed_1_21327286
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9670548, 'precision': 0.73216796, 'recall': 0.5442399, 'specificity': 0.5442399, 'f1': 0.5689287, 'auroc': 0.90171504, 'binary_precision': 0.49438202, 'binary_recall': 0.09166667, 'binary_specificity': 0.99681306, 'binary_f1_score': 0.15465729}
confusion matrix:
       0    1
0  42225  135
1   1308  132
---- Validation: 
scalar performance:
{'acc': 0.96451443, 'precision': 0.76517916, 'recall': 0.52525574, 'specificity': 0.52525574, 'f1': 0.53857017, 'auroc': 0.89117837, 'binary_precision': 0.5645161, 'binary_recall': 0.052005943, 'binary_specificity': 0.9985056, 'binary_f1_score': 0.09523809}
confusion matrix:
       0   1
0  18040  27
1    638  35
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606832, 'precision': 0.9802908, 'recall': 0.5307692, 'specificity': 0.5307692, 'f1': 0.5479183, 'auroc': 0.8648827, 'binary_precision': 1.0, 'binary_recall': 0.06153846, 'binary_specificity': 1.0, 'binary_f1_score': 0.11594203}
confusion matrix:
      0   1
0  5946   0
1   244  16
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327286_27.png
early stop counter: 1
val acc:0.964514434337616, best validation acc: 0.964514434337616, corresponding to test acc:                         0.9606832265853882 / 0.9606832265853882
after epoch: 27,now: 2024-06-16 11:57:01.175749,epoch time: 0:16:28.956005,used: 7:29:02.964060,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_04_27_58_seed_1_21327286
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.96652967, 'precision': 0.71740264, 'recall': 0.55604345, 'specificity': 0.55604345, 'f1': 0.5846864, 'auroc': 0.8994544, 'binary_precision': 0.4640884, 'binary_recall': 0.11666667, 'binary_specificity': 0.9954202, 'binary_f1_score': 0.1864595}
confusion matrix:
       0    1
0  42166  194
1   1272  168
---- Validation: 
scalar performance:
{'acc': 0.9645678, 'precision': 0.7609495, 'recall': 0.5324361, 'specificity': 0.5324361, 'f1': 0.5506418, 'auroc': 0.8960402, 'binary_precision': 0.5555556, 'binary_recall': 0.06686478, 'binary_specificity': 0.9980074, 'binary_f1_score': 0.11936338}
confusion matrix:
       0   1
0  18031  36
1    628  45
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96100545, 'precision': 0.980446, 'recall': 0.5346154, 'specificity': 0.5346154, 'f1': 0.55477625, 'auroc': 0.8652384, 'binary_precision': 1.0, 'binary_recall': 0.06923077, 'binary_specificity': 1.0, 'binary_f1_score': 0.12949641}
confusion matrix:
      0   1
0  5946   0
1   242  18
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327286_28.png
new oracle model saved
better model found
persisted
after epoch: 28,now: 2024-06-16 12:13:24.200230,epoch time: 0:16:23.024481,used: 7:45:25.988541,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_04_27_58_seed_1_21327286
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.96753424, 'precision': 0.74835646, 'recall': 0.55826986, 'specificity': 0.55826986, 'f1': 0.589567, 'auroc': 0.90333533, 'binary_precision': 0.5258359, 'binary_recall': 0.120222375, 'binary_specificity': 0.9963174, 'binary_f1_score': 0.19570135}
confusion matrix:
       0    1
0  42205  156
1   1266  173
---- Validation: 
scalar performance:
{'acc': 0.964301, 'precision': 0.7465308, 'recall': 0.52800614, 'specificity': 0.52800614, 'f1': 0.54310256, 'auroc': 0.89266026, 'binary_precision': 0.527027, 'binary_recall': 0.05794948, 'binary_specificity': 0.9980628, 'binary_f1_score': 0.10441767}
confusion matrix:
       0   1
0  18032  35
1    634  39
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96084434, 'precision': 0.9803684, 'recall': 0.5326923, 'specificity': 0.5326923, 'f1': 0.55135953, 'auroc': 0.8644973, 'binary_precision': 1.0, 'binary_recall': 0.06538462, 'binary_specificity': 1.0, 'binary_f1_score': 0.12274369}
confusion matrix:
      0   1
0  5946   0
1   243  17
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327286_29.png
early stop counter: 1
val acc:0.9643009901046753, best validation acc: 0.9645677804946899, corresponding to test acc:                         0.961005449295044 / 0.961005449295044
after epoch: 29,now: 2024-06-16 12:30:51.432603,epoch time: 0:17:27.232373,used: 8:02:53.220914,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_04_27_58_seed_1_21327286
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9681507, 'precision': 0.7666391, 'recall': 0.5676514, 'specificity': 0.5676514, 'f1': 0.6032917, 'auroc': 0.90468436, 'binary_precision': 0.56179774, 'binary_recall': 0.13898541, 'binary_specificity': 0.9963174, 'binary_f1_score': 0.22284123}
confusion matrix:
       0    1
0  42205  156
1   1239  200
---- Validation: 
scalar performance:
{'acc': 0.9647812, 'precision': 0.7706566, 'recall': 0.5361231, 'specificity': 0.5361231, 'f1': 0.5568025, 'auroc': 0.8984042, 'binary_precision': 0.57471263, 'binary_recall': 0.0742942, 'binary_specificity': 0.99795204, 'binary_f1_score': 0.13157894}
confusion matrix:
       0   1
0  18030  37
1    623  50
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606832, 'precision': 0.9802908, 'recall': 0.5307692, 'specificity': 0.5307692, 'f1': 0.5479183, 'auroc': 0.86868536, 'binary_precision': 1.0, 'binary_recall': 0.06153846, 'binary_specificity': 1.0, 'binary_f1_score': 0.11594203}
confusion matrix:
      0   1
0  5946   0
1   244  16
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327286_30.png
better model found
persisted
after epoch: 30,now: 2024-06-16 12:47:25.319060,epoch time: 0:16:33.886457,used: 8:19:27.107371,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_04_27_58_seed_1_21327286
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 8:19:27.107371 at 2024-06-16 12:47:25.319060
persisted model performance metric: 

scalar performance:
{'acc': 0.9606832, 'precision': 0.9802908, 'recall': 0.5307692, 'specificity': 0.5307692, 'f1': 0.5479183, 'auroc': 0.86868536, 'binary_precision': 1.0, 'binary_recall': 0.06153846, 'binary_specificity': 1.0, 'binary_f1_score': 0.11594203}
confusion matrix:
      0   1
0  5946   0
1   244  16
oracle model performance metric: 

scalar performance:
{'acc': 0.96100545, 'precision': 0.980446, 'recall': 0.5346154, 'specificity': 0.5346154, 'f1': 0.55477625, 'auroc': 0.8652384, 'binary_precision': 1.0, 'binary_recall': 0.06923077, 'binary_specificity': 1.0, 'binary_f1_score': 0.12949641}
confusion matrix:
      0   1
0  5946   0
1   242  18
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_bs16_different_batchsizes/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_resnet_bs16_different_batchsizes/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204178 KiB |   1436 MiB | 688519 GiB | 688519 GiB |
|       from large pool | 167936 KiB |   1366 MiB | 688392 GiB | 688392 GiB |
|       from small pool |  36242 KiB |     72 MiB |    126 GiB |    126 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 204178 KiB |   1436 MiB | 688519 GiB | 688519 GiB |
|       from large pool | 167936 KiB |   1366 MiB | 688392 GiB | 688392 GiB |
|       from small pool |  36242 KiB |     72 MiB |    126 GiB |    126 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201086 KiB |   1428 MiB | 688498 GiB | 688498 GiB |
|       from large pool | 165120 KiB |   1358 MiB | 688376 GiB | 688375 GiB |
|       from small pool |  35966 KiB |     71 MiB |    122 GiB |    122 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1466 MiB |   1524 MiB |   2478 MiB |   1012 MiB |
|       from large pool |   1392 MiB |   1450 MiB |   2374 MiB |    982 MiB |
|       from small pool |     74 MiB |     74 MiB |    104 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 320109 KiB | 749313 KiB | 527770 GiB | 527770 GiB |
|       from large pool | 311296 KiB | 748328 KiB | 527632 GiB | 527632 GiB |
|       from small pool |   8813 KiB |  16408 KiB |    137 GiB |    137 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1278    |    1935    |   22716 K  |   22715 K  |
|       from large pool |      36    |      76    |    9038 K  |    9038 K  |
|       from small pool |    1242    |    1864    |   13678 K  |   13677 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1278    |    1935    |   22716 K  |   22715 K  |
|       from large pool |      36    |      76    |    9038 K  |    9038 K  |
|       from small pool |    1242    |    1864    |   13678 K  |   13677 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      49    |      50    |      68    |      19    |
|       from large pool |      12    |      13    |      16    |       4    |
|       from small pool |      37    |      37    |      52    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      35    |     453    |   12958 K  |   12958 K  |
|       from large pool |       5    |      11    |    3538 K  |    3538 K  |
|       from small pool |      30    |     448    |    9419 K  |    9419 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1436 MiB | 688519 GiB | 688519 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 688392 GiB | 688392 GiB |
|       from small pool |      0 KiB |     72 MiB |    126 GiB |    126 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1436 MiB | 688519 GiB | 688519 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 688392 GiB | 688392 GiB |
|       from small pool |      0 KiB |     72 MiB |    126 GiB |    126 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1428 MiB | 688498 GiB | 688498 GiB |
|       from large pool |  16640 KiB |   1358 MiB | 688376 GiB | 688376 GiB |
|       from small pool |      0 KiB |     71 MiB |    122 GiB |    122 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 524288 KiB |   1524 MiB |   2478 MiB |   1966 MiB |
|       from large pool | 479232 KiB |   1450 MiB |   2374 MiB |   1906 MiB |
|       from small pool |  45056 KiB |     74 MiB |    104 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 298752 KiB | 749313 KiB | 527770 GiB | 527770 GiB |
|       from large pool | 298752 KiB | 748328 KiB | 527632 GiB | 527632 GiB |
|       from small pool |      0 KiB |  16408 KiB |    137 GiB |    137 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1935    |   22716 K  |   22716 K  |
|       from large pool |       2    |      76    |    9038 K  |    9038 K  |
|       from small pool |       0    |    1864    |   13678 K  |   13678 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1935    |   22716 K  |   22716 K  |
|       from large pool |       2    |      76    |    9038 K  |    9038 K  |
|       from small pool |       0    |    1864    |   13678 K  |   13678 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      50    |      68    |      37    |
|       from large pool |       9    |      13    |      16    |       7    |
|       from small pool |      22    |      37    |      52    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     453    |   12958 K  |   12958 K  |
|       from large pool |       1    |      11    |    3538 K  |    3538 K  |
|       from small pool |       0    |     448    |    9419 K  |    9419 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1436 MiB | 688519 GiB | 688519 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 688392 GiB | 688392 GiB |
|       from small pool |      0 KiB |     72 MiB |    126 GiB |    126 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1436 MiB | 688519 GiB | 688519 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 688392 GiB | 688392 GiB |
|       from small pool |      0 KiB |     72 MiB |    126 GiB |    126 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1428 MiB | 688498 GiB | 688498 GiB |
|       from large pool |  16640 KiB |   1358 MiB | 688376 GiB | 688376 GiB |
|       from small pool |      0 KiB |     71 MiB |    122 GiB |    122 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 524288 KiB |   1524 MiB |   2478 MiB |   1966 MiB |
|       from large pool | 479232 KiB |   1450 MiB |   2374 MiB |   1906 MiB |
|       from small pool |  45056 KiB |     74 MiB |    104 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 298752 KiB | 749313 KiB | 527770 GiB | 527770 GiB |
|       from large pool | 298752 KiB | 748328 KiB | 527632 GiB | 527632 GiB |
|       from small pool |      0 KiB |  16408 KiB |    137 GiB |    137 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1935    |   22716 K  |   22716 K  |
|       from large pool |       2    |      76    |    9038 K  |    9038 K  |
|       from small pool |       0    |    1864    |   13678 K  |   13678 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1935    |   22716 K  |   22716 K  |
|       from large pool |       2    |      76    |    9038 K  |    9038 K  |
|       from small pool |       0    |    1864    |   13678 K  |   13678 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      50    |      68    |      37    |
|       from large pool |       9    |      13    |      16    |       7    |
|       from small pool |      22    |      37    |      52    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     453    |   12958 K  |   12958 K  |
|       from large pool |       1    |      11    |    3538 K  |    3538 K  |
|       from small pool |       0    |     448    |    9419 K  |    9419 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0




!!!: not committed yet



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_12_54_37_seed_2_21327286

 Experiment start at: 2024-06-16 12:54:37.910092
before training, model accuracy: 0.0544959120452404
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96547943, 'precision': 0.48273972, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4912183, 'auroc': 0.4397226, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42288  0
1   1512  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.3725453, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.36505854, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327286_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-16 13:10:35.696659,epoch time: 0:15:57.786567,used: 0:15:57.786567,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_12_54_37_seed_2_21327286
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96547943, 'precision': 0.48273972, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4912183, 'auroc': 0.45578027, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42288  0
1   1512  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.3959806, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.37875068, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327286_2.png
early stop counter: 1
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 2,now: 2024-06-16 13:26:13.687231,epoch time: 0:15:37.990572,used: 0:31:35.777139,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_12_54_37_seed_2_21327286
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9654566, 'precision': 0.4827283, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49121237, 'auroc': 0.5009686, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42287  0
1   1513  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.42816973, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.41069138, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327286_3.png
early stop counter: 2
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 3,now: 2024-06-16 13:41:57.295623,epoch time: 0:15:43.608392,used: 0:47:19.385531,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_12_54_37_seed_2_21327286
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9654566, 'precision': 0.4827283, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49121237, 'auroc': 0.5104505, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42287  0
1   1513  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.45093864, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.4195541, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327286_4.png
early stop counter: 3
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 4,now: 2024-06-16 13:57:39.739571,epoch time: 0:15:42.443948,used: 1:03:01.829479,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_12_54_37_seed_2_21327286
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96547943, 'precision': 0.48273972, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4912183, 'auroc': 0.5603297, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42288  0
1   1512  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.49753374, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.4894498, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327286_5.png
early stop counter: 4
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 5,now: 2024-06-16 14:13:29.658631,epoch time: 0:15:49.919060,used: 1:18:51.748539,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_12_54_37_seed_2_21327286
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96547943, 'precision': 0.48273972, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4912183, 'auroc': 0.6106702, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42288  0
1   1512  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.55485654, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.5404057, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327286_6.png
early stop counter: 5
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 6,now: 2024-06-16 14:29:29.968826,epoch time: 0:16:00.310195,used: 1:34:52.058734,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_12_54_37_seed_2_21327286
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9654566, 'precision': 0.4827283, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49121237, 'auroc': 0.66109467, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42287  0
1   1513  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.5977051, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.5993725, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327286_7.png
early stop counter: 6
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 7,now: 2024-06-16 14:45:36.555009,epoch time: 0:16:06.586183,used: 1:50:58.644917,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_12_54_37_seed_2_21327286
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.96550226, 'precision': 0.48275113, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4912242, 'auroc': 0.69646835, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42289  0
1   1511  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.6733097, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.6369271, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327286_8.png
early stop counter: 7
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 8,now: 2024-06-16 15:02:06.153785,epoch time: 0:16:29.598776,used: 2:07:28.243693,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_12_54_37_seed_2_21327286
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.96547943, 'precision': 0.48273972, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4912183, 'auroc': 0.72389317, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42288  0
1   1512  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.6868187, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.68641865, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327286_9.png
early stop counter: 8
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 9,now: 2024-06-16 15:19:51.219219,epoch time: 0:17:45.065434,used: 2:25:13.309127,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_12_54_37_seed_2_21327286
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.96547943, 'precision': 0.48273972, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4912183, 'auroc': 0.77234995, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42288  0
1   1512  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.7450099, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.7315031, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327286_10.png
early stop counter: 9
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 10,now: 2024-06-16 15:37:43.477785,epoch time: 0:17:52.258566,used: 2:43:05.567693,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_12_54_37_seed_2_21327286
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96547943, 'precision': 0.48273972, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4912183, 'auroc': 0.7956561, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42288  0
1   1512  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.78342307, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.7692431, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327286_11.png
early stop counter: 10
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 11,now: 2024-06-16 15:53:37.970432,epoch time: 0:15:54.492647,used: 2:59:00.060340,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_12_54_37_seed_2_21327286
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.96547943, 'precision': 0.48273972, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4912183, 'auroc': 0.8173276, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42288  0
1   1512  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.800947, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.78986067, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327286_12.png
early stop counter: 11
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 12,now: 2024-06-16 16:09:37.372520,epoch time: 0:15:59.402088,used: 3:14:59.462428,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_12_54_37_seed_2_21327286
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9654566, 'precision': 0.4827283, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49121237, 'auroc': 0.83075225, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42287  0
1   1513  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.82755363, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.8057979, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327286_13.png
early stop counter: 12
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 13,now: 2024-06-16 16:26:10.205772,epoch time: 0:16:32.833252,used: 3:31:32.295680,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_12_54_37_seed_2_21327286
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96547943, 'precision': 0.9827393, 'recall': 0.50033045, 'specificity': 0.50033045, 'f1': 0.4918786, 'auroc': 0.848002, 'binary_precision': 1.0, 'binary_recall': 0.00066093856, 'binary_specificity': 1.0, 'binary_f1_score': 0.0013210041}
confusion matrix:
       0  1
0  42287  0
1   1512  1
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.831174, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.80993164, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327286_14.png
early stop counter: 13
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 14,now: 2024-06-16 16:42:06.080509,epoch time: 0:15:55.874737,used: 3:47:28.170417,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_12_54_37_seed_2_21327286
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.96547943, 'precision': 0.75551975, 'recall': 0.5019237, 'specificity': 0.5019237, 'f1': 0.49515405, 'auroc': 0.8565075, 'binary_precision': 0.54545456, 'binary_recall': 0.003965631, 'binary_specificity': 0.99988174, 'binary_f1_score': 0.007874016}
confusion matrix:
       0  1
0  42282  5
1   1507  6
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.8476919, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.83030355, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327286_15.png
early stop counter: 14
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 15,now: 2024-06-16 16:58:03.222139,epoch time: 0:15:57.141630,used: 4:03:25.312047,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_12_54_37_seed_2_21327286
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9656621, 'precision': 0.79178977, 'recall': 0.5067907, 'specificity': 0.5067907, 'f1': 0.5048447, 'auroc': 0.8674078, 'binary_precision': 0.61764705, 'binary_recall': 0.013888889, 'binary_specificity': 0.99969256, 'binary_f1_score': 0.027166884}
confusion matrix:
       0   1
0  42275  13
1   1491  21
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.73399127, 'recall': 0.50080305, 'specificity': 0.50080305, 'f1': 0.49350777, 'auroc': 0.86239624, 'binary_precision': 0.5, 'binary_recall': 0.0016611295, 'binary_specificity': 0.999945, 'binary_f1_score': 0.0033112583}
confusion matrix:
       0  1
0  18170  1
1    601  1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.8356141, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327286_16.png
early stop counter: 15
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 16,now: 2024-06-16 17:13:59.360429,epoch time: 0:15:56.138290,used: 4:19:21.450337,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_12_54_37_seed_2_21327286
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.96561646, 'precision': 0.77369463, 'recall': 0.5080489, 'specificity': 0.5080489, 'f1': 0.5073155, 'auroc': 0.86908984, 'binary_precision': 0.5813953, 'binary_recall': 0.016523464, 'binary_specificity': 0.99957436, 'binary_f1_score': 0.032133676}
confusion matrix:
       0   1
0  42269  18
1   1488  25
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.73399127, 'recall': 0.50080305, 'specificity': 0.50080305, 'f1': 0.49350777, 'auroc': 0.8643732, 'binary_precision': 0.5, 'binary_recall': 0.0016611295, 'binary_specificity': 0.999945, 'binary_f1_score': 0.0033112583}
confusion matrix:
       0  1
0  18170  1
1    601  1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.838912, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327286_17.png
early stop counter: 16
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 17,now: 2024-06-16 17:29:43.425761,epoch time: 0:15:44.065332,used: 4:35:05.515669,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_12_54_37_seed_2_21327286
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9655251, 'precision': 0.7439822, 'recall': 0.5115067, 'specificity': 0.5115067, 'f1': 0.5139787, 'auroc': 0.880298, 'binary_precision': 0.5217391, 'binary_recall': 0.023793787, 'binary_specificity': 0.9992196, 'binary_f1_score': 0.04551201}
confusion matrix:
       0   1
0  42254  33
1   1477  36
---- Validation: 
scalar performance:
{'acc': 0.9678794, 'precision': 0.68401533, 'recall': 0.50157857, 'specificity': 0.50157857, 'f1': 0.4951328, 'auroc': 0.8719928, 'binary_precision': 0.4, 'binary_recall': 0.003322259, 'binary_specificity': 0.9998349, 'binary_f1_score': 0.006589785}
confusion matrix:
       0  1
0  18168  3
1    600  2
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9616926, 'precision': 0.9808371, 'recall': 0.50619835, 'specificity': 0.50619835, 'f1': 0.5024762, 'auroc': 0.84426653, 'binary_precision': 1.0, 'binary_recall': 0.012396694, 'binary_specificity': 1.0, 'binary_f1_score': 0.024489796}
confusion matrix:
      0  1
0  5997  0
1   239  3
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327286_18.png
new oracle model saved
early stop counter: 17
val acc:0.9678794145584106, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9616925716400146
after epoch: 18,now: 2024-06-16 17:45:19.645736,epoch time: 0:15:36.219975,used: 4:50:41.735644,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_12_54_37_seed_2_21327286
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9653881, 'precision': 0.723638, 'recall': 0.51207304, 'specificity': 0.51207304, 'f1': 0.5150562, 'auroc': 0.8789269, 'binary_precision': 0.48101267, 'binary_recall': 0.025115665, 'binary_specificity': 0.9990304, 'binary_f1_score': 0.047738697}
confusion matrix:
       0   1
0  42246  41
1   1475  38
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.7340411, 'recall': 0.50240916, 'specificity': 0.50240916, 'f1': 0.4967854, 'auroc': 0.8738339, 'binary_precision': 0.5, 'binary_recall': 0.004983389, 'binary_specificity': 0.9998349, 'binary_f1_score': 0.009868422}
confusion matrix:
       0  1
0  18168  3
1    599  3
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9616926, 'precision': 0.9808371, 'recall': 0.50619835, 'specificity': 0.50619835, 'f1': 0.5024762, 'auroc': 0.84534585, 'binary_precision': 1.0, 'binary_recall': 0.012396694, 'binary_specificity': 1.0, 'binary_f1_score': 0.024489796}
confusion matrix:
      0  1
0  5997  0
1   239  3
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327286_19.png
early stop counter: 18
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9616925716400146
after epoch: 19,now: 2024-06-16 18:00:55.200507,epoch time: 0:15:35.554771,used: 5:06:17.290415,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_12_54_37_seed_2_21327286
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.96577626, 'precision': 0.7533673, 'recall': 0.5263067, 'specificity': 0.5263067, 'f1': 0.54058695, 'auroc': 0.88158506, 'binary_precision': 0.5394737, 'binary_recall': 0.054268695, 'binary_specificity': 0.9983447, 'binary_f1_score': 0.09861695}
confusion matrix:
       0   1
0  42219  70
1   1429  82
---- Validation: 
scalar performance:
{'acc': 0.9680925, 'precision': 0.77833605, 'recall': 0.508113, 'specificity': 0.508113, 'f1': 0.5080445, 'auroc': 0.878567, 'binary_precision': 0.5882353, 'binary_recall': 0.016611295, 'binary_specificity': 0.9996148, 'binary_f1_score': 0.032310177}
confusion matrix:
       0   1
0  18164   7
1    592  10
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.962494, 'precision': 0.9812229, 'recall': 0.5165289, 'specificity': 0.5165289, 'f1': 0.5224318, 'auroc': 0.85214645, 'binary_precision': 1.0, 'binary_recall': 0.03305785, 'binary_specificity': 1.0, 'binary_f1_score': 0.064}
confusion matrix:
      0  1
0  5997  0
1   234  8
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327286_20.png
new oracle model saved
better model found
persisted
after epoch: 20,now: 2024-06-16 18:16:28.131605,epoch time: 0:15:32.931098,used: 5:21:50.221513,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_12_54_37_seed_2_21327286
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9659589, 'precision': 0.76648855, 'recall': 0.53053147, 'specificity': 0.53053147, 'f1': 0.5478372, 'auroc': 0.8903867, 'binary_precision': 0.5654762, 'binary_recall': 0.06278916, 'binary_specificity': 0.99827373, 'binary_f1_score': 0.11302795}
confusion matrix:
       0   1
0  42214  73
1   1418  95
---- Validation: 
scalar performance:
{'acc': 0.9680925, 'precision': 0.76998264, 'recall': 0.50971913, 'specificity': 0.50971913, 'f1': 0.5111501, 'auroc': 0.8799088, 'binary_precision': 0.5714286, 'binary_recall': 0.019933555, 'binary_specificity': 0.9995047, 'binary_f1_score': 0.03852327}
confusion matrix:
       0   1
0  18162   9
1    590  12
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96281457, 'precision': 0.9813774, 'recall': 0.5206612, 'specificity': 0.5206612, 'f1': 0.5301945, 'auroc': 0.85540134, 'binary_precision': 1.0, 'binary_recall': 0.041322313, 'binary_specificity': 1.0, 'binary_f1_score': 0.079365075}
confusion matrix:
      0   1
0  5997   0
1   232  10
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327286_21.png
new oracle model saved
early stop counter: 1
val acc:0.9680925011634827, best validation acc: 0.9680925011634827, corresponding to test acc:                         0.9624940156936646 / 0.9628145694732666
after epoch: 21,now: 2024-06-16 18:31:58.595750,epoch time: 0:15:30.464145,used: 5:37:20.685658,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_12_54_37_seed_2_21327286
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.96575344, 'precision': 0.7483325, 'recall': 0.5383911, 'specificity': 0.5383911, 'f1': 0.5602303, 'auroc': 0.9013724, 'binary_precision': 0.52863437, 'binary_recall': 0.07931262, 'binary_specificity': 0.99746966, 'binary_f1_score': 0.13793103}
confusion matrix:
       0    1
0  42180  107
1   1393  120
---- Validation: 
scalar performance:
{'acc': 0.9681457, 'precision': 0.76081, 'recall': 0.5169741, 'specificity': 0.5169741, 'f1': 0.52471083, 'auroc': 0.88702154, 'binary_precision': 0.55263156, 'binary_recall': 0.034883723, 'binary_specificity': 0.99906445, 'binary_f1_score': 0.065625004}
confusion matrix:
       0   1
0  18154  17
1    581  21
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96377623, 'precision': 0.98184156, 'recall': 0.53305787, 'specificity': 0.53305787, 'f1': 0.55276835, 'auroc': 0.8617041, 'binary_precision': 1.0, 'binary_recall': 0.0661157, 'binary_specificity': 1.0, 'binary_f1_score': 0.124031}
confusion matrix:
      0   1
0  5997   0
1   226  16
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327286_22.png
new oracle model saved
better model found
persisted
after epoch: 22,now: 2024-06-16 18:47:30.325624,epoch time: 0:15:31.729874,used: 5:52:52.415532,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_12_54_37_seed_2_21327286
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.96568495, 'precision': 0.7407094, 'recall': 0.54446584, 'specificity': 0.54446584, 'f1': 0.5692892, 'auroc': 0.8960546, 'binary_precision': 0.51291513, 'binary_recall': 0.09205298, 'binary_specificity': 0.9968787, 'binary_f1_score': 0.15609209}
confusion matrix:
       0    1
0  42158  132
1   1371  139
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.7345661, 'recall': 0.51927316, 'specificity': 0.51927316, 'f1': 0.528765, 'auroc': 0.89065564, 'binary_precision': 0.5, 'binary_recall': 0.03986711, 'binary_specificity': 0.9986792, 'binary_f1_score': 0.073846154}
confusion matrix:
       0   1
0  18147  24
1    578  24
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96473795, 'precision': 0.9823066, 'recall': 0.54545456, 'specificity': 0.54545456, 'f1': 0.57432723, 'auroc': 0.863888, 'binary_precision': 1.0, 'binary_recall': 0.09090909, 'binary_specificity': 1.0, 'binary_f1_score': 0.16666667}
confusion matrix:
      0   1
0  5997   0
1   220  22
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327286_23.png
new oracle model saved
early stop counter: 1
val acc:0.9679326415061951, best validation acc: 0.9681457281112671, corresponding to test acc:                         0.9637762308120728 / 0.9647379517555237
after epoch: 23,now: 2024-06-16 19:03:04.295627,epoch time: 0:15:33.970003,used: 6:08:26.385535,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_12_54_37_seed_2_21327286
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9654566, 'precision': 0.7333471, 'recall': 0.54462916, 'specificity': 0.54462916, 'f1': 0.5692651, 'auroc': 0.8918464, 'binary_precision': 0.49822065, 'binary_recall': 0.09259259, 'binary_specificity': 0.9966657, 'binary_f1_score': 0.15616286}
confusion matrix:
       0    1
0  42147  141
1   1372  140
---- Validation: 
scalar performance:
{'acc': 0.9681457, 'precision': 0.7539004, 'recall': 0.5225954, 'specificity': 0.5225954, 'f1': 0.5347087, 'auroc': 0.88978887, 'binary_precision': 0.53846157, 'binary_recall': 0.046511628, 'binary_specificity': 0.9986792, 'binary_f1_score': 0.08562691}
confusion matrix:
       0   1
0  18147  24
1    574  28
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645777, 'precision': 0.982229, 'recall': 0.5433884, 'specificity': 0.5433884, 'f1': 0.5708017, 'auroc': 0.8628998, 'binary_precision': 1.0, 'binary_recall': 0.08677686, 'binary_specificity': 1.0, 'binary_f1_score': 0.15969582}
confusion matrix:
      0   1
0  5997   0
1   221  21
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327286_24.png
early stop counter: 2
val acc:0.9681457281112671, best validation acc: 0.9681457281112671, corresponding to test acc:                         0.9637762308120728 / 0.9647379517555237
after epoch: 24,now: 2024-06-16 19:18:41.371498,epoch time: 0:15:37.075871,used: 6:24:03.461406,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_12_54_37_seed_2_21327286
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.96593606, 'precision': 0.7506547, 'recall': 0.5556926, 'specificity': 0.5556926, 'f1': 0.5858666, 'auroc': 0.9006369, 'binary_precision': 0.5321101, 'binary_recall': 0.1150033, 'binary_specificity': 0.9963819, 'binary_f1_score': 0.18913044}
confusion matrix:
       0    1
0  42134  153
1   1339  174
---- Validation: 
scalar performance:
{'acc': 0.9681457, 'precision': 0.7539004, 'recall': 0.5225954, 'specificity': 0.5225954, 'f1': 0.5347087, 'auroc': 0.891794, 'binary_precision': 0.53846157, 'binary_recall': 0.046511628, 'binary_specificity': 0.9986792, 'binary_f1_score': 0.08562691}
confusion matrix:
       0   1
0  18147  24
1    574  28
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9648982, 'precision': 0.9823842, 'recall': 0.54752064, 'specificity': 0.54752064, 'f1': 0.57782656, 'auroc': 0.86296177, 'binary_precision': 1.0, 'binary_recall': 0.09504132, 'binary_specificity': 1.0, 'binary_f1_score': 0.17358491}
confusion matrix:
      0   1
0  5997   0
1   219  23
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327286_25.png
new oracle model saved
early stop counter: 3
val acc:0.9681457281112671, best validation acc: 0.9681457281112671, corresponding to test acc:                         0.9637762308120728 / 0.9648982286453247
after epoch: 25,now: 2024-06-16 19:34:15.802798,epoch time: 0:15:34.431300,used: 6:39:37.892706,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_12_54_37_seed_2_21327286
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.96593606, 'precision': 0.74946755, 'recall': 0.56047225, 'specificity': 0.56047225, 'f1': 0.59236777, 'auroc': 0.9026747, 'binary_precision': 0.5294118, 'binary_recall': 0.12491738, 'binary_specificity': 0.9960272, 'binary_f1_score': 0.20213902}
confusion matrix:
       0    1
0  42119  168
1   1324  189
---- Validation: 
scalar performance:
{'acc': 0.9682523, 'precision': 0.75759923, 'recall': 0.52907485, 'specificity': 0.52907485, 'f1': 0.54581153, 'auroc': 0.8940086, 'binary_precision': 0.54545456, 'binary_recall': 0.059800666, 'binary_specificity': 0.998349, 'binary_f1_score': 0.10778443}
confusion matrix:
       0   1
0  18141  30
1    566  36
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9658599, 'precision': 0.98285025, 'recall': 0.55991733, 'specificity': 0.55991733, 'f1': 0.59828657, 'auroc': 0.86568815, 'binary_precision': 1.0, 'binary_recall': 0.11983471, 'binary_specificity': 1.0, 'binary_f1_score': 0.21402216}
confusion matrix:
      0   1
0  5997   0
1   213  29
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327286_26.png
new oracle model saved
better model found
persisted
after epoch: 26,now: 2024-06-16 19:50:48.528997,epoch time: 0:16:32.726199,used: 6:56:10.618905,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_12_54_37_seed_2_21327286
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9656621, 'precision': 0.7399597, 'recall': 0.56450516, 'specificity': 0.56450516, 'f1': 0.5970944, 'auroc': 0.8996198, 'binary_precision': 0.510101, 'binary_recall': 0.13359788, 'binary_specificity': 0.9954124, 'binary_f1_score': 0.21174002}
confusion matrix:
       0    1
0  42094  194
1   1310  202
---- Validation: 
scalar performance:
{'acc': 0.9677196, 'precision': 0.72050285, 'recall': 0.52639055, 'specificity': 0.52639055, 'f1': 0.54089, 'auroc': 0.89444077, 'binary_precision': 0.47142857, 'binary_recall': 0.054817274, 'binary_specificity': 0.9979638, 'binary_f1_score': 0.09821429}
confusion matrix:
       0   1
0  18134  37
1    569  33
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9658599, 'precision': 0.98285025, 'recall': 0.55991733, 'specificity': 0.55991733, 'f1': 0.59828657, 'auroc': 0.8659033, 'binary_precision': 1.0, 'binary_recall': 0.11983471, 'binary_specificity': 1.0, 'binary_f1_score': 0.21402216}
confusion matrix:
      0   1
0  5997   0
1   213  29
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327286_27.png
early stop counter: 1
val acc:0.9677196145057678, best validation acc: 0.9682523012161255, corresponding to test acc:                         0.9658598899841309 / 0.9658598899841309
after epoch: 27,now: 2024-06-16 20:07:21.614305,epoch time: 0:16:33.085308,used: 7:12:43.704213,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_12_54_37_seed_2_21327286
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9657078, 'precision': 0.7427943, 'recall': 0.5552557, 'specificity': 0.5552557, 'f1': 0.58485687, 'auroc': 0.9043647, 'binary_precision': 0.5164179, 'binary_recall': 0.11434237, 'binary_specificity': 0.99616903, 'binary_f1_score': 0.18722944}
confusion matrix:
       0    1
0  42125  162
1   1340  173
---- Validation: 
scalar performance:
{'acc': 0.9679859, 'precision': 0.73863876, 'recall': 0.5265281, 'specificity': 0.5265281, 'f1': 0.541327, 'auroc': 0.8958968, 'binary_precision': 0.50769234, 'binary_recall': 0.054817274, 'binary_specificity': 0.998239, 'binary_f1_score': 0.09895053}
confusion matrix:
       0   1
0  18139  32
1    569  33
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9663408, 'precision': 0.9830836, 'recall': 0.5661157, 'specificity': 0.5661157, 'f1': 0.6081846, 'auroc': 0.86645645, 'binary_precision': 1.0, 'binary_recall': 0.1322314, 'binary_specificity': 1.0, 'binary_f1_score': 0.23357664}
confusion matrix:
      0   1
0  5997   0
1   210  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327286_28.png
new oracle model saved
early stop counter: 2
val acc:0.9679859280586243, best validation acc: 0.9682523012161255, corresponding to test acc:                         0.9658598899841309 / 0.9663407802581787
after epoch: 28,now: 2024-06-16 20:23:52.436281,epoch time: 0:16:30.821976,used: 7:29:14.526189,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_12_54_37_seed_2_21327286
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.96531963, 'precision': 0.7305183, 'recall': 0.56305236, 'specificity': 0.56305236, 'f1': 0.5945304, 'auroc': 0.9064795, 'binary_precision': 0.49131513, 'binary_recall': 0.13095239, 'binary_specificity': 0.9951523, 'binary_f1_score': 0.20678854}
confusion matrix:
       0    1
0  42083  205
1   1314  198
---- Validation: 
scalar performance:
{'acc': 0.9680392, 'precision': 0.7412444, 'recall': 0.53298, 'specificity': 0.53298, 'f1': 0.5519793, 'auroc': 0.8972378, 'binary_precision': 0.5125, 'binary_recall': 0.06810631, 'binary_specificity': 0.9978537, 'binary_f1_score': 0.12023461}
confusion matrix:
       0   1
0  18132  39
1    561  41
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9663408, 'precision': 0.9830836, 'recall': 0.5661157, 'specificity': 0.5661157, 'f1': 0.6081846, 'auroc': 0.86626905, 'binary_precision': 1.0, 'binary_recall': 0.1322314, 'binary_specificity': 1.0, 'binary_f1_score': 0.23357664}
confusion matrix:
      0   1
0  5997   0
1   210  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327286_29.png
early stop counter: 3
val acc:0.9680392146110535, best validation acc: 0.9682523012161255, corresponding to test acc:                         0.9658598899841309 / 0.9663407802581787
after epoch: 29,now: 2024-06-16 20:40:24.831441,epoch time: 0:16:32.395160,used: 7:45:46.921349,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_12_54_37_seed_2_21327286
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.96561646, 'precision': 0.73915815, 'recall': 0.56922877, 'specificity': 0.56922877, 'f1': 0.60306513, 'auroc': 0.90765697, 'binary_precision': 0.5081967, 'binary_recall': 0.14342366, 'binary_specificity': 0.9950339, 'binary_f1_score': 0.22371134}
confusion matrix:
       0    1
0  42077  210
1   1296  217
---- Validation: 
scalar performance:
{'acc': 0.9680925, 'precision': 0.7435479, 'recall': 0.53702277, 'specificity': 0.53702277, 'f1': 0.5584437, 'auroc': 0.8999871, 'binary_precision': 0.5168539, 'binary_recall': 0.07641196, 'binary_specificity': 0.9976336, 'binary_f1_score': 0.13314037}
confusion matrix:
       0   1
0  18128  43
1    556  46
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9661805, 'precision': 0.98300576, 'recall': 0.5640496, 'specificity': 0.5640496, 'f1': 0.6049091, 'auroc': 0.8707067, 'binary_precision': 1.0, 'binary_recall': 0.12809917, 'binary_specificity': 1.0, 'binary_f1_score': 0.22710621}
confusion matrix:
      0   1
0  5997   0
1   211  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327286_30.png
early stop counter: 4
val acc:0.9680925011634827, best validation acc: 0.9682523012161255, corresponding to test acc:                         0.9658598899841309 / 0.9663407802581787
after epoch: 30,now: 2024-06-16 20:56:49.088499,epoch time: 0:16:24.257058,used: 8:02:11.178407,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_12_54_37_seed_2_21327286
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 8:02:11.178407 at 2024-06-16 20:56:49.088499
persisted model performance metric: 

scalar performance:
{'acc': 0.9658599, 'precision': 0.98285025, 'recall': 0.55991733, 'specificity': 0.55991733, 'f1': 0.59828657, 'auroc': 0.86568815, 'binary_precision': 1.0, 'binary_recall': 0.11983471, 'binary_specificity': 1.0, 'binary_f1_score': 0.21402216}
confusion matrix:
      0   1
0  5997   0
1   213  29
oracle model performance metric: 

scalar performance:
{'acc': 0.9663408, 'precision': 0.9830836, 'recall': 0.5661157, 'specificity': 0.5661157, 'f1': 0.6081846, 'auroc': 0.86645645, 'binary_precision': 1.0, 'binary_recall': 0.1322314, 'binary_specificity': 1.0, 'binary_f1_score': 0.23357664}
confusion matrix:
      0   1
0  5997   0
1   210  32
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_bs16_different_batchsizes/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_resnet_bs16_different_batchsizes/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204178 KiB |   1436 MiB |   1067 TiB |   1067 TiB |
|       from large pool | 167936 KiB |   1366 MiB |   1067 TiB |   1067 TiB |
|       from small pool |  36242 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 204178 KiB |   1436 MiB |   1067 TiB |   1067 TiB |
|       from large pool | 167936 KiB |   1366 MiB |   1067 TiB |   1067 TiB |
|       from small pool |  36242 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201087 KiB |   1428 MiB |   1067 TiB |   1067 TiB |
|       from large pool | 165120 KiB |   1358 MiB |   1067 TiB |   1067 TiB |
|       from small pool |  35967 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1466 MiB |   1524 MiB |   3432 MiB |   1966 MiB |
|       from large pool |   1392 MiB |   1450 MiB |   3298 MiB |   1906 MiB |
|       from small pool |     74 MiB |     74 MiB |    134 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 320109 KiB | 749313 KiB |    824 TiB |    824 TiB |
|       from large pool | 311296 KiB | 748328 KiB |    823 TiB |    823 TiB |
|       from small pool |   8813 KiB |  16408 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    1278    |    1935    |   36066 K  |   36065 K  |
|       from large pool |      36    |      76    |   14350 K  |   14350 K  |
|       from small pool |    1242    |    1864    |   21716 K  |   21715 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1278    |    1935    |   36066 K  |   36065 K  |
|       from large pool |      36    |      76    |   14350 K  |   14350 K  |
|       from small pool |    1242    |    1864    |   21716 K  |   21715 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      49    |      50    |      86    |      37    |
|       from large pool |      12    |      13    |      19    |       7    |
|       from small pool |      37    |      37    |      67    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      35    |     453    |   20280 K  |   20280 K  |
|       from large pool |       5    |      11    |    5692 K  |    5692 K  |
|       from small pool |      30    |     448    |   14587 K  |   14587 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1436 MiB |   1067 TiB |   1067 TiB |
|       from large pool |  16640 KiB |   1366 MiB |   1067 TiB |   1067 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1436 MiB |   1067 TiB |   1067 TiB |
|       from large pool |  16640 KiB |   1366 MiB |   1067 TiB |   1067 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1428 MiB |   1067 TiB |   1067 TiB |
|       from large pool |  16640 KiB |   1358 MiB |   1067 TiB |   1067 TiB |
|       from small pool |      0 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 524288 KiB |   1524 MiB |   3432 MiB |   2920 MiB |
|       from large pool | 479232 KiB |   1450 MiB |   3298 MiB |   2830 MiB |
|       from small pool |  45056 KiB |     74 MiB |    134 MiB |     90 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 298752 KiB | 749313 KiB |    824 TiB |    824 TiB |
|       from large pool | 298752 KiB | 748328 KiB |    823 TiB |    823 TiB |
|       from small pool |      0 KiB |  16408 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1935    |   36066 K  |   36066 K  |
|       from large pool |       2    |      76    |   14350 K  |   14350 K  |
|       from small pool |       0    |    1864    |   21716 K  |   21716 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1935    |   36066 K  |   36066 K  |
|       from large pool |       2    |      76    |   14350 K  |   14350 K  |
|       from small pool |       0    |    1864    |   21716 K  |   21716 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      50    |      86    |      55    |
|       from large pool |       9    |      13    |      19    |      10    |
|       from small pool |      22    |      37    |      67    |      45    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     453    |   20280 K  |   20280 K  |
|       from large pool |       1    |      11    |    5692 K  |    5692 K  |
|       from small pool |       0    |     448    |   14588 K  |   14588 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

