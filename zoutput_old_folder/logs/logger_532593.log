Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0




!!!: not committed yet



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512113

 Experiment start at: 2024-06-19 23:10:44.364844
before training, model accuracy: 0.31128156185150146
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9437714, 'precision': 0.96704996, 'recall': 0.70391154, 'specificity': 0.70391154, 'f1': 0.7741376, 'auroc': 0.94791716, 'binary_precision': 0.99229074, 'binary_recall': 0.408154, 'binary_specificity': 0.9996691, 'binary_f1_score': 0.57839835}
confusion matrix:
       0     1
0  42291    14
1   2613  1802
---- Validation: 
scalar performance:
{'acc': 0.9656769, 'precision': 0.48288983, 'recall': 0.4999449, 'specificity': 0.4999449, 'f1': 0.49126938, 'auroc': 0.5324156, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998898, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18147  2
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.5555532, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512113_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-19 23:29:14.037065,epoch time: 0:18:29.672221,used: 0:18:29.672221,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512113
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9694992, 'precision': 0.980772, 'recall': 0.8405095, 'specificity': 0.8405095, 'f1': 0.89596176, 'auroc': 0.97540236, 'binary_precision': 0.99372315, 'binary_recall': 0.68146807, 'binary_specificity': 0.9995509, 'binary_f1_score': 0.8084935}
confusion matrix:
       0     1
0  42287    19
1   1406  3008
---- Validation: 
scalar performance:
{'acc': 0.9665815, 'precision': 0.8072549, 'recall': 0.5251651, 'specificity': 0.5251651, 'f1': 0.53903866, 'auroc': 0.64000607, 'binary_precision': 0.64705884, 'binary_recall': 0.051321927, 'binary_specificity': 0.99900824, 'binary_f1_score': 0.095100865}
confusion matrix:
       0   1
0  18131  18
1    610  33
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9576542, 'precision': 0.6914807, 'recall': 0.5198222, 'specificity': 0.5198222, 'f1': 0.52749264, 'auroc': 0.6883998, 'binary_precision': 0.42307693, 'binary_recall': 0.042145595, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.07665505}
confusion matrix:
      0   1
0  5982  15
1   250  11
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512113_2.png
better model found
persisted
after epoch: 2,now: 2024-06-19 23:46:21.978921,epoch time: 0:17:07.941856,used: 0:35:37.614077,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512113
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9785745, 'precision': 0.982128, 'recall': 0.8914074, 'specificity': 0.8914074, 'f1': 0.93092936, 'auroc': 0.9832896, 'binary_precision': 0.9863092, 'binary_recall': 0.7839492, 'binary_specificity': 0.9988655, 'binary_f1_score': 0.8735632}
confusion matrix:
       0     1
0  42261    48
1    953  3458
---- Validation: 
scalar performance:
{'acc': 0.966688, 'precision': 0.76628613, 'recall': 0.5574725, 'specificity': 0.5574725, 'f1': 0.5891823, 'auroc': 0.69284743, 'binary_precision': 0.56296295, 'binary_recall': 0.11819596, 'binary_specificity': 0.9967491, 'binary_f1_score': 0.19537275}
confusion matrix:
       0   1
0  18090  59
1    567  76
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959412, 'precision': 0.76223695, 'recall': 0.5592183, 'specificity': 0.5592183, 'f1': 0.5902174, 'auroc': 0.71843904, 'binary_precision': 0.5614035, 'binary_recall': 0.12260536, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.20125784}
confusion matrix:
      0   1
0  5972  25
1   229  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512113_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-20 00:05:07.195324,epoch time: 0:18:45.216403,used: 0:54:22.830480,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512113
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97992295, 'precision': 0.98296607, 'recall': 0.89859426, 'specificity': 0.89859426, 'f1': 0.9357693, 'auroc': 0.9862418, 'binary_precision': 0.9865584, 'binary_recall': 0.79832315, 'binary_specificity': 0.9988654, 'binary_f1_score': 0.882515}
confusion matrix:
       0     1
0  42259    48
1    890  3523
---- Validation: 
scalar performance:
{'acc': 0.9671669, 'precision': 0.7801775, 'recall': 0.564471, 'specificity': 0.564471, 'f1': 0.59962124, 'auroc': 0.7207184, 'binary_precision': 0.5902778, 'binary_recall': 0.13219285, 'binary_specificity': 0.9967491, 'binary_f1_score': 0.21601017}
confusion matrix:
       0   1
0  18090  59
1    558  85
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9600511, 'precision': 0.7834339, 'recall': 0.5595518, 'specificity': 0.5595518, 'f1': 0.5916666, 'auroc': 0.74069667, 'binary_precision': 0.6037736, 'binary_recall': 0.12260536, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.20382164}
confusion matrix:
      0   1
0  5976  21
1   229  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512113_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-20 00:22:21.762931,epoch time: 0:17:14.567607,used: 1:11:37.398087,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512113
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.982363, 'precision': 0.98244214, 'recall': 0.91329426, 'specificity': 0.91329426, 'f1': 0.94454336, 'auroc': 0.98991776, 'binary_precision': 0.98253626, 'binary_recall': 0.828125, 'binary_specificity': 0.9984635, 'binary_f1_score': 0.89874655}
confusion matrix:
       0     1
0  42239    65
1    759  3657
---- Validation: 
scalar performance:
{'acc': 0.9670072, 'precision': 0.7701118, 'recall': 0.57113886, 'specificity': 0.57113886, 'f1': 0.60790724, 'auroc': 0.7465934, 'binary_precision': 0.56969696, 'binary_recall': 0.14618973, 'binary_specificity': 0.99608797, 'binary_f1_score': 0.23267326}
confusion matrix:
       0   1
0  18078  71
1    549  94
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96196866, 'precision': 0.82367504, 'recall': 0.58070797, 'specificity': 0.58070797, 'f1': 0.62295556, 'auroc': 0.75942373, 'binary_precision': 0.6825397, 'binary_recall': 0.16475096, 'binary_specificity': 0.996665, 'binary_f1_score': 0.26543212}
confusion matrix:
      0   1
0  5977  20
1   218  43
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512113_5.png
new oracle model saved
early stop counter: 1
val acc:0.9670072197914124, best validation acc: 0.9671669006347656, corresponding to test acc:                         0.9600511193275452 / 0.9619686603546143
after epoch: 5,now: 2024-06-20 00:41:05.736694,epoch time: 0:18:43.973763,used: 1:30:21.371850,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512113
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98467463, 'precision': 0.98029983, 'recall': 0.9286723, 'specificity': 0.9286723, 'f1': 0.95265234, 'auroc': 0.98973465, 'binary_precision': 0.97505146, 'binary_recall': 0.8596372, 'binary_specificity': 0.9977074, 'binary_f1_score': 0.9137142}
confusion matrix:
       0     1
0  42213    97
1    619  3791
---- Validation: 
scalar performance:
{'acc': 0.9671669, 'precision': 0.76709807, 'recall': 0.5884727, 'specificity': 0.5884727, 'f1': 0.62908685, 'auroc': 0.76200056, 'binary_precision': 0.5625, 'binary_recall': 0.18195957, 'binary_specificity': 0.99498594, 'binary_f1_score': 0.27497065}
confusion matrix:
       0    1
0  18058   91
1    526  117
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96180886, 'precision': 0.80710244, 'recall': 0.5897863, 'specificity': 0.5897863, 'f1': 0.63347316, 'auroc': 0.76977825, 'binary_precision': 0.6486486, 'binary_recall': 0.18390805, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.28656715}
confusion matrix:
      0   1
0  5971  26
1   213  48
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512113_6.png
early stop counter: 2
val acc:0.9671669006347656, best validation acc: 0.9671669006347656, corresponding to test acc:                         0.9600511193275452 / 0.9619686603546143
after epoch: 6,now: 2024-06-20 00:57:19.193102,epoch time: 0:16:13.456408,used: 1:46:34.828258,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512113
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9858947, 'precision': 0.9819174, 'recall': 0.9344969, 'specificity': 0.9344969, 'f1': 0.95667124, 'auroc': 0.9900257, 'binary_precision': 0.97713417, 'binary_recall': 0.87112117, 'binary_specificity': 0.9978726, 'binary_f1_score': 0.92108727}
confusion matrix:
       0     1
0  42215    90
1    569  3846
---- Validation: 
scalar performance:
{'acc': 0.96737975, 'precision': 0.77043253, 'recall': 0.5938333, 'specificity': 0.5938333, 'f1': 0.6356723, 'auroc': 0.76588964, 'binary_precision': 0.56880736, 'binary_recall': 0.19284603, 'binary_specificity': 0.99482065, 'binary_f1_score': 0.28803715}
confusion matrix:
       0    1
0  18055   94
1    519  124
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96276766, 'precision': 0.82761526, 'recall': 0.59578353, 'specificity': 0.59578353, 'f1': 0.64267474, 'auroc': 0.7754189, 'binary_precision': 0.6891892, 'binary_recall': 0.1954023, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.30447763}
confusion matrix:
      0   1
0  5974  23
1   210  51
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512113_7.png
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-06-20 01:15:56.086354,epoch time: 0:18:36.893252,used: 2:05:11.721510,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512113
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9878639, 'precision': 0.9814187, 'recall': 0.94656956, 'specificity': 0.94656956, 'f1': 0.9631729, 'auroc': 0.99421465, 'binary_precision': 0.97361934, 'binary_recall': 0.89566797, 'binary_specificity': 0.9974711, 'binary_f1_score': 0.9330184}
confusion matrix:
       0     1
0  42204   107
1    460  3949
---- Validation: 
scalar performance:
{'acc': 0.9661558, 'precision': 0.7428514, 'recall': 0.6044505, 'specificity': 0.6044505, 'f1': 0.64340687, 'auroc': 0.7930385, 'binary_precision': 0.51291513, 'binary_recall': 0.21617419, 'binary_specificity': 0.99272686, 'binary_f1_score': 0.30415756}
confusion matrix:
       0    1
0  18017  132
1    504  139
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96212846, 'precision': 0.7916865, 'recall': 0.6192704, 'specificity': 0.6192704, 'f1': 0.66559017, 'auroc': 0.8022736, 'binary_precision': 0.61538464, 'binary_recall': 0.24521072, 'binary_specificity': 0.99333, 'binary_f1_score': 0.35068494}
confusion matrix:
      0   1
0  5957  40
1   197  64
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512113_8.png
early stop counter: 1
val acc:0.9661558270454407, best validation acc: 0.9673797488212585, corresponding to test acc:                         0.9627676606178284 / 0.9627676606178284
after epoch: 8,now: 2024-06-20 01:32:06.127721,epoch time: 0:16:10.041367,used: 2:21:21.762877,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512113
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9880137, 'precision': 0.98528206, 'recall': 0.9438579, 'specificity': 0.9438579, 'f1': 0.96341336, 'auroc': 0.9940501, 'binary_precision': 0.98198646, 'binary_recall': 0.88941765, 'binary_specificity': 0.99829817, 'binary_f1_score': 0.93341255}
confusion matrix:
       0     1
0  42235    72
1    488  3925
---- Validation: 
scalar performance:
{'acc': 0.9668476, 'precision': 0.75829196, 'recall': 0.59205776, 'specificity': 0.59205776, 'f1': 0.63223135, 'auroc': 0.7855684, 'binary_precision': 0.54464287, 'binary_recall': 0.18973562, 'binary_specificity': 0.9943799, 'binary_f1_score': 0.28143024}
confusion matrix:
       0    1
0  18047  102
1    521  122
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96228826, 'precision': 0.81032383, 'recall': 0.59919804, 'specificity': 0.59919804, 'f1': 0.645278, 'auroc': 0.7911844, 'binary_precision': 0.654321, 'binary_recall': 0.20306513, 'binary_specificity': 0.995331, 'binary_f1_score': 0.30994153}
confusion matrix:
      0   1
0  5969  28
1   208  53
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512113_9.png
early stop counter: 2
val acc:0.9668475985527039, best validation acc: 0.9673797488212585, corresponding to test acc:                         0.9627676606178284 / 0.9627676606178284
after epoch: 9,now: 2024-06-20 01:48:09.343170,epoch time: 0:16:03.215449,used: 2:37:24.978326,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512113
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9883348, 'precision': 0.9824981, 'recall': 0.9484217, 'specificity': 0.9484217, 'f1': 0.9646769, 'auroc': 0.9933145, 'binary_precision': 0.97542995, 'binary_recall': 0.89920723, 'binary_specificity': 0.9976362, 'binary_f1_score': 0.93576896}
confusion matrix:
       0     1
0  42205   100
1    445  3970
---- Validation: 
scalar performance:
{'acc': 0.96647507, 'precision': 0.74966526, 'recall': 0.5948651, 'specificity': 0.5948651, 'f1': 0.6342745, 'auroc': 0.79712605, 'binary_precision': 0.52719665, 'binary_recall': 0.19595645, 'binary_specificity': 0.99377376, 'binary_f1_score': 0.28571427}
confusion matrix:
       0    1
0  18036  113
1    517  126
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96228826, 'precision': 0.8184782, 'recall': 0.59186876, 'specificity': 0.59186876, 'f1': 0.6370202, 'auroc': 0.79603356, 'binary_precision': 0.6712329, 'binary_recall': 0.18773946, 'binary_specificity': 0.995998, 'binary_f1_score': 0.2934132}
confusion matrix:
      0   1
0  5973  24
1   212  49
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512113_10.png
early stop counter: 3
val acc:0.9664750695228577, best validation acc: 0.9673797488212585, corresponding to test acc:                         0.9627676606178284 / 0.9627676606178284
after epoch: 10,now: 2024-06-20 02:04:24.270428,epoch time: 0:16:14.927258,used: 2:53:39.905584,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512113
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9889983, 'precision': 0.98294514, 'recall': 0.95191133, 'specificity': 0.95191133, 'f1': 0.96678126, 'auroc': 0.9944762, 'binary_precision': 0.9756038, 'binary_recall': 0.9061863, 'binary_specificity': 0.9976363, 'binary_f1_score': 0.93961465}
confusion matrix:
       0     1
0  42207   100
1    414  3999
---- Validation: 
scalar performance:
{'acc': 0.96663475, 'precision': 0.7517595, 'recall': 0.6039484, 'specificity': 0.6039484, 'f1': 0.6442772, 'auroc': 0.7957679, 'binary_precision': 0.5307692, 'binary_recall': 0.21461898, 'binary_specificity': 0.99327785, 'binary_f1_score': 0.30564785}
confusion matrix:
       0    1
0  18027  122
1    505  138
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96180886, 'precision': 0.7986313, 'recall': 0.59894794, 'specificity': 0.59894794, 'f1': 0.6438047, 'auroc': 0.79332066, 'binary_precision': 0.63095236, 'binary_recall': 0.20306513, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.30724636}
confusion matrix:
      0   1
0  5966  31
1   208  53
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512113_11.png
early stop counter: 4
val acc:0.9666347503662109, best validation acc: 0.9673797488212585, corresponding to test acc:                         0.9627676606178284 / 0.9627676606178284
after epoch: 11,now: 2024-06-20 02:20:51.090240,epoch time: 0:16:26.819812,used: 3:10:06.725396,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512113
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98889124, 'precision': 0.98650384, 'recall': 0.94792914, 'specificity': 0.94792914, 'f1': 0.9662187, 'auroc': 0.9943372, 'binary_precision': 0.98361874, 'binary_recall': 0.8974185, 'binary_specificity': 0.99843985, 'binary_f1_score': 0.93854356}
confusion matrix:
       0     1
0  42238    66
1    453  3963
---- Validation: 
scalar performance:
{'acc': 0.96737975, 'precision': 0.77133, 'recall': 0.5915832, 'specificity': 0.5915832, 'f1': 0.63317555, 'auroc': 0.80252314, 'binary_precision': 0.5707547, 'binary_recall': 0.1881804, 'binary_specificity': 0.99498594, 'binary_f1_score': 0.28304094}
confusion matrix:
       0    1
0  18058   91
1    522  121
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96164906, 'precision': 0.81083274, 'recall': 0.58237356, 'specificity': 0.58237356, 'f1': 0.6243006, 'auroc': 0.7990731, 'binary_precision': 0.6567164, 'binary_recall': 0.16858238, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.2682927}
confusion matrix:
      0   1
0  5974  23
1   217  44
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512113_12.png
early stop counter: 5
val acc:0.9673797488212585, best validation acc: 0.9673797488212585, corresponding to test acc:                         0.9627676606178284 / 0.9627676606178284
after epoch: 12,now: 2024-06-20 02:35:46.852329,epoch time: 0:14:55.762089,used: 3:25:02.487485,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512113
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9901755, 'precision': 0.9835463, 'recall': 0.9583641, 'specificity': 0.9583641, 'f1': 0.9705318, 'auroc': 0.9958291, 'binary_precision': 0.9754808, 'binary_recall': 0.9191393, 'binary_specificity': 0.99758893, 'binary_f1_score': 0.9464723}
confusion matrix:
       0     1
0  42203   102
1    357  4058
---- Validation: 
scalar performance:
{'acc': 0.96674114, 'precision': 0.7538183, 'recall': 0.60400355, 'specificity': 0.60400355, 'f1': 0.64464426, 'auroc': 0.8080653, 'binary_precision': 0.53488374, 'binary_recall': 0.21461898, 'binary_specificity': 0.99338806, 'binary_f1_score': 0.30632633}
confusion matrix:
       0    1
0  18029  120
1    505  138
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96212846, 'precision': 0.7987561, 'recall': 0.60827637, 'specificity': 0.60827637, 'f1': 0.6545633, 'auroc': 0.80012023, 'binary_precision': 0.6304348, 'binary_recall': 0.22222222, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.32861188}
confusion matrix:
      0   1
0  5963  34
1   203  58
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512113_13.png
early stop counter: 6
val acc:0.966741144657135, best validation acc: 0.9673797488212585, corresponding to test acc:                         0.9627676606178284 / 0.9627676606178284
after epoch: 13,now: 2024-06-20 02:50:50.909973,epoch time: 0:15:04.057644,used: 3:40:06.545129,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512113
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9903895, 'precision': 0.9872395, 'recall': 0.9560382, 'specificity': 0.9560382, 'f1': 0.97099125, 'auroc': 0.995068, 'binary_precision': 0.9834187, 'binary_recall': 0.9136837, 'binary_specificity': 0.99839264, 'binary_f1_score': 0.94726956}
confusion matrix:
       0     1
0  42238    68
1    381  4033
---- Validation: 
scalar performance:
{'acc': 0.9667944, 'precision': 0.75849384, 'recall': 0.58602977, 'specificity': 0.58602977, 'f1': 0.6253089, 'auroc': 0.80568993, 'binary_precision': 0.54545456, 'binary_recall': 0.17729394, 'binary_specificity': 0.9947656, 'binary_f1_score': 0.26760563}
confusion matrix:
       0    1
0  18054   95
1    529  114
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9603707, 'precision': 0.78065896, 'recall': 0.57437724, 'specificity': 0.57437724, 'f1': 0.61177725, 'auroc': 0.79415476, 'binary_precision': 0.5970149, 'binary_recall': 0.1532567, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.24390243}
confusion matrix:
      0   1
0  5970  27
1   221  40
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512113_14.png
early stop counter: 7
val acc:0.9667943716049194, best validation acc: 0.9673797488212585, corresponding to test acc:                         0.9627676606178284 / 0.9627676606178284
after epoch: 14,now: 2024-06-20 03:05:42.296855,epoch time: 0:14:51.386882,used: 3:54:57.932011,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512113
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9894692, 'precision': 0.9834768, 'recall': 0.95421106, 'specificity': 0.95421106, 'f1': 0.9682701, 'auroc': 0.99534094, 'binary_precision': 0.976202, 'binary_recall': 0.9107386, 'binary_specificity': 0.9976835, 'binary_f1_score': 0.9423348}
confusion matrix:
       0     1
0  42208    98
1    394  4020
---- Validation: 
scalar performance:
{'acc': 0.96663475, 'precision': 0.75204647, 'recall': 0.6016983, 'specificity': 0.6016983, 'f1': 0.6419564, 'auroc': 0.8098013, 'binary_precision': 0.53149605, 'binary_recall': 0.20995334, 'binary_specificity': 0.9934432, 'binary_f1_score': 0.30100337}
confusion matrix:
       0    1
0  18030  119
1    508  135
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.7637686, 'recall': 0.5832888, 'specificity': 0.5832888, 'f1': 0.6216568, 'auroc': 0.7887621, 'binary_precision': 0.5625, 'binary_recall': 0.1724138, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.2639296}
confusion matrix:
      0   1
0  5962  35
1   216  45
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512113_15.png
early stop counter: 8
val acc:0.9666347503662109, best validation acc: 0.9673797488212585, corresponding to test acc:                         0.9627676606178284 / 0.9627676606178284
after epoch: 15,now: 2024-06-20 03:21:49.180366,epoch time: 0:16:06.883511,used: 4:11:04.815522,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512113
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9904752, 'precision': 0.9867623, 'recall': 0.95698905, 'specificity': 0.95698905, 'f1': 0.97128606, 'auroc': 0.99475515, 'binary_precision': 0.9822557, 'binary_recall': 0.9157036, 'binary_specificity': 0.9982745, 'binary_f1_score': 0.94781286}
confusion matrix:
       0     1
0  42234    73
1    372  4041
---- Validation: 
scalar performance:
{'acc': 0.9671137, 'precision': 0.76834154, 'recall': 0.5816947, 'specificity': 0.5816947, 'f1': 0.62108827, 'auroc': 0.80134314, 'binary_precision': 0.565445, 'binary_recall': 0.16796267, 'binary_specificity': 0.9954268, 'binary_f1_score': 0.2589928}
confusion matrix:
       0    1
0  18066   83
1    535  108
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9592522, 'precision': 0.7558753, 'recall': 0.5627996, 'specificity': 0.5627996, 'f1': 0.5948064, 'auroc': 0.7813838, 'binary_precision': 0.5483871, 'binary_recall': 0.1302682, 'binary_specificity': 0.995331, 'binary_f1_score': 0.21052632}
confusion matrix:
      0   1
0  5969  28
1   227  34
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512113_16.png
early stop counter: 9
val acc:0.9671136736869812, best validation acc: 0.9673797488212585, corresponding to test acc:                         0.9627676606178284 / 0.9627676606178284
after epoch: 16,now: 2024-06-20 03:37:06.499738,epoch time: 0:15:17.319372,used: 4:26:22.134894,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512113
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99058217, 'precision': 0.98693883, 'recall': 0.9574635, 'specificity': 0.9574635, 'f1': 0.9716237, 'auroc': 0.99551415, 'binary_precision': 0.9825158, 'binary_recall': 0.9166289, 'binary_specificity': 0.9982981, 'binary_f1_score': 0.94842947}
confusion matrix:
       0     1
0  42234    72
1    368  4046
---- Validation: 
scalar performance:
{'acc': 0.966688, 'precision': 0.7549757, 'recall': 0.59047496, 'specificity': 0.59047496, 'f1': 0.6300437, 'auroc': 0.81744874, 'binary_precision': 0.5381166, 'binary_recall': 0.1866252, 'binary_specificity': 0.99432474, 'binary_f1_score': 0.27713627}
confusion matrix:
       0    1
0  18046  103
1    523  120
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9592522, 'precision': 0.75519407, 'recall': 0.56463194, 'specificity': 0.56463194, 'f1': 0.5972338, 'auroc': 0.80286294, 'binary_precision': 0.546875, 'binary_recall': 0.13409962, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.21538462}
confusion matrix:
      0   1
0  5968  29
1   226  35
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512113_17.png
early stop counter: 10
val acc:0.9666879773139954, best validation acc: 0.9673797488212585, corresponding to test acc:                         0.9627676606178284 / 0.9627676606178284
after epoch: 17,now: 2024-06-20 03:52:25.844503,epoch time: 0:15:19.344765,used: 4:41:41.479659,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512113
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99165237, 'precision': 0.98720586, 'recall': 0.96351707, 'specificity': 0.96351707, 'f1': 0.9749905, 'auroc': 0.9962127, 'binary_precision': 0.98179203, 'binary_recall': 0.92883044, 'binary_specificity': 0.99820364, 'binary_f1_score': 0.9545772}
confusion matrix:
       0     1
0  42232    76
1    314  4098
---- Validation: 
scalar performance:
{'acc': 0.96706045, 'precision': 0.76324624, 'recall': 0.5921679, 'specificity': 0.5921679, 'f1': 0.6329389, 'auroc': 0.81384003, 'binary_precision': 0.55454546, 'binary_recall': 0.18973562, 'binary_specificity': 0.99460024, 'binary_f1_score': 0.28273466}
confusion matrix:
       0    1
0  18051   98
1    521  122
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590924, 'precision': 0.7520958, 'recall': 0.5608839, 'specificity': 0.5608839, 'f1': 0.5919875, 'auroc': 0.7944294, 'binary_precision': 0.5409836, 'binary_recall': 0.12643678, 'binary_specificity': 0.995331, 'binary_f1_score': 0.20496894}
confusion matrix:
      0   1
0  5969  28
1   228  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512113_18.png
early stop counter: 11
val acc:0.9670604467391968, best validation acc: 0.9673797488212585, corresponding to test acc:                         0.9627676606178284 / 0.9627676606178284
after epoch: 18,now: 2024-06-20 04:07:17.917400,epoch time: 0:14:52.072897,used: 4:56:33.552556,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512113
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99195206, 'precision': 0.98844355, 'recall': 0.9641044, 'specificity': 0.9641044, 'f1': 0.97588325, 'auroc': 0.9964396, 'binary_precision': 0.98417264, 'binary_recall': 0.9297689, 'binary_specificity': 0.9984399, 'binary_f1_score': 0.95619756}
confusion matrix:
       0     1
0  42240    66
1    310  4104
---- Validation: 
scalar performance:
{'acc': 0.96706045, 'precision': 0.7646673, 'recall': 0.5876676, 'specificity': 0.5876676, 'f1': 0.62788457, 'auroc': 0.8177977, 'binary_precision': 0.5576923, 'binary_recall': 0.18040435, 'binary_specificity': 0.99493086, 'binary_f1_score': 0.27262044}
confusion matrix:
       0    1
0  18057   92
1    527  116
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.74350286, 'recall': 0.56071717, 'specificity': 0.56071717, 'f1': 0.59127116, 'auroc': 0.7979869, 'binary_precision': 0.52380955, 'binary_recall': 0.12643678, 'binary_specificity': 0.9949975, 'binary_f1_score': 0.2037037}
confusion matrix:
      0   1
0  5967  30
1   228  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512113_19.png
early stop counter: 12
val acc:0.9670604467391968, best validation acc: 0.9673797488212585, corresponding to test acc:                         0.9627676606178284 / 0.9627676606178284
after epoch: 19,now: 2024-06-20 04:22:20.387143,epoch time: 0:15:02.469743,used: 5:11:36.022299,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512113
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.990625, 'precision': 0.98845583, 'recall': 0.9562696, 'specificity': 0.9562696, 'f1': 0.97167504, 'auroc': 0.99622357, 'binary_precision': 0.985826, 'binary_recall': 0.91391027, 'binary_specificity': 0.99862903, 'binary_f1_score': 0.94850695}
confusion matrix:
       0     1
0  42248    58
1    380  4034
---- Validation: 
scalar performance:
{'acc': 0.96695405, 'precision': 0.76508534, 'recall': 0.57861185, 'specificity': 0.57861185, 'f1': 0.6170045, 'auroc': 0.8152562, 'binary_precision': 0.5591398, 'binary_recall': 0.16174184, 'binary_specificity': 0.99548185, 'binary_f1_score': 0.2509047}
confusion matrix:
       0    1
0  18067   82
1    539  104
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9592522, 'precision': 0.76015455, 'recall': 0.5536379, 'specificity': 0.5536379, 'f1': 0.5822035, 'auroc': 0.79031867, 'binary_precision': 0.5576923, 'binary_recall': 0.11111111, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.18530352}
confusion matrix:
      0   1
0  5974  23
1   232  29
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512113_20.png
early stop counter: 13
val acc:0.9669540524482727, best validation acc: 0.9673797488212585, corresponding to test acc:                         0.9627676606178284 / 0.9627676606178284
after epoch: 20,now: 2024-06-20 04:37:22.634528,epoch time: 0:15:02.247385,used: 5:26:38.269684,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512113
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9912029, 'precision': 0.9875494, 'recall': 0.96055436, 'specificity': 0.96055436, 'f1': 0.97356915, 'auroc': 0.99601877, 'binary_precision': 0.9831081, 'binary_recall': 0.9227633, 'binary_specificity': 0.9983454, 'binary_f1_score': 0.95198035}
confusion matrix:
       0     1
0  42235    70
1    341  4074
---- Validation: 
scalar performance:
{'acc': 0.96722007, 'precision': 0.7656043, 'recall': 0.5967509, 'specificity': 0.5967509, 'f1': 0.63839936, 'auroc': 0.82936794, 'binary_precision': 0.558952, 'binary_recall': 0.19906688, 'binary_specificity': 0.99443495, 'binary_f1_score': 0.293578}
confusion matrix:
       0    1
0  18048  101
1    515  128
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95733464, 'precision': 0.71006787, 'recall': 0.55813444, 'specificity': 0.55813444, 'f1': 0.58572066, 'auroc': 0.805979, 'binary_precision': 0.45714286, 'binary_recall': 0.12260536, 'binary_specificity': 0.9936635, 'binary_f1_score': 0.19335347}
confusion matrix:
      0   1
0  5959  38
1   229  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512113_21.png
early stop counter: 14
val acc:0.9672200679779053, best validation acc: 0.9673797488212585, corresponding to test acc:                         0.9627676606178284 / 0.9627676606178284
after epoch: 21,now: 2024-06-20 04:52:52.304455,epoch time: 0:15:29.669927,used: 5:42:07.939611,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512113
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99201626, 'precision': 0.9872304, 'recall': 0.96563154, 'specificity': 0.96563154, 'f1': 0.9761232, 'auroc': 0.9960684, 'binary_precision': 0.98139757, 'binary_recall': 0.9331066, 'binary_specificity': 0.9981565, 'binary_f1_score': 0.95664304}
confusion matrix:
       0     1
0  42232    78
1    295  4115
---- Validation: 
scalar performance:
{'acc': 0.9669008, 'precision': 0.75880027, 'recall': 0.5950855, 'specificity': 0.5950855, 'f1': 0.63569295, 'auroc': 0.8200687, 'binary_precision': 0.54545456, 'binary_recall': 0.19595645, 'binary_specificity': 0.99421453, 'binary_f1_score': 0.2883295}
confusion matrix:
       0    1
0  18044  105
1    517  126
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.739779, 'recall': 0.5569691, 'specificity': 0.5569691, 'f1': 0.5859541, 'auroc': 0.7936355, 'binary_precision': 0.51666665, 'binary_recall': 0.118773945, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.19314641}
confusion matrix:
      0   1
0  5968  29
1   230  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512113_22.png
early stop counter: 15
val acc:0.9669008255004883, best validation acc: 0.9673797488212585, corresponding to test acc:                         0.9627676606178284 / 0.9627676606178284
after epoch: 22,now: 2024-06-20 05:08:16.100475,epoch time: 0:15:23.796020,used: 5:57:31.735631,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512113
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9921019, 'precision': 0.9903245, 'recall': 0.963148, 'specificity': 0.963148, 'f1': 0.9762502, 'auroc': 0.9966469, 'binary_precision': 0.98816425, 'binary_recall': 0.9274541, 'binary_specificity': 0.9988419, 'binary_f1_score': 0.9568472}
confusion matrix:
       0     1
0  42260    49
1    320  4091
---- Validation: 
scalar performance:
{'acc': 0.9671137, 'precision': 0.7652408, 'recall': 0.5899453, 'specificity': 0.5899453, 'f1': 0.63060546, 'auroc': 0.8192288, 'binary_precision': 0.5586854, 'binary_recall': 0.18506998, 'binary_specificity': 0.99482065, 'binary_f1_score': 0.27803737}
confusion matrix:
       0    1
0  18055   94
1    524  119
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.7713144, 'recall': 0.5538047, 'specificity': 0.5538047, 'f1': 0.582883, 'auroc': 0.788951, 'binary_precision': 0.58, 'binary_recall': 0.11111111, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.18649518}
confusion matrix:
      0   1
0  5976  21
1   232  29
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512113_23.png
early stop counter: 16
val acc:0.9671136736869812, best validation acc: 0.9673797488212585, corresponding to test acc:                         0.9627676606178284 / 0.9627676606178284
after epoch: 23,now: 2024-06-20 05:23:36.056584,epoch time: 0:15:19.956109,used: 6:12:51.691740,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512113
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9922731, 'precision': 0.9893753, 'recall': 0.9650779, 'specificity': 0.9650779, 'f1': 0.9768381, 'auroc': 0.99731153, 'binary_precision': 0.98584795, 'binary_recall': 0.9315503, 'binary_specificity': 0.9986055, 'binary_f1_score': 0.9579303}
confusion matrix:
       0     1
0  42249    59
1    302  4110
---- Validation: 
scalar performance:
{'acc': 0.9670072, 'precision': 0.7640694, 'recall': 0.5853899, 'specificity': 0.5853899, 'f1': 0.6251316, 'auroc': 0.82255733, 'binary_precision': 0.5566502, 'binary_recall': 0.17573872, 'binary_specificity': 0.9950411, 'binary_f1_score': 0.26713946}
confusion matrix:
       0    1
0  18059   90
1    530  113
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589326, 'precision': 0.75365746, 'recall': 0.5443095, 'specificity': 0.5443095, 'f1': 0.56816524, 'auroc': 0.7954539, 'binary_precision': 0.54545456, 'binary_recall': 0.09195402, 'binary_specificity': 0.996665, 'binary_f1_score': 0.15737705}
confusion matrix:
      0   1
0  5977  20
1   237  24
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512113_24.png
early stop counter: 17
val acc:0.9670072197914124, best validation acc: 0.9673797488212585, corresponding to test acc:                         0.9627676606178284 / 0.9627676606178284
after epoch: 24,now: 2024-06-20 05:38:36.346389,epoch time: 0:15:00.289805,used: 6:27:51.981545,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512113
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9925942, 'precision': 0.99031025, 'recall': 0.9660672, 'specificity': 0.9660672, 'f1': 0.9778029, 'auroc': 0.99724936, 'binary_precision': 0.98753, 'binary_recall': 0.93336356, 'binary_specificity': 0.9987709, 'binary_f1_score': 0.95968306}
confusion matrix:
       0     1
0  42256    52
1    294  4118
---- Validation: 
scalar performance:
{'acc': 0.96722007, 'precision': 0.770312, 'recall': 0.584, 'specificity': 0.584, 'f1': 0.62407637, 'auroc': 0.82568, 'binary_precision': 0.5692308, 'binary_recall': 0.1726283, 'binary_specificity': 0.99537164, 'binary_f1_score': 0.26491648}
confusion matrix:
       0    1
0  18065   84
1    532  111
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.78139496, 'recall': 0.5558038, 'specificity': 0.5558038, 'f1': 0.5861803, 'auroc': 0.80096304, 'binary_precision': 0.6, 'binary_recall': 0.11494253, 'binary_specificity': 0.996665, 'binary_f1_score': 0.19292603}
confusion matrix:
      0   1
0  5977  20
1   231  30
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512113_25.png
early stop counter: 18
val acc:0.9672200679779053, best validation acc: 0.9673797488212585, corresponding to test acc:                         0.9627676606178284 / 0.9627676606178284
after epoch: 25,now: 2024-06-20 05:53:39.147040,epoch time: 0:15:02.800651,used: 6:42:54.782196,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512113
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9918664, 'precision': 0.9863188, 'recall': 0.9656805, 'specificity': 0.9656805, 'f1': 0.97571826, 'auroc': 0.9964783, 'binary_precision': 0.97955304, 'binary_recall': 0.9333938, 'binary_specificity': 0.9979672, 'binary_f1_score': 0.9559165}
confusion matrix:
       0     1
0  42220    86
1    294  4120
---- Validation: 
scalar performance:
{'acc': 0.96722007, 'precision': 0.7656043, 'recall': 0.5967509, 'specificity': 0.5967509, 'f1': 0.63839936, 'auroc': 0.82212543, 'binary_precision': 0.558952, 'binary_recall': 0.19906688, 'binary_specificity': 0.99443495, 'binary_f1_score': 0.293578}
confusion matrix:
       0    1
0  18048  101
1    515  128
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589326, 'precision': 0.7498209, 'recall': 0.5534712, 'specificity': 0.5534712, 'f1': 0.5815316, 'auroc': 0.79125535, 'binary_precision': 0.537037, 'binary_recall': 0.11111111, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.18412699}
confusion matrix:
      0   1
0  5972  25
1   232  29
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512113_26.png
early stop counter: 19
val acc:0.9672200679779053, best validation acc: 0.9673797488212585, corresponding to test acc:                         0.9627676606178284 / 0.9627676606178284
after epoch: 26,now: 2024-06-20 06:08:48.314566,epoch time: 0:15:09.167526,used: 6:58:03.949722,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512113
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9921447, 'precision': 0.98773086, 'recall': 0.96592057, 'specificity': 0.96592057, 'f1': 0.97651213, 'auroc': 0.9969356, 'binary_precision': 0.98235154, 'binary_recall': 0.93359023, 'binary_specificity': 0.9982509, 'binary_f1_score': 0.9573504}
confusion matrix:
       0     1
0  42234    74
1    293  4119
---- Validation: 
scalar performance:
{'acc': 0.96706045, 'precision': 0.7671719, 'recall': 0.5809171, 'specificity': 0.5809171, 'f1': 0.62002987, 'auroc': 0.82603765, 'binary_precision': 0.5631579, 'binary_recall': 0.16640747, 'binary_specificity': 0.9954268, 'binary_f1_score': 0.25690275}
confusion matrix:
       0    1
0  18066   83
1    536  107
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579738, 'precision': 0.71989346, 'recall': 0.5401446, 'specificity': 0.5401446, 'f1': 0.5608905, 'auroc': 0.79573613, 'binary_precision': 0.47826087, 'binary_recall': 0.08429119, 'binary_specificity': 0.995998, 'binary_f1_score': 0.14332247}
confusion matrix:
      0   1
0  5973  24
1   239  22
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512113_27.png
early stop counter: 20
val acc:0.9670604467391968, best validation acc: 0.9673797488212585, corresponding to test acc:                         0.9627676606178284 / 0.9627676606178284
after epoch: 27,now: 2024-06-20 06:23:37.907496,epoch time: 0:14:49.592930,used: 7:12:53.542652,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512113
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 27 with time: 7:12:53.542652 at 2024-06-20 06:23:37.907496
persisted model performance metric: 

scalar performance:
{'acc': 0.96276766, 'precision': 0.82761526, 'recall': 0.59578353, 'specificity': 0.59578353, 'f1': 0.64267474, 'auroc': 0.7754189, 'binary_precision': 0.6891892, 'binary_recall': 0.1954023, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.30447763}
confusion matrix:
      0   1
0  5974  23
1   210  51
oracle model performance metric: 

scalar performance:
{'acc': 0.96276766, 'precision': 0.82761526, 'recall': 0.59578353, 'specificity': 0.59578353, 'f1': 0.64267474, 'auroc': 0.7754189, 'binary_precision': 0.6891892, 'binary_recall': 0.1954023, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.30447763}
confusion matrix:
      0   1
0  5974  23
1   210  51
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_irm_resnet_different_bs128_lre4_classbalancing/rule_results/3.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_irm_resnet_different_bs128_lre4_classbalancing/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_irm_resnet_different_bs128_lre4_classbalancing/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204097 KiB |   1730 MiB | 340026 GiB | 340026 GiB |
|       from large pool | 167936 KiB |   1660 MiB | 339931 GiB | 339930 GiB |
|       from small pool |  36161 KiB |     72 MiB |     95 GiB |     95 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 204097 KiB |   1730 MiB | 340026 GiB | 340026 GiB |
|       from large pool | 167936 KiB |   1660 MiB | 339931 GiB | 339930 GiB |
|       from small pool |  36161 KiB |     72 MiB |     95 GiB |     95 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201088 KiB |   1723 MiB | 340012 GiB | 340011 GiB |
|       from large pool | 165120 KiB |   1653 MiB | 339918 GiB | 339917 GiB |
|       from small pool |  35968 KiB |     71 MiB |     93 GiB |     93 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1876 MiB |   1876 MiB |   1876 MiB |      0 B   |
|       from large pool |   1802 MiB |   1802 MiB |   1802 MiB |      0 B   |
|       from small pool |     74 MiB |     74 MiB |     74 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 404158 KiB | 758032 KiB | 239266 GiB | 239266 GiB |
|       from large pool | 397312 KiB | 756864 KiB | 239168 GiB | 239167 GiB |
|       from small pool |   6846 KiB |  12716 KiB |     98 GiB |     98 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1194    |    1851    |   10195 K  |   10194 K  |
|       from large pool |      36    |      76    |    3230 K  |    3230 K  |
|       from small pool |    1158    |    1780    |    6964 K  |    6963 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1194    |    1851    |   10195 K  |   10194 K  |
|       from large pool |      36    |      76    |    3230 K  |    3230 K  |
|       from small pool |    1158    |    1780    |    6964 K  |    6963 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      50    |      50    |      50    |       0    |
|       from large pool |      13    |      13    |      13    |       0    |
|       from small pool |      37    |      37    |      37    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      27    |     378    |    5106 K  |    5106 K  |
|       from large pool |       5    |      10    |    1218 K  |    1218 K  |
|       from small pool |      22    |     373    |    3888 K  |    3888 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1730 MiB | 340026 GiB | 340026 GiB |
|       from large pool |  16640 KiB |   1660 MiB | 339931 GiB | 339931 GiB |
|       from small pool |      0 KiB |     72 MiB |     95 GiB |     95 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1730 MiB | 340026 GiB | 340026 GiB |
|       from large pool |  16640 KiB |   1660 MiB | 339931 GiB | 339931 GiB |
|       from small pool |      0 KiB |     72 MiB |     95 GiB |     95 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1723 MiB | 340012 GiB | 340012 GiB |
|       from large pool |  16640 KiB |   1653 MiB | 339918 GiB | 339918 GiB |
|       from small pool |      0 KiB |     71 MiB |     93 GiB |     93 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 608256 KiB |   1876 MiB |   1876 MiB |   1282 MiB |
|       from large pool | 565248 KiB |   1802 MiB |   1802 MiB |   1250 MiB |
|       from small pool |  43008 KiB |     74 MiB |     74 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 384768 KiB | 758032 KiB | 239266 GiB | 239266 GiB |
|       from large pool | 384768 KiB | 756864 KiB | 239168 GiB | 239167 GiB |
|       from small pool |      0 KiB |  14441 KiB |     98 GiB |     98 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1851    |   10195 K  |   10195 K  |
|       from large pool |       2    |      76    |    3230 K  |    3230 K  |
|       from small pool |       0    |    1780    |    6964 K  |    6964 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1851    |   10195 K  |   10195 K  |
|       from large pool |       2    |      76    |    3230 K  |    3230 K  |
|       from small pool |       0    |    1780    |    6964 K  |    6964 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      30    |      50    |      50    |      20    |
|       from large pool |       9    |      13    |      13    |       4    |
|       from small pool |      21    |      37    |      37    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     378    |    5107 K  |    5107 K  |
|       from large pool |       1    |      11    |    1218 K  |    1218 K  |
|       from small pool |       0    |     373    |    3888 K  |    3888 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1730 MiB | 340026 GiB | 340026 GiB |
|       from large pool |  16640 KiB |   1660 MiB | 339931 GiB | 339931 GiB |
|       from small pool |      0 KiB |     72 MiB |     95 GiB |     95 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1730 MiB | 340026 GiB | 340026 GiB |
|       from large pool |  16640 KiB |   1660 MiB | 339931 GiB | 339931 GiB |
|       from small pool |      0 KiB |     72 MiB |     95 GiB |     95 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1723 MiB | 340012 GiB | 340012 GiB |
|       from large pool |  16640 KiB |   1653 MiB | 339918 GiB | 339918 GiB |
|       from small pool |      0 KiB |     71 MiB |     93 GiB |     93 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 608256 KiB |   1876 MiB |   1876 MiB |   1282 MiB |
|       from large pool | 565248 KiB |   1802 MiB |   1802 MiB |   1250 MiB |
|       from small pool |  43008 KiB |     74 MiB |     74 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 384768 KiB | 758032 KiB | 239266 GiB | 239266 GiB |
|       from large pool | 384768 KiB | 756864 KiB | 239168 GiB | 239167 GiB |
|       from small pool |      0 KiB |  14441 KiB |     98 GiB |     98 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1851    |   10195 K  |   10195 K  |
|       from large pool |       2    |      76    |    3230 K  |    3230 K  |
|       from small pool |       0    |    1780    |    6964 K  |    6964 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1851    |   10195 K  |   10195 K  |
|       from large pool |       2    |      76    |    3230 K  |    3230 K  |
|       from small pool |       0    |    1780    |    6964 K  |    6964 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      30    |      50    |      50    |      20    |
|       from large pool |       9    |      13    |      13    |       4    |
|       from small pool |      21    |      37    |      37    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     378    |    5107 K  |    5107 K  |
|       from large pool |       1    |      11    |    1218 K  |    1218 K  |
|       from small pool |       0    |     373    |    3888 K  |    3888 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0




!!!: not committed yet



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_06_30_58_seed_1_21512113

 Experiment start at: 2024-06-20 06:30:58.440443
before training, model accuracy: 0.1456654816865921
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9368365, 'precision': 0.9246046, 'recall': 0.67428315, 'specificity': 0.67428315, 'f1': 0.73708653, 'auroc': 0.9314726, 'binary_precision': 0.9114303, 'binary_recall': 0.35205734, 'binary_specificity': 0.99650896, 'binary_f1_score': 0.5079207}
confusion matrix:
       0     1
0  42246   148
1   2803  1523
---- Validation: 
scalar performance:
{'acc': 0.9633938, 'precision': 0.51538944, 'recall': 0.5003555, 'specificity': 0.5003555, 'f1': 0.49213085, 'auroc': 0.49840197, 'binary_precision': 0.06666667, 'binary_recall': 0.0014858841, 'binary_specificity': 0.9992251, 'binary_f1_score': 0.0029069767}
confusion matrix:
       0   1
0  18053  14
1    672   1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.4867972, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512113_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-20 06:47:06.874734,epoch time: 0:16:08.434291,used: 0:16:08.434291,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_06_30_58_seed_1_21512113
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96952057, 'precision': 0.9800947, 'recall': 0.8377634, 'specificity': 0.8377634, 'f1': 0.89382726, 'auroc': 0.9718652, 'binary_precision': 0.9921954, 'binary_recall': 0.6760694, 'binary_specificity': 0.9994575, 'binary_f1_score': 0.8041804}
confusion matrix:
       0     1
0  42372    23
1   1401  2924
---- Validation: 
scalar performance:
{'acc': 0.96510136, 'precision': 0.8339451, 'recall': 0.5241296, 'specificity': 0.5241296, 'f1': 0.5369378, 'auroc': 0.6412246, 'binary_precision': 0.70212764, 'binary_recall': 0.049034175, 'binary_specificity': 0.9992251, 'binary_f1_score': 0.09166667}
confusion matrix:
       0   1
0  18053  14
1    640  33
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9577828, 'precision': 0.6458602, 'recall': 0.5035098, 'specificity': 0.5035098, 'f1': 0.49673337, 'auroc': 0.68057644, 'binary_precision': 0.33333334, 'binary_recall': 0.0076923077, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.015037594}
confusion matrix:
      0  1
0  5942  4
1   258  2
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512113_2.png
better model found
persisted
after epoch: 2,now: 2024-06-20 07:02:35.127383,epoch time: 0:15:28.252649,used: 0:31:36.686940,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_06_30_58_seed_1_21512113
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9755993, 'precision': 0.9828936, 'recall': 0.87114453, 'specificity': 0.87114453, 'f1': 0.91804504, 'auroc': 0.97974575, 'binary_precision': 0.99136335, 'binary_recall': 0.7429496, 'binary_specificity': 0.9993395, 'binary_f1_score': 0.8493657}
confusion matrix:
       0     1
0  42366    28
1   1112  3214
---- Validation: 
scalar performance:
{'acc': 0.9657951, 'precision': 0.81217426, 'recall': 0.5488085, 'specificity': 0.5488085, 'f1': 0.57771987, 'auroc': 0.6849672, 'binary_precision': 0.65686274, 'binary_recall': 0.09955423, 'binary_specificity': 0.9980628, 'binary_f1_score': 0.17290321}
confusion matrix:
       0   1
0  18032  35
1    606  67
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590719, 'precision': 0.79268444, 'recall': 0.52808934, 'specificity': 0.52808934, 'f1': 0.5423453, 'auroc': 0.7109474, 'binary_precision': 0.625, 'binary_recall': 0.057692308, 'binary_specificity': 0.9984864, 'binary_f1_score': 0.1056338}
confusion matrix:
      0   1
0  5937   9
1   245  15
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512113_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-20 07:17:22.048736,epoch time: 0:14:46.921353,used: 0:46:23.608293,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_06_30_58_seed_1_21512113
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.980137, 'precision': 0.97966194, 'recall': 0.90030766, 'specificity': 0.90030766, 'f1': 0.93556, 'auroc': 0.98517275, 'binary_precision': 0.97910196, 'binary_recall': 0.8023606, 'binary_specificity': 0.99825466, 'binary_f1_score': 0.8819639}
confusion matrix:
       0     1
0  42325    74
1    854  3467
---- Validation: 
scalar performance:
{'acc': 0.9659552, 'precision': 0.7826178, 'recall': 0.57893276, 'specificity': 0.57893276, 'f1': 0.61862636, 'auroc': 0.72979796, 'binary_precision': 0.59562844, 'binary_recall': 0.16196136, 'binary_specificity': 0.99590415, 'binary_f1_score': 0.25467288}
confusion matrix:
       0    1
0  17993   74
1    564  109
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9619723, 'precision': 0.84734756, 'recall': 0.57189965, 'specificity': 0.57189965, 'f1': 0.6120428, 'auroc': 0.76452106, 'binary_precision': 0.7307692, 'binary_recall': 0.14615385, 'binary_specificity': 0.9976455, 'binary_f1_score': 0.24358974}
confusion matrix:
      0   1
0  5932  14
1   222  38
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512113_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-20 07:32:07.823102,epoch time: 0:14:45.774366,used: 1:01:09.382659,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_06_30_58_seed_1_21512113
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98306936, 'precision': 0.98342, 'recall': 0.9146408, 'specificity': 0.9146408, 'f1': 0.9457675, 'auroc': 0.98801374, 'binary_precision': 0.98383564, 'binary_recall': 0.83067316, 'binary_specificity': 0.9986084, 'binary_f1_score': 0.90079015}
confusion matrix:
       0     1
0  42338    59
1    732  3591
---- Validation: 
scalar performance:
{'acc': 0.96643543, 'precision': 0.7906704, 'recall': 0.58776504, 'specificity': 0.58776504, 'f1': 0.63032997, 'auroc': 0.75526834, 'binary_precision': 0.6111111, 'binary_recall': 0.17979197, 'binary_specificity': 0.9957381, 'binary_f1_score': 0.27784154}
confusion matrix:
       0    1
0  17990   77
1    552  121
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96310025, 'precision': 0.85963666, 'recall': 0.58720016, 'specificity': 0.58720016, 'f1': 0.63383234, 'auroc': 0.78257585, 'binary_precision': 0.75409836, 'binary_recall': 0.17692308, 'binary_specificity': 0.9974773, 'binary_f1_score': 0.28660434}
confusion matrix:
      0   1
0  5931  15
1   214  46
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512113_5.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-06-20 07:46:57.305866,epoch time: 0:14:49.482764,used: 1:15:58.865423,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_06_30_58_seed_1_21512113
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9849957, 'precision': 0.98287916, 'recall': 0.9265579, 'specificity': 0.9265579, 'f1': 0.9525523, 'auroc': 0.99074566, 'binary_precision': 0.98035574, 'binary_recall': 0.85486114, 'binary_specificity': 0.9982547, 'binary_f1_score': 0.9133177}
confusion matrix:
       0     1
0  42326    74
1    627  3693
---- Validation: 
scalar performance:
{'acc': 0.96611524, 'precision': 0.7830138, 'recall': 0.58545315, 'specificity': 0.58545315, 'f1': 0.6268037, 'auroc': 0.7740561, 'binary_precision': 0.5959596, 'binary_recall': 0.17533432, 'binary_specificity': 0.99557203, 'binary_f1_score': 0.2709529}
confusion matrix:
       0    1
0  17987   80
1    555  118
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96358365, 'precision': 0.8616869, 'recall': 0.5948084, 'specificity': 0.5948084, 'f1': 0.64402455, 'auroc': 0.7985834, 'binary_precision': 0.75757575, 'binary_recall': 0.1923077, 'binary_specificity': 0.9973091, 'binary_f1_score': 0.30674845}
confusion matrix:
      0   1
0  5930  16
1   210  50
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512113_6.png
new oracle model saved
early stop counter: 1
val acc:0.9661152362823486, best validation acc: 0.966435432434082, corresponding to test acc:                         0.963100254535675 / 0.9635836482048035
after epoch: 6,now: 2024-06-20 08:01:43.583106,epoch time: 0:14:46.277240,used: 1:30:45.142663,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_06_30_58_seed_1_21512113
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9854238, 'precision': 0.9829446, 'recall': 0.92917764, 'specificity': 0.92917764, 'f1': 0.95409095, 'auroc': 0.991451, 'binary_precision': 0.9799842, 'binary_recall': 0.86014795, 'binary_specificity': 0.9982073, 'binary_f1_score': 0.916164}
confusion matrix:
       0     1
0  42318    76
1    605  3721
---- Validation: 
scalar performance:
{'acc': 0.966222, 'precision': 0.7865566, 'recall': 0.58479327, 'specificity': 0.58479327, 'f1': 0.6263036, 'auroc': 0.7818591, 'binary_precision': 0.6030928, 'binary_recall': 0.17384844, 'binary_specificity': 0.9957381, 'binary_f1_score': 0.26989618}
confusion matrix:
       0    1
0  17990   77
1    556  117
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96358365, 'precision': 0.845121, 'recall': 0.6040033, 'specificity': 0.6040033, 'f1': 0.6543331, 'auroc': 0.80003023, 'binary_precision': 0.7236842, 'binary_recall': 0.21153846, 'binary_specificity': 0.9964682, 'binary_f1_score': 0.32738096}
confusion matrix:
      0   1
0  5925  21
1   205  55
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512113_7.png
early stop counter: 2
val acc:0.9662219882011414, best validation acc: 0.966435432434082, corresponding to test acc:                         0.963100254535675 / 0.9635836482048035
after epoch: 7,now: 2024-06-20 08:17:01.376360,epoch time: 0:15:17.793254,used: 1:46:02.935917,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_06_30_58_seed_1_21512113
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9879495, 'precision': 0.9832754, 'recall': 0.9440489, 'specificity': 0.9440489, 'f1': 0.9626276, 'auroc': 0.9916249, 'binary_precision': 0.9776536, 'binary_recall': 0.89017344, 'binary_specificity': 0.99792427, 'binary_f1_score': 0.9318649}
confusion matrix:
       0     1
0  42307    88
1    475  3850
---- Validation: 
scalar performance:
{'acc': 0.96627533, 'precision': 0.7813559, 'recall': 0.59554994, 'specificity': 0.59554994, 'f1': 0.63868374, 'auroc': 0.79376924, 'binary_precision': 0.59192824, 'binary_recall': 0.1961367, 'binary_specificity': 0.99496317, 'binary_f1_score': 0.29464284}
confusion matrix:
       0    1
0  17976   91
1    541  132
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9653561, 'precision': 0.8606288, 'recall': 0.62699616, 'specificity': 0.62699616, 'f1': 0.68306553, 'auroc': 0.8173096, 'binary_precision': 0.752809, 'binary_recall': 0.2576923, 'binary_specificity': 0.99630004, 'binary_f1_score': 0.38395417}
confusion matrix:
      0   1
0  5924  22
1   193  67
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512113_8.png
new oracle model saved
early stop counter: 3
val acc:0.9662753343582153, best validation acc: 0.966435432434082, corresponding to test acc:                         0.963100254535675 / 0.9653561115264893
after epoch: 8,now: 2024-06-20 08:35:48.722536,epoch time: 0:18:47.346176,used: 2:04:50.282093,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_06_30_58_seed_1_21512113
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98777825, 'precision': 0.9843742, 'recall': 0.9419557, 'specificity': 0.9419557, 'f1': 0.96195513, 'auroc': 0.99229705, 'binary_precision': 0.9802867, 'binary_recall': 0.8857275, 'binary_specificity': 0.99818385, 'binary_f1_score': 0.93061125}
confusion matrix:
       0     1
0  42320    77
1    494  3829
---- Validation: 
scalar performance:
{'acc': 0.9667022, 'precision': 0.7886319, 'recall': 0.6014935, 'specificity': 0.6014935, 'f1': 0.64633703, 'auroc': 0.7939048, 'binary_precision': 0.6060606, 'binary_recall': 0.20802377, 'binary_specificity': 0.99496317, 'binary_f1_score': 0.3097345}
confusion matrix:
       0    1
0  17976   91
1    533  140
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96406704, 'precision': 0.84256804, 'recall': 0.61528957, 'specificity': 0.61528957, 'f1': 0.66757154, 'auroc': 0.8006337, 'binary_precision': 0.7176471, 'binary_recall': 0.23461539, 'binary_specificity': 0.9959637, 'binary_f1_score': 0.3536232}
confusion matrix:
      0   1
0  5922  24
1   199  61
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512113_9.png
better model found
persisted
after epoch: 9,now: 2024-06-20 08:53:04.216670,epoch time: 0:17:15.494134,used: 2:22:05.776227,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_06_30_58_seed_1_21512113
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9880351, 'precision': 0.98321784, 'recall': 0.94459, 'specificity': 0.94459, 'f1': 0.96290123, 'auroc': 0.9943001, 'binary_precision': 0.97742265, 'binary_recall': 0.8912792, 'binary_specificity': 0.9979008, 'binary_f1_score': 0.9323654}
confusion matrix:
       0     1
0  42308    89
1    470  3853
---- Validation: 
scalar performance:
{'acc': 0.9667022, 'precision': 0.7886319, 'recall': 0.6014935, 'specificity': 0.6014935, 'f1': 0.64633703, 'auroc': 0.80172485, 'binary_precision': 0.6060606, 'binary_recall': 0.20802377, 'binary_specificity': 0.99496317, 'binary_f1_score': 0.3097345}
confusion matrix:
       0    1
0  17976   91
1    533  140
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9629391, 'precision': 0.83180004, 'recall': 0.599989, 'specificity': 0.599989, 'f1': 0.64821506, 'auroc': 0.8088015, 'binary_precision': 0.69736844, 'binary_recall': 0.20384616, 'binary_specificity': 0.99613184, 'binary_f1_score': 0.31547618}
confusion matrix:
      0   1
0  5923  23
1   207  53
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512113_10.png
early stop counter: 1
val acc:0.9667022228240967, best validation acc: 0.9667022228240967, corresponding to test acc:                         0.9640670418739319 / 0.9653561115264893
after epoch: 10,now: 2024-06-20 09:11:23.132008,epoch time: 0:18:18.915338,used: 2:40:24.691565,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_06_30_58_seed_1_21512113
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9891053, 'precision': 0.9844804, 'recall': 0.94985366, 'specificity': 0.94985366, 'f1': 0.9663664, 'auroc': 0.9938851, 'binary_precision': 0.9789051, 'binary_recall': 0.90168864, 'binary_specificity': 0.99801874, 'binary_f1_score': 0.9387116}
confusion matrix:
       0     1
0  42313    84
1    425  3898
---- Validation: 
scalar performance:
{'acc': 0.9666489, 'precision': 0.79246396, 'recall': 0.5935979, 'specificity': 0.5935979, 'f1': 0.63755393, 'auroc': 0.80343205, 'binary_precision': 0.6142857, 'binary_recall': 0.19167905, 'binary_specificity': 0.9955167, 'binary_f1_score': 0.29218572}
confusion matrix:
       0    1
0  17986   81
1    544  129
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621334, 'precision': 0.8348024, 'recall': 0.58117867, 'specificity': 0.58117867, 'f1': 0.62423843, 'auroc': 0.802245, 'binary_precision': 0.704918, 'binary_recall': 0.16538462, 'binary_specificity': 0.99697274, 'binary_f1_score': 0.26791278}
confusion matrix:
      0   1
0  5928  18
1   217  43
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512113_11.png
early stop counter: 2
val acc:0.9666488766670227, best validation acc: 0.9667022228240967, corresponding to test acc:                         0.9640670418739319 / 0.9653561115264893
after epoch: 11,now: 2024-06-20 09:29:21.148867,epoch time: 0:17:58.016859,used: 2:58:22.708424,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_06_30_58_seed_1_21512113
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9897046, 'precision': 0.98401856, 'recall': 0.9539231, 'specificity': 0.9539231, 'f1': 0.96836776, 'auroc': 0.99581265, 'binary_precision': 0.97714853, 'binary_recall': 0.9100162, 'binary_specificity': 0.99783003, 'binary_f1_score': 0.9423883}
confusion matrix:
       0     1
0  42305    92
1    389  3934
---- Validation: 
scalar performance:
{'acc': 0.9663821, 'precision': 0.7912954, 'recall': 0.5848763, 'specificity': 0.5848763, 'f1': 0.6268139, 'auroc': 0.8061695, 'binary_precision': 0.61256546, 'binary_recall': 0.17384844, 'binary_specificity': 0.99590415, 'binary_f1_score': 0.2708333}
confusion matrix:
       0    1
0  17993   74
1    556  117
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611666, 'precision': 0.8053274, 'recall': 0.5788351, 'specificity': 0.5788351, 'f1': 0.6192614, 'auroc': 0.8074767, 'binary_precision': 0.64615387, 'binary_recall': 0.16153847, 'binary_specificity': 0.99613184, 'binary_f1_score': 0.25846153}
confusion matrix:
      0   1
0  5923  23
1   218  42
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512113_12.png
early stop counter: 3
val acc:0.9663820862770081, best validation acc: 0.9667022228240967, corresponding to test acc:                         0.9640670418739319 / 0.9653561115264893
after epoch: 12,now: 2024-06-20 09:45:58.151687,epoch time: 0:16:37.002820,used: 3:14:59.711244,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_06_30_58_seed_1_21512113
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9900043, 'precision': 0.9863812, 'recall': 0.9534861, 'specificity': 0.9534861, 'f1': 0.9692153, 'auroc': 0.9957583, 'binary_precision': 0.982009, 'binary_recall': 0.90867054, 'binary_specificity': 0.9983017, 'binary_f1_score': 0.9439174}
confusion matrix:
       0     1
0  42323    72
1    395  3930
---- Validation: 
scalar performance:
{'acc': 0.96627533, 'precision': 0.7876005, 'recall': 0.5855362, 'specificity': 0.5855362, 'f1': 0.6273136, 'auroc': 0.8124871, 'binary_precision': 0.6051282, 'binary_recall': 0.17533432, 'binary_specificity': 0.9957381, 'binary_f1_score': 0.2718894}
confusion matrix:
       0    1
0  17990   77
1    555  118
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614889, 'precision': 0.81076574, 'recall': 0.5826813, 'specificity': 0.5826813, 'f1': 0.62466824, 'auroc': 0.8156899, 'binary_precision': 0.6567164, 'binary_recall': 0.16923077, 'binary_specificity': 0.99613184, 'binary_f1_score': 0.26911315}
confusion matrix:
      0   1
0  5923  23
1   216  44
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512113_13.png
early stop counter: 4
val acc:0.9662753343582153, best validation acc: 0.9667022228240967, corresponding to test acc:                         0.9640670418739319 / 0.9653561115264893
after epoch: 13,now: 2024-06-20 10:02:35.922200,epoch time: 0:16:37.770513,used: 3:31:37.481757,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_06_30_58_seed_1_21512113
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98953336, 'precision': 0.98455125, 'recall': 0.9523854, 'specificity': 0.9523854, 'f1': 0.967779, 'auroc': 0.99428844, 'binary_precision': 0.97853756, 'binary_recall': 0.90679926, 'binary_specificity': 0.99797153, 'binary_f1_score': 0.94130355}
confusion matrix:
       0     1
0  42310    86
1    403  3921
---- Validation: 
scalar performance:
{'acc': 0.966809, 'precision': 0.7886605, 'recall': 0.60584044, 'specificity': 0.60584044, 'f1': 0.65123224, 'auroc': 0.8218501, 'binary_precision': 0.60580915, 'binary_recall': 0.21693908, 'binary_specificity': 0.9947418, 'binary_f1_score': 0.31947485}
confusion matrix:
       0    1
0  17972   95
1    527  146
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96132773, 'precision': 0.8020007, 'recall': 0.58627516, 'specificity': 0.58627516, 'f1': 0.6286204, 'auroc': 0.8141891, 'binary_precision': 0.6388889, 'binary_recall': 0.17692308, 'binary_specificity': 0.9956273, 'binary_f1_score': 0.27710843}
confusion matrix:
      0   1
0  5920  26
1   214  46
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512113_14.png
better model found
persisted
after epoch: 14,now: 2024-06-20 10:20:29.223351,epoch time: 0:17:53.301151,used: 3:49:30.782908,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_06_30_58_seed_1_21512113
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9900471, 'precision': 0.98728013, 'recall': 0.95286536, 'specificity': 0.95286536, 'f1': 0.9692872, 'auroc': 0.9954442, 'binary_precision': 0.9839438, 'binary_recall': 0.90724033, 'binary_specificity': 0.99849045, 'binary_f1_score': 0.9440366}
confusion matrix:
       0     1
0  42333    64
1    401  3922
---- Validation: 
scalar performance:
{'acc': 0.9668623, 'precision': 0.79902434, 'recall': 0.5929933, 'specificity': 0.5929933, 'f1': 0.6374692, 'auroc': 0.82332957, 'binary_precision': 0.627451, 'binary_recall': 0.19019316, 'binary_specificity': 0.99579346, 'binary_f1_score': 0.2919042}
confusion matrix:
       0    1
0  17991   76
1    545  128
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611666, 'precision': 0.8152816, 'recall': 0.5714792, 'specificity': 0.5714792, 'f1': 0.609911, 'auroc': 0.8236182, 'binary_precision': 0.6666667, 'binary_recall': 0.14615385, 'binary_specificity': 0.9968046, 'binary_f1_score': 0.23974764}
confusion matrix:
      0   1
0  5927  19
1   222  38
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512113_15.png
better model found
persisted
after epoch: 15,now: 2024-06-20 10:37:26.355523,epoch time: 0:16:57.132172,used: 4:06:27.915080,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_06_30_58_seed_1_21512113
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9914598, 'precision': 0.9886133, 'recall': 0.9601016, 'specificity': 0.9601016, 'f1': 0.9738226, 'auroc': 0.9960115, 'binary_precision': 0.98517054, 'binary_recall': 0.9216185, 'binary_specificity': 0.99858475, 'binary_f1_score': 0.9523355}
confusion matrix:
       0     1
0  42335    60
1    339  3986
---- Validation: 
scalar performance:
{'acc': 0.9663821, 'precision': 0.7969236, 'recall': 0.5784389, 'specificity': 0.5784389, 'f1': 0.619061, 'auroc': 0.8158172, 'binary_precision': 0.6242775, 'binary_recall': 0.16047548, 'binary_specificity': 0.99640226, 'binary_f1_score': 0.25531912}
confusion matrix:
       0    1
0  18002   65
1    565  108
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96003866, 'precision': 0.7871063, 'recall': 0.56169564, 'specificity': 0.56169564, 'f1': 0.5948459, 'auroc': 0.8060741, 'binary_precision': 0.6111111, 'binary_recall': 0.12692308, 'binary_specificity': 0.9964682, 'binary_f1_score': 0.21019109}
confusion matrix:
      0   1
0  5925  21
1   227  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512113_16.png
early stop counter: 1
val acc:0.9663820862770081, best validation acc: 0.9668623208999634, corresponding to test acc:                         0.9611666202545166 / 0.9653561115264893
after epoch: 16,now: 2024-06-20 10:55:26.804134,epoch time: 0:18:00.448611,used: 4:24:28.363691,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_06_30_58_seed_1_21512113
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99130994, 'precision': 0.9863664, 'recall': 0.9613513, 'specificity': 0.9613513, 'f1': 0.97344625, 'auroc': 0.99612284, 'binary_precision': 0.98037773, 'binary_recall': 0.9245894, 'binary_specificity': 0.9981131, 'binary_f1_score': 0.9516667}
confusion matrix:
       0     1
0  42317    80
1    326  3997
---- Validation: 
scalar performance:
{'acc': 0.9666489, 'precision': 0.8002088, 'recall': 0.5842994, 'specificity': 0.5842994, 'f1': 0.62682295, 'auroc': 0.8178328, 'binary_precision': 0.6304348, 'binary_recall': 0.17236255, 'binary_specificity': 0.9962362, 'binary_f1_score': 0.27071178}
confusion matrix:
       0    1
0  17999   68
1    557  116
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96003866, 'precision': 0.79140025, 'recall': 0.5580177, 'specificity': 0.5580177, 'f1': 0.58975375, 'auroc': 0.80119115, 'binary_precision': 0.62, 'binary_recall': 0.11923077, 'binary_specificity': 0.9968046, 'binary_f1_score': 0.20000002}
confusion matrix:
      0   1
0  5927  19
1   229  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512113_17.png
early stop counter: 2
val acc:0.9666488766670227, best validation acc: 0.9668623208999634, corresponding to test acc:                         0.9611666202545166 / 0.9653561115264893
after epoch: 17,now: 2024-06-20 11:16:25.212025,epoch time: 0:20:58.407891,used: 4:45:26.771582,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_06_30_58_seed_1_21512113
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9911815, 'precision': 0.98800236, 'recall': 0.9590047, 'specificity': 0.9590047, 'f1': 0.97294927, 'auroc': 0.99510306, 'binary_precision': 0.9841584, 'binary_recall': 0.91951895, 'binary_specificity': 0.99849045, 'binary_f1_score': 0.95074123}
confusion matrix:
       0     1
0  42332    64
1    348  3976
---- Validation: 
scalar performance:
{'acc': 0.9665422, 'precision': 0.8048334, 'recall': 0.5763761, 'specificity': 0.5763761, 'f1': 0.61689246, 'auroc': 0.81361616, 'binary_precision': 0.6402439, 'binary_recall': 0.15601783, 'binary_specificity': 0.9967344, 'binary_f1_score': 0.25089604}
confusion matrix:
       0    1
0  18008   59
1    568  105
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95939416, 'precision': 0.7728294, 'recall': 0.5521644, 'specificity': 0.5521644, 'f1': 0.5804993, 'auroc': 0.79550767, 'binary_precision': 0.5833333, 'binary_recall': 0.10769231, 'binary_specificity': 0.9966364, 'binary_f1_score': 0.18181817}
confusion matrix:
      0   1
0  5926  20
1   232  28
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512113_18.png
early stop counter: 3
val acc:0.9665421843528748, best validation acc: 0.9668623208999634, corresponding to test acc:                         0.9611666202545166 / 0.9653561115264893
after epoch: 18,now: 2024-06-20 11:34:49.721892,epoch time: 0:18:24.509867,used: 5:03:51.281449,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_06_30_58_seed_1_21512113
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99083906, 'precision': 0.9888822, 'recall': 0.9561361, 'specificity': 0.9561361, 'f1': 0.97180146, 'auroc': 0.99602723, 'binary_precision': 0.98652023, 'binary_recall': 0.913546, 'binary_specificity': 0.99872625, 'binary_f1_score': 0.9486318}
confusion matrix:
       0     1
0  42340    54
1    374  3952
---- Validation: 
scalar performance:
{'acc': 0.9665422, 'precision': 0.8074205, 'recall': 0.5742303, 'specificity': 0.5742303, 'f1': 0.61418957, 'auroc': 0.8181988, 'binary_precision': 0.6455696, 'binary_recall': 0.15156017, 'binary_specificity': 0.99690044, 'binary_f1_score': 0.24548735}
confusion matrix:
       0    1
0  18011   56
1    571  102
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96084434, 'precision': 0.821916, 'recall': 0.5602771, 'specificity': 0.5602771, 'f1': 0.59419733, 'auroc': 0.8153578, 'binary_precision': 0.68085104, 'binary_recall': 0.12307692, 'binary_specificity': 0.9974773, 'binary_f1_score': 0.20846906}
confusion matrix:
      0   1
0  5931  15
1   228  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512113_19.png
early stop counter: 4
val acc:0.9665421843528748, best validation acc: 0.9668623208999634, corresponding to test acc:                         0.9611666202545166 / 0.9653561115264893
after epoch: 19,now: 2024-06-20 11:53:17.703711,epoch time: 0:18:27.981819,used: 5:22:19.263268,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_06_30_58_seed_1_21512113
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9911601, 'precision': 0.98679984, 'recall': 0.9600133, 'specificity': 0.9600133, 'f1': 0.9729332, 'auroc': 0.9962806, 'binary_precision': 0.98152256, 'binary_recall': 0.9217955, 'binary_specificity': 0.99823105, 'binary_f1_score': 0.95072186}
confusion matrix:
       0     1
0  42323    75
1    338  3984
---- Validation: 
scalar performance:
{'acc': 0.9667556, 'precision': 0.7989459, 'recall': 0.5893616, 'specificity': 0.5893616, 'f1': 0.63303363, 'auroc': 0.8242158, 'binary_precision': 0.627551, 'binary_recall': 0.18276374, 'binary_specificity': 0.99595946, 'binary_f1_score': 0.283084}
confusion matrix:
       0    1
0  17994   73
1    550  123
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96003866, 'precision': 0.78023934, 'recall': 0.5690516, 'specificity': 0.5690516, 'f1': 0.60465044, 'auroc': 0.8129129, 'binary_precision': 0.5967742, 'binary_recall': 0.1423077, 'binary_specificity': 0.9957955, 'binary_f1_score': 0.22981368}
confusion matrix:
      0   1
0  5921  25
1   223  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512113_20.png
early stop counter: 5
val acc:0.9667556285858154, best validation acc: 0.9668623208999634, corresponding to test acc:                         0.9611666202545166 / 0.9653561115264893
after epoch: 20,now: 2024-06-20 12:14:22.946193,epoch time: 0:21:05.242482,used: 5:43:24.505750,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_06_30_58_seed_1_21512113
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9914598, 'precision': 0.98742414, 'recall': 0.96122605, 'specificity': 0.96122605, 'f1': 0.97387314, 'auroc': 0.9965031, 'binary_precision': 0.9825381, 'binary_recall': 0.92412674, 'binary_specificity': 0.99832535, 'binary_f1_score': 0.9524377}
confusion matrix:
       0     1
0  42326    71
1    328  3995
---- Validation: 
scalar performance:
{'acc': 0.9667022, 'precision': 0.7967528, 'recall': 0.5900492, 'specificity': 0.5900492, 'f1': 0.6336791, 'auroc': 0.82976437, 'binary_precision': 0.6231156, 'binary_recall': 0.18424962, 'binary_specificity': 0.9958488, 'binary_f1_score': 0.28440365}
confusion matrix:
       0    1
0  17992   75
1    549  124
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96036094, 'precision': 0.8014815, 'recall': 0.56002486, 'specificity': 0.56002486, 'f1': 0.5930622, 'auroc': 0.8138833, 'binary_precision': 0.64, 'binary_recall': 0.12307692, 'binary_specificity': 0.99697274, 'binary_f1_score': 0.20645161}
confusion matrix:
      0   1
0  5928  18
1   228  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512113_21.png
early stop counter: 6
val acc:0.9667022228240967, best validation acc: 0.9668623208999634, corresponding to test acc:                         0.9611666202545166 / 0.9653561115264893
after epoch: 21,now: 2024-06-20 12:32:56.380231,epoch time: 0:18:33.434038,used: 6:01:57.939788,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_06_30_58_seed_1_21512113
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9914383, 'precision': 0.9864553, 'recall': 0.96206224, 'specificity': 0.96206224, 'f1': 0.9738667, 'auroc': 0.99643415, 'binary_precision': 0.9804162, 'binary_recall': 0.92601156, 'binary_specificity': 0.998113, 'binary_f1_score': 0.9524376}
confusion matrix:
       0     1
0  42315    80
1    320  4005
---- Validation: 
scalar performance:
{'acc': 0.9664888, 'precision': 0.79222226, 'recall': 0.5877927, 'specificity': 0.5877927, 'f1': 0.63050354, 'auroc': 0.83025426, 'binary_precision': 0.61421317, 'binary_recall': 0.17979197, 'binary_specificity': 0.99579346, 'binary_f1_score': 0.2781609}
confusion matrix:
       0    1
0  17991   76
1    552  121
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95955527, 'precision': 0.7685777, 'recall': 0.56512135, 'specificity': 0.56512135, 'f1': 0.5986546, 'auroc': 0.8144064, 'binary_precision': 0.57377046, 'binary_recall': 0.13461539, 'binary_specificity': 0.9956273, 'binary_f1_score': 0.21806855}
confusion matrix:
      0   1
0  5920  26
1   225  35
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512113_22.png
early stop counter: 7
val acc:0.966488778591156, best validation acc: 0.9668623208999634, corresponding to test acc:                         0.9611666202545166 / 0.9653561115264893
after epoch: 22,now: 2024-06-20 12:50:58.500936,epoch time: 0:18:02.120705,used: 6:20:00.060493,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_06_30_58_seed_1_21512113
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99101025, 'precision': 0.9885455, 'recall': 0.95744693, 'specificity': 0.95744693, 'f1': 0.9723584, 'auroc': 0.9958447, 'binary_precision': 0.9855685, 'binary_recall': 0.91626185, 'binary_specificity': 0.99863195, 'binary_f1_score': 0.9496523}
confusion matrix:
       0     1
0  42339    58
1    362  3961
---- Validation: 
scalar performance:
{'acc': 0.9665422, 'precision': 0.80092984, 'recall': 0.5799524, 'specificity': 0.5799524, 'f1': 0.6213123, 'auroc': 0.8354256, 'binary_precision': 0.6321839, 'binary_recall': 0.16344725, 'binary_specificity': 0.99645764, 'binary_f1_score': 0.25974026}
confusion matrix:
       0    1
0  18003   64
1    563  110
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95987755, 'precision': 0.792283, 'recall': 0.5524166, 'specificity': 0.5524166, 'f1': 0.58151996, 'auroc': 0.816105, 'binary_precision': 0.62222224, 'binary_recall': 0.10769231, 'binary_specificity': 0.99714094, 'binary_f1_score': 0.18360655}
confusion matrix:
      0   1
0  5929  17
1   232  28
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512113_23.png
early stop counter: 8
val acc:0.9665421843528748, best validation acc: 0.9668623208999634, corresponding to test acc:                         0.9611666202545166 / 0.9653561115264893
after epoch: 23,now: 2024-06-20 13:08:59.792640,epoch time: 0:18:01.291704,used: 6:38:01.352197,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_06_30_58_seed_1_21512113
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9917594, 'precision': 0.9877238, 'recall': 0.96274143, 'specificity': 0.96274143, 'f1': 0.9748224, 'auroc': 0.9965712, 'binary_precision': 0.9828347, 'binary_recall': 0.9271339, 'binary_specificity': 0.99834895, 'binary_f1_score': 0.9541721}
confusion matrix:
       0     1
0  42327    70
1    315  4008
---- Validation: 
scalar performance:
{'acc': 0.966222, 'precision': 0.78706825, 'recall': 0.584078, 'specificity': 0.584078, 'f1': 0.62546, 'auroc': 0.8315346, 'binary_precision': 0.6041667, 'binary_recall': 0.17236255, 'binary_specificity': 0.99579346, 'binary_f1_score': 0.2682081}
confusion matrix:
       0    1
0  17991   76
1    557  116
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597164, 'precision': 0.781319, 'recall': 0.5560105, 'specificity': 0.5560105, 'f1': 0.58644533, 'auroc': 0.81064844, 'binary_precision': 0.6, 'binary_recall': 0.115384616, 'binary_specificity': 0.9966364, 'binary_f1_score': 0.19354838}
confusion matrix:
      0   1
0  5926  20
1   230  30
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512113_24.png
early stop counter: 9
val acc:0.9662219882011414, best validation acc: 0.9668623208999634, corresponding to test acc:                         0.9611666202545166 / 0.9653561115264893
after epoch: 24,now: 2024-06-20 13:29:20.840879,epoch time: 0:20:21.048239,used: 6:58:22.400436,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_06_30_58_seed_1_21512113
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99190927, 'precision': 0.9884676, 'recall': 0.962953, 'specificity': 0.962953, 'f1': 0.9752828, 'auroc': 0.99752295, 'binary_precision': 0.98429835, 'binary_recall': 0.9274156, 'binary_specificity': 0.99849033, 'binary_f1_score': 0.9550107}
confusion matrix:
       0     1
0  42330    64
1    314  4012
---- Validation: 
scalar performance:
{'acc': 0.9666489, 'precision': 0.79697376, 'recall': 0.5878757, 'specificity': 0.5878757, 'f1': 0.6310265, 'auroc': 0.8364539, 'binary_precision': 0.62371135, 'binary_recall': 0.17979197, 'binary_specificity': 0.99595946, 'binary_f1_score': 0.2791234}
confusion matrix:
       0    1
0  17994   73
1    552  121
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9585885, 'precision': 0.7448589, 'recall': 0.55358285, 'specificity': 0.55358285, 'f1': 0.58144104, 'auroc': 0.81624496, 'binary_precision': 0.5272727, 'binary_recall': 0.11153846, 'binary_specificity': 0.9956273, 'binary_f1_score': 0.18412699}
confusion matrix:
      0   1
0  5920  26
1   231  29
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512113_25.png
early stop counter: 10
val acc:0.9666488766670227, best validation acc: 0.9668623208999634, corresponding to test acc:                         0.9611666202545166 / 0.9653561115264893
after epoch: 25,now: 2024-06-20 13:49:19.518800,epoch time: 0:19:58.677921,used: 7:18:21.078357,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_06_30_58_seed_1_21512113
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99235874, 'precision': 0.98726594, 'recall': 0.96681833, 'specificity': 0.96681833, 'f1': 0.976768, 'auroc': 0.9963174, 'binary_precision': 0.9810817, 'binary_recall': 0.9354764, 'binary_specificity': 0.9981602, 'binary_f1_score': 0.9577365}
confusion matrix:
       0     1
0  42318    78
1    279  4045
---- Validation: 
scalar performance:
{'acc': 0.9664888, 'precision': 0.7939402, 'recall': 0.58564687, 'specificity': 0.58564687, 'f1': 0.6279986, 'auroc': 0.8418496, 'binary_precision': 0.6178011, 'binary_recall': 0.17533432, 'binary_specificity': 0.99595946, 'binary_f1_score': 0.27314815}
confusion matrix:
       0    1
0  17994   73
1    555  118
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582662, 'precision': 0.7363217, 'recall': 0.5423808, 'specificity': 0.5423808, 'f1': 0.56471354, 'auroc': 0.8185214, 'binary_precision': 0.51111114, 'binary_recall': 0.08846154, 'binary_specificity': 0.99630004, 'binary_f1_score': 0.15081969}
confusion matrix:
      0   1
0  5924  22
1   237  23
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512113_26.png
early stop counter: 11
val acc:0.966488778591156, best validation acc: 0.9668623208999634, corresponding to test acc:                         0.9611666202545166 / 0.9653561115264893
after epoch: 26,now: 2024-06-20 14:14:38.907238,epoch time: 0:25:19.388438,used: 7:43:40.466795,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_06_30_58_seed_1_21512113
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99238014, 'precision': 0.9895151, 'recall': 0.96476924, 'specificity': 0.96476924, 'f1': 0.9767413, 'auroc': 0.9968842, 'binary_precision': 0.9860431, 'binary_recall': 0.93088305, 'binary_specificity': 0.9986555, 'binary_f1_score': 0.95766944}
confusion matrix:
       0     1
0  42337    57
1    299  4027
---- Validation: 
scalar performance:
{'acc': 0.9667556, 'precision': 0.80224794, 'recall': 0.58578527, 'specificity': 0.58578527, 'f1': 0.628863, 'auroc': 0.838368, 'binary_precision': 0.6344086, 'binary_recall': 0.17533432, 'binary_specificity': 0.9962362, 'binary_f1_score': 0.27473804}
confusion matrix:
       0    1
0  17999   68
1    555  118
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587496, 'precision': 0.75357765, 'recall': 0.54447204, 'specificity': 0.54447204, 'f1': 0.5683759, 'auroc': 0.8168806, 'binary_precision': 0.54545456, 'binary_recall': 0.092307694, 'binary_specificity': 0.9966364, 'binary_f1_score': 0.15789475}
confusion matrix:
      0   1
0  5926  20
1   236  24
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512113_27.png
early stop counter: 12
val acc:0.9667556285858154, best validation acc: 0.9668623208999634, corresponding to test acc:                         0.9611666202545166 / 0.9653561115264893
after epoch: 27,now: 2024-06-20 14:42:01.625191,epoch time: 0:27:22.717953,used: 8:11:03.184748,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_06_30_58_seed_1_21512113
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9922089, 'precision': 0.98962235, 'recall': 0.96362877, 'specificity': 0.96362877, 'f1': 0.97618294, 'auroc': 0.9968606, 'binary_precision': 0.98648983, 'binary_recall': 0.9285549, 'binary_specificity': 0.9987027, 'binary_f1_score': 0.956646}
confusion matrix:
       0     1
0  42340    55
1    309  4016
---- Validation: 
scalar performance:
{'acc': 0.9666489, 'precision': 0.7946255, 'recall': 0.5907368, 'specificity': 0.5907368, 'f1': 0.63432, 'auroc': 0.8387871, 'binary_precision': 0.6188119, 'binary_recall': 0.18573551, 'binary_specificity': 0.9957381, 'binary_f1_score': 0.28571427}
confusion matrix:
       0    1
0  17990   77
1    548  125
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959233, 'precision': 0.7643288, 'recall': 0.55575824, 'specificity': 0.55575824, 'f1': 0.5853912, 'auroc': 0.8166686, 'binary_precision': 0.5660377, 'binary_recall': 0.115384616, 'binary_specificity': 0.99613184, 'binary_f1_score': 0.19169328}
confusion matrix:
      0   1
0  5923  23
1   230  30
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512113_28.png
early stop counter: 13
val acc:0.9666488766670227, best validation acc: 0.9668623208999634, corresponding to test acc:                         0.9611666202545166 / 0.9653561115264893
after epoch: 28,now: 2024-06-20 15:09:52.536488,epoch time: 0:27:50.911297,used: 8:38:54.096045,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_06_30_58_seed_1_21512113
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99240154, 'precision': 0.98866355, 'recall': 0.9656764, 'specificity': 0.9656764, 'f1': 0.97682405, 'auroc': 0.9972835, 'binary_precision': 0.98413086, 'binary_recall': 0.9328859, 'binary_specificity': 0.99846697, 'binary_f1_score': 0.9578234}
confusion matrix:
       0     1
0  42334    65
1    290  4031
---- Validation: 
scalar performance:
{'acc': 0.9668623, 'precision': 0.7961736, 'recall': 0.59656966, 'specificity': 0.59656966, 'f1': 0.6414584, 'auroc': 0.84067965, 'binary_precision': 0.6214953, 'binary_recall': 0.19762258, 'binary_specificity': 0.9955167, 'binary_f1_score': 0.29988727}
confusion matrix:
       0    1
0  17986   81
1    540  133
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582662, 'precision': 0.7354106, 'recall': 0.55893165, 'specificity': 0.55893165, 'f1': 0.588359, 'auroc': 0.8209134, 'binary_precision': 0.50793654, 'binary_recall': 0.12307692, 'binary_specificity': 0.9947864, 'binary_f1_score': 0.19814242}
confusion matrix:
      0   1
0  5915  31
1   228  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512113_29.png
early stop counter: 14
val acc:0.9668623208999634, best validation acc: 0.9668623208999634, corresponding to test acc:                         0.9611666202545166 / 0.9653561115264893
after epoch: 29,now: 2024-06-20 15:32:07.745544,epoch time: 0:22:15.209056,used: 9:01:09.305101,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_06_30_58_seed_1_21512113
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9927654, 'precision': 0.98826575, 'recall': 0.9682884, 'specificity': 0.9682884, 'f1': 0.9780162, 'auroc': 0.9966918, 'binary_precision': 0.98280036, 'binary_recall': 0.9382516, 'binary_specificity': 0.9983253, 'binary_f1_score': 0.96000946}
confusion matrix:
       0     1
0  42325    71
1    267  4057
---- Validation: 
scalar performance:
{'acc': 0.9667556, 'precision': 0.79329467, 'recall': 0.5965143, 'specificity': 0.5965143, 'f1': 0.64109325, 'auroc': 0.8441787, 'binary_precision': 0.6157407, 'binary_recall': 0.19762258, 'binary_specificity': 0.995406, 'binary_f1_score': 0.29921257}
confusion matrix:
       0    1
0  17984   83
1    540  133
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582662, 'precision': 0.7354653, 'recall': 0.55709267, 'specificity': 0.55709267, 'f1': 0.58586276, 'auroc': 0.8211409, 'binary_precision': 0.5081967, 'binary_recall': 0.11923077, 'binary_specificity': 0.9949546, 'binary_f1_score': 0.19314642}
confusion matrix:
      0   1
0  5916  30
1   229  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512113_30.png
early stop counter: 15
val acc:0.9667556285858154, best validation acc: 0.9668623208999634, corresponding to test acc:                         0.9611666202545166 / 0.9653561115264893
after epoch: 30,now: 2024-06-20 15:55:27.312632,epoch time: 0:23:19.567088,used: 9:24:28.872189,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_06_30_58_seed_1_21512113
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 9:24:28.872189 at 2024-06-20 15:55:27.312632
persisted model performance metric: 

scalar performance:
{'acc': 0.9611666, 'precision': 0.8152816, 'recall': 0.5714792, 'specificity': 0.5714792, 'f1': 0.609911, 'auroc': 0.8236182, 'binary_precision': 0.6666667, 'binary_recall': 0.14615385, 'binary_specificity': 0.9968046, 'binary_f1_score': 0.23974764}
confusion matrix:
      0   1
0  5927  19
1   222  38
oracle model performance metric: 

scalar performance:
{'acc': 0.9653561, 'precision': 0.8606288, 'recall': 0.62699616, 'specificity': 0.62699616, 'f1': 0.68306553, 'auroc': 0.8173096, 'binary_precision': 0.752809, 'binary_recall': 0.2576923, 'binary_specificity': 0.99630004, 'binary_f1_score': 0.38395417}
confusion matrix:
      0   1
0  5924  22
1   193  67
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_irm_resnet_different_bs128_lre4_classbalancing/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_irm_resnet_different_bs128_lre4_classbalancing/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204094 KiB |   1730 MiB | 717109 GiB | 717109 GiB |
|       from large pool | 167936 KiB |   1660 MiB | 716908 GiB | 716908 GiB |
|       from small pool |  36158 KiB |     72 MiB |    201 GiB |    201 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 204094 KiB |   1730 MiB | 717109 GiB | 717109 GiB |
|       from large pool | 167936 KiB |   1660 MiB | 716908 GiB | 716908 GiB |
|       from small pool |  36158 KiB |     72 MiB |    201 GiB |    201 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201086 KiB |   1723 MiB | 717093 GiB | 717093 GiB |
|       from large pool | 165120 KiB |   1653 MiB | 716895 GiB | 716895 GiB |
|       from small pool |  35966 KiB |     71 MiB |    198 GiB |    198 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1802 MiB |   1876 MiB |   3084 MiB |   1282 MiB |
|       from large pool |   1728 MiB |   1802 MiB |   2978 MiB |   1250 MiB |
|       from small pool |     74 MiB |     74 MiB |    106 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 404161 KiB |    900 MiB | 507967 GiB | 507967 GiB |
|       from large pool | 397312 KiB |    899 MiB | 507759 GiB | 507759 GiB |
|       from small pool |   6849 KiB |     14 MiB |    207 GiB |    207 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1194    |    1851    |   21518 K  |   21517 K  |
|       from large pool |      36    |      76    |    6818 K  |    6818 K  |
|       from small pool |    1158    |    1780    |   14700 K  |   14699 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1194    |    1851    |   21518 K  |   21517 K  |
|       from large pool |      36    |      76    |    6818 K  |    6818 K  |
|       from small pool |    1158    |    1780    |   14700 K  |   14699 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      49    |      50    |      69    |      20    |
|       from large pool |      12    |      13    |      16    |       4    |
|       from small pool |      37    |      37    |      53    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      34    |     380    |   10947 K  |   10947 K  |
|       from large pool |       5    |      11    |    2688 K  |    2688 K  |
|       from small pool |      29    |     375    |    8258 K  |    8258 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1730 MiB | 717109 GiB | 717109 GiB |
|       from large pool |  16640 KiB |   1660 MiB | 716908 GiB | 716908 GiB |
|       from small pool |      0 KiB |     72 MiB |    201 GiB |    201 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1730 MiB | 717109 GiB | 717109 GiB |
|       from large pool |  16640 KiB |   1660 MiB | 716908 GiB | 716908 GiB |
|       from small pool |      0 KiB |     72 MiB |    201 GiB |    201 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1723 MiB | 717093 GiB | 717093 GiB |
|       from large pool |  16640 KiB |   1653 MiB | 716895 GiB | 716895 GiB |
|       from small pool |      0 KiB |     71 MiB |    198 GiB |    198 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 608256 KiB |   1876 MiB |   3084 MiB |   2490 MiB |
|       from large pool | 565248 KiB |   1802 MiB |   2978 MiB |   2426 MiB |
|       from small pool |  43008 KiB |     74 MiB |    106 MiB |     64 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 384768 KiB |    900 MiB | 507967 GiB | 507967 GiB |
|       from large pool | 384768 KiB |    899 MiB | 507759 GiB | 507759 GiB |
|       from small pool |      0 KiB |     14 MiB |    207 GiB |    207 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1851    |   21518 K  |   21518 K  |
|       from large pool |       2    |      76    |    6818 K  |    6818 K  |
|       from small pool |       0    |    1780    |   14700 K  |   14700 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1851    |   21518 K  |   21518 K  |
|       from large pool |       2    |      76    |    6818 K  |    6818 K  |
|       from small pool |       0    |    1780    |   14700 K  |   14700 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      30    |      50    |      69    |      39    |
|       from large pool |       9    |      13    |      16    |       7    |
|       from small pool |      21    |      37    |      53    |      32    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     380    |   10947 K  |   10947 K  |
|       from large pool |       1    |      11    |    2688 K  |    2688 K  |
|       from small pool |       0    |     375    |    8259 K  |    8259 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1730 MiB | 717109 GiB | 717109 GiB |
|       from large pool |  16640 KiB |   1660 MiB | 716908 GiB | 716908 GiB |
|       from small pool |      0 KiB |     72 MiB |    201 GiB |    201 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1730 MiB | 717109 GiB | 717109 GiB |
|       from large pool |  16640 KiB |   1660 MiB | 716908 GiB | 716908 GiB |
|       from small pool |      0 KiB |     72 MiB |    201 GiB |    201 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1723 MiB | 717093 GiB | 717093 GiB |
|       from large pool |  16640 KiB |   1653 MiB | 716895 GiB | 716895 GiB |
|       from small pool |      0 KiB |     71 MiB |    198 GiB |    198 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 608256 KiB |   1876 MiB |   3084 MiB |   2490 MiB |
|       from large pool | 565248 KiB |   1802 MiB |   2978 MiB |   2426 MiB |
|       from small pool |  43008 KiB |     74 MiB |    106 MiB |     64 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 384768 KiB |    900 MiB | 507967 GiB | 507967 GiB |
|       from large pool | 384768 KiB |    899 MiB | 507759 GiB | 507759 GiB |
|       from small pool |      0 KiB |     14 MiB |    207 GiB |    207 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1851    |   21518 K  |   21518 K  |
|       from large pool |       2    |      76    |    6818 K  |    6818 K  |
|       from small pool |       0    |    1780    |   14700 K  |   14700 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1851    |   21518 K  |   21518 K  |
|       from large pool |       2    |      76    |    6818 K  |    6818 K  |
|       from small pool |       0    |    1780    |   14700 K  |   14700 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      30    |      50    |      69    |      39    |
|       from large pool |       9    |      13    |      16    |       7    |
|       from small pool |      21    |      37    |      53    |      32    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     380    |   10947 K  |   10947 K  |
|       from large pool |       1    |      11    |    2688 K  |    2688 K  |
|       from small pool |       0    |     375    |    8259 K  |    8259 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0




!!!: not committed yet



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_09_14_seed_2_21512113

 Experiment start at: 2024-06-20 16:09:14.977595
before training, model accuracy: 0.0544959120452404
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.94337004, 'precision': 0.9640447, 'recall': 0.71031183, 'specificity': 0.71031183, 'f1': 0.7799896, 'auroc': 0.943269, 'binary_precision': 0.9865841, 'binary_recall': 0.42123815, 'binary_specificity': 0.9993855, 'binary_f1_score': 0.5903968}
confusion matrix:
       0     1
0  42283    26
1   2627  1912
---- Validation: 
scalar performance:
{'acc': 0.96713364, 'precision': 0.4839535, 'recall': 0.49958727, 'specificity': 0.49958727, 'f1': 0.4916461, 'auroc': 0.55419284, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99917454, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18156  15
1    602   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608912, 'precision': 0.48059964, 'recall': 0.49983326, 'specificity': 0.49983326, 'f1': 0.49002782, 'auroc': 0.60091287, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5995  2
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512113_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-20 16:38:55.382168,epoch time: 0:29:40.404573,used: 0:29:40.404573,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_09_14_seed_2_21512113
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9683231, 'precision': 0.9787067, 'recall': 0.8393444, 'specificity': 0.8393444, 'f1': 0.8943833, 'auroc': 0.9718356, 'binary_precision': 0.99068123, 'binary_recall': 0.67937416, 'binary_specificity': 0.9993146, 'binary_f1_score': 0.8060131}
confusion matrix:
       0     1
0  42281    29
1   1455  3083
---- Validation: 
scalar performance:
{'acc': 0.9688382, 'precision': 0.81504446, 'recall': 0.52857447, 'specificity': 0.52857447, 'f1': 0.54550636, 'auroc': 0.65404785, 'binary_precision': 0.6603774, 'binary_recall': 0.058139537, 'binary_specificity': 0.99900943, 'binary_f1_score': 0.10687023}
confusion matrix:
       0   1
0  18153  18
1    567  35
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96105146, 'precision': 0.71648985, 'recall': 0.51577854, 'specificity': 0.51577854, 'f1': 0.52094454, 'auroc': 0.6843966, 'binary_precision': 0.47058824, 'binary_recall': 0.03305785, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.06177606}
confusion matrix:
      0  1
0  5988  9
1   234  8
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512113_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-20 17:16:17.619842,epoch time: 0:37:22.237674,used: 1:07:02.642247,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_09_14_seed_2_21512113
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97513235, 'precision': 0.98059666, 'recall': 0.87609303, 'specificity': 0.87609303, 'f1': 0.9204173, 'auroc': 0.9810196, 'binary_precision': 0.9870092, 'binary_recall': 0.7532496, 'binary_specificity': 0.9989364, 'binary_f1_score': 0.85442954}
confusion matrix:
       0     1
0  42264    45
1   1120  3419
---- Validation: 
scalar performance:
{'acc': 0.9691046, 'precision': 0.78393614, 'recall': 0.5552126, 'specificity': 0.5552126, 'f1': 0.58709806, 'auroc': 0.69528675, 'binary_precision': 0.5964912, 'binary_recall': 0.11295681, 'binary_specificity': 0.9974685, 'binary_f1_score': 0.18994413}
confusion matrix:
       0   1
0  18125  46
1    534  68
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96537906, 'precision': 0.8540405, 'recall': 0.5814774, 'specificity': 0.5814774, 'f1': 0.6262696, 'auroc': 0.71153283, 'binary_precision': 0.7407407, 'binary_recall': 0.16528925, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.27027026}
confusion matrix:
      0   1
0  5983  14
1   202  40
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512113_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-20 17:49:18.300561,epoch time: 0:33:00.680719,used: 1:40:03.322966,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_09_14_seed_2_21512113
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98121583, 'precision': 0.9810307, 'recall': 0.91022146, 'specificity': 0.91022146, 'f1': 0.94209987, 'auroc': 0.9860412, 'binary_precision': 0.9808097, 'binary_recall': 0.82216835, 'binary_specificity': 0.9982746, 'binary_f1_score': 0.89450973}
confusion matrix:
       0     1
0  42237    73
1    807  3731
---- Validation: 
scalar performance:
{'acc': 0.9688382, 'precision': 0.7626161, 'recall': 0.5719391, 'specificity': 0.5719391, 'f1': 0.60869277, 'auroc': 0.74008834, 'binary_precision': 0.55279505, 'binary_recall': 0.14784053, 'binary_specificity': 0.99603766, 'binary_f1_score': 0.23328966}
confusion matrix:
       0   1
0  18099  72
1    513  89
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96714216, 'precision': 0.8812814, 'recall': 0.6022219, 'specificity': 0.6022219, 'f1': 0.6555142, 'auroc': 0.7483274, 'binary_precision': 0.7936508, 'binary_recall': 0.20661157, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.32786885}
confusion matrix:
      0   1
0  5984  13
1   192  50
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512113_4.png
new oracle model saved
early stop counter: 1
val acc:0.9688382148742676, best validation acc: 0.9691045880317688, corresponding to test acc:                         0.9653790593147278 / 0.9671421647071838
after epoch: 4,now: 2024-06-20 18:12:16.508465,epoch time: 0:22:58.207904,used: 2:03:01.530870,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_09_14_seed_2_21512113
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98352116, 'precision': 0.9832027, 'recall': 0.92153084, 'specificity': 0.92153084, 'f1': 0.94972706, 'auroc': 0.9894514, 'binary_precision': 0.9828205, 'binary_recall': 0.8446452, 'binary_specificity': 0.9984164, 'binary_f1_score': 0.9085091}
confusion matrix:
       0     1
0  42243    67
1    705  3833
---- Validation: 
scalar performance:
{'acc': 0.9685719, 'precision': 0.75190246, 'recall': 0.5838472, 'specificity': 0.5838472, 'f1': 0.6222982, 'auroc': 0.7596876, 'binary_precision': 0.53061223, 'binary_recall': 0.17275748, 'binary_specificity': 0.994937, 'binary_f1_score': 0.26065162}
confusion matrix:
       0    1
0  18079   92
1    498  104
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96730244, 'precision': 0.8538937, 'recall': 0.62014997, 'specificity': 0.62014997, 'f1': 0.6748389, 'auroc': 0.7636991, 'binary_precision': 0.7375, 'binary_recall': 0.24380165, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.36645964}
confusion matrix:
      0   1
0  5976  21
1   183  59
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512113_5.png
new oracle model saved
early stop counter: 2
val acc:0.9685719013214111, best validation acc: 0.9691045880317688, corresponding to test acc:                         0.9653790593147278 / 0.9673024415969849
after epoch: 5,now: 2024-06-20 18:39:26.871934,epoch time: 0:27:10.363469,used: 2:30:11.894339,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_09_14_seed_2_21512113
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9843323, 'precision': 0.9830574, 'recall': 0.9263239, 'specificity': 0.9263239, 'f1': 0.95246553, 'auroc': 0.990569, 'binary_precision': 0.9815237, 'binary_recall': 0.8543732, 'binary_specificity': 0.9982746, 'binary_f1_score': 0.91354537}
confusion matrix:
       0     1
0  42236    73
1    661  3878
---- Validation: 
scalar performance:
{'acc': 0.9686784, 'precision': 0.7556758, 'recall': 0.579084, 'specificity': 0.579084, 'f1': 0.6170026, 'auroc': 0.761938, 'binary_precision': 0.53846157, 'binary_recall': 0.1627907, 'binary_specificity': 0.99537724, 'binary_f1_score': 0.25}
confusion matrix:
       0   1
0  18087  84
1    504  98
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9674627, 'precision': 0.8721651, 'recall': 0.61230236, 'specificity': 0.61230236, 'f1': 0.66737527, 'auroc': 0.7601654, 'binary_precision': 0.7746479, 'binary_recall': 0.22727273, 'binary_specificity': 0.997332, 'binary_f1_score': 0.35143772}
confusion matrix:
      0   1
0  5981  16
1   187  55
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512113_6.png
new oracle model saved
early stop counter: 3
val acc:0.9686784148216248, best validation acc: 0.9691045880317688, corresponding to test acc:                         0.9653790593147278 / 0.9674627184867859
after epoch: 6,now: 2024-06-20 19:13:08.178781,epoch time: 0:33:41.306847,used: 3:03:53.201186,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_09_14_seed_2_21512113
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98625344, 'precision': 0.982481, 'recall': 0.9379097, 'specificity': 0.9379097, 'f1': 0.9588344, 'auroc': 0.991744, 'binary_precision': 0.9779141, 'binary_recall': 0.8779467, 'binary_specificity': 0.99787277, 'binary_f1_score': 0.925238}
confusion matrix:
       0     1
0  42219    90
1    554  3985
---- Validation: 
scalar performance:
{'acc': 0.9687317, 'precision': 0.7550441, 'recall': 0.5887481, 'specificity': 0.5887481, 'f1': 0.62831855, 'auroc': 0.7790127, 'binary_precision': 0.5365854, 'binary_recall': 0.18272425, 'binary_specificity': 0.9947719, 'binary_f1_score': 0.27261463}
confusion matrix:
       0    1
0  18076   95
1    492  110
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96826416, 'precision': 0.8799713, 'recall': 0.6226329, 'specificity': 0.6226329, 'f1': 0.6805378, 'auroc': 0.7741687, 'binary_precision': 0.7894737, 'binary_recall': 0.24793388, 'binary_specificity': 0.997332, 'binary_f1_score': 0.3773585}
confusion matrix:
      0   1
0  5981  16
1   182  60
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512113_7.png
new oracle model saved
early stop counter: 4
val acc:0.968731701374054, best validation acc: 0.9691045880317688, corresponding to test acc:                         0.9653790593147278 / 0.9682641625404358
after epoch: 7,now: 2024-06-20 19:42:21.470476,epoch time: 0:29:13.291695,used: 3:33:06.492881,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_09_14_seed_2_21512113
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9848446, 'precision': 0.98207676, 'recall': 0.93013257, 'specificity': 0.93013257, 'f1': 0.9542428, 'auroc': 0.99118817, 'binary_precision': 0.9787394, 'binary_recall': 0.8622741, 'binary_specificity': 0.997991, 'binary_f1_score': 0.9168229}
confusion matrix:
       0     1
0  42225    85
1    625  3913
---- Validation: 
scalar performance:
{'acc': 0.9693176, 'precision': 0.7751188, 'recall': 0.57861114, 'specificity': 0.57861114, 'f1': 0.61814284, 'auroc': 0.78678465, 'binary_precision': 0.57738096, 'binary_recall': 0.16112956, 'binary_specificity': 0.9960927, 'binary_f1_score': 0.25194806}
confusion matrix:
       0   1
0  18100  71
1    505  97
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96730244, 'precision': 0.87047684, 'recall': 0.6102362, 'specificity': 0.6102362, 'f1': 0.6646929, 'auroc': 0.76907873, 'binary_precision': 0.7714286, 'binary_recall': 0.2231405, 'binary_specificity': 0.997332, 'binary_f1_score': 0.34615383}
confusion matrix:
      0   1
0  5981  16
1   188  54
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512113_8.png
better model found
persisted
after epoch: 8,now: 2024-06-20 20:03:45.049743,epoch time: 0:21:23.579267,used: 3:54:30.072148,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_09_14_seed_2_21512113
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9877903, 'precision': 0.9852874, 'recall': 0.9441693, 'specificity': 0.9441693, 'f1': 0.9635811, 'auroc': 0.9930304, 'binary_precision': 0.9822514, 'binary_recall': 0.8900639, 'binary_specificity': 0.9982746, 'binary_f1_score': 0.93388814}
confusion matrix:
       0     1
0  42236    73
1    499  4040
---- Validation: 
scalar performance:
{'acc': 0.9691046, 'precision': 0.76203716, 'recall': 0.5977742, 'specificity': 0.5977742, 'f1': 0.6393052, 'auroc': 0.7990239, 'binary_precision': 0.55, 'binary_recall': 0.20099668, 'binary_specificity': 0.9945518, 'binary_f1_score': 0.29440388}
confusion matrix:
       0    1
0  18072   99
1    481  121
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9668216, 'precision': 0.85149795, 'recall': 0.6119689, 'specificity': 0.6119689, 'f1': 0.6649908, 'auroc': 0.78984857, 'binary_precision': 0.73333335, 'binary_recall': 0.22727273, 'binary_specificity': 0.996665, 'binary_f1_score': 0.34700316}
confusion matrix:
      0   1
0  5977  20
1   187  55
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512113_9.png
early stop counter: 1
val acc:0.9691045880317688, best validation acc: 0.969317615032196, corresponding to test acc:                         0.9673024415969849 / 0.9682641625404358
after epoch: 9,now: 2024-06-20 20:23:47.789793,epoch time: 0:20:02.740050,used: 4:14:32.812198,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_09_14_seed_2_21512113
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9879824, 'precision': 0.98446536, 'recall': 0.9460457, 'specificity': 0.9460457, 'f1': 0.96425426, 'auroc': 0.99481046, 'binary_precision': 0.98019326, 'binary_recall': 0.8940295, 'binary_specificity': 0.9980619, 'binary_f1_score': 0.9351308}
confusion matrix:
       0     1
0  42227    82
1    481  4058
---- Validation: 
scalar performance:
{'acc': 0.968998, 'precision': 0.7615329, 'recall': 0.5896887, 'specificity': 0.5896887, 'f1': 0.6301396, 'auroc': 0.80059683, 'binary_precision': 0.54950494, 'binary_recall': 0.18438539, 'binary_specificity': 0.994992, 'binary_f1_score': 0.27611944}
confusion matrix:
       0    1
0  18080   91
1    491  111
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9661805, 'precision': 0.8380024, 'recall': 0.6076699, 'specificity': 0.6076699, 'f1': 0.6585171, 'auroc': 0.7858895, 'binary_precision': 0.70666665, 'binary_recall': 0.21900827, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.33438486}
confusion matrix:
      0   1
0  5975  22
1   189  53
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512113_10.png
early stop counter: 2
val acc:0.9689980149269104, best validation acc: 0.969317615032196, corresponding to test acc:                         0.9673024415969849 / 0.9682641625404358
after epoch: 10,now: 2024-06-20 20:45:31.071198,epoch time: 0:21:43.281405,used: 4:36:16.093603,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_09_14_seed_2_21512113
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98828125, 'precision': 0.9836223, 'recall': 0.94856024, 'specificity': 0.94856024, 'f1': 0.9652581, 'auroc': 0.9937726, 'binary_precision': 0.9779535, 'binary_recall': 0.89929485, 'binary_specificity': 0.99782556, 'binary_f1_score': 0.93697625}
confusion matrix:
       0     1
0  42218    92
1    457  4081
---- Validation: 
scalar performance:
{'acc': 0.9692644, 'precision': 0.76792955, 'recall': 0.5914324, 'specificity': 0.5914324, 'f1': 0.63287044, 'auroc': 0.8012886, 'binary_precision': 0.56218904, 'binary_recall': 0.18770765, 'binary_specificity': 0.9951571, 'binary_f1_score': 0.28144458}
confusion matrix:
       0    1
0  18083   88
1    489  113
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96602017, 'precision': 0.838681, 'recall': 0.603621, 'specificity': 0.603621, 'f1': 0.65370613, 'auroc': 0.7772571, 'binary_precision': 0.7083333, 'binary_recall': 0.2107438, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.32484075}
confusion matrix:
      0   1
0  5976  21
1   191  51
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512113_11.png
early stop counter: 3
val acc:0.9692643880844116, best validation acc: 0.969317615032196, corresponding to test acc:                         0.9673024415969849 / 0.9682641625404358
after epoch: 11,now: 2024-06-20 21:05:32.537751,epoch time: 0:20:01.466553,used: 4:56:17.560156,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_09_14_seed_2_21512113
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98917776, 'precision': 0.9847329, 'recall': 0.95270616, 'specificity': 0.95270616, 'f1': 0.96802795, 'auroc': 0.9953375, 'binary_precision': 0.9793153, 'binary_recall': 0.9074686, 'binary_specificity': 0.9979437, 'binary_f1_score': 0.94202405}
confusion matrix:
       0     1
0  42222    87
1    420  4119
---- Validation: 
scalar performance:
{'acc': 0.968998, 'precision': 0.75824875, 'recall': 0.60414356, 'specificity': 0.60414356, 'f1': 0.6456436, 'auroc': 0.82273626, 'binary_precision': 0.5420168, 'binary_recall': 0.21428572, 'binary_specificity': 0.99400145, 'binary_f1_score': 0.30714285}
confusion matrix:
       0    1
0  18062  109
1    473  129
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9661805, 'precision': 0.8305767, 'recall': 0.61361814, 'specificity': 0.61361814, 'f1': 0.6646951, 'auroc': 0.8071281, 'binary_precision': 0.69135803, 'binary_recall': 0.23140496, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.34674925}
confusion matrix:
      0   1
0  5972  25
1   186  56
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512113_12.png
early stop counter: 4
val acc:0.9689980149269104, best validation acc: 0.969317615032196, corresponding to test acc:                         0.9673024415969849 / 0.9682641625404358
after epoch: 12,now: 2024-06-20 21:24:29.890803,epoch time: 0:18:57.353052,used: 5:15:14.913208,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_09_14_seed_2_21512113
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98954064, 'precision': 0.983655, 'recall': 0.9558572, 'specificity': 0.9558572, 'f1': 0.9692356, 'auroc': 0.9946791, 'binary_precision': 0.97646505, 'binary_recall': 0.914078, 'binary_specificity': 0.99763644, 'binary_f1_score': 0.9442422}
confusion matrix:
       0     1
0  42209   100
1    390  4149
---- Validation: 
scalar performance:
{'acc': 0.9693709, 'precision': 0.76843596, 'recall': 0.5979118, 'specificity': 0.5979118, 'f1': 0.6402752, 'auroc': 0.8235049, 'binary_precision': 0.5627907, 'binary_recall': 0.20099668, 'binary_specificity': 0.9948269, 'binary_f1_score': 0.2962056}
confusion matrix:
       0    1
0  18077   94
1    481  121
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642571, 'precision': 0.80093193, 'recall': 0.59080744, 'specificity': 0.59080744, 'f1': 0.63460433, 'auroc': 0.78974664, 'binary_precision': 0.63380283, 'binary_recall': 0.18595041, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.28753996}
confusion matrix:
      0   1
0  5971  26
1   197  45
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512113_13.png
better model found
persisted
after epoch: 13,now: 2024-06-20 21:42:56.458665,epoch time: 0:18:26.567862,used: 5:33:41.481070,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_09_14_seed_2_21512113
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9887722, 'precision': 0.98384964, 'recall': 0.9512032, 'specificity': 0.9512032, 'f1': 0.96680593, 'auroc': 0.99509585, 'binary_precision': 0.97785187, 'binary_recall': 0.90460455, 'binary_specificity': 0.9978019, 'binary_f1_score': 0.9398031}
confusion matrix:
       0     1
0  42216    93
1    433  4106
---- Validation: 
scalar performance:
{'acc': 0.9693176, 'precision': 0.76846564, 'recall': 0.59386903, 'specificity': 0.59386903, 'f1': 0.635725, 'auroc': 0.82474947, 'binary_precision': 0.5631068, 'binary_recall': 0.19269103, 'binary_specificity': 0.99504703, 'binary_f1_score': 0.28712872}
confusion matrix:
       0    1
0  18081   90
1    486  116
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9632954, 'precision': 0.7835601, 'recall': 0.57841074, 'specificity': 0.57841074, 'f1': 0.6176282, 'auroc': 0.79140294, 'binary_precision': 0.6, 'binary_recall': 0.16115703, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.25407168}
confusion matrix:
      0   1
0  5971  26
1   203  39
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512113_14.png
early stop counter: 1
val acc:0.969317615032196, best validation acc: 0.9693709015846252, corresponding to test acc:                         0.9642571210861206 / 0.9682641625404358
after epoch: 14,now: 2024-06-20 22:01:14.015132,epoch time: 0:18:17.556467,used: 5:51:59.037537,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_09_14_seed_2_21512113
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98981816, 'precision': 0.9841434, 'recall': 0.95699424, 'specificity': 0.95699424, 'f1': 0.9700731, 'auroc': 0.9957472, 'binary_precision': 0.9772087, 'binary_recall': 0.9162811, 'binary_specificity': 0.99770737, 'binary_f1_score': 0.9457646}
confusion matrix:
       0     1
0  42212    97
1    380  4159
---- Validation: 
scalar performance:
{'acc': 0.9691578, 'precision': 0.76395655, 'recall': 0.5953926, 'specificity': 0.5953926, 'f1': 0.63690364, 'auroc': 0.82053113, 'binary_precision': 0.5539906, 'binary_recall': 0.19601329, 'binary_specificity': 0.9947719, 'binary_f1_score': 0.28957054}
confusion matrix:
       0    1
0  18076   95
1    484  118
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9631351, 'precision': 0.7754513, 'recall': 0.5842756, 'specificity': 0.5842756, 'f1': 0.6243038, 'auroc': 0.795118, 'binary_precision': 0.5833333, 'binary_recall': 0.17355372, 'binary_specificity': 0.9949975, 'binary_f1_score': 0.26751593}
confusion matrix:
      0   1
0  5967  30
1   200  42
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512113_15.png
early stop counter: 2
val acc:0.9691578149795532, best validation acc: 0.9693709015846252, corresponding to test acc:                         0.9642571210861206 / 0.9682641625404358
after epoch: 15,now: 2024-06-20 22:19:52.584028,epoch time: 0:18:38.568896,used: 6:10:37.606433,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_09_14_seed_2_21512113
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9904585, 'precision': 0.98669016, 'recall': 0.95822483, 'specificity': 0.95822483, 'f1': 0.97191525, 'auroc': 0.99559456, 'binary_precision': 0.98208815, 'binary_recall': 0.9182459, 'binary_specificity': 0.99820375, 'binary_f1_score': 0.9490946}
confusion matrix:
       0     1
0  42234    76
1    371  4167
---- Validation: 
scalar performance:
{'acc': 0.9692111, 'precision': 0.7645614, 'recall': 0.5978292, 'specificity': 0.5978292, 'f1': 0.6396919, 'auroc': 0.83168626, 'binary_precision': 0.55504584, 'binary_recall': 0.20099668, 'binary_specificity': 0.9946618, 'binary_f1_score': 0.29512194}
confusion matrix:
       0    1
0  18074   97
1    481  121
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96297485, 'precision': 0.77145326, 'recall': 0.5841922, 'specificity': 0.5841922, 'f1': 0.62383735, 'auroc': 0.7992972, 'binary_precision': 0.5753425, 'binary_recall': 0.17355372, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.26666668}
confusion matrix:
      0   1
0  5966  31
1   200  42
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512113_16.png
early stop counter: 3
val acc:0.9692111015319824, best validation acc: 0.9693709015846252, corresponding to test acc:                         0.9642571210861206 / 0.9682641625404358
after epoch: 16,now: 2024-06-20 22:37:49.882930,epoch time: 0:17:57.298902,used: 6:28:34.905335,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_09_14_seed_2_21512113
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9909921, 'precision': 0.9854244, 'recall': 0.96255314, 'specificity': 0.96255314, 'f1': 0.9736393, 'auroc': 0.99587786, 'binary_precision': 0.9786047, 'binary_recall': 0.9272807, 'binary_specificity': 0.99782556, 'binary_f1_score': 0.9522516}
confusion matrix:
       0     1
0  42218    92
1    330  4208
---- Validation: 
scalar performance:
{'acc': 0.9687317, 'precision': 0.7537973, 'recall': 0.5959755, 'specificity': 0.5959755, 'f1': 0.6362497, 'auroc': 0.83357656, 'binary_precision': 0.5336323, 'binary_recall': 0.19767442, 'binary_specificity': 0.9942766, 'binary_f1_score': 0.28848487}
confusion matrix:
       0    1
0  18067  104
1    483  119
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9632954, 'precision': 0.7835601, 'recall': 0.57841074, 'specificity': 0.57841074, 'f1': 0.6176282, 'auroc': 0.8014639, 'binary_precision': 0.6, 'binary_recall': 0.16115703, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.25407168}
confusion matrix:
      0   1
0  5971  26
1   203  39
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512113_17.png
early stop counter: 4
val acc:0.968731701374054, best validation acc: 0.9693709015846252, corresponding to test acc:                         0.9642571210861206 / 0.9682641625404358
after epoch: 17,now: 2024-06-20 22:56:00.191985,epoch time: 0:18:10.309055,used: 6:46:45.214390,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_09_14_seed_2_21512113
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9909068, 'precision': 0.9874895, 'recall': 0.9600554, 'specificity': 0.9600554, 'f1': 0.9732702, 'auroc': 0.9957513, 'binary_precision': 0.98331374, 'binary_recall': 0.92178893, 'binary_specificity': 0.9983219, 'binary_f1_score': 0.9515578}
confusion matrix:
       0     1
0  42238    71
1    355  4184
---- Validation: 
scalar performance:
{'acc': 0.9690513, 'precision': 0.7644061, 'recall': 0.58489794, 'specificity': 0.58489794, 'f1': 0.62483966, 'auroc': 0.8209655, 'binary_precision': 0.5555556, 'binary_recall': 0.1744186, 'binary_specificity': 0.99537724, 'binary_f1_score': 0.26548675}
confusion matrix:
       0    1
0  18087   84
1    497  105
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96281457, 'precision': 0.7777417, 'recall': 0.5662642, 'specificity': 0.5662642, 'f1': 0.60121447, 'auroc': 0.7847555, 'binary_precision': 0.58928573, 'binary_recall': 0.13636364, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.22147653}
confusion matrix:
      0   1
0  5974  23
1   209  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512113_18.png
early stop counter: 5
val acc:0.9690513014793396, best validation acc: 0.9693709015846252, corresponding to test acc:                         0.9642571210861206 / 0.9682641625404358
after epoch: 18,now: 2024-06-20 23:14:52.603110,epoch time: 0:18:52.411125,used: 7:05:37.625515,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_09_14_seed_2_21512113
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.991291, 'precision': 0.98572415, 'recall': 0.964005, 'specificity': 0.964005, 'f1': 0.97454995, 'auroc': 0.9967911, 'binary_precision': 0.97890097, 'binary_recall': 0.9301608, 'binary_specificity': 0.99784917, 'binary_f1_score': 0.9539087}
confusion matrix:
       0     1
0  42218    91
1    317  4222
---- Validation: 
scalar performance:
{'acc': 0.9686251, 'precision': 0.75341094, 'recall': 0.5830717, 'specificity': 0.5830717, 'f1': 0.6215464, 'auroc': 0.8305081, 'binary_precision': 0.53367877, 'binary_recall': 0.17109634, 'binary_specificity': 0.99504703, 'binary_f1_score': 0.2591195}
confusion matrix:
       0    1
0  18081   90
1    499  103
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9623337, 'precision': 0.76101935, 'recall': 0.56997955, 'specificity': 0.56997955, 'f1': 0.6051016, 'auroc': 0.7930368, 'binary_precision': 0.5555556, 'binary_recall': 0.1446281, 'binary_specificity': 0.995331, 'binary_f1_score': 0.22950819}
confusion matrix:
      0   1
0  5969  28
1   207  35
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512113_19.png
early stop counter: 6
val acc:0.9686251282691956, best validation acc: 0.9693709015846252, corresponding to test acc:                         0.9642571210861206 / 0.9682641625404358
after epoch: 19,now: 2024-06-20 23:33:22.555830,epoch time: 0:18:29.952720,used: 7:24:07.578235,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_09_14_seed_2_21512113
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9916325, 'precision': 0.98866236, 'recall': 0.96311235, 'specificity': 0.96311235, 'f1': 0.97545356, 'auroc': 0.99585295, 'binary_precision': 0.9850292, 'binary_recall': 0.9277374, 'binary_specificity': 0.9984873, 'binary_f1_score': 0.9555253}
confusion matrix:
       0     1
0  42245    64
1    328  4211
---- Validation: 
scalar performance:
{'acc': 0.9688382, 'precision': 0.75683343, 'recall': 0.5928184, 'specificity': 0.5928184, 'f1': 0.633141, 'auroc': 0.8397007, 'binary_precision': 0.5399061, 'binary_recall': 0.1910299, 'binary_specificity': 0.9946068, 'binary_f1_score': 0.2822086}
confusion matrix:
       0    1
0  18073   98
1    487  115
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608912, 'precision': 0.72599864, 'recall': 0.56724644, 'specificity': 0.56724644, 'f1': 0.5989464, 'auroc': 0.8034418, 'binary_precision': 0.4857143, 'binary_recall': 0.14049587, 'binary_specificity': 0.993997, 'binary_f1_score': 0.21794872}
confusion matrix:
      0   1
0  5961  36
1   208  34
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512113_20.png
early stop counter: 7
val acc:0.9688382148742676, best validation acc: 0.9693709015846252, corresponding to test acc:                         0.9642571210861206 / 0.9682641625404358
after epoch: 20,now: 2024-06-20 23:57:57.469407,epoch time: 0:24:34.913577,used: 7:48:42.491812,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_09_14_seed_2_21512113
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9909921, 'precision': 0.98592436, 'recall': 0.96206135, 'specificity': 0.96206135, 'f1': 0.97361255, 'auroc': 0.99597526, 'binary_precision': 0.9797203, 'binary_recall': 0.92617893, 'binary_specificity': 0.99794376, 'binary_f1_score': 0.95219755}
confusion matrix:
       0     1
0  42223    87
1    335  4203
---- Validation: 
scalar performance:
{'acc': 0.9681457, 'precision': 0.7413732, 'recall': 0.5884454, 'specificity': 0.5884454, 'f1': 0.6263334, 'auroc': 0.8338245, 'binary_precision': 0.5092593, 'binary_recall': 0.18272425, 'binary_specificity': 0.99416655, 'binary_f1_score': 0.26894864}
confusion matrix:
       0    1
0  18065  106
1    492  110
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.7336012, 'recall': 0.57930964, 'specificity': 0.57930964, 'f1': 0.6142697, 'auroc': 0.7921368, 'binary_precision': 0.5, 'binary_recall': 0.16528925, 'binary_specificity': 0.99333, 'binary_f1_score': 0.2484472}
confusion matrix:
      0   1
0  5957  40
1   202  40
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512113_21.png
early stop counter: 8
val acc:0.9681457281112671, best validation acc: 0.9693709015846252, corresponding to test acc:                         0.9642571210861206 / 0.9682641625404358
after epoch: 21,now: 2024-06-21 00:21:52.902306,epoch time: 0:23:55.432899,used: 8:12:37.924711,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_09_14_seed_2_21512113
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99235827, 'precision': 0.9896243, 'recall': 0.96636593, 'specificity': 0.96636593, 'f1': 0.9776371, 'auroc': 0.99696565, 'binary_precision': 0.98627585, 'binary_recall': 0.93412644, 'binary_specificity': 0.9986055, 'binary_f1_score': 0.9594931}
confusion matrix:
       0     1
0  42250    59
1    299  4240
---- Validation: 
scalar performance:
{'acc': 0.9687317, 'precision': 0.75638884, 'recall': 0.5823237, 'specificity': 0.5823237, 'f1': 0.62096536, 'auroc': 0.8399227, 'binary_precision': 0.53968257, 'binary_recall': 0.16943522, 'binary_specificity': 0.99521214, 'binary_f1_score': 0.2579014}
confusion matrix:
       0    1
0  18084   87
1    500  102
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9615323, 'precision': 0.74195933, 'recall': 0.5556835, 'specificity': 0.5556835, 'f1': 0.584744, 'auroc': 0.7981017, 'binary_precision': 0.5185185, 'binary_recall': 0.11570248, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.1891892}
confusion matrix:
      0   1
0  5971  26
1   214  28
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512113_22.png
early stop counter: 9
val acc:0.968731701374054, best validation acc: 0.9693709015846252, corresponding to test acc:                         0.9642571210861206 / 0.9682641625404358
after epoch: 22,now: 2024-06-21 00:45:18.709115,epoch time: 0:23:25.806809,used: 8:36:03.731520,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_09_14_seed_2_21512113
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9921235, 'precision': 0.98937666, 'recall': 0.96525264, 'specificity': 0.96525264, 'f1': 0.97692895, 'auroc': 0.9967735, 'binary_precision': 0.986014, 'binary_recall': 0.93192333, 'binary_specificity': 0.9985819, 'binary_f1_score': 0.95820594}
confusion matrix:
       0     1
0  42249    60
1    309  4230
---- Validation: 
scalar performance:
{'acc': 0.9683588, 'precision': 0.7468263, 'recall': 0.58132803, 'specificity': 0.58132803, 'f1': 0.6188028, 'auroc': 0.8343595, 'binary_precision': 0.52061856, 'binary_recall': 0.16777408, 'binary_specificity': 0.9948819, 'binary_f1_score': 0.25376883}
confusion matrix:
       0    1
0  18078   93
1    501  101
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96185285, 'precision': 0.74921143, 'recall': 0.56576395, 'specificity': 0.56576395, 'f1': 0.5987777, 'auroc': 0.781754, 'binary_precision': 0.5322581, 'binary_recall': 0.13636364, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.21710527}
confusion matrix:
      0   1
0  5968  29
1   209  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512113_23.png
early stop counter: 10
val acc:0.9683588147163391, best validation acc: 0.9693709015846252, corresponding to test acc:                         0.9642571210861206 / 0.9682641625404358
after epoch: 23,now: 2024-06-21 01:12:44.922314,epoch time: 0:27:26.213199,used: 9:03:29.944719,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_09_14_seed_2_21512113
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9917606, 'precision': 0.98722875, 'recall': 0.96524835, 'specificity': 0.96524835, 'f1': 0.97591734, 'auroc': 0.9967897, 'binary_precision': 0.9816748, 'binary_recall': 0.9323639, 'binary_specificity': 0.99813277, 'binary_f1_score': 0.9563842}
confusion matrix:
       0     1
0  42230    79
1    307  4232
---- Validation: 
scalar performance:
{'acc': 0.9687317, 'precision': 0.75602853, 'recall': 0.5839298, 'specificity': 0.5839298, 'f1': 0.6228314, 'auroc': 0.8407729, 'binary_precision': 0.5388601, 'binary_recall': 0.17275748, 'binary_specificity': 0.9951021, 'binary_f1_score': 0.2616352}
confusion matrix:
       0    1
0  18082   89
1    498  104
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96185285, 'precision': 0.75338864, 'recall': 0.5518848, 'specificity': 0.5518848, 'f1': 0.57989144, 'auroc': 0.79497033, 'binary_precision': 0.5416667, 'binary_recall': 0.10743801, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.17931034}
confusion matrix:
      0   1
0  5975  22
1   216  26
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512113_24.png
early stop counter: 11
val acc:0.968731701374054, best validation acc: 0.9693709015846252, corresponding to test acc:                         0.9642571210861206 / 0.9682641625404358
after epoch: 24,now: 2024-06-21 01:41:49.051775,epoch time: 0:29:04.129461,used: 9:32:34.074180,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_09_14_seed_2_21512113
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9919527, 'precision': 0.98596185, 'recall': 0.96760964, 'specificity': 0.96760964, 'f1': 0.9765619, 'auroc': 0.99700487, 'binary_precision': 0.9786059, 'binary_recall': 0.9374174, 'binary_specificity': 0.99780196, 'binary_f1_score': 0.957569}
confusion matrix:
       0     1
0  42217    93
1    284  4254
---- Validation: 
scalar performance:
{'acc': 0.96777284, 'precision': 0.73291135, 'recall': 0.5818284, 'specificity': 0.5818284, 'f1': 0.6178474, 'auroc': 0.84462607, 'binary_precision': 0.49275362, 'binary_recall': 0.16943522, 'binary_specificity': 0.99422157, 'binary_f1_score': 0.25216317}
confusion matrix:
       0    1
0  18066  105
1    500  102
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9607309, 'precision': 0.7183094, 'recall': 0.5493184, 'specificity': 0.5493184, 'f1': 0.57469076, 'auroc': 0.79816854, 'binary_precision': 0.4716981, 'binary_recall': 0.10330579, 'binary_specificity': 0.995331, 'binary_f1_score': 0.16949153}
confusion matrix:
      0   1
0  5969  28
1   217  25
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512113_25.png
early stop counter: 12
val acc:0.9677728414535522, best validation acc: 0.9693709015846252, corresponding to test acc:                         0.9642571210861206 / 0.9682641625404358
after epoch: 25,now: 2024-06-21 02:09:56.910310,epoch time: 0:28:07.858535,used: 10:00:41.932715,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_09_14_seed_2_21512113
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9919314, 'precision': 0.98854595, 'recall': 0.9649496, 'specificity': 0.9649496, 'f1': 0.9763782, 'auroc': 0.99649835, 'binary_precision': 0.98440045, 'binary_recall': 0.93148273, 'binary_specificity': 0.9984164, 'binary_f1_score': 0.9572108}
confusion matrix:
       0     1
0  42242    67
1    311  4228
---- Validation: 
scalar performance:
{'acc': 0.9690513, 'precision': 0.7600645, 'recall': 0.6009589, 'specificity': 0.6009589, 'f1': 0.64250886, 'auroc': 0.8490242, 'binary_precision': 0.5458515, 'binary_recall': 0.2076412, 'binary_specificity': 0.9942766, 'binary_f1_score': 0.30084237}
confusion matrix:
       0    1
0  18067  104
1    477  125
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9615323, 'precision': 0.74224025, 'recall': 0.55370075, 'specificity': 0.55370075, 'f1': 0.58198774, 'auroc': 0.79612964, 'binary_precision': 0.5192308, 'binary_recall': 0.11157025, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.18367347}
confusion matrix:
      0   1
0  5972  25
1   215  27
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512113_26.png
early stop counter: 13
val acc:0.9690513014793396, best validation acc: 0.9693709015846252, corresponding to test acc:                         0.9642571210861206 / 0.9682641625404358
after epoch: 26,now: 2024-06-21 02:37:37.629227,epoch time: 0:27:40.718917,used: 10:28:22.651632,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_09_14_seed_2_21512113
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9926144, 'precision': 0.9877802, 'recall': 0.9696546, 'specificity': 0.9696546, 'f1': 0.9785, 'auroc': 0.99720156, 'binary_precision': 0.98184323, 'binary_recall': 0.9411765, 'binary_specificity': 0.99813277, 'binary_f1_score': 0.9610799}
confusion matrix:
       0     1
0  42230    79
1    267  4272
---- Validation: 
scalar performance:
{'acc': 0.9679859, 'precision': 0.7380096, 'recall': 0.59478724, 'specificity': 0.59478724, 'f1': 0.63279366, 'auroc': 0.84639287, 'binary_precision': 0.50212765, 'binary_recall': 0.19601329, 'binary_specificity': 0.99356115, 'binary_f1_score': 0.28195938}
confusion matrix:
       0    1
0  18054  117
1    484  118
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9604103, 'precision': 0.7165423, 'recall': 0.568979, 'specificity': 0.568979, 'f1': 0.60025465, 'auroc': 0.796801, 'binary_precision': 0.46666667, 'binary_recall': 0.1446281, 'binary_specificity': 0.99333, 'binary_f1_score': 0.22082019}
confusion matrix:
      0   1
0  5957  40
1   207  35
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512113_27.png
early stop counter: 14
val acc:0.9679859280586243, best validation acc: 0.9693709015846252, corresponding to test acc:                         0.9642571210861206 / 0.9682641625404358
after epoch: 27,now: 2024-06-21 03:04:57.702823,epoch time: 0:27:20.073596,used: 10:55:42.725228,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_09_14_seed_2_21512113
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99252903, 'precision': 0.9906466, 'recall': 0.9663622, 'specificity': 0.9663622, 'f1': 0.9781147, 'auroc': 0.9974564, 'binary_precision': 0.9883423, 'binary_recall': 0.93390614, 'binary_specificity': 0.9988182, 'binary_f1_score': 0.96035343}
confusion matrix:
       0     1
0  42259    50
1    300  4239
---- Validation: 
scalar performance:
{'acc': 0.9683055, 'precision': 0.74626195, 'recall': 0.57327, 'specificity': 0.57327, 'f1': 0.6090261, 'auroc': 0.83985734, 'binary_precision': 0.52, 'binary_recall': 0.15116279, 'binary_specificity': 0.99537724, 'binary_f1_score': 0.23423421}
confusion matrix:
       0   1
0  18087  84
1    511  91
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608912, 'precision': 0.7223881, 'recall': 0.547419, 'specificity': 0.547419, 'f1': 0.5721803, 'auroc': 0.7918968, 'binary_precision': 0.48, 'binary_recall': 0.09917355, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.16438356}
confusion matrix:
      0   1
0  5971  26
1   218  24
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512113_28.png
early stop counter: 15
val acc:0.9683055281639099, best validation acc: 0.9693709015846252, corresponding to test acc:                         0.9642571210861206 / 0.9682641625404358
after epoch: 28,now: 2024-06-21 03:31:29.325922,epoch time: 0:26:31.623099,used: 11:22:14.348327,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_09_14_seed_2_21512113
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99216616, 'precision': 0.9871902, 'recall': 0.96762943, 'specificity': 0.96762943, 'f1': 0.9771559, 'auroc': 0.99665546, 'binary_precision': 0.9810842, 'binary_recall': 0.937197, 'binary_specificity': 0.9980619, 'binary_f1_score': 0.95863855}
confusion matrix:
       0     1
0  42228    82
1    285  4253
---- Validation: 
scalar performance:
{'acc': 0.9684121, 'precision': 0.7490261, 'recall': 0.57493114, 'specificity': 0.57493114, 'f1': 0.61131954, 'auroc': 0.84443474, 'binary_precision': 0.5254237, 'binary_recall': 0.15448505, 'binary_specificity': 0.99537724, 'binary_f1_score': 0.23876764}
confusion matrix:
       0   1
0  18087  84
1    509  93
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9616926, 'precision': 0.749069, 'recall': 0.5478359, 'specificity': 0.5478359, 'f1': 0.57382137, 'auroc': 0.7922697, 'binary_precision': 0.53333336, 'binary_recall': 0.09917355, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.1672474}
confusion matrix:
      0   1
0  5976  21
1   218  24
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512113_29.png
early stop counter: 16
val acc:0.9684121012687683, best validation acc: 0.9693709015846252, corresponding to test acc:                         0.9642571210861206 / 0.9682641625404358
after epoch: 29,now: 2024-06-21 03:59:10.828470,epoch time: 0:27:41.502548,used: 11:49:55.850875,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_09_14_seed_2_21512113
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99284923, 'precision': 0.9873405, 'recall': 0.9714564, 'specificity': 0.9714564, 'f1': 0.9792316, 'auroc': 0.9972799, 'binary_precision': 0.980567, 'binary_recall': 0.9449218, 'binary_specificity': 0.99799097, 'binary_f1_score': 0.96241444}
confusion matrix:
       0     1
0  42224    85
1    250  4289
---- Validation: 
scalar performance:
{'acc': 0.968199, 'precision': 0.74250305, 'recall': 0.590079, 'specificity': 0.590079, 'f1': 0.628291, 'auroc': 0.84798807, 'binary_precision': 0.51141554, 'binary_recall': 0.18604651, 'binary_specificity': 0.9941115, 'binary_f1_score': 0.272838}
confusion matrix:
       0    1
0  18064  107
1    490  112
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9607309, 'precision': 0.7199742, 'recall': 0.5552666, 'specificity': 0.5552666, 'f1': 0.5829633, 'auroc': 0.7924086, 'binary_precision': 0.47457626, 'binary_recall': 0.11570248, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.18604651}
confusion matrix:
      0   1
0  5966  31
1   214  28
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512113_30.png
early stop counter: 17
val acc:0.9681990146636963, best validation acc: 0.9693709015846252, corresponding to test acc:                         0.9642571210861206 / 0.9682641625404358
after epoch: 30,now: 2024-06-21 04:31:15.122817,epoch time: 0:32:04.294347,used: 12:22:00.145222,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_09_14_seed_2_21512113
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 12:22:00.145222 at 2024-06-21 04:31:15.122817
persisted model performance metric: 

scalar performance:
{'acc': 0.9642571, 'precision': 0.80093193, 'recall': 0.59080744, 'specificity': 0.59080744, 'f1': 0.63460433, 'auroc': 0.78974664, 'binary_precision': 0.63380283, 'binary_recall': 0.18595041, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.28753996}
confusion matrix:
      0   1
0  5971  26
1   197  45
oracle model performance metric: 

scalar performance:
{'acc': 0.96826416, 'precision': 0.8799713, 'recall': 0.6226329, 'specificity': 0.6226329, 'f1': 0.6805378, 'auroc': 0.7741687, 'binary_precision': 0.7894737, 'binary_recall': 0.24793388, 'binary_specificity': 0.997332, 'binary_f1_score': 0.3773585}
confusion matrix:
      0   1
0  5981  16
1   182  60
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_irm_resnet_different_bs128_lre4_classbalancing/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_irm_resnet_different_bs128_lre4_classbalancing/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204097 KiB |   1730 MiB |   1069 TiB |   1069 TiB |
|       from large pool | 167936 KiB |   1660 MiB |   1069 TiB |   1069 TiB |
|       from small pool |  36161 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 204097 KiB |   1730 MiB |   1069 TiB |   1069 TiB |
|       from large pool | 167936 KiB |   1660 MiB |   1069 TiB |   1069 TiB |
|       from small pool |  36161 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201087 KiB |   1723 MiB |   1069 TiB |   1069 TiB |
|       from large pool | 165120 KiB |   1653 MiB |   1069 TiB |   1069 TiB |
|       from small pool |  35967 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1802 MiB |   1876 MiB |   4292 MiB |   2490 MiB |
|       from large pool |   1728 MiB |   1802 MiB |   4154 MiB |   2426 MiB |
|       from small pool |     74 MiB |     74 MiB |    138 MiB |     64 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 404158 KiB |    900 MiB | 777511 GiB | 777511 GiB |
|       from large pool | 397312 KiB |    899 MiB | 777194 GiB | 777194 GiB |
|       from small pool |   6846 KiB |     14 MiB |    317 GiB |    317 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1194    |    1851    |   32863 K  |   32862 K  |
|       from large pool |      36    |      76    |   10412 K  |   10412 K  |
|       from small pool |    1158    |    1780    |   22451 K  |   22450 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1194    |    1851    |   32863 K  |   32862 K  |
|       from large pool |      36    |      76    |   10412 K  |   10412 K  |
|       from small pool |    1158    |    1780    |   22451 K  |   22450 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      49    |      50    |      88    |      39    |
|       from large pool |      12    |      13    |      19    |       7    |
|       from small pool |      37    |      37    |      69    |      32    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      31    |     380    |   16859 K  |   16859 K  |
|       from large pool |       5    |      11    |    4162 K  |    4162 K  |
|       from small pool |      26    |     375    |   12697 K  |   12697 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1730 MiB |   1069 TiB |   1069 TiB |
|       from large pool |  16640 KiB |   1660 MiB |   1069 TiB |   1069 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1730 MiB |   1069 TiB |   1069 TiB |
|       from large pool |  16640 KiB |   1660 MiB |   1069 TiB |   1069 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1723 MiB |   1069 TiB |   1069 TiB |
|       from large pool |  16640 KiB |   1653 MiB |   1069 TiB |   1069 TiB |
|       from small pool |      0 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 608256 KiB |   1876 MiB |   4292 MiB |   3698 MiB |
|       from large pool | 565248 KiB |   1802 MiB |   4154 MiB |   3602 MiB |
|       from small pool |  43008 KiB |     74 MiB |    138 MiB |     96 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 384768 KiB |    900 MiB | 777512 GiB | 777511 GiB |
|       from large pool | 384768 KiB |    899 MiB | 777194 GiB | 777194 GiB |
|       from small pool |      0 KiB |     14 MiB |    317 GiB |    317 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1851    |   32863 K  |   32863 K  |
|       from large pool |       2    |      76    |   10412 K  |   10412 K  |
|       from small pool |       0    |    1780    |   22451 K  |   22451 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1851    |   32863 K  |   32863 K  |
|       from large pool |       2    |      76    |   10412 K  |   10412 K  |
|       from small pool |       0    |    1780    |   22451 K  |   22451 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      30    |      50    |      88    |      58    |
|       from large pool |       9    |      13    |      19    |      10    |
|       from small pool |      21    |      37    |      69    |      48    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     380    |   16859 K  |   16859 K  |
|       from large pool |       1    |      11    |    4162 K  |    4162 K  |
|       from small pool |       0    |     375    |   12697 K  |   12697 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

