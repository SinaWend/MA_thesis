Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0




!!!: not committed yet



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546971

 Experiment start at: 2024-06-22 10:15:48.331475
before training, model accuracy: 0.31128156185150146
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9055223, 'precision': 0.7027698, 'recall': 0.50010145, 'specificity': 0.50010145, 'f1': 0.4754354, 'auroc': 0.46329105, 'binary_precision': 0.5, 'binary_recall': 0.00022655189, 'binary_specificity': 0.99997634, 'binary_f1_score': 0.00045289856}
confusion matrix:
       0  1
0  42305  1
1   4413  1
---- Validation: 
scalar performance:
{'acc': 0.9656237, 'precision': 0.48288894, 'recall': 0.49991736, 'specificity': 0.49991736, 'f1': 0.4912556, 'auroc': 0.3340966, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998347, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18146  3
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581336, 'precision': 0.47914335, 'recall': 0.4999166, 'specificity': 0.4999166, 'f1': 0.48930964, 'auroc': 0.3597902, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5996  1
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546971_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-22 10:29:44.428277,epoch time: 0:13:56.096802,used: 0:13:56.096802,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546971
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9055437, 'precision': 0.45277184, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.47521538, 'auroc': 0.52302015, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42307  0
1   4413  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.3264834, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.31245524, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546971_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-22 10:42:58.793064,epoch time: 0:13:14.364787,used: 0:27:10.461589,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546971
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9056079, 'precision': 0.45280394, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.47523305, 'auroc': 0.5547538, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42310  0
1   4410  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.34736192, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.34061396, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546971_3.png
early stop counter: 1
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 3,now: 2024-06-22 10:56:01.941941,epoch time: 0:13:03.148877,used: 0:40:13.610466,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546971
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9055437, 'precision': 0.45277184, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.47521538, 'auroc': 0.63276327, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42307  0
1   4413  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.3403588, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.30637157, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546971_4.png
early stop counter: 2
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 4,now: 2024-06-22 11:08:59.321992,epoch time: 0:12:57.380051,used: 0:53:10.990517,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546971
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9055865, 'precision': 0.45279324, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.47522718, 'auroc': 0.77105457, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42309  0
1   4411  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.37123638, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.4227574, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546971_5.png
early stop counter: 3
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 5,now: 2024-06-22 11:21:46.045883,epoch time: 0:12:46.723891,used: 1:05:57.714408,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546971
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9056079, 'precision': 0.9528029, 'recall': 0.50011337, 'specificity': 0.50011337, 'f1': 0.47545916, 'auroc': 0.77217984, 'binary_precision': 1.0, 'binary_recall': 0.00022670596, 'binary_specificity': 1.0, 'binary_f1_score': 0.00045330913}
confusion matrix:
       0  1
0  42309  0
1   4410  1
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.37405857, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.40037516, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546971_6.png
early stop counter: 4
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 6,now: 2024-06-22 11:35:01.843764,epoch time: 0:13:15.797881,used: 1:19:13.512289,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546971
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9066567, 'precision': 0.94367164, 'recall': 0.5057692, 'specificity': 0.5057692, 'f1': 0.48692092, 'auroc': 0.8440296, 'binary_precision': 0.9807692, 'binary_recall': 0.011562004, 'binary_specificity': 0.99997634, 'binary_f1_score': 0.022854581}
confusion matrix:
       0   1
0  42308   1
1   4360  51
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.4415726, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.570112, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546971_7.png
early stop counter: 5
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 7,now: 2024-06-22 11:47:41.065629,epoch time: 0:12:39.221865,used: 1:31:52.734154,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546971
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.90819776, 'precision': 0.93550104, 'recall': 0.5146668, 'specificity': 0.5146668, 'f1': 0.50445265, 'auroc': 0.8612137, 'binary_precision': 0.962963, 'binary_recall': 0.029451745, 'binary_specificity': 0.9998818, 'binary_f1_score': 0.057155423}
confusion matrix:
       0    1
0  42301    5
1   4284  130
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.40930867, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.55009246, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546971_8.png
early stop counter: 6
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 8,now: 2024-06-22 12:00:31.165522,epoch time: 0:12:50.099893,used: 1:44:42.834047,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546971
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9129709, 'precision': 0.9426248, 'recall': 0.54033047, 'specificity': 0.54033047, 'f1': 0.55175585, 'auroc': 0.8823916, 'binary_precision': 0.97275203, 'binary_recall': 0.080897346, 'binary_specificity': 0.9997636, 'binary_f1_score': 0.14937237}
confusion matrix:
       0    1
0  42297   10
1   4056  357
---- Validation: 
scalar performance:
{'acc': 0.9657301, 'precision': 0.48289075, 'recall': 0.49997246, 'specificity': 0.49997246, 'f1': 0.4912832, 'auroc': 0.43495718, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9999449, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18148  1
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.62623775, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546971_9.png
early stop counter: 7
val acc:0.9657300710678101, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 9,now: 2024-06-22 12:13:21.870058,epoch time: 0:12:50.704536,used: 1:57:33.538583,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546971
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9201627, 'precision': 0.9445986, 'recall': 0.57980794, 'specificity': 0.57980794, 'f1': 0.61631954, 'auroc': 0.89200544, 'binary_precision': 0.9698217, 'binary_recall': 0.1601359, 'binary_specificity': 0.99947995, 'binary_f1_score': 0.27488336}
confusion matrix:
       0    1
0  42283   22
1   3708  707
---- Validation: 
scalar performance:
{'acc': 0.96557045, 'precision': 0.482888, 'recall': 0.4998898, 'specificity': 0.4998898, 'f1': 0.49124184, 'auroc': 0.4307224, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9997796, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18145  4
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.57333136, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546971_10.png
early stop counter: 8
val acc:0.9655704498291016, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 10,now: 2024-06-22 12:26:06.954791,epoch time: 0:12:45.084733,used: 2:10:18.623316,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546971
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.922881, 'precision': 0.9391594, 'recall': 0.59573215, 'specificity': 0.59573215, 'f1': 0.6397192, 'auroc': 0.8970567, 'binary_precision': 0.9560811, 'binary_recall': 0.19238614, 'binary_specificity': 0.99907815, 'binary_f1_score': 0.32031694}
confusion matrix:
       0    1
0  42268   39
1   3564  849
---- Validation: 
scalar performance:
{'acc': 0.96546406, 'precision': 0.4828862, 'recall': 0.49983472, 'specificity': 0.49983472, 'f1': 0.4912143, 'auroc': 0.46922767, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99966943, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18143  6
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579738, 'precision': 0.6042133, 'recall': 0.5016656, 'specificity': 0.5016656, 'f1': 0.49303976, 'auroc': 0.66866004, 'binary_precision': 0.25, 'binary_recall': 0.0038314175, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.0075471695}
confusion matrix:
      0  1
0  5994  3
1   260  1
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546971_11.png
early stop counter: 9
val acc:0.9654640555381775, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 11,now: 2024-06-22 12:39:53.060942,epoch time: 0:13:46.106151,used: 2:24:04.729467,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546971
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.92833906, 'precision': 0.9238435, 'recall': 0.6312855, 'specificity': 0.6312855, 'f1': 0.68661976, 'auroc': 0.9196918, 'binary_precision': 0.9190888, 'binary_recall': 0.26500565, 'binary_specificity': 0.9975653, 'binary_f1_score': 0.4113924}
confusion matrix:
       0     1
0  42202   103
1   3245  1170
---- Validation: 
scalar performance:
{'acc': 0.965198, 'precision': 0.48288164, 'recall': 0.49969694, 'specificity': 0.49969694, 'f1': 0.4911454, 'auroc': 0.5076958, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9993939, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18138  11
1    643   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589326, 'precision': 0.8130804, 'recall': 0.5149922, 'specificity': 0.5149922, 'f1': 0.51880825, 'auroc': 0.7003521, 'binary_precision': 0.6666667, 'binary_recall': 0.03065134, 'binary_specificity': 0.999333, 'binary_f1_score': 0.058608055}
confusion matrix:
      0  1
0  5993  4
1   253  8
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546971_12.png
new oracle model saved
early stop counter: 10
val acc:0.9651979804039001, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9589325785636902
after epoch: 12,now: 2024-06-22 12:52:54.244201,epoch time: 0:13:01.183259,used: 2:37:05.912726,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546971
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9365154, 'precision': 0.9402216, 'recall': 0.6733299, 'specificity': 0.6733299, 'f1': 0.73774475, 'auroc': 0.91433275, 'binary_precision': 0.944206, 'binary_recall': 0.34881088, 'binary_specificity': 0.9978489, 'binary_f1_score': 0.5094277}
confusion matrix:
       0     1
0  42214    91
1   2875  1540
---- Validation: 
scalar performance:
{'acc': 0.96466583, 'precision': 0.50463647, 'recall': 0.50017154, 'specificity': 0.50017154, 'f1': 0.49250862, 'auroc': 0.48820043, 'binary_precision': 0.04347826, 'binary_recall': 0.00155521, 'binary_specificity': 0.9987878, 'binary_f1_score': 0.003003003}
confusion matrix:
       0   1
0  18127  22
1    642   1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579738, 'precision': 0.7107917, 'recall': 0.52182126, 'specificity': 0.52182126, 'f1': 0.5310587, 'auroc': 0.69021106, 'binary_precision': 0.46153846, 'binary_recall': 0.04597701, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.08362369}
confusion matrix:
      0   1
0  5983  14
1   249  12
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546971_13.png
early stop counter: 11
val acc:0.9646658301353455, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9589325785636902
after epoch: 13,now: 2024-06-22 13:05:50.677732,epoch time: 0:12:56.433531,used: 2:50:02.346257,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546971
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9460617, 'precision': 0.9457644, 'recall': 0.7263137, 'specificity': 0.7263137, 'f1': 0.79284006, 'auroc': 0.9443587, 'binary_precision': 0.94543743, 'binary_recall': 0.4553693, 'binary_specificity': 0.99725807, 'binary_f1_score': 0.614679}
confusion matrix:
       0     1
0  42190   116
1   2404  2010
---- Validation: 
scalar performance:
{'acc': 0.9641337, 'precision': 0.5234784, 'recall': 0.5013961, 'specificity': 0.5013961, 'f1': 0.49527997, 'auroc': 0.56224936, 'binary_precision': 0.08108108, 'binary_recall': 0.00466563, 'binary_specificity': 0.9981266, 'binary_f1_score': 0.00882353}
confusion matrix:
       0   1
0  18115  34
1    640   3
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9603707, 'precision': 0.7978051, 'recall': 0.55788624, 'specificity': 0.55788624, 'f1': 0.58984107, 'auroc': 0.7355293, 'binary_precision': 0.63265306, 'binary_recall': 0.118773945, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.19999999}
confusion matrix:
      0   1
0  5979  18
1   230  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546971_14.png
new oracle model saved
early stop counter: 12
val acc:0.9641336798667908, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9603707194328308
after epoch: 14,now: 2024-06-22 13:18:52.751184,epoch time: 0:13:02.073452,used: 3:03:04.419709,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546971
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9453125, 'precision': 0.92261505, 'recall': 0.73492974, 'specificity': 0.73492974, 'f1': 0.7960879, 'auroc': 0.93547183, 'binary_precision': 0.89739203, 'binary_recall': 0.47553238, 'binary_specificity': 0.99432707, 'binary_f1_score': 0.6216496}
confusion matrix:
       0     1
0  42066   240
1   2315  2099
---- Validation: 
scalar performance:
{'acc': 0.96243083, 'precision': 0.51720506, 'recall': 0.50201464, 'specificity': 0.50201464, 'f1': 0.49740854, 'auroc': 0.58934647, 'binary_precision': 0.06849315, 'binary_recall': 0.00777605, 'binary_specificity': 0.99625325, 'binary_f1_score': 0.01396648}
confusion matrix:
       0   1
0  18081  68
1    638   5
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.7967518, 'recall': 0.5821234, 'specificity': 0.5821234, 'f1': 0.62295926, 'auroc': 0.7640915, 'binary_precision': 0.62857145, 'binary_recall': 0.16858238, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.26586103}
confusion matrix:
      0   1
0  5971  26
1   217  44
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546971_15.png
new oracle model saved
early stop counter: 13
val acc:0.9624308347702026, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9611697196960449
after epoch: 15,now: 2024-06-22 13:32:13.088130,epoch time: 0:13:20.336946,used: 3:16:24.756655,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546971
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.944863, 'precision': 0.9376806, 'recall': 0.72329533, 'specificity': 0.72329533, 'f1': 0.78847575, 'auroc': 0.9342959, 'binary_precision': 0.9297753, 'binary_recall': 0.450136, 'binary_specificity': 0.9964546, 'binary_f1_score': 0.6065974}
confusion matrix:
       0     1
0  42158   150
1   2426  1986
---- Validation: 
scalar performance:
{'acc': 0.9638144, 'precision': 0.49570325, 'recall': 0.4997307, 'specificity': 0.4997307, 'f1': 0.49225268, 'auroc': 0.5394198, 'binary_precision': 0.025641026, 'binary_recall': 0.00155521, 'binary_specificity': 0.9979062, 'binary_f1_score': 0.0029325515}
confusion matrix:
       0   1
0  18111  38
1    642   1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.8337661, 'recall': 0.5583031, 'specificity': 0.5583031, 'f1': 0.5916893, 'auroc': 0.72414875, 'binary_precision': 0.70454544, 'binary_recall': 0.118773945, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.20327869}
confusion matrix:
      0   1
0  5984  13
1   230  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546971_16.png
early stop counter: 14
val acc:0.963814377784729, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9611697196960449
after epoch: 16,now: 2024-06-22 13:44:44.723566,epoch time: 0:12:31.635436,used: 3:28:56.392091,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546971
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9474529, 'precision': 0.9279597, 'recall': 0.74477977, 'specificity': 0.74477977, 'f1': 0.8059222, 'auroc': 0.9307463, 'binary_precision': 0.9062241, 'binary_recall': 0.49490142, 'binary_specificity': 0.9946581, 'binary_f1_score': 0.6401876}
confusion matrix:
       0     1
0  42081   226
1   2229  2184
---- Validation: 
scalar performance:
{'acc': 0.9623244, 'precision': 0.5219426, 'recall': 0.5027096, 'specificity': 0.5027096, 'f1': 0.49873045, 'auroc': 0.5776095, 'binary_precision': 0.077922076, 'binary_recall': 0.00933126, 'binary_specificity': 0.99608797, 'binary_f1_score': 0.016666668}
confusion matrix:
       0   1
0  18078  71
1    637   6
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.7606734, 'recall': 0.59245044, 'specificity': 0.59245044, 'f1': 0.63213366, 'auroc': 0.75253844, 'binary_precision': 0.5555556, 'binary_recall': 0.19157088, 'binary_specificity': 0.99333, 'binary_f1_score': 0.28490028}
confusion matrix:
      0   1
0  5957  40
1   211  50
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546971_17.png
early stop counter: 15
val acc:0.9623243808746338, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9611697196960449
after epoch: 17,now: 2024-06-22 13:57:01.844850,epoch time: 0:12:17.121284,used: 3:41:13.513375,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546971
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9506207, 'precision': 0.9296098, 'recall': 0.763428, 'specificity': 0.763428, 'f1': 0.82207996, 'auroc': 0.9352858, 'binary_precision': 0.905973, 'binary_recall': 0.53262347, 'binary_specificity': 0.9942325, 'binary_f1_score': 0.67085177}
confusion matrix:
       0     1
0  42062   244
1   2063  2351
---- Validation: 
scalar performance:
{'acc': 0.96227115, 'precision': 0.5497968, 'recall': 0.5071824, 'specificity': 0.5071824, 'f1': 0.5067513, 'auroc': 0.58817065, 'binary_precision': 0.13333334, 'binary_recall': 0.01866252, 'binary_specificity': 0.99570227, 'binary_f1_score': 0.032742154}
confusion matrix:
       0   1
0  18071  78
1    631  12
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96196866, 'precision': 0.78974074, 'recall': 0.61735463, 'specificity': 0.61735463, 'f1': 0.6632843, 'auroc': 0.7755295, 'binary_precision': 0.61165047, 'binary_recall': 0.2413793, 'binary_specificity': 0.99333, 'binary_f1_score': 0.34615383}
confusion matrix:
      0   1
0  5957  40
1   198  63
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546971_18.png
new oracle model saved
early stop counter: 16
val acc:0.9622711539268494, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9619686603546143
after epoch: 18,now: 2024-06-22 14:09:17.064085,epoch time: 0:12:15.219235,used: 3:53:28.732610,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546971
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9570205, 'precision': 0.93585944, 'recall': 0.79867303, 'specificity': 0.79867303, 'f1': 0.8514433, 'auroc': 0.9461458, 'binary_precision': 0.9116741, 'binary_recall': 0.6034444, 'binary_specificity': 0.9939017, 'binary_f1_score': 0.7262067}
confusion matrix:
       0     1
0  42049   258
1   1750  2663
---- Validation: 
scalar performance:
{'acc': 0.9608876, 'precision': 0.55069184, 'recall': 0.51021636, 'specificity': 0.51021636, 'f1': 0.5121243, 'auroc': 0.60502046, 'binary_precision': 0.13492064, 'binary_recall': 0.02643857, 'binary_specificity': 0.9939942, 'binary_f1_score': 0.04421327}
confusion matrix:
       0    1
0  18040  109
1    626   17
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96212846, 'precision': 0.77719164, 'recall': 0.65591705, 'specificity': 0.65591705, 'f1': 0.6976229, 'auroc': 0.77393997, 'binary_precision': 0.5833333, 'binary_recall': 0.3218391, 'binary_specificity': 0.989995, 'binary_f1_score': 0.4148148}
confusion matrix:
      0   1
0  5937  60
1   177  84
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546971_19.png
new oracle model saved
early stop counter: 17
val acc:0.960887610912323, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9621284604072571
after epoch: 19,now: 2024-06-22 14:21:37.899924,epoch time: 0:12:20.835839,used: 4:05:49.568449,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546971
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9557363, 'precision': 0.9303981, 'recall': 0.794965, 'specificity': 0.794965, 'f1': 0.84704244, 'auroc': 0.9427202, 'binary_precision': 0.90143734, 'binary_recall': 0.5967376, 'binary_specificity': 0.99319243, 'binary_f1_score': 0.71810246}
confusion matrix:
       0     1
0  42018   288
1   1780  2634
---- Validation: 
scalar performance:
{'acc': 0.96030223, 'precision': 0.5335093, 'recall': 0.5069131, 'specificity': 0.5069131, 'f1': 0.50670683, 'auroc': 0.58217824, 'binary_precision': 0.1007752, 'binary_recall': 0.02021773, 'binary_specificity': 0.9936085, 'binary_f1_score': 0.03367876}
confusion matrix:
       0    1
0  18033  116
1    630   13
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96356666, 'precision': 0.7974995, 'recall': 0.6548351, 'specificity': 0.6548351, 'f1': 0.7012555, 'auroc': 0.7741642, 'binary_precision': 0.62406015, 'binary_recall': 0.31800765, 'binary_specificity': 0.9916625, 'binary_f1_score': 0.42131978}
confusion matrix:
      0   1
0  5947  50
1   178  83
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546971_20.png
new oracle model saved
early stop counter: 18
val acc:0.9603022336959839, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9635666608810425
after epoch: 20,now: 2024-06-22 14:34:11.168140,epoch time: 0:12:33.268216,used: 4:18:22.836665,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546971
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.95800513, 'precision': 0.903329, 'recall': 0.8369684, 'specificity': 0.8369684, 'f1': 0.8663775, 'auroc': 0.9598954, 'binary_precision': 0.8386295, 'binary_recall': 0.68774074, 'binary_specificity': 0.98619616, 'binary_f1_score': 0.75572705}
confusion matrix:
       0     1
0  41723   584
1   1378  3035
---- Validation: 
scalar performance:
{'acc': 0.95753515, 'precision': 0.57304, 'recall': 0.5279822, 'specificity': 0.5279822, 'f1': 0.5377706, 'auroc': 0.6544624, 'binary_precision': 0.17842324, 'binary_recall': 0.06687403, 'binary_specificity': 0.9890903, 'binary_f1_score': 0.09728506}
confusion matrix:
       0    1
0  17951  198
1    600   43
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9603707, 'precision': 0.75471246, 'recall': 0.6751556, 'specificity': 0.6751556, 'f1': 0.7066283, 'auroc': 0.80652523, 'binary_precision': 0.53672314, 'binary_recall': 0.36398467, 'binary_specificity': 0.9863265, 'binary_f1_score': 0.4337899}
confusion matrix:
      0   1
0  5915  82
1   166  95
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546971_21.png
early stop counter: 19
val acc:0.9575351476669312, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9635666608810425
after epoch: 21,now: 2024-06-22 14:46:36.122873,epoch time: 0:12:24.954733,used: 4:30:47.791398,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546971
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9577055, 'precision': 0.9124438, 'recall': 0.8243836, 'specificity': 0.8243836, 'f1': 0.8617966, 'auroc': 0.9528562, 'binary_precision': 0.8595041, 'binary_recall': 0.66001815, 'binary_specificity': 0.98874915, 'binary_f1_score': 0.74666667}
confusion matrix:
       0     1
0  41832   476
1   1500  2912
---- Validation: 
scalar performance:
{'acc': 0.9583333, 'precision': 0.5451667, 'recall': 0.5133943, 'specificity': 0.5133943, 'f1': 0.51709265, 'auroc': 0.59863555, 'binary_precision': 0.123655915, 'binary_recall': 0.035769828, 'binary_specificity': 0.9910188, 'binary_f1_score': 0.05548854}
confusion matrix:
       0    1
0  17986  163
1    620   23
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614893, 'precision': 0.7666217, 'recall': 0.6702422, 'specificity': 0.6702422, 'f1': 0.7065045, 'auroc': 0.76956165, 'binary_precision': 0.5609756, 'binary_recall': 0.35249043, 'binary_specificity': 0.987994, 'binary_f1_score': 0.43294117}
confusion matrix:
      0   1
0  5925  72
1   169  92
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546971_22.png
early stop counter: 20
val acc:0.9583333134651184, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9635666608810425
after epoch: 22,now: 2024-06-22 14:59:20.044657,epoch time: 0:12:43.921784,used: 4:43:31.713182,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546971
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9605308, 'precision': 0.9395286, 'recall': 0.817701, 'specificity': 0.817701, 'f1': 0.86646825, 'auroc': 0.95048726, 'binary_precision': 0.91532, 'binary_recall': 0.64159495, 'binary_specificity': 0.993807, 'binary_f1_score': 0.7543953}
confusion matrix:
       0     1
0  42044   262
1   1582  2832
---- Validation: 
scalar performance:
{'acc': 0.96024907, 'precision': 0.5750097, 'recall': 0.51963645, 'specificity': 0.51963645, 'f1': 0.5270189, 'auroc': 0.6132113, 'binary_precision': 0.18292683, 'binary_recall': 0.0466563, 'binary_specificity': 0.99261665, 'binary_f1_score': 0.07434945}
confusion matrix:
       0    1
0  18015  134
1    613   30
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96196866, 'precision': 0.773413, 'recall': 0.663163, 'specificity': 0.663163, 'f1': 0.7027273, 'auroc': 0.78413665, 'binary_precision': 0.5751634, 'binary_recall': 0.33716476, 'binary_specificity': 0.98916125, 'binary_f1_score': 0.4251208}
confusion matrix:
      0   1
0  5932  65
1   173  88
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546971_23.png
early stop counter: 21
val acc:0.9602490663528442, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9635666608810425
after epoch: 23,now: 2024-06-22 15:12:05.363012,epoch time: 0:12:45.318355,used: 4:56:17.031537,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546971
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9559289, 'precision': 0.9154843, 'recall': 0.80946076, 'specificity': 0.80946076, 'f1': 0.85277575, 'auroc': 0.94921124, 'binary_precision': 0.86862683, 'binary_recall': 0.6288496, 'binary_specificity': 0.99007183, 'binary_f1_score': 0.7295416}
confusion matrix:
       0     1
0  41884   420
1   1639  2777
---- Validation: 
scalar performance:
{'acc': 0.959238, 'precision': 0.57761395, 'recall': 0.52436346, 'specificity': 0.52436346, 'f1': 0.5336241, 'auroc': 0.62507594, 'binary_precision': 0.18781726, 'binary_recall': 0.057542767, 'binary_specificity': 0.9911841, 'binary_f1_score': 0.08809524}
confusion matrix:
       0    1
0  17989  160
1    606   37
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9603707, 'precision': 0.7543439, 'recall': 0.6806526, 'specificity': 0.6806526, 'f1': 0.71044904, 'auroc': 0.8055861, 'binary_precision': 0.5355191, 'binary_recall': 0.37547892, 'binary_specificity': 0.98582625, 'binary_f1_score': 0.44144145}
confusion matrix:
      0   1
0  5912  85
1   163  98
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546971_24.png
early stop counter: 22
val acc:0.9592379927635193, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9635666608810425
after epoch: 24,now: 2024-06-22 15:25:07.649384,epoch time: 0:13:02.286372,used: 5:09:19.317909,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546971
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.95976025, 'precision': 0.9150239, 'recall': 0.8358422, 'specificity': 0.8358422, 'f1': 0.8701728, 'auroc': 0.9570626, 'binary_precision': 0.8624142, 'binary_recall': 0.6830539, 'binary_specificity': 0.9886305, 'binary_f1_score': 0.7623262}
confusion matrix:
       0     1
0  41825   481
1   1399  3015
---- Validation: 
scalar performance:
{'acc': 0.95843977, 'precision': 0.59387666, 'recall': 0.5367011, 'specificity': 0.5367011, 'f1': 0.5501006, 'auroc': 0.6620854, 'binary_precision': 0.2195122, 'binary_recall': 0.083981335, 'binary_specificity': 0.9894209, 'binary_f1_score': 0.12148481}
confusion matrix:
       0    1
0  17957  192
1    589   54
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96196866, 'precision': 0.76673114, 'recall': 0.70347434, 'specificity': 0.70347434, 'f1': 0.73030573, 'auroc': 0.8181982, 'binary_precision': 0.55837566, 'binary_recall': 0.42145595, 'binary_specificity': 0.98549277, 'binary_f1_score': 0.4803494}
confusion matrix:
      0    1
0  5910   87
1   151  110
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546971_25.png
early stop counter: 23
val acc:0.9584397673606873, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9635666608810425
after epoch: 25,now: 2024-06-22 15:37:59.446872,epoch time: 0:12:51.797488,used: 5:22:11.115397,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546971
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9603596, 'precision': 0.9243852, 'recall': 0.8301871, 'specificity': 0.8301871, 'f1': 0.86992335, 'auroc': 0.95575047, 'binary_precision': 0.88238806, 'binary_recall': 0.66968733, 'binary_specificity': 0.9906869, 'binary_f1_score': 0.7614631}
confusion matrix:
       0     1
0  41912   394
1   1458  2956
---- Validation: 
scalar performance:
{'acc': 0.9574287, 'precision': 0.5936003, 'recall': 0.541428, 'specificity': 0.541428, 'f1': 0.55525005, 'auroc': 0.6744019, 'binary_precision': 0.21863799, 'binary_recall': 0.09486781, 'binary_specificity': 0.9879883, 'binary_f1_score': 0.13232104}
confusion matrix:
       0    1
0  17931  218
1    582   61
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95621604, 'precision': 0.72448915, 'recall': 0.70963454, 'specificity': 0.70963454, 'f1': 0.71676934, 'auroc': 0.8200197, 'binary_precision': 0.47325101, 'binary_recall': 0.44061303, 'binary_specificity': 0.978656, 'binary_f1_score': 0.45634922}
confusion matrix:
      0    1
0  5869  128
1   146  115
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546971_26.png
early stop counter: 24
val acc:0.9574286937713623, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9635666608810425
after epoch: 26,now: 2024-06-22 15:50:44.009837,epoch time: 0:12:44.562965,used: 5:34:55.678362,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546971
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9619649, 'precision': 0.92450434, 'recall': 0.84071195, 'specificity': 0.84071195, 'f1': 0.8768475, 'auroc': 0.95858073, 'binary_precision': 0.8805195, 'binary_recall': 0.6912098, 'binary_specificity': 0.99021417, 'binary_f1_score': 0.7744638}
confusion matrix:
       0     1
0  41892   414
1   1363  3051
---- Validation: 
scalar performance:
{'acc': 0.9590783, 'precision': 0.58807063, 'recall': 0.53028125, 'specificity': 0.53028125, 'f1': 0.5419168, 'auroc': 0.63357425, 'binary_precision': 0.20833333, 'binary_recall': 0.06998445, 'binary_specificity': 0.990578, 'binary_f1_score': 0.10477299}
confusion matrix:
       0    1
0  17978  171
1    598   45
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.7497764, 'recall': 0.6877318, 'specificity': 0.6877318, 'f1': 0.7137704, 'auroc': 0.79474854, 'binary_precision': 0.52577317, 'binary_recall': 0.3908046, 'binary_specificity': 0.984659, 'binary_f1_score': 0.44835165}
confusion matrix:
      0    1
0  5905   92
1   159  102
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546971_27.png
early stop counter: 25
val acc:0.959078311920166, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9635666608810425
after epoch: 27,now: 2024-06-22 16:03:08.522170,epoch time: 0:12:24.512333,used: 5:47:20.190695,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546971
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.96110874, 'precision': 0.9342686, 'recall': 0.8258323, 'specificity': 0.8258323, 'f1': 0.8704206, 'auroc': 0.95654476, 'binary_precision': 0.90313566, 'binary_recall': 0.65903944, 'binary_specificity': 0.9926252, 'binary_f1_score': 0.7620171}
confusion matrix:
       0     1
0  41994   312
1   1505  2909
---- Validation: 
scalar performance:
{'acc': 0.9597169, 'precision': 0.58840555, 'recall': 0.5276116, 'specificity': 0.5276116, 'f1': 0.53856695, 'auroc': 0.6510048, 'binary_precision': 0.20918368, 'binary_recall': 0.06376361, 'binary_specificity': 0.9914596, 'binary_f1_score': 0.097735405}
confusion matrix:
       0    1
0  17994  155
1    602   41
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9638862, 'precision': 0.7887188, 'recall': 0.6898162, 'specificity': 0.6898162, 'f1': 0.7278596, 'auroc': 0.8081346, 'binary_precision': 0.6035503, 'binary_recall': 0.3908046, 'binary_specificity': 0.98882776, 'binary_f1_score': 0.47441858}
confusion matrix:
      0    1
0  5930   67
1   159  102
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546971_28.png
new oracle model saved
early stop counter: 26
val acc:0.9597169160842896, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9638862013816833
after epoch: 28,now: 2024-06-22 16:15:25.640213,epoch time: 0:12:17.118043,used: 5:59:37.308738,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546971
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.96170807, 'precision': 0.919747, 'recall': 0.8440536, 'specificity': 0.8440536, 'f1': 0.8771752, 'auroc': 0.95881826, 'binary_precision': 0.8702764, 'binary_recall': 0.69898075, 'binary_specificity': 0.98912656, 'binary_f1_score': 0.7752795}
confusion matrix:
       0     1
0  41845   460
1   1329  3086
---- Validation: 
scalar performance:
{'acc': 0.9559919, 'precision': 0.6056802, 'recall': 0.5594356, 'specificity': 0.5594356, 'f1': 0.5747836, 'auroc': 0.6833749, 'binary_precision': 0.24157304, 'binary_recall': 0.13374805, 'binary_specificity': 0.98512316, 'binary_f1_score': 0.17217217}
confusion matrix:
       0    1
0  17879  270
1    557   86
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579738, 'precision': 0.7374499, 'recall': 0.7435336, 'specificity': 0.7435336, 'f1': 0.7404476, 'auroc': 0.8371542, 'binary_precision': 0.49626866, 'binary_recall': 0.5095785, 'binary_specificity': 0.97748876, 'binary_f1_score': 0.5028355}
confusion matrix:
      0    1
0  5862  135
1   128  133
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546971_29.png
early stop counter: 27
val acc:0.9559919238090515, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9638862013816833
after epoch: 29,now: 2024-06-22 16:27:53.486288,epoch time: 0:12:27.846075,used: 6:12:05.154813,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546971
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.96128, 'precision': 0.9087708, 'recall': 0.8536318, 'specificity': 0.8536318, 'f1': 0.87866914, 'auroc': 0.95921963, 'binary_precision': 0.8461948, 'binary_recall': 0.720925, 'binary_specificity': 0.9863386, 'binary_f1_score': 0.77855307}
confusion matrix:
       0     1
0  41731   578
1   1231  3180
---- Validation: 
scalar performance:
{'acc': 0.95721585, 'precision': 0.59703255, 'recall': 0.54506814, 'specificity': 0.54506814, 'f1': 0.5595436, 'auroc': 0.6757342, 'binary_precision': 0.22525597, 'binary_recall': 0.102643855, 'binary_specificity': 0.98749244, 'binary_f1_score': 0.14102565}
confusion matrix:
       0    1
0  17922  227
1    577   66
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96260786, 'precision': 0.76844597, 'recall': 0.7367898, 'specificity': 0.7367898, 'f1': 0.75149554, 'auroc': 0.8282373, 'binary_precision': 0.558952, 'binary_recall': 0.49042144, 'binary_specificity': 0.98315823, 'binary_f1_score': 0.52244896}
confusion matrix:
      0    1
0  5896  101
1   133  128
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546971_30.png
early stop counter: 28
val acc:0.9572158455848694, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9638862013816833
after epoch: 30,now: 2024-06-22 16:40:30.101993,epoch time: 0:12:36.615705,used: 6:24:41.770518,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546971
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 6:24:41.770518 at 2024-06-22 16:40:30.101993
persisted model performance metric: 

scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.31245524, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
oracle model performance metric: 

scalar performance:
{'acc': 0.9638862, 'precision': 0.7887188, 'recall': 0.6898162, 'specificity': 0.6898162, 'f1': 0.7278596, 'auroc': 0.8081346, 'binary_precision': 0.6035503, 'binary_recall': 0.3908046, 'binary_specificity': 0.98882776, 'binary_f1_score': 0.47441858}
confusion matrix:
      0    1
0  5930   67
1   159  102
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_resnet_lre5_bs32_classbalancing3/rule_results/4.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_resnet_lre5_bs32_classbalancing3/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_resnet_lre5_bs32_classbalancing3/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204391 KiB | 737101 KiB | 452857 GiB | 452857 GiB |
|       from large pool | 167936 KiB | 664960 KiB | 452495 GiB | 452495 GiB |
|       from small pool |  36455 KiB |  73422 KiB |    361 GiB |    361 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 204391 KiB | 737101 KiB | 452857 GiB | 452857 GiB |
|       from large pool | 167936 KiB | 664960 KiB | 452495 GiB | 452495 GiB |
|       from small pool |  36455 KiB |  73422 KiB |    361 GiB |    361 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201088 KiB | 730152 KiB | 452727 GiB | 452727 GiB |
|       from large pool | 165120 KiB | 658560 KiB | 452374 GiB | 452374 GiB |
|       from small pool |  35968 KiB |  72872 KiB |    352 GiB |    352 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    900 MiB |    900 MiB |    900 MiB |      0 B   |
|       from large pool |    828 MiB |    828 MiB |    828 MiB |      0 B   |
|       from small pool |     72 MiB |     72 MiB |     72 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 104856 KiB | 260793 KiB | 331858 GiB | 331858 GiB |
|       from large pool |  96256 KiB | 259208 KiB | 331491 GiB | 331491 GiB |
|       from small pool |   8600 KiB |  12473 KiB |    366 GiB |    366 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2076    |    3689    |   49206 K  |   49204 K  |
|       from large pool |      36    |      76    |   16647 K  |   16647 K  |
|       from small pool |    2040    |    3651    |   32558 K  |   32556 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2076    |    3689    |   49206 K  |   49204 K  |
|       from large pool |      36    |      76    |   16647 K  |   16647 K  |
|       from small pool |    2040    |    3651    |   32558 K  |   32556 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      51    |      51    |      51    |       0    |
|       from large pool |      15    |      15    |      15    |       0    |
|       from small pool |      36    |      36    |      36    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      51    |    1476    |   22384 K  |   22384 K  |
|       from large pool |       5    |      10    |    6195 K  |    6195 K  |
|       from small pool |      46    |    1470    |   16188 K  |   16188 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 737101 KiB | 452857 GiB | 452857 GiB |
|       from large pool |  16640 KiB | 664960 KiB | 452495 GiB | 452495 GiB |
|       from small pool |      0 KiB |  73422 KiB |    361 GiB |    361 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 737101 KiB | 452857 GiB | 452857 GiB |
|       from large pool |  16640 KiB | 664960 KiB | 452495 GiB | 452495 GiB |
|       from small pool |      0 KiB |  73422 KiB |    361 GiB |    361 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 730152 KiB | 452727 GiB | 452727 GiB |
|       from large pool |  16640 KiB | 658560 KiB | 452374 GiB | 452374 GiB |
|       from small pool |      0 KiB |  72872 KiB |    352 GiB |    352 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 309248 KiB |    900 MiB |    900 MiB | 612352 KiB |
|       from large pool | 264192 KiB |    828 MiB |    828 MiB | 583680 KiB |
|       from small pool |  45056 KiB |     72 MiB |     72 MiB |  28672 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  83712 KiB | 260793 KiB | 331858 GiB | 331858 GiB |
|       from large pool |  83712 KiB | 259208 KiB | 331491 GiB | 331491 GiB |
|       from small pool |      0 KiB |  16195 KiB |    366 GiB |    366 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3689    |   49206 K  |   49206 K  |
|       from large pool |       2    |      76    |   16647 K  |   16647 K  |
|       from small pool |       0    |    3651    |   32558 K  |   32558 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3689    |   49206 K  |   49206 K  |
|       from large pool |       2    |      76    |   16647 K  |   16647 K  |
|       from small pool |       0    |    3651    |   32558 K  |   32558 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      51    |      51    |      20    |
|       from large pool |       9    |      15    |      15    |       6    |
|       from small pool |      22    |      36    |      36    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |    1476    |   22385 K  |   22385 K  |
|       from large pool |       1    |      11    |    6195 K  |    6195 K  |
|       from small pool |       0    |    1470    |   16189 K  |   16189 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 737101 KiB | 452857 GiB | 452857 GiB |
|       from large pool |  16640 KiB | 664960 KiB | 452495 GiB | 452495 GiB |
|       from small pool |      0 KiB |  73422 KiB |    361 GiB |    361 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 737101 KiB | 452857 GiB | 452857 GiB |
|       from large pool |  16640 KiB | 664960 KiB | 452495 GiB | 452495 GiB |
|       from small pool |      0 KiB |  73422 KiB |    361 GiB |    361 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 730152 KiB | 452727 GiB | 452727 GiB |
|       from large pool |  16640 KiB | 658560 KiB | 452374 GiB | 452374 GiB |
|       from small pool |      0 KiB |  72872 KiB |    352 GiB |    352 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 309248 KiB |    900 MiB |    900 MiB | 612352 KiB |
|       from large pool | 264192 KiB |    828 MiB |    828 MiB | 583680 KiB |
|       from small pool |  45056 KiB |     72 MiB |     72 MiB |  28672 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  83712 KiB | 260793 KiB | 331858 GiB | 331858 GiB |
|       from large pool |  83712 KiB | 259208 KiB | 331491 GiB | 331491 GiB |
|       from small pool |      0 KiB |  16195 KiB |    366 GiB |    366 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3689    |   49206 K  |   49206 K  |
|       from large pool |       2    |      76    |   16647 K  |   16647 K  |
|       from small pool |       0    |    3651    |   32558 K  |   32558 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3689    |   49206 K  |   49206 K  |
|       from large pool |       2    |      76    |   16647 K  |   16647 K  |
|       from small pool |       0    |    3651    |   32558 K  |   32558 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      51    |      51    |      20    |
|       from large pool |       9    |      15    |      15    |       6    |
|       from small pool |      22    |      36    |      36    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |    1476    |   22385 K  |   22385 K  |
|       from large pool |       1    |      11    |    6195 K  |    6195 K  |
|       from small pool |       0    |    1470    |   16189 K  |   16189 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0




!!!: not committed yet



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_45_41_seed_1_21546971

 Experiment start at: 2024-06-22 16:45:41.091968
before training, model accuracy: 0.1456654816865921
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9048373, 'precision': 0.45359343, 'recall': 0.49857295, 'specificity': 0.49857295, 'f1': 0.4750208, 'auroc': 0.41733557, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9971459, 'binary_f1_score': 0.0}
confusion matrix:
       0    1
0  42274  121
1   4325    0
---- Validation: 
scalar performance:
{'acc': 0.95010674, 'precision': 0.48929694, 'recall': 0.49561027, 'specificity': 0.49561027, 'f1': 0.49144652, 'auroc': 0.30684978, 'binary_precision': 0.014814815, 'binary_recall': 0.0059435363, 'binary_specificity': 0.985277, 'binary_f1_score': 0.008483563}
confusion matrix:
       0    1
0  17801  266
1    669    4
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94537544, 'precision': 0.47878245, 'recall': 0.49335688, 'specificity': 0.49335688, 'f1': 0.4859604, 'auroc': 0.19016291, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.98671377, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5867  79
1   260   0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546971_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-22 16:58:39.515647,epoch time: 0:12:58.423679,used: 0:12:58.423679,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_45_41_seed_1_21546971
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9068279, 'precision': 0.47036126, 'recall': 0.4997736, 'specificity': 0.4997736, 'f1': 0.47579792, 'auroc': 0.4823305, 'binary_precision': 0.033333335, 'binary_recall': 0.00023121387, 'binary_specificity': 0.999316, 'binary_f1_score': 0.00045924223}
confusion matrix:
       0   1
0  42366  29
1   4324   1
---- Validation: 
scalar performance:
{'acc': 0.96318036, 'precision': 0.508368, 'recall': 0.5002448, 'specificity': 0.5002448, 'f1': 0.49206704, 'auroc': 0.31254584, 'binary_precision': 0.05263158, 'binary_recall': 0.0014858841, 'binary_specificity': 0.9990037, 'binary_f1_score': 0.0028901733}
confusion matrix:
       0   1
0  18049  18
1    672   1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.20041026, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546971_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-22 17:11:01.052014,epoch time: 0:12:21.536367,used: 0:25:19.960046,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_45_41_seed_1_21546971
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.90714896, 'precision': 0.453691, 'recall': 0.49985847, 'specificity': 0.49985847, 'f1': 0.4756571, 'auroc': 0.5391884, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99971694, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  42382  12
1   4326   0
---- Validation: 
scalar performance:
{'acc': 0.96387404, 'precision': 0.48203993, 'recall': 0.4998893, 'specificity': 0.4998893, 'f1': 0.49080238, 'auroc': 0.32644248, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9997786, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18063  4
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.25801122, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546971_3.png
better model found
persisted
after epoch: 3,now: 2024-06-22 17:23:20.724058,epoch time: 0:12:19.672044,used: 0:37:39.632090,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_45_41_seed_1_21546971
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.90744865, 'precision': 0.45372432, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.47573948, 'auroc': 0.6033963, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42396  0
1   4324  0
---- Validation: 
scalar performance:
{'acc': 0.96403414, 'precision': 0.4820428, 'recall': 0.4999723, 'specificity': 0.4999723, 'f1': 0.49084386, 'auroc': 0.3356034, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9999446, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18066  1
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.2888566, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546971_4.png
better model found
persisted
after epoch: 4,now: 2024-06-22 17:35:36.868730,epoch time: 0:12:16.144672,used: 0:49:55.776762,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_45_41_seed_1_21546971
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9069563, 'precision': 0.45372096, 'recall': 0.49970517, 'specificity': 0.49970517, 'f1': 0.47560415, 'auroc': 0.7035513, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99941033, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  42373  25
1   4322   0
---- Validation: 
scalar performance:
{'acc': 0.9638207, 'precision': 0.48203897, 'recall': 0.49986163, 'specificity': 0.49986163, 'f1': 0.49078858, 'auroc': 0.3551004, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99972326, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18062  5
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.27276707, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546971_5.png
early stop counter: 1
val acc:0.9638206958770752, best validation acc: 0.9640341401100159, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 5,now: 2024-06-22 17:48:06.956975,epoch time: 0:12:30.088245,used: 1:02:25.865007,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_45_41_seed_1_21546971
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9065711, 'precision': 0.46586806, 'recall': 0.4996438, 'specificity': 0.4996438, 'f1': 0.47572663, 'auroc': 0.7205026, 'binary_precision': 0.024390243, 'binary_recall': 0.00023116042, 'binary_specificity': 0.99905646, 'binary_f1_score': 0.0004579803}
confusion matrix:
       0   1
0  42354  40
1   4325   1
---- Validation: 
scalar performance:
{'acc': 0.96387404, 'precision': 0.48203993, 'recall': 0.4998893, 'specificity': 0.4998893, 'f1': 0.49080238, 'auroc': 0.3294708, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9997786, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18063  4
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.26990187, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546971_6.png
early stop counter: 2
val acc:0.9638740420341492, best validation acc: 0.9640341401100159, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 6,now: 2024-06-22 18:01:00.658532,epoch time: 0:12:53.701557,used: 1:15:19.566564,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_45_41_seed_1_21546971
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9058647, 'precision': 0.47288844, 'recall': 0.4994622, 'specificity': 0.4994622, 'f1': 0.47598332, 'auroc': 0.7962382, 'binary_precision': 0.03846154, 'binary_recall': 0.0006934813, 'binary_specificity': 0.9982309, 'binary_f1_score': 0.0013623978}
confusion matrix:
       0   1
0  42319  75
1   4323   3
---- Validation: 
scalar performance:
{'acc': 0.96344715, 'precision': 0.48203224, 'recall': 0.4996679, 'specificity': 0.4996679, 'f1': 0.49069163, 'auroc': 0.37326086, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9993358, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18055  12
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.34419778, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546971_7.png
early stop counter: 3
val acc:0.9634471535682678, best validation acc: 0.9640341401100159, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 7,now: 2024-06-22 18:13:48.874199,epoch time: 0:12:48.215667,used: 1:28:07.782231,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_45_41_seed_1_21546971
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9065711, 'precision': 0.61653435, 'recall': 0.5035555, 'specificity': 0.5035555, 'f1': 0.48425454, 'auroc': 0.84313583, 'binary_precision': 0.325, 'binary_recall': 0.009021513, 'binary_specificity': 0.9980895, 'binary_f1_score': 0.017555706}
confusion matrix:
       0   1
0  42316  81
1   4284  39
---- Validation: 
scalar performance:
{'acc': 0.9638207, 'precision': 0.48203897, 'recall': 0.49986163, 'specificity': 0.49986163, 'f1': 0.49078858, 'auroc': 0.40105754, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99972326, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18062  5
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.39290667, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546971_8.png
early stop counter: 4
val acc:0.9638206958770752, best validation acc: 0.9640341401100159, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 8,now: 2024-06-22 18:26:44.020598,epoch time: 0:12:55.146399,used: 1:41:02.928630,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_45_41_seed_1_21546971
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9087329, 'precision': 0.7731925, 'recall': 0.51524526, 'specificity': 0.51524526, 'f1': 0.5068268, 'auroc': 0.8604499, 'binary_precision': 0.6363636, 'binary_recall': 0.03237743, 'binary_specificity': 0.99811304, 'binary_f1_score': 0.06161972}
confusion matrix:
       0    1
0  42316   80
1   4184  140
---- Validation: 
scalar performance:
{'acc': 0.963714, 'precision': 0.48203704, 'recall': 0.49980628, 'specificity': 0.49980628, 'f1': 0.49076086, 'auroc': 0.43618727, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99961257, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18060  7
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.55563605, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546971_9.png
early stop counter: 5
val acc:0.9637140035629272, best validation acc: 0.9640341401100159, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 9,now: 2024-06-22 18:39:25.798671,epoch time: 0:12:41.778073,used: 1:53:44.706703,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_45_41_seed_1_21546971
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.911494, 'precision': 0.7911632, 'recall': 0.5414822, 'specificity': 0.5414822, 'f1': 0.5539361, 'auroc': 0.87132025, 'binary_precision': 0.66784453, 'binary_recall': 0.08739884, 'binary_specificity': 0.99556553, 'binary_f1_score': 0.15456963}
confusion matrix:
       0    1
0  42207  188
1   3947  378
---- Validation: 
scalar performance:
{'acc': 0.96334046, 'precision': 0.48203033, 'recall': 0.49961254, 'specificity': 0.49961254, 'f1': 0.49066398, 'auroc': 0.43191463, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9992251, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18053  14
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.5166097, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546971_10.png
early stop counter: 6
val acc:0.9633404612541199, best validation acc: 0.9640341401100159, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 10,now: 2024-06-22 18:52:06.835441,epoch time: 0:12:41.036770,used: 2:06:25.743473,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_45_41_seed_1_21546971
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9162671, 'precision': 0.84431887, 'recall': 0.5660168, 'specificity': 0.5660168, 'f1': 0.59357786, 'auroc': 0.8821614, 'binary_precision': 0.76993465, 'binary_recall': 0.13618498, 'binary_specificity': 0.9958486, 'binary_f1_score': 0.2314342}
confusion matrix:
       0    1
0  42219  176
1   3736  589
---- Validation: 
scalar performance:
{'acc': 0.9630736, 'precision': 0.48202553, 'recall': 0.49947417, 'specificity': 0.49947417, 'f1': 0.49059477, 'auroc': 0.4403792, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99894834, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18048  19
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.50920093, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546971_11.png
early stop counter: 7
val acc:0.9630736112594604, best validation acc: 0.9640341401100159, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 11,now: 2024-06-22 19:04:44.464312,epoch time: 0:12:37.628871,used: 2:19:03.372344,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_45_41_seed_1_21546971
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.92414385, 'precision': 0.85971355, 'recall': 0.61944383, 'specificity': 0.61944383, 'f1': 0.667179, 'auroc': 0.90564466, 'binary_precision': 0.7913562, 'binary_recall': 0.24549237, 'binary_specificity': 0.99339527, 'binary_f1_score': 0.37473536}
confusion matrix:
       0     1
0  42114   280
1   3264  1062
---- Validation: 
scalar performance:
{'acc': 0.9614728, 'precision': 0.4819967, 'recall': 0.49864393, 'specificity': 0.49864393, 'f1': 0.49017897, 'auroc': 0.47777814, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99728787, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18018  49
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579439, 'precision': 0.47904915, 'recall': 0.4999159, 'specificity': 0.4999159, 'f1': 0.48926014, 'auroc': 0.6488519, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5945  1
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546971_12.png
early stop counter: 8
val acc:0.9614728093147278, best validation acc: 0.9640341401100159, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 12,now: 2024-06-22 19:17:40.444197,epoch time: 0:12:55.979885,used: 2:31:59.352229,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_45_41_seed_1_21546971
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9328981, 'precision': 0.8951168, 'recall': 0.66274816, 'specificity': 0.66274816, 'f1': 0.72078, 'auroc': 0.9209955, 'binary_precision': 0.8544153, 'binary_recall': 0.33125144, 'binary_specificity': 0.9942449, 'binary_f1_score': 0.47741288}
confusion matrix:
       0     1
0  42153   244
1   2891  1432
---- Validation: 
scalar performance:
{'acc': 0.9621665, 'precision': 0.4820092, 'recall': 0.4990037, 'specificity': 0.4990037, 'f1': 0.49035925, 'auroc': 0.50421834, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9980074, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18031  36
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.66105896, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546971_13.png
early stop counter: 9
val acc:0.9621664881706238, best validation acc: 0.9640341401100159, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 13,now: 2024-06-22 19:30:35.554686,epoch time: 0:12:55.110489,used: 2:44:54.462718,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_45_41_seed_1_21546971
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.93775684, 'precision': 0.8990289, 'recall': 0.69308764, 'specificity': 0.69308764, 'f1': 0.75266623, 'auroc': 0.9129113, 'binary_precision': 0.8567104, 'binary_recall': 0.39287367, 'binary_specificity': 0.9933016, 'binary_f1_score': 0.5387056}
confusion matrix:
       0     1
0  42114   284
1   2624  1698
---- Validation: 
scalar performance:
{'acc': 0.96179295, 'precision': 0.48200247, 'recall': 0.49881, 'specificity': 0.49881, 'f1': 0.49026224, 'auroc': 0.48169392, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99762, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18024  43
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.72920024, 'recall': 0.50367796, 'specificity': 0.50367796, 'f1': 0.49687442, 'auroc': 0.660151, 'binary_precision': 0.5, 'binary_recall': 0.0076923077, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.015151515}
confusion matrix:
      0  1
0  5944  2
1   258  2
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546971_14.png
early stop counter: 10
val acc:0.9617929458618164, best validation acc: 0.9640341401100159, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 14,now: 2024-06-22 19:43:33.915261,epoch time: 0:12:58.360575,used: 2:57:52.823293,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_45_41_seed_1_21546971
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9368365, 'precision': 0.8975811, 'recall': 0.6879441, 'specificity': 0.6879441, 'f1': 0.7473349, 'auroc': 0.91895425, 'binary_precision': 0.8547804, 'binary_recall': 0.38251618, 'binary_specificity': 0.993372, 'binary_f1_score': 0.5285189}
confusion matrix:
       0     1
0  42115   281
1   2670  1654
---- Validation: 
scalar performance:
{'acc': 0.96168625, 'precision': 0.48200053, 'recall': 0.49875465, 'specificity': 0.49875465, 'f1': 0.49023446, 'auroc': 0.5504928, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9975093, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18022  45
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.7293482, 'recall': 0.507356, 'specificity': 0.507356, 'f1': 0.5042205, 'auroc': 0.7240268, 'binary_precision': 0.5, 'binary_recall': 0.015384615, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.029850746}
confusion matrix:
      0  1
0  5942  4
1   256  4
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546971_15.png
early stop counter: 11
val acc:0.9616862535476685, best validation acc: 0.9640341401100159, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 15,now: 2024-06-22 19:56:16.946299,epoch time: 0:12:43.031038,used: 3:10:35.854331,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_45_41_seed_1_21546971
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.94092464, 'precision': 0.90021443, 'recall': 0.7141064, 'specificity': 0.7141064, 'f1': 0.7727891, 'auroc': 0.92217064, 'binary_precision': 0.8552632, 'binary_recall': 0.4357374, 'binary_specificity': 0.99247533, 'binary_f1_score': 0.57733536}
confusion matrix:
       0     1
0  42075   319
1   2441  1885
---- Validation: 
scalar performance:
{'acc': 0.9608858, 'precision': 0.49007544, 'recall': 0.4990548, 'specificity': 0.4990548, 'f1': 0.49138638, 'auroc': 0.5552962, 'binary_precision': 0.016129032, 'binary_recall': 0.0014858841, 'binary_specificity': 0.9966237, 'binary_f1_score': 0.0027210882}
confusion matrix:
       0   1
0  18006  61
1    672   1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95939416, 'precision': 0.8018429, 'recall': 0.5337745, 'specificity': 0.5337745, 'f1': 0.55210733, 'auroc': 0.7295629, 'binary_precision': 0.64285713, 'binary_recall': 0.06923077, 'binary_specificity': 0.9983182, 'binary_f1_score': 0.125}
confusion matrix:
      0   1
0  5936  10
1   242  18
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546971_16.png
new oracle model saved
early stop counter: 12
val acc:0.9608858227729797, best validation acc: 0.9640341401100159, corresponding to test acc:                         0.9581050872802734 / 0.9593941569328308
after epoch: 16,now: 2024-06-22 20:08:58.284255,epoch time: 0:12:41.337956,used: 3:23:17.192287,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_45_41_seed_1_21546971
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.94800943, 'precision': 0.8967222, 'recall': 0.7660088, 'specificity': 0.7660088, 'f1': 0.8153782, 'auroc': 0.93894875, 'binary_precision': 0.83845603, 'binary_recall': 0.5426787, 'binary_specificity': 0.9893389, 'binary_f1_score': 0.6588962}
confusion matrix:
       0     1
0  41945   452
1   1977  2346
---- Validation: 
scalar performance:
{'acc': 0.9589114, 'precision': 0.4965881, 'recall': 0.49946135, 'specificity': 0.49946135, 'f1': 0.49337664, 'auroc': 0.5635283, 'binary_precision': 0.029126214, 'binary_recall': 0.004457652, 'binary_specificity': 0.99446505, 'binary_f1_score': 0.0077319588}
confusion matrix:
       0    1
0  17967  100
1    670    3
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95987755, 'precision': 0.77550006, 'recall': 0.56896746, 'specificity': 0.56896746, 'f1': 0.60425246, 'auroc': 0.74354136, 'binary_precision': 0.5873016, 'binary_recall': 0.1423077, 'binary_specificity': 0.9956273, 'binary_f1_score': 0.22910218}
confusion matrix:
      0   1
0  5920  26
1   223  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546971_17.png
new oracle model saved
early stop counter: 13
val acc:0.9589114189147949, best validation acc: 0.9640341401100159, corresponding to test acc:                         0.9581050872802734 / 0.9598775506019592
after epoch: 17,now: 2024-06-22 20:21:36.978638,epoch time: 0:12:38.694383,used: 3:35:55.886670,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_45_41_seed_1_21546971
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.94760275, 'precision': 0.9070787, 'recall': 0.7540958, 'specificity': 0.7540958, 'f1': 0.8088218, 'auroc': 0.9354855, 'binary_precision': 0.8614969, 'binary_recall': 0.51665896, 'binary_specificity': 0.9915326, 'binary_f1_score': 0.6459358}
confusion matrix:
       0     1
0  42039   359
1   2089  2233
---- Validation: 
scalar performance:
{'acc': 0.9605656, 'precision': 0.5028882, 'recall': 0.50031924, 'specificity': 0.50031924, 'f1': 0.49396834, 'auroc': 0.5920341, 'binary_precision': 0.041666668, 'binary_recall': 0.004457652, 'binary_specificity': 0.9961809, 'binary_f1_score': 0.008053691}
confusion matrix:
       0   1
0  17998  69
1    670   3
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96003866, 'precision': 0.8025285, 'recall': 0.55066174, 'specificity': 0.55066174, 'f1': 0.5791645, 'auroc': 0.7578414, 'binary_precision': 0.64285713, 'binary_recall': 0.103846155, 'binary_specificity': 0.9974773, 'binary_f1_score': 0.17880796}
confusion matrix:
      0   1
0  5931  15
1   233  27
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546971_18.png
new oracle model saved
early stop counter: 14
val acc:0.9605656266212463, best validation acc: 0.9640341401100159, corresponding to test acc:                         0.9581050872802734 / 0.9600386619567871
after epoch: 18,now: 2024-06-22 20:34:04.189027,epoch time: 0:12:27.210389,used: 3:48:23.097059,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_45_41_seed_1_21546971
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9483947, 'precision': 0.903592, 'recall': 0.7623743, 'specificity': 0.7623743, 'f1': 0.814497, 'auroc': 0.9413997, 'binary_precision': 0.85291946, 'binary_recall': 0.53413564, 'binary_specificity': 0.990613, 'binary_f1_score': 0.65689486}
confusion matrix:
       0     1
0  42001   398
1   2013  2308
---- Validation: 
scalar performance:
{'acc': 0.9601921, 'precision': 0.51221836, 'recall': 0.50155604, 'specificity': 0.50155604, 'f1': 0.4964569, 'auroc': 0.6217027, 'binary_precision': 0.060240965, 'binary_recall': 0.0074294205, 'binary_specificity': 0.9956827, 'binary_f1_score': 0.013227514}
confusion matrix:
       0   1
0  17989  78
1    668   5
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9624557, 'precision': 0.8506946, 'recall': 0.5795079, 'specificity': 0.5795079, 'f1': 0.62286, 'auroc': 0.7904583, 'binary_precision': 0.7368421, 'binary_recall': 0.16153847, 'binary_specificity': 0.9974773, 'binary_f1_score': 0.26498422}
confusion matrix:
      0   1
0  5931  15
1   218  42
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546971_19.png
new oracle model saved
early stop counter: 15
val acc:0.960192084312439, best validation acc: 0.9640341401100159, corresponding to test acc:                         0.9581050872802734 / 0.962455689907074
after epoch: 19,now: 2024-06-22 20:46:25.300788,epoch time: 0:12:21.111761,used: 4:00:44.208820,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_45_41_seed_1_21546971
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9559932, 'precision': 0.9176418, 'recall': 0.80217636, 'specificity': 0.80217636, 'f1': 0.8484214, 'auroc': 0.94987345, 'binary_precision': 0.8735594, 'binary_recall': 0.6134104, 'binary_specificity': 0.9909423, 'binary_f1_score': 0.7207281}
confusion matrix:
       0     1
0  42011   384
1   1672  2653
---- Validation: 
scalar performance:
{'acc': 0.95747066, 'precision': 0.52558184, 'recall': 0.50586677, 'specificity': 0.50586677, 'f1': 0.50492483, 'auroc': 0.63790905, 'binary_precision': 0.086666666, 'binary_recall': 0.019316493, 'binary_specificity': 0.9924171, 'binary_f1_score': 0.031591736}
confusion matrix:
       0    1
0  17930  137
1    660   13
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96310025, 'precision': 0.813855, 'recall': 0.62030196, 'specificity': 0.62030196, 'f1': 0.6697736, 'auroc': 0.79029566, 'binary_precision': 0.6597938, 'binary_recall': 0.24615385, 'binary_specificity': 0.99445003, 'binary_f1_score': 0.35854343}
confusion matrix:
      0   1
0  5913  33
1   196  64
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546971_20.png
new oracle model saved
early stop counter: 16
val acc:0.9574706554412842, best validation acc: 0.9640341401100159, corresponding to test acc:                         0.9581050872802734 / 0.963100254535675
after epoch: 20,now: 2024-06-22 20:58:50.431732,epoch time: 0:12:25.130944,used: 4:13:09.339764,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_45_41_seed_1_21546971
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.95498717, 'precision': 0.9050546, 'recall': 0.8073671, 'specificity': 0.8073671, 'f1': 0.84784245, 'auroc': 0.9544226, 'binary_precision': 0.8472135, 'binary_recall': 0.62624395, 'binary_specificity': 0.9884903, 'binary_f1_score': 0.7201597}
confusion matrix:
       0     1
0  41911   488
1   1615  2706
---- Validation: 
scalar performance:
{'acc': 0.9574173, 'precision': 0.5580169, 'recall': 0.51585287, 'specificity': 0.51585287, 'f1': 0.52079684, 'auroc': 0.6795232, 'binary_precision': 0.15083799, 'binary_recall': 0.04011887, 'binary_specificity': 0.99158686, 'binary_f1_score': 0.06338028}
confusion matrix:
       0    1
0  17915  152
1    646   27
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9653561, 'precision': 0.81708986, 'recall': 0.67297083, 'specificity': 0.67297083, 'f1': 0.7216278, 'auroc': 0.8223007, 'binary_precision': 0.6618705, 'binary_recall': 0.35384616, 'binary_specificity': 0.99209553, 'binary_f1_score': 0.46115288}
confusion matrix:
      0   1
0  5899  47
1   168  92
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546971_21.png
new oracle model saved
early stop counter: 17
val acc:0.9574173092842102, best validation acc: 0.9640341401100159, corresponding to test acc:                         0.9581050872802734 / 0.9653561115264893
after epoch: 21,now: 2024-06-22 21:11:41.423085,epoch time: 0:12:50.991353,used: 4:26:00.331117,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_45_41_seed_1_21546971
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.95331764, 'precision': 0.91327995, 'recall': 0.7878373, 'specificity': 0.7878373, 'f1': 0.83666563, 'auroc': 0.94208926, 'binary_precision': 0.867536, 'binary_recall': 0.5847791, 'binary_specificity': 0.99089557, 'binary_f1_score': 0.698632}
confusion matrix:
       0     1
0  42011   386
1   1795  2528
---- Validation: 
scalar performance:
{'acc': 0.95816433, 'precision': 0.5355024, 'recall': 0.5076571, 'specificity': 0.5076571, 'f1': 0.5077364, 'auroc': 0.6051148, 'binary_precision': 0.10638298, 'binary_recall': 0.022288261, 'binary_specificity': 0.99302596, 'binary_f1_score': 0.036855035}
confusion matrix:
       0    1
0  17941  126
1    658   15
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96132773, 'precision': 0.77605706, 'recall': 0.6304109, 'specificity': 0.6304109, 'f1': 0.67423713, 'auroc': 0.77377295, 'binary_precision': 0.5833333, 'binary_recall': 0.26923078, 'binary_specificity': 0.991591, 'binary_f1_score': 0.36842105}
confusion matrix:
      0   1
0  5896  50
1   190  70
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546971_22.png
early stop counter: 18
val acc:0.9581643342971802, best validation acc: 0.9640341401100159, corresponding to test acc:                         0.9581050872802734 / 0.9653561115264893
after epoch: 22,now: 2024-06-22 21:24:42.901287,epoch time: 0:13:01.478202,used: 4:39:01.809319,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_45_41_seed_1_21546971
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9555865, 'precision': 0.92275476, 'recall': 0.79484653, 'specificity': 0.79484653, 'f1': 0.8447218, 'auroc': 0.9514282, 'binary_precision': 0.88523465, 'binary_recall': 0.5975948, 'binary_specificity': 0.99209833, 'binary_f1_score': 0.7135165}
confusion matrix:
       0     1
0  42061   335
1   1740  2584
---- Validation: 
scalar performance:
{'acc': 0.95939165, 'precision': 0.5578294, 'recall': 0.5111547, 'specificity': 0.5111547, 'f1': 0.5134065, 'auroc': 0.6496383, 'binary_precision': 0.15079366, 'binary_recall': 0.028231798, 'binary_specificity': 0.9940776, 'binary_f1_score': 0.04755945}
confusion matrix:
       0    1
0  17960  107
1    654   19
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96326137, 'precision': 0.8060036, 'recall': 0.6350979, 'specificity': 0.6350979, 'f1': 0.68407995, 'auroc': 0.7988663, 'binary_precision': 0.64285713, 'binary_recall': 0.2769231, 'binary_specificity': 0.9932728, 'binary_f1_score': 0.38709676}
confusion matrix:
      0   1
0  5906  40
1   188  72
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546971_23.png
early stop counter: 19
val acc:0.9593916535377502, best validation acc: 0.9640341401100159, corresponding to test acc:                         0.9581050872802734 / 0.9653561115264893
after epoch: 23,now: 2024-06-22 21:37:54.837700,epoch time: 0:13:11.936413,used: 4:52:13.745732,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_45_41_seed_1_21546971
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.95331764, 'precision': 0.9110241, 'recall': 0.78996205, 'specificity': 0.78996205, 'f1': 0.83752894, 'auroc': 0.94552135, 'binary_precision': 0.86260575, 'binary_recall': 0.5895005, 'binary_specificity': 0.9904236, 'binary_f1_score': 0.70037097}
confusion matrix:
       0     1
0  41990   406
1   1775  2549
---- Validation: 
scalar performance:
{'acc': 0.95896477, 'precision': 0.5533205, 'recall': 0.5109333, 'specificity': 0.5109333, 'f1': 0.51305944, 'auroc': 0.6114869, 'binary_precision': 0.14179105, 'binary_recall': 0.028231798, 'binary_specificity': 0.9936348, 'binary_f1_score': 0.047087982}
confusion matrix:
       0    1
0  17952  115
1    654   19
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9629391, 'precision': 0.793704, 'recall': 0.64780265, 'specificity': 0.64780265, 'f1': 0.694044, 'auroc': 0.77659917, 'binary_precision': 0.6171875, 'binary_recall': 0.30384615, 'binary_specificity': 0.9917592, 'binary_f1_score': 0.4072165}
confusion matrix:
      0   1
0  5897  49
1   181  79
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546971_24.png
early stop counter: 20
val acc:0.9589647650718689, best validation acc: 0.9640341401100159, corresponding to test acc:                         0.9581050872802734 / 0.9653561115264893
after epoch: 24,now: 2024-06-22 21:50:58.693579,epoch time: 0:13:03.855879,used: 5:05:17.601611,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_45_41_seed_1_21546971
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.95749146, 'precision': 0.9134785, 'recall': 0.8164976, 'specificity': 0.8164976, 'f1': 0.85695004, 'auroc': 0.9489355, 'binary_precision': 0.8624109, 'binary_recall': 0.6434682, 'binary_specificity': 0.98952705, 'binary_f1_score': 0.73702323}
confusion matrix:
       0     1
0  41951   444
1   1542  2783
---- Validation: 
scalar performance:
{'acc': 0.9574173, 'precision': 0.5518869, 'recall': 0.51370704, 'specificity': 0.51370704, 'f1': 0.5174773, 'auroc': 0.62631476, 'binary_precision': 0.13872832, 'binary_recall': 0.035661217, 'binary_specificity': 0.9917529, 'binary_f1_score': 0.056737587}
confusion matrix:
       0    1
0  17918  149
1    649   24
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96052206, 'precision': 0.7584627, 'recall': 0.66860914, 'specificity': 0.66860914, 'f1': 0.7028936, 'auroc': 0.7840766, 'binary_precision': 0.5449102, 'binary_recall': 0.35, 'binary_specificity': 0.9872183, 'binary_f1_score': 0.42622948}
confusion matrix:
      0   1
0  5870  76
1   169  91
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546971_25.png
early stop counter: 21
val acc:0.9574173092842102, best validation acc: 0.9640341401100159, corresponding to test acc:                         0.9581050872802734 / 0.9653561115264893
after epoch: 25,now: 2024-06-22 22:04:01.398404,epoch time: 0:13:02.704825,used: 5:18:20.306436,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_45_41_seed_1_21546971
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9578339, 'precision': 0.90109646, 'recall': 0.83291805, 'specificity': 0.83291805, 'f1': 0.8630139, 'auroc': 0.9554165, 'binary_precision': 0.83427924, 'binary_recall': 0.6796116, 'binary_specificity': 0.9862245, 'binary_f1_score': 0.74904454}
confusion matrix:
       0     1
0  41810   584
1   1386  2940
---- Validation: 
scalar performance:
{'acc': 0.9544824, 'precision': 0.5675835, 'recall': 0.52792084, 'specificity': 0.52792084, 'f1': 0.5370035, 'auroc': 0.6858267, 'binary_precision': 0.16911764, 'binary_recall': 0.068350665, 'binary_specificity': 0.987491, 'binary_f1_score': 0.0973545}
confusion matrix:
       0    1
0  17841  226
1    627   46
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95939416, 'precision': 0.7469214, 'recall': 0.70296127, 'specificity': 0.70296127, 'f1': 0.72249806, 'auroc': 0.8152132, 'binary_precision': 0.5188679, 'binary_recall': 0.42307693, 'binary_specificity': 0.9828456, 'binary_f1_score': 0.4661017}
confusion matrix:
      0    1
0  5844  102
1   150  110
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546971_26.png
early stop counter: 22
val acc:0.95448237657547, best validation acc: 0.9640341401100159, corresponding to test acc:                         0.9581050872802734 / 0.9653561115264893
after epoch: 26,now: 2024-06-22 22:17:02.242100,epoch time: 0:13:00.843696,used: 5:31:21.150132,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_45_41_seed_1_21546971
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.95905393, 'precision': 0.9152725, 'recall': 0.82537794, 'specificity': 0.82537794, 'f1': 0.8635092, 'auroc': 0.95234144, 'binary_precision': 0.8642684, 'binary_recall': 0.6613463, 'binary_specificity': 0.9894096, 'binary_f1_score': 0.749312}
confusion matrix:
       0     1
0  41948   449
1   1464  2859
---- Validation: 
scalar performance:
{'acc': 0.9561366, 'precision': 0.57446694, 'recall': 0.52663296, 'specificity': 0.52663296, 'f1': 0.53611875, 'auroc': 0.6558749, 'binary_precision': 0.18297872, 'binary_recall': 0.06389301, 'binary_specificity': 0.9893729, 'binary_f1_score': 0.09471365}
confusion matrix:
       0    1
0  17875  192
1    630   43
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96003866, 'precision': 0.75232774, 'recall': 0.6922637, 'specificity': 0.6922637, 'f1': 0.7176988, 'auroc': 0.8079561, 'binary_precision': 0.53061223, 'binary_recall': 0.4, 'binary_specificity': 0.9845274, 'binary_f1_score': 0.45614037}
confusion matrix:
      0    1
0  5854   92
1   156  104
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546971_27.png
early stop counter: 23
val acc:0.9561365842819214, best validation acc: 0.9640341401100159, corresponding to test acc:                         0.9581050872802734 / 0.9653561115264893
after epoch: 27,now: 2024-06-22 22:30:00.669905,epoch time: 0:12:58.427805,used: 5:44:19.577937,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_45_41_seed_1_21546971
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9606164, 'precision': 0.9186354, 'recall': 0.8326787, 'specificity': 0.8326787, 'f1': 0.86951166, 'auroc': 0.9579083, 'binary_precision': 0.86960405, 'binary_recall': 0.6756882, 'binary_specificity': 0.9896691, 'binary_f1_score': 0.7604791}
confusion matrix:
       0     1
0  41959   438
1   1402  2921
---- Validation: 
scalar performance:
{'acc': 0.9538954, 'precision': 0.5690263, 'recall': 0.53047746, 'specificity': 0.53047746, 'f1': 0.5400368, 'auroc': 0.65826094, 'binary_precision': 0.17182131, 'binary_recall': 0.0742942, 'binary_specificity': 0.9866608, 'binary_f1_score': 0.10373444}
confusion matrix:
       0    1
0  17826  241
1    623   50
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95939416, 'precision': 0.7469168, 'recall': 0.7250291, 'specificity': 0.7250291, 'f1': 0.7353937, 'auroc': 0.8240808, 'binary_precision': 0.5169492, 'binary_recall': 0.46923077, 'binary_specificity': 0.98082745, 'binary_f1_score': 0.4919355}
confusion matrix:
      0    1
0  5832  114
1   138  122
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546971_28.png
early stop counter: 24
val acc:0.9538953900337219, best validation acc: 0.9640341401100159, corresponding to test acc:                         0.9581050872802734 / 0.9653561115264893
after epoch: 28,now: 2024-06-22 22:42:57.047053,epoch time: 0:12:56.377148,used: 5:57:15.955085,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_45_41_seed_1_21546971
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.96496147, 'precision': 0.9280235, 'recall': 0.8525224, 'specificity': 0.8525224, 'f1': 0.88570637, 'auroc': 0.96267176, 'binary_precision': 0.88459337, 'binary_recall': 0.7145501, 'binary_specificity': 0.9904946, 'binary_f1_score': 0.79053104}
confusion matrix:
       0     1
0  41994   403
1   1234  3089
---- Validation: 
scalar performance:
{'acc': 0.9576841, 'precision': 0.60287154, 'recall': 0.5360187, 'specificity': 0.5360187, 'f1': 0.55006796, 'auroc': 0.6942638, 'binary_precision': 0.23913044, 'binary_recall': 0.08172362, 'binary_specificity': 0.9903138, 'binary_f1_score': 0.121816166}
confusion matrix:
       0    1
0  17892  175
1    618   55
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96422815, 'precision': 0.79606044, 'recall': 0.6852551, 'specificity': 0.6852551, 'f1': 0.72645813, 'auroc': 0.80779773, 'binary_precision': 0.61875, 'binary_recall': 0.38076922, 'binary_specificity': 0.989741, 'binary_f1_score': 0.47142854}
confusion matrix:
      0   1
0  5885  61
1   161  99
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546971_29.png
early stop counter: 25
val acc:0.9576840996742249, best validation acc: 0.9640341401100159, corresponding to test acc:                         0.9581050872802734 / 0.9653561115264893
after epoch: 29,now: 2024-06-22 22:55:47.188544,epoch time: 0:12:50.141491,used: 6:10:06.096576,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_45_41_seed_1_21546971
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.959161, 'precision': 0.89677644, 'recall': 0.8484246, 'specificity': 0.8484246, 'f1': 0.8706095, 'auroc': 0.95900905, 'binary_precision': 0.8224773, 'binary_recall': 0.71253467, 'binary_specificity': 0.98431456, 'binary_f1_score': 0.76356876}
confusion matrix:
       0     1
0  41731   665
1   1243  3081
---- Validation: 
scalar performance:
{'acc': 0.9506403, 'precision': 0.58167416, 'recall': 0.5509626, 'specificity': 0.5509626, 'f1': 0.5618086, 'auroc': 0.6982279, 'binary_precision': 0.19565217, 'binary_recall': 0.12035661, 'binary_specificity': 0.98156863, 'binary_f1_score': 0.14903404}
confusion matrix:
       0    1
0  17734  333
1    592   81
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587496, 'precision': 0.7432901, 'recall': 0.7504386, 'specificity': 0.7504386, 'f1': 0.746805, 'auroc': 0.8487141, 'binary_precision': 0.5074627, 'binary_recall': 0.52307695, 'binary_specificity': 0.9778002, 'binary_f1_score': 0.51515156}
confusion matrix:
      0    1
0  5814  132
1   124  136
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546971_30.png
early stop counter: 26
val acc:0.9506403207778931, best validation acc: 0.9640341401100159, corresponding to test acc:                         0.9581050872802734 / 0.9653561115264893
after epoch: 30,now: 2024-06-22 23:08:41.693417,epoch time: 0:12:54.504873,used: 6:23:00.601449,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_45_41_seed_1_21546971
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 6:23:00.601449 at 2024-06-22 23:08:41.693417
persisted model performance metric: 

scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.2888566, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
oracle model performance metric: 

scalar performance:
{'acc': 0.9653561, 'precision': 0.81708986, 'recall': 0.67297083, 'specificity': 0.67297083, 'f1': 0.7216278, 'auroc': 0.8223007, 'binary_precision': 0.6618705, 'binary_recall': 0.35384616, 'binary_specificity': 0.99209553, 'binary_f1_score': 0.46115288}
confusion matrix:
      0   1
0  5899  47
1   168  92
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_resnet_lre5_bs32_classbalancing3/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_resnet_lre5_bs32_classbalancing3/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204385 KiB | 737735 KiB |    884 TiB |    884 TiB |
|       from large pool | 167936 KiB | 665600 KiB |    884 TiB |    884 TiB |
|       from small pool |  36449 KiB |  73422 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 204385 KiB | 737735 KiB |    884 TiB |    884 TiB |
|       from large pool | 167936 KiB | 665600 KiB |    884 TiB |    884 TiB |
|       from small pool |  36449 KiB |  73422 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201086 KiB | 730152 KiB |    884 TiB |    884 TiB |
|       from large pool | 165120 KiB | 658560 KiB |    883 TiB |    883 TiB |
|       from small pool |  35966 KiB |  72872 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    880 MiB |    900 MiB |   1478 MiB | 612352 KiB |
|       from large pool |    808 MiB |    828 MiB |   1378 MiB | 583680 KiB |
|       from small pool |     72 MiB |     72 MiB |    100 MiB |  28672 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 104862 KiB | 260793 KiB | 668180 GiB | 668180 GiB |
|       from large pool |  96256 KiB | 259208 KiB | 667443 GiB | 667443 GiB |
|       from small pool |   8606 KiB |  16195 KiB |    737 GiB |    737 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2064    |    3689    |   98420 K  |   98418 K  |
|       from large pool |      36    |      76    |   33301 K  |   33301 K  |
|       from small pool |    2028    |    3651    |   65119 K  |   65117 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2064    |    3689    |   98420 K  |   98418 K  |
|       from large pool |      36    |      76    |   33301 K  |   33301 K  |
|       from small pool |    2028    |    3651    |   65119 K  |   65117 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      50    |      51    |      70    |      20    |
|       from large pool |      14    |      15    |      20    |       6    |
|       from small pool |      36    |      36    |      50    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      52    |    1476    |   46257 K  |   46257 K  |
|       from large pool |       5    |      11    |   13954 K  |   13954 K  |
|       from small pool |      47    |    1470    |   32302 K  |   32302 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 737735 KiB |    884 TiB |    884 TiB |
|       from large pool |  16640 KiB | 665600 KiB |    884 TiB |    884 TiB |
|       from small pool |      0 KiB |  73422 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 737735 KiB |    884 TiB |    884 TiB |
|       from large pool |  16640 KiB | 665600 KiB |    884 TiB |    884 TiB |
|       from small pool |      0 KiB |  73422 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 730152 KiB |    884 TiB |    884 TiB |
|       from large pool |  16640 KiB | 658560 KiB |    883 TiB |    883 TiB |
|       from small pool |      0 KiB |  72872 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 309248 KiB |    900 MiB |   1478 MiB |   1176 MiB |
|       from large pool | 264192 KiB |    828 MiB |   1378 MiB |   1120 MiB |
|       from small pool |  45056 KiB |     72 MiB |    100 MiB |     56 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  83712 KiB | 260793 KiB | 668180 GiB | 668180 GiB |
|       from large pool |  83712 KiB | 259208 KiB | 667443 GiB | 667443 GiB |
|       from small pool |      0 KiB |  16201 KiB |    737 GiB |    737 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3689    |   98420 K  |   98420 K  |
|       from large pool |       2    |      76    |   33301 K  |   33301 K  |
|       from small pool |       0    |    3651    |   65119 K  |   65119 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3689    |   98420 K  |   98420 K  |
|       from large pool |       2    |      76    |   33301 K  |   33301 K  |
|       from small pool |       0    |    3651    |   65119 K  |   65119 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      51    |      70    |      39    |
|       from large pool |       9    |      15    |      20    |      11    |
|       from small pool |      22    |      36    |      50    |      28    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |    1476    |   46257 K  |   46257 K  |
|       from large pool |       1    |      11    |   13954 K  |   13954 K  |
|       from small pool |       0    |    1470    |   32302 K  |   32302 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 737735 KiB |    884 TiB |    884 TiB |
|       from large pool |  16640 KiB | 665600 KiB |    884 TiB |    884 TiB |
|       from small pool |      0 KiB |  73422 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 737735 KiB |    884 TiB |    884 TiB |
|       from large pool |  16640 KiB | 665600 KiB |    884 TiB |    884 TiB |
|       from small pool |      0 KiB |  73422 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 730152 KiB |    884 TiB |    884 TiB |
|       from large pool |  16640 KiB | 658560 KiB |    883 TiB |    883 TiB |
|       from small pool |      0 KiB |  72872 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 309248 KiB |    900 MiB |   1478 MiB |   1176 MiB |
|       from large pool | 264192 KiB |    828 MiB |   1378 MiB |   1120 MiB |
|       from small pool |  45056 KiB |     72 MiB |    100 MiB |     56 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  83712 KiB | 260793 KiB | 668180 GiB | 668180 GiB |
|       from large pool |  83712 KiB | 259208 KiB | 667443 GiB | 667443 GiB |
|       from small pool |      0 KiB |  16201 KiB |    737 GiB |    737 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3689    |   98420 K  |   98420 K  |
|       from large pool |       2    |      76    |   33301 K  |   33301 K  |
|       from small pool |       0    |    3651    |   65119 K  |   65119 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3689    |   98420 K  |   98420 K  |
|       from large pool |       2    |      76    |   33301 K  |   33301 K  |
|       from small pool |       0    |    3651    |   65119 K  |   65119 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      51    |      70    |      39    |
|       from large pool |       9    |      15    |      20    |      11    |
|       from small pool |      22    |      36    |      50    |      28    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |    1476    |   46257 K  |   46257 K  |
|       from large pool |       1    |      11    |   13954 K  |   13954 K  |
|       from small pool |       0    |    1470    |   32302 K  |   32302 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0




!!!: not committed yet



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_23_14_01_seed_2_21546971

 Experiment start at: 2024-06-22 23:14:01.206335
before training, model accuracy: 0.0544959120452404
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.90170336, 'precision': 0.45148775, 'recall': 0.49922, 'specificity': 0.49922, 'f1': 0.4741556, 'auroc': 0.3885905, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99844, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  42243  66
1   4539   0
---- Validation: 
scalar performance:
{'acc': 0.9667075, 'precision': 0.52103364, 'recall': 0.5009732, 'specificity': 0.5009732, 'f1': 0.49471474, 'auroc': 0.32325155, 'binary_precision': 0.074074075, 'binary_recall': 0.003322259, 'binary_specificity': 0.9986242, 'binary_f1_score': 0.0063593}
confusion matrix:
       0   1
0  18146  25
1    600   2
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9596089, 'precision': 0.52231544, 'recall': 0.501149, 'specificity': 0.501149, 'f1': 0.4936294, 'auroc': 0.30575824, 'binary_precision': 0.083333336, 'binary_recall': 0.004132231, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.007874016}
confusion matrix:
      0   1
0  5986  11
1   241   1
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546971_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-22 23:26:57.191804,epoch time: 0:12:55.985469,used: 0:12:55.985469,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_23_14_01_seed_2_21546971
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9031122, 'precision': 0.4515561, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4745449, 'auroc': 0.5045482, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42309  0
1   4539  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.33370626, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.2709352, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546971_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-22 23:39:41.603174,epoch time: 0:12:44.411370,used: 0:25:40.396839,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_23_14_01_seed_2_21546971
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9031335, 'precision': 0.45156676, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.47455078, 'auroc': 0.57906055, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42310  0
1   4538  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.35149944, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.30441928, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546971_3.png
