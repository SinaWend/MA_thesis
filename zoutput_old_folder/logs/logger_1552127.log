Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0




!!!: not committed yet



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512115

 Experiment start at: 2024-06-19 23:10:44.340231
before training, model accuracy: 0.3103227913379669
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9055223, 'precision': 0.45276114, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.47520947, 'auroc': 0.5693668, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42306  0
1   4414  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.35091487, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.33764517, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512115_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-19 23:28:49.581984,epoch time: 0:18:05.241753,used: 0:18:05.241753,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512115
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9055865, 'precision': 0.45279324, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.47522718, 'auroc': 0.75231564, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42309  0
1   4411  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.37321594, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.40534508, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512115_2.png
early stop counter: 1
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 2,now: 2024-06-19 23:45:58.708540,epoch time: 0:17:09.126556,used: 0:35:14.368309,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512115
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9098673, 'precision': 0.949968, 'recall': 0.5234139, 'specificity': 0.5234139, 'f1': 0.5210502, 'auroc': 0.87295103, 'binary_precision': 0.9904306, 'binary_recall': 0.046875, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.08951351}
confusion matrix:
       0    1
0  42302    2
1   4209  207
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.43913028, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.5835135, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512115_3.png
early stop counter: 2
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 3,now: 2024-06-20 00:04:40.284960,epoch time: 0:18:41.576420,used: 0:53:55.944729,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512115
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.92666954, 'precision': 0.9512036, 'recall': 0.61452615, 'specificity': 0.61452615, 'f1': 0.6664496, 'auroc': 0.9072615, 'binary_precision': 0.9768786, 'binary_recall': 0.22961956, 'binary_specificity': 0.9994327, 'binary_f1_score': 0.37183717}
confusion matrix:
       0     1
0  42280    24
1   3402  1014
---- Validation: 
scalar performance:
{'acc': 0.9654108, 'precision': 0.48288527, 'recall': 0.49980715, 'specificity': 0.49980715, 'f1': 0.4912005, 'auroc': 0.49290377, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9996143, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18142  7
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.7292199, 'recall': 0.5018323, 'specificity': 0.5018323, 'f1': 0.49315178, 'auroc': 0.67483866, 'binary_precision': 0.5, 'binary_recall': 0.0038314175, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.007604562}
confusion matrix:
      0  1
0  5996  1
1   260  1
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512115_4.png
early stop counter: 3
val acc:0.9654108285903931, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 4,now: 2024-06-20 00:21:57.294673,epoch time: 0:17:17.009713,used: 1:11:12.954442,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512115
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9463185, 'precision': 0.95072544, 'recall': 0.7254014, 'specificity': 0.7254014, 'f1': 0.792889, 'auroc': 0.931463, 'binary_precision': 0.95556617, 'binary_recall': 0.45300114, 'binary_specificity': 0.99780166, 'binary_f1_score': 0.61462814}
confusion matrix:
       0     1
0  42212    93
1   2415  2000
---- Validation: 
scalar performance:
{'acc': 0.9641869, 'precision': 0.51232576, 'recall': 0.50067365, 'specificity': 0.50067365, 'f1': 0.4938367, 'auroc': 0.57240534, 'binary_precision': 0.05882353, 'binary_recall': 0.00311042, 'binary_specificity': 0.99823684, 'binary_f1_score': 0.00590842}
confusion matrix:
       0   1
0  18117  32
1    641   2
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614893, 'precision': 0.8564249, 'recall': 0.5566375, 'specificity': 0.5566375, 'f1': 0.5898028, 'auroc': 0.76026714, 'binary_precision': 0.75, 'binary_recall': 0.11494253, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.19933555}
confusion matrix:
      0   1
0  5987  10
1   231  30
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512115_5.png
new oracle model saved
early stop counter: 4
val acc:0.9641869068145752, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9614893198013306
after epoch: 5,now: 2024-06-20 00:40:37.620930,epoch time: 0:18:40.326257,used: 1:29:53.280699,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512115
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.952012, 'precision': 0.9436786, 'recall': 0.76256776, 'specificity': 0.76256776, 'f1': 0.82481635, 'auroc': 0.9421245, 'binary_precision': 0.93434745, 'binary_recall': 0.5290118, 'binary_specificity': 0.9961237, 'binary_f1_score': 0.6755427}
confusion matrix:
       0     1
0  42144   164
1   2078  2334
---- Validation: 
scalar performance:
{'acc': 0.9630694, 'precision': 0.53061336, 'recall': 0.50309527, 'specificity': 0.50309527, 'f1': 0.49908915, 'auroc': 0.61135346, 'binary_precision': 0.0952381, 'binary_recall': 0.00933126, 'binary_specificity': 0.9968593, 'binary_f1_score': 0.016997168}
confusion matrix:
       0   1
0  18092  57
1    637   6
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96324706, 'precision': 0.83651304, 'recall': 0.5996983, 'specificity': 0.5996983, 'f1': 0.6482964, 'auroc': 0.7782512, 'binary_precision': 0.70666665, 'binary_recall': 0.20306513, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.3154762}
confusion matrix:
      0   1
0  5975  22
1   208  53
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512115_6.png
new oracle model saved
early stop counter: 5
val acc:0.9630693793296814, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9632470607757568
after epoch: 6,now: 2024-06-20 00:56:38.681908,epoch time: 0:16:01.060978,used: 1:45:54.341677,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512115
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9537885, 'precision': 0.9445373, 'recall': 0.7727355, 'specificity': 0.7727355, 'f1': 0.833494, 'auroc': 0.94327784, 'binary_precision': 0.9341294, 'binary_recall': 0.5495128, 'binary_specificity': 0.9959581, 'binary_f1_score': 0.6919675}
confusion matrix:
       0     1
0  42136   171
1   1988  2425
---- Validation: 
scalar performance:
{'acc': 0.9627501, 'precision': 0.53783315, 'recall': 0.5044301, 'specificity': 0.5044301, 'f1': 0.50167984, 'auroc': 0.60730416, 'binary_precision': 0.10958904, 'binary_recall': 0.01244168, 'binary_specificity': 0.99641854, 'binary_f1_score': 0.022346368}
confusion matrix:
       0   1
0  18084  65
1    635   8
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96276766, 'precision': 0.8067693, 'recall': 0.6159392, 'specificity': 0.6159392, 'f1': 0.6640881, 'auroc': 0.77644104, 'binary_precision': 0.6458333, 'binary_recall': 0.23754789, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.3473389}
confusion matrix:
      0   1
0  5963  34
1   199  62
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512115_7.png
early stop counter: 6
val acc:0.9627500772476196, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9632470607757568
after epoch: 7,now: 2024-06-20 01:15:32.840503,epoch time: 0:18:54.158595,used: 2:04:48.500272,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512115
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9592894, 'precision': 0.93543637, 'recall': 0.81313705, 'specificity': 0.81313705, 'f1': 0.8618989, 'auroc': 0.948146, 'binary_precision': 0.9079675, 'binary_recall': 0.63296306, 'binary_specificity': 0.9933111, 'binary_f1_score': 0.7459258}
confusion matrix:
       0     1
0  42026   283
1   1619  2792
---- Validation: 
scalar performance:
{'acc': 0.9605683, 'precision': 0.55041534, 'recall': 0.51080114, 'specificity': 0.51080114, 'f1': 0.5131, 'auroc': 0.6168107, 'binary_precision': 0.13432837, 'binary_recall': 0.02799378, 'binary_specificity': 0.9936085, 'binary_f1_score': 0.046332046}
confusion matrix:
       0    1
0  18033  116
1    625   18
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96324706, 'precision': 0.7944712, 'recall': 0.65100366, 'specificity': 0.65100366, 'f1': 0.6971473, 'auroc': 0.7809473, 'binary_precision': 0.6183206, 'binary_recall': 0.31034482, 'binary_specificity': 0.9916625, 'binary_f1_score': 0.41326532}
confusion matrix:
      0   1
0  5947  50
1   180  81
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512115_8.png
early stop counter: 7
val acc:0.9605683088302612, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9632470607757568
after epoch: 8,now: 2024-06-20 01:29:44.766518,epoch time: 0:14:11.926015,used: 2:19:00.426287,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512115
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.95858306, 'precision': 0.9387785, 'recall': 0.80617535, 'specificity': 0.80617535, 'f1': 0.85788906, 'auroc': 0.9443257, 'binary_precision': 0.9160792, 'binary_recall': 0.6182601, 'binary_specificity': 0.9940907, 'binary_f1_score': 0.7382659}
confusion matrix:
       0     1
0  42056   250
1   1685  2729
---- Validation: 
scalar performance:
{'acc': 0.96067476, 'precision': 0.5667364, 'recall': 0.51535654, 'specificity': 0.51535654, 'f1': 0.520454, 'auroc': 0.62775224, 'binary_precision': 0.16666667, 'binary_recall': 0.03732504, 'binary_specificity': 0.99338806, 'binary_f1_score': 0.060991105}
confusion matrix:
       0    1
0  18029  120
1    619   24
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9638862, 'precision': 0.80134046, 'recall': 0.6568342, 'specificity': 0.6568342, 'f1': 0.7038761, 'auroc': 0.79089546, 'binary_precision': 0.6315789, 'binary_recall': 0.3218391, 'binary_specificity': 0.9918293, 'binary_f1_score': 0.42639592}
confusion matrix:
      0   1
0  5948  49
1   177  84
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512115_9.png
new oracle model saved
early stop counter: 8
val acc:0.9606747627258301, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9638862013816833
after epoch: 9,now: 2024-06-20 01:42:59.342158,epoch time: 0:13:14.575640,used: 2:32:15.001927,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512115
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9629923, 'precision': 0.9259237, 'recall': 0.8459804, 'specificity': 0.8459804, 'f1': 0.8807509, 'auroc': 0.95989513, 'binary_precision': 0.88230264, 'binary_recall': 0.70172256, 'binary_specificity': 0.99023825, 'binary_f1_score': 0.7817195}
confusion matrix:
       0     1
0  41895   413
1   1316  3096
---- Validation: 
scalar performance:
{'acc': 0.95843977, 'precision': 0.5890616, 'recall': 0.5337009, 'specificity': 0.5337009, 'f1': 0.5461142, 'auroc': 0.67985713, 'binary_precision': 0.21008404, 'binary_recall': 0.077760495, 'binary_specificity': 0.9896413, 'binary_f1_score': 0.11350737}
confusion matrix:
       0    1
0  17961  188
1    593   50
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96356666, 'precision': 0.78423804, 'recall': 0.6933141, 'specificity': 0.6933141, 'f1': 0.72909504, 'auroc': 0.81134117, 'binary_precision': 0.5942857, 'binary_recall': 0.39846742, 'binary_specificity': 0.9881607, 'binary_f1_score': 0.47706422}
confusion matrix:
      0    1
0  5926   71
1   157  104
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512115_10.png
early stop counter: 9
val acc:0.9584397673606873, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9638862013816833
after epoch: 10,now: 2024-06-20 01:57:36.562293,epoch time: 0:14:37.220135,used: 2:46:52.222062,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512115
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96121573, 'precision': 0.91803944, 'recall': 0.8422916, 'specificity': 0.8422916, 'f1': 0.8754116, 'auroc': 0.9564791, 'binary_precision': 0.86715657, 'binary_recall': 0.6956916, 'binary_specificity': 0.98889154, 'binary_f1_score': 0.77201813}
confusion matrix:
       0     1
0  41840   470
1   1342  3068
---- Validation: 
scalar performance:
{'acc': 0.95737547, 'precision': 0.58785766, 'recall': 0.5376502, 'specificity': 0.5376502, 'f1': 0.5504148, 'auroc': 0.66871274, 'binary_precision': 0.2074074, 'binary_recall': 0.08709176, 'binary_specificity': 0.9882087, 'binary_f1_score': 0.122672506}
confusion matrix:
       0    1
0  17935  214
1    587   56
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9610099, 'precision': 0.75901246, 'recall': 0.69564474, 'specificity': 0.69564474, 'f1': 0.72234005, 'auroc': 0.8172918, 'binary_precision': 0.5435898, 'binary_recall': 0.40613025, 'binary_specificity': 0.9851592, 'binary_f1_score': 0.4649123}
confusion matrix:
      0    1
0  5908   89
1   155  106
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512115_11.png
early stop counter: 10
val acc:0.9573754668235779, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9638862013816833
after epoch: 11,now: 2024-06-20 02:07:55.533505,epoch time: 0:10:18.971212,used: 2:57:11.193274,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512115
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9620719, 'precision': 0.9221008, 'recall': 0.8438822, 'specificity': 0.8438822, 'f1': 0.8779669, 'auroc': 0.96037835, 'binary_precision': 0.8750355, 'binary_recall': 0.6981645, 'binary_specificity': 0.9895998, 'binary_f1_score': 0.77665746}
confusion matrix:
       0     1
0  41867   440
1   1332  3081
---- Validation: 
scalar performance:
{'acc': 0.9579076, 'precision': 0.5872361, 'recall': 0.5349255, 'specificity': 0.5349255, 'f1': 0.5473208, 'auroc': 0.6758382, 'binary_precision': 0.20634921, 'binary_recall': 0.08087092, 'binary_specificity': 0.9889801, 'binary_f1_score': 0.116201125}
confusion matrix:
       0    1
0  17949  200
1    591   52
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96356666, 'precision': 0.780185, 'recall': 0.71163744, 'specificity': 0.71163744, 'f1': 0.74054724, 'auroc': 0.8195394, 'binary_precision': 0.5846154, 'binary_recall': 0.43678162, 'binary_specificity': 0.98649323, 'binary_f1_score': 0.5}
confusion matrix:
      0    1
0  5916   81
1   147  114
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512115_12.png
early stop counter: 11
val acc:0.9579076170921326, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9638862013816833
after epoch: 12,now: 2024-06-20 02:20:28.511248,epoch time: 0:12:32.977743,used: 3:09:44.171017,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512115
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9629709, 'precision': 0.9112268, 'recall': 0.8627764, 'specificity': 0.8627764, 'f1': 0.88507324, 'auroc': 0.9618993, 'binary_precision': 0.8492972, 'binary_recall': 0.7392388, 'binary_specificity': 0.986314, 'binary_f1_score': 0.79045546}
confusion matrix:
       0     1
0  41727   579
1   1151  3263
---- Validation: 
scalar performance:
{'acc': 0.9572691, 'precision': 0.6121376, 'recall': 0.5578466, 'specificity': 0.5578466, 'f1': 0.57468987, 'auroc': 0.69567937, 'binary_precision': 0.25460124, 'binary_recall': 0.12908243, 'binary_specificity': 0.98661083, 'binary_f1_score': 0.17131062}
confusion matrix:
       0    1
0  17906  243
1    560   83
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9638862, 'precision': 0.7777686, 'recall': 0.74295384, 'specificity': 0.74295384, 'f1': 0.75904787, 'auroc': 0.8344178, 'binary_precision': 0.5770925, 'binary_recall': 0.5019157, 'binary_specificity': 0.983992, 'binary_f1_score': 0.53688526}
confusion matrix:
      0    1
0  5901   96
1   130  131
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512115_13.png
early stop counter: 12
val acc:0.9572690725326538, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9638862013816833
after epoch: 13,now: 2024-06-20 02:34:04.610801,epoch time: 0:13:36.099553,used: 3:23:20.270570,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512115
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96389127, 'precision': 0.9222177, 'recall': 0.8560499, 'specificity': 0.8560499, 'f1': 0.88558376, 'auroc': 0.9649681, 'binary_precision': 0.8728118, 'binary_recall': 0.7230909, 'binary_specificity': 0.9890089, 'binary_f1_score': 0.79092824}
confusion matrix:
       0     1
0  41842   465
1   1222  3191
---- Validation: 
scalar performance:
{'acc': 0.95854616, 'precision': 0.6113385, 'recall': 0.5487571, 'specificity': 0.5487571, 'f1': 0.5655465, 'auroc': 0.7068878, 'binary_precision': 0.2536232, 'binary_recall': 0.108864695, 'binary_specificity': 0.9886495, 'binary_f1_score': 0.1523395}
confusion matrix:
       0    1
0  17943  206
1    573   70
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9654842, 'precision': 0.79275155, 'recall': 0.7364583, 'specificity': 0.7364583, 'f1': 0.76124716, 'auroc': 0.8302967, 'binary_precision': 0.6076555, 'binary_recall': 0.48659003, 'binary_specificity': 0.9863265, 'binary_f1_score': 0.54042554}
confusion matrix:
      0    1
0  5915   82
1   134  127
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512115_14.png
new oracle model saved
early stop counter: 13
val acc:0.9585461616516113, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9654842019081116
after epoch: 14,now: 2024-06-20 02:49:57.424053,epoch time: 0:15:52.813252,used: 3:39:13.083822,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512115
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9638057, 'precision': 0.919, 'recall': 0.859179, 'specificity': 0.859179, 'f1': 0.88618016, 'auroc': 0.96161175, 'binary_precision': 0.8656997, 'binary_recall': 0.7301767, 'binary_specificity': 0.98818135, 'binary_f1_score': 0.7921838}
confusion matrix:
       0     1
0  41806   500
1   1191  3223
---- Validation: 
scalar performance:
{'acc': 0.9583333, 'precision': 0.62047434, 'recall': 0.5583976, 'specificity': 0.5583976, 'f1': 0.576774, 'auroc': 0.6979904, 'binary_precision': 0.27124184, 'binary_recall': 0.12908243, 'binary_specificity': 0.9877128, 'binary_f1_score': 0.17492096}
confusion matrix:
       0    1
0  17926  223
1    560   83
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964845, 'precision': 0.7856132, 'recall': 0.7434541, 'specificity': 0.7434541, 'f1': 0.76264346, 'auroc': 0.83657044, 'binary_precision': 0.5927602, 'binary_recall': 0.5019157, 'binary_specificity': 0.9849925, 'binary_f1_score': 0.5435685}
confusion matrix:
      0    1
0  5907   90
1   130  131
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512115_15.png
early stop counter: 14
val acc:0.9583333134651184, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9654842019081116
after epoch: 15,now: 2024-06-20 03:04:56.183529,epoch time: 0:14:58.759476,used: 3:54:11.843298,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512115
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9645762, 'precision': 0.90551364, 'recall': 0.88202924, 'specificity': 0.88202924, 'f1': 0.8933226, 'auroc': 0.96725744, 'binary_precision': 0.83377755, 'binary_recall': 0.7802721, 'binary_specificity': 0.98378634, 'binary_f1_score': 0.806138}
confusion matrix:
       0     1
0  41624   686
1    969  3441
---- Validation: 
scalar performance:
{'acc': 0.9537037, 'precision': 0.60295767, 'recall': 0.5695018, 'specificity': 0.5695018, 'f1': 0.5823025, 'auroc': 0.71722686, 'binary_precision': 0.23543124, 'binary_recall': 0.15707621, 'binary_specificity': 0.9819274, 'binary_f1_score': 0.18843286}
confusion matrix:
       0    1
0  17821  328
1    542  101
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96196866, 'precision': 0.7622919, 'recall': 0.75844437, 'specificity': 0.75844437, 'f1': 0.76035196, 'auroc': 0.84263587, 'binary_precision': 0.54474705, 'binary_recall': 0.5363985, 'binary_specificity': 0.98049027, 'binary_f1_score': 0.5405405}
confusion matrix:
      0    1
0  5880  117
1   121  140
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512115_16.png
early stop counter: 15
val acc:0.9537037014961243, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9654842019081116
after epoch: 16,now: 2024-06-20 03:21:26.292314,epoch time: 0:16:30.108785,used: 4:10:41.952083,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512115
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.96607447, 'precision': 0.9183638, 'recall': 0.87559724, 'specificity': 0.87559724, 'f1': 0.8955165, 'auroc': 0.97177494, 'binary_precision': 0.86104727, 'binary_recall': 0.76405257, 'binary_specificity': 0.9871419, 'binary_f1_score': 0.8096553}
confusion matrix:
       0     1
0  41764   544
1   1041  3371
---- Validation: 
scalar performance:
{'acc': 0.95721585, 'precision': 0.6237736, 'recall': 0.57057005, 'specificity': 0.57057005, 'f1': 0.58861196, 'auroc': 0.7303808, 'binary_precision': 0.27700832, 'binary_recall': 0.15552099, 'binary_specificity': 0.98561907, 'binary_f1_score': 0.19920318}
confusion matrix:
       0    1
0  17888  261
1    543  100
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650048, 'precision': 0.78406787, 'recall': 0.7600285, 'specificity': 0.7600285, 'f1': 0.771449, 'auroc': 0.8484255, 'binary_precision': 0.5882353, 'binary_recall': 0.5363985, 'binary_specificity': 0.9836585, 'binary_f1_score': 0.56112224}
confusion matrix:
      0    1
0  5899   98
1   121  140
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512115_17.png
early stop counter: 16
val acc:0.9572158455848694, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9654842019081116
after epoch: 17,now: 2024-06-20 03:36:22.386594,epoch time: 0:14:56.094280,used: 4:25:38.046363,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512115
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9648116, 'precision': 0.908417, 'recall': 0.8796202, 'specificity': 0.8796202, 'f1': 0.8933456, 'auroc': 0.96584576, 'binary_precision': 0.8401377, 'binary_recall': 0.7746032, 'binary_specificity': 0.9846372, 'binary_f1_score': 0.8060406}
confusion matrix:
       0     1
0  41660   650
1    994  3416
---- Validation: 
scalar performance:
{'acc': 0.9559387, 'precision': 0.6111023, 'recall': 0.56540847, 'specificity': 0.56540847, 'f1': 0.5811983, 'auroc': 0.70518035, 'binary_precision': 0.25201073, 'binary_recall': 0.14618973, 'binary_specificity': 0.98462725, 'binary_f1_score': 0.18503937}
confusion matrix:
       0    1
0  17870  279
1    549   94
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96340686, 'precision': 0.7720133, 'recall': 0.76102704, 'specificity': 0.76102704, 'f1': 0.7663919, 'auroc': 0.84161747, 'binary_precision': 0.564, 'binary_recall': 0.54022986, 'binary_specificity': 0.9818242, 'binary_f1_score': 0.5518591}
confusion matrix:
      0    1
0  5888  109
1   120  141
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512115_18.png
early stop counter: 17
val acc:0.9559386968612671, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9654842019081116
after epoch: 18,now: 2024-06-20 03:50:59.001740,epoch time: 0:14:36.615146,used: 4:40:14.661509,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512115
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9641695, 'precision': 0.90683454, 'recall': 0.8773379, 'specificity': 0.8773379, 'f1': 0.89137626, 'auroc': 0.9677421, 'binary_precision': 0.8374384, 'binary_recall': 0.77027637, 'binary_specificity': 0.9843994, 'binary_f1_score': 0.80245453}
confusion matrix:
       0     1
0  41646   660
1   1014  3400
---- Validation: 
scalar performance:
{'acc': 0.9562048, 'precision': 0.6187506, 'recall': 0.57229674, 'specificity': 0.57229674, 'f1': 0.5888402, 'auroc': 0.7209333, 'binary_precision': 0.26683939, 'binary_recall': 0.16018662, 'binary_specificity': 0.9844068, 'binary_f1_score': 0.20019437}
confusion matrix:
       0    1
0  17866  283
1    540  103
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9643656, 'precision': 0.778263, 'recall': 0.7670243, 'specificity': 0.7670243, 'f1': 0.77251256, 'auroc': 0.85157824, 'binary_precision': 0.576, 'binary_recall': 0.55172414, 'binary_specificity': 0.9823245, 'binary_f1_score': 0.5636008}
confusion matrix:
      0    1
0  5891  106
1   117  144
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512115_19.png
early stop counter: 18
val acc:0.9562047719955444, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9654842019081116
after epoch: 19,now: 2024-06-20 04:03:11.174432,epoch time: 0:12:12.172692,used: 4:52:26.834201,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512115
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.96577483, 'precision': 0.9036646, 'recall': 0.8940516, 'specificity': 0.8940516, 'f1': 0.8987835, 'auroc': 0.9720005, 'binary_precision': 0.8275541, 'binary_recall': 0.80561846, 'binary_specificity': 0.98248476, 'binary_f1_score': 0.816439}
confusion matrix:
       0     1
0  41565   741
1    858  3556
---- Validation: 
scalar performance:
{'acc': 0.9550341, 'precision': 0.6209509, 'recall': 0.58369154, 'specificity': 0.58369154, 'f1': 0.5983049, 'auroc': 0.73855686, 'binary_precision': 0.27045456, 'binary_recall': 0.18506998, 'binary_specificity': 0.9823131, 'binary_f1_score': 0.21975993}
confusion matrix:
       0    1
0  17828  321
1    524  119
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9654842, 'precision': 0.78541505, 'recall': 0.7749373, 'specificity': 0.7749373, 'f1': 0.78006554, 'auroc': 0.84922475, 'binary_precision': 0.58964145, 'binary_recall': 0.5670498, 'binary_specificity': 0.98282474, 'binary_f1_score': 0.578125}
confusion matrix:
      0    1
0  5894  103
1   113  148
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512115_20.png
early stop counter: 19
val acc:0.955034077167511, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9654842019081116
after epoch: 20,now: 2024-06-20 04:13:44.756184,epoch time: 0:10:33.581752,used: 5:03:00.415953,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512115
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.96793664, 'precision': 0.919715, 'recall': 0.88702726, 'specificity': 0.88702726, 'f1': 0.90252733, 'auroc': 0.9724205, 'binary_precision': 0.86142784, 'binary_recall': 0.7872678, 'binary_specificity': 0.9867867, 'binary_f1_score': 0.82267994}
confusion matrix:
       0     1
0  41747   559
1    939  3475
---- Validation: 
scalar performance:
{'acc': 0.95689654, 'precision': 0.6276391, 'recall': 0.5779053, 'specificity': 0.5779053, 'f1': 0.5957166, 'auroc': 0.7362398, 'binary_precision': 0.2842377, 'binary_recall': 0.1710731, 'binary_specificity': 0.98473746, 'binary_f1_score': 0.21359222}
confusion matrix:
       0    1
0  17872  277
1    533  110
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96612334, 'precision': 0.791536, 'recall': 0.7679415, 'specificity': 0.7679415, 'f1': 0.7791784, 'auroc': 0.8468602, 'binary_precision': 0.60251045, 'binary_recall': 0.55172414, 'binary_specificity': 0.98415875, 'binary_f1_score': 0.5759999}
confusion matrix:
      0    1
0  5902   95
1   117  144
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512115_21.png
new oracle model saved
early stop counter: 20
val acc:0.9568965435028076, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9661233425140381
after epoch: 21,now: 2024-06-20 04:23:41.748503,epoch time: 0:09:56.992319,used: 5:12:57.408272,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512115
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.96609586, 'precision': 0.9005588, 'recall': 0.90153384, 'specificity': 0.90153384, 'f1': 0.90104556, 'auroc': 0.9754286, 'binary_precision': 0.8197018, 'binary_recall': 0.8219302, 'binary_specificity': 0.98113745, 'binary_f1_score': 0.8208145}
confusion matrix:
       0     1
0  41508   798
1    786  3628
---- Validation: 
scalar performance:
{'acc': 0.9520541, 'precision': 0.61344343, 'recall': 0.5933996, 'specificity': 0.5933996, 'f1': 0.6022566, 'auroc': 0.7332773, 'binary_precision': 0.25475284, 'binary_recall': 0.20839813, 'binary_specificity': 0.978401, 'binary_f1_score': 0.22925577}
confusion matrix:
       0    1
0  17757  392
1    509  134
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959412, 'precision': 0.74662876, 'recall': 0.7736014, 'specificity': 0.7736014, 'f1': 0.7593124, 'auroc': 0.854224, 'binary_precision': 0.5120275, 'binary_recall': 0.57088125, 'binary_specificity': 0.9763215, 'binary_f1_score': 0.53985506}
confusion matrix:
      0    1
0  5855  142
1   112  149
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512115_22.png
early stop counter: 21
val acc:0.9520540833473206, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9661233425140381
after epoch: 22,now: 2024-06-20 04:34:07.295963,epoch time: 0:10:25.547460,used: 5:23:22.955732,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512115
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9677012, 'precision': 0.9089243, 'recall': 0.9003501, 'specificity': 0.9003501, 'f1': 0.9045788, 'auroc': 0.9747715, 'binary_precision': 0.8368531, 'binary_recall': 0.8173164, 'binary_specificity': 0.9833838, 'binary_f1_score': 0.8269694}
confusion matrix:
       0     1
0  41605   703
1    806  3606
---- Validation: 
scalar performance:
{'acc': 0.95301193, 'precision': 0.62085116, 'recall': 0.5983958, 'specificity': 0.5983958, 'f1': 0.60825616, 'auroc': 0.75395834, 'binary_precision': 0.26923078, 'binary_recall': 0.21772939, 'binary_specificity': 0.9790622, 'binary_f1_score': 0.24075668}
confusion matrix:
       0    1
0  17769  380
1    503  140
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96228826, 'precision': 0.7632073, 'recall': 0.7824315, 'specificity': 0.7824315, 'f1': 0.77243316, 'auroc': 0.85943097, 'binary_precision': 0.54448396, 'binary_recall': 0.5862069, 'binary_specificity': 0.978656, 'binary_f1_score': 0.5645757}
confusion matrix:
      0    1
0  5869  128
1   108  153
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512115_23.png
early stop counter: 22
val acc:0.9530119299888611, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9661233425140381
after epoch: 23,now: 2024-06-20 04:44:33.032467,epoch time: 0:10:25.736504,used: 5:33:48.692236,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512115
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9645976, 'precision': 0.88981277, 'recall': 0.9086859, 'specificity': 0.9086859, 'f1': 0.8989586, 'auroc': 0.9748695, 'binary_precision': 0.79643166, 'binary_recall': 0.83975524, 'binary_specificity': 0.97761655, 'binary_f1_score': 0.81751996}
confusion matrix:
       0     1
0  41361   947
1    707  3705
---- Validation: 
scalar performance:
{'acc': 0.9522137, 'precision': 0.6254606, 'recall': 0.6122336, 'specificity': 0.6122336, 'f1': 0.6184105, 'auroc': 0.75782156, 'binary_precision': 0.27748692, 'binary_recall': 0.24727838, 'binary_specificity': 0.9771888, 'binary_f1_score': 0.26151314}
confusion matrix:
       0    1
0  17735  414
1    484  159
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.7529682, 'recall': 0.79800534, 'specificity': 0.79800534, 'f1': 0.7733737, 'auroc': 0.8661758, 'binary_precision': 0.5225806, 'binary_recall': 0.62068963, 'binary_specificity': 0.975321, 'binary_f1_score': 0.56742555}
confusion matrix:
      0    1
0  5849  148
1    99  162
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512115_24.png
early stop counter: 23
val acc:0.952213704586029, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9661233425140381
after epoch: 24,now: 2024-06-20 04:54:31.714109,epoch time: 0:09:58.681642,used: 5:43:47.373878,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512115
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9666524, 'precision': 0.9004452, 'recall': 0.9061212, 'specificity': 0.9061212, 'f1': 0.90325737, 'auroc': 0.97339654, 'binary_precision': 0.8185061, 'binary_recall': 0.8314836, 'binary_specificity': 0.9807588, 'binary_f1_score': 0.82494384}
confusion matrix:
       0     1
0  41491   814
1    744  3671
---- Validation: 
scalar performance:
{'acc': 0.9541826, 'precision': 0.6263475, 'recall': 0.5982518, 'specificity': 0.5982518, 'f1': 0.6102246, 'auroc': 0.7451669, 'binary_precision': 0.28024194, 'binary_recall': 0.21617419, 'binary_specificity': 0.9803295, 'binary_f1_score': 0.24407375}
confusion matrix:
       0    1
0  17792  357
1    504  139
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642058, 'precision': 0.77537006, 'recall': 0.78343195, 'specificity': 0.78343195, 'f1': 0.779335, 'auroc': 0.857565, 'binary_precision': 0.5687732, 'binary_recall': 0.5862069, 'binary_specificity': 0.980657, 'binary_f1_score': 0.5773584}
confusion matrix:
      0    1
0  5881  116
1   108  153
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512115_25.png
early stop counter: 24
val acc:0.9541826248168945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9661233425140381
after epoch: 25,now: 2024-06-20 05:04:57.666534,epoch time: 0:10:25.952425,used: 5:54:13.326303,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512115
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9676156, 'precision': 0.905233, 'recall': 0.9054798, 'specificity': 0.9054798, 'f1': 0.9053563, 'auroc': 0.97635335, 'binary_precision': 0.8283126, 'binary_recall': 0.8288758, 'binary_specificity': 0.98208374, 'binary_f1_score': 0.8285941}
confusion matrix:
       0     1
0  41550   758
1    755  3657
---- Validation: 
scalar performance:
{'acc': 0.95381016, 'precision': 0.6229647, 'recall': 0.5958088, 'specificity': 0.5958088, 'f1': 0.60738957, 'auroc': 0.7542133, 'binary_precision': 0.27364185, 'binary_recall': 0.21150856, 'binary_specificity': 0.9801091, 'binary_f1_score': 0.2385965}
confusion matrix:
       0    1
0  17788  361
1    507  136
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964845, 'precision': 0.7784766, 'recall': 0.79475945, 'specificity': 0.79475945, 'f1': 0.78635556, 'auroc': 0.86526537, 'binary_precision': 0.5740072, 'binary_recall': 0.6091954, 'binary_specificity': 0.9803235, 'binary_f1_score': 0.5910781}
confusion matrix:
      0    1
0  5879  118
1   102  159
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512115_26.png
early stop counter: 25
val acc:0.9538101553916931, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9661233425140381
after epoch: 26,now: 2024-06-20 05:15:18.293758,epoch time: 0:10:20.627224,used: 6:04:33.953527,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512115
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.96372, 'precision': 0.882638, 'recall': 0.9160334, 'specificity': 0.9160334, 'f1': 0.8984194, 'auroc': 0.9792074, 'binary_precision': 0.7803218, 'binary_recall': 0.85723996, 'binary_specificity': 0.9748269, 'binary_f1_score': 0.8169744}
confusion matrix:
       0     1
0  41242  1065
1    630  3783
---- Validation: 
scalar performance:
{'acc': 0.95258623, 'precision': 0.63194966, 'recall': 0.6214271, 'specificity': 0.6214271, 'f1': 0.62643063, 'auroc': 0.7600372, 'binary_precision': 0.2898305, 'binary_recall': 0.2659409, 'binary_specificity': 0.97691333, 'binary_f1_score': 0.27737224}
confusion matrix:
       0    1
0  17730  419
1    472  171
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964046, 'precision': 0.7736784, 'recall': 0.7906779, 'specificity': 0.7906779, 'f1': 0.7818872, 'auroc': 0.8653234, 'binary_precision': 0.5647482, 'binary_recall': 0.6015326, 'binary_specificity': 0.97982323, 'binary_f1_score': 0.58256036}
confusion matrix:
      0    1
0  5876  121
1   104  157
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512115_27.png
early stop counter: 26
val acc:0.9525862336158752, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9661233425140381
after epoch: 27,now: 2024-06-20 05:25:15.296602,epoch time: 0:09:57.002844,used: 6:14:30.956371,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512115
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.96956336, 'precision': 0.9153203, 'recall': 0.9044856, 'specificity': 0.9044856, 'f1': 0.90981114, 'auroc': 0.9764743, 'binary_precision': 0.8489024, 'binary_recall': 0.82426304, 'binary_specificity': 0.98470813, 'binary_f1_score': 0.83640134}
confusion matrix:
       0     1
0  41663   647
1    775  3635
---- Validation: 
scalar performance:
{'acc': 0.9563644, 'precision': 0.6362157, 'recall': 0.59488106, 'specificity': 0.59488106, 'f1': 0.6112343, 'auroc': 0.7519215, 'binary_precision': 0.30022573, 'binary_recall': 0.20684293, 'binary_specificity': 0.98291916, 'binary_f1_score': 0.24493556}
confusion matrix:
       0    1
0  17839  310
1    510  133
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9693193, 'precision': 0.81328726, 'recall': 0.7879323, 'specificity': 0.7879323, 'f1': 0.8000106, 'auroc': 0.8612435, 'binary_precision': 0.6443515, 'binary_recall': 0.5900383, 'binary_specificity': 0.98582625, 'binary_f1_score': 0.616}
confusion matrix:
      0    1
0  5912   85
1   107  154
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512115_28.png
new oracle model saved
early stop counter: 27
val acc:0.9563643932342529, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9693192839622498
after epoch: 28,now: 2024-06-20 05:35:05.781341,epoch time: 0:09:50.484739,used: 6:24:21.441110,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512115
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.96652395, 'precision': 0.89725345, 'recall': 0.9105793, 'specificity': 0.9105793, 'f1': 0.90377367, 'auroc': 0.976562, 'binary_precision': 0.8110941, 'binary_recall': 0.84160435, 'binary_specificity': 0.97955424, 'binary_f1_score': 0.8260676}
confusion matrix:
       0     1
0  41442   865
1    699  3714
---- Validation: 
scalar performance:
{'acc': 0.95226693, 'precision': 0.6273391, 'recall': 0.6152614, 'specificity': 0.6152614, 'f1': 0.62094414, 'auroc': 0.7578936, 'binary_precision': 0.28103447, 'binary_recall': 0.2534992, 'binary_specificity': 0.97702354, 'binary_f1_score': 0.26655763}
confusion matrix:
       0    1
0  17732  417
1    480  163
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.7564049, 'recall': 0.7965065, 'specificity': 0.7965065, 'f1': 0.7747892, 'auroc': 0.8664485, 'binary_precision': 0.52960527, 'binary_recall': 0.61685824, 'binary_specificity': 0.97615474, 'binary_f1_score': 0.56991154}
confusion matrix:
      0    1
0  5854  143
1   100  161
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512115_29.png
early stop counter: 28
val acc:0.9522669315338135, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9693192839622498
after epoch: 29,now: 2024-06-20 05:44:47.078823,epoch time: 0:09:41.297482,used: 6:34:02.738592,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512115
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.96746576, 'precision': 0.89632535, 'recall': 0.9199438, 'specificity': 0.9199438, 'f1': 0.9076895, 'auroc': 0.9790054, 'binary_precision': 0.8072187, 'binary_recall': 0.86135024, 'binary_specificity': 0.9785373, 'binary_f1_score': 0.83340645}
confusion matrix:
       0     1
0  41398   908
1    612  3802
---- Validation: 
scalar performance:
{'acc': 0.9536505, 'precision': 0.643794, 'recall': 0.63622916, 'specificity': 0.63622916, 'f1': 0.63989216, 'auroc': 0.77496237, 'binary_precision': 0.3125, 'binary_recall': 0.29548988, 'binary_specificity': 0.9769684, 'binary_f1_score': 0.30375698}
confusion matrix:
       0    1
0  17731  418
1    453  190
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96724194, 'precision': 0.7936688, 'recall': 0.8033394, 'specificity': 0.8033394, 'f1': 0.79841566, 'auroc': 0.8680341, 'binary_precision': 0.6037037, 'binary_recall': 0.6245211, 'binary_specificity': 0.98215777, 'binary_f1_score': 0.61393595}
confusion matrix:
      0    1
0  5890  107
1    98  163
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512115_30.png
early stop counter: 29
val acc:0.9536504745483398, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9693192839622498
after epoch: 30,now: 2024-06-20 05:54:27.620435,epoch time: 0:09:40.541612,used: 6:43:43.280204,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512115
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 6:43:43.280204 at 2024-06-20 05:54:27.620435
persisted model performance metric: 

scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.33764517, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
oracle model performance metric: 

scalar performance:
{'acc': 0.9693193, 'precision': 0.81328726, 'recall': 0.7879323, 'specificity': 0.7879323, 'f1': 0.8000106, 'auroc': 0.8612435, 'binary_precision': 0.6443515, 'binary_recall': 0.5900383, 'binary_specificity': 0.98582625, 'binary_f1_score': 0.616}
confusion matrix:
      0    1
0  5912   85
1   107  154
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_irm_resnet_different_bs128_lre4_classbalancing/rule_results/7.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_irm_resnet_different_bs128_lre4_classbalancing/rule_results/7.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_irm_resnet_different_bs128_lre4_classbalancing/confusion_matrix/7.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204097 KiB |   1730 MiB | 464697 GiB | 464696 GiB |
|       from large pool | 167936 KiB |   1660 MiB | 464621 GiB | 464621 GiB |
|       from small pool |  36161 KiB |     72 MiB |     75 GiB |     75 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 204097 KiB |   1730 MiB | 464697 GiB | 464696 GiB |
|       from large pool | 167936 KiB |   1660 MiB | 464621 GiB | 464621 GiB |
|       from small pool |  36161 KiB |     72 MiB |     75 GiB |     75 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201088 KiB |   1723 MiB | 464691 GiB | 464691 GiB |
|       from large pool | 165120 KiB |   1653 MiB | 464617 GiB | 464617 GiB |
|       from small pool |  35968 KiB |     71 MiB |     74 GiB |     74 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2270 MiB |   2270 MiB |   2270 MiB |      0 B   |
|       from large pool |   2196 MiB |   2196 MiB |   2196 MiB |      0 B   |
|       from small pool |     74 MiB |     74 MiB |     74 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 404158 KiB | 758032 KiB | 356974 GiB | 356974 GiB |
|       from large pool | 397312 KiB | 756864 KiB | 356898 GiB | 356897 GiB |
|       from small pool |   6846 KiB |  12716 KiB |     76 GiB |     76 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1194    |    1851    |   12183 K  |   12182 K  |
|       from large pool |      36    |      76    |    4890 K  |    4890 K  |
|       from small pool |    1158    |    1780    |    7293 K  |    7292 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1194    |    1851    |   12183 K  |   12182 K  |
|       from large pool |      36    |      76    |    4890 K  |    4890 K  |
|       from small pool |    1158    |    1780    |    7293 K  |    7292 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      51    |      51    |      51    |       0    |
|       from large pool |      14    |      14    |      14    |       0    |
|       from small pool |      37    |      37    |      37    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      47    |     381    |    7036 K  |    7036 K  |
|       from large pool |       5    |      10    |    1647 K  |    1647 K  |
|       from small pool |      42    |     376    |    5389 K  |    5389 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1730 MiB | 464697 GiB | 464697 GiB |
|       from large pool |  16640 KiB |   1660 MiB | 464621 GiB | 464621 GiB |
|       from small pool |      0 KiB |     72 MiB |     75 GiB |     75 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1730 MiB | 464697 GiB | 464697 GiB |
|       from large pool |  16640 KiB |   1660 MiB | 464621 GiB | 464621 GiB |
|       from small pool |      0 KiB |     72 MiB |     75 GiB |     75 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1723 MiB | 464691 GiB | 464691 GiB |
|       from large pool |  16640 KiB |   1653 MiB | 464617 GiB | 464617 GiB |
|       from small pool |      0 KiB |     71 MiB |     74 GiB |     74 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 608256 KiB |   2270 MiB |   2270 MiB |   1676 MiB |
|       from large pool | 565248 KiB |   2196 MiB |   2196 MiB |   1644 MiB |
|       from small pool |  43008 KiB |     74 MiB |     74 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 384768 KiB | 758032 KiB | 356974 GiB | 356974 GiB |
|       from large pool | 384768 KiB | 756864 KiB | 356898 GiB | 356897 GiB |
|       from small pool |      0 KiB |  14441 KiB |     76 GiB |     76 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1851    |   12183 K  |   12183 K  |
|       from large pool |       2    |      76    |    4890 K  |    4890 K  |
|       from small pool |       0    |    1780    |    7293 K  |    7293 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1851    |   12183 K  |   12183 K  |
|       from large pool |       2    |      76    |    4890 K  |    4890 K  |
|       from small pool |       0    |    1780    |    7293 K  |    7293 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      30    |      51    |      51    |      21    |
|       from large pool |       9    |      14    |      14    |       5    |
|       from small pool |      21    |      37    |      37    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     381    |    7036 K  |    7036 K  |
|       from large pool |       1    |      11    |    1647 K  |    1647 K  |
|       from small pool |       0    |     376    |    5389 K  |    5389 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1730 MiB | 464697 GiB | 464697 GiB |
|       from large pool |  16640 KiB |   1660 MiB | 464621 GiB | 464621 GiB |
|       from small pool |      0 KiB |     72 MiB |     75 GiB |     75 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1730 MiB | 464697 GiB | 464697 GiB |
|       from large pool |  16640 KiB |   1660 MiB | 464621 GiB | 464621 GiB |
|       from small pool |      0 KiB |     72 MiB |     75 GiB |     75 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1723 MiB | 464691 GiB | 464691 GiB |
|       from large pool |  16640 KiB |   1653 MiB | 464617 GiB | 464617 GiB |
|       from small pool |      0 KiB |     71 MiB |     74 GiB |     74 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 608256 KiB |   2270 MiB |   2270 MiB |   1676 MiB |
|       from large pool | 565248 KiB |   2196 MiB |   2196 MiB |   1644 MiB |
|       from small pool |  43008 KiB |     74 MiB |     74 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 384768 KiB | 758032 KiB | 356974 GiB | 356974 GiB |
|       from large pool | 384768 KiB | 756864 KiB | 356898 GiB | 356897 GiB |
|       from small pool |      0 KiB |  14441 KiB |     76 GiB |     76 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1851    |   12183 K  |   12183 K  |
|       from large pool |       2    |      76    |    4890 K  |    4890 K  |
|       from small pool |       0    |    1780    |    7293 K  |    7293 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1851    |   12183 K  |   12183 K  |
|       from large pool |       2    |      76    |    4890 K  |    4890 K  |
|       from small pool |       0    |    1780    |    7293 K  |    7293 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      30    |      51    |      51    |      21    |
|       from large pool |       9    |      14    |      14    |       5    |
|       from small pool |      21    |      37    |      37    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     381    |    7036 K  |    7036 K  |
|       from large pool |       1    |      11    |    1647 K  |    1647 K  |
|       from small pool |       0    |     376    |    5389 K  |    5389 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0




!!!: not committed yet



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_05_59_57_seed_1_21512115

 Experiment start at: 2024-06-20 05:59:57.101076
before training, model accuracy: 0.14631003141403198
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.907363, 'precision': 0.45371065, 'recall': 0.49996462, 'specificity': 0.49996462, 'f1': 0.47571597, 'auroc': 0.49982697, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99992925, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42392  3
1   4325  0
---- Validation: 
scalar performance:
{'acc': 0.9639808, 'precision': 0.48204184, 'recall': 0.49994466, 'specificity': 0.49994466, 'f1': 0.49083003, 'auroc': 0.32691562, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998893, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18065  2
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.21474731, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512115_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-20 06:11:08.653147,epoch time: 0:11:11.552071,used: 0:11:11.552071,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_05_59_57_seed_1_21512115
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9074058, 'precision': 0.45372233, 'recall': 0.49997643, 'specificity': 0.49997643, 'f1': 0.4757277, 'auroc': 0.70117545, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99995285, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42394  2
1   4324  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.35309497, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.26135847, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512115_2.png
better model found
persisted
after epoch: 2,now: 2024-06-20 06:21:38.468007,epoch time: 0:10:29.814860,used: 0:21:41.366931,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_05_59_57_seed_1_21512115
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9069563, 'precision': 0.644215, 'recall': 0.503374, 'specificity': 0.503374, 'f1': 0.48350888, 'auroc': 0.8393775, 'binary_precision': 0.38043478, 'binary_recall': 0.008092485, 'binary_specificity': 0.9986555, 'binary_f1_score': 0.01584786}
confusion matrix:
       0   1
0  42338  57
1   4290  35
---- Validation: 
scalar performance:
{'acc': 0.9635539, 'precision': 0.48203418, 'recall': 0.49972326, 'specificity': 0.49972326, 'f1': 0.49071938, 'auroc': 0.4014771, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9994465, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18057  10
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.42797, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512115_3.png
early stop counter: 1
val acc:0.9635539054870605, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 3,now: 2024-06-20 06:32:05.247906,epoch time: 0:10:26.779899,used: 0:32:08.146830,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_05_59_57_seed_1_21512115
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9171661, 'precision': 0.8677547, 'recall': 0.56600076, 'specificity': 0.56600076, 'f1': 0.5940304, 'auroc': 0.8879066, 'binary_precision': 0.8167832, 'binary_recall': 0.13509136, 'binary_specificity': 0.99691015, 'binary_f1_score': 0.23183802}
confusion matrix:
       0    1
0  42266  131
1   3739  584
---- Validation: 
scalar performance:
{'acc': 0.9635539, 'precision': 0.48203418, 'recall': 0.49972326, 'specificity': 0.49972326, 'f1': 0.49071938, 'auroc': 0.4475659, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9994465, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18057  10
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.52203274, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512115_4.png
early stop counter: 2
val acc:0.9635539054870605, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 4,now: 2024-06-20 06:42:40.028509,epoch time: 0:10:34.780603,used: 0:42:42.927433,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_05_59_57_seed_1_21512115
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9325342, 'precision': 0.9032804, 'recall': 0.65657717, 'specificity': 0.65657717, 'f1': 0.71496826, 'auroc': 0.906611, 'binary_precision': 0.87190866, 'binary_recall': 0.31791908, 'binary_specificity': 0.99523526, 'binary_f1_score': 0.46594378}
confusion matrix:
       0     1
0  42193   202
1   2950  1375
---- Validation: 
scalar performance:
{'acc': 0.96286017, 'precision': 0.4820217, 'recall': 0.49936348, 'specificity': 0.49936348, 'f1': 0.49053937, 'auroc': 0.48775494, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99872696, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18044  23
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.6207534, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512115_5.png
early stop counter: 3
val acc:0.9628601670265198, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 5,now: 2024-06-20 06:52:43.864865,epoch time: 0:10:03.836356,used: 0:52:46.763789,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_05_59_57_seed_1_21512115
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9420805, 'precision': 0.9215015, 'recall': 0.7084493, 'specificity': 0.7084493, 'f1': 0.77152693, 'auroc': 0.9256431, 'binary_precision': 0.898965, 'binary_recall': 0.4217341, 'binary_specificity': 0.9951645, 'binary_f1_score': 0.57412654}
confusion matrix:
       0     1
0  42190   205
1   2501  1824
---- Validation: 
scalar performance:
{'acc': 0.9618463, 'precision': 0.49339187, 'recall': 0.49955294, 'specificity': 0.49955294, 'f1': 0.49167025, 'auroc': 0.5360628, 'binary_precision': 0.022727273, 'binary_recall': 0.0014858841, 'binary_specificity': 0.99762, 'binary_f1_score': 0.0027894003}
confusion matrix:
       0   1
0  18024  43
1    672   1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579439, 'precision': 0.70156705, 'recall': 0.5072719, 'specificity': 0.5072719, 'f1': 0.504123, 'auroc': 0.69458294, 'binary_precision': 0.44444445, 'binary_recall': 0.015384615, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.029739777}
confusion matrix:
      0  1
0  5941  5
1   256  4
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512115_6.png
early stop counter: 4
val acc:0.9618462920188904, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 6,now: 2024-06-20 07:02:40.978628,epoch time: 0:09:57.113763,used: 1:02:43.877552,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_05_59_57_seed_1_21512115
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9495291, 'precision': 0.9276589, 'recall': 0.75189877, 'specificity': 0.75189877, 'f1': 0.81209254, 'auroc': 0.932227, 'binary_precision': 0.903239, 'binary_recall': 0.5093642, 'binary_specificity': 0.9944333, 'binary_f1_score': 0.6513898}
confusion matrix:
       0     1
0  42159   236
1   2122  2203
---- Validation: 
scalar performance:
{'acc': 0.9603522, 'precision': 0.49553964, 'recall': 0.4994933, 'specificity': 0.4994933, 'f1': 0.49256384, 'auroc': 0.56257164, 'binary_precision': 0.027027028, 'binary_recall': 0.0029717681, 'binary_specificity': 0.99601483, 'binary_f1_score': 0.0053547523}
confusion matrix:
       0   1
0  17995  72
1    671   2
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589107, 'precision': 0.7707274, 'recall': 0.5335222, 'specificity': 0.5335222, 'f1': 0.5513367, 'auroc': 0.73936063, 'binary_precision': 0.58064514, 'binary_recall': 0.06923077, 'binary_specificity': 0.99781364, 'binary_f1_score': 0.12371134}
confusion matrix:
      0   1
0  5933  13
1   242  18
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512115_7.png
new oracle model saved
early stop counter: 5
val acc:0.9603521823883057, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9589107036590576
after epoch: 7,now: 2024-06-20 07:12:42.026378,epoch time: 0:10:01.047750,used: 1:12:44.925302,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_05_59_57_seed_1_21512115
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9531678, 'precision': 0.91996324, 'recall': 0.7811569, 'specificity': 0.7811569, 'f1': 0.83363163, 'auroc': 0.93958724, 'binary_precision': 0.8822477, 'binary_recall': 0.570074, 'binary_specificity': 0.99223983, 'binary_f1_score': 0.69261026}
confusion matrix:
       0     1
0  42067   329
1   1859  2465
---- Validation: 
scalar performance:
{'acc': 0.9590182, 'precision': 0.5181875, 'recall': 0.503093, 'specificity': 0.503093, 'f1': 0.4997397, 'auroc': 0.5892473, 'binary_precision': 0.072072074, 'binary_recall': 0.011887073, 'binary_specificity': 0.994299, 'binary_f1_score': 0.020408163}
confusion matrix:
       0    1
0  17964  103
1    665    8
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96100545, 'precision': 0.79336137, 'recall': 0.586107, 'specificity': 0.586107, 'f1': 0.62770635, 'auroc': 0.75957394, 'binary_precision': 0.6216216, 'binary_recall': 0.17692308, 'binary_specificity': 0.99529094, 'binary_f1_score': 0.2754491}
confusion matrix:
      0   1
0  5918  28
1   214  46
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512115_8.png
new oracle model saved
early stop counter: 6
val acc:0.9590181708335876, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.961005449295044
after epoch: 8,now: 2024-06-20 07:22:40.479318,epoch time: 0:09:58.452940,used: 1:22:43.378242,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_05_59_57_seed_1_21512115
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.95682794, 'precision': 0.92330325, 'recall': 0.8025471, 'specificity': 0.8025471, 'f1': 0.85049766, 'auroc': 0.9467796, 'binary_precision': 0.88484645, 'binary_recall': 0.61323154, 'binary_specificity': 0.99186265, 'binary_f1_score': 0.7244159}
confusion matrix:
       0     1
0  42052   345
1   1672  2651
---- Validation: 
scalar performance:
{'acc': 0.95757735, 'precision': 0.5289421, 'recall': 0.5066374, 'specificity': 0.5066374, 'f1': 0.5061672, 'auroc': 0.64173615, 'binary_precision': 0.093333334, 'binary_recall': 0.020802377, 'binary_specificity': 0.99247247, 'binary_f1_score': 0.03402187}
confusion matrix:
       0    1
0  17931  136
1    659   14
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96471155, 'precision': 0.8241904, 'recall': 0.6468887, 'specificity': 0.6468887, 'f1': 0.698903, 'auroc': 0.7986727, 'binary_precision': 0.67826086, 'binary_recall': 0.3, 'binary_specificity': 0.99377733, 'binary_f1_score': 0.416}
confusion matrix:
      0   1
0  5909  37
1   182  78
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512115_9.png
new oracle model saved
early stop counter: 7
val acc:0.9575773477554321, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9647115468978882
after epoch: 9,now: 2024-06-20 07:32:29.646944,epoch time: 0:09:49.167626,used: 1:32:32.545868,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_05_59_57_seed_1_21512115
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9587329, 'precision': 0.92129993, 'recall': 0.8169759, 'specificity': 0.8169759, 'f1': 0.8599769, 'auroc': 0.94768286, 'binary_precision': 0.8780025, 'binary_recall': 0.64305556, 'binary_specificity': 0.9908962, 'binary_f1_score': 0.7423838}
confusion matrix:
       0     1
0  42014   386
1   1542  2778
---- Validation: 
scalar performance:
{'acc': 0.95581645, 'precision': 0.5416078, 'recall': 0.5128768, 'specificity': 0.5128768, 'f1': 0.51608706, 'auroc': 0.636448, 'binary_precision': 0.1182266, 'binary_recall': 0.035661217, 'binary_specificity': 0.99009246, 'binary_f1_score': 0.054794513}
confusion matrix:
       0    1
0  17888  179
1    649   24
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9618111, 'precision': 0.77610576, 'recall': 0.652731, 'specificity': 0.652731, 'f1': 0.6946228, 'auroc': 0.79027337, 'binary_precision': 0.58156025, 'binary_recall': 0.31538463, 'binary_specificity': 0.9900774, 'binary_f1_score': 0.40897754}
confusion matrix:
      0   1
0  5887  59
1   178  82
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512115_10.png
early stop counter: 8
val acc:0.9558164477348328, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9647115468978882
after epoch: 10,now: 2024-06-20 07:42:37.686236,epoch time: 0:10:08.039292,used: 1:42:40.585160,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_05_59_57_seed_1_21512115
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9588399, 'precision': 0.9253252, 'recall': 0.8142301, 'specificity': 0.8142301, 'f1': 0.85943055, 'auroc': 0.9493588, 'binary_precision': 0.88667095, 'binary_recall': 0.636763, 'binary_specificity': 0.99169713, 'binary_f1_score': 0.74121916}
confusion matrix:
       0     1
0  42043   352
1   1571  2754
---- Validation: 
scalar performance:
{'acc': 0.957524, 'precision': 0.5627604, 'recall': 0.51733875, 'specificity': 0.51733875, 'f1': 0.52309126, 'auroc': 0.6408411, 'binary_precision': 0.160221, 'binary_recall': 0.043090638, 'binary_specificity': 0.99158686, 'binary_f1_score': 0.06791569}
confusion matrix:
       0    1
0  17915  152
1    644   29
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96084434, 'precision': 0.7633221, 'recall': 0.6577434, 'specificity': 0.6577434, 'f1': 0.69568527, 'auroc': 0.79771924, 'binary_precision': 0.5555556, 'binary_recall': 0.32692307, 'binary_specificity': 0.9885637, 'binary_f1_score': 0.4116223}
confusion matrix:
      0   1
0  5878  68
1   175  85
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512115_11.png
early stop counter: 9
val acc:0.9575240015983582, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9647115468978882
after epoch: 11,now: 2024-06-20 07:52:27.186824,epoch time: 0:09:49.500588,used: 1:52:30.085748,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_05_59_57_seed_1_21512115
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9616438, 'precision': 0.91254, 'recall': 0.84664357, 'specificity': 0.84664357, 'f1': 0.87599367, 'auroc': 0.9547716, 'binary_precision': 0.8545811, 'binary_recall': 0.70552856, 'binary_specificity': 0.9877586, 'binary_f1_score': 0.7729346}
confusion matrix:
       0     1
0  41878   519
1   1273  3050
---- Validation: 
scalar performance:
{'acc': 0.9527215, 'precision': 0.57042867, 'recall': 0.5348755, 'specificity': 0.5348755, 'f1': 0.54485637, 'auroc': 0.67359245, 'binary_precision': 0.17431192, 'binary_recall': 0.08469539, 'binary_specificity': 0.9850556, 'binary_f1_score': 0.114}
confusion matrix:
       0    1
0  17797  270
1    616   57
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621334, 'precision': 0.7668353, 'recall': 0.7282976, 'specificity': 0.7282976, 'f1': 0.7458689, 'auroc': 0.81993, 'binary_precision': 0.5565611, 'binary_recall': 0.4730769, 'binary_specificity': 0.9835183, 'binary_f1_score': 0.5114345}
confusion matrix:
      0    1
0  5848   98
1   137  123
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512115_12.png
early stop counter: 10
val acc:0.9527214765548706, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9647115468978882
after epoch: 12,now: 2024-06-20 08:02:11.268281,epoch time: 0:09:44.081457,used: 2:02:14.167205,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_05_59_57_seed_1_21512115
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9619007, 'precision': 0.92608845, 'recall': 0.8340173, 'specificity': 0.8340173, 'f1': 0.8731047, 'auroc': 0.95549625, 'binary_precision': 0.8843599, 'binary_recall': 0.6770689, 'binary_specificity': 0.9909657, 'binary_f1_score': 0.7669547}
confusion matrix:
       0     1
0  42011   383
1   1397  2929
---- Validation: 
scalar performance:
{'acc': 0.9570971, 'precision': 0.5950603, 'recall': 0.53428376, 'specificity': 0.53428376, 'f1': 0.54724914, 'auroc': 0.6743969, 'binary_precision': 0.22362868, 'binary_recall': 0.078751855, 'binary_specificity': 0.9898157, 'binary_f1_score': 0.11648352}
confusion matrix:
       0    1
0  17883  184
1    620   53
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650338, 'precision': 0.79653996, 'recall': 0.7114214, 'specificity': 0.7114214, 'f1': 0.746014, 'auroc': 0.819888, 'binary_precision': 0.61748636, 'binary_recall': 0.43461537, 'binary_specificity': 0.98822737, 'binary_f1_score': 0.51015806}
confusion matrix:
      0    1
0  5876   70
1   147  113
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512115_13.png
new oracle model saved
early stop counter: 11
val acc:0.9570971131324768, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9650338292121887
after epoch: 13,now: 2024-06-20 08:12:20.548775,epoch time: 0:10:09.280494,used: 2:12:23.447699,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_05_59_57_seed_1_21512115
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96359164, 'precision': 0.9154304, 'recall': 0.857263, 'specificity': 0.857263, 'f1': 0.883588, 'auroc': 0.9613112, 'binary_precision': 0.85831285, 'binary_recall': 0.7267684, 'binary_specificity': 0.9877577, 'binary_f1_score': 0.7870822}
confusion matrix:
       0     1
0  41875   519
1   1182  3144
---- Validation: 
scalar performance:
{'acc': 0.9565101, 'precision': 0.6030244, 'recall': 0.54256254, 'specificity': 0.54256254, 'f1': 0.55762935, 'auroc': 0.6946012, 'binary_precision': 0.2389706, 'binary_recall': 0.096582465, 'binary_specificity': 0.9885427, 'binary_f1_score': 0.13756615}
confusion matrix:
       0    1
0  17860  207
1    608   65
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9626168, 'precision': 0.77025145, 'recall': 0.73222786, 'specificity': 0.73222786, 'f1': 0.7496127, 'auroc': 0.8279824, 'binary_precision': 0.5630631, 'binary_recall': 0.48076922, 'binary_specificity': 0.9836865, 'binary_f1_score': 0.5186722}
confusion matrix:
      0    1
0  5849   97
1   135  125
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512115_14.png
early stop counter: 12
val acc:0.9565101265907288, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9650338292121887
after epoch: 14,now: 2024-06-20 08:25:10.152403,epoch time: 0:12:49.603628,used: 2:25:13.051327,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_05_59_57_seed_1_21512115
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.96322775, 'precision': 0.9115513, 'recall': 0.85928416, 'specificity': 0.85928416, 'f1': 0.88317966, 'auroc': 0.9577975, 'binary_precision': 0.8500806, 'binary_recall': 0.73172987, 'binary_specificity': 0.9868384, 'binary_f1_score': 0.78647774}
confusion matrix:
       0     1
0  41838   558
1   1160  3164
---- Validation: 
scalar performance:
{'acc': 0.9535219, 'precision': 0.59718066, 'recall': 0.5531723, 'specificity': 0.5531723, 'f1': 0.5672775, 'auroc': 0.69330776, 'binary_precision': 0.22651933, 'binary_recall': 0.121842496, 'binary_specificity': 0.98450214, 'binary_f1_score': 0.1584541}
confusion matrix:
       0    1
0  17787  280
1    591   82
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9622946, 'precision': 0.7668936, 'recall': 0.7412546, 'specificity': 0.7412546, 'f1': 0.75334084, 'auroc': 0.83120644, 'binary_precision': 0.5555556, 'binary_recall': 0.5, 'binary_specificity': 0.98250926, 'binary_f1_score': 0.5263158}
confusion matrix:
      0    1
0  5842  104
1   130  130
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512115_15.png
early stop counter: 13
val acc:0.9535219073295593, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9650338292121887
after epoch: 15,now: 2024-06-20 08:36:43.177159,epoch time: 0:11:33.024756,used: 2:36:46.076083,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_05_59_57_seed_1_21512115
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.96318495, 'precision': 0.9025192, 'recall': 0.87112606, 'specificity': 0.87112606, 'f1': 0.8860118, 'auroc': 0.9636457, 'binary_precision': 0.82949656, 'binary_recall': 0.7581503, 'binary_specificity': 0.9841019, 'binary_f1_score': 0.79222035}
confusion matrix:
       0     1
0  41721   674
1   1046  3279
---- Validation: 
scalar performance:
{'acc': 0.95298827, 'precision': 0.60009557, 'recall': 0.5586177, 'specificity': 0.5586177, 'f1': 0.5727303, 'auroc': 0.71598554, 'binary_precision': 0.23195876, 'binary_recall': 0.13372956, 'binary_specificity': 0.98350585, 'binary_f1_score': 0.16965127}
confusion matrix:
       0    1
0  17769  298
1    583   90
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9619723, 'precision': 0.7632525, 'recall': 0.7613153, 'specificity': 0.7613153, 'f1': 0.7622798, 'auroc': 0.84431684, 'binary_precision': 0.54651165, 'binary_recall': 0.5423077, 'binary_specificity': 0.9803229, 'binary_f1_score': 0.5444015}
confusion matrix:
      0    1
0  5829  117
1   119  141
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512115_16.png
early stop counter: 14
val acc:0.9529882669448853, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9650338292121887
after epoch: 16,now: 2024-06-20 08:48:31.876103,epoch time: 0:11:48.698944,used: 2:48:34.775027,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_05_59_57_seed_1_21512115
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9636986, 'precision': 0.90901124, 'recall': 0.8659817, 'specificity': 0.8659817, 'f1': 0.8859831, 'auroc': 0.95988774, 'binary_precision': 0.8436192, 'binary_recall': 0.7460685, 'binary_specificity': 0.9858949, 'binary_f1_score': 0.79185075}
confusion matrix:
       0     1
0  41798   598
1   1098  3226
---- Validation: 
scalar performance:
{'acc': 0.9526681, 'precision': 0.6004376, 'recall': 0.5605974, 'specificity': 0.5605974, 'f1': 0.57449114, 'auroc': 0.70141745, 'binary_precision': 0.2325, 'binary_recall': 0.13818721, 'binary_specificity': 0.98300767, 'binary_f1_score': 0.17334576}
confusion matrix:
       0    1
0  17760  307
1    580   93
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611666, 'precision': 0.7579935, 'recall': 0.7627338, 'specificity': 0.7627338, 'f1': 0.760339, 'auroc': 0.8428569, 'binary_precision': 0.53584903, 'binary_recall': 0.54615384, 'binary_specificity': 0.97931385, 'binary_f1_score': 0.5409524}
confusion matrix:
      0    1
0  5823  123
1   118  142
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512115_17.png
early stop counter: 15
val acc:0.9526680707931519, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9650338292121887
after epoch: 17,now: 2024-06-20 09:02:45.218269,epoch time: 0:14:13.342166,used: 3:02:48.117193,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_05_59_57_seed_1_21512115
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.96391267, 'precision': 0.90244585, 'recall': 0.876848, 'specificity': 0.876848, 'f1': 0.8891108, 'auroc': 0.9665117, 'binary_precision': 0.8281949, 'binary_recall': 0.7699954, 'binary_specificity': 0.9837005, 'binary_f1_score': 0.7980355}
confusion matrix:
       0     1
0  41703   691
1    995  3331
---- Validation: 
scalar performance:
{'acc': 0.9529349, 'precision': 0.6059668, 'recall': 0.5650274, 'specificity': 0.5650274, 'f1': 0.5795513, 'auroc': 0.72058916, 'binary_precision': 0.24324325, 'binary_recall': 0.14710252, 'binary_specificity': 0.98295236, 'binary_f1_score': 0.18333335}
confusion matrix:
       0    1
0  17759  308
1    574   99
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9629391, 'precision': 0.77042234, 'recall': 0.7544639, 'specificity': 0.7544639, 'f1': 0.76216805, 'auroc': 0.8391963, 'binary_precision': 0.5614754, 'binary_recall': 0.52692306, 'binary_specificity': 0.9820047, 'binary_f1_score': 0.54365075}
confusion matrix:
      0    1
0  5839  107
1   123  137
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512115_18.png
early stop counter: 16
val acc:0.9529349207878113, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9650338292121887
after epoch: 18,now: 2024-06-20 09:17:39.343146,epoch time: 0:14:54.124877,used: 3:17:42.242070,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_05_59_57_seed_1_21512115
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.96320635, 'precision': 0.8953742, 'recall': 0.8822708, 'specificity': 0.8822708, 'f1': 0.88868093, 'auroc': 0.9664098, 'binary_precision': 0.81281495, 'binary_recall': 0.7829404, 'binary_specificity': 0.9816012, 'binary_f1_score': 0.79759806}
confusion matrix:
       0     1
0  41614   780
1    939  3387
---- Validation: 
scalar performance:
{'acc': 0.9504269, 'precision': 0.6013052, 'recall': 0.57302517, 'specificity': 0.57302517, 'f1': 0.5843513, 'auroc': 0.7197239, 'binary_precision': 0.23333333, 'binary_recall': 0.16641901, 'binary_specificity': 0.97963136, 'binary_f1_score': 0.1942758}
confusion matrix:
       0    1
0  17699  368
1    561  112
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621334, 'precision': 0.7635393, 'recall': 0.77611125, 'specificity': 0.77611125, 'f1': 0.7696583, 'auroc': 0.849434, 'binary_precision': 0.5457876, 'binary_recall': 0.5730769, 'binary_specificity': 0.97914565, 'binary_f1_score': 0.55909944}
confusion matrix:
      0    1
0  5822  124
1   111  149
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512115_19.png
early stop counter: 17
val acc:0.9504268765449524, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9650338292121887
after epoch: 19,now: 2024-06-20 09:29:23.754858,epoch time: 0:11:44.411712,used: 3:29:26.653782,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_05_59_57_seed_1_21512115
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9656678, 'precision': 0.90763235, 'recall': 0.88235927, 'specificity': 0.88235927, 'f1': 0.8944812, 'auroc': 0.96870315, 'binary_precision': 0.83751553, 'binary_recall': 0.7801435, 'binary_specificity': 0.9845751, 'binary_f1_score': 0.8078121}
confusion matrix:
       0     1
0  41745   654
1    950  3371
---- Validation: 
scalar performance:
{'acc': 0.95373535, 'precision': 0.6150788, 'recall': 0.5704494, 'specificity': 0.5704494, 'f1': 0.5863301, 'auroc': 0.72231984, 'binary_precision': 0.26108375, 'binary_recall': 0.15750371, 'binary_specificity': 0.98339516, 'binary_f1_score': 0.19647822}
confusion matrix:
       0    1
0  17767  300
1    567  106
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621334, 'precision': 0.76421034, 'recall': 0.7632384, 'specificity': 0.7632384, 'f1': 0.7637234, 'auroc': 0.83956313, 'binary_precision': 0.54826254, 'binary_recall': 0.54615384, 'binary_specificity': 0.9803229, 'binary_f1_score': 0.54720616}
confusion matrix:
      0    1
0  5829  117
1   118  142
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512115_20.png
early stop counter: 18
val acc:0.9537353515625, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9650338292121887
after epoch: 20,now: 2024-06-20 09:45:19.580571,epoch time: 0:15:55.825713,used: 3:45:22.479495,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_05_59_57_seed_1_21512115
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9658818, 'precision': 0.9098276, 'recall': 0.8809697, 'specificity': 0.8809697, 'f1': 0.8947293, 'auroc': 0.970438, 'binary_precision': 0.8422373, 'binary_recall': 0.77677536, 'binary_specificity': 0.98516405, 'binary_f1_score': 0.8081829}
confusion matrix:
       0     1
0  41768   629
1    965  3358
---- Validation: 
scalar performance:
{'acc': 0.95426893, 'precision': 0.61328834, 'recall': 0.56500405, 'specificity': 0.56500405, 'f1': 0.5813042, 'auroc': 0.7207565, 'binary_precision': 0.25789472, 'binary_recall': 0.14561664, 'binary_specificity': 0.98439145, 'binary_f1_score': 0.18613485}
confusion matrix:
       0    1
0  17785  282
1    575   98
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96374476, 'precision': 0.77586234, 'recall': 0.7585623, 'specificity': 0.7585623, 'f1': 0.7668953, 'auroc': 0.842818, 'binary_precision': 0.5720165, 'binary_recall': 0.5346154, 'binary_specificity': 0.98250926, 'binary_f1_score': 0.5526839}
confusion matrix:
      0    1
0  5842  104
1   121  139
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512115_21.png
early stop counter: 19
val acc:0.9542689323425293, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9650338292121887
after epoch: 21,now: 2024-06-20 10:02:15.848516,epoch time: 0:16:56.267945,used: 4:02:18.747440,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_05_59_57_seed_1_21512115
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9662457, 'precision': 0.900054, 'recall': 0.898641, 'specificity': 0.898641, 'f1': 0.8993459, 'auroc': 0.97303975, 'binary_precision': 0.81889945, 'binary_recall': 0.8156799, 'binary_specificity': 0.981602, 'binary_f1_score': 0.81728643}
confusion matrix:
       0     1
0  41616   780
1    797  3527
---- Validation: 
scalar performance:
{'acc': 0.950587, 'precision': 0.6147832, 'recall': 0.59027463, 'specificity': 0.59027463, 'f1': 0.60076135, 'auroc': 0.739867, 'binary_precision': 0.25904763, 'binary_recall': 0.20208023, 'binary_specificity': 0.978469, 'binary_f1_score': 0.22704507}
confusion matrix:
       0    1
0  17678  389
1    537  136
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579439, 'precision': 0.7402033, 'recall': 0.78311986, 'specificity': 0.78311986, 'f1': 0.7596311, 'auroc': 0.8539432, 'binary_precision': 0.49838188, 'binary_recall': 0.5923077, 'binary_specificity': 0.973932, 'binary_f1_score': 0.54130054}
confusion matrix:
      0    1
0  5791  155
1   106  154
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512115_22.png
early stop counter: 20
val acc:0.9505869746208191, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9650338292121887
after epoch: 22,now: 2024-06-20 10:19:48.743769,epoch time: 0:17:32.895253,used: 4:19:51.642693,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_05_59_57_seed_1_21512115
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.96785104, 'precision': 0.9137358, 'recall': 0.8902035, 'specificity': 0.8902035, 'f1': 0.9015316, 'auroc': 0.9701341, 'binary_precision': 0.8482605, 'binary_recall': 0.7949133, 'binary_specificity': 0.9854936, 'binary_f1_score': 0.8207209}
confusion matrix:
       0     1
0  41780   615
1    887  3438
---- Validation: 
scalar performance:
{'acc': 0.9549627, 'precision': 0.6241423, 'recall': 0.5725165, 'specificity': 0.5725165, 'f1': 0.5902998, 'auroc': 0.7407594, 'binary_precision': 0.27906978, 'binary_recall': 0.16047548, 'binary_specificity': 0.9845575, 'binary_f1_score': 0.20377357}
confusion matrix:
       0    1
0  17788  279
1    565  108
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96728975, 'precision': 0.80109215, 'recall': 0.7732852, 'specificity': 0.7732852, 'f1': 0.78643227, 'auroc': 0.8495815, 'binary_precision': 0.6212766, 'binary_recall': 0.56153846, 'binary_specificity': 0.98503196, 'binary_f1_score': 0.589899}
confusion matrix:
      0    1
0  5857   89
1   114  146
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512115_23.png
new oracle model saved
early stop counter: 21
val acc:0.9549626708030701, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9672897458076477
after epoch: 23,now: 2024-06-20 10:37:04.752068,epoch time: 0:17:16.008299,used: 4:37:07.650992,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_05_59_57_seed_1_21512115
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9649187, 'precision': 0.89452547, 'recall': 0.8973906, 'specificity': 0.8973906, 'f1': 0.89595133, 'auroc': 0.97288597, 'binary_precision': 0.80798346, 'binary_recall': 0.8145236, 'binary_specificity': 0.9802576, 'binary_f1_score': 0.8112403}
confusion matrix:
       0     1
0  41559   837
1    802  3522
---- Validation: 
scalar performance:
{'acc': 0.95176095, 'precision': 0.611705, 'recall': 0.5787239, 'specificity': 0.5787239, 'f1': 0.5917644, 'auroc': 0.740602, 'binary_precision': 0.25373134, 'binary_recall': 0.1768202, 'binary_specificity': 0.98062766, 'binary_f1_score': 0.2084063}
confusion matrix:
       0    1
0  17717  350
1    554  119
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9634225, 'precision': 0.7710639, 'recall': 0.7859789, 'specificity': 0.7859789, 'f1': 0.7782942, 'auroc': 0.8555118, 'binary_precision': 0.56, 'binary_recall': 0.5923077, 'binary_specificity': 0.9796502, 'binary_f1_score': 0.5757009}
confusion matrix:
      0    1
0  5825  121
1   106  154
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512115_24.png
early stop counter: 22
val acc:0.9517609477043152, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9672897458076477
after epoch: 24,now: 2024-06-20 10:55:04.977447,epoch time: 0:18:00.225379,used: 4:55:07.876371,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_05_59_57_seed_1_21512115
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9670591, 'precision': 0.9032736, 'recall': 0.8998369, 'specificity': 0.8998369, 'f1': 0.9015458, 'auroc': 0.9731717, 'binary_precision': 0.8251634, 'binary_recall': 0.817341, 'binary_specificity': 0.9823328, 'binary_f1_score': 0.8212336}
confusion matrix:
       0     1
0  41646   749
1    790  3535
---- Validation: 
scalar performance:
{'acc': 0.9552828, 'precision': 0.6400133, 'recall': 0.59127945, 'specificity': 0.59127945, 'f1': 0.60963815, 'auroc': 0.7416879, 'binary_precision': 0.30946884, 'binary_recall': 0.19910847, 'binary_specificity': 0.9834505, 'binary_f1_score': 0.24231467}
confusion matrix:
       0    1
0  17768  299
1    539  134
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9658395, 'precision': 0.7896198, 'recall': 0.7725284, 'specificity': 0.7725284, 'f1': 0.7807809, 'auroc': 0.8514509, 'binary_precision': 0.59836066, 'binary_recall': 0.56153846, 'binary_specificity': 0.9835183, 'binary_f1_score': 0.5793651}
confusion matrix:
      0    1
0  5848   98
1   114  146
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512115_25.png
early stop counter: 23
val acc:0.9552828073501587, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9672897458076477
after epoch: 25,now: 2024-06-20 11:13:20.361656,epoch time: 0:18:15.384209,used: 5:13:23.260580,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_05_59_57_seed_1_21512115
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.96172947, 'precision': 0.8791189, 'recall': 0.8999108, 'specificity': 0.8999108, 'f1': 0.8891539, 'auroc': 0.9711002, 'binary_precision': 0.77630144, 'binary_recall': 0.82404625, 'binary_specificity': 0.9757754, 'binary_f1_score': 0.7994616}
confusion matrix:
       0     1
0  41368  1027
1    761  3564
---- Validation: 
scalar performance:
{'acc': 0.949413, 'precision': 0.613335, 'recall': 0.59538794, 'specificity': 0.59538794, 'f1': 0.6034268, 'auroc': 0.7443428, 'binary_precision': 0.25577265, 'binary_recall': 0.21396731, 'binary_specificity': 0.97680855, 'binary_f1_score': 0.2330097}
confusion matrix:
       0    1
0  17648  419
1    529  144
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9572994, 'precision': 0.73754597, 'recall': 0.7919785, 'specificity': 0.7919785, 'f1': 0.761526, 'auroc': 0.8663914, 'binary_precision': 0.49226007, 'binary_recall': 0.61153847, 'binary_specificity': 0.9724184, 'binary_f1_score': 0.54545456}
confusion matrix:
      0    1
0  5782  164
1   101  159
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512115_26.png
early stop counter: 24
val acc:0.949413001537323, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9672897458076477
after epoch: 26,now: 2024-06-20 11:33:50.141289,epoch time: 0:20:29.779633,used: 5:33:53.040213,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_05_59_57_seed_1_21512115
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9640839, 'precision': 0.8906499, 'recall': 0.89744985, 'specificity': 0.89744985, 'f1': 0.89401203, 'auroc': 0.9693629, 'binary_precision': 0.8001361, 'binary_recall': 0.8156799, 'binary_specificity': 0.97921973, 'binary_f1_score': 0.80783325}
confusion matrix:
       0     1
0  41515   881
1    797  3527
---- Validation: 
scalar performance:
{'acc': 0.9528815, 'precision': 0.6187577, 'recall': 0.5807356, 'specificity': 0.5807356, 'f1': 0.5954114, 'auroc': 0.7386184, 'binary_precision': 0.26769912, 'binary_recall': 0.17979197, 'binary_specificity': 0.9816793, 'binary_f1_score': 0.2151111}
confusion matrix:
       0    1
0  17736  331
1    552  121
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9653561, 'precision': 0.78361595, 'recall': 0.788827, 'specificity': 0.788827, 'f1': 0.7861946, 'auroc': 0.85819554, 'binary_precision': 0.5849057, 'binary_recall': 0.59615386, 'binary_specificity': 0.98150015, 'binary_f1_score': 0.5904762}
confusion matrix:
      0    1
0  5836  110
1   105  155
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512115_27.png
early stop counter: 25
val acc:0.9528815150260925, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9672897458076477
after epoch: 27,now: 2024-06-20 11:52:57.674315,epoch time: 0:19:07.533026,used: 5:53:00.573239,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_05_59_57_seed_1_21512115
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.965518, 'precision': 0.891099, 'recall': 0.90862405, 'specificity': 0.90862405, 'f1': 0.899613, 'auroc': 0.97554773, 'binary_precision': 0.79872274, 'binary_recall': 0.8388067, 'binary_specificity': 0.97844136, 'binary_f1_score': 0.81827414}
confusion matrix:
       0     1
0  41482   914
1    697  3627
---- Validation: 
scalar performance:
{'acc': 0.95085377, 'precision': 0.62070715, 'recall': 0.59756565, 'specificity': 0.59756565, 'f1': 0.60766524, 'auroc': 0.7527442, 'binary_precision': 0.27037036, 'binary_recall': 0.21693908, 'binary_specificity': 0.97819227, 'binary_f1_score': 0.24072547}
confusion matrix:
       0    1
0  17673  394
1    527  146
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9622946, 'precision': 0.7637212, 'recall': 0.7945852, 'specificity': 0.7945852, 'f1': 0.7781784, 'auroc': 0.8654344, 'binary_precision': 0.54452056, 'binary_recall': 0.61153847, 'binary_specificity': 0.97763205, 'binary_f1_score': 0.57608694}
confusion matrix:
      0    1
0  5813  133
1   101  159
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512115_28.png
early stop counter: 26
val acc:0.9508537650108337, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9672897458076477
after epoch: 28,now: 2024-06-20 12:13:44.242517,epoch time: 0:20:46.568202,used: 6:13:47.141441,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_05_59_57_seed_1_21512115
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9656678, 'precision': 0.8884882, 'recall': 0.91504085, 'specificity': 0.91504085, 'f1': 0.9011948, 'auroc': 0.97506714, 'binary_precision': 0.7920962, 'binary_recall': 0.852914, 'binary_specificity': 0.97716767, 'binary_f1_score': 0.8213808}
confusion matrix:
       0     1
0  41428   968
1    636  3688
---- Validation: 
scalar performance:
{'acc': 0.9488794, 'precision': 0.61891305, 'recall': 0.607986, 'specificity': 0.607986, 'f1': 0.6131323, 'auroc': 0.7531221, 'binary_precision': 0.26600984, 'binary_recall': 0.24071322, 'binary_specificity': 0.97525877, 'binary_f1_score': 0.2527301}
confusion matrix:
       0    1
0  17620  447
1    511  162
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95665485, 'precision': 0.73502266, 'recall': 0.798998, 'specificity': 0.798998, 'f1': 0.76256764, 'auroc': 0.8641504, 'binary_precision': 0.48656717, 'binary_recall': 0.6269231, 'binary_specificity': 0.971073, 'binary_f1_score': 0.5478992}
confusion matrix:
      0    1
0  5774  172
1    97  163
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512115_29.png
early stop counter: 27
val acc:0.9488794207572937, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9672897458076477
after epoch: 29,now: 2024-06-20 12:32:33.845198,epoch time: 0:18:49.602681,used: 6:32:36.744122,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_05_59_57_seed_1_21512115
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9647688, 'precision': 0.8929204, 'recall': 0.89894867, 'specificity': 0.89894867, 'f1': 0.8959049, 'auroc': 0.97019374, 'binary_precision': 0.8044121, 'binary_recall': 0.8181818, 'binary_specificity': 0.9797155, 'binary_f1_score': 0.8112386}
confusion matrix:
       0     1
0  41537   860
1    786  3537
---- Validation: 
scalar performance:
{'acc': 0.95202774, 'precision': 0.6241898, 'recall': 0.5945982, 'specificity': 0.5945982, 'f1': 0.6070071, 'auroc': 0.740765, 'binary_precision': 0.27755904, 'binary_recall': 0.20950966, 'binary_specificity': 0.97968674, 'binary_f1_score': 0.23878069}
confusion matrix:
       0    1
0  17700  367
1    532  141
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.962778, 'precision': 0.76664495, 'recall': 0.79299855, 'specificity': 0.79299855, 'f1': 0.7791137, 'auroc': 0.8644991, 'binary_precision': 0.5505226, 'binary_recall': 0.6076923, 'binary_specificity': 0.97830474, 'binary_f1_score': 0.5776965}
confusion matrix:
      0    1
0  5817  129
1   102  158
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512115_30.png
early stop counter: 28
val acc:0.9520277380943298, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9672897458076477
after epoch: 30,now: 2024-06-20 12:50:32.779091,epoch time: 0:17:58.933893,used: 6:50:35.678015,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_05_59_57_seed_1_21512115
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 6:50:35.678015 at 2024-06-20 12:50:32.779091
persisted model performance metric: 

scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.26135847, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
oracle model performance metric: 

scalar performance:
{'acc': 0.96728975, 'precision': 0.80109215, 'recall': 0.7732852, 'specificity': 0.7732852, 'f1': 0.78643227, 'auroc': 0.8495815, 'binary_precision': 0.6212766, 'binary_recall': 0.56153846, 'binary_specificity': 0.98503196, 'binary_f1_score': 0.589899}
confusion matrix:
      0    1
0  5857   89
1   114  146
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_irm_resnet_different_bs128_lre4_classbalancing/rule_results/7.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_irm_resnet_different_bs128_lre4_classbalancing/confusion_matrix/7.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204094 KiB |   1730 MiB |    907 TiB |    907 TiB |
|       from large pool | 167936 KiB |   1660 MiB |    906 TiB |    906 TiB |
|       from small pool |  36158 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 204094 KiB |   1730 MiB |    907 TiB |    907 TiB |
|       from large pool | 167936 KiB |   1660 MiB |    906 TiB |    906 TiB |
|       from small pool |  36158 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201086 KiB |   1723 MiB |    907 TiB |    907 TiB |
|       from large pool | 165120 KiB |   1653 MiB |    906 TiB |    906 TiB |
|       from small pool |  35966 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2196 MiB |   2270 MiB |   3872 MiB |   1676 MiB |
|       from large pool |   2122 MiB |   2196 MiB |   3766 MiB |   1644 MiB |
|       from small pool |     74 MiB |     74 MiB |    106 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 404161 KiB |    900 MiB | 736992 GiB | 736992 GiB |
|       from large pool | 397312 KiB |    899 MiB | 736839 GiB | 736839 GiB |
|       from small pool |   6849 KiB |     14 MiB |    153 GiB |    153 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1194    |    1851    |   24366 K  |   24365 K  |
|       from large pool |      36    |      76    |    9779 K  |    9779 K  |
|       from small pool |    1158    |    1780    |   14586 K  |   14585 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1194    |    1851    |   24366 K  |   24365 K  |
|       from large pool |      36    |      76    |    9779 K  |    9779 K  |
|       from small pool |    1158    |    1780    |   14586 K  |   14585 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      50    |      51    |      71    |      21    |
|       from large pool |      13    |      14    |      18    |       5    |
|       from small pool |      37    |      37    |      53    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      49    |     382    |   14155 K  |   14155 K  |
|       from large pool |       5    |      11    |    3385 K  |    3385 K  |
|       from small pool |      44    |     377    |   10769 K  |   10769 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1730 MiB |    907 TiB |    907 TiB |
|       from large pool |  16640 KiB |   1660 MiB |    906 TiB |    906 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1730 MiB |    907 TiB |    907 TiB |
|       from large pool |  16640 KiB |   1660 MiB |    906 TiB |    906 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1723 MiB |    907 TiB |    907 TiB |
|       from large pool |  16640 KiB |   1653 MiB |    906 TiB |    906 TiB |
|       from small pool |      0 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 608256 KiB |   2270 MiB |   3872 MiB |   3278 MiB |
|       from large pool | 565248 KiB |   2196 MiB |   3766 MiB |   3214 MiB |
|       from small pool |  43008 KiB |     74 MiB |    106 MiB |     64 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 384768 KiB |    900 MiB | 736993 GiB | 736992 GiB |
|       from large pool | 384768 KiB |    899 MiB | 736839 GiB | 736839 GiB |
|       from small pool |      0 KiB |     14 MiB |    153 GiB |    153 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1851    |   24366 K  |   24366 K  |
|       from large pool |       2    |      76    |    9779 K  |    9779 K  |
|       from small pool |       0    |    1780    |   14586 K  |   14586 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1851    |   24366 K  |   24366 K  |
|       from large pool |       2    |      76    |    9779 K  |    9779 K  |
|       from small pool |       0    |    1780    |   14586 K  |   14586 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      30    |      51    |      71    |      41    |
|       from large pool |       9    |      14    |      18    |       9    |
|       from small pool |      21    |      37    |      53    |      32    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     382    |   14155 K  |   14155 K  |
|       from large pool |       1    |      11    |    3385 K  |    3385 K  |
|       from small pool |       0    |     377    |   10769 K  |   10769 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1730 MiB |    907 TiB |    907 TiB |
|       from large pool |  16640 KiB |   1660 MiB |    906 TiB |    906 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1730 MiB |    907 TiB |    907 TiB |
|       from large pool |  16640 KiB |   1660 MiB |    906 TiB |    906 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1723 MiB |    907 TiB |    907 TiB |
|       from large pool |  16640 KiB |   1653 MiB |    906 TiB |    906 TiB |
|       from small pool |      0 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 608256 KiB |   2270 MiB |   3872 MiB |   3278 MiB |
|       from large pool | 565248 KiB |   2196 MiB |   3766 MiB |   3214 MiB |
|       from small pool |  43008 KiB |     74 MiB |    106 MiB |     64 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 384768 KiB |    900 MiB | 736993 GiB | 736992 GiB |
|       from large pool | 384768 KiB |    899 MiB | 736839 GiB | 736839 GiB |
|       from small pool |      0 KiB |     14 MiB |    153 GiB |    153 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1851    |   24366 K  |   24366 K  |
|       from large pool |       2    |      76    |    9779 K  |    9779 K  |
|       from small pool |       0    |    1780    |   14586 K  |   14586 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1851    |   24366 K  |   24366 K  |
|       from large pool |       2    |      76    |    9779 K  |    9779 K  |
|       from small pool |       0    |    1780    |   14586 K  |   14586 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      30    |      51    |      71    |      41    |
|       from large pool |       9    |      14    |      18    |       9    |
|       from small pool |      21    |      37    |      53    |      32    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     382    |   14155 K  |   14155 K  |
|       from large pool |       1    |      11    |    3385 K  |    3385 K  |
|       from small pool |       0    |     377    |   10769 K  |   10769 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0




!!!: not committed yet



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_13_00_25_seed_2_21512115

 Experiment start at: 2024-06-20 13:00:25.613554
before training, model accuracy: 0.0544959120452404
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9031122, 'precision': 0.4515561, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4745449, 'auroc': 0.5581531, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42309  0
1   4539  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.33731455, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.28645366, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512115_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-20 13:20:27.400822,epoch time: 0:20:01.787268,used: 0:20:01.787268,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_13_00_25_seed_2_21512115
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9031122, 'precision': 0.4515561, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4745449, 'auroc': 0.7505691, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42309  0
1   4539  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.39254713, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.4445336, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512115_2.png
early stop counter: 1
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 2,now: 2024-06-20 13:40:03.632029,epoch time: 0:19:36.231207,used: 0:39:38.018475,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_13_00_25_seed_2_21512115
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.90625, 'precision': 0.94963044, 'recall': 0.5162913, 'specificity': 0.5162913, 'f1': 0.50689805, 'auroc': 0.8641429, 'binary_precision': 0.9932886, 'binary_recall': 0.0326063, 'binary_specificity': 0.99997634, 'binary_f1_score': 0.06313993}
confusion matrix:
       0    1
0  42308    1
1   4391  148
---- Validation: 
scalar performance:
{'acc': 0.9678794, 'precision': 0.4839655, 'recall': 0.4999725, 'specificity': 0.4999725, 'f1': 0.4918388, 'auroc': 0.44996202, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.999945, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18170  1
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.57659596, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512115_3.png
early stop counter: 2
val acc:0.9678794145584106, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 3,now: 2024-06-20 13:57:13.024431,epoch time: 0:17:09.392402,used: 0:56:47.410877,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_13_00_25_seed_2_21512115
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9222379, 'precision': 0.9508691, 'recall': 0.60047024, 'specificity': 0.60047024, 'f1': 0.64641666, 'auroc': 0.8914825, 'binary_precision': 0.9806867, 'binary_recall': 0.20136593, 'binary_specificity': 0.99957454, 'binary_f1_score': 0.3341254}
confusion matrix:
       0    1
0  42291   18
1   3625  914
---- Validation: 
scalar performance:
{'acc': 0.9672402, 'precision': 0.48395523, 'recall': 0.49964228, 'specificity': 0.49964228, 'f1': 0.49167365, 'auroc': 0.5049368, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99928457, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18158  13
1    602   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.6838709, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512115_4.png
early stop counter: 3
val acc:0.9672402143478394, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 4,now: 2024-06-20 14:17:42.740660,epoch time: 0:20:29.716229,used: 1:17:17.127106,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_13_00_25_seed_2_21512115
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9378629, 'precision': 0.943794, 'recall': 0.6881851, 'specificity': 0.6881851, 'f1': 0.75401604, 'auroc': 0.91669524, 'binary_precision': 0.95022124, 'binary_recall': 0.37849745, 'binary_specificity': 0.99787277, 'binary_f1_score': 0.5413581}
confusion matrix:
       0     1
0  42219    90
1   2821  1718
---- Validation: 
scalar performance:
{'acc': 0.96612155, 'precision': 0.48393723, 'recall': 0.49906445, 'specificity': 0.49906445, 'f1': 0.49138442, 'auroc': 0.5633958, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9981289, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18137  34
1    602   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9626543, 'precision': 0.8388894, 'recall': 0.5304915, 'specificity': 0.5304915, 'f1': 0.54749674, 'auroc': 0.73217595, 'binary_precision': 0.71428573, 'binary_recall': 0.06198347, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.11406844}
confusion matrix:
      0   1
0  5991   6
1   227  15
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512115_5.png
new oracle model saved
early stop counter: 4
val acc:0.9661215543746948, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9626542925834656
after epoch: 5,now: 2024-06-20 14:42:06.687689,epoch time: 0:24:23.947029,used: 1:41:41.074135,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_13_00_25_seed_2_21512115
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9477459, 'precision': 0.94541407, 'recall': 0.74361277, 'specificity': 0.74361277, 'f1': 0.8085066, 'auroc': 0.9336444, 'binary_precision': 0.94282085, 'binary_recall': 0.49041638, 'binary_specificity': 0.9968092, 'binary_f1_score': 0.64521736}
confusion matrix:
       0     1
0  42174   135
1   2313  2226
---- Validation: 
scalar performance:
{'acc': 0.9647366, 'precision': 0.49200442, 'recall': 0.49915206, 'specificity': 0.49915206, 'f1': 0.49253145, 'auroc': 0.58892524, 'binary_precision': 0.016129032, 'binary_recall': 0.0016611295, 'binary_specificity': 0.996643, 'binary_f1_score': 0.0030120483}
confusion matrix:
       0   1
0  18110  61
1    601   1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9656996, 'precision': 0.8633807, 'recall': 0.58362687, 'specificity': 0.58362687, 'f1': 0.6297301, 'auroc': 0.75544244, 'binary_precision': 0.7592593, 'binary_recall': 0.1694215, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.27702704}
confusion matrix:
      0   1
0  5984  13
1   201  41
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512115_6.png
new oracle model saved
early stop counter: 5
val acc:0.9647365808486938, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9656996130943298
after epoch: 6,now: 2024-06-20 15:09:09.183594,epoch time: 0:27:02.495905,used: 2:08:43.570040,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_13_00_25_seed_2_21512115
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.95195097, 'precision': 0.9461677, 'recall': 0.76747704, 'specificity': 0.76747704, 'f1': 0.8293857, 'auroc': 0.93719476, 'binary_precision': 0.9396618, 'binary_recall': 0.5386649, 'binary_specificity': 0.9962892, 'binary_f1_score': 0.68477803}
confusion matrix:
       0     1
0  42152   157
1   2094  2445
---- Validation: 
scalar performance:
{'acc': 0.9637245, 'precision': 0.5170159, 'recall': 0.5026445, 'specificity': 0.5026445, 'f1': 0.49941862, 'auroc': 0.620672, 'binary_precision': 0.06593407, 'binary_recall': 0.009966778, 'binary_specificity': 0.9953222, 'binary_f1_score': 0.01731602}
confusion matrix:
       0   1
0  18086  85
1    596   6
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96537906, 'precision': 0.80882543, 'recall': 0.61518395, 'specificity': 0.61518395, 'f1': 0.6638369, 'auroc': 0.7659749, 'binary_precision': 0.64772725, 'binary_recall': 0.23553719, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.34545454}
confusion matrix:
      0   1
0  5966  31
1   185  57
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512115_7.png
early stop counter: 6
val acc:0.9637244939804077, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9656996130943298
after epoch: 7,now: 2024-06-20 15:31:14.910499,epoch time: 0:22:05.726905,used: 2:30:49.296945,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_13_00_25_seed_2_21512115
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9567751, 'precision': 0.9233047, 'recall': 0.8141053, 'specificity': 0.8141053, 'f1': 0.8585532, 'auroc': 0.9428617, 'binary_precision': 0.88440365, 'binary_recall': 0.63714474, 'binary_specificity': 0.99106574, 'binary_f1_score': 0.7406838}
confusion matrix:
       0     1
0  41931   378
1   1647  2892
---- Validation: 
scalar performance:
{'acc': 0.9598892, 'precision': 0.54665494, 'recall': 0.51592124, 'specificity': 0.51592124, 'f1': 0.5208864, 'auroc': 0.63695025, 'binary_precision': 0.12437811, 'binary_recall': 0.04152824, 'binary_specificity': 0.99031425, 'binary_f1_score': 0.062266506}
confusion matrix:
       0    1
0  17995  176
1    577   25
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642571, 'precision': 0.77040493, 'recall': 0.66020334, 'specificity': 0.66020334, 'f1': 0.69965863, 'auroc': 0.78427094, 'binary_precision': 0.5673759, 'binary_recall': 0.3305785, 'binary_specificity': 0.9898282, 'binary_f1_score': 0.41775456}
confusion matrix:
      0   1
0  5936  61
1   162  80
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512115_8.png
early stop counter: 7
val acc:0.9598891735076904, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9656996130943298
after epoch: 8,now: 2024-06-20 15:52:06.540189,epoch time: 0:20:51.629690,used: 2:51:40.926635,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_13_00_25_seed_2_21512115
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9587389, 'precision': 0.93187326, 'recall': 0.818831, 'specificity': 0.818831, 'f1': 0.8646958, 'auroc': 0.9459587, 'binary_precision': 0.9006765, 'binary_recall': 0.64529634, 'binary_specificity': 0.9923657, 'binary_f1_score': 0.7518932}
confusion matrix:
       0     1
0  41986   323
1   1610  2929
---- Validation: 
scalar performance:
{'acc': 0.96063495, 'precision': 0.56251854, 'recall': 0.5211247, 'specificity': 0.5211247, 'f1': 0.5286458, 'auroc': 0.65785736, 'binary_precision': 0.1557789, 'binary_recall': 0.051495016, 'binary_specificity': 0.9907545, 'binary_f1_score': 0.07740325}
confusion matrix:
       0    1
0  18003  168
1    571   31
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9677833, 'precision': 0.8050809, 'recall': 0.6957442, 'specificity': 0.6957442, 'f1': 0.7372522, 'auroc': 0.79484856, 'binary_precision': 0.63398695, 'binary_recall': 0.40082645, 'binary_specificity': 0.990662, 'binary_f1_score': 0.49113926}
confusion matrix:
      0   1
0  5941  56
1   145  97
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512115_9.png
new oracle model saved
early stop counter: 8
val acc:0.9606349468231201, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9677832722663879
after epoch: 9,now: 2024-06-20 16:14:48.855217,epoch time: 0:22:42.315028,used: 3:14:23.241663,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_13_00_25_seed_2_21512115
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9581839, 'precision': 0.91938025, 'recall': 0.826944, 'specificity': 0.826944, 'f1': 0.86593497, 'auroc': 0.95250267, 'binary_precision': 0.8738765, 'binary_recall': 0.66416925, 'binary_specificity': 0.98971874, 'binary_f1_score': 0.7547264}
confusion matrix:
       0     1
0  41875   435
1   1524  3014
---- Validation: 
scalar performance:
{'acc': 0.9590902, 'precision': 0.576639, 'recall': 0.53397864, 'specificity': 0.53397864, 'f1': 0.5450872, 'auroc': 0.67098147, 'binary_precision': 0.18320611, 'binary_recall': 0.07973422, 'binary_specificity': 0.988223, 'binary_f1_score': 0.111111104}
confusion matrix:
       0    1
0  17957  214
1    554   48
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9632954, 'precision': 0.75534415, 'recall': 0.7053062, 'specificity': 0.7053062, 'f1': 0.72727406, 'auroc': 0.80284834, 'binary_precision': 0.53367877, 'binary_recall': 0.42561984, 'binary_specificity': 0.9849925, 'binary_f1_score': 0.47356322}
confusion matrix:
      0    1
0  5907   90
1   139  103
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512115_10.png
early stop counter: 9
val acc:0.9590901732444763, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9677832722663879
after epoch: 10,now: 2024-06-20 16:31:37.528810,epoch time: 0:16:48.673593,used: 3:31:11.915256,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_13_00_25_seed_2_21512115
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.959977, 'precision': 0.9088539, 'recall': 0.85075694, 'specificity': 0.85075694, 'f1': 0.8769658, 'auroc': 0.9554486, 'binary_precision': 0.84774095, 'binary_recall': 0.7152931, 'binary_specificity': 0.9862208, 'binary_f1_score': 0.7759054}
confusion matrix:
       0     1
0  41727   583
1   1292  3246
---- Validation: 
scalar performance:
{'acc': 0.9574389, 'precision': 0.58194065, 'recall': 0.54436827, 'specificity': 0.54436827, 'f1': 0.5562638, 'auroc': 0.688995, 'binary_precision': 0.19314642, 'binary_recall': 0.10299003, 'binary_specificity': 0.9857465, 'binary_f1_score': 0.13434453}
confusion matrix:
       0    1
0  17912  259
1    540   62
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96553934, 'precision': 0.7732408, 'recall': 0.72630084, 'specificity': 0.72630084, 'f1': 0.74730504, 'auroc': 0.80815613, 'binary_precision': 0.5678392, 'binary_recall': 0.46694216, 'binary_specificity': 0.9856595, 'binary_f1_score': 0.5124717}
confusion matrix:
      0    1
0  5911   86
1   129  113
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512115_11.png
early stop counter: 10
val acc:0.9574388861656189, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9677832722663879
after epoch: 11,now: 2024-06-20 17:03:36.855511,epoch time: 0:31:59.326701,used: 4:03:11.241957,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_13_00_25_seed_2_21512115
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.957693, 'precision': 0.9154544, 'recall': 0.8277908, 'specificity': 0.8277908, 'f1': 0.86508054, 'auroc': 0.9511919, 'binary_precision': 0.8658083, 'binary_recall': 0.6666667, 'binary_specificity': 0.9889149, 'binary_f1_score': 0.75329846}
confusion matrix:
       0     1
0  41840   469
1   1513  3026
---- Validation: 
scalar performance:
{'acc': 0.9583977, 'precision': 0.58463186, 'recall': 0.5424544, 'specificity': 0.5424544, 'f1': 0.55497277, 'auroc': 0.6752, 'binary_precision': 0.19865319, 'binary_recall': 0.09800664, 'binary_specificity': 0.9869022, 'binary_f1_score': 0.13125695}
confusion matrix:
       0    1
0  17933  238
1    543   59
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96377623, 'precision': 0.7577158, 'recall': 0.7392629, 'specificity': 0.7392629, 'f1': 0.7481035, 'auroc': 0.8168616, 'binary_precision': 0.53571427, 'binary_recall': 0.49586776, 'binary_specificity': 0.98265797, 'binary_f1_score': 0.5150215}
confusion matrix:
      0    1
0  5893  104
1   122  120
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512115_12.png
early stop counter: 11
val acc:0.9583976864814758, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9677832722663879
after epoch: 12,now: 2024-06-20 17:28:24.273542,epoch time: 0:24:47.418031,used: 4:27:58.659988,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_13_00_25_seed_2_21512115
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.95969945, 'precision': 0.9063406, 'recall': 0.8520112, 'specificity': 0.8520112, 'f1': 0.876684, 'auroc': 0.95938456, 'binary_precision': 0.84241796, 'binary_recall': 0.7184402, 'binary_specificity': 0.9855823, 'binary_f1_score': 0.7755053}
confusion matrix:
       0     1
0  41699   610
1   1278  3261
---- Validation: 
scalar performance:
{'acc': 0.9579716, 'precision': 0.59612954, 'recall': 0.55428004, 'specificity': 0.55428004, 'f1': 0.5681994, 'auroc': 0.70339453, 'binary_precision': 0.22089553, 'binary_recall': 0.12292359, 'binary_specificity': 0.9856365, 'binary_f1_score': 0.15795092}
confusion matrix:
       0    1
0  17910  261
1    528   74
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9640968, 'precision': 0.7597466, 'recall': 0.7473606, 'specificity': 0.7473606, 'f1': 0.75338316, 'auroc': 0.820331, 'binary_precision': 0.53913045, 'binary_recall': 0.5123967, 'binary_specificity': 0.9823245, 'binary_f1_score': 0.52542377}
confusion matrix:
      0    1
0  5891  106
1   118  124
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512115_13.png
early stop counter: 12
val acc:0.9579715728759766, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9677832722663879
after epoch: 13,now: 2024-06-20 17:48:50.481560,epoch time: 0:20:26.208018,used: 4:48:24.868006,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_13_00_25_seed_2_21512115
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9601691, 'precision': 0.9135181, 'recall': 0.8465676, 'specificity': 0.8465676, 'f1': 0.8762879, 'auroc': 0.95577085, 'binary_precision': 0.85802305, 'binary_recall': 0.705662, 'binary_specificity': 0.98747313, 'binary_f1_score': 0.7744197}
confusion matrix:
       0     1
0  41779   530
1   1336  3203
---- Validation: 
scalar performance:
{'acc': 0.9587173, 'precision': 0.5946344, 'recall': 0.5490439, 'specificity': 0.5490439, 'f1': 0.5631306, 'auroc': 0.69020367, 'binary_precision': 0.21824104, 'binary_recall': 0.11129568, 'binary_specificity': 0.98679215, 'binary_f1_score': 0.14741474}
confusion matrix:
       0    1
0  17931  240
1    535   67
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642571, 'precision': 0.7611344, 'recall': 0.7434785, 'specificity': 0.7434785, 'f1': 0.7519588, 'auroc': 0.82292473, 'binary_precision': 0.5422222, 'binary_recall': 0.5041322, 'binary_specificity': 0.98282474, 'binary_f1_score': 0.5224839}
confusion matrix:
      0    1
0  5894  103
1   120  122
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512115_14.png
early stop counter: 13
val acc:0.9587172865867615, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9677832722663879
after epoch: 14,now: 2024-06-20 18:11:52.218063,epoch time: 0:23:01.736503,used: 5:11:26.604509,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_13_00_25_seed_2_21512115
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9627305, 'precision': 0.9111924, 'recall': 0.8670634, 'specificity': 0.8670634, 'f1': 0.8875234, 'auroc': 0.9631052, 'binary_precision': 0.84903777, 'binary_recall': 0.7484027, 'binary_specificity': 0.9857241, 'binary_f1_score': 0.79555035}
confusion matrix:
       0     1
0  41705   604
1   1142  3397
---- Validation: 
scalar performance:
{'acc': 0.9547222, 'precision': 0.58459437, 'recall': 0.5582229, 'specificity': 0.5582229, 'f1': 0.5684065, 'auroc': 0.71095717, 'binary_precision': 0.19756098, 'binary_recall': 0.1345515, 'binary_specificity': 0.98189425, 'binary_f1_score': 0.16007905}
confusion matrix:
       0    1
0  17842  329
1    521   81
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9604103, 'precision': 0.73544043, 'recall': 0.7494085, 'specificity': 0.7494085, 'f1': 0.74219537, 'auroc': 0.82794565, 'binary_precision': 0.49027237, 'binary_recall': 0.5206612, 'binary_specificity': 0.97815573, 'binary_f1_score': 0.50501007}
confusion matrix:
      0    1
0  5866  131
1   116  126
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512115_15.png
early stop counter: 14
val acc:0.9547222256660461, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9677832722663879
after epoch: 15,now: 2024-06-20 18:30:51.242807,epoch time: 0:18:59.024744,used: 5:30:25.629253,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_13_00_25_seed_2_21512115
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9612577, 'precision': 0.9050108, 'recall': 0.8647171, 'specificity': 0.8647171, 'f1': 0.8835078, 'auroc': 0.96133316, 'binary_precision': 0.83704805, 'binary_recall': 0.7449857, 'binary_specificity': 0.9844485, 'binary_f1_score': 0.7883382}
confusion matrix:
       0     1
0  41653   658
1   1157  3380
---- Validation: 
scalar performance:
{'acc': 0.9550951, 'precision': 0.5915147, 'recall': 0.56403685, 'specificity': 0.56403685, 'f1': 0.5748198, 'auroc': 0.7246233, 'binary_precision': 0.21103117, 'binary_recall': 0.14617941, 'binary_specificity': 0.98189425, 'binary_f1_score': 0.17271836}
confusion matrix:
       0    1
0  17842  329
1    514   88
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96105146, 'precision': 0.73985004, 'recall': 0.7616384, 'specificity': 0.7616384, 'f1': 0.7502055, 'auroc': 0.83814156, 'binary_precision': 0.49811321, 'binary_recall': 0.54545456, 'binary_specificity': 0.97782224, 'binary_f1_score': 0.52071005}
confusion matrix:
      0    1
0  5864  133
1   110  132
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512115_16.png
early stop counter: 15
val acc:0.955095112323761, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9677832722663879
after epoch: 16,now: 2024-06-20 18:55:01.038767,epoch time: 0:24:09.795960,used: 5:54:35.425213,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_13_00_25_seed_2_21512115
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.96260244, 'precision': 0.8975296, 'recall': 0.8857523, 'specificity': 0.8857523, 'f1': 0.8915259, 'auroc': 0.96929127, 'binary_precision': 0.8174567, 'binary_recall': 0.7904363, 'binary_specificity': 0.9810683, 'binary_f1_score': 0.8037195}
confusion matrix:
       0     1
0  41509   801
1    951  3587
---- Validation: 
scalar performance:
{'acc': 0.95269805, 'precision': 0.5963888, 'recall': 0.5820717, 'specificity': 0.5820717, 'f1': 0.588533, 'auroc': 0.733914, 'binary_precision': 0.21960784, 'binary_recall': 0.18604651, 'binary_specificity': 0.97809696, 'binary_f1_score': 0.20143884}
confusion matrix:
       0    1
0  17773  398
1    490  112
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95752525, 'precision': 0.72159195, 'recall': 0.7677351, 'specificity': 0.7677351, 'f1': 0.7421626, 'auroc': 0.8399826, 'binary_precision': 0.46101695, 'binary_recall': 0.56198347, 'binary_specificity': 0.9734867, 'binary_f1_score': 0.50651765}
confusion matrix:
      0    1
0  5838  159
1   106  136
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512115_17.png
early stop counter: 16
val acc:0.9526980519294739, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9677832722663879
after epoch: 17,now: 2024-06-20 19:18:59.368839,epoch time: 0:23:58.330072,used: 6:18:33.755285,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_13_00_25_seed_2_21512115
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9629653, 'precision': 0.90804505, 'recall': 0.872897, 'specificity': 0.872897, 'f1': 0.8894532, 'auroc': 0.9668331, 'binary_precision': 0.8414515, 'binary_recall': 0.7611809, 'binary_specificity': 0.9846132, 'binary_f1_score': 0.7993059}
confusion matrix:
       0     1
0  41658   651
1   1084  3455
---- Validation: 
scalar performance:
{'acc': 0.957865, 'precision': 0.60875714, 'recall': 0.5678768, 'specificity': 0.5678768, 'f1': 0.58271116, 'auroc': 0.72011113, 'binary_precision': 0.24528302, 'binary_recall': 0.15116279, 'binary_specificity': 0.9845908, 'binary_f1_score': 0.18705036}
confusion matrix:
       0    1
0  17891  280
1    511   91
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650585, 'precision': 0.76666677, 'recall': 0.75182635, 'specificity': 0.75182635, 'f1': 0.7590078, 'auroc': 0.8317547, 'binary_precision': 0.55263156, 'binary_recall': 0.5206612, 'binary_specificity': 0.9829915, 'binary_f1_score': 0.5361702}
confusion matrix:
      0    1
0  5895  102
1   116  126
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512115_18.png
early stop counter: 17
val acc:0.9578649997711182, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9677832722663879
after epoch: 18,now: 2024-06-20 19:41:45.282332,epoch time: 0:22:45.913493,used: 6:41:19.668778,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_13_00_25_seed_2_21512115
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9639259, 'precision': 0.9066886, 'recall': 0.8816893, 'specificity': 0.8816893, 'f1': 0.89367723, 'auroc': 0.9677373, 'binary_precision': 0.83684087, 'binary_recall': 0.77968717, 'binary_specificity': 0.9836914, 'binary_f1_score': 0.80725366}
confusion matrix:
       0     1
0  41619   690
1   1000  3539
---- Validation: 
scalar performance:
{'acc': 0.9567997, 'precision': 0.60922873, 'recall': 0.57535696, 'specificity': 0.57535696, 'f1': 0.5886043, 'auroc': 0.73222315, 'binary_precision': 0.2457421, 'binary_recall': 0.16777408, 'binary_specificity': 0.98293984, 'binary_f1_score': 0.19940771}
confusion matrix:
       0    1
0  17861  310
1    501  101
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96281457, 'precision': 0.7506505, 'recall': 0.7605728, 'specificity': 0.7605728, 'f1': 0.7555026, 'auroc': 0.83654636, 'binary_precision': 0.51984125, 'binary_recall': 0.5413223, 'binary_specificity': 0.97982323, 'binary_f1_score': 0.53036433}
confusion matrix:
      0    1
0  5876  121
1   111  131
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512115_19.png
early stop counter: 18
val acc:0.9567996859550476, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9677832722663879
after epoch: 19,now: 2024-06-20 20:03:21.168765,epoch time: 0:21:35.886433,used: 7:02:55.555211,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_13_00_25_seed_2_21512115
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.96441686, 'precision': 0.9071212, 'recall': 0.88461626, 'specificity': 0.88461626, 'f1': 0.8954555, 'auroc': 0.96923566, 'binary_precision': 0.8370892, 'binary_recall': 0.7856356, 'binary_specificity': 0.98359686, 'binary_f1_score': 0.81054664}
confusion matrix:
       0     1
0  41615   694
1    973  3566
---- Validation: 
scalar performance:
{'acc': 0.9582912, 'precision': 0.61823225, 'recall': 0.5761274, 'specificity': 0.5761274, 'f1': 0.5918299, 'auroc': 0.7322334, 'binary_precision': 0.26370758, 'binary_recall': 0.16777408, 'binary_specificity': 0.98448074, 'binary_f1_score': 0.20507614}
confusion matrix:
       0    1
0  17889  282
1    501  101
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96553934, 'precision': 0.76999176, 'recall': 0.7560419, 'specificity': 0.7560419, 'f1': 0.76280916, 'auroc': 0.8341305, 'binary_precision': 0.558952, 'binary_recall': 0.5289256, 'binary_specificity': 0.98315823, 'binary_f1_score': 0.54352444}
confusion matrix:
      0    1
0  5896  101
1   114  128
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512115_20.png
early stop counter: 19
val acc:0.9582911729812622, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9677832722663879
after epoch: 20,now: 2024-06-20 20:23:21.961245,epoch time: 0:20:00.792480,used: 7:22:56.347691,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_13_00_25_seed_2_21512115
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9619194, 'precision': 0.8905153, 'recall': 0.89235795, 'specificity': 0.89235795, 'f1': 0.8914338, 'auroc': 0.96994424, 'binary_precision': 0.8018413, 'binary_recall': 0.80608195, 'binary_specificity': 0.9786339, 'binary_f1_score': 0.80395603}
confusion matrix:
       0     1
0  41406   904
1    880  3658
---- Validation: 
scalar performance:
{'acc': 0.95413625, 'precision': 0.6133183, 'recall': 0.59887564, 'specificity': 0.59887564, 'f1': 0.6055132, 'auroc': 0.7455168, 'binary_precision': 0.25239006, 'binary_recall': 0.2192691, 'binary_specificity': 0.9784822, 'binary_f1_score': 0.23466666}
confusion matrix:
       0    1
0  17780  391
1    470  132
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.74119866, 'recall': 0.7716355, 'specificity': 0.7716355, 'f1': 0.75538856, 'auroc': 0.84428227, 'binary_precision': 0.5, 'binary_recall': 0.5661157, 'binary_specificity': 0.97715527, 'binary_f1_score': 0.53100777}
confusion matrix:
      0    1
0  5860  137
1   105  137
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512115_21.png
early stop counter: 20
val acc:0.9541362524032593, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9677832722663879
after epoch: 21,now: 2024-06-20 20:44:48.764402,epoch time: 0:21:26.803157,used: 7:44:23.150848,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_13_00_25_seed_2_21512115
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.96452355, 'precision': 0.89966244, 'recall': 0.89682853, 'specificity': 0.89682853, 'f1': 0.8982389, 'auroc': 0.9714765, 'binary_precision': 0.8193735, 'binary_recall': 0.81287193, 'binary_specificity': 0.98078513, 'binary_f1_score': 0.8161098}
confusion matrix:
       0     1
0  41498   813
1    849  3688
---- Validation: 
scalar performance:
{'acc': 0.954882, 'precision': 0.6177894, 'recall': 0.600867, 'specificity': 0.600867, 'f1': 0.60855466, 'auroc': 0.75176907, 'binary_precision': 0.26120856, 'binary_recall': 0.22259136, 'binary_specificity': 0.9791426, 'binary_f1_score': 0.24035874}
confusion matrix:
       0    1
0  17792  379
1    468  134
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96297485, 'precision': 0.75167114, 'recall': 0.7725526, 'specificity': 0.7725526, 'f1': 0.7616404, 'auroc': 0.84708405, 'binary_precision': 0.5209125, 'binary_recall': 0.5661157, 'binary_specificity': 0.9789895, 'binary_f1_score': 0.5425742}
confusion matrix:
      0    1
0  5871  126
1   105  137
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512115_22.png
early stop counter: 21
val acc:0.954882025718689, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9677832722663879
after epoch: 22,now: 2024-06-20 21:05:06.546343,epoch time: 0:20:17.781941,used: 8:04:40.932789,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_13_00_25_seed_2_21512115
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.96497184, 'precision': 0.9021152, 'recall': 0.89633083, 'specificity': 0.89633083, 'f1': 0.8991958, 'auroc': 0.9744693, 'binary_precision': 0.8244514, 'binary_recall': 0.8111919, 'binary_specificity': 0.9814697, 'binary_f1_score': 0.817768}
confusion matrix:
       0     1
0  41525   784
1    857  3682
---- Validation: 
scalar performance:
{'acc': 0.9561604, 'precision': 0.61860853, 'recall': 0.5926938, 'specificity': 0.5926938, 'f1': 0.6037798, 'auroc': 0.74684143, 'binary_precision': 0.2633833, 'binary_recall': 0.20431894, 'binary_specificity': 0.98106873, 'binary_f1_score': 0.23012161}
confusion matrix:
       0    1
0  17827  344
1    479  123
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645777, 'precision': 0.7621528, 'recall': 0.76942086, 'specificity': 0.76942086, 'f1': 0.76573074, 'auroc': 0.8474299, 'binary_precision': 0.5421687, 'binary_recall': 0.55785125, 'binary_specificity': 0.98099047, 'binary_f1_score': 0.54989815}
confusion matrix:
      0    1
0  5883  114
1   107  135
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512115_23.png
early stop counter: 22
val acc:0.9561604261398315, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9677832722663879
after epoch: 23,now: 2024-06-20 21:24:07.876357,epoch time: 0:19:01.330014,used: 8:23:42.262803,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_13_00_25_seed_2_21512115
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9632855, 'precision': 0.8922484, 'recall': 0.900098, 'specificity': 0.900098, 'f1': 0.8961223, 'auroc': 0.96971905, 'binary_precision': 0.8036638, 'binary_recall': 0.82172763, 'binary_specificity': 0.9784684, 'binary_f1_score': 0.8125953}
confusion matrix:
       0     1
0  41399   911
1    809  3729
---- Validation: 
scalar performance:
{'acc': 0.95296437, 'precision': 0.61441666, 'recall': 0.60870993, 'specificity': 0.60870993, 'f1': 0.61147654, 'auroc': 0.74397016, 'binary_precision': 0.25394046, 'binary_recall': 0.24086379, 'binary_specificity': 0.97655606, 'binary_f1_score': 0.24722932}
confusion matrix:
       0    1
0  17745  426
1    457  145
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95832664, 'precision': 0.7270352, 'recall': 0.7840139, 'specificity': 0.7840139, 'f1': 0.75187683, 'auroc': 0.8480817, 'binary_precision': 0.47058824, 'binary_recall': 0.59504133, 'binary_specificity': 0.9729865, 'binary_f1_score': 0.52554744}
confusion matrix:
      0    1
0  5835  162
1    98  144
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512115_24.png
early stop counter: 23
val acc:0.9529643654823303, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9677832722663879
after epoch: 24,now: 2024-06-20 21:42:33.928107,epoch time: 0:18:26.051750,used: 8:42:08.314553,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_13_00_25_seed_2_21512115
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.96433145, 'precision': 0.8982948, 'recall': 0.8977463, 'specificity': 0.8977463, 'f1': 0.8980204, 'auroc': 0.97111356, 'binary_precision': 0.8164166, 'binary_recall': 0.81515753, 'binary_specificity': 0.9803352, 'binary_f1_score': 0.8157866}
confusion matrix:
       0     1
0  41477   832
1    839  3700
---- Validation: 
scalar performance:
{'acc': 0.9550418, 'precision': 0.6113055, 'recall': 0.58970684, 'specificity': 0.58970684, 'f1': 0.5991274, 'auroc': 0.74350816, 'binary_precision': 0.24896266, 'binary_recall': 0.19933555, 'binary_specificity': 0.98007816, 'binary_f1_score': 0.2214022}
confusion matrix:
       0    1
0  17809  362
1    482  120
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.961372, 'precision': 0.7424885, 'recall': 0.78163254, 'specificity': 0.78163254, 'f1': 0.76039505, 'auroc': 0.8508496, 'binary_precision': 0.5017668, 'binary_recall': 0.58677685, 'binary_specificity': 0.97648823, 'binary_f1_score': 0.5409524}
confusion matrix:
      0    1
0  5856  141
1   100  142
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512115_25.png
early stop counter: 24
val acc:0.9550418257713318, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9677832722663879
after epoch: 25,now: 2024-06-20 22:00:50.759431,epoch time: 0:18:16.831324,used: 9:00:25.145877,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_13_00_25_seed_2_21512115
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.96516395, 'precision': 0.8942184, 'recall': 0.91148293, 'specificity': 0.91148293, 'f1': 0.90260804, 'auroc': 0.9765254, 'binary_precision': 0.8051648, 'binary_recall': 0.8448998, 'binary_specificity': 0.97806615, 'binary_f1_score': 0.82455385}
confusion matrix:
       0     1
0  41381   928
1    704  3835
---- Validation: 
scalar performance:
{'acc': 0.95429605, 'precision': 0.62674403, 'recall': 0.62144357, 'specificity': 0.62144357, 'f1': 0.6240273, 'auroc': 0.76980186, 'binary_precision': 0.2777778, 'binary_recall': 0.26578072, 'binary_specificity': 0.9771064, 'binary_f1_score': 0.2716469}
confusion matrix:
       0    1
0  17755  416
1    442  160
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9639365, 'precision': 0.7574384, 'recall': 0.7889148, 'specificity': 0.7889148, 'f1': 0.7721494, 'auroc': 0.85623455, 'binary_precision': 0.53113556, 'binary_recall': 0.59917355, 'binary_specificity': 0.978656, 'binary_f1_score': 0.5631068}
confusion matrix:
      0    1
0  5869  128
1    97  145
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512115_26.png
early stop counter: 25
val acc:0.9542960524559021, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9677832722663879
after epoch: 26,now: 2024-06-20 22:19:31.536133,epoch time: 0:18:40.776702,used: 9:19:05.922579,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_13_00_25_seed_2_21512115
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9623463, 'precision': 0.8816968, 'recall': 0.9134632, 'specificity': 0.9134632, 'f1': 0.89674014, 'auroc': 0.9752283, 'binary_precision': 0.77934366, 'binary_recall': 0.852831, 'binary_specificity': 0.97409534, 'binary_f1_score': 0.8144329}
confusion matrix:
       0     1
0  41213  1096
1    668  3871
---- Validation: 
scalar performance:
{'acc': 0.95317745, 'precision': 0.61973757, 'recall': 0.6168505, 'specificity': 0.6168505, 'f1': 0.6182732, 'auroc': 0.76101464, 'binary_precision': 0.2640545, 'binary_recall': 0.25747508, 'binary_specificity': 0.97622585, 'binary_f1_score': 0.26072332}
confusion matrix:
       0    1
0  17739  432
1    447  155
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9620131, 'precision': 0.74618995, 'recall': 0.7859315, 'specificity': 0.7859315, 'f1': 0.7643719, 'auroc': 0.85961646, 'binary_precision': 0.50883394, 'binary_recall': 0.59504133, 'binary_specificity': 0.9768217, 'binary_f1_score': 0.54857147}
confusion matrix:
      0    1
0  5858  139
1    98  144
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512115_27.png
early stop counter: 26
val acc:0.9531774520874023, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9677832722663879
after epoch: 27,now: 2024-06-20 22:37:27.185226,epoch time: 0:17:55.649093,used: 9:37:01.571672,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_13_00_25_seed_2_21512115
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9646943, 'precision': 0.8937533, 'recall': 0.9085503, 'specificity': 0.9085503, 'f1': 0.90097296, 'auroc': 0.9737412, 'binary_precision': 0.80486256, 'binary_recall': 0.8389158, 'binary_specificity': 0.9781848, 'binary_f1_score': 0.82153654}
confusion matrix:
       0     1
0  41387   923
1    731  3807
---- Validation: 
scalar performance:
{'acc': 0.95333725, 'precision': 0.61078095, 'recall': 0.600069, 'specificity': 0.600069, 'f1': 0.6051005, 'auroc': 0.7532516, 'binary_precision': 0.24723247, 'binary_recall': 0.22259136, 'binary_specificity': 0.97754663, 'binary_f1_score': 0.23426571}
confusion matrix:
       0    1
0  17763  408
1    468  134
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96057063, 'precision': 0.738649, 'recall': 0.79112935, 'specificity': 0.79112935, 'f1': 0.761919, 'auroc': 0.85354114, 'binary_precision': 0.49328858, 'binary_recall': 0.607438, 'binary_specificity': 0.97482073, 'binary_f1_score': 0.54444444}
confusion matrix:
      0    1
0  5846  151
1    95  147
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512115_28.png
early stop counter: 27
val acc:0.9533372521400452, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9677832722663879
after epoch: 28,now: 2024-06-20 22:55:39.450997,epoch time: 0:18:12.265771,used: 9:55:13.837443,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_13_00_25_seed_2_21512115
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.96420336, 'precision': 0.8949781, 'recall': 0.902494, 'specificity': 0.902494, 'f1': 0.89868975, 'auroc': 0.9736484, 'binary_precision': 0.8086713, 'binary_recall': 0.8259528, 'binary_specificity': 0.9790352, 'binary_f1_score': 0.8172207}
confusion matrix:
       0     1
0  41422   887
1    790  3749
---- Validation: 
scalar performance:
{'acc': 0.95514834, 'precision': 0.6210135, 'recall': 0.60421675, 'specificity': 0.60421675, 'f1': 0.6118777, 'auroc': 0.75030637, 'binary_precision': 0.26744187, 'binary_recall': 0.22923589, 'binary_specificity': 0.9791976, 'binary_f1_score': 0.24686942}
confusion matrix:
       0    1
0  17793  378
1    464  138
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9623337, 'precision': 0.7480407, 'recall': 0.78808105, 'specificity': 0.78808105, 'f1': 0.7663603, 'auroc': 0.85427356, 'binary_precision': 0.5123675, 'binary_recall': 0.59917355, 'binary_specificity': 0.9769885, 'binary_f1_score': 0.5523809}
confusion matrix:
      0    1
0  5859  138
1    97  145
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512115_29.png
early stop counter: 28
val acc:0.9551483392715454, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9677832722663879
after epoch: 29,now: 2024-06-20 23:14:29.053109,epoch time: 0:18:49.602112,used: 10:14:03.439555,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_13_00_25_seed_2_21512115
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9673412, 'precision': 0.9014909, 'recall': 0.9153273, 'specificity': 0.9153273, 'f1': 0.90825593, 'auroc': 0.97719157, 'binary_precision': 0.81904966, 'binary_recall': 0.85081536, 'binary_specificity': 0.97983927, 'binary_f1_score': 0.83463037}
confusion matrix:
       0     1
0  41457   853
1    677  3861
---- Validation: 
scalar performance:
{'acc': 0.95546794, 'precision': 0.6276205, 'recall': 0.6132154, 'specificity': 0.6132154, 'f1': 0.6199136, 'auroc': 0.7614466, 'binary_precision': 0.2800752, 'binary_recall': 0.2475083, 'binary_specificity': 0.9789225, 'binary_f1_score': 0.2627866}
confusion matrix:
       0    1
0  17788  383
1    453  149
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9658599, 'precision': 0.7697983, 'recall': 0.7879325, 'specificity': 0.7879325, 'f1': 0.7785331, 'auroc': 0.85602444, 'binary_precision': 0.55598456, 'binary_recall': 0.59504133, 'binary_specificity': 0.98082376, 'binary_f1_score': 0.5748503}
confusion matrix:
      0    1
0  5882  115
1    98  144
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512115_30.png
early stop counter: 29
val acc:0.955467939376831, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9677832722663879
after epoch: 30,now: 2024-06-20 23:32:59.750174,epoch time: 0:18:30.697065,used: 10:32:34.136620,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_13_00_25_seed_2_21512115
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 10:32:34.136620 at 2024-06-20 23:32:59.750174
persisted model performance metric: 

scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.28645366, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
oracle model performance metric: 

scalar performance:
{'acc': 0.9677833, 'precision': 0.8050809, 'recall': 0.6957442, 'specificity': 0.6957442, 'f1': 0.7372522, 'auroc': 0.79484856, 'binary_precision': 0.63398695, 'binary_recall': 0.40082645, 'binary_specificity': 0.990662, 'binary_f1_score': 0.49113926}
confusion matrix:
      0   1
0  5941  56
1   145  97
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_irm_resnet_different_bs128_lre4_classbalancing/rule_results/7.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_irm_resnet_different_bs128_lre4_classbalancing/confusion_matrix/7.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204097 KiB |   1730 MiB |   1361 TiB |   1361 TiB |
|       from large pool | 167936 KiB |   1660 MiB |   1360 TiB |   1360 TiB |
|       from small pool |  36161 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 204097 KiB |   1730 MiB |   1361 TiB |   1361 TiB |
|       from large pool | 167936 KiB |   1660 MiB |   1360 TiB |   1360 TiB |
|       from small pool |  36161 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201087 KiB |   1723 MiB |   1361 TiB |   1361 TiB |
|       from large pool | 165120 KiB |   1653 MiB |   1360 TiB |   1360 TiB |
|       from small pool |  35967 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2196 MiB |   2270 MiB |   5474 MiB |   3278 MiB |
|       from large pool |   2122 MiB |   2196 MiB |   5336 MiB |   3214 MiB |
|       from small pool |     74 MiB |     74 MiB |    138 MiB |     64 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 404158 KiB |    900 MiB |   1091 TiB |   1091 TiB |
|       from large pool | 397312 KiB |    899 MiB |   1091 TiB |   1091 TiB |
|       from small pool |   6846 KiB |     14 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    1194    |    1851    |   36561 K  |   36560 K  |
|       from large pool |      36    |      76    |   14674 K  |   14674 K  |
|       from small pool |    1158    |    1780    |   21886 K  |   21885 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1194    |    1851    |   36561 K  |   36560 K  |
|       from large pool |      36    |      76    |   14674 K  |   14674 K  |
|       from small pool |    1158    |    1780    |   21886 K  |   21885 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      50    |      51    |      91    |      41    |
|       from large pool |      13    |      14    |      22    |       9    |
|       from small pool |      37    |      37    |      69    |      32    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      48    |     383    |   21286 K  |   21286 K  |
|       from large pool |       5    |      11    |    5126 K  |    5126 K  |
|       from small pool |      43    |     378    |   16160 K  |   16160 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1730 MiB |   1361 TiB |   1361 TiB |
|       from large pool |  16640 KiB |   1660 MiB |   1360 TiB |   1360 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1730 MiB |   1361 TiB |   1361 TiB |
|       from large pool |  16640 KiB |   1660 MiB |   1360 TiB |   1360 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1723 MiB |   1361 TiB |   1361 TiB |
|       from large pool |  16640 KiB |   1653 MiB |   1360 TiB |   1360 TiB |
|       from small pool |      0 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 608256 KiB |   2270 MiB |   5474 MiB |   4880 MiB |
|       from large pool | 565248 KiB |   2196 MiB |   5336 MiB |   4784 MiB |
|       from small pool |  43008 KiB |     74 MiB |    138 MiB |     96 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 384768 KiB |    900 MiB |   1091 TiB |   1091 TiB |
|       from large pool | 384768 KiB |    899 MiB |   1091 TiB |   1091 TiB |
|       from small pool |      0 KiB |     14 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1851    |   36561 K  |   36561 K  |
|       from large pool |       2    |      76    |   14674 K  |   14674 K  |
|       from small pool |       0    |    1780    |   21886 K  |   21886 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1851    |   36561 K  |   36561 K  |
|       from large pool |       2    |      76    |   14674 K  |   14674 K  |
|       from small pool |       0    |    1780    |   21886 K  |   21886 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      30    |      51    |      91    |      61    |
|       from large pool |       9    |      14    |      22    |      13    |
|       from small pool |      21    |      37    |      69    |      48    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     383    |   21287 K  |   21287 K  |
|       from large pool |       1    |      11    |    5126 K  |    5126 K  |
|       from small pool |       0    |     378    |   16160 K  |   16160 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

