Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0




!!!: not committed yet



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_52_39_seed_0_21403763

 Experiment start at: 2024-06-18 03:52:39.242108
before training, model accuracy: 0.3103227913379669
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9664155, 'precision': 0.48320776, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49146047, 'auroc': 0.73813397, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42329  0
1   1471  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.6966865, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.7145219, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21403763_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-18 04:14:00.984302,epoch time: 0:21:21.742194,used: 0:21:21.742194,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_52_39_seed_0_21403763
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.966621, 'precision': 0.806005, 'recall': 0.50666815, 'specificity': 0.50666815, 'f1': 0.5048253, 'auroc': 0.85578334, 'binary_precision': 0.6451613, 'binary_recall': 0.013596193, 'binary_specificity': 0.9997401, 'binary_f1_score': 0.02663116}
confusion matrix:
       0   1
0  42318  11
1   1451  20
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.84743667, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.8450775, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21403763_2.png
early stop counter: 1
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 2,now: 2024-06-18 04:32:05.174073,epoch time: 0:18:04.189771,used: 0:39:25.931965,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_52_39_seed_0_21403763
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9669863, 'precision': 0.7586999, 'recall': 0.54915845, 'specificity': 0.54915845, 'f1': 0.5770147, 'auroc': 0.8907454, 'binary_precision': 0.5477941, 'binary_recall': 0.10122283, 'binary_specificity': 0.9970941, 'binary_f1_score': 0.17087157}
confusion matrix:
       0    1
0  42205  123
1   1323  149
---- Validation: 
scalar performance:
{'acc': 0.9658365, 'precision': 0.7408904, 'recall': 0.51277846, 'specificity': 0.51277846, 'f1': 0.51645064, 'auroc': 0.8833054, 'binary_precision': 0.5151515, 'binary_recall': 0.02643857, 'binary_specificity': 0.9991184, 'binary_f1_score': 0.050295856}
confusion matrix:
       0   1
0  18133  16
1    626  17
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.98022103, 'recall': 0.52681994, 'specificity': 0.52681994, 'f1': 0.54082, 'auroc': 0.8679953, 'binary_precision': 1.0, 'binary_recall': 0.053639848, 'binary_specificity': 1.0, 'binary_f1_score': 0.10181818}
confusion matrix:
      0   1
0  5997   0
1   247  14
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21403763_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-18 04:52:18.974451,epoch time: 0:20:13.800378,used: 0:59:39.732343,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_52_39_seed_0_21403763
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96671236, 'precision': 0.74327433, 'recall': 0.57918, 'specificity': 0.57918, 'f1': 0.61571646, 'auroc': 0.90432, 'binary_precision': 0.51495725, 'binary_recall': 0.16372283, 'binary_specificity': 0.99463713, 'binary_f1_score': 0.24845362}
confusion matrix:
       0    1
0  42101  227
1   1231  241
---- Validation: 
scalar performance:
{'acc': 0.966688, 'precision': 0.7749039, 'recall': 0.54622173, 'specificity': 0.54622173, 'f1': 0.5730537, 'auroc': 0.8965322, 'binary_precision': 0.5809524, 'binary_recall': 0.09486781, 'binary_specificity': 0.99757564, 'binary_f1_score': 0.16310161}
confusion matrix:
       0   1
0  18105  44
1    582  61
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642058, 'precision': 0.9819965, 'recall': 0.57088125, 'specificity': 0.57088125, 'f1': 0.6149943, 'auroc': 0.88124967, 'binary_precision': 1.0, 'binary_recall': 0.14176245, 'binary_specificity': 1.0, 'binary_f1_score': 0.24832213}
confusion matrix:
      0   1
0  5997   0
1   224  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21403763_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-18 05:08:51.109216,epoch time: 0:16:32.134765,used: 1:16:11.867108,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_52_39_seed_0_21403763
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96643835, 'precision': 0.73700035, 'recall': 0.5869069, 'specificity': 0.5869069, 'f1': 0.6239136, 'auroc': 0.9075911, 'binary_precision': 0.50189394, 'binary_recall': 0.18002717, 'binary_specificity': 0.99378663, 'binary_f1_score': 0.265}
confusion matrix:
       0    1
0  42065  263
1   1207  265
---- Validation: 
scalar performance:
{'acc': 0.9669008, 'precision': 0.7802589, 'recall': 0.5515823, 'specificity': 0.5515823, 'f1': 0.5812647, 'auroc': 0.9070609, 'binary_precision': 0.59130436, 'binary_recall': 0.10575428, 'binary_specificity': 0.9974103, 'binary_f1_score': 0.17941955}
confusion matrix:
       0   1
0  18102  47
1    575  68
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642058, 'precision': 0.9819965, 'recall': 0.57088125, 'specificity': 0.57088125, 'f1': 0.6149943, 'auroc': 0.8851849, 'binary_precision': 1.0, 'binary_recall': 0.14176245, 'binary_specificity': 1.0, 'binary_f1_score': 0.24832213}
confusion matrix:
      0   1
0  5997   0
1   224  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21403763_5.png
better model found
persisted
after epoch: 5,now: 2024-06-18 05:29:32.127231,epoch time: 0:20:41.018015,used: 1:36:52.885123,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_52_39_seed_0_21403763
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9665525, 'precision': 0.7394304, 'recall': 0.6063098, 'specificity': 0.6063098, 'f1': 0.64476794, 'auroc': 0.9133012, 'binary_precision': 0.5054602, 'binary_recall': 0.2201087, 'binary_specificity': 0.99251086, 'binary_f1_score': 0.306673}
confusion matrix:
       0    1
0  42011  317
1   1148  324
---- Validation: 
scalar performance:
{'acc': 0.96706045, 'precision': 0.78098935, 'recall': 0.5584155, 'specificity': 0.5584155, 'f1': 0.5912041, 'auroc': 0.91206443, 'binary_precision': 0.5923077, 'binary_recall': 0.11975116, 'binary_specificity': 0.99707973, 'binary_f1_score': 0.1992238}
confusion matrix:
       0   1
0  18096  53
1    566  77
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964845, 'precision': 0.97075343, 'recall': 0.5803764, 'specificity': 0.5803764, 'f1': 0.6291504, 'auroc': 0.884948, 'binary_precision': 0.9767442, 'binary_recall': 0.16091955, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.27631578}
confusion matrix:
      0   1
0  5996   1
1   219  42
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21403763_6.png
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-06-18 05:50:45.886249,epoch time: 0:21:13.759018,used: 1:58:06.644141,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_52_39_seed_0_21403763
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96703196, 'precision': 0.7478485, 'recall': 0.60852504, 'specificity': 0.60852504, 'f1': 0.6483993, 'auroc': 0.9182277, 'binary_precision': 0.5221519, 'binary_recall': 0.22418478, 'binary_specificity': 0.99286526, 'binary_f1_score': 0.3136882}
confusion matrix:
       0    1
0  42026  302
1   1142  330
---- Validation: 
scalar performance:
{'acc': 0.96674114, 'precision': 0.7629361, 'recall': 0.56800085, 'specificity': 0.56800085, 'f1': 0.60330456, 'auroc': 0.9172411, 'binary_precision': 0.5555556, 'binary_recall': 0.1399689, 'binary_specificity': 0.99603283, 'binary_f1_score': 0.2236025}
confusion matrix:
       0   1
0  18077  72
1    553  90
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9643656, 'precision': 0.9696486, 'recall': 0.57462925, 'specificity': 0.57462925, 'f1': 0.62044, 'auroc': 0.89185315, 'binary_precision': 0.975, 'binary_recall': 0.14942528, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.2591362}
confusion matrix:
      0   1
0  5996   1
1   222  39
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21403763_7.png
early stop counter: 1
val acc:0.966741144657135, best validation acc: 0.9670604467391968, corresponding to test acc:                         0.9648450016975403 / 0.9648450016975403
after epoch: 7,now: 2024-06-18 06:14:19.176514,epoch time: 0:23:33.290265,used: 2:21:39.934406,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_52_39_seed_0_21403763
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9673516, 'precision': 0.7508824, 'recall': 0.6388536, 'specificity': 0.6388536, 'f1': 0.67719644, 'auroc': 0.9202306, 'binary_precision': 0.52618456, 'binary_recall': 0.28668478, 'binary_specificity': 0.99102247, 'binary_f1_score': 0.37115216}
confusion matrix:
       0    1
0  41948  380
1   1050  422
---- Validation: 
scalar performance:
{'acc': 0.9668476, 'precision': 0.759403, 'recall': 0.5875574, 'specificity': 0.5875574, 'f1': 0.6271915, 'auroc': 0.9225778, 'binary_precision': 0.5471698, 'binary_recall': 0.18040435, 'binary_specificity': 0.99471045, 'binary_f1_score': 0.27134502}
confusion matrix:
       0    1
0  18053   96
1    527  116
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96708214, 'precision': 0.9746985, 'recall': 0.60719633, 'specificity': 0.60719633, 'f1': 0.66765666, 'auroc': 0.89137787, 'binary_precision': 0.98245615, 'binary_recall': 0.21455939, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.35220128}
confusion matrix:
      0   1
0  5996   1
1   205  56
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21403763_8.png
new oracle model saved
early stop counter: 2
val acc:0.9668475985527039, best validation acc: 0.9670604467391968, corresponding to test acc:                         0.9648450016975403 / 0.967082142829895
after epoch: 8,now: 2024-06-18 06:38:00.563702,epoch time: 0:23:41.387188,used: 2:45:21.321594,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_52_39_seed_0_21403763
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9683105, 'precision': 0.76808465, 'recall': 0.626891, 'specificity': 0.626891, 'f1': 0.66998535, 'auroc': 0.9249414, 'binary_precision': 0.5614035, 'binary_recall': 0.26086956, 'binary_specificity': 0.9929125, 'binary_f1_score': 0.3562152}
confusion matrix:
       0    1
0  42028  300
1   1088  384
---- Validation: 
scalar performance:
{'acc': 0.9670072, 'precision': 0.773652, 'recall': 0.5651384, 'specificity': 0.5651384, 'f1': 0.6001601, 'auroc': 0.9242151, 'binary_precision': 0.5771812, 'binary_recall': 0.13374805, 'binary_specificity': 0.99652874, 'binary_f1_score': 0.21717171}
confusion matrix:
       0   1
0  18086  63
1    557  86
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96324706, 'precision': 0.9664549, 'recall': 0.5612193, 'specificity': 0.5612193, 'f1': 0.59943426, 'auroc': 0.88930047, 'binary_precision': 0.969697, 'binary_recall': 0.12260536, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.21768707}
confusion matrix:
      0   1
0  5996   1
1   229  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21403763_9.png
early stop counter: 3
val acc:0.9670072197914124, best validation acc: 0.9670604467391968, corresponding to test acc:                         0.9648450016975403 / 0.967082142829895
after epoch: 9,now: 2024-06-18 06:56:58.396565,epoch time: 0:18:57.832863,used: 3:04:19.154457,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_52_39_seed_0_21403763
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9681735, 'precision': 0.764759, 'recall': 0.63108236, 'specificity': 0.63108236, 'f1': 0.6732838, 'auroc': 0.92458177, 'binary_precision': 0.5544693, 'binary_recall': 0.2697011, 'binary_specificity': 0.9924636, 'binary_f1_score': 0.36288851}
confusion matrix:
       0    1
0  42009  319
1   1075  397
---- Validation: 
scalar performance:
{'acc': 0.96722007, 'precision': 0.77401483, 'recall': 0.5764994, 'specificity': 0.5764994, 'f1': 0.61509454, 'auroc': 0.9278623, 'binary_precision': 0.57714283, 'binary_recall': 0.15707621, 'binary_specificity': 0.9959226, 'binary_f1_score': 0.24694376}
confusion matrix:
       0    1
0  18075   74
1    542  101
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9651646, 'precision': 0.9824618, 'recall': 0.58237547, 'specificity': 0.58237547, 'f1': 0.6325217, 'auroc': 0.8932321, 'binary_precision': 1.0, 'binary_recall': 0.16475096, 'binary_specificity': 1.0, 'binary_f1_score': 0.28289476}
confusion matrix:
      0   1
0  5997   0
1   218  43
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21403763_10.png
better model found
persisted
after epoch: 10,now: 2024-06-18 07:20:49.854212,epoch time: 0:23:51.457647,used: 3:28:10.612104,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_52_39_seed_0_21403763
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96890414, 'precision': 0.7682077, 'recall': 0.6734266, 'specificity': 0.6734266, 'f1': 0.70966756, 'auroc': 0.9302163, 'binary_precision': 0.55851066, 'binary_recall': 0.3566576, 'binary_specificity': 0.99019563, 'binary_f1_score': 0.43532336}
confusion matrix:
       0    1
0  41913  415
1    947  525
---- Validation: 
scalar performance:
{'acc': 0.96823114, 'precision': 0.78723097, 'recall': 0.6032748, 'specificity': 0.6032748, 'f1': 0.6483715, 'auroc': 0.93076026, 'binary_precision': 0.6017699, 'binary_recall': 0.21150856, 'binary_specificity': 0.9950411, 'binary_f1_score': 0.31300345}
confusion matrix:
       0    1
0  18059   90
1    507  136
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96580374, 'precision': 0.98277247, 'recall': 0.5900383, 'specificity': 0.5900383, 'f1': 0.6438327, 'auroc': 0.8960358, 'binary_precision': 1.0, 'binary_recall': 0.18007663, 'binary_specificity': 1.0, 'binary_f1_score': 0.30519482}
confusion matrix:
      0   1
0  5997   0
1   214  47
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21403763_11.png
better model found
persisted
after epoch: 11,now: 2024-06-18 07:44:10.923658,epoch time: 0:23:21.069446,used: 3:51:31.681550,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_52_39_seed_0_21403763
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9680822, 'precision': 0.7583319, 'recall': 0.6680834, 'specificity': 0.6680834, 'f1': 0.7027121, 'auroc': 0.9309154, 'binary_precision': 0.53911203, 'binary_recall': 0.3464674, 'binary_specificity': 0.9896995, 'binary_f1_score': 0.42183623}
confusion matrix:
       0    1
0  41892  436
1    962  510
---- Validation: 
scalar performance:
{'acc': 0.967699, 'precision': 0.77102137, 'recall': 0.61275005, 'specificity': 0.61275005, 'f1': 0.6563664, 'auroc': 0.93426657, 'binary_precision': 0.5687023, 'binary_recall': 0.23172629, 'binary_specificity': 0.99377376, 'binary_f1_score': 0.32928175}
confusion matrix:
       0    1
0  18036  113
1    494  149
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96580374, 'precision': 0.9726434, 'recall': 0.59187067, 'specificity': 0.59187067, 'f1': 0.6460725, 'auroc': 0.89777666, 'binary_precision': 0.97959185, 'binary_recall': 0.18390805, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.30967742}
confusion matrix:
      0   1
0  5996   1
1   213  48
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21403763_12.png
early stop counter: 1
val acc:0.9676989912986755, best validation acc: 0.9682311415672302, corresponding to test acc:                         0.9658037424087524 / 0.967082142829895
after epoch: 12,now: 2024-06-18 08:03:03.419996,epoch time: 0:18:52.496338,used: 4:10:24.177888,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_52_39_seed_0_21403763
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9683105, 'precision': 0.7623738, 'recall': 0.65869355, 'specificity': 0.65869355, 'f1': 0.6965401, 'auroc': 0.93466187, 'binary_precision': 0.547836, 'binary_recall': 0.3267663, 'binary_specificity': 0.99062085, 'binary_f1_score': 0.40936172}
confusion matrix:
       0    1
0  41931  397
1    991  481
---- Validation: 
scalar performance:
{'acc': 0.9676458, 'precision': 0.780676, 'recall': 0.5872206, 'specificity': 0.5872206, 'f1': 0.62895846, 'auroc': 0.9343958, 'binary_precision': 0.5897436, 'binary_recall': 0.17884915, 'binary_specificity': 0.99559206, 'binary_f1_score': 0.274463}
confusion matrix:
       0    1
0  18069   80
1    528  115
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96324706, 'precision': 0.9664549, 'recall': 0.5612193, 'specificity': 0.5612193, 'f1': 0.59943426, 'auroc': 0.8950087, 'binary_precision': 0.969697, 'binary_recall': 0.12260536, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.21768707}
confusion matrix:
      0   1
0  5996   1
1   229  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21403763_13.png
early stop counter: 2
val acc:0.9676458239555359, best validation acc: 0.9682311415672302, corresponding to test acc:                         0.9658037424087524 / 0.967082142829895
after epoch: 13,now: 2024-06-18 08:26:22.382058,epoch time: 0:23:18.962062,used: 4:33:43.139950,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_52_39_seed_0_21403763
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96890414, 'precision': 0.76945686, 'recall': 0.6658858, 'specificity': 0.6658858, 'f1': 0.7041827, 'auroc': 0.93487287, 'binary_precision': 0.56152123, 'binary_recall': 0.3410326, 'binary_specificity': 0.990739, 'binary_f1_score': 0.4243449}
confusion matrix:
       0    1
0  41936  392
1    970  502
---- Validation: 
scalar performance:
{'acc': 0.96812475, 'precision': 0.7819774, 'recall': 0.6084701, 'specificity': 0.6084701, 'f1': 0.6534209, 'auroc': 0.9359244, 'binary_precision': 0.59090906, 'binary_recall': 0.22239502, 'binary_specificity': 0.99454516, 'binary_f1_score': 0.32316384}
confusion matrix:
       0    1
0  18050   99
1    500  143
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96644294, 'precision': 0.9830836, 'recall': 0.59770113, 'specificity': 0.59770113, 'f1': 0.65485775, 'auroc': 0.8959439, 'binary_precision': 1.0, 'binary_recall': 0.1954023, 'binary_specificity': 1.0, 'binary_f1_score': 0.32692307}
confusion matrix:
      0   1
0  5997   0
1   210  51
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21403763_14.png
early stop counter: 3
val acc:0.9681247472763062, best validation acc: 0.9682311415672302, corresponding to test acc:                         0.9658037424087524 / 0.967082142829895
after epoch: 14,now: 2024-06-18 08:49:26.301046,epoch time: 0:23:03.918988,used: 4:56:47.058938,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_52_39_seed_0_21403763
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.968242, 'precision': 0.7591245, 'recall': 0.6809527, 'specificity': 0.6809527, 'f1': 0.7123988, 'auroc': 0.9344424, 'binary_precision': 0.539823, 'binary_recall': 0.37296197, 'binary_specificity': 0.9889435, 'binary_f1_score': 0.44114104}
confusion matrix:
       0    1
0  41860  468
1    923  549
---- Validation: 
scalar performance:
{'acc': 0.96828437, 'precision': 0.7834909, 'recall': 0.6130531, 'specificity': 0.6130531, 'f1': 0.65854454, 'auroc': 0.93750083, 'binary_precision': 0.5936255, 'binary_recall': 0.23172629, 'binary_specificity': 0.9943799, 'binary_f1_score': 0.3333333}
confusion matrix:
       0    1
0  18047  102
1    494  149
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96660274, 'precision': 0.9739773, 'recall': 0.6014492, 'specificity': 0.6014492, 'f1': 0.65968907, 'auroc': 0.8974473, 'binary_precision': 0.9814815, 'binary_recall': 0.20306513, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.33650795}
confusion matrix:
      0   1
0  5996   1
1   208  53
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21403763_15.png
better model found
persisted
after epoch: 15,now: 2024-06-18 09:11:54.928671,epoch time: 0:22:28.627625,used: 5:19:15.686563,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_52_39_seed_0_21403763
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.96949774, 'precision': 0.7791092, 'recall': 0.661275, 'specificity': 0.661275, 'f1': 0.7029904, 'auroc': 0.93768406, 'binary_precision': 0.5811456, 'binary_recall': 0.3308424, 'binary_specificity': 0.9917076, 'binary_f1_score': 0.42164502}
confusion matrix:
       0    1
0  41977  351
1    985  487
---- Validation: 
scalar performance:
{'acc': 0.96780545, 'precision': 0.78168255, 'recall': 0.5933037, 'specificity': 0.5933037, 'f1': 0.6363008, 'auroc': 0.9378596, 'binary_precision': 0.59134614, 'binary_recall': 0.19129083, 'binary_specificity': 0.99531657, 'binary_f1_score': 0.28907168}
confusion matrix:
       0    1
0  18064   85
1    520  123
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964046, 'precision': 0.981919, 'recall': 0.5689655, 'specificity': 0.5689655, 'f1': 0.6120051, 'auroc': 0.89699674, 'binary_precision': 1.0, 'binary_recall': 0.13793103, 'binary_specificity': 1.0, 'binary_f1_score': 0.24242425}
confusion matrix:
      0   1
0  5997   0
1   225  36
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21403763_16.png
early stop counter: 1
val acc:0.9678054451942444, best validation acc: 0.9682843685150146, corresponding to test acc:                         0.9666027426719666 / 0.967082142829895
after epoch: 16,now: 2024-06-18 09:39:55.581341,epoch time: 0:28:00.652670,used: 5:47:16.339233,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_52_39_seed_0_21403763
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.96906394, 'precision': 0.77489865, 'recall': 0.6512147, 'specificity': 0.6512147, 'f1': 0.69347066, 'auroc': 0.93599045, 'binary_precision': 0.57340026, 'binary_recall': 0.31046197, 'binary_specificity': 0.9919675, 'binary_f1_score': 0.40282062}
confusion matrix:
       0    1
0  41988  340
1   1015  457
---- Validation: 
scalar performance:
{'acc': 0.9680715, 'precision': 0.79329693, 'recall': 0.58744097, 'specificity': 0.58744097, 'f1': 0.63039184, 'auroc': 0.9366412, 'binary_precision': 0.61497325, 'binary_recall': 0.17884915, 'binary_specificity': 0.99603283, 'binary_f1_score': 0.27710843}
confusion matrix:
       0    1
0  18077   72
1    528  115
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642058, 'precision': 0.9819965, 'recall': 0.57088125, 'specificity': 0.57088125, 'f1': 0.6149943, 'auroc': 0.8960754, 'binary_precision': 1.0, 'binary_recall': 0.14176245, 'binary_specificity': 1.0, 'binary_f1_score': 0.24832213}
confusion matrix:
      0   1
0  5997   0
1   224  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21403763_17.png
early stop counter: 2
val acc:0.9680715203285217, best validation acc: 0.9682843685150146, corresponding to test acc:                         0.9666027426719666 / 0.967082142829895
after epoch: 17,now: 2024-06-18 10:01:24.898029,epoch time: 0:21:29.316688,used: 6:08:45.655921,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_52_39_seed_0_21403763
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9697032, 'precision': 0.7782621, 'recall': 0.67711866, 'specificity': 0.67711866, 'f1': 0.7154084, 'auroc': 0.9345746, 'binary_precision': 0.5783784, 'binary_recall': 0.3634511, 'binary_specificity': 0.99078625, 'binary_f1_score': 0.44639134}
confusion matrix:
       0    1
0  41938  390
1    937  535
---- Validation: 
scalar performance:
{'acc': 0.96823114, 'precision': 0.78899646, 'recall': 0.60027456, 'specificity': 0.60027456, 'f1': 0.64518166, 'auroc': 0.93798727, 'binary_precision': 0.6055046, 'binary_recall': 0.20528771, 'binary_specificity': 0.99526143, 'binary_f1_score': 0.3066202}
confusion matrix:
       0    1
0  18063   86
1    511  132
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9638862, 'precision': 0.98184156, 'recall': 0.5670498, 'specificity': 0.5670498, 'f1': 0.60899615, 'auroc': 0.89840657, 'binary_precision': 1.0, 'binary_recall': 0.13409962, 'binary_specificity': 1.0, 'binary_f1_score': 0.2364865}
confusion matrix:
      0   1
0  5997   0
1   226  35
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21403763_18.png
early stop counter: 3
val acc:0.9682311415672302, best validation acc: 0.9682843685150146, corresponding to test acc:                         0.9666027426719666 / 0.967082142829895
after epoch: 18,now: 2024-06-18 10:23:27.469637,epoch time: 0:22:02.571608,used: 6:30:48.227529,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_52_39_seed_0_21403763
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9690411, 'precision': 0.7714885, 'recall': 0.66376424, 'specificity': 0.66376424, 'f1': 0.7030448, 'auroc': 0.93546563, 'binary_precision': 0.5657143, 'binary_recall': 0.33650577, 'binary_specificity': 0.9910227, 'binary_f1_score': 0.42199486}
confusion matrix:
       0    1
0  41949  380
1    976  495
---- Validation: 
scalar performance:
{'acc': 0.9679119, 'precision': 0.78690445, 'recall': 0.58960855, 'specificity': 0.58960855, 'f1': 0.6324384, 'auroc': 0.938388, 'binary_precision': 0.6020408, 'binary_recall': 0.18351477, 'binary_specificity': 0.99570227, 'binary_f1_score': 0.28128725}
confusion matrix:
       0    1
0  18071   78
1    525  118
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9637264, 'precision': 0.98176414, 'recall': 0.5651341, 'specificity': 0.5651341, 'f1': 0.6059669, 'auroc': 0.89904165, 'binary_precision': 1.0, 'binary_recall': 0.1302682, 'binary_specificity': 1.0, 'binary_f1_score': 0.23050848}
confusion matrix:
      0   1
0  5997   0
1   227  34
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21403763_19.png
early stop counter: 4
val acc:0.9679118990898132, best validation acc: 0.9682843685150146, corresponding to test acc:                         0.9666027426719666 / 0.967082142829895
after epoch: 19,now: 2024-06-18 10:43:41.667907,epoch time: 0:20:14.198270,used: 6:51:02.425799,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_52_39_seed_0_21403763
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.96981734, 'precision': 0.786942, 'recall': 0.6525881, 'specificity': 0.6525881, 'f1': 0.69743013, 'auroc': 0.93726563, 'binary_precision': 0.5974026, 'binary_recall': 0.3125, 'binary_specificity': 0.99267626, 'binary_f1_score': 0.4103479}
confusion matrix:
       0    1
0  42018  310
1   1012  460
---- Validation: 
scalar performance:
{'acc': 0.9679119, 'precision': 0.7943783, 'recall': 0.57985777, 'specificity': 0.57985777, 'f1': 0.6209519, 'auroc': 0.93890077, 'binary_precision': 0.61764705, 'binary_recall': 0.16329704, 'binary_specificity': 0.99641854, 'binary_f1_score': 0.25830257}
confusion matrix:
       0    1
0  18084   65
1    538  105
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96324706, 'precision': 0.98153204, 'recall': 0.55938697, 'specificity': 0.55938697, 'f1': 0.59675664, 'auroc': 0.8971652, 'binary_precision': 1.0, 'binary_recall': 0.118773945, 'binary_specificity': 1.0, 'binary_f1_score': 0.21232876}
confusion matrix:
      0   1
0  5997   0
1   230  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21403763_20.png
early stop counter: 5
val acc:0.9679118990898132, best validation acc: 0.9682843685150146, corresponding to test acc:                         0.9666027426719666 / 0.967082142829895
after epoch: 20,now: 2024-06-18 11:07:13.719233,epoch time: 0:23:32.051326,used: 7:14:34.477125,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_52_39_seed_0_21403763
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.97, 'precision': 0.7835512, 'recall': 0.6718065, 'specificity': 0.6718065, 'f1': 0.7127188, 'auroc': 0.9379184, 'binary_precision': 0.58930606, 'binary_recall': 0.3521414, 'binary_specificity': 0.9914716, 'binary_f1_score': 0.44085106}
confusion matrix:
       0    1
0  41968  361
1    953  518
---- Validation: 
scalar performance:
{'acc': 0.96855044, 'precision': 0.7939489, 'recall': 0.60569024, 'specificity': 0.60569024, 'f1': 0.6519055, 'auroc': 0.9411572, 'binary_precision': 0.61504424, 'binary_recall': 0.21617419, 'binary_specificity': 0.99520636, 'binary_f1_score': 0.31990793}
confusion matrix:
       0    1
0  18062   87
1    504  139
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96292746, 'precision': 0.9813774, 'recall': 0.5555556, 'specificity': 0.5555556, 'f1': 0.59051204, 'auroc': 0.8954403, 'binary_precision': 1.0, 'binary_recall': 0.11111111, 'binary_specificity': 1.0, 'binary_f1_score': 0.19999999}
confusion matrix:
      0   1
0  5997   0
1   232  29
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21403763_21.png
better model found
persisted
after epoch: 21,now: 2024-06-18 11:40:09.014851,epoch time: 0:32:55.295618,used: 7:47:29.772743,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_52_39_seed_0_21403763
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.969726, 'precision': 0.77702534, 'recall': 0.68434346, 'specificity': 0.68434346, 'f1': 0.7204933, 'auroc': 0.9368795, 'binary_precision': 0.5754132, 'binary_recall': 0.37839675, 'binary_specificity': 0.9902901, 'binary_f1_score': 0.4565574}
confusion matrix:
       0    1
0  41917  411
1    915  557
---- Validation: 
scalar performance:
{'acc': 0.96886975, 'precision': 0.801772, 'recall': 0.60660565, 'specificity': 0.60660565, 'f1': 0.6538838, 'auroc': 0.9418113, 'binary_precision': 0.6306306, 'binary_recall': 0.21772939, 'binary_specificity': 0.99548185, 'binary_f1_score': 0.3236994}
confusion matrix:
       0    1
0  18067   82
1    503  140
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96244806, 'precision': 0.98114574, 'recall': 0.54980844, 'specificity': 0.54980844, 'f1': 0.580984, 'auroc': 0.8966107, 'binary_precision': 1.0, 'binary_recall': 0.099616855, 'binary_specificity': 1.0, 'binary_f1_score': 0.18118466}
confusion matrix:
      0   1
0  5997   0
1   235  26
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21403763_22.png
better model found
persisted
after epoch: 22,now: 2024-06-18 12:14:17.816450,epoch time: 0:34:08.801599,used: 8:21:38.574342,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_52_39_seed_0_21403763
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9704338, 'precision': 0.7886331, 'recall': 0.6774967, 'specificity': 0.6774967, 'f1': 0.718619, 'auroc': 0.9448627, 'binary_precision': 0.59910417, 'binary_recall': 0.3634511, 'binary_specificity': 0.9915422, 'binary_f1_score': 0.4524313}
confusion matrix:
       0    1
0  41970  358
1    937  535
---- Validation: 
scalar performance:
{'acc': 0.96972114, 'precision': 0.8121816, 'recall': 0.62204754, 'specificity': 0.62204754, 'f1': 0.6722244, 'auroc': 0.94178677, 'binary_precision': 0.6504065, 'binary_recall': 0.2488336, 'binary_specificity': 0.99526143, 'binary_f1_score': 0.359955}
confusion matrix:
       0    1
0  18063   86
1    483  160
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96260786, 'precision': 0.9812229, 'recall': 0.55172414, 'specificity': 0.55172414, 'f1': 0.5841818, 'auroc': 0.89936733, 'binary_precision': 1.0, 'binary_recall': 0.10344828, 'binary_specificity': 1.0, 'binary_f1_score': 0.1875}
confusion matrix:
      0   1
0  5997   0
1   234  27
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21403763_23.png
better model found
persisted
after epoch: 23,now: 2024-06-18 12:43:11.246409,epoch time: 0:28:53.429959,used: 8:50:32.004301,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_52_39_seed_0_21403763
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9706393, 'precision': 0.79147047, 'recall': 0.6782587, 'specificity': 0.6782587, 'f1': 0.71999896, 'auroc': 0.94350517, 'binary_precision': 0.6047297, 'binary_recall': 0.36480978, 'binary_specificity': 0.9917076, 'binary_f1_score': 0.45508474}
confusion matrix:
       0    1
0  41977  351
1    935  537
---- Validation: 
scalar performance:
{'acc': 0.9691358, 'precision': 0.80264026, 'recall': 0.61499393, 'specificity': 0.61499393, 'f1': 0.66330034, 'auroc': 0.94366145, 'binary_precision': 0.63179916, 'binary_recall': 0.2348367, 'binary_specificity': 0.9951512, 'binary_f1_score': 0.34240362}
confusion matrix:
       0    1
0  18061   88
1    492  151
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96276766, 'precision': 0.9813002, 'recall': 0.5536398, 'specificity': 0.5536398, 'f1': 0.5873577, 'auroc': 0.8986695, 'binary_precision': 1.0, 'binary_recall': 0.107279696, 'binary_specificity': 1.0, 'binary_f1_score': 0.19377163}
confusion matrix:
      0   1
0  5997   0
1   233  28
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21403763_24.png
early stop counter: 1
val acc:0.9691358208656311, best validation acc: 0.9697211384773254, corresponding to test acc:                         0.9626078605651855 / 0.967082142829895
after epoch: 24,now: 2024-06-18 13:08:27.989343,epoch time: 0:25:16.742934,used: 9:15:48.747235,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_52_39_seed_0_21403763
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.970274, 'precision': 0.79046357, 'recall': 0.6642995, 'specificity': 0.6642995, 'f1': 0.7083374, 'auroc': 0.9416256, 'binary_precision': 0.60365856, 'binary_recall': 0.3362772, 'binary_specificity': 0.99232185, 'binary_f1_score': 0.4319372}
confusion matrix:
       0    1
0  42003  325
1    977  495
---- Validation: 
scalar performance:
{'acc': 0.9690826, 'precision': 0.81605136, 'recall': 0.59771514, 'specificity': 0.59771514, 'f1': 0.64502174, 'auroc': 0.9405097, 'binary_precision': 0.6597938, 'binary_recall': 0.19906688, 'binary_specificity': 0.99636346, 'binary_f1_score': 0.30585426}
confusion matrix:
       0    1
0  18083   66
1    515  128
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96276766, 'precision': 0.9813002, 'recall': 0.5536398, 'specificity': 0.5536398, 'f1': 0.5873577, 'auroc': 0.8954774, 'binary_precision': 1.0, 'binary_recall': 0.107279696, 'binary_specificity': 1.0, 'binary_f1_score': 0.19377163}
confusion matrix:
      0   1
0  5997   0
1   233  28
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21403763_25.png
early stop counter: 2
val acc:0.9690825939178467, best validation acc: 0.9697211384773254, corresponding to test acc:                         0.9626078605651855 / 0.967082142829895
after epoch: 25,now: 2024-06-18 13:31:47.924686,epoch time: 0:23:19.935343,used: 9:39:08.682578,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_52_39_seed_0_21403763
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9708904, 'precision': 0.7957382, 'recall': 0.6770772, 'specificity': 0.6770772, 'f1': 0.7202033, 'auroc': 0.9445022, 'binary_precision': 0.61334866, 'binary_recall': 0.3620924, 'binary_specificity': 0.992062, 'binary_f1_score': 0.45536095}
confusion matrix:
       0    1
0  41992  336
1    939  533
---- Validation: 
scalar performance:
{'acc': 0.96886975, 'precision': 0.8108429, 'recall': 0.59610486, 'specificity': 0.59610486, 'f1': 0.64257777, 'auroc': 0.9407595, 'binary_precision': 0.6494845, 'binary_recall': 0.19595645, 'binary_specificity': 0.99625325, 'binary_f1_score': 0.30107525}
confusion matrix:
       0    1
0  18081   68
1    517  126
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96212846, 'precision': 0.98099136, 'recall': 0.545977, 'specificity': 0.545977, 'f1': 0.574522, 'auroc': 0.8971555, 'binary_precision': 1.0, 'binary_recall': 0.09195402, 'binary_specificity': 1.0, 'binary_f1_score': 0.16842106}
confusion matrix:
      0   1
0  5997   0
1   237  24
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21403763_26.png
early stop counter: 3
val acc:0.9688697457313538, best validation acc: 0.9697211384773254, corresponding to test acc:                         0.9626078605651855 / 0.967082142829895
after epoch: 26,now: 2024-06-18 13:56:46.405189,epoch time: 0:24:58.480503,used: 10:04:07.163081,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_52_39_seed_0_21403763
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.97134703, 'precision': 0.7960504, 'recall': 0.6951418, 'specificity': 0.6951418, 'f1': 0.7342957, 'auroc': 0.94310355, 'binary_precision': 0.61273485, 'binary_recall': 0.39904827, 'binary_specificity': 0.9912353, 'binary_f1_score': 0.48332646}
confusion matrix:
       0    1
0  41958  371
1    884  587
---- Validation: 
scalar performance:
{'acc': 0.9695615, 'precision': 0.8142318, 'recall': 0.6144643, 'specificity': 0.6144643, 'f1': 0.66422796, 'auroc': 0.94398355, 'binary_precision': 0.65502185, 'binary_recall': 0.2332815, 'binary_specificity': 0.99564713, 'binary_f1_score': 0.3440367}
confusion matrix:
       0    1
0  18070   79
1    493  150
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96276766, 'precision': 0.9813002, 'recall': 0.5536398, 'specificity': 0.5536398, 'f1': 0.5873577, 'auroc': 0.8982192, 'binary_precision': 1.0, 'binary_recall': 0.107279696, 'binary_specificity': 1.0, 'binary_f1_score': 0.19377163}
confusion matrix:
      0   1
0  5997   0
1   233  28
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21403763_27.png
early stop counter: 4
val acc:0.9695615172386169, best validation acc: 0.9697211384773254, corresponding to test acc:                         0.9626078605651855 / 0.967082142829895
after epoch: 27,now: 2024-06-18 14:24:18.269400,epoch time: 0:27:31.864211,used: 10:31:39.027292,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_52_39_seed_0_21403763
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.97159815, 'precision': 0.79857147, 'recall': 0.69908226, 'specificity': 0.69908226, 'f1': 0.7379867, 'auroc': 0.94285846, 'binary_precision': 0.61752576, 'binary_recall': 0.40692934, 'binary_specificity': 0.99123514, 'binary_f1_score': 0.49058148}
confusion matrix:
       0    1
0  41957  371
1    873  599
---- Validation: 
scalar performance:
{'acc': 0.9695615, 'precision': 0.8066608, 'recall': 0.624215, 'specificity': 0.624215, 'f1': 0.6737186, 'auroc': 0.9445168, 'binary_precision': 0.6392157, 'binary_recall': 0.2534992, 'binary_specificity': 0.99493086, 'binary_f1_score': 0.36302894}
confusion matrix:
       0    1
0  18057   92
1    480  163
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96244806, 'precision': 0.98114574, 'recall': 0.54980844, 'specificity': 0.54980844, 'f1': 0.580984, 'auroc': 0.8991673, 'binary_precision': 1.0, 'binary_recall': 0.099616855, 'binary_specificity': 1.0, 'binary_f1_score': 0.18118466}
confusion matrix:
      0   1
0  5997   0
1   235  26
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21403763_28.png
early stop counter: 5
val acc:0.9695615172386169, best validation acc: 0.9697211384773254, corresponding to test acc:                         0.9626078605651855 / 0.967082142829895
after epoch: 28,now: 2024-06-18 14:45:41.243210,epoch time: 0:21:22.973810,used: 10:53:02.001102,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_52_39_seed_0_21403763
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9707306, 'precision': 0.787423, 'recall': 0.6966662, 'specificity': 0.6966662, 'f1': 0.732746, 'auroc': 0.9444841, 'binary_precision': 0.5953815, 'binary_recall': 0.40285325, 'binary_specificity': 0.9904791, 'binary_f1_score': 0.48055103}
confusion matrix:
       0    1
0  41925  403
1    879  593
---- Validation: 
scalar performance:
{'acc': 0.96972114, 'precision': 0.81277245, 'recall': 0.6212975, 'specificity': 0.6212975, 'f1': 0.67150325, 'auroc': 0.94459474, 'binary_precision': 0.65163934, 'binary_recall': 0.24727838, 'binary_specificity': 0.99531657, 'binary_f1_score': 0.3585118}
confusion matrix:
       0    1
0  18064   85
1    484  159
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96292746, 'precision': 0.9512231, 'recall': 0.55922025, 'specificity': 0.55922025, 'f1': 0.5959511, 'auroc': 0.8986658, 'binary_precision': 0.93939394, 'binary_recall': 0.118773945, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.21088433}
confusion matrix:
      0   1
0  5995   2
1   230  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21403763_29.png
early stop counter: 6
val acc:0.9697211384773254, best validation acc: 0.9697211384773254, corresponding to test acc:                         0.9626078605651855 / 0.967082142829895
after epoch: 29,now: 2024-06-18 15:26:09.481797,epoch time: 0:40:28.238587,used: 11:33:30.239689,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_52_39_seed_0_21403763
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.969863, 'precision': 0.7751126, 'recall': 0.704086, 'specificity': 0.704086, 'f1': 0.73382133, 'auroc': 0.9454216, 'binary_precision': 0.5702403, 'binary_recall': 0.4191576, 'binary_specificity': 0.9890144, 'binary_f1_score': 0.48316368}
confusion matrix:
       0    1
0  41863  465
1    855  617
---- Validation: 
scalar performance:
{'acc': 0.9701469, 'precision': 0.8013591, 'recall': 0.6545203, 'specificity': 0.6545203, 'f1': 0.7022672, 'auroc': 0.94455373, 'binary_precision': 0.6265432, 'binary_recall': 0.31570762, 'binary_specificity': 0.993333, 'binary_f1_score': 0.4198552}
confusion matrix:
       0    1
0  18028  121
1    440  203
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9638862, 'precision': 0.9684026, 'recall': 0.5688821, 'specificity': 0.5688821, 'f1': 0.6115567, 'auroc': 0.8976121, 'binary_precision': 0.972973, 'binary_recall': 0.13793103, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.24161074}
confusion matrix:
      0   1
0  5996   1
1   225  36
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21403763_30.png
better model found
persisted
after epoch: 30,now: 2024-06-18 16:04:48.212008,epoch time: 0:38:38.730211,used: 12:12:08.969900,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_52_39_seed_0_21403763
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 12:12:08.969900 at 2024-06-18 16:04:48.212008
persisted model performance metric: 

scalar performance:
{'acc': 0.9638862, 'precision': 0.9684026, 'recall': 0.5688821, 'specificity': 0.5688821, 'f1': 0.6115567, 'auroc': 0.8976121, 'binary_precision': 0.972973, 'binary_recall': 0.13793103, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.24161074}
confusion matrix:
      0   1
0  5996   1
1   225  36
oracle model performance metric: 

scalar performance:
{'acc': 0.96708214, 'precision': 0.9746985, 'recall': 0.60719633, 'specificity': 0.60719633, 'f1': 0.66765666, 'auroc': 0.89137787, 'binary_precision': 0.98245615, 'binary_recall': 0.21455939, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.35220128}
confusion matrix:
      0   1
0  5996   1
1   205  56
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4_rest/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4_rest/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204178 KiB |   1436 MiB | 404959 GiB | 404958 GiB |
|       from large pool | 167936 KiB |   1366 MiB | 404884 GiB | 404884 GiB |
|       from small pool |  36242 KiB |     72 MiB |     74 GiB |     74 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 204178 KiB |   1436 MiB | 404959 GiB | 404958 GiB |
|       from large pool | 167936 KiB |   1366 MiB | 404884 GiB | 404884 GiB |
|       from small pool |  36242 KiB |     72 MiB |     74 GiB |     74 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201088 KiB |   1428 MiB | 404935 GiB | 404935 GiB |
|       from large pool | 165120 KiB |   1358 MiB | 404863 GiB | 404863 GiB |
|       from small pool |  35968 KiB |     71 MiB |     71 GiB |     71 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1524 MiB |   1524 MiB |   1524 MiB |      0 B   |
|       from large pool |   1450 MiB |   1450 MiB |   1450 MiB |      0 B   |
|       from small pool |     74 MiB |     74 MiB |     74 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 320109 KiB | 749313 KiB | 302187 GiB | 302187 GiB |
|       from large pool | 311296 KiB | 748328 KiB | 302105 GiB | 302105 GiB |
|       from small pool |   8813 KiB |  12610 KiB |     81 GiB |     81 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1278    |    1935    |   13352 K  |   13351 K  |
|       from large pool |      36    |      76    |    5312 K  |    5312 K  |
|       from small pool |    1242    |    1864    |    8040 K  |    8039 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1278    |    1935    |   13352 K  |   13351 K  |
|       from large pool |      36    |      76    |    5312 K  |    5312 K  |
|       from small pool |    1242    |    1864    |    8040 K  |    8039 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      50    |      50    |      50    |       0    |
|       from large pool |      13    |      13    |      13    |       0    |
|       from small pool |      37    |      37    |      37    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      35    |     452    |    7142 K  |    7142 K  |
|       from large pool |       5    |      10    |    1973 K  |    1973 K  |
|       from small pool |      30    |     447    |    5168 K  |    5168 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1436 MiB | 404959 GiB | 404958 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 404884 GiB | 404884 GiB |
|       from small pool |      0 KiB |     72 MiB |     74 GiB |     74 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1436 MiB | 404959 GiB | 404958 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 404884 GiB | 404884 GiB |
|       from small pool |      0 KiB |     72 MiB |     74 GiB |     74 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1428 MiB | 404935 GiB | 404935 GiB |
|       from large pool |  16640 KiB |   1358 MiB | 404863 GiB | 404863 GiB |
|       from small pool |      0 KiB |     71 MiB |     71 GiB |     71 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 524288 KiB |   1524 MiB |   1524 MiB |   1012 MiB |
|       from large pool | 479232 KiB |   1450 MiB |   1450 MiB |    982 MiB |
|       from small pool |  45056 KiB |     74 MiB |     74 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 298752 KiB | 749313 KiB | 302187 GiB | 302187 GiB |
|       from large pool | 298752 KiB | 748328 KiB | 302105 GiB | 302105 GiB |
|       from small pool |      0 KiB |  16408 KiB |     81 GiB |     81 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1935    |   13352 K  |   13352 K  |
|       from large pool |       2    |      76    |    5312 K  |    5312 K  |
|       from small pool |       0    |    1864    |    8040 K  |    8040 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1935    |   13352 K  |   13352 K  |
|       from large pool |       2    |      76    |    5312 K  |    5312 K  |
|       from small pool |       0    |    1864    |    8040 K  |    8040 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      50    |      50    |      19    |
|       from large pool |       9    |      13    |      13    |       4    |
|       from small pool |      22    |      37    |      37    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     452    |    7142 K  |    7142 K  |
|       from large pool |       1    |      11    |    1973 K  |    1973 K  |
|       from small pool |       0    |     447    |    5168 K  |    5168 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

