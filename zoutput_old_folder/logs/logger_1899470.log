Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0




!!!: not committed yet



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520752

 Experiment start at: 2024-06-21 11:23:15.174466
before training, model accuracy: 0.3103227913379669
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.90547943, 'precision': 0.45273972, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4751977, 'auroc': 0.52520597, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42304  0
1   4416  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.3318319, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.2566136, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520752_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-21 11:39:43.461814,epoch time: 0:16:28.287348,used: 0:16:28.287348,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9055437, 'precision': 0.45277184, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.47521538, 'auroc': 0.6559505, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42307  0
1   4413  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.3552878, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.30929515, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520752_2.png
early stop counter: 1
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 2,now: 2024-06-21 11:54:13.697061,epoch time: 0:14:30.235247,used: 0:30:58.522595,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9055651, 'precision': 0.45278254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4752213, 'auroc': 0.7637186, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42308  0
1   4412  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.38099453, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.33665365, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520752_3.png
early stop counter: 2
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 3,now: 2024-06-21 12:09:24.485424,epoch time: 0:15:10.788363,used: 0:46:09.310958,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9056935, 'precision': 0.95284474, 'recall': 0.50022686, 'specificity': 0.50022686, 'f1': 0.47570905, 'auroc': 0.84873104, 'binary_precision': 1.0, 'binary_recall': 0.0004537205, 'binary_specificity': 1.0, 'binary_f1_score': 0.0009070295}
confusion matrix:
       0  1
0  42312  0
1   4406  2
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.416537, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.39374667, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520752_4.png
early stop counter: 3
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 4,now: 2024-06-21 12:23:02.411497,epoch time: 0:13:37.926073,used: 0:59:47.237031,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9069135, 'precision': 0.95339096, 'recall': 0.50747454, 'specificity': 0.50747454, 'f1': 0.49028498, 'auroc': 0.8963698, 'binary_precision': 1.0, 'binary_recall': 0.014949038, 'binary_specificity': 1.0, 'binary_f1_score': 0.029457709}
confusion matrix:
       0   1
0  42305   0
1   4349  66
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.442742, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.44822776, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520752_5.png
early stop counter: 4
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 5,now: 2024-06-21 12:36:43.551179,epoch time: 0:13:41.139682,used: 1:13:28.376713,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9150471, 'precision': 0.95488954, 'recall': 0.55020314, 'specificity': 0.55020314, 'f1': 0.56884396, 'auroc': 0.9159853, 'binary_precision': 0.99550563, 'binary_recall': 0.10045352, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.18249227}
confusion matrix:
       0    1
0  42308    2
1   3967  443
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.4688035, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.49416983, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520752_6.png
early stop counter: 5
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 6,now: 2024-06-21 12:51:45.808610,epoch time: 0:15:02.257431,used: 1:28:30.634144,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.93050086, 'precision': 0.9610522, 'recall': 0.6329216, 'specificity': 0.6329216, 'f1': 0.6913488, 'auroc': 0.93915105, 'binary_precision': 0.99323183, 'binary_recall': 0.2660322, 'binary_specificity': 0.99981093, 'binary_f1_score': 0.41966045}
confusion matrix:
       0     1
0  42299     8
1   3239  1174
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.5182601, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581336, 'precision': 0.47914335, 'recall': 0.4999166, 'specificity': 0.4999166, 'f1': 0.48930964, 'auroc': 0.5624019, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5996  1
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520752_7.png
early stop counter: 6
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 7,now: 2024-06-21 13:08:17.695436,epoch time: 0:16:31.886826,used: 1:45:02.520970,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.93516695, 'precision': 0.9645022, 'recall': 0.6574184, 'specificity': 0.6574184, 'f1': 0.7220012, 'auroc': 0.9375085, 'binary_precision': 0.995702, 'binary_recall': 0.31497848, 'binary_specificity': 0.9998582, 'binary_f1_score': 0.47856775}
confusion matrix:
       0     1
0  42301     6
1   3023  1390
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.5084529, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.52585375, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520752_8.png
early stop counter: 7
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 8,now: 2024-06-21 13:26:28.131487,epoch time: 0:18:10.436051,used: 2:03:12.957021,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.94511986, 'precision': 0.9660864, 'recall': 0.7116911, 'specificity': 0.7116911, 'f1': 0.7819886, 'auroc': 0.95350546, 'binary_precision': 0.98890066, 'binary_recall': 0.42387858, 'binary_specificity': 0.9995036, 'binary_f1_score': 0.59340316}
confusion matrix:
       0     1
0  42285    21
1   2543  1871
---- Validation: 
scalar performance:
{'acc': 0.9657301, 'precision': 0.48289075, 'recall': 0.49997246, 'specificity': 0.49997246, 'f1': 0.4912832, 'auroc': 0.5562103, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9999449, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18148  1
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581336, 'precision': 0.47914335, 'recall': 0.4999166, 'specificity': 0.4999166, 'f1': 0.48930964, 'auroc': 0.63036513, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5996  1
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520752_9.png
early stop counter: 8
val acc:0.9657300710678101, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 9,now: 2024-06-21 13:44:28.599429,epoch time: 0:18:00.467942,used: 2:21:13.424963,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9510916, 'precision': 0.9697483, 'recall': 0.7431207, 'specificity': 0.7431207, 'f1': 0.8131882, 'auroc': 0.95475745, 'binary_precision': 0.99031365, 'binary_recall': 0.4867377, 'binary_specificity': 0.9995037, 'binary_f1_score': 0.6526828}
confusion matrix:
       0     1
0  42288    21
1   2264  2147
---- Validation: 
scalar performance:
{'acc': 0.9657301, 'precision': 0.69725084, 'recall': 0.5022226, 'specificity': 0.5022226, 'f1': 0.4958971, 'auroc': 0.581723, 'binary_precision': 0.42857143, 'binary_recall': 0.00466563, 'binary_specificity': 0.9997796, 'binary_f1_score': 0.009230768}
confusion matrix:
       0  1
0  18145  4
1    640  3
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9574944, 'precision': 0.47913003, 'recall': 0.49958313, 'specificity': 0.49958313, 'f1': 0.48914286, 'auroc': 0.64958465, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5992  5
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520752_10.png
early stop counter: 9
val acc:0.9657300710678101, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 10,now: 2024-06-21 14:02:25.894609,epoch time: 0:17:57.295180,used: 2:39:10.720143,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.95550084, 'precision': 0.97237456, 'recall': 0.76652426, 'specificity': 0.76652426, 'f1': 0.83484346, 'auroc': 0.95941114, 'binary_precision': 0.9911579, 'binary_recall': 0.5335449, 'binary_specificity': 0.9995036, 'binary_f1_score': 0.69367915}
confusion matrix:
       0     1
0  42287    21
1   2058  2354
---- Validation: 
scalar performance:
{'acc': 0.9657301, 'precision': 0.69725084, 'recall': 0.5022226, 'specificity': 0.5022226, 'f1': 0.4958971, 'auroc': 0.5752409, 'binary_precision': 0.42857143, 'binary_recall': 0.00466563, 'binary_specificity': 0.9997796, 'binary_f1_score': 0.009230768}
confusion matrix:
       0  1
0  18145  4
1    640  3
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95733464, 'precision': 0.4791267, 'recall': 0.49949974, 'specificity': 0.49949974, 'f1': 0.48910117, 'auroc': 0.62704915, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5991  6
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520752_11.png
early stop counter: 10
val acc:0.9657300710678101, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 11,now: 2024-06-21 14:21:03.035190,epoch time: 0:18:37.140581,used: 2:57:47.860724,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9602098, 'precision': 0.9753089, 'recall': 0.79149634, 'specificity': 0.79149634, 'f1': 0.8566681, 'auroc': 0.9641212, 'binary_precision': 0.99229586, 'binary_recall': 0.58346546, 'binary_specificity': 0.9995272, 'binary_f1_score': 0.7348453}
confusion matrix:
       0     1
0  42285    20
1   1839  2576
---- Validation: 
scalar performance:
{'acc': 0.9657301, 'precision': 0.7163977, 'recall': 0.50522286, 'specificity': 0.50522286, 'f1': 0.50191814, 'auroc': 0.6132831, 'binary_precision': 0.46666667, 'binary_recall': 0.01088647, 'binary_specificity': 0.9995592, 'binary_f1_score': 0.021276597}
confusion matrix:
       0  1
0  18141  8
1    636  7
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9576542, 'precision': 0.6460935, 'recall': 0.50699586, 'specificity': 0.50699586, 'f1': 0.5038295, 'auroc': 0.6713728, 'binary_precision': 0.33333334, 'binary_recall': 0.01532567, 'binary_specificity': 0.998666, 'binary_f1_score': 0.029304028}
confusion matrix:
      0  1
0  5989  8
1   257  4
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520752_12.png
early stop counter: 11
val acc:0.9657300710678101, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 12,now: 2024-06-21 14:39:14.722113,epoch time: 0:18:11.686923,used: 3:15:59.547647,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.96359164, 'precision': 0.97792447, 'recall': 0.80876786, 'specificity': 0.80876786, 'f1': 0.8712092, 'auroc': 0.96988475, 'binary_precision': 0.99416274, 'binary_recall': 0.61791384, 'binary_specificity': 0.99962187, 'binary_f1_score': 0.7621312}
confusion matrix:
       0     1
0  42294    16
1   1685  2725
---- Validation: 
scalar performance:
{'acc': 0.96588975, 'precision': 0.7688062, 'recall': 0.50605553, 'specificity': 0.50605553, 'f1': 0.5034973, 'auroc': 0.62265366, 'binary_precision': 0.5714286, 'binary_recall': 0.01244168, 'binary_specificity': 0.99966943, 'binary_f1_score': 0.02435312}
confusion matrix:
       0  1
0  18143  6
1    635  8
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581336, 'precision': 0.7067829, 'recall': 0.50907826, 'specificity': 0.50907826, 'f1': 0.5076832, 'auroc': 0.68416333, 'binary_precision': 0.45454547, 'binary_recall': 0.019157087, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.036764704}
confusion matrix:
      0  1
0  5991  6
1   256  5
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520752_13.png
better model found
persisted
after epoch: 13,now: 2024-06-21 14:58:11.786155,epoch time: 0:18:57.064042,used: 3:34:56.611689,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9656678, 'precision': 0.97843874, 'recall': 0.8203752, 'specificity': 0.8203752, 'f1': 0.88031614, 'auroc': 0.96963614, 'binary_precision': 0.9929849, 'binary_recall': 0.64122313, 'binary_specificity': 0.9995272, 'binary_f1_score': 0.77924585}
confusion matrix:
       0     1
0  42285    20
1   1584  2831
---- Validation: 
scalar performance:
{'acc': 0.9658365, 'precision': 0.74249935, 'recall': 0.5105283, 'specificity': 0.5105283, 'f1': 0.51219964, 'auroc': 0.6285988, 'binary_precision': 0.5185185, 'binary_recall': 0.02177294, 'binary_specificity': 0.99928373, 'binary_f1_score': 0.041791048}
confusion matrix:
       0   1
0  18136  13
1    629  14
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579738, 'precision': 0.7019498, 'recall': 0.5144919, 'specificity': 0.5144919, 'f1': 0.51792777, 'auroc': 0.6790383, 'binary_precision': 0.44444445, 'binary_recall': 0.03065134, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.05734767}
confusion matrix:
      0   1
0  5987  10
1   253   8
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520752_14.png
early stop counter: 1
val acc:0.9658365249633789, best validation acc: 0.9658897519111633, corresponding to test acc:                         0.9581335783004761 / 0.9582933783531189
after epoch: 14,now: 2024-06-21 15:13:48.820423,epoch time: 0:15:37.034268,used: 3:50:33.645957,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.96643835, 'precision': 0.9788775, 'recall': 0.82441247, 'specificity': 0.82441247, 'f1': 0.8835013, 'auroc': 0.9716842, 'binary_precision': 0.99307, 'binary_recall': 0.6492977, 'binary_specificity': 0.9995273, 'binary_f1_score': 0.78520554}
confusion matrix:
       0     1
0  42286    20
1   1548  2866
---- Validation: 
scalar performance:
{'acc': 0.9661026, 'precision': 0.78334403, 'recall': 0.5136663, 'specificity': 0.5136663, 'f1': 0.5181171, 'auroc': 0.64655197, 'binary_precision': 0.6, 'binary_recall': 0.02799378, 'binary_specificity': 0.9993388, 'binary_f1_score': 0.053491827}
confusion matrix:
       0   1
0  18137  12
1    625  18
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.72973406, 'recall': 0.5146587, 'specificity': 0.5146587, 'f1': 0.5182182, 'auroc': 0.69265664, 'binary_precision': 0.5, 'binary_recall': 0.03065134, 'binary_specificity': 0.998666, 'binary_f1_score': 0.057761732}
confusion matrix:
      0  1
0  5989  8
1   253  8
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520752_15.png
better model found
persisted
after epoch: 15,now: 2024-06-21 15:26:36.917760,epoch time: 0:12:48.097337,used: 4:03:21.743294,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.97069776, 'precision': 0.97981644, 'recall': 0.8479003, 'specificity': 0.8479003, 'f1': 0.90094924, 'auroc': 0.9772978, 'binary_precision': 0.99033195, 'binary_recall': 0.69650954, 'binary_specificity': 0.99929094, 'binary_f1_score': 0.81783104}
confusion matrix:
       0     1
0  42278    30
1   1339  3073
---- Validation: 
scalar performance:
{'acc': 0.9662622, 'precision': 0.7761233, 'recall': 0.52349967, 'specificity': 0.52349967, 'f1': 0.53594667, 'auroc': 0.66703784, 'binary_precision': 0.5849057, 'binary_recall': 0.048211507, 'binary_specificity': 0.9987878, 'binary_f1_score': 0.08908046}
confusion matrix:
       0   1
0  18127  22
1    612  31
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.74090165, 'recall': 0.52207136, 'specificity': 0.52207136, 'f1': 0.5316256, 'auroc': 0.7194555, 'binary_precision': 0.5217391, 'binary_recall': 0.04597701, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.08450704}
confusion matrix:
      0   1
0  5986  11
1   249  12
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520752_16.png
new oracle model saved
better model found
persisted
after epoch: 16,now: 2024-06-21 15:37:55.564027,epoch time: 0:11:18.646267,used: 4:14:40.389561,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9698202, 'precision': 0.9803473, 'recall': 0.84254324, 'specificity': 0.84254324, 'f1': 0.89729637, 'auroc': 0.97594535, 'binary_precision': 0.99245405, 'binary_recall': 0.6856301, 'binary_specificity': 0.99945635, 'binary_f1_score': 0.81099194}
confusion matrix:
       0     1
0  42285    23
1   1387  3025
---- Validation: 
scalar performance:
{'acc': 0.965943, 'precision': 0.75015736, 'recall': 0.518084, 'specificity': 0.518084, 'f1': 0.52621067, 'auroc': 0.65467626, 'binary_precision': 0.53333336, 'binary_recall': 0.03732504, 'binary_specificity': 0.9988429, 'binary_f1_score': 0.069767445}
confusion matrix:
       0   1
0  18128  21
1    619  24
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579738, 'precision': 0.7107917, 'recall': 0.52182126, 'specificity': 0.52182126, 'f1': 0.5310587, 'auroc': 0.6907424, 'binary_precision': 0.46153846, 'binary_recall': 0.04597701, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.08362369}
confusion matrix:
      0   1
0  5983  14
1   249  12
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520752_17.png
early stop counter: 1
val acc:0.9659429788589478, best validation acc: 0.9662622213363647, corresponding to test acc:                         0.9584531784057617 / 0.9584531784057617
after epoch: 17,now: 2024-06-21 15:53:20.855935,epoch time: 0:15:25.291908,used: 4:30:05.681469,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9723673, 'precision': 0.98094785, 'recall': 0.8566706, 'specificity': 0.8566706, 'f1': 0.9074683, 'auroc': 0.9783429, 'binary_precision': 0.9908805, 'binary_recall': 0.71402675, 'binary_specificity': 0.99931455, 'binary_f1_score': 0.829975}
confusion matrix:
       0     1
0  42278    29
1   1262  3151
---- Validation: 
scalar performance:
{'acc': 0.965943, 'precision': 0.74465954, 'recall': 0.52708465, 'specificity': 0.52708465, 'f1': 0.5418831, 'auroc': 0.6692277, 'binary_precision': 0.5217391, 'binary_recall': 0.05598756, 'binary_specificity': 0.9981817, 'binary_f1_score': 0.1011236}
confusion matrix:
       0   1
0  18116  33
1    607  36
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.957814, 'precision': 0.7022415, 'recall': 0.5217379, 'specificity': 0.5217379, 'f1': 0.5308718, 'auroc': 0.7052417, 'binary_precision': 0.44444445, 'binary_recall': 0.04597701, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.08333333}
confusion matrix:
      0   1
0  5982  15
1   249  12
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520752_18.png
early stop counter: 2
val acc:0.9659429788589478, best validation acc: 0.9662622213363647, corresponding to test acc:                         0.9584531784057617 / 0.9584531784057617
after epoch: 18,now: 2024-06-21 16:06:54.643425,epoch time: 0:13:33.787490,used: 4:43:39.468959,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9740368, 'precision': 0.9817885, 'recall': 0.86560965, 'specificity': 0.86560965, 'f1': 0.9138851, 'auroc': 0.98050404, 'binary_precision': 0.9907975, 'binary_recall': 0.7319284, 'binary_specificity': 0.9992909, 'binary_f1_score': 0.8419132}
confusion matrix:
       0     1
0  42277    30
1   1183  3230
---- Validation: 
scalar performance:
{'acc': 0.96647507, 'precision': 0.7773318, 'recall': 0.5333606, 'specificity': 0.5333606, 'f1': 0.5527369, 'auroc': 0.68115854, 'binary_precision': 0.58666664, 'binary_recall': 0.06842924, 'binary_specificity': 0.9982919, 'binary_f1_score': 0.12256268}
confusion matrix:
       0   1
0  18118  31
1    599  44
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.73017657, 'recall': 0.5256527, 'specificity': 0.5256527, 'f1': 0.53776985, 'auroc': 0.7102312, 'binary_precision': 0.5, 'binary_recall': 0.053639848, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.096885815}
confusion matrix:
      0   1
0  5983  14
1   247  14
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520752_19.png
better model found
persisted
after epoch: 19,now: 2024-06-21 16:18:08.797209,epoch time: 0:11:14.153784,used: 4:54:53.622743,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.97465754, 'precision': 0.9838278, 'recall': 0.8677075, 'specificity': 0.8677075, 'f1': 0.9160137, 'auroc': 0.980685, 'binary_precision': 0.99448866, 'binary_recall': 0.7358405, 'binary_specificity': 0.99957454, 'binary_f1_score': 0.84583336}
confusion matrix:
       0     1
0  42288    18
1   1166  3248
---- Validation: 
scalar performance:
{'acc': 0.96631545, 'precision': 0.7638329, 'recall': 0.5355281, 'specificity': 0.5355281, 'f1': 0.55606204, 'auroc': 0.6825174, 'binary_precision': 0.5595238, 'binary_recall': 0.07309487, 'binary_specificity': 0.99796134, 'binary_f1_score': 0.1292985}
confusion matrix:
       0   1
0  18112  37
1    596  47
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.756196, 'recall': 0.5295675, 'specificity': 0.5295675, 'f1': 0.5446211, 'auroc': 0.7157544, 'binary_precision': 0.55172414, 'binary_recall': 0.06130268, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.11034483}
confusion matrix:
      0   1
0  5984  13
1   245  16
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520752_20.png
new oracle model saved
early stop counter: 1
val acc:0.9663154482841492, best validation acc: 0.9664750695228577, corresponding to test acc:                         0.9582933783531189 / 0.9587727785110474
after epoch: 20,now: 2024-06-21 16:29:22.959321,epoch time: 0:11:14.162112,used: 5:06:07.784855,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.97669095, 'precision': 0.9828136, 'recall': 0.88006496, 'specificity': 0.88006496, 'f1': 0.9238786, 'auroc': 0.9823132, 'binary_precision': 0.9899764, 'binary_recall': 0.7609336, 'binary_specificity': 0.99919635, 'binary_f1_score': 0.860474}
confusion matrix:
       0     1
0  42273    34
1   1055  3358
---- Validation: 
scalar performance:
{'acc': 0.9664219, 'precision': 0.7642981, 'recall': 0.5423337, 'specificity': 0.5423337, 'f1': 0.5668063, 'auroc': 0.6934923, 'binary_precision': 0.56, 'binary_recall': 0.08709176, 'binary_specificity': 0.99757564, 'binary_f1_score': 0.15074025}
confusion matrix:
       0   1
0  18105  44
1    587  56
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959412, 'precision': 0.769977, 'recall': 0.54822433, 'specificity': 0.54822433, 'f1': 0.574566, 'auroc': 0.7209052, 'binary_precision': 0.5777778, 'binary_recall': 0.099616855, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.16993465}
confusion matrix:
      0   1
0  5978  19
1   235  26
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520752_21.png
new oracle model saved
early stop counter: 2
val acc:0.966421902179718, best validation acc: 0.9664750695228577, corresponding to test acc:                         0.9582933783531189 / 0.9594119787216187
after epoch: 21,now: 2024-06-21 16:40:23.982286,epoch time: 0:11:01.022965,used: 5:17:08.807820,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.97666955, 'precision': 0.98227096, 'recall': 0.8804116, 'specificity': 0.8804116, 'f1': 0.9239062, 'auroc': 0.9835938, 'binary_precision': 0.9888268, 'binary_recall': 0.76172143, 'binary_specificity': 0.99910176, 'binary_f1_score': 0.86054254}
confusion matrix:
       0     1
0  42267    38
1   1052  3363
---- Validation: 
scalar performance:
{'acc': 0.96599615, 'precision': 0.7443701, 'recall': 0.538363, 'specificity': 0.538363, 'f1': 0.560154, 'auroc': 0.70389855, 'binary_precision': 0.52040815, 'binary_recall': 0.07931571, 'binary_specificity': 0.9974103, 'binary_f1_score': 0.13765182}
confusion matrix:
       0   1
0  18102  47
1    592  51
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.8186836, 'recall': 0.5506403, 'specificity': 0.5506403, 'f1': 0.57959044, 'auroc': 0.7453599, 'binary_precision': 0.675, 'binary_recall': 0.10344828, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.179402}
confusion matrix:
      0   1
0  5984  13
1   234  27
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520752_22.png
new oracle model saved
early stop counter: 3
val acc:0.9659961462020874, best validation acc: 0.9664750695228577, corresponding to test acc:                         0.9582933783531189 / 0.9605305194854736
after epoch: 22,now: 2024-06-21 16:51:42.040999,epoch time: 0:11:18.058713,used: 5:28:26.866533,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.97889555, 'precision': 0.98284113, 'recall': 0.89277405, 'specificity': 0.89277405, 'f1': 0.9320656, 'auroc': 0.9851799, 'binary_precision': 0.98748577, 'binary_recall': 0.78658813, 'binary_specificity': 0.99895996, 'binary_f1_score': 0.8756621}
confusion matrix:
       0     1
0  42262    44
1    942  3472
---- Validation: 
scalar performance:
{'acc': 0.96674114, 'precision': 0.7704191, 'recall': 0.55449986, 'specificity': 0.55449986, 'f1': 0.58513975, 'auroc': 0.70652217, 'binary_precision': 0.5714286, 'binary_recall': 0.11197512, 'binary_specificity': 0.99702466, 'binary_f1_score': 0.18725619}
confusion matrix:
       0   1
0  18095  54
1    571  72
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.8043982, 'recall': 0.5579696, 'specificity': 0.5579696, 'f1': 0.59020644, 'auroc': 0.73797774, 'binary_precision': 0.6458333, 'binary_recall': 0.118773945, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.20064723}
confusion matrix:
      0   1
0  5980  17
1   230  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520752_23.png
better model found
persisted
after epoch: 23,now: 2024-06-21 17:02:50.782935,epoch time: 0:11:08.741936,used: 5:39:35.608469,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.97958046, 'precision': 0.98237425, 'recall': 0.89703953, 'specificity': 0.89703953, 'f1': 0.9345697, 'auroc': 0.9855869, 'binary_precision': 0.98567015, 'binary_recall': 0.7952845, 'binary_specificity': 0.99879456, 'binary_f1_score': 0.8803012}
confusion matrix:
       0     1
0  42258    51
1    903  3508
---- Validation: 
scalar performance:
{'acc': 0.9667944, 'precision': 0.767716, 'recall': 0.562028, 'specificity': 0.562028, 'f1': 0.5955817, 'auroc': 0.72201717, 'binary_precision': 0.56551725, 'binary_recall': 0.12752722, 'binary_specificity': 0.99652874, 'binary_f1_score': 0.20812182}
confusion matrix:
       0   1
0  18086  63
1    561  82
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606903, 'precision': 0.7999648, 'recall': 0.5653823, 'specificity': 0.5653823, 'f1': 0.6006775, 'auroc': 0.7637094, 'binary_precision': 0.6363636, 'binary_recall': 0.13409962, 'binary_specificity': 0.996665, 'binary_f1_score': 0.221519}
confusion matrix:
      0   1
0  5977  20
1   226  35
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520752_24.png
new oracle model saved
better model found
persisted
after epoch: 24,now: 2024-06-21 17:13:49.064500,epoch time: 0:10:58.281565,used: 5:50:33.890034,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.97893834, 'precision': 0.9827399, 'recall': 0.89310205, 'specificity': 0.89310205, 'f1': 0.9322344, 'auroc': 0.9850373, 'binary_precision': 0.98721594, 'binary_recall': 0.7872678, 'binary_specificity': 0.9989363, 'binary_f1_score': 0.87597686}
confusion matrix:
       0     1
0  42261    45
1    939  3475
---- Validation: 
scalar performance:
{'acc': 0.9668476, 'precision': 0.76922995, 'recall': 0.5628056, 'specificity': 0.5628056, 'f1': 0.59673065, 'auroc': 0.71714735, 'binary_precision': 0.5684931, 'binary_recall': 0.12908243, 'binary_specificity': 0.99652874, 'binary_f1_score': 0.2103929}
confusion matrix:
       0   1
0  18086  63
1    560  83
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9603707, 'precision': 0.7929485, 'recall': 0.5615509, 'specificity': 0.5615509, 'f1': 0.59493333, 'auroc': 0.74085253, 'binary_precision': 0.6226415, 'binary_recall': 0.12643678, 'binary_specificity': 0.996665, 'binary_f1_score': 0.21019109}
confusion matrix:
      0   1
0  5977  20
1   228  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520752_25.png
better model found
persisted
after epoch: 25,now: 2024-06-21 17:24:39.905353,epoch time: 0:10:50.840853,used: 6:01:24.730887,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9808433, 'precision': 0.9803753, 'recall': 0.9061259, 'specificity': 0.9061259, 'f1': 0.9393807, 'auroc': 0.9859842, 'binary_precision': 0.97982, 'binary_recall': 0.8140009, 'binary_specificity': 0.99825084, 'binary_f1_score': 0.88924646}
confusion matrix:
       0     1
0  42232    74
1    821  3593
---- Validation: 
scalar performance:
{'acc': 0.96674114, 'precision': 0.7646375, 'recall': 0.5642506, 'specificity': 0.5642506, 'f1': 0.59842384, 'auroc': 0.74141824, 'binary_precision': 0.55921054, 'binary_recall': 0.13219285, 'binary_specificity': 0.9963083, 'binary_f1_score': 0.21383648}
confusion matrix:
       0   1
0  18082  67
1    558  85
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9603707, 'precision': 0.7852054, 'recall': 0.56888026, 'specificity': 0.56888026, 'f1': 0.6047379, 'auroc': 0.7665448, 'binary_precision': 0.60655737, 'binary_recall': 0.14176245, 'binary_specificity': 0.995998, 'binary_f1_score': 0.22981367}
confusion matrix:
      0   1
0  5973  24
1   224  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520752_26.png
early stop counter: 1
val acc:0.966741144657135, best validation acc: 0.9668475985527039, corresponding to test acc:                         0.9603707194328308 / 0.9606903195381165
after epoch: 26,now: 2024-06-21 17:35:38.984122,epoch time: 0:10:59.078769,used: 6:12:23.809656,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.98101455, 'precision': 0.98108715, 'recall': 0.9065248, 'specificity': 0.9065248, 'f1': 0.939909, 'auroc': 0.9861375, 'binary_precision': 0.9811733, 'binary_recall': 0.8146806, 'binary_specificity': 0.99836904, 'binary_f1_score': 0.8902092}
confusion matrix:
       0     1
0  42237    69
1    818  3596
---- Validation: 
scalar performance:
{'acc': 0.9669008, 'precision': 0.76635206, 'recall': 0.5718338, 'specificity': 0.5718338, 'f1': 0.60853755, 'auroc': 0.7351786, 'binary_precision': 0.56213015, 'binary_recall': 0.14774494, 'binary_specificity': 0.9959226, 'binary_f1_score': 0.23399013}
confusion matrix:
       0   1
0  18075  74
1    548  95
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614893, 'precision': 0.8104466, 'recall': 0.57862556, 'specificity': 0.57862556, 'f1': 0.61934644, 'auroc': 0.76325715, 'binary_precision': 0.65625, 'binary_recall': 0.16091955, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.25846156}
confusion matrix:
      0   1
0  5975  22
1   219  42
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520752_27.png
new oracle model saved
better model found
persisted
after epoch: 27,now: 2024-06-21 17:46:30.671750,epoch time: 0:10:51.687628,used: 6:23:15.497284,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.98125, 'precision': 0.9806438, 'recall': 0.9082781, 'specificity': 0.9082781, 'f1': 0.9407935, 'auroc': 0.987185, 'binary_precision': 0.979924, 'binary_recall': 0.8183054, 'binary_specificity': 0.99825084, 'binary_f1_score': 0.8918518}
confusion matrix:
       0     1
0  42232    74
1    802  3612
---- Validation: 
scalar performance:
{'acc': 0.96647507, 'precision': 0.7529494, 'recall': 0.57461363, 'specificity': 0.57461363, 'f1': 0.6109952, 'auroc': 0.73367554, 'binary_precision': 0.53513515, 'binary_recall': 0.15396579, 'binary_specificity': 0.99526143, 'binary_f1_score': 0.23913045}
confusion matrix:
       0   1
0  18063  86
1    544  99
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.77752817, 'recall': 0.57246155, 'specificity': 0.57246155, 'f1': 0.60905194, 'auroc': 0.7650356, 'binary_precision': 0.59090906, 'binary_recall': 0.14942528, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.23853211}
confusion matrix:
      0   1
0  5970  27
1   222  39
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520752_28.png
early stop counter: 1
val acc:0.9664750695228577, best validation acc: 0.9669008255004883, corresponding to test acc:                         0.9614893198013306 / 0.9614893198013306
after epoch: 28,now: 2024-06-21 17:58:53.454308,epoch time: 0:12:22.782558,used: 6:35:38.279842,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.98202056, 'precision': 0.9803252, 'recall': 0.9130273, 'specificity': 0.9130273, 'f1': 0.94351685, 'auroc': 0.9893074, 'binary_precision': 0.9783074, 'binary_recall': 0.8279692, 'binary_specificity': 0.99808544, 'binary_f1_score': 0.89688194}
confusion matrix:
       0     1
0  42227    81
1    759  3653
---- Validation: 
scalar performance:
{'acc': 0.96663475, 'precision': 0.75615466, 'recall': 0.5791966, 'specificity': 0.5791966, 'f1': 0.6169167, 'auroc': 0.74775004, 'binary_precision': 0.5412371, 'binary_recall': 0.16329704, 'binary_specificity': 0.99509615, 'binary_f1_score': 0.25089607}
confusion matrix:
       0    1
0  18060   89
1    538  105
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9610099, 'precision': 0.7923224, 'recall': 0.5820401, 'specificity': 0.5820401, 'f1': 0.622517, 'auroc': 0.7715729, 'binary_precision': 0.6197183, 'binary_recall': 0.16858238, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.26506025}
confusion matrix:
      0   1
0  5970  27
1   217  44
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520752_29.png
early stop counter: 2
val acc:0.9666347503662109, best validation acc: 0.9669008255004883, corresponding to test acc:                         0.9614893198013306 / 0.9614893198013306
after epoch: 29,now: 2024-06-21 18:09:57.738111,epoch time: 0:11:04.283803,used: 6:46:42.563645,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9826627, 'precision': 0.982397, 'recall': 0.91506314, 'specificity': 0.91506314, 'f1': 0.9455824, 'auroc': 0.98866844, 'binary_precision': 0.98208076, 'binary_recall': 0.8317101, 'binary_specificity': 0.99841624, 'binary_f1_score': 0.9006623}
confusion matrix:
       0     1
0  42238    67
1    743  3672
---- Validation: 
scalar performance:
{'acc': 0.9671669, 'precision': 0.77237445, 'recall': 0.57647187, 'specificity': 0.57647187, 'f1': 0.61493003, 'auroc': 0.738224, 'binary_precision': 0.5738636, 'binary_recall': 0.15707621, 'binary_specificity': 0.99586755, 'binary_f1_score': 0.24664223}
confusion matrix:
       0    1
0  18074   75
1    542  101
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9613295, 'precision': 0.8032893, 'recall': 0.5803745, 'specificity': 0.5803745, 'f1': 0.62116975, 'auroc': 0.7625531, 'binary_precision': 0.64179105, 'binary_recall': 0.16475096, 'binary_specificity': 0.995998, 'binary_f1_score': 0.2621951}
confusion matrix:
      0   1
0  5973  24
1   218  43
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520752_30.png
better model found
persisted
after epoch: 30,now: 2024-06-21 18:21:13.392217,epoch time: 0:11:15.654106,used: 6:57:58.217751,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 6:57:58.217751 at 2024-06-21 18:21:13.392217
persisted model performance metric: 

scalar performance:
{'acc': 0.9613295, 'precision': 0.8032893, 'recall': 0.5803745, 'specificity': 0.5803745, 'f1': 0.62116975, 'auroc': 0.7625531, 'binary_precision': 0.64179105, 'binary_recall': 0.16475096, 'binary_specificity': 0.995998, 'binary_f1_score': 0.2621951}
confusion matrix:
      0   1
0  5973  24
1   218  43
oracle model performance metric: 

scalar performance:
{'acc': 0.9614893, 'precision': 0.8104466, 'recall': 0.57862556, 'specificity': 0.57862556, 'f1': 0.61934644, 'auroc': 0.76325715, 'binary_precision': 0.65625, 'binary_recall': 0.16091955, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.25846156}
confusion matrix:
      0   1
0  5975  22
1   219  42
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_differentbatchsizes_lre5_classbalancing3/rule_results/3.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_differentbatchsizes_lre5_classbalancing3/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_resnet_differentbatchsizes_lre5_classbalancing3/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204097 KiB |   1730 MiB | 413333 GiB | 413333 GiB |
|       from large pool | 167936 KiB |   1660 MiB | 413266 GiB | 413266 GiB |
|       from small pool |  36161 KiB |     72 MiB |     67 GiB |     67 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 204097 KiB |   1730 MiB | 413333 GiB | 413333 GiB |
|       from large pool | 167936 KiB |   1660 MiB | 413266 GiB | 413266 GiB |
|       from small pool |  36161 KiB |     72 MiB |     67 GiB |     67 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201088 KiB |   1723 MiB | 413317 GiB | 413317 GiB |
|       from large pool | 165120 KiB |   1653 MiB | 413251 GiB | 413251 GiB |
|       from small pool |  35968 KiB |     71 MiB |     66 GiB |     66 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2270 MiB |   2270 MiB |   2270 MiB |      0 B   |
|       from large pool |   2196 MiB |   2196 MiB |   2196 MiB |      0 B   |
|       from small pool |     74 MiB |     74 MiB |     74 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 404158 KiB | 758032 KiB | 304625 GiB | 304625 GiB |
|       from large pool | 397312 KiB | 756864 KiB | 304557 GiB | 304557 GiB |
|       from small pool |   6846 KiB |  12716 KiB |     68 GiB |     68 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1194    |    1851    |   10943 K  |   10942 K  |
|       from large pool |      36    |      76    |    4351 K  |    4351 K  |
|       from small pool |    1158    |    1780    |    6592 K  |    6590 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1194    |    1851    |   10943 K  |   10942 K  |
|       from large pool |      36    |      76    |    4351 K  |    4351 K  |
|       from small pool |    1158    |    1780    |    6592 K  |    6590 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      51    |      51    |      51    |       0    |
|       from large pool |      14    |      14    |      14    |       0    |
|       from small pool |      37    |      37    |      37    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      28    |     378    |    5439 K  |    5439 K  |
|       from large pool |       5    |      10    |    1382 K  |    1382 K  |
|       from small pool |      23    |     373    |    4056 K  |    4056 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1730 MiB | 413333 GiB | 413333 GiB |
|       from large pool |  16640 KiB |   1660 MiB | 413266 GiB | 413266 GiB |
|       from small pool |      0 KiB |     72 MiB |     67 GiB |     67 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1730 MiB | 413333 GiB | 413333 GiB |
|       from large pool |  16640 KiB |   1660 MiB | 413266 GiB | 413266 GiB |
|       from small pool |      0 KiB |     72 MiB |     67 GiB |     67 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1723 MiB | 413317 GiB | 413317 GiB |
|       from large pool |  16640 KiB |   1653 MiB | 413251 GiB | 413251 GiB |
|       from small pool |      0 KiB |     71 MiB |     66 GiB |     66 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 608256 KiB |   2270 MiB |   2270 MiB |   1676 MiB |
|       from large pool | 565248 KiB |   2196 MiB |   2196 MiB |   1644 MiB |
|       from small pool |  43008 KiB |     74 MiB |     74 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 384768 KiB | 758032 KiB | 304626 GiB | 304625 GiB |
|       from large pool | 384768 KiB | 756864 KiB | 304557 GiB | 304557 GiB |
|       from small pool |      0 KiB |  14441 KiB |     68 GiB |     68 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1851    |   10943 K  |   10943 K  |
|       from large pool |       2    |      76    |    4351 K  |    4351 K  |
|       from small pool |       0    |    1780    |    6592 K  |    6592 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1851    |   10943 K  |   10943 K  |
|       from large pool |       2    |      76    |    4351 K  |    4351 K  |
|       from small pool |       0    |    1780    |    6592 K  |    6592 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      30    |      51    |      51    |      21    |
|       from large pool |       9    |      14    |      14    |       5    |
|       from small pool |      21    |      37    |      37    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     378    |    5439 K  |    5439 K  |
|       from large pool |       1    |      11    |    1382 K  |    1382 K  |
|       from small pool |       0    |     373    |    4056 K  |    4056 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1730 MiB | 413333 GiB | 413333 GiB |
|       from large pool |  16640 KiB |   1660 MiB | 413266 GiB | 413266 GiB |
|       from small pool |      0 KiB |     72 MiB |     67 GiB |     67 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1730 MiB | 413333 GiB | 413333 GiB |
|       from large pool |  16640 KiB |   1660 MiB | 413266 GiB | 413266 GiB |
|       from small pool |      0 KiB |     72 MiB |     67 GiB |     67 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1723 MiB | 413317 GiB | 413317 GiB |
|       from large pool |  16640 KiB |   1653 MiB | 413251 GiB | 413251 GiB |
|       from small pool |      0 KiB |     71 MiB |     66 GiB |     66 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 608256 KiB |   2270 MiB |   2270 MiB |   1676 MiB |
|       from large pool | 565248 KiB |   2196 MiB |   2196 MiB |   1644 MiB |
|       from small pool |  43008 KiB |     74 MiB |     74 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 384768 KiB | 758032 KiB | 304626 GiB | 304625 GiB |
|       from large pool | 384768 KiB | 756864 KiB | 304557 GiB | 304557 GiB |
|       from small pool |      0 KiB |  14441 KiB |     68 GiB |     68 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1851    |   10943 K  |   10943 K  |
|       from large pool |       2    |      76    |    4351 K  |    4351 K  |
|       from small pool |       0    |    1780    |    6592 K  |    6592 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1851    |   10943 K  |   10943 K  |
|       from large pool |       2    |      76    |    4351 K  |    4351 K  |
|       from small pool |       0    |    1780    |    6592 K  |    6592 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      30    |      51    |      51    |      21    |
|       from large pool |       9    |      14    |      14    |       5    |
|       from small pool |      21    |      37    |      37    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     378    |    5439 K  |    5439 K  |
|       from large pool |       1    |      11    |    1382 K  |    1382 K  |
|       from small pool |       0    |     373    |    4056 K  |    4056 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0




!!!: not committed yet



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_25_40_seed_1_21520752

 Experiment start at: 2024-06-21 18:25:40.476121
before training, model accuracy: 0.14631003141403198
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.90650684, 'precision': 0.45366126, 'recall': 0.49950466, 'specificity': 0.49950466, 'f1': 0.47548053, 'auroc': 0.4698677, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9990093, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  42352  42
1   4326   0
---- Validation: 
scalar performance:
{'acc': 0.96302027, 'precision': 0.48202458, 'recall': 0.4994465, 'specificity': 0.4994465, 'f1': 0.49058095, 'auroc': 0.29908293, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.998893, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18047  20
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.20259452, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520752_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-21 18:36:43.612138,epoch time: 0:11:03.136017,used: 0:11:03.136017,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_25_40_seed_1_21520752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9072132, 'precision': 0.4537037, 'recall': 0.49988207, 'specificity': 0.49988207, 'f1': 0.47567478, 'auroc': 0.58520925, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99976414, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  42385  10
1   4325   0
---- Validation: 
scalar performance:
{'acc': 0.9639808, 'precision': 0.48204184, 'recall': 0.49994466, 'specificity': 0.49994466, 'f1': 0.49083003, 'auroc': 0.31685662, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998893, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18065  2
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.21112755, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520752_2.png
better model found
persisted
after epoch: 2,now: 2024-06-21 18:49:48.833251,epoch time: 0:13:05.221113,used: 0:24:08.357130,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_25_40_seed_1_21520752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.90714896, 'precision': 0.453691, 'recall': 0.49985847, 'specificity': 0.49985847, 'f1': 0.4756571, 'auroc': 0.7144692, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99971694, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  42382  12
1   4326   0
---- Validation: 
scalar performance:
{'acc': 0.9639808, 'precision': 0.48204184, 'recall': 0.49994466, 'specificity': 0.49994466, 'f1': 0.49083003, 'auroc': 0.31703454, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998893, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18065  2
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.21940687, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520752_3.png
early stop counter: 1
val acc:0.9639807939529419, best validation acc: 0.9639807939529419, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 3,now: 2024-06-21 19:01:29.166806,epoch time: 0:11:40.333555,used: 0:35:48.690685,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_25_40_seed_1_21520752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9069777, 'precision': 0.45371222, 'recall': 0.49972877, 'specificity': 0.49972877, 'f1': 0.47561005, 'auroc': 0.80390453, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99945754, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  42374  23
1   4323   0
---- Validation: 
scalar performance:
{'acc': 0.96387404, 'precision': 0.48203993, 'recall': 0.4998893, 'specificity': 0.4998893, 'f1': 0.49080238, 'auroc': 0.36696178, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9997786, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18063  4
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.27941847, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520752_4.png
early stop counter: 2
val acc:0.9638740420341492, best validation acc: 0.9639807939529419, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 4,now: 2024-06-21 19:13:32.598623,epoch time: 0:12:03.431817,used: 0:47:52.122502,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_25_40_seed_1_21520752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9056079, 'precision': 0.54712164, 'recall': 0.50160396, 'specificity': 0.50160396, 'f1': 0.4808245, 'auroc': 0.85270894, 'binary_precision': 0.18656716, 'binary_recall': 0.0057790107, 'binary_specificity': 0.9974289, 'binary_f1_score': 0.011210763}
confusion matrix:
       0    1
0  42285  109
1   4301   25
---- Validation: 
scalar performance:
{'acc': 0.96344715, 'precision': 0.48203224, 'recall': 0.4996679, 'specificity': 0.4996679, 'f1': 0.49069163, 'auroc': 0.38480228, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9993358, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18055  12
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.2983337, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520752_5.png
early stop counter: 3
val acc:0.9634471535682678, best validation acc: 0.9639807939529419, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 5,now: 2024-06-21 19:24:30.542472,epoch time: 0:10:57.943849,used: 0:58:50.066351,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_25_40_seed_1_21520752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9111515, 'precision': 0.81236076, 'recall': 0.532046, 'specificity': 0.532046, 'f1': 0.5377161, 'auroc': 0.8917372, 'binary_precision': 0.7118227, 'binary_recall': 0.06685172, 'binary_specificity': 0.99724036, 'binary_f1_score': 0.12222456}
confusion matrix:
       0    1
0  42280  117
1   4034  289
---- Validation: 
scalar performance:
{'acc': 0.9636606, 'precision': 0.48203608, 'recall': 0.4997786, 'specificity': 0.4997786, 'f1': 0.49074703, 'auroc': 0.42341182, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9995572, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18059  8
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.3592792, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520752_6.png
early stop counter: 4
val acc:0.9636605978012085, best validation acc: 0.9639807939529419, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 6,now: 2024-06-21 19:36:11.499678,epoch time: 0:11:40.957206,used: 1:10:31.023557,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_25_40_seed_1_21520752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9172517, 'precision': 0.85973144, 'recall': 0.56904614, 'specificity': 0.56904614, 'f1': 0.5985055, 'auroc': 0.899329, 'binary_precision': 0.8002611, 'binary_recall': 0.14170134, 'binary_specificity': 0.996391, 'binary_f1_score': 0.24076983}
confusion matrix:
       0    1
0  42241  153
1   3713  613
---- Validation: 
scalar performance:
{'acc': 0.9629669, 'precision': 0.48202363, 'recall': 0.49941882, 'specificity': 0.49941882, 'f1': 0.49056706, 'auroc': 0.43478626, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99883765, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18046  21
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.36025366, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520752_7.png
early stop counter: 5
val acc:0.9629669189453125, best validation acc: 0.9639807939529419, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 7,now: 2024-06-21 19:48:53.981360,epoch time: 0:12:42.481682,used: 1:23:13.505239,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_25_40_seed_1_21520752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9286815, 'precision': 0.90437573, 'recall': 0.6312192, 'specificity': 0.6312192, 'f1': 0.68532175, 'auroc': 0.92459524, 'binary_precision': 0.8786259, 'binary_recall': 0.2661887, 'binary_specificity': 0.9962497, 'binary_f1_score': 0.4085907}
confusion matrix:
       0     1
0  42237   159
1   3173  1151
---- Validation: 
scalar performance:
{'acc': 0.96334046, 'precision': 0.48203033, 'recall': 0.49961254, 'specificity': 0.49961254, 'f1': 0.49066398, 'auroc': 0.4654104, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9992251, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18053  14
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.4256876, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520752_8.png
early stop counter: 6
val acc:0.9633404612541199, best validation acc: 0.9639807939529419, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 8,now: 2024-06-21 20:01:27.775404,epoch time: 0:12:33.794044,used: 1:35:47.299283,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_25_40_seed_1_21520752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.933583, 'precision': 0.9184707, 'recall': 0.656399, 'specificity': 0.656399, 'f1': 0.716485, 'auroc': 0.9340565, 'binary_precision': 0.90231025, 'binary_recall': 0.31628877, 'binary_specificity': 0.99650925, 'binary_f1_score': 0.46839127}
confusion matrix:
       0     1
0  42250   148
1   2955  1367
---- Validation: 
scalar performance:
{'acc': 0.9638207, 'precision': 0.48203897, 'recall': 0.49986163, 'specificity': 0.49986163, 'f1': 0.49078858, 'auroc': 0.48540735, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99972326, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18062  5
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.4710421, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520752_9.png
early stop counter: 7
val acc:0.9638206958770752, best validation acc: 0.9639807939529419, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 9,now: 2024-06-21 20:12:45.507463,epoch time: 0:11:17.732059,used: 1:47:05.031342,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_25_40_seed_1_21520752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.942744, 'precision': 0.93732023, 'recall': 0.70421493, 'specificity': 0.70421493, 'f1': 0.7700792, 'auroc': 0.9495883, 'binary_precision': 0.9314136, 'binary_recall': 0.41151977, 'binary_specificity': 0.99691015, 'binary_f1_score': 0.5708326}
confusion matrix:
       0     1
0  42266   131
1   2544  1779
---- Validation: 
scalar performance:
{'acc': 0.96392745, 'precision': 0.58206564, 'recall': 0.5006322, 'specificity': 0.5006322, 'f1': 0.49229065, 'auroc': 0.52682614, 'binary_precision': 0.2, 'binary_recall': 0.0014858841, 'binary_specificity': 0.9997786, 'binary_f1_score': 0.0029498525}
confusion matrix:
       0  1
0  18063  4
1    672  1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.5390146, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520752_10.png
early stop counter: 8
val acc:0.9639274477958679, best validation acc: 0.9639807939529419, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 10,now: 2024-06-21 20:24:20.787198,epoch time: 0:11:35.279735,used: 1:58:40.311077,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_25_40_seed_1_21520752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.94978595, 'precision': 0.9441782, 'recall': 0.7432021, 'specificity': 0.7432021, 'f1': 0.808228, 'auroc': 0.95049417, 'binary_precision': 0.93797076, 'binary_recall': 0.48970622, 'binary_specificity': 0.9966979, 'binary_f1_score': 0.64346504}
confusion matrix:
       0     1
0  42257   140
1   2206  2117
---- Validation: 
scalar performance:
{'acc': 0.96403414, 'precision': 0.68209237, 'recall': 0.50140285, 'specificity': 0.50140285, 'f1': 0.49379277, 'auroc': 0.53536725, 'binary_precision': 0.4, 'binary_recall': 0.0029717681, 'binary_specificity': 0.99983394, 'binary_f1_score': 0.005899705}
confusion matrix:
       0  1
0  18064  3
1    671  2
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.5437741, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520752_11.png
better model found
persisted
after epoch: 11,now: 2024-06-21 20:34:50.074804,epoch time: 0:10:29.287606,used: 2:09:09.598683,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_25_40_seed_1_21520752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.95473033, 'precision': 0.95706487, 'recall': 0.7656151, 'specificity': 0.7656151, 'f1': 0.83069515, 'auroc': 0.9572605, 'binary_precision': 0.9596674, 'binary_recall': 0.53351825, 'binary_specificity': 0.99771196, 'binary_f1_score': 0.6857822}
confusion matrix:
       0     1
0  42297    97
1   2018  2308
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.73214287, 'recall': 0.5028611, 'specificity': 0.5028611, 'f1': 0.49672946, 'auroc': 0.57837534, 'binary_precision': 0.5, 'binary_recall': 0.0059435363, 'binary_specificity': 0.9997786, 'binary_f1_score': 0.01174743}
confusion matrix:
       0  1
0  18063  4
1    669  4
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.6196189, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520752_12.png
better model found
persisted
after epoch: 12,now: 2024-06-21 20:47:07.874453,epoch time: 0:12:17.799649,used: 2:21:27.398332,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_25_40_seed_1_21520752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9588613, 'precision': 0.9611352, 'recall': 0.7874642, 'specificity': 0.7874642, 'f1': 0.84986025, 'auroc': 0.96263874, 'binary_precision': 0.96369255, 'binary_recall': 0.5771455, 'binary_specificity': 0.9977829, 'binary_f1_score': 0.72193295}
confusion matrix:
       0     1
0  42303    94
1   1828  2495
---- Validation: 
scalar performance:
{'acc': 0.96419424, 'precision': 0.7821944, 'recall': 0.50434697, 'specificity': 0.50434697, 'f1': 0.49966717, 'auroc': 0.6045537, 'binary_precision': 0.6, 'binary_recall': 0.008915304, 'binary_specificity': 0.9997786, 'binary_f1_score': 0.017569544}
confusion matrix:
       0  1
0  18063  4
1    667  6
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.72912633, 'recall': 0.501839, 'specificity': 0.501839, 'f1': 0.49311718, 'auroc': 0.6524826, 'binary_precision': 0.5, 'binary_recall': 0.0038461538, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.0076335873}
confusion matrix:
      0  1
0  5945  1
1   259  1
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520752_13.png
better model found
persisted
after epoch: 13,now: 2024-06-21 20:57:51.506928,epoch time: 0:10:43.632475,used: 2:32:11.030807,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_25_40_seed_1_21520752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9620077, 'precision': 0.9677886, 'recall': 0.80191517, 'specificity': 0.80191517, 'f1': 0.8631447, 'auroc': 0.9653889, 'binary_precision': 0.9743208, 'binary_recall': 0.6054579, 'binary_specificity': 0.9983725, 'binary_f1_score': 0.74682647}
confusion matrix:
       0     1
0  42327    69
1   1706  2618
---- Validation: 
scalar performance:
{'acc': 0.964461, 'precision': 0.8352891, 'recall': 0.5087769, 'specificity': 0.5087769, 'f1': 0.50833994, 'auroc': 0.6015402, 'binary_precision': 0.7058824, 'binary_recall': 0.017830608, 'binary_specificity': 0.99972326, 'binary_f1_score': 0.034782607}
confusion matrix:
       0   1
0  18062   5
1    661  12
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579439, 'precision': 0.6791969, 'recall': 0.50359386, 'specificity': 0.50359386, 'f1': 0.49680376, 'auroc': 0.63673186, 'binary_precision': 0.4, 'binary_recall': 0.0076923077, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.01509434}
confusion matrix:
      0  1
0  5943  3
1   258  2
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520752_14.png
better model found
persisted
after epoch: 14,now: 2024-06-21 21:08:32.385798,epoch time: 0:10:40.878870,used: 2:42:51.909677,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_25_40_seed_1_21520752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9640197, 'precision': 0.97450626, 'recall': 0.809374, 'specificity': 0.809374, 'f1': 0.8708322, 'auroc': 0.96812654, 'binary_precision': 0.986372, 'binary_recall': 0.61962056, 'binary_specificity': 0.9991273, 'binary_f1_score': 0.7611198}
confusion matrix:
       0     1
0  42361    37
1   1644  2678
---- Validation: 
scalar performance:
{'acc': 0.964461, 'precision': 0.80850935, 'recall': 0.51092273, 'specificity': 0.51092273, 'f1': 0.51249886, 'auroc': 0.61552095, 'binary_precision': 0.65217394, 'binary_recall': 0.022288261, 'binary_specificity': 0.9995572, 'binary_f1_score': 0.04310345}
confusion matrix:
       0   1
0  18059   8
1    658  15
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579439, 'precision': 0.6791969, 'recall': 0.50359386, 'specificity': 0.50359386, 'f1': 0.49680376, 'auroc': 0.6463311, 'binary_precision': 0.4, 'binary_recall': 0.0076923077, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.01509434}
confusion matrix:
      0  1
0  5943  3
1   258  2
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520752_15.png
early stop counter: 1
val acc:0.9644610285758972, best validation acc: 0.9644610285758972, corresponding to test acc:                         0.9579439163208008 / 0.9581050872802734
after epoch: 15,now: 2024-06-21 21:18:58.396607,epoch time: 0:10:26.010809,used: 2:53:17.920486,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_25_40_seed_1_21520752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9665454, 'precision': 0.97625124, 'recall': 0.82304364, 'specificity': 0.82304364, 'f1': 0.8817792, 'auroc': 0.9703089, 'binary_precision': 0.9872971, 'binary_recall': 0.6469364, 'binary_specificity': 0.9991509, 'binary_f1_score': 0.7816735}
confusion matrix:
       0     1
0  42359    36
1   1527  2798
---- Validation: 
scalar performance:
{'acc': 0.9645678, 'precision': 0.80075514, 'recall': 0.5152697, 'specificity': 0.5152697, 'f1': 0.5207169, 'auroc': 0.6340662, 'binary_precision': 0.6363636, 'binary_recall': 0.031203566, 'binary_specificity': 0.9993358, 'binary_f1_score': 0.059490085}
confusion matrix:
       0   1
0  18055  12
1    652  21
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579439, 'precision': 0.6791969, 'recall': 0.50359386, 'specificity': 0.50359386, 'f1': 0.49680376, 'auroc': 0.68349314, 'binary_precision': 0.4, 'binary_recall': 0.0076923077, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.01509434}
confusion matrix:
      0  1
0  5943  3
1   258  2
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520752_16.png
better model found
persisted
after epoch: 16,now: 2024-06-21 21:29:30.002381,epoch time: 0:10:31.605774,used: 3:03:49.526260,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_25_40_seed_1_21520752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.96956336, 'precision': 0.977192, 'recall': 0.8399671, 'specificity': 0.8399671, 'f1': 0.8945074, 'auroc': 0.97196925, 'binary_precision': 0.9859391, 'binary_recall': 0.68092483, 'binary_specificity': 0.9990093, 'binary_f1_score': 0.8055252}
confusion matrix:
       0     1
0  42353    42
1   1380  2945
---- Validation: 
scalar performance:
{'acc': 0.9647812, 'precision': 0.7899432, 'recall': 0.52539414, 'specificity': 0.52539414, 'f1': 0.5389656, 'auroc': 0.6430672, 'binary_precision': 0.61403507, 'binary_recall': 0.052005943, 'binary_specificity': 0.99878234, 'binary_f1_score': 0.0958904}
confusion matrix:
       0   1
0  18045  22
1    638  35
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579439, 'precision': 0.69355655, 'recall': 0.5054329, 'specificity': 0.5054329, 'f1': 0.5004908, 'auroc': 0.6785395, 'binary_precision': 0.42857143, 'binary_recall': 0.011538462, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.02247191}
confusion matrix:
      0  1
0  5942  4
1   257  3
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520752_17.png
better model found
persisted
after epoch: 17,now: 2024-06-21 21:39:52.555225,epoch time: 0:10:22.552844,used: 3:14:12.079104,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_25_40_seed_1_21520752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9726027, 'precision': 0.9786494, 'recall': 0.85659564, 'specificity': 0.85659564, 'f1': 0.906697, 'auroc': 0.9751526, 'binary_precision': 0.9856322, 'binary_recall': 0.71425265, 'binary_specificity': 0.9989386, 'binary_f1_score': 0.8282801}
confusion matrix:
       0     1
0  42353    45
1   1235  3087
---- Validation: 
scalar performance:
{'acc': 0.96510136, 'precision': 0.7919476, 'recall': 0.53628916, 'specificity': 0.53628916, 'f1': 0.55740917, 'auroc': 0.66744345, 'binary_precision': 0.61728394, 'binary_recall': 0.0742942, 'binary_specificity': 0.99828416, 'binary_f1_score': 0.132626}
confusion matrix:
       0   1
0  18036  31
1    623  50
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9574605, 'precision': 0.6579803, 'recall': 0.50885856, 'specificity': 0.50885856, 'f1': 0.5073733, 'auroc': 0.70582163, 'binary_precision': 0.35714287, 'binary_recall': 0.01923077, 'binary_specificity': 0.9984864, 'binary_f1_score': 0.036496352}
confusion matrix:
      0  1
0  5937  9
1   255  5
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520752_18.png
better model found
persisted
after epoch: 18,now: 2024-06-21 21:50:20.416226,epoch time: 0:10:27.861001,used: 3:24:39.940105,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_25_40_seed_1_21520752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9734375, 'precision': 0.9787528, 'recall': 0.8615148, 'specificity': 0.8615148, 'f1': 0.91010123, 'auroc': 0.97678906, 'binary_precision': 0.98490566, 'binary_recall': 0.72416186, 'binary_specificity': 0.9988678, 'binary_f1_score': 0.8346436}
confusion matrix:
       0     1
0  42347    48
1   1193  3132
---- Validation: 
scalar performance:
{'acc': 0.9653682, 'precision': 0.80164206, 'recall': 0.54071915, 'specificity': 0.54071915, 'f1': 0.56475, 'auroc': 0.6908283, 'binary_precision': 0.6363636, 'binary_recall': 0.08320951, 'binary_specificity': 0.9982288, 'binary_f1_score': 0.14717476}
confusion matrix:
       0   1
0  18035  32
1    617  56
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582662, 'precision': 0.7488045, 'recall': 0.512957, 'specificity': 0.512957, 'f1': 0.514973, 'auroc': 0.74543905, 'binary_precision': 0.53846157, 'binary_recall': 0.026923077, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.051282056}
confusion matrix:
      0  1
0  5940  6
1   253  7
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520752_19.png
new oracle model saved
better model found
persisted
after epoch: 19,now: 2024-06-21 22:00:52.781499,epoch time: 0:10:32.365273,used: 3:35:12.305378,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_25_40_seed_1_21520752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.97461474, 'precision': 0.9793531, 'recall': 0.8679162, 'specificity': 0.8679162, 'f1': 0.9146353, 'auroc': 0.9796132, 'binary_precision': 0.98485315, 'binary_recall': 0.7369882, 'binary_specificity': 0.99884427, 'binary_f1_score': 0.84308016}
confusion matrix:
       0     1
0  42348    49
1   1137  3186
---- Validation: 
scalar performance:
{'acc': 0.96542156, 'precision': 0.80530024, 'recall': 0.5407468, 'specificity': 0.5407468, 'f1': 0.56486064, 'auroc': 0.6818018, 'binary_precision': 0.6436782, 'binary_recall': 0.08320951, 'binary_specificity': 0.99828416, 'binary_f1_score': 0.14736842}
confusion matrix:
       0   1
0  18036  31
1    617  56
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587496, 'precision': 0.7799548, 'recall': 0.5224042, 'specificity': 0.5224042, 'f1': 0.53230655, 'auroc': 0.72488487, 'binary_precision': 0.6, 'binary_recall': 0.046153847, 'binary_specificity': 0.99865454, 'binary_f1_score': 0.08571429}
confusion matrix:
      0   1
0  5938   8
1   248  12
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520752_20.png
new oracle model saved
better model found
persisted
after epoch: 20,now: 2024-06-21 22:11:15.067015,epoch time: 0:10:22.285516,used: 3:45:34.590894,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_25_40_seed_1_21520752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9736729, 'precision': 0.98161554, 'recall': 0.86074984, 'specificity': 0.86074984, 'f1': 0.9105607, 'auroc': 0.9804331, 'binary_precision': 0.99079657, 'binary_recall': 0.72218364, 'binary_specificity': 0.999316, 'binary_f1_score': 0.83542943}
confusion matrix:
       0     1
0  42368    29
1   1201  3122
---- Validation: 
scalar performance:
{'acc': 0.965635, 'precision': 0.8275454, 'recall': 0.5387117, 'specificity': 0.5387117, 'f1': 0.56189996, 'auroc': 0.67347634, 'binary_precision': 0.6883117, 'binary_recall': 0.078751855, 'binary_specificity': 0.9986716, 'binary_f1_score': 0.14133333}
confusion matrix:
       0   1
0  18043  24
1    620  53
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582662, 'precision': 0.74295425, 'recall': 0.518474, 'specificity': 0.518474, 'f1': 0.5251689, 'auroc': 0.7142722, 'binary_precision': 0.5263158, 'binary_recall': 0.03846154, 'binary_specificity': 0.9984864, 'binary_f1_score': 0.071684584}
confusion matrix:
      0   1
0  5937   9
1   250  10
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520752_21.png
better model found
persisted
after epoch: 21,now: 2024-06-21 22:21:39.730028,epoch time: 0:10:24.663013,used: 3:55:59.253907,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_25_40_seed_1_21520752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.97639126, 'precision': 0.97846174, 'recall': 0.87904626, 'specificity': 0.87904626, 'f1': 0.9216572, 'auroc': 0.98183334, 'binary_precision': 0.9808784, 'binary_recall': 0.759602, 'binary_specificity': 0.9984905, 'binary_f1_score': 0.8561742}
confusion matrix:
       0     1
0  42334    64
1   1039  3283
---- Validation: 
scalar performance:
{'acc': 0.96515477, 'precision': 0.7754744, 'recall': 0.55062217, 'specificity': 0.55062217, 'f1': 0.57937276, 'auroc': 0.7132119, 'binary_precision': 0.5833333, 'binary_recall': 0.104011886, 'binary_specificity': 0.9972325, 'binary_f1_score': 0.17654476}
confusion matrix:
       0   1
0  18017  50
1    603  70
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96100545, 'precision': 0.8715936, 'recall': 0.5474883, 'specificity': 0.5474883, 'f1': 0.5756329, 'auroc': 0.7618549, 'binary_precision': 0.78125, 'binary_recall': 0.09615385, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.17123288}
confusion matrix:
      0   1
0  5939   7
1   235  25
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520752_22.png
new oracle model saved
early stop counter: 1
val acc:0.965154767036438, best validation acc: 0.9656350016593933, corresponding to test acc:                         0.9582661986351013 / 0.961005449295044
after epoch: 22,now: 2024-06-21 22:32:06.272385,epoch time: 0:10:26.542357,used: 4:06:25.796264,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_25_40_seed_1_21520752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9747431, 'precision': 0.98125625, 'recall': 0.86732113, 'specificity': 0.86732113, 'f1': 0.9149028, 'auroc': 0.9811232, 'binary_precision': 0.98880947, 'binary_recall': 0.73549134, 'binary_specificity': 0.9991509, 'binary_f1_score': 0.84354275}
confusion matrix:
       0     1
0  42359    36
1   1144  3181
---- Validation: 
scalar performance:
{'acc': 0.96542156, 'precision': 0.8069655, 'recall': 0.54003155, 'specificity': 0.54003155, 'f1': 0.5637363, 'auroc': 0.6840907, 'binary_precision': 0.64705884, 'binary_recall': 0.08172362, 'binary_specificity': 0.99833953, 'binary_f1_score': 0.14511873}
confusion matrix:
       0   1
0  18037  30
1    618  55
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589107, 'precision': 0.7957474, 'recall': 0.5224883, 'specificity': 0.5224883, 'f1': 0.53250223, 'auroc': 0.7257277, 'binary_precision': 0.6315789, 'binary_recall': 0.046153847, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.086021505}
confusion matrix:
      0   1
0  5939   7
1   248  12
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520752_23.png
early stop counter: 2
val acc:0.9654215574264526, best validation acc: 0.9656350016593933, corresponding to test acc:                         0.9582661986351013 / 0.961005449295044
after epoch: 23,now: 2024-06-21 22:42:21.380788,epoch time: 0:10:15.108403,used: 4:16:40.904667,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_25_40_seed_1_21520752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9780394, 'precision': 0.98418266, 'recall': 0.8843446, 'specificity': 0.8843446, 'f1': 0.9272041, 'auroc': 0.98423886, 'binary_precision': 0.9913562, 'binary_recall': 0.7693731, 'binary_specificity': 0.999316, 'binary_f1_score': 0.86637145}
confusion matrix:
       0     1
0  42368    29
1    997  3326
---- Validation: 
scalar performance:
{'acc': 0.9657951, 'precision': 0.8028841, 'recall': 0.55381536, 'specificity': 0.55381536, 'f1': 0.58505446, 'auroc': 0.7042845, 'binary_precision': 0.63793105, 'binary_recall': 0.10995542, 'binary_specificity': 0.9976753, 'binary_f1_score': 0.1875792}
confusion matrix:
       0   1
0  18025  42
1    599  74
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96003866, 'precision': 0.81903565, 'recall': 0.54330575, 'specificity': 0.54330575, 'f1': 0.5679986, 'auroc': 0.7403368, 'binary_precision': 0.6764706, 'binary_recall': 0.08846154, 'binary_specificity': 0.99815, 'binary_f1_score': 0.1564626}
confusion matrix:
      0   1
0  5935  11
1   237  23
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520752_24.png
better model found
persisted
after epoch: 24,now: 2024-06-21 22:52:38.102757,epoch time: 0:10:16.721969,used: 4:26:57.626636,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_25_40_seed_1_21520752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.97778255, 'precision': 0.9813473, 'recall': 0.88503397, 'specificity': 0.88503397, 'f1': 0.9265963, 'auroc': 0.9813214, 'binary_precision': 0.98551583, 'binary_recall': 0.77122366, 'binary_specificity': 0.99884427, 'binary_f1_score': 0.86529976}
confusion matrix:
       0     1
0  42348    49
1    989  3334
---- Validation: 
scalar performance:
{'acc': 0.96574175, 'precision': 0.7899498, 'recall': 0.56165564, 'specificity': 0.56165564, 'f1': 0.59592557, 'auroc': 0.7217367, 'binary_precision': 0.6115108, 'binary_recall': 0.12630014, 'binary_specificity': 0.9970111, 'binary_f1_score': 0.2093596}
confusion matrix:
       0   1
0  18013  54
1    588  85
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96052206, 'precision': 0.827263, 'recall': 0.550914, 'specificity': 0.550914, 'f1': 0.5801879, 'auroc': 0.75618446, 'binary_precision': 0.6923077, 'binary_recall': 0.103846155, 'binary_specificity': 0.99798185, 'binary_f1_score': 0.18060201}
confusion matrix:
      0   1
0  5934  12
1   233  27
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520752_25.png
early stop counter: 1
val acc:0.965741753578186, best validation acc: 0.96579509973526, corresponding to test acc:                         0.9600386619567871 / 0.961005449295044
after epoch: 25,now: 2024-06-21 23:02:49.716519,epoch time: 0:10:11.613762,used: 4:37:09.240398,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_25_40_seed_1_21520752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9801584, 'precision': 0.98360443, 'recall': 0.8972727, 'specificity': 0.8972727, 'f1': 0.93521756, 'auroc': 0.98514974, 'binary_precision': 0.9876543, 'binary_recall': 0.79555964, 'binary_specificity': 0.99898577, 'binary_f1_score': 0.8812604}
confusion matrix:
       0     1
0  42353    43
1    884  3440
---- Validation: 
scalar performance:
{'acc': 0.9657951, 'precision': 0.795633, 'recall': 0.5588222, 'specificity': 0.5588222, 'f1': 0.5921333, 'auroc': 0.7194802, 'binary_precision': 0.6230769, 'binary_recall': 0.12035661, 'binary_specificity': 0.99728787, 'binary_f1_score': 0.20174347}
confusion matrix:
       0   1
0  18018  49
1    592  81
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96036094, 'precision': 0.8186061, 'recall': 0.5508299, 'specificity': 0.5508299, 'f1': 0.5798448, 'auroc': 0.7497536, 'binary_precision': 0.675, 'binary_recall': 0.103846155, 'binary_specificity': 0.99781364, 'binary_f1_score': 0.18}
confusion matrix:
      0   1
0  5933  13
1   233  27
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520752_26.png
early stop counter: 2
val acc:0.96579509973526, best validation acc: 0.96579509973526, corresponding to test acc:                         0.9600386619567871 / 0.961005449295044
after epoch: 26,now: 2024-06-21 23:12:57.451026,epoch time: 0:10:07.734507,used: 4:47:16.974905,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_25_40_seed_1_21520752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9794521, 'precision': 0.9807311, 'recall': 0.8954778, 'specificity': 0.8954778, 'f1': 0.9329816, 'auroc': 0.98446786, 'binary_precision': 0.98223495, 'binary_recall': 0.79241794, 'binary_specificity': 0.99853754, 'binary_f1_score': 0.877175}
confusion matrix:
       0     1
0  42332    62
1    898  3428
---- Validation: 
scalar performance:
{'acc': 0.96568835, 'precision': 0.7818888, 'recall': 0.56806535, 'specificity': 0.56806535, 'f1': 0.60434437, 'auroc': 0.7324614, 'binary_precision': 0.5949367, 'binary_recall': 0.1396731, 'binary_specificity': 0.99645764, 'binary_f1_score': 0.22623344}
confusion matrix:
       0   1
0  18003  64
1    579  94
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96100545, 'precision': 0.8182577, 'recall': 0.56587815, 'specificity': 0.56587815, 'f1': 0.60217947, 'auroc': 0.7694208, 'binary_precision': 0.6730769, 'binary_recall': 0.13461539, 'binary_specificity': 0.99714094, 'binary_f1_score': 0.22435899}
confusion matrix:
      0   1
0  5929  17
1   225  35
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520752_27.png
early stop counter: 3
val acc:0.9656883478164673, best validation acc: 0.96579509973526, corresponding to test acc:                         0.9600386619567871 / 0.961005449295044
after epoch: 27,now: 2024-06-21 23:23:14.176098,epoch time: 0:10:16.725072,used: 4:57:33.699977,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_25_40_seed_1_21520752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.97953767, 'precision': 0.9774099, 'recall': 0.89869595, 'specificity': 0.89869595, 'f1': 0.93367696, 'auroc': 0.9833703, 'binary_precision': 0.9749013, 'binary_recall': 0.7994912, 'binary_specificity': 0.9979007, 'binary_f1_score': 0.87852603}
confusion matrix:
       0     1
0  42307    89
1    867  3457
---- Validation: 
scalar performance:
{'acc': 0.9659018, 'precision': 0.7863792, 'recall': 0.57175237, 'specificity': 0.57175237, 'f1': 0.60956025, 'auroc': 0.7483436, 'binary_precision': 0.60365856, 'binary_recall': 0.14710252, 'binary_specificity': 0.99640226, 'binary_f1_score': 0.23655912}
confusion matrix:
       0   1
0  18002  65
1    574  99
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96165, 'precision': 0.8238502, 'recall': 0.57724845, 'specificity': 0.57724845, 'f1': 0.6182838, 'auroc': 0.77764434, 'binary_precision': 0.68333334, 'binary_recall': 0.15769231, 'binary_specificity': 0.9968046, 'binary_f1_score': 0.25625}
confusion matrix:
      0   1
0  5927  19
1   219  41
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520752_28.png
new oracle model saved
better model found
persisted
after epoch: 28,now: 2024-06-21 23:33:29.716756,epoch time: 0:10:15.540658,used: 5:07:49.240635,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_25_40_seed_1_21520752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.98065066, 'precision': 0.9821311, 'recall': 0.9014087, 'specificity': 0.9014087, 'f1': 0.937212, 'auroc': 0.9847431, 'binary_precision': 0.9838755, 'binary_recall': 0.80416185, 'binary_specificity': 0.9986555, 'binary_f1_score': 0.8849873}
confusion matrix:
       0     1
0  42338    57
1    847  3478
---- Validation: 
scalar performance:
{'acc': 0.9659018, 'precision': 0.78961855, 'recall': 0.56817603, 'specificity': 0.56817603, 'f1': 0.6049469, 'auroc': 0.7370508, 'binary_precision': 0.6103896, 'binary_recall': 0.1396731, 'binary_specificity': 0.996679, 'binary_f1_score': 0.22732767}
confusion matrix:
       0   1
0  18007  60
1    579  94
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96165, 'precision': 0.84631443, 'recall': 0.5662145, 'specificity': 0.5662145, 'f1': 0.6038049, 'auroc': 0.7683648, 'binary_precision': 0.7291667, 'binary_recall': 0.13461539, 'binary_specificity': 0.99781364, 'binary_f1_score': 0.22727273}
confusion matrix:
      0   1
0  5933  13
1   225  35
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520752_29.png
early stop counter: 1
val acc:0.965901792049408, best validation acc: 0.965901792049408, corresponding to test acc:                         0.961650013923645 / 0.961650013923645
after epoch: 29,now: 2024-06-21 23:43:44.248196,epoch time: 0:10:14.531440,used: 5:18:03.772075,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_25_40_seed_1_21520752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9814854, 'precision': 0.98252976, 'recall': 0.9059348, 'specificity': 0.9059348, 'f1': 0.9401489, 'auroc': 0.9878839, 'binary_precision': 0.9837626, 'binary_recall': 0.81323767, 'binary_specificity': 0.998632, 'binary_f1_score': 0.8904092}
confusion matrix:
       0     1
0  42341    58
1    807  3514
---- Validation: 
scalar performance:
{'acc': 0.9659018, 'precision': 0.78961855, 'recall': 0.56817603, 'specificity': 0.56817603, 'f1': 0.6049469, 'auroc': 0.7359639, 'binary_precision': 0.6103896, 'binary_recall': 0.1396731, 'binary_specificity': 0.996679, 'binary_f1_score': 0.22732767}
confusion matrix:
       0   1
0  18007  60
1    579  94
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9618111, 'precision': 0.8365809, 'recall': 0.57365453, 'specificity': 0.57365453, 'f1': 0.6140137, 'auroc': 0.7596666, 'binary_precision': 0.7090909, 'binary_recall': 0.15, 'binary_specificity': 0.9973091, 'binary_f1_score': 0.24761905}
confusion matrix:
      0   1
0  5930  16
1   221  39
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520752_30.png
new oracle model saved
early stop counter: 2
val acc:0.965901792049408, best validation acc: 0.965901792049408, corresponding to test acc:                         0.961650013923645 / 0.9618111252784729
after epoch: 30,now: 2024-06-21 23:53:53.932826,epoch time: 0:10:09.684630,used: 5:28:13.456705,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_25_40_seed_1_21520752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 5:28:13.456705 at 2024-06-21 23:53:53.932826
persisted model performance metric: 

scalar performance:
{'acc': 0.96165, 'precision': 0.8238502, 'recall': 0.57724845, 'specificity': 0.57724845, 'f1': 0.6182838, 'auroc': 0.77764434, 'binary_precision': 0.68333334, 'binary_recall': 0.15769231, 'binary_specificity': 0.9968046, 'binary_f1_score': 0.25625}
confusion matrix:
      0   1
0  5927  19
1   219  41
oracle model performance metric: 

scalar performance:
{'acc': 0.9618111, 'precision': 0.8365809, 'recall': 0.57365453, 'specificity': 0.57365453, 'f1': 0.6140137, 'auroc': 0.7596666, 'binary_precision': 0.7090909, 'binary_recall': 0.15, 'binary_specificity': 0.9973091, 'binary_f1_score': 0.24761905}
confusion matrix:
      0   1
0  5930  16
1   221  39
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_differentbatchsizes_lre5_classbalancing3/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_resnet_differentbatchsizes_lre5_classbalancing3/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204094 KiB |   1730 MiB |    806 TiB |    806 TiB |
|       from large pool | 167936 KiB |   1660 MiB |    806 TiB |    806 TiB |
|       from small pool |  36158 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 204094 KiB |   1730 MiB |    806 TiB |    806 TiB |
|       from large pool | 167936 KiB |   1660 MiB |    806 TiB |    806 TiB |
|       from small pool |  36158 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201086 KiB |   1723 MiB |    806 TiB |    806 TiB |
|       from large pool | 165120 KiB |   1653 MiB |    806 TiB |    806 TiB |
|       from small pool |  35966 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2196 MiB |   2270 MiB |   3872 MiB |   1676 MiB |
|       from large pool |   2122 MiB |   2196 MiB |   3766 MiB |   1644 MiB |
|       from small pool |     74 MiB |     74 MiB |    106 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 404161 KiB |    900 MiB | 631645 GiB | 631645 GiB |
|       from large pool | 397312 KiB |    899 MiB | 631509 GiB | 631509 GiB |
|       from small pool |   6849 KiB |     14 MiB |    136 GiB |    136 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1194    |    1851    |   21888 K  |   21887 K  |
|       from large pool |      36    |      76    |    8702 K  |    8702 K  |
|       from small pool |    1158    |    1780    |   13185 K  |   13184 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1194    |    1851    |   21888 K  |   21887 K  |
|       from large pool |      36    |      76    |    8702 K  |    8702 K  |
|       from small pool |    1158    |    1780    |   13185 K  |   13184 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      50    |      51    |      71    |      21    |
|       from large pool |      13    |      14    |      18    |       5    |
|       from small pool |      37    |      37    |      53    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      34    |     380    |   11174 K  |   11174 K  |
|       from large pool |       5    |      11    |    2911 K  |    2911 K  |
|       from small pool |      29    |     375    |    8263 K  |    8263 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1730 MiB |    806 TiB |    806 TiB |
|       from large pool |  16640 KiB |   1660 MiB |    806 TiB |    806 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1730 MiB |    806 TiB |    806 TiB |
|       from large pool |  16640 KiB |   1660 MiB |    806 TiB |    806 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1723 MiB |    806 TiB |    806 TiB |
|       from large pool |  16640 KiB |   1653 MiB |    806 TiB |    806 TiB |
|       from small pool |      0 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 608256 KiB |   2270 MiB |   3872 MiB |   3278 MiB |
|       from large pool | 565248 KiB |   2196 MiB |   3766 MiB |   3214 MiB |
|       from small pool |  43008 KiB |     74 MiB |    106 MiB |     64 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 384768 KiB |    900 MiB | 631645 GiB | 631645 GiB |
|       from large pool | 384768 KiB |    899 MiB | 631509 GiB | 631509 GiB |
|       from small pool |      0 KiB |     14 MiB |    136 GiB |    136 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1851    |   21888 K  |   21888 K  |
|       from large pool |       2    |      76    |    8702 K  |    8702 K  |
|       from small pool |       0    |    1780    |   13185 K  |   13185 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1851    |   21888 K  |   21888 K  |
|       from large pool |       2    |      76    |    8702 K  |    8702 K  |
|       from small pool |       0    |    1780    |   13185 K  |   13185 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      30    |      51    |      71    |      41    |
|       from large pool |       9    |      14    |      18    |       9    |
|       from small pool |      21    |      37    |      53    |      32    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     380    |   11174 K  |   11174 K  |
|       from large pool |       1    |      11    |    2911 K  |    2911 K  |
|       from small pool |       0    |     375    |    8263 K  |    8263 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1730 MiB |    806 TiB |    806 TiB |
|       from large pool |  16640 KiB |   1660 MiB |    806 TiB |    806 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1730 MiB |    806 TiB |    806 TiB |
|       from large pool |  16640 KiB |   1660 MiB |    806 TiB |    806 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1723 MiB |    806 TiB |    806 TiB |
|       from large pool |  16640 KiB |   1653 MiB |    806 TiB |    806 TiB |
|       from small pool |      0 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 608256 KiB |   2270 MiB |   3872 MiB |   3278 MiB |
|       from large pool | 565248 KiB |   2196 MiB |   3766 MiB |   3214 MiB |
|       from small pool |  43008 KiB |     74 MiB |    106 MiB |     64 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 384768 KiB |    900 MiB | 631645 GiB | 631645 GiB |
|       from large pool | 384768 KiB |    899 MiB | 631509 GiB | 631509 GiB |
|       from small pool |      0 KiB |     14 MiB |    136 GiB |    136 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1851    |   21888 K  |   21888 K  |
|       from large pool |       2    |      76    |    8702 K  |    8702 K  |
|       from small pool |       0    |    1780    |   13185 K  |   13185 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1851    |   21888 K  |   21888 K  |
|       from large pool |       2    |      76    |    8702 K  |    8702 K  |
|       from small pool |       0    |    1780    |   13185 K  |   13185 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      30    |      51    |      71    |      41    |
|       from large pool |       9    |      14    |      18    |       9    |
|       from small pool |      21    |      37    |      53    |      32    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     380    |   11174 K  |   11174 K  |
|       from large pool |       1    |      11    |    2911 K  |    2911 K  |
|       from small pool |       0    |     375    |    8263 K  |    8263 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0




!!!: not committed yet



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_58_15_seed_2_21520752

 Experiment start at: 2024-06-21 23:58:15.325386
before training, model accuracy: 0.0544959120452404
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9031335, 'precision': 0.45156676, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.47455078, 'auroc': 0.49868673, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42310  0
1   4538  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.31639564, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.24011317, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520752_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-22 00:08:31.423560,epoch time: 0:10:16.098174,used: 0:10:16.098174,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_58_15_seed_2_21520752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9031122, 'precision': 0.4515561, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4745449, 'auroc': 0.6282886, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42309  0
1   4539  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.35029465, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.28774995, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520752_2.png
early stop counter: 1
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 2,now: 2024-06-22 00:18:39.449448,epoch time: 0:10:08.025888,used: 0:20:24.124062,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_58_15_seed_2_21520752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9031122, 'precision': 0.4515561, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4745449, 'auroc': 0.75941545, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42309  0
1   4539  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.374986, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.31519753, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520752_3.png
early stop counter: 2
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 3,now: 2024-06-22 00:28:53.650563,epoch time: 0:10:14.201115,used: 0:30:38.325177,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_58_15_seed_2_21520752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9031549, 'precision': 0.9515754, 'recall': 0.5002203, 'specificity': 0.5002203, 'f1': 0.47499594, 'auroc': 0.8273729, 'binary_precision': 1.0, 'binary_recall': 0.00044062568, 'binary_specificity': 1.0, 'binary_f1_score': 0.0008808632}
confusion matrix:
       0  1
0  42309  0
1   4537  2
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.41535565, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.3708914, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520752_4.png
early stop counter: 3
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 4,now: 2024-06-22 00:39:08.607073,epoch time: 0:10:14.956510,used: 0:40:53.281687,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_58_15_seed_2_21520752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.906314, 'precision': 0.9530076, 'recall': 0.5164169, 'specificity': 0.5164169, 'f1': 0.5071352, 'auroc': 0.8800353, 'binary_precision': 1.0, 'binary_recall': 0.03283385, 'binary_specificity': 1.0, 'binary_f1_score': 0.06358012}
confusion matrix:
       0    1
0  42310    0
1   4389  149
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.45000482, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.44646776, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520752_5.png
early stop counter: 4
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 5,now: 2024-06-22 00:49:21.554142,epoch time: 0:10:12.947069,used: 0:51:06.228756,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_58_15_seed_2_21520752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.91530055, 'precision': 0.9545549, 'recall': 0.56319433, 'specificity': 0.56319433, 'f1': 0.5897992, 'auroc': 0.9111987, 'binary_precision': 0.9948007, 'binary_recall': 0.12645957, 'binary_specificity': 0.9999291, 'binary_f1_score': 0.22439405}
confusion matrix:
       0    1
0  42306    3
1   3965  574
---- Validation: 
scalar performance:
{'acc': 0.9677196, 'precision': 0.48396292, 'recall': 0.49988994, 'specificity': 0.49988994, 'f1': 0.4917975, 'auroc': 0.47886953, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9997799, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18167  4
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96105146, 'precision': 0.48060277, 'recall': 0.4999166, 'specificity': 0.4999166, 'f1': 0.49006948, 'auroc': 0.47888547, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5996  1
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520752_6.png
early stop counter: 5
val acc:0.9677196145057678, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 6,now: 2024-06-22 00:59:34.158625,epoch time: 0:10:12.604483,used: 1:01:18.833239,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_58_15_seed_2_21520752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.92266476, 'precision': 0.95686203, 'recall': 0.60159165, 'specificity': 0.60159165, 'f1': 0.64823717, 'auroc': 0.9209689, 'binary_precision': 0.9924731, 'binary_recall': 0.20334876, 'binary_specificity': 0.99983454, 'binary_f1_score': 0.33753884}
confusion matrix:
       0    1
0  42302    7
1   3616  923
---- Validation: 
scalar performance:
{'acc': 0.9676663, 'precision': 0.48396206, 'recall': 0.49986243, 'specificity': 0.49986243, 'f1': 0.49178377, 'auroc': 0.4889257, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99972486, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18166  5
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96105146, 'precision': 0.48060277, 'recall': 0.4999166, 'specificity': 0.4999166, 'f1': 0.49006948, 'auroc': 0.4908005, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5996  1
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520752_7.png
early stop counter: 6
val acc:0.9676663279533386, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 7,now: 2024-06-22 01:09:46.709776,epoch time: 0:10:12.551151,used: 1:11:31.384390,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_58_15_seed_2_21520752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9358564, 'precision': 0.96219075, 'recall': 0.67045504, 'specificity': 0.67045504, 'f1': 0.7366564, 'auroc': 0.93231463, 'binary_precision': 0.9904092, 'binary_recall': 0.3412646, 'binary_specificity': 0.9996455, 'binary_f1_score': 0.5076192}
confusion matrix:
       0     1
0  42294    15
1   2990  1549
---- Validation: 
scalar performance:
{'acc': 0.9674, 'precision': 0.4839578, 'recall': 0.49972484, 'specificity': 0.49972484, 'f1': 0.49171495, 'auroc': 0.5281594, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9994497, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18161  10
1    602   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96105146, 'precision': 0.48060277, 'recall': 0.4999166, 'specificity': 0.4999166, 'f1': 0.49006948, 'auroc': 0.5638791, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5996  1
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520752_8.png
early stop counter: 7
val acc:0.9674000144004822, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 8,now: 2024-06-22 01:19:56.275886,epoch time: 0:10:09.566110,used: 1:21:40.950500,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_58_15_seed_2_21520752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9435408, 'precision': 0.96560484, 'recall': 0.71053934, 'specificity': 0.71053934, 'f1': 0.7804647, 'auroc': 0.94730484, 'binary_precision': 0.9896534, 'binary_recall': 0.42155135, 'binary_specificity': 0.9995273, 'binary_f1_score': 0.5912533}
confusion matrix:
       0     1
0  42290    20
1   2625  1913
---- Validation: 
scalar performance:
{'acc': 0.96729344, 'precision': 0.48395607, 'recall': 0.4996698, 'specificity': 0.4996698, 'f1': 0.49168742, 'auroc': 0.55946517, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9993396, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18159  12
1    602   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96105146, 'precision': 0.48060277, 'recall': 0.4999166, 'specificity': 0.4999166, 'f1': 0.49006948, 'auroc': 0.5956959, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5996  1
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520752_9.png
early stop counter: 8
val acc:0.9672934412956238, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 9,now: 2024-06-22 01:30:12.240134,epoch time: 0:10:15.964248,used: 1:31:56.914748,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_58_15_seed_2_21520752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.94776726, 'precision': 0.9686128, 'recall': 0.7322173, 'specificity': 0.7322173, 'f1': 0.8024256, 'auroc': 0.9462993, 'binary_precision': 0.9915413, 'binary_recall': 0.4648601, 'binary_specificity': 0.99957454, 'binary_f1_score': 0.63296837}
confusion matrix:
       0     1
0  42291    18
1   2429  2110
---- Validation: 
scalar performance:
{'acc': 0.9671869, 'precision': 0.48395437, 'recall': 0.49961478, 'specificity': 0.49961478, 'f1': 0.4916599, 'auroc': 0.5533227, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99922955, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18157  14
1    602   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608912, 'precision': 0.48059964, 'recall': 0.49983326, 'specificity': 0.49983326, 'f1': 0.49002782, 'auroc': 0.5883403, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5995  2
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520752_10.png
early stop counter: 9
val acc:0.9671869277954102, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 10,now: 2024-06-22 01:40:25.022554,epoch time: 0:10:12.782420,used: 1:42:09.697168,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_58_15_seed_2_21520752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.95487535, 'precision': 0.9723531, 'recall': 0.7690961, 'specificity': 0.7690961, 'f1': 0.8368936, 'auroc': 0.9524462, 'binary_precision': 0.99188644, 'binary_recall': 0.5386649, 'binary_specificity': 0.9995273, 'binary_f1_score': 0.69817245}
confusion matrix:
       0     1
0  42289    20
1   2094  2445
---- Validation: 
scalar performance:
{'acc': 0.96729344, 'precision': 0.5673643, 'recall': 0.50207895, 'specificity': 0.50207895, 'f1': 0.49652478, 'auroc': 0.58709955, 'binary_precision': 0.16666667, 'binary_recall': 0.004983389, 'binary_specificity': 0.99917454, 'binary_f1_score': 0.009677419}
confusion matrix:
       0   1
0  18156  15
1    599   3
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9607309, 'precision': 0.48059654, 'recall': 0.49974987, 'specificity': 0.49974987, 'f1': 0.4899861, 'auroc': 0.62501156, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5994  3
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520752_11.png
early stop counter: 10
val acc:0.9672934412956238, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 11,now: 2024-06-22 01:50:37.654666,epoch time: 0:10:12.632112,used: 1:52:22.329280,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_58_15_seed_2_21520752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9551742, 'precision': 0.97196305, 'recall': 0.7709333, 'specificity': 0.7709333, 'f1': 0.83839786, 'auroc': 0.95766026, 'binary_precision': 0.9907445, 'binary_recall': 0.5424102, 'binary_specificity': 0.9994564, 'binary_f1_score': 0.70102495}
confusion matrix:
       0     1
0  42286    23
1   2077  2462
---- Validation: 
scalar performance:
{'acc': 0.9675065, 'precision': 0.6090593, 'recall': 0.50299203, 'specificity': 0.50299203, 'f1': 0.49821317, 'auroc': 0.600466, 'binary_precision': 0.25, 'binary_recall': 0.006644518, 'binary_specificity': 0.9993396, 'binary_f1_score': 0.012944983}
confusion matrix:
       0   1
0  18159  12
1    598   4
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9607309, 'precision': 0.58067054, 'recall': 0.50173265, 'specificity': 0.50173265, 'f1': 0.49403307, 'auroc': 0.642332, 'binary_precision': 0.2, 'binary_recall': 0.004132231, 'binary_specificity': 0.999333, 'binary_f1_score': 0.008097166}
confusion matrix:
      0  1
0  5993  4
1   241  1
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520752_12.png
early stop counter: 11
val acc:0.9675065279006958, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 12,now: 2024-06-22 02:00:49.296254,epoch time: 0:10:11.641588,used: 2:02:33.970868,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_58_15_seed_2_21520752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.96091616, 'precision': 0.973986, 'recall': 0.8013521, 'specificity': 0.8013521, 'f1': 0.8641458, 'auroc': 0.964041, 'binary_precision': 0.9888087, 'binary_recall': 0.6034369, 'binary_specificity': 0.9992673, 'binary_f1_score': 0.7494869}
confusion matrix:
       0     1
0  42278    31
1   1800  2739
---- Validation: 
scalar performance:
{'acc': 0.9676663, 'precision': 0.67983884, 'recall': 0.50708985, 'specificity': 0.50708985, 'f1': 0.50617975, 'auroc': 0.630458, 'binary_precision': 0.39130434, 'binary_recall': 0.014950166, 'binary_specificity': 0.99922955, 'binary_f1_score': 0.028800001}
confusion matrix:
       0   1
0  18157  14
1    593   9
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96057063, 'precision': 0.5640007, 'recall': 0.50164926, 'specificity': 0.50164926, 'f1': 0.493975, 'auroc': 0.6685257, 'binary_precision': 0.16666667, 'binary_recall': 0.004132231, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.008064516}
confusion matrix:
      0  1
0  5992  5
1   241  1
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520752_13.png
early stop counter: 12
val acc:0.9676663279533386, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 13,now: 2024-06-22 02:10:59.625992,epoch time: 0:10:10.329738,used: 2:12:44.300606,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_58_15_seed_2_21520752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96343493, 'precision': 0.9764596, 'recall': 0.8137605, 'specificity': 0.8137605, 'f1': 0.874564, 'auroc': 0.9680816, 'binary_precision': 0.9913074, 'binary_recall': 0.6281119, 'binary_specificity': 0.9994091, 'binary_f1_score': 0.7689817}
confusion matrix:
       0     1
0  42284    25
1   1688  2851
---- Validation: 
scalar performance:
{'acc': 0.9675598, 'precision': 0.664185, 'recall': 0.50703484, 'specificity': 0.50703484, 'f1': 0.50610626, 'auroc': 0.62166643, 'binary_precision': 0.36, 'binary_recall': 0.014950166, 'binary_specificity': 0.99911946, 'binary_f1_score': 0.028708136}
confusion matrix:
       0   1
0  18155  16
1    593   9
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608912, 'precision': 0.6474143, 'recall': 0.5037987, 'specificity': 0.5037987, 'f1': 0.49808905, 'auroc': 0.6519517, 'binary_precision': 0.33333334, 'binary_recall': 0.008264462, 'binary_specificity': 0.999333, 'binary_f1_score': 0.016129032}
confusion matrix:
      0  1
0  5993  4
1   240  2
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520752_14.png
early stop counter: 13
val acc:0.967559814453125, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 14,now: 2024-06-22 02:21:15.574091,epoch time: 0:10:15.948099,used: 2:23:00.248705,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_58_15_seed_2_21520752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9643741, 'precision': 0.9782764, 'recall': 0.81782067, 'specificity': 0.81782067, 'f1': 0.87820625, 'auroc': 0.96848786, 'binary_precision': 0.994146, 'binary_recall': 0.6360432, 'binary_specificity': 0.9995982, 'binary_f1_score': 0.7757625}
confusion matrix:
       0     1
0  42292    17
1   1652  2887
---- Validation: 
scalar performance:
{'acc': 0.9682523, 'precision': 0.77858853, 'recall': 0.51622605, 'specificity': 0.51622605, 'f1': 0.5233728, 'auroc': 0.63910925, 'binary_precision': 0.5882353, 'binary_recall': 0.03322259, 'binary_specificity': 0.99922955, 'binary_f1_score': 0.06289307}
confusion matrix:
       0   1
0  18157  14
1    582  20
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9604103, 'precision': 0.6347328, 'recall': 0.5075141, 'specificity': 0.5075141, 'f1': 0.50558233, 'auroc': 0.6730492, 'binary_precision': 0.30769232, 'binary_recall': 0.016528925, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.031372547}
confusion matrix:
      0  1
0  5988  9
1   238  4
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520752_15.png
better model found
persisted
after epoch: 15,now: 2024-06-22 02:31:27.513485,epoch time: 0:10:11.939394,used: 2:33:12.188099,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_58_15_seed_2_21520752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.96764004, 'precision': 0.9772711, 'recall': 0.8365431, 'specificity': 0.8365431, 'f1': 0.8918997, 'auroc': 0.97103226, 'binary_precision': 0.98836833, 'binary_recall': 0.67393696, 'binary_specificity': 0.99914914, 'binary_f1_score': 0.80141467}
confusion matrix:
       0     1
0  42273    36
1   1480  3059
---- Validation: 
scalar performance:
{'acc': 0.9683055, 'precision': 0.7690109, 'recall': 0.523481, 'specificity': 0.523481, 'f1': 0.53634655, 'auroc': 0.6585576, 'binary_precision': 0.5686275, 'binary_recall': 0.048172757, 'binary_specificity': 0.99878925, 'binary_f1_score': 0.08882083}
confusion matrix:
       0   1
0  18149  22
1    573  29
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9604103, 'precision': 0.66531986, 'recall': 0.5134623, 'specificity': 0.5134623, 'f1': 0.51671106, 'auroc': 0.6876367, 'binary_precision': 0.36842105, 'binary_recall': 0.02892562, 'binary_specificity': 0.997999, 'binary_f1_score': 0.053639848}
confusion matrix:
      0   1
0  5985  12
1   235   7
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520752_16.png
better model found
persisted
after epoch: 16,now: 2024-06-22 02:41:39.249001,epoch time: 0:10:11.735516,used: 2:43:23.923615,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_58_15_seed_2_21520752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.96904886, 'precision': 0.97769153, 'recall': 0.8441084, 'specificity': 0.8441084, 'f1': 0.8974862, 'auroc': 0.97405565, 'binary_precision': 0.9876855, 'binary_recall': 0.6891386, 'binary_specificity': 0.9990782, 'binary_f1_score': 0.81183493}
confusion matrix:
       0     1
0  42270    39
1   1411  3128
---- Validation: 
scalar performance:
{'acc': 0.9686784, 'precision': 0.8047781, 'recall': 0.5260828, 'specificity': 0.5260828, 'f1': 0.541111, 'auroc': 0.66247654, 'binary_precision': 0.64, 'binary_recall': 0.053156145, 'binary_specificity': 0.99900943, 'binary_f1_score': 0.09815951}
confusion matrix:
       0   1
0  18153  18
1    570  32
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96105146, 'precision': 0.71943974, 'recall': 0.51974404, 'specificity': 0.51974404, 'f1': 0.528076, 'auroc': 0.6959878, 'binary_precision': 0.47619048, 'binary_recall': 0.041322313, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.076045625}
confusion matrix:
      0   1
0  5986  11
1   232  10
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520752_17.png
better model found
persisted
after epoch: 17,now: 2024-06-22 02:51:48.485700,epoch time: 0:10:09.236699,used: 2:53:33.160314,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_58_15_seed_2_21520752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.97207993, 'precision': 0.9802185, 'recall': 0.859228, 'specificity': 0.859228, 'f1': 0.90892196, 'auroc': 0.9754266, 'binary_precision': 0.9896907, 'binary_recall': 0.71925956, 'binary_specificity': 0.9991964, 'binary_f1_score': 0.8330781}
confusion matrix:
       0     1
0  42276    34
1   1274  3264
---- Validation: 
scalar performance:
{'acc': 0.9689448, 'precision': 0.7899076, 'recall': 0.5430844, 'specificity': 0.5430844, 'f1': 0.56901413, 'auroc': 0.6818246, 'binary_precision': 0.6091954, 'binary_recall': 0.08803987, 'binary_specificity': 0.9981289, 'binary_f1_score': 0.15384616}
confusion matrix:
       0   1
0  18137  34
1    549  53
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.962494, 'precision': 0.79870886, 'recall': 0.5383391, 'specificity': 0.5383391, 'f1': 0.56026745, 'auroc': 0.70154154, 'binary_precision': 0.6333333, 'binary_recall': 0.0785124, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.13970588}
confusion matrix:
      0   1
0  5986  11
1   223  19
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520752_18.png
new oracle model saved
better model found
persisted
after epoch: 18,now: 2024-06-22 03:01:58.954453,epoch time: 0:10:10.468753,used: 3:03:43.629067,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_58_15_seed_2_21520752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9756873, 'precision': 0.9806802, 'recall': 0.8791537, 'specificity': 0.8791537, 'f1': 0.9224568, 'auroc': 0.98000276, 'binary_precision': 0.98654836, 'binary_recall': 0.75941837, 'binary_specificity': 0.99888915, 'binary_f1_score': 0.8582099}
confusion matrix:
       0     1
0  42262    47
1   1092  3447
---- Validation: 
scalar performance:
{'acc': 0.9688915, 'precision': 0.7704546, 'recall': 0.55992085, 'specificity': 0.55992085, 'f1': 0.5931611, 'auroc': 0.71543086, 'binary_precision': 0.5692308, 'binary_recall': 0.12292359, 'binary_specificity': 0.99691814, 'binary_f1_score': 0.2021858}
confusion matrix:
       0   1
0  18115  56
1    528  74
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9639365, 'precision': 0.81652665, 'recall': 0.56883055, 'specificity': 0.56883055, 'f1': 0.6068083, 'auroc': 0.7412775, 'binary_precision': 0.6666667, 'binary_recall': 0.14049587, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.23208192}
confusion matrix:
      0   1
0  5980  17
1   208  34
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520752_19.png
new oracle model saved
early stop counter: 1
val acc:0.9688915014266968, best validation acc: 0.968944787979126, corresponding to test acc:                         0.9624940156936646 / 0.9639365077018738
after epoch: 19,now: 2024-06-22 03:12:10.505941,epoch time: 0:10:11.551488,used: 3:13:55.180555,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_58_15_seed_2_21520752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.97481215, 'precision': 0.98144746, 'recall': 0.87365395, 'specificity': 0.87365395, 'f1': 0.9191084, 'auroc': 0.97979, 'binary_precision': 0.9892222, 'binary_recall': 0.7481824, 'binary_specificity': 0.9991255, 'binary_f1_score': 0.85198194}
confusion matrix:
       0     1
0  42272    37
1   1143  3396
---- Validation: 
scalar performance:
{'acc': 0.968998, 'precision': 0.7948093, 'recall': 0.54230887, 'specificity': 0.54230887, 'f1': 0.56790704, 'auroc': 0.7029743, 'binary_precision': 0.61904764, 'binary_recall': 0.08637874, 'binary_specificity': 0.998239, 'binary_f1_score': 0.15160349}
confusion matrix:
       0   1
0  18139  32
1    550  52
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96377623, 'precision': 0.8327391, 'recall': 0.55685073, 'specificity': 0.55685073, 'f1': 0.5900254, 'auroc': 0.72355324, 'binary_precision': 0.7, 'binary_recall': 0.11570248, 'binary_specificity': 0.997999, 'binary_f1_score': 0.19858158}
confusion matrix:
      0   1
0  5985  12
1   214  28
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520752_20.png
better model found
persisted
after epoch: 20,now: 2024-06-22 03:22:23.329349,epoch time: 0:10:12.823408,used: 3:24:08.003963,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_58_15_seed_2_21520752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9744066, 'precision': 0.9809401, 'recall': 0.8717576, 'specificity': 0.8717576, 'f1': 0.91766536, 'auroc': 0.9780768, 'binary_precision': 0.9885898, 'binary_recall': 0.7444371, 'binary_specificity': 0.9990782, 'binary_f1_score': 0.84931505}
confusion matrix:
       0     1
0  42270    39
1   1160  3379
---- Validation: 
scalar performance:
{'acc': 0.9690513, 'precision': 0.7874932, 'recall': 0.54956377, 'specificity': 0.54956377, 'f1': 0.57888615, 'auroc': 0.7020148, 'binary_precision': 0.6039604, 'binary_recall': 0.1013289, 'binary_specificity': 0.9977987, 'binary_f1_score': 0.17354196}
confusion matrix:
       0   1
0  18131  40
1    541  61
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645777, 'precision': 0.8449062, 'recall': 0.56916404, 'specificity': 0.56916404, 'f1': 0.6085815, 'auroc': 0.72321856, 'binary_precision': 0.7234042, 'binary_recall': 0.14049587, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.23529413}
confusion matrix:
      0   1
0  5984  13
1   208  34
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520752_21.png
new oracle model saved
better model found
persisted
after epoch: 21,now: 2024-06-22 03:32:41.350325,epoch time: 0:10:18.020976,used: 3:34:26.024939,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_58_15_seed_2_21520752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.97504693, 'precision': 0.9796394, 'recall': 0.87634075, 'specificity': 0.87634075, 'f1': 0.9202344, 'auroc': 0.98161566, 'binary_precision': 0.98503166, 'binary_recall': 0.75391054, 'binary_specificity': 0.99877095, 'binary_f1_score': 0.8541121}
confusion matrix:
       0     1
0  42257    52
1   1117  3422
---- Validation: 
scalar performance:
{'acc': 0.968998, 'precision': 0.7810678, 'recall': 0.5527485, 'specificity': 0.5527485, 'f1': 0.58339185, 'auroc': 0.7165848, 'binary_precision': 0.59090906, 'binary_recall': 0.10797342, 'binary_specificity': 0.99752355, 'binary_f1_score': 0.18258427}
confusion matrix:
       0   1
0  18126  45
1    537  65
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645777, 'precision': 0.8324869, 'recall': 0.5751123, 'specificity': 0.5751123, 'f1': 0.6163537, 'auroc': 0.7371272, 'binary_precision': 0.6981132, 'binary_recall': 0.15289256, 'binary_specificity': 0.997332, 'binary_f1_score': 0.25084746}
confusion matrix:
      0   1
0  5981  16
1   205  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520752_22.png
early stop counter: 1
val acc:0.9689980149269104, best validation acc: 0.9690513014793396, corresponding to test acc:                         0.9645776748657227 / 0.9645776748657227
after epoch: 22,now: 2024-06-22 03:42:58.373317,epoch time: 0:10:17.022992,used: 3:44:43.047931,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_58_15_seed_2_21520752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9759221, 'precision': 0.9810795, 'recall': 0.8801425, 'specificity': 0.8801425, 'f1': 0.923249, 'auroc': 0.9833739, 'binary_precision': 0.98714286, 'binary_recall': 0.7613486, 'binary_specificity': 0.9989364, 'binary_f1_score': 0.8596666}
confusion matrix:
       0     1
0  42265    45
1   1083  3455
---- Validation: 
scalar performance:
{'acc': 0.9692644, 'precision': 0.79009116, 'recall': 0.55690134, 'specificity': 0.55690134, 'f1': 0.5897955, 'auroc': 0.71975374, 'binary_precision': 0.6086956, 'binary_recall': 0.11627907, 'binary_specificity': 0.99752355, 'binary_f1_score': 0.19525802}
confusion matrix:
       0   1
0  18126  45
1    532  70
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650585, 'precision': 0.8534384, 'recall': 0.5753624, 'specificity': 0.5753624, 'f1': 0.61776763, 'auroc': 0.7389954, 'binary_precision': 0.74, 'binary_recall': 0.15289256, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.25342464}
confusion matrix:
      0   1
0  5984  13
1   205  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520752_23.png
new oracle model saved
better model found
persisted
after epoch: 23,now: 2024-06-22 03:53:13.360267,epoch time: 0:10:14.986950,used: 3:54:58.034881,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_58_15_seed_2_21520752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9769254, 'precision': 0.9774877, 'recall': 0.88868964, 'specificity': 0.88868964, 'f1': 0.92740303, 'auroc': 0.98415816, 'binary_precision': 0.97815263, 'binary_recall': 0.7792465, 'binary_specificity': 0.99813277, 'binary_f1_score': 0.8674433}
confusion matrix:
       0     1
0  42230    79
1   1002  3537
---- Validation: 
scalar performance:
{'acc': 0.968998, 'precision': 0.7686376, 'recall': 0.57041556, 'specificity': 0.57041556, 'f1': 0.60716957, 'auroc': 0.74030614, 'binary_precision': 0.5649351, 'binary_recall': 0.14451827, 'binary_specificity': 0.9963128, 'binary_f1_score': 0.23015873}
confusion matrix:
       0   1
0  18104  67
1    515  87
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9658599, 'precision': 0.8529088, 'recall': 0.5916412, 'specificity': 0.5916412, 'f1': 0.6397674, 'auroc': 0.75939965, 'binary_precision': 0.73770493, 'binary_recall': 0.18595041, 'binary_specificity': 0.997332, 'binary_f1_score': 0.29702973}
confusion matrix:
      0   1
0  5981  16
1   197  45
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520752_24.png
new oracle model saved
early stop counter: 1
val acc:0.9689980149269104, best validation acc: 0.9692643880844116, corresponding to test acc:                         0.9650585055351257 / 0.9658598899841309
after epoch: 24,now: 2024-06-22 04:03:26.674622,epoch time: 0:10:13.314355,used: 4:05:11.349236,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_58_15_seed_2_21520752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.97684, 'precision': 0.98113835, 'recall': 0.88529885, 'specificity': 0.88529885, 'f1': 0.926613, 'auroc': 0.9837967, 'binary_precision': 0.986205, 'binary_recall': 0.7717559, 'binary_specificity': 0.9988419, 'binary_f1_score': 0.8659004}
confusion matrix:
       0     1
0  42260    49
1   1036  3503
---- Validation: 
scalar performance:
{'acc': 0.9691046, 'precision': 0.7847724, 'recall': 0.5544096, 'specificity': 0.5544096, 'f1': 0.58596396, 'auroc': 0.7152232, 'binary_precision': 0.59821427, 'binary_recall': 0.11129568, 'binary_specificity': 0.99752355, 'binary_f1_score': 0.18767506}
confusion matrix:
       0   1
0  18126  45
1    535  67
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9658599, 'precision': 0.85686195, 'recall': 0.5896585, 'specificity': 0.5896585, 'f1': 0.6374334, 'auroc': 0.7309619, 'binary_precision': 0.7457627, 'binary_recall': 0.18181819, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.29235882}
confusion matrix:
      0   1
0  5982  15
1   198  44
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520752_25.png
early stop counter: 2
val acc:0.9691045880317688, best validation acc: 0.9692643880844116, corresponding to test acc:                         0.9650585055351257 / 0.9658598899841309
after epoch: 25,now: 2024-06-22 04:13:45.306697,epoch time: 0:10:18.632075,used: 4:15:29.981311,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_58_15_seed_2_21520752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9782488, 'precision': 0.98262674, 'recall': 0.89205384, 'specificity': 0.89205384, 'f1': 0.9314908, 'auroc': 0.9851353, 'binary_precision': 0.9878015, 'binary_recall': 0.78514767, 'binary_specificity': 0.9989601, 'binary_f1_score': 0.87489253}
confusion matrix:
       0     1
0  42266    44
1    975  3563
---- Validation: 
scalar performance:
{'acc': 0.9686251, 'precision': 0.76059395, 'recall': 0.55817723, 'specificity': 0.55817723, 'f1': 0.5902266, 'auroc': 0.7286009, 'binary_precision': 0.5496183, 'binary_recall': 0.11960133, 'binary_specificity': 0.9967531, 'binary_f1_score': 0.19645293}
confusion matrix:
       0   1
0  18112  59
1    530  72
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9658599, 'precision': 0.85686195, 'recall': 0.5896585, 'specificity': 0.5896585, 'f1': 0.6374334, 'auroc': 0.7388743, 'binary_precision': 0.7457627, 'binary_recall': 0.18181819, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.29235882}
confusion matrix:
      0   1
0  5982  15
1   198  44
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520752_26.png
early stop counter: 3
val acc:0.9686251282691956, best validation acc: 0.9692643880844116, corresponding to test acc:                         0.9650585055351257 / 0.9658598899841309
after epoch: 26,now: 2024-06-22 04:24:08.680491,epoch time: 0:10:23.373794,used: 4:25:53.355105,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_58_15_seed_2_21520752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.97963625, 'precision': 0.9831072, 'recall': 0.8995327, 'specificity': 0.8995327, 'f1': 0.93637633, 'auroc': 0.9855759, 'binary_precision': 0.9872248, 'binary_recall': 0.80017626, 'binary_specificity': 0.99888915, 'binary_f1_score': 0.8839134}
confusion matrix:
       0     1
0  42262    47
1    907  3632
---- Validation: 
scalar performance:
{'acc': 0.9692111, 'precision': 0.7783251, 'recall': 0.56731343, 'specificity': 0.56731343, 'f1': 0.6037063, 'auroc': 0.74100745, 'binary_precision': 0.58450705, 'binary_recall': 0.13787375, 'binary_specificity': 0.9967531, 'binary_f1_score': 0.22311829}
confusion matrix:
       0   1
0  18112  59
1    519  83
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9669819, 'precision': 0.88430166, 'recall': 0.5981731, 'specificity': 0.5981731, 'f1': 0.6504811, 'auroc': 0.75771976, 'binary_precision': 0.8, 'binary_recall': 0.1983471, 'binary_specificity': 0.997999, 'binary_f1_score': 0.31788078}
confusion matrix:
      0   1
0  5985  12
1   194  48
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520752_27.png
new oracle model saved
early stop counter: 4
val acc:0.9692111015319824, best validation acc: 0.9692643880844116, corresponding to test acc:                         0.9650585055351257 / 0.9669818878173828
after epoch: 27,now: 2024-06-22 04:34:35.767932,epoch time: 0:10:27.087441,used: 4:36:20.442546,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_58_15_seed_2_21520752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9806395, 'precision': 0.9813558, 'recall': 0.9066768, 'specificity': 0.9066768, 'f1': 0.9400835, 'auroc': 0.98620677, 'binary_precision': 0.98220927, 'binary_recall': 0.81493723, 'binary_specificity': 0.9984164, 'binary_f1_score': 0.8907887}
confusion matrix:
       0     1
0  42242    67
1    840  3699
---- Validation: 
scalar performance:
{'acc': 0.9683588, 'precision': 0.7465199, 'recall': 0.5845402, 'specificity': 0.5845402, 'f1': 0.62251365, 'auroc': 0.7503863, 'binary_precision': 0.519802, 'binary_recall': 0.1744186, 'binary_specificity': 0.9946618, 'binary_f1_score': 0.26119405}
confusion matrix:
       0    1
0  18074   97
1    497  105
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9661805, 'precision': 0.82622683, 'recall': 0.6175836, 'specificity': 0.6175836, 'f1': 0.6686876, 'auroc': 0.7630241, 'binary_precision': 0.68235296, 'binary_recall': 0.23966943, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.35474005}
confusion matrix:
      0   1
0  5970  27
1   184  58
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520752_28.png
early stop counter: 5
val acc:0.9683588147163391, best validation acc: 0.9692643880844116, corresponding to test acc:                         0.9650585055351257 / 0.9669818878173828
after epoch: 28,now: 2024-06-22 04:44:55.329437,epoch time: 0:10:19.561505,used: 4:46:40.004051,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_58_15_seed_2_21520752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9803834, 'precision': 0.9809565, 'recall': 0.9055516, 'specificity': 0.9055516, 'f1': 0.9392379, 'auroc': 0.9880117, 'binary_precision': 0.98163915, 'binary_recall': 0.81273407, 'binary_specificity': 0.99836916, 'binary_f1_score': 0.889237}
confusion matrix:
       0     1
0  42240    69
1    850  3689
---- Validation: 
scalar performance:
{'acc': 0.9684121, 'precision': 0.7497982, 'recall': 0.5701129, 'specificity': 0.5701129, 'f1': 0.60536724, 'auroc': 0.7433033, 'binary_precision': 0.5272727, 'binary_recall': 0.14451827, 'binary_specificity': 0.99570745, 'binary_f1_score': 0.22685789}
confusion matrix:
       0   1
0  18093  78
1    515  87
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9668216, 'precision': 0.8579184, 'recall': 0.6080034, 'specificity': 0.6080034, 'f1': 0.660821, 'auroc': 0.7462802, 'binary_precision': 0.74647886, 'binary_recall': 0.21900827, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.33865812}
confusion matrix:
      0   1
0  5979  18
1   189  53
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520752_29.png
early stop counter: 6
val acc:0.9684121012687683, best validation acc: 0.9692643880844116, corresponding to test acc:                         0.9650585055351257 / 0.9669818878173828
after epoch: 29,now: 2024-06-22 04:55:11.344988,epoch time: 0:10:16.015551,used: 4:56:56.019602,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_58_15_seed_2_21520752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9801699, 'precision': 0.9801142, 'recall': 0.9050194, 'specificity': 0.9050194, 'f1': 0.9385767, 'auroc': 0.98609513, 'binary_precision': 0.9800479, 'binary_recall': 0.8118114, 'binary_specificity': 0.99822736, 'binary_f1_score': 0.8880318}
confusion matrix:
       0     1
0  42235    75
1    854  3684
---- Validation: 
scalar performance:
{'acc': 0.9684653, 'precision': 0.75190926, 'recall': 0.56773126, 'specificity': 0.56773126, 'f1': 0.60247976, 'auroc': 0.7516098, 'binary_precision': 0.5316456, 'binary_recall': 0.13953489, 'binary_specificity': 0.9959276, 'binary_f1_score': 0.22105263}
confusion matrix:
       0   1
0  18097  74
1    518  84
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9674627, 'precision': 0.8760693, 'recall': 0.6103196, 'specificity': 0.6103196, 'f1': 0.6652912, 'auroc': 0.76258683, 'binary_precision': 0.7826087, 'binary_recall': 0.2231405, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.34726685}
confusion matrix:
      0   1
0  5982  15
1   188  54
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520752_30.png
new oracle model saved
early stop counter: 7
val acc:0.9684653282165527, best validation acc: 0.9692643880844116, corresponding to test acc:                         0.9650585055351257 / 0.9674627184867859
after epoch: 30,now: 2024-06-22 05:05:25.105733,epoch time: 0:10:13.760745,used: 5:07:09.780347,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_58_15_seed_2_21520752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 5:07:09.780347 at 2024-06-22 05:05:25.105733
persisted model performance metric: 

scalar performance:
{'acc': 0.9650585, 'precision': 0.8534384, 'recall': 0.5753624, 'specificity': 0.5753624, 'f1': 0.61776763, 'auroc': 0.7389954, 'binary_precision': 0.74, 'binary_recall': 0.15289256, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.25342464}
confusion matrix:
      0   1
0  5984  13
1   205  37
oracle model performance metric: 

scalar performance:
{'acc': 0.9674627, 'precision': 0.8760693, 'recall': 0.6103196, 'specificity': 0.6103196, 'f1': 0.6652912, 'auroc': 0.76258683, 'binary_precision': 0.7826087, 'binary_recall': 0.2231405, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.34726685}
confusion matrix:
      0   1
0  5982  15
1   188  54
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_differentbatchsizes_lre5_classbalancing3/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_resnet_differentbatchsizes_lre5_classbalancing3/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204097 KiB |   1730 MiB |   1211 TiB |   1211 TiB |
|       from large pool | 167936 KiB |   1660 MiB |   1210 TiB |   1210 TiB |
|       from small pool |  36161 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 204097 KiB |   1730 MiB |   1211 TiB |   1211 TiB |
|       from large pool | 167936 KiB |   1660 MiB |   1210 TiB |   1210 TiB |
|       from small pool |  36161 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201087 KiB |   1723 MiB |   1211 TiB |   1211 TiB |
|       from large pool | 165120 KiB |   1653 MiB |   1210 TiB |   1210 TiB |
|       from small pool |  35967 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2196 MiB |   2270 MiB |   5474 MiB |   3278 MiB |
|       from large pool |   2122 MiB |   2196 MiB |   5336 MiB |   3214 MiB |
|       from small pool |     74 MiB |     74 MiB |    138 MiB |     64 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 404158 KiB |    900 MiB |    937 TiB |    937 TiB |
|       from large pool | 397312 KiB |    899 MiB |    936 TiB |    936 TiB |
|       from small pool |   6846 KiB |     14 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    1194    |    1851    |   32853 K  |   32852 K  |
|       from large pool |      36    |      76    |   13063 K  |   13063 K  |
|       from small pool |    1158    |    1780    |   19790 K  |   19789 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1194    |    1851    |   32853 K  |   32852 K  |
|       from large pool |      36    |      76    |   13063 K  |   13063 K  |
|       from small pool |    1158    |    1780    |   19790 K  |   19789 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      50    |      51    |      91    |      41    |
|       from large pool |      13    |      14    |      22    |       9    |
|       from small pool |      37    |      37    |      69    |      32    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      31    |     380    |   16901 K  |   16901 K  |
|       from large pool |       5    |      11    |    4443 K  |    4443 K  |
|       from small pool |      26    |     375    |   12458 K  |   12458 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1730 MiB |   1211 TiB |   1211 TiB |
|       from large pool |  16640 KiB |   1660 MiB |   1210 TiB |   1210 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1730 MiB |   1211 TiB |   1211 TiB |
|       from large pool |  16640 KiB |   1660 MiB |   1210 TiB |   1210 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1723 MiB |   1211 TiB |   1211 TiB |
|       from large pool |  16640 KiB |   1653 MiB |   1210 TiB |   1210 TiB |
|       from small pool |      0 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 608256 KiB |   2270 MiB |   5474 MiB |   4880 MiB |
|       from large pool | 565248 KiB |   2196 MiB |   5336 MiB |   4784 MiB |
|       from small pool |  43008 KiB |     74 MiB |    138 MiB |     96 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 384768 KiB |    900 MiB |    937 TiB |    937 TiB |
|       from large pool | 384768 KiB |    899 MiB |    936 TiB |    936 TiB |
|       from small pool |      0 KiB |     14 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1851    |   32853 K  |   32853 K  |
|       from large pool |       2    |      76    |   13063 K  |   13063 K  |
|       from small pool |       0    |    1780    |   19790 K  |   19790 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1851    |   32853 K  |   32853 K  |
|       from large pool |       2    |      76    |   13063 K  |   13063 K  |
|       from small pool |       0    |    1780    |   19790 K  |   19790 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      30    |      51    |      91    |      61    |
|       from large pool |       9    |      14    |      22    |      13    |
|       from small pool |      21    |      37    |      69    |      48    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     380    |   16902 K  |   16902 K  |
|       from large pool |       1    |      11    |    4443 K  |    4443 K  |
|       from small pool |       0    |     375    |   12458 K  |   12458 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

