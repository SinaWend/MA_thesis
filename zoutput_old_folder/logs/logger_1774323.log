Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0




!!!: not committed yet



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546984

 Experiment start at: 2024-06-22 10:15:48.337433
before training, model accuracy: 0.3101629912853241
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9761772, 'precision': 0.98025197, 'recall': 0.87915266, 'specificity': 0.87915266, 'f1': 0.9223457, 'auroc': 0.98173594, 'binary_precision': 0.985022, 'binary_recall': 0.7595109, 'binary_specificity': 0.99879444, 'binary_f1_score': 0.8576908}
confusion matrix:
       0     1
0  42253    51
1   1062  3354
---- Validation: 
scalar performance:
{'acc': 0.9667944, 'precision': 0.7672955, 'recall': 0.562778, 'specificity': 0.562778, 'f1': 0.5965836, 'auroc': 0.722165, 'binary_precision': 0.56462586, 'binary_recall': 0.12908243, 'binary_specificity': 0.9964736, 'binary_f1_score': 0.21012658}
confusion matrix:
       0   1
0  18085  64
1    560  83
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.7834983, 'recall': 0.5651322, 'specificity': 0.5651322, 'f1': 0.59951043, 'auroc': 0.77529556, 'binary_precision': 0.6034483, 'binary_recall': 0.13409962, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.21943574}
confusion matrix:
      0   1
0  5974  23
1   226  35
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546984_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-22 10:26:23.033818,epoch time: 0:10:34.696385,used: 0:10:34.696385,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9837329, 'precision': 0.97921324, 'recall': 0.9241406, 'specificity': 0.9241406, 'f1': 0.94957817, 'auroc': 0.99045455, 'binary_precision': 0.97380024, 'binary_recall': 0.8506685, 'binary_specificity': 0.9976127, 'binary_f1_score': 0.9080793}
confusion matrix:
       0     1
0  42206   101
1    659  3754
---- Validation: 
scalar performance:
{'acc': 0.9663687, 'precision': 0.74611473, 'recall': 0.61431146, 'specificity': 0.61431146, 'f1': 0.6537706, 'auroc': 0.7757907, 'binary_precision': 0.51877135, 'binary_recall': 0.23639192, 'binary_specificity': 0.99223095, 'binary_f1_score': 0.32478634}
confusion matrix:
       0    1
0  18008  141
1    491  152
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96324706, 'precision': 0.81719387, 'recall': 0.6161893, 'specificity': 0.6161893, 'f1': 0.66568553, 'auroc': 0.8005497, 'binary_precision': 0.6666667, 'binary_recall': 0.23754789, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.3502825}
confusion matrix:
      0   1
0  5966  31
1   199  62
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546984_2.png
new oracle model saved
early stop counter: 1
val acc:0.9663686752319336, best validation acc: 0.9667943716049194, corresponding to test acc:                         0.960210919380188 / 0.9632470607757568
after epoch: 2,now: 2024-06-22 10:35:55.339975,epoch time: 0:09:32.306157,used: 0:20:07.002542,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9874786, 'precision': 0.97384155, 'recall': 0.95187366, 'specificity': 0.95187366, 'f1': 0.96252894, 'auroc': 0.99252033, 'binary_precision': 0.9572282, 'binary_recall': 0.90797824, 'binary_specificity': 0.99576914, 'binary_f1_score': 0.93195295}
confusion matrix:
       0     1
0  42129   179
1    406  4006
---- Validation: 
scalar performance:
{'acc': 0.96557045, 'precision': 0.7353639, 'recall': 0.64765066, 'specificity': 0.64765066, 'f1': 0.6803885, 'auroc': 0.80770826, 'binary_precision': 0.49497488, 'binary_recall': 0.30637637, 'binary_specificity': 0.988925, 'binary_f1_score': 0.37848225}
confusion matrix:
       0    1
0  17948  201
1    446  197
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9638862, 'precision': 0.80854326, 'recall': 0.6440078, 'specificity': 0.6440078, 'f1': 0.69332045, 'auroc': 0.817557, 'binary_precision': 0.64705884, 'binary_recall': 0.29501915, 'binary_specificity': 0.9929965, 'binary_f1_score': 0.40526316}
confusion matrix:
      0   1
0  5955  42
1   184  77
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546984_3.png
new oracle model saved
early stop counter: 2
val acc:0.9655704498291016, best validation acc: 0.9667943716049194, corresponding to test acc:                         0.960210919380188 / 0.9638862013816833
after epoch: 3,now: 2024-06-22 10:45:19.459781,epoch time: 0:09:24.119806,used: 0:29:31.122348,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98951197, 'precision': 0.97923315, 'recall': 0.9586988, 'specificity': 0.9586988, 'f1': 0.96868277, 'auroc': 0.99302506, 'binary_precision': 0.9666984, 'binary_recall': 0.92070687, 'binary_specificity': 0.99669075, 'binary_f1_score': 0.9431423}
confusion matrix:
       0     1
0  42166   140
1    350  4064
---- Validation: 
scalar performance:
{'acc': 0.96631545, 'precision': 0.74444103, 'recall': 0.6442861, 'specificity': 0.6442861, 'f1': 0.68013525, 'auroc': 0.80763817, 'binary_precision': 0.51336896, 'binary_recall': 0.29860032, 'binary_specificity': 0.9899719, 'binary_f1_score': 0.37758112}
confusion matrix:
       0    1
0  17967  182
1    451  192
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96292746, 'precision': 0.79299915, 'recall': 0.6435076, 'specificity': 0.6435076, 'f1': 0.68991876, 'auroc': 0.8225646, 'binary_precision': 0.616, 'binary_recall': 0.29501915, 'binary_specificity': 0.991996, 'binary_f1_score': 0.39896372}
confusion matrix:
      0   1
0  5949  48
1   184  77
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546984_4.png
early stop counter: 3
val acc:0.9663154482841492, best validation acc: 0.9667943716049194, corresponding to test acc:                         0.960210919380188 / 0.9638862013816833
after epoch: 4,now: 2024-06-22 10:54:55.836102,epoch time: 0:09:36.376321,used: 0:39:07.498669,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9885916, 'precision': 0.97745216, 'recall': 0.95492446, 'specificity': 0.95492446, 'f1': 0.96584547, 'auroc': 0.99467236, 'binary_precision': 0.96388423, 'binary_recall': 0.91341794, 'binary_specificity': 0.99643093, 'binary_f1_score': 0.9379728}
confusion matrix:
       0     1
0  42157   151
1    382  4030
---- Validation: 
scalar performance:
{'acc': 0.965943, 'precision': 0.73981535, 'recall': 0.6485936, 'specificity': 0.6485936, 'f1': 0.6823641, 'auroc': 0.8269348, 'binary_precision': 0.5038168, 'binary_recall': 0.30793157, 'binary_specificity': 0.9892556, 'binary_f1_score': 0.38223937}
confusion matrix:
       0    1
0  17954  195
1    445  198
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96180886, 'precision': 0.78587574, 'recall': 0.6191036, 'specificity': 0.6191036, 'f1': 0.6645507, 'auroc': 0.82882535, 'binary_precision': 0.6037736, 'binary_recall': 0.24521072, 'binary_specificity': 0.9929965, 'binary_f1_score': 0.34877384}
confusion matrix:
      0   1
0  5955  42
1   197  64
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546984_5.png
early stop counter: 4
val acc:0.9659429788589478, best validation acc: 0.9667943716049194, corresponding to test acc:                         0.960210919380188 / 0.9638862013816833
after epoch: 5,now: 2024-06-22 11:04:19.751415,epoch time: 0:09:23.915313,used: 0:48:31.413982,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9904324, 'precision': 0.98159117, 'recall': 0.9618449, 'specificity': 0.9618449, 'f1': 0.9714577, 'auroc': 0.9957503, 'binary_precision': 0.97080463, 'binary_recall': 0.9265972, 'binary_specificity': 0.9970926, 'binary_f1_score': 0.9481859}
confusion matrix:
       0     1
0  42183   123
1    324  4090
---- Validation: 
scalar performance:
{'acc': 0.9662622, 'precision': 0.7438791, 'recall': 0.63375777, 'specificity': 0.63375777, 'f1': 0.67113537, 'auroc': 0.8189402, 'binary_precision': 0.5129683, 'binary_recall': 0.27682737, 'binary_specificity': 0.9906882, 'binary_f1_score': 0.35959598}
confusion matrix:
       0    1
0  17980  169
1    465  178
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606903, 'precision': 0.77276105, 'recall': 0.60202897, 'specificity': 0.60202897, 'f1': 0.64437926, 'auroc': 0.82197964, 'binary_precision': 0.57894737, 'binary_recall': 0.21072797, 'binary_specificity': 0.99333, 'binary_f1_score': 0.30898875}
confusion matrix:
      0   1
0  5957  40
1   206  55
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546984_6.png
early stop counter: 5
val acc:0.9662622213363647, best validation acc: 0.9667943716049194, corresponding to test acc:                         0.960210919380188 / 0.9638862013816833
after epoch: 6,now: 2024-06-22 11:13:37.304187,epoch time: 0:09:17.552772,used: 0:57:48.966754,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9896618, 'precision': 0.9775555, 'recall': 0.96128476, 'specificity': 0.96128476, 'f1': 0.9692423, 'auroc': 0.99537694, 'binary_precision': 0.9627622, 'binary_recall': 0.92630386, 'binary_specificity': 0.99626565, 'binary_f1_score': 0.9441812}
confusion matrix:
       0     1
0  42152   158
1    325  4085
---- Validation: 
scalar performance:
{'acc': 0.96557045, 'precision': 0.73469037, 'recall': 0.63489974, 'specificity': 0.63489974, 'f1': 0.6699045, 'auroc': 0.8204285, 'binary_precision': 0.4945055, 'binary_recall': 0.2799378, 'binary_specificity': 0.9898617, 'binary_f1_score': 0.35749757}
confusion matrix:
       0    1
0  17965  184
1    463  180
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.7545267, 'recall': 0.60702574, 'specificity': 0.60702574, 'f1': 0.64723665, 'auroc': 0.8261353, 'binary_precision': 0.5420561, 'binary_recall': 0.22222222, 'binary_specificity': 0.9918293, 'binary_f1_score': 0.3152174}
confusion matrix:
      0   1
0  5948  49
1   203  58
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546984_7.png
early stop counter: 6
val acc:0.9655704498291016, best validation acc: 0.9667943716049194, corresponding to test acc:                         0.960210919380188 / 0.9638862013816833
after epoch: 7,now: 2024-06-22 11:22:58.170751,epoch time: 0:09:20.866564,used: 1:07:09.833318,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9904752, 'precision': 0.98112226, 'recall': 0.9625788, 'specificity': 0.9625788, 'f1': 0.9716209, 'auroc': 0.9953853, 'binary_precision': 0.96970415, 'binary_recall': 0.9281831, 'binary_specificity': 0.9969744, 'binary_f1_score': 0.9484894}
confusion matrix:
       0     1
0  42178   128
1    317  4097
---- Validation: 
scalar performance:
{'acc': 0.9665815, 'precision': 0.749344, 'recall': 0.618922, 'specificity': 0.618922, 'f1': 0.658803, 'auroc': 0.82557774, 'binary_precision': 0.52491695, 'binary_recall': 0.24572317, 'binary_specificity': 0.9921208, 'binary_f1_score': 0.33474576}
confusion matrix:
       0    1
0  18006  143
1    485  158
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590924, 'precision': 0.7509844, 'recall': 0.56454855, 'specificity': 0.56454855, 'f1': 0.59686154, 'auroc': 0.819304, 'binary_precision': 0.53846157, 'binary_recall': 0.13409962, 'binary_specificity': 0.9949975, 'binary_f1_score': 0.21472393}
confusion matrix:
      0   1
0  5967  30
1   226  35
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546984_8.png
early stop counter: 7
val acc:0.9665815234184265, best validation acc: 0.9667943716049194, corresponding to test acc:                         0.960210919380188 / 0.9638862013816833
after epoch: 8,now: 2024-06-22 11:32:20.248679,epoch time: 0:09:22.077928,used: 1:16:31.911246,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9914598, 'precision': 0.9808478, 'recall': 0.9688107, 'specificity': 0.9688107, 'f1': 0.974733, 'auroc': 0.9958966, 'binary_precision': 0.96784717, 'binary_recall': 0.94088334, 'binary_specificity': 0.99673796, 'binary_f1_score': 0.9541748}
confusion matrix:
       0     1
0  42167   138
1    261  4154
---- Validation: 
scalar performance:
{'acc': 0.965943, 'precision': 0.73952925, 'recall': 0.63434255, 'specificity': 0.63434255, 'f1': 0.6706122, 'auroc': 0.83015704, 'binary_precision': 0.5042254, 'binary_recall': 0.27838257, 'binary_specificity': 0.9903025, 'binary_f1_score': 0.35871744}
confusion matrix:
       0    1
0  17973  176
1    464  179
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.957814, 'precision': 0.72600156, 'recall': 0.59503126, 'specificity': 0.59503126, 'f1': 0.6304384, 'auroc': 0.8225454, 'binary_precision': 0.48598132, 'binary_recall': 0.19923371, 'binary_specificity': 0.99082875, 'binary_f1_score': 0.28260872}
confusion matrix:
      0   1
0  5942  55
1   209  52
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546984_9.png
early stop counter: 8
val acc:0.9659429788589478, best validation acc: 0.9667943716049194, corresponding to test acc:                         0.960210919380188 / 0.9638862013816833
after epoch: 9,now: 2024-06-22 11:41:38.257632,epoch time: 0:09:18.008953,used: 1:25:49.920199,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9921661, 'precision': 0.98910016, 'recall': 0.9647221, 'specificity': 0.9647221, 'f1': 0.9765197, 'auroc': 0.9967736, 'binary_precision': 0.9853682, 'binary_recall': 0.93088603, 'binary_specificity': 0.99855816, 'binary_f1_score': 0.9573526}
confusion matrix:
       0     1
0  42246    61
1    305  4108
---- Validation: 
scalar performance:
{'acc': 0.9671137, 'precision': 0.7649932, 'recall': 0.5906954, 'specificity': 0.5906954, 'f1': 0.6314465, 'auroc': 0.8268519, 'binary_precision': 0.55813956, 'binary_recall': 0.1866252, 'binary_specificity': 0.9947656, 'binary_f1_score': 0.2797203}
confusion matrix:
       0    1
0  18054   95
1    523  120
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590924, 'precision': 0.7576777, 'recall': 0.54805756, 'specificity': 0.54805756, 'f1': 0.5739306, 'auroc': 0.8078522, 'binary_precision': 0.5531915, 'binary_recall': 0.099616855, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.16883117}
confusion matrix:
      0   1
0  5976  21
1   235  26
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546984_10.png
better model found
persisted
after epoch: 10,now: 2024-06-22 11:51:00.768055,epoch time: 0:09:22.510423,used: 1:35:12.430622,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99208045, 'precision': 0.9863554, 'recall': 0.96690744, 'specificity': 0.96690744, 'f1': 0.9763818, 'auroc': 0.99546605, 'binary_precision': 0.9793692, 'binary_recall': 0.9358713, 'binary_specificity': 0.9979436, 'binary_f1_score': 0.9571263}
confusion matrix:
       0     1
0  42220    87
1    283  4130
---- Validation: 
scalar performance:
{'acc': 0.96706045, 'precision': 0.758973, 'recall': 0.61016923, 'specificity': 0.61016923, 'f1': 0.651824, 'auroc': 0.82461995, 'binary_precision': 0.54477614, 'binary_recall': 0.22706065, 'binary_specificity': 0.99327785, 'binary_f1_score': 0.3205269}
confusion matrix:
       0    1
0  18027  122
1    497  146
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.735365, 'recall': 0.56421506, 'specificity': 0.56421506, 'f1': 0.59539264, 'auroc': 0.8168056, 'binary_precision': 0.5072464, 'binary_recall': 0.13409962, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.21212122}
confusion matrix:
      0   1
0  5963  34
1   226  35
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546984_11.png
early stop counter: 1
val acc:0.9670604467391968, best validation acc: 0.9671136736869812, corresponding to test acc:                         0.959092378616333 / 0.9638862013816833
after epoch: 11,now: 2024-06-22 12:00:35.573494,epoch time: 0:09:34.805439,used: 1:44:47.236061,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99197346, 'precision': 0.98587435, 'recall': 0.9667396, 'specificity': 0.9667396, 'f1': 0.9760651, 'auroc': 0.9964232, 'binary_precision': 0.9784309, 'binary_recall': 0.9356301, 'binary_specificity': 0.9978491, 'binary_f1_score': 0.9565519}
confusion matrix:
       0     1
0  42217    91
1    284  4128
---- Validation: 
scalar performance:
{'acc': 0.966688, 'precision': 0.75076914, 'recall': 0.62272733, 'specificity': 0.62272733, 'f1': 0.66267407, 'auroc': 0.84302753, 'binary_precision': 0.5275081, 'binary_recall': 0.2534992, 'binary_specificity': 0.99195546, 'binary_f1_score': 0.34243697}
confusion matrix:
       0    1
0  18003  146
1    480  163
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95685524, 'precision': 0.70546687, 'recall': 0.5688783, 'specificity': 0.5688783, 'f1': 0.5987337, 'auroc': 0.83154464, 'binary_precision': 0.44705883, 'binary_recall': 0.14559387, 'binary_specificity': 0.99216276, 'binary_f1_score': 0.21965319}
confusion matrix:
      0   1
0  5950  47
1   223  38
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546984_12.png
early stop counter: 2
val acc:0.9666879773139954, best validation acc: 0.9671136736869812, corresponding to test acc:                         0.959092378616333 / 0.9638862013816833
after epoch: 12,now: 2024-06-22 12:10:04.948394,epoch time: 0:09:29.374900,used: 1:54:16.610961,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9921661, 'precision': 0.98519623, 'recall': 0.96857846, 'specificity': 0.96857846, 'f1': 0.976705, 'auroc': 0.9967288, 'binary_precision': 0.97667843, 'binary_recall': 0.93949693, 'binary_specificity': 0.99766, 'binary_f1_score': 0.95772696}
confusion matrix:
       0     1
0  42208    99
1    267  4146
---- Validation: 
scalar performance:
{'acc': 0.9656769, 'precision': 0.73530114, 'recall': 0.6184536, 'specificity': 0.6184536, 'f1': 0.65560615, 'auroc': 0.8239999, 'binary_precision': 0.49685535, 'binary_recall': 0.24572317, 'binary_specificity': 0.9911841, 'binary_f1_score': 0.32882413}
confusion matrix:
       0    1
0  17989  160
1    485  158
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95653564, 'precision': 0.70641965, 'recall': 0.5852026, 'specificity': 0.5852026, 'f1': 0.61722183, 'auroc': 0.8147142, 'binary_precision': 0.44761905, 'binary_recall': 0.18007663, 'binary_specificity': 0.9903285, 'binary_f1_score': 0.2568306}
confusion matrix:
      0   1
0  5939  58
1   214  47
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546984_13.png
early stop counter: 3
val acc:0.9656769037246704, best validation acc: 0.9671136736869812, corresponding to test acc:                         0.959092378616333 / 0.9638862013816833
after epoch: 13,now: 2024-06-22 12:19:29.395772,epoch time: 0:09:24.447378,used: 2:03:41.058339,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.991845, 'precision': 0.9781694, 'recall': 0.97399354, 'specificity': 0.97399354, 'f1': 0.9760699, 'auroc': 0.996786, 'binary_precision': 0.9613449, 'binary_recall': 0.9519819, 'binary_specificity': 0.9960052, 'binary_f1_score': 0.95664054}
confusion matrix:
       0     1
0  42136   169
1    212  4203
---- Validation: 
scalar performance:
{'acc': 0.96620905, 'precision': 0.74312127, 'recall': 0.63598037, 'specificity': 0.63598037, 'f1': 0.6728667, 'auroc': 0.83557373, 'binary_precision': 0.51129943, 'binary_recall': 0.281493, 'binary_specificity': 0.9904678, 'binary_f1_score': 0.36308926}
confusion matrix:
       0    1
0  17976  173
1    462  181
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9552573, 'precision': 0.6830144, 'recall': 0.5698769, 'specificity': 0.5698769, 'f1': 0.5974235, 'auroc': 0.8154628, 'binary_precision': 0.40206185, 'binary_recall': 0.14942528, 'binary_specificity': 0.9903285, 'binary_f1_score': 0.21787709}
confusion matrix:
      0   1
0  5939  58
1   222  39
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546984_14.png
early stop counter: 4
val acc:0.9662090539932251, best validation acc: 0.9671136736869812, corresponding to test acc:                         0.959092378616333 / 0.9638862013816833
after epoch: 14,now: 2024-06-22 12:28:55.103134,epoch time: 0:09:25.707362,used: 2:13:06.765701,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99235874, 'precision': 0.9847311, 'recall': 0.97021997, 'specificity': 0.97021997, 'f1': 0.9773365, 'auroc': 0.99722314, 'binary_precision': 0.9753983, 'binary_recall': 0.9429219, 'binary_specificity': 0.997518, 'binary_f1_score': 0.9588852}
confusion matrix:
       0     1
0  42200   105
1    252  4163
---- Validation: 
scalar performance:
{'acc': 0.96695405, 'precision': 0.75433034, 'recall': 0.6296156, 'specificity': 0.6296156, 'f1': 0.66975915, 'auroc': 0.8441372, 'binary_precision': 0.5341615, 'binary_recall': 0.2674961, 'binary_specificity': 0.9917351, 'binary_f1_score': 0.3564767}
confusion matrix:
       0    1
0  17999  150
1    471  172
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95605624, 'precision': 0.68117326, 'recall': 0.5501381, 'specificity': 0.5501381, 'f1': 0.5733078, 'auroc': 0.8113693, 'binary_precision': 0.4, 'binary_recall': 0.107279696, 'binary_specificity': 0.9929965, 'binary_f1_score': 0.1691843}
confusion matrix:
      0   1
0  5955  42
1   233  28
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546984_15.png
early stop counter: 5
val acc:0.9669540524482727, best validation acc: 0.9671136736869812, corresponding to test acc:                         0.959092378616333 / 0.9638862013816833
after epoch: 15,now: 2024-06-22 12:39:28.694679,epoch time: 0:10:33.591545,used: 2:23:40.357246,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9927654, 'precision': 0.9821729, 'recall': 0.9753132, 'specificity': 0.9753132, 'f1': 0.978712, 'auroc': 0.99736273, 'binary_precision': 0.96915996, 'binary_recall': 0.9537939, 'binary_specificity': 0.99683255, 'binary_f1_score': 0.9614155}
confusion matrix:
       0     1
0  42171   134
1    204  4211
---- Validation: 
scalar performance:
{'acc': 0.9663687, 'precision': 0.7450131, 'recall': 0.6518142, 'specificity': 0.6518142, 'f1': 0.68633455, 'auroc': 0.85027313, 'binary_precision': 0.51399493, 'binary_recall': 0.31415242, 'binary_specificity': 0.989476, 'binary_f1_score': 0.3899614}
confusion matrix:
       0    1
0  17958  191
1    441  202
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9550975, 'precision': 0.68511236, 'recall': 0.57712287, 'specificity': 0.57712287, 'f1': 0.60560143, 'auroc': 0.82464427, 'binary_precision': 0.4056604, 'binary_recall': 0.16475096, 'binary_specificity': 0.98949474, 'binary_f1_score': 0.23433244}
confusion matrix:
      0   1
0  5934  63
1   218  43
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546984_16.png
early stop counter: 6
val acc:0.9663686752319336, best validation acc: 0.9671136736869812, corresponding to test acc:                         0.959092378616333 / 0.9638862013816833
after epoch: 16,now: 2024-06-22 12:49:01.729307,epoch time: 0:09:33.034628,used: 2:33:13.391874,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9926584, 'precision': 0.9848387, 'recall': 0.9719129, 'specificity': 0.9719129, 'f1': 0.97826576, 'auroc': 0.9971982, 'binary_precision': 0.9752625, 'binary_recall': 0.9463315, 'binary_specificity': 0.99749434, 'binary_f1_score': 0.9605792}
confusion matrix:
       0     1
0  42198   106
1    237  4179
---- Validation: 
scalar performance:
{'acc': 0.9663687, 'precision': 0.74577117, 'recall': 0.621812, 'specificity': 0.621812, 'f1': 0.66082877, 'auroc': 0.8383947, 'binary_precision': 0.51757187, 'binary_recall': 0.251944, 'binary_specificity': 0.99167997, 'binary_f1_score': 0.3389121}
confusion matrix:
       0    1
0  17998  151
1    481  162
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9544583, 'precision': 0.669243, 'recall': 0.563963, 'specificity': 0.563963, 'f1': 0.5891206, 'auroc': 0.824264, 'binary_precision': 0.375, 'binary_recall': 0.13793103, 'binary_specificity': 0.989995, 'binary_f1_score': 0.20168066}
confusion matrix:
      0   1
0  5937  60
1   225  36
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546984_17.png
early stop counter: 7
val acc:0.9663686752319336, best validation acc: 0.9671136736869812, corresponding to test acc:                         0.959092378616333 / 0.9638862013816833
after epoch: 17,now: 2024-06-22 12:58:25.428914,epoch time: 0:09:23.699607,used: 2:42:37.091481,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9933005, 'precision': 0.98797005, 'recall': 0.97255975, 'specificity': 0.97255975, 'f1': 0.9801093, 'auroc': 0.99751, 'binary_precision': 0.98145103, 'binary_recall': 0.94698685, 'binary_specificity': 0.99813265, 'binary_f1_score': 0.963911}
confusion matrix:
       0     1
0  42227    79
1    234  4180
---- Validation: 
scalar performance:
{'acc': 0.96695405, 'precision': 0.7552049, 'recall': 0.622115, 'specificity': 0.622115, 'f1': 0.66295403, 'auroc': 0.83943176, 'binary_precision': 0.53642386, 'binary_recall': 0.251944, 'binary_specificity': 0.9922861, 'binary_f1_score': 0.34285715}
confusion matrix:
       0    1
0  18009  140
1    481  162
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.957814, 'precision': 0.721456, 'recall': 0.5638816, 'specificity': 0.5638816, 'f1': 0.59395474, 'auroc': 0.828592, 'binary_precision': 0.47945204, 'binary_recall': 0.13409962, 'binary_specificity': 0.9936635, 'binary_f1_score': 0.20958084}
confusion matrix:
      0   1
0  5959  38
1   226  35
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546984_18.png
early stop counter: 8
val acc:0.9669540524482727, best validation acc: 0.9671136736869812, corresponding to test acc:                         0.959092378616333 / 0.9638862013816833
after epoch: 18,now: 2024-06-22 13:08:03.309486,epoch time: 0:09:37.880572,used: 2:52:14.972053,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9929367, 'precision': 0.9858155, 'recall': 0.9725558, 'specificity': 0.9725558, 'f1': 0.97907007, 'auroc': 0.9969884, 'binary_precision': 0.97709745, 'binary_recall': 0.94742805, 'binary_specificity': 0.9976836, 'binary_f1_score': 0.96203405}
confusion matrix:
       0     1
0  42209    98
1    232  4181
---- Validation: 
scalar performance:
{'acc': 0.96722007, 'precision': 0.75911164, 'recall': 0.6260031, 'specificity': 0.6260031, 'f1': 0.667382, 'auroc': 0.82819545, 'binary_precision': 0.5439739, 'binary_recall': 0.25972006, 'binary_specificity': 0.9922861, 'binary_f1_score': 0.35157892}
confusion matrix:
       0    1
0  18009  140
1    476  167
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9550975, 'precision': 0.6719307, 'recall': 0.5569672, 'specificity': 0.5569672, 'f1': 0.58120984, 'auroc': 0.8143264, 'binary_precision': 0.3809524, 'binary_recall': 0.12260536, 'binary_specificity': 0.991329, 'binary_f1_score': 0.18550725}
confusion matrix:
      0   1
0  5945  52
1   229  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546984_19.png
better model found
persisted
after epoch: 19,now: 2024-06-22 13:17:28.275141,epoch time: 0:09:24.965655,used: 3:01:39.937708,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9933005, 'precision': 0.98596597, 'recall': 0.97459435, 'specificity': 0.97459435, 'f1': 0.9801953, 'auroc': 0.99793637, 'binary_precision': 0.97697675, 'binary_recall': 0.9515289, 'binary_specificity': 0.99765986, 'binary_f1_score': 0.9640849}
confusion matrix:
       0     1
0  42206    99
1    214  4201
---- Validation: 
scalar performance:
{'acc': 0.9671137, 'precision': 0.75861835, 'recall': 0.61769736, 'specificity': 0.61769736, 'f1': 0.6593118, 'auroc': 0.838794, 'binary_precision': 0.543554, 'binary_recall': 0.24261275, 'binary_specificity': 0.992782, 'binary_f1_score': 0.33548385}
confusion matrix:
       0    1
0  18018  131
1    487  156
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95637584, 'precision': 0.68966216, 'recall': 0.5539695, 'specificity': 0.5539695, 'f1': 0.578886, 'auroc': 0.82250255, 'binary_precision': 0.41666666, 'binary_recall': 0.11494253, 'binary_specificity': 0.9929965, 'binary_f1_score': 0.18018018}
confusion matrix:
      0   1
0  5955  42
1   231  30
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546984_20.png
early stop counter: 1
val acc:0.9671136736869812, best validation acc: 0.9672200679779053, corresponding to test acc:                         0.955097496509552 / 0.9638862013816833
after epoch: 20,now: 2024-06-22 13:26:55.334954,epoch time: 0:09:27.059813,used: 3:11:06.997521,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99235874, 'precision': 0.9789225, 'recall': 0.97629607, 'specificity': 0.97629607, 'f1': 0.97760475, 'auroc': 0.99760807, 'binary_precision': 0.9623803, 'binary_recall': 0.9564922, 'binary_specificity': 0.99609995, 'binary_f1_score': 0.9594272}
confusion matrix:
       0     1
0  42142   165
1    192  4221
---- Validation: 
scalar performance:
{'acc': 0.9665815, 'precision': 0.7478651, 'recall': 0.645924, 'specificity': 0.645924, 'f1': 0.68235815, 'auroc': 0.8334229, 'binary_precision': 0.5201072, 'binary_recall': 0.30171072, 'binary_specificity': 0.9901372, 'binary_f1_score': 0.38188976}
confusion matrix:
       0    1
0  17970  179
1    449  194
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95238096, 'precision': 0.65294635, 'recall': 0.5702085, 'specificity': 0.5702085, 'f1': 0.5935446, 'auroc': 0.80704165, 'binary_precision': 0.34188035, 'binary_recall': 0.1532567, 'binary_specificity': 0.98716027, 'binary_f1_score': 0.21164022}
confusion matrix:
      0   1
0  5920  77
1   221  40
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546984_21.png
early stop counter: 2
val acc:0.9665815234184265, best validation acc: 0.9672200679779053, corresponding to test acc:                         0.955097496509552 / 0.9638862013816833
after epoch: 21,now: 2024-06-22 13:36:13.060441,epoch time: 0:09:17.725487,used: 3:20:24.723008,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99306506, 'precision': 0.9865044, 'recall': 0.97263265, 'specificity': 0.97263265, 'f1': 0.9794421, 'auroc': 0.99761856, 'binary_precision': 0.9784745, 'binary_recall': 0.94743997, 'binary_specificity': 0.9978254, 'binary_f1_score': 0.9627071}
confusion matrix:
       0     1
0  42214    92
1    232  4182
---- Validation: 
scalar performance:
{'acc': 0.9675926, 'precision': 0.7651414, 'recall': 0.62769604, 'specificity': 0.62769604, 'f1': 0.67014706, 'auroc': 0.8502151, 'binary_precision': 0.5559211, 'binary_recall': 0.2628305, 'binary_specificity': 0.9925616, 'binary_f1_score': 0.35691658}
confusion matrix:
       0    1
0  18014  135
1    474  169
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95685524, 'precision': 0.69415396, 'recall': 0.5468903, 'specificity': 0.5468903, 'f1': 0.5696743, 'auroc': 0.8232032, 'binary_precision': 0.4262295, 'binary_recall': 0.099616855, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.16149068}
confusion matrix:
      0   1
0  5962  35
1   235  26
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546984_22.png
better model found
persisted
after epoch: 22,now: 2024-06-22 13:45:36.925539,epoch time: 0:09:23.865098,used: 3:29:48.588106,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99300086, 'precision': 0.9850639, 'recall': 0.9737076, 'specificity': 0.9737076, 'f1': 0.9793009, 'auroc': 0.9974647, 'binary_precision': 0.9753374, 'binary_recall': 0.9499207, 'binary_specificity': 0.9974945, 'binary_f1_score': 0.96246123}
confusion matrix:
       0     1
0  42201   106
1    221  4192
---- Validation: 
scalar performance:
{'acc': 0.9667944, 'precision': 0.75322187, 'recall': 0.61603194, 'specificity': 0.61603194, 'f1': 0.65672356, 'auroc': 0.8329931, 'binary_precision': 0.53287196, 'binary_recall': 0.23950233, 'binary_specificity': 0.9925616, 'binary_f1_score': 0.3304721}
confusion matrix:
       0    1
0  18014  135
1    489  154
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9544583, 'precision': 0.65986395, 'recall': 0.55296904, 'specificity': 0.55296904, 'f1': 0.57524836, 'auroc': 0.81123316, 'binary_precision': 0.35714287, 'binary_recall': 0.11494253, 'binary_specificity': 0.9909955, 'binary_f1_score': 0.17391305}
confusion matrix:
      0   1
0  5943  54
1   231  30
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546984_23.png
early stop counter: 1
val acc:0.9667943716049194, best validation acc: 0.9675925970077515, corresponding to test acc:                         0.9568552374839783 / 0.9638862013816833
after epoch: 23,now: 2024-06-22 13:55:07.517796,epoch time: 0:09:30.592257,used: 3:39:19.180363,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9928938, 'precision': 0.9846913, 'recall': 0.9734398, 'specificity': 0.9734398, 'f1': 0.97898227, 'auroc': 0.9971484, 'binary_precision': 0.97463936, 'binary_recall': 0.94945604, 'binary_specificity': 0.99742365, 'binary_f1_score': 0.9618829}
confusion matrix:
       0     1
0  42199   109
1    223  4189
---- Validation: 
scalar performance:
{'acc': 0.96674114, 'precision': 0.7511101, 'recall': 0.62875533, 'specificity': 0.62875533, 'f1': 0.66830134, 'auroc': 0.84021807, 'binary_precision': 0.5277778, 'binary_recall': 0.2659409, 'binary_specificity': 0.99156976, 'binary_f1_score': 0.35367116}
confusion matrix:
       0    1
0  17996  153
1    472  171
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9542985, 'precision': 0.6595254, 'recall': 0.55471796, 'specificity': 0.55471796, 'f1': 0.5773283, 'auroc': 0.8166342, 'binary_precision': 0.35632184, 'binary_recall': 0.118773945, 'binary_specificity': 0.990662, 'binary_f1_score': 0.17816092}
confusion matrix:
      0   1
0  5941  56
1   230  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546984_24.png
early stop counter: 2
val acc:0.966741144657135, best validation acc: 0.9675925970077515, corresponding to test acc:                         0.9568552374839783 / 0.9638862013816833
after epoch: 24,now: 2024-06-22 14:04:28.974055,epoch time: 0:09:21.456259,used: 3:48:40.636622,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99411386, 'precision': 0.98950315, 'recall': 0.97583914, 'specificity': 0.97583914, 'f1': 0.9825494, 'auroc': 0.99808276, 'binary_precision': 0.98385966, 'binary_recall': 0.9533092, 'binary_specificity': 0.9983691, 'binary_f1_score': 0.9683435}
confusion matrix:
       0     1
0  42239    69
1    206  4206
---- Validation: 
scalar performance:
{'acc': 0.9675926, 'precision': 0.773795, 'recall': 0.59844387, 'specificity': 0.59844387, 'f1': 0.6413036, 'auroc': 0.82321674, 'binary_precision': 0.57522124, 'binary_recall': 0.2021773, 'binary_specificity': 0.99471045, 'binary_f1_score': 0.29919448}
confusion matrix:
       0    1
0  18053   96
1    513  130
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95701504, 'precision': 0.6906701, 'recall': 0.537812, 'specificity': 0.537812, 'f1': 0.556504, 'auroc': 0.795214, 'binary_precision': 0.42, 'binary_recall': 0.08045977, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.13504823}
confusion matrix:
      0   1
0  5968  29
1   240  21
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546984_25.png
early stop counter: 3
val acc:0.9675925970077515, best validation acc: 0.9675925970077515, corresponding to test acc:                         0.9568552374839783 / 0.9638862013816833
after epoch: 25,now: 2024-06-22 14:14:29.186300,epoch time: 0:10:00.212245,used: 3:58:40.848867,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99336475, 'precision': 0.98511225, 'recall': 0.9758315, 'specificity': 0.9758315, 'f1': 0.98041534, 'auroc': 0.9974357, 'binary_precision': 0.9749884, 'binary_recall': 0.95421576, 'binary_specificity': 0.9974473, 'binary_f1_score': 0.96449023}
confusion matrix:
       0     1
0  42200   108
1    202  4210
---- Validation: 
scalar performance:
{'acc': 0.9673265, 'precision': 0.7600331, 'recall': 0.63130856, 'specificity': 0.63130856, 'f1': 0.67249024, 'auroc': 0.8479618, 'binary_precision': 0.54545456, 'binary_recall': 0.27060652, 'binary_specificity': 0.9920106, 'binary_f1_score': 0.36174634}
confusion matrix:
       0    1
0  18004  145
1    469  174
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9550975, 'precision': 0.6573268, 'recall': 0.5423085, 'specificity': 0.5423085, 'f1': 0.5614196, 'auroc': 0.8143016, 'binary_precision': 0.3529412, 'binary_recall': 0.09195402, 'binary_specificity': 0.992663, 'binary_f1_score': 0.14589664}
confusion matrix:
      0   1
0  5953  44
1   237  24
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546984_26.png
early stop counter: 4
val acc:0.9673265218734741, best validation acc: 0.9675925970077515, corresponding to test acc:                         0.9568552374839783 / 0.9638862013816833
after epoch: 26,now: 2024-06-22 14:23:52.236065,epoch time: 0:09:23.049765,used: 4:08:03.898632,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9928724, 'precision': 0.9891263, 'recall': 0.9688601, 'specificity': 0.9688601, 'f1': 0.97872365, 'auroc': 0.99710083, 'binary_precision': 0.9845569, 'binary_recall': 0.93925655, 'binary_specificity': 0.99846363, 'binary_f1_score': 0.9613734}
confusion matrix:
       0     1
0  42243    65
1    268  4144
---- Validation: 
scalar performance:
{'acc': 0.967433, 'precision': 0.7697574, 'recall': 0.59911126, 'specificity': 0.59911126, 'f1': 0.64154994, 'auroc': 0.84354657, 'binary_precision': 0.5670996, 'binary_recall': 0.2037325, 'binary_specificity': 0.99449, 'binary_f1_score': 0.29977116}
confusion matrix:
       0    1
0  18049  100
1    512  131
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95669544, 'precision': 0.6844419, 'recall': 0.5394776, 'specificity': 0.5394776, 'f1': 0.5587356, 'auroc': 0.82075334, 'binary_precision': 0.4074074, 'binary_recall': 0.08429119, 'binary_specificity': 0.994664, 'binary_f1_score': 0.13968255}
confusion matrix:
      0   1
0  5965  32
1   239  22
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546984_27.png
early stop counter: 5
val acc:0.967432975769043, best validation acc: 0.9675925970077515, corresponding to test acc:                         0.9568552374839783 / 0.9638862013816833
after epoch: 27,now: 2024-06-22 14:33:10.714806,epoch time: 0:09:18.478741,used: 4:17:22.377373,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9928296, 'precision': 0.9864459, 'recall': 0.9712789, 'specificity': 0.9712789, 'f1': 0.9787112, 'auroc': 0.9974315, 'binary_precision': 0.97863847, 'binary_recall': 0.9447088, 'binary_specificity': 0.99784905, 'binary_f1_score': 0.9613744}
confusion matrix:
       0     1
0  42216    91
1    244  4169
---- Validation: 
scalar performance:
{'acc': 0.96674114, 'precision': 0.7545161, 'recall': 0.5995032, 'specificity': 0.5995032, 'f1': 0.63996536, 'auroc': 0.8330767, 'binary_precision': 0.5365854, 'binary_recall': 0.20528771, 'binary_specificity': 0.9937187, 'binary_f1_score': 0.2969629}
confusion matrix:
       0    1
0  18035  114
1    511  132
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9547779, 'precision': 0.6498931, 'recall': 0.5403094, 'specificity': 0.5403094, 'f1': 0.55829805, 'auroc': 0.80321467, 'binary_precision': 0.3382353, 'binary_recall': 0.08812261, 'binary_specificity': 0.99249625, 'binary_f1_score': 0.13981763}
confusion matrix:
      0   1
0  5952  45
1   238  23
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546984_28.png
early stop counter: 6
val acc:0.966741144657135, best validation acc: 0.9675925970077515, corresponding to test acc:                         0.9568552374839783 / 0.9638862013816833
after epoch: 28,now: 2024-06-22 14:42:35.567520,epoch time: 0:09:24.852714,used: 4:26:47.230087,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9938356, 'precision': 0.98963225, 'recall': 0.97406137, 'specificity': 0.97406137, 'f1': 0.9816885, 'auroc': 0.9979657, 'binary_precision': 0.9844925, 'binary_recall': 0.9496827, 'binary_specificity': 0.99844, 'binary_f1_score': 0.96677434}
confusion matrix:
       0     1
0  42242    66
1    222  4190
---- Validation: 
scalar performance:
{'acc': 0.96647507, 'precision': 0.74822575, 'recall': 0.6098662, 'specificity': 0.6098662, 'f1': 0.6497594, 'auroc': 0.8307191, 'binary_precision': 0.5232975, 'binary_recall': 0.22706065, 'binary_specificity': 0.9926718, 'binary_f1_score': 0.3167028}
confusion matrix:
       0    1
0  18016  133
1    497  146
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95317996, 'precision': 0.63802016, 'recall': 0.546805, 'specificity': 0.546805, 'f1': 0.56577104, 'auroc': 0.7947275, 'binary_precision': 0.3139535, 'binary_recall': 0.10344828, 'binary_specificity': 0.9901618, 'binary_f1_score': 0.1556196}
confusion matrix:
      0   1
0  5938  59
1   234  27
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546984_29.png
early stop counter: 7
val acc:0.9664750695228577, best validation acc: 0.9675925970077515, corresponding to test acc:                         0.9568552374839783 / 0.9638862013816833
after epoch: 29,now: 2024-06-22 14:52:14.257175,epoch time: 0:09:38.689655,used: 4:36:25.919742,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99342895, 'precision': 0.98753506, 'recall': 0.97371244, 'specificity': 0.97371244, 'f1': 0.9804986, 'auroc': 0.99783593, 'binary_precision': 0.98032326, 'binary_recall': 0.94941014, 'binary_specificity': 0.99801475, 'binary_f1_score': 0.9646191}
confusion matrix:
       0     1
0  42228    84
1    223  4185
---- Validation: 
scalar performance:
{'acc': 0.96663475, 'precision': 0.7492986, 'recall': 0.63170046, 'specificity': 0.63170046, 'f1': 0.67055583, 'auroc': 0.8426985, 'binary_precision': 0.52395207, 'binary_recall': 0.27216175, 'binary_specificity': 0.9912392, 'binary_f1_score': 0.3582395}
confusion matrix:
       0    1
0  17990  159
1    468  175
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9533397, 'precision': 0.66601115, 'recall': 0.57620573, 'specificity': 0.57620573, 'f1': 0.60172826, 'auroc': 0.82693744, 'binary_precision': 0.36752138, 'binary_recall': 0.16475096, 'binary_specificity': 0.98766047, 'binary_f1_score': 0.22751324}
confusion matrix:
      0   1
0  5923  74
1   218  43
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546984_30.png
early stop counter: 8
val acc:0.9666347503662109, best validation acc: 0.9675925970077515, corresponding to test acc:                         0.9568552374839783 / 0.9638862013816833
after epoch: 30,now: 2024-06-22 15:02:20.658240,epoch time: 0:10:06.401065,used: 4:46:32.320807,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 4:46:32.320807 at 2024-06-22 15:02:20.658240
persisted model performance metric: 

scalar performance:
{'acc': 0.95685524, 'precision': 0.69415396, 'recall': 0.5468903, 'specificity': 0.5468903, 'f1': 0.5696743, 'auroc': 0.8232032, 'binary_precision': 0.4262295, 'binary_recall': 0.099616855, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.16149068}
confusion matrix:
      0   1
0  5962  35
1   235  26
oracle model performance metric: 

scalar performance:
{'acc': 0.9638862, 'precision': 0.80854326, 'recall': 0.6440078, 'specificity': 0.6440078, 'f1': 0.69332045, 'auroc': 0.817557, 'binary_precision': 0.64705884, 'binary_recall': 0.29501915, 'binary_specificity': 0.9929965, 'binary_f1_score': 0.40526316}
confusion matrix:
      0   1
0  5955  42
1   184  77
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_resnet_differentlearningrates_bs32_classbalancing3/rule_results/2.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_resnet_differentlearningrates_bs32_classbalancing3/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_resnet_differentlearningrates_bs32_classbalancing3/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204391 KiB | 755277 KiB | 711703 GiB | 711703 GiB |
|       from large pool | 167936 KiB | 683136 KiB | 711530 GiB | 711530 GiB |
|       from small pool |  36455 KiB |  73422 KiB |    173 GiB |    173 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 204391 KiB | 755277 KiB | 711703 GiB | 711703 GiB |
|       from large pool | 167936 KiB | 683136 KiB | 711530 GiB | 711530 GiB |
|       from small pool |  36455 KiB |  73422 KiB |    173 GiB |    173 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201088 KiB | 748328 KiB | 711586 GiB | 711586 GiB |
|       from large pool | 165120 KiB | 676736 KiB | 711420 GiB | 711420 GiB |
|       from small pool |  35968 KiB |  72872 KiB |    165 GiB |    165 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    930 MiB |    930 MiB |    930 MiB |      0 B   |
|       from large pool |    858 MiB |    858 MiB |    858 MiB |      0 B   |
|       from small pool |     72 MiB |     72 MiB |     72 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 104856 KiB | 245592 KiB | 285290 GiB | 285290 GiB |
|       from large pool |  96256 KiB | 244616 KiB | 285116 GiB | 285116 GiB |
|       from small pool |   8600 KiB |  12473 KiB |    174 GiB |    174 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2076    |    3669    |   44382 K  |   44380 K  |
|       from large pool |      36    |      76    |   18225 K  |   18225 K  |
|       from small pool |    2040    |    3632    |   26156 K  |   26154 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2076    |    3669    |   44382 K  |   44380 K  |
|       from large pool |      36    |      76    |   18225 K  |   18225 K  |
|       from small pool |    2040    |    3632    |   26156 K  |   26154 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      51    |      51    |      51    |       0    |
|       from large pool |      15    |      15    |      15    |       0    |
|       from small pool |      36    |      36    |      36    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      34    |    1476    |   19206 K  |   19206 K  |
|       from large pool |       5    |      10    |    5763 K  |    5763 K  |
|       from small pool |      29    |    1471    |   13443 K  |   13443 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 755277 KiB | 711703 GiB | 711703 GiB |
|       from large pool |  16640 KiB | 683136 KiB | 711530 GiB | 711530 GiB |
|       from small pool |      0 KiB |  73422 KiB |    173 GiB |    173 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 755277 KiB | 711703 GiB | 711703 GiB |
|       from large pool |  16640 KiB | 683136 KiB | 711530 GiB | 711530 GiB |
|       from small pool |      0 KiB |  73422 KiB |    173 GiB |    173 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 748328 KiB | 711586 GiB | 711586 GiB |
|       from large pool |  16640 KiB | 676736 KiB | 711420 GiB | 711420 GiB |
|       from small pool |      0 KiB |  72872 KiB |    165 GiB |    165 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 309248 KiB |    930 MiB |    930 MiB | 643072 KiB |
|       from large pool | 264192 KiB |    858 MiB |    858 MiB | 614400 KiB |
|       from small pool |  45056 KiB |     72 MiB |     72 MiB |  28672 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  83712 KiB | 245592 KiB | 285291 GiB | 285290 GiB |
|       from large pool |  83712 KiB | 244616 KiB | 285116 GiB | 285116 GiB |
|       from small pool |      0 KiB |  16195 KiB |    174 GiB |    174 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3669    |   44382 K  |   44382 K  |
|       from large pool |       2    |      76    |   18225 K  |   18225 K  |
|       from small pool |       0    |    3632    |   26156 K  |   26156 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3669    |   44382 K  |   44382 K  |
|       from large pool |       2    |      76    |   18225 K  |   18225 K  |
|       from small pool |       0    |    3632    |   26156 K  |   26156 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      51    |      51    |      20    |
|       from large pool |       9    |      15    |      15    |       6    |
|       from small pool |      22    |      36    |      36    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |    1476    |   19207 K  |   19207 K  |
|       from large pool |       1    |      11    |    5763 K  |    5763 K  |
|       from small pool |       0    |    1471    |   13444 K  |   13444 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 755277 KiB | 711703 GiB | 711703 GiB |
|       from large pool |  16640 KiB | 683136 KiB | 711530 GiB | 711530 GiB |
|       from small pool |      0 KiB |  73422 KiB |    173 GiB |    173 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 755277 KiB | 711703 GiB | 711703 GiB |
|       from large pool |  16640 KiB | 683136 KiB | 711530 GiB | 711530 GiB |
|       from small pool |      0 KiB |  73422 KiB |    173 GiB |    173 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 748328 KiB | 711586 GiB | 711586 GiB |
|       from large pool |  16640 KiB | 676736 KiB | 711420 GiB | 711420 GiB |
|       from small pool |      0 KiB |  72872 KiB |    165 GiB |    165 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 309248 KiB |    930 MiB |    930 MiB | 643072 KiB |
|       from large pool | 264192 KiB |    858 MiB |    858 MiB | 614400 KiB |
|       from small pool |  45056 KiB |     72 MiB |     72 MiB |  28672 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  83712 KiB | 245592 KiB | 285291 GiB | 285290 GiB |
|       from large pool |  83712 KiB | 244616 KiB | 285116 GiB | 285116 GiB |
|       from small pool |      0 KiB |  16195 KiB |    174 GiB |    174 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3669    |   44382 K  |   44382 K  |
|       from large pool |       2    |      76    |   18225 K  |   18225 K  |
|       from small pool |       0    |    3632    |   26156 K  |   26156 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3669    |   44382 K  |   44382 K  |
|       from large pool |       2    |      76    |   18225 K  |   18225 K  |
|       from small pool |       0    |    3632    |   26156 K  |   26156 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      51    |      51    |      20    |
|       from large pool |       9    |      15    |      15    |       6    |
|       from small pool |      22    |      36    |      36    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |    1476    |   19207 K  |   19207 K  |
|       from large pool |       1    |      11    |    5763 K  |    5763 K  |
|       from small pool |       0    |    1471    |   13444 K  |   13444 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0




!!!: not committed yet



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_15_06_17_seed_1_21546984

 Experiment start at: 2024-06-22 15:06:17.706228
before training, model accuracy: 0.14647115767002106
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9744435, 'precision': 0.9615638, 'recall': 0.881509, 'specificity': 0.881509, 'f1': 0.91681993, 'auroc': 0.9797213, 'binary_precision': 0.9464082, 'binary_recall': 0.7674526, 'binary_specificity': 0.9955654, 'binary_f1_score': 0.84758747}
confusion matrix:
       0     1
0  42206   188
1   1006  3320
---- Validation: 
scalar performance:
{'acc': 0.9653148, 'precision': 0.7667142, 'recall': 0.5728785, 'specificity': 0.5728785, 'f1': 0.6096716, 'auroc': 0.7095026, 'binary_precision': 0.5642458, 'binary_recall': 0.15007429, 'binary_specificity': 0.9956827, 'binary_f1_score': 0.2370892}
confusion matrix:
       0    1
0  17989   78
1    572  101
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.7315901, 'recall': 0.5625256, 'specificity': 0.5625256, 'f1': 0.5929005, 'auroc': 0.7639928, 'binary_precision': 0.5, 'binary_recall': 0.13076924, 'binary_specificity': 0.9942819, 'binary_f1_score': 0.20731708}
confusion matrix:
      0   1
0  5912  34
1   226  34
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546984_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-22 15:15:35.295257,epoch time: 0:09:17.589029,used: 0:09:17.589029,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_15_06_17_seed_1_21546984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9839897, 'precision': 0.9760578, 'recall': 0.9267479, 'specificity': 0.9267479, 'f1': 0.9497254, 'auroc': 0.98928905, 'binary_precision': 0.9665709, 'binary_recall': 0.8565147, 'binary_specificity': 0.9969811, 'binary_f1_score': 0.9082209}
confusion matrix:
       0     1
0  42271   128
1    620  3701
---- Validation: 
scalar performance:
{'acc': 0.9655283, 'precision': 0.75981903, 'recall': 0.61161363, 'specificity': 0.61161363, 'f1': 0.6532904, 'auroc': 0.7800399, 'binary_precision': 0.5477032, 'binary_recall': 0.23031203, 'binary_specificity': 0.9929153, 'binary_f1_score': 0.32426777}
confusion matrix:
       0    1
0  17939  128
1    518  155
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96471155, 'precision': 0.83600605, 'recall': 0.63401574, 'specificity': 0.63401574, 'f1': 0.6875895, 'auroc': 0.8175912, 'binary_precision': 0.7029703, 'binary_recall': 0.27307692, 'binary_specificity': 0.9949546, 'binary_f1_score': 0.3933518}
confusion matrix:
      0   1
0  5916  30
1   189  71
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546984_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-22 15:25:15.906109,epoch time: 0:09:40.610852,used: 0:18:58.199881,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_15_06_17_seed_1_21546984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.98557365, 'precision': 0.9760466, 'recall': 0.9364681, 'specificity': 0.9364681, 'f1': 0.9551859, 'auroc': 0.9913818, 'binary_precision': 0.964595, 'binary_recall': 0.87621474, 'binary_specificity': 0.99672157, 'binary_f1_score': 0.9182832}
confusion matrix:
       0     1
0  42259   139
1    535  3787
---- Validation: 
scalar performance:
{'acc': 0.9665422, 'precision': 0.7778019, 'recall': 0.61643106, 'specificity': 0.61643106, 'f1': 0.66107047, 'auroc': 0.7851903, 'binary_precision': 0.5833333, 'binary_recall': 0.23922734, 'binary_specificity': 0.9936348, 'binary_f1_score': 0.3393045}
confusion matrix:
       0    1
0  17952  115
1    512  161
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9653561, 'precision': 0.8400557, 'recall': 0.64354706, 'specificity': 0.64354706, 'f1': 0.69815964, 'auroc': 0.81827426, 'binary_precision': 0.71028036, 'binary_recall': 0.2923077, 'binary_specificity': 0.9947864, 'binary_f1_score': 0.41416898}
confusion matrix:
      0   1
0  5915  31
1   184  76
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546984_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-22 15:34:46.296203,epoch time: 0:09:30.390094,used: 0:28:28.589975,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_15_06_17_seed_1_21546984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9880351, 'precision': 0.9744143, 'recall': 0.9532943, 'specificity': 0.9532943, 'f1': 0.96355283, 'auroc': 0.99444544, 'binary_precision': 0.95788705, 'binary_recall': 0.91066885, 'binary_specificity': 0.9959197, 'binary_f1_score': 0.93368137}
confusion matrix:
       0     1
0  42226   173
1    386  3935
---- Validation: 
scalar performance:
{'acc': 0.96510136, 'precision': 0.7493596, 'recall': 0.6478709, 'specificity': 0.6478709, 'f1': 0.68426573, 'auroc': 0.8286495, 'binary_precision': 0.524173, 'binary_recall': 0.3060921, 'binary_specificity': 0.98964965, 'binary_f1_score': 0.38649154}
confusion matrix:
       0    1
0  17880  187
1    467  206
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9655172, 'precision': 0.8269607, 'recall': 0.66202104, 'specificity': 0.66202104, 'f1': 0.71390057, 'auroc': 0.8480811, 'binary_precision': 0.6825397, 'binary_recall': 0.33076924, 'binary_specificity': 0.9932728, 'binary_f1_score': 0.44559586}
confusion matrix:
      0   1
0  5906  40
1   174  86
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546984_4.png
new oracle model saved
early stop counter: 1
val acc:0.9651013612747192, best validation acc: 0.9665421843528748, corresponding to test acc:                         0.9653561115264893 / 0.9655172228813171
after epoch: 4,now: 2024-06-22 15:44:10.523133,epoch time: 0:09:24.226930,used: 0:37:52.816905,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_15_06_17_seed_1_21546984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.988506, 'precision': 0.9778303, 'recall': 0.9527644, 'specificity': 0.9527644, 'f1': 0.9648746, 'auroc': 0.9938675, 'binary_precision': 0.96489936, 'binary_recall': 0.90890175, 'binary_specificity': 0.996627, 'binary_f1_score': 0.9360638}
confusion matrix:
       0     1
0  42252   143
1    394  3931
---- Validation: 
scalar performance:
{'acc': 0.9660619, 'precision': 0.76603997, 'recall': 0.6261957, 'specificity': 0.6261957, 'f1': 0.668771, 'auroc': 0.81488335, 'binary_precision': 0.55910546, 'binary_recall': 0.2600297, 'binary_specificity': 0.9923618, 'binary_f1_score': 0.35496956}
confusion matrix:
       0    1
0  17929  138
1    498  175
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96455044, 'precision': 0.8273417, 'recall': 0.63944864, 'specificity': 0.63944864, 'f1': 0.6919538, 'auroc': 0.83377755, 'binary_precision': 0.6851852, 'binary_recall': 0.2846154, 'binary_specificity': 0.9942819, 'binary_f1_score': 0.4021739}
confusion matrix:
      0   1
0  5912  34
1   186  74
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546984_5.png
early stop counter: 2
val acc:0.9660618901252747, best validation acc: 0.9665421843528748, corresponding to test acc:                         0.9653561115264893 / 0.9655172228813171
after epoch: 5,now: 2024-06-22 15:53:35.418682,epoch time: 0:09:24.895549,used: 0:47:17.712454,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_15_06_17_seed_1_21546984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9900899, 'precision': 0.98365015, 'recall': 0.9566574, 'specificity': 0.9566574, 'f1': 0.96966946, 'auroc': 0.99450946, 'binary_precision': 0.9758561, 'binary_recall': 0.91562647, 'binary_specificity': 0.99768835, 'binary_f1_score': 0.9447824}
confusion matrix:
       0     1
0  42296    98
1    365  3961
---- Validation: 
scalar performance:
{'acc': 0.96616864, 'precision': 0.7678392, 'recall': 0.6262511, 'specificity': 0.6262511, 'f1': 0.66915965, 'auroc': 0.81786656, 'binary_precision': 0.562701, 'binary_recall': 0.2600297, 'binary_specificity': 0.99247247, 'binary_f1_score': 0.35569108}
confusion matrix:
       0    1
0  17931  136
1    498  175
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96100545, 'precision': 0.77854073, 'recall': 0.61001384, 'specificity': 0.61001384, 'f1': 0.65384907, 'auroc': 0.82951516, 'binary_precision': 0.59, 'binary_recall': 0.22692308, 'binary_specificity': 0.99310464, 'binary_f1_score': 0.32777777}
confusion matrix:
      0   1
0  5905  41
1   201  59
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546984_6.png
early stop counter: 3
val acc:0.9661686420440674, best validation acc: 0.9665421843528748, corresponding to test acc:                         0.9653561115264893 / 0.9655172228813171
after epoch: 6,now: 2024-06-22 16:03:00.247347,epoch time: 0:09:24.828665,used: 0:56:42.541119,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_15_06_17_seed_1_21546984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9900685, 'precision': 0.9809144, 'recall': 0.9592131, 'specificity': 0.9592131, 'f1': 0.96975017, 'auroc': 0.9952599, 'binary_precision': 0.9698076, 'binary_recall': 0.9213509, 'binary_specificity': 0.99707526, 'binary_f1_score': 0.9449584}
confusion matrix:
       0     1
0  42273   124
1    340  3983
---- Validation: 
scalar performance:
{'acc': 0.96568835, 'precision': 0.7612256, 'recall': 0.61884934, 'specificity': 0.61884934, 'f1': 0.66077214, 'auroc': 0.83246815, 'binary_precision': 0.55, 'binary_recall': 0.24517088, 'binary_specificity': 0.99252784, 'binary_f1_score': 0.33915725}
confusion matrix:
       0    1
0  17932  135
1    508  165
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96310025, 'precision': 0.8171383, 'recall': 0.61662394, 'specificity': 0.61662394, 'f1': 0.6661424, 'auroc': 0.83607095, 'binary_precision': 0.6666667, 'binary_recall': 0.23846154, 'binary_specificity': 0.9947864, 'binary_f1_score': 0.3512748}
confusion matrix:
      0   1
0  5915  31
1   198  62
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546984_7.png
early stop counter: 4
val acc:0.9656883478164673, best validation acc: 0.9665421843528748, corresponding to test acc:                         0.9653561115264893 / 0.9655172228813171
after epoch: 7,now: 2024-06-22 16:12:17.164654,epoch time: 0:09:16.917307,used: 1:05:59.458426,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_15_06_17_seed_1_21546984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9911387, 'precision': 0.9871078, 'recall': 0.9595859, 'specificity': 0.9595859, 'f1': 0.9728472, 'auroc': 0.99663055, 'binary_precision': 0.982231, 'binary_recall': 0.92086995, 'binary_specificity': 0.9983018, 'binary_f1_score': 0.9505613}
confusion matrix:
       0     1
0  42326    72
1    342  3980
---- Validation: 
scalar performance:
{'acc': 0.9659552, 'precision': 0.77699906, 'recall': 0.5882312, 'specificity': 0.5882312, 'f1': 0.62960565, 'auroc': 0.83123463, 'binary_precision': 0.58373207, 'binary_recall': 0.18127786, 'binary_specificity': 0.9951846, 'binary_f1_score': 0.276644}
confusion matrix:
       0    1
0  17980   87
1    551  122
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96003866, 'precision': 0.7817768, 'recall': 0.56721264, 'specificity': 0.56721264, 'f1': 0.60224533, 'auroc': 0.8319814, 'binary_precision': 0.6, 'binary_recall': 0.13846155, 'binary_specificity': 0.9959637, 'binary_f1_score': 0.22500002}
confusion matrix:
      0   1
0  5922  24
1   224  36
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546984_8.png
early stop counter: 5
val acc:0.9659551978111267, best validation acc: 0.9665421843528748, corresponding to test acc:                         0.9653561115264893 / 0.9655172228813171
after epoch: 8,now: 2024-06-22 16:21:33.672481,epoch time: 0:09:16.507827,used: 1:15:15.966253,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_15_06_17_seed_1_21546984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.990411, 'precision': 0.9785295, 'recall': 0.96375626, 'specificity': 0.96375626, 'f1': 0.97099763, 'auroc': 0.99624264, 'binary_precision': 0.9640632, 'binary_recall': 0.9310504, 'binary_specificity': 0.9964621, 'binary_f1_score': 0.94726926}
confusion matrix:
       0     1
0  42248   150
1    298  4024
---- Validation: 
scalar performance:
{'acc': 0.9655283, 'precision': 0.7575884, 'recall': 0.6244885, 'specificity': 0.6244885, 'f1': 0.66554296, 'auroc': 0.8420719, 'binary_precision': 0.5423198, 'binary_recall': 0.25705793, 'binary_specificity': 0.991919, 'binary_f1_score': 0.34879035}
confusion matrix:
       0    1
0  17921  146
1    500  173
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96036094, 'precision': 0.7703819, 'recall': 0.6004825, 'specificity': 0.6004825, 'f1': 0.6423417, 'auroc': 0.8371041, 'binary_precision': 0.5744681, 'binary_recall': 0.20769231, 'binary_specificity': 0.9932728, 'binary_f1_score': 0.30508474}
confusion matrix:
      0   1
0  5906  40
1   206  54
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546984_9.png
early stop counter: 6
val acc:0.9655283093452454, best validation acc: 0.9665421843528748, corresponding to test acc:                         0.9653561115264893 / 0.9655172228813171
after epoch: 9,now: 2024-06-22 16:30:48.038108,epoch time: 0:09:14.365627,used: 1:24:30.331880,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_15_06_17_seed_1_21546984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9907534, 'precision': 0.98213065, 'recall': 0.9622123, 'specificity': 0.9622123, 'f1': 0.9719084, 'auroc': 0.9954578, 'binary_precision': 0.971657, 'binary_recall': 0.92718446, 'binary_specificity': 0.9972402, 'binary_f1_score': 0.9489}
confusion matrix:
       0     1
0  42277   117
1    315  4011
---- Validation: 
scalar performance:
{'acc': 0.9655283, 'precision': 0.75874734, 'recall': 0.6173358, 'specificity': 0.6173358, 'f1': 0.6588481, 'auroc': 0.8401772, 'binary_precision': 0.5451505, 'binary_recall': 0.24219911, 'binary_specificity': 0.99247247, 'binary_f1_score': 0.33539096}
confusion matrix:
       0    1
0  17931  136
1    510  163
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95633256, 'precision': 0.69943106, 'recall': 0.5671175, 'specificity': 0.5671175, 'f1': 0.5960174, 'auroc': 0.8335254, 'binary_precision': 0.43529412, 'binary_recall': 0.1423077, 'binary_specificity': 0.9919273, 'binary_f1_score': 0.21449277}
confusion matrix:
      0   1
0  5898  48
1   223  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546984_10.png
early stop counter: 7
val acc:0.9655283093452454, best validation acc: 0.9665421843528748, corresponding to test acc:                         0.9653561115264893 / 0.9655172228813171
after epoch: 10,now: 2024-06-22 16:40:03.242266,epoch time: 0:09:15.204158,used: 1:33:45.536038,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_15_06_17_seed_1_21546984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9921661, 'precision': 0.98362994, 'recall': 0.9693217, 'specificity': 0.9693217, 'f1': 0.9763412, 'auroc': 0.99672353, 'binary_precision': 0.9732314, 'binary_recall': 0.94128525, 'binary_specificity': 0.99735814, 'binary_f1_score': 0.95699173}
confusion matrix:
       0     1
0  42282   112
1    254  4072
---- Validation: 
scalar performance:
{'acc': 0.9664888, 'precision': 0.775461, 'recall': 0.61997974, 'specificity': 0.61997974, 'f1': 0.6643187, 'auroc': 0.8364879, 'binary_precision': 0.5783972, 'binary_recall': 0.24665676, 'binary_specificity': 0.9933027, 'binary_f1_score': 0.34583333}
confusion matrix:
       0    1
0  17946  121
1    507  166
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9569771, 'precision': 0.70823574, 'recall': 0.5619369, 'specificity': 0.5619369, 'f1': 0.5904385, 'auroc': 0.8330287, 'binary_precision': 0.45333335, 'binary_recall': 0.13076924, 'binary_specificity': 0.99310464, 'binary_f1_score': 0.2029851}
confusion matrix:
      0   1
0  5905  41
1   226  34
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546984_11.png
early stop counter: 8
val acc:0.966488778591156, best validation acc: 0.9665421843528748, corresponding to test acc:                         0.9653561115264893 / 0.9655172228813171
after epoch: 11,now: 2024-06-22 16:49:16.705644,epoch time: 0:09:13.463378,used: 1:42:58.999416,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_15_06_17_seed_1_21546984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9904752, 'precision': 0.9803938, 'recall': 0.9622499, 'specificity': 0.9622499, 'f1': 0.97110295, 'auroc': 0.99612767, 'binary_precision': 0.96813905, 'binary_recall': 0.9276133, 'binary_specificity': 0.9968865, 'binary_f1_score': 0.94744295}
confusion matrix:
       0     1
0  42264   132
1    313  4011
---- Validation: 
scalar performance:
{'acc': 0.9663821, 'precision': 0.77212894, 'recall': 0.62421596, 'specificity': 0.62421596, 'f1': 0.6679627, 'auroc': 0.8419385, 'binary_precision': 0.5714286, 'binary_recall': 0.25557205, 'binary_specificity': 0.9928599, 'binary_f1_score': 0.35318276}
confusion matrix:
       0    1
0  17938  129
1    501  172
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589107, 'precision': 0.74597573, 'recall': 0.5923698, 'specificity': 0.5923698, 'f1': 0.6302703, 'auroc': 0.8337939, 'binary_precision': 0.5263158, 'binary_recall': 0.1923077, 'binary_specificity': 0.9924319, 'binary_f1_score': 0.28169015}
confusion matrix:
      0   1
0  5901  45
1   210  50
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546984_12.png
early stop counter: 9
val acc:0.9663820862770081, best validation acc: 0.9665421843528748, corresponding to test acc:                         0.9653561115264893 / 0.9655172228813171
after epoch: 12,now: 2024-06-22 16:58:31.987978,epoch time: 0:09:15.282334,used: 1:52:14.281750,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_15_06_17_seed_1_21546984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99199486, 'precision': 0.98483956, 'recall': 0.96704054, 'specificity': 0.96704054, 'f1': 0.9757316, 'auroc': 0.9965303, 'binary_precision': 0.97613883, 'binary_recall': 0.9364162, 'binary_specificity': 0.9976648, 'binary_f1_score': 0.955865}
confusion matrix:
       0     1
0  42296    99
1    275  4050
---- Validation: 
scalar performance:
{'acc': 0.96558166, 'precision': 0.75720555, 'recall': 0.6330993, 'specificity': 0.6330993, 'f1': 0.6734219, 'auroc': 0.8475769, 'binary_precision': 0.5409357, 'binary_recall': 0.27488855, 'binary_specificity': 0.9913101, 'binary_f1_score': 0.36453202}
confusion matrix:
       0    1
0  17910  157
1    488  185
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9572994, 'precision': 0.7225647, 'recall': 0.60256284, 'specificity': 0.60256284, 'f1': 0.6375315, 'auroc': 0.8500901, 'binary_precision': 0.47863248, 'binary_recall': 0.21538462, 'binary_specificity': 0.989741, 'binary_f1_score': 0.29708222}
confusion matrix:
      0   1
0  5885  61
1   204  56
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546984_13.png
early stop counter: 10
val acc:0.9655816555023193, best validation acc: 0.9665421843528748, corresponding to test acc:                         0.9653561115264893 / 0.9655172228813171
after epoch: 13,now: 2024-06-22 17:07:55.852408,epoch time: 0:09:23.864430,used: 2:01:38.146180,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_15_06_17_seed_1_21546984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99238014, 'precision': 0.98812616, 'recall': 0.9661108, 'specificity': 0.9661108, 'f1': 0.9768009, 'auroc': 0.99693, 'binary_precision': 0.9829642, 'binary_recall': 0.9338728, 'binary_specificity': 0.99834883, 'binary_f1_score': 0.9577899}
confusion matrix:
       0     1
0  42325    70
1    286  4039
---- Validation: 
scalar performance:
{'acc': 0.96616864, 'precision': 0.77733743, 'recall': 0.59835565, 'specificity': 0.59835565, 'f1': 0.641443, 'auroc': 0.84519666, 'binary_precision': 0.583691, 'binary_recall': 0.20208023, 'binary_specificity': 0.9946311, 'binary_f1_score': 0.30022073}
confusion matrix:
       0    1
0  17970   97
1    537  136
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9577828, 'precision': 0.7235454, 'recall': 0.5568404, 'specificity': 0.5568404, 'f1': 0.58484185, 'auroc': 0.83916545, 'binary_precision': 0.484375, 'binary_recall': 0.11923077, 'binary_specificity': 0.99445003, 'binary_f1_score': 0.19135803}
confusion matrix:
      0   1
0  5913  33
1   229  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546984_14.png
early stop counter: 11
val acc:0.9661686420440674, best validation acc: 0.9665421843528748, corresponding to test acc:                         0.9653561115264893 / 0.9655172228813171
after epoch: 14,now: 2024-06-22 17:17:23.732031,epoch time: 0:09:27.879623,used: 2:11:06.025803,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_15_06_17_seed_1_21546984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9917166, 'precision': 0.98600566, 'recall': 0.96418804, 'specificity': 0.96418804, 'f1': 0.97478354, 'auroc': 0.99698305, 'binary_precision': 0.97907543, 'binary_recall': 0.9304046, 'binary_specificity': 0.9979715, 'binary_f1_score': 0.9541197}
confusion matrix:
       0     1
0  42309    86
1    301  4024
---- Validation: 
scalar performance:
{'acc': 0.96627533, 'precision': 0.7813559, 'recall': 0.59554994, 'specificity': 0.59554994, 'f1': 0.63868374, 'auroc': 0.8475758, 'binary_precision': 0.59192824, 'binary_recall': 0.1961367, 'binary_specificity': 0.99496317, 'binary_f1_score': 0.29464284}
confusion matrix:
       0    1
0  17976   91
1    541  132
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95601034, 'precision': 0.67563754, 'recall': 0.54120356, 'specificity': 0.54120356, 'f1': 0.5608128, 'auroc': 0.8274614, 'binary_precision': 0.3898305, 'binary_recall': 0.08846154, 'binary_specificity': 0.99394554, 'binary_f1_score': 0.14420062}
confusion matrix:
      0   1
0  5910  36
1   237  23
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546984_15.png
early stop counter: 12
val acc:0.9662753343582153, best validation acc: 0.9665421843528748, corresponding to test acc:                         0.9653561115264893 / 0.9655172228813171
after epoch: 15,now: 2024-06-22 17:26:58.607860,epoch time: 0:09:34.875829,used: 2:20:40.901632,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_15_06_17_seed_1_21546984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9927012, 'precision': 0.9863423, 'recall': 0.9698039, 'specificity': 0.9698039, 'f1': 0.97789407, 'auroc': 0.99763143, 'binary_precision': 0.97860575, 'binary_recall': 0.94170713, 'binary_specificity': 0.9979008, 'binary_f1_score': 0.9598019}
confusion matrix:
       0     1
0  42308    89
1    252  4071
---- Validation: 
scalar performance:
{'acc': 0.9657951, 'precision': 0.7593445, 'recall': 0.6403627, 'specificity': 0.6403627, 'f1': 0.6803436, 'auroc': 0.8650447, 'binary_precision': 0.54469275, 'binary_recall': 0.2897474, 'binary_specificity': 0.990978, 'binary_f1_score': 0.37827355}
confusion matrix:
       0    1
0  17904  163
1    478  195
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9558492, 'precision': 0.69200236, 'recall': 0.56686527, 'specificity': 0.56686527, 'f1': 0.5949657, 'auroc': 0.8530835, 'binary_precision': 0.42045453, 'binary_recall': 0.1423077, 'binary_specificity': 0.99142283, 'binary_f1_score': 0.21264368}
confusion matrix:
      0   1
0  5895  51
1   223  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546984_16.png
early stop counter: 13
val acc:0.96579509973526, best validation acc: 0.9665421843528748, corresponding to test acc:                         0.9653561115264893 / 0.9655172228813171
after epoch: 16,now: 2024-06-22 17:36:35.472508,epoch time: 0:09:36.864648,used: 2:30:17.766280,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_15_06_17_seed_1_21546984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9925514, 'precision': 0.9841, 'recall': 0.97119457, 'specificity': 0.97119457, 'f1': 0.977538, 'auroc': 0.9964521, 'binary_precision': 0.973797, 'binary_recall': 0.94498384, 'binary_specificity': 0.9974053, 'binary_f1_score': 0.95917416}
confusion matrix:
       0     1
0  42284   110
1    238  4088
---- Validation: 
scalar performance:
{'acc': 0.9674493, 'precision': 0.78999865, 'recall': 0.62977636, 'specificity': 0.62977636, 'f1': 0.6765639, 'auroc': 0.8520805, 'binary_precision': 0.60677963, 'binary_recall': 0.26597324, 'binary_specificity': 0.99357945, 'binary_f1_score': 0.3698347}
confusion matrix:
       0    1
0  17951  116
1    494  179
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9558492, 'precision': 0.6761819, 'recall': 0.5447974, 'specificity': 0.5447974, 'f1': 0.56582695, 'auroc': 0.81880176, 'binary_precision': 0.390625, 'binary_recall': 0.09615385, 'binary_specificity': 0.993441, 'binary_f1_score': 0.15432099}
confusion matrix:
      0   1
0  5907  39
1   235  25
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546984_17.png
better model found
persisted
after epoch: 17,now: 2024-06-22 17:46:23.735121,epoch time: 0:09:48.262613,used: 2:40:06.028893,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_15_06_17_seed_1_21546984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99238014, 'precision': 0.98561335, 'recall': 0.9685954, 'specificity': 0.9685954, 'f1': 0.9769144, 'auroc': 0.9969882, 'binary_precision': 0.9773821, 'binary_recall': 0.93940794, 'binary_specificity': 0.9977828, 'binary_f1_score': 0.95801896}
confusion matrix:
       0     1
0  42302    94
1    262  4062
---- Validation: 
scalar performance:
{'acc': 0.9654749, 'precision': 0.75858724, 'recall': 0.6130165, 'specificity': 0.6130165, 'f1': 0.65451306, 'auroc': 0.84786725, 'binary_precision': 0.5451389, 'binary_recall': 0.2332838, 'binary_specificity': 0.9927492, 'binary_f1_score': 0.32674295}
confusion matrix:
       0    1
0  17936  131
1    516  157
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95391554, 'precision': 0.66533685, 'recall': 0.5640172, 'specificity': 0.5640172, 'f1': 0.5886954, 'auroc': 0.8345914, 'binary_precision': 0.36734694, 'binary_recall': 0.13846155, 'binary_specificity': 0.9895728, 'binary_f1_score': 0.20111734}
confusion matrix:
      0   1
0  5884  62
1   224  36
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546984_18.png
early stop counter: 1
val acc:0.9654749035835266, best validation acc: 0.9674493074417114, corresponding to test acc:                         0.9558491706848145 / 0.9655172228813171
after epoch: 18,now: 2024-06-22 17:56:02.008535,epoch time: 0:09:38.273414,used: 2:49:44.302307,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_15_06_17_seed_1_21546984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9926584, 'precision': 0.9891495, 'recall': 0.96676826, 'specificity': 0.96676826, 'f1': 0.97763145, 'auroc': 0.99661684, 'binary_precision': 0.9848928, 'binary_recall': 0.93499887, 'binary_specificity': 0.99853766, 'binary_f1_score': 0.95929754}
confusion matrix:
       0     1
0  42335    62
1    281  4042
---- Validation: 
scalar performance:
{'acc': 0.96568835, 'precision': 0.76958346, 'recall': 0.5895234, 'specificity': 0.5895234, 'f1': 0.63038266, 'auroc': 0.8542185, 'binary_precision': 0.56880736, 'binary_recall': 0.18424962, 'binary_specificity': 0.99479717, 'binary_f1_score': 0.27833894}
confusion matrix:
       0    1
0  17973   94
1    549  124
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95633256, 'precision': 0.6718433, 'recall': 0.5321768, 'specificity': 0.5321768, 'f1': 0.5474382, 'auroc': 0.83111334, 'binary_precision': 0.38297874, 'binary_recall': 0.06923077, 'binary_specificity': 0.9951228, 'binary_f1_score': 0.11726385}
confusion matrix:
      0   1
0  5917  29
1   242  18
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546984_19.png
early stop counter: 2
val acc:0.9656883478164673, best validation acc: 0.9674493074417114, corresponding to test acc:                         0.9558491706848145 / 0.9655172228813171
after epoch: 19,now: 2024-06-22 18:05:44.626685,epoch time: 0:09:42.618150,used: 2:59:26.920457,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_15_06_17_seed_1_21546984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99310786, 'precision': 0.9862099, 'recall': 0.9724353, 'specificity': 0.9724353, 'f1': 0.9791986, 'auroc': 0.997439, 'binary_precision': 0.9778043, 'binary_recall': 0.9470643, 'binary_specificity': 0.9978063, 'binary_f1_score': 0.96218884}
confusion matrix:
       0     1
0  42301    93
1    229  4097
---- Validation: 
scalar performance:
{'acc': 0.9663821, 'precision': 0.7816833, 'recall': 0.5998969, 'specificity': 0.5998969, 'f1': 0.6437052, 'auroc': 0.8514157, 'binary_precision': 0.59227467, 'binary_recall': 0.205052, 'binary_specificity': 0.9947418, 'binary_f1_score': 0.30463576}
confusion matrix:
       0    1
0  17972   95
1    535  138
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9574605, 'precision': 0.71445924, 'recall': 0.55115527, 'specificity': 0.55115527, 'f1': 0.5765837, 'auroc': 0.828913, 'binary_precision': 0.46666667, 'binary_recall': 0.10769231, 'binary_specificity': 0.99461824, 'binary_f1_score': 0.175}
confusion matrix:
      0   1
0  5914  32
1   232  28
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546984_20.png
early stop counter: 3
val acc:0.9663820862770081, best validation acc: 0.9674493074417114, corresponding to test acc:                         0.9558491706848145 / 0.9655172228813171
after epoch: 20,now: 2024-06-22 18:15:19.884898,epoch time: 0:09:35.258213,used: 3:09:02.178670,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_15_06_17_seed_1_21546984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9927012, 'precision': 0.9833922, 'recall': 0.97282207, 'specificity': 0.97282207, 'f1': 0.9780338, 'auroc': 0.997267, 'binary_precision': 0.9720313, 'binary_recall': 0.9484274, 'binary_specificity': 0.9972167, 'binary_f1_score': 0.9600843}
confusion matrix:
       0     1
0  42278   118
1    223  4101
---- Validation: 
scalar performance:
{'acc': 0.9649413, 'precision': 0.7482705, 'recall': 0.6284756, 'specificity': 0.6284756, 'f1': 0.667346, 'auroc': 0.85666656, 'binary_precision': 0.5233918, 'binary_recall': 0.26597324, 'binary_specificity': 0.990978, 'binary_f1_score': 0.35270932}
confusion matrix:
       0    1
0  17904  163
1    494  179
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9506929, 'precision': 0.62869656, 'recall': 0.5568184, 'specificity': 0.5568184, 'f1': 0.576002, 'auroc': 0.82656956, 'binary_precision': 0.29464287, 'binary_recall': 0.12692308, 'binary_specificity': 0.98671377, 'binary_f1_score': 0.17741936}
confusion matrix:
      0   1
0  5867  79
1   227  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546984_21.png
early stop counter: 4
val acc:0.9649413228034973, best validation acc: 0.9674493074417114, corresponding to test acc:                         0.9558491706848145 / 0.9655172228813171
after epoch: 21,now: 2024-06-22 18:24:45.814614,epoch time: 0:09:25.929716,used: 3:18:28.108386,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_15_06_17_seed_1_21546984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9933005, 'precision': 0.9846028, 'recall': 0.9752129, 'specificity': 0.9752129, 'f1': 0.97985023, 'auroc': 0.997767, 'binary_precision': 0.973983, 'binary_recall': 0.95302016, 'binary_specificity': 0.9974056, 'binary_f1_score': 0.96338755}
confusion matrix:
       0     1
0  42289   110
1    203  4118
---- Validation: 
scalar performance:
{'acc': 0.96616864, 'precision': 0.76620185, 'recall': 0.6334038, 'specificity': 0.6334038, 'f1': 0.67557234, 'auroc': 0.8697988, 'binary_precision': 0.5589124, 'binary_recall': 0.27488855, 'binary_specificity': 0.991919, 'binary_f1_score': 0.3685259}
confusion matrix:
       0    1
0  17921  146
1    488  185
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95649374, 'precision': 0.6985898, 'recall': 0.5598457, 'specificity': 0.5598457, 'f1': 0.58703506, 'auroc': 0.8428782, 'binary_precision': 0.43421054, 'binary_recall': 0.12692308, 'binary_specificity': 0.9927682, 'binary_f1_score': 0.19642858}
confusion matrix:
      0   1
0  5903  43
1   227  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546984_22.png
early stop counter: 5
val acc:0.9661686420440674, best validation acc: 0.9674493074417114, corresponding to test acc:                         0.9558491706848145 / 0.9655172228813171
after epoch: 22,now: 2024-06-22 18:34:20.066117,epoch time: 0:09:34.251503,used: 3:28:02.359889,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_15_06_17_seed_1_21546984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99272263, 'precision': 0.9895116, 'recall': 0.9668111, 'specificity': 0.9668111, 'f1': 0.9778247, 'auroc': 0.9962094, 'binary_precision': 0.98561674, 'binary_recall': 0.9350139, 'binary_specificity': 0.99860835, 'binary_f1_score': 0.95964867}
confusion matrix:
       0     1
0  42337    59
1    281  4043
---- Validation: 
scalar performance:
{'acc': 0.96643543, 'precision': 0.7929082, 'recall': 0.58490396, 'specificity': 0.58490396, 'f1': 0.62698466, 'auroc': 0.8448304, 'binary_precision': 0.6157895, 'binary_recall': 0.17384844, 'binary_specificity': 0.99595946, 'binary_f1_score': 0.27114716}
confusion matrix:
       0    1
0  17994   73
1    556  117
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9558492, 'precision': 0.65410787, 'recall': 0.5282465, 'specificity': 0.5282465, 'f1': 0.5409709, 'auroc': 0.8102176, 'binary_precision': 0.3478261, 'binary_recall': 0.06153846, 'binary_specificity': 0.9949546, 'binary_f1_score': 0.10457517}
confusion matrix:
      0   1
0  5916  30
1   244  16
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546984_23.png
early stop counter: 6
val acc:0.966435432434082, best validation acc: 0.9674493074417114, corresponding to test acc:                         0.9558491706848145 / 0.9655172228813171
after epoch: 23,now: 2024-06-22 18:43:45.823285,epoch time: 0:09:25.757168,used: 3:37:28.117057,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_15_06_17_seed_1_21546984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9932149, 'precision': 0.9844523, 'recall': 0.9748703, 'specificity': 0.9748703, 'f1': 0.9796013, 'auroc': 0.9978907, 'binary_precision': 0.9737527, 'binary_recall': 0.9523589, 'binary_specificity': 0.9973818, 'binary_f1_score': 0.962937}
confusion matrix:
       0     1
0  42285   111
1    206  4118
---- Validation: 
scalar performance:
{'acc': 0.9653682, 'precision': 0.755829, 'recall': 0.6186833, 'specificity': 0.6186833, 'f1': 0.65964913, 'auroc': 0.85520875, 'binary_precision': 0.5392157, 'binary_recall': 0.24517088, 'binary_specificity': 0.9921957, 'binary_f1_score': 0.33707866}
confusion matrix:
       0    1
0  17926  141
1    508  165
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9542378, 'precision': 0.65796906, 'recall': 0.55131245, 'specificity': 0.55131245, 'f1': 0.5730306, 'auroc': 0.82345647, 'binary_precision': 0.35365853, 'binary_recall': 0.11153846, 'binary_specificity': 0.9910864, 'binary_f1_score': 0.16959064}
confusion matrix:
      0   1
0  5893  53
1   231  29
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546984_24.png
early stop counter: 7
val acc:0.9653682112693787, best validation acc: 0.9674493074417114, corresponding to test acc:                         0.9558491706848145 / 0.9655172228813171
after epoch: 24,now: 2024-06-22 18:53:06.423188,epoch time: 0:09:20.599903,used: 3:46:48.716960,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_15_06_17_seed_1_21546984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9937072, 'precision': 0.9863014, 'recall': 0.97597235, 'specificity': 0.97597235, 'f1': 0.9810674, 'auroc': 0.9973626, 'binary_precision': 0.97726196, 'binary_recall': 0.9542091, 'binary_specificity': 0.9977356, 'binary_f1_score': 0.9655979}
confusion matrix:
       0     1
0  42300    96
1    198  4126
---- Validation: 
scalar performance:
{'acc': 0.9659018, 'precision': 0.76445115, 'recall': 0.62110585, 'specificity': 0.62110585, 'f1': 0.66355544, 'auroc': 0.8568718, 'binary_precision': 0.5562914, 'binary_recall': 0.24962853, 'binary_specificity': 0.99258316, 'binary_f1_score': 0.34461537}
confusion matrix:
       0    1
0  17933  134
1    505  168
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9545601, 'precision': 0.6641483, 'recall': 0.55331963, 'specificity': 0.55331963, 'f1': 0.57603747, 'auroc': 0.823993, 'binary_precision': 0.36585367, 'binary_recall': 0.115384616, 'binary_specificity': 0.9912546, 'binary_f1_score': 0.1754386}
confusion matrix:
      0   1
0  5894  52
1   230  30
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546984_25.png
early stop counter: 8
val acc:0.965901792049408, best validation acc: 0.9674493074417114, corresponding to test acc:                         0.9558491706848145 / 0.9655172228813171
after epoch: 25,now: 2024-06-22 19:02:19.861735,epoch time: 0:09:13.438547,used: 3:56:02.155507,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_15_06_17_seed_1_21546984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99300086, 'precision': 0.98695254, 'recall': 0.97100127, 'specificity': 0.97100127, 'f1': 0.97881067, 'auroc': 0.99719155, 'binary_precision': 0.97959185, 'binary_recall': 0.9440074, 'binary_specificity': 0.9979952, 'binary_f1_score': 0.9614705}
confusion matrix:
       0     1
0  42313    85
1    242  4080
---- Validation: 
scalar performance:
{'acc': 0.966809, 'precision': 0.7986802, 'recall': 0.5915351, 'specificity': 0.5915351, 'f1': 0.6356689, 'auroc': 0.8462969, 'binary_precision': 0.6268657, 'binary_recall': 0.1872214, 'binary_specificity': 0.9958488, 'binary_f1_score': 0.2883295}
confusion matrix:
       0    1
0  17992   75
1    547  126
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95681596, 'precision': 0.684909, 'recall': 0.53242904, 'specificity': 0.53242904, 'f1': 0.54814345, 'auroc': 0.80479705, 'binary_precision': 0.4090909, 'binary_recall': 0.06923077, 'binary_specificity': 0.9956273, 'binary_f1_score': 0.11842106}
confusion matrix:
      0   1
0  5920  26
1   242  18
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546984_26.png
early stop counter: 9
val acc:0.9668089747428894, best validation acc: 0.9674493074417114, corresponding to test acc:                         0.9558491706848145 / 0.9655172228813171
after epoch: 26,now: 2024-06-22 19:11:35.533434,epoch time: 0:09:15.671699,used: 4:05:17.827206,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_15_06_17_seed_1_21546984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99355733, 'precision': 0.9900327, 'recall': 0.9713144, 'specificity': 0.9713144, 'f1': 0.9804457, 'auroc': 0.99745893, 'binary_precision': 0.98574877, 'binary_recall': 0.94402033, 'binary_specificity': 0.9986084, 'binary_f1_score': 0.96443343}
confusion matrix:
       0     1
0  42338    59
1    242  4081
---- Validation: 
scalar performance:
{'acc': 0.96574175, 'precision': 0.7715148, 'recall': 0.5881205, 'specificity': 0.5881205, 'f1': 0.62892556, 'auroc': 0.8550067, 'binary_precision': 0.57276994, 'binary_recall': 0.18127786, 'binary_specificity': 0.99496317, 'binary_f1_score': 0.27539504}
confusion matrix:
       0    1
0  17976   91
1    551  122
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9542378, 'precision': 0.6189767, 'recall': 0.52556664, 'specificity': 0.52556664, 'f1': 0.5360332, 'auroc': 0.8109578, 'binary_precision': 0.2777778, 'binary_recall': 0.057692308, 'binary_specificity': 0.993441, 'binary_f1_score': 0.0955414}
confusion matrix:
      0   1
0  5907  39
1   245  15
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546984_27.png
early stop counter: 10
val acc:0.965741753578186, best validation acc: 0.9674493074417114, corresponding to test acc:                         0.9558491706848145 / 0.9655172228813171
after epoch: 27,now: 2024-06-22 19:20:48.583449,epoch time: 0:09:13.050015,used: 4:14:30.877221,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_15_06_17_seed_1_21546984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9937286, 'precision': 0.9866204, 'recall': 0.97577643, 'specificity': 0.97577643, 'f1': 0.98112184, 'auroc': 0.9978088, 'binary_precision': 0.9779464, 'binary_recall': 0.95374656, 'binary_specificity': 0.9978064, 'binary_f1_score': 0.9656949}
confusion matrix:
       0     1
0  42303    93
1    200  4124
---- Validation: 
scalar performance:
{'acc': 0.966809, 'precision': 0.78048694, 'recall': 0.6230068, 'specificity': 0.6230068, 'f1': 0.6681989, 'auroc': 0.8608644, 'binary_precision': 0.5882353, 'binary_recall': 0.25260028, 'binary_specificity': 0.9934134, 'binary_f1_score': 0.35343036}
confusion matrix:
       0    1
0  17948  119
1    503  170
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95617145, 'precision': 0.68248856, 'recall': 0.54496557, 'specificity': 0.54496557, 'f1': 0.56639075, 'auroc': 0.8189229, 'binary_precision': 0.4032258, 'binary_recall': 0.09615385, 'binary_specificity': 0.99377733, 'binary_f1_score': 0.1552795}
confusion matrix:
      0   1
0  5909  37
1   235  25
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546984_28.png
early stop counter: 11
val acc:0.9668089747428894, best validation acc: 0.9674493074417114, corresponding to test acc:                         0.9558491706848145 / 0.9655172228813171
after epoch: 28,now: 2024-06-22 19:30:01.617690,epoch time: 0:09:13.034241,used: 4:23:43.911462,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_15_06_17_seed_1_21546984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99351454, 'precision': 0.98647976, 'recall': 0.9746257, 'specificity': 0.9746257, 'f1': 0.9804611, 'auroc': 0.99767905, 'binary_precision': 0.97789925, 'binary_recall': 0.9514451, 'binary_specificity': 0.9978064, 'binary_f1_score': 0.96449083}
confusion matrix:
       0     1
0  42302    93
1    210  4115
---- Validation: 
scalar performance:
{'acc': 0.9663287, 'precision': 0.77097905, 'recall': 0.62490356, 'specificity': 0.62490356, 'f1': 0.66842955, 'auroc': 0.86512125, 'binary_precision': 0.5690789, 'binary_recall': 0.25705793, 'binary_specificity': 0.9927492, 'binary_f1_score': 0.35414532}
confusion matrix:
       0    1
0  17936  131
1    500  173
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9547212, 'precision': 0.6569039, 'recall': 0.54420877, 'specificity': 0.54420877, 'f1': 0.56389886, 'auroc': 0.8235357, 'binary_precision': 0.35211268, 'binary_recall': 0.09615385, 'binary_specificity': 0.99226373, 'binary_f1_score': 0.15105739}
confusion matrix:
      0   1
0  5900  46
1   235  25
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546984_29.png
early stop counter: 12
val acc:0.9663286805152893, best validation acc: 0.9674493074417114, corresponding to test acc:                         0.9558491706848145 / 0.9655172228813171
after epoch: 29,now: 2024-06-22 19:39:13.370278,epoch time: 0:09:11.752588,used: 4:32:55.664050,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_15_06_17_seed_1_21546984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99375, 'precision': 0.98724663, 'recall': 0.9752691, 'specificity': 0.9752691, 'f1': 0.98116446, 'auroc': 0.9974545, 'binary_precision': 0.9793153, 'binary_recall': 0.95259017, 'binary_specificity': 0.99794793, 'binary_f1_score': 0.96576786}
confusion matrix:
       0     1
0  42309    87
1    205  4119
---- Validation: 
scalar performance:
{'acc': 0.96659553, 'precision': 0.77622247, 'recall': 0.6236114, 'specificity': 0.6236114, 'f1': 0.66808033, 'auroc': 0.86609936, 'binary_precision': 0.579661, 'binary_recall': 0.25408617, 'binary_specificity': 0.99313664, 'binary_f1_score': 0.35330576}
confusion matrix:
       0    1
0  17943  124
1    502  171
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95665485, 'precision': 0.6913362, 'recall': 0.5433789, 'specificity': 0.5433789, 'f1': 0.5645895, 'auroc': 0.82345563, 'binary_precision': 0.42105263, 'binary_recall': 0.092307694, 'binary_specificity': 0.99445003, 'binary_f1_score': 0.15141957}
confusion matrix:
      0   1
0  5913  33
1   236  24
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546984_30.png
early stop counter: 13
val acc:0.9665955305099487, best validation acc: 0.9674493074417114, corresponding to test acc:                         0.9558491706848145 / 0.9655172228813171
after epoch: 30,now: 2024-06-22 19:48:24.812138,epoch time: 0:09:11.441860,used: 4:42:07.105910,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_15_06_17_seed_1_21546984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 4:42:07.105910 at 2024-06-22 19:48:24.812138
persisted model performance metric: 

scalar performance:
{'acc': 0.9558492, 'precision': 0.6761819, 'recall': 0.5447974, 'specificity': 0.5447974, 'f1': 0.56582695, 'auroc': 0.81880176, 'binary_precision': 0.390625, 'binary_recall': 0.09615385, 'binary_specificity': 0.993441, 'binary_f1_score': 0.15432099}
confusion matrix:
      0   1
0  5907  39
1   235  25
oracle model performance metric: 

scalar performance:
{'acc': 0.9655172, 'precision': 0.8269607, 'recall': 0.66202104, 'specificity': 0.66202104, 'f1': 0.71390057, 'auroc': 0.8480811, 'binary_precision': 0.6825397, 'binary_recall': 0.33076924, 'binary_specificity': 0.9932728, 'binary_f1_score': 0.44559586}
confusion matrix:
      0   1
0  5906  40
1   174  86
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_resnet_differentlearningrates_bs32_classbalancing3/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_resnet_differentlearningrates_bs32_classbalancing3/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204385 KiB | 755911 KiB |   1388 TiB |   1388 TiB |
|       from large pool | 167936 KiB | 683776 KiB |   1388 TiB |   1388 TiB |
|       from small pool |  36449 KiB |  73422 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 204385 KiB | 755911 KiB |   1388 TiB |   1388 TiB |
|       from large pool | 167936 KiB | 683776 KiB |   1388 TiB |   1388 TiB |
|       from small pool |  36449 KiB |  73422 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201086 KiB | 748328 KiB |   1388 TiB |   1388 TiB |
|       from large pool | 165120 KiB | 676736 KiB |   1388 TiB |   1388 TiB |
|       from small pool |  35966 KiB |  72872 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    782 MiB |    930 MiB |   1410 MiB | 643072 KiB |
|       from large pool |    710 MiB |    858 MiB |   1310 MiB | 614400 KiB |
|       from small pool |     72 MiB |     72 MiB |    100 MiB |  28672 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 104862 KiB | 245592 KiB | 600891 GiB | 600891 GiB |
|       from large pool |  96256 KiB | 244616 KiB | 600542 GiB | 600542 GiB |
|       from small pool |   8606 KiB |  16195 KiB |    349 GiB |    349 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2064    |    3669    |   88698 K  |   88696 K  |
|       from large pool |      36    |      76    |   36422 K  |   36422 K  |
|       from small pool |    2028    |    3632    |   52275 K  |   52273 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2064    |    3669    |   88698 K  |   88696 K  |
|       from large pool |      36    |      76    |   36422 K  |   36422 K  |
|       from small pool |    2028    |    3632    |   52275 K  |   52273 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      49    |      51    |      69    |      20    |
|       from large pool |      13    |      15    |      19    |       6    |
|       from small pool |      36    |      36    |      50    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      33    |    1476    |   38755 K  |   38755 K  |
|       from large pool |       5    |      11    |   11871 K  |   11871 K  |
|       from small pool |      28    |    1471    |   26884 K  |   26884 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 755911 KiB |   1388 TiB |   1388 TiB |
|       from large pool |  16640 KiB | 683776 KiB |   1388 TiB |   1388 TiB |
|       from small pool |      0 KiB |  73422 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 755911 KiB |   1388 TiB |   1388 TiB |
|       from large pool |  16640 KiB | 683776 KiB |   1388 TiB |   1388 TiB |
|       from small pool |      0 KiB |  73422 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 748328 KiB |   1388 TiB |   1388 TiB |
|       from large pool |  16640 KiB | 676736 KiB |   1388 TiB |   1388 TiB |
|       from small pool |      0 KiB |  72872 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 309248 KiB |    930 MiB |   1410 MiB |   1108 MiB |
|       from large pool | 264192 KiB |    858 MiB |   1310 MiB |   1052 MiB |
|       from small pool |  45056 KiB |     72 MiB |    100 MiB |     56 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  83712 KiB | 245592 KiB | 600891 GiB | 600891 GiB |
|       from large pool |  83712 KiB | 244616 KiB | 600542 GiB | 600542 GiB |
|       from small pool |      0 KiB |  16201 KiB |    349 GiB |    349 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3669    |   88698 K  |   88698 K  |
|       from large pool |       2    |      76    |   36422 K  |   36422 K  |
|       from small pool |       0    |    3632    |   52275 K  |   52275 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3669    |   88698 K  |   88698 K  |
|       from large pool |       2    |      76    |   36422 K  |   36422 K  |
|       from small pool |       0    |    3632    |   52275 K  |   52275 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      51    |      69    |      38    |
|       from large pool |       9    |      15    |      19    |      10    |
|       from small pool |      22    |      36    |      50    |      28    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |    1476    |   38756 K  |   38756 K  |
|       from large pool |       1    |      11    |   11871 K  |   11871 K  |
|       from small pool |       0    |    1471    |   26885 K  |   26885 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 755911 KiB |   1388 TiB |   1388 TiB |
|       from large pool |  16640 KiB | 683776 KiB |   1388 TiB |   1388 TiB |
|       from small pool |      0 KiB |  73422 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 755911 KiB |   1388 TiB |   1388 TiB |
|       from large pool |  16640 KiB | 683776 KiB |   1388 TiB |   1388 TiB |
|       from small pool |      0 KiB |  73422 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 748328 KiB |   1388 TiB |   1388 TiB |
|       from large pool |  16640 KiB | 676736 KiB |   1388 TiB |   1388 TiB |
|       from small pool |      0 KiB |  72872 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 309248 KiB |    930 MiB |   1410 MiB |   1108 MiB |
|       from large pool | 264192 KiB |    858 MiB |   1310 MiB |   1052 MiB |
|       from small pool |  45056 KiB |     72 MiB |    100 MiB |     56 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  83712 KiB | 245592 KiB | 600891 GiB | 600891 GiB |
|       from large pool |  83712 KiB | 244616 KiB | 600542 GiB | 600542 GiB |
|       from small pool |      0 KiB |  16201 KiB |    349 GiB |    349 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3669    |   88698 K  |   88698 K  |
|       from large pool |       2    |      76    |   36422 K  |   36422 K  |
|       from small pool |       0    |    3632    |   52275 K  |   52275 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3669    |   88698 K  |   88698 K  |
|       from large pool |       2    |      76    |   36422 K  |   36422 K  |
|       from small pool |       0    |    3632    |   52275 K  |   52275 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      51    |      69    |      38    |
|       from large pool |       9    |      15    |      19    |      10    |
|       from small pool |      22    |      36    |      50    |      28    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |    1476    |   38756 K  |   38756 K  |
|       from large pool |       1    |      11    |   11871 K  |   11871 K  |
|       from small pool |       0    |    1471    |   26885 K  |   26885 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0




!!!: not committed yet



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_19_52_32_seed_2_21546984

 Experiment start at: 2024-06-22 19:52:32.877481
before training, model accuracy: 0.0544959120452404
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9768186, 'precision': 0.9752549, 'recall': 0.88990897, 'specificity': 0.88990897, 'f1': 0.9273171, 'auroc': 0.98130405, 'binary_precision': 0.9734028, 'binary_recall': 0.7821106, 'binary_specificity': 0.99770737, 'binary_f1_score': 0.8673344}
confusion matrix:
       0     1
0  42212    97
1    989  3550
---- Validation: 
scalar performance:
{'acc': 0.968998, 'precision': 0.7629433, 'recall': 0.5848704, 'specificity': 0.5848704, 'f1': 0.6246582, 'auroc': 0.7293091, 'binary_precision': 0.55263156, 'binary_recall': 0.1744186, 'binary_specificity': 0.9953222, 'binary_f1_score': 0.2651515}
confusion matrix:
       0    1
0  18086   85
1    497  105
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9644174, 'precision': 0.80546165, 'recall': 0.5908908, 'specificity': 0.5908908, 'f1': 0.635107, 'auroc': 0.74140805, 'binary_precision': 0.64285713, 'binary_recall': 0.18595041, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.28846154}
confusion matrix:
      0   1
0  5972  25
1   197  45
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546984_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-22 20:02:18.644956,epoch time: 0:09:45.767475,used: 0:09:45.767475,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_19_52_32_seed_2_21546984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.98219776, 'precision': 0.9737085, 'recall': 0.922487, 'specificity': 0.922487, 'f1': 0.94625145, 'auroc': 0.98954725, 'binary_precision': 0.9634726, 'binary_recall': 0.8484248, 'binary_specificity': 0.9965492, 'binary_f1_score': 0.9022962}
confusion matrix:
       0     1
0  42163   146
1    688  3851
---- Validation: 
scalar performance:
{'acc': 0.9673467, 'precision': 0.72908, 'recall': 0.62176067, 'specificity': 0.62176067, 'f1': 0.65739024, 'auroc': 0.78054595, 'binary_precision': 0.48253968, 'binary_recall': 0.25249168, 'binary_specificity': 0.9910297, 'binary_f1_score': 0.33151582}
confusion matrix:
       0    1
0  18008  163
1    450  152
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96714216, 'precision': 0.81962574, 'recall': 0.6498077, 'specificity': 0.6498077, 'f1': 0.70117813, 'auroc': 0.782215, 'binary_precision': 0.6666667, 'binary_recall': 0.30578512, 'binary_specificity': 0.99383026, 'binary_f1_score': 0.41926345}
confusion matrix:
      0   1
0  5960  37
1   168  74
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546984_2.png
new oracle model saved
early stop counter: 1
val acc:0.967346727848053, best validation acc: 0.9689980149269104, corresponding to test acc:                         0.9644173979759216 / 0.9671421647071838
after epoch: 2,now: 2024-06-22 20:11:44.111038,epoch time: 0:09:25.466082,used: 0:19:11.233557,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_19_52_32_seed_2_21546984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.98586917, 'precision': 0.9751525, 'recall': 0.9427123, 'specificity': 0.9427123, 'f1': 0.9582063, 'auroc': 0.9913789, 'binary_precision': 0.96209776, 'binary_recall': 0.8891826, 'binary_specificity': 0.9962419, 'binary_f1_score': 0.92420423}
confusion matrix:
       0     1
0  42150   159
1    503  4036
---- Validation: 
scalar performance:
{'acc': 0.96713364, 'precision': 0.7265383, 'recall': 0.62566584, 'specificity': 0.62566584, 'f1': 0.6602104, 'auroc': 0.7967683, 'binary_precision': 0.47720364, 'binary_recall': 0.26079735, 'binary_specificity': 0.99053437, 'binary_f1_score': 0.33727175}
confusion matrix:
       0    1
0  17999  172
1    445  157
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9656996, 'precision': 0.79372656, 'recall': 0.6510401, 'specificity': 0.6510401, 'f1': 0.6972112, 'auroc': 0.7919662, 'binary_precision': 0.6147541, 'binary_recall': 0.30991736, 'binary_specificity': 0.99216276, 'binary_f1_score': 0.41208795}
confusion matrix:
      0   1
0  5950  47
1   167  75
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546984_3.png
early stop counter: 2
val acc:0.967133641242981, best validation acc: 0.9689980149269104, corresponding to test acc:                         0.9644173979759216 / 0.9671421647071838
after epoch: 3,now: 2024-06-22 20:21:02.336945,epoch time: 0:09:18.225907,used: 0:28:29.459464,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_19_52_32_seed_2_21546984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98738474, 'precision': 0.9796489, 'recall': 0.94718987, 'specificity': 0.94718987, 'f1': 0.9627002, 'auroc': 0.9928137, 'binary_precision': 0.9702239, 'binary_recall': 0.8973342, 'binary_specificity': 0.9970455, 'binary_f1_score': 0.93235666}
confusion matrix:
       0     1
0  42184   125
1    466  4073
---- Validation: 
scalar performance:
{'acc': 0.9684653, 'precision': 0.7470026, 'recall': 0.6086867, 'specificity': 0.6086867, 'f1': 0.6485436, 'auroc': 0.80828017, 'binary_precision': 0.5192308, 'binary_recall': 0.22425249, 'binary_specificity': 0.9931209, 'binary_f1_score': 0.31322506}
confusion matrix:
       0    1
0  18046  125
1    467  135
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.967623, 'precision': 0.8379552, 'recall': 0.6401441, 'specificity': 0.6401441, 'f1': 0.69462025, 'auroc': 0.8116714, 'binary_precision': 0.70408165, 'binary_recall': 0.28512397, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.4058824}
confusion matrix:
      0   1
0  5968  29
1   173  69
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546984_4.png
new oracle model saved
early stop counter: 3
val acc:0.9684653282165527, best validation acc: 0.9689980149269104, corresponding to test acc:                         0.9644173979759216 / 0.9676229953765869
after epoch: 4,now: 2024-06-22 20:30:16.477114,epoch time: 0:09:14.140169,used: 0:37:43.599633,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_19_52_32_seed_2_21546984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9885801, 'precision': 0.97613025, 'recall': 0.95776623, 'specificity': 0.95776623, 'f1': 0.9667189, 'auroc': 0.9944787, 'binary_precision': 0.96084756, 'binary_recall': 0.91955036, 'binary_specificity': 0.9959821, 'binary_f1_score': 0.9397455}
confusion matrix:
       0     1
0  42141   170
1    365  4172
---- Validation: 
scalar performance:
{'acc': 0.9686784, 'precision': 0.7494706, 'recall': 0.628873, 'specificity': 0.628873, 'f1': 0.66818696, 'auroc': 0.8188963, 'binary_precision': 0.52287585, 'binary_recall': 0.26578072, 'binary_specificity': 0.99196523, 'binary_f1_score': 0.3524229}
confusion matrix:
       0    1
0  18025  146
1    442  160
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9661805, 'precision': 0.80359316, 'recall': 0.6473247, 'specificity': 0.6473247, 'f1': 0.6957779, 'auroc': 0.8108255, 'binary_precision': 0.6347826, 'binary_recall': 0.30165288, 'binary_specificity': 0.9929965, 'binary_f1_score': 0.4089636}
confusion matrix:
      0   1
0  5955  42
1   169  73
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546984_5.png
early stop counter: 4
val acc:0.9686784148216248, best validation acc: 0.9689980149269104, corresponding to test acc:                         0.9644173979759216 / 0.9676229953765869
after epoch: 5,now: 2024-06-22 20:39:31.454941,epoch time: 0:09:14.977827,used: 0:46:58.577460,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_19_52_32_seed_2_21546984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9886228, 'precision': 0.979051, 'recall': 0.95505404, 'specificity': 0.95505404, 'f1': 0.96666163, 'auroc': 0.99483204, 'binary_precision': 0.9673355, 'binary_recall': 0.91341704, 'binary_specificity': 0.996691, 'binary_f1_score': 0.9396034}
confusion matrix:
       0     1
0  42169   140
1    393  4146
---- Validation: 
scalar performance:
{'acc': 0.96692055, 'precision': 0.7254306, 'recall': 0.6392076, 'specificity': 0.6392076, 'f1': 0.6710776, 'auroc': 0.84050196, 'binary_precision': 0.47411445, 'binary_recall': 0.28903654, 'binary_specificity': 0.9893787, 'binary_f1_score': 0.35913312}
confusion matrix:
       0    1
0  17978  193
1    428  174
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9658599, 'precision': 0.80356914, 'recall': 0.6372442, 'specificity': 0.6372442, 'f1': 0.6860618, 'auroc': 0.8284211, 'binary_precision': 0.635514, 'binary_recall': 0.28099173, 'binary_specificity': 0.9934968, 'binary_f1_score': 0.38968483}
confusion matrix:
      0   1
0  5958  39
1   174  68
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546984_6.png
early stop counter: 5
val acc:0.9669205546379089, best validation acc: 0.9689980149269104, corresponding to test acc:                         0.9644173979759216 / 0.9676229953765869
after epoch: 6,now: 2024-06-22 20:48:54.642659,epoch time: 0:09:23.187718,used: 0:56:21.765178,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_19_52_32_seed_2_21546984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.99005294, 'precision': 0.98550993, 'recall': 0.9570167, 'specificity': 0.9570167, 'f1': 0.9707185, 'auroc': 0.9947511, 'binary_precision': 0.9799623, 'binary_recall': 0.9160423, 'binary_specificity': 0.997991, 'binary_f1_score': 0.94692487}
confusion matrix:
       0     1
0  42225    85
1    381  4157
---- Validation: 
scalar performance:
{'acc': 0.9682523, 'precision': 0.74304926, 'recall': 0.60937965, 'specificity': 0.60937965, 'f1': 0.64855725, 'auroc': 0.8351917, 'binary_precision': 0.5112782, 'binary_recall': 0.22591361, 'binary_specificity': 0.9928457, 'binary_f1_score': 0.31336406}
confusion matrix:
       0    1
0  18041  130
1    466  136
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9639365, 'precision': 0.7880507, 'recall': 0.5965889, 'specificity': 0.5965889, 'f1': 0.6402788, 'auroc': 0.81955284, 'binary_precision': 0.6075949, 'binary_recall': 0.1983471, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.2990654}
confusion matrix:
      0   1
0  5966  31
1   194  48
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546984_7.png
early stop counter: 6
val acc:0.9682523012161255, best validation acc: 0.9689980149269104, corresponding to test acc:                         0.9644173979759216 / 0.9676229953765869
after epoch: 7,now: 2024-06-22 20:58:20.181798,epoch time: 0:09:25.539139,used: 1:05:47.304317,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_19_52_32_seed_2_21546984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9902237, 'precision': 0.98233604, 'recall': 0.9611523, 'specificity': 0.9611523, 'f1': 0.9714426, 'auroc': 0.99630815, 'binary_precision': 0.9726662, 'binary_recall': 0.92509365, 'binary_specificity': 0.997211, 'binary_f1_score': 0.9482836}
confusion matrix:
       0     1
0  42191   118
1    340  4199
---- Validation: 
scalar performance:
{'acc': 0.9677196, 'precision': 0.73493457, 'recall': 0.6283777, 'specificity': 0.6283777, 'f1': 0.664512, 'auroc': 0.8415247, 'binary_precision': 0.49382716, 'binary_recall': 0.26578072, 'binary_specificity': 0.9909746, 'binary_f1_score': 0.34557235}
confusion matrix:
       0    1
0  18007  164
1    442  160
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96281457, 'precision': 0.758224, 'recall': 0.6178155, 'specificity': 0.6178155, 'f1': 0.6590068, 'auroc': 0.81976855, 'binary_precision': 0.5462963, 'binary_recall': 0.24380165, 'binary_specificity': 0.9918293, 'binary_f1_score': 0.33714285}
confusion matrix:
      0   1
0  5948  49
1   183  59
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546984_8.png
early stop counter: 7
val acc:0.9677196145057678, best validation acc: 0.9689980149269104, corresponding to test acc:                         0.9644173979759216 / 0.9676229953765869
after epoch: 8,now: 2024-06-22 21:07:40.512205,epoch time: 0:09:20.330407,used: 1:15:07.634724,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_19_52_32_seed_2_21546984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9907787, 'precision': 0.98360085, 'recall': 0.9631313, 'specificity': 0.9631313, 'f1': 0.9730855, 'auroc': 0.99648875, 'binary_precision': 0.97479767, 'binary_recall': 0.92883897, 'binary_specificity': 0.9974237, 'binary_f1_score': 0.95126355}
confusion matrix:
       0     1
0  42200   109
1    323  4216
---- Validation: 
scalar performance:
{'acc': 0.9691046, 'precision': 0.75792396, 'recall': 0.6186535, 'specificity': 0.6186535, 'f1': 0.6602843, 'auroc': 0.83648235, 'binary_precision': 0.54044116, 'binary_recall': 0.24418604, 'binary_specificity': 0.9931209, 'binary_f1_score': 0.33638442}
confusion matrix:
       0    1
0  18046  125
1    455  147
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96281457, 'precision': 0.7777417, 'recall': 0.5662642, 'specificity': 0.5662642, 'f1': 0.60121447, 'auroc': 0.7997201, 'binary_precision': 0.58928573, 'binary_recall': 0.13636364, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.22147653}
confusion matrix:
      0   1
0  5974  23
1   209  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546984_9.png
better model found
persisted
after epoch: 9,now: 2024-06-22 21:17:02.495227,epoch time: 0:09:21.983022,used: 1:24:29.617746,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_19_52_32_seed_2_21546984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99088544, 'precision': 0.98077697, 'recall': 0.96663225, 'specificity': 0.96663225, 'f1': 0.9735705, 'auroc': 0.99593216, 'binary_precision': 0.9683371, 'binary_recall': 0.9365499, 'binary_specificity': 0.99671465, 'binary_f1_score': 0.95217836}
confusion matrix:
       0     1
0  42170   139
1    288  4251
---- Validation: 
scalar performance:
{'acc': 0.9671869, 'precision': 0.7283039, 'recall': 0.63532996, 'specificity': 0.63532996, 'f1': 0.6687317, 'auroc': 0.84934103, 'binary_precision': 0.48011363, 'binary_recall': 0.2807309, 'binary_specificity': 0.989929, 'binary_f1_score': 0.3542977}
confusion matrix:
       0    1
0  17988  183
1    433  169
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9596089, 'precision': 0.7143047, 'recall': 0.6101997, 'specificity': 0.6101997, 'f1': 0.6434449, 'auroc': 0.8184926, 'binary_precision': 0.45901638, 'binary_recall': 0.23140496, 'binary_specificity': 0.9889945, 'binary_f1_score': 0.3076923}
confusion matrix:
      0   1
0  5931  66
1   186  56
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546984_10.png
early stop counter: 1
val acc:0.9671869277954102, best validation acc: 0.9691045880317688, corresponding to test acc:                         0.9628145694732666 / 0.9676229953765869
after epoch: 10,now: 2024-06-22 21:26:19.770009,epoch time: 0:09:17.274782,used: 1:33:46.892528,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_19_52_32_seed_2_21546984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.991355, 'precision': 0.9881819, 'recall': 0.96197534, 'specificity': 0.96197534, 'f1': 0.9746214, 'auroc': 0.9965602, 'binary_precision': 0.9843018, 'binary_recall': 0.92553425, 'binary_specificity': 0.9984164, 'binary_f1_score': 0.9540138}
confusion matrix:
       0     1
0  42242    67
1    338  4201
---- Validation: 
scalar performance:
{'acc': 0.9688382, 'precision': 0.75864613, 'recall': 0.58478785, 'specificity': 0.58478785, 'f1': 0.62411654, 'auroc': 0.8439496, 'binary_precision': 0.54404145, 'binary_recall': 0.1744186, 'binary_specificity': 0.9951571, 'binary_f1_score': 0.26415092}
confusion matrix:
       0    1
0  18083   88
1    497  105
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9616926, 'precision': 0.7514082, 'recall': 0.5418877, 'specificity': 0.5418877, 'f1': 0.56493556, 'auroc': 0.81157315, 'binary_precision': 0.53846157, 'binary_recall': 0.08677686, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.14946619}
confusion matrix:
      0   1
0  5979  18
1   221  21
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546984_11.png
early stop counter: 2
val acc:0.9688382148742676, best validation acc: 0.9691045880317688, corresponding to test acc:                         0.9628145694732666 / 0.9676229953765869
after epoch: 11,now: 2024-06-22 21:35:36.740436,epoch time: 0:09:16.970427,used: 1:43:03.862955,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_19_52_32_seed_2_21546984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99103487, 'precision': 0.9778967, 'recall': 0.9705502, 'specificity': 0.9705502, 'f1': 0.97418725, 'auroc': 0.9967345, 'binary_precision': 0.9616678, 'binary_recall': 0.9451421, 'binary_specificity': 0.9959583, 'binary_f1_score': 0.9533334}
confusion matrix:
       0     1
0  42138   171
1    249  4290
---- Validation: 
scalar performance:
{'acc': 0.96713364, 'precision': 0.72691214, 'recall': 0.62887806, 'specificity': 0.62887806, 'f1': 0.66303164, 'auroc': 0.8523214, 'binary_precision': 0.47774482, 'binary_recall': 0.26744187, 'binary_specificity': 0.99031425, 'binary_f1_score': 0.342918}
confusion matrix:
       0    1
0  17995  176
1    441  161
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608912, 'precision': 0.7289199, 'recall': 0.5930221, 'specificity': 0.5930221, 'f1': 0.62900376, 'auroc': 0.82944775, 'binary_precision': 0.48958334, 'binary_recall': 0.19421488, 'binary_specificity': 0.9918293, 'binary_f1_score': 0.2781065}
confusion matrix:
      0   1
0  5948  49
1   195  47
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546984_12.png
early stop counter: 3
val acc:0.967133641242981, best validation acc: 0.9691045880317688, corresponding to test acc:                         0.9628145694732666 / 0.9676229953765869
after epoch: 12,now: 2024-06-22 21:44:59.098022,epoch time: 0:09:22.357586,used: 1:52:26.220541,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_19_52_32_seed_2_21546984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99287057, 'precision': 0.98550403, 'recall': 0.97342944, 'specificity': 0.97342944, 'f1': 0.97937024, 'auroc': 0.9969772, 'binary_precision': 0.9764279, 'binary_recall': 0.94931686, 'binary_specificity': 0.99754196, 'binary_f1_score': 0.96268153}
confusion matrix:
       0     1
0  42206   104
1    230  4308
---- Validation: 
scalar performance:
{'acc': 0.9680392, 'precision': 0.7393478, 'recall': 0.61489093, 'specificity': 0.61489093, 'f1': 0.65321624, 'auroc': 0.8478176, 'binary_precision': 0.50352114, 'binary_recall': 0.23754153, 'binary_specificity': 0.99224037, 'binary_f1_score': 0.32279912}
confusion matrix:
       0    1
0  18030  141
1    459  143
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9607309, 'precision': 0.7245571, 'recall': 0.5790595, 'specificity': 0.5790595, 'f1': 0.6129971, 'auroc': 0.8082981, 'binary_precision': 0.48192772, 'binary_recall': 0.16528925, 'binary_specificity': 0.99282974, 'binary_f1_score': 0.24615385}
confusion matrix:
      0   1
0  5954  43
1   202  40
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546984_13.png
early stop counter: 4
val acc:0.9680392146110535, best validation acc: 0.9691045880317688, corresponding to test acc:                         0.9628145694732666 / 0.9676229953765869
after epoch: 13,now: 2024-06-22 21:54:25.628033,epoch time: 0:09:26.530011,used: 2:01:52.750552,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_19_52_32_seed_2_21546984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99210215, 'precision': 0.9848884, 'recall': 0.9695613, 'specificity': 0.9695613, 'f1': 0.97706866, 'auroc': 0.9962969, 'binary_precision': 0.97601646, 'binary_recall': 0.94160426, 'binary_specificity': 0.9975183, 'binary_f1_score': 0.95850164}
confusion matrix:
       0     1
0  42205   105
1    265  4273
---- Validation: 
scalar performance:
{'acc': 0.96745324, 'precision': 0.73157454, 'recall': 0.63305837, 'specificity': 0.63305837, 'f1': 0.6676876, 'auroc': 0.86255866, 'binary_precision': 0.48680353, 'binary_recall': 0.2757475, 'binary_specificity': 0.99036926, 'binary_f1_score': 0.35206786}
confusion matrix:
       0    1
0  17996  175
1    436  166
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96008974, 'precision': 0.71592164, 'recall': 0.58863974, 'specificity': 0.58863974, 'f1': 0.6224872, 'auroc': 0.8259555, 'binary_precision': 0.46391752, 'binary_recall': 0.18595041, 'binary_specificity': 0.991329, 'binary_f1_score': 0.26548672}
confusion matrix:
      0   1
0  5945  52
1   197  45
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546984_14.png
early stop counter: 5
val acc:0.9674532413482666, best validation acc: 0.9691045880317688, corresponding to test acc:                         0.9628145694732666 / 0.9676229953765869
after epoch: 14,now: 2024-06-22 22:03:45.489145,epoch time: 0:09:19.861112,used: 2:11:12.611664,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_19_52_32_seed_2_21546984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99240094, 'precision': 0.98724574, 'recall': 0.96894646, 'specificity': 0.96894646, 'f1': 0.97787416, 'auroc': 0.9973552, 'binary_precision': 0.9809151, 'binary_recall': 0.9398546, 'binary_specificity': 0.99803823, 'binary_f1_score': 0.95994604}
confusion matrix:
       0     1
0  42226    83
1    273  4266
---- Validation: 
scalar performance:
{'acc': 0.9680392, 'precision': 0.7396784, 'recall': 0.63255805, 'specificity': 0.63255805, 'f1': 0.6692262, 'auroc': 0.85615855, 'binary_precision': 0.5030488, 'binary_recall': 0.2740864, 'binary_specificity': 0.9910297, 'binary_f1_score': 0.35483873}
confusion matrix:
       0    1
0  18008  163
1    437  165
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9596089, 'precision': 0.70836866, 'recall': 0.5864068, 'specificity': 0.5864068, 'f1': 0.6190312, 'auroc': 0.8243736, 'binary_precision': 0.4489796, 'binary_recall': 0.18181819, 'binary_specificity': 0.9909955, 'binary_f1_score': 0.25882354}
confusion matrix:
      0   1
0  5943  54
1   198  44
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546984_15.png
early stop counter: 6
val acc:0.9680392146110535, best validation acc: 0.9691045880317688, corresponding to test acc:                         0.9628145694732666 / 0.9676229953765869
after epoch: 15,now: 2024-06-22 22:13:20.220882,epoch time: 0:09:34.731737,used: 2:20:47.343401,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_19_52_32_seed_2_21546984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9924436, 'precision': 0.98320794, 'recall': 0.97329694, 'specificity': 0.97329694, 'f1': 0.9781872, 'auroc': 0.99687004, 'binary_precision': 0.9718151, 'binary_recall': 0.94954836, 'binary_specificity': 0.9970455, 'binary_f1_score': 0.96055275}
confusion matrix:
       0     1
0  42184   125
1    229  4310
---- Validation: 
scalar performance:
{'acc': 0.9679859, 'precision': 0.7385626, 'recall': 0.61887866, 'specificity': 0.61887866, 'f1': 0.656795, 'auroc': 0.8586216, 'binary_precision': 0.5016949, 'binary_recall': 0.24584718, 'binary_specificity': 0.99191016, 'binary_f1_score': 0.32998887}
confusion matrix:
       0    1
0  18024  147
1    454  148
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9591281, 'precision': 0.69502765, 'recall': 0.5702948, 'specificity': 0.5702948, 'f1': 0.59959877, 'auroc': 0.8293666, 'binary_precision': 0.42352942, 'binary_recall': 0.14876033, 'binary_specificity': 0.9918293, 'binary_f1_score': 0.22018348}
confusion matrix:
      0   1
0  5948  49
1   206  36
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546984_16.png
early stop counter: 7
val acc:0.9679859280586243, best validation acc: 0.9691045880317688, corresponding to test acc:                         0.9628145694732666 / 0.9676229953765869
after epoch: 16,now: 2024-06-22 22:22:46.101983,epoch time: 0:09:25.881101,used: 2:30:13.224502,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_19_52_32_seed_2_21546984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9923369, 'precision': 0.9839909, 'recall': 0.9718611, 'specificity': 0.9718611, 'f1': 0.97782826, 'auroc': 0.9968868, 'binary_precision': 0.9737081, 'binary_recall': 0.946464, 'binary_specificity': 0.99725825, 'binary_f1_score': 0.95989275}
confusion matrix:
       0     1
0  42193   116
1    243  4296
---- Validation: 
scalar performance:
{'acc': 0.9680925, 'precision': 0.7405093, 'recall': 0.6366008, 'specificity': 0.6366008, 'f1': 0.6728622, 'auroc': 0.85852355, 'binary_precision': 0.50445104, 'binary_recall': 0.28239202, 'binary_specificity': 0.99080956, 'binary_f1_score': 0.36208734}
confusion matrix:
       0    1
0  18004  167
1    432  170
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9596089, 'precision': 0.70358497, 'recall': 0.57252765, 'specificity': 0.57252765, 'f1': 0.60312825, 'auroc': 0.8225909, 'binary_precision': 0.44047618, 'binary_recall': 0.15289256, 'binary_specificity': 0.99216276, 'binary_f1_score': 0.22699384}
confusion matrix:
      0   1
0  5950  47
1   205  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546984_17.png
early stop counter: 8
val acc:0.9680925011634827, best validation acc: 0.9691045880317688, corresponding to test acc:                         0.9628145694732666 / 0.9676229953765869
after epoch: 17,now: 2024-06-22 22:32:23.320837,epoch time: 0:09:37.218854,used: 2:39:50.443356,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_19_52_32_seed_2_21546984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9928279, 'precision': 0.988812, 'recall': 0.96987116, 'specificity': 0.96987116, 'f1': 0.9791045, 'auroc': 0.9969592, 'binary_precision': 0.9838821, 'binary_recall': 0.9413968, 'binary_specificity': 0.9983455, 'binary_f1_score': 0.96217066}
confusion matrix:
       0     1
0  42239    70
1    266  4273
---- Validation: 
scalar performance:
{'acc': 0.9683055, 'precision': 0.7439454, 'recall': 0.61181635, 'specificity': 0.61181635, 'f1': 0.65110886, 'auroc': 0.85502493, 'binary_precision': 0.51291513, 'binary_recall': 0.23089701, 'binary_specificity': 0.9927357, 'binary_f1_score': 0.31844217}
confusion matrix:
       0    1
0  18039  132
1    463  139
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9604103, 'precision': 0.7165423, 'recall': 0.568979, 'specificity': 0.568979, 'f1': 0.60025465, 'auroc': 0.8231063, 'binary_precision': 0.46666667, 'binary_recall': 0.1446281, 'binary_specificity': 0.99333, 'binary_f1_score': 0.22082019}
confusion matrix:
      0   1
0  5957  40
1   207  35
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546984_18.png
early stop counter: 9
val acc:0.9683055281639099, best validation acc: 0.9691045880317688, corresponding to test acc:                         0.9628145694732666 / 0.9676229953765869
after epoch: 18,now: 2024-06-22 22:41:48.553829,epoch time: 0:09:25.232992,used: 2:49:15.676348,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_19_52_32_seed_2_21546984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9926358, 'precision': 0.98554164, 'recall': 0.9720266, 'specificity': 0.9720266, 'f1': 0.9786631, 'auroc': 0.9972818, 'binary_precision': 0.97680765, 'binary_recall': 0.946464, 'binary_specificity': 0.9975892, 'binary_f1_score': 0.96139646}
confusion matrix:
       0     1
0  42207   102
1    243  4296
---- Validation: 
scalar performance:
{'acc': 0.96777284, 'precision': 0.7358985, 'recall': 0.6324204, 'specificity': 0.6324204, 'f1': 0.668208, 'auroc': 0.8596139, 'binary_precision': 0.4954955, 'binary_recall': 0.2740864, 'binary_specificity': 0.9907545, 'binary_f1_score': 0.3529412}
confusion matrix:
       0    1
0  18003  168
1    437  165
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597692, 'precision': 0.7095357, 'recall': 0.5825247, 'specificity': 0.5825247, 'f1': 0.615038, 'auroc': 0.81719285, 'binary_precision': 0.4516129, 'binary_recall': 0.17355372, 'binary_specificity': 0.9914957, 'binary_f1_score': 0.25074628}
confusion matrix:
      0   1
0  5946  51
1   200  42
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546984_19.png
early stop counter: 10
val acc:0.9677728414535522, best validation acc: 0.9691045880317688, corresponding to test acc:                         0.9628145694732666 / 0.9676229953765869
after epoch: 19,now: 2024-06-22 22:51:05.773488,epoch time: 0:09:17.219659,used: 2:58:32.896007,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_19_52_32_seed_2_21546984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99287057, 'precision': 0.985603, 'recall': 0.9733366, 'specificity': 0.9733366, 'f1': 0.97937024, 'auroc': 0.99712014, 'binary_precision': 0.9766493, 'binary_recall': 0.9491077, 'binary_specificity': 0.9975655, 'binary_f1_score': 0.9626816}
confusion matrix:
       0     1
0  42206   103
1    231  4308
---- Validation: 
scalar performance:
{'acc': 0.9683588, 'precision': 0.7445047, 'recall': 0.6254957, 'specificity': 0.6254957, 'f1': 0.66407955, 'auroc': 0.85131866, 'binary_precision': 0.5131579, 'binary_recall': 0.2591362, 'binary_specificity': 0.99185514, 'binary_f1_score': 0.34437084}
confusion matrix:
       0    1
0  18023  148
1    446  156
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9578458, 'precision': 0.67805386, 'recall': 0.5716105, 'specificity': 0.5716105, 'f1': 0.5989612, 'auroc': 0.80972683, 'binary_precision': 0.38947368, 'binary_recall': 0.15289256, 'binary_specificity': 0.9903285, 'binary_f1_score': 0.21958455}
confusion matrix:
      0   1
0  5939  58
1   205  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546984_20.png
early stop counter: 11
val acc:0.9683588147163391, best validation acc: 0.9691045880317688, corresponding to test acc:                         0.9628145694732666 / 0.9676229953765869
after epoch: 20,now: 2024-06-22 23:00:22.329922,epoch time: 0:09:16.556434,used: 3:07:49.452441,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_19_52_32_seed_2_21546984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9925077, 'precision': 0.9872142, 'recall': 0.96958905, 'specificity': 0.96958905, 'f1': 0.9781959, 'auroc': 0.99716175, 'binary_precision': 0.9807118, 'binary_recall': 0.9411635, 'binary_specificity': 0.9980146, 'binary_f1_score': 0.9605308}
confusion matrix:
       0     1
0  42226    84
1    267  4271
---- Validation: 
scalar performance:
{'acc': 0.968199, 'precision': 0.742082, 'recall': 0.6101552, 'specificity': 0.6101552, 'f1': 0.64915144, 'auroc': 0.8544477, 'binary_precision': 0.5092937, 'binary_recall': 0.22757475, 'binary_specificity': 0.9927357, 'binary_f1_score': 0.31458092}
confusion matrix:
       0    1
0  18039  132
1    465  137
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95816636, 'precision': 0.67713684, 'recall': 0.56384635, 'specificity': 0.56384635, 'f1': 0.5901776, 'auroc': 0.8077662, 'binary_precision': 0.3882353, 'binary_recall': 0.13636364, 'binary_specificity': 0.991329, 'binary_f1_score': 0.20183487}
confusion matrix:
      0   1
0  5945  52
1   209  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546984_21.png
early stop counter: 12
val acc:0.9681990146636963, best validation acc: 0.9691045880317688, corresponding to test acc:                         0.9628145694732666 / 0.9676229953765869
after epoch: 21,now: 2024-06-22 23:09:42.615713,epoch time: 0:09:20.285791,used: 3:17:09.738232,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_19_52_32_seed_2_21546984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99208075, 'precision': 0.9872364, 'recall': 0.9670974, 'specificity': 0.9670974, 'f1': 0.9768977, 'auroc': 0.9976318, 'binary_precision': 0.9812933, 'binary_recall': 0.9361093, 'binary_specificity': 0.9980855, 'binary_f1_score': 0.9581689}
confusion matrix:
       0     1
0  42228    81
1    290  4249
---- Validation: 
scalar performance:
{'acc': 0.9680392, 'precision': 0.7390907, 'recall': 0.5956178, 'specificity': 0.5956178, 'f1': 0.63383216, 'auroc': 0.85559726, 'binary_precision': 0.5042373, 'binary_recall': 0.19767442, 'binary_specificity': 0.99356115, 'binary_f1_score': 0.28400955}
confusion matrix:
       0    1
0  18054  117
1    483  119
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96105146, 'precision': 0.729147, 'recall': 0.5633643, 'specificity': 0.5633643, 'f1': 0.5942518, 'auroc': 0.81948245, 'binary_precision': 0.4923077, 'binary_recall': 0.1322314, 'binary_specificity': 0.99449724, 'binary_f1_score': 0.20846905}
confusion matrix:
      0   1
0  5964  33
1   210  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546984_22.png
early stop counter: 13
val acc:0.9680392146110535, best validation acc: 0.9691045880317688, corresponding to test acc:                         0.9628145694732666 / 0.9676229953765869
after epoch: 22,now: 2024-06-22 23:19:01.074113,epoch time: 0:09:18.458400,used: 3:26:28.196632,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_19_52_32_seed_2_21546984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9923796, 'precision': 0.98556376, 'recall': 0.970508, 'specificity': 0.970508, 'f1': 0.9778855, 'auroc': 0.9972286, 'binary_precision': 0.97717935, 'binary_recall': 0.9433796, 'binary_specificity': 0.99763644, 'binary_f1_score': 0.95998204}
confusion matrix:
       0     1
0  42209   100
1    257  4282
---- Validation: 
scalar performance:
{'acc': 0.9683588, 'precision': 0.74483913, 'recall': 0.61345, 'specificity': 0.61345, 'f1': 0.6528596, 'auroc': 0.8613616, 'binary_precision': 0.51459855, 'binary_recall': 0.23421927, 'binary_specificity': 0.99268067, 'binary_f1_score': 0.3219178}
confusion matrix:
       0    1
0  18038  133
1    461  141
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95816636, 'precision': 0.6784972, 'recall': 0.56582904, 'specificity': 0.56582904, 'f1': 0.59260184, 'auroc': 0.8243211, 'binary_precision': 0.3908046, 'binary_recall': 0.14049587, 'binary_specificity': 0.99116224, 'binary_f1_score': 0.20668693}
confusion matrix:
      0   1
0  5944  53
1   208  34
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546984_23.png
early stop counter: 14
val acc:0.9683588147163391, best validation acc: 0.9691045880317688, corresponding to test acc:                         0.9628145694732666 / 0.9676229953765869
after epoch: 23,now: 2024-06-22 23:28:18.604768,epoch time: 0:09:17.530655,used: 3:35:45.727287,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_19_52_32_seed_2_21546984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99216616, 'precision': 0.979373, 'recall': 0.97569036, 'specificity': 0.97569036, 'f1': 0.9775226, 'auroc': 0.9972376, 'binary_precision': 0.96353936, 'binary_recall': 0.95525676, 'binary_specificity': 0.9961239, 'binary_f1_score': 0.9593802}
confusion matrix:
       0     1
0  42147   164
1    203  4334
---- Validation: 
scalar performance:
{'acc': 0.9673467, 'precision': 0.7300811, 'recall': 0.6322003, 'specificity': 0.6322003, 'f1': 0.66659987, 'auroc': 0.8586508, 'binary_precision': 0.48387095, 'binary_recall': 0.2740864, 'binary_specificity': 0.99031425, 'binary_f1_score': 0.34994698}
confusion matrix:
       0    1
0  17995  176
1    437  165
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95688415, 'precision': 0.66356117, 'recall': 0.5671448, 'specificity': 0.5671448, 'f1': 0.5921649, 'auroc': 0.801108, 'binary_precision': 0.36082473, 'binary_recall': 0.1446281, 'binary_specificity': 0.9896615, 'binary_f1_score': 0.20648968}
confusion matrix:
      0   1
0  5935  62
1   207  35
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546984_24.png
early stop counter: 15
val acc:0.967346727848053, best validation acc: 0.9691045880317688, corresponding to test acc:                         0.9628145694732666 / 0.9676229953765869
after epoch: 24,now: 2024-06-22 23:37:35.584597,epoch time: 0:09:16.979829,used: 3:45:02.707116,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_19_52_32_seed_2_21546984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9927638, 'precision': 0.98428464, 'recall': 0.97406423, 'specificity': 0.97406423, 'f1': 0.97910523, 'auroc': 0.9979683, 'binary_precision': 0.9738267, 'binary_recall': 0.9508702, 'binary_specificity': 0.99725825, 'binary_f1_score': 0.9622116}
confusion matrix:
       0     1
0  42193   116
1    223  4316
---- Validation: 
scalar performance:
{'acc': 0.968199, 'precision': 0.74200654, 'recall': 0.62059486, 'specificity': 0.62059486, 'f1': 0.65907925, 'auroc': 0.8638413, 'binary_precision': 0.5084746, 'binary_recall': 0.24916944, 'binary_specificity': 0.99202025, 'binary_f1_score': 0.33444816}
confusion matrix:
       0    1
0  18026  145
1    452  150
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9560827, 'precision': 0.6416954, 'recall': 0.55284876, 'specificity': 0.55284876, 'f1': 0.5735709, 'auroc': 0.8127361, 'binary_precision': 0.3181818, 'binary_recall': 0.11570248, 'binary_specificity': 0.989995, 'binary_f1_score': 0.16969697}
confusion matrix:
      0   1
0  5937  60
1   214  28
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546984_25.png
