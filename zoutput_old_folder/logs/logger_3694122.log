Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0




!!!: not committed yet



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_53_01_seed_0_21316515

 Experiment start at: 2024-06-13 16:53:01.538205
before training, model accuracy: 0.3101629912853241
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9664322, 'precision': 0.7957473, 'recall': 0.5016629, 'specificity': 0.5016629, 'f1': 0.4948422, 'auroc': 0.8441539, 'binary_precision': 0.625, 'binary_recall': 0.003396739, 'binary_specificity': 0.99992913, 'binary_f1_score': 0.0067567565}
confusion matrix:
       0  1
0  42317  3
1   1467  5
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.8353907, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.9792999, 'recall': 0.50383145, 'specificity': 0.50383145, 'f1': 0.4970357, 'auroc': 0.83621424, 'binary_precision': 1.0, 'binary_recall': 0.007662835, 'binary_specificity': 1.0, 'binary_f1_score': 0.015209124}
confusion matrix:
      0  1
0  5997  0
1   259  2
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316515_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-13 17:15:05.242198,epoch time: 0:22:03.703993,used: 0:22:03.703993,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_53_01_seed_0_21316515
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9667291, 'precision': 0.7471408, 'recall': 0.55296254, 'specificity': 0.55296254, 'f1': 0.5820101, 'auroc': 0.89562285, 'binary_precision': 0.52443, 'binary_recall': 0.109375, 'binary_specificity': 0.9965501, 'binary_f1_score': 0.18100056}
confusion matrix:
       0    1
0  42174  146
1   1311  161
---- Validation: 
scalar performance:
{'acc': 0.965943, 'precision': 0.7423068, 'recall': 0.53533524, 'specificity': 0.53533524, 'f1': 0.5553489, 'auroc': 0.89921623, 'binary_precision': 0.51648355, 'binary_recall': 0.07309487, 'binary_specificity': 0.99757564, 'binary_f1_score': 0.1280654}
confusion matrix:
       0   1
0  18105  44
1    596  47
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9688399, 'precision': 0.97697663, 'recall': 0.6282691, 'specificity': 0.6282691, 'f1': 0.6956471, 'auroc': 0.8814752, 'binary_precision': 0.9852941, 'binary_recall': 0.256705, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.4072948}
confusion matrix:
      0   1
0  5996   1
1   194  67
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316515_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-13 17:34:21.387176,epoch time: 0:19:16.144978,used: 0:41:19.848971,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_53_01_seed_0_21316515
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9665464, 'precision': 0.73902094, 'recall': 0.60407555, 'specificity': 0.60407555, 'f1': 0.6424555, 'auroc': 0.9038538, 'binary_precision': 0.5047771, 'binary_recall': 0.21549965, 'binary_specificity': 0.9926514, 'binary_f1_score': 0.3020486}
confusion matrix:
       0    1
0  42010  311
1   1154  317
---- Validation: 
scalar performance:
{'acc': 0.96663475, 'precision': 0.76164687, 'recall': 0.5626954, 'specificity': 0.5626954, 'f1': 0.59614474, 'auroc': 0.908458, 'binary_precision': 0.55333334, 'binary_recall': 0.12908243, 'binary_specificity': 0.9963083, 'binary_f1_score': 0.20933165}
confusion matrix:
       0   1
0  18082  67
1    560  83
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9705976, 'precision': 0.97292227, 'recall': 0.65117425, 'specificity': 0.65117425, 'f1': 0.7234371, 'auroc': 0.8858598, 'binary_precision': 0.97530866, 'binary_recall': 0.30268198, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.46198833}
confusion matrix:
      0   1
0  5995   2
1   182  79
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316515_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-13 17:53:35.200852,epoch time: 0:19:13.813676,used: 1:00:33.662647,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_53_01_seed_0_21316515
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9664779, 'precision': 0.73839885, 'recall': 0.6138144, 'specificity': 0.6138144, 'f1': 0.6519069, 'auroc': 0.907071, 'binary_precision': 0.5028986, 'binary_recall': 0.2357337, 'binary_specificity': 0.9918951, 'binary_f1_score': 0.3209991}
confusion matrix:
       0    1
0  41977  343
1   1125  347
---- Validation: 
scalar performance:
{'acc': 0.96674114, 'precision': 0.7561884, 'recall': 0.59050256, 'specificity': 0.59050256, 'f1': 0.6302178, 'auroc': 0.90862, 'binary_precision': 0.5405405, 'binary_recall': 0.1866252, 'binary_specificity': 0.9943799, 'binary_f1_score': 0.27745664}
confusion matrix:
       0    1
0  18047  102
1    523  120
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97251517, 'precision': 0.9657473, 'recall': 0.6778274, 'specificity': 0.6778274, 'f1': 0.7527031, 'auroc': 0.8871658, 'binary_precision': 0.9587629, 'binary_recall': 0.35632184, 'binary_specificity': 0.999333, 'binary_f1_score': 0.5195531}
confusion matrix:
      0   1
0  5993   4
1   168  93
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316515_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-13 18:12:54.263376,epoch time: 0:19:19.062524,used: 1:19:52.725171,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_53_01_seed_0_21316515
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9674826, 'precision': 0.7534107, 'recall': 0.63269436, 'specificity': 0.63269436, 'f1': 0.6723758, 'auroc': 0.9180287, 'binary_precision': 0.5316623, 'binary_recall': 0.2737772, 'binary_specificity': 0.99161154, 'binary_f1_score': 0.361435}
confusion matrix:
       0    1
0  41965  355
1   1069  403
---- Validation: 
scalar performance:
{'acc': 0.9675926, 'precision': 0.7783541, 'recall': 0.58869314, 'specificity': 0.58869314, 'f1': 0.6305023, 'auroc': 0.91687083, 'binary_precision': 0.585, 'binary_recall': 0.18195957, 'binary_specificity': 0.9954268, 'binary_f1_score': 0.27758005}
confusion matrix:
       0    1
0  18066   83
1    526  117
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.971876, 'precision': 0.96949023, 'recall': 0.6683322, 'specificity': 0.6683322, 'f1': 0.74276555, 'auroc': 0.88891923, 'binary_precision': 0.96703297, 'binary_recall': 0.33716476, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.5}
confusion matrix:
      0   1
0  5994   3
1   173  88
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316515_5.png
better model found
persisted
after epoch: 5,now: 2024-06-13 18:32:07.427476,epoch time: 0:19:13.164100,used: 1:39:05.889271,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_53_01_seed_0_21316515
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9668204, 'precision': 0.7436695, 'recall': 0.62808955, 'specificity': 0.62808955, 'f1': 0.66614103, 'auroc': 0.91453797, 'binary_precision': 0.5124836, 'binary_recall': 0.26494566, 'binary_specificity': 0.99123347, 'binary_f1_score': 0.3493059}
confusion matrix:
       0    1
0  41949  371
1   1082  390
---- Validation: 
scalar performance:
{'acc': 0.96695405, 'precision': 0.76017106, 'recall': 0.594363, 'specificity': 0.594363, 'f1': 0.63505566, 'auroc': 0.91547847, 'binary_precision': 0.5482456, 'binary_recall': 0.19440125, 'binary_specificity': 0.99432474, 'binary_f1_score': 0.2870264}
confusion matrix:
       0    1
0  18046  103
1    518  125
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9715564, 'precision': 0.97978103, 'recall': 0.66083616, 'specificity': 0.66083616, 'f1': 0.73546153, 'auroc': 0.8872348, 'binary_precision': 0.9882353, 'binary_recall': 0.3218391, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.48554915}
confusion matrix:
      0   1
0  5996   1
1   177  84
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316515_6.png
early stop counter: 1
val acc:0.9669540524482727, best validation acc: 0.9675925970077515, corresponding to test acc:                         0.9718760251998901 / 0.9725151658058167
after epoch: 6,now: 2024-06-13 18:51:19.040254,epoch time: 0:19:11.612778,used: 1:58:17.502049,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_53_01_seed_0_21316515
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9674598, 'precision': 0.7514373, 'recall': 0.65048075, 'specificity': 0.65048075, 'f1': 0.6870244, 'auroc': 0.92158675, 'binary_precision': 0.5264977, 'binary_recall': 0.310673, 'binary_specificity': 0.9902885, 'binary_f1_score': 0.39076528}
confusion matrix:
       0    1
0  41910  411
1   1014  457
---- Validation: 
scalar performance:
{'acc': 0.96780545, 'precision': 0.77569824, 'recall': 0.60605466, 'specificity': 0.60605466, 'f1': 0.6499494, 'auroc': 0.9241612, 'binary_precision': 0.5785124, 'binary_recall': 0.21772939, 'binary_specificity': 0.9943799, 'binary_f1_score': 0.31638417}
confusion matrix:
       0    1
0  18047  102
1    503  140
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97363377, 'precision': 0.9721362, 'recall': 0.689405, 'specificity': 0.689405, 'f1': 0.7659388, 'auroc': 0.8926734, 'binary_precision': 0.9705882, 'binary_recall': 0.37931034, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.5454545}
confusion matrix:
      0   1
0  5994   3
1   162  99
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316515_7.png
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-06-13 19:10:29.965818,epoch time: 0:19:10.925564,used: 2:17:28.427613,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_53_01_seed_0_21316515
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9668889, 'precision': 0.7441474, 'recall': 0.6406708, 'specificity': 0.6406708, 'f1': 0.67710114, 'auroc': 0.9205222, 'binary_precision': 0.51257485, 'binary_recall': 0.29095852, 'binary_specificity': 0.990383, 'binary_f1_score': 0.37120554}
confusion matrix:
       0    1
0  41914  407
1   1043  428
---- Validation: 
scalar performance:
{'acc': 0.9668476, 'precision': 0.7526803, 'recall': 0.6295605, 'specificity': 0.6295605, 'f1': 0.6693627, 'auroc': 0.92821956, 'binary_precision': 0.5308642, 'binary_recall': 0.2674961, 'binary_specificity': 0.9916249, 'binary_f1_score': 0.35573938}
confusion matrix:
       0    1
0  17997  152
1    471  172
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97347397, 'precision': 0.9674225, 'recall': 0.6893217, 'specificity': 0.6893217, 'f1': 0.7651479, 'auroc': 0.8969555, 'binary_precision': 0.9611651, 'binary_recall': 0.37931034, 'binary_specificity': 0.999333, 'binary_f1_score': 0.54395604}
confusion matrix:
      0   1
0  5993   4
1   162  99
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316515_8.png
early stop counter: 1
val acc:0.9668475985527039, best validation acc: 0.9678054451942444, corresponding to test acc:                         0.9736337661743164 / 0.9736337661743164
after epoch: 8,now: 2024-06-13 19:29:35.732183,epoch time: 0:19:05.766365,used: 2:36:34.193978,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_53_01_seed_0_21316515
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.96768814, 'precision': 0.75569326, 'recall': 0.6409972, 'specificity': 0.6409972, 'f1': 0.68017024, 'auroc': 0.9283122, 'binary_precision': 0.53566957, 'binary_recall': 0.29076087, 'binary_specificity': 0.99123347, 'binary_f1_score': 0.37692645}
confusion matrix:
       0    1
0  41949  371
1   1044  428
---- Validation: 
scalar performance:
{'acc': 0.96722007, 'precision': 0.7696669, 'recall': 0.58550006, 'specificity': 0.58550006, 'f1': 0.6258215, 'auroc': 0.9280274, 'binary_precision': 0.5678392, 'binary_recall': 0.17573872, 'binary_specificity': 0.99526143, 'binary_f1_score': 0.26840854}
confusion matrix:
       0    1
0  18063   86
1    530  113
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.971077, 'precision': 0.9853512, 'recall': 0.6532567, 'specificity': 0.6532567, 'f1': 0.7271708, 'auroc': 0.88949835, 'binary_precision': 1.0, 'binary_recall': 0.3065134, 'binary_specificity': 1.0, 'binary_f1_score': 0.46920818}
confusion matrix:
      0   1
0  5997   0
1   181  80
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316515_9.png
early stop counter: 2
val acc:0.9672200679779053, best validation acc: 0.9678054451942444, corresponding to test acc:                         0.9736337661743164 / 0.9736337661743164
after epoch: 9,now: 2024-06-13 19:48:43.769021,epoch time: 0:19:08.036838,used: 2:55:42.230816,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_53_01_seed_0_21316515
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9681677, 'precision': 0.75909495, 'recall': 0.67206407, 'specificity': 0.67206407, 'f1': 0.70592403, 'auroc': 0.92692924, 'binary_precision': 0.54037267, 'binary_recall': 0.35461956, 'binary_specificity': 0.9895085, 'binary_f1_score': 0.42821983}
confusion matrix:
       0    1
0  41876  444
1    950  522
---- Validation: 
scalar performance:
{'acc': 0.968178, 'precision': 0.7789904, 'recall': 0.61824834, 'specificity': 0.61824834, 'f1': 0.66327566, 'auroc': 0.9246912, 'binary_precision': 0.58426964, 'binary_recall': 0.24261275, 'binary_specificity': 0.99388397, 'binary_f1_score': 0.34285712}
confusion matrix:
       0    1
0  18038  111
1    487  156
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9705976, 'precision': 0.97292227, 'recall': 0.65117425, 'specificity': 0.65117425, 'f1': 0.7234371, 'auroc': 0.8890743, 'binary_precision': 0.97530866, 'binary_recall': 0.30268198, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.46198833}
confusion matrix:
      0   1
0  5995   2
1   182  79
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316515_10.png
better model found
persisted
after epoch: 10,now: 2024-06-13 20:07:44.883077,epoch time: 0:19:01.114056,used: 3:14:43.344872,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_53_01_seed_0_21316515
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96768814, 'precision': 0.7527617, 'recall': 0.68361884, 'specificity': 0.68361884, 'f1': 0.71214783, 'auroc': 0.9271902, 'binary_precision': 0.52691215, 'binary_recall': 0.3790761, 'binary_specificity': 0.9881616, 'binary_f1_score': 0.44093245}
confusion matrix:
       0    1
0  41819  501
1    914  558
---- Validation: 
scalar performance:
{'acc': 0.9679119, 'precision': 0.76789916, 'recall': 0.63986224, 'specificity': 0.63986224, 'f1': 0.6818984, 'auroc': 0.93185014, 'binary_precision': 0.56060606, 'binary_recall': 0.28771386, 'binary_specificity': 0.9920106, 'binary_f1_score': 0.38026723}
confusion matrix:
       0    1
0  18004  145
1    458  185
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97267497, 'precision': 0.9660367, 'recall': 0.6797432, 'specificity': 0.6797432, 'f1': 0.75480545, 'auroc': 0.8937772, 'binary_precision': 0.9591837, 'binary_recall': 0.36015326, 'binary_specificity': 0.999333, 'binary_f1_score': 0.52367693}
confusion matrix:
      0   1
0  5993   4
1   167  94
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316515_11.png
early stop counter: 1
val acc:0.9679118990898132, best validation acc: 0.9681779742240906, corresponding to test acc:                         0.9705976247787476 / 0.9736337661743164
after epoch: 11,now: 2024-06-13 20:26:47.419055,epoch time: 0:19:02.535978,used: 3:33:45.880850,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_53_01_seed_0_21316515
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.96807635, 'precision': 0.76020825, 'recall': 0.65070593, 'specificity': 0.65070593, 'f1': 0.6894671, 'auroc': 0.92806315, 'binary_precision': 0.5440476, 'binary_recall': 0.31046197, 'binary_specificity': 0.9909499, 'binary_f1_score': 0.39532873}
confusion matrix:
       0    1
0  41937  383
1   1015  457
---- Validation: 
scalar performance:
{'acc': 0.9673265, 'precision': 0.76732206, 'recall': 0.5990562, 'specificity': 0.5990562, 'f1': 0.6411801, 'auroc': 0.9340855, 'binary_precision': 0.5622318, 'binary_recall': 0.2037325, 'binary_specificity': 0.9943799, 'binary_f1_score': 0.29908678}
confusion matrix:
       0    1
0  18047  102
1    512  131
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.970278, 'precision': 0.98495877, 'recall': 0.6436782, 'specificity': 0.6436782, 'f1': 0.7155788, 'auroc': 0.8949395, 'binary_precision': 1.0, 'binary_recall': 0.28735632, 'binary_specificity': 1.0, 'binary_f1_score': 0.44642854}
confusion matrix:
      0   1
0  5997   0
1   186  75
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316515_12.png
early stop counter: 2
val acc:0.9673265218734741, best validation acc: 0.9681779742240906, corresponding to test acc:                         0.9705976247787476 / 0.9736337661743164
after epoch: 12,now: 2024-06-13 20:45:50.907262,epoch time: 0:19:03.488207,used: 3:52:49.369057,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_53_01_seed_0_21316515
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.967574, 'precision': 0.7531192, 'recall': 0.65241313, 'specificity': 0.65241313, 'f1': 0.6890276, 'auroc': 0.9291249, 'binary_precision': 0.52974826, 'binary_recall': 0.31453803, 'binary_specificity': 0.99028826, 'binary_f1_score': 0.3947144}
confusion matrix:
       0    1
0  41909  411
1   1009  463
---- Validation: 
scalar performance:
{'acc': 0.96674114, 'precision': 0.7507147, 'recall': 0.6340057, 'specificity': 0.6340057, 'f1': 0.67291, 'auroc': 0.93747735, 'binary_precision': 0.52662724, 'binary_recall': 0.27682737, 'binary_specificity': 0.9911841, 'binary_f1_score': 0.36289498}
confusion matrix:
       0    1
0  17989  160
1    465  178
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97283477, 'precision': 0.9709831, 'recall': 0.6798265, 'specificity': 0.6798265, 'f1': 0.7555785, 'auroc': 0.89687264, 'binary_precision': 0.96907216, 'binary_recall': 0.36015326, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.52513963}
confusion matrix:
      0   1
0  5994   3
1   167  94
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316515_13.png
early stop counter: 3
val acc:0.966741144657135, best validation acc: 0.9681779742240906, corresponding to test acc:                         0.9705976247787476 / 0.9736337661743164
after epoch: 13,now: 2024-06-13 21:04:48.325696,epoch time: 0:18:57.418434,used: 4:11:46.787491,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_53_01_seed_0_21316515
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96787083, 'precision': 0.75342, 'recall': 0.7039755, 'specificity': 0.7039755, 'f1': 0.725744, 'auroc': 0.9325086, 'binary_precision': 0.5268085, 'binary_recall': 0.42108843, 'binary_specificity': 0.9868626, 'binary_f1_score': 0.4680529}
confusion matrix:
       0    1
0  41766  556
1    851  619
---- Validation: 
scalar performance:
{'acc': 0.9676458, 'precision': 0.7597114, 'recall': 0.66972667, 'specificity': 0.66972667, 'f1': 0.7043426, 'auroc': 0.93599236, 'binary_precision': 0.5421687, 'binary_recall': 0.34992224, 'binary_specificity': 0.9895311, 'binary_f1_score': 0.42533082}
confusion matrix:
       0    1
0  17959  190
1    418  225
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97331417, 'precision': 0.9671531, 'recall': 0.68740594, 'specificity': 0.68740594, 'f1': 0.7631017, 'auroc': 0.8943541, 'binary_precision': 0.9607843, 'binary_recall': 0.37547892, 'binary_specificity': 0.999333, 'binary_f1_score': 0.5399449}
confusion matrix:
      0   1
0  5993   4
1   163  98
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316515_14.png
early stop counter: 4
val acc:0.9676458239555359, best validation acc: 0.9681779742240906, corresponding to test acc:                         0.9705976247787476 / 0.9736337661743164
after epoch: 14,now: 2024-06-13 21:23:55.672965,epoch time: 0:19:07.347269,used: 4:30:54.134760,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_53_01_seed_0_21316515
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9684189, 'precision': 0.76067686, 'recall': 0.6872755, 'specificity': 0.6872755, 'f1': 0.7173572, 'auroc': 0.9282526, 'binary_precision': 0.5425024, 'binary_recall': 0.38586956, 'binary_specificity': 0.9886815, 'binary_f1_score': 0.45097262}
confusion matrix:
       0    1
0  41841  479
1    904  568
---- Validation: 
scalar performance:
{'acc': 0.968178, 'precision': 0.7706301, 'recall': 0.64675045, 'specificity': 0.64675045, 'f1': 0.68858474, 'auroc': 0.93646026, 'binary_precision': 0.56559765, 'binary_recall': 0.30171072, 'binary_specificity': 0.9917902, 'binary_f1_score': 0.39350912}
confusion matrix:
       0    1
0  18000  149
1    449  194
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9717162, 'precision': 0.97992814, 'recall': 0.66275185, 'specificity': 0.66275185, 'f1': 0.73768425, 'auroc': 0.8912208, 'binary_precision': 0.9883721, 'binary_recall': 0.3256705, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.48991358}
confusion matrix:
      0   1
0  5996   1
1   176  85
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316515_15.png
early stop counter: 5
val acc:0.9681779742240906, best validation acc: 0.9681779742240906, corresponding to test acc:                         0.9705976247787476 / 0.9736337661743164
after epoch: 15,now: 2024-06-13 21:43:06.707081,epoch time: 0:19:11.034116,used: 4:50:05.168876,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_53_01_seed_0_21316515
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.96857876, 'precision': 0.76163924, 'recall': 0.69653827, 'specificity': 0.69653827, 'f1': 0.7239946, 'auroc': 0.93510157, 'binary_precision': 0.54379565, 'binary_recall': 0.4048913, 'binary_specificity': 0.9881852, 'binary_f1_score': 0.46417445}
confusion matrix:
       0    1
0  41820  500
1    876  596
---- Validation: 
scalar performance:
{'acc': 0.967699, 'precision': 0.7622771, 'recall': 0.654003, 'specificity': 0.654003, 'f1': 0.69268584, 'auroc': 0.93377244, 'binary_precision': 0.5483871, 'binary_recall': 0.31726283, 'binary_specificity': 0.9907433, 'binary_f1_score': 0.40197045}
confusion matrix:
       0    1
0  17981  168
1    439  204
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97203577, 'precision': 0.9802177, 'recall': 0.6665833, 'specificity': 0.6665833, 'f1': 0.7420921, 'auroc': 0.89121354, 'binary_precision': 0.9886364, 'binary_recall': 0.33333334, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.49856734}
confusion matrix:
      0   1
0  5996   1
1   174  87
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316515_16.png
early stop counter: 6
val acc:0.9676989912986755, best validation acc: 0.9681779742240906, corresponding to test acc:                         0.9705976247787476 / 0.9736337661743164
after epoch: 16,now: 2024-06-13 22:02:18.382085,epoch time: 0:19:11.675004,used: 5:09:16.843880,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_53_01_seed_0_21316515
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9687157, 'precision': 0.7638006, 'recall': 0.6878767, 'specificity': 0.6878767, 'f1': 0.71882236, 'auroc': 0.9310547, 'binary_precision': 0.5486982, 'binary_recall': 0.3868117, 'binary_specificity': 0.98894167, 'binary_f1_score': 0.45374802}
confusion matrix:
       0    1
0  41853  468
1    902  569
---- Validation: 
scalar performance:
{'acc': 0.96961474, 'precision': 0.7899859, 'recall': 0.6594952, 'specificity': 0.6594952, 'f1': 0.70410514, 'auroc': 0.9362001, 'binary_precision': 0.6034483, 'binary_recall': 0.32659408, 'binary_specificity': 0.9923963, 'binary_f1_score': 0.42381433}
confusion matrix:
       0    1
0  18011  138
1    433  210
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97331417, 'precision': 0.9864536, 'recall': 0.6800766, 'specificity': 0.6800766, 'f1': 0.75792253, 'auroc': 0.8990488, 'binary_precision': 1.0, 'binary_recall': 0.36015326, 'binary_specificity': 1.0, 'binary_f1_score': 0.5295775}
confusion matrix:
      0   1
0  5997   0
1   167  94
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316515_17.png
better model found
persisted
after epoch: 17,now: 2024-06-13 22:21:20.273929,epoch time: 0:19:01.891844,used: 5:28:18.735724,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_53_01_seed_0_21316515
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9694693, 'precision': 0.77141446, 'recall': 0.6956095, 'specificity': 0.6956095, 'f1': 0.72675824, 'auroc': 0.9354677, 'binary_precision': 0.5633937, 'binary_recall': 0.4020408, 'binary_specificity': 0.9891782, 'binary_f1_score': 0.4692338}
confusion matrix:
       0    1
0  41864  458
1    879  591
---- Validation: 
scalar performance:
{'acc': 0.96972114, 'precision': 0.792305, 'recall': 0.6580502, 'specificity': 0.6580502, 'f1': 0.7033941, 'auroc': 0.9376546, 'binary_precision': 0.60818714, 'binary_recall': 0.32348368, 'binary_specificity': 0.99261665, 'binary_f1_score': 0.42233506}
confusion matrix:
       0    1
0  18015  134
1    435  208
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97219557, 'precision': 0.98036027, 'recall': 0.668499, 'specificity': 0.668499, 'f1': 0.7442775, 'auroc': 0.89704126, 'binary_precision': 0.98876405, 'binary_recall': 0.33716476, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.50285715}
confusion matrix:
      0   1
0  5996   1
1   173  88
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316515_18.png
better model found
persisted
after epoch: 18,now: 2024-06-13 22:40:25.197893,epoch time: 0:19:04.923964,used: 5:47:23.659688,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_53_01_seed_0_21316515
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9688071, 'precision': 0.7665965, 'recall': 0.67632914, 'specificity': 0.67632914, 'f1': 0.7113708, 'auroc': 0.93575954, 'binary_precision': 0.5550935, 'binary_recall': 0.36277175, 'binary_specificity': 0.9898866, 'binary_f1_score': 0.43878388}
confusion matrix:
       0    1
0  41892  428
1    938  534
---- Validation: 
scalar performance:
{'acc': 0.96902937, 'precision': 0.786963, 'recall': 0.64044076, 'specificity': 0.64044076, 'f1': 0.68638384, 'auroc': 0.9426216, 'binary_precision': 0.59870553, 'binary_recall': 0.28771386, 'binary_specificity': 0.99316764, 'binary_f1_score': 0.38865545}
confusion matrix:
       0    1
0  18025  124
1    458  185
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97251517, 'precision': 0.9657473, 'recall': 0.6778274, 'specificity': 0.6778274, 'f1': 0.7527031, 'auroc': 0.891817, 'binary_precision': 0.9587629, 'binary_recall': 0.35632184, 'binary_specificity': 0.999333, 'binary_f1_score': 0.5195531}
confusion matrix:
      0   1
0  5993   4
1   168  93
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316515_19.png
early stop counter: 1
val acc:0.9690293669700623, best validation acc: 0.9697211384773254, corresponding to test acc:                         0.972195565700531 / 0.9736337661743164
after epoch: 19,now: 2024-06-13 22:59:43.414532,epoch time: 0:19:18.216639,used: 6:06:41.876327,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_53_01_seed_0_21316515
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9700402, 'precision': 0.77971387, 'recall': 0.69020236, 'specificity': 0.69020236, 'f1': 0.72562695, 'auroc': 0.9331256, 'binary_precision': 0.58038425, 'binary_recall': 0.39021075, 'binary_specificity': 0.990194, 'binary_f1_score': 0.46666667}
confusion matrix:
       0    1
0  41906  415
1    897  574
---- Validation: 
scalar performance:
{'acc': 0.9683908, 'precision': 0.77323973, 'recall': 0.64986086, 'specificity': 0.64986086, 'f1': 0.6918839, 'auroc': 0.94102037, 'binary_precision': 0.57060516, 'binary_recall': 0.30793157, 'binary_specificity': 0.9917902, 'binary_f1_score': 0.4}
confusion matrix:
       0    1
0  18000  149
1    445  198
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97203577, 'precision': 0.9802177, 'recall': 0.6665833, 'specificity': 0.6665833, 'f1': 0.7420921, 'auroc': 0.8923265, 'binary_precision': 0.9886364, 'binary_recall': 0.33333334, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.49856734}
confusion matrix:
      0   1
0  5996   1
1   174  87
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316515_20.png
early stop counter: 2
val acc:0.9683908224105835, best validation acc: 0.9697211384773254, corresponding to test acc:                         0.972195565700531 / 0.9736337661743164
after epoch: 20,now: 2024-06-13 23:19:03.647827,epoch time: 0:19:20.233295,used: 6:26:02.109622,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_53_01_seed_0_21316515
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.96903545, 'precision': 0.76956743, 'recall': 0.67611945, 'specificity': 0.67611945, 'f1': 0.71210474, 'auroc': 0.93156767, 'binary_precision': 0.5610526, 'binary_recall': 0.3620924, 'binary_specificity': 0.9901465, 'binary_f1_score': 0.4401321}
confusion matrix:
       0    1
0  41903  417
1    939  533
---- Validation: 
scalar performance:
{'acc': 0.9686569, 'precision': 0.78082335, 'recall': 0.6387478, 'specificity': 0.6387478, 'f1': 0.6835829, 'auroc': 0.94127965, 'binary_precision': 0.58653843, 'binary_recall': 0.28460342, 'binary_specificity': 0.99289215, 'binary_f1_score': 0.38324606}
confusion matrix:
       0    1
0  18020  129
1    460  183
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9688399, 'precision': 0.9636477, 'recall': 0.6319338, 'specificity': 0.6319338, 'f1': 0.69920427, 'auroc': 0.89628804, 'binary_precision': 0.9583333, 'binary_recall': 0.26436782, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.41441444}
confusion matrix:
      0   1
0  5994   3
1   192  69
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316515_21.png
early stop counter: 3
val acc:0.9686568975448608, best validation acc: 0.9697211384773254, corresponding to test acc:                         0.972195565700531 / 0.9736337661743164
after epoch: 21,now: 2024-06-13 23:38:22.435748,epoch time: 0:19:18.787921,used: 6:45:20.897543,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_53_01_seed_0_21316515
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9689441, 'precision': 0.7659142, 'recall': 0.6925881, 'specificity': 0.6925881, 'f1': 0.72280514, 'auroc': 0.9346323, 'binary_precision': 0.55260664, 'binary_recall': 0.39632902, 'binary_specificity': 0.98884714, 'binary_f1_score': 0.46159938}
confusion matrix:
       0    1
0  41849  472
1    888  583
---- Validation: 
scalar performance:
{'acc': 0.9683376, 'precision': 0.7785699, 'recall': 0.62808174, 'specificity': 0.62808174, 'f1': 0.67301905, 'auroc': 0.94132674, 'binary_precision': 0.5827586, 'binary_recall': 0.2628305, 'binary_specificity': 0.993333, 'binary_f1_score': 0.36227223}
confusion matrix:
       0    1
0  18028  121
1    474  169
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9712368, 'precision': 0.9738177, 'recall': 0.6588371, 'specificity': 0.6588371, 'f1': 0.73248917, 'auroc': 0.89068997, 'binary_precision': 0.9764706, 'binary_recall': 0.31800765, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.47976878}
confusion matrix:
      0   1
0  5995   2
1   178  83
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316515_22.png
early stop counter: 4
val acc:0.9683375954627991, best validation acc: 0.9697211384773254, corresponding to test acc:                         0.972195565700531 / 0.9736337661743164
after epoch: 22,now: 2024-06-13 23:57:53.875404,epoch time: 0:19:31.439656,used: 7:04:52.337199,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_53_01_seed_0_21316515
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.96882993, 'precision': 0.7667004, 'recall': 0.6776524, 'specificity': 0.6776524, 'f1': 0.71238554, 'auroc': 0.93134284, 'binary_precision': 0.55521154, 'binary_recall': 0.36548913, 'binary_specificity': 0.9898157, 'binary_f1_score': 0.44080293}
confusion matrix:
       0    1
0  41889  431
1    934  538
---- Validation: 
scalar performance:
{'acc': 0.9686569, 'precision': 0.77721035, 'recall': 0.65074867, 'specificity': 0.65074867, 'f1': 0.69357395, 'auroc': 0.9430689, 'binary_precision': 0.57848835, 'binary_recall': 0.30948678, 'binary_specificity': 0.9920106, 'binary_f1_score': 0.40324217}
confusion matrix:
       0    1
0  18004  145
1    444  199
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9701182, 'precision': 0.9848803, 'recall': 0.64176244, 'specificity': 0.64176244, 'f1': 0.71321964, 'auroc': 0.894294, 'binary_precision': 1.0, 'binary_recall': 0.2835249, 'binary_specificity': 1.0, 'binary_f1_score': 0.44179106}
confusion matrix:
      0   1
0  5997   0
1   187  74
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316515_23.png
early stop counter: 5
val acc:0.9686568975448608, best validation acc: 0.9697211384773254, corresponding to test acc:                         0.972195565700531 / 0.9736337661743164
after epoch: 23,now: 2024-06-14 00:17:24.090616,epoch time: 0:19:30.215212,used: 7:24:22.552411,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_53_01_seed_0_21316515
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9686929, 'precision': 0.76616496, 'recall': 0.6634633, 'specificity': 0.6634633, 'f1': 0.7013674, 'auroc': 0.93463016, 'binary_precision': 0.55505615, 'binary_recall': 0.33628318, 'binary_specificity': 0.9906434, 'binary_f1_score': 0.4188215}
confusion matrix:
       0    1
0  41927  396
1    975  494
---- Validation: 
scalar performance:
{'acc': 0.9687633, 'precision': 0.784673, 'recall': 0.6335525, 'specificity': 0.6335525, 'f1': 0.67942417, 'auroc': 0.9402753, 'binary_precision': 0.5945946, 'binary_recall': 0.27371696, 'binary_specificity': 0.99338806, 'binary_f1_score': 0.37486687}
confusion matrix:
       0    1
0  18029  120
1    467  176
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96724194, 'precision': 0.98347306, 'recall': 0.6072797, 'specificity': 0.6072797, 'f1': 0.6682538, 'auroc': 0.8898613, 'binary_precision': 1.0, 'binary_recall': 0.21455939, 'binary_specificity': 1.0, 'binary_f1_score': 0.35331228}
confusion matrix:
      0   1
0  5997   0
1   205  56
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316515_24.png
early stop counter: 6
val acc:0.9687632918357849, best validation acc: 0.9697211384773254, corresponding to test acc:                         0.972195565700531 / 0.9736337661743164
after epoch: 24,now: 2024-06-14 00:36:58.787828,epoch time: 0:19:34.697212,used: 7:43:57.249623,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_53_01_seed_0_21316515
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9701772, 'precision': 0.77947354, 'recall': 0.69978786, 'specificity': 0.69978786, 'f1': 0.7323719, 'auroc': 0.9378064, 'binary_precision': 0.5792507, 'binary_recall': 0.40992522, 'binary_specificity': 0.98965055, 'binary_f1_score': 0.48009554}
confusion matrix:
       0    1
0  41883  438
1    868  603
---- Validation: 
scalar performance:
{'acc': 0.96977437, 'precision': 0.7931974, 'recall': 0.6580777, 'specificity': 0.6580777, 'f1': 0.7036226, 'auroc': 0.94211054, 'binary_precision': 0.6099707, 'binary_recall': 0.32348368, 'binary_specificity': 0.9926718, 'binary_f1_score': 0.4227642}
confusion matrix:
       0    1
0  18016  133
1    435  208
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9694791, 'precision': 0.9776983, 'recall': 0.63593197, 'specificity': 0.63593197, 'f1': 0.7053744, 'auroc': 0.89032274, 'binary_precision': 0.9861111, 'binary_recall': 0.27203065, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.4264264}
confusion matrix:
      0   1
0  5996   1
1   190  71
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316515_25.png
better model found
persisted
after epoch: 25,now: 2024-06-14 00:56:23.349356,epoch time: 0:19:24.561528,used: 8:03:21.811151,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_53_01_seed_0_21316515
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9707024, 'precision': 0.78219783, 'recall': 0.7189479, 'specificity': 0.7189479, 'f1': 0.7461939, 'auroc': 0.93757355, 'binary_precision': 0.58340687, 'binary_recall': 0.4490489, 'binary_specificity': 0.9888469, 'binary_f1_score': 0.50748557}
confusion matrix:
       0    1
0  41848  472
1    811  661
---- Validation: 
scalar performance:
{'acc': 0.96961474, 'precision': 0.79197323, 'recall': 0.6542448, 'specificity': 0.6542448, 'f1': 0.69997984, 'auroc': 0.93837, 'binary_precision': 0.60778445, 'binary_recall': 0.31570762, 'binary_specificity': 0.992782, 'binary_f1_score': 0.41555783}
confusion matrix:
       0    1
0  18018  131
1    440  203
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9688399, 'precision': 0.97697663, 'recall': 0.6282691, 'specificity': 0.6282691, 'f1': 0.6956471, 'auroc': 0.8878219, 'binary_precision': 0.9852941, 'binary_recall': 0.256705, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.4072948}
confusion matrix:
      0   1
0  5996   1
1   194  67
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316515_26.png
early stop counter: 1
val acc:0.9696147441864014, best validation acc: 0.9697743654251099, corresponding to test acc:                         0.9694790840148926 / 0.9736337661743164
after epoch: 26,now: 2024-06-14 01:15:39.985358,epoch time: 0:19:16.636002,used: 8:22:38.447153,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_53_01_seed_0_21316515
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9692638, 'precision': 0.768663, 'recall': 0.6999715, 'specificity': 0.6999715, 'f1': 0.7287829, 'auroc': 0.93535316, 'binary_precision': 0.55760366, 'binary_recall': 0.41128483, 'binary_specificity': 0.98865813, 'binary_f1_score': 0.47339588}
confusion matrix:
       0    1
0  41841  480
1    866  605
---- Validation: 
scalar performance:
{'acc': 0.96897614, 'precision': 0.7803372, 'recall': 0.6576645, 'specificity': 0.6576645, 'f1': 0.7002405, 'auroc': 0.9432819, 'binary_precision': 0.58426964, 'binary_recall': 0.32348368, 'binary_specificity': 0.9918453, 'binary_f1_score': 0.4164164}
confusion matrix:
       0    1
0  18001  148
1    435  208
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96756154, 'precision': 0.9676508, 'recall': 0.6147758, 'specificity': 0.6147758, 'f1': 0.6774341, 'auroc': 0.8894417, 'binary_precision': 0.9677419, 'binary_recall': 0.22988506, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.37151703}
confusion matrix:
      0   1
0  5995   2
1   201  60
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316515_27.png
early stop counter: 2
val acc:0.9689761400222778, best validation acc: 0.9697743654251099, corresponding to test acc:                         0.9694790840148926 / 0.9736337661743164
after epoch: 27,now: 2024-06-14 01:35:03.441079,epoch time: 0:19:23.455721,used: 8:42:01.902874,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_53_01_seed_0_21316515
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9700174, 'precision': 0.7794901, 'recall': 0.6898625, 'specificity': 0.6898625, 'f1': 0.7253094, 'auroc': 0.93498003, 'binary_precision': 0.5799595, 'binary_recall': 0.38953093, 'binary_specificity': 0.990194, 'binary_f1_score': 0.4660431}
confusion matrix:
       0    1
0  41906  415
1    898  573
---- Validation: 
scalar performance:
{'acc': 0.9690826, 'precision': 0.7888583, 'recall': 0.63821816, 'specificity': 0.63821816, 'f1': 0.6846639, 'auroc': 0.94051296, 'binary_precision': 0.60264903, 'binary_recall': 0.2830482, 'binary_specificity': 0.99338806, 'binary_f1_score': 0.38518518}
confusion matrix:
       0    1
0  18029  120
1    461  182
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9654842, 'precision': 0.9826171, 'recall': 0.5862069, 'specificity': 0.5862069, 'f1': 0.63821363, 'auroc': 0.89044636, 'binary_precision': 1.0, 'binary_recall': 0.1724138, 'binary_specificity': 1.0, 'binary_f1_score': 0.29411763}
confusion matrix:
      0   1
0  5997   0
1   216  45
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316515_28.png
early stop counter: 3
val acc:0.9690825939178467, best validation acc: 0.9697743654251099, corresponding to test acc:                         0.9694790840148926 / 0.9736337661743164
after epoch: 28,now: 2024-06-14 01:54:37.837474,epoch time: 0:19:34.396395,used: 9:01:36.299269,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_53_01_seed_0_21316515
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9708166, 'precision': 0.7854519, 'recall': 0.70864904, 'specificity': 0.70864904, 'f1': 0.740515, 'auroc': 0.9374491, 'binary_precision': 0.5906103, 'binary_recall': 0.42760026, 'binary_specificity': 0.9896978, 'binary_f1_score': 0.49605674}
confusion matrix:
       0    1
0  41885  436
1    842  629
---- Validation: 
scalar performance:
{'acc': 0.9691358, 'precision': 0.786579, 'recall': 0.6464963, 'specificity': 0.6464963, 'f1': 0.6918733, 'auroc': 0.94513106, 'binary_precision': 0.5975232, 'binary_recall': 0.30015552, 'binary_specificity': 0.9928371, 'binary_f1_score': 0.3995859}
confusion matrix:
       0    1
0  18019  130
1    450  193
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650048, 'precision': 0.9710953, 'recall': 0.5822921, 'specificity': 0.5822921, 'f1': 0.6320163, 'auroc': 0.88906455, 'binary_precision': 0.97727275, 'binary_recall': 0.16475096, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.28196722}
confusion matrix:
      0   1
0  5996   1
1   218  43
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316515_29.png
early stop counter: 4
val acc:0.9691358208656311, best validation acc: 0.9697743654251099, corresponding to test acc:                         0.9694790840148926 / 0.9736337661743164
after epoch: 29,now: 2024-06-14 02:14:07.084893,epoch time: 0:19:29.247419,used: 9:21:05.546688,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_53_01_seed_0_21316515
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9697205, 'precision': 0.77309036, 'recall': 0.7054572, 'specificity': 0.7054572, 'f1': 0.7340239, 'auroc': 0.9372299, 'binary_precision': 0.56608933, 'binary_recall': 0.4221618, 'binary_specificity': 0.9887526, 'binary_f1_score': 0.48364487}
confusion matrix:
       0    1
0  41845  476
1    850  621
---- Validation: 
scalar performance:
{'acc': 0.96977437, 'precision': 0.78748274, 'recall': 0.67457896, 'specificity': 0.67457896, 'f1': 0.71596646, 'auroc': 0.9424504, 'binary_precision': 0.5974026, 'binary_recall': 0.3576983, 'binary_specificity': 0.9914596, 'binary_f1_score': 0.44747078}
confusion matrix:
       0    1
0  17994  155
1    413  230
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96724194, 'precision': 0.97492766, 'recall': 0.609112, 'specificity': 0.609112, 'f1': 0.6702797, 'auroc': 0.89496875, 'binary_precision': 0.98275864, 'binary_recall': 0.21839081, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.35736677}
confusion matrix:
      0   1
0  5996   1
1   204  57
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316515_30.png
early stop counter: 5
val acc:0.9697743654251099, best validation acc: 0.9697743654251099, corresponding to test acc:                         0.9694790840148926 / 0.9736337661743164
after epoch: 30,now: 2024-06-14 02:33:35.913090,epoch time: 0:19:28.828197,used: 9:40:34.374885,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_53_01_seed_0_21316515
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 9:40:34.374885 at 2024-06-14 02:33:35.913090
persisted model performance metric: 

scalar performance:
{'acc': 0.9694791, 'precision': 0.9776983, 'recall': 0.63593197, 'specificity': 0.63593197, 'f1': 0.7053744, 'auroc': 0.89032274, 'binary_precision': 0.9861111, 'binary_recall': 0.27203065, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.4264264}
confusion matrix:
      0   1
0  5996   1
1   190  71
oracle model performance metric: 

scalar performance:
{'acc': 0.97363377, 'precision': 0.9721362, 'recall': 0.689405, 'specificity': 0.689405, 'f1': 0.7659388, 'auroc': 0.8926734, 'binary_precision': 0.9705882, 'binary_recall': 0.37931034, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.5454545}
confusion matrix:
      0   1
0  5994   3
1   162  99
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_vit_resnet_dinov2_bs16_different_learningrates/rule_results/15.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_vit_resnet_dinov2_bs16_different_learningrates/rule_results/15.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_vit_resnet_dinov2_bs16_different_learningrates/confusion_matrix/15.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204979 KiB | 640729 KiB |    942 TiB |    942 TiB |
|       from large pool | 167936 KiB | 568000 KiB |    942 TiB |    942 TiB |
|       from small pool |  37043 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 204979 KiB | 640729 KiB |    942 TiB |    942 TiB |
|       from large pool | 167936 KiB | 568000 KiB |    942 TiB |    942 TiB |
|       from small pool |  37043 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201088 KiB | 632296 KiB |    940 TiB |    940 TiB |
|       from large pool | 165120 KiB | 560704 KiB |    940 TiB |    940 TiB |
|       from small pool |  35968 KiB |  73944 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 755712 KiB | 755712 KiB | 755712 KiB |      0 B   |
|       from large pool | 679936 KiB | 679936 KiB | 679936 KiB |      0 B   |
|       from small pool |  75776 KiB |  75776 KiB |  75776 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  79692 KiB | 215750 KiB | 380569 GiB | 380569 GiB |
|       from large pool |  67584 KiB | 213792 KiB | 380264 GiB | 380264 GiB |
|       from small pool |  12108 KiB |  13958 KiB |    304 GiB |    304 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3252    |    6223    |   83718 K  |   83715 K  |
|       from large pool |      36    |      76    |   33845 K  |   33845 K  |
|       from small pool |    3216    |    6186    |   49872 K  |   49869 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3252    |    6223    |   83718 K  |   83715 K  |
|       from large pool |      36    |      76    |   33845 K  |   33845 K  |
|       from small pool |    3216    |    6186    |   49872 K  |   49869 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      51    |      51    |      51    |       0    |
|       from large pool |      14    |      14    |      14    |       0    |
|       from small pool |      37    |      37    |      37    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      38    |    2753    |   37622 K  |   37622 K  |
|       from large pool |       7    |      11    |   12103 K  |   12103 K  |
|       from small pool |      31    |    2746    |   25518 K  |   25518 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 640729 KiB |    942 TiB |    942 TiB |
|       from large pool |  16640 KiB | 568000 KiB |    942 TiB |    942 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 640729 KiB |    942 TiB |    942 TiB |
|       from large pool |  16640 KiB | 568000 KiB |    942 TiB |    942 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 632296 KiB |    940 TiB |    940 TiB |
|       from large pool |  16640 KiB | 560704 KiB |    940 TiB |    940 TiB |
|       from small pool |      0 KiB |  73944 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 284672 KiB | 755712 KiB | 755712 KiB | 471040 KiB |
|       from large pool | 235520 KiB | 679936 KiB | 679936 KiB | 444416 KiB |
|       from small pool |  49152 KiB |  75776 KiB |  75776 KiB |  26624 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  55040 KiB | 215750 KiB | 380569 GiB | 380569 GiB |
|       from large pool |  55040 KiB | 213792 KiB | 380264 GiB | 380264 GiB |
|       from small pool |      0 KiB |  19703 KiB |    304 GiB |    304 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6223    |   83718 K  |   83718 K  |
|       from large pool |       2    |      76    |   33845 K  |   33845 K  |
|       from small pool |       0    |    6186    |   49872 K  |   49872 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6223    |   83718 K  |   83718 K  |
|       from large pool |       2    |      76    |   33845 K  |   33845 K  |
|       from small pool |       0    |    6186    |   49872 K  |   49872 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      34    |      51    |      51    |      17    |
|       from large pool |      10    |      14    |      14    |       4    |
|       from small pool |      24    |      37    |      37    |      13    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2753    |   37623 K  |   37623 K  |
|       from large pool |       3    |      13    |   12103 K  |   12103 K  |
|       from small pool |       0    |    2746    |   25519 K  |   25519 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 640729 KiB |    942 TiB |    942 TiB |
|       from large pool |  16640 KiB | 568000 KiB |    942 TiB |    942 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 640729 KiB |    942 TiB |    942 TiB |
|       from large pool |  16640 KiB | 568000 KiB |    942 TiB |    942 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 632296 KiB |    940 TiB |    940 TiB |
|       from large pool |  16640 KiB | 560704 KiB |    940 TiB |    940 TiB |
|       from small pool |      0 KiB |  73944 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 284672 KiB | 755712 KiB | 755712 KiB | 471040 KiB |
|       from large pool | 235520 KiB | 679936 KiB | 679936 KiB | 444416 KiB |
|       from small pool |  49152 KiB |  75776 KiB |  75776 KiB |  26624 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  55040 KiB | 215750 KiB | 380569 GiB | 380569 GiB |
|       from large pool |  55040 KiB | 213792 KiB | 380264 GiB | 380264 GiB |
|       from small pool |      0 KiB |  19703 KiB |    304 GiB |    304 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6223    |   83718 K  |   83718 K  |
|       from large pool |       2    |      76    |   33845 K  |   33845 K  |
|       from small pool |       0    |    6186    |   49872 K  |   49872 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6223    |   83718 K  |   83718 K  |
|       from large pool |       2    |      76    |   33845 K  |   33845 K  |
|       from small pool |       0    |    6186    |   49872 K  |   49872 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      34    |      51    |      51    |      17    |
|       from large pool |      10    |      14    |      14    |       4    |
|       from small pool |      24    |      37    |      37    |      13    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2753    |   37623 K  |   37623 K  |
|       from large pool |       3    |      13    |   12103 K  |   12103 K  |
|       from small pool |       0    |    2746    |   25519 K  |   25519 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0




!!!: not committed yet



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_02_41_21_seed_1_21316515

 Experiment start at: 2024-06-14 02:41:21.242738
before training, model accuracy: 0.14647115767002106
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96714246, 'precision': 0.78359216, 'recall': 0.5010167, 'specificity': 0.5010167, 'f1': 0.4937211, 'auroc': 0.8415003, 'binary_precision': 0.6, 'binary_recall': 0.0020804438, 'binary_specificity': 0.99995285, 'binary_f1_score': 0.00414651}
confusion matrix:
       0  1
0  42412  2
1   1439  3
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.83896023, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.83339995, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316515_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-14 03:01:13.762179,epoch time: 0:19:52.519441,used: 0:19:52.519441,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_02_41_21_seed_1_21316515
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9675985, 'precision': 0.7503753, 'recall': 0.56321853, 'specificity': 0.56321853, 'f1': 0.596349, 'auroc': 0.89581585, 'binary_precision': 0.5295775, 'binary_recall': 0.13037448, 'binary_specificity': 0.99606264, 'binary_f1_score': 0.20923762}
confusion matrix:
       0    1
0  42247  167
1   1254  188
---- Validation: 
scalar performance:
{'acc': 0.96350056, 'precision': 0.7041312, 'recall': 0.5297368, 'specificity': 0.5297368, 'f1': 0.5453718, 'auroc': 0.89720243, 'binary_precision': 0.44210526, 'binary_recall': 0.062407132, 'binary_specificity': 0.9970665, 'binary_f1_score': 0.10937501}
confusion matrix:
       0   1
0  18014  53
1    631  42
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9655172, 'precision': 0.9826299, 'recall': 0.5884615, 'specificity': 0.5884615, 'f1': 0.6414882, 'auroc': 0.8666214, 'binary_precision': 1.0, 'binary_recall': 0.17692308, 'binary_specificity': 1.0, 'binary_f1_score': 0.3006536}
confusion matrix:
      0   1
0  5946   0
1   214  46
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316515_2.png
new oracle model saved
early stop counter: 1
val acc:0.9635005593299866, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9655172228813171
after epoch: 2,now: 2024-06-14 03:20:51.539562,epoch time: 0:19:37.777383,used: 0:39:30.296824,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_02_41_21_seed_1_21316515
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96675485, 'precision': 0.7269496, 'recall': 0.572161, 'specificity': 0.572161, 'f1': 0.6057914, 'auroc': 0.9003674, 'binary_precision': 0.48214287, 'binary_recall': 0.14979196, 'binary_specificity': 0.9945301, 'binary_f1_score': 0.22857143}
confusion matrix:
       0    1
0  42182  232
1   1226  216
---- Validation: 
scalar performance:
{'acc': 0.9642476, 'precision': 0.74089205, 'recall': 0.53656167, 'specificity': 0.53656167, 'f1': 0.5569361, 'auroc': 0.90727925, 'binary_precision': 0.5151515, 'binary_recall': 0.075780086, 'binary_specificity': 0.99734324, 'binary_f1_score': 0.13212435}
confusion matrix:
       0   1
0  18019  48
1    622  51
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650338, 'precision': 0.98239493, 'recall': 0.5826923, 'specificity': 0.5826923, 'f1': 0.6329539, 'auroc': 0.8748208, 'binary_precision': 1.0, 'binary_recall': 0.16538462, 'binary_specificity': 1.0, 'binary_f1_score': 0.28382838}
confusion matrix:
      0   1
0  5946   0
1   217  43
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316515_3.png
better model found
persisted
after epoch: 3,now: 2024-06-14 03:40:31.434336,epoch time: 0:19:39.894774,used: 0:59:10.191598,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_02_41_21_seed_1_21316515
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9673477, 'precision': 0.741013, 'recall': 0.6036181, 'specificity': 0.6036181, 'f1': 0.64237326, 'auroc': 0.91297376, 'binary_precision': 0.5082237, 'binary_recall': 0.21428572, 'binary_specificity': 0.99295044, 'binary_f1_score': 0.30146343}
confusion matrix:
       0    1
0  42115  299
1   1133  309
---- Validation: 
scalar performance:
{'acc': 0.96611524, 'precision': 0.7946546, 'recall': 0.5711478, 'specificity': 0.5711478, 'f1': 0.60926694, 'auroc': 0.9090406, 'binary_precision': 0.62025315, 'binary_recall': 0.14561664, 'binary_specificity': 0.996679, 'binary_f1_score': 0.2358604}
confusion matrix:
       0   1
0  18007  60
1    575  98
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9663229, 'precision': 0.9736637, 'recall': 0.5999159, 'specificity': 0.5999159, 'f1': 0.6574971, 'auroc': 0.87956834, 'binary_precision': 0.9811321, 'binary_recall': 0.2, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.3322684}
confusion matrix:
      0   1
0  5945   1
1   208  52
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316515_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-14 04:00:17.684385,epoch time: 0:19:46.250049,used: 1:18:56.441647,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_02_41_21_seed_1_21316515
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9673933, 'precision': 0.7417258, 'recall': 0.61503005, 'specificity': 0.61503005, 'f1': 0.6537451, 'auroc': 0.9141519, 'binary_precision': 0.5089021, 'binary_recall': 0.23786408, 'binary_specificity': 0.99219596, 'binary_f1_score': 0.3241966}
confusion matrix:
       0    1
0  42083  331
1   1099  343
---- Validation: 
scalar performance:
{'acc': 0.96526146, 'precision': 0.760722, 'recall': 0.58501035, 'specificity': 0.58501035, 'f1': 0.6241375, 'auroc': 0.92073286, 'binary_precision': 0.55140185, 'binary_recall': 0.17533432, 'binary_specificity': 0.9946864, 'binary_f1_score': 0.26606536}
confusion matrix:
       0    1
0  17971   96
1    555  118
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97019017, 'precision': 0.9724078, 'recall': 0.64790875, 'specificity': 0.64790875, 'f1': 0.71947694, 'auroc': 0.8825722, 'binary_precision': 0.9746835, 'binary_recall': 0.29615384, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.45427728}
confusion matrix:
      0   1
0  5944   2
1   183  77
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316515_5.png
new oracle model saved
early stop counter: 1
val acc:0.9652614593505859, best validation acc: 0.9661152362823486, corresponding to test acc:                         0.9663228988647461 / 0.970190167427063
after epoch: 5,now: 2024-06-14 04:19:54.581592,epoch time: 0:19:36.897207,used: 1:38:33.338854,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_02_41_21_seed_1_21316515
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96670926, 'precision': 0.73214483, 'recall': 0.63041914, 'specificity': 0.63041914, 'f1': 0.6655663, 'auroc': 0.91697615, 'binary_precision': 0.48872182, 'binary_recall': 0.27045768, 'binary_specificity': 0.9903805, 'binary_f1_score': 0.3482143}
confusion matrix:
       0    1
0  42006  408
1   1052  390
---- Validation: 
scalar performance:
{'acc': 0.966222, 'precision': 0.7819929, 'recall': 0.59194595, 'specificity': 0.59194595, 'f1': 0.63453007, 'auroc': 0.9141705, 'binary_precision': 0.59345794, 'binary_recall': 0.18870728, 'binary_specificity': 0.9951846, 'binary_f1_score': 0.2863585}
confusion matrix:
       0    1
0  17980   87
1    546  127
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9690622, 'precision': 0.96431875, 'recall': 0.6362862, 'specificity': 0.6362862, 'f1': 0.70462656, 'auroc': 0.88130015, 'binary_precision': 0.9594595, 'binary_recall': 0.27307692, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.4251497}
confusion matrix:
      0   1
0  5943   3
1   189  71
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316515_6.png
better model found
persisted
after epoch: 6,now: 2024-06-14 04:39:30.614186,epoch time: 0:19:36.032594,used: 1:58:09.371448,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_02_41_21_seed_1_21316515
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96796334, 'precision': 0.750633, 'recall': 0.6257082, 'specificity': 0.6257082, 'f1': 0.6655004, 'auroc': 0.9245883, 'binary_precision': 0.5260197, 'binary_recall': 0.25936198, 'binary_specificity': 0.9920545, 'binary_f1_score': 0.34742218}
confusion matrix:
       0    1
0  42077  337
1   1068  374
---- Validation: 
scalar performance:
{'acc': 0.9654749, 'precision': 0.776008, 'recall': 0.56580883, 'specificity': 0.56580883, 'f1': 0.6009443, 'auroc': 0.9212448, 'binary_precision': 0.5833333, 'binary_recall': 0.13521545, 'binary_specificity': 0.99640226, 'binary_f1_score': 0.21954161}
confusion matrix:
       0   1
0  18002  65
1    582  91
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9656784, 'precision': 0.9827082, 'recall': 0.5903846, 'specificity': 0.5903846, 'f1': 0.64429647, 'auroc': 0.8845237, 'binary_precision': 1.0, 'binary_recall': 0.18076923, 'binary_specificity': 1.0, 'binary_f1_score': 0.30618894}
confusion matrix:
      0   1
0  5946   0
1   213  47
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316515_7.png
early stop counter: 1
val acc:0.9654749035835266, best validation acc: 0.9662219882011414, corresponding to test acc:                         0.9690622091293335 / 0.970190167427063
after epoch: 7,now: 2024-06-14 04:59:03.034240,epoch time: 0:19:32.420054,used: 2:17:41.791502,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_02_41_21_seed_1_21316515
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.96821415, 'precision': 0.75201106, 'recall': 0.660338, 'specificity': 0.660338, 'f1': 0.6949866, 'auroc': 0.92466986, 'binary_precision': 0.5264901, 'binary_recall': 0.33079058, 'binary_specificity': 0.9898854, 'binary_f1_score': 0.40630326}
confusion matrix:
       0    1
0  41985  429
1    965  477
---- Validation: 
scalar performance:
{'acc': 0.96691567, 'precision': 0.7886994, 'recall': 0.6101874, 'specificity': 0.6101874, 'f1': 0.656022, 'auroc': 0.92392874, 'binary_precision': 0.6055777, 'binary_recall': 0.22585438, 'binary_specificity': 0.9945204, 'binary_f1_score': 0.32900432}
confusion matrix:
       0    1
0  17968   99
1    521  152
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97067356, 'precision': 0.9851501, 'recall': 0.65, 'specificity': 0.65, 'f1': 0.7232324, 'auroc': 0.8897887, 'binary_precision': 1.0, 'binary_recall': 0.3, 'binary_specificity': 1.0, 'binary_f1_score': 0.4615385}
confusion matrix:
      0   1
0  5946   0
1   182  78
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316515_8.png
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-06-14 05:18:42.197634,epoch time: 0:19:39.163394,used: 2:37:20.954896,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_02_41_21_seed_1_21316515
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9687614, 'precision': 0.75911057, 'recall': 0.6612908, 'specificity': 0.6612908, 'f1': 0.6977334, 'auroc': 0.9247357, 'binary_precision': 0.54063207, 'binary_recall': 0.33217752, 'binary_specificity': 0.9904041, 'binary_f1_score': 0.41151202}
confusion matrix:
       0    1
0  42007  407
1    963  479
---- Validation: 
scalar performance:
{'acc': 0.96659553, 'precision': 0.7819589, 'recall': 0.60930604, 'specificity': 0.60930604, 'f1': 0.65415233, 'auroc': 0.9250076, 'binary_precision': 0.5921569, 'binary_recall': 0.2243685, 'binary_specificity': 0.9942436, 'binary_f1_score': 0.32543102}
confusion matrix:
       0    1
0  17963  104
1    522  151
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97260714, 'precision': 0.986102, 'recall': 0.6730769, 'specificity': 0.6730769, 'f1': 0.75009596, 'auroc': 0.88692784, 'binary_precision': 1.0, 'binary_recall': 0.34615386, 'binary_specificity': 1.0, 'binary_f1_score': 0.51428574}
confusion matrix:
      0   1
0  5946   0
1   170  90
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316515_9.png
new oracle model saved
early stop counter: 1
val acc:0.9665955305099487, best validation acc: 0.9669156670570374, corresponding to test acc:                         0.9706735610961914 / 0.9726071357727051
after epoch: 9,now: 2024-06-14 05:38:23.354106,epoch time: 0:19:41.156472,used: 2:57:02.111368,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_02_41_21_seed_1_21316515
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.96800894, 'precision': 0.75217783, 'recall': 0.61702305, 'specificity': 0.61702305, 'f1': 0.65759933, 'auroc': 0.9273077, 'binary_precision': 0.5296804, 'binary_recall': 0.24133149, 'binary_specificity': 0.99271464, 'binary_f1_score': 0.33158648}
confusion matrix:
       0    1
0  42105  309
1   1094  348
---- Validation: 
scalar performance:
{'acc': 0.9653682, 'precision': 0.77756596, 'recall': 0.55860084, 'specificity': 0.55860084, 'f1': 0.59102726, 'auroc': 0.92352813, 'binary_precision': 0.5869565, 'binary_recall': 0.12035661, 'binary_specificity': 0.99684507, 'binary_f1_score': 0.19975339}
confusion matrix:
       0   1
0  18010  57
1    592  81
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96422815, 'precision': 0.9820039, 'recall': 0.5730769, 'specificity': 0.5730769, 'f1': 0.61835384, 'auroc': 0.8869873, 'binary_precision': 1.0, 'binary_recall': 0.14615385, 'binary_specificity': 1.0, 'binary_f1_score': 0.25503358}
confusion matrix:
      0   1
0  5946   0
1   222  38
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316515_10.png
early stop counter: 2
val acc:0.9653682112693787, best validation acc: 0.9669156670570374, corresponding to test acc:                         0.9706735610961914 / 0.9726071357727051
after epoch: 10,now: 2024-06-14 05:58:12.033992,epoch time: 0:19:48.679886,used: 3:16:50.791254,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_02_41_21_seed_1_21316515
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96796334, 'precision': 0.7492094, 'recall': 0.6504947, 'specificity': 0.6504947, 'f1': 0.686473, 'auroc': 0.92967796, 'binary_precision': 0.52153665, 'binary_recall': 0.3106796, 'binary_specificity': 0.9903098, 'binary_f1_score': 0.3893959}
confusion matrix:
       0    1
0  42003  411
1    994  448
---- Validation: 
scalar performance:
{'acc': 0.96691567, 'precision': 0.7954831, 'recall': 0.5994584, 'specificity': 0.5994584, 'f1': 0.6447707, 'auroc': 0.9249959, 'binary_precision': 0.6199095, 'binary_recall': 0.20356612, 'binary_specificity': 0.99535066, 'binary_f1_score': 0.30648768}
confusion matrix:
       0    1
0  17983   84
1    536  137
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.970029, 'precision': 0.9783313, 'recall': 0.6441467, 'specificity': 0.6441467, 'f1': 0.71551305, 'auroc': 0.8924193, 'binary_precision': 0.9868421, 'binary_recall': 0.28846154, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.4464286}
confusion matrix:
      0   1
0  5945   1
1   185  75
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316515_11.png
early stop counter: 3
val acc:0.9669156670570374, best validation acc: 0.9669156670570374, corresponding to test acc:                         0.9706735610961914 / 0.9726071357727051
after epoch: 11,now: 2024-06-14 06:17:53.800952,epoch time: 0:19:41.766960,used: 3:36:32.558214,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_02_41_21_seed_1_21316515
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9679405, 'precision': 0.7484505, 'recall': 0.6642159, 'specificity': 0.6642159, 'f1': 0.6968787, 'auroc': 0.9308795, 'binary_precision': 0.5191083, 'binary_recall': 0.33911234, 'binary_specificity': 0.98931956, 'binary_f1_score': 0.4102349}
confusion matrix:
       0    1
0  41961  453
1    953  489
---- Validation: 
scalar performance:
{'acc': 0.9677161, 'precision': 0.79485726, 'recall': 0.63063, 'specificity': 0.63063, 'f1': 0.67824423, 'auroc': 0.92816186, 'binary_precision': 0.6164383, 'binary_recall': 0.26745912, 'binary_specificity': 0.9938009, 'binary_f1_score': 0.37305698}
confusion matrix:
       0    1
0  17955  112
1    493  180
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9698679, 'precision': 0.97816455, 'recall': 0.6422236, 'specificity': 0.6422236, 'f1': 0.7131536, 'auroc': 0.89080524, 'binary_precision': 0.9866667, 'binary_recall': 0.2846154, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.44179106}
confusion matrix:
      0   1
0  5945   1
1   186  74
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316515_12.png
better model found
persisted
after epoch: 12,now: 2024-06-14 06:37:34.180626,epoch time: 0:19:40.379674,used: 3:56:12.937888,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_02_41_21_seed_1_21316515
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.96851057, 'precision': 0.7550831, 'recall': 0.6708747, 'specificity': 0.6708747, 'f1': 0.703838, 'auroc': 0.92508674, 'binary_precision': 0.5319372, 'binary_recall': 0.35228848, 'binary_specificity': 0.989461, 'binary_f1_score': 0.42386317}
confusion matrix:
       0    1
0  41967  447
1    934  508
---- Validation: 
scalar performance:
{'acc': 0.96840984, 'precision': 0.7968291, 'recall': 0.6531631, 'specificity': 0.6531631, 'f1': 0.69996965, 'auroc': 0.9267801, 'binary_precision': 0.61876833, 'binary_recall': 0.31352153, 'binary_specificity': 0.9928046, 'binary_f1_score': 0.41617358}
confusion matrix:
       0    1
0  17937  130
1    462  211
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9709958, 'precision': 0.9680973, 'recall': 0.6593631, 'specificity': 0.6593631, 'f1': 0.73242545, 'auroc': 0.89644253, 'binary_precision': 0.96511626, 'binary_recall': 0.31923077, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.47976875}
confusion matrix:
      0   1
0  5943   3
1   177  83
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316515_13.png
better model found
persisted
after epoch: 13,now: 2024-06-14 06:57:03.512634,epoch time: 0:19:29.332008,used: 4:15:42.269896,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_02_41_21_seed_1_21316515
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.969035, 'precision': 0.7635126, 'recall': 0.656408, 'specificity': 0.656408, 'f1': 0.6950262, 'auroc': 0.92978466, 'binary_precision': 0.549763, 'binary_recall': 0.32177532, 'binary_specificity': 0.9910407, 'binary_f1_score': 0.40594926}
confusion matrix:
       0    1
0  42034  380
1    978  464
---- Validation: 
scalar performance:
{'acc': 0.9678762, 'precision': 0.8127386, 'recall': 0.6099703, 'specificity': 0.6099703, 'f1': 0.65880597, 'auroc': 0.92796075, 'binary_precision': 0.65367967, 'binary_recall': 0.2243685, 'binary_specificity': 0.99557203, 'binary_f1_score': 0.3340708}
confusion matrix:
       0    1
0  17987   80
1    522  151
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9648727, 'precision': 0.9823167, 'recall': 0.58076924, 'specificity': 0.58076924, 'f1': 0.630072, 'auroc': 0.8895222, 'binary_precision': 1.0, 'binary_recall': 0.16153847, 'binary_specificity': 1.0, 'binary_f1_score': 0.2781457}
confusion matrix:
      0   1
0  5946   0
1   218  42
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316515_14.png
early stop counter: 1
val acc:0.9678761959075928, best validation acc: 0.9684098362922668, corresponding to test acc:                         0.9709957838058472 / 0.9726071357727051
after epoch: 14,now: 2024-06-14 07:16:44.011596,epoch time: 0:19:40.498962,used: 4:35:22.768858,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_02_41_21_seed_1_21316515
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9687614, 'precision': 0.76188374, 'recall': 0.6395189, 'specificity': 0.6395189, 'f1': 0.6803427, 'auroc': 0.936077, 'binary_precision': 0.54761904, 'binary_recall': 0.28710124, 'binary_specificity': 0.9919366, 'binary_f1_score': 0.3767061}
confusion matrix:
       0    1
0  42072  342
1   1028  414
---- Validation: 
scalar performance:
{'acc': 0.9666489, 'precision': 0.78347474, 'recall': 0.6086185, 'specificity': 0.6086185, 'f1': 0.6536134, 'auroc': 0.9325006, 'binary_precision': 0.5952381, 'binary_recall': 0.22288261, 'binary_specificity': 0.99435437, 'binary_f1_score': 0.32432434}
confusion matrix:
       0    1
0  17965  102
1    523  150
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9690622, 'precision': 0.98435974, 'recall': 0.63076925, 'specificity': 0.63076925, 'f1': 0.69937265, 'auroc': 0.8976149, 'binary_precision': 1.0, 'binary_recall': 0.26153848, 'binary_specificity': 1.0, 'binary_f1_score': 0.41463417}
confusion matrix:
      0   1
0  5946   0
1   192  68
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316515_15.png
early stop counter: 2
val acc:0.9666488766670227, best validation acc: 0.9684098362922668, corresponding to test acc:                         0.9709957838058472 / 0.9726071357727051
after epoch: 15,now: 2024-06-14 07:36:17.441188,epoch time: 0:19:33.429592,used: 4:54:56.198450,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_02_41_21_seed_1_21316515
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9696507, 'precision': 0.77304375, 'recall': 0.6547166, 'specificity': 0.6547166, 'f1': 0.6960405, 'auroc': 0.9369177, 'binary_precision': 0.5689441, 'binary_recall': 0.31761444, 'binary_specificity': 0.9918187, 'binary_f1_score': 0.40765467}
confusion matrix:
       0    1
0  42067  347
1    984  458
---- Validation: 
scalar performance:
{'acc': 0.96792954, 'precision': 0.81351125, 'recall': 0.6107132, 'specificity': 0.6107132, 'f1': 0.6597398, 'auroc': 0.93101406, 'binary_precision': 0.6551724, 'binary_recall': 0.22585438, 'binary_specificity': 0.99557203, 'binary_f1_score': 0.33591157}
confusion matrix:
       0    1
0  17987   80
1    521  152
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9648727, 'precision': 0.9823167, 'recall': 0.58076924, 'specificity': 0.58076924, 'f1': 0.630072, 'auroc': 0.8905848, 'binary_precision': 1.0, 'binary_recall': 0.16153847, 'binary_specificity': 1.0, 'binary_f1_score': 0.2781457}
confusion matrix:
      0   1
0  5946   0
1   218  42
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316515_16.png
early stop counter: 3
val acc:0.9679295420646667, best validation acc: 0.9684098362922668, corresponding to test acc:                         0.9709957838058472 / 0.9726071357727051
after epoch: 16,now: 2024-06-14 07:56:01.526531,epoch time: 0:19:44.085343,used: 5:14:40.283793,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_02_41_21_seed_1_21316515
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9700611, 'precision': 0.7750032, 'recall': 0.674021, 'specificity': 0.674021, 'f1': 0.7121135, 'auroc': 0.93903196, 'binary_precision': 0.57158715, 'binary_recall': 0.35714287, 'binary_specificity': 0.9908992, 'binary_f1_score': 0.43960735}
confusion matrix:
       0    1
0  42028  386
1    927  515
---- Validation: 
scalar performance:
{'acc': 0.96782285, 'precision': 0.80612767, 'recall': 0.61638, 'specificity': 0.61638, 'f1': 0.6651004, 'auroc': 0.93140244, 'binary_precision': 0.64, 'binary_recall': 0.23774146, 'binary_specificity': 0.99501854, 'binary_f1_score': 0.34669557}
confusion matrix:
       0    1
0  17977   90
1    513  160
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9643893, 'precision': 0.982082, 'recall': 0.575, 'specificity': 0.575, 'f1': 0.6213124, 'auroc': 0.889632, 'binary_precision': 1.0, 'binary_recall': 0.15, 'binary_specificity': 1.0, 'binary_f1_score': 0.2608696}
confusion matrix:
      0   1
0  5946   0
1   221  39
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316515_17.png
early stop counter: 4
val acc:0.9678228497505188, best validation acc: 0.9684098362922668, corresponding to test acc:                         0.9709957838058472 / 0.9726071357727051
after epoch: 17,now: 2024-06-14 08:15:37.132909,epoch time: 0:19:35.606378,used: 5:34:15.890171,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_02_41_21_seed_1_21316515
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.96860176, 'precision': 0.7556926, 'recall': 0.67829084, 'specificity': 0.67829084, 'f1': 0.7094066, 'auroc': 0.9363651, 'binary_precision': 0.53266335, 'binary_recall': 0.36754507, 'binary_specificity': 0.9890366, 'binary_f1_score': 0.43496102}
confusion matrix:
       0    1
0  41949  465
1    912  530
---- Validation: 
scalar performance:
{'acc': 0.9687834, 'precision': 0.80561805, 'recall': 0.6490652, 'specificity': 0.6490652, 'f1': 0.6980132, 'auroc': 0.9315143, 'binary_precision': 0.636646, 'binary_recall': 0.30460623, 'binary_specificity': 0.99352413, 'binary_f1_score': 0.4120603}
confusion matrix:
       0    1
0  17950  117
1    468  205
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96777314, 'precision': 0.98372924, 'recall': 0.61538464, 'specificity': 0.61538464, 'f1': 0.6792301, 'auroc': 0.8899993, 'binary_precision': 1.0, 'binary_recall': 0.23076923, 'binary_specificity': 1.0, 'binary_f1_score': 0.375}
confusion matrix:
      0   1
0  5946   0
1   200  60
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316515_18.png
better model found
persisted
after epoch: 18,now: 2024-06-14 08:34:55.012210,epoch time: 0:19:17.879301,used: 5:53:33.769472,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_02_41_21_seed_1_21316515
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9695595, 'precision': 0.7626629, 'recall': 0.7253443, 'specificity': 0.7253443, 'f1': 0.7424312, 'auroc': 0.9395462, 'binary_precision': 0.5434606, 'binary_recall': 0.46393898, 'binary_specificity': 0.98674965, 'binary_f1_score': 0.5005612}
confusion matrix:
       0    1
0  41852  562
1    773  669
---- Validation: 
scalar performance:
{'acc': 0.9683031, 'precision': 0.79078054, 'recall': 0.6638367, 'specificity': 0.6638367, 'f1': 0.70790946, 'auroc': 0.93336856, 'binary_precision': 0.60589814, 'binary_recall': 0.3358098, 'binary_specificity': 0.9918636, 'binary_f1_score': 0.43212235}
confusion matrix:
       0    1
0  17920  147
1    447  226
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97131807, 'precision': 0.985467, 'recall': 0.6576923, 'specificity': 0.6576923, 'f1': 0.73239243, 'auroc': 0.8939812, 'binary_precision': 1.0, 'binary_recall': 0.31538463, 'binary_specificity': 1.0, 'binary_f1_score': 0.47953218}
confusion matrix:
      0   1
0  5946   0
1   178  82
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316515_19.png
early stop counter: 1
val acc:0.9683030843734741, best validation acc: 0.9687833786010742, corresponding to test acc:                         0.9677731394767761 / 0.9726071357727051
after epoch: 19,now: 2024-06-14 08:54:05.203679,epoch time: 0:19:10.191469,used: 6:12:43.960941,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_02_41_21_seed_1_21316515
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.96778095, 'precision': 0.74616146, 'recall': 0.675636, 'specificity': 0.675636, 'f1': 0.704401, 'auroc': 0.93753695, 'binary_precision': 0.51375246, 'binary_recall': 0.3629424, 'binary_specificity': 0.9883296, 'binary_f1_score': 0.42537618}
confusion matrix:
       0    1
0  41920  495
1    918  523
---- Validation: 
scalar performance:
{'acc': 0.96808964, 'precision': 0.7887893, 'recall': 0.6601497, 'specificity': 0.6601497, 'f1': 0.70429474, 'auroc': 0.9347062, 'binary_precision': 0.6021798, 'binary_recall': 0.32838038, 'binary_specificity': 0.991919, 'binary_f1_score': 0.42499998}
confusion matrix:
       0    1
0  17921  146
1    452  221
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9693845, 'precision': 0.9650103, 'recall': 0.6401323, 'specificity': 0.6401323, 'f1': 0.70939505, 'auroc': 0.89566237, 'binary_precision': 0.9605263, 'binary_recall': 0.28076923, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.4345238}
confusion matrix:
      0   1
0  5943   3
1   187  73
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316515_20.png
early stop counter: 2
val acc:0.9680896401405334, best validation acc: 0.9687833786010742, corresponding to test acc:                         0.9677731394767761 / 0.9726071357727051
after epoch: 20,now: 2024-06-14 09:13:15.343927,epoch time: 0:19:10.140248,used: 6:31:54.101189,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_02_41_21_seed_1_21316515
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9693543, 'precision': 0.7667533, 'recall': 0.66494685, 'specificity': 0.66494685, 'f1': 0.7027245, 'auroc': 0.9342079, 'binary_precision': 0.5556818, 'binary_recall': 0.33911234, 'binary_specificity': 0.99078137, 'binary_f1_score': 0.42118862}
confusion matrix:
       0    1
0  42023  391
1    953  489
---- Validation: 
scalar performance:
{'acc': 0.9686766, 'precision': 0.82104075, 'recall': 0.62397546, 'specificity': 0.62397546, 'f1': 0.6753578, 'auroc': 0.9312177, 'binary_precision': 0.6692913, 'binary_recall': 0.25260028, 'binary_specificity': 0.99535066, 'binary_f1_score': 0.36677456}
confusion matrix:
       0    1
0  17983   84
1    503  170
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9656784, 'precision': 0.9827082, 'recall': 0.5903846, 'specificity': 0.5903846, 'f1': 0.64429647, 'auroc': 0.88985986, 'binary_precision': 1.0, 'binary_recall': 0.18076923, 'binary_specificity': 1.0, 'binary_f1_score': 0.30618894}
confusion matrix:
      0   1
0  5946   0
1   213  47
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316515_21.png
early stop counter: 3
val acc:0.9686766266822815, best validation acc: 0.9687833786010742, corresponding to test acc:                         0.9677731394767761 / 0.9726071357727051
after epoch: 21,now: 2024-06-14 09:32:27.856797,epoch time: 0:19:12.512870,used: 6:51:06.614059,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_02_41_21_seed_1_21316515
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9695139, 'precision': 0.7624597, 'recall': 0.7219712, 'specificity': 0.7219712, 'f1': 0.74035156, 'auroc': 0.9417398, 'binary_precision': 0.54328114, 'binary_recall': 0.45700416, 'binary_specificity': 0.9869383, 'binary_f1_score': 0.49642187}
confusion matrix:
       0    1
0  41860  554
1    783  659
---- Validation: 
scalar performance:
{'acc': 0.96915686, 'precision': 0.80048895, 'recall': 0.6728627, 'specificity': 0.6728627, 'f1': 0.71787256, 'auroc': 0.9324324, 'binary_precision': 0.62467194, 'binary_recall': 0.3536404, 'binary_specificity': 0.99208504, 'binary_f1_score': 0.4516129}
confusion matrix:
       0    1
0  17924  143
1    435  238
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9687399, 'precision': 0.98420197, 'recall': 0.6269231, 'specificity': 0.6269231, 'f1': 0.6944282, 'auroc': 0.8913115, 'binary_precision': 1.0, 'binary_recall': 0.25384617, 'binary_specificity': 1.0, 'binary_f1_score': 0.404908}
confusion matrix:
      0   1
0  5946   0
1   194  66
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316515_22.png
better model found
persisted
after epoch: 22,now: 2024-06-14 09:51:41.991744,epoch time: 0:19:14.134947,used: 7:10:20.749006,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_02_41_21_seed_1_21316515
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9699699, 'precision': 0.77380437, 'recall': 0.67363894, 'specificity': 0.67363894, 'f1': 0.71147597, 'auroc': 0.9340474, 'binary_precision': 0.56921375, 'binary_recall': 0.35644937, 'binary_specificity': 0.9908285, 'binary_f1_score': 0.43837953}
confusion matrix:
       0    1
0  42025  389
1    928  514
---- Validation: 
scalar performance:
{'acc': 0.96840984, 'precision': 0.8077771, 'recall': 0.63313556, 'specificity': 0.63313556, 'f1': 0.6829183, 'auroc': 0.9358548, 'binary_precision': 0.6421053, 'binary_recall': 0.27191678, 'binary_specificity': 0.99435437, 'binary_f1_score': 0.38204592}
confusion matrix:
       0    1
0  17965  102
1    490  183
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9663229, 'precision': 0.983022, 'recall': 0.59807694, 'specificity': 0.59807694, 'f1': 0.65535146, 'auroc': 0.89684594, 'binary_precision': 1.0, 'binary_recall': 0.19615385, 'binary_specificity': 1.0, 'binary_f1_score': 0.32797426}
confusion matrix:
      0   1
0  5946   0
1   209  51
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316515_23.png
early stop counter: 1
val acc:0.9684098362922668, best validation acc: 0.9691568613052368, corresponding to test acc:                         0.968739926815033 / 0.9726071357727051
after epoch: 23,now: 2024-06-14 10:11:10.232222,epoch time: 0:19:28.240478,used: 7:29:48.989484,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_02_41_21_seed_1_21316515
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.97049433, 'precision': 0.77506053, 'recall': 0.7043907, 'specificity': 0.7043907, 'f1': 0.7340203, 'auroc': 0.94010603, 'binary_precision': 0.56967986, 'binary_recall': 0.41955617, 'binary_specificity': 0.98922527, 'binary_f1_score': 0.48322687}
confusion matrix:
       0    1
0  41957  457
1    837  605
---- Validation: 
scalar performance:
{'acc': 0.9686233, 'precision': 0.8108461, 'recall': 0.63539207, 'specificity': 0.63539207, 'f1': 0.6856996, 'auroc': 0.9358088, 'binary_precision': 0.6480836, 'binary_recall': 0.27637443, 'binary_specificity': 0.9944097, 'binary_f1_score': 0.38750002}
confusion matrix:
       0    1
0  17966  101
1    487  186
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96696746, 'precision': 0.98333603, 'recall': 0.6057692, 'specificity': 0.6057692, 'f1': 0.66613, 'auroc': 0.89398026, 'binary_precision': 1.0, 'binary_recall': 0.21153846, 'binary_specificity': 1.0, 'binary_f1_score': 0.34920636}
confusion matrix:
      0   1
0  5946   0
1   205  55
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316515_24.png
early stop counter: 2
val acc:0.9686232805252075, best validation acc: 0.9691568613052368, corresponding to test acc:                         0.968739926815033 / 0.9726071357727051
after epoch: 24,now: 2024-06-14 10:30:40.805308,epoch time: 0:19:30.573086,used: 7:49:19.562570,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_02_41_21_seed_1_21316515
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9697875, 'precision': 0.7723586, 'recall': 0.66785043, 'specificity': 0.66785043, 'f1': 0.7065582, 'auroc': 0.9402504, 'binary_precision': 0.5667047, 'binary_recall': 0.3446602, 'binary_specificity': 0.9910407, 'binary_f1_score': 0.428633}
confusion matrix:
       0    1
0  42034  380
1    945  497
---- Validation: 
scalar performance:
{'acc': 0.96915686, 'precision': 0.81008446, 'recall': 0.6535505, 'specificity': 0.6535505, 'f1': 0.70307785, 'auroc': 0.93716, 'binary_precision': 0.6452599, 'binary_recall': 0.31352153, 'binary_specificity': 0.99357945, 'binary_f1_score': 0.42199996}
confusion matrix:
       0    1
0  17951  116
1    462  211
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9708347, 'precision': 0.97913325, 'recall': 0.65376204, 'specificity': 0.65376204, 'f1': 0.7271068, 'auroc': 0.89959633, 'binary_precision': 0.9876543, 'binary_recall': 0.30769232, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.46920824}
confusion matrix:
      0   1
0  5945   1
1   180  80
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316515_25.png
early stop counter: 3
val acc:0.9691568613052368, best validation acc: 0.9691568613052368, corresponding to test acc:                         0.968739926815033 / 0.9726071357727051
after epoch: 25,now: 2024-06-14 10:50:20.680598,epoch time: 0:19:39.875290,used: 8:08:59.437860,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_02_41_21_seed_1_21316515
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9705399, 'precision': 0.77418697, 'recall': 0.713458, 'specificity': 0.713458, 'f1': 0.7396753, 'auroc': 0.93984777, 'binary_precision': 0.56732494, 'binary_recall': 0.43828017, 'binary_specificity': 0.98863584, 'binary_f1_score': 0.4945227}
confusion matrix:
       0    1
0  41932  482
1    810  632
---- Validation: 
scalar performance:
{'acc': 0.96905017, 'precision': 0.81020826, 'recall': 0.6499188, 'specificity': 0.6499188, 'f1': 0.69971347, 'auroc': 0.9373033, 'binary_precision': 0.64576805, 'binary_recall': 0.3060921, 'binary_specificity': 0.9937455, 'binary_f1_score': 0.41532254}
confusion matrix:
