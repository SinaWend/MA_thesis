Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0




!!!: not committed yet



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316521

 Experiment start at: 2024-06-13 16:52:51.590840
before training, model accuracy: 0.9563758969306946
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96752834, 'precision': 0.751819, 'recall': 0.65937465, 'specificity': 0.65937465, 'f1': 0.6941648, 'auroc': 0.9371511, 'binary_precision': 0.5266594, 'binary_recall': 0.32902786, 'binary_specificity': 0.9897214, 'binary_f1_score': 0.40502092}
confusion matrix:
       0    1
0  41886  435
1    987  484
---- Validation: 
scalar performance:
{'acc': 0.96546406, 'precision': 0.7329946, 'recall': 0.62959427, 'specificity': 0.62959427, 'f1': 0.66500056, 'auroc': 0.92891365, 'binary_precision': 0.49147728, 'binary_recall': 0.2690513, 'binary_specificity': 0.9901372, 'binary_f1_score': 0.34773868}
confusion matrix:
       0    1
0  17970  179
1    470  173
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96580374, 'precision': 0.93928826, 'recall': 0.5992, 'specificity': 0.5992, 'f1': 0.6547501, 'auroc': 0.91477877, 'binary_precision': 0.9122807, 'binary_recall': 0.19923371, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.32704404}
confusion matrix:
      0   1
0  5992   5
1   209  52
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316521_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-13 17:20:08.822543,epoch time: 0:27:17.231703,used: 0:27:17.231703,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316521
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9683504, 'precision': 0.7715714, 'recall': 0.61583585, 'specificity': 0.61583585, 'f1': 0.6596798, 'auroc': 0.9406729, 'binary_precision': 0.5691057, 'binary_recall': 0.23793338, 'binary_specificity': 0.99373835, 'binary_f1_score': 0.33557045}
confusion matrix:
       0    1
0  42056  265
1   1121  350
---- Validation: 
scalar performance:
{'acc': 0.96588975, 'precision': 0.7379242, 'recall': 0.5743106, 'specificity': 0.5743106, 'f1': 0.60927534, 'auroc': 0.9365401, 'binary_precision': 0.50510204, 'binary_recall': 0.15396579, 'binary_specificity': 0.9946554, 'binary_f1_score': 0.23599523}
confusion matrix:
       0   1
0  18052  97
1    544  99
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96196866, 'precision': 0.9294125, 'recall': 0.5495583, 'specificity': 0.5495583, 'f1': 0.57992184, 'auroc': 0.9180901, 'binary_precision': 0.8965517, 'binary_recall': 0.099616855, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.17931034}
confusion matrix:
      0   1
0  5994   3
1   235  26
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316521_2.png
better model found
persisted
after epoch: 2,now: 2024-06-13 17:46:20.897732,epoch time: 0:26:12.075189,used: 0:53:29.306892,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316521
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9695835, 'precision': 0.78446525, 'recall': 0.6473143, 'specificity': 0.6473143, 'f1': 0.69219816, 'auroc': 0.94119567, 'binary_precision': 0.59279037, 'binary_recall': 0.30183548, 'binary_specificity': 0.9927932, 'binary_f1_score': 0.39999998}
confusion matrix:
       0    1
0  42016  305
1   1027  444
---- Validation: 
scalar performance:
{'acc': 0.9671137, 'precision': 0.7604555, 'recall': 0.60794663, 'specificity': 0.60794663, 'f1': 0.6497616, 'auroc': 0.94142723, 'binary_precision': 0.54789275, 'binary_recall': 0.22239502, 'binary_specificity': 0.99349827, 'binary_f1_score': 0.31637168}
confusion matrix:
       0    1
0  18031  118
1    500  143
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590924, 'precision': 0.84338665, 'recall': 0.51507556, 'specificity': 0.51507556, 'f1': 0.5189576, 'auroc': 0.92100954, 'binary_precision': 0.72727275, 'binary_recall': 0.03065134, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.058823526}
confusion matrix:
      0  1
0  5994  3
1   253  8
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316521_3.png
better model found
persisted
after epoch: 3,now: 2024-06-13 18:12:34.515421,epoch time: 0:26:13.617689,used: 1:19:42.924581,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316521
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9693551, 'precision': 0.78121126, 'recall': 0.6440039, 'specificity': 0.6440039, 'f1': 0.68852055, 'auroc': 0.9440269, 'binary_precision': 0.58648646, 'binary_recall': 0.2952381, 'binary_specificity': 0.9927697, 'binary_f1_score': 0.39276016}
confusion matrix:
       0    1
0  42016  306
1   1036  434
---- Validation: 
scalar performance:
{'acc': 0.9678587, 'precision': 0.7785232, 'recall': 0.6023319, 'specificity': 0.6023319, 'f1': 0.6462356, 'auroc': 0.94470954, 'binary_precision': 0.58441556, 'binary_recall': 0.20995334, 'binary_specificity': 0.99471045, 'binary_f1_score': 0.3089245}
confusion matrix:
       0    1
0  18053   96
1    508  135
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589326, 'precision': 0.8546, 'recall': 0.5113275, 'specificity': 0.5113275, 'f1': 0.51181245, 'auroc': 0.92179346, 'binary_precision': 0.75, 'binary_recall': 0.022988506, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.044609666}
confusion matrix:
      0  1
0  5995  2
1   255  6
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316521_4.png
better model found
persisted
after epoch: 4,now: 2024-06-13 18:38:45.590750,epoch time: 0:26:11.075329,used: 1:45:53.999910,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316521
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9692866, 'precision': 0.8242919, 'recall': 0.58117026, 'specificity': 0.58117026, 'f1': 0.6248721, 'auroc': 0.94671386, 'binary_precision': 0.67688024, 'binary_recall': 0.16508152, 'binary_specificity': 0.99725896, 'binary_f1_score': 0.26542872}
confusion matrix:
       0    1
0  42204  116
1   1229  243
---- Validation: 
scalar performance:
{'acc': 0.9670072, 'precision': 0.7903081, 'recall': 0.5478871, 'specificity': 0.5478871, 'f1': 0.5760352, 'auroc': 0.9449679, 'binary_precision': 0.61165047, 'binary_recall': 0.09797823, 'binary_specificity': 0.997796, 'binary_f1_score': 0.1689008}
confusion matrix:
       0   1
0  18109  40
1    580  63
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.8543732, 'recall': 0.50566375, 'specificity': 0.50566375, 'f1': 0.5007502, 'auroc': 0.92142254, 'binary_precision': 0.75, 'binary_recall': 0.011494253, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.022641508}
confusion matrix:
      0  1
0  5996  1
1   258  3
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316521_5.png
early stop counter: 1
val acc:0.9670072197914124, best validation acc: 0.9678586721420288, corresponding to test acc:                         0.9589325785636902 / 0.9658037424087524
after epoch: 5,now: 2024-06-13 19:05:03.375954,epoch time: 0:26:17.785204,used: 2:12:11.785114,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316521
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97033703, 'precision': 0.7763194, 'recall': 0.7305618, 'specificity': 0.7305618, 'f1': 0.7511682, 'auroc': 0.94936097, 'binary_precision': 0.5708436, 'binary_recall': 0.47350544, 'binary_specificity': 0.98761815, 'binary_f1_score': 0.5176383}
confusion matrix:
       0    1
0  41796  524
1    775  697
---- Validation: 
scalar performance:
{'acc': 0.968178, 'precision': 0.7636081, 'recall': 0.6925038, 'specificity': 0.6925038, 'f1': 0.7219472, 'auroc': 0.9462427, 'binary_precision': 0.5483871, 'binary_recall': 0.39657855, 'binary_specificity': 0.9884291, 'binary_f1_score': 0.4602888}
confusion matrix:
       0    1
0  17939  210
1    388  255
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9643656, 'precision': 0.8814856, 'recall': 0.5966173, 'specificity': 0.5966173, 'f1': 0.64777696, 'auroc': 0.923637, 'binary_precision': 0.796875, 'binary_recall': 0.1954023, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.31384617}
confusion matrix:
      0   1
0  5984  13
1   210  51
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316521_6.png
better model found
persisted
after epoch: 6,now: 2024-06-13 19:31:24.785934,epoch time: 0:26:21.409980,used: 2:38:33.195094,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316521
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9704969, 'precision': 0.7785263, 'recall': 0.727038, 'specificity': 0.727038, 'f1': 0.74990034, 'auroc': 0.9492048, 'binary_precision': 0.57550335, 'binary_recall': 0.4660326, 'binary_specificity': 0.9880435, 'binary_f1_score': 0.515015}
confusion matrix:
       0    1
0  41814  506
1    786  686
---- Validation: 
scalar performance:
{'acc': 0.968923, 'precision': 0.77212775, 'recall': 0.6928896, 'specificity': 0.6928896, 'f1': 0.7250874, 'auroc': 0.9473145, 'binary_precision': 0.5654102, 'binary_recall': 0.39657855, 'binary_specificity': 0.98920053, 'binary_f1_score': 0.46617916}
confusion matrix:
       0    1
0  17953  196
1    388  255
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608501, 'precision': 0.8845907, 'recall': 0.53981304, 'specificity': 0.53981304, 'f1': 0.56315356, 'auroc': 0.9222038, 'binary_precision': 0.8076923, 'binary_recall': 0.08045977, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.14634146}
confusion matrix:
      0   1
0  5992   5
1   240  21
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316521_7.png
better model found
persisted
after epoch: 7,now: 2024-06-13 19:57:51.658521,epoch time: 0:26:26.872587,used: 3:05:00.067681,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316521
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9714103, 'precision': 0.80309916, 'recall': 0.67964315, 'specificity': 0.67964315, 'f1': 0.72421795, 'auroc': 0.95085716, 'binary_precision': 0.627907, 'binary_recall': 0.3668478, 'binary_specificity': 0.99243855, 'binary_f1_score': 0.46312177}
confusion matrix:
       0    1
0  42000  320
1    932  540
---- Validation: 
scalar performance:
{'acc': 0.969189, 'precision': 0.7843703, 'recall': 0.6555245, 'specificity': 0.6555245, 'f1': 0.69936913, 'auroc': 0.9473978, 'binary_precision': 0.59248555, 'binary_recall': 0.31881803, 'binary_specificity': 0.99223095, 'binary_f1_score': 0.41456017}
confusion matrix:
       0    1
0  18008  141
1    438  205
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608501, 'precision': 0.93052256, 'recall': 0.534316, 'specificity': 0.534316, 'f1': 0.55404466, 'auroc': 0.92115164, 'binary_precision': 0.9, 'binary_recall': 0.06896552, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.12811388}
confusion matrix:
      0   1
0  5995   2
1   243  18
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316521_8.png
better model found
persisted
after epoch: 8,now: 2024-06-13 20:24:13.953440,epoch time: 0:26:22.294919,used: 3:31:22.362600,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316521
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.97045124, 'precision': 0.80862254, 'recall': 0.6333273, 'specificity': 0.6333273, 'f1': 0.6834538, 'auroc': 0.95161676, 'binary_precision': 0.64205456, 'binary_recall': 0.27192387, 'binary_specificity': 0.9947308, 'binary_f1_score': 0.38204393}
confusion matrix:
       0    1
0  42098  223
1   1071  400
---- Validation: 
scalar performance:
{'acc': 0.96812475, 'precision': 0.8026057, 'recall': 0.5792179, 'specificity': 0.5792179, 'f1': 0.6207287, 'auroc': 0.95011353, 'binary_precision': 0.63414633, 'binary_recall': 0.16174184, 'binary_specificity': 0.996694, 'binary_f1_score': 0.25774473}
confusion matrix:
       0    1
0  18089   60
1    539  104
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.9792999, 'recall': 0.50383145, 'specificity': 0.50383145, 'f1': 0.4970357, 'auroc': 0.92518693, 'binary_precision': 1.0, 'binary_recall': 0.007662835, 'binary_specificity': 1.0, 'binary_f1_score': 0.015209124}
confusion matrix:
      0  1
0  5997  0
1   259  2
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316521_9.png
early stop counter: 1
val acc:0.9681247472763062, best validation acc: 0.9691889882087708, corresponding to test acc:                         0.9608501195907593 / 0.9658037424087524
after epoch: 9,now: 2024-06-13 20:50:35.289308,epoch time: 0:26:21.335868,used: 3:57:43.698468,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316521
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.97129613, 'precision': 0.78925794, 'recall': 0.7174275, 'specificity': 0.7174275, 'f1': 0.747769, 'auroc': 0.9531161, 'binary_precision': 0.59762776, 'binary_recall': 0.44527534, 'binary_specificity': 0.9895796, 'binary_f1_score': 0.51032335}
confusion matrix:
       0    1
0  41880  441
1    816  655
---- Validation: 
scalar performance:
{'acc': 0.96945506, 'precision': 0.7803111, 'recall': 0.6849144, 'specificity': 0.6849144, 'f1': 0.7218969, 'auroc': 0.9490837, 'binary_precision': 0.5823389, 'binary_recall': 0.37947124, 'binary_specificity': 0.9903576, 'binary_f1_score': 0.4595104}
confusion matrix:
       0    1
0  17974  175
1    399  244
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.87642366, 'recall': 0.5359816, 'specificity': 0.5359816, 'f1': 0.55656934, 'auroc': 0.9230329, 'binary_precision': 0.7916667, 'binary_recall': 0.07279693, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.13333333}
confusion matrix:
      0   1
0  5992   5
1   242  19
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316521_10.png
better model found
persisted
after epoch: 10,now: 2024-06-13 21:16:57.792946,epoch time: 0:26:22.503638,used: 4:24:06.202106,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316521
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.971867, 'precision': 0.8190348, 'recall': 0.663916, 'specificity': 0.663916, 'f1': 0.7145549, 'auroc': 0.95442957, 'binary_precision': 0.66083443, 'binary_recall': 0.33378655, 'binary_specificity': 0.9940455, 'binary_f1_score': 0.4435411}
confusion matrix:
       0    1
0  42069  252
1    980  491
---- Validation: 
scalar performance:
{'acc': 0.96823114, 'precision': 0.7919169, 'recall': 0.59577423, 'specificity': 0.59577423, 'f1': 0.6402841, 'auroc': 0.94960713, 'binary_precision': 0.61165047, 'binary_recall': 0.19595645, 'binary_specificity': 0.99559206, 'binary_f1_score': 0.29681978}
confusion matrix:
       0    1
0  18069   80
1    517  126
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.8366661, 'recall': 0.5094118, 'specificity': 0.5094118, 'f1': 0.50812435, 'auroc': 0.9254391, 'binary_precision': 0.71428573, 'binary_recall': 0.019157087, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.037313428}
confusion matrix:
      0  1
0  5995  2
1   256  5
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316521_11.png
early stop counter: 1
val acc:0.9682311415672302, best validation acc: 0.9694550633430481, corresponding to test acc:                         0.9605305194854736 / 0.9658037424087524
after epoch: 11,now: 2024-06-13 21:43:31.926124,epoch time: 0:26:34.133178,used: 4:50:40.335284,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316521
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.97086227, 'precision': 0.8090131, 'recall': 0.64699167, 'specificity': 0.64699167, 'f1': 0.69688743, 'auroc': 0.95244527, 'binary_precision': 0.6419214, 'binary_recall': 0.29979604, 'binary_specificity': 0.9941873, 'binary_f1_score': 0.40871176}
confusion matrix:
       0    1
0  42075  246
1   1030  441
---- Validation: 
scalar performance:
{'acc': 0.96886975, 'precision': 0.8101056, 'recall': 0.59685487, 'specificity': 0.59685487, 'f1': 0.6434104, 'auroc': 0.9495553, 'binary_precision': 0.6479592, 'binary_recall': 0.19751166, 'binary_specificity': 0.9961981, 'binary_f1_score': 0.30274135}
confusion matrix:
       0    1
0  18080   69
1    516  127
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.9793765, 'recall': 0.50574714, 'specificity': 0.50574714, 'f1': 0.50083476, 'auroc': 0.9241966, 'binary_precision': 1.0, 'binary_recall': 0.011494253, 'binary_specificity': 1.0, 'binary_f1_score': 0.022727272}
confusion matrix:
      0  1
0  5997  0
1   258  3
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316521_12.png
early stop counter: 2
val acc:0.9688697457313538, best validation acc: 0.9694550633430481, corresponding to test acc:                         0.9605305194854736 / 0.9658037424087524
after epoch: 12,now: 2024-06-13 22:09:52.321737,epoch time: 0:26:20.395613,used: 5:17:00.730897,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316521
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9713646, 'precision': 0.80717826, 'recall': 0.66824937, 'specificity': 0.66824937, 'f1': 0.7157077, 'auroc': 0.95438886, 'binary_precision': 0.6368222, 'binary_recall': 0.3433039, 'binary_specificity': 0.9931949, 'binary_f1_score': 0.44611308}
confusion matrix:
       0    1
0  42033  288
1    966  505
---- Validation: 
scalar performance:
{'acc': 0.9691358, 'precision': 0.7996429, 'recall': 0.6194943, 'specificity': 0.6194943, 'f1': 0.66771114, 'auroc': 0.9503094, 'binary_precision': 0.625498, 'binary_recall': 0.24416797, 'binary_specificity': 0.99482065, 'binary_f1_score': 0.3512304}
confusion matrix:
       0    1
0  18055   94
1    486  157
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.9793765, 'recall': 0.50574714, 'specificity': 0.50574714, 'f1': 0.50083476, 'auroc': 0.9248914, 'binary_precision': 1.0, 'binary_recall': 0.011494253, 'binary_specificity': 1.0, 'binary_f1_score': 0.022727272}
confusion matrix:
      0  1
0  5997  0
1   258  3
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316521_13.png
early stop counter: 3
val acc:0.9691358208656311, best validation acc: 0.9694550633430481, corresponding to test acc:                         0.9605305194854736 / 0.9658037424087524
after epoch: 13,now: 2024-06-13 22:36:09.213607,epoch time: 0:26:16.891870,used: 5:43:17.622767,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316521
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9720954, 'precision': 0.82079625, 'recall': 0.6688504, 'specificity': 0.6688504, 'f1': 0.7193408, 'auroc': 0.95405656, 'binary_precision': 0.664042, 'binary_recall': 0.34375, 'binary_specificity': 0.99395084, 'binary_f1_score': 0.45299911}
confusion matrix:
       0    1
0  42064  256
1    966  506
---- Validation: 
scalar performance:
{'acc': 0.9694019, 'precision': 0.8044344, 'recall': 0.6218822, 'specificity': 0.6218822, 'f1': 0.67093486, 'auroc': 0.95147717, 'binary_precision': 0.63492066, 'binary_recall': 0.2488336, 'binary_specificity': 0.99493086, 'binary_f1_score': 0.35754192}
confusion matrix:
       0    1
0  18057   92
1    483  160
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.81262994, 'recall': 0.50374806, 'specificity': 0.50374806, 'f1': 0.49696523, 'auroc': 0.9254421, 'binary_precision': 0.6666667, 'binary_recall': 0.007662835, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.015151515}
confusion matrix:
      0  1
0  5996  1
1   259  2
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316521_14.png
early stop counter: 4
val acc:0.9694018959999084, best validation acc: 0.9694550633430481, corresponding to test acc:                         0.9605305194854736 / 0.9658037424087524
after epoch: 14,now: 2024-06-13 23:02:32.922717,epoch time: 0:26:23.709110,used: 6:09:41.331877,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316521
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9713418, 'precision': 0.7888803, 'recall': 0.7213882, 'specificity': 0.7213882, 'f1': 0.75024563, 'auroc': 0.9553243, 'binary_precision': 0.59660107, 'binary_recall': 0.45343304, 'binary_specificity': 0.98934335, 'binary_f1_score': 0.5152569}
confusion matrix:
       0    1
0  41870  451
1    804  667
---- Validation: 
scalar performance:
{'acc': 0.96945506, 'precision': 0.78457034, 'recall': 0.66841316, 'specificity': 0.66841316, 'f1': 0.7102258, 'auroc': 0.9506976, 'binary_precision': 0.592, 'binary_recall': 0.3452566, 'binary_specificity': 0.99156976, 'binary_f1_score': 0.43614933}
confusion matrix:
       0    1
0  17996  153
1    421  222
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.8552821, 'recall': 0.52831876, 'specificity': 0.52831876, 'f1': 0.5431233, 'auroc': 0.9259571, 'binary_precision': 0.75, 'binary_recall': 0.057471264, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.10676157}
confusion matrix:
      0   1
0  5992   5
1   246  15
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316521_15.png
early stop counter: 5
val acc:0.9694550633430481, best validation acc: 0.9694550633430481, corresponding to test acc:                         0.9605305194854736 / 0.9658037424087524
after epoch: 15,now: 2024-06-13 23:29:05.007441,epoch time: 0:26:32.084724,used: 6:36:13.416601,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316521
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.97266626, 'precision': 0.8089363, 'recall': 0.7124232, 'specificity': 0.7124232, 'f1': 0.7509543, 'auroc': 0.9565463, 'binary_precision': 0.63736266, 'binary_recall': 0.4334239, 'binary_specificity': 0.9914225, 'binary_f1_score': 0.5159725}
confusion matrix:
       0    1
0  41957  363
1    834  638
---- Validation: 
scalar performance:
{'acc': 0.9710515, 'precision': 0.80700374, 'recall': 0.67599016, 'specificity': 0.67599016, 'f1': 0.7221861, 'auroc': 0.95114714, 'binary_precision': 0.6363636, 'binary_recall': 0.3592535, 'binary_specificity': 0.99272686, 'binary_f1_score': 0.4592445}
confusion matrix:
       0    1
0  18017  132
1    412  231
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.7293666, 'recall': 0.505497, 'specificity': 0.505497, 'f1': 0.50058204, 'auroc': 0.923583, 'binary_precision': 0.5, 'binary_recall': 0.011494253, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.022471908}
confusion matrix:
      0  1
0  5994  3
1   258  3
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316521_16.png
better model found
persisted
after epoch: 16,now: 2024-06-13 23:55:53.269606,epoch time: 0:26:48.262165,used: 7:03:01.678766,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316521
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9728718, 'precision': 0.81332946, 'recall': 0.7089231, 'specificity': 0.7089231, 'f1': 0.7497802, 'auroc': 0.9556608, 'binary_precision': 0.64639175, 'binary_recall': 0.4259511, 'binary_specificity': 0.9918951, 'binary_f1_score': 0.5135135}
confusion matrix:
       0    1
0  41977  343
1    845  627
---- Validation: 
scalar performance:
{'acc': 0.9703065, 'precision': 0.79838765, 'recall': 0.66735387, 'specificity': 0.66735387, 'f1': 0.712815, 'auroc': 0.951731, 'binary_precision': 0.6197183, 'binary_recall': 0.3421462, 'binary_specificity': 0.9925616, 'binary_f1_score': 0.44088176}
confusion matrix:
       0    1
0  18014  135
1    423  220
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589326, 'precision': 0.7923943, 'recall': 0.51865685, 'specificity': 0.51865685, 'f1': 0.52560186, 'auroc': 0.9256568, 'binary_precision': 0.625, 'binary_recall': 0.038314175, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.07220217}
confusion matrix:
      0   1
0  5991   6
1   251  10
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316521_17.png
early stop counter: 1
val acc:0.9703065156936646, best validation acc: 0.9710515141487122, corresponding to test acc:                         0.9582933783531189 / 0.9658037424087524
after epoch: 17,now: 2024-06-14 00:22:36.611613,epoch time: 0:26:43.342007,used: 7:29:45.020773,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316521
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9726434, 'precision': 0.8174126, 'recall': 0.692412, 'specificity': 0.692412, 'f1': 0.73829526, 'auroc': 0.95463586, 'binary_precision': 0.6556818, 'binary_recall': 0.3919837, 'binary_specificity': 0.9928403, 'binary_f1_score': 0.49064624}
confusion matrix:
       0    1
0  42017  303
1    895  577
---- Validation: 
scalar performance:
{'acc': 0.97009367, 'precision': 0.8059082, 'recall': 0.64399195, 'specificity': 0.64399195, 'f1': 0.69339544, 'auroc': 0.95161617, 'binary_precision': 0.6363636, 'binary_recall': 0.29393467, 'binary_specificity': 0.99404925, 'binary_f1_score': 0.40212762}
confusion matrix:
       0    1
0  18041  108
1    454  189
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.81262994, 'recall': 0.50374806, 'specificity': 0.50374806, 'f1': 0.49696523, 'auroc': 0.9246023, 'binary_precision': 0.6666667, 'binary_recall': 0.007662835, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.015151515}
confusion matrix:
      0  1
0  5996  1
1   259  2
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316521_18.png
early stop counter: 2
val acc:0.9700936675071716, best validation acc: 0.9710515141487122, corresponding to test acc:                         0.9582933783531189 / 0.9658037424087524
after epoch: 18,now: 2024-06-14 00:49:08.441390,epoch time: 0:26:31.829777,used: 7:56:16.850550,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316521
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.97255206, 'precision': 0.81389177, 'recall': 0.6966269, 'specificity': 0.6966269, 'f1': 0.7406372, 'auroc': 0.95550716, 'binary_precision': 0.64835167, 'binary_recall': 0.40081522, 'binary_specificity': 0.99243855, 'binary_f1_score': 0.49538204}
confusion matrix:
       0    1
0  42000  320
1    882  590
---- Validation: 
scalar performance:
{'acc': 0.97094506, 'precision': 0.8104169, 'recall': 0.6654343, 'specificity': 0.6654343, 'f1': 0.71397036, 'auroc': 0.95112145, 'binary_precision': 0.6439169, 'binary_recall': 0.33748055, 'binary_specificity': 0.99338806, 'binary_f1_score': 0.44285715}
confusion matrix:
       0    1
0  18029  120
1    426  217
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.9793765, 'recall': 0.50574714, 'specificity': 0.50574714, 'f1': 0.50083476, 'auroc': 0.92267776, 'binary_precision': 1.0, 'binary_recall': 0.011494253, 'binary_specificity': 1.0, 'binary_f1_score': 0.022727272}
confusion matrix:
      0  1
0  5997  0
1   258  3
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316521_19.png
early stop counter: 3
val acc:0.9709450602531433, best validation acc: 0.9710515141487122, corresponding to test acc:                         0.9582933783531189 / 0.9658037424087524
after epoch: 19,now: 2024-06-14 01:15:42.703363,epoch time: 0:26:34.261973,used: 8:22:51.112523,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316521
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9727119, 'precision': 0.8193668, 'recall': 0.6902723, 'specificity': 0.6902723, 'f1': 0.73710245, 'auroc': 0.9541412, 'binary_precision': 0.6597222, 'binary_recall': 0.3874915, 'binary_specificity': 0.9930531, 'binary_f1_score': 0.48822272}
confusion matrix:
       0    1
0  42027  294
1    901  570
---- Validation: 
scalar performance:
{'acc': 0.969934, 'precision': 0.8071104, 'recall': 0.63640875, 'specificity': 0.63640875, 'f1': 0.6862271, 'auroc': 0.95080745, 'binary_precision': 0.63928574, 'binary_recall': 0.27838257, 'binary_specificity': 0.99443495, 'binary_f1_score': 0.38786566}
confusion matrix:
       0    1
0  18048  101
1    464  179
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590924, 'precision': 0.84338665, 'recall': 0.51507556, 'specificity': 0.51507556, 'f1': 0.5189576, 'auroc': 0.922606, 'binary_precision': 0.72727275, 'binary_recall': 0.03065134, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.058823526}
confusion matrix:
      0  1
0  5994  3
1   253  8
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316521_20.png
early stop counter: 4
val acc:0.9699339866638184, best validation acc: 0.9710515141487122, corresponding to test acc:                         0.9582933783531189 / 0.9658037424087524
after epoch: 20,now: 2024-06-14 01:42:30.953199,epoch time: 0:26:48.249836,used: 8:49:39.362359,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316521
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9728718, 'precision': 0.80250514, 'recall': 0.73974186, 'specificity': 0.73974186, 'f1': 0.7671525, 'auroc': 0.95294285, 'binary_precision': 0.62262523, 'binary_recall': 0.48980978, 'binary_specificity': 0.9896739, 'binary_f1_score': 0.548289}
confusion matrix:
       0    1
0  41883  437
1    751  721
---- Validation: 
scalar performance:
{'acc': 0.97115797, 'precision': 0.80231017, 'recall': 0.6910464, 'specificity': 0.6910464, 'f1': 0.7330049, 'auroc': 0.9519393, 'binary_precision': 0.62593514, 'binary_recall': 0.3903577, 'binary_specificity': 0.9917351, 'binary_f1_score': 0.48084292}
confusion matrix:
       0    1
0  17999  150
1    392  251
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589326, 'precision': 0.8546, 'recall': 0.5113275, 'specificity': 0.5113275, 'f1': 0.51181245, 'auroc': 0.9230046, 'binary_precision': 0.75, 'binary_recall': 0.022988506, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.044609666}
confusion matrix:
      0  1
0  5995  2
1   255  6
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316521_21.png
better model found
persisted
after epoch: 21,now: 2024-06-14 02:09:05.418857,epoch time: 0:26:34.465658,used: 9:16:13.828017,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316521
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9725977, 'precision': 0.8362384, 'recall': 0.6618974, 'specificity': 0.6618974, 'f1': 0.71622276, 'auroc': 0.9572983, 'binary_precision': 0.6954023, 'binary_recall': 0.32880434, 'binary_specificity': 0.9949905, 'binary_f1_score': 0.44649446}
confusion matrix:
       0    1
0  42108  212
1    988  484
---- Validation: 
scalar performance:
{'acc': 0.9695615, 'precision': 0.83210707, 'recall': 0.5979631, 'specificity': 0.5979631, 'f1': 0.6468083, 'auroc': 0.9518434, 'binary_precision': 0.6918919, 'binary_recall': 0.19906688, 'binary_specificity': 0.9968593, 'binary_f1_score': 0.30917874}
confusion matrix:
       0    1
0  18092   57
1    515  128
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.9793765, 'recall': 0.50574714, 'specificity': 0.50574714, 'f1': 0.50083476, 'auroc': 0.92371583, 'binary_precision': 1.0, 'binary_recall': 0.011494253, 'binary_specificity': 1.0, 'binary_f1_score': 0.022727272}
confusion matrix:
      0  1
0  5997  0
1   258  3
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316521_22.png
early stop counter: 1
val acc:0.9695615172386169, best validation acc: 0.971157968044281, corresponding to test acc:                         0.9589325785636902 / 0.9658037424087524
after epoch: 22,now: 2024-06-14 02:35:53.051364,epoch time: 0:26:47.632507,used: 9:43:01.460524,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316521
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.97266626, 'precision': 0.7921904, 'recall': 0.77471644, 'specificity': 0.77471644, 'f1': 0.7831573, 'auroc': 0.95906687, 'binary_precision': 0.5995655, 'binary_recall': 0.5625, 'binary_specificity': 0.9869329, 'binary_f1_score': 0.58044165}
confusion matrix:
       0    1
0  41767  553
1    644  828
---- Validation: 
scalar performance:
{'acc': 0.9707322, 'precision': 0.784178, 'recall': 0.73957956, 'specificity': 0.73957956, 'f1': 0.759789, 'auroc': 0.9533649, 'binary_precision': 0.58627087, 'binary_recall': 0.49144635, 'binary_specificity': 0.9877128, 'binary_f1_score': 0.534687}
confusion matrix:
       0    1
0  17926  223
1    327  316
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9592522, 'precision': 0.8051218, 'recall': 0.5243206, 'specificity': 0.5243206, 'f1': 0.5358424, 'auroc': 0.9241556, 'binary_precision': 0.65, 'binary_recall': 0.049808428, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.09252669}
confusion matrix:
      0   1
0  5990   7
1   248  13
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316521_23.png
early stop counter: 2
val acc:0.9707322120666504, best validation acc: 0.971157968044281, corresponding to test acc:                         0.9589325785636902 / 0.9658037424087524
after epoch: 23,now: 2024-06-14 03:02:36.487638,epoch time: 0:26:43.436274,used: 10:09:44.896798,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316521
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9728946, 'precision': 0.79669845, 'recall': 0.7628748, 'specificity': 0.7628748, 'f1': 0.77866507, 'auroc': 0.9562183, 'binary_precision': 0.6093991, 'binary_recall': 0.53772944, 'binary_specificity': 0.9880201, 'binary_f1_score': 0.57132536}
confusion matrix:
       0    1
0  41814  507
1    680  791
---- Validation: 
scalar performance:
{'acc': 0.9714772, 'precision': 0.79628944, 'recall': 0.722714, 'specificity': 0.722714, 'f1': 0.7537906, 'auroc': 0.95280695, 'binary_precision': 0.611691, 'binary_recall': 0.45567653, 'binary_specificity': 0.9897515, 'binary_f1_score': 0.5222816}
confusion matrix:
       0    1
0  17963  186
1    350  293
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9592522, 'precision': 0.8051218, 'recall': 0.5243206, 'specificity': 0.5243206, 'f1': 0.5358424, 'auroc': 0.9253477, 'binary_precision': 0.65, 'binary_recall': 0.049808428, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.09252669}
confusion matrix:
      0   1
0  5990   7
1   248  13
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316521_24.png
better model found
persisted
after epoch: 24,now: 2024-06-14 03:29:24.183191,epoch time: 0:26:47.695553,used: 10:36:32.592351,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316521
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9733513, 'precision': 0.8089637, 'recall': 0.7371919, 'specificity': 0.7371919, 'f1': 0.76793206, 'auroc': 0.9578717, 'binary_precision': 0.6357143, 'binary_recall': 0.48402447, 'binary_specificity': 0.9903594, 'binary_f1_score': 0.5495947}
confusion matrix:
       0    1
0  41913  408
1    759  712
---- Validation: 
scalar performance:
{'acc': 0.9720626, 'precision': 0.8158033, 'recall': 0.6922648, 'specificity': 0.6922648, 'f1': 0.737717, 'auroc': 0.95315194, 'binary_precision': 0.65284973, 'binary_recall': 0.3919129, 'binary_specificity': 0.99261665, 'binary_f1_score': 0.48979592}
confusion matrix:
       0    1
0  18015  134
1    391  252
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959412, 'precision': 0.9796833, 'recall': 0.51341, 'specificity': 0.51341, 'f1': 0.51575035, 'auroc': 0.9264736, 'binary_precision': 1.0, 'binary_recall': 0.026819924, 'binary_specificity': 1.0, 'binary_f1_score': 0.052238807}
confusion matrix:
      0  1
0  5997  0
1   254  7
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316521_25.png
better model found
persisted
after epoch: 25,now: 2024-06-14 03:56:20.996845,epoch time: 0:26:56.813654,used: 11:03:29.406005,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316521
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9727576, 'precision': 0.7950272, 'recall': 0.7649279, 'specificity': 0.7649279, 'f1': 0.77908945, 'auroc': 0.95594084, 'binary_precision': 0.6059226, 'binary_recall': 0.54211956, 'binary_specificity': 0.9877363, 'binary_f1_score': 0.5722481}
confusion matrix:
       0    1
0  41801  519
1    674  798
---- Validation: 
scalar performance:
{'acc': 0.97078544, 'precision': 0.7834221, 'recall': 0.7471077, 'specificity': 0.7471077, 'f1': 0.76389575, 'auroc': 0.9523933, 'binary_precision': 0.5842294, 'binary_recall': 0.5069984, 'binary_specificity': 0.98721695, 'binary_f1_score': 0.54288095}
confusion matrix:
       0    1
0  17917  232
1    317  326
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.88960725, 'recall': 0.5341493, 'specificity': 0.5341493, 'f1': 0.5535086, 'auroc': 0.9239973, 'binary_precision': 0.8181818, 'binary_recall': 0.06896552, 'binary_specificity': 0.999333, 'binary_f1_score': 0.12720849}
confusion matrix:
      0   1
0  5993   4
1   243  18
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316521_26.png
early stop counter: 1
val acc:0.9707854390144348, best validation acc: 0.9720625877380371, corresponding to test acc:                         0.9594119787216187 / 0.9658037424087524
after epoch: 26,now: 2024-06-14 04:23:15.432600,epoch time: 0:26:54.435755,used: 11:30:23.841760,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316521
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9727119, 'precision': 0.8517966, 'recall': 0.6485143, 'specificity': 0.6485143, 'f1': 0.70589036, 'auroc': 0.95687413, 'binary_precision': 0.727422, 'binary_recall': 0.3009511, 'binary_specificity': 0.9960775, 'binary_f1_score': 0.42575684}
confusion matrix:
       0    1
0  42154  166
1   1029  443
---- Validation: 
scalar performance:
{'acc': 0.96977437, 'precision': 0.83061385, 'recall': 0.60482377, 'specificity': 0.60482377, 'f1': 0.6549783, 'auroc': 0.95279163, 'binary_precision': 0.68844223, 'binary_recall': 0.21306376, 'binary_specificity': 0.9965838, 'binary_f1_score': 0.3254157}
confusion matrix:
       0    1
0  18087   62
1    506  137
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.9792999, 'recall': 0.50383145, 'specificity': 0.50383145, 'f1': 0.4970357, 'auroc': 0.9237467, 'binary_precision': 1.0, 'binary_recall': 0.007662835, 'binary_specificity': 1.0, 'binary_f1_score': 0.015209124}
confusion matrix:
      0  1
0  5997  0
1   259  2
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316521_27.png
early stop counter: 2
val acc:0.9697743654251099, best validation acc: 0.9720625877380371, corresponding to test acc:                         0.9594119787216187 / 0.9658037424087524
after epoch: 27,now: 2024-06-14 04:50:10.378436,epoch time: 0:26:54.945836,used: 11:57:18.787596,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316521
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9720497, 'precision': 0.855332, 'recall': 0.6298115, 'specificity': 0.6298115, 'f1': 0.686543, 'auroc': 0.9581946, 'binary_precision': 0.73574144, 'binary_recall': 0.2629076, 'binary_specificity': 0.9967155, 'binary_f1_score': 0.3873874}
confusion matrix:
       0    1
0  42181  139
1   1085  387
---- Validation: 
scalar performance:
{'acc': 0.968444, 'precision': 0.8258644, 'recall': 0.57188267, 'specificity': 0.57188267, 'f1': 0.6123021, 'auroc': 0.95251703, 'binary_precision': 0.68115944, 'binary_recall': 0.14618973, 'binary_specificity': 0.99757564, 'binary_f1_score': 0.24071702}
confusion matrix:
       0   1
0  18105  44
1    549  94
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.97922325, 'recall': 0.5019157, 'specificity': 0.5019157, 'f1': 0.49320802, 'auroc': 0.9235713, 'binary_precision': 1.0, 'binary_recall': 0.0038314175, 'binary_specificity': 1.0, 'binary_f1_score': 0.007633588}
confusion matrix:
      0  1
0  5997  0
1   260  1
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316521_28.png
early stop counter: 3
val acc:0.9684439897537231, best validation acc: 0.9720625877380371, corresponding to test acc:                         0.9594119787216187 / 0.9658037424087524
after epoch: 28,now: 2024-06-14 05:16:59.833254,epoch time: 0:26:49.454818,used: 12:24:08.242414,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316521
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.97319144, 'precision': 0.80544937, 'recall': 0.7420306, 'specificity': 0.7420306, 'f1': 0.76972675, 'auroc': 0.95690584, 'binary_precision': 0.6283492, 'binary_recall': 0.49422163, 'binary_specificity': 0.98983955, 'binary_f1_score': 0.5532725}
confusion matrix:
       0    1
0  41891  430
1    744  727
---- Validation: 
scalar performance:
{'acc': 0.9713176, 'precision': 0.8029152, 'recall': 0.69562936, 'specificity': 0.69562936, 'f1': 0.7366873, 'auroc': 0.952605, 'binary_precision': 0.62682927, 'binary_recall': 0.39968896, 'binary_specificity': 0.99156976, 'binary_f1_score': 0.48812917}
confusion matrix:
       0    1
0  17996  153
1    386  257
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9600511, 'precision': 0.86131155, 'recall': 0.53023446, 'specificity': 0.53023446, 'f1': 0.5465201, 'auroc': 0.92703617, 'binary_precision': 0.7619048, 'binary_recall': 0.06130268, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.11347518}
confusion matrix:
      0   1
0  5992   5
1   245  16
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316521_29.png
early stop counter: 4
val acc:0.9713175892829895, best validation acc: 0.9720625877380371, corresponding to test acc:                         0.9594119787216187 / 0.9658037424087524
after epoch: 29,now: 2024-06-14 05:43:54.777298,epoch time: 0:26:54.944044,used: 12:51:03.186458,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316521
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.97252923, 'precision': 0.79060256, 'recall': 0.7762849, 'specificity': 0.7762849, 'f1': 0.7832447, 'auroc': 0.95627034, 'binary_precision': 0.5962777, 'binary_recall': 0.56589675, 'binary_specificity': 0.986673, 'binary_f1_score': 0.5806901}
confusion matrix:
       0    1
0  41756  564
1    639  833
---- Validation: 
scalar performance:
{'acc': 0.97126436, 'precision': 0.7920757, 'recall': 0.72935426, 'specificity': 0.72935426, 'f1': 0.75657654, 'auroc': 0.9522453, 'binary_precision': 0.6027944, 'binary_recall': 0.4696734, 'binary_specificity': 0.9890352, 'binary_f1_score': 0.527972}
confusion matrix:
       0    1
0  17950  199
1    341  302
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.88097304, 'recall': 0.54547673, 'specificity': 0.54547673, 'f1': 0.5725356, 'auroc': 0.9261567, 'binary_precision': 0.8, 'binary_recall': 0.09195402, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.16494845}
confusion matrix:
      0   1
0  5991   6
1   237  24
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316521_30.png
early stop counter: 5
val acc:0.9712643623352051, best validation acc: 0.9720625877380371, corresponding to test acc:                         0.9594119787216187 / 0.9658037424087524
after epoch: 30,now: 2024-06-14 06:10:54.923755,epoch time: 0:27:00.146457,used: 13:18:03.332915,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316521
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 13:18:03.332915 at 2024-06-14 06:10:54.923755
persisted model performance metric: 

scalar performance:
{'acc': 0.959412, 'precision': 0.9796833, 'recall': 0.51341, 'specificity': 0.51341, 'f1': 0.51575035, 'auroc': 0.9264736, 'binary_precision': 1.0, 'binary_recall': 0.026819924, 'binary_specificity': 1.0, 'binary_f1_score': 0.052238807}
confusion matrix:
      0  1
0  5997  0
1   254  7
oracle model performance metric: 

scalar performance:
{'acc': 0.96580374, 'precision': 0.93928826, 'recall': 0.5992, 'specificity': 0.5992, 'f1': 0.6547501, 'auroc': 0.91477877, 'binary_precision': 0.9122807, 'binary_recall': 0.19923371, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.32704404}
confusion matrix:
      0   1
0  5992   5
1   209  52
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_vit_resnet_dinov2_bs16_different_learningrates/rule_results/10.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_vit_resnet_dinov2_bs16_different_learningrates/rule_results/10.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_vit_resnet_dinov2_bs16_different_learningrates/confusion_matrix/10.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 688276 KiB |   1449 MiB | 462789 GiB | 462788 GiB |
|       from large pool | 684800 KiB |   1444 MiB | 451908 GiB | 451907 GiB |
|       from small pool |   3476 KiB |      8 MiB |  10881 GiB |  10881 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 688276 KiB |   1449 MiB | 462789 GiB | 462788 GiB |
|       from large pool | 684800 KiB |   1444 MiB | 451908 GiB | 451907 GiB |
|       from small pool |   3476 KiB |      8 MiB |  10881 GiB |  10881 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 687268 KiB |   1445 MiB | 461986 GiB | 461985 GiB |
|       from large pool | 684800 KiB |   1441 MiB | 451123 GiB | 451123 GiB |
|       from small pool |   2468 KiB |      6 MiB |  10862 GiB |  10862 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1628 MiB |   1628 MiB |   1628 MiB |      0 B   |
|       from large pool |   1618 MiB |   1618 MiB |   1618 MiB |      0 B   |
|       from small pool |     10 MiB |     10 MiB |     10 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 116587 KiB | 228792 KiB | 201086 GiB | 201086 GiB |
|       from large pool | 113920 KiB | 225536 KiB | 190203 GiB | 190203 GiB |
|       from small pool |   2667 KiB |   3932 KiB |  10882 GiB |  10882 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2916    |    5887    |   90913 K  |   90910 K  |
|       from large pool |     100    |     205    |   28247 K  |   28247 K  |
|       from small pool |    2816    |    5786    |   62666 K  |   62663 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2916    |    5887    |   90913 K  |   90910 K  |
|       from large pool |     100    |     205    |   28247 K  |   28247 K  |
|       from small pool |    2816    |    5786    |   62666 K  |   62663 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      79    |      79    |      79    |       0    |
|       from large pool |      74    |      74    |      74    |       0    |
|       from small pool |       5    |       5    |       5    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      53    |    2787    |   37274 K  |   37274 K  |
|       from large pool |      39    |      69    |   11234 K  |   11234 K  |
|       from small pool |      14    |    2748    |   26039 K  |   26039 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1449 MiB | 462789 GiB | 462789 GiB |
|       from large pool |  16640 KiB |   1444 MiB | 451908 GiB | 451908 GiB |
|       from small pool |      0 KiB |      8 MiB |  10881 GiB |  10881 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1449 MiB | 462789 GiB | 462789 GiB |
|       from large pool |  16640 KiB |   1444 MiB | 451908 GiB | 451908 GiB |
|       from small pool |      0 KiB |      8 MiB |  10881 GiB |  10881 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1445 MiB | 461986 GiB | 461986 GiB |
|       from large pool |  16640 KiB |   1441 MiB | 451123 GiB | 451123 GiB |
|       from small pool |      0 KiB |      6 MiB |  10862 GiB |  10862 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    786 MiB |   1628 MiB |   1628 MiB |    842 MiB |
|       from large pool |    780 MiB |   1618 MiB |   1618 MiB |    838 MiB |
|       from small pool |      6 MiB |     10 MiB |     10 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 228792 KiB | 201086 GiB | 201086 GiB |
|       from large pool |  24320 KiB | 225536 KiB | 190204 GiB | 190204 GiB |
|       from small pool |      0 KiB |   5048 KiB |  10882 GiB |  10882 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    5887    |   90913 K  |   90913 K  |
|       from large pool |       2    |     205    |   28247 K  |   28247 K  |
|       from small pool |       0    |    5786    |   62666 K  |   62666 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    5887    |   90913 K  |   90913 K  |
|       from large pool |       2    |     205    |   28247 K  |   28247 K  |
|       from small pool |       0    |    5786    |   62666 K  |   62666 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      42    |      79    |      79    |      37    |
|       from large pool |      39    |      74    |      74    |      35    |
|       from small pool |       3    |       5    |       5    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    2787    |   37275 K  |   37275 K  |
|       from large pool |       2    |      69    |   11234 K  |   11234 K  |
|       from small pool |       0    |    2748    |   26041 K  |   26041 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1449 MiB | 462789 GiB | 462789 GiB |
|       from large pool |  16640 KiB |   1444 MiB | 451908 GiB | 451908 GiB |
|       from small pool |      0 KiB |      8 MiB |  10881 GiB |  10881 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1449 MiB | 462789 GiB | 462789 GiB |
|       from large pool |  16640 KiB |   1444 MiB | 451908 GiB | 451908 GiB |
|       from small pool |      0 KiB |      8 MiB |  10881 GiB |  10881 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1445 MiB | 461986 GiB | 461986 GiB |
|       from large pool |  16640 KiB |   1441 MiB | 451123 GiB | 451123 GiB |
|       from small pool |      0 KiB |      6 MiB |  10862 GiB |  10862 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    786 MiB |   1628 MiB |   1628 MiB |    842 MiB |
|       from large pool |    780 MiB |   1618 MiB |   1618 MiB |    838 MiB |
|       from small pool |      6 MiB |     10 MiB |     10 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 228792 KiB | 201086 GiB | 201086 GiB |
|       from large pool |  24320 KiB | 225536 KiB | 190204 GiB | 190204 GiB |
|       from small pool |      0 KiB |   5048 KiB |  10882 GiB |  10882 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    5887    |   90913 K  |   90913 K  |
|       from large pool |       2    |     205    |   28247 K  |   28247 K  |
|       from small pool |       0    |    5786    |   62666 K  |   62666 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    5887    |   90913 K  |   90913 K  |
|       from large pool |       2    |     205    |   28247 K  |   28247 K  |
|       from small pool |       0    |    5786    |   62666 K  |   62666 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      42    |      79    |      79    |      37    |
|       from large pool |      39    |      74    |      74    |      35    |
|       from small pool |       3    |       5    |       5    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    2787    |   37275 K  |   37275 K  |
|       from large pool |       2    |      69    |   11234 K  |   11234 K  |
|       from small pool |       0    |    2748    |   26041 K  |   26041 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0




!!!: not committed yet



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_06_19_51_seed_1_21316521

 Experiment start at: 2024-06-14 06:19:51.973903
before training, model accuracy: 0.04785691574215889
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9671653, 'precision': 0.7392391, 'recall': 0.6584559, 'specificity': 0.6584559, 'f1': 0.6898015, 'auroc': 0.9239663, 'binary_precision': 0.5010593, 'binary_recall': 0.32801664, 'binary_specificity': 0.9888952, 'binary_f1_score': 0.39647946}
confusion matrix:
       0    1
0  41943  471
1    969  473
---- Validation: 
scalar performance:
{'acc': 0.96542156, 'precision': 0.7520014, 'recall': 0.6702102, 'specificity': 0.6702102, 'f1': 0.70231855, 'auroc': 0.93647814, 'binary_precision': 0.52783966, 'binary_recall': 0.35215452, 'binary_specificity': 0.9882659, 'binary_f1_score': 0.4224599}
confusion matrix:
       0    1
0  17855  212
1    436  237
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9629391, 'precision': 0.8662863, 'recall': 0.5815991, 'specificity': 0.5815991, 'f1': 0.6265687, 'auroc': 0.92089397, 'binary_precision': 0.76785713, 'binary_recall': 0.16538462, 'binary_specificity': 0.99781364, 'binary_f1_score': 0.27215192}
confusion matrix:
      0   1
0  5933  13
1   217  43
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316521_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-14 06:47:35.850170,epoch time: 0:27:43.876267,used: 0:27:43.876267,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_06_19_51_seed_1_21316521
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9683738, 'precision': 0.75585735, 'recall': 0.6393185, 'specificity': 0.6393185, 'f1': 0.67879605, 'auroc': 0.93402, 'binary_precision': 0.5355757, 'binary_recall': 0.28710124, 'binary_specificity': 0.99153584, 'binary_f1_score': 0.3738149}
confusion matrix:
       0    1
0  42055  359
1   1028  414
---- Validation: 
scalar performance:
{'acc': 0.9649413, 'precision': 0.7480669, 'recall': 0.63205194, 'specificity': 0.63205194, 'f1': 0.6705011, 'auroc': 0.94314194, 'binary_precision': 0.52272725, 'binary_recall': 0.27340266, 'binary_specificity': 0.99070126, 'binary_f1_score': 0.35902438}
confusion matrix:
       0    1
0  17899  168
1    489  184
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96052206, 'precision': 0.85177743, 'recall': 0.54355806, 'specificity': 0.54355806, 'f1': 0.56893134, 'auroc': 0.9234005, 'binary_precision': 0.7419355, 'binary_recall': 0.08846154, 'binary_specificity': 0.99865454, 'binary_f1_score': 0.1580756}
confusion matrix:
      0   1
0  5938   8
1   237  23
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316521_2.png
early stop counter: 1
val acc:0.9649413228034973, best validation acc: 0.9654215574264526, corresponding to test acc:                         0.9629390835762024 / 0.9629390835762024
after epoch: 2,now: 2024-06-14 07:14:11.642341,epoch time: 0:26:35.792171,used: 0:54:19.668438,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_06_19_51_seed_1_21316521
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9684422, 'precision': 0.75590336, 'recall': 0.6490675, 'specificity': 0.6490675, 'f1': 0.6870551, 'auroc': 0.9376363, 'binary_precision': 0.53502417, 'binary_recall': 0.3072122, 'binary_specificity': 0.9909228, 'binary_f1_score': 0.39030835}
confusion matrix:
       0    1
0  42029  385
1    999  443
---- Validation: 
scalar performance:
{'acc': 0.96515477, 'precision': 0.7511896, 'recall': 0.6307321, 'specificity': 0.6307321, 'f1': 0.6700034, 'auroc': 0.94635653, 'binary_precision': 0.5290698, 'binary_recall': 0.2704309, 'binary_specificity': 0.9910334, 'binary_f1_score': 0.3579154}
confusion matrix:
       0    1
0  17905  162
1    491  182
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590719, 'precision': 0.79268444, 'recall': 0.52808934, 'specificity': 0.52808934, 'f1': 0.5423453, 'auroc': 0.92850137, 'binary_precision': 0.625, 'binary_recall': 0.057692308, 'binary_specificity': 0.9984864, 'binary_f1_score': 0.1056338}
confusion matrix:
      0   1
0  5937   9
1   245  15
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316521_3.png
early stop counter: 2
val acc:0.965154767036438, best validation acc: 0.9654215574264526, corresponding to test acc:                         0.9629390835762024 / 0.9629390835762024
after epoch: 3,now: 2024-06-14 07:40:58.266975,epoch time: 0:26:46.624634,used: 1:21:06.293072,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_06_19_51_seed_1_21316521
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9687386, 'precision': 0.7541268, 'recall': 0.76075983, 'specificity': 0.76075983, 'f1': 0.75739586, 'auroc': 0.9424138, 'binary_precision': 0.5239703, 'binary_recall': 0.5381415, 'binary_specificity': 0.9833781, 'binary_f1_score': 0.53096133}
confusion matrix:
       0    1
0  41709  705
1    666  776
---- Validation: 
scalar performance:
{'acc': 0.9671291, 'precision': 0.762952, 'recall': 0.75692785, 'specificity': 0.75692785, 'f1': 0.759901, 'auroc': 0.9493128, 'binary_precision': 0.543379, 'binary_recall': 0.5304606, 'binary_specificity': 0.98339516, 'binary_f1_score': 0.53684205}
confusion matrix:
       0    1
0  17767  300
1    316  357
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614889, 'precision': 0.81076574, 'recall': 0.5826813, 'specificity': 0.5826813, 'f1': 0.62466824, 'auroc': 0.9295239, 'binary_precision': 0.6567164, 'binary_recall': 0.16923077, 'binary_specificity': 0.99613184, 'binary_f1_score': 0.26911315}
confusion matrix:
      0   1
0  5923  23
1   216  44
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316521_4.png
better model found
persisted
after epoch: 4,now: 2024-06-14 08:07:43.097596,epoch time: 0:26:44.830621,used: 1:47:51.123693,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_06_19_51_seed_1_21316521
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9701979, 'precision': 0.792043, 'recall': 0.62820333, 'specificity': 0.62820333, 'f1': 0.6755984, 'auroc': 0.9431571, 'binary_precision': 0.6086956, 'binary_recall': 0.26213592, 'binary_specificity': 0.99427074, 'binary_f1_score': 0.36645663}
confusion matrix:
       0    1
0  42171  243
1   1064  378
---- Validation: 
scalar performance:
{'acc': 0.9665422, 'precision': 0.7828578, 'recall': 0.6049868, 'specificity': 0.6049868, 'f1': 0.6495501, 'auroc': 0.94996667, 'binary_precision': 0.5942623, 'binary_recall': 0.2154532, 'binary_specificity': 0.9945204, 'binary_f1_score': 0.31624863}
confusion matrix:
       0    1
0  17968   99
1    528  145
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584273, 'precision': 0.7795029, 'recall': 0.5112021, 'specificity': 0.5112021, 'f1': 0.511598, 'auroc': 0.9293015, 'binary_precision': 0.6, 'binary_recall': 0.023076924, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.04444444}
confusion matrix:
      0  1
0  5942  4
1   254  6
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316521_5.png
early stop counter: 1
val acc:0.9665421843528748, best validation acc: 0.967129111289978, corresponding to test acc:                         0.9614889025688171 / 0.9629390835762024
after epoch: 5,now: 2024-06-14 08:34:18.751955,epoch time: 0:26:35.654359,used: 2:14:26.778052,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_06_19_51_seed_1_21316521
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9698103, 'precision': 0.7641038, 'recall': 0.73853713, 'specificity': 0.73853713, 'f1': 0.7506033, 'auroc': 0.9469423, 'binary_precision': 0.54545456, 'binary_recall': 0.49098474, 'binary_specificity': 0.9860895, 'binary_f1_score': 0.5167883}
confusion matrix:
       0    1
0  41824  590
1    734  708
---- Validation: 
scalar performance:
{'acc': 0.96792954, 'precision': 0.77056557, 'recall': 0.7437529, 'specificity': 0.7437529, 'f1': 0.7563824, 'auroc': 0.95268434, 'binary_precision': 0.5596027, 'binary_recall': 0.5022288, 'binary_specificity': 0.985277, 'binary_f1_score': 0.52936566}
confusion matrix:
       0    1
0  17801  266
1    335  338
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597164, 'precision': 0.77776575, 'recall': 0.5596885, 'specificity': 0.5596885, 'f1': 0.59157854, 'auroc': 0.93156856, 'binary_precision': 0.5925926, 'binary_recall': 0.12307692, 'binary_specificity': 0.99630004, 'binary_f1_score': 0.20382166}
confusion matrix:
      0   1
0  5924  22
1   228  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316521_6.png
better model found
persisted
after epoch: 6,now: 2024-06-14 09:00:42.688584,epoch time: 0:26:23.936629,used: 2:40:50.714681,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_06_19_51_seed_1_21316521
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96937704, 'precision': 0.7590749, 'recall': 0.7641045, 'specificity': 0.7641045, 'f1': 0.7615629, 'auroc': 0.9495735, 'binary_precision': 0.5336506, 'binary_recall': 0.5443828, 'binary_specificity': 0.9838261, 'binary_f1_score': 0.53896326}
confusion matrix:
       0    1
0  41728  686
1    657  785
---- Validation: 
scalar performance:
{'acc': 0.96835643, 'precision': 0.7718588, 'recall': 0.7675781, 'specificity': 0.7675781, 'f1': 0.7696995, 'auroc': 0.9532491, 'binary_precision': 0.56042296, 'binary_recall': 0.551263, 'binary_specificity': 0.9838933, 'binary_f1_score': 0.5558052}
confusion matrix:
       0    1
0  17776  291
1    302  371
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587496, 'precision': 0.75266445, 'recall': 0.546311, 'specificity': 0.546311, 'f1': 0.5711261, 'auroc': 0.9301004, 'binary_precision': 0.54347825, 'binary_recall': 0.09615385, 'binary_specificity': 0.9964682, 'binary_f1_score': 0.1633987}
confusion matrix:
      0   1
0  5925  21
1   235  25
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316521_7.png
better model found
persisted
after epoch: 7,now: 2024-06-14 09:27:00.702375,epoch time: 0:26:18.013791,used: 3:07:08.728472,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_06_19_51_seed_1_21316521
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97042596, 'precision': 0.8196974, 'recall': 0.5991804, 'specificity': 0.5991804, 'f1': 0.64731425, 'auroc': 0.94858164, 'binary_precision': 0.66590387, 'binary_recall': 0.20180306, 'binary_specificity': 0.9965577, 'binary_f1_score': 0.30973926}
confusion matrix:
       0    1
0  42268  146
1   1151  291
---- Validation: 
scalar performance:
{'acc': 0.9657951, 'precision': 0.7870032, 'recall': 0.56669015, 'specificity': 0.56669015, 'f1': 0.60277146, 'auroc': 0.9517541, 'binary_precision': 0.6052632, 'binary_recall': 0.13670133, 'binary_specificity': 0.996679, 'binary_f1_score': 0.2230303}
confusion matrix:
       0   1
0  18007  60
1    581  92
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.72920024, 'recall': 0.50367796, 'specificity': 0.50367796, 'f1': 0.49687442, 'auroc': 0.92857754, 'binary_precision': 0.5, 'binary_recall': 0.0076923077, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.015151515}
confusion matrix:
      0  1
0  5944  2
1   258  2
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316521_8.png
early stop counter: 1
val acc:0.96579509973526, best validation acc: 0.9683564305305481, corresponding to test acc:                         0.9587495923042297 / 0.9629390835762024
after epoch: 8,now: 2024-06-14 09:53:28.834953,epoch time: 0:26:28.132578,used: 3:33:36.861050,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_06_19_51_seed_1_21316521
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.96933144, 'precision': 0.7599431, 'recall': 0.7310741, 'specificity': 0.7310741, 'f1': 0.74457216, 'auroc': 0.94739854, 'binary_precision': 0.53761756, 'binary_recall': 0.4760583, 'binary_specificity': 0.9860898, 'binary_f1_score': 0.5049687}
confusion matrix:
       0    1
0  41825  590
1    755  686
---- Validation: 
scalar performance:
{'acc': 0.9677161, 'precision': 0.76940846, 'recall': 0.73648953, 'specificity': 0.73648953, 'f1': 0.75175905, 'auroc': 0.95259917, 'binary_precision': 0.5578231, 'binary_recall': 0.48736998, 'binary_specificity': 0.9856091, 'binary_f1_score': 0.520222}
confusion matrix:
       0    1
0  17807  260
1    345  328
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9577828, 'precision': 0.6877489, 'recall': 0.50902677, 'specificity': 0.50902677, 'f1': 0.5075916, 'auroc': 0.9292325, 'binary_precision': 0.41666666, 'binary_recall': 0.01923077, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.036764707}
confusion matrix:
      0  1
0  5939  7
1   255  5
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316521_9.png
early stop counter: 2
val acc:0.9677160978317261, best validation acc: 0.9683564305305481, corresponding to test acc:                         0.9587495923042297 / 0.9629390835762024
after epoch: 9,now: 2024-06-14 10:20:15.224200,epoch time: 0:26:46.389247,used: 4:00:23.250297,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_06_19_51_seed_1_21316521
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9714064, 'precision': 0.7979114, 'recall': 0.66644895, 'specificity': 0.66644895, 'f1': 0.7120023, 'auroc': 0.94862247, 'binary_precision': 0.6179067, 'binary_recall': 0.34004164, 'binary_specificity': 0.9928563, 'binary_f1_score': 0.43867502}
confusion matrix:
       0    1
0  42112  303
1    951  490
---- Validation: 
scalar performance:
{'acc': 0.96798295, 'precision': 0.78840435, 'recall': 0.656518, 'specificity': 0.656518, 'f1': 0.70107144, 'auroc': 0.9524997, 'binary_precision': 0.60167134, 'binary_recall': 0.32095096, 'binary_specificity': 0.99208504, 'binary_f1_score': 0.41860464}
confusion matrix:
       0    1
0  17924  143
1    457  216
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9585885, 'precision': 0.79776216, 'recall': 0.5131252, 'specificity': 0.5131252, 'f1': 0.5152463, 'auroc': 0.9276694, 'binary_precision': 0.6363636, 'binary_recall': 0.026923077, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.05166052}
confusion matrix:
      0  1
0  5942  4
1   253  7
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316521_10.png
early stop counter: 3
val acc:0.9679829478263855, best validation acc: 0.9683564305305481, corresponding to test acc:                         0.9587495923042297 / 0.9629390835762024
after epoch: 10,now: 2024-06-14 10:47:17.814753,epoch time: 0:27:02.590553,used: 4:27:25.840850,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_06_19_51_seed_1_21316521
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
