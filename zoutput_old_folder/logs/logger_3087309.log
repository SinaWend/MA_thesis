Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0




!!!: not committed yet



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_21_13_20_seed_0_21504668

 Experiment start at: 2024-06-18 21:13:20.395255
before training, model accuracy: 0.31622418761253357
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9528908, 'precision': 0.9714519, 'recall': 0.75245094, 'specificity': 0.75245094, 'f1': 0.822104, 'auroc': 0.95581913, 'binary_precision': 0.9919893, 'binary_recall': 0.5053276, 'binary_specificity': 0.99957436, 'binary_f1_score': 0.66957045}
confusion matrix:
       0     1
0  42271    18
1   2182  2229
---- Validation: 
scalar performance:
{'acc': 0.9656769, 'precision': 0.6704642, 'recall': 0.50219506, 'specificity': 0.50219506, 'f1': 0.49587625, 'auroc': 0.56653863, 'binary_precision': 0.375, 'binary_recall': 0.00466563, 'binary_specificity': 0.9997245, 'binary_f1_score': 0.00921659}
confusion matrix:
       0  1
0  18144  5
1    640  3
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8839233, 'precision': 0.44222254, 'recall': 0.4996665, 'specificity': 0.4996665, 'f1': 0.46919283, 'auroc': 0.59918064, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.999333, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5993  4
1   783  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504668_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-18 22:09:39.747787,epoch time: 0:56:19.352532,used: 0:56:19.352532,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_21_13_20_seed_0_21504668
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9755032, 'precision': 0.9815633, 'recall': 0.8742107, 'specificity': 0.8742107, 'f1': 0.9195719, 'auroc': 0.9803504, 'binary_precision': 0.9886364, 'binary_recall': 0.74932003, 'binary_specificity': 0.9991014, 'binary_f1_score': 0.8525013}
confusion matrix:
       0     1
0  42250    38
1   1106  3306
---- Validation: 
scalar performance:
{'acc': 0.9665283, 'precision': 0.767419, 'recall': 0.545389, 'specificity': 0.545389, 'f1': 0.5715687, 'auroc': 0.6924424, 'binary_precision': 0.5660377, 'binary_recall': 0.0933126, 'binary_specificity': 0.99746543, 'binary_f1_score': 0.16021362}
confusion matrix:
       0   1
0  18103  46
1    583  60
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89174044, 'precision': 0.84405893, 'recall': 0.5407282, 'specificity': 0.5407282, 'f1': 0.5473012, 'auroc': 0.72848666, 'binary_precision': 0.79518074, 'binary_recall': 0.08429119, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.15242495}
confusion matrix:
      0   1
0  5980  17
1   717  66
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504668_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-18 22:59:03.434839,epoch time: 0:49:23.687052,used: 1:45:43.039584,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_21_13_20_seed_0_21504668
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9809208, 'precision': 0.9807818, 'recall': 0.9062321, 'specificity': 0.9062321, 'f1': 0.9396085, 'auroc': 0.9855547, 'binary_precision': 0.980617, 'binary_recall': 0.81414324, 'binary_specificity': 0.99832106, 'binary_f1_score': 0.8896594}
confusion matrix:
       0     1
0  42217    71
1    820  3592
---- Validation: 
scalar performance:
{'acc': 0.96695405, 'precision': 0.7708254, 'recall': 0.566611, 'specificity': 0.566611, 'f1': 0.60197353, 'auroc': 0.7144484, 'binary_precision': 0.5714286, 'binary_recall': 0.13685848, 'binary_specificity': 0.99636346, 'binary_f1_score': 0.22082812}
confusion matrix:
       0   1
0  18083  66
1    555  88
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8958702, 'precision': 0.85039485, 'recall': 0.56304973, 'specificity': 0.56304973, 'f1': 0.58418274, 'auroc': 0.7398342, 'binary_precision': 0.8031496, 'binary_recall': 0.1302682, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.22417583}
confusion matrix:
      0    1
0  5972   25
1   681  102
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504668_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-18 23:41:13.795028,epoch time: 0:42:10.360189,used: 2:27:53.399773,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_21_13_20_seed_0_21504668
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98349035, 'precision': 0.98222667, 'recall': 0.9200165, 'specificity': 0.9200165, 'f1': 0.9484461, 'auroc': 0.9896621, 'binary_precision': 0.98071843, 'binary_recall': 0.84175926, 'binary_specificity': 0.9982738, 'binary_f1_score': 0.9059412}
confusion matrix:
       0     1
0  42216    73
1    698  3713
---- Validation: 
scalar performance:
{'acc': 0.967433, 'precision': 0.77511585, 'recall': 0.58636034, 'specificity': 0.58636034, 'f1': 0.6273864, 'auroc': 0.75134706, 'binary_precision': 0.5786802, 'binary_recall': 0.17729394, 'binary_specificity': 0.9954268, 'binary_f1_score': 0.27142859}
confusion matrix:
       0    1
0  18066   83
1    529  114
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9044248, 'precision': 0.887132, 'recall': 0.5995316, 'specificity': 0.5995316, 'f1': 0.6388697, 'auroc': 0.77196056, 'binary_precision': 0.86885244, 'binary_recall': 0.20306513, 'binary_specificity': 0.995998, 'binary_f1_score': 0.32919255}
confusion matrix:
      0    1
0  5973   24
1   624  159
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504668_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-19 00:38:23.123727,epoch time: 0:57:09.328699,used: 3:25:02.728472,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_21_13_20_seed_0_21504668
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98415416, 'precision': 0.984159, 'recall': 0.92217565, 'specificity': 0.92217565, 'f1': 0.95052445, 'auroc': 0.99063575, 'binary_precision': 0.9841647, 'binary_recall': 0.84577, 'binary_specificity': 0.99858123, 'binary_f1_score': 0.90973413}
confusion matrix:
       0     1
0  42231    60
1    680  3729
---- Validation: 
scalar performance:
{'acc': 0.967433, 'precision': 0.78403705, 'recall': 0.5721093, 'specificity': 0.5721093, 'f1': 0.6101346, 'auroc': 0.7522348, 'binary_precision': 0.5974843, 'binary_recall': 0.14774494, 'binary_specificity': 0.9964736, 'binary_f1_score': 0.23690774}
confusion matrix:
       0   1
0  18085  64
1    548  95
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89896756, 'precision': 0.88002664, 'recall': 0.5731285, 'specificity': 0.5731285, 'f1': 0.60021794, 'auroc': 0.76146746, 'binary_precision': 0.8602941, 'binary_recall': 0.14942528, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.2546246}
confusion matrix:
      0    1
0  5978   19
1   666  117
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504668_5.png
early stop counter: 1
val acc:0.967432975769043, best validation acc: 0.967432975769043, corresponding to test acc:                         0.904424786567688 / 0.904424786567688
after epoch: 5,now: 2024-06-19 01:26:49.182031,epoch time: 0:48:26.058304,used: 4:13:28.786776,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_21_13_20_seed_0_21504668
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9867024, 'precision': 0.9808234, 'recall': 0.9402287, 'specificity': 0.9402287, 'f1': 0.9594046, 'auroc': 0.9910984, 'binary_precision': 0.9737303, 'binary_recall': 0.8829401, 'binary_specificity': 0.9975173, 'binary_f1_score': 0.92611545}
confusion matrix:
       0     1
0  42187   105
1    516  3892
---- Validation: 
scalar performance:
{'acc': 0.9661558, 'precision': 0.7432053, 'recall': 0.5946998, 'specificity': 0.5946998, 'f1': 0.6332261, 'auroc': 0.7781136, 'binary_precision': 0.51428574, 'binary_recall': 0.19595645, 'binary_specificity': 0.9934432, 'binary_f1_score': 0.2837838}
confusion matrix:
       0    1
0  18030  119
1    517  126
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9076696, 'precision': 0.87781364, 'recall': 0.61968726, 'specificity': 0.61968726, 'f1': 0.6651588, 'auroc': 0.7851174, 'binary_precision': 0.845815, 'binary_recall': 0.24521072, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.38019803}
confusion matrix:
      0    1
0  5962   35
1   591  192
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504668_6.png
new oracle model saved
early stop counter: 2
val acc:0.9661558270454407, best validation acc: 0.967432975769043, corresponding to test acc:                         0.904424786567688 / 0.9076696038246155
after epoch: 6,now: 2024-06-19 02:12:58.278820,epoch time: 0:46:09.096789,used: 4:59:37.883565,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_21_13_20_seed_0_21504668
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
