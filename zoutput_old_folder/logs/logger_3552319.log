Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0




!!!: not committed yet



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512114

 Experiment start at: 2024-06-19 23:10:44.333387
before training, model accuracy: 0.3103227913379669
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.94411385, 'precision': 0.96802986, 'recall': 0.70535254, 'specificity': 0.70535254, 'f1': 0.77578056, 'auroc': 0.9437783, 'binary_precision': 0.9939726, 'binary_recall': 0.4109651, 'binary_specificity': 0.99974, 'binary_f1_score': 0.58150345}
confusion matrix:
       0     1
0  42295    11
1   2600  1814
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.7329165, 'recall': 0.50075006, 'specificity': 0.50075006, 'f1': 0.49284685, 'auroc': 0.55180717, 'binary_precision': 0.5, 'binary_recall': 0.00155521, 'binary_specificity': 0.9999449, 'binary_f1_score': 0.0031007752}
confusion matrix:
       0  1
0  18148  1
1    642  1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579738, 'precision': 0.47914, 'recall': 0.49983326, 'specificity': 0.49983326, 'f1': 0.48926792, 'auroc': 0.5971817, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5995  2
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512114_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-19 23:28:49.952408,epoch time: 0:18:05.619021,used: 0:18:05.619021,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512114
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9691567, 'precision': 0.981038, 'recall': 0.83831954, 'specificity': 0.83831954, 'f1': 0.8944566, 'auroc': 0.9750587, 'binary_precision': 0.994672, 'binary_recall': 0.6770172, 'binary_specificity': 0.9996218, 'binary_f1_score': 0.8056641}
confusion matrix:
       0     1
0  42292    16
1   1425  2987
---- Validation: 
scalar performance:
{'acc': 0.9661558, 'precision': 0.78341955, 'recall': 0.515944, 'specificity': 0.515944, 'f1': 0.522357, 'auroc': 0.6402767, 'binary_precision': 0.6, 'binary_recall': 0.032659408, 'binary_specificity': 0.9992286, 'binary_f1_score': 0.0619469}
confusion matrix:
       0   1
0  18135  14
1    622  21
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.74451685, 'recall': 0.5165744, 'specificity': 0.5165744, 'f1': 0.52175146, 'auroc': 0.679477, 'binary_precision': 0.5294118, 'binary_recall': 0.03448276, 'binary_specificity': 0.998666, 'binary_f1_score': 0.0647482}
confusion matrix:
      0  1
0  5989  8
1   252  9
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512114_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-19 23:46:00.064901,epoch time: 0:17:10.112493,used: 0:35:15.731514,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512114
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97645545, 'precision': 0.9818744, 'recall': 0.87945473, 'specificity': 0.87945473, 'f1': 0.9231366, 'auroc': 0.98362595, 'binary_precision': 0.9882145, 'binary_recall': 0.75985503, 'binary_specificity': 0.9990545, 'binary_f1_score': 0.8591188}
confusion matrix:
       0     1
0  42266    40
1   1060  3354
---- Validation: 
scalar performance:
{'acc': 0.9664219, 'precision': 0.7612343, 'recall': 0.546834, 'specificity': 0.546834, 'f1': 0.5735526, 'auroc': 0.6978908, 'binary_precision': 0.5535714, 'binary_recall': 0.096423015, 'binary_specificity': 0.997245, 'binary_f1_score': 0.16423841}
confusion matrix:
       0   1
0  18099  50
1    581  62
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606903, 'precision': 0.82272446, 'recall': 0.552556, 'specificity': 0.552556, 'f1': 0.5826448, 'auroc': 0.7242753, 'binary_precision': 0.68292683, 'binary_recall': 0.107279696, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.18543045}
confusion matrix:
      0   1
0  5984  13
1   233  28
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512114_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-20 00:04:41.627173,epoch time: 0:18:41.562272,used: 0:53:57.293786,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512114
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98032963, 'precision': 0.9797921, 'recall': 0.90358853, 'specificity': 0.90358853, 'f1': 0.93760127, 'auroc': 0.98602664, 'binary_precision': 0.97915524, 'binary_recall': 0.8089735, 'binary_specificity': 0.99820364, 'binary_f1_score': 0.885966}
confusion matrix:
       0     1
0  42231    76
1    843  3570
---- Validation: 
scalar performance:
{'acc': 0.96647507, 'precision': 0.75701094, 'recall': 0.5603626, 'specificity': 0.5603626, 'f1': 0.59270465, 'auroc': 0.73919296, 'binary_precision': 0.5442177, 'binary_recall': 0.1244168, 'binary_specificity': 0.9963083, 'binary_f1_score': 0.20253165}
confusion matrix:
       0   1
0  18082  67
1    563  80
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.8122984, 'recall': 0.56929713, 'specificity': 0.56929713, 'f1': 0.6067594, 'auroc': 0.75996363, 'binary_precision': 0.66071427, 'binary_recall': 0.14176245, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.23343849}
confusion matrix:
      0   1
0  5978  19
1   224  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512114_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-20 00:21:57.347174,epoch time: 0:17:15.720001,used: 1:11:13.013787,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512114
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9832192, 'precision': 0.9820554, 'recall': 0.91859806, 'specificity': 0.91859806, 'f1': 0.9475385, 'auroc': 0.98916984, 'binary_precision': 0.98066735, 'binary_recall': 0.8389216, 'binary_specificity': 0.9982745, 'binary_f1_score': 0.9042735}
confusion matrix:
       0     1
0  42233    73
1    711  3703
---- Validation: 
scalar performance:
{'acc': 0.9669008, 'precision': 0.76568437, 'recall': 0.57333386, 'specificity': 0.57333386, 'f1': 0.6104141, 'auroc': 0.74961066, 'binary_precision': 0.5606936, 'binary_recall': 0.15085536, 'binary_specificity': 0.9958124, 'binary_f1_score': 0.23774509}
confusion matrix:
       0   1
0  18073  76
1    546  97
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96244806, 'precision': 0.8256464, 'recall': 0.5901198, 'specificity': 0.5901198, 'f1': 0.63537216, 'auroc': 0.77052766, 'binary_precision': 0.6857143, 'binary_recall': 0.18390805, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.2900302}
confusion matrix:
      0   1
0  5975  22
1   213  48
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512114_5.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-06-20 00:40:38.498992,epoch time: 0:18:41.151818,used: 1:29:54.165605,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512114
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98514557, 'precision': 0.98106205, 'recall': 0.930745, 'specificity': 0.930745, 'f1': 0.954167, 'auroc': 0.9907794, 'binary_precision': 0.97615993, 'binary_recall': 0.86368793, 'binary_specificity': 0.997802, 'binary_f1_score': 0.9164862}
confusion matrix:
       0     1
0  42218    93
1    601  3808
---- Validation: 
scalar performance:
{'acc': 0.96706045, 'precision': 0.764922, 'recall': 0.5869175, 'specificity': 0.5869175, 'f1': 0.6270283, 'auroc': 0.7684588, 'binary_precision': 0.55825245, 'binary_recall': 0.17884915, 'binary_specificity': 0.99498594, 'binary_f1_score': 0.27090696}
confusion matrix:
       0    1
0  18058   91
1    528  115
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96196866, 'precision': 0.81154805, 'recall': 0.5898696, 'specificity': 0.5898696, 'f1': 0.6339441, 'auroc': 0.7765057, 'binary_precision': 0.65753424, 'binary_recall': 0.18390805, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.28742516}
confusion matrix:
      0   1
0  5972  25
1   213  48
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512114_6.png
better model found
persisted
after epoch: 6,now: 2024-06-20 00:56:38.605457,epoch time: 0:16:00.106465,used: 1:45:54.272070,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512114
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98660105, 'precision': 0.9815204, 'recall': 0.93901855, 'specificity': 0.93901855, 'f1': 0.9590399, 'auroc': 0.9919138, 'binary_precision': 0.97539544, 'binary_recall': 0.8803535, 'binary_specificity': 0.9976836, 'binary_f1_score': 0.9254407}
confusion matrix:
       0     1
0  42209    98
1    528  3885
---- Validation: 
scalar performance:
{'acc': 0.9663687, 'precision': 0.7472755, 'recall': 0.5970602, 'specificity': 0.5970602, 'f1': 0.63633204, 'auroc': 0.78307104, 'binary_precision': 0.5222672, 'binary_recall': 0.20062208, 'binary_specificity': 0.99349827, 'binary_f1_score': 0.28988764}
confusion matrix:
       0    1
0  18031  118
1    514  129
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.8170396, 'recall': 0.6124413, 'specificity': 0.6124413, 'f1': 0.66144574, 'auroc': 0.7902911, 'binary_precision': 0.6666667, 'binary_recall': 0.22988506, 'binary_specificity': 0.9949975, 'binary_f1_score': 0.34188035}
confusion matrix:
      0   1
0  5967  30
1   201  60
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512114_7.png
new oracle model saved
early stop counter: 1
val acc:0.9663686752319336, best validation acc: 0.9670604467391968, corresponding to test acc:                         0.9619686603546143 / 0.963087260723114
after epoch: 7,now: 2024-06-20 01:15:32.942881,epoch time: 0:18:54.337424,used: 2:04:48.609494,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512114
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9861087, 'precision': 0.9806449, 'recall': 0.936934, 'specificity': 0.936934, 'f1': 0.9574847, 'auroc': 0.99247277, 'binary_precision': 0.97406197, 'binary_recall': 0.87630266, 'binary_specificity': 0.9975653, 'binary_f1_score': 0.92259985}
confusion matrix:
       0     1
0  42203   103
1    546  3868
---- Validation: 
scalar performance:
{'acc': 0.9662622, 'precision': 0.74537456, 'recall': 0.59400487, 'specificity': 0.59400487, 'f1': 0.6327651, 'auroc': 0.7872163, 'binary_precision': 0.5186722, 'binary_recall': 0.19440125, 'binary_specificity': 0.9936085, 'binary_f1_score': 0.28280544}
confusion matrix:
       0    1
0  18033  116
1    518  125
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96196866, 'precision': 0.7918444, 'recall': 0.61368996, 'specificity': 0.61368996, 'f1': 0.65965503, 'auroc': 0.7883693, 'binary_precision': 0.61616164, 'binary_recall': 0.23371647, 'binary_specificity': 0.9936635, 'binary_f1_score': 0.33888888}
confusion matrix:
      0   1
0  5959  38
1   200  61
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512114_8.png
early stop counter: 2
val acc:0.9662622213363647, best validation acc: 0.9670604467391968, corresponding to test acc:                         0.9619686603546143 / 0.963087260723114
after epoch: 8,now: 2024-06-20 01:29:44.885096,epoch time: 0:14:11.942215,used: 2:19:00.551709,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512114
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98707193, 'precision': 0.98108476, 'recall': 0.9421832, 'specificity': 0.9421832, 'f1': 0.9606062, 'auroc': 0.99424994, 'binary_precision': 0.9738546, 'binary_recall': 0.8868481, 'binary_specificity': 0.9975183, 'binary_f1_score': 0.9283171}
confusion matrix:
       0     1
0  42205   105
1    499  3911
---- Validation: 
scalar performance:
{'acc': 0.96695405, 'precision': 0.76094663, 'recall': 0.5913628, 'specificity': 0.5913628, 'f1': 0.63175297, 'auroc': 0.7935649, 'binary_precision': 0.55, 'binary_recall': 0.1881804, 'binary_specificity': 0.99454516, 'binary_f1_score': 0.28041717}
confusion matrix:
       0    1
0  18050   99
1    522  121
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96340686, 'precision': 0.8246206, 'recall': 0.612608, 'specificity': 0.612608, 'f1': 0.6625091, 'auroc': 0.7914225, 'binary_precision': 0.6818182, 'binary_recall': 0.22988506, 'binary_specificity': 0.995331, 'binary_f1_score': 0.34383956}
confusion matrix:
      0   1
0  5969  28
1   201  60
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512114_9.png
new oracle model saved
early stop counter: 3
val acc:0.9669540524482727, best validation acc: 0.9670604467391968, corresponding to test acc:                         0.9619686603546143 / 0.9634068608283997
after epoch: 9,now: 2024-06-20 01:42:58.968021,epoch time: 0:13:14.082925,used: 2:32:14.634634,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512114
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9880351, 'precision': 0.9841053, 'recall': 0.9450997, 'specificity': 0.9450997, 'f1': 0.96357626, 'auroc': 0.9939634, 'binary_precision': 0.9793584, 'binary_recall': 0.8921613, 'binary_specificity': 0.9980381, 'binary_f1_score': 0.9337286}
confusion matrix:
       0     1
0  42223    83
1    476  3938
---- Validation: 
scalar performance:
{'acc': 0.9671137, 'precision': 0.7642802, 'recall': 0.5929455, 'specificity': 0.5929455, 'f1': 0.63394606, 'auroc': 0.7923213, 'binary_precision': 0.5565611, 'binary_recall': 0.19129083, 'binary_specificity': 0.99460024, 'binary_f1_score': 0.2847222}
confusion matrix:
       0    1
0  18051   98
1    520  123
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.7754388, 'recall': 0.5891193, 'specificity': 0.5891193, 'f1': 0.62979627, 'auroc': 0.7879361, 'binary_precision': 0.58536583, 'binary_recall': 0.18390805, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.27988338}
confusion matrix:
      0   1
0  5963  34
1   213  48
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512114_10.png
better model found
persisted
after epoch: 10,now: 2024-06-20 01:57:36.781874,epoch time: 0:14:37.813853,used: 2:46:52.448487,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512114
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98842037, 'precision': 0.9799546, 'recall': 0.9513892, 'specificity': 0.9513892, 'f1': 0.96512103, 'auroc': 0.99451864, 'binary_precision': 0.96967494, 'binary_recall': 0.90573305, 'binary_specificity': 0.9970454, 'binary_f1_score': 0.936614}
confusion matrix:
       0     1
0  42182   125
1    416  3997
---- Validation: 
scalar performance:
{'acc': 0.9665815, 'precision': 0.7506583, 'recall': 0.6046709, 'specificity': 0.6046709, 'f1': 0.6448606, 'auroc': 0.796515, 'binary_precision': 0.5285171, 'binary_recall': 0.21617419, 'binary_specificity': 0.99316764, 'binary_f1_score': 0.30684328}
confusion matrix:
       0    1
0  18025  124
1    504  139
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9613295, 'precision': 0.7807068, 'recall': 0.61152416, 'specificity': 0.61152416, 'f1': 0.6557903, 'auroc': 0.7860298, 'binary_precision': 0.5940594, 'binary_recall': 0.22988506, 'binary_specificity': 0.9931632, 'binary_f1_score': 0.33149174}
confusion matrix:
      0   1
0  5956  41
1   201  60
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512114_11.png
early stop counter: 1
val acc:0.9665815234184265, best validation acc: 0.9671136736869812, corresponding to test acc:                         0.9605305194854736 / 0.9634068608283997
after epoch: 11,now: 2024-06-20 02:08:49.895043,epoch time: 0:11:13.113169,used: 2:58:05.561656,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512114
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9890625, 'precision': 0.9841498, 'recall': 0.9511565, 'specificity': 0.9511565, 'f1': 0.96692264, 'auroc': 0.99443483, 'binary_precision': 0.978197, 'binary_recall': 0.90441674, 'binary_specificity': 0.99789625, 'binary_f1_score': 0.9398612}
confusion matrix:
       0     1
0  42216    89
1    422  3993
---- Validation: 
scalar performance:
{'acc': 0.9669008, 'precision': 0.7578306, 'recall': 0.59958583, 'specificity': 0.59958583, 'f1': 0.6405096, 'auroc': 0.8150524, 'binary_precision': 0.54320985, 'binary_recall': 0.20528771, 'binary_specificity': 0.99388397, 'binary_f1_score': 0.2979684}
confusion matrix:
       0    1
0  18038  111
1    511  132
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96180886, 'precision': 0.7932403, 'recall': 0.6062773, 'specificity': 0.6062773, 'f1': 0.6516482, 'auroc': 0.8108429, 'binary_precision': 0.6195652, 'binary_recall': 0.21839081, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.32294616}
confusion matrix:
      0   1
0  5962  35
1   204  57
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512114_12.png
early stop counter: 2
val acc:0.9669008255004883, best validation acc: 0.9671136736869812, corresponding to test acc:                         0.9605305194854736 / 0.9634068608283997
after epoch: 12,now: 2024-06-20 02:20:28.412585,epoch time: 0:11:38.517542,used: 3:09:44.079198,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512114
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98951197, 'precision': 0.9861392, 'recall': 0.9518798, 'specificity': 0.9518798, 'f1': 0.9682248, 'auroc': 0.9957191, 'binary_precision': 0.98205507, 'binary_recall': 0.90548503, 'binary_specificity': 0.99827456, 'binary_f1_score': 0.942217}
confusion matrix:
       0     1
0  42235    73
1    417  3995
---- Validation: 
scalar performance:
{'acc': 0.96706045, 'precision': 0.7639347, 'recall': 0.5899178, 'specificity': 0.5899178, 'f1': 0.63042945, 'auroc': 0.80019236, 'binary_precision': 0.55607474, 'binary_recall': 0.18506998, 'binary_specificity': 0.9947656, 'binary_f1_score': 0.27771294}
confusion matrix:
       0    1
0  18054   95
1    524  119
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589326, 'precision': 0.74586433, 'recall': 0.5699622, 'specificity': 0.5699622, 'f1': 0.60356665, 'auroc': 0.79322326, 'binary_precision': 0.5277778, 'binary_recall': 0.14559387, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.22822823}
confusion matrix:
      0   1
0  5963  34
1   223  38
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512114_13.png
early stop counter: 3
val acc:0.9670604467391968, best validation acc: 0.9671136736869812, corresponding to test acc:                         0.9605305194854736 / 0.9634068608283997
after epoch: 13,now: 2024-06-20 02:34:04.247044,epoch time: 0:13:35.834459,used: 3:23:19.913657,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512114
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9895976, 'precision': 0.9854536, 'recall': 0.9530645, 'specificity': 0.9530645, 'f1': 0.9685576, 'auroc': 0.99502385, 'binary_precision': 0.98043054, 'binary_recall': 0.90801996, 'binary_specificity': 0.99810904, 'binary_f1_score': 0.942837}
confusion matrix:
       0     1
0  42226    80
1    406  4008
---- Validation: 
scalar performance:
{'acc': 0.96706045, 'precision': 0.7646673, 'recall': 0.5876676, 'specificity': 0.5876676, 'f1': 0.62788457, 'auroc': 0.8063067, 'binary_precision': 0.5576923, 'binary_recall': 0.18040435, 'binary_specificity': 0.99493086, 'binary_f1_score': 0.27262044}
confusion matrix:
       0    1
0  18057   92
1    527  116
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9592522, 'precision': 0.75340986, 'recall': 0.5701289, 'specificity': 0.5701289, 'f1': 0.60433996, 'auroc': 0.7905501, 'binary_precision': 0.54285717, 'binary_recall': 0.14559387, 'binary_specificity': 0.994664, 'binary_f1_score': 0.22960725}
confusion matrix:
      0   1
0  5965  32
1   223  38
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512114_14.png
early stop counter: 4
val acc:0.9670604467391968, best validation acc: 0.9671136736869812, corresponding to test acc:                         0.9605305194854736 / 0.9634068608283997
after epoch: 14,now: 2024-06-20 02:49:57.181652,epoch time: 0:15:52.934608,used: 3:39:12.848265,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512114
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.990411, 'precision': 0.9844161, 'recall': 0.95886374, 'specificity': 0.95886374, 'f1': 0.9712048, 'auroc': 0.9955473, 'binary_precision': 0.977125, 'binary_recall': 0.9199728, 'binary_specificity': 0.99775463, 'binary_f1_score': 0.947688}
confusion matrix:
       0     1
0  42214    95
1    353  4058
---- Validation: 
scalar performance:
{'acc': 0.9662622, 'precision': 0.7461022, 'recall': 0.5850042, 'specificity': 0.5850042, 'f1': 0.6227634, 'auroc': 0.80450237, 'binary_precision': 0.52073735, 'binary_recall': 0.17573872, 'binary_specificity': 0.99426967, 'binary_f1_score': 0.26279068}
confusion matrix:
       0    1
0  18045  104
1    530  113
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.77479696, 'recall': 0.5631331, 'specificity': 0.5631331, 'f1': 0.5962936, 'auroc': 0.7852464, 'binary_precision': 0.5862069, 'binary_recall': 0.1302682, 'binary_specificity': 0.995998, 'binary_f1_score': 0.21316615}
confusion matrix:
      0   1
0  5973  24
1   227  34
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512114_15.png
early stop counter: 5
val acc:0.9662622213363647, best validation acc: 0.9671136736869812, corresponding to test acc:                         0.9605305194854736 / 0.9634068608283997
after epoch: 15,now: 2024-06-20 03:04:55.649525,epoch time: 0:14:58.467873,used: 3:54:11.316138,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512114
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9907962, 'precision': 0.9863417, 'recall': 0.9593065, 'specificity': 0.9593065, 'f1': 0.97233856, 'auroc': 0.9958224, 'binary_precision': 0.9809271, 'binary_recall': 0.9204803, 'binary_specificity': 0.99813265, 'binary_f1_score': 0.9497429}
confusion matrix:
       0     1
0  42227    79
1    351  4063
---- Validation: 
scalar performance:
{'acc': 0.9668476, 'precision': 0.7577859, 'recall': 0.5943079, 'specificity': 0.5943079, 'f1': 0.6346992, 'auroc': 0.8179742, 'binary_precision': 0.54347825, 'binary_recall': 0.19440125, 'binary_specificity': 0.99421453, 'binary_f1_score': 0.28636885}
confusion matrix:
       0    1
0  18044  105
1    518  125
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.7640205, 'recall': 0.5647987, 'specificity': 0.5647987, 'f1': 0.5979843, 'auroc': 0.7932497, 'binary_precision': 0.5645161, 'binary_recall': 0.13409962, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.21671826}
confusion matrix:
      0   1
0  5970  27
1   226  35
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512114_16.png
early stop counter: 6
val acc:0.9668475985527039, best validation acc: 0.9671136736869812, corresponding to test acc:                         0.9605305194854736 / 0.9634068608283997
after epoch: 16,now: 2024-06-20 03:21:28.654847,epoch time: 0:16:33.005322,used: 4:10:44.321460,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512114
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9911815, 'precision': 0.98514926, 'recall': 0.962774, 'specificity': 0.962774, 'f1': 0.9736295, 'auroc': 0.99549675, 'binary_precision': 0.977799, 'binary_recall': 0.9277463, 'binary_specificity': 0.99780166, 'binary_f1_score': 0.9521153}
confusion matrix:
       0     1
0  42212    93
1    319  4096
---- Validation: 
scalar performance:
{'acc': 0.9671137, 'precision': 0.7619997, 'recall': 0.60119617, 'specificity': 0.60119617, 'f1': 0.64282143, 'auroc': 0.8198918, 'binary_precision': 0.55144036, 'binary_recall': 0.20839813, 'binary_specificity': 0.9939942, 'binary_f1_score': 0.30248308}
confusion matrix:
       0    1
0  18040  109
1    509  134
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.7318888, 'recall': 0.56779635, 'specificity': 0.56779635, 'f1': 0.5997343, 'auroc': 0.79721534, 'binary_precision': 0.5, 'binary_recall': 0.14176245, 'binary_specificity': 0.99383026, 'binary_f1_score': 0.22089553}
confusion matrix:
      0   1
0  5960  37
1   224  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512114_17.png
early stop counter: 7
val acc:0.9671136736869812, best validation acc: 0.9671136736869812, corresponding to test acc:                         0.9605305194854736 / 0.9634068608283997
after epoch: 17,now: 2024-06-20 03:36:22.412374,epoch time: 0:14:53.757527,used: 4:25:38.078987,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512114
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9907962, 'precision': 0.98697114, 'recall': 0.95869774, 'specificity': 0.95869774, 'f1': 0.9723036, 'auroc': 0.9959554, 'binary_precision': 0.9823245, 'binary_recall': 0.91912097, 'binary_specificity': 0.9982745, 'binary_f1_score': 0.9496723}
confusion matrix:
       0     1
0  42233    73
1    357  4057
---- Validation: 
scalar performance:
{'acc': 0.9669008, 'precision': 0.7620486, 'recall': 0.58308464, 'specificity': 0.58308464, 'f1': 0.6221769, 'auroc': 0.8091219, 'binary_precision': 0.5527638, 'binary_recall': 0.1710731, 'binary_specificity': 0.99509615, 'binary_f1_score': 0.26128265}
confusion matrix:
       0    1
0  18060   89
1    533  110
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.7394076, 'recall': 0.5606338, 'specificity': 0.5606338, 'f1': 0.59091586, 'auroc': 0.79268885, 'binary_precision': 0.515625, 'binary_recall': 0.12643678, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.20307693}
confusion matrix:
      0   1
0  5966  31
1   228  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512114_18.png
early stop counter: 8
val acc:0.9669008255004883, best validation acc: 0.9671136736869812, corresponding to test acc:                         0.9605305194854736 / 0.9634068608283997
after epoch: 18,now: 2024-06-20 03:51:00.053537,epoch time: 0:14:37.641163,used: 4:40:15.720150,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512114
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99098885, 'precision': 0.98825693, 'recall': 0.9586012, 'specificity': 0.9586012, 'f1': 0.97284615, 'auroc': 0.9963825, 'binary_precision': 0.98494047, 'binary_recall': 0.91866785, 'binary_specificity': 0.9985345, 'binary_f1_score': 0.9506505}
confusion matrix:
       0     1
0  42244    62
1    359  4055
---- Validation: 
scalar performance:
{'acc': 0.96722007, 'precision': 0.7696669, 'recall': 0.58550006, 'specificity': 0.58550006, 'f1': 0.6258215, 'auroc': 0.81398743, 'binary_precision': 0.5678392, 'binary_recall': 0.17573872, 'binary_specificity': 0.99526143, 'binary_f1_score': 0.26840854}
confusion matrix:
       0    1
0  18063   86
1    530  113
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9592522, 'precision': 0.7582433, 'recall': 0.5573026, 'specificity': 0.5573026, 'f1': 0.5873401, 'auroc': 0.79563934, 'binary_precision': 0.5535714, 'binary_recall': 0.118773945, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.1955836}
confusion matrix:
      0   1
0  5972  25
1   230  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512114_19.png
better model found
persisted
after epoch: 19,now: 2024-06-20 04:03:11.121220,epoch time: 0:12:11.067683,used: 4:52:26.787833,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512114
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99098885, 'precision': 0.98532903, 'recall': 0.96145046, 'specificity': 0.96145046, 'f1': 0.97301114, 'auroc': 0.9963763, 'binary_precision': 0.97843796, 'binary_recall': 0.9250283, 'binary_specificity': 0.9978726, 'binary_f1_score': 0.9509839}
confusion matrix:
       0     1
0  42215    90
1    331  4084
---- Validation: 
scalar performance:
{'acc': 0.9673265, 'precision': 0.7668478, 'recall': 0.6005563, 'specificity': 0.6005563, 'f1': 0.6427722, 'auroc': 0.82385397, 'binary_precision': 0.5611814, 'binary_recall': 0.20684293, 'binary_specificity': 0.99426967, 'binary_f1_score': 0.30227274}
confusion matrix:
       0    1
0  18045  104
1    510  133
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.73166394, 'recall': 0.5622994, 'specificity': 0.5622994, 'f1': 0.59263533, 'auroc': 0.8007503, 'binary_precision': 0.5, 'binary_recall': 0.1302682, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.20668693}
confusion matrix:
      0   1
0  5963  34
1   227  34
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512114_20.png
better model found
persisted
after epoch: 20,now: 2024-06-20 04:14:20.317562,epoch time: 0:11:09.196342,used: 5:03:35.984175,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512114
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9921447, 'precision': 0.98866814, 'recall': 0.9650147, 'specificity': 0.9650147, 'f1': 0.97647285, 'auroc': 0.9968311, 'binary_precision': 0.98443484, 'binary_recall': 0.9315658, 'binary_specificity': 0.99846363, 'binary_f1_score': 0.9572709}
confusion matrix:
       0     1
0  42242    65
1    302  4111
---- Validation: 
scalar performance:
{'acc': 0.96722007, 'precision': 0.770312, 'recall': 0.584, 'specificity': 0.584, 'f1': 0.62407637, 'auroc': 0.8173393, 'binary_precision': 0.5692308, 'binary_recall': 0.1726283, 'binary_specificity': 0.99537164, 'binary_f1_score': 0.26491648}
confusion matrix:
       0    1
0  18065   84
1    532  111
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.74585617, 'recall': 0.54972315, 'specificity': 0.54972315, 'f1': 0.57596815, 'auroc': 0.7853237, 'binary_precision': 0.5294118, 'binary_recall': 0.10344828, 'binary_specificity': 0.995998, 'binary_f1_score': 0.17307694}
confusion matrix:
      0   1
0  5973  24
1   234  27
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512114_21.png
early stop counter: 1
val acc:0.9672200679779053, best validation acc: 0.9673265218734741, corresponding to test acc:                         0.9582933783531189 / 0.9634068608283997
after epoch: 21,now: 2024-06-20 04:25:18.373815,epoch time: 0:10:58.056253,used: 5:14:34.040428,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512114
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99188787, 'precision': 0.98592424, 'recall': 0.9661996, 'specificity': 0.9661996, 'f1': 0.9758048, 'auroc': 0.9964427, 'binary_precision': 0.9786477, 'binary_recall': 0.9345265, 'binary_specificity': 0.99787265, 'binary_f1_score': 0.9560784}
confusion matrix:
       0     1
0  42216    90
1    289  4125
---- Validation: 
scalar performance:
{'acc': 0.96663475, 'precision': 0.75194895, 'recall': 0.6024483, 'specificity': 0.6024483, 'f1': 0.64273345, 'auroc': 0.82319367, 'binary_precision': 0.53125, 'binary_recall': 0.21150856, 'binary_specificity': 0.99338806, 'binary_f1_score': 0.3025584}
confusion matrix:
       0    1
0  18029  120
1    507  136
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95717484, 'precision': 0.7075957, 'recall': 0.5598834, 'specificity': 0.5598834, 'f1': 0.5878025, 'auroc': 0.8032233, 'binary_precision': 0.4520548, 'binary_recall': 0.12643678, 'binary_specificity': 0.99333, 'binary_f1_score': 0.19760479}
confusion matrix:
      0   1
0  5957  40
1   228  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512114_22.png
early stop counter: 2
val acc:0.9666347503662109, best validation acc: 0.9673265218734741, corresponding to test acc:                         0.9582933783531189 / 0.9634068608283997
after epoch: 22,now: 2024-06-20 04:36:09.105874,epoch time: 0:10:50.732059,used: 5:25:24.772487,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512114
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9925086, 'precision': 0.9862375, 'recall': 0.96959263, 'specificity': 0.96959263, 'f1': 0.97773254, 'auroc': 0.99759644, 'binary_precision': 0.9785731, 'binary_recall': 0.94133633, 'binary_specificity': 0.9978489, 'binary_f1_score': 0.9595936}
confusion matrix:
       0     1
0  42214    91
1    259  4156
---- Validation: 
scalar performance:
{'acc': 0.96647507, 'precision': 0.7487993, 'recall': 0.6031157, 'specificity': 0.6031157, 'f1': 0.64296085, 'auroc': 0.8272402, 'binary_precision': 0.5249042, 'binary_recall': 0.21306376, 'binary_specificity': 0.99316764, 'binary_f1_score': 0.30309734}
confusion matrix:
       0    1
0  18025  124
1    506  137
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579738, 'precision': 0.72505116, 'recall': 0.56579727, 'specificity': 0.56579727, 'f1': 0.5966672, 'auroc': 0.80175704, 'binary_precision': 0.4864865, 'binary_recall': 0.13793103, 'binary_specificity': 0.9936635, 'binary_f1_score': 0.21492536}
confusion matrix:
      0   1
0  5959  38
1   225  36
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512114_23.png
early stop counter: 3
val acc:0.9664750695228577, best validation acc: 0.9673265218734741, corresponding to test acc:                         0.9582933783531189 / 0.9634068608283997
after epoch: 23,now: 2024-06-20 04:49:06.331780,epoch time: 0:12:57.225906,used: 5:38:21.998393,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512114
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99246573, 'precision': 0.990755, 'recall': 0.9648484, 'specificity': 0.9648484, 'f1': 0.977361, 'auroc': 0.996783, 'binary_precision': 0.9886747, 'binary_recall': 0.93080765, 'binary_specificity': 0.9988892, 'binary_f1_score': 0.9588689}
confusion matrix:
       0     1
0  42265    47
1    305  4103
---- Validation: 
scalar performance:
{'acc': 0.96722007, 'precision': 0.76583856, 'recall': 0.59600085, 'specificity': 0.59600085, 'f1': 0.63758785, 'auroc': 0.82909274, 'binary_precision': 0.55947137, 'binary_recall': 0.19751166, 'binary_specificity': 0.99449, 'binary_f1_score': 0.291954}
confusion matrix:
       0    1
0  18049  100
1    516  127
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.73999166, 'recall': 0.55513674, 'specificity': 0.55513674, 'f1': 0.58342654, 'auroc': 0.7995658, 'binary_precision': 0.51724136, 'binary_recall': 0.11494253, 'binary_specificity': 0.995331, 'binary_f1_score': 0.18808776}
confusion matrix:
      0   1
0  5969  28
1   231  30
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512114_24.png
early stop counter: 4
val acc:0.9672200679779053, best validation acc: 0.9673265218734741, corresponding to test acc:                         0.9582933783531189 / 0.9634068608283997
after epoch: 24,now: 2024-06-20 05:00:00.836362,epoch time: 0:10:54.504582,used: 5:49:16.502975,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512114
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.991738, 'precision': 0.9870583, 'recall': 0.9641892, 'specificity': 0.9641892, 'f1': 0.97527814, 'auroc': 0.9970542, 'binary_precision': 0.9813576, 'binary_recall': 0.93022203, 'binary_specificity': 0.9981563, 'binary_f1_score': 0.95510584}
confusion matrix:
       0     1
0  42228    78
1    308  4106
---- Validation: 
scalar performance:
{'acc': 0.9667944, 'precision': 0.75462735, 'recall': 0.6055312, 'specificity': 0.6055312, 'f1': 0.64636123, 'auroc': 0.8321471, 'binary_precision': 0.5363985, 'binary_recall': 0.21772939, 'binary_specificity': 0.993333, 'binary_f1_score': 0.30973452}
confusion matrix:
       0    1
0  18028  121
1    503  140
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95733464, 'precision': 0.7093628, 'recall': 0.55630213, 'specificity': 0.55630213, 'f1': 0.5832706, 'auroc': 0.80450493, 'binary_precision': 0.45588234, 'binary_recall': 0.118773945, 'binary_specificity': 0.99383026, 'binary_f1_score': 0.18844984}
confusion matrix:
      0   1
0  5960  37
1   230  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512114_25.png
early stop counter: 5
val acc:0.9667943716049194, best validation acc: 0.9673265218734741, corresponding to test acc:                         0.9582933783531189 / 0.9634068608283997
after epoch: 25,now: 2024-06-20 05:10:41.399141,epoch time: 0:10:40.562779,used: 5:59:57.065754,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512114
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99205905, 'precision': 0.9889264, 'recall': 0.96424913, 'specificity': 0.96424913, 'f1': 0.9761865, 'auroc': 0.9973488, 'binary_precision': 0.98511404, 'binary_recall': 0.9299637, 'binary_specificity': 0.99853456, 'binary_f1_score': 0.9567448}
confusion matrix:
       0     1
0  42246    62
1    309  4103
---- Validation: 
scalar performance:
{'acc': 0.96674114, 'precision': 0.75650954, 'recall': 0.5890024, 'specificity': 0.5890024, 'f1': 0.6285403, 'auroc': 0.8229723, 'binary_precision': 0.5412844, 'binary_recall': 0.18351477, 'binary_specificity': 0.99449, 'binary_f1_score': 0.2740999}
confusion matrix:
       0    1
0  18049  100
1    525  118
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.73609734, 'recall': 0.54589176, 'specificity': 0.54589176, 'f1': 0.5699946, 'auroc': 0.79981244, 'binary_precision': 0.5102041, 'binary_recall': 0.09578544, 'binary_specificity': 0.995998, 'binary_f1_score': 0.16129032}
confusion matrix:
      0   1
0  5973  24
1   236  25
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512114_26.png
early stop counter: 6
val acc:0.966741144657135, best validation acc: 0.9673265218734741, corresponding to test acc:                         0.9582933783531189 / 0.9634068608283997
after epoch: 26,now: 2024-06-20 05:21:18.609260,epoch time: 0:10:37.210119,used: 6:10:34.275873,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512114
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9922089, 'precision': 0.98726326, 'recall': 0.96678996, 'specificity': 0.96678996, 'f1': 0.97675025, 'auroc': 0.99635303, 'binary_precision': 0.9812307, 'binary_recall': 0.93544734, 'binary_specificity': 0.9981326, 'binary_f1_score': 0.9577922}
confusion matrix:
       0     1
0  42226    79
1    285  4130
---- Validation: 
scalar performance:
{'acc': 0.9665815, 'precision': 0.75200045, 'recall': 0.59417015, 'specificity': 0.59417015, 'f1': 0.6338145, 'auroc': 0.82573664, 'binary_precision': 0.5319149, 'binary_recall': 0.19440125, 'binary_specificity': 0.99393904, 'binary_f1_score': 0.28473803}
confusion matrix:
       0    1
0  18039  110
1    518  125
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579738, 'precision': 0.7239326, 'recall': 0.5584679, 'specificity': 0.5584679, 'f1': 0.58707094, 'auroc': 0.7981093, 'binary_precision': 0.4848485, 'binary_recall': 0.12260536, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.19571865}
confusion matrix:
      0   1
0  5963  34
1   229  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512114_27.png
early stop counter: 7
val acc:0.9665815234184265, best validation acc: 0.9673265218734741, corresponding to test acc:                         0.9582933783531189 / 0.9634068608283997
after epoch: 27,now: 2024-06-20 05:32:04.889375,epoch time: 0:10:46.280115,used: 6:21:20.555988,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512114
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9925728, 'precision': 0.9906163, 'recall': 0.9656646, 'specificity': 0.9656646, 'f1': 0.9777317, 'auroc': 0.99697274, 'binary_precision': 0.9882353, 'binary_recall': 0.93248755, 'binary_specificity': 0.99884176, 'binary_f1_score': 0.9595524}
confusion matrix:
       0     1
0  42257    49
1    298  4116
---- Validation: 
scalar performance:
{'acc': 0.96706045, 'precision': 0.76571965, 'recall': 0.5846674, 'specificity': 0.5846674, 'f1': 0.62443495, 'auroc': 0.8271632, 'binary_precision': 0.56, 'binary_recall': 0.17418352, 'binary_specificity': 0.9951512, 'binary_f1_score': 0.26571766}
confusion matrix:
       0    1
0  18061   88
1    531  112
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581336, 'precision': 0.7263467, 'recall': 0.5475573, 'specificity': 0.5475573, 'f1': 0.5720666, 'auroc': 0.8057158, 'binary_precision': 0.49056605, 'binary_recall': 0.099616855, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.16560508}
confusion matrix:
      0   1
0  5970  27
1   235  26
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512114_28.png
early stop counter: 8
val acc:0.9670604467391968, best validation acc: 0.9673265218734741, corresponding to test acc:                         0.9582933783531189 / 0.9634068608283997
after epoch: 28,now: 2024-06-20 05:43:04.457982,epoch time: 0:10:59.568607,used: 6:32:20.124595,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512114
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.992637, 'precision': 0.9892945, 'recall': 0.96733063, 'specificity': 0.96733063, 'f1': 0.97799563, 'auroc': 0.9969891, 'binary_precision': 0.9852205, 'binary_recall': 0.9361268, 'binary_specificity': 0.99853444, 'binary_f1_score': 0.9600464}
confusion matrix:
       0     1
0  42243    62
1    282  4133
---- Validation: 
scalar performance:
{'acc': 0.96674114, 'precision': 0.75370955, 'recall': 0.6047536, 'specificity': 0.6047536, 'f1': 0.64541197, 'auroc': 0.8327162, 'binary_precision': 0.5346154, 'binary_recall': 0.21617419, 'binary_specificity': 0.993333, 'binary_f1_score': 0.30786267}
confusion matrix:
       0    1
0  18028  121
1    504  139
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579738, 'precision': 0.7245152, 'recall': 0.5621326, 'specificity': 0.5621326, 'f1': 0.59192705, 'auroc': 0.80385804, 'binary_precision': 0.4857143, 'binary_recall': 0.1302682, 'binary_specificity': 0.993997, 'binary_f1_score': 0.20543806}
confusion matrix:
      0   1
0  5961  36
1   227  34
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512114_29.png
early stop counter: 9
val acc:0.966741144657135, best validation acc: 0.9673265218734741, corresponding to test acc:                         0.9582933783531189 / 0.9634068608283997
after epoch: 29,now: 2024-06-20 05:54:04.403260,epoch time: 0:10:59.945278,used: 6:43:20.069873,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512114
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99208045, 'precision': 0.98748064, 'recall': 0.9657761, 'specificity': 0.9657761, 'f1': 0.97631764, 'auroc': 0.9968775, 'binary_precision': 0.9818745, 'binary_recall': 0.9333484, 'binary_specificity': 0.9982037, 'binary_f1_score': 0.95699674}
confusion matrix:
       0     1
0  42233    76
1    294  4117
---- Validation: 
scalar performance:
{'acc': 0.9667944, 'precision': 0.75451446, 'recall': 0.6062812, 'specificity': 0.6062812, 'f1': 0.6471227, 'auroc': 0.84105015, 'binary_precision': 0.53612167, 'binary_recall': 0.21928461, 'binary_specificity': 0.99327785, 'binary_f1_score': 0.3112583}
confusion matrix:
       0    1
0  18027  122
1    502  141
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95685524, 'precision': 0.6965731, 'recall': 0.550555, 'specificity': 0.550555, 'f1': 0.5748149, 'auroc': 0.80309594, 'binary_precision': 0.43076923, 'binary_recall': 0.107279696, 'binary_specificity': 0.99383026, 'binary_f1_score': 0.17177914}
confusion matrix:
      0   1
0  5960  37
1   233  28
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512114_30.png
early stop counter: 10
val acc:0.9667943716049194, best validation acc: 0.9673265218734741, corresponding to test acc:                         0.9582933783531189 / 0.9634068608283997
after epoch: 30,now: 2024-06-20 06:06:11.134197,epoch time: 0:12:06.730937,used: 6:55:26.800810,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512114
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 6:55:26.800810 at 2024-06-20 06:06:11.134197
persisted model performance metric: 

scalar performance:
{'acc': 0.9582934, 'precision': 0.73166394, 'recall': 0.5622994, 'specificity': 0.5622994, 'f1': 0.59263533, 'auroc': 0.8007503, 'binary_precision': 0.5, 'binary_recall': 0.1302682, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.20668693}
confusion matrix:
      0   1
0  5963  34
1   227  34
oracle model performance metric: 

scalar performance:
{'acc': 0.96340686, 'precision': 0.8246206, 'recall': 0.612608, 'specificity': 0.612608, 'f1': 0.6625091, 'auroc': 0.7914225, 'binary_precision': 0.6818182, 'binary_recall': 0.22988506, 'binary_specificity': 0.995331, 'binary_f1_score': 0.34383956}
confusion matrix:
      0   1
0  5969  28
1   201  60
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_irm_resnet_different_bs128_lre4_classbalancing/rule_results/5.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_irm_resnet_different_bs128_lre4_classbalancing/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_irm_resnet_different_bs128_lre4_classbalancing/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204097 KiB |   1730 MiB | 413333 GiB | 413333 GiB |
|       from large pool | 167936 KiB |   1660 MiB | 413266 GiB | 413265 GiB |
|       from small pool |  36161 KiB |     72 MiB |     67 GiB |     67 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 204097 KiB |   1730 MiB | 413333 GiB | 413333 GiB |
|       from large pool | 167936 KiB |   1660 MiB | 413266 GiB | 413265 GiB |
|       from small pool |  36161 KiB |     72 MiB |     67 GiB |     67 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201088 KiB |   1723 MiB | 413317 GiB | 413317 GiB |
|       from large pool | 165120 KiB |   1653 MiB | 413251 GiB | 413251 GiB |
|       from small pool |  35968 KiB |     71 MiB |     66 GiB |     65 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2270 MiB |   2270 MiB |   2270 MiB |      0 B   |
|       from large pool |   2196 MiB |   2196 MiB |   2196 MiB |      0 B   |
|       from small pool |     74 MiB |     74 MiB |     74 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 404158 KiB | 758032 KiB | 304625 GiB | 304625 GiB |
|       from large pool | 397312 KiB | 756864 KiB | 304557 GiB | 304557 GiB |
|       from small pool |   6846 KiB |  12716 KiB |     68 GiB |     68 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1194    |    1851    |   10942 K  |   10941 K  |
|       from large pool |      36    |      76    |    4351 K  |    4351 K  |
|       from small pool |    1158    |    1780    |    6591 K  |    6590 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1194    |    1851    |   10942 K  |   10941 K  |
|       from large pool |      36    |      76    |    4351 K  |    4351 K  |
|       from small pool |    1158    |    1780    |    6591 K  |    6590 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      51    |      51    |      51    |       0    |
|       from large pool |      14    |      14    |      14    |       0    |
|       from small pool |      37    |      37    |      37    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      28    |     378    |    5439 K  |    5439 K  |
|       from large pool |       5    |      10    |    1382 K  |    1382 K  |
|       from small pool |      23    |     373    |    4056 K  |    4056 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1730 MiB | 413333 GiB | 413333 GiB |
|       from large pool |  16640 KiB |   1660 MiB | 413266 GiB | 413266 GiB |
|       from small pool |      0 KiB |     72 MiB |     67 GiB |     67 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1730 MiB | 413333 GiB | 413333 GiB |
|       from large pool |  16640 KiB |   1660 MiB | 413266 GiB | 413266 GiB |
|       from small pool |      0 KiB |     72 MiB |     67 GiB |     67 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1723 MiB | 413317 GiB | 413317 GiB |
|       from large pool |  16640 KiB |   1653 MiB | 413251 GiB | 413251 GiB |
|       from small pool |      0 KiB |     71 MiB |     66 GiB |     66 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 608256 KiB |   2270 MiB |   2270 MiB |   1676 MiB |
|       from large pool | 565248 KiB |   2196 MiB |   2196 MiB |   1644 MiB |
|       from small pool |  43008 KiB |     74 MiB |     74 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 384768 KiB | 758032 KiB | 304625 GiB | 304625 GiB |
|       from large pool | 384768 KiB | 756864 KiB | 304557 GiB | 304557 GiB |
|       from small pool |      0 KiB |  14441 KiB |     68 GiB |     68 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1851    |   10942 K  |   10942 K  |
|       from large pool |       2    |      76    |    4351 K  |    4351 K  |
|       from small pool |       0    |    1780    |    6591 K  |    6591 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1851    |   10942 K  |   10942 K  |
|       from large pool |       2    |      76    |    4351 K  |    4351 K  |
|       from small pool |       0    |    1780    |    6591 K  |    6591 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      30    |      51    |      51    |      21    |
|       from large pool |       9    |      14    |      14    |       5    |
|       from small pool |      21    |      37    |      37    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     378    |    5439 K  |    5439 K  |
|       from large pool |       1    |      11    |    1382 K  |    1382 K  |
|       from small pool |       0    |     373    |    4056 K  |    4056 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1730 MiB | 413333 GiB | 413333 GiB |
|       from large pool |  16640 KiB |   1660 MiB | 413266 GiB | 413266 GiB |
|       from small pool |      0 KiB |     72 MiB |     67 GiB |     67 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1730 MiB | 413333 GiB | 413333 GiB |
|       from large pool |  16640 KiB |   1660 MiB | 413266 GiB | 413266 GiB |
|       from small pool |      0 KiB |     72 MiB |     67 GiB |     67 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1723 MiB | 413317 GiB | 413317 GiB |
|       from large pool |  16640 KiB |   1653 MiB | 413251 GiB | 413251 GiB |
|       from small pool |      0 KiB |     71 MiB |     66 GiB |     66 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 608256 KiB |   2270 MiB |   2270 MiB |   1676 MiB |
|       from large pool | 565248 KiB |   2196 MiB |   2196 MiB |   1644 MiB |
|       from small pool |  43008 KiB |     74 MiB |     74 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 384768 KiB | 758032 KiB | 304625 GiB | 304625 GiB |
|       from large pool | 384768 KiB | 756864 KiB | 304557 GiB | 304557 GiB |
|       from small pool |      0 KiB |  14441 KiB |     68 GiB |     68 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1851    |   10942 K  |   10942 K  |
|       from large pool |       2    |      76    |    4351 K  |    4351 K  |
|       from small pool |       0    |    1780    |    6591 K  |    6591 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1851    |   10942 K  |   10942 K  |
|       from large pool |       2    |      76    |    4351 K  |    4351 K  |
|       from small pool |       0    |    1780    |    6591 K  |    6591 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      30    |      51    |      51    |      21    |
|       from large pool |       9    |      14    |      14    |       5    |
|       from small pool |      21    |      37    |      37    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     378    |    5439 K  |    5439 K  |
|       from large pool |       1    |      11    |    1382 K  |    1382 K  |
|       from small pool |       0    |     373    |    4056 K  |    4056 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0




!!!: not committed yet



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_06_10_52_seed_1_21512114

 Experiment start at: 2024-06-20 06:10:52.496586
before training, model accuracy: 0.14631003141403198
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9365154, 'precision': 0.9238094, 'recall': 0.6726532, 'specificity': 0.6726532, 'f1': 0.7352153, 'auroc': 0.9344202, 'binary_precision': 0.9101327, 'binary_recall': 0.34882107, 'binary_specificity': 0.99648535, 'binary_f1_score': 0.5043449}
confusion matrix:
       0     1
0  42245   149
1   2817  1509
---- Validation: 
scalar performance:
{'acc': 0.96360725, 'precision': 0.48203513, 'recall': 0.49975094, 'specificity': 0.49975094, 'f1': 0.4907332, 'auroc': 0.51762474, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9995019, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18058  9
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.52605486, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512114_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-20 06:21:38.461203,epoch time: 0:10:45.964617,used: 0:10:45.964617,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_06_10_52_seed_1_21512114
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96688783, 'precision': 0.97791624, 'recall': 0.823959, 'specificity': 0.823959, 'f1': 0.88295925, 'auroc': 0.9728975, 'binary_precision': 0.9904661, 'binary_recall': 0.6485549, 'binary_specificity': 0.9993631, 'binary_f1_score': 0.783848}
confusion matrix:
       0     1
0  42368    27
1   1520  2805
---- Validation: 
scalar performance:
{'acc': 0.9648346, 'precision': 0.85757804, 'recall': 0.51540804, 'specificity': 0.51540804, 'f1': 0.5209983, 'auroc': 0.63242954, 'binary_precision': 0.75, 'binary_recall': 0.031203566, 'binary_specificity': 0.99961257, 'binary_f1_score': 0.059914406}
confusion matrix:
       0   1
0  18060   7
1    652  21
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9574605, 'precision': 0.60418683, 'recall': 0.5033416, 'specificity': 0.5033416, 'f1': 0.49659312, 'auroc': 0.6869991, 'binary_precision': 0.25, 'binary_recall': 0.0076923077, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.014925373}
confusion matrix:
      0  1
0  5940  6
1   258  2
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512114_2.png
better model found
persisted
after epoch: 2,now: 2024-06-20 06:32:26.476358,epoch time: 0:10:48.015155,used: 0:21:33.979772,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_06_10_52_seed_1_21512114
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97814643, 'precision': 0.9800035, 'recall': 0.8882209, 'specificity': 0.8882209, 'f1': 0.9281293, 'auroc': 0.9823947, 'binary_precision': 0.9821794, 'binary_recall': 0.7778806, 'binary_specificity': 0.99856126, 'binary_f1_score': 0.868173}
confusion matrix:
       0     1
0  42337    61
1    960  3362
---- Validation: 
scalar performance:
{'acc': 0.96568835, 'precision': 0.7900882, 'recall': 0.55948216, 'specificity': 0.55948216, 'f1': 0.59284425, 'auroc': 0.70196795, 'binary_precision': 0.6119403, 'binary_recall': 0.121842496, 'binary_specificity': 0.9971218, 'binary_f1_score': 0.20322181}
confusion matrix:
       0   1
0  18015  52
1    591  82
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96003866, 'precision': 0.8142085, 'recall': 0.5451448, 'specificity': 0.5451448, 'f1': 0.5708467, 'auroc': 0.7476901, 'binary_precision': 0.6666667, 'binary_recall': 0.092307694, 'binary_specificity': 0.99798185, 'binary_f1_score': 0.16216217}
confusion matrix:
      0   1
0  5934  12
1   236  24
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512114_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-20 06:43:05.832268,epoch time: 0:10:39.355910,used: 0:32:13.335682,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_06_10_52_seed_1_21512114
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98030823, 'precision': 0.9815367, 'recall': 0.8998934, 'specificity': 0.8998934, 'f1': 0.9360416, 'auroc': 0.98604333, 'binary_precision': 0.9829835, 'binary_recall': 0.80120206, 'binary_specificity': 0.9985847, 'binary_f1_score': 0.8828324}
confusion matrix:
       0     1
0  42334    60
1    860  3466
---- Validation: 
scalar performance:
{'acc': 0.96627533, 'precision': 0.8014988, 'recall': 0.5705156, 'specificity': 0.5705156, 'f1': 0.6088123, 'auroc': 0.72275347, 'binary_precision': 0.63398695, 'binary_recall': 0.14413075, 'binary_specificity': 0.99690044, 'binary_f1_score': 0.23486681}
confusion matrix:
       0   1
0  18011  56
1    576  97
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96165, 'precision': 0.8512211, 'recall': 0.5643755, 'specificity': 0.5643755, 'f1': 0.6012813, 'auroc': 0.7519057, 'binary_precision': 0.73913044, 'binary_recall': 0.13076924, 'binary_specificity': 0.99798185, 'binary_f1_score': 0.22222224}
confusion matrix:
      0   1
0  5934  12
1   226  34
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512114_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-20 06:53:56.113508,epoch time: 0:10:50.281240,used: 0:43:03.616922,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_06_10_52_seed_1_21512114
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9838613, 'precision': 0.9817889, 'recall': 0.9208079, 'specificity': 0.9208079, 'f1': 0.9487412, 'auroc': 0.98995924, 'binary_precision': 0.9793233, 'binary_recall': 0.843432, 'binary_specificity': 0.9981838, 'binary_f1_score': 0.90631217}
confusion matrix:
       0     1
0  42319    77
1    677  3647
---- Validation: 
scalar performance:
{'acc': 0.9663287, 'precision': 0.79197574, 'recall': 0.58198756, 'specificity': 0.58198756, 'f1': 0.6232405, 'auroc': 0.7597176, 'binary_precision': 0.61413044, 'binary_recall': 0.1679049, 'binary_specificity': 0.9960702, 'binary_f1_score': 0.2637106}
confusion matrix:
       0    1
0  17996   71
1    560  113
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96310025, 'precision': 0.86386776, 'recall': 0.58536124, 'specificity': 0.58536124, 'f1': 0.6315975, 'auroc': 0.78451836, 'binary_precision': 0.7627119, 'binary_recall': 0.17307693, 'binary_specificity': 0.9976455, 'binary_f1_score': 0.28213164}
confusion matrix:
      0   1
0  5932  14
1   215  45
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512114_5.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-06-20 07:04:46.168985,epoch time: 0:10:50.055477,used: 0:53:53.672399,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_06_10_52_seed_1_21512114
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98465323, 'precision': 0.98185337, 'recall': 0.92551863, 'specificity': 0.92551863, 'f1': 0.9515128, 'auroc': 0.9893968, 'binary_precision': 0.9785146, 'binary_recall': 0.85294795, 'binary_specificity': 0.9980894, 'binary_f1_score': 0.9114268}
confusion matrix:
       0     1
0  42314    81
1    636  3689
---- Validation: 
scalar performance:
{'acc': 0.9663287, 'precision': 0.7876133, 'recall': 0.58770967, 'specificity': 0.58770967, 'f1': 0.62998396, 'auroc': 0.76903665, 'binary_precision': 0.605, 'binary_recall': 0.17979197, 'binary_specificity': 0.9956274, 'binary_f1_score': 0.27720505}
confusion matrix:
       0    1
0  17988   79
1    552  121
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96471155, 'precision': 0.870193, 'recall': 0.6101089, 'specificity': 0.6101089, 'f1': 0.6640675, 'auroc': 0.78843933, 'binary_precision': 0.7733333, 'binary_recall': 0.22307692, 'binary_specificity': 0.99714094, 'binary_f1_score': 0.34626865}
confusion matrix:
      0   1
0  5929  17
1   202  58
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512114_6.png
new oracle model saved
early stop counter: 1
val acc:0.9663286805152893, best validation acc: 0.9663286805152893, corresponding to test acc:                         0.963100254535675 / 0.9647115468978882
after epoch: 6,now: 2024-06-20 07:15:27.578285,epoch time: 0:10:41.409300,used: 1:04:35.081699,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_06_10_52_seed_1_21512114
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98559505, 'precision': 0.97967184, 'recall': 0.93321586, 'specificity': 0.93321586, 'f1': 0.9549711, 'auroc': 0.992929, 'binary_precision': 0.9725744, 'binary_recall': 0.86893207, 'binary_specificity': 0.99749964, 'binary_f1_score': 0.9178367}
confusion matrix:
       0     1
0  42288   106
1    567  3759
---- Validation: 
scalar performance:
{'acc': 0.9659552, 'precision': 0.77487814, 'recall': 0.5925228, 'specificity': 0.5925228, 'f1': 0.6344576, 'auroc': 0.7819533, 'binary_precision': 0.57918555, 'binary_recall': 0.19019316, 'binary_specificity': 0.9948525, 'binary_f1_score': 0.28635347}
confusion matrix:
       0    1
0  17974   93
1    545  128
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9648727, 'precision': 0.85607994, 'recall': 0.62122697, 'specificity': 0.62122697, 'f1': 0.6759374, 'auroc': 0.81131613, 'binary_precision': 0.74418604, 'binary_recall': 0.24615385, 'binary_specificity': 0.99630004, 'binary_f1_score': 0.3699422}
confusion matrix:
      0   1
0  5924  22
1   196  64
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512114_7.png
new oracle model saved
early stop counter: 2
val acc:0.9659551978111267, best validation acc: 0.9663286805152893, corresponding to test acc:                         0.963100254535675 / 0.9648727178573608
after epoch: 7,now: 2024-06-20 07:26:52.889319,epoch time: 0:11:25.311034,used: 1:16:00.392733,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_06_10_52_seed_1_21512114
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98555225, 'precision': 0.9830194, 'recall': 0.92980707, 'specificity': 0.92980707, 'f1': 0.9544853, 'auroc': 0.991421, 'binary_precision': 0.9799947, 'binary_recall': 0.86140674, 'binary_specificity': 0.99820745, 'binary_f1_score': 0.9168821}
confusion matrix:
       0     1
0  42322    76
1    599  3723
---- Validation: 
scalar performance:
{'acc': 0.966809, 'precision': 0.80396336, 'recall': 0.5858129, 'specificity': 0.5858129, 'f1': 0.62903696, 'auroc': 0.771085, 'binary_precision': 0.6378378, 'binary_recall': 0.17533432, 'binary_specificity': 0.9962916, 'binary_f1_score': 0.27505827}
confusion matrix:
       0    1
0  18000   67
1    555  118
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96374476, 'precision': 0.8530686, 'recall': 0.60224843, 'specificity': 0.60224843, 'f1': 0.6528485, 'auroc': 0.78725064, 'binary_precision': 0.739726, 'binary_recall': 0.20769231, 'binary_specificity': 0.9968046, 'binary_f1_score': 0.3243243}
confusion matrix:
      0   1
0  5927  19
1   206  54
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512114_8.png
better model found
persisted
after epoch: 8,now: 2024-06-20 07:39:31.585014,epoch time: 0:12:38.695695,used: 1:28:39.088428,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_06_10_52_seed_1_21512114
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98779964, 'precision': 0.9835002, 'recall': 0.94290227, 'specificity': 0.94290227, 'f1': 0.9620925, 'auroc': 0.99264276, 'binary_precision': 0.97833294, 'binary_recall': 0.8878094, 'binary_specificity': 0.99799514, 'binary_f1_score': 0.93087566}
confusion matrix:
       0     1
0  42312    85
1    485  3838
---- Validation: 
scalar performance:
{'acc': 0.9670224, 'precision': 0.7962044, 'recall': 0.6023748, 'specificity': 0.6023748, 'f1': 0.6482194, 'auroc': 0.790079, 'binary_precision': 0.62114537, 'binary_recall': 0.20950966, 'binary_specificity': 0.9952399, 'binary_f1_score': 0.31333333}
confusion matrix:
       0    1
0  17981   86
1    532  141
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96406704, 'precision': 0.8356222, 'recall': 0.6208065, 'specificity': 0.6208065, 'f1': 0.67309153, 'auroc': 0.80586696, 'binary_precision': 0.7032967, 'binary_recall': 0.24615385, 'binary_specificity': 0.99545914, 'binary_f1_score': 0.36467236}
confusion matrix:
      0   1
0  5919  27
1   196  64
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512114_9.png
better model found
persisted
after epoch: 9,now: 2024-06-20 07:50:25.299472,epoch time: 0:10:53.714458,used: 1:39:32.802886,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_06_10_52_seed_1_21512114
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9883776, 'precision': 0.98356044, 'recall': 0.94634885, 'specificity': 0.94634885, 'f1': 0.964026, 'auroc': 0.99334127, 'binary_precision': 0.9777609, 'binary_recall': 0.89477336, 'binary_specificity': 0.9979243, 'binary_f1_score': 0.9344282}
confusion matrix:
       0     1
0  42308    88
1    455  3869
---- Validation: 
scalar performance:
{'acc': 0.96659553, 'precision': 0.79785013, 'recall': 0.584987, 'specificity': 0.584987, 'f1': 0.6274992, 'auroc': 0.7893423, 'binary_precision': 0.62566847, 'binary_recall': 0.17384844, 'binary_specificity': 0.9961255, 'binary_f1_score': 0.272093}
confusion matrix:
       0    1
0  17997   70
1    556  117
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621334, 'precision': 0.81411874, 'recall': 0.5958906, 'specificity': 0.5958906, 'f1': 0.6416045, 'auroc': 0.7949719, 'binary_precision': 0.66233766, 'binary_recall': 0.19615385, 'binary_specificity': 0.9956273, 'binary_f1_score': 0.30267063}
confusion matrix:
      0   1
0  5920  26
1   209  51
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512114_10.png
early stop counter: 1
val acc:0.9665955305099487, best validation acc: 0.9670224189758301, corresponding to test acc:                         0.9640670418739319 / 0.9648727178573608
after epoch: 10,now: 2024-06-20 08:00:55.887680,epoch time: 0:10:30.588208,used: 1:50:03.391094,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_06_10_52_seed_1_21512114
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9882491, 'precision': 0.9855766, 'recall': 0.9436821, 'specificity': 0.9436821, 'f1': 0.96345305, 'auroc': 0.99331367, 'binary_precision': 0.98236644, 'binary_recall': 0.88899165, 'binary_specificity': 0.9983725, 'binary_f1_score': 0.9333495}
confusion matrix:
       0     1
0  42327    69
1    480  3844
---- Validation: 
scalar performance:
{'acc': 0.96643543, 'precision': 0.7941026, 'recall': 0.58347344, 'specificity': 0.58347344, 'f1': 0.62528867, 'auroc': 0.79581475, 'binary_precision': 0.6182796, 'binary_recall': 0.17087667, 'binary_specificity': 0.9960702, 'binary_f1_score': 0.26775318}
confusion matrix:
       0    1
0  17996   71
1    558  115
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9618111, 'precision': 0.8265243, 'recall': 0.57917154, 'specificity': 0.57917154, 'f1': 0.62104046, 'auroc': 0.81170297, 'binary_precision': 0.6885246, 'binary_recall': 0.16153847, 'binary_specificity': 0.9968046, 'binary_f1_score': 0.26168224}
confusion matrix:
      0   1
0  5927  19
1   218  42
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512114_11.png
early stop counter: 2
val acc:0.966435432434082, best validation acc: 0.9670224189758301, corresponding to test acc:                         0.9640670418739319 / 0.9648727178573608
after epoch: 11,now: 2024-06-20 08:12:15.835417,epoch time: 0:11:19.947737,used: 2:01:23.338831,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_06_10_52_seed_1_21512114
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98872006, 'precision': 0.98206794, 'recall': 0.94987166, 'specificity': 0.94987166, 'f1': 0.96527517, 'auroc': 0.9956819, 'binary_precision': 0.97403896, 'binary_recall': 0.9021965, 'binary_specificity': 0.99754685, 'binary_f1_score': 0.9367423}
confusion matrix:
       0     1
0  42291   104
1    423  3902
---- Validation: 
scalar performance:
{'acc': 0.966809, 'precision': 0.8005558, 'recall': 0.58938926, 'specificity': 0.58938926, 'f1': 0.63321054, 'auroc': 0.7995805, 'binary_precision': 0.63076925, 'binary_recall': 0.18276374, 'binary_specificity': 0.99601483, 'binary_f1_score': 0.28341013}
confusion matrix:
       0    1
0  17995   72
1    550  123
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96165, 'precision': 0.8157438, 'recall': 0.5827654, 'specificity': 0.5827654, 'f1': 0.62512326, 'auroc': 0.7975261, 'binary_precision': 0.6666667, 'binary_recall': 0.16923077, 'binary_specificity': 0.99630004, 'binary_f1_score': 0.26993868}
confusion matrix:
      0   1
0  5924  22
1   216  44
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512114_12.png
early stop counter: 3
val acc:0.9668089747428894, best validation acc: 0.9670224189758301, corresponding to test acc:                         0.9640670418739319 / 0.9648727178573608
after epoch: 12,now: 2024-06-20 08:25:12.376160,epoch time: 0:12:56.540743,used: 2:14:19.879574,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_06_10_52_seed_1_21512114
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9883348, 'precision': 0.9848505, 'recall': 0.944859, 'specificity': 0.944859, 'f1': 0.9637829, 'auroc': 0.9940307, 'binary_precision': 0.9806616, 'binary_recall': 0.89151055, 'binary_specificity': 0.99820745, 'binary_f1_score': 0.9339634}
confusion matrix:
       0     1
0  42321    76
1    469  3854
---- Validation: 
scalar performance:
{'acc': 0.9663821, 'precision': 0.79491657, 'recall': 0.58058465, 'specificity': 0.58058465, 'f1': 0.6216817, 'auroc': 0.802245, 'binary_precision': 0.6201117, 'binary_recall': 0.16493313, 'binary_specificity': 0.9962362, 'binary_f1_score': 0.26056337}
confusion matrix:
       0    1
0  17999   68
1    562  111
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614889, 'precision': 0.8182462, 'recall': 0.57716435, 'specificity': 0.57716435, 'f1': 0.6178425, 'auroc': 0.80157363, 'binary_precision': 0.6721311, 'binary_recall': 0.15769231, 'binary_specificity': 0.9966364, 'binary_f1_score': 0.2554517}
confusion matrix:
      0   1
0  5926  20
1   219  41
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512114_13.png
early stop counter: 4
val acc:0.9663820862770081, best validation acc: 0.9670224189758301, corresponding to test acc:                         0.9640670418739319 / 0.9648727178573608
after epoch: 13,now: 2024-06-20 08:37:12.615584,epoch time: 0:12:00.239424,used: 2:26:20.118998,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_06_10_52_seed_1_21512114
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.989726, 'precision': 0.9848877, 'recall': 0.95318663, 'specificity': 0.95318663, 'f1': 0.9683686, 'auroc': 0.99523664, 'binary_precision': 0.9790471, 'binary_recall': 0.9083545, 'binary_specificity': 0.9980188, 'binary_f1_score': 0.9423769}
confusion matrix:
       0     1
0  42315    84
1    396  3925
---- Validation: 
scalar performance:
{'acc': 0.9670224, 'precision': 0.80716395, 'recall': 0.58949995, 'specificity': 0.58949995, 'f1': 0.63392216, 'auroc': 0.81130236, 'binary_precision': 0.6439791, 'binary_recall': 0.18276374, 'binary_specificity': 0.9962362, 'binary_f1_score': 0.2847222}
confusion matrix:
       0    1
0  17999   68
1    550  123
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614889, 'precision': 0.8274087, 'recall': 0.5716474, 'specificity': 0.5716474, 'f1': 0.61075646, 'auroc': 0.8093015, 'binary_precision': 0.6909091, 'binary_recall': 0.14615385, 'binary_specificity': 0.99714094, 'binary_f1_score': 0.24126984}
confusion matrix:
      0   1
0  5929  17
1   222  38
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512114_14.png
early stop counter: 5
val acc:0.9670224189758301, best validation acc: 0.9670224189758301, corresponding to test acc:                         0.9640670418739319 / 0.9648727178573608
after epoch: 14,now: 2024-06-20 08:48:31.876161,epoch time: 0:11:19.260577,used: 2:37:39.379575,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_06_10_52_seed_1_21512114
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98991865, 'precision': 0.97968835, 'recall': 0.9595639, 'specificity': 0.9595639, 'f1': 0.96935594, 'auroc': 0.9962547, 'binary_precision': 0.9672648, 'binary_recall': 0.92231214, 'binary_specificity': 0.9968157, 'binary_f1_score': 0.94425374}
confusion matrix:
       0     1
0  42260   135
1    336  3989
---- Validation: 
scalar performance:
{'acc': 0.9672892, 'precision': 0.7946628, 'recall': 0.6146727, 'specificity': 0.6146727, 'f1': 0.6616898, 'auroc': 0.8213316, 'binary_precision': 0.6171875, 'binary_recall': 0.23476969, 'binary_specificity': 0.99457574, 'binary_f1_score': 0.34015068}
confusion matrix:
       0    1
0  17969   98
1    515  158
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614889, 'precision': 0.79626787, 'recall': 0.5973932, 'specificity': 0.5973932, 'f1': 0.64170206, 'auroc': 0.81461567, 'binary_precision': 0.62650603, 'binary_recall': 0.2, 'binary_specificity': 0.9947864, 'binary_f1_score': 0.303207}
confusion matrix:
      0   1
0  5915  31
1   208  52
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512114_15.png
better model found
persisted
after epoch: 15,now: 2024-06-20 09:02:44.128120,epoch time: 0:14:12.251959,used: 2:51:51.631534,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_06_10_52_seed_1_21512114
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9904752, 'precision': 0.9866792, 'recall': 0.9559996, 'specificity': 0.9559996, 'f1': 0.97071624, 'auroc': 0.9946382, 'binary_precision': 0.982094, 'binary_recall': 0.91369736, 'binary_specificity': 0.9983018, 'binary_f1_score': 0.9466619}
confusion matrix:
       0     1
0  42326    72
1    373  3949
---- Validation: 
scalar performance:
{'acc': 0.9668623, 'precision': 0.79358876, 'recall': 0.60014594, 'specificity': 0.60014594, 'f1': 0.64535856, 'auroc': 0.82046235, 'binary_precision': 0.6160714, 'binary_recall': 0.205052, 'binary_specificity': 0.9952399, 'binary_f1_score': 0.30769232}
confusion matrix:
       0    1
0  17981   86
1    535  138
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621334, 'precision': 0.81841445, 'recall': 0.5922126, 'specificity': 0.5922126, 'f1': 0.6374195, 'auroc': 0.82803404, 'binary_precision': 0.6712329, 'binary_recall': 0.18846154, 'binary_specificity': 0.9959637, 'binary_f1_score': 0.29429433}
confusion matrix:
      0   1
0  5922  24
1   211  49
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512114_16.png
early stop counter: 1
val acc:0.9668623208999634, best validation acc: 0.9672892093658447, corresponding to test acc:                         0.9614889025688171 / 0.9648727178573608
after epoch: 16,now: 2024-06-20 09:17:39.376329,epoch time: 0:14:55.248209,used: 3:06:46.879743,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_06_10_52_seed_1_21512114
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9910745, 'precision': 0.9849385, 'recall': 0.9613167, 'specificity': 0.9613167, 'f1': 0.97275895, 'auroc': 0.9953338, 'binary_precision': 0.9775006, 'binary_recall': 0.9248033, 'binary_specificity': 0.9978301, 'binary_f1_score': 0.95042205}
confusion matrix:
       0     1
0  42306    92
1    325  3997
---- Validation: 
scalar performance:
{'acc': 0.96611524, 'precision': 0.773695, 'recall': 0.6040501, 'specificity': 0.6040501, 'f1': 0.6473279, 'auroc': 0.83001393, 'binary_precision': 0.576, 'binary_recall': 0.21396731, 'binary_specificity': 0.99413294, 'binary_f1_score': 0.312026}
confusion matrix:
       0    1
0  17961  106
1    529  144
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621334, 'precision': 0.8067838, 'recall': 0.6032465, 'specificity': 0.6032465, 'f1': 0.649683, 'auroc': 0.83126307, 'binary_precision': 0.64705884, 'binary_recall': 0.21153846, 'binary_specificity': 0.9949546, 'binary_f1_score': 0.3188406}
confusion matrix:
      0   1
0  5916  30
1   205  55
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512114_17.png
early stop counter: 2
val acc:0.9661152362823486, best validation acc: 0.9672892093658447, corresponding to test acc:                         0.9614889025688171 / 0.9648727178573608
after epoch: 17,now: 2024-06-20 09:29:52.992804,epoch time: 0:12:13.616475,used: 3:19:00.496218,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_06_10_52_seed_1_21512114
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99101025, 'precision': 0.9872466, 'recall': 0.958712, 'specificity': 0.958712, 'f1': 0.9724418, 'auroc': 0.99694145, 'binary_precision': 0.9826947, 'binary_recall': 0.91907513, 'binary_specificity': 0.99834883, 'binary_f1_score': 0.94982076}
confusion matrix:
       0     1
0  42325    70
1    350  3975
---- Validation: 
scalar performance:
{'acc': 0.9663287, 'precision': 0.78811824, 'recall': 0.5869944, 'specificity': 0.5869944, 'f1': 0.62915456, 'auroc': 0.8223333, 'binary_precision': 0.6060606, 'binary_recall': 0.17830609, 'binary_specificity': 0.9956827, 'binary_f1_score': 0.27554536}
confusion matrix:
       0    1
0  17989   78
1    553  120
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96100545, 'precision': 0.80953157, 'recall': 0.5713951, 'specificity': 0.5713951, 'f1': 0.6094919, 'auroc': 0.8092748, 'binary_precision': 0.6551724, 'binary_recall': 0.14615385, 'binary_specificity': 0.9966364, 'binary_f1_score': 0.23899372}
confusion matrix:
      0   1
0  5926  20
1   222  38
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512114_18.png
early stop counter: 3
val acc:0.9663286805152893, best validation acc: 0.9672892093658447, corresponding to test acc:                         0.9614889025688171 / 0.9648727178573608
after epoch: 18,now: 2024-06-20 09:45:21.011362,epoch time: 0:15:28.018558,used: 3:34:28.514776,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_06_10_52_seed_1_21512114
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99101025, 'precision': 0.9854284, 'recall': 0.96046793, 'specificity': 0.96046793, 'f1': 0.97253644, 'auroc': 0.99593544, 'binary_precision': 0.978666, 'binary_recall': 0.922988, 'binary_specificity': 0.99794793, 'binary_f1_score': 0.95001197}
confusion matrix:
       0     1
0  42309    87
1    333  3991
---- Validation: 
scalar performance:
{'acc': 0.96627533, 'precision': 0.7825506, 'recall': 0.5934041, 'specificity': 0.5934041, 'f1': 0.6363076, 'auroc': 0.8297782, 'binary_precision': 0.59447, 'binary_recall': 0.19167905, 'binary_specificity': 0.9951292, 'binary_f1_score': 0.2898876}
confusion matrix:
       0    1
0  17979   88
1    544  129
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590719, 'precision': 0.75333863, 'recall': 0.57038605, 'specificity': 0.57038605, 'f1': 0.60464, 'auroc': 0.8266713, 'binary_precision': 0.54285717, 'binary_recall': 0.14615385, 'binary_specificity': 0.99461824, 'binary_f1_score': 0.23030303}
confusion matrix:
      0   1
0  5914  32
1   222  38
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512114_19.png
early stop counter: 4
val acc:0.9662753343582153, best validation acc: 0.9672892093658447, corresponding to test acc:                         0.9614889025688171 / 0.9648727178573608
after epoch: 19,now: 2024-06-20 10:02:15.934376,epoch time: 0:16:54.923014,used: 3:51:23.437790,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_06_10_52_seed_1_21512114
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99124575, 'precision': 0.987179, 'recall': 0.9601733, 'specificity': 0.9601733, 'f1': 0.9731953, 'auroc': 0.99653316, 'binary_precision': 0.98225725, 'binary_recall': 0.9220449, 'binary_specificity': 0.99830174, 'binary_f1_score': 0.9511991}
confusion matrix:
       0     1
0  42325    72
1    337  3986
---- Validation: 
scalar performance:
{'acc': 0.9666489, 'precision': 0.80540246, 'recall': 0.57929254, 'specificity': 0.57929254, 'f1': 0.6207705, 'auroc': 0.8197815, 'binary_precision': 0.64117646, 'binary_recall': 0.16196136, 'binary_specificity': 0.9966237, 'binary_f1_score': 0.25860023}
confusion matrix:
       0    1
0  18006   61
1    564  109
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597164, 'precision': 0.7833272, 'recall': 0.5541715, 'specificity': 0.5541715, 'f1': 0.5838287, 'auroc': 0.8090237, 'binary_precision': 0.6041667, 'binary_recall': 0.11153846, 'binary_specificity': 0.9968046, 'binary_f1_score': 0.1883117}
confusion matrix:
      0   1
0  5927  19
1   231  29
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512114_20.png
early stop counter: 5
val acc:0.9666488766670227, best validation acc: 0.9672892093658447, corresponding to test acc:                         0.9614889025688171 / 0.9648727178573608
after epoch: 20,now: 2024-06-20 10:19:50.492469,epoch time: 0:17:34.558093,used: 4:08:57.995883,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_06_10_52_seed_1_21512114
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9918664, 'precision': 0.98704845, 'recall': 0.96404684, 'specificity': 0.96404684, 'f1': 0.97519994, 'auroc': 0.99649274, 'binary_precision': 0.98120576, 'binary_recall': 0.92990977, 'binary_specificity': 0.99818385, 'binary_f1_score': 0.9548694}
confusion matrix:
       0     1
0  42320    77
1    303  4020
---- Validation: 
scalar performance:
{'acc': 0.96616864, 'precision': 0.78600585, 'recall': 0.58333504, 'specificity': 0.58333504, 'f1': 0.6244444, 'auroc': 0.8256464, 'binary_precision': 0.60209423, 'binary_recall': 0.17087667, 'binary_specificity': 0.99579346, 'binary_f1_score': 0.26620367}
confusion matrix:
       0    1
0  17991   76
1    558  115
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96019983, 'precision': 0.7820062, 'recall': 0.57281363, 'specificity': 0.57281363, 'f1': 0.6097824, 'auroc': 0.809834, 'binary_precision': 0.6, 'binary_recall': 0.15, 'binary_specificity': 0.9956273, 'binary_f1_score': 0.24000001}
confusion matrix:
      0   1
0  5920  26
1   221  39
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512114_21.png
early stop counter: 6
val acc:0.9661686420440674, best validation acc: 0.9672892093658447, corresponding to test acc:                         0.9614889025688171 / 0.9648727178573608
after epoch: 21,now: 2024-06-20 10:37:04.859276,epoch time: 0:17:14.366807,used: 4:26:12.362690,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_06_10_52_seed_1_21512114
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.991524, 'precision': 0.9880079, 'recall': 0.96108013, 'specificity': 0.96108013, 'f1': 0.97406685, 'auroc': 0.99657756, 'binary_precision': 0.98375183, 'binary_recall': 0.9237171, 'binary_specificity': 0.9984432, 'binary_f1_score': 0.9527897}
confusion matrix:
       0     1
0  42328    66
1    330  3996
---- Validation: 
scalar performance:
{'acc': 0.96616864, 'precision': 0.7937208, 'recall': 0.5740366, 'specificity': 0.5740366, 'f1': 0.6130671, 'auroc': 0.82687247, 'binary_precision': 0.6181818, 'binary_recall': 0.15156017, 'binary_specificity': 0.996513, 'binary_f1_score': 0.24343674}
confusion matrix:
       0    1
0  18004   63
1    571  102
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590719, 'precision': 0.75653267, 'recall': 0.5611911, 'specificity': 0.5611911, 'f1': 0.5926222, 'auroc': 0.81236637, 'binary_precision': 0.55, 'binary_recall': 0.12692308, 'binary_specificity': 0.99545914, 'binary_f1_score': 0.20625001}
confusion matrix:
      0   1
0  5919  27
1   227  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512114_22.png
early stop counter: 7
val acc:0.9661686420440674, best validation acc: 0.9672892093658447, corresponding to test acc:                         0.9614889025688171 / 0.9648727178573608
after epoch: 22,now: 2024-06-20 10:55:05.949690,epoch time: 0:18:01.090414,used: 4:44:13.453104,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_06_10_52_seed_1_21512114
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99231595, 'precision': 0.98883015, 'recall': 0.96503735, 'specificity': 0.96503735, 'f1': 0.97656286, 'auroc': 0.9963216, 'binary_precision': 0.9846041, 'binary_recall': 0.9315607, 'binary_specificity': 0.998514, 'binary_f1_score': 0.9573482}
confusion matrix:
       0     1
0  42332    63
1    296  4029
---- Validation: 
scalar performance:
{'acc': 0.966222, 'precision': 0.785566, 'recall': 0.5862238, 'specificity': 0.5862238, 'f1': 0.62797916, 'auroc': 0.82426685, 'binary_precision': 0.6010101, 'binary_recall': 0.1768202, 'binary_specificity': 0.9956274, 'binary_f1_score': 0.27324912}
confusion matrix:
       0    1
0  17988   79
1    554  119
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9585885, 'precision': 0.7448589, 'recall': 0.55358285, 'specificity': 0.55358285, 'f1': 0.58144104, 'auroc': 0.7991018, 'binary_precision': 0.5272727, 'binary_recall': 0.11153846, 'binary_specificity': 0.9956273, 'binary_f1_score': 0.18412699}
confusion matrix:
      0   1
0  5920  26
1   231  29
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512114_23.png
early stop counter: 8
val acc:0.9662219882011414, best validation acc: 0.9672892093658447, corresponding to test acc:                         0.9614889025688171 / 0.9648727178573608
after epoch: 23,now: 2024-06-20 11:13:19.373971,epoch time: 0:18:13.424281,used: 5:02:26.877385,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_06_10_52_seed_1_21512114
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9921875, 'precision': 0.9872641, 'recall': 0.96580476, 'specificity': 0.96580476, 'f1': 0.9762323, 'auroc': 0.99690497, 'binary_precision': 0.98128796, 'binary_recall': 0.9334258, 'binary_specificity': 0.9981837, 'binary_f1_score': 0.9567587}
confusion matrix:
       0     1
0  42317    77
1    288  4038
---- Validation: 
scalar performance:
{'acc': 0.966809, 'precision': 0.79991734, 'recall': 0.5901045, 'specificity': 0.5901045, 'f1': 0.6340338, 'auroc': 0.83618313, 'binary_precision': 0.6294416, 'binary_recall': 0.18424962, 'binary_specificity': 0.99595946, 'binary_f1_score': 0.28505746}
confusion matrix:
       0    1
0  17994   73
1    549  124
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587496, 'precision': 0.7486174, 'recall': 0.557345, 'specificity': 0.557345, 'f1': 0.58690053, 'auroc': 0.81894433, 'binary_precision': 0.5344828, 'binary_recall': 0.11923077, 'binary_specificity': 0.99545914, 'binary_f1_score': 0.19496855}
confusion matrix:
      0   1
0  5919  27
1   229  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512114_24.png
early stop counter: 9
val acc:0.9668089747428894, best validation acc: 0.9672892093658447, corresponding to test acc:                         0.9614889025688171 / 0.9648727178573608
after epoch: 24,now: 2024-06-20 11:33:51.140202,epoch time: 0:20:31.766231,used: 5:22:58.643616,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_06_10_52_seed_1_21512114
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9929367, 'precision': 0.9890105, 'recall': 0.96859753, 'specificity': 0.96859753, 'f1': 0.97853196, 'auroc': 0.99715865, 'binary_precision': 0.98424244, 'binary_recall': 0.93872833, 'binary_specificity': 0.9984668, 'binary_f1_score': 0.96094674}
confusion matrix:
       0     1
0  42330    65
1    265  4060
---- Validation: 
scalar performance:
{'acc': 0.96723586, 'precision': 0.8023515, 'recall': 0.6017702, 'specificity': 0.6017702, 'f1': 0.6482084, 'auroc': 0.84288985, 'binary_precision': 0.6334842, 'binary_recall': 0.20802377, 'binary_specificity': 0.9955167, 'binary_f1_score': 0.3131991}
confusion matrix:
       0    1
0  17986   81
1    533  140
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9585885, 'precision': 0.7431376, 'recall': 0.5627778, 'specificity': 0.5627778, 'f1': 0.5939841, 'auroc': 0.8188149, 'binary_precision': 0.52307695, 'binary_recall': 0.13076924, 'binary_specificity': 0.9947864, 'binary_f1_score': 0.20923077}
confusion matrix:
      0   1
0  5915  31
1   226  34
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512114_25.png
early stop counter: 10
val acc:0.9672358632087708, best validation acc: 0.9672892093658447, corresponding to test acc:                         0.9614889025688171 / 0.9648727178573608
after epoch: 25,now: 2024-06-20 11:52:57.674260,epoch time: 0:19:06.534058,used: 5:42:05.177674,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_06_10_52_seed_1_21512114
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99201626, 'precision': 0.98831755, 'recall': 0.9637221, 'specificity': 0.9637221, 'f1': 0.9756229, 'auroc': 0.99698424, 'binary_precision': 0.9838354, 'binary_recall': 0.9290009, 'binary_specificity': 0.99844325, 'binary_f1_score': 0.9556322}
confusion matrix:
       0     1
0  42330    66
1    307  4017
---- Validation: 
scalar performance:
{'acc': 0.9663287, 'precision': 0.7951288, 'recall': 0.5784112, 'specificity': 0.5784112, 'f1': 0.61889637, 'auroc': 0.82779336, 'binary_precision': 0.62068963, 'binary_recall': 0.16047548, 'binary_specificity': 0.99634695, 'binary_f1_score': 0.2550177}
confusion matrix:
       0    1
0  18001   66
1    565  108
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587496, 'precision': 0.75266445, 'recall': 0.546311, 'specificity': 0.546311, 'f1': 0.5711261, 'auroc': 0.8006402, 'binary_precision': 0.54347825, 'binary_recall': 0.09615385, 'binary_specificity': 0.9964682, 'binary_f1_score': 0.1633987}
confusion matrix:
      0   1
0  5925  21
1   235  25
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512114_26.png
early stop counter: 11
val acc:0.9663286805152893, best validation acc: 0.9672892093658447, corresponding to test acc:                         0.9614889025688171 / 0.9648727178573608
after epoch: 26,now: 2024-06-20 12:13:46.043502,epoch time: 0:20:48.369242,used: 6:02:53.546916,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_06_10_52_seed_1_21512114
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9922089, 'precision': 0.98790616, 'recall': 0.9652742, 'specificity': 0.9652742, 'f1': 0.9762543, 'auroc': 0.99669355, 'binary_precision': 0.9826872, 'binary_recall': 0.932223, 'binary_specificity': 0.99832535, 'binary_f1_score': 0.95679015}
confusion matrix:
       0     1
0  42326    71
1    293  4030
---- Validation: 
scalar performance:
{'acc': 0.9670224, 'precision': 0.8011923, 'recall': 0.5959374, 'specificity': 0.5959374, 'f1': 0.64121675, 'auroc': 0.8455828, 'binary_precision': 0.6315789, 'binary_recall': 0.1961367, 'binary_specificity': 0.9957381, 'binary_f1_score': 0.2993197}
confusion matrix:
       0    1
0  17990   77
1    541  132
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582662, 'precision': 0.7354653, 'recall': 0.55709267, 'specificity': 0.55709267, 'f1': 0.58586276, 'auroc': 0.82503283, 'binary_precision': 0.5081967, 'binary_recall': 0.11923077, 'binary_specificity': 0.9949546, 'binary_f1_score': 0.19314642}
confusion matrix:
      0   1
0  5916  30
1   229  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512114_27.png
early stop counter: 12
val acc:0.9670224189758301, best validation acc: 0.9672892093658447, corresponding to test acc:                         0.9614889025688171 / 0.9648727178573608
after epoch: 27,now: 2024-06-20 12:32:34.427663,epoch time: 0:18:48.384161,used: 6:21:41.931077,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_06_10_52_seed_1_21512114
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9928082, 'precision': 0.9869386, 'recall': 0.9698831, 'specificity': 0.9698831, 'f1': 0.9782205, 'auroc': 0.9970768, 'binary_precision': 0.97979796, 'binary_recall': 0.94174755, 'binary_specificity': 0.99801856, 'binary_f1_score': 0.96039605}
confusion matrix:
       0     1
0  42310    84
1    252  4074
---- Validation: 
scalar performance:
{'acc': 0.9667556, 'precision': 0.7943357, 'recall': 0.5950838, 'specificity': 0.5950838, 'f1': 0.6395105, 'auroc': 0.84367704, 'binary_precision': 0.6179245, 'binary_recall': 0.19465081, 'binary_specificity': 0.9955167, 'binary_f1_score': 0.29604518}
confusion matrix:
       0    1
0  17986   81
1    542  131
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582662, 'precision': 0.7354653, 'recall': 0.55709267, 'specificity': 0.55709267, 'f1': 0.58586276, 'auroc': 0.82042664, 'binary_precision': 0.5081967, 'binary_recall': 0.11923077, 'binary_specificity': 0.9949546, 'binary_f1_score': 0.19314642}
confusion matrix:
      0   1
0  5916  30
1   229  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512114_28.png
early stop counter: 13
val acc:0.9667556285858154, best validation acc: 0.9672892093658447, corresponding to test acc:                         0.9614889025688171 / 0.9648727178573608
after epoch: 28,now: 2024-06-20 12:50:35.047879,epoch time: 0:18:00.620216,used: 6:39:42.551293,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_06_10_52_seed_1_21512114
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99272263, 'precision': 0.9882403, 'recall': 0.96806437, 'specificity': 0.96806437, 'f1': 0.9778861, 'auroc': 0.9968963, 'binary_precision': 0.9827962, 'binary_recall': 0.93780345, 'binary_specificity': 0.9983253, 'binary_f1_score': 0.95977277}
confusion matrix:
       0     1
0  42324    71
1    269  4056
---- Validation: 
scalar performance:
{'acc': 0.96643543, 'precision': 0.78455216, 'recall': 0.5970635, 'specificity': 0.5970635, 'f1': 0.64079, 'auroc': 0.85236514, 'binary_precision': 0.59821427, 'binary_recall': 0.19910847, 'binary_specificity': 0.99501854, 'binary_f1_score': 0.29877368}
confusion matrix:
       0    1
0  17977   90
1    539  134
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95762163, 'precision': 0.71890914, 'recall': 0.55307835, 'specificity': 0.55307835, 'f1': 0.5794668, 'auroc': 0.839479, 'binary_precision': 0.47540984, 'binary_recall': 0.11153846, 'binary_specificity': 0.99461824, 'binary_f1_score': 0.18068537}
confusion matrix:
      0   1
0  5914  32
1   231  29
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512114_29.png
early stop counter: 14
val acc:0.966435432434082, best validation acc: 0.9672892093658447, corresponding to test acc:                         0.9614889025688171 / 0.9648727178573608
after epoch: 29,now: 2024-06-20 13:08:39.588125,epoch time: 0:18:04.540246,used: 6:57:47.091539,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_06_10_52_seed_1_21512114
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9928938, 'precision': 0.989406, 'recall': 0.9679439, 'specificity': 0.9679439, 'f1': 0.9783742, 'auroc': 0.9975157, 'binary_precision': 0.98517257, 'binary_recall': 0.93732655, 'binary_specificity': 0.9985612, 'binary_f1_score': 0.96065414}
confusion matrix:
       0     1
0  42335    61
1    271  4053
---- Validation: 
scalar performance:
{'acc': 0.96734256, 'precision': 0.8064903, 'recall': 0.600395, 'specificity': 0.600395, 'f1': 0.64704293, 'auroc': 0.8463663, 'binary_precision': 0.6418605, 'binary_recall': 0.205052, 'binary_specificity': 0.9957381, 'binary_f1_score': 0.3108108}
confusion matrix:
       0    1
0  17990   77
1    535  138
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584273, 'precision': 0.74099416, 'recall': 0.54798186, 'specificity': 0.54798186, 'f1': 0.57321155, 'auroc': 0.8173332, 'binary_precision': 0.52, 'binary_recall': 0.1, 'binary_specificity': 0.9959637, 'binary_f1_score': 0.16774192}
confusion matrix:
      0   1
0  5922  24
1   234  26
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512114_30.png
better model found
persisted
after epoch: 30,now: 2024-06-20 13:28:43.064272,epoch time: 0:20:03.476147,used: 7:17:50.567686,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_06_10_52_seed_1_21512114
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 7:17:50.567686 at 2024-06-20 13:28:43.064272
persisted model performance metric: 

scalar performance:
{'acc': 0.9584273, 'precision': 0.74099416, 'recall': 0.54798186, 'specificity': 0.54798186, 'f1': 0.57321155, 'auroc': 0.8173332, 'binary_precision': 0.52, 'binary_recall': 0.1, 'binary_specificity': 0.9959637, 'binary_f1_score': 0.16774192}
confusion matrix:
      0   1
0  5922  24
1   234  26
oracle model performance metric: 

scalar performance:
{'acc': 0.9648727, 'precision': 0.85607994, 'recall': 0.62122697, 'specificity': 0.62122697, 'f1': 0.6759374, 'auroc': 0.81131613, 'binary_precision': 0.74418604, 'binary_recall': 0.24615385, 'binary_specificity': 0.99630004, 'binary_f1_score': 0.3699422}
confusion matrix:
      0   1
0  5924  22
1   196  64
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_irm_resnet_different_bs128_lre4_classbalancing/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_irm_resnet_different_bs128_lre4_classbalancing/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204094 KiB |   1730 MiB |    806 TiB |    806 TiB |
|       from large pool | 167936 KiB |   1660 MiB |    806 TiB |    806 TiB |
|       from small pool |  36158 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 204094 KiB |   1730 MiB |    806 TiB |    806 TiB |
|       from large pool | 167936 KiB |   1660 MiB |    806 TiB |    806 TiB |
|       from small pool |  36158 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201086 KiB |   1723 MiB |    806 TiB |    806 TiB |
|       from large pool | 165120 KiB |   1653 MiB |    806 TiB |    806 TiB |
|       from small pool |  35966 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2196 MiB |   2270 MiB |   3872 MiB |   1676 MiB |
|       from large pool |   2122 MiB |   2196 MiB |   3766 MiB |   1644 MiB |
|       from small pool |     74 MiB |     74 MiB |    106 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 404161 KiB |    900 MiB | 631645 GiB | 631644 GiB |
|       from large pool | 397312 KiB |    899 MiB | 631509 GiB | 631508 GiB |
|       from small pool |   6849 KiB |     14 MiB |    135 GiB |    135 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1194    |    1851    |   21884 K  |   21883 K  |
|       from large pool |      36    |      76    |    8702 K  |    8702 K  |
|       from small pool |    1158    |    1780    |   13182 K  |   13180 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1194    |    1851    |   21884 K  |   21883 K  |
|       from large pool |      36    |      76    |    8702 K  |    8702 K  |
|       from small pool |    1158    |    1780    |   13182 K  |   13180 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      50    |      51    |      71    |      21    |
|       from large pool |      13    |      14    |      18    |       5    |
|       from small pool |      37    |      37    |      53    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      34    |     380    |   11174 K  |   11174 K  |
|       from large pool |       5    |      11    |    2911 K  |    2911 K  |
|       from small pool |      29    |     375    |    8262 K  |    8262 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1730 MiB |    806 TiB |    806 TiB |
|       from large pool |  16640 KiB |   1660 MiB |    806 TiB |    806 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1730 MiB |    806 TiB |    806 TiB |
|       from large pool |  16640 KiB |   1660 MiB |    806 TiB |    806 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1723 MiB |    806 TiB |    806 TiB |
|       from large pool |  16640 KiB |   1653 MiB |    806 TiB |    806 TiB |
|       from small pool |      0 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 608256 KiB |   2270 MiB |   3872 MiB |   3278 MiB |
|       from large pool | 565248 KiB |   2196 MiB |   3766 MiB |   3214 MiB |
|       from small pool |  43008 KiB |     74 MiB |    106 MiB |     64 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 384768 KiB |    900 MiB | 631645 GiB | 631644 GiB |
|       from large pool | 384768 KiB |    899 MiB | 631509 GiB | 631508 GiB |
|       from small pool |      0 KiB |     14 MiB |    136 GiB |    136 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1851    |   21884 K  |   21884 K  |
|       from large pool |       2    |      76    |    8702 K  |    8702 K  |
|       from small pool |       0    |    1780    |   13182 K  |   13182 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1851    |   21884 K  |   21884 K  |
|       from large pool |       2    |      76    |    8702 K  |    8702 K  |
|       from small pool |       0    |    1780    |   13182 K  |   13182 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      30    |      51    |      71    |      41    |
|       from large pool |       9    |      14    |      18    |       9    |
|       from small pool |      21    |      37    |      53    |      32    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     380    |   11174 K  |   11174 K  |
|       from large pool |       1    |      11    |    2911 K  |    2911 K  |
|       from small pool |       0    |     375    |    8263 K  |    8263 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1730 MiB |    806 TiB |    806 TiB |
|       from large pool |  16640 KiB |   1660 MiB |    806 TiB |    806 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1730 MiB |    806 TiB |    806 TiB |
|       from large pool |  16640 KiB |   1660 MiB |    806 TiB |    806 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1723 MiB |    806 TiB |    806 TiB |
|       from large pool |  16640 KiB |   1653 MiB |    806 TiB |    806 TiB |
|       from small pool |      0 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 608256 KiB |   2270 MiB |   3872 MiB |   3278 MiB |
|       from large pool | 565248 KiB |   2196 MiB |   3766 MiB |   3214 MiB |
|       from small pool |  43008 KiB |     74 MiB |    106 MiB |     64 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 384768 KiB |    900 MiB | 631645 GiB | 631644 GiB |
|       from large pool | 384768 KiB |    899 MiB | 631509 GiB | 631508 GiB |
|       from small pool |      0 KiB |     14 MiB |    136 GiB |    136 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1851    |   21884 K  |   21884 K  |
|       from large pool |       2    |      76    |    8702 K  |    8702 K  |
|       from small pool |       0    |    1780    |   13182 K  |   13182 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1851    |   21884 K  |   21884 K  |
|       from large pool |       2    |      76    |    8702 K  |    8702 K  |
|       from small pool |       0    |    1780    |   13182 K  |   13182 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      30    |      51    |      71    |      41    |
|       from large pool |       9    |      14    |      18    |       9    |
|       from small pool |      21    |      37    |      53    |      32    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     380    |   11174 K  |   11174 K  |
|       from large pool |       1    |      11    |    2911 K  |    2911 K  |
|       from small pool |       0    |     375    |    8263 K  |    8263 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0




!!!: not committed yet



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_13_39_25_seed_2_21512114

 Experiment start at: 2024-06-20 13:39:25.404046
before training, model accuracy: 0.0544959120452404
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.941513, 'precision': 0.96511734, 'recall': 0.69984317, 'specificity': 0.69984317, 'f1': 0.7693082, 'auroc': 0.9432156, 'binary_precision': 0.9907256, 'binary_recall': 0.40008813, 'binary_specificity': 0.9995982, 'binary_f1_score': 0.56999373}
confusion matrix:
       0     1
0  42292    17
1   2723  1816
---- Validation: 
scalar performance:
{'acc': 0.9675598, 'precision': 0.48396036, 'recall': 0.4998074, 'specificity': 0.4998074, 'f1': 0.49175623, 'auroc': 0.5734022, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9996148, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18164  7
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96105146, 'precision': 0.48060277, 'recall': 0.4999166, 'specificity': 0.4999166, 'f1': 0.49006948, 'auroc': 0.61921096, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5996  1
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512114_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-20 13:57:16.792422,epoch time: 0:17:51.388376,used: 0:17:51.388376,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_13_39_25_seed_2_21512114
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9657616, 'precision': 0.9779664, 'recall': 0.8256309, 'specificity': 0.8256309, 'f1': 0.8840445, 'auroc': 0.9708842, 'binary_precision': 0.9919517, 'binary_recall': 0.651829, 'binary_specificity': 0.99943274, 'binary_f1_score': 0.78670216}
confusion matrix:
       0     1
0  42286    24
1   1580  2958
---- Validation: 
scalar performance:
{'acc': 0.9683588, 'precision': 0.78007734, 'recall': 0.5210994, 'specificity': 0.5210994, 'f1': 0.5321989, 'auroc': 0.6468412, 'binary_precision': 0.59090906, 'binary_recall': 0.04318937, 'binary_specificity': 0.99900943, 'binary_f1_score': 0.08049536}
confusion matrix:
       0   1
0  18153  18
1    576  26
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9604103, 'precision': 0.6476275, 'recall': 0.5094968, 'specificity': 0.5094968, 'f1': 0.50934964, 'auroc': 0.683494, 'binary_precision': 0.33333334, 'binary_recall': 0.020661157, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.038910504}
confusion matrix:
      0   1
0  5987  10
1   237   5
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512114_2.png
better model found
persisted
after epoch: 2,now: 2024-06-20 14:17:46.201903,epoch time: 0:20:29.409481,used: 0:38:20.797857,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_13_39_25_seed_2_21512114
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97664785, 'precision': 0.9816525, 'recall': 0.88381577, 'specificity': 0.88381577, 'f1': 0.92584646, 'auroc': 0.9813086, 'binary_precision': 0.98754597, 'binary_recall': 0.7686715, 'binary_specificity': 0.99896, 'binary_f1_score': 0.86446977}
confusion matrix:
       0     1
0  42265    44
1   1050  3489
---- Validation: 
scalar performance:
{'acc': 0.9689448, 'precision': 0.77013916, 'recall': 0.56396365, 'specificity': 0.56396365, 'f1': 0.5986926, 'auroc': 0.71724594, 'binary_precision': 0.5683453, 'binary_recall': 0.13122924, 'binary_specificity': 0.996698, 'binary_f1_score': 0.21322538}
confusion matrix:
       0   1
0  18111  60
1    523  79
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9648982, 'precision': 0.8345394, 'recall': 0.58122724, 'specificity': 0.58122724, 'f1': 0.6247884, 'auroc': 0.73190355, 'binary_precision': 0.7017544, 'binary_recall': 0.16528925, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.26755852}
confusion matrix:
      0   1
0  5980  17
1   202  40
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512114_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-20 14:45:59.517041,epoch time: 0:28:13.315138,used: 1:06:34.112995,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_13_39_25_seed_2_21512114
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97933745, 'precision': 0.98159075, 'recall': 0.8990501, 'specificity': 0.8990501, 'f1': 0.9354852, 'auroc': 0.9850794, 'binary_precision': 0.9842648, 'binary_recall': 0.79947114, 'binary_specificity': 0.99862915, 'binary_f1_score': 0.88229567}
confusion matrix:
       0     1
0  42252    58
1    910  3628
---- Validation: 
scalar performance:
{'acc': 0.9687317, 'precision': 0.76120734, 'recall': 0.5662627, 'specificity': 0.5662627, 'f1': 0.6012111, 'auroc': 0.732268, 'binary_precision': 0.5503356, 'binary_recall': 0.13621262, 'binary_specificity': 0.9963128, 'binary_f1_score': 0.21837549}
confusion matrix:
       0   1
0  18104  67
1    520  82
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9661805, 'precision': 0.87481916, 'recall': 0.58784246, 'specificity': 0.58784246, 'f1': 0.6361201, 'auroc': 0.7366108, 'binary_precision': 0.7818182, 'binary_recall': 0.17768595, 'binary_specificity': 0.997999, 'binary_f1_score': 0.28956228}
confusion matrix:
      0   1
0  5985  12
1   199  43
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512114_4.png
new oracle model saved
early stop counter: 1
val acc:0.968731701374054, best validation acc: 0.968944787979126, corresponding to test acc:                         0.9648982286453247 / 0.9661805033683777
after epoch: 4,now: 2024-06-20 15:14:19.013352,epoch time: 0:28:19.496311,used: 1:34:53.609306,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_13_39_25_seed_2_21512114
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98322237, 'precision': 0.9790293, 'recall': 0.92354596, 'specificity': 0.92354596, 'f1': 0.949141, 'auroc': 0.9886878, 'binary_precision': 0.97398335, 'binary_recall': 0.84952635, 'binary_specificity': 0.9975655, 'binary_f1_score': 0.90750766}
confusion matrix:
       0     1
0  42206   103
1    683  3856
---- Validation: 
scalar performance:
{'acc': 0.9678794, 'precision': 0.7363266, 'recall': 0.6051718, 'specificity': 0.6051718, 'f1': 0.64322555, 'auroc': 0.7748055, 'binary_precision': 0.49809885, 'binary_recall': 0.21760798, 'binary_specificity': 0.9927357, 'binary_f1_score': 0.30289015}
confusion matrix:
       0    1
0  18039  132
1    471  131
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.968745, 'precision': 0.86235124, 'recall': 0.64271045, 'specificity': 0.64271045, 'f1': 0.7009259, 'auroc': 0.78534305, 'binary_precision': 0.75268817, 'binary_recall': 0.2892562, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.41791043}
confusion matrix:
      0   1
0  5974  23
1   172  70
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512114_5.png
new oracle model saved
early stop counter: 2
val acc:0.9678794145584106, best validation acc: 0.968944787979126, corresponding to test acc:                         0.9648982286453247 / 0.9687449932098389
after epoch: 5,now: 2024-06-20 15:36:57.902313,epoch time: 0:22:38.888961,used: 1:57:32.498267,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_13_39_25_seed_2_21512114
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98428965, 'precision': 0.9770202, 'recall': 0.93159586, 'specificity': 0.93159586, 'f1': 0.95287496, 'auroc': 0.990126, 'binary_precision': 0.9682266, 'binary_recall': 0.8662406, 'binary_specificity': 0.9969511, 'binary_f1_score': 0.9143987}
confusion matrix:
       0     1
0  42181   129
1    607  3931
---- Validation: 
scalar performance:
{'acc': 0.9680925, 'precision': 0.7401655, 'recall': 0.6020697, 'specificity': 0.6020697, 'f1': 0.64072394, 'auroc': 0.78068304, 'binary_precision': 0.5059761, 'binary_recall': 0.21096346, 'binary_specificity': 0.9931759, 'binary_f1_score': 0.29777256}
confusion matrix:
       0    1
0  18047  124
1    475  127
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96730244, 'precision': 0.83674324, 'recall': 0.63402915, 'specificity': 0.63402915, 'f1': 0.688028, 'auroc': 0.7750316, 'binary_precision': 0.70212764, 'binary_recall': 0.27272728, 'binary_specificity': 0.995331, 'binary_f1_score': 0.39285713}
confusion matrix:
      0   1
0  5969  28
1   176  66
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512114_6.png
early stop counter: 3
val acc:0.9680925011634827, best validation acc: 0.968944787979126, corresponding to test acc:                         0.9648982286453247 / 0.9687449932098389
after epoch: 6,now: 2024-06-20 16:06:02.965296,epoch time: 0:29:05.062983,used: 2:26:37.561250,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_13_39_25_seed_2_21512114
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9852715, 'precision': 0.9812875, 'recall': 0.9333198, 'specificity': 0.9333198, 'f1': 0.9557184, 'auroc': 0.9902828, 'binary_precision': 0.9764735, 'binary_recall': 0.868885, 'binary_specificity': 0.9977547, 'binary_f1_score': 0.9195429}
confusion matrix:
       0     1
0  42215    95
1    595  3943
---- Validation: 
scalar performance:
{'acc': 0.968998, 'precision': 0.7648585, 'recall': 0.5792491, 'specificity': 0.5792491, 'f1': 0.6180495, 'auroc': 0.7759265, 'binary_precision': 0.5568182, 'binary_recall': 0.1627907, 'binary_specificity': 0.99570745, 'binary_f1_score': 0.251928}
confusion matrix:
       0   1
0  18093  78
1    504  98
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96730244, 'precision': 0.86329323, 'recall': 0.6142017, 'specificity': 0.6142017, 'f1': 0.66882837, 'auroc': 0.76636267, 'binary_precision': 0.7567568, 'binary_recall': 0.23140496, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.35443038}
confusion matrix:
      0   1
0  5979  18
1   186  56
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512114_7.png
better model found
persisted
after epoch: 7,now: 2024-06-20 16:31:38.447416,epoch time: 0:25:35.482120,used: 2:52:13.043370,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_13_39_25_seed_2_21512114
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9858265, 'precision': 0.9828368, 'recall': 0.9351166, 'specificity': 0.9351166, 'f1': 0.9574137, 'auroc': 0.99164844, 'binary_precision': 0.9792234, 'binary_recall': 0.87221855, 'binary_specificity': 0.9980146, 'binary_f1_score': 0.92262876}
confusion matrix:
       0     1
0  42225    84
1    580  3959
---- Validation: 
scalar performance:
{'acc': 0.9691046, 'precision': 0.7647921, 'recall': 0.5881376, 'specificity': 0.5881376, 'f1': 0.6286999, 'auroc': 0.79114026, 'binary_precision': 0.5561224, 'binary_recall': 0.18106312, 'binary_specificity': 0.99521214, 'binary_f1_score': 0.27318293}
confusion matrix:
       0    1
0  18084   87
1    493  109
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96602017, 'precision': 0.838681, 'recall': 0.603621, 'specificity': 0.603621, 'f1': 0.65370613, 'auroc': 0.7809545, 'binary_precision': 0.7083333, 'binary_recall': 0.2107438, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.32484075}
confusion matrix:
      0   1
0  5976  21
1   191  51
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512114_8.png
better model found
persisted
after epoch: 8,now: 2024-06-20 17:03:37.187016,epoch time: 0:31:58.739600,used: 3:24:11.782970,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_13_39_25_seed_2_21512114
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9880251, 'precision': 0.9845978, 'recall': 0.9461677, 'specificity': 0.9461677, 'f1': 0.9643812, 'auroc': 0.9939904, 'binary_precision': 0.9804348, 'binary_recall': 0.89424986, 'binary_specificity': 0.9980855, 'binary_f1_score': 0.9353612}
confusion matrix:
       0     1
0  42228    81
1    480  4059
---- Validation: 
scalar performance:
{'acc': 0.9691578, 'precision': 0.7651587, 'recall': 0.5913773, 'specificity': 0.5913773, 'f1': 0.63249314, 'auroc': 0.8022231, 'binary_precision': 0.5566502, 'binary_recall': 0.18770765, 'binary_specificity': 0.99504703, 'binary_f1_score': 0.28074533}
confusion matrix:
       0    1
0  18081   90
1    489  113
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96650106, 'precision': 0.83445287, 'recall': 0.61775035, 'specificity': 0.61775035, 'f1': 0.66986287, 'auroc': 0.79115677, 'binary_precision': 0.6987952, 'binary_recall': 0.23966943, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.35692307}
confusion matrix:
      0   1
0  5972  25
1   184  58
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512114_9.png
better model found
persisted
after epoch: 9,now: 2024-06-20 17:29:53.760634,epoch time: 0:26:16.573618,used: 3:50:28.356588,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_13_39_25_seed_2_21512114
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98851603, 'precision': 0.9860668, 'recall': 0.94760823, 'specificity': 0.94760823, 'f1': 0.96583796, 'auroc': 0.99295396, 'binary_precision': 0.9830918, 'binary_recall': 0.89687085, 'binary_specificity': 0.99834555, 'binary_f1_score': 0.9380041}
confusion matrix:
       0     1
0  42240    70
1    468  4070
---- Validation: 
scalar performance:
{'acc': 0.9691046, 'precision': 0.7647921, 'recall': 0.5881376, 'specificity': 0.5881376, 'f1': 0.6286999, 'auroc': 0.80016583, 'binary_precision': 0.5561224, 'binary_recall': 0.18106312, 'binary_specificity': 0.99521214, 'binary_f1_score': 0.27318293}
confusion matrix:
       0    1
0  18084   87
1    493  109
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96730244, 'precision': 0.8483918, 'recall': 0.6241154, 'specificity': 0.6241154, 'f1': 0.67872286, 'auroc': 0.78451777, 'binary_precision': 0.72619045, 'binary_recall': 0.2520661, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.3742331}
confusion matrix:
      0   1
0  5974  23
1   181  61
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512114_10.png
early stop counter: 1
val acc:0.9691045880317688, best validation acc: 0.9691578149795532, corresponding to test acc:                         0.9665010571479797 / 0.9687449932098389
after epoch: 10,now: 2024-06-20 17:50:43.244849,epoch time: 0:20:49.484215,used: 4:11:17.840803,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_13_39_25_seed_2_21512114
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98828125, 'precision': 0.9822946, 'recall': 0.94984967, 'specificity': 0.94984967, 'f1': 0.965358, 'auroc': 0.9948717, 'binary_precision': 0.975, 'binary_recall': 0.9021811, 'binary_specificity': 0.99751824, 'binary_f1_score': 0.9371782}
confusion matrix:
       0     1
0  42204   105
1    444  4095
---- Validation: 
scalar performance:
{'acc': 0.9689448, 'precision': 0.76173365, 'recall': 0.58403987, 'specificity': 0.58403987, 'f1': 0.62354827, 'auroc': 0.80441916, 'binary_precision': 0.55026454, 'binary_recall': 0.17275748, 'binary_specificity': 0.9953222, 'binary_f1_score': 0.2629583}
confusion matrix:
       0    1
0  18086   85
1    498  104
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9656996, 'precision': 0.8182237, 'recall': 0.613368, 'specificity': 0.613368, 'f1': 0.662974, 'auroc': 0.7858297, 'binary_precision': 0.6666667, 'binary_recall': 0.23140496, 'binary_specificity': 0.995331, 'binary_f1_score': 0.34355828}
confusion matrix:
      0   1
0  5969  28
1   186  56
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512114_11.png
early stop counter: 2
val acc:0.968944787979126, best validation acc: 0.9691578149795532, corresponding to test acc:                         0.9665010571479797 / 0.9687449932098389
after epoch: 11,now: 2024-06-20 18:11:52.495662,epoch time: 0:21:09.250813,used: 4:32:27.091616,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_13_39_25_seed_2_21512114
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98892164, 'precision': 0.9837452, 'recall': 0.95217097, 'specificity': 0.95217097, 'f1': 0.9672847, 'auroc': 0.9933827, 'binary_precision': 0.9774347, 'binary_recall': 0.90658736, 'binary_specificity': 0.99775463, 'binary_f1_score': 0.94067895}
confusion matrix:
       0     1
0  42214    95
1    424  4115
---- Validation: 
scalar performance:
{'acc': 0.9694242, 'precision': 0.7725259, 'recall': 0.5907119, 'specificity': 0.5907119, 'f1': 0.63254094, 'auroc': 0.8100279, 'binary_precision': 0.5714286, 'binary_recall': 0.18604651, 'binary_specificity': 0.99537724, 'binary_f1_score': 0.28070176}
confusion matrix:
       0    1
0  18087   84
1    490  112
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650585, 'precision': 0.83066607, 'recall': 0.5872589, 'specificity': 0.5872589, 'f1': 0.63249385, 'auroc': 0.7832975, 'binary_precision': 0.6935484, 'binary_recall': 0.17768595, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.28289476}
confusion matrix:
      0   1
0  5978  19
1   199  43
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512114_12.png
better model found
persisted
after epoch: 12,now: 2024-06-20 18:30:51.531632,epoch time: 0:18:59.035970,used: 4:51:26.127586,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_13_39_25_seed_2_21512114
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9894766, 'precision': 0.98636985, 'recall': 0.9528716, 'specificity': 0.9528716, 'f1': 0.9688661, 'auroc': 0.9948591, 'binary_precision': 0.9825859, 'binary_recall': 0.9074686, 'binary_specificity': 0.9982746, 'binary_f1_score': 0.9435346}
confusion matrix:
       0     1
0  42236    73
1    420  4119
---- Validation: 
scalar performance:
{'acc': 0.9693709, 'precision': 0.76817214, 'recall': 0.5987148, 'specificity': 0.5987148, 'f1': 0.64113414, 'auroc': 0.82263196, 'binary_precision': 0.562212, 'binary_recall': 0.2026578, 'binary_specificity': 0.9947719, 'binary_f1_score': 0.29792428}
confusion matrix:
       0    1
0  18076   95
1    480  122
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96473795, 'precision': 0.81268555, 'recall': 0.59304035, 'specificity': 0.59304035, 'f1': 0.6383943, 'auroc': 0.8009778, 'binary_precision': 0.6571429, 'binary_recall': 0.19008264, 'binary_specificity': 0.995998, 'binary_f1_score': 0.29487178}
confusion matrix:
      0   1
0  5973  24
1   196  46
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512114_13.png
early stop counter: 1
val acc:0.9693709015846252, best validation acc: 0.9694241881370544, corresponding to test acc:                         0.9650585055351257 / 0.9687449932098389
after epoch: 13,now: 2024-06-20 18:55:23.897456,epoch time: 0:24:32.365824,used: 5:15:58.493410,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_13_39_25_seed_2_21512114
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98872954, 'precision': 0.9831072, 'recall': 0.95167124, 'specificity': 0.95167124, 'f1': 0.9667207, 'auroc': 0.99419034, 'binary_precision': 0.9762527, 'binary_recall': 0.9057061, 'binary_specificity': 0.99763644, 'binary_f1_score': 0.93965715}
confusion matrix:
       0     1
0  42209   100
1    428  4111
---- Validation: 
scalar performance:
{'acc': 0.9696373, 'precision': 0.777295, 'recall': 0.5932311, 'specificity': 0.5932311, 'f1': 0.635994, 'auroc': 0.8241708, 'binary_precision': 0.5808081, 'binary_recall': 0.1910299, 'binary_specificity': 0.99543226, 'binary_f1_score': 0.2875}
confusion matrix:
       0    1
0  18088   83
1    487  115
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645777, 'precision': 0.8197982, 'recall': 0.5830432, 'specificity': 0.5830432, 'f1': 0.6262376, 'auroc': 0.7966856, 'binary_precision': 0.6721311, 'binary_recall': 0.1694215, 'binary_specificity': 0.996665, 'binary_f1_score': 0.27062708}
confusion matrix:
      0   1
0  5977  20
1   201  41
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512114_14.png
better model found
persisted
after epoch: 14,now: 2024-06-20 19:19:00.358135,epoch time: 0:23:36.460679,used: 5:39:34.954089,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_13_39_25_seed_2_21512114
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9902237, 'precision': 0.9862343, 'recall': 0.9573171, 'specificity': 0.9573171, 'f1': 0.9712153, 'auroc': 0.9958055, 'binary_precision': 0.98136353, 'binary_recall': 0.9165014, 'binary_specificity': 0.99813277, 'binary_f1_score': 0.94782406}
confusion matrix:
       0     1
0  42230    79
1    379  4160
---- Validation: 
scalar performance:
{'acc': 0.9692111, 'precision': 0.7705941, 'recall': 0.5809652, 'specificity': 0.5809652, 'f1': 0.6206746, 'auroc': 0.82071793, 'binary_precision': 0.5681818, 'binary_recall': 0.16611296, 'binary_specificity': 0.9958175, 'binary_f1_score': 0.2570694}
confusion matrix:
       0    1
0  18095   76
1    502  100
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9639365, 'precision': 0.807981, 'recall': 0.5747788, 'specificity': 0.5747788, 'f1': 0.61450857, 'auroc': 0.7896965, 'binary_precision': 0.64912283, 'binary_recall': 0.15289256, 'binary_specificity': 0.996665, 'binary_f1_score': 0.24749164}
confusion matrix:
      0   1
0  5977  20
1   205  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512114_15.png
early stop counter: 1
val acc:0.9692111015319824, best validation acc: 0.9696372747421265, corresponding to test acc:                         0.9645776748657227 / 0.9687449932098389
after epoch: 15,now: 2024-06-20 19:41:45.224932,epoch time: 0:22:44.866797,used: 6:02:19.820886,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_13_39_25_seed_2_21512114
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9904585, 'precision': 0.9863864, 'recall': 0.9585288, 'specificity': 0.9585288, 'f1': 0.9719382, 'auroc': 0.99505293, 'binary_precision': 0.98141176, 'binary_recall': 0.91892487, 'binary_specificity': 0.99813277, 'binary_f1_score': 0.94914097}
confusion matrix:
       0     1
0  42230    79
1    368  4171
---- Validation: 
scalar performance:
{'acc': 0.9689448, 'precision': 0.76274264, 'recall': 0.58082765, 'specificity': 0.58082765, 'f1': 0.6197847, 'auroc': 0.8148202, 'binary_precision': 0.5524862, 'binary_recall': 0.16611296, 'binary_specificity': 0.99554235, 'binary_f1_score': 0.25542784}
confusion matrix:
       0    1
0  18090   81
1    502  100
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96361595, 'precision': 0.7969736, 'recall': 0.574612, 'specificity': 0.574612, 'f1': 0.61360276, 'auroc': 0.78555167, 'binary_precision': 0.62711865, 'binary_recall': 0.15289256, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.24584718}
confusion matrix:
      0   1
0  5975  22
1   205  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512114_16.png
early stop counter: 2
val acc:0.968944787979126, best validation acc: 0.9696372747421265, corresponding to test acc:                         0.9645776748657227 / 0.9687449932098389
after epoch: 16,now: 2024-06-20 20:03:21.168748,epoch time: 0:21:35.943816,used: 6:23:55.764702,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_13_39_25_seed_2_21512114
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9900956, 'precision': 0.9847313, 'recall': 0.9580329, 'specificity': 0.9580329, 'f1': 0.97090364, 'auroc': 0.99606264, 'binary_precision': 0.97817415, 'binary_recall': 0.9182639, 'binary_specificity': 0.9978019, 'binary_f1_score': 0.9472727}
confusion matrix:
       0     1
0  42216    93
1    371  4168
---- Validation: 
scalar performance:
{'acc': 0.9688915, 'precision': 0.75984746, 'recall': 0.58561844, 'specificity': 0.58561844, 'f1': 0.62522024, 'auroc': 0.8237539, 'binary_precision': 0.5463917, 'binary_recall': 0.17607974, 'binary_specificity': 0.9951571, 'binary_f1_score': 0.26633164}
confusion matrix:
       0    1
0  18083   88
1    496  106
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9631351, 'precision': 0.78035676, 'recall': 0.5763446, 'specificity': 0.5763446, 'f1': 0.61473507, 'auroc': 0.78700364, 'binary_precision': 0.59375, 'binary_recall': 0.1570248, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.24836601}
confusion matrix:
      0   1
0  5971  26
1   204  38
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512114_17.png
early stop counter: 3
val acc:0.9688915014266968, best validation acc: 0.9696372747421265, corresponding to test acc:                         0.9645776748657227 / 0.9687449932098389
after epoch: 17,now: 2024-06-20 20:23:22.987404,epoch time: 0:20:01.818656,used: 6:43:57.583358,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_13_39_25_seed_2_21512114
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9908, 'precision': 0.98361266, 'recall': 0.9632337, 'specificity': 0.9632337, 'f1': 0.9731451, 'auroc': 0.99622893, 'binary_precision': 0.97479767, 'binary_recall': 0.92904365, 'binary_specificity': 0.99742377, 'binary_f1_score': 0.9513709}
confusion matrix:
       0     1
0  42201   109
1    322  4216
---- Validation: 
scalar performance:
{'acc': 0.9685186, 'precision': 0.7497103, 'recall': 0.5902441, 'specificity': 0.5902441, 'f1': 0.6293783, 'auroc': 0.83044326, 'binary_precision': 0.52582157, 'binary_recall': 0.18604651, 'binary_specificity': 0.9944417, 'binary_f1_score': 0.27484664}
confusion matrix:
       0    1
0  18070  101
1    490  112
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9632954, 'precision': 0.77523017, 'recall': 0.5922899, 'specificity': 0.5922899, 'f1': 0.6338837, 'auroc': 0.7963715, 'binary_precision': 0.5822785, 'binary_recall': 0.19008264, 'binary_specificity': 0.99449724, 'binary_f1_score': 0.28660434}
confusion matrix:
      0   1
0  5964  33
1   196  46
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512114_18.png
early stop counter: 4
val acc:0.9685186147689819, best validation acc: 0.9696372747421265, corresponding to test acc:                         0.9645776748657227 / 0.9687449932098389
after epoch: 18,now: 2024-06-20 20:44:54.890843,epoch time: 0:21:31.903439,used: 7:05:29.486797,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_13_39_25_seed_2_21512114
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9915685, 'precision': 0.987203, 'recall': 0.96415097, 'specificity': 0.96415097, 'f1': 0.97532344, 'auroc': 0.996945, 'binary_precision': 0.9818562, 'binary_recall': 0.93014544, 'binary_specificity': 0.9981565, 'binary_f1_score': 0.9553016}
confusion matrix:
       0     1
0  42232    78
1    317  4221
---- Validation: 
scalar performance:
{'acc': 0.9688382, 'precision': 0.756997, 'recall': 0.59201527, 'specificity': 0.59201527, 'f1': 0.63225853, 'auroc': 0.8359662, 'binary_precision': 0.54028434, 'binary_recall': 0.18936877, 'binary_specificity': 0.9946618, 'binary_f1_score': 0.2804428}
confusion matrix:
       0    1
0  18074   97
1    488  114
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96281457, 'precision': 0.7684258, 'recall': 0.58212614, 'specificity': 0.58212614, 'f1': 0.6210369, 'auroc': 0.8069345, 'binary_precision': 0.5694444, 'binary_recall': 0.1694215, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.2611465}
confusion matrix:
      0   1
0  5966  31
1   201  41
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512114_19.png
early stop counter: 5
val acc:0.9688382148742676, best validation acc: 0.9696372747421265, corresponding to test acc:                         0.9645776748657227 / 0.9687449932098389
after epoch: 19,now: 2024-06-20 21:05:08.394869,epoch time: 0:20:13.504026,used: 7:25:42.990823,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_13_39_25_seed_2_21512114
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9912056, 'precision': 0.98707175, 'recall': 0.96218765, 'specificity': 0.96218765, 'f1': 0.97421694, 'auroc': 0.99710065, 'binary_precision': 0.9820135, 'binary_recall': 0.9261952, 'binary_specificity': 0.99818003, 'binary_f1_score': 0.953288}
confusion matrix:
       0     1
0  42232    77
1    335  4204
---- Validation: 
scalar performance:
{'acc': 0.9687317, 'precision': 0.75535715, 'recall': 0.587142, 'specificity': 0.587142, 'f1': 0.62650776, 'auroc': 0.8348826, 'binary_precision': 0.53731346, 'binary_recall': 0.179402, 'binary_specificity': 0.9948819, 'binary_f1_score': 0.2689913}
confusion matrix:
       0    1
0  18078   93
1    494  108
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9623337, 'precision': 0.7618546, 'recall': 0.5679968, 'specificity': 0.5679968, 'f1': 0.6025603, 'auroc': 0.7939865, 'binary_precision': 0.55737704, 'binary_recall': 0.14049587, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.22442245}
confusion matrix:
      0   1
0  5970  27
1   208  34
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512114_20.png
early stop counter: 6
val acc:0.968731701374054, best validation acc: 0.9696372747421265, corresponding to test acc:                         0.9645776748657227 / 0.9687449932098389
after epoch: 20,now: 2024-06-20 21:24:07.930227,epoch time: 0:18:59.535358,used: 7:44:42.526181,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_13_39_25_seed_2_21512114
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99114156, 'precision': 0.9858248, 'recall': 0.96303725, 'specificity': 0.96303725, 'f1': 0.97408444, 'auroc': 0.9972539, 'binary_precision': 0.97931194, 'binary_recall': 0.928178, 'binary_specificity': 0.99789643, 'binary_f1_score': 0.9530596}
confusion matrix:
       0     1
0  42220    89
1    326  4213
---- Validation: 
scalar performance:
{'acc': 0.9688382, 'precision': 0.75751007, 'recall': 0.58960617, 'specificity': 0.58960617, 'f1': 0.6295849, 'auroc': 0.83497393, 'binary_precision': 0.54146343, 'binary_recall': 0.18438539, 'binary_specificity': 0.9948269, 'binary_f1_score': 0.27509296}
confusion matrix:
       0    1
0  18077   94
1    491  111
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.961372, 'precision': 0.7370216, 'recall': 0.56154835, 'specificity': 0.56154835, 'f1': 0.5924129, 'auroc': 0.79379344, 'binary_precision': 0.5081967, 'binary_recall': 0.12809917, 'binary_specificity': 0.9949975, 'binary_f1_score': 0.20462047}
confusion matrix:
      0   1
0  5967  30
1   211  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512114_21.png
early stop counter: 7
val acc:0.9688382148742676, best validation acc: 0.9696372747421265, corresponding to test acc:                         0.9645776748657227 / 0.9687449932098389
after epoch: 21,now: 2024-06-20 21:42:34.633555,epoch time: 0:18:26.703328,used: 8:03:09.229509,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_13_39_25_seed_2_21512114
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9917179, 'precision': 0.988716, 'recall': 0.96355295, 'specificity': 0.96355295, 'f1': 0.97571385, 'auroc': 0.99699306, 'binary_precision': 0.9850432, 'binary_recall': 0.9286186, 'binary_specificity': 0.9984873, 'binary_f1_score': 0.9559991}
confusion matrix:
       0     1
0  42245    64
1    324  4215
---- Validation: 
scalar performance:
{'acc': 0.9684653, 'precision': 0.7505195, 'recall': 0.5749587, 'specificity': 0.5749587, 'f1': 0.6114868, 'auroc': 0.8311956, 'binary_precision': 0.52840906, 'binary_recall': 0.15448505, 'binary_specificity': 0.99543226, 'binary_f1_score': 0.23907453}
confusion matrix:
       0   1
0  18088  83
1    509  93
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.7324689, 'recall': 0.54956853, 'specificity': 0.54956853, 'f1': 0.575687, 'auroc': 0.78114575, 'binary_precision': 0.5, 'binary_recall': 0.10330579, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.17123286}
confusion matrix:
      0   1
0  5972  25
1   217  25
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512114_22.png
early stop counter: 8
val acc:0.9684653282165527, best validation acc: 0.9696372747421265, corresponding to test acc:                         0.9645776748657227 / 0.9687449932098389
after epoch: 22,now: 2024-06-20 22:00:51.171652,epoch time: 0:18:16.538097,used: 8:21:25.767606,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_13_39_25_seed_2_21512114
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99220884, 'precision': 0.98781765, 'recall': 0.9672667, 'specificity': 0.9672667, 'f1': 0.97726214, 'auroc': 0.99673223, 'binary_precision': 0.9824318, 'binary_recall': 0.9363296, 'binary_specificity': 0.9982037, 'binary_f1_score': 0.95882684}
confusion matrix:
       0     1
0  42233    76
1    289  4250
---- Validation: 
scalar performance:
{'acc': 0.9685719, 'precision': 0.75230944, 'recall': 0.58143806, 'specificity': 0.58143806, 'f1': 0.6194989, 'auroc': 0.83998, 'binary_precision': 0.53157896, 'binary_recall': 0.16777408, 'binary_specificity': 0.9951021, 'binary_f1_score': 0.2550505}
confusion matrix:
       0    1
0  18082   89
1    501  101
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.961372, 'precision': 0.73696697, 'recall': 0.56353104, 'specificity': 0.56353104, 'f1': 0.59501904, 'auroc': 0.79347557, 'binary_precision': 0.50793654, 'binary_recall': 0.1322314, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.20983605}
confusion matrix:
      0   1
0  5966  31
1   210  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512114_23.png
early stop counter: 9
val acc:0.9685719013214111, best validation acc: 0.9696372747421265, corresponding to test acc:                         0.9645776748657227 / 0.9687449932098389
after epoch: 23,now: 2024-06-20 22:19:31.447825,epoch time: 0:18:40.276173,used: 8:40:06.043779,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_13_39_25_seed_2_21512114
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.991355, 'precision': 0.9882839, 'recall': 0.961877, 'specificity': 0.961877, 'f1': 0.9746163, 'auroc': 0.9967284, 'binary_precision': 0.98452884, 'binary_recall': 0.92531395, 'binary_specificity': 0.99844, 'binary_f1_score': 0.95400345}
confusion matrix:
       0     1
0  42243    66
1    339  4200
---- Validation: 
scalar performance:
{'acc': 0.9685186, 'precision': 0.7526812, 'recall': 0.571774, 'specificity': 0.571774, 'f1': 0.6076998, 'auroc': 0.8352562, 'binary_precision': 0.5329341, 'binary_recall': 0.14784053, 'binary_specificity': 0.99570745, 'binary_f1_score': 0.23146942}
confusion matrix:
       0   1
0  18093  78
1    513  89
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.961372, 'precision': 0.7372427, 'recall': 0.5556001, 'specificity': 0.5556001, 'f1': 0.5843836, 'auroc': 0.7863889, 'binary_precision': 0.5090909, 'binary_recall': 0.11570248, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.18855219}
confusion matrix:
      0   1
0  5970  27
1   214  28
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512114_24.png
early stop counter: 10
val acc:0.9685186147689819, best validation acc: 0.9696372747421265, corresponding to test acc:                         0.9645776748657227 / 0.9687449932098389
after epoch: 24,now: 2024-06-20 22:37:27.923662,epoch time: 0:17:56.475837,used: 8:58:02.519616,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_13_39_25_seed_2_21512114
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9917606, 'precision': 0.9855413, 'recall': 0.96692014, 'specificity': 0.96692014, 'f1': 0.97599995, 'auroc': 0.99671924, 'binary_precision': 0.97790563, 'binary_recall': 0.9361093, 'binary_specificity': 0.997731, 'binary_f1_score': 0.95655113}
confusion matrix:
       0     1
0  42213    96
1    290  4249
---- Validation: 
scalar performance:
{'acc': 0.9684121, 'precision': 0.74705577, 'recall': 0.5925982, 'specificity': 0.5925982, 'f1': 0.63165873, 'auroc': 0.84899265, 'binary_precision': 0.520362, 'binary_recall': 0.1910299, 'binary_specificity': 0.99416655, 'binary_f1_score': 0.27946538}
confusion matrix:
       0    1
0  18065  106
1    487  115
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9616926, 'precision': 0.7460114, 'recall': 0.5597324, 'specificity': 0.5597324, 'f1': 0.59052247, 'auroc': 0.79524815, 'binary_precision': 0.5263158, 'binary_recall': 0.12396694, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.2006689}
confusion matrix:
      0   1
0  5970  27
1   212  30
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512114_25.png
early stop counter: 11
val acc:0.9684121012687683, best validation acc: 0.9696372747421265, corresponding to test acc:                         0.9645776748657227 / 0.9687449932098389
after epoch: 25,now: 2024-06-20 22:55:40.080668,epoch time: 0:18:12.157006,used: 9:16:14.676622,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_13_39_25_seed_2_21512114
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99197406, 'precision': 0.986968, 'recall': 0.9667433, 'specificity': 0.9667433, 'f1': 0.97658396, 'auroc': 0.99708307, 'binary_precision': 0.980827, 'binary_recall': 0.93544835, 'binary_specificity': 0.99803823, 'binary_f1_score': 0.95760036}
confusion matrix:
       0     1
0  42226    83
1    293  4246
---- Validation: 
scalar performance:
{'acc': 0.9685719, 'precision': 0.75164723, 'recall': 0.58545333, 'specificity': 0.58545333, 'f1': 0.62414104, 'auroc': 0.84785485, 'binary_precision': 0.53, 'binary_recall': 0.17607974, 'binary_specificity': 0.9948269, 'binary_f1_score': 0.26433915}
confusion matrix:
       0    1
0  18077   94
1    496  106
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96185285, 'precision': 0.75071335, 'recall': 0.5598157, 'specificity': 0.5598157, 'f1': 0.590901, 'auroc': 0.79913324, 'binary_precision': 0.53571427, 'binary_recall': 0.12396694, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.20134228}
confusion matrix:
      0   1
0  5971  26
1   212  30
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512114_26.png
early stop counter: 12
val acc:0.9685719013214111, best validation acc: 0.9696372747421265, corresponding to test acc:                         0.9645776748657227 / 0.9687449932098389
after epoch: 26,now: 2024-06-20 23:14:29.474453,epoch time: 0:18:49.393785,used: 9:35:04.070407,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_13_39_25_seed_2_21512114
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9922515, 'precision': 0.98824537, 'recall': 0.9670936, 'specificity': 0.9670936, 'f1': 0.97737294, 'auroc': 0.99732935, 'binary_precision': 0.98333335, 'binary_recall': 0.93588895, 'binary_specificity': 0.9982982, 'binary_f1_score': 0.9590247}
confusion matrix:
       0     1
0  42237    72
1    291  4248
---- Validation: 
scalar performance:
{'acc': 0.9686784, 'precision': 0.7566668, 'recall': 0.5750687, 'specificity': 0.5750687, 'f1': 0.61215985, 'auroc': 0.8399861, 'binary_precision': 0.5406977, 'binary_recall': 0.15448505, 'binary_specificity': 0.99565244, 'binary_f1_score': 0.24031009}
confusion matrix:
       0   1
0  18092  79
1    509  93
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96105146, 'precision': 0.726352, 'recall': 0.5415542, 'specificity': 0.5415542, 'f1': 0.5637195, 'auroc': 0.7781973, 'binary_precision': 0.4883721, 'binary_recall': 0.08677686, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.14736843}
confusion matrix:
      0   1
0  5975  22
1   221  21
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512114_27.png
early stop counter: 13
val acc:0.9686784148216248, best validation acc: 0.9696372747421265, corresponding to test acc:                         0.9645776748657227 / 0.9687449932098389
after epoch: 27,now: 2024-06-20 23:33:00.806641,epoch time: 0:18:31.332188,used: 9:53:35.402595,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_13_39_25_seed_2_21512114
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9924436, 'precision': 0.99028784, 'recall': 0.96621656, 'specificity': 0.96621656, 'f1': 0.97786903, 'auroc': 0.99691916, 'binary_precision': 0.98764855, 'binary_recall': 0.93368584, 'binary_specificity': 0.9987473, 'binary_f1_score': 0.9599094}
confusion matrix:
       0     1
0  42256    53
1    301  4238
---- Validation: 
scalar performance:
{'acc': 0.9683055, 'precision': 0.7463522, 'recall': 0.57246697, 'specificity': 0.57246697, 'f1': 0.6080384, 'auroc': 0.8427557, 'binary_precision': 0.5202312, 'binary_recall': 0.14950167, 'binary_specificity': 0.99543226, 'binary_f1_score': 0.23225805}
confusion matrix:
       0   1
0  18088  83
1    512  90
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9615323, 'precision': 0.7436881, 'recall': 0.54576975, 'specificity': 0.54576975, 'f1': 0.5705771, 'auroc': 0.78427696, 'binary_precision': 0.52272725, 'binary_recall': 0.09504132, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.16083916}
confusion matrix:
      0   1
0  5976  21
1   219  23
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512114_28.png
early stop counter: 14
val acc:0.9683055281639099, best validation acc: 0.9696372747421265, corresponding to test acc:                         0.9645776748657227 / 0.9687449932098389
after epoch: 28,now: 2024-06-20 23:57:34.056978,epoch time: 0:24:33.250337,used: 10:18:08.652932,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_13_39_25_seed_2_21512114
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99252903, 'precision': 0.9867357, 'recall': 0.9701911, 'specificity': 0.9701911, 'f1': 0.97828203, 'auroc': 0.99650943, 'binary_precision': 0.9796152, 'binary_recall': 0.9424857, 'binary_specificity': 0.9978965, 'binary_f1_score': 0.9606918}
confusion matrix:
       0     1
0  42221    89
1    261  4277
---- Validation: 
scalar performance:
{'acc': 0.9680392, 'precision': 0.7391065, 'recall': 0.5972239, 'specificity': 0.5972239, 'f1': 0.635532, 'auroc': 0.8532548, 'binary_precision': 0.50416666, 'binary_recall': 0.20099668, 'binary_specificity': 0.9934511, 'binary_f1_score': 0.2874109}
confusion matrix:
       0    1
0  18052  119
1    481  121
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9591281, 'precision': 0.6840752, 'recall': 0.5524501, 'specificity': 0.5524501, 'f1': 0.5769012, 'auroc': 0.78855693, 'binary_precision': 0.40298507, 'binary_recall': 0.11157025, 'binary_specificity': 0.99333, 'binary_f1_score': 0.17475727}
confusion matrix:
      0   1
0  5957  40
1   215  27
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512114_29.png
early stop counter: 15
val acc:0.9680392146110535, best validation acc: 0.9696372747421265, corresponding to test acc:                         0.9645776748657227 / 0.9687449932098389
after epoch: 29,now: 2024-06-21 00:21:25.634909,epoch time: 0:23:51.577931,used: 10:42:00.230863,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_13_39_25_seed_2_21512114
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9929559, 'precision': 0.9888933, 'recall': 0.97053206, 'specificity': 0.97053206, 'f1': 0.97949004, 'auroc': 0.9971614, 'binary_precision': 0.98390436, 'binary_recall': 0.9427187, 'binary_specificity': 0.9983455, 'binary_f1_score': 0.96287125}
confusion matrix:
       0     1
0  42239    70
1    260  4279
---- Validation: 
scalar performance:
{'acc': 0.9683055, 'precision': 0.7452992, 'recall': 0.58370966, 'specificity': 0.58370966, 'f1': 0.6214175, 'auroc': 0.84876084, 'binary_precision': 0.51741296, 'binary_recall': 0.17275748, 'binary_specificity': 0.9946618, 'binary_f1_score': 0.25902864}
confusion matrix:
       0    1
0  18074   97
1    498  104
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9604103, 'precision': 0.70972747, 'recall': 0.54915166, 'specificity': 0.54915166, 'f1': 0.57403636, 'auroc': 0.7964447, 'binary_precision': 0.45454547, 'binary_recall': 0.10330579, 'binary_specificity': 0.9949975, 'binary_f1_score': 0.16835018}
confusion matrix:
      0   1
0  5967  30
1   217  25
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512114_30.png
early stop counter: 16
val acc:0.9683055281639099, best validation acc: 0.9696372747421265, corresponding to test acc:                         0.9645776748657227 / 0.9687449932098389
after epoch: 30,now: 2024-06-21 00:44:57.469142,epoch time: 0:23:31.834233,used: 11:05:32.065096,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_13_39_25_seed_2_21512114
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 11:05:32.065096 at 2024-06-21 00:44:57.469142
persisted model performance metric: 

scalar performance:
{'acc': 0.9645777, 'precision': 0.8197982, 'recall': 0.5830432, 'specificity': 0.5830432, 'f1': 0.6262376, 'auroc': 0.7966856, 'binary_precision': 0.6721311, 'binary_recall': 0.1694215, 'binary_specificity': 0.996665, 'binary_f1_score': 0.27062708}
confusion matrix:
      0   1
0  5977  20
1   201  41
oracle model performance metric: 

scalar performance:
{'acc': 0.968745, 'precision': 0.86235124, 'recall': 0.64271045, 'specificity': 0.64271045, 'f1': 0.7009259, 'auroc': 0.78534305, 'binary_precision': 0.75268817, 'binary_recall': 0.2892562, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.41791043}
confusion matrix:
      0   1
0  5974  23
1   172  70
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_irm_resnet_different_bs128_lre4_classbalancing/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_irm_resnet_different_bs128_lre4_classbalancing/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204097 KiB |   1730 MiB |   1211 TiB |   1211 TiB |
|       from large pool | 167936 KiB |   1660 MiB |   1210 TiB |   1210 TiB |
|       from small pool |  36161 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 204097 KiB |   1730 MiB |   1211 TiB |   1211 TiB |
|       from large pool | 167936 KiB |   1660 MiB |   1210 TiB |   1210 TiB |
|       from small pool |  36161 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201087 KiB |   1723 MiB |   1211 TiB |   1211 TiB |
|       from large pool | 165120 KiB |   1653 MiB |   1210 TiB |   1210 TiB |
|       from small pool |  35967 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2196 MiB |   2270 MiB |   5474 MiB |   3278 MiB |
|       from large pool |   2122 MiB |   2196 MiB |   5336 MiB |   3214 MiB |
|       from small pool |     74 MiB |     74 MiB |    138 MiB |     64 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 404158 KiB |    900 MiB |    937 TiB |    937 TiB |
|       from large pool | 397312 KiB |    899 MiB |    936 TiB |    936 TiB |
|       from small pool |   6846 KiB |     14 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    1194    |    1851    |   32846 K  |   32845 K  |
|       from large pool |      36    |      76    |   13063 K  |   13063 K  |
|       from small pool |    1158    |    1780    |   19783 K  |   19782 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1194    |    1851    |   32846 K  |   32845 K  |
|       from large pool |      36    |      76    |   13063 K  |   13063 K  |
|       from small pool |    1158    |    1780    |   19783 K  |   19782 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      50    |      51    |      91    |      41    |
|       from large pool |      13    |      14    |      22    |       9    |
|       from small pool |      37    |      37    |      69    |      32    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      31    |     380    |   16901 K  |   16901 K  |
|       from large pool |       5    |      11    |    4443 K  |    4443 K  |
|       from small pool |      26    |     375    |   12457 K  |   12457 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1730 MiB |   1211 TiB |   1211 TiB |
|       from large pool |  16640 KiB |   1660 MiB |   1210 TiB |   1210 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1730 MiB |   1211 TiB |   1211 TiB |
|       from large pool |  16640 KiB |   1660 MiB |   1210 TiB |   1210 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1723 MiB |   1211 TiB |   1211 TiB |
|       from large pool |  16640 KiB |   1653 MiB |   1210 TiB |   1210 TiB |
|       from small pool |      0 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 608256 KiB |   2270 MiB |   5474 MiB |   4880 MiB |
|       from large pool | 565248 KiB |   2196 MiB |   5336 MiB |   4784 MiB |
|       from small pool |  43008 KiB |     74 MiB |    138 MiB |     96 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 384768 KiB |    900 MiB |    937 TiB |    937 TiB |
|       from large pool | 384768 KiB |    899 MiB |    936 TiB |    936 TiB |
|       from small pool |      0 KiB |     14 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1851    |   32846 K  |   32846 K  |
|       from large pool |       2    |      76    |   13063 K  |   13063 K  |
|       from small pool |       0    |    1780    |   19783 K  |   19783 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1851    |   32846 K  |   32846 K  |
|       from large pool |       2    |      76    |   13063 K  |   13063 K  |
|       from small pool |       0    |    1780    |   19783 K  |   19783 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      30    |      51    |      91    |      61    |
|       from large pool |       9    |      14    |      22    |      13    |
|       from small pool |      21    |      37    |      69    |      48    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     380    |   16901 K  |   16901 K  |
|       from large pool |       1    |      11    |    4443 K  |    4443 K  |
|       from small pool |       0    |     375    |   12458 K  |   12458 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

