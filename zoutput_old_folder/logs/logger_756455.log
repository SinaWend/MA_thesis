Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0




!!!: not committed yet



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_16_24_seed_0_21512108

 Experiment start at: 2024-06-19 23:16:24.559724
before training, model accuracy: 0.31128156185150146
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.94663954, 'precision': 0.9679966, 'recall': 0.71932787, 'specificity': 0.71932787, 'f1': 0.7899705, 'auroc': 0.94983125, 'binary_precision': 0.99130434, 'binary_recall': 0.43905756, 'binary_specificity': 0.99959815, 'binary_f1_score': 0.60857284}
confusion matrix:
       0     1
0  42289    17
1   2476  1938
---- Validation: 
scalar performance:
{'acc': 0.9657301, 'precision': 0.6495822, 'recall': 0.5007225, 'specificity': 0.5007225, 'f1': 0.4928307, 'auroc': 0.5418165, 'binary_precision': 0.33333334, 'binary_recall': 0.00155521, 'binary_specificity': 0.9998898, 'binary_f1_score': 0.0030959754}
confusion matrix:
       0  1
0  18147  2
1    642  1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.5843892, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512108_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-19 23:50:05.629182,epoch time: 0:33:41.069458,used: 0:33:41.069458,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_16_24_seed_0_21512108
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9701841, 'precision': 0.9807068, 'recall': 0.8443683, 'specificity': 0.8443683, 'f1': 0.8987206, 'auroc': 0.9756249, 'binary_precision': 0.9928175, 'binary_recall': 0.68925655, 'binary_specificity': 0.99948, 'binary_f1_score': 0.8136455}
confusion matrix:
       0     1
0  42286    22
1   1371  3041
---- Validation: 
scalar performance:
{'acc': 0.9664219, 'precision': 0.7892785, 'recall': 0.5250824, 'specificity': 0.5250824, 'f1': 0.5387926, 'auroc': 0.6471242, 'binary_precision': 0.6111111, 'binary_recall': 0.051321927, 'binary_specificity': 0.9988429, 'binary_f1_score': 0.09469154}
confusion matrix:
       0   1
0  18128  21
1    610  33
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579738, 'precision': 0.7048012, 'recall': 0.5163242, 'specificity': 0.5163242, 'f1': 0.5212806, 'auroc': 0.68570817, 'binary_precision': 0.45, 'binary_recall': 0.03448276, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.06405694}
confusion matrix:
      0   1
0  5986  11
1   252   9
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512108_2.png
better model found
persisted
after epoch: 2,now: 2024-06-20 00:23:00.489260,epoch time: 0:32:54.860078,used: 1:06:35.929536,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_16_24_seed_0_21512108
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9762414, 'precision': 0.9813422, 'recall': 0.8785716, 'specificity': 0.8785716, 'f1': 0.92236555, 'auroc': 0.979578, 'binary_precision': 0.98730814, 'binary_recall': 0.7581596, 'binary_specificity': 0.9989836, 'binary_f1_score': 0.85769236}
confusion matrix:
       0     1
0  42265    43
1   1067  3345
---- Validation: 
scalar performance:
{'acc': 0.96695405, 'precision': 0.7836896, 'recall': 0.5508598, 'specificity': 0.5508598, 'f1': 0.5803109, 'auroc': 0.6926083, 'binary_precision': 0.59821427, 'binary_recall': 0.10419907, 'binary_specificity': 0.9975205, 'binary_f1_score': 0.17748344}
confusion matrix:
       0   1
0  18104  45
1    576  67
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.77863574, 'recall': 0.54647535, 'specificity': 0.54647535, 'f1': 0.57215047, 'auroc': 0.7038673, 'binary_precision': 0.5952381, 'binary_recall': 0.09578544, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.1650165}
confusion matrix:
      0   1
0  5980  17
1   236  25
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512108_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-20 00:57:44.167920,epoch time: 0:34:43.678660,used: 1:41:19.608196,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_16_24_seed_0_21512108
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.980458, 'precision': 0.98341775, 'recall': 0.9012809, 'specificity': 0.9012809, 'f1': 0.93761575, 'auroc': 0.98668575, 'binary_precision': 0.98691535, 'binary_recall': 0.8036726, 'binary_specificity': 0.99888915, 'binary_f1_score': 0.88591784}
confusion matrix:
       0     1
0  42262    47
1    866  3545
---- Validation: 
scalar performance:
{'acc': 0.96706045, 'precision': 0.7745863, 'recall': 0.56666607, 'specificity': 0.56666607, 'f1': 0.602279, 'auroc': 0.73153317, 'binary_precision': 0.57894737, 'binary_recall': 0.13685848, 'binary_specificity': 0.9964736, 'binary_f1_score': 0.22138366}
confusion matrix:
       0   1
0  18085  64
1    555  88
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.8096023, 'recall': 0.57112944, 'specificity': 0.57112944, 'f1': 0.6091608, 'auroc': 0.75154114, 'binary_precision': 0.6551724, 'binary_recall': 0.14559387, 'binary_specificity': 0.996665, 'binary_f1_score': 0.2382445}
confusion matrix:
      0   1
0  5977  20
1   223  38
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512108_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-20 01:31:22.378953,epoch time: 0:33:38.211033,used: 2:14:57.819229,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_16_24_seed_0_21512108
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9838827, 'precision': 0.9801032, 'recall': 0.92424023, 'specificity': 0.92424023, 'f1': 0.95001525, 'auroc': 0.99117374, 'binary_precision': 0.97557807, 'binary_recall': 0.8507023, 'binary_specificity': 0.9977781, 'binary_f1_score': 0.9088709}
confusion matrix:
       0     1
0  42212    94
1    659  3755
---- Validation: 
scalar performance:
{'acc': 0.96663475, 'precision': 0.7546322, 'recall': 0.5859471, 'specificity': 0.5859471, 'f1': 0.6247978, 'auroc': 0.7685299, 'binary_precision': 0.5377358, 'binary_recall': 0.17729394, 'binary_specificity': 0.99460024, 'binary_f1_score': 0.26666665}
confusion matrix:
       0    1
0  18051   98
1    529  114
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96340686, 'precision': 0.8266591, 'recall': 0.6107757, 'specificity': 0.6107757, 'f1': 0.6606197, 'auroc': 0.7846503, 'binary_precision': 0.68604654, 'binary_recall': 0.22605364, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.3400576}
confusion matrix:
      0   1
0  5970  27
1   202  59
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512108_5.png
new oracle model saved
early stop counter: 1
val acc:0.9666347503662109, best validation acc: 0.9670604467391968, corresponding to test acc:                         0.9611697196960449 / 0.9634068608283997
after epoch: 5,now: 2024-06-20 02:03:49.611527,epoch time: 0:32:27.232574,used: 2:47:25.051803,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_16_24_seed_0_21512108
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98531675, 'precision': 0.98263526, 'recall': 0.93039376, 'specificity': 0.93039376, 'f1': 0.954646, 'auroc': 0.9905615, 'binary_precision': 0.9794186, 'binary_recall': 0.86267847, 'binary_specificity': 0.99810904, 'binary_f1_score': 0.9173494}
confusion matrix:
       0     1
0  42227    80
1    606  3807
---- Validation: 
scalar performance:
{'acc': 0.9667944, 'precision': 0.7577575, 'recall': 0.58902997, 'specificity': 0.58902997, 'f1': 0.6287135, 'auroc': 0.76881593, 'binary_precision': 0.5437788, 'binary_recall': 0.18351477, 'binary_specificity': 0.99454516, 'binary_f1_score': 0.2744186}
confusion matrix:
       0    1
0  18050   99
1    525  118
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96324706, 'precision': 0.83143187, 'recall': 0.603363, 'specificity': 0.603363, 'f1': 0.6523199, 'auroc': 0.7792114, 'binary_precision': 0.6962025, 'binary_recall': 0.21072797, 'binary_specificity': 0.995998, 'binary_f1_score': 0.32352942}
confusion matrix:
      0   1
0  5973  24
1   206  55
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512108_6.png
early stop counter: 2
val acc:0.9667943716049194, best validation acc: 0.9670604467391968, corresponding to test acc:                         0.9611697196960449 / 0.9634068608283997
after epoch: 6,now: 2024-06-20 02:35:54.124642,epoch time: 0:32:04.513115,used: 3:19:29.564918,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_16_24_seed_0_21512108
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98565924, 'precision': 0.9830922, 'recall': 0.9320491, 'specificity': 0.9320491, 'f1': 0.9557904, 'auroc': 0.993257, 'binary_precision': 0.9800103, 'binary_recall': 0.865942, 'binary_specificity': 0.9981562, 'binary_f1_score': 0.9194518}
confusion matrix:
       0     1
0  42226    78
1    592  3824
---- Validation: 
scalar performance:
{'acc': 0.96737975, 'precision': 0.7772136, 'recall': 0.5795823, 'specificity': 0.5795823, 'f1': 0.61924434, 'auroc': 0.7649975, 'binary_precision': 0.5833333, 'binary_recall': 0.16329704, 'binary_specificity': 0.99586755, 'binary_f1_score': 0.25516403}
confusion matrix:
       0    1
0  18074   75
1    538  105
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96324706, 'precision': 0.8452725, 'recall': 0.5942013, 'specificity': 0.5942013, 'f1': 0.6420781, 'auroc': 0.77098894, 'binary_precision': 0.7246377, 'binary_recall': 0.19157088, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.30303028}
confusion matrix:
      0   1
0  5978  19
1   211  50
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512108_7.png
better model found
persisted
after epoch: 7,now: 2024-06-20 03:07:41.637723,epoch time: 0:31:47.513081,used: 3:51:17.077999,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_16_24_seed_0_21512108
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9875856, 'precision': 0.98359406, 'recall': 0.94293654, 'specificity': 0.94293654, 'f1': 0.96214724, 'auroc': 0.993063, 'binary_precision': 0.9787765, 'binary_recall': 0.88788223, 'binary_specificity': 0.9979908, 'binary_f1_score': 0.9311164}
confusion matrix:
       0     1
0  42220    85
1    495  3920
---- Validation: 
scalar performance:
{'acc': 0.96631545, 'precision': 0.74600863, 'recall': 0.60003287, 'specificity': 0.60003287, 'f1': 0.63931465, 'auroc': 0.7873834, 'binary_precision': 0.51953125, 'binary_recall': 0.20684293, 'binary_specificity': 0.9932228, 'binary_f1_score': 0.29588434}
confusion matrix:
       0    1
0  18026  123
1    510  133
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645254, 'precision': 0.8368925, 'recall': 0.626018, 'specificity': 0.626018, 'f1': 0.6790739, 'auroc': 0.7955549, 'binary_precision': 0.70526314, 'binary_recall': 0.256705, 'binary_specificity': 0.995331, 'binary_f1_score': 0.3764045}
confusion matrix:
      0   1
0  5969  28
1   194  67
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512108_8.png
new oracle model saved
early stop counter: 1
val acc:0.9663154482841492, best validation acc: 0.9673797488212585, corresponding to test acc:                         0.9632470607757568 / 0.9645254015922546
after epoch: 8,now: 2024-06-20 03:39:39.935663,epoch time: 0:31:58.297940,used: 4:23:15.375939,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_16_24_seed_0_21512108
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9868579, 'precision': 0.983987, 'recall': 0.93827456, 'specificity': 0.93827456, 'f1': 0.9597126, 'auroc': 0.9942229, 'binary_precision': 0.980531, 'binary_recall': 0.8783692, 'binary_specificity': 0.9981799, 'binary_f1_score': 0.9266428}
confusion matrix:
       0     1
0  42228    77
1    537  3878
---- Validation: 
scalar performance:
{'acc': 0.96695405, 'precision': 0.7607467, 'recall': 0.59211284, 'specificity': 0.59211284, 'f1': 0.63258433, 'auroc': 0.78304183, 'binary_precision': 0.5495495, 'binary_recall': 0.18973562, 'binary_specificity': 0.99449, 'binary_f1_score': 0.28208092}
confusion matrix:
       0    1
0  18049  100
1    521  122
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96212846, 'precision': 0.81611705, 'recall': 0.58995306, 'specificity': 0.58995306, 'f1': 0.6344175, 'auroc': 0.7786529, 'binary_precision': 0.6666667, 'binary_recall': 0.18390805, 'binary_specificity': 0.995998, 'binary_f1_score': 0.2882883}
confusion matrix:
      0   1
0  5973  24
1   213  48
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512108_9.png
early stop counter: 2
val acc:0.9669540524482727, best validation acc: 0.9673797488212585, corresponding to test acc:                         0.9632470607757568 / 0.9645254015922546
after epoch: 9,now: 2024-06-20 04:10:49.420689,epoch time: 0:31:09.485026,used: 4:54:24.860965,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_16_24_seed_0_21512108
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98784244, 'precision': 0.9807904, 'recall': 0.94712394, 'specificity': 0.94712394, 'f1': 0.96319014, 'auroc': 0.99331754, 'binary_precision': 0.9722495, 'binary_recall': 0.8969189, 'binary_specificity': 0.997329, 'binary_f1_score': 0.93306625}
confusion matrix:
       0     1
0  42193   113
1    455  3959
---- Validation: 
scalar performance:
{'acc': 0.9669008, 'precision': 0.7568321, 'recall': 0.6048362, 'specificity': 0.6048362, 'f1': 0.64596665, 'auroc': 0.79372746, 'binary_precision': 0.540856, 'binary_recall': 0.21617419, 'binary_specificity': 0.99349827, 'binary_f1_score': 0.30888888}
confusion matrix:
       0    1
0  18031  118
1    504  139
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96244806, 'precision': 0.8106981, 'recall': 0.6029461, 'specificity': 0.6029461, 'f1': 0.6497662, 'auroc': 0.79606473, 'binary_precision': 0.6547619, 'binary_recall': 0.21072797, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.31884056}
confusion matrix:
      0   1
0  5968  29
1   206  55
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512108_10.png
early stop counter: 3
val acc:0.9669008255004883, best validation acc: 0.9673797488212585, corresponding to test acc:                         0.9632470607757568 / 0.9645254015922546
after epoch: 10,now: 2024-06-20 04:42:31.942465,epoch time: 0:31:42.521776,used: 5:26:07.382741,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_16_24_seed_0_21512108
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.988506, 'precision': 0.98303366, 'recall': 0.9489107, 'specificity': 0.9489107, 'f1': 0.965188, 'auroc': 0.9943434, 'binary_precision': 0.976407, 'binary_recall': 0.90009063, 'binary_specificity': 0.9977308, 'binary_f1_score': 0.93669695}
confusion matrix:
       0     1
0  42210    96
1    441  3973
---- Validation: 
scalar performance:
{'acc': 0.9670072, 'precision': 0.75958294, 'recall': 0.6018911, 'specificity': 0.6018911, 'f1': 0.6432371, 'auroc': 0.79177403, 'binary_precision': 0.5465587, 'binary_recall': 0.20995334, 'binary_specificity': 0.99382883, 'binary_f1_score': 0.30337074}
confusion matrix:
       0    1
0  18037  112
1    508  135
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96196866, 'precision': 0.81154805, 'recall': 0.5898696, 'specificity': 0.5898696, 'f1': 0.6339441, 'auroc': 0.78317034, 'binary_precision': 0.65753424, 'binary_recall': 0.18390805, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.28742516}
confusion matrix:
      0   1
0  5972  25
1   213  48
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512108_11.png
early stop counter: 4
val acc:0.9670072197914124, best validation acc: 0.9673797488212585, corresponding to test acc:                         0.9632470607757568 / 0.9645254015922546
after epoch: 11,now: 2024-06-20 05:14:04.955743,epoch time: 0:31:33.013278,used: 5:57:40.396019,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_16_24_seed_0_21512108
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.989619, 'precision': 0.98536396, 'recall': 0.9532895, 'specificity': 0.9532895, 'f1': 0.96863884, 'auroc': 0.995216, 'binary_precision': 0.9802053, 'binary_recall': 0.90849376, 'binary_specificity': 0.9980853, 'binary_f1_score': 0.9429881}
confusion matrix:
       0     1
0  42224    81
1    404  4011
---- Validation: 
scalar performance:
{'acc': 0.96631545, 'precision': 0.74611264, 'recall': 0.59853274, 'specificity': 0.59853274, 'f1': 0.63774216, 'auroc': 0.7998574, 'binary_precision': 0.51984125, 'binary_recall': 0.2037325, 'binary_specificity': 0.993333, 'binary_f1_score': 0.29273742}
confusion matrix:
       0    1
0  18028  121
1    512  131
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608501, 'precision': 0.7865896, 'recall': 0.58378905, 'specificity': 0.58378905, 'f1': 0.62427175, 'auroc': 0.7888462, 'binary_precision': 0.6081081, 'binary_recall': 0.1724138, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.26865673}
confusion matrix:
      0   1
0  5968  29
1   216  45
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512108_12.png
early stop counter: 5
val acc:0.9663154482841492, best validation acc: 0.9673797488212585, corresponding to test acc:                         0.9632470607757568 / 0.9645254015922546
after epoch: 12,now: 2024-06-20 05:46:00.927116,epoch time: 0:31:55.971373,used: 6:29:36.367392,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_16_24_seed_0_21512108
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.989726, 'precision': 0.98627937, 'recall': 0.9530235, 'specificity': 0.9530235, 'f1': 0.96891284, 'auroc': 0.99431837, 'binary_precision': 0.98210347, 'binary_recall': 0.9077725, 'binary_specificity': 0.9982745, 'binary_f1_score': 0.94347626}
confusion matrix:
       0     1
0  42234    73
1    407  4006
---- Validation: 
scalar performance:
{'acc': 0.9668476, 'precision': 0.7598058, 'recall': 0.5860573, 'specificity': 0.5860573, 'f1': 0.62547994, 'auroc': 0.7977986, 'binary_precision': 0.5480769, 'binary_recall': 0.17729394, 'binary_specificity': 0.99482065, 'binary_f1_score': 0.2679201}
confusion matrix:
       0    1
0  18055   94
1    529  114
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606903, 'precision': 0.79549193, 'recall': 0.569047, 'specificity': 0.569047, 'f1': 0.60553974, 'auroc': 0.7800733, 'binary_precision': 0.62711865, 'binary_recall': 0.14176245, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.23125}
confusion matrix:
      0   1
0  5975  22
1   224  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512108_13.png
early stop counter: 6
val acc:0.9668475985527039, best validation acc: 0.9673797488212585, corresponding to test acc:                         0.9632470607757568 / 0.9645254015922546
after epoch: 13,now: 2024-06-20 06:19:02.276057,epoch time: 0:33:01.348941,used: 7:02:37.716333,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_16_24_seed_0_21512108
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99130994, 'precision': 0.98740435, 'recall': 0.96130633, 'specificity': 0.96130633, 'f1': 0.97390443, 'auroc': 0.99535024, 'binary_precision': 0.9826548, 'binary_recall': 0.9243145, 'binary_specificity': 0.99829817, 'binary_f1_score': 0.95259225}
confusion matrix:
       0     1
0  42235    72
1    334  4079
---- Validation: 
scalar performance:
{'acc': 0.9661026, 'precision': 0.74183995, 'recall': 0.60817325, 'specificity': 0.60817325, 'f1': 0.6469875, 'auroc': 0.8119908, 'binary_precision': 0.5106383, 'binary_recall': 0.22395024, 'binary_specificity': 0.9923963, 'binary_f1_score': 0.31135136}
confusion matrix:
       0    1
0  18011  138
1    499  144
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.763355, 'recall': 0.60361123, 'specificity': 0.60361123, 'f1': 0.64488196, 'auroc': 0.8043326, 'binary_precision': 0.56, 'binary_recall': 0.21455939, 'binary_specificity': 0.992663, 'binary_f1_score': 0.31024933}
confusion matrix:
      0   1
0  5953  44
1   205  56
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512108_14.png
early stop counter: 7
val acc:0.9661026000976562, best validation acc: 0.9673797488212585, corresponding to test acc:                         0.9632470607757568 / 0.9645254015922546
after epoch: 14,now: 2024-06-20 06:52:14.710171,epoch time: 0:33:12.434114,used: 7:35:50.150447,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_16_24_seed_0_21512108
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9906892, 'precision': 0.98742867, 'recall': 0.95761466, 'specificity': 0.95761466, 'f1': 0.97193134, 'auroc': 0.9958806, 'binary_precision': 0.9834711, 'binary_recall': 0.9168366, 'binary_specificity': 0.9983927, 'binary_f1_score': 0.94898564}
confusion matrix:
       0     1
0  42239    68
1    367  4046
---- Validation: 
scalar performance:
{'acc': 0.966688, 'precision': 0.75574344, 'recall': 0.5867247, 'specificity': 0.5867247, 'f1': 0.62582374, 'auroc': 0.8057989, 'binary_precision': 0.5399061, 'binary_recall': 0.17884915, 'binary_specificity': 0.99460024, 'binary_f1_score': 0.2686916}
confusion matrix:
       0    1
0  18051   98
1    528  115
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.76063347, 'recall': 0.572128, 'specificity': 0.572128, 'f1': 0.60744315, 'auroc': 0.7999892, 'binary_precision': 0.55714285, 'binary_recall': 0.14942528, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.23564956}
confusion matrix:
      0   1
0  5966  31
1   222  39
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512108_15.png
early stop counter: 8
val acc:0.9666879773139954, best validation acc: 0.9673797488212585, corresponding to test acc:                         0.9632470607757568 / 0.9645254015922546
after epoch: 15,now: 2024-06-20 07:25:33.999881,epoch time: 0:33:19.289710,used: 8:09:09.440157,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_16_24_seed_0_21512108
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99023974, 'precision': 0.9877854, 'recall': 0.9546366, 'specificity': 0.9546366, 'f1': 0.9704797, 'auroc': 0.9960184, 'binary_precision': 0.98481137, 'binary_recall': 0.9107386, 'binary_specificity': 0.9985345, 'binary_f1_score': 0.9463277}
confusion matrix:
       0     1
0  42244    62
1    394  4020
---- Validation: 
scalar performance:
{'acc': 0.9667944, 'precision': 0.75522494, 'recall': 0.6017809, 'specificity': 0.6017809, 'f1': 0.642503, 'auroc': 0.8225218, 'binary_precision': 0.5378486, 'binary_recall': 0.20995334, 'binary_specificity': 0.9936085, 'binary_f1_score': 0.30201343}
confusion matrix:
       0    1
0  18033  116
1    508  135
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959412, 'precision': 0.75554264, 'recall': 0.57570934, 'specificity': 0.57570934, 'f1': 0.6115969, 'auroc': 0.8016518, 'binary_precision': 0.5466667, 'binary_recall': 0.15708812, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.24404763}
confusion matrix:
      0   1
0  5963  34
1   220  41
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512108_16.png
early stop counter: 9
val acc:0.9667943716049194, best validation acc: 0.9673797488212585, corresponding to test acc:                         0.9632470607757568 / 0.9645254015922546
after epoch: 16,now: 2024-06-20 07:59:03.839606,epoch time: 0:33:29.839725,used: 8:42:39.279882,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_16_24_seed_0_21512108
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99086046, 'precision': 0.98659706, 'recall': 0.95946133, 'specificity': 0.95946133, 'f1': 0.97254026, 'auroc': 0.9962075, 'binary_precision': 0.98141444, 'binary_recall': 0.92074275, 'binary_specificity': 0.99817985, 'binary_f1_score': 0.95011103}
confusion matrix:
       0     1
0  42227    77
1    350  4066
---- Validation: 
scalar performance:
{'acc': 0.966688, 'precision': 0.7528871, 'recall': 0.6032259, 'specificity': 0.6032259, 'f1': 0.6436899, 'auroc': 0.8245362, 'binary_precision': 0.5330739, 'binary_recall': 0.21306376, 'binary_specificity': 0.99338806, 'binary_f1_score': 0.30444443}
confusion matrix:
       0    1
0  18029  120
1    506  137
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.77098584, 'recall': 0.5834555, 'specificity': 0.5834555, 'f1': 0.6225192, 'auroc': 0.80730355, 'binary_precision': 0.5769231, 'binary_recall': 0.1724138, 'binary_specificity': 0.99449724, 'binary_f1_score': 0.26548675}
confusion matrix:
      0   1
0  5964  33
1   216  45
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512108_17.png
early stop counter: 10
val acc:0.9666879773139954, best validation acc: 0.9673797488212585, corresponding to test acc:                         0.9632470607757568 / 0.9645254015922546
after epoch: 17,now: 2024-06-20 08:32:45.414086,epoch time: 0:33:41.574480,used: 9:16:20.854362,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_16_24_seed_0_21512108
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9910959, 'precision': 0.9835596, 'recall': 0.9638267, 'specificity': 0.9638267, 'f1': 0.9734344, 'auroc': 0.9958724, 'binary_precision': 0.97436506, 'binary_recall': 0.9302062, 'binary_specificity': 0.99744725, 'binary_f1_score': 0.95177364}
confusion matrix:
       0     1
0  42199   108
1    308  4105
---- Validation: 
scalar performance:
{'acc': 0.96706045, 'precision': 0.75678253, 'recall': 0.6236703, 'specificity': 0.6236703, 'f1': 0.6647307, 'auroc': 0.8323196, 'binary_precision': 0.5394737, 'binary_recall': 0.25505444, 'binary_specificity': 0.9922861, 'binary_f1_score': 0.34635693}
confusion matrix:
       0    1
0  18009  140
1    479  164
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.7596995, 'recall': 0.5850377, 'specificity': 0.5850377, 'f1': 0.6233693, 'auroc': 0.8117801, 'binary_precision': 0.55421686, 'binary_recall': 0.17624521, 'binary_specificity': 0.99383026, 'binary_f1_score': 0.26744184}
confusion matrix:
      0   1
0  5960  37
1   215  46
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512108_18.png
early stop counter: 11
val acc:0.9670604467391968, best validation acc: 0.9673797488212585, corresponding to test acc:                         0.9632470607757568 / 0.9645254015922546
after epoch: 18,now: 2024-06-20 09:09:04.662501,epoch time: 0:36:19.248415,used: 9:52:40.102777,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_16_24_seed_0_21512108
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99141693, 'precision': 0.98895144, 'recall': 0.9604696, 'specificity': 0.9604696, 'f1': 0.97417426, 'auroc': 0.9959896, 'binary_precision': 0.98595643, 'binary_recall': 0.9223103, 'binary_specificity': 0.998629, 'binary_f1_score': 0.95307195}
confusion matrix:
       0     1
0  42247    58
1    343  4072
---- Validation: 
scalar performance:
{'acc': 0.9669008, 'precision': 0.75951385, 'recall': 0.5920853, 'specificity': 0.5920853, 'f1': 0.63240767, 'auroc': 0.8222594, 'binary_precision': 0.5470852, 'binary_recall': 0.18973562, 'binary_specificity': 0.99443495, 'binary_f1_score': 0.2817552}
confusion matrix:
       0    1
0  18048  101
1    521  122
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.73158914, 'recall': 0.560467, 'specificity': 0.560467, 'f1': 0.5902111, 'auroc': 0.8035512, 'binary_precision': 0.5, 'binary_recall': 0.12643678, 'binary_specificity': 0.99449724, 'binary_f1_score': 0.20183487}
confusion matrix:
      0   1
0  5964  33
1   228  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512108_19.png
early stop counter: 12
val acc:0.9669008255004883, best validation acc: 0.9673797488212585, corresponding to test acc:                         0.9632470607757568 / 0.9645254015922546
after epoch: 19,now: 2024-06-20 09:47:32.118578,epoch time: 0:38:27.456077,used: 10:31:07.558854,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_16_24_seed_0_21512108
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9918022, 'precision': 0.9876143, 'recall': 0.9640058, 'specificity': 0.9640058, 'f1': 0.97544205, 'auroc': 0.99649143, 'binary_precision': 0.982515, 'binary_recall': 0.9297371, 'binary_specificity': 0.99827456, 'binary_f1_score': 0.9553977}
confusion matrix:
       0     1
0  42235    73
1    310  4102
---- Validation: 
scalar performance:
{'acc': 0.96695405, 'precision': 0.75998676, 'recall': 0.59511304, 'specificity': 0.59511304, 'f1': 0.63587195, 'auroc': 0.8240664, 'binary_precision': 0.5478261, 'binary_recall': 0.19595645, 'binary_specificity': 0.99426967, 'binary_f1_score': 0.28865978}
confusion matrix:
       0    1
0  18045  104
1    517  126
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579738, 'precision': 0.72295094, 'recall': 0.55297095, 'specificity': 0.55297095, 'f1': 0.57955956, 'auroc': 0.79996943, 'binary_precision': 0.48333332, 'binary_recall': 0.11111111, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.18068536}
confusion matrix:
      0   1
0  5966  31
1   232  29
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512108_20.png
early stop counter: 13
val acc:0.9669540524482727, best validation acc: 0.9673797488212585, corresponding to test acc:                         0.9632470607757568 / 0.9645254015922546
after epoch: 20,now: 2024-06-20 10:27:32.860469,epoch time: 0:40:00.741891,used: 11:11:08.300745,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_16_24_seed_0_21512108
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99203765, 'precision': 0.9869441, 'recall': 0.96607935, 'specificity': 0.96607935, 'f1': 0.9762244, 'auroc': 0.9956602, 'binary_precision': 0.9807326, 'binary_recall': 0.9340734, 'binary_specificity': 0.9980854, 'binary_f1_score': 0.9568345}
confusion matrix:
       0     1
0  42225    81
1    291  4123
---- Validation: 
scalar performance:
{'acc': 0.96663475, 'precision': 0.75157744, 'recall': 0.6054485, 'specificity': 0.6054485, 'f1': 0.6458074, 'auroc': 0.8230873, 'binary_precision': 0.530303, 'binary_recall': 0.21772939, 'binary_specificity': 0.99316764, 'binary_f1_score': 0.30871004}
confusion matrix:
       0    1
0  18025  124
1    503  140
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95733464, 'precision': 0.7093628, 'recall': 0.55630213, 'specificity': 0.55630213, 'f1': 0.5832706, 'auroc': 0.80476403, 'binary_precision': 0.45588234, 'binary_recall': 0.118773945, 'binary_specificity': 0.99383026, 'binary_f1_score': 0.18844984}
confusion matrix:
      0   1
0  5960  37
1   230  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512108_21.png
early stop counter: 14
val acc:0.9666347503662109, best validation acc: 0.9673797488212585, corresponding to test acc:                         0.9632470607757568 / 0.9645254015922546
after epoch: 21,now: 2024-06-20 11:11:57.977980,epoch time: 0:44:25.117511,used: 11:55:33.418256,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_16_24_seed_0_21512108
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99238014, 'precision': 0.98933244, 'recall': 0.9657233, 'specificity': 0.9657233, 'f1': 0.9771613, 'auroc': 0.9963602, 'binary_precision': 0.98562187, 'binary_recall': 0.9328646, 'binary_specificity': 0.99858195, 'binary_f1_score': 0.95851785}
confusion matrix:
       0     1
0  42251    60
1    296  4113
---- Validation: 
scalar performance:
{'acc': 0.96722007, 'precision': 0.76708174, 'recall': 0.5922506, 'specificity': 0.5922506, 'f1': 0.6334736, 'auroc': 0.82251555, 'binary_precision': 0.562212, 'binary_recall': 0.18973562, 'binary_specificity': 0.9947656, 'binary_f1_score': 0.2837209}
confusion matrix:
       0    1
0  18054   95
1    521  122
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9574944, 'precision': 0.70993954, 'recall': 0.5490562, 'specificity': 0.5490562, 'f1': 0.57346976, 'auroc': 0.79610527, 'binary_precision': 0.45762712, 'binary_recall': 0.10344828, 'binary_specificity': 0.994664, 'binary_f1_score': 0.16875002}
confusion matrix:
      0   1
0  5965  32
1   234  27
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512108_22.png
early stop counter: 15
val acc:0.9672200679779053, best validation acc: 0.9673797488212585, corresponding to test acc:                         0.9632470607757568 / 0.9645254015922546
after epoch: 22,now: 2024-06-20 11:54:56.538283,epoch time: 0:42:58.560303,used: 12:38:31.978559,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_16_24_seed_0_21512108
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9914812, 'precision': 0.9865806, 'recall': 0.9631342, 'specificity': 0.9631342, 'f1': 0.9744935, 'auroc': 0.9962973, 'binary_precision': 0.98061275, 'binary_recall': 0.9281831, 'binary_specificity': 0.9980854, 'binary_f1_score': 0.95367783}
confusion matrix:
       0     1
0  42225    81
1    317  4097
---- Validation: 
scalar performance:
{'acc': 0.96695405, 'precision': 0.7587929, 'recall': 0.60036343, 'specificity': 0.60036343, 'f1': 0.6414825, 'auroc': 0.8291997, 'binary_precision': 0.545082, 'binary_recall': 0.20684293, 'binary_specificity': 0.99388397, 'binary_f1_score': 0.29988727}
confusion matrix:
       0    1
0  18038  111
1    510  133
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9576542, 'precision': 0.7162761, 'recall': 0.55646884, 'specificity': 0.55646884, 'f1': 0.58393073, 'auroc': 0.8002373, 'binary_precision': 0.46969697, 'binary_recall': 0.118773945, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.18960243}
confusion matrix:
      0   1
0  5962  35
1   230  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512108_23.png
early stop counter: 16
val acc:0.9669540524482727, best validation acc: 0.9673797488212585, corresponding to test acc:                         0.9632470607757568 / 0.9645254015922546
after epoch: 23,now: 2024-06-20 12:35:59.045817,epoch time: 0:41:02.507534,used: 13:19:34.486093,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_16_24_seed_0_21512108
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9921233, 'precision': 0.98588246, 'recall': 0.96766263, 'specificity': 0.96766263, 'f1': 0.9765534, 'auroc': 0.996669, 'binary_precision': 0.9782609, 'binary_recall': 0.9375, 'binary_specificity': 0.99782526, 'binary_f1_score': 0.9574468}
confusion matrix:
       0     1
0  42212    92
1    276  4140
---- Validation: 
scalar performance:
{'acc': 0.9665283, 'precision': 0.74923337, 'recall': 0.60914373, 'specificity': 0.60914373, 'f1': 0.6492026, 'auroc': 0.83382547, 'binary_precision': 0.5253623, 'binary_recall': 0.22550544, 'binary_specificity': 0.992782, 'binary_f1_score': 0.3155604}
confusion matrix:
       0    1
0  18018  131
1    498  145
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9574944, 'precision': 0.7145259, 'recall': 0.5618825, 'specificity': 0.5618825, 'f1': 0.59087867, 'auroc': 0.8040137, 'binary_precision': 0.46575344, 'binary_recall': 0.1302682, 'binary_specificity': 0.9934968, 'binary_f1_score': 0.2035928}
confusion matrix:
      0   1
0  5958  39
1   227  34
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512108_24.png
early stop counter: 17
val acc:0.9665282964706421, best validation acc: 0.9673797488212585, corresponding to test acc:                         0.9632470607757568 / 0.9645254015922546
after epoch: 24,now: 2024-06-20 13:14:08.778304,epoch time: 0:38:09.732487,used: 13:57:44.218580,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_16_24_seed_0_21512108
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9921447, 'precision': 0.9895087, 'recall': 0.9642108, 'specificity': 0.9642108, 'f1': 0.97643834, 'auroc': 0.99627304, 'binary_precision': 0.98630136, 'binary_recall': 0.9297689, 'binary_specificity': 0.9986527, 'binary_f1_score': 0.9572012}
confusion matrix:
       0     1
0  42249    57
1    310  4104
---- Validation: 
scalar performance:
{'acc': 0.967433, 'precision': 0.77205074, 'recall': 0.59311086, 'specificity': 0.59311086, 'f1': 0.6350247, 'auroc': 0.8271571, 'binary_precision': 0.572093, 'binary_recall': 0.19129083, 'binary_specificity': 0.99493086, 'binary_f1_score': 0.28671327}
confusion matrix:
       0    1
0  18057   92
1    520  123
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.957814, 'precision': 0.71683216, 'recall': 0.5455582, 'specificity': 0.5455582, 'f1': 0.5688, 'auroc': 0.8060806, 'binary_precision': 0.4716981, 'binary_recall': 0.09578544, 'binary_specificity': 0.995331, 'binary_f1_score': 0.15923567}
confusion matrix:
      0   1
0  5969  28
1   236  25
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512108_25.png
better model found
persisted
after epoch: 25,now: 2024-06-20 13:52:18.424037,epoch time: 0:38:09.645733,used: 14:35:53.864313,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_16_24_seed_0_21512108
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9922089, 'precision': 0.9883981, 'recall': 0.96566665, 'specificity': 0.96566665, 'f1': 0.97669196, 'auroc': 0.99700856, 'binary_precision': 0.98375535, 'binary_recall': 0.93294066, 'binary_specificity': 0.99839264, 'binary_f1_score': 0.9576744}
confusion matrix:
       0     1
0  42238    68
1    296  4118
---- Validation: 
scalar performance:
{'acc': 0.9673265, 'precision': 0.7670827, 'recall': 0.59980625, 'specificity': 0.59980625, 'f1': 0.6419779, 'auroc': 0.830041, 'binary_precision': 0.56170213, 'binary_recall': 0.20528771, 'binary_specificity': 0.99432474, 'binary_f1_score': 0.30068338}
confusion matrix:
       0    1
0  18046  103
1    511  132
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.73143965, 'recall': 0.55680233, 'specificity': 0.55680233, 'f1': 0.5852724, 'auroc': 0.80182076, 'binary_precision': 0.5, 'binary_recall': 0.118773945, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.19195047}
confusion matrix:
      0   1
0  5966  31
1   230  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512108_26.png
early stop counter: 1
val acc:0.9673265218734741, best validation acc: 0.967432975769043, corresponding to test acc:                         0.9578139781951904 / 0.9645254015922546
after epoch: 26,now: 2024-06-20 14:35:48.106293,epoch time: 0:43:29.682256,used: 15:19:23.546569,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_16_24_seed_0_21512108
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9931935, 'precision': 0.98912495, 'recall': 0.97076946, 'specificity': 0.97076946, 'f1': 0.97972643, 'auroc': 0.99722815, 'binary_precision': 0.984157, 'binary_recall': 0.94312257, 'binary_specificity': 0.99841636, 'binary_f1_score': 0.96320295}
confusion matrix:
       0     1
0  42240    67
1    251  4162
---- Validation: 
scalar performance:
{'acc': 0.9671669, 'precision': 0.76655924, 'recall': 0.58997285, 'specificity': 0.58997285, 'f1': 0.63078195, 'auroc': 0.8286854, 'binary_precision': 0.5613208, 'binary_recall': 0.18506998, 'binary_specificity': 0.9948757, 'binary_f1_score': 0.27836257}
confusion matrix:
       0    1
0  18056   93
1    524  119
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581336, 'precision': 0.7265927, 'recall': 0.54938966, 'specificity': 0.54938966, 'f1': 0.57470536, 'auroc': 0.8009633, 'binary_precision': 0.4909091, 'binary_recall': 0.10344828, 'binary_specificity': 0.995331, 'binary_f1_score': 0.17088608}
confusion matrix:
      0   1
0  5969  28
1   234  27
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512108_27.png
early stop counter: 2
val acc:0.9671669006347656, best validation acc: 0.967432975769043, corresponding to test acc:                         0.9578139781951904 / 0.9645254015922546
after epoch: 27,now: 2024-06-20 15:21:38.630751,epoch time: 0:45:50.524458,used: 16:05:14.071027,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_16_24_seed_0_21512108
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9932791, 'precision': 0.98887706, 'recall': 0.9715458, 'specificity': 0.9715458, 'f1': 0.9800147, 'auroc': 0.9968617, 'binary_precision': 0.98349833, 'binary_recall': 0.9447464, 'binary_specificity': 0.9983453, 'binary_f1_score': 0.96373296}
confusion matrix:
       0     1
0  42234    70
1    244  4172
---- Validation: 
scalar performance:
{'acc': 0.9671669, 'precision': 0.7633382, 'recall': 0.60047364, 'specificity': 0.60047364, 'f1': 0.64221716, 'auroc': 0.83349603, 'binary_precision': 0.5541667, 'binary_recall': 0.20684293, 'binary_specificity': 0.9941044, 'binary_f1_score': 0.30124578}
confusion matrix:
       0    1
0  18042  107
1    510  133
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95733464, 'precision': 0.70700395, 'recall': 0.5508051, 'specificity': 0.5508051, 'f1': 0.57573843, 'auroc': 0.80555415, 'binary_precision': 0.4516129, 'binary_recall': 0.107279696, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.17337461}
confusion matrix:
      0   1
0  5963  34
1   233  28
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512108_28.png
early stop counter: 3
val acc:0.9671669006347656, best validation acc: 0.967432975769043, corresponding to test acc:                         0.9578139781951904 / 0.9645254015922546
after epoch: 28,now: 2024-06-20 15:44:29.604794,epoch time: 0:22:50.974043,used: 16:28:05.045070,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_16_24_seed_0_21512108
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.992637, 'precision': 0.9887701, 'recall': 0.96781653, 'specificity': 0.96781653, 'f1': 0.9780048, 'auroc': 0.9974512, 'binary_precision': 0.9840552, 'binary_recall': 0.9372167, 'binary_specificity': 0.99841636, 'binary_f1_score': 0.960065}
confusion matrix:
       0     1
0  42241    67
1    277  4135
---- Validation: 
scalar performance:
{'acc': 0.96780545, 'precision': 0.781273, 'recall': 0.59405375, 'specificity': 0.59405375, 'f1': 0.6371337, 'auroc': 0.8325291, 'binary_precision': 0.5904762, 'binary_recall': 0.19284603, 'binary_specificity': 0.99526143, 'binary_f1_score': 0.29073858}
confusion matrix:
       0    1
0  18063   86
1    519  124
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95733464, 'precision': 0.6994263, 'recall': 0.53797877, 'specificity': 0.53797877, 'f1': 0.55702484, 'auroc': 0.7950222, 'binary_precision': 0.4375, 'binary_recall': 0.08045977, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.13592233}
confusion matrix:
      0   1
0  5970  27
1   240  21
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512108_29.png
better model found
persisted
after epoch: 29,now: 2024-06-20 16:10:13.488580,epoch time: 0:25:43.883786,used: 16:53:48.928856,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_16_24_seed_0_21512108
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9931507, 'precision': 0.98666394, 'recall': 0.97299016, 'specificity': 0.97299016, 'f1': 0.9797043, 'auroc': 0.99723923, 'binary_precision': 0.9787234, 'binary_recall': 0.9481314, 'binary_specificity': 0.9978489, 'binary_f1_score': 0.96318454}
confusion matrix:
       0     1
0  42214    91
1    229  4186
---- Validation: 
scalar performance:
{'acc': 0.9669008, 'precision': 0.7557248, 'recall': 0.6115867, 'specificity': 0.6115867, 'f1': 0.65273803, 'auroc': 0.83636105, 'binary_precision': 0.53818184, 'binary_recall': 0.23017107, 'binary_specificity': 0.99300236, 'binary_f1_score': 0.3224401}
confusion matrix:
       0    1
0  18022  127
1    495  148
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95653564, 'precision': 0.6948148, 'recall': 0.55771756, 'specificity': 0.55771756, 'f1': 0.58407223, 'auroc': 0.79984534, 'binary_precision': 0.42666668, 'binary_recall': 0.12260536, 'binary_specificity': 0.99282974, 'binary_f1_score': 0.19047618}
confusion matrix:
      0   1
0  5954  43
1   229  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512108_30.png
early stop counter: 1
val acc:0.9669008255004883, best validation acc: 0.9678054451942444, corresponding to test acc:                         0.9573346376419067 / 0.9645254015922546
after epoch: 30,now: 2024-06-20 16:32:05.401126,epoch time: 0:21:51.912546,used: 17:15:40.841402,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_16_24_seed_0_21512108
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 17:15:40.841402 at 2024-06-20 16:32:05.401126
persisted model performance metric: 

scalar performance:
{'acc': 0.95733464, 'precision': 0.6994263, 'recall': 0.53797877, 'specificity': 0.53797877, 'f1': 0.55702484, 'auroc': 0.7950222, 'binary_precision': 0.4375, 'binary_recall': 0.08045977, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.13592233}
confusion matrix:
      0   1
0  5970  27
1   240  21
oracle model performance metric: 

scalar performance:
{'acc': 0.9645254, 'precision': 0.8368925, 'recall': 0.626018, 'specificity': 0.626018, 'f1': 0.6790739, 'auroc': 0.7955549, 'binary_precision': 0.70526314, 'binary_recall': 0.256705, 'binary_specificity': 0.995331, 'binary_f1_score': 0.3764045}
confusion matrix:
      0   1
0  5969  28
1   194  67
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_irm_resnet_different_bs128_lre4_classbalancing/rule_results/4.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_irm_resnet_different_bs128_lre4_classbalancing/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_irm_resnet_different_bs128_lre4_classbalancing/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204097 KiB |   1730 MiB | 377597 GiB | 377597 GiB |
|       from large pool | 167936 KiB |   1660 MiB | 377491 GiB | 377491 GiB |
|       from small pool |  36161 KiB |     72 MiB |    106 GiB |    106 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 204097 KiB |   1730 MiB | 377597 GiB | 377597 GiB |
|       from large pool | 167936 KiB |   1660 MiB | 377491 GiB | 377491 GiB |
|       from small pool |  36161 KiB |     72 MiB |    106 GiB |    106 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201088 KiB |   1723 MiB | 377581 GiB | 377581 GiB |
|       from large pool | 165120 KiB |   1653 MiB | 377477 GiB | 377477 GiB |
|       from small pool |  35968 KiB |     71 MiB |    104 GiB |    104 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1876 MiB |   1876 MiB |   1876 MiB |      0 B   |
|       from large pool |   1802 MiB |   1802 MiB |   1802 MiB |      0 B   |
|       from small pool |     74 MiB |     74 MiB |     74 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 404158 KiB | 758032 KiB | 265696 GiB | 265695 GiB |
|       from large pool | 397312 KiB | 756864 KiB | 265586 GiB | 265586 GiB |
|       from small pool |   6846 KiB |  12716 KiB |    109 GiB |    109 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1194    |    1851    |   11322 K  |   11321 K  |
|       from large pool |      36    |      76    |    3587 K  |    3587 K  |
|       from small pool |    1158    |    1780    |    7734 K  |    7733 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1194    |    1851    |   11322 K  |   11321 K  |
|       from large pool |      36    |      76    |    3587 K  |    3587 K  |
|       from small pool |    1158    |    1780    |    7734 K  |    7733 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      50    |      50    |      50    |       0    |
|       from large pool |      13    |      13    |      13    |       0    |
|       from small pool |      37    |      37    |      37    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      28    |     378    |    5676 K  |    5676 K  |
|       from large pool |       5    |      10    |    1353 K  |    1353 K  |
|       from small pool |      23    |     373    |    4323 K  |    4323 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1730 MiB | 377597 GiB | 377597 GiB |
|       from large pool |  16640 KiB |   1660 MiB | 377491 GiB | 377491 GiB |
|       from small pool |      0 KiB |     72 MiB |    106 GiB |    106 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1730 MiB | 377597 GiB | 377597 GiB |
|       from large pool |  16640 KiB |   1660 MiB | 377491 GiB | 377491 GiB |
|       from small pool |      0 KiB |     72 MiB |    106 GiB |    106 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1723 MiB | 377581 GiB | 377581 GiB |
|       from large pool |  16640 KiB |   1653 MiB | 377477 GiB | 377477 GiB |
|       from small pool |      0 KiB |     71 MiB |    104 GiB |    104 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 608256 KiB |   1876 MiB |   1876 MiB |   1282 MiB |
|       from large pool | 565248 KiB |   1802 MiB |   1802 MiB |   1250 MiB |
|       from small pool |  43008 KiB |     74 MiB |     74 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 384768 KiB | 758032 KiB | 265696 GiB | 265695 GiB |
|       from large pool | 384768 KiB | 756864 KiB | 265586 GiB | 265586 GiB |
|       from small pool |      0 KiB |  14441 KiB |    109 GiB |    109 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1851    |   11322 K  |   11322 K  |
|       from large pool |       2    |      76    |    3587 K  |    3587 K  |
|       from small pool |       0    |    1780    |    7734 K  |    7734 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1851    |   11322 K  |   11322 K  |
|       from large pool |       2    |      76    |    3587 K  |    3587 K  |
|       from small pool |       0    |    1780    |    7734 K  |    7734 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      30    |      50    |      50    |      20    |
|       from large pool |       9    |      13    |      13    |       4    |
|       from small pool |      21    |      37    |      37    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     378    |    5676 K  |    5676 K  |
|       from large pool |       1    |      11    |    1353 K  |    1353 K  |
|       from small pool |       0    |     373    |    4323 K  |    4323 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1730 MiB | 377597 GiB | 377597 GiB |
|       from large pool |  16640 KiB |   1660 MiB | 377491 GiB | 377491 GiB |
|       from small pool |      0 KiB |     72 MiB |    106 GiB |    106 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1730 MiB | 377597 GiB | 377597 GiB |
|       from large pool |  16640 KiB |   1660 MiB | 377491 GiB | 377491 GiB |
|       from small pool |      0 KiB |     72 MiB |    106 GiB |    106 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1723 MiB | 377581 GiB | 377581 GiB |
|       from large pool |  16640 KiB |   1653 MiB | 377477 GiB | 377477 GiB |
|       from small pool |      0 KiB |     71 MiB |    104 GiB |    104 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 608256 KiB |   1876 MiB |   1876 MiB |   1282 MiB |
|       from large pool | 565248 KiB |   1802 MiB |   1802 MiB |   1250 MiB |
|       from small pool |  43008 KiB |     74 MiB |     74 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 384768 KiB | 758032 KiB | 265696 GiB | 265695 GiB |
|       from large pool | 384768 KiB | 756864 KiB | 265586 GiB | 265586 GiB |
|       from small pool |      0 KiB |  14441 KiB |    109 GiB |    109 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1851    |   11322 K  |   11322 K  |
|       from large pool |       2    |      76    |    3587 K  |    3587 K  |
|       from small pool |       0    |    1780    |    7734 K  |    7734 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1851    |   11322 K  |   11322 K  |
|       from large pool |       2    |      76    |    3587 K  |    3587 K  |
|       from small pool |       0    |    1780    |    7734 K  |    7734 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      30    |      50    |      50    |      20    |
|       from large pool |       9    |      13    |      13    |       4    |
|       from small pool |      21    |      37    |      37    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     378    |    5676 K  |    5676 K  |
|       from large pool |       1    |      11    |    1353 K  |    1353 K  |
|       from small pool |       0    |     373    |    4323 K  |    4323 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0




!!!: not committed yet



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_38_28_seed_1_21512108

 Experiment start at: 2024-06-20 16:38:28.117594
before training, model accuracy: 0.1456654816865921
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9354024, 'precision': 0.93342364, 'recall': 0.66181695, 'specificity': 0.66181695, 'f1': 0.72429544, 'auroc': 0.93255246, 'binary_precision': 0.9313078, 'binary_recall': 0.32608697, 'binary_specificity': 0.9975469, 'binary_f1_score': 0.48304215}
confusion matrix:
       0     1
0  42292   104
1   2914  1410
---- Validation: 
scalar performance:
{'acc': 0.9639808, 'precision': 0.48204184, 'recall': 0.49994466, 'specificity': 0.49994466, 'f1': 0.49083003, 'auroc': 0.49623767, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998893, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18065  2
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.48610198, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512108_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-20 16:59:27.527073,epoch time: 0:20:59.409479,used: 0:20:59.409479,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_38_28_seed_1_21512108
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9686858, 'precision': 0.97726107, 'recall': 0.8348501, 'specificity': 0.8348501, 'f1': 0.89082325, 'auroc': 0.97047234, 'binary_precision': 0.98707044, 'binary_recall': 0.6705964, 'binary_specificity': 0.99910367, 'binary_f1_score': 0.79862356}
confusion matrix:
       0     1
0  42356    38
1   1425  2901
---- Validation: 
scalar performance:
{'acc': 0.9648879, 'precision': 0.8398213, 'recall': 0.5182968, 'specificity': 0.5182968, 'f1': 0.52636373, 'auroc': 0.6385957, 'binary_precision': 0.71428573, 'binary_recall': 0.0371471, 'binary_specificity': 0.9994465, 'binary_f1_score': 0.07062147}
confusion matrix:
       0   1
0  18057  10
1    648  25
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9577828, 'precision': 0.6458602, 'recall': 0.5035098, 'specificity': 0.5035098, 'f1': 0.49673337, 'auroc': 0.69468296, 'binary_precision': 0.33333334, 'binary_recall': 0.0076923077, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.015037594}
confusion matrix:
      0  1
0  5942  4
1   258  2
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512108_2.png
better model found
persisted
after epoch: 2,now: 2024-06-20 17:16:17.750333,epoch time: 0:16:50.223260,used: 0:37:49.632739,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_38_28_seed_1_21512108
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9769264, 'precision': 0.9832555, 'recall': 0.8785659, 'specificity': 0.8785659, 'f1': 0.9230948, 'auroc': 0.98166114, 'binary_precision': 0.9906288, 'binary_recall': 0.7578631, 'binary_specificity': 0.9992688, 'binary_f1_score': 0.8587526}
confusion matrix:
       0     1
0  42365    31
1   1047  3277
---- Validation: 
scalar performance:
{'acc': 0.9655283, 'precision': 0.81107414, 'recall': 0.54151744, 'specificity': 0.54151744, 'f1': 0.5662037, 'auroc': 0.68663716, 'binary_precision': 0.6551724, 'binary_recall': 0.08469539, 'binary_specificity': 0.99833953, 'binary_f1_score': 0.14999999}
confusion matrix:
       0   1
0  18037  30
1    616  57
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589107, 'precision': 0.77655196, 'recall': 0.5298442, 'specificity': 0.5298442, 'f1': 0.54523367, 'auroc': 0.71719384, 'binary_precision': 0.5925926, 'binary_recall': 0.06153846, 'binary_specificity': 0.99815, 'binary_f1_score': 0.11149825}
confusion matrix:
      0   1
0  5935  11
1   244  16
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512108_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-20 17:33:45.910059,epoch time: 0:17:28.159726,used: 0:55:17.792465,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_38_28_seed_1_21512108
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.981143, 'precision': 0.98119843, 'recall': 0.90506226, 'specificity': 0.90506226, 'f1': 0.9390838, 'auroc': 0.9861305, 'binary_precision': 0.981264, 'binary_recall': 0.8117048, 'binary_specificity': 0.9984197, 'binary_f1_score': 0.8884669}
confusion matrix:
       0     1
0  42330    67
1    814  3509
---- Validation: 
scalar performance:
{'acc': 0.9659018, 'precision': 0.7917806, 'recall': 0.56603026, 'specificity': 0.56603026, 'f1': 0.6021249, 'auroc': 0.7306135, 'binary_precision': 0.6148649, 'binary_recall': 0.13521545, 'binary_specificity': 0.99684507, 'binary_f1_score': 0.22168088}
confusion matrix:
       0   1
0  18010  57
1    582  91
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96132773, 'precision': 0.8451359, 'recall': 0.5605294, 'specificity': 0.5605294, 'f1': 0.59535235, 'auroc': 0.755407, 'binary_precision': 0.72727275, 'binary_recall': 0.12307692, 'binary_specificity': 0.99798185, 'binary_f1_score': 0.21052632}
confusion matrix:
      0   1
0  5934  12
1   228  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512108_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-20 17:49:58.924727,epoch time: 0:16:13.014668,used: 1:11:30.807133,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_38_28_seed_1_21512108
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9829195, 'precision': 0.982725, 'recall': 0.9144093, 'specificity': 0.9144093, 'f1': 0.94534355, 'auroc': 0.9884068, 'binary_precision': 0.98249453, 'binary_recall': 0.8303282, 'binary_specificity': 0.99849033, 'binary_f1_score': 0.900025}
confusion matrix:
       0     1
0  42330    64
1    734  3592
---- Validation: 
scalar performance:
{'acc': 0.96611524, 'precision': 0.7859572, 'recall': 0.58116156, 'specificity': 0.58116156, 'f1': 0.6217143, 'auroc': 0.7552229, 'binary_precision': 0.60215056, 'binary_recall': 0.16641901, 'binary_specificity': 0.99590415, 'binary_f1_score': 0.26076832}
confusion matrix:
       0    1
0  17993   74
1    561  112
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96406704, 'precision': 0.8797328, 'recall': 0.59506065, 'specificity': 0.59506065, 'f1': 0.6455755, 'auroc': 0.7833495, 'binary_precision': 0.7936508, 'binary_recall': 0.1923077, 'binary_specificity': 0.99781364, 'binary_f1_score': 0.30959752}
confusion matrix:
      0   1
0  5933  13
1   210  50
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512108_5.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-06-20 18:05:43.459964,epoch time: 0:15:44.535237,used: 1:27:15.342370,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_38_28_seed_1_21512108
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98461044, 'precision': 0.97862697, 'recall': 0.9281454, 'specificity': 0.9281454, 'f1': 0.9516369, 'auroc': 0.99077344, 'binary_precision': 0.97147346, 'binary_recall': 0.8588616, 'binary_specificity': 0.99742913, 'binary_f1_score': 0.9117032}
confusion matrix:
       0     1
0  42289   109
1    610  3712
---- Validation: 
scalar performance:
{'acc': 0.96611524, 'precision': 0.78002286, 'recall': 0.59046006, 'specificity': 0.59046006, 'f1': 0.63256687, 'auroc': 0.7711906, 'binary_precision': 0.5896226, 'binary_recall': 0.18573551, 'binary_specificity': 0.9951846, 'binary_f1_score': 0.28248587}
confusion matrix:
       0    1
0  17980   87
1    548  125
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96455044, 'precision': 0.85867614, 'recall': 0.61370283, 'specificity': 0.61370283, 'f1': 0.6673586, 'auroc': 0.78982913, 'binary_precision': 0.75, 'binary_recall': 0.23076923, 'binary_specificity': 0.9966364, 'binary_f1_score': 0.3529412}
confusion matrix:
      0   1
0  5926  20
1   200  60
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512108_6.png
new oracle model saved
early stop counter: 1
val acc:0.9661152362823486, best validation acc: 0.9661152362823486, corresponding to test acc:                         0.9640670418739319 / 0.9645504355430603
after epoch: 6,now: 2024-06-20 18:22:49.059362,epoch time: 0:17:05.599398,used: 1:44:20.941768,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_38_28_seed_1_21512108
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.985488, 'precision': 0.979257, 'recall': 0.9329189, 'specificity': 0.9329189, 'f1': 0.95462155, 'auroc': 0.99138963, 'binary_precision': 0.9717909, 'binary_recall': 0.86840886, 'binary_specificity': 0.997429, 'binary_f1_score': 0.9171959}
confusion matrix:
       0     1
0  42287   109
1    569  3755
---- Validation: 
scalar performance:
{'acc': 0.9663287, 'precision': 0.7811465, 'recall': 0.5984387, 'specificity': 0.5984387, 'f1': 0.64198345, 'auroc': 0.7744265, 'binary_precision': 0.59130436, 'binary_recall': 0.20208023, 'binary_specificity': 0.99479717, 'binary_f1_score': 0.30121815}
confusion matrix:
       0    1
0  17973   94
1    537  136
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9634225, 'precision': 0.828485, 'recall': 0.6131142, 'specificity': 0.6131142, 'f1': 0.6635033, 'auroc': 0.78239536, 'binary_precision': 0.6896552, 'binary_recall': 0.23076923, 'binary_specificity': 0.99545914, 'binary_f1_score': 0.34582132}
confusion matrix:
      0   1
0  5919  27
1   200  60
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512108_7.png
better model found
persisted
after epoch: 7,now: 2024-06-20 18:39:00.932248,epoch time: 0:16:11.872886,used: 2:00:32.814654,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_38_28_seed_1_21512108
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9865796, 'precision': 0.98324335, 'recall': 0.93577564, 'specificity': 0.93577564, 'f1': 0.9579839, 'auroc': 0.9925077, 'binary_precision': 0.97924775, 'binary_recall': 0.87343824, 'binary_specificity': 0.9981131, 'binary_f1_score': 0.92332155}
confusion matrix:
       0     1
0  42318    80
1    547  3775
---- Validation: 
scalar performance:
{'acc': 0.96659553, 'precision': 0.7860292, 'recall': 0.6014381, 'specificity': 0.6014381, 'f1': 0.6459674, 'auroc': 0.7875018, 'binary_precision': 0.6008584, 'binary_recall': 0.20802377, 'binary_specificity': 0.9948525, 'binary_f1_score': 0.30905077}
confusion matrix:
       0    1
0  17974   93
1    533  140
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96455044, 'precision': 0.8428304, 'recall': 0.6247367, 'specificity': 0.6247367, 'f1': 0.67837894, 'auroc': 0.8024252, 'binary_precision': 0.7173913, 'binary_recall': 0.25384617, 'binary_specificity': 0.9956273, 'binary_f1_score': 0.375}
confusion matrix:
      0   1
0  5920  26
1   194  66
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512108_8.png
better model found
persisted
after epoch: 8,now: 2024-06-20 18:55:56.492843,epoch time: 0:16:55.560595,used: 2:17:28.375249,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_38_28_seed_1_21512108
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9883134, 'precision': 0.98199177, 'recall': 0.94743204, 'specificity': 0.94743204, 'f1': 0.9639098, 'auroc': 0.9931022, 'binary_precision': 0.97437185, 'binary_recall': 0.8972698, 'binary_specificity': 0.99759424, 'binary_f1_score': 0.9342327}
confusion matrix:
       0     1
0  42296   102
1    444  3878
---- Validation: 
scalar performance:
{'acc': 0.9664888, 'precision': 0.7802943, 'recall': 0.60782015, 'specificity': 0.60782015, 'f1': 0.65231705, 'auroc': 0.800249, 'binary_precision': 0.5889328, 'binary_recall': 0.22139673, 'binary_specificity': 0.9942436, 'binary_f1_score': 0.32181424}
confusion matrix:
       0    1
0  17963  104
1    524  149
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96471155, 'precision': 0.8467747, 'recall': 0.6248208, 'specificity': 0.6248208, 'f1': 0.6789553, 'auroc': 0.80659413, 'binary_precision': 0.72527474, 'binary_recall': 0.25384617, 'binary_specificity': 0.9957955, 'binary_f1_score': 0.37606838}
confusion matrix:
      0   1
0  5921  25
1   194  66
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512108_9.png
new oracle model saved
early stop counter: 1
val acc:0.966488778591156, best validation acc: 0.9665955305099487, corresponding to test acc:                         0.9645504355430603 / 0.9647115468978882
after epoch: 9,now: 2024-06-20 19:13:00.930508,epoch time: 0:17:04.437665,used: 2:34:32.812914,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_38_28_seed_1_21512108
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98777825, 'precision': 0.98392653, 'recall': 0.942358, 'specificity': 0.942358, 'f1': 0.9619802, 'auroc': 0.9938835, 'binary_precision': 0.9792998, 'binary_recall': 0.88662654, 'binary_specificity': 0.99808955, 'binary_f1_score': 0.93066186}
confusion matrix:
       0     1
0  42317    81
1    490  3832
---- Validation: 
scalar performance:
{'acc': 0.9666489, 'precision': 0.7877493, 'recall': 0.6007505, 'specificity': 0.6007505, 'f1': 0.6453877, 'auroc': 0.80584586, 'binary_precision': 0.6043478, 'binary_recall': 0.20653789, 'binary_specificity': 0.99496317, 'binary_f1_score': 0.30786267}
confusion matrix:
       0    1
0  17976   91
1    534  139
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9634225, 'precision': 0.8264305, 'recall': 0.61495316, 'specificity': 0.61495316, 'f1': 0.6653762, 'auroc': 0.8146315, 'binary_precision': 0.6853933, 'binary_recall': 0.23461539, 'binary_specificity': 0.99529094, 'binary_f1_score': 0.3495702}
confusion matrix:
      0   1
0  5918  28
1   199  61
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512108_10.png
better model found
persisted
after epoch: 10,now: 2024-06-20 19:31:05.275257,epoch time: 0:18:04.344749,used: 2:52:37.157663,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_38_28_seed_1_21512108
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98814213, 'precision': 0.9830795, 'recall': 0.9454131, 'specificity': 0.9454131, 'f1': 0.9632932, 'auroc': 0.99324965, 'binary_precision': 0.97698534, 'binary_recall': 0.8929727, 'binary_specificity': 0.99785346, 'binary_f1_score': 0.9330918}
confusion matrix:
       0     1
0  42303    91
1    463  3863
---- Validation: 
scalar performance:
{'acc': 0.966809, 'precision': 0.7886605, 'recall': 0.60584044, 'specificity': 0.60584044, 'f1': 0.65123224, 'auroc': 0.80982816, 'binary_precision': 0.60580915, 'binary_recall': 0.21693908, 'binary_specificity': 0.9947418, 'binary_f1_score': 0.31947485}
confusion matrix:
       0    1
0  17972   95
1    527  146
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96310025, 'precision': 0.8246759, 'recall': 0.609268, 'specificity': 0.609268, 'f1': 0.6586273, 'auroc': 0.8183376, 'binary_precision': 0.68235296, 'binary_recall': 0.22307692, 'binary_specificity': 0.99545914, 'binary_f1_score': 0.33623186}
confusion matrix:
      0   1
0  5919  27
1   202  58
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512108_11.png
better model found
persisted
after epoch: 11,now: 2024-06-20 19:48:15.514030,epoch time: 0:17:10.238773,used: 3:09:47.396436,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_38_28_seed_1_21512108
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9894264, 'precision': 0.98469627, 'recall': 0.95159954, 'specificity': 0.95159954, 'f1': 0.96741784, 'auroc': 0.9943987, 'binary_precision': 0.9789895, 'binary_recall': 0.9051804, 'binary_specificity': 0.9980187, 'binary_f1_score': 0.9406393}
confusion matrix:
       0     1
0  42312    84
1    410  3914
---- Validation: 
scalar performance:
{'acc': 0.966809, 'precision': 0.7963537, 'recall': 0.5943962, 'specificity': 0.5943962, 'f1': 0.63889456, 'auroc': 0.80585796, 'binary_precision': 0.6220096, 'binary_recall': 0.19316493, 'binary_specificity': 0.9956274, 'binary_f1_score': 0.29478458}
confusion matrix:
       0    1
0  17988   79
1    543  130
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96422815, 'precision': 0.8495245, 'recall': 0.6135346, 'specificity': 0.6135346, 'f1': 0.66624224, 'auroc': 0.8061793, 'binary_precision': 0.73170733, 'binary_recall': 0.23076923, 'binary_specificity': 0.99630004, 'binary_f1_score': 0.3508772}
confusion matrix:
      0   1
0  5924  22
1   200  60
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512108_12.png
early stop counter: 1
val acc:0.9668089747428894, best validation acc: 0.9668089747428894, corresponding to test acc:                         0.963100254535675 / 0.9647115468978882
after epoch: 12,now: 2024-06-20 20:04:17.051946,epoch time: 0:16:01.537916,used: 3:25:48.934352,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_38_28_seed_1_21512108
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9885916, 'precision': 0.9816552, 'recall': 0.94947815, 'specificity': 0.94947815, 'f1': 0.96487224, 'auroc': 0.9940338, 'binary_precision': 0.9732834, 'binary_recall': 0.90148014, 'binary_specificity': 0.99747616, 'binary_f1_score': 0.9360068}
confusion matrix:
       0     1
0  42289   107
1    426  3898
---- Validation: 
scalar performance:
{'acc': 0.966809, 'precision': 0.7908234, 'recall': 0.6022641, 'specificity': 0.6022641, 'f1': 0.6474706, 'auroc': 0.81884336, 'binary_precision': 0.6103896, 'binary_recall': 0.20950966, 'binary_specificity': 0.99501854, 'binary_f1_score': 0.3119469}
confusion matrix:
       0    1
0  17977   90
1    532  141
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9639059, 'precision': 0.8338947, 'recall': 0.61888343, 'specificity': 0.61888343, 'f1': 0.6707147, 'auroc': 0.8239689, 'binary_precision': 0.7, 'binary_recall': 0.2423077, 'binary_specificity': 0.99545914, 'binary_f1_score': 0.36}
confusion matrix:
      0   1
0  5919  27
1   197  63
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512108_13.png
early stop counter: 2
val acc:0.9668089747428894, best validation acc: 0.9668089747428894, corresponding to test acc:                         0.963100254535675 / 0.9647115468978882
after epoch: 13,now: 2024-06-20 20:22:43.470593,epoch time: 0:18:26.418647,used: 3:44:15.352999,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_38_28_seed_1_21512108
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99023974, 'precision': 0.9831213, 'recall': 0.95808923, 'specificity': 0.95808923, 'f1': 0.97018886, 'auroc': 0.99491477, 'binary_precision': 0.9744973, 'binary_recall': 0.91863155, 'binary_specificity': 0.99754685, 'binary_f1_score': 0.94574016}
confusion matrix:
       0     1
0  42290   104
1    352  3974
---- Validation: 
scalar performance:
{'acc': 0.9666489, 'precision': 0.7886218, 'recall': 0.59932, 'specificity': 0.59932, 'f1': 0.6438489, 'auroc': 0.81977355, 'binary_precision': 0.6061947, 'binary_recall': 0.20356612, 'binary_specificity': 0.9950739, 'binary_f1_score': 0.30478308}
confusion matrix:
       0    1
0  17978   89
1    536  137
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9626168, 'precision': 0.8166721, 'recall': 0.6053378, 'specificity': 0.6053378, 'f1': 0.6531785, 'auroc': 0.8166382, 'binary_precision': 0.6666667, 'binary_recall': 0.21538462, 'binary_specificity': 0.99529094, 'binary_f1_score': 0.3255814}
confusion matrix:
      0   1
0  5918  28
1   204  56
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512108_14.png
early stop counter: 3
val acc:0.9666488766670227, best validation acc: 0.9668089747428894, corresponding to test acc:                         0.963100254535675 / 0.9647115468978882
after epoch: 14,now: 2024-06-20 20:41:33.964301,epoch time: 0:18:50.493708,used: 4:03:05.846707,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_38_28_seed_1_21512108
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98981166, 'precision': 0.9858184, 'recall': 0.9528502, 'specificity': 0.9528502, 'f1': 0.96861184, 'auroc': 0.99454015, 'binary_precision': 0.981, 'binary_recall': 0.90749305, 'binary_specificity': 0.9982074, 'binary_f1_score': 0.94281596}
confusion matrix:
       0     1
0  42320    76
1    400  3924
---- Validation: 
scalar performance:
{'acc': 0.96627533, 'precision': 0.7813559, 'recall': 0.59554994, 'specificity': 0.59554994, 'f1': 0.63868374, 'auroc': 0.8244723, 'binary_precision': 0.59192824, 'binary_recall': 0.1961367, 'binary_specificity': 0.99496317, 'binary_f1_score': 0.29464284}
confusion matrix:
       0    1
0  17976   91
1    541  132
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614889, 'precision': 0.8009685, 'recall': 0.59187627, 'specificity': 0.59187627, 'f1': 0.6355041, 'auroc': 0.82900524, 'binary_precision': 0.6363636, 'binary_recall': 0.18846154, 'binary_specificity': 0.99529094, 'binary_f1_score': 0.2908012}
confusion matrix:
      0   1
0  5918  28
1   211  49
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512108_15.png
early stop counter: 4
val acc:0.9662753343582153, best validation acc: 0.9668089747428894, corresponding to test acc:                         0.963100254535675 / 0.9647115468978882
after epoch: 15,now: 2024-06-20 21:02:55.360466,epoch time: 0:21:21.396165,used: 4:24:27.242872,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_38_28_seed_1_21512108
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9906678, 'precision': 0.986059, 'recall': 0.9578061, 'specificity': 0.9578061, 'f1': 0.9714043, 'auroc': 0.99541515, 'binary_precision': 0.9804842, 'binary_recall': 0.9174757, 'binary_specificity': 0.9981365, 'binary_f1_score': 0.94793403}
confusion matrix:
       0     1
0  42315    79
1    357  3969
---- Validation: 
scalar performance:
{'acc': 0.9667022, 'precision': 0.7985904, 'recall': 0.5879034, 'specificity': 0.5879034, 'f1': 0.63120157, 'auroc': 0.8186107, 'binary_precision': 0.626943, 'binary_recall': 0.17979197, 'binary_specificity': 0.99601483, 'binary_f1_score': 0.27944574}
confusion matrix:
       0    1
0  17995   72
1    552  121
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96165, 'precision': 0.8209688, 'recall': 0.57908744, 'specificity': 0.57908744, 'f1': 0.6205919, 'auroc': 0.8119503, 'binary_precision': 0.67741936, 'binary_recall': 0.16153847, 'binary_specificity': 0.9966364, 'binary_f1_score': 0.26086956}
confusion matrix:
      0   1
0  5926  20
1   218  42
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512108_16.png
early stop counter: 5
val acc:0.9667022228240967, best validation acc: 0.9668089747428894, corresponding to test acc:                         0.963100254535675 / 0.9647115468978882
after epoch: 16,now: 2024-06-20 21:20:00.559194,epoch time: 0:17:05.198728,used: 4:41:32.441600,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_38_28_seed_1_21512108
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9901755, 'precision': 0.98638326, 'recall': 0.95451474, 'specificity': 0.95451474, 'f1': 0.96977544, 'auroc': 0.9956685, 'binary_precision': 0.9818046, 'binary_recall': 0.91075146, 'binary_specificity': 0.9982781, 'binary_f1_score': 0.94494426}
confusion matrix:
       0     1
0  42322    73
1    386  3939
---- Validation: 
scalar performance:
{'acc': 0.9664888, 'precision': 0.80716497, 'recall': 0.5727721, 'specificity': 0.5727721, 'f1': 0.61220586, 'auroc': 0.8079829, 'binary_precision': 0.6451613, 'binary_recall': 0.1485884, 'binary_specificity': 0.99695575, 'binary_f1_score': 0.24154589}
confusion matrix:
       0    1
0  18012   55
1    573  100
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606832, 'precision': 0.8032172, 'recall': 0.567549, 'specificity': 0.567549, 'f1': 0.6038381, 'auroc': 0.7952863, 'binary_precision': 0.64285713, 'binary_recall': 0.13846155, 'binary_specificity': 0.9966364, 'binary_f1_score': 0.22784811}
confusion matrix:
      0   1
0  5926  20
1   224  36
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512108_17.png
early stop counter: 6
val acc:0.966488778591156, best validation acc: 0.9668089747428894, corresponding to test acc:                         0.963100254535675 / 0.9647115468978882
after epoch: 17,now: 2024-06-20 21:36:12.779386,epoch time: 0:16:12.220192,used: 4:57:44.661792,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_38_28_seed_1_21512108
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9914383, 'precision': 0.9842535, 'recall': 0.96424234, 'specificity': 0.96424234, 'f1': 0.9739837, 'auroc': 0.99546456, 'binary_precision': 0.975527, 'binary_recall': 0.9308671, 'binary_specificity': 0.99761766, 'binary_f1_score': 0.9526739}
confusion matrix:
       0     1
0  42294   101
1    299  4026
---- Validation: 
scalar performance:
{'acc': 0.966222, 'precision': 0.78041065, 'recall': 0.59480697, 'specificity': 0.59480697, 'f1': 0.6377176, 'auroc': 0.8284849, 'binary_precision': 0.5900901, 'binary_recall': 0.19465081, 'binary_specificity': 0.99496317, 'binary_f1_score': 0.29273742}
confusion matrix:
       0    1
0  17976   91
1    542  131
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96036094, 'precision': 0.7796848, 'recall': 0.5820927, 'specificity': 0.5820927, 'f1': 0.62155277, 'auroc': 0.81918, 'binary_precision': 0.5945946, 'binary_recall': 0.16923077, 'binary_specificity': 0.9949546, 'binary_f1_score': 0.26347306}
confusion matrix:
      0   1
0  5916  30
1   216  44
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512108_18.png
early stop counter: 7
val acc:0.9662219882011414, best validation acc: 0.9668089747428894, corresponding to test acc:                         0.963100254535675 / 0.9647115468978882
after epoch: 18,now: 2024-06-20 21:50:15.282569,epoch time: 0:14:02.503183,used: 5:11:47.164975,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_38_28_seed_1_21512108
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9917166, 'precision': 0.98664, 'recall': 0.96357334, 'specificity': 0.96357334, 'f1': 0.9747566, 'auroc': 0.99576735, 'binary_precision': 0.98048306, 'binary_recall': 0.92903376, 'binary_specificity': 0.9981129, 'binary_f1_score': 0.95406526}
confusion matrix:
       0     1
0  42314    80
1    307  4019
---- Validation: 
scalar performance:
{'acc': 0.966222, 'precision': 0.785566, 'recall': 0.5862238, 'specificity': 0.5862238, 'f1': 0.62797916, 'auroc': 0.82333106, 'binary_precision': 0.6010101, 'binary_recall': 0.1768202, 'binary_specificity': 0.9956274, 'binary_f1_score': 0.27324912}
confusion matrix:
       0    1
0  17988   79
1    554  119
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597164, 'precision': 0.7687621, 'recall': 0.5725614, 'specificity': 0.5725614, 'f1': 0.6085582, 'auroc': 0.8167163, 'binary_precision': 0.5735294, 'binary_recall': 0.15, 'binary_specificity': 0.9951228, 'binary_f1_score': 0.23780487}
confusion matrix:
      0   1
0  5917  29
1   221  39
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512108_19.png
early stop counter: 8
val acc:0.9662219882011414, best validation acc: 0.9668089747428894, corresponding to test acc:                         0.963100254535675 / 0.9647115468978882
after epoch: 19,now: 2024-06-20 22:05:43.457910,epoch time: 0:15:28.175341,used: 5:27:15.340316,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_38_28_seed_1_21512108
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9922089, 'precision': 0.9895128, 'recall': 0.9637244, 'specificity': 0.9637244, 'f1': 0.97618294, 'auroc': 0.99682724, 'binary_precision': 0.98624754, 'binary_recall': 0.92876965, 'binary_specificity': 0.9986791, 'binary_f1_score': 0.956646}
confusion matrix:
       0     1
0  42340    56
1    308  4016
---- Validation: 
scalar performance:
{'acc': 0.9666489, 'precision': 0.8016074, 'recall': 0.5828689, 'specificity': 0.5828689, 'f1': 0.62511396, 'auroc': 0.8287599, 'binary_precision': 0.6333333, 'binary_recall': 0.16939078, 'binary_specificity': 0.99634695, 'binary_f1_score': 0.2672919}
confusion matrix:
       0    1
0  18001   66
1    559  114
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95955527, 'precision': 0.77543366, 'recall': 0.5559264, 'specificity': 0.5559264, 'f1': 0.58609194, 'auroc': 0.81772506, 'binary_precision': 0.5882353, 'binary_recall': 0.115384616, 'binary_specificity': 0.9964682, 'binary_f1_score': 0.19292603}
confusion matrix:
      0   1
0  5925  21
1   230  30
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512108_20.png
early stop counter: 9
val acc:0.9666488766670227, best validation acc: 0.9668089747428894, corresponding to test acc:                         0.963100254535675 / 0.9647115468978882
after epoch: 20,now: 2024-06-20 22:20:02.071470,epoch time: 0:14:18.613560,used: 5:41:33.953876,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_38_28_seed_1_21512108
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99137414, 'precision': 0.9875858, 'recall': 0.9605646, 'specificity': 0.9605646, 'f1': 0.9735943, 'auroc': 0.9965115, 'binary_precision': 0.98300076, 'binary_recall': 0.92275673, 'binary_specificity': 0.9983725, 'binary_f1_score': 0.9519266}
confusion matrix:
       0     1
0  42327    69
1    334  3990
---- Validation: 
scalar performance:
{'acc': 0.966222, 'precision': 0.7956063, 'recall': 0.57406425, 'specificity': 0.57406425, 'f1': 0.6132264, 'auroc': 0.81810474, 'binary_precision': 0.6219512, 'binary_recall': 0.15156017, 'binary_specificity': 0.9965683, 'binary_f1_score': 0.24372758}
confusion matrix:
       0    1
0  18005   62
1    571  102
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9585885, 'precision': 0.74751395, 'recall': 0.54438794, 'specificity': 0.54438794, 'f1': 0.5680748, 'auroc': 0.8012675, 'binary_precision': 0.53333336, 'binary_recall': 0.092307694, 'binary_specificity': 0.9964682, 'binary_f1_score': 0.15737705}
confusion matrix:
      0   1
0  5925  21
1   236  24
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512108_21.png
early stop counter: 10
val acc:0.9662219882011414, best validation acc: 0.9668089747428894, corresponding to test acc:                         0.963100254535675 / 0.9647115468978882
after epoch: 21,now: 2024-06-20 22:36:25.024825,epoch time: 0:16:22.953355,used: 5:57:56.907231,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_38_28_seed_1_21512108
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9917166, 'precision': 0.98801756, 'recall': 0.9621985, 'specificity': 0.9621985, 'f1': 0.97466993, 'auroc': 0.9966398, 'binary_precision': 0.9835381, 'binary_recall': 0.92597735, 'binary_specificity': 0.9984197, 'binary_f1_score': 0.9538902}
confusion matrix:
       0     1
0  42330    67
1    320  4003
---- Validation: 
scalar performance:
{'acc': 0.96691567, 'precision': 0.798773, 'recall': 0.59516674, 'specificity': 0.59516674, 'f1': 0.64005566, 'auroc': 0.8365165, 'binary_precision': 0.6267943, 'binary_recall': 0.19465081, 'binary_specificity': 0.9956827, 'binary_f1_score': 0.29705215}
confusion matrix:
       0    1
0  17989   78
1    542  131
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597164, 'precision': 0.781319, 'recall': 0.5560105, 'specificity': 0.5560105, 'f1': 0.58644533, 'auroc': 0.8192416, 'binary_precision': 0.6, 'binary_recall': 0.115384616, 'binary_specificity': 0.9966364, 'binary_f1_score': 0.19354838}
confusion matrix:
      0   1
0  5926  20
1   230  30
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512108_22.png
better model found
persisted
after epoch: 22,now: 2024-06-20 22:52:38.525957,epoch time: 0:16:13.501132,used: 6:14:10.408363,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_38_28_seed_1_21512108
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99203765, 'precision': 0.9870566, 'recall': 0.9650838, 'specificity': 0.9650838, 'f1': 0.97575307, 'auroc': 0.99673045, 'binary_precision': 0.98101264, 'binary_recall': 0.9320074, 'binary_specificity': 0.9981602, 'binary_f1_score': 0.9558823}
confusion matrix:
       0     1
0  42318    78
1    294  4030
---- Validation: 
scalar performance:
{'acc': 0.9663821, 'precision': 0.78362507, 'recall': 0.59632057, 'specificity': 0.59632057, 'f1': 0.6398272, 'auroc': 0.8367473, 'binary_precision': 0.59641254, 'binary_recall': 0.19762258, 'binary_specificity': 0.99501854, 'binary_f1_score': 0.296875}
confusion matrix:
       0    1
0  17977   90
1    540  133
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584273, 'precision': 0.73917186, 'recall': 0.5626937, 'specificity': 0.5626937, 'f1': 0.59362096, 'auroc': 0.82180893, 'binary_precision': 0.5151515, 'binary_recall': 0.13076924, 'binary_specificity': 0.99461824, 'binary_f1_score': 0.20858896}
confusion matrix:
      0   1
0  5914  32
1   226  34
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512108_23.png
early stop counter: 1
val acc:0.9663820862770081, best validation acc: 0.9669156670570374, corresponding to test acc:                         0.9597163796424866 / 0.9647115468978882
after epoch: 23,now: 2024-06-20 23:09:05.011116,epoch time: 0:16:26.485159,used: 6:30:36.893522,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_38_28_seed_1_21512108
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99208045, 'precision': 0.9903009, 'recall': 0.96219987, 'specificity': 0.96219987, 'f1': 0.975733, 'auroc': 0.9970553, 'binary_precision': 0.98814815, 'binary_recall': 0.9255319, 'binary_specificity': 0.9988678, 'binary_f1_score': 0.9558156}
confusion matrix:
       0     1
0  42348    48
1    322  4002
---- Validation: 
scalar performance:
{'acc': 0.9663821, 'precision': 0.80479366, 'recall': 0.5712862, 'specificity': 0.5712862, 'f1': 0.6100502, 'auroc': 0.82674557, 'binary_precision': 0.6405229, 'binary_recall': 0.14561664, 'binary_specificity': 0.99695575, 'binary_f1_score': 0.23728812}
confusion matrix:
       0   1
0  18012  55
1    575  98
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.73076296, 'recall': 0.5422967, 'specificity': 0.5422967, 'f1': 0.56442493, 'auroc': 0.8040143, 'binary_precision': 0.5, 'binary_recall': 0.08846154, 'binary_specificity': 0.99613184, 'binary_f1_score': 0.1503268}
confusion matrix:
      0   1
0  5923  23
1   237  23
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512108_24.png
early stop counter: 2
val acc:0.9663820862770081, best validation acc: 0.9669156670570374, corresponding to test acc:                         0.9597163796424866 / 0.9647115468978882
after epoch: 24,now: 2024-06-20 23:23:12.162955,epoch time: 0:14:07.151839,used: 6:44:44.045361,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_38_28_seed_1_21512108
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9921019, 'precision': 0.9882672, 'recall': 0.9642965, 'specificity': 0.9642965, 'f1': 0.97590494, 'auroc': 0.99735564, 'binary_precision': 0.98361856, 'binary_recall': 0.9301734, 'binary_specificity': 0.99841964, 'binary_f1_score': 0.95614976}
confusion matrix:
       0     1
0  42328    67
1    302  4023
---- Validation: 
scalar performance:
{'acc': 0.96643543, 'precision': 0.79946625, 'recall': 0.5777513, 'specificity': 0.5777513, 'f1': 0.6183434, 'auroc': 0.83042127, 'binary_precision': 0.62941176, 'binary_recall': 0.1589896, 'binary_specificity': 0.996513, 'binary_f1_score': 0.25385526}
confusion matrix:
       0    1
0  18004   63
1    566  107
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584273, 'precision': 0.7493279, 'recall': 0.525914, 'specificity': 0.525914, 'f1': 0.53831273, 'auroc': 0.7972245, 'binary_precision': 0.53846157, 'binary_recall': 0.053846154, 'binary_specificity': 0.99798185, 'binary_f1_score': 0.0979021}
confusion matrix:
      0   1
0  5934  12
1   246  14
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512108_25.png
early stop counter: 3
val acc:0.966435432434082, best validation acc: 0.9669156670570374, corresponding to test acc:                         0.9597163796424866 / 0.9647115468978882
after epoch: 25,now: 2024-06-20 23:39:09.465167,epoch time: 0:15:57.302212,used: 7:00:41.347573,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_38_28_seed_1_21512108
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9922517, 'precision': 0.9867785, 'recall': 0.966663, 'specificity': 0.966663, 'f1': 0.9764552, 'auroc': 0.9972919, 'binary_precision': 0.98013085, 'binary_recall': 0.9352601, 'binary_specificity': 0.9980658, 'binary_f1_score': 0.9571699}
confusion matrix:
       0     1
0  42313    82
1    280  4045
---- Validation: 
scalar performance:
{'acc': 0.96739596, 'precision': 0.8067126, 'recall': 0.60185325, 'specificity': 0.60185325, 'f1': 0.6487773, 'auroc': 0.84209096, 'binary_precision': 0.64220184, 'binary_recall': 0.20802377, 'binary_specificity': 0.9956827, 'binary_f1_score': 0.31425363}
confusion matrix:
       0    1
0  17989   78
1    533  140
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582662, 'precision': 0.735893, 'recall': 0.54789776, 'specificity': 0.54789776, 'f1': 0.5728997, 'auroc': 0.8105351, 'binary_precision': 0.50980395, 'binary_recall': 0.1, 'binary_specificity': 0.9957955, 'binary_f1_score': 0.16720258}
confusion matrix:
      0   1
0  5921  25
1   234  26
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512108_26.png
better model found
persisted
after epoch: 26,now: 2024-06-20 23:59:16.039038,epoch time: 0:20:06.573871,used: 7:20:47.921444,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_38_28_seed_1_21512108
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9928296, 'precision': 0.98799384, 'recall': 0.96895385, 'specificity': 0.96895385, 'f1': 0.9782368, 'auroc': 0.9968302, 'binary_precision': 0.98211694, 'binary_recall': 0.93965316, 'binary_specificity': 0.99825454, 'binary_f1_score': 0.9604159}
confusion matrix:
       0     1
0  42321    74
1    261  4064
---- Validation: 
scalar performance:
{'acc': 0.9664888, 'precision': 0.7876697, 'recall': 0.5942301, 'specificity': 0.5942301, 'f1': 0.6378153, 'auroc': 0.8382891, 'binary_precision': 0.60465115, 'binary_recall': 0.19316493, 'binary_specificity': 0.9952953, 'binary_f1_score': 0.29279277}
confusion matrix:
       0    1
0  17982   85
1    543  130
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9574605, 'precision': 0.71507215, 'recall': 0.55299425, 'specificity': 0.55299425, 'f1': 0.579144, 'auroc': 0.8065144, 'binary_precision': 0.46774194, 'binary_recall': 0.11153846, 'binary_specificity': 0.99445003, 'binary_f1_score': 0.18012422}
confusion matrix:
      0   1
0  5913  33
1   231  29
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512108_27.png
early stop counter: 1
val acc:0.966488778591156, best validation acc: 0.9673959612846375, corresponding to test acc:                         0.9582661986351013 / 0.9647115468978882
after epoch: 27,now: 2024-06-21 00:20:05.694274,epoch time: 0:20:49.655236,used: 7:41:37.576680,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_38_28_seed_1_21512108
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99304366, 'precision': 0.9909937, 'recall': 0.9672773, 'specificity': 0.9672773, 'f1': 0.97876894, 'auroc': 0.99761784, 'binary_precision': 0.9885086, 'binary_recall': 0.93566304, 'binary_specificity': 0.9988915, 'binary_f1_score': 0.9613601}
confusion matrix:
       0     1
0  42352    47
1    278  4043
---- Validation: 
scalar performance:
{'acc': 0.96627533, 'precision': 0.78865063, 'recall': 0.5841057, 'specificity': 0.5841057, 'f1': 0.6256291, 'auroc': 0.8347647, 'binary_precision': 0.60732985, 'binary_recall': 0.17236255, 'binary_specificity': 0.9958488, 'binary_f1_score': 0.2685185}
confusion matrix:
       0    1
0  17992   75
1    557  116
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582662, 'precision': 0.73616016, 'recall': 0.5442198, 'specificity': 0.5442198, 'f1': 0.5674778, 'auroc': 0.8050951, 'binary_precision': 0.5106383, 'binary_recall': 0.092307694, 'binary_specificity': 0.99613184, 'binary_f1_score': 0.1563518}
confusion matrix:
      0   1
0  5923  23
1   236  24
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512108_28.png
early stop counter: 2
val acc:0.9662753343582153, best validation acc: 0.9673959612846375, corresponding to test acc:                         0.9582661986351013 / 0.9647115468978882
after epoch: 28,now: 2024-06-21 00:41:47.637749,epoch time: 0:21:41.943475,used: 8:03:19.520155,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_38_28_seed_1_21512108
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9933433, 'precision': 0.9890524, 'recall': 0.9709822, 'specificity': 0.9709822, 'f1': 0.97980464, 'auroc': 0.99743724, 'binary_precision': 0.98383594, 'binary_recall': 0.9435446, 'binary_specificity': 0.99841976, 'binary_f1_score': 0.9632691}
confusion matrix:
       0     1
0  42331    67
1    244  4078
---- Validation: 
scalar performance:
{'acc': 0.966809, 'precision': 0.79174507, 'recall': 0.60083354, 'specificity': 0.60083354, 'f1': 0.6459425, 'auroc': 0.8451163, 'binary_precision': 0.6123348, 'binary_recall': 0.20653789, 'binary_specificity': 0.9951292, 'binary_f1_score': 0.30888885}
confusion matrix:
       0    1
0  17979   88
1    534  139
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9569771, 'precision': 0.702353, 'recall': 0.54906404, 'specificity': 0.54906404, 'f1': 0.5730709, 'auroc': 0.81988704, 'binary_precision': 0.44262296, 'binary_recall': 0.103846155, 'binary_specificity': 0.9942819, 'binary_f1_score': 0.1682243}
confusion matrix:
      0   1
0  5912  34
1   233  27
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512108_29.png
early stop counter: 3
val acc:0.9668089747428894, best validation acc: 0.9673959612846375, corresponding to test acc:                         0.9582661986351013 / 0.9647115468978882
after epoch: 29,now: 2024-06-21 01:02:58.765307,epoch time: 0:21:11.127558,used: 8:24:30.647713,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_38_28_seed_1_21512108
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9922089, 'precision': 0.98844016, 'recall': 0.9647628, 'specificity': 0.9647628, 'f1': 0.97623396, 'auroc': 0.99712825, 'binary_precision': 0.983871, 'binary_recall': 0.9310823, 'binary_specificity': 0.99844325, 'binary_f1_score': 0.9567491}
confusion matrix:
       0     1
0  42330    66
1    298  4026
---- Validation: 
scalar performance:
{'acc': 0.96659553, 'precision': 0.79203284, 'recall': 0.59213966, 'specificity': 0.59213966, 'f1': 0.63576627, 'auroc': 0.8402213, 'binary_precision': 0.6135266, 'binary_recall': 0.18870728, 'binary_specificity': 0.99557203, 'binary_f1_score': 0.28863636}
confusion matrix:
       0    1
0  17987   80
1    546  127
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.7305384, 'recall': 0.53677976, 'specificity': 0.53677976, 'f1': 0.55593354, 'auroc': 0.8032855, 'binary_precision': 0.5, 'binary_recall': 0.07692308, 'binary_specificity': 0.9966364, 'binary_f1_score': 0.13333334}
confusion matrix:
      0   1
0  5926  20
1   240  20
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512108_30.png
early stop counter: 4
val acc:0.9665955305099487, best validation acc: 0.9673959612846375, corresponding to test acc:                         0.9582661986351013 / 0.9647115468978882
after epoch: 30,now: 2024-06-21 01:24:31.867104,epoch time: 0:21:33.101797,used: 8:46:03.749510,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_38_28_seed_1_21512108
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 8:46:03.749510 at 2024-06-21 01:24:31.867104
persisted model performance metric: 

scalar performance:
{'acc': 0.9582662, 'precision': 0.735893, 'recall': 0.54789776, 'specificity': 0.54789776, 'f1': 0.5728997, 'auroc': 0.8105351, 'binary_precision': 0.50980395, 'binary_recall': 0.1, 'binary_specificity': 0.9957955, 'binary_f1_score': 0.16720258}
confusion matrix:
      0   1
0  5921  25
1   234  26
oracle model performance metric: 

scalar performance:
{'acc': 0.96471155, 'precision': 0.8467747, 'recall': 0.6248208, 'specificity': 0.6248208, 'f1': 0.6789553, 'auroc': 0.80659413, 'binary_precision': 0.72527474, 'binary_recall': 0.25384617, 'binary_specificity': 0.9957955, 'binary_f1_score': 0.37606838}
confusion matrix:
      0   1
0  5921  25
1   194  66
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_irm_resnet_different_bs128_lre4_classbalancing/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_irm_resnet_different_bs128_lre4_classbalancing/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204094 KiB |   1730 MiB | 754681 GiB | 754681 GiB |
|       from large pool | 167936 KiB |   1660 MiB | 754469 GiB | 754469 GiB |
|       from small pool |  36158 KiB |     72 MiB |    212 GiB |    211 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 204094 KiB |   1730 MiB | 754681 GiB | 754681 GiB |
|       from large pool | 167936 KiB |   1660 MiB | 754469 GiB | 754469 GiB |
|       from small pool |  36158 KiB |     72 MiB |    212 GiB |    211 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201086 KiB |   1723 MiB | 754663 GiB | 754663 GiB |
|       from large pool | 165120 KiB |   1653 MiB | 754454 GiB | 754454 GiB |
|       from small pool |  35966 KiB |     71 MiB |    208 GiB |    208 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1802 MiB |   1876 MiB |   3084 MiB |   1282 MiB |
|       from large pool |   1728 MiB |   1802 MiB |   2978 MiB |   1250 MiB |
|       from small pool |     74 MiB |     74 MiB |    106 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 404161 KiB |    900 MiB | 534397 GiB | 534396 GiB |
|       from large pool | 397312 KiB |    899 MiB | 534178 GiB | 534178 GiB |
|       from small pool |   6849 KiB |     14 MiB |    218 GiB |    218 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1194    |    1851    |   22647 K  |   22646 K  |
|       from large pool |      36    |      76    |    7175 K  |    7175 K  |
|       from small pool |    1158    |    1780    |   15472 K  |   15471 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1194    |    1851    |   22647 K  |   22646 K  |
|       from large pool |      36    |      76    |    7175 K  |    7175 K  |
|       from small pool |    1158    |    1780    |   15472 K  |   15471 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      49    |      50    |      69    |      20    |
|       from large pool |      12    |      13    |      16    |       4    |
|       from small pool |      37    |      37    |      53    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      34    |     380    |   11517 K  |   11517 K  |
|       from large pool |       5    |      11    |    2823 K  |    2823 K  |
|       from small pool |      29    |     375    |    8693 K  |    8693 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1730 MiB | 754681 GiB | 754681 GiB |
|       from large pool |  16640 KiB |   1660 MiB | 754469 GiB | 754469 GiB |
|       from small pool |      0 KiB |     72 MiB |    212 GiB |    212 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1730 MiB | 754681 GiB | 754681 GiB |
|       from large pool |  16640 KiB |   1660 MiB | 754469 GiB | 754469 GiB |
|       from small pool |      0 KiB |     72 MiB |    212 GiB |    212 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1723 MiB | 754663 GiB | 754663 GiB |
|       from large pool |  16640 KiB |   1653 MiB | 754454 GiB | 754454 GiB |
|       from small pool |      0 KiB |     71 MiB |    208 GiB |    208 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 608256 KiB |   1876 MiB |   3084 MiB |   2490 MiB |
|       from large pool | 565248 KiB |   1802 MiB |   2978 MiB |   2426 MiB |
|       from small pool |  43008 KiB |     74 MiB |    106 MiB |     64 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 384768 KiB |    900 MiB | 534397 GiB | 534396 GiB |
|       from large pool | 384768 KiB |    899 MiB | 534178 GiB | 534178 GiB |
|       from small pool |      0 KiB |     14 MiB |    218 GiB |    218 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1851    |   22647 K  |   22647 K  |
|       from large pool |       2    |      76    |    7175 K  |    7175 K  |
|       from small pool |       0    |    1780    |   15472 K  |   15472 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1851    |   22647 K  |   22647 K  |
|       from large pool |       2    |      76    |    7175 K  |    7175 K  |
|       from small pool |       0    |    1780    |   15472 K  |   15472 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      30    |      50    |      69    |      39    |
|       from large pool |       9    |      13    |      16    |       7    |
|       from small pool |      21    |      37    |      53    |      32    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     380    |   11517 K  |   11517 K  |
|       from large pool |       1    |      11    |    2823 K  |    2823 K  |
|       from small pool |       0    |     375    |    8694 K  |    8694 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1730 MiB | 754681 GiB | 754681 GiB |
|       from large pool |  16640 KiB |   1660 MiB | 754469 GiB | 754469 GiB |
|       from small pool |      0 KiB |     72 MiB |    212 GiB |    212 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1730 MiB | 754681 GiB | 754681 GiB |
|       from large pool |  16640 KiB |   1660 MiB | 754469 GiB | 754469 GiB |
|       from small pool |      0 KiB |     72 MiB |    212 GiB |    212 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1723 MiB | 754663 GiB | 754663 GiB |
|       from large pool |  16640 KiB |   1653 MiB | 754454 GiB | 754454 GiB |
|       from small pool |      0 KiB |     71 MiB |    208 GiB |    208 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 608256 KiB |   1876 MiB |   3084 MiB |   2490 MiB |
|       from large pool | 565248 KiB |   1802 MiB |   2978 MiB |   2426 MiB |
|       from small pool |  43008 KiB |     74 MiB |    106 MiB |     64 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 384768 KiB |    900 MiB | 534397 GiB | 534396 GiB |
|       from large pool | 384768 KiB |    899 MiB | 534178 GiB | 534178 GiB |
|       from small pool |      0 KiB |     14 MiB |    218 GiB |    218 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1851    |   22647 K  |   22647 K  |
|       from large pool |       2    |      76    |    7175 K  |    7175 K  |
|       from small pool |       0    |    1780    |   15472 K  |   15472 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1851    |   22647 K  |   22647 K  |
|       from large pool |       2    |      76    |    7175 K  |    7175 K  |
|       from small pool |       0    |    1780    |   15472 K  |   15472 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      30    |      50    |      69    |      39    |
|       from large pool |       9    |      13    |      16    |       7    |
|       from small pool |      21    |      37    |      53    |      32    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     380    |   11517 K  |   11517 K  |
|       from large pool |       1    |      11    |    2823 K  |    2823 K  |
|       from small pool |       0    |     375    |    8694 K  |    8694 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0




!!!: not committed yet



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_01_31_21_seed_2_21512108

 Experiment start at: 2024-06-21 01:31:21.577899
before training, model accuracy: 0.0544959120452404
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.94415987, 'precision': 0.96719086, 'recall': 0.71324277, 'specificity': 0.71324277, 'f1': 0.7834602, 'auroc': 0.9420655, 'binary_precision': 0.9923156, 'binary_recall': 0.42684, 'binary_specificity': 0.9996455, 'binary_f1_score': 0.59691834}
confusion matrix:
       0     1
0  42295    15
1   2601  1937
---- Validation: 
scalar performance:
{'acc': 0.96745324, 'precision': 0.48395863, 'recall': 0.49975234, 'specificity': 0.49975234, 'f1': 0.4917287, 'auroc': 0.560092, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9995047, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18162  9
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96105146, 'precision': 0.48060277, 'recall': 0.4999166, 'specificity': 0.4999166, 'f1': 0.49006948, 'auroc': 0.6012876, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5996  1
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512108_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-21 02:00:28.707222,epoch time: 0:29:07.129323,used: 0:29:07.129323,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_01_31_21_seed_2_21512108
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96667945, 'precision': 0.98002845, 'recall': 0.8294226, 'specificity': 0.8294226, 'f1': 0.8874943, 'auroc': 0.97069657, 'binary_precision': 0.9953427, 'binary_recall': 0.65917605, 'binary_specificity': 0.9996691, 'binary_f1_score': 0.79310805}
confusion matrix:
       0     1
0  42295    14
1   1547  2992
---- Validation: 
scalar performance:
{'acc': 0.9688382, 'precision': 0.82154024, 'recall': 0.52696836, 'specificity': 0.52696836, 'f1': 0.5427633, 'auroc': 0.62650657, 'binary_precision': 0.67346936, 'binary_recall': 0.054817274, 'binary_specificity': 0.99911946, 'binary_f1_score': 0.10138249}
confusion matrix:
       0   1
0  18155  16
1    569  33
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96105146, 'precision': 0.70824575, 'recall': 0.5098303, 'specificity': 0.5098303, 'f1': 0.5098242, 'auroc': 0.6576215, 'binary_precision': 0.45454547, 'binary_recall': 0.020661157, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.03952569}
confusion matrix:
      0  1
0  5991  6
1   237  5
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512108_2.png
better model found
persisted
after epoch: 2,now: 2024-06-21 02:25:52.250857,epoch time: 0:25:23.543635,used: 0:54:30.672958,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_01_31_21_seed_2_21512108
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9741504, 'precision': 0.98065305, 'recall': 0.87053406, 'specificity': 0.87053406, 'f1': 0.9167464, 'auroc': 0.9807385, 'binary_precision': 0.9882629, 'binary_recall': 0.74201363, 'binary_specificity': 0.99905455, 'binary_f1_score': 0.8476154}
confusion matrix:
       0     1
0  42269    40
1   1171  3368
---- Validation: 
scalar performance:
{'acc': 0.9690513, 'precision': 0.79070055, 'recall': 0.54715466, 'specificity': 0.54715466, 'f1': 0.5753302, 'auroc': 0.68984926, 'binary_precision': 0.6105263, 'binary_recall': 0.096345514, 'binary_specificity': 0.9979638, 'binary_f1_score': 0.16642754}
confusion matrix:
       0   1
0  18134  37
1    544  58
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9640968, 'precision': 0.8400378, 'recall': 0.560983, 'specificity': 0.560983, 'f1': 0.59644896, 'auroc': 0.7104572, 'binary_precision': 0.71428573, 'binary_recall': 0.12396694, 'binary_specificity': 0.997999, 'binary_f1_score': 0.2112676}
confusion matrix:
      0   1
0  5985  12
1   212  30
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512108_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-21 02:40:18.542671,epoch time: 0:14:26.291814,used: 1:08:56.964772,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_01_31_21_seed_2_21512108
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98140794, 'precision': 0.9816189, 'recall': 0.91083914, 'specificity': 0.91083914, 'f1': 0.94271064, 'auroc': 0.9885707, 'binary_precision': 0.9818707, 'binary_recall': 0.8233091, 'binary_specificity': 0.99836916, 'binary_f1_score': 0.8956261}
confusion matrix:
       0     1
0  42240    69
1    802  3737
---- Validation: 
scalar performance:
{'acc': 0.9683588, 'precision': 0.74745005, 'recall': 0.5757067, 'specificity': 0.5757067, 'f1': 0.61212605, 'auroc': 0.7442045, 'binary_precision': 0.5222222, 'binary_recall': 0.15614618, 'binary_specificity': 0.9952672, 'binary_f1_score': 0.24040921}
confusion matrix:
       0   1
0  18085  86
1    508  94
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9658599, 'precision': 0.82881993, 'recall': 0.6075032, 'specificity': 0.6075032, 'f1': 0.6573853, 'auroc': 0.75071573, 'binary_precision': 0.6883117, 'binary_recall': 0.21900827, 'binary_specificity': 0.995998, 'binary_f1_score': 0.3322884}
confusion matrix:
      0   1
0  5973  24
1   189  53
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512108_4.png
new oracle model saved
early stop counter: 1
val acc:0.9683588147163391, best validation acc: 0.9690513014793396, corresponding to test acc:                         0.9640967845916748 / 0.9658598899841309
after epoch: 4,now: 2024-06-21 03:01:00.056967,epoch time: 0:20:41.514296,used: 1:29:38.479068,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_01_31_21_seed_2_21512108
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98307294, 'precision': 0.9811235, 'recall': 0.9208081, 'specificity': 0.9208081, 'f1': 0.94843113, 'auroc': 0.9913901, 'binary_precision': 0.97878325, 'binary_recall': 0.84357786, 'binary_specificity': 0.99803823, 'binary_f1_score': 0.90616494}
confusion matrix:
       0     1
0  42226    83
1    710  3829
---- Validation: 
scalar performance:
{'acc': 0.9686251, 'precision': 0.75311995, 'recall': 0.5846778, 'specificity': 0.5846778, 'f1': 0.6234, 'auroc': 0.7606029, 'binary_precision': 0.5329949, 'binary_recall': 0.1744186, 'binary_specificity': 0.994937, 'binary_f1_score': 0.2628285}
confusion matrix:
       0    1
0  18079   92
1    497  105
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9677833, 'precision': 0.8682678, 'recall': 0.6204001, 'specificity': 0.6204001, 'f1': 0.6766875, 'auroc': 0.7618432, 'binary_precision': 0.76623374, 'binary_recall': 0.24380165, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.36990595}
confusion matrix:
      0   1
0  5979  18
1   183  59
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512108_5.png
new oracle model saved
early stop counter: 2
val acc:0.9686251282691956, best validation acc: 0.9690513014793396, corresponding to test acc:                         0.9640967845916748 / 0.9677832722663879
after epoch: 5,now: 2024-06-21 03:26:55.900731,epoch time: 0:25:55.843764,used: 1:55:34.322832,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_01_31_21_seed_2_21512108
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.984439, 'precision': 0.9811587, 'recall': 0.9286448, 'specificity': 0.9286448, 'f1': 0.9529936, 'auroc': 0.98989475, 'binary_precision': 0.9772044, 'binary_recall': 0.8594404, 'binary_specificity': 0.99784917, 'binary_f1_score': 0.91454697}
confusion matrix:
       0     1
0  42218    91
1    638  3901
---- Validation: 
scalar performance:
{'acc': 0.9681457, 'precision': 0.74117815, 'recall': 0.6020972, 'specificity': 0.6020972, 'f1': 0.6409126, 'auroc': 0.7822565, 'binary_precision': 0.508, 'binary_recall': 0.21096346, 'binary_specificity': 0.993231, 'binary_f1_score': 0.29812208}
confusion matrix:
       0    1
0  18048  123
1    475  127
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.967623, 'precision': 0.84916717, 'recall': 0.6302304, 'specificity': 0.6302304, 'f1': 0.68562526, 'auroc': 0.7820293, 'binary_precision': 0.72727275, 'binary_recall': 0.2644628, 'binary_specificity': 0.995998, 'binary_f1_score': 0.38787878}
confusion matrix:
      0   1
0  5973  24
1   178  64
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512108_6.png
early stop counter: 3
val acc:0.9681457281112671, best validation acc: 0.9690513014793396, corresponding to test acc:                         0.9640967845916748 / 0.9677832722663879
after epoch: 6,now: 2024-06-21 03:54:25.377933,epoch time: 0:27:29.477202,used: 2:23:03.800034,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_01_31_21_seed_2_21512108
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98529285, 'precision': 0.9824842, 'recall': 0.9323627, 'specificity': 0.9323627, 'f1': 0.9556942, 'auroc': 0.99155235, 'binary_precision': 0.9790941, 'binary_recall': 0.8667107, 'binary_specificity': 0.9980146, 'binary_f1_score': 0.9194811}
confusion matrix:
       0     1
0  42225    84
1    605  3934
---- Validation: 
scalar performance:
{'acc': 0.9692644, 'precision': 0.77300274, 'recall': 0.57938665, 'specificity': 0.57938665, 'f1': 0.6189333, 'auroc': 0.7695162, 'binary_precision': 0.57309943, 'binary_recall': 0.1627907, 'binary_specificity': 0.9959826, 'binary_f1_score': 0.25355756}
confusion matrix:
       0   1
0  18098  73
1    504  98
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96714216, 'precision': 0.8726676, 'recall': 0.6061874, 'specificity': 0.6061874, 'f1': 0.65986174, 'auroc': 0.76434654, 'binary_precision': 0.7761194, 'binary_recall': 0.21487603, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.33656958}
confusion matrix:
      0   1
0  5982  15
1   190  52
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512108_7.png
better model found
persisted
after epoch: 7,now: 2024-06-21 04:22:16.286515,epoch time: 0:27:50.908582,used: 2:50:54.708616,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_01_31_21_seed_2_21512108
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9859759, 'precision': 0.98218954, 'recall': 0.936576, 'specificity': 0.936576, 'f1': 0.9579551, 'auroc': 0.9912002, 'binary_precision': 0.97760826, 'binary_recall': 0.8753029, 'binary_specificity': 0.99784917, 'binary_f1_score': 0.92363125}
confusion matrix:
       0     1
0  42218    91
1    566  3973
---- Validation: 
scalar performance:
{'acc': 0.9697438, 'precision': 0.7798472, 'recall': 0.59408915, 'specificity': 0.59408915, 'f1': 0.6372713, 'auroc': 0.794897, 'binary_precision': 0.5858586, 'binary_recall': 0.19269103, 'binary_specificity': 0.99548733, 'binary_f1_score': 0.29}
confusion matrix:
       0    1
0  18089   82
1    486  116
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.967623, 'precision': 0.8633536, 'recall': 0.62031674, 'specificity': 0.62031674, 'f1': 0.6760677, 'auroc': 0.79208213, 'binary_precision': 0.75641024, 'binary_recall': 0.24380165, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.36874998}
confusion matrix:
      0   1
0  5978  19
1   183  59
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512108_8.png
better model found
persisted
after epoch: 8,now: 2024-06-21 04:50:50.555992,epoch time: 0:28:34.269477,used: 3:19:28.978093,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_01_31_21_seed_2_21512108
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9876195, 'precision': 0.9821501, 'recall': 0.9461398, 'specificity': 0.9461398, 'f1': 0.9632623, 'auroc': 0.9938954, 'binary_precision': 0.97549844, 'binary_recall': 0.89469045, 'binary_specificity': 0.9975892, 'binary_f1_score': 0.9333486}
confusion matrix:
       0     1
0  42207   102
1    478  4061
---- Validation: 
scalar performance:
{'acc': 0.9688915, 'precision': 0.7584647, 'recall': 0.59123975, 'specificity': 0.59123975, 'f1': 0.6315576, 'auroc': 0.8027405, 'binary_precision': 0.5432692, 'binary_recall': 0.18770765, 'binary_specificity': 0.9947719, 'binary_f1_score': 0.27901232}
confusion matrix:
       0    1
0  18076   95
1    489  113
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96666133, 'precision': 0.8363245, 'recall': 0.6198164, 'specificity': 0.6198164, 'f1': 0.6724233, 'auroc': 0.7920922, 'binary_precision': 0.70238096, 'binary_recall': 0.24380165, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.36196318}
confusion matrix:
      0   1
0  5972  25
1   183  59
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512108_9.png
early stop counter: 1
val acc:0.9688915014266968, best validation acc: 0.9697437882423401, corresponding to test acc:                         0.9676229953765869 / 0.9677832722663879
after epoch: 9,now: 2024-06-21 05:07:21.651114,epoch time: 0:16:31.095122,used: 3:36:00.073215,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_01_31_21_seed_2_21512108
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98757684, 'precision': 0.9816083, 'recall': 0.9464112, 'specificity': 0.9464112, 'f1': 0.96316606, 'auroc': 0.993954, 'binary_precision': 0.9743467, 'binary_recall': 0.8953514, 'binary_specificity': 0.997471, 'binary_f1_score': 0.93318033}
confusion matrix:
       0     1
0  42202   107
1    475  4064
---- Validation: 
scalar performance:
{'acc': 0.9689448, 'precision': 0.7601788, 'recall': 0.5896612, 'specificity': 0.5896612, 'f1': 0.6299543, 'auroc': 0.8024168, 'binary_precision': 0.54679805, 'binary_recall': 0.18438539, 'binary_specificity': 0.994937, 'binary_f1_score': 0.27577642}
confusion matrix:
       0    1
0  18079   92
1    491  111
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9679436, 'precision': 0.8549303, 'recall': 0.6323799, 'specificity': 0.6323799, 'f1': 0.68873787, 'auroc': 0.7911502, 'binary_precision': 0.7386364, 'binary_recall': 0.26859504, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.39393935}
confusion matrix:
      0   1
0  5974  23
1   177  65
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512108_10.png
new oracle model saved
early stop counter: 2
val acc:0.968944787979126, best validation acc: 0.9697437882423401, corresponding to test acc:                         0.9676229953765869 / 0.9679436087608337
after epoch: 10,now: 2024-06-21 05:42:37.890195,epoch time: 0:35:16.239081,used: 4:11:16.312296,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_01_31_21_seed_2_21512108
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98936987, 'precision': 0.98404515, 'recall': 0.9544843, 'specificity': 0.9544843, 'f1': 0.9686758, 'auroc': 0.99453163, 'binary_precision': 0.9775467, 'binary_recall': 0.91121393, 'binary_specificity': 0.99775463, 'binary_f1_score': 0.94321555}
confusion matrix:
       0     1
0  42214    95
1    403  4136
---- Validation: 
scalar performance:
{'acc': 0.9692111, 'precision': 0.7650248, 'recall': 0.5962232, 'specificity': 0.5962232, 'f1': 0.6379651, 'auroc': 0.8055363, 'binary_precision': 0.55607474, 'binary_recall': 0.19767442, 'binary_specificity': 0.9947719, 'binary_f1_score': 0.2916667}
confusion matrix:
       0    1
0  18076   95
1    483  119
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96714216, 'precision': 0.84169245, 'recall': 0.6260148, 'specificity': 0.6260148, 'f1': 0.6800129, 'auroc': 0.78772306, 'binary_precision': 0.7126437, 'binary_recall': 0.25619835, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.3768997}
confusion matrix:
      0   1
0  5972  25
1   180  62
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512108_11.png
early stop counter: 3
val acc:0.9692111015319824, best validation acc: 0.9697437882423401, corresponding to test acc:                         0.9676229953765869 / 0.9679436087608337
after epoch: 11,now: 2024-06-21 06:22:14.013102,epoch time: 0:39:36.122907,used: 4:50:52.435203,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_01_31_21_seed_2_21512108
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9888149, 'precision': 0.9831649, 'recall': 0.9521119, 'specificity': 0.9521119, 'f1': 0.96698636, 'auroc': 0.99450994, 'binary_precision': 0.9762752, 'binary_recall': 0.90658736, 'binary_specificity': 0.99763644, 'binary_f1_score': 0.9401417}
confusion matrix:
       0     1
0  42209   100
1    424  4115
---- Validation: 
scalar performance:
{'acc': 0.9693176, 'precision': 0.7671325, 'recall': 0.5978843, 'specificity': 0.5978843, 'f1': 0.64008033, 'auroc': 0.81650656, 'binary_precision': 0.5601852, 'binary_recall': 0.20099668, 'binary_specificity': 0.9947719, 'binary_f1_score': 0.2958435}
confusion matrix:
       0    1
0  18076   95
1    481  121
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9652188, 'precision': 0.8247775, 'recall': 0.5952732, 'specificity': 0.5952732, 'f1': 0.64220786, 'auroc': 0.8006028, 'binary_precision': 0.68115944, 'binary_recall': 0.19421488, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.30225083}
confusion matrix:
      0   1
0  5975  22
1   195  47
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512108_12.png
early stop counter: 4
val acc:0.969317615032196, best validation acc: 0.9697437882423401, corresponding to test acc:                         0.9676229953765869 / 0.9679436087608337
after epoch: 12,now: 2024-06-21 07:01:37.019094,epoch time: 0:39:23.005992,used: 5:30:15.441195,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_01_31_21_seed_2_21512108
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98936987, 'precision': 0.9849595, 'recall': 0.9535892, 'specificity': 0.9535892, 'f1': 0.9686116, 'auroc': 0.9953097, 'binary_precision': 0.97958213, 'binary_recall': 0.9092111, 'binary_specificity': 0.99796736, 'binary_f1_score': 0.9430857}
confusion matrix:
       0     1
0  42224    86
1    412  4126
---- Validation: 
scalar performance:
{'acc': 0.9696905, 'precision': 0.7745285, 'recall': 0.6028952, 'specificity': 0.6028952, 'f1': 0.6465663, 'auroc': 0.82214785, 'binary_precision': 0.57466066, 'binary_recall': 0.21096346, 'binary_specificity': 0.9948269, 'binary_f1_score': 0.30862698}
confusion matrix:
       0    1
0  18077   94
1    475  127
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650585, 'precision': 0.8277176, 'recall': 0.5892416, 'specificity': 0.5892416, 'f1': 0.6348359, 'auroc': 0.80864537, 'binary_precision': 0.6875, 'binary_recall': 0.18181819, 'binary_specificity': 0.996665, 'binary_f1_score': 0.2875817}
confusion matrix:
      0   1
0  5977  20
1   198  44
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512108_13.png
early stop counter: 5
val acc:0.9696905016899109, best validation acc: 0.9697437882423401, corresponding to test acc:                         0.9676229953765869 / 0.9679436087608337
after epoch: 13,now: 2024-06-21 07:39:02.947121,epoch time: 0:37:25.928027,used: 6:07:41.369222,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_01_31_21_seed_2_21512108
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9892845, 'precision': 0.9838815, 'recall': 0.9541223, 'specificity': 0.9541223, 'f1': 0.9684048, 'auroc': 0.9950181, 'binary_precision': 0.97728884, 'binary_recall': 0.9105136, 'binary_specificity': 0.9977311, 'binary_f1_score': 0.94272023}
confusion matrix:
       0     1
0  42215    96
1    406  4131
---- Validation: 
scalar performance:
{'acc': 0.9690513, 'precision': 0.7600645, 'recall': 0.6009589, 'specificity': 0.6009589, 'f1': 0.64250886, 'auroc': 0.8238491, 'binary_precision': 0.5458515, 'binary_recall': 0.2076412, 'binary_specificity': 0.9942766, 'binary_f1_score': 0.30084237}
confusion matrix:
       0    1
0  18067  104
1    477  125
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9648982, 'precision': 0.80089366, 'recall': 0.61096835, 'specificity': 0.61096835, 'f1': 0.65816015, 'auroc': 0.80649465, 'binary_precision': 0.6321839, 'binary_recall': 0.22727273, 'binary_specificity': 0.994664, 'binary_f1_score': 0.3343465}
confusion matrix:
      0   1
0  5965  32
1   187  55
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512108_14.png
early stop counter: 6
val acc:0.9690513014793396, best validation acc: 0.9697437882423401, corresponding to test acc:                         0.9676229953765869 / 0.9679436087608337
after epoch: 14,now: 2024-06-21 08:21:43.250033,epoch time: 0:42:40.302912,used: 6:50:21.672134,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_01_31_21_seed_2_21512108
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9901597, 'precision': 0.9866022, 'recall': 0.9565933, 'specificity': 0.9565933, 'f1': 0.9709942, 'auroc': 0.9955733, 'binary_precision': 0.9822611, 'binary_recall': 0.91495925, 'binary_specificity': 0.9982273, 'binary_f1_score': 0.9474165}
confusion matrix:
       0     1
0  42234    75
1    386  4153
---- Validation: 
scalar performance:
{'acc': 0.9688382, 'precision': 0.75751007, 'recall': 0.58960617, 'specificity': 0.58960617, 'f1': 0.6295849, 'auroc': 0.8233695, 'binary_precision': 0.54146343, 'binary_recall': 0.18438539, 'binary_specificity': 0.9948269, 'binary_f1_score': 0.27509296}
confusion matrix:
       0    1
0  18077   94
1    491  111
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9634557, 'precision': 0.78247684, 'recall': 0.5864251, 'specificity': 0.5864251, 'f1': 0.62757075, 'auroc': 0.80061865, 'binary_precision': 0.5972222, 'binary_recall': 0.17768595, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.27388534}
confusion matrix:
      0   1
0  5968  29
1   199  43
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512108_15.png
early stop counter: 7
val acc:0.9688382148742676, best validation acc: 0.9697437882423401, corresponding to test acc:                         0.9676229953765869 / 0.9679436087608337
after epoch: 15,now: 2024-06-21 09:03:13.204006,epoch time: 0:41:29.953973,used: 7:31:51.626107,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_01_31_21_seed_2_21512108
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99033046, 'precision': 0.98468685, 'recall': 0.9594413, 'specificity': 0.9594413, 'f1': 0.9716368, 'auroc': 0.9953622, 'binary_precision': 0.97778296, 'binary_recall': 0.921128, 'binary_specificity': 0.99775463, 'binary_f1_score': 0.9486103}
confusion matrix:
       0     1
0  42214    95
1    358  4181
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.7371241, 'recall': 0.6003811, 'specificity': 0.6003811, 'f1': 0.63851064, 'auroc': 0.8269297, 'binary_precision': 0.5, 'binary_recall': 0.2076412, 'binary_specificity': 0.9931209, 'binary_f1_score': 0.29342723}
confusion matrix:
       0    1
0  18046  125
1    477  125
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9648982, 'precision': 0.7944623, 'recall': 0.6208821, 'specificity': 0.6208821, 'f1': 0.66797066, 'auroc': 0.8033059, 'binary_precision': 0.6185567, 'binary_recall': 0.24793388, 'binary_specificity': 0.99383026, 'binary_f1_score': 0.3539823}
confusion matrix:
      0   1
0  5960  37
1   182  60
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512108_16.png
early stop counter: 8
val acc:0.9679326415061951, best validation acc: 0.9697437882423401, corresponding to test acc:                         0.9676229953765869 / 0.9679436087608337
after epoch: 16,now: 2024-06-21 09:43:30.298718,epoch time: 0:40:17.094712,used: 8:12:08.720819,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_01_31_21_seed_2_21512108
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9909281, 'precision': 0.9855841, 'recall': 0.962034, 'specificity': 0.962034, 'f1': 0.9734384, 'auroc': 0.9958213, 'binary_precision': 0.9790405, 'binary_recall': 0.9261952, 'binary_specificity': 0.99787277, 'binary_f1_score': 0.9518849}
confusion matrix:
       0     1
0  42219    90
1    335  4204
---- Validation: 
scalar performance:
{'acc': 0.9687317, 'precision': 0.75405335, 'recall': 0.5943694, 'specificity': 0.5943694, 'f1': 0.6345174, 'auroc': 0.8313252, 'binary_precision': 0.53424656, 'binary_recall': 0.19435216, 'binary_specificity': 0.9943867, 'binary_f1_score': 0.2850183}
confusion matrix:
       0    1
0  18069  102
1    485  117
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96361595, 'precision': 0.7816404, 'recall': 0.59443945, 'specificity': 0.59443945, 'f1': 0.63708127, 'auroc': 0.7979015, 'binary_precision': 0.5949367, 'binary_recall': 0.19421488, 'binary_specificity': 0.994664, 'binary_f1_score': 0.29283488}
confusion matrix:
      0   1
0  5965  32
1   195  47
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512108_17.png
early stop counter: 9
val acc:0.968731701374054, best validation acc: 0.9697437882423401, corresponding to test acc:                         0.9676229953765869 / 0.9679436087608337
after epoch: 17,now: 2024-06-21 10:10:54.983993,epoch time: 0:27:24.685275,used: 8:39:33.406094,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_01_31_21_seed_2_21512108
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99088544, 'precision': 0.987272, 'recall': 0.9601419, 'specificity': 0.9601419, 'f1': 0.97321564, 'auroc': 0.9957455, 'binary_precision': 0.9828558, 'binary_recall': 0.9220092, 'binary_specificity': 0.9982746, 'binary_f1_score': 0.9514607}
confusion matrix:
       0     1
0  42236    73
1    354  4185
---- Validation: 
scalar performance:
{'acc': 0.9685719, 'precision': 0.7524519, 'recall': 0.5806351, 'specificity': 0.5806351, 'f1': 0.6185564, 'auroc': 0.825721, 'binary_precision': 0.5319149, 'binary_recall': 0.16611296, 'binary_specificity': 0.9951571, 'binary_f1_score': 0.25316456}
confusion matrix:
       0    1
0  18083   88
1    502  100
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96281457, 'precision': 0.7724633, 'recall': 0.57419515, 'specificity': 0.57419515, 'f1': 0.611385, 'auroc': 0.78697217, 'binary_precision': 0.578125, 'binary_recall': 0.15289256, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.24183007}
confusion matrix:
      0   1
0  5970  27
1   205  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512108_18.png
