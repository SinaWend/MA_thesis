Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0




!!!: not committed yet



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_15_seed_0_21520749

 Experiment start at: 2024-06-21 11:23:15.188329
before training, model accuracy: 0.31128156185150146
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9055417, 'precision': 0.5956746, 'recall': 0.50016814, 'specificity': 0.50016814, 'f1': 0.4756678, 'auroc': 0.4700565, 'binary_precision': 0.2857143, 'binary_recall': 0.00045475215, 'binary_specificity': 0.9998815, 'binary_f1_score': 0.000908059}
confusion matrix:
       0  1
0  42189  5
1   4396  2
---- Validation: 
scalar performance:
{'acc': 0.9650915, 'precision': 0.48287982, 'recall': 0.49964187, 'specificity': 0.49964187, 'f1': 0.49111786, 'auroc': 0.32920414, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99928373, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18136  13
1    643   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9574944, 'precision': 0.47913003, 'recall': 0.49958313, 'specificity': 0.49958313, 'f1': 0.48914286, 'auroc': 0.26838017, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5992  5
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520749_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-21 11:39:56.036267,epoch time: 0:16:40.847938,used: 0:16:40.847938,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_15_seed_0_21520749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.90552026, 'precision': 0.45276013, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.47520897, 'auroc': 0.52321136, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42190  0
1   4402  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.3174063, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.2358593, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520749_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-21 11:54:29.952727,epoch time: 0:14:33.916460,used: 0:31:14.764398,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_15_seed_0_21520749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.90537, 'precision': 0.452685, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.47516754, 'auroc': 0.5866653, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42183  0
1   4409  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.3276748, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.23754598, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520749_3.png
early stop counter: 1
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 3,now: 2024-06-21 12:09:42.054780,epoch time: 0:15:12.102053,used: 0:46:26.866451,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_15_seed_0_21520749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.905413, 'precision': 0.4527065, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4751794, 'auroc': 0.6598756, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42185  0
1   4407  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.33634734, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.2564296, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520749_4.png
early stop counter: 2
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 4,now: 2024-06-21 12:24:02.257619,epoch time: 0:14:20.202839,used: 1:00:47.069290,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_15_seed_0_21520749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.905692, 'precision': 0.452846, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.47525623, 'auroc': 0.73709583, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42198  0
1   4394  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.35931575, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.29544306, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520749_5.png
early stop counter: 3
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 5,now: 2024-06-21 12:37:57.791234,epoch time: 0:13:55.533615,used: 1:14:42.602905,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_15_seed_0_21520749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.90564907, 'precision': 0.45282453, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4752444, 'auroc': 0.79084206, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42196  0
1   4396  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.37270212, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.3067971, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520749_6.png
early stop counter: 4
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 6,now: 2024-06-21 12:52:15.922749,epoch time: 0:14:18.131515,used: 1:29:00.734420,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_15_seed_0_21520749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9055417, 'precision': 0.45277086, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.47521487, 'auroc': 0.83507943, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42191  0
1   4401  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.3859063, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.32795197, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520749_7.png
early stop counter: 5
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 7,now: 2024-06-21 13:08:39.637684,epoch time: 0:16:23.714935,used: 1:45:24.449355,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_15_seed_0_21520749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.90562755, 'precision': 0.9528057, 'recall': 0.5009081, 'specificity': 0.5009081, 'f1': 0.47704685, 'auroc': 0.87306595, 'binary_precision': 1.0, 'binary_recall': 0.001816118, 'binary_specificity': 1.0, 'binary_f1_score': 0.0036256514}
confusion matrix:
       0  1
0  42187  0
1   4397  8
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.4066143, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.37414894, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520749_8.png
early stop counter: 6
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 8,now: 2024-06-21 13:26:50.731816,epoch time: 0:18:11.094132,used: 2:03:35.543487,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_15_seed_0_21520749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.906808, 'precision': 0.9533439, 'recall': 0.5068151, 'specificity': 0.5068151, 'f1': 0.4889772, 'auroc': 0.8835778, 'binary_precision': 1.0, 'binary_recall': 0.0136301685, 'binary_specificity': 1.0, 'binary_f1_score': 0.02689377}
confusion matrix:
       0   1
0  42190   0
1   4342  60
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.42317334, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.38087562, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520749_9.png
early stop counter: 7
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 9,now: 2024-06-21 13:44:52.049326,epoch time: 0:18:01.317510,used: 2:21:36.860997,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_15_seed_0_21520749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9103709, 'precision': 0.9527654, 'recall': 0.5255563, 'specificity': 0.5255563, 'f1': 0.52506036, 'auroc': 0.9059914, 'binary_precision': 0.99557525, 'binary_recall': 0.051136363, 'binary_specificity': 0.9999763, 'binary_f1_score': 0.09727627}
confusion matrix:
       0    1
0  42191    1
1   4175  225
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.44562697, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.4230966, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520749_10.png
early stop counter: 8
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 10,now: 2024-06-21 14:02:46.692372,epoch time: 0:17:54.643046,used: 2:39:31.504043,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_15_seed_0_21520749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.91685265, 'precision': 0.95608026, 'recall': 0.55987626, 'specificity': 0.55987626, 'f1': 0.58499247, 'auroc': 0.912513, 'binary_precision': 0.9962193, 'binary_recall': 0.11979996, 'binary_specificity': 0.9999526, 'binary_f1_score': 0.21387987}
confusion matrix:
       0    1
0  42191    2
1   3872  527
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.44774005, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.44084048, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520749_11.png
early stop counter: 9
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 11,now: 2024-06-21 14:21:21.591822,epoch time: 0:18:34.899450,used: 2:58:06.403493,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_15_seed_0_21520749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9229696, 'precision': 0.95839095, 'recall': 0.5922883, 'specificity': 0.5922883, 'f1': 0.63536566, 'auroc': 0.92561615, 'binary_precision': 0.99509805, 'binary_recall': 0.18467137, 'binary_specificity': 0.9999052, 'binary_f1_score': 0.3115289}
confusion matrix:
       0    1
0  42191    4
1   3585  812
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.47031295, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581336, 'precision': 0.47914335, 'recall': 0.4999166, 'specificity': 0.4999166, 'f1': 0.48930964, 'auroc': 0.46744, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5996  1
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520749_12.png
early stop counter: 10
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 12,now: 2024-06-21 14:39:36.211253,epoch time: 0:18:14.619431,used: 3:16:21.022924,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_15_seed_0_21520749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.92745537, 'precision': 0.9600669, 'recall': 0.61660695, 'specificity': 0.61660695, 'f1': 0.66973597, 'auroc': 0.92883015, 'binary_precision': 0.99419165, 'binary_recall': 0.23335606, 'binary_specificity': 0.9998578, 'binary_f1_score': 0.37799045}
confusion matrix:
       0     1
0  42185     6
1   3374  1027
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.47535655, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581336, 'precision': 0.47914335, 'recall': 0.4999166, 'specificity': 0.4999166, 'f1': 0.48930964, 'auroc': 0.47807747, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5996  1
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520749_13.png
early stop counter: 11
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 13,now: 2024-06-21 14:58:30.089513,epoch time: 0:18:53.878260,used: 3:35:14.901184,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_15_seed_0_21520749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9321557, 'precision': 0.96358633, 'recall': 0.6413656, 'specificity': 0.6413656, 'f1': 0.70225894, 'auroc': 0.9340222, 'binary_precision': 0.99679744, 'binary_recall': 0.28282598, 'binary_specificity': 0.99990517, 'binary_f1_score': 0.44063}
confusion matrix:
       0     1
0  42186     4
1   3157  1245
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.48472595, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581336, 'precision': 0.47914335, 'recall': 0.4999166, 'specificity': 0.4999166, 'f1': 0.48930964, 'auroc': 0.49657413, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5996  1
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520749_14.png
early stop counter: 12
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 14,now: 2024-06-21 15:14:09.832411,epoch time: 0:15:39.742898,used: 3:50:54.644082,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_15_seed_0_21520749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.93953896, 'precision': 0.9656893, 'recall': 0.68119395, 'specificity': 0.68119395, 'f1': 0.7495221, 'auroc': 0.94183385, 'binary_precision': 0.9937772, 'binary_recall': 0.36262488, 'binary_specificity': 0.99976295, 'binary_f1_score': 0.53135914}
confusion matrix:
       0     1
0  42178    10
1   2807  1597
---- Validation: 
scalar performance:
{'acc': 0.9657301, 'precision': 0.48289075, 'recall': 0.49997246, 'specificity': 0.49997246, 'f1': 0.4912832, 'auroc': 0.5223471, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9999449, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18148  1
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579738, 'precision': 0.47914, 'recall': 0.49983326, 'specificity': 0.49983326, 'f1': 0.48926792, 'auroc': 0.5413387, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5995  2
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520749_15.png
early stop counter: 13
val acc:0.9657300710678101, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 15,now: 2024-06-21 15:28:22.178393,epoch time: 0:14:12.345982,used: 4:05:06.990064,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_15_seed_0_21520749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9452481, 'precision': 0.96689653, 'recall': 0.7119458, 'specificity': 0.7119458, 'f1': 0.78237855, 'auroc': 0.9464687, 'binary_precision': 0.9904509, 'binary_recall': 0.4243182, 'binary_specificity': 0.99957335, 'binary_f1_score': 0.594113}
confusion matrix:
       0     1
0  42174    18
1   2533  1867
---- Validation: 
scalar performance:
{'acc': 0.9657301, 'precision': 0.48289075, 'recall': 0.49997246, 'specificity': 0.49997246, 'f1': 0.4912832, 'auroc': 0.5290214, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9999449, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18148  1
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579738, 'precision': 0.47914, 'recall': 0.49983326, 'specificity': 0.49983326, 'f1': 0.48926792, 'auroc': 0.5609118, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5995  2
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520749_16.png
early stop counter: 14
val acc:0.9657300710678101, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 16,now: 2024-06-21 15:42:55.828026,epoch time: 0:14:33.649633,used: 4:19:40.639697,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_15_seed_0_21520749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.94627833, 'precision': 0.96899605, 'recall': 0.7168539, 'specificity': 0.7168539, 'f1': 0.7876637, 'auroc': 0.9500505, 'binary_precision': 0.99375653, 'binary_recall': 0.43399227, 'binary_specificity': 0.99971557, 'binary_f1_score': 0.60414356}
confusion matrix:
       0     1
0  42179    12
1   2491  1910
---- Validation: 
scalar performance:
{'acc': 0.9657301, 'precision': 0.48289075, 'recall': 0.49997246, 'specificity': 0.49997246, 'f1': 0.4912832, 'auroc': 0.54312396, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9999449, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18148  1
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.957814, 'precision': 0.4791367, 'recall': 0.49974987, 'specificity': 0.49974987, 'f1': 0.48922622, 'auroc': 0.5698533, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5994  3
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520749_17.png
early stop counter: 15
val acc:0.9657300710678101, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 17,now: 2024-06-21 16:00:20.298803,epoch time: 0:17:24.470777,used: 4:37:05.110474,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_15_seed_0_21520749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9498412, 'precision': 0.9707724, 'recall': 0.7353944, 'specificity': 0.7353944, 'f1': 0.806116, 'auroc': 0.9557326, 'binary_precision': 0.993759, 'binary_recall': 0.47109696, 'binary_specificity': 0.9996919, 'binary_f1_score': 0.63918483}
confusion matrix:
       0     1
0  42185    13
1   2324  2070
---- Validation: 
scalar performance:
{'acc': 0.9656769, 'precision': 0.6079146, 'recall': 0.500695, 'specificity': 0.500695, 'f1': 0.49281454, 'auroc': 0.55864364, 'binary_precision': 0.25, 'binary_recall': 0.00155521, 'binary_specificity': 0.9998347, 'binary_f1_score': 0.0030911902}
confusion matrix:
       0  1
0  18146  3
1    642  1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9576542, 'precision': 0.47913337, 'recall': 0.4996665, 'specificity': 0.4996665, 'f1': 0.48918456, 'auroc': 0.59576535, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.999333, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5993  4
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520749_18.png
early stop counter: 16
val acc:0.9656769037246704, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 18,now: 2024-06-21 16:15:48.974091,epoch time: 0:15:28.675288,used: 4:52:33.785762,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_15_seed_0_21520749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.95258844, 'precision': 0.9727479, 'recall': 0.7498128, 'specificity': 0.7498128, 'f1': 0.8199707, 'auroc': 0.95817244, 'binary_precision': 0.9950181, 'binary_recall': 0.49988624, 'binary_specificity': 0.9997393, 'binary_f1_score': 0.6654551}
confusion matrix:
       0     1
0  42186    11
1   2198  2197
---- Validation: 
scalar performance:
{'acc': 0.9657301, 'precision': 0.6829403, 'recall': 0.5014726, 'specificity': 0.5014726, 'f1': 0.49436864, 'auroc': 0.55559933, 'binary_precision': 0.4, 'binary_recall': 0.00311042, 'binary_specificity': 0.9998347, 'binary_f1_score': 0.00617284}
confusion matrix:
       0  1
0  18146  3
1    641  2
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.957814, 'precision': 0.4791367, 'recall': 0.49974987, 'specificity': 0.49974987, 'f1': 0.48922622, 'auroc': 0.58334404, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5994  3
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520749_19.png
early stop counter: 17
val acc:0.9657300710678101, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 19,now: 2024-06-21 16:29:35.446214,epoch time: 0:13:46.472123,used: 5:06:20.257885,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_15_seed_0_21520749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.95516396, 'precision': 0.97315943, 'recall': 0.7641351, 'specificity': 0.7641351, 'f1': 0.8329239, 'auroc': 0.95835143, 'binary_precision': 0.9931653, 'binary_recall': 0.5286494, 'binary_specificity': 0.9996208, 'binary_f1_score': 0.69001335}
confusion matrix:
       0     1
0  42178    16
1   2073  2325
---- Validation: 
scalar performance:
{'acc': 0.9657301, 'precision': 0.69725084, 'recall': 0.5022226, 'specificity': 0.5022226, 'f1': 0.4958971, 'auroc': 0.5739747, 'binary_precision': 0.42857143, 'binary_recall': 0.00466563, 'binary_specificity': 0.9997796, 'binary_f1_score': 0.009230768}
confusion matrix:
       0  1
0  18145  4
1    640  3
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9576542, 'precision': 0.47913337, 'recall': 0.4996665, 'specificity': 0.4996665, 'f1': 0.48918456, 'auroc': 0.61200655, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.999333, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5993  4
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520749_20.png
early stop counter: 18
val acc:0.9657300710678101, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 20,now: 2024-06-21 16:42:55.448000,epoch time: 0:13:20.001786,used: 5:19:40.259671,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_15_seed_0_21520749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.95477766, 'precision': 0.973547, 'recall': 0.7617832, 'specificity': 0.7617832, 'f1': 0.8309288, 'auroc': 0.95891356, 'binary_precision': 0.9943893, 'binary_recall': 0.52387446, 'binary_specificity': 0.9996919, 'binary_f1_score': 0.6862248}
confusion matrix:
       0     1
0  42181    13
1   2094  2304
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.73296607, 'recall': 0.5022502, 'specificity': 0.5022502, 'f1': 0.495918, 'auroc': 0.56595075, 'binary_precision': 0.5, 'binary_recall': 0.00466563, 'binary_specificity': 0.9998347, 'binary_f1_score': 0.009244992}
confusion matrix:
       0  1
0  18146  3
1    640  3
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9574944, 'precision': 0.47913003, 'recall': 0.49958313, 'specificity': 0.49958313, 'f1': 0.48914286, 'auroc': 0.5966692, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5992  5
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520749_21.png
early stop counter: 19
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 21,now: 2024-06-21 16:55:42.740469,epoch time: 0:12:47.292469,used: 5:32:27.552140,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_15_seed_0_21520749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9584693, 'precision': 0.9748535, 'recall': 0.7820914, 'specificity': 0.7820914, 'f1': 0.8487511, 'auroc': 0.96438503, 'binary_precision': 0.99321085, 'binary_recall': 0.5645857, 'binary_specificity': 0.999597, 'binary_f1_score': 0.7199305}
confusion matrix:
       0     1
0  42170    17
1   1918  2487
---- Validation: 
scalar performance:
{'acc': 0.9657301, 'precision': 0.7052122, 'recall': 0.50297266, 'specificity': 0.50297266, 'f1': 0.4974162, 'auroc': 0.5787595, 'binary_precision': 0.44444445, 'binary_recall': 0.00622084, 'binary_specificity': 0.9997245, 'binary_f1_score': 0.012269938}
confusion matrix:
       0  1
0  18144  5
1    639  4
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9576542, 'precision': 0.60428, 'recall': 0.5033312, 'specificity': 0.5033312, 'f1': 0.49661598, 'auroc': 0.608492, 'binary_precision': 0.25, 'binary_recall': 0.007662835, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.014869888}
confusion matrix:
      0  1
0  5991  6
1   259  2
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520749_22.png
early stop counter: 20
val acc:0.9657300710678101, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 22,now: 2024-06-21 17:09:31.203910,epoch time: 0:13:48.463441,used: 5:46:16.015581,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_15_seed_0_21520749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 22 with time: 5:46:16.015581 at 2024-06-21 17:09:31.203910
persisted model performance metric: 

scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.2358593, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
oracle model performance metric: 

scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.2358593, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_differentbatchsizes_lre5_classbalancing3/rule_results/4.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_differentbatchsizes_lre5_classbalancing3/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_resnet_differentbatchsizes_lre5_classbalancing3/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204097 KiB |   3077 MiB | 267476 GiB | 267475 GiB |
|       from large pool | 167936 KiB |   3007 MiB | 267446 GiB | 267446 GiB |
|       from small pool |  36161 KiB |     72 MiB |     29 GiB |     29 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 204097 KiB |   3077 MiB | 267476 GiB | 267475 GiB |
|       from large pool | 167936 KiB |   3007 MiB | 267446 GiB | 267446 GiB |
|       from small pool |  36161 KiB |     72 MiB |     29 GiB |     29 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201088 KiB |   3071 MiB | 267454 GiB | 267454 GiB |
|       from large pool | 165120 KiB |   3001 MiB | 267425 GiB | 267425 GiB |
|       from small pool |  35968 KiB |     71 MiB |     29 GiB |     28 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3518 MiB |   3518 MiB |   3518 MiB |      0 B   |
|       from large pool |   3444 MiB |   3444 MiB |   3444 MiB |      0 B   |
|       from small pool |     74 MiB |     74 MiB |     74 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |    786 MiB |   1614 MiB | 183759 GiB | 183758 GiB |
|       from large pool |    780 MiB |   1612 MiB | 183728 GiB | 183727 GiB |
|       from small pool |      6 MiB |     12 MiB |     31 GiB |     31 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1050    |    1707    |    4184 K  |    4183 K  |
|       from large pool |      36    |      76    |    1341 K  |    1341 K  |
|       from small pool |    1014    |    1636    |    2843 K  |    2842 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1050    |    1707    |    4184 K  |    4183 K  |
|       from large pool |      36    |      76    |    1341 K  |    1341 K  |
|       from small pool |    1014    |    1636    |    2843 K  |    2842 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      50    |      50    |      50    |       0    |
|       from large pool |      13    |      13    |      13    |       0    |
|       from small pool |      37    |      37    |      37    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      31    |     198    |    2264 K  |    2264 K  |
|       from large pool |       5    |      10    |     475 K  |     475 K  |
|       from small pool |      26    |     193    |    1788 K  |    1788 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3077 MiB | 267476 GiB | 267476 GiB |
|       from large pool |  16640 KiB |   3007 MiB | 267446 GiB | 267446 GiB |
|       from small pool |      0 KiB |     72 MiB |     29 GiB |     29 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3077 MiB | 267476 GiB | 267476 GiB |
|       from large pool |  16640 KiB |   3007 MiB | 267446 GiB | 267446 GiB |
|       from small pool |      0 KiB |     72 MiB |     29 GiB |     29 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3071 MiB | 267454 GiB | 267454 GiB |
|       from large pool |  16640 KiB |   3001 MiB | 267425 GiB | 267425 GiB |
|       from small pool |      0 KiB |     71 MiB |     29 GiB |     29 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    986 MiB |   3518 MiB |   3518 MiB |   2532 MiB |
|       from large pool |    944 MiB |   3444 MiB |   3444 MiB |   2500 MiB |
|       from small pool |     42 MiB |     74 MiB |     74 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 786176 KiB |   1614 MiB | 183759 GiB | 183758 GiB |
|       from large pool | 786176 KiB |   1612 MiB | 183728 GiB | 183727 GiB |
|       from small pool |      0 KiB |     14 MiB |     31 GiB |     31 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1707    |    4184 K  |    4184 K  |
|       from large pool |       2    |      76    |    1341 K  |    1341 K  |
|       from small pool |       0    |    1636    |    2843 K  |    2843 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1707    |    4184 K  |    4184 K  |
|       from large pool |       2    |      76    |    1341 K  |    1341 K  |
|       from small pool |       0    |    1636    |    2843 K  |    2843 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      30    |      50    |      50    |      20    |
|       from large pool |       9    |      13    |      13    |       4    |
|       from small pool |      21    |      37    |      37    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     198    |    2264 K  |    2264 K  |
|       from large pool |       1    |      11    |     475 K  |     475 K  |
|       from small pool |       0    |     193    |    1788 K  |    1788 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3077 MiB | 267476 GiB | 267476 GiB |
|       from large pool |  16640 KiB |   3007 MiB | 267446 GiB | 267446 GiB |
|       from small pool |      0 KiB |     72 MiB |     29 GiB |     29 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3077 MiB | 267476 GiB | 267476 GiB |
|       from large pool |  16640 KiB |   3007 MiB | 267446 GiB | 267446 GiB |
|       from small pool |      0 KiB |     72 MiB |     29 GiB |     29 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3071 MiB | 267454 GiB | 267454 GiB |
|       from large pool |  16640 KiB |   3001 MiB | 267425 GiB | 267425 GiB |
|       from small pool |      0 KiB |     71 MiB |     29 GiB |     29 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    986 MiB |   3518 MiB |   3518 MiB |   2532 MiB |
|       from large pool |    944 MiB |   3444 MiB |   3444 MiB |   2500 MiB |
|       from small pool |     42 MiB |     74 MiB |     74 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 786176 KiB |   1614 MiB | 183759 GiB | 183758 GiB |
|       from large pool | 786176 KiB |   1612 MiB | 183728 GiB | 183727 GiB |
|       from small pool |      0 KiB |     14 MiB |     31 GiB |     31 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1707    |    4184 K  |    4184 K  |
|       from large pool |       2    |      76    |    1341 K  |    1341 K  |
|       from small pool |       0    |    1636    |    2843 K  |    2843 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1707    |    4184 K  |    4184 K  |
|       from large pool |       2    |      76    |    1341 K  |    1341 K  |
|       from small pool |       0    |    1636    |    2843 K  |    2843 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      30    |      50    |      50    |      20    |
|       from large pool |       9    |      13    |      13    |       4    |
|       from small pool |      21    |      37    |      37    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     198    |    2264 K  |    2264 K  |
|       from large pool |       1    |      11    |     475 K  |     475 K  |
|       from small pool |       0    |     193    |    1788 K  |    1788 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0




!!!: not committed yet



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_17_16_50_seed_1_21520749

 Experiment start at: 2024-06-21 17:16:50.424211
before training, model accuracy: 0.1456654816865921
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9041037, 'precision': 0.45670477, 'recall': 0.49821225, 'specificity': 0.49821225, 'f1': 0.4750417, 'auroc': 0.3896376, 'binary_precision': 0.0061728396, 'binary_recall': 0.00023212627, 'binary_specificity': 0.9961924, 'binary_f1_score': 0.0004474273}
confusion matrix:
       0    1
0  42123  161
1   4307    1
---- Validation: 
scalar performance:
{'acc': 0.92972255, 'precision': 0.48140472, 'recall': 0.48217744, 'specificity': 0.48217744, 'f1': 0.48179078, 'auroc': 0.28468543, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9643549, 'binary_f1_score': 0.0}
confusion matrix:
       0    1
0  17423  644
1    673    0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93747985, 'precision': 0.4825328, 'recall': 0.49107546, 'specificity': 0.49107546, 'f1': 0.48642704, 'auroc': 0.19621724, 'binary_precision': 0.0076923077, 'binary_recall': 0.0038461538, 'binary_specificity': 0.97830474, 'binary_f1_score': 0.005128205}
confusion matrix:
      0    1
0  5817  129
1   259    1
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520749_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-21 17:31:18.950777,epoch time: 0:14:28.526566,used: 0:14:28.526566,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_17_16_50_seed_1_21520749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9067222, 'precision': 0.4537409, 'recall': 0.49953884, 'specificity': 0.49953884, 'f1': 0.47553974, 'auroc': 0.4690498, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9990777, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  42246  39
1   4307   0
---- Validation: 
scalar performance:
{'acc': 0.9630736, 'precision': 0.48202553, 'recall': 0.49947417, 'specificity': 0.49947417, 'f1': 0.49059477, 'auroc': 0.28850043, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99894834, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18048  19
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.1866976, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520749_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-21 17:45:13.279296,epoch time: 0:13:54.328519,used: 0:28:22.855085,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_17_16_50_seed_1_21520749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9071944, 'precision': 0.45374325, 'recall': 0.49982262, 'specificity': 0.49982262, 'f1': 0.4756696, 'auroc': 0.53741837, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99964523, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  42268  15
1   4309   0
---- Validation: 
scalar performance:
{'acc': 0.9636606, 'precision': 0.48203608, 'recall': 0.4997786, 'specificity': 0.4997786, 'f1': 0.49074703, 'auroc': 0.29767013, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9995572, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18059  8
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.19430968, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520749_3.png
better model found
persisted
after epoch: 3,now: 2024-06-21 18:00:05.402224,epoch time: 0:14:52.122928,used: 0:43:14.978013,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_17_16_50_seed_1_21520749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.90730166, 'precision': 0.4537872, 'recall': 0.49983448, 'specificity': 0.49983448, 'f1': 0.4756991, 'auroc': 0.6002327, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99966896, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  42273  14
1   4305   0
---- Validation: 
scalar performance:
{'acc': 0.96392745, 'precision': 0.48204088, 'recall': 0.49991697, 'specificity': 0.49991697, 'f1': 0.4908162, 'auroc': 0.31063986, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99983394, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18064  3
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.20178336, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520749_4.png
better model found
persisted
after epoch: 4,now: 2024-06-21 18:13:46.786065,epoch time: 0:13:41.383841,used: 0:56:56.361854,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_17_16_50_seed_1_21520749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.90721583, 'precision': 0.45368582, 'recall': 0.49990538, 'specificity': 0.49990538, 'f1': 0.47567546, 'auroc': 0.65474844, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99981076, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42269  8
1   4315  0
---- Validation: 
scalar performance:
{'acc': 0.96403414, 'precision': 0.4820428, 'recall': 0.4999723, 'specificity': 0.4999723, 'f1': 0.49084386, 'auroc': 0.32909998, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9999446, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18066  1
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.22540686, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520749_5.png
better model found
persisted
after epoch: 5,now: 2024-06-21 18:28:01.572501,epoch time: 0:14:14.786436,used: 1:11:11.148290,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_17_16_50_seed_1_21520749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.90713, 'precision': 0.45368183, 'recall': 0.49985808, 'specificity': 0.49985808, 'f1': 0.4756519, 'auroc': 0.7294376, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99971616, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  42265  12
1   4315   0
---- Validation: 
scalar performance:
{'acc': 0.96403414, 'precision': 0.4820428, 'recall': 0.4999723, 'specificity': 0.4999723, 'f1': 0.49084386, 'auroc': 0.33880627, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9999446, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18066  1
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.2342103, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520749_6.png
early stop counter: 1
val acc:0.9640341401100159, best validation acc: 0.9640341401100159, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 6,now: 2024-06-21 18:41:21.203750,epoch time: 0:13:19.631249,used: 1:24:30.779539,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_17_16_50_seed_1_21520749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9068939, 'precision': 0.45369038, 'recall': 0.49970433, 'specificity': 0.49970433, 'f1': 0.47558698, 'auroc': 0.77906466, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99940866, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  42254  25
1   4313   0
---- Validation: 
scalar performance:
{'acc': 0.96392745, 'precision': 0.48204088, 'recall': 0.49991697, 'specificity': 0.49991697, 'f1': 0.4908162, 'auroc': 0.35287702, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99983394, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18064  3
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.26387745, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520749_7.png
early stop counter: 2
val acc:0.9639274477958679, best validation acc: 0.9640341401100159, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 7,now: 2024-06-21 18:56:05.007831,epoch time: 0:14:43.804081,used: 1:39:14.583620,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_17_16_50_seed_1_21520749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9063144, 'precision': 0.46233195, 'recall': 0.499442, 'specificity': 0.499442, 'f1': 0.475656, 'auroc': 0.8172859, 'binary_precision': 0.01724138, 'binary_recall': 0.0002320724, 'binary_specificity': 0.9986519, 'binary_f1_score': 0.0004579803}
confusion matrix:
       0   1
0  42226  57
1   4308   1
---- Validation: 
scalar performance:
{'acc': 0.96376735, 'precision': 0.482038, 'recall': 0.49983394, 'specificity': 0.49983394, 'f1': 0.49077466, 'auroc': 0.35499078, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9996679, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18061  6
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.25165853, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520749_8.png
early stop counter: 3
val acc:0.9637673497200012, best validation acc: 0.9640341401100159, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 8,now: 2024-06-21 19:10:46.486428,epoch time: 0:14:41.478597,used: 1:53:56.062217,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_17_16_50_seed_1_21520749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.90625, 'precision': 0.5750439, 'recall': 0.5018927, 'specificity': 0.5018927, 'f1': 0.4808313, 'auroc': 0.85131896, 'binary_precision': 0.24242425, 'binary_recall': 0.0055594165, 'binary_specificity': 0.9982259, 'binary_f1_score': 0.010869565}
confusion matrix:
       0   1
0  42200  75
1   4293  24
---- Validation: 
scalar performance:
{'acc': 0.963714, 'precision': 0.48203704, 'recall': 0.49980628, 'specificity': 0.49980628, 'f1': 0.49076086, 'auroc': 0.37970358, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99961257, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18060  7
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.28445852, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520749_9.png
early stop counter: 4
val acc:0.9637140035629272, best validation acc: 0.9640341401100159, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 9,now: 2024-06-21 19:24:16.069405,epoch time: 0:13:29.582977,used: 2:07:25.645194,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_17_16_50_seed_1_21520749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9077953, 'precision': 0.73872006, 'recall': 0.5110998, 'specificity': 0.5110998, 'f1': 0.49886867, 'auroc': 0.86529684, 'binary_precision': 0.568306, 'binary_recall': 0.024068503, 'binary_specificity': 0.9981311, 'binary_f1_score': 0.046181176}
confusion matrix:
       0    1
0  42192   79
1   4217  104
---- Validation: 
scalar performance:
{'acc': 0.9635539, 'precision': 0.48203418, 'recall': 0.49972326, 'specificity': 0.49972326, 'f1': 0.49071938, 'auroc': 0.3870316, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9994465, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18057  10
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.2952528, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520749_10.png
early stop counter: 5
val acc:0.9635539054870605, best validation acc: 0.9640341401100159, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 10,now: 2024-06-21 19:38:53.422969,epoch time: 0:14:37.353564,used: 2:22:02.998758,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_17_16_50_seed_1_21520749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9107357, 'precision': 0.80991733, 'recall': 0.5282384, 'specificity': 0.5282384, 'f1': 0.530932, 'auroc': 0.88666606, 'binary_precision': 0.7075209, 'binary_recall': 0.058960073, 'binary_specificity': 0.9975168, 'binary_f1_score': 0.10884936}
confusion matrix:
       0    1
0  42179  105
1   4054  254
---- Validation: 
scalar performance:
{'acc': 0.96360725, 'precision': 0.48203513, 'recall': 0.49975094, 'specificity': 0.49975094, 'f1': 0.4907332, 'auroc': 0.4021126, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9995019, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18058  9
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.3261763, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520749_11.png
early stop counter: 6
val acc:0.9636072516441345, best validation acc: 0.9640341401100159, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 11,now: 2024-06-21 19:51:53.094173,epoch time: 0:12:59.671204,used: 2:35:02.669962,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_17_16_50_seed_1_21520749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.915522, 'precision': 0.860152, 'recall': 0.5550652, 'specificity': 0.5550652, 'f1': 0.5767283, 'auroc': 0.8960699, 'binary_precision': 0.8033058, 'binary_recall': 0.112944454, 'binary_specificity': 0.997186, 'binary_f1_score': 0.19804402}
confusion matrix:
       0    1
0  42170  119
1   3817  486
---- Validation: 
scalar performance:
{'acc': 0.9636606, 'precision': 0.48203608, 'recall': 0.4997786, 'specificity': 0.4997786, 'f1': 0.49074703, 'auroc': 0.42363942, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9995572, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18059  8
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.36482897, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520749_12.png
early stop counter: 7
val acc:0.9636605978012085, best validation acc: 0.9640341401100159, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 12,now: 2024-06-21 20:05:08.921317,epoch time: 0:13:15.827144,used: 2:48:18.497106,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_17_16_50_seed_1_21520749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.91927797, 'precision': 0.8760257, 'recall': 0.5792607, 'specificity': 0.5792607, 'f1': 0.6141281, 'auroc': 0.9107866, 'binary_precision': 0.8311534, 'binary_recall': 0.1618805, 'binary_specificity': 0.996641, 'binary_f1_score': 0.27098274}
confusion matrix:
       0    1
0  42132  142
1   3619  699
---- Validation: 
scalar performance:
{'acc': 0.96344715, 'precision': 0.48203224, 'recall': 0.4996679, 'specificity': 0.4996679, 'f1': 0.49069163, 'auroc': 0.44157332, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9993358, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18055  12
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.3895429, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520749_13.png
early stop counter: 8
val acc:0.9634471535682678, best validation acc: 0.9640341401100159, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 13,now: 2024-06-21 20:19:00.557730,epoch time: 0:13:51.636413,used: 3:02:10.133519,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_17_16_50_seed_1_21520749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.92503005, 'precision': 0.90691346, 'recall': 0.60707325, 'specificity': 0.60707325, 'f1': 0.65445566, 'auroc': 0.91313064, 'binary_precision': 0.8879392, 'binary_recall': 0.21693735, 'binary_specificity': 0.9972092, 'binary_f1_score': 0.34868544}
confusion matrix:
       0    1
0  42164  118
1   3375  935
---- Validation: 
scalar performance:
{'acc': 0.96392745, 'precision': 0.48204088, 'recall': 0.49991697, 'specificity': 0.49991697, 'f1': 0.4908162, 'auroc': 0.4449975, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99983394, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18064  3
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.40762502, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520749_14.png
early stop counter: 9
val acc:0.9639274477958679, best validation acc: 0.9640341401100159, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 14,now: 2024-06-21 20:32:37.436300,epoch time: 0:13:36.878570,used: 3:15:47.012089,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_17_16_50_seed_1_21520749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9293441, 'precision': 0.9173205, 'recall': 0.6305995, 'specificity': 0.6305995, 'f1': 0.6855957, 'auroc': 0.9203361, 'binary_precision': 0.9046105, 'binary_recall': 0.26403713, 'binary_specificity': 0.9971619, 'binary_f1_score': 0.4087644}
confusion matrix:
       0     1
0  42162   120
1   3172  1138
---- Validation: 
scalar performance:
{'acc': 0.96392745, 'precision': 0.48204088, 'recall': 0.49991697, 'specificity': 0.49991697, 'f1': 0.4908162, 'auroc': 0.46889994, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99983394, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18064  3
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.4427883, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520749_15.png
early stop counter: 10
val acc:0.9639274477958679, best validation acc: 0.9640341401100159, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 15,now: 2024-06-21 20:47:27.796513,epoch time: 0:14:50.360213,used: 3:30:37.372302,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_17_16_50_seed_1_21520749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.93346494, 'precision': 0.9245926, 'recall': 0.65353006, 'specificity': 0.65353006, 'f1': 0.7138227, 'auroc': 0.92981136, 'binary_precision': 0.9151266, 'binary_recall': 0.30999306, 'binary_specificity': 0.9970671, 'binary_f1_score': 0.4631105}
confusion matrix:
       0     1
0  42155   124
1   2976  1337
---- Validation: 
scalar performance:
{'acc': 0.96392745, 'precision': 0.48204088, 'recall': 0.49991697, 'specificity': 0.49991697, 'f1': 0.4908162, 'auroc': 0.48123375, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99983394, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18064  3
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.46143174, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520749_16.png
early stop counter: 11
val acc:0.9639274477958679, best validation acc: 0.9640341401100159, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 16,now: 2024-06-21 21:00:56.059268,epoch time: 0:13:28.262755,used: 3:44:05.635057,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_17_16_50_seed_1_21520749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.93747854, 'precision': 0.9313512, 'recall': 0.6752087, 'specificity': 0.6752087, 'f1': 0.73896325, 'auroc': 0.93877816, 'binary_precision': 0.9247573, 'binary_recall': 0.35335034, 'binary_specificity': 0.9970671, 'binary_f1_score': 0.51132363}
confusion matrix:
       0     1
0  42155   124
1   2789  1524
---- Validation: 
scalar performance:
{'acc': 0.96392745, 'precision': 0.48204088, 'recall': 0.49991697, 'specificity': 0.49991697, 'f1': 0.4908162, 'auroc': 0.50187695, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99983394, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18064  3
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.49625605, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520749_17.png
early stop counter: 12
val acc:0.9639274477958679, best validation acc: 0.9640341401100159, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 17,now: 2024-06-21 21:13:45.448203,epoch time: 0:12:49.388935,used: 3:56:55.023992,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_17_16_50_seed_1_21520749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9422433, 'precision': 0.94817394, 'recall': 0.6964685, 'specificity': 0.6964685, 'f1': 0.7638676, 'auroc': 0.94237804, 'binary_precision': 0.9545964, 'binary_recall': 0.39485276, 'binary_specificity': 0.9980841, 'binary_f1_score': 0.55863535}
confusion matrix:
       0     1
0  42198    81
1   2610  1703
---- Validation: 
scalar performance:
{'acc': 0.9639808, 'precision': 0.60706663, 'recall': 0.5006599, 'specificity': 0.5006599, 'f1': 0.49230665, 'auroc': 0.5219424, 'binary_precision': 0.25, 'binary_recall': 0.0014858841, 'binary_specificity': 0.99983394, 'binary_f1_score': 0.0029542097}
confusion matrix:
       0  1
0  18064  3
1    672  1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.53204226, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520749_18.png
early stop counter: 13
val acc:0.9639807939529419, best validation acc: 0.9640341401100159, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 18,now: 2024-06-21 21:26:19.143619,epoch time: 0:12:33.695416,used: 4:09:28.719408,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_17_16_50_seed_1_21520749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.94453984, 'precision': 0.94701564, 'recall': 0.7109388, 'specificity': 0.7109388, 'f1': 0.7783523, 'auroc': 0.94900155, 'binary_precision': 0.9497149, 'binary_recall': 0.42417225, 'binary_specificity': 0.9977054, 'binary_f1_score': 0.5864276}
confusion matrix:
       0     1
0  42176    97
1   2487  1832
---- Validation: 
scalar performance:
{'acc': 0.96403414, 'precision': 0.6487342, 'recall': 0.5006876, 'specificity': 0.5006876, 'f1': 0.49232268, 'auroc': 0.53116095, 'binary_precision': 0.33333334, 'binary_recall': 0.0014858841, 'binary_specificity': 0.9998893, 'binary_f1_score': 0.0029585797}
confusion matrix:
       0  1
0  18065  2
1    672  1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.54047716, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520749_19.png
early stop counter: 14
val acc:0.9640341401100159, best validation acc: 0.9640341401100159, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 19,now: 2024-06-21 21:40:04.636330,epoch time: 0:13:45.492711,used: 4:23:14.212119,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_17_16_50_seed_1_21520749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9488324, 'precision': 0.949822, 'recall': 0.73455703, 'specificity': 0.73455703, 'f1': 0.8015076, 'auroc': 0.9483634, 'binary_precision': 0.95091164, 'binary_recall': 0.4715975, 'binary_specificity': 0.9975165, 'binary_f1_score': 0.63050216}
confusion matrix:
       0     1
0  42174   105
1   2279  2034
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.73206854, 'recall': 0.50071526, 'specificity': 0.50071526, 'f1': 0.49233866, 'auroc': 0.5430436, 'binary_precision': 0.5, 'binary_recall': 0.0014858841, 'binary_specificity': 0.9999446, 'binary_f1_score': 0.002962963}
confusion matrix:
       0  1
0  18066  1
1    672  1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.55470777, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520749_20.png
better model found
persisted
after epoch: 20,now: 2024-06-21 21:53:37.807036,epoch time: 0:13:33.170706,used: 4:36:47.382825,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_17_16_50_seed_1_21520749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.95037776, 'precision': 0.9588714, 'recall': 0.73923284, 'specificity': 0.73923284, 'f1': 0.80761266, 'auroc': 0.95208883, 'binary_precision': 0.9682243, 'binary_recall': 0.48007414, 'binary_specificity': 0.9983915, 'binary_f1_score': 0.6418835}
confusion matrix:
       0     1
0  42208    68
1   2244  2072
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.73209333, 'recall': 0.5014305, 'specificity': 0.5014305, 'f1': 0.49381095, 'auroc': 0.54548204, 'binary_precision': 0.5, 'binary_recall': 0.0029717681, 'binary_specificity': 0.9998893, 'binary_f1_score': 0.0059084194}
confusion matrix:
       0  1
0  18065  2
1    671  2
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.5526463, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520749_21.png
early stop counter: 1
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 21,now: 2024-06-21 22:07:03.176725,epoch time: 0:13:25.369689,used: 4:50:12.752514,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_17_16_50_seed_1_21520749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9527172, 'precision': 0.9629855, 'recall': 0.75037, 'specificity': 0.75037, 'f1': 0.81863123, 'auroc': 0.9553026, 'binary_precision': 0.9743359, 'binary_recall': 0.5020882, 'binary_specificity': 0.9986519, 'binary_f1_score': 0.6626857}
confusion matrix:
       0     1
0  42225    57
1   2146  2164
---- Validation: 
scalar performance:
{'acc': 0.96419424, 'precision': 0.98209524, 'recall': 0.5014859, 'specificity': 0.5014859, 'f1': 0.49384734, 'auroc': 0.5524416, 'binary_precision': 1.0, 'binary_recall': 0.0029717681, 'binary_specificity': 1.0, 'binary_f1_score': 0.005925926}
confusion matrix:
       0  1
0  18067  0
1    671  2
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579439, 'precision': 0.47904915, 'recall': 0.4999159, 'specificity': 0.4999159, 'f1': 0.48926014, 'auroc': 0.56766343, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5945  1
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520749_22.png
better model found
persisted
after epoch: 22,now: 2024-06-21 22:20:23.915016,epoch time: 0:13:20.738291,used: 5:03:33.490805,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_17_16_50_seed_1_21520749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.95750344, 'precision': 0.967317, 'recall': 0.7760306, 'specificity': 0.7760306, 'f1': 0.8419658, 'auroc': 0.95987105, 'binary_precision': 0.9782787, 'binary_recall': 0.5533148, 'binary_specificity': 0.9987464, 'binary_f1_score': 0.70684034}
confusion matrix:
       0     1
0  42225    53
1   1927  2387
---- Validation: 
scalar performance:
{'acc': 0.96403414, 'precision': 0.68209237, 'recall': 0.50140285, 'specificity': 0.50140285, 'f1': 0.49379277, 'auroc': 0.5727962, 'binary_precision': 0.4, 'binary_recall': 0.0029717681, 'binary_specificity': 0.99983394, 'binary_f1_score': 0.005899705}
confusion matrix:
       0  1
0  18064  3
1    671  2
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95762163, 'precision': 0.4790424, 'recall': 0.49974772, 'specificity': 0.49974772, 'f1': 0.48917606, 'auroc': 0.5967121, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5943  3
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520749_23.png
early stop counter: 1
val acc:0.9640341401100159, best validation acc: 0.9641942381858826, corresponding to test acc:                         0.9579439163208008 / 0.9581050872802734
after epoch: 23,now: 2024-06-21 22:33:12.919552,epoch time: 0:12:49.004536,used: 5:16:22.495341,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_17_16_50_seed_1_21520749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.95795417, 'precision': 0.9725361, 'recall': 0.77586234, 'specificity': 0.77586234, 'f1': 0.84306335, 'auroc': 0.9649029, 'binary_precision': 0.9888013, 'binary_recall': 0.5523633, 'binary_specificity': 0.99936134, 'binary_f1_score': 0.7087854}
confusion matrix:
       0     1
0  42249    27
1   1932  2384
---- Validation: 
scalar performance:
{'acc': 0.96435434, 'precision': 0.8711109, 'recall': 0.50514525, 'specificity': 0.50514525, 'f1': 0.5011874, 'auroc': 0.57318413, 'binary_precision': 0.7777778, 'binary_recall': 0.010401188, 'binary_specificity': 0.9998893, 'binary_f1_score': 0.020527858}
confusion matrix:
       0  1
0  18065  2
1    666  7
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579439, 'precision': 0.47904915, 'recall': 0.4999159, 'specificity': 0.4999159, 'f1': 0.48926014, 'auroc': 0.5968324, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5945  1
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520749_24.png
better model found
persisted
after epoch: 24,now: 2024-06-21 22:45:44.043185,epoch time: 0:12:31.123633,used: 5:28:53.618974,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_17_16_50_seed_1_21520749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9611736, 'precision': 0.97557545, 'recall': 0.79232705, 'specificity': 0.79232705, 'f1': 0.8575369, 'auroc': 0.9634339, 'binary_precision': 0.991742, 'binary_recall': 0.58515084, 'binary_specificity': 0.9995033, 'binary_f1_score': 0.7360281}
confusion matrix:
       0     1
0  42261    21
1   1788  2522
---- Validation: 
scalar performance:
{'acc': 0.96451443, 'precision': 0.8989659, 'recall': 0.50737405, 'specificity': 0.50737405, 'f1': 0.505562, 'auroc': 0.59039897, 'binary_precision': 0.8333333, 'binary_recall': 0.014858841, 'binary_specificity': 0.9998893, 'binary_f1_score': 0.029197082}
confusion matrix:
       0   1
0  18065   2
1    663  10
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.72920024, 'recall': 0.50367796, 'specificity': 0.50367796, 'f1': 0.49687442, 'auroc': 0.62126577, 'binary_precision': 0.5, 'binary_recall': 0.0076923077, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.015151515}
confusion matrix:
      0  1
0  5944  2
1   258  2
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520749_25.png
better model found
persisted
after epoch: 25,now: 2024-06-21 22:59:39.469310,epoch time: 0:13:55.426125,used: 5:42:49.045099,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_17_16_50_seed_1_21520749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9619677, 'precision': 0.9769403, 'recall': 0.7959566, 'specificity': 0.7959566, 'f1': 0.8608432, 'auroc': 0.9645171, 'binary_precision': 0.993767, 'binary_recall': 0.5922916, 'binary_specificity': 0.9996216, 'binary_f1_score': 0.742217}
confusion matrix:
       0     1
0  42269    16
1   1756  2551
---- Validation: 
scalar performance:
{'acc': 0.96451443, 'precision': 0.8989659, 'recall': 0.50737405, 'specificity': 0.50737405, 'f1': 0.505562, 'auroc': 0.5859418, 'binary_precision': 0.8333333, 'binary_recall': 0.014858841, 'binary_specificity': 0.9998893, 'binary_f1_score': 0.029197082}
confusion matrix:
       0   1
0  18065   2
1    663  10
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579439, 'precision': 0.6791969, 'recall': 0.50359386, 'specificity': 0.50359386, 'f1': 0.49680376, 'auroc': 0.60812306, 'binary_precision': 0.4, 'binary_recall': 0.0076923077, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.01509434}
confusion matrix:
      0  1
0  5943  3
1   258  2
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520749_26.png
early stop counter: 1
val acc:0.964514434337616, best validation acc: 0.964514434337616, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 26,now: 2024-06-21 23:13:18.651784,epoch time: 0:13:39.182474,used: 5:56:28.227573,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_17_16_50_seed_1_21520749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.963234, 'precision': 0.97695744, 'recall': 0.80372363, 'specificity': 0.80372363, 'f1': 0.8670589, 'auroc': 0.9658793, 'binary_precision': 0.99243855, 'binary_recall': 0.60792035, 'binary_specificity': 0.9995269, 'binary_f1_score': 0.7539853}
confusion matrix:
       0     1
0  42254    20
1   1693  2625
---- Validation: 
scalar performance:
{'acc': 0.96451443, 'precision': 0.8751812, 'recall': 0.5080893, 'specificity': 0.5080893, 'f1': 0.5069746, 'auroc': 0.59659314, 'binary_precision': 0.78571427, 'binary_recall': 0.016344724, 'binary_specificity': 0.99983394, 'binary_f1_score': 0.03202329}
confusion matrix:
       0   1
0  18064   3
1    662  11
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579439, 'precision': 0.6791969, 'recall': 0.50359386, 'specificity': 0.50359386, 'f1': 0.49680376, 'auroc': 0.6237029, 'binary_precision': 0.4, 'binary_recall': 0.0076923077, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.01509434}
confusion matrix:
      0  1
0  5943  3
1   258  2
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520749_27.png
early stop counter: 2
val acc:0.964514434337616, best validation acc: 0.964514434337616, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 27,now: 2024-06-21 23:26:52.982292,epoch time: 0:13:34.330508,used: 6:10:02.558081,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_17_16_50_seed_1_21520749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.96535885, 'precision': 0.9769987, 'recall': 0.8157873, 'specificity': 0.8157873, 'f1': 0.8764844, 'auroc': 0.9707873, 'binary_precision': 0.9901996, 'binary_recall': 0.63221323, 'binary_specificity': 0.99936134, 'binary_f1_score': 0.77171147}
confusion matrix:
       0     1
0  42250    27
1   1587  2728
---- Validation: 
scalar performance:
{'acc': 0.9646211, 'precision': 0.8460864, 'recall': 0.511721, 'specificity': 0.511721, 'f1': 0.5140098, 'auroc': 0.62028015, 'binary_precision': 0.72727275, 'binary_recall': 0.023774145, 'binary_specificity': 0.9996679, 'binary_f1_score': 0.046043165}
confusion matrix:
       0   1
0  18061   6
1    657  16
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579439, 'precision': 0.6791969, 'recall': 0.50359386, 'specificity': 0.50359386, 'f1': 0.49680376, 'auroc': 0.6586884, 'binary_precision': 0.4, 'binary_recall': 0.0076923077, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.01509434}
confusion matrix:
      0  1
0  5943  3
1   258  2
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520749_28.png
better model found
persisted
after epoch: 28,now: 2024-06-21 23:40:37.179114,epoch time: 0:13:44.196822,used: 6:23:46.754903,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_17_16_50_seed_1_21520749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9672047, 'precision': 0.97889745, 'recall': 0.82482696, 'specificity': 0.82482696, 'f1': 0.8839092, 'auroc': 0.97232866, 'binary_precision': 0.9922013, 'binary_recall': 0.6501742, 'binary_specificity': 0.9994798, 'binary_f1_score': 0.78557396}
confusion matrix:
       0     1
0  42265    22
1   1506  2799
---- Validation: 
scalar performance:
{'acc': 0.9645678, 'precision': 0.81583214, 'recall': 0.51312387, 'specificity': 0.51312387, 'f1': 0.5166877, 'auroc': 0.6301162, 'binary_precision': 0.6666667, 'binary_recall': 0.026745914, 'binary_specificity': 0.9995019, 'binary_f1_score': 0.05142857}
confusion matrix:
       0   1
0  18058   9
1    655  18
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9577828, 'precision': 0.6458602, 'recall': 0.5035098, 'specificity': 0.5035098, 'f1': 0.49673337, 'auroc': 0.66325784, 'binary_precision': 0.33333334, 'binary_recall': 0.0076923077, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.015037594}
confusion matrix:
      0  1
0  5942  4
1   258  2
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520749_29.png
early stop counter: 1
val acc:0.9645677804946899, best validation acc: 0.9646211266517639, corresponding to test acc:                         0.9579439163208008 / 0.9581050872802734
after epoch: 29,now: 2024-06-21 23:53:40.717456,epoch time: 0:13:03.538342,used: 6:36:50.293245,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_17_16_50_seed_1_21520749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.96737635, 'precision': 0.980646, 'recall': 0.8250783, 'specificity': 0.8250783, 'f1': 0.8846062, 'auroc': 0.9718992, 'binary_precision': 0.99574167, 'binary_recall': 0.65044045, 'binary_specificity': 0.99971616, 'binary_f1_score': 0.78687614}
confusion matrix:
       0     1
0  42266    12
1   1508  2806
---- Validation: 
scalar performance:
{'acc': 0.9646745, 'precision': 0.81593347, 'recall': 0.51604027, 'specificity': 0.51604027, 'f1': 0.52216053, 'auroc': 0.6457908, 'binary_precision': 0.6666667, 'binary_recall': 0.03268945, 'binary_specificity': 0.99939114, 'binary_f1_score': 0.062322944}
confusion matrix:
       0   1
0  18056  11
1    651  22
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579439, 'precision': 0.6791969, 'recall': 0.50359386, 'specificity': 0.50359386, 'f1': 0.49680376, 'auroc': 0.6853496, 'binary_precision': 0.4, 'binary_recall': 0.0076923077, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.01509434}
confusion matrix:
      0  1
0  5943  3
1   258  2
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520749_30.png
better model found
persisted
after epoch: 30,now: 2024-06-22 00:06:20.949668,epoch time: 0:12:40.232212,used: 6:49:30.525457,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_17_16_50_seed_1_21520749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 6:49:30.525457 at 2024-06-22 00:06:20.949668
persisted model performance metric: 

scalar performance:
{'acc': 0.9579439, 'precision': 0.6791969, 'recall': 0.50359386, 'specificity': 0.50359386, 'f1': 0.49680376, 'auroc': 0.6853496, 'binary_precision': 0.4, 'binary_recall': 0.0076923077, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.01509434}
confusion matrix:
      0  1
0  5943  3
1   258  2
oracle model performance metric: 

scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.1866976, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_differentbatchsizes_lre5_classbalancing3/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_resnet_differentbatchsizes_lre5_classbalancing3/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204094 KiB |   3077 MiB | 631039 GiB | 631039 GiB |
|       from large pool | 167936 KiB |   3007 MiB | 630969 GiB | 630969 GiB |
|       from small pool |  36158 KiB |     72 MiB |     69 GiB |     69 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 204094 KiB |   3077 MiB | 631039 GiB | 631039 GiB |
|       from large pool | 167936 KiB |   3007 MiB | 630969 GiB | 630969 GiB |
|       from small pool |  36158 KiB |     72 MiB |     69 GiB |     69 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201086 KiB |   3071 MiB | 631002 GiB | 631002 GiB |
|       from large pool | 165120 KiB |   3001 MiB | 630934 GiB | 630934 GiB |
|       from small pool |  35966 KiB |     71 MiB |     68 GiB |     68 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3368 MiB |   3518 MiB |   5900 MiB |   2532 MiB |
|       from large pool |   3296 MiB |   3444 MiB |   5796 MiB |   2500 MiB |
|       from small pool |     72 MiB |     74 MiB |    104 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    786 MiB |   1614 MiB | 435522 GiB | 435521 GiB |
|       from large pool |    780 MiB |   1612 MiB | 435448 GiB | 435448 GiB |
|       from small pool |      6 MiB |     14 MiB |     73 GiB |     73 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1050    |    1707    |    9884 K  |    9883 K  |
|       from large pool |      36    |      76    |    3166 K  |    3166 K  |
|       from small pool |    1014    |    1636    |    6718 K  |    6717 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1050    |    1707    |    9884 K  |    9883 K  |
|       from large pool |      36    |      76    |    3166 K  |    3166 K  |
|       from small pool |    1014    |    1636    |    6718 K  |    6717 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      48    |      50    |      68    |      20    |
|       from large pool |      12    |      13    |      16    |       4    |
|       from small pool |      36    |      37    |      52    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      34    |     198    |    5247 K  |    5247 K  |
|       from large pool |       5    |      11    |    1123 K  |    1123 K  |
|       from small pool |      29    |     193    |    4124 K  |    4124 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3077 MiB | 631039 GiB | 631039 GiB |
|       from large pool |  16640 KiB |   3007 MiB | 630969 GiB | 630969 GiB |
|       from small pool |      0 KiB |     72 MiB |     69 GiB |     69 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3077 MiB | 631039 GiB | 631039 GiB |
|       from large pool |  16640 KiB |   3007 MiB | 630969 GiB | 630969 GiB |
|       from small pool |      0 KiB |     72 MiB |     69 GiB |     69 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3071 MiB | 631002 GiB | 631002 GiB |
|       from large pool |  16640 KiB |   3001 MiB | 630934 GiB | 630934 GiB |
|       from small pool |      0 KiB |     71 MiB |     68 GiB |     68 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    986 MiB |   3518 MiB |   5900 MiB |   4914 MiB |
|       from large pool |    944 MiB |   3444 MiB |   5796 MiB |   4852 MiB |
|       from small pool |     42 MiB |     74 MiB |    104 MiB |     62 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 786176 KiB |   1614 MiB | 435522 GiB | 435521 GiB |
|       from large pool | 786176 KiB |   1612 MiB | 435449 GiB | 435448 GiB |
|       from small pool |      0 KiB |     14 MiB |     73 GiB |     73 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1707    |    9884 K  |    9884 K  |
|       from large pool |       2    |      76    |    3166 K  |    3166 K  |
|       from small pool |       0    |    1636    |    6718 K  |    6718 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1707    |    9884 K  |    9884 K  |
|       from large pool |       2    |      76    |    3166 K  |    3166 K  |
|       from small pool |       0    |    1636    |    6718 K  |    6718 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      30    |      50    |      68    |      38    |
|       from large pool |       9    |      13    |      16    |       7    |
|       from small pool |      21    |      37    |      52    |      31    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     198    |    5248 K  |    5248 K  |
|       from large pool |       1    |      11    |    1123 K  |    1123 K  |
|       from small pool |       0    |     193    |    4125 K  |    4125 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3077 MiB | 631039 GiB | 631039 GiB |
|       from large pool |  16640 KiB |   3007 MiB | 630969 GiB | 630969 GiB |
|       from small pool |      0 KiB |     72 MiB |     69 GiB |     69 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3077 MiB | 631039 GiB | 631039 GiB |
|       from large pool |  16640 KiB |   3007 MiB | 630969 GiB | 630969 GiB |
|       from small pool |      0 KiB |     72 MiB |     69 GiB |     69 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3071 MiB | 631002 GiB | 631002 GiB |
|       from large pool |  16640 KiB |   3001 MiB | 630934 GiB | 630934 GiB |
|       from small pool |      0 KiB |     71 MiB |     68 GiB |     68 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    986 MiB |   3518 MiB |   5900 MiB |   4914 MiB |
|       from large pool |    944 MiB |   3444 MiB |   5796 MiB |   4852 MiB |
|       from small pool |     42 MiB |     74 MiB |    104 MiB |     62 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 786176 KiB |   1614 MiB | 435522 GiB | 435521 GiB |
|       from large pool | 786176 KiB |   1612 MiB | 435449 GiB | 435448 GiB |
|       from small pool |      0 KiB |     14 MiB |     73 GiB |     73 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1707    |    9884 K  |    9884 K  |
|       from large pool |       2    |      76    |    3166 K  |    3166 K  |
|       from small pool |       0    |    1636    |    6718 K  |    6718 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1707    |    9884 K  |    9884 K  |
|       from large pool |       2    |      76    |    3166 K  |    3166 K  |
|       from small pool |       0    |    1636    |    6718 K  |    6718 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      30    |      50    |      68    |      38    |
|       from large pool |       9    |      13    |      16    |       7    |
|       from small pool |      21    |      37    |      52    |      31    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     198    |    5248 K  |    5248 K  |
|       from large pool |       1    |      11    |    1123 K  |    1123 K  |
|       from small pool |       0    |     193    |    4125 K  |    4125 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0




!!!: not committed yet



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_00_12_04_seed_2_21520749

 Experiment start at: 2024-06-22 00:12:04.744705
before training, model accuracy: 0.0544959120452404
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9023224, 'precision': 0.46434692, 'recall': 0.49966106, 'specificity': 0.49966106, 'f1': 0.47454458, 'auroc': 0.41442293, 'binary_precision': 0.025641026, 'binary_recall': 0.00022031284, 'binary_specificity': 0.9991018, 'binary_f1_score': 0.00043687195}
confusion matrix:
       0   1
0  42271  38
1   4538   1
---- Validation: 
scalar performance:
{'acc': 0.96638787, 'precision': 0.5268736, 'recall': 0.5016112, 'specificity': 0.5016112, 'f1': 0.49616152, 'auroc': 0.32585165, 'binary_precision': 0.08571429, 'binary_recall': 0.004983389, 'binary_specificity': 0.998239, 'binary_f1_score': 0.0094191525}
confusion matrix:
       0   1
0  18139  32
1    599   3
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9596089, 'precision': 0.48057473, 'recall': 0.49916625, 'specificity': 0.49916625, 'f1': 0.4896941, 'auroc': 0.26715976, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5987  10
1   242   0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520749_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-22 00:25:55.679181,epoch time: 0:13:50.934476,used: 0:13:50.934476,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_00_12_04_seed_2_21520749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9031122, 'precision': 0.4515561, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4745449, 'auroc': 0.47792667, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42309  0
1   4539  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.31298715, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.23931113, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520749_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-22 00:39:25.477909,epoch time: 0:13:29.798728,used: 0:27:20.733204,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_00_12_04_seed_2_21520749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9031122, 'precision': 0.4515561, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4745449, 'auroc': 0.56306267, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42309  0
1   4539  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.32455367, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.2468383, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520749_3.png
early stop counter: 1
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 3,now: 2024-06-22 00:52:45.508486,epoch time: 0:13:20.030577,used: 0:40:40.763781,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_00_12_04_seed_2_21520749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9031335, 'precision': 0.45156676, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.47455078, 'auroc': 0.63611954, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42310  0
1   4538  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.34640723, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.2762879, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520749_4.png
early stop counter: 2
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 4,now: 2024-06-22 01:06:22.180221,epoch time: 0:13:36.671735,used: 0:54:17.435516,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_00_12_04_seed_2_21520749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9031335, 'precision': 0.45156676, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.47455078, 'auroc': 0.7165776, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42310  0
1   4538  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.36424717, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.28751838, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520749_5.png
early stop counter: 3
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 5,now: 2024-06-22 01:20:03.963834,epoch time: 0:13:41.783613,used: 1:07:59.219129,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_00_12_04_seed_2_21520749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9031122, 'precision': 0.4515561, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4745449, 'auroc': 0.7605033, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42309  0
1   4539  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.37626827, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.3074898, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520749_6.png
early stop counter: 4
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 6,now: 2024-06-22 01:33:39.467334,epoch time: 0:13:35.503500,used: 1:21:34.722629,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_00_12_04_seed_2_21520749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9031122, 'precision': 0.4515561, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4745449, 'auroc': 0.813748, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42309  0
1   4539  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.38672578, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.33026016, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520749_7.png
early stop counter: 5
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 7,now: 2024-06-22 01:47:10.495821,epoch time: 0:13:31.028487,used: 1:35:05.751116,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_00_12_04_seed_2_21520749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.90328294, 'precision': 0.9516343, 'recall': 0.5007713, 'specificity': 0.5007713, 'f1': 0.4761282, 'auroc': 0.851336, 'binary_precision': 1.0, 'binary_recall': 0.0015425298, 'binary_specificity': 1.0, 'binary_f1_score': 0.003080308}
confusion matrix:
       0  1
0  42310  0
1   4531  7
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.40733284, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.365215, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520749_8.png
early stop counter: 6
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 8,now: 2024-06-22 02:00:40.799626,epoch time: 0:13:30.303805,used: 1:48:36.054921,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_00_12_04_seed_2_21520749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.90546024, 'precision': 0.95261884, 'recall': 0.5121172, 'specificity': 0.5121172, 'f1': 0.4987921, 'auroc': 0.87865466, 'binary_precision': 1.0, 'binary_recall': 0.024234412, 'binary_specificity': 1.0, 'binary_f1_score': 0.047322005}
confusion matrix:
       0    1
0  42309    0
1   4429  110
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.4325375, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.41051775, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520749_9.png
early stop counter: 7
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 9,now: 2024-06-22 02:13:47.120672,epoch time: 0:13:06.321046,used: 2:01:42.375967,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_00_12_04_seed_2_21520749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.908534, 'precision': 0.9540177, 'recall': 0.52797973, 'specificity': 0.52797973, 'f1': 0.52889466, 'auroc': 0.8856764, 'binary_precision': 1.0, 'binary_recall': 0.055959463, 'binary_specificity': 1.0, 'binary_f1_score': 0.1059879}
confusion matrix:
       0    1
0  42309    0
1   4285  254
---- Validation: 
scalar performance:
{'acc': 0.9678261, 'precision': 0.48396462, 'recall': 0.49994496, 'specificity': 0.49994496, 'f1': 0.49182498, 'auroc': 0.4306867, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998899, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18169  2
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.4124562, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520749_10.png
early stop counter: 8
val acc:0.9678261280059814, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 10,now: 2024-06-22 02:27:15.135815,epoch time: 0:13:28.015143,used: 2:15:10.391110,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_00_12_04_seed_2_21520749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9144254, 'precision': 0.9548683, 'recall': 0.55857956, 'specificity': 0.55857956, 'f1': 0.58225065, 'auroc': 0.90730643, 'binary_precision': 0.9962547, 'binary_recall': 0.11720643, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.20973782}
confusion matrix:
       0    1
0  42307    2
1   4007  532
---- Validation: 
scalar performance:
{'acc': 0.96777284, 'precision': 0.48396376, 'recall': 0.49991745, 'specificity': 0.49991745, 'f1': 0.49181125, 'auroc': 0.4519967, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998349, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18168  3
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96105146, 'precision': 0.48060277, 'recall': 0.4999166, 'specificity': 0.4999166, 'f1': 0.49006948, 'auroc': 0.44092017, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5996  1
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520749_11.png
early stop counter: 9
val acc:0.9677728414535522, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 11,now: 2024-06-22 02:40:52.202014,epoch time: 0:13:37.066199,used: 2:28:47.457309,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_00_12_04_seed_2_21520749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.92082906, 'precision': 0.9567673, 'recall': 0.5918316, 'specificity': 0.5918316, 'f1': 0.6341073, 'auroc': 0.9142202, 'binary_precision': 0.99404055, 'binary_recall': 0.1837814, 'binary_specificity': 0.9998818, 'binary_f1_score': 0.31021014}
confusion matrix:
       0    1
0  42305    5
1   3704  834
---- Validation: 
scalar performance:
{'acc': 0.9675065, 'precision': 0.4839595, 'recall': 0.49977988, 'specificity': 0.49977988, 'f1': 0.4917425, 'auroc': 0.48464248, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99955976, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18163  8
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96105146, 'precision': 0.48060277, 'recall': 0.4999166, 'specificity': 0.4999166, 'f1': 0.49006948, 'auroc': 0.49198014, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5996  1
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520749_12.png
early stop counter: 10
val acc:0.9675065279006958, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 12,now: 2024-06-22 02:54:15.412604,epoch time: 0:13:23.210590,used: 2:42:10.667899,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_00_12_04_seed_2_21520749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9272754, 'precision': 0.95890546, 'recall': 0.6254996, 'specificity': 0.6254996, 'f1': 0.6811012, 'auroc': 0.9251622, 'binary_precision': 0.9921671, 'binary_recall': 0.251212, 'binary_specificity': 0.9997873, 'binary_f1_score': 0.4009144}
confusion matrix:
       0     1
0  42301     9
1   3398  1140
---- Validation: 
scalar performance:
{'acc': 0.96745324, 'precision': 0.48395863, 'recall': 0.49975234, 'specificity': 0.49975234, 'f1': 0.4917287, 'auroc': 0.489372, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9995047, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18162  9
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96105146, 'precision': 0.48060277, 'recall': 0.4999166, 'specificity': 0.4999166, 'f1': 0.49006948, 'auroc': 0.5068669, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5996  1
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520749_13.png
early stop counter: 11
val acc:0.9674532413482666, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 13,now: 2024-06-22 03:07:35.287571,epoch time: 0:13:19.874967,used: 2:55:30.542866,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_00_12_04_seed_2_21520749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9322276, 'precision': 0.961925, 'recall': 0.65106153, 'specificity': 0.65106153, 'f1': 0.7137103, 'auroc': 0.9299456, 'binary_precision': 0.993483, 'binary_recall': 0.30233583, 'binary_specificity': 0.9997873, 'binary_f1_score': 0.46359184}
confusion matrix:
       0     1
0  42301     9
1   3166  1372
---- Validation: 
scalar performance:
{'acc': 0.96729344, 'precision': 0.48395607, 'recall': 0.4996698, 'specificity': 0.4996698, 'f1': 0.49168742, 'auroc': 0.50246894, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9993396, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18159  12
1    602   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96105146, 'precision': 0.48060277, 'recall': 0.4999166, 'specificity': 0.4999166, 'f1': 0.49006948, 'auroc': 0.5321719, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5996  1
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520749_14.png
early stop counter: 12
val acc:0.9672934412956238, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 14,now: 2024-06-22 03:20:52.628203,epoch time: 0:13:17.340632,used: 3:08:47.883498,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_00_12_04_seed_2_21520749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9360485, 'precision': 0.9641386, 'recall': 0.6708564, 'specificity': 0.6708564, 'f1': 0.73732495, 'auroc': 0.9344971, 'binary_precision': 0.99423444, 'binary_recall': 0.34192553, 'binary_specificity': 0.9997873, 'binary_f1_score': 0.5088525}
confusion matrix:
       0     1
0  42300     9
1   2987  1552
---- Validation: 
scalar performance:
{'acc': 0.9674, 'precision': 0.4839578, 'recall': 0.49972484, 'specificity': 0.49972484, 'f1': 0.49171495, 'auroc': 0.53008324, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9994497, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18161  10
1    602   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96105146, 'precision': 0.48060277, 'recall': 0.4999166, 'specificity': 0.4999166, 'f1': 0.49006948, 'auroc': 0.5646907, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5996  1
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520749_15.png
early stop counter: 13
val acc:0.9674000144004822, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 15,now: 2024-06-22 03:34:09.787595,epoch time: 0:13:17.159392,used: 3:22:05.042890,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_00_12_04_seed_2_21520749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9406378, 'precision': 0.96432006, 'recall': 0.6954251, 'specificity': 0.6954251, 'f1': 0.76451945, 'auroc': 0.94260055, 'binary_precision': 0.9899666, 'binary_recall': 0.3912756, 'binary_specificity': 0.99957454, 'binary_f1_score': 0.56087166}
confusion matrix:
       0     1
0  42291    18
1   2763  1776
---- Validation: 
scalar performance:
{'acc': 0.96729344, 'precision': 0.48395607, 'recall': 0.4996698, 'specificity': 0.4996698, 'f1': 0.49168742, 'auroc': 0.5201448, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9993396, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18159  12
1    602   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96105146, 'precision': 0.48060277, 'recall': 0.4999166, 'specificity': 0.4999166, 'f1': 0.49006948, 'auroc': 0.5376547, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5996  1
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520749_16.png
early stop counter: 14
val acc:0.9672934412956238, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 16,now: 2024-06-22 03:47:39.363012,epoch time: 0:13:29.575417,used: 3:35:34.618307,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_00_12_04_seed_2_21520749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9452698, 'precision': 0.9659674, 'recall': 0.71982074, 'specificity': 0.71982074, 'f1': 0.7898605, 'auroc': 0.9450135, 'binary_precision': 0.9886195, 'binary_recall': 0.44018507, 'binary_specificity': 0.9994564, 'binary_f1_score': 0.6091463}
confusion matrix:
       0     1
0  42286    23
1   2541  1998
---- Validation: 
scalar performance:
{'acc': 0.9671869, 'precision': 0.51522934, 'recall': 0.5004178, 'specificity': 0.5004178, 'f1': 0.49327758, 'auroc': 0.5590297, 'binary_precision': 0.0625, 'binary_recall': 0.0016611295, 'binary_specificity': 0.99917454, 'binary_f1_score': 0.0032362458}
confusion matrix:
       0   1
0  18156  15
1    601   1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96105146, 'precision': 0.48060277, 'recall': 0.4999166, 'specificity': 0.4999166, 'f1': 0.49006948, 'auroc': 0.5922045, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5996  1
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520749_17.png
early stop counter: 15
val acc:0.9671869277954102, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 17,now: 2024-06-22 04:00:21.881279,epoch time: 0:12:42.518267,used: 3:48:17.136574,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_00_12_04_seed_2_21520749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.94616634, 'precision': 0.9685878, 'recall': 0.72356224, 'specificity': 0.72356224, 'f1': 0.79399943, 'auroc': 0.94847906, 'binary_precision': 0.99315405, 'binary_recall': 0.44745538, 'binary_specificity': 0.9996691, 'binary_f1_score': 0.61695015}
confusion matrix:
       0     1
0  42295    14
1   2508  2031
---- Validation: 
scalar performance:
{'acc': 0.9673467, 'precision': 0.48395693, 'recall': 0.49969733, 'specificity': 0.49969733, 'f1': 0.4917012, 'auroc': 0.54026055, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99939466, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18160  11
1    602   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608912, 'precision': 0.48059964, 'recall': 0.49983326, 'specificity': 0.49983326, 'f1': 0.49002782, 'auroc': 0.5670459, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5995  2
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520749_18.png
early stop counter: 16
val acc:0.967346727848053, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 18,now: 2024-06-22 04:13:35.817360,epoch time: 0:13:13.936081,used: 4:01:31.072655,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_00_12_04_seed_2_21520749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9491334, 'precision': 0.9698435, 'recall': 0.73907065, 'specificity': 0.73907065, 'f1': 0.80917764, 'auroc': 0.95357037, 'binary_precision': 0.9926874, 'binary_recall': 0.4785195, 'binary_specificity': 0.9996218, 'binary_f1_score': 0.64575595}
confusion matrix:
       0     1
0  42293    16
1   2367  2172
---- Validation: 
scalar performance:
{'acc': 0.9674, 'precision': 0.5256494, 'recall': 0.5005279, 'specificity': 0.5005279, 'f1': 0.49334317, 'auroc': 0.5538255, 'binary_precision': 0.083333336, 'binary_recall': 0.0016611295, 'binary_specificity': 0.99939466, 'binary_f1_score': 0.0032573289}
confusion matrix:
       0   1
0  18160  11
1    601   1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608912, 'precision': 0.48059964, 'recall': 0.49983326, 'specificity': 0.49983326, 'f1': 0.49002782, 'auroc': 0.58389866, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5995  2
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520749_19.png
early stop counter: 17
val acc:0.9674000144004822, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 19,now: 2024-06-22 04:27:16.711484,epoch time: 0:13:40.894124,used: 4:15:11.966779,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_00_12_04_seed_2_21520749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9518016, 'precision': 0.9701582, 'recall': 0.75343025, 'specificity': 0.75343025, 'f1': 0.8225165, 'auroc': 0.9524424, 'binary_precision': 0.99053764, 'binary_recall': 0.5073805, 'binary_specificity': 0.99948, 'binary_f1_score': 0.67103726}
confusion matrix:
       0     1
0  42287    22
1   2236  2303
---- Validation: 
scalar performance:
{'acc': 0.9675065, 'precision': 0.5339844, 'recall': 0.50058293, 'specificity': 0.50058293, 'f1': 0.49337602, 'auroc': 0.5708768, 'binary_precision': 0.1, 'binary_recall': 0.0016611295, 'binary_specificity': 0.9995047, 'binary_f1_score': 0.0032679737}
confusion matrix:
       0  1
0  18162  9
1    601  1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608912, 'precision': 0.48059964, 'recall': 0.49983326, 'specificity': 0.49983326, 'f1': 0.49002782, 'auroc': 0.60824144, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5995  2
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520749_20.png
early stop counter: 18
val acc:0.9675065279006958, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 20,now: 2024-06-22 04:41:05.837389,epoch time: 0:13:49.125905,used: 4:29:01.092684,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_00_12_04_seed_2_21520749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9542136, 'precision': 0.9719689, 'recall': 0.76568127, 'specificity': 0.76568127, 'f1': 0.83382547, 'auroc': 0.95753086, 'binary_precision': 0.9917831, 'binary_recall': 0.5318352, 'binary_specificity': 0.9995273, 'binary_f1_score': 0.69238496}
confusion matrix:
       0     1
0  42289    20
1   2125  2414
---- Validation: 
scalar performance:
{'acc': 0.9674, 'precision': 0.5256494, 'recall': 0.5005279, 'specificity': 0.5005279, 'f1': 0.49334317, 'auroc': 0.5729041, 'binary_precision': 0.083333336, 'binary_recall': 0.0016611295, 'binary_specificity': 0.99939466, 'binary_f1_score': 0.0032573289}
confusion matrix:
       0   1
0  18160  11
1    601   1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608912, 'precision': 0.48059964, 'recall': 0.49983326, 'specificity': 0.49983326, 'f1': 0.49002782, 'auroc': 0.60940665, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5995  2
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520749_21.png
early stop counter: 19
val acc:0.9674000144004822, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 21,now: 2024-06-22 04:54:59.872125,epoch time: 0:13:54.034736,used: 4:42:55.127420,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_00_12_04_seed_2_21520749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.95760757, 'precision': 0.9746519, 'recall': 0.78280276, 'specificity': 0.78280276, 'f1': 0.8491418, 'auroc': 0.9613101, 'binary_precision': 0.9938104, 'binary_recall': 0.5659837, 'binary_specificity': 0.9996218, 'binary_f1_score': 0.721224}
confusion matrix:
       0     1
0  42293    16
1   1970  2569
---- Validation: 
scalar performance:
{'acc': 0.9675065, 'precision': 0.59117717, 'recall': 0.50218904, 'specificity': 0.50218904, 'f1': 0.49661127, 'auroc': 0.5909015, 'binary_precision': 0.21428572, 'binary_recall': 0.004983389, 'binary_specificity': 0.99939466, 'binary_f1_score': 0.0097402595}
confusion matrix:
       0   1
0  18160  11
1    599   3
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9607309, 'precision': 0.48059654, 'recall': 0.49974987, 'specificity': 0.49974987, 'f1': 0.4899861, 'auroc': 0.62450504, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5994  3
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520749_22.png
early stop counter: 20
val acc:0.9675065279006958, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 22,now: 2024-06-22 05:08:37.066363,epoch time: 0:13:37.194238,used: 4:56:32.321658,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_00_12_04_seed_2_21520749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 22 with time: 4:56:32.321658 at 2024-06-22 05:08:37.066363
persisted model performance metric: 

scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.23931113, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
oracle model performance metric: 

scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.23931113, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_differentbatchsizes_lre5_classbalancing3/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_resnet_differentbatchsizes_lre5_classbalancing3/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204097 KiB |   3077 MiB |    878 TiB |    878 TiB |
|       from large pool | 167936 KiB |   3007 MiB |    878 TiB |    878 TiB |
|       from small pool |  36161 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 204097 KiB |   3077 MiB |    878 TiB |    878 TiB |
|       from large pool | 167936 KiB |   3007 MiB |    878 TiB |    878 TiB |
|       from small pool |  36161 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201087 KiB |   3071 MiB |    878 TiB |    878 TiB |
|       from large pool | 165120 KiB |   3001 MiB |    878 TiB |    878 TiB |
|       from small pool |  35967 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3368 MiB |   3518 MiB |   8282 MiB |   4914 MiB |
|       from large pool |   3296 MiB |   3444 MiB |   8148 MiB |   4852 MiB |
|       from small pool |     72 MiB |     74 MiB |    134 MiB |     62 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    786 MiB |   1614 MiB | 621655 GiB | 621654 GiB |
|       from large pool |    780 MiB |   1612 MiB | 621551 GiB | 621550 GiB |
|       from small pool |      6 MiB |     14 MiB |    104 GiB |    104 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1050    |    1707    |   14086 K  |   14085 K  |
|       from large pool |      36    |      76    |    4513 K  |    4513 K  |
|       from small pool |    1014    |    1636    |    9573 K  |    9572 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1050    |    1707    |   14086 K  |   14085 K  |
|       from large pool |      36    |      76    |    4513 K  |    4513 K  |
|       from small pool |    1014    |    1636    |    9573 K  |    9572 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      48    |      50    |      86    |      38    |
|       from large pool |      12    |      13    |      19    |       7    |
|       from small pool |      36    |      37    |      67    |      31    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      33    |     199    |    7574 K  |    7574 K  |
|       from large pool |       5    |      11    |    1600 K  |    1600 K  |
|       from small pool |      28    |     194    |    5973 K  |    5973 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3077 MiB |    878 TiB |    878 TiB |
|       from large pool |  16640 KiB |   3007 MiB |    878 TiB |    878 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3077 MiB |    878 TiB |    878 TiB |
|       from large pool |  16640 KiB |   3007 MiB |    878 TiB |    878 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3071 MiB |    878 TiB |    878 TiB |
|       from large pool |  16640 KiB |   3001 MiB |    878 TiB |    878 TiB |
|       from small pool |      0 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    986 MiB |   3518 MiB |   8282 MiB |   7296 MiB |
|       from large pool |    944 MiB |   3444 MiB |   8148 MiB |   7204 MiB |
|       from small pool |     42 MiB |     74 MiB |    134 MiB |     92 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 786176 KiB |   1614 MiB | 621655 GiB | 621655 GiB |
|       from large pool | 786176 KiB |   1612 MiB | 621551 GiB | 621550 GiB |
|       from small pool |      0 KiB |     14 MiB |    104 GiB |    104 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1707    |   14086 K  |   14086 K  |
|       from large pool |       2    |      76    |    4513 K  |    4513 K  |
|       from small pool |       0    |    1636    |    9573 K  |    9573 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1707    |   14086 K  |   14086 K  |
|       from large pool |       2    |      76    |    4513 K  |    4513 K  |
|       from small pool |       0    |    1636    |    9573 K  |    9573 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      30    |      50    |      86    |      56    |
|       from large pool |       9    |      13    |      19    |      10    |
|       from small pool |      21    |      37    |      67    |      46    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     199    |    7574 K  |    7574 K  |
|       from large pool |       1    |      11    |    1601 K  |    1601 K  |
|       from small pool |       0    |     194    |    5973 K  |    5973 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

