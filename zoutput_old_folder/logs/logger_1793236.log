Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0




!!!: not committed yet



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_34_seed_0_21329044

 Experiment start at: 2024-06-17 02:20:34.621426
before training, model accuracy: 0.3103227913379669
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96659815, 'precision': 0.7400612, 'recall': 0.57752436, 'specificity': 0.57752436, 'f1': 0.6134247, 'auroc': 0.9172606, 'binary_precision': 0.5086207, 'binary_recall': 0.16043508, 'binary_specificity': 0.99461365, 'binary_f1_score': 0.24392764}
confusion matrix:
       0    1
0  42101  228
1   1235  236
---- Validation: 
scalar performance:
{'acc': 0.9663687, 'precision': 0.7643918, 'recall': 0.53855586, 'specificity': 0.53855586, 'f1': 0.560907, 'auroc': 0.91302764, 'binary_precision': 0.5604396, 'binary_recall': 0.07931571, 'binary_specificity': 0.997796, 'binary_f1_score': 0.13896458}
confusion matrix:
       0   1
0  18109  40
1    592  51
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9638862, 'precision': 0.98184156, 'recall': 0.5670498, 'specificity': 0.5670498, 'f1': 0.60899615, 'auroc': 0.8922074, 'binary_precision': 1.0, 'binary_recall': 0.13409962, 'binary_specificity': 1.0, 'binary_f1_score': 0.2364865}
confusion matrix:
      0   1
0  5997   0
1   226  35
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329044_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-17 02:35:50.846471,epoch time: 0:15:16.225045,used: 0:15:16.225045,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_34_seed_0_21329044
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9695434, 'precision': 0.7773638, 'recall': 0.66992974, 'specificity': 0.66992974, 'f1': 0.7095479, 'auroc': 0.9299897, 'binary_precision': 0.5770529, 'binary_recall': 0.34874237, 'binary_specificity': 0.9911172, 'binary_f1_score': 0.4347458}
confusion matrix:
       0    1
0  41953  376
1    958  513
---- Validation: 
scalar performance:
{'acc': 0.9683376, 'precision': 0.7788316, 'recall': 0.6273317, 'specificity': 0.6273317, 'f1': 0.6723345, 'auroc': 0.93599117, 'binary_precision': 0.5833333, 'binary_recall': 0.26127526, 'binary_specificity': 0.99338806, 'binary_f1_score': 0.36090225}
confusion matrix:
       0    1
0  18029  120
1    475  168
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9694791, 'precision': 0.9712051, 'recall': 0.6377643, 'specificity': 0.6377643, 'f1': 0.70708525, 'auroc': 0.90424764, 'binary_precision': 0.972973, 'binary_recall': 0.27586207, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.42985073}
confusion matrix:
      0   1
0  5995   2
1   189  72
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329044_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-17 02:50:43.787313,epoch time: 0:14:52.940842,used: 0:30:09.165887,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_34_seed_0_21329044
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9706621, 'precision': 0.78323376, 'recall': 0.71105665, 'specificity': 0.71105665, 'f1': 0.74137014, 'auroc': 0.93836355, 'binary_precision': 0.58601654, 'binary_recall': 0.43274456, 'binary_specificity': 0.98936874, 'binary_f1_score': 0.4978507}
confusion matrix:
       0    1
0  41878  450
1    835  637
---- Validation: 
scalar performance:
{'acc': 0.9695083, 'precision': 0.797063, 'recall': 0.6384385, 'specificity': 0.6384385, 'f1': 0.68641907, 'auroc': 0.94285274, 'binary_precision': 0.61904764, 'binary_recall': 0.2830482, 'binary_specificity': 0.99382883, 'binary_f1_score': 0.38847384}
confusion matrix:
       0    1
0  18037  112
1    461  182
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9680409, 'precision': 0.96170175, 'recall': 0.6223552, 'specificity': 0.6223552, 'f1': 0.6869172, 'auroc': 0.90271014, 'binary_precision': 0.95522386, 'binary_recall': 0.24521072, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.3902439}
confusion matrix:
      0   1
0  5994   3
1   197  64
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329044_3.png
better model found
persisted
after epoch: 3,now: 2024-06-17 03:05:21.654526,epoch time: 0:14:37.867213,used: 0:44:47.033100,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_34_seed_0_21329044
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9717352, 'precision': 0.7966809, 'recall': 0.7109561, 'specificity': 0.7109561, 'f1': 0.7459153, 'auroc': 0.94262207, 'binary_precision': 0.61293435, 'binary_recall': 0.43138587, 'binary_specificity': 0.9905264, 'binary_f1_score': 0.50637954}
confusion matrix:
       0    1
0  41927  401
1    837  635
---- Validation: 
scalar performance:
{'acc': 0.9702533, 'precision': 0.8082496, 'recall': 0.64557475, 'specificity': 0.64557475, 'f1': 0.6953479, 'auroc': 0.9444221, 'binary_precision': 0.6409396, 'binary_recall': 0.2970451, 'binary_specificity': 0.9941044, 'binary_f1_score': 0.40595114}
confusion matrix:
       0    1
0  18042  107
1    452  191
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964845, 'precision': 0.9602339, 'recall': 0.58220875, 'specificity': 0.58220875, 'f1': 0.63151383, 'auroc': 0.89644325, 'binary_precision': 0.95555556, 'binary_recall': 0.16475096, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.28104576}
confusion matrix:
      0   1
0  5995   2
1   218  43
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329044_4.png
better model found
persisted
after epoch: 4,now: 2024-06-17 03:20:03.560380,epoch time: 0:14:41.905854,used: 0:59:28.938954,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_34_seed_0_21329044
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9711644, 'precision': 0.78162557, 'recall': 0.75065994, 'specificity': 0.75065994, 'f1': 0.76515144, 'auroc': 0.94490653, 'binary_precision': 0.58007663, 'binary_recall': 0.5142663, 'binary_specificity': 0.9870535, 'binary_f1_score': 0.54519266}
confusion matrix:
       0    1
0  41780  548
1    715  757
---- Validation: 
scalar performance:
{'acc': 0.97078544, 'precision': 0.79252493, 'recall': 0.7051046, 'specificity': 0.7051046, 'f1': 0.74041235, 'auroc': 0.95046365, 'binary_precision': 0.6053812, 'binary_recall': 0.41990668, 'binary_specificity': 0.9903025, 'binary_f1_score': 0.4958678}
confusion matrix:
       0    1
0  17973  176
1    373  270
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9688399, 'precision': 0.9636477, 'recall': 0.6319338, 'specificity': 0.6319338, 'f1': 0.69920427, 'auroc': 0.90055484, 'binary_precision': 0.9583333, 'binary_recall': 0.26436782, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.41441444}
confusion matrix:
      0   1
0  5994   3
1   192  69
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329044_5.png
better model found
persisted
after epoch: 5,now: 2024-06-17 03:34:39.286523,epoch time: 0:14:35.726143,used: 1:14:04.665097,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_34_seed_0_21329044
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97150683, 'precision': 0.8141801, 'recall': 0.6606752, 'specificity': 0.6606752, 'f1': 0.71059453, 'auroc': 0.9429402, 'binary_precision': 0.65135133, 'binary_recall': 0.32744566, 'binary_specificity': 0.99390477, 'binary_f1_score': 0.43580472}
confusion matrix:
       0    1
0  42070  258
1    990  482
---- Validation: 
scalar performance:
{'acc': 0.97035974, 'precision': 0.84511375, 'recall': 0.6088771, 'specificity': 0.6088771, 'f1': 0.661267, 'auroc': 0.94559664, 'binary_precision': 0.7171717, 'binary_recall': 0.22083981, 'binary_specificity': 0.99691445, 'binary_f1_score': 0.33769324}
confusion matrix:
       0    1
0  18093   56
1    501  142
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96276766, 'precision': 0.96470773, 'recall': 0.5554722, 'specificity': 0.5554722, 'f1': 0.5901267, 'auroc': 0.88234127, 'binary_precision': 0.96666664, 'binary_recall': 0.11111111, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.19931272}
confusion matrix:
      0   1
0  5996   1
1   232  29
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329044_6.png
early stop counter: 1
val acc:0.970359742641449, best validation acc: 0.9707854390144348, corresponding to test acc:                         0.9688398838043213 / 0.9694790840148926
after epoch: 6,now: 2024-06-17 03:49:14.126719,epoch time: 0:14:34.840196,used: 1:28:39.505293,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_34_seed_0_21329044
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97164387, 'precision': 0.79909855, 'recall': 0.6994337, 'specificity': 0.6994337, 'f1': 0.73840797, 'auroc': 0.9471734, 'binary_precision': 0.6185567, 'binary_recall': 0.4076087, 'binary_specificity': 0.99125874, 'binary_f1_score': 0.49140048}
confusion matrix:
       0    1
0  41958  370
1    872  600
---- Validation: 
scalar performance:
{'acc': 0.9713176, 'precision': 0.8390733, 'recall': 0.6378751, 'specificity': 0.6378751, 'f1': 0.69287616, 'auroc': 0.94660866, 'binary_precision': 0.703125, 'binary_recall': 0.2799378, 'binary_specificity': 0.9958124, 'binary_f1_score': 0.40044495}
confusion matrix:
       0    1
0  18073   76
1    463  180
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.96590406, 'recall': 0.5593036, 'specificity': 0.5593036, 'f1': 0.59635264, 'auroc': 0.89619297, 'binary_precision': 0.96875, 'binary_recall': 0.118773945, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.21160409}
confusion matrix:
      0   1
0  5996   1
1   230  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329044_7.png
better model found
persisted
after epoch: 7,now: 2024-06-17 04:03:51.512707,epoch time: 0:14:37.385988,used: 1:43:16.891281,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_34_seed_0_21329044
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9723288, 'precision': 0.80422974, 'recall': 0.71224684, 'specificity': 0.71224684, 'f1': 0.74931085, 'auroc': 0.94411737, 'binary_precision': 0.62795275, 'binary_recall': 0.4334239, 'binary_specificity': 0.99106973, 'binary_f1_score': 0.5128617}
confusion matrix:
       0    1
0  41950  378
1    834  638
---- Validation: 
scalar performance:
{'acc': 0.97153044, 'precision': 0.8269973, 'recall': 0.65748674, 'specificity': 0.65748674, 'f1': 0.71022767, 'auroc': 0.9469119, 'binary_precision': 0.67763156, 'binary_recall': 0.32037324, 'binary_specificity': 0.99460024, 'binary_f1_score': 0.43505806}
confusion matrix:
       0    1
0  18051   98
1    437  206
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.92983353, 'recall': 0.517158, 'specificity': 0.517158, 'f1': 0.5228796, 'auroc': 0.8770971, 'binary_precision': 0.9, 'binary_recall': 0.03448276, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.06642067}
confusion matrix:
      0  1
0  5996  1
1   252  9
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329044_8.png
better model found
persisted
after epoch: 8,now: 2024-06-17 04:18:34.269329,epoch time: 0:14:42.756622,used: 1:57:59.647903,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_34_seed_0_21329044
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9727397, 'precision': 0.8028985, 'recall': 0.73278683, 'specificity': 0.73278683, 'f1': 0.7628305, 'auroc': 0.9474951, 'binary_precision': 0.6238859, 'binary_recall': 0.47554347, 'binary_specificity': 0.9900302, 'binary_f1_score': 0.53970706}
confusion matrix:
       0    1
0  41906  422
1    772  700
---- Validation: 
scalar performance:
{'acc': 0.9713708, 'precision': 0.81645995, 'recall': 0.6686549, 'specificity': 0.6686549, 'f1': 0.7181613, 'auroc': 0.9480289, 'binary_precision': 0.65578634, 'binary_recall': 0.3437014, 'binary_specificity': 0.9936085, 'binary_f1_score': 0.4510204}
confusion matrix:
       0    1
0  18033  116
1    422  221
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96292746, 'precision': 0.9512231, 'recall': 0.55922025, 'specificity': 0.55922025, 'f1': 0.5959511, 'auroc': 0.8869888, 'binary_precision': 0.93939394, 'binary_recall': 0.118773945, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.21088433}
confusion matrix:
      0   1
0  5995   2
1   230  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329044_9.png
early stop counter: 1
val acc:0.9713708162307739, best validation acc: 0.9715304374694824, corresponding to test acc:                         0.9595717191696167 / 0.9694790840148926
after epoch: 9,now: 2024-06-17 04:33:12.618348,epoch time: 0:14:38.349019,used: 2:12:37.996922,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_34_seed_0_21329044
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9707991, 'precision': 0.7748519, 'recall': 0.7789948, 'specificity': 0.7789948, 'f1': 0.77690625, 'auroc': 0.94780916, 'binary_precision': 0.5645485, 'binary_recall': 0.57336956, 'binary_specificity': 0.9846201, 'binary_f1_score': 0.56892484}
confusion matrix:
       0    1
0  41677  651
1    628  844
---- Validation: 
scalar performance:
{'acc': 0.9713176, 'precision': 0.80263346, 'recall': 0.6963794, 'specificity': 0.6963794, 'f1': 0.73717207, 'auroc': 0.9485322, 'binary_precision': 0.6262136, 'binary_recall': 0.40124416, 'binary_specificity': 0.9915147, 'binary_f1_score': 0.48909953}
confusion matrix:
       0    1
0  17995  154
1    385  258
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9643656, 'precision': 0.9696486, 'recall': 0.57462925, 'specificity': 0.57462925, 'f1': 0.62044, 'auroc': 0.88959026, 'binary_precision': 0.975, 'binary_recall': 0.14942528, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.2591362}
confusion matrix:
      0   1
0  5996   1
1   222  39
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329044_10.png
early stop counter: 2
val acc:0.9713175892829895, best validation acc: 0.9715304374694824, corresponding to test acc:                         0.9595717191696167 / 0.9694790840148926
after epoch: 10,now: 2024-06-17 04:47:52.076226,epoch time: 0:14:39.457878,used: 2:27:17.454800,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_34_seed_0_21329044
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.97333336, 'precision': 0.81208646, 'recall': 0.72817606, 'specificity': 0.72817606, 'f1': 0.76303196, 'auroc': 0.9494239, 'binary_precision': 0.6425891, 'binary_recall': 0.46535325, 'binary_specificity': 0.99099886, 'binary_f1_score': 0.5397951}
confusion matrix:
       0    1
0  41947  381
1    787  685
---- Validation: 
scalar performance:
{'acc': 0.97243506, 'precision': 0.83156765, 'recall': 0.6767065, 'specificity': 0.6767065, 'f1': 0.7286385, 'auroc': 0.95056844, 'binary_precision': 0.6854599, 'binary_recall': 0.3592535, 'binary_specificity': 0.99415946, 'binary_f1_score': 0.47142857}
confusion matrix:
       0    1
0  18043  106
1    412  231
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96340686, 'precision': 0.9669779, 'recall': 0.563135, 'specificity': 0.563135, 'f1': 0.60249525, 'auroc': 0.88457, 'binary_precision': 0.9705882, 'binary_recall': 0.12643678, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.2237288}
confusion matrix:
      0   1
0  5996   1
1   228  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329044_11.png
better model found
persisted
after epoch: 11,now: 2024-06-17 05:02:25.695423,epoch time: 0:14:33.619197,used: 2:41:51.073997,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_34_seed_0_21329044
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.97203195, 'precision': 0.8148212, 'recall': 0.6770121, 'specificity': 0.6770121, 'f1': 0.72500247, 'auroc': 0.9468111, 'binary_precision': 0.6515337, 'binary_recall': 0.3607337, 'binary_specificity': 0.9932905, 'binary_f1_score': 0.4643638}
confusion matrix:
       0    1
0  42044  284
1    941  531
---- Validation: 
scalar performance:
{'acc': 0.971424, 'precision': 0.8477496, 'recall': 0.6326798, 'specificity': 0.6326798, 'f1': 0.6886071, 'auroc': 0.9505991, 'binary_precision': 0.72083336, 'binary_recall': 0.2690513, 'binary_specificity': 0.9963083, 'binary_f1_score': 0.39184597}
confusion matrix:
       0    1
0  18082   67
1    470  173
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.9799136, 'recall': 0.5191571, 'specificity': 0.5191571, 'f1': 0.52665126, 'auroc': 0.881932, 'binary_precision': 1.0, 'binary_recall': 0.038314175, 'binary_specificity': 1.0, 'binary_f1_score': 0.073800735}
confusion matrix:
      0   1
0  5997   0
1   251  10
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329044_12.png
early stop counter: 1
val acc:0.9714239835739136, best validation acc: 0.9724350571632385, corresponding to test acc:                         0.9634068608283997 / 0.9694790840148926
after epoch: 12,now: 2024-06-17 05:17:03.145813,epoch time: 0:14:37.450390,used: 2:56:28.524387,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_34_seed_0_21329044
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.97194064, 'precision': 0.78735054, 'recall': 0.7622088, 'specificity': 0.7622088, 'f1': 0.77414715, 'auroc': 0.95054317, 'binary_precision': 0.59073937, 'binary_recall': 0.5373641, 'binary_specificity': 0.9870535, 'binary_f1_score': 0.5627891}
confusion matrix:
       0    1
0  41780  548
1    681  791
---- Validation: 
scalar performance:
{'acc': 0.9717433, 'precision': 0.8192637, 'recall': 0.67559826, 'specificity': 0.67559826, 'f1': 0.72483337, 'auroc': 0.95294785, 'binary_precision': 0.66091955, 'binary_recall': 0.3576983, 'binary_specificity': 0.99349827, 'binary_f1_score': 0.4641776}
confusion matrix:
       0    1
0  18031  118
1    413  230
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96324706, 'precision': 0.9664549, 'recall': 0.5612193, 'specificity': 0.5612193, 'f1': 0.59943426, 'auroc': 0.8921825, 'binary_precision': 0.969697, 'binary_recall': 0.12260536, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.21768707}
confusion matrix:
      0   1
0  5996   1
1   229  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329044_13.png
early stop counter: 2
val acc:0.9717432856559753, best validation acc: 0.9724350571632385, corresponding to test acc:                         0.9634068608283997 / 0.9694790840148926
after epoch: 13,now: 2024-06-17 05:31:35.623360,epoch time: 0:14:32.477547,used: 3:11:01.001934,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_34_seed_0_21329044
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9734475, 'precision': 0.80405957, 'recall': 0.75774264, 'specificity': 0.75774264, 'f1': 0.77881134, 'auroc': 0.95151407, 'binary_precision': 0.6244964, 'binary_recall': 0.52649456, 'binary_specificity': 0.9889907, 'binary_f1_score': 0.5713233}
confusion matrix:
       0    1
0  41862  466
1    697  775
---- Validation: 
scalar performance:
{'acc': 0.972914, 'precision': 0.82161593, 'recall': 0.7077067, 'specificity': 0.7077067, 'f1': 0.7513429, 'auroc': 0.95294136, 'binary_precision': 0.66341466, 'binary_recall': 0.4230171, 'binary_specificity': 0.9923963, 'binary_f1_score': 0.5166192}
confusion matrix:
       0    1
0  18011  138
1    371  272
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96276766, 'precision': 0.96470773, 'recall': 0.5554722, 'specificity': 0.5554722, 'f1': 0.5901267, 'auroc': 0.88431394, 'binary_precision': 0.96666664, 'binary_recall': 0.11111111, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.19931272}
confusion matrix:
      0   1
0  5996   1
1   232  29
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329044_14.png
better model found
persisted
after epoch: 14,now: 2024-06-17 05:46:14.881052,epoch time: 0:14:39.257692,used: 3:25:40.259626,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_34_seed_0_21329044
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.97159815, 'precision': 0.7805805, 'recall': 0.7879327, 'specificity': 0.7879327, 'f1': 0.7842041, 'auroc': 0.9510058, 'binary_precision': 0.57539684, 'binary_recall': 0.5910326, 'binary_specificity': 0.98483276, 'binary_f1_score': 0.5831099}
confusion matrix:
       0    1
0  41686  642
1    602  870
---- Validation: 
scalar performance:
{'acc': 0.9724883, 'precision': 0.8004172, 'recall': 0.7509895, 'specificity': 0.7509895, 'f1': 0.7732736, 'auroc': 0.9519681, 'binary_precision': 0.6179775, 'binary_recall': 0.5132193, 'binary_specificity': 0.9887597, 'binary_f1_score': 0.5607477}
confusion matrix:
       0    1
0  17945  204
1    313  330
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96708214, 'precision': 0.959031, 'recall': 0.610861, 'specificity': 0.610861, 'f1': 0.6716775, 'auroc': 0.89251477, 'binary_precision': 0.9508197, 'binary_recall': 0.22222222, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.36024845}
confusion matrix:
      0   1
0  5994   3
1   203  58
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329044_15.png
early stop counter: 1
val acc:0.972488284111023, best validation acc: 0.9729139804840088, corresponding to test acc:                         0.9627676606178284 / 0.9694790840148926
after epoch: 15,now: 2024-06-17 06:00:56.832053,epoch time: 0:14:41.951001,used: 3:40:22.210627,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_34_seed_0_21329044
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.97356164, 'precision': 0.82659656, 'recall': 0.7037046, 'specificity': 0.7037046, 'f1': 0.7497241, 'auroc': 0.9533957, 'binary_precision': 0.6732892, 'binary_recall': 0.4144022, 'binary_specificity': 0.993007, 'binary_f1_score': 0.5130362}
confusion matrix:
       0    1
0  42032  296
1    862  610
---- Validation: 
scalar performance:
{'acc': 0.9722222, 'precision': 0.83693016, 'recall': 0.6638453, 'specificity': 0.6638453, 'f1': 0.7181386, 'auroc': 0.9494313, 'binary_precision': 0.6970684, 'binary_recall': 0.33281493, 'binary_specificity': 0.9948757, 'binary_f1_score': 0.45052627}
confusion matrix:
       0    1
0  18056   93
1    429  214
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.94904476, 'recall': 0.52865225, 'specificity': 0.52865225, 'f1': 0.54406095, 'auroc': 0.88539577, 'binary_precision': 0.9375, 'binary_recall': 0.057471264, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.10830325}
confusion matrix:
      0   1
0  5996   1
1   246  15
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329044_16.png
early stop counter: 2
val acc:0.9722222089767456, best validation acc: 0.9729139804840088, corresponding to test acc:                         0.9627676606178284 / 0.9694790840148926
after epoch: 16,now: 2024-06-17 06:15:39.879409,epoch time: 0:14:43.047356,used: 3:55:05.257983,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_34_seed_0_21329044
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.97333336, 'precision': 0.8053582, 'recall': 0.74850345, 'specificity': 0.74850345, 'f1': 0.7737405, 'auroc': 0.9500309, 'binary_precision': 0.6277311, 'binary_recall': 0.5074728, 'binary_specificity': 0.98953414, 'binary_f1_score': 0.56123215}
confusion matrix:
       0    1
0  41885  443
1    725  747
---- Validation: 
scalar performance:
{'acc': 0.97184974, 'precision': 0.8207276, 'recall': 0.6764034, 'specificity': 0.6764034, 'f1': 0.72586966, 'auroc': 0.94888544, 'binary_precision': 0.6637931, 'binary_recall': 0.3592535, 'binary_specificity': 0.99355334, 'binary_f1_score': 0.46619573}
confusion matrix:
       0    1
0  18032  117
1    412  231
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96228826, 'precision': 0.9626242, 'recall': 0.54972506, 'specificity': 0.54972506, 'f1': 0.5806278, 'auroc': 0.89169395, 'binary_precision': 0.962963, 'binary_recall': 0.099616855, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.18055554}
confusion matrix:
      0   1
0  5996   1
1   235  26
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329044_17.png
early stop counter: 3
val acc:0.9718497395515442, best validation acc: 0.9729139804840088, corresponding to test acc:                         0.9627676606178284 / 0.9694790840148926
after epoch: 17,now: 2024-06-17 06:30:13.024924,epoch time: 0:14:33.145515,used: 4:09:38.403498,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_34_seed_0_21329044
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.97280824, 'precision': 0.83243835, 'recall': 0.6724958, 'specificity': 0.6724958, 'f1': 0.7251438, 'auroc': 0.9466549, 'binary_precision': 0.6870839, 'binary_recall': 0.35054347, 'binary_specificity': 0.9944481, 'binary_f1_score': 0.4642375}
confusion matrix:
       0    1
0  42093  235
1    956  516
---- Validation: 
scalar performance:
{'acc': 0.970679, 'precision': 0.8614305, 'recall': 0.6060422, 'specificity': 0.6060422, 'f1': 0.65937304, 'auroc': 0.947101, 'binary_precision': 0.75, 'binary_recall': 0.21461898, 'binary_specificity': 0.99746543, 'binary_f1_score': 0.33373642}
confusion matrix:
       0    1
0  18103   46
1    505  138
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589326, 'precision': 0.97945315, 'recall': 0.50766283, 'specificity': 0.50766283, 'f1': 0.5046054, 'auroc': 0.8909396, 'binary_precision': 1.0, 'binary_recall': 0.01532567, 'binary_specificity': 1.0, 'binary_f1_score': 0.030188678}
confusion matrix:
      0  1
0  5997  0
1   257  4
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329044_18.png
early stop counter: 4
val acc:0.970678985118866, best validation acc: 0.9729139804840088, corresponding to test acc:                         0.9627676606178284 / 0.9694790840148926
after epoch: 18,now: 2024-06-17 06:44:49.041661,epoch time: 0:14:36.016737,used: 4:24:14.420235,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_34_seed_0_21329044
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9729224, 'precision': 0.81540966, 'recall': 0.70514345, 'specificity': 0.70514345, 'f1': 0.7475916, 'auroc': 0.9474422, 'binary_precision': 0.6507937, 'binary_recall': 0.41808292, 'binary_specificity': 0.99220395, 'binary_f1_score': 0.509106}
confusion matrix:
       0    1
0  41999  330
1    856  615
---- Validation: 
scalar performance:
{'acc': 0.9721158, 'precision': 0.8290785, 'recall': 0.67129076, 'specificity': 0.67129076, 'f1': 0.7232966, 'auroc': 0.9491999, 'binary_precision': 0.68085104, 'binary_recall': 0.34836704, 'binary_specificity': 0.99421453, 'binary_f1_score': 0.46090534}
confusion matrix:
       0    1
0  18044  105
1    419  224
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.94442666, 'recall': 0.5248208, 'specificity': 0.5248208, 'f1': 0.537102, 'auroc': 0.8879293, 'binary_precision': 0.9285714, 'binary_recall': 0.049808428, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.094545454}
confusion matrix:
      0   1
0  5996   1
1   248  13
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329044_19.png
early stop counter: 5
val acc:0.9721158146858215, best validation acc: 0.9729139804840088, corresponding to test acc:                         0.9627676606178284 / 0.9694790840148926
after epoch: 19,now: 2024-06-17 06:59:25.201084,epoch time: 0:14:36.159423,used: 4:38:50.579658,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_34_seed_0_21329044
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9727626, 'precision': 0.80558, 'recall': 0.7252579, 'specificity': 0.7252579, 'f1': 0.7587896, 'auroc': 0.9477847, 'binary_precision': 0.6297674, 'binary_recall': 0.45991847, 'binary_specificity': 0.99059725, 'binary_f1_score': 0.5316058}
confusion matrix:
       0    1
0  41930  398
1    795  677
---- Validation: 
scalar performance:
{'acc': 0.9724883, 'precision': 0.8227164, 'recall': 0.6924852, 'specificity': 0.6924852, 'f1': 0.73974687, 'auroc': 0.9492068, 'binary_precision': 0.6666667, 'binary_recall': 0.3919129, 'binary_specificity': 0.9930575, 'binary_f1_score': 0.49363375}
confusion matrix:
       0    1
0  18023  126
1    391  252
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96340686, 'precision': 0.9669779, 'recall': 0.563135, 'specificity': 0.563135, 'f1': 0.60249525, 'auroc': 0.88772964, 'binary_precision': 0.9705882, 'binary_recall': 0.12643678, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.2237288}
confusion matrix:
      0   1
0  5996   1
1   228  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329044_20.png
early stop counter: 6
val acc:0.972488284111023, best validation acc: 0.9729139804840088, corresponding to test acc:                         0.9627676606178284 / 0.9694790840148926
after epoch: 20,now: 2024-06-17 07:14:04.786234,epoch time: 0:14:39.585150,used: 4:53:30.164808,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_34_seed_0_21329044
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9729909, 'precision': 0.80085456, 'recall': 0.7497995, 'specificity': 0.7497995, 'f1': 0.77273625, 'auroc': 0.94907653, 'binary_precision': 0.61861616, 'binary_recall': 0.510537, 'binary_specificity': 0.9890619, 'binary_f1_score': 0.559404}
confusion matrix:
       0    1
0  41866  463
1    720  751
---- Validation: 
scalar performance:
{'acc': 0.97392505, 'precision': 0.8273074, 'recall': 0.7269815, 'specificity': 0.7269815, 'f1': 0.76727295, 'auroc': 0.9512908, 'binary_precision': 0.67346936, 'binary_recall': 0.46189734, 'binary_specificity': 0.99206567, 'binary_f1_score': 0.5479705}
confusion matrix:
       0    1
0  18005  144
1    346  297
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.92983353, 'recall': 0.517158, 'specificity': 0.517158, 'f1': 0.5228796, 'auroc': 0.8737923, 'binary_precision': 0.9, 'binary_recall': 0.03448276, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.06642067}
confusion matrix:
      0  1
0  5996  1
1   252  9
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329044_21.png
better model found
persisted
after epoch: 21,now: 2024-06-17 07:28:50.916590,epoch time: 0:14:46.130356,used: 5:08:16.295164,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_34_seed_0_21329044
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9714612, 'precision': 0.7803608, 'recall': 0.7799931, 'specificity': 0.7799931, 'f1': 0.78017676, 'auroc': 0.9487529, 'binary_precision': 0.5755102, 'binary_recall': 0.57472825, 'binary_specificity': 0.985258, 'binary_f1_score': 0.5751189}
confusion matrix:
       0    1
0  41704  624
1    626  846
---- Validation: 
scalar performance:
{'acc': 0.97200936, 'precision': 0.8009686, 'recall': 0.72898996, 'specificity': 0.72898996, 'f1': 0.75962985, 'auroc': 0.95176995, 'binary_precision': 0.6206186, 'binary_recall': 0.4681182, 'binary_specificity': 0.9898617, 'binary_f1_score': 0.53368795}
confusion matrix:
       0    1
0  17965  184
1    342  301
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.95560277, 'recall': 0.5363151, 'specificity': 0.5363151, 'f1': 0.55768514, 'auroc': 0.8888699, 'binary_precision': 0.95, 'binary_recall': 0.07279693, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.13523132}
confusion matrix:
      0   1
0  5996   1
1   242  19
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329044_22.png
early stop counter: 1
val acc:0.9720093607902527, best validation acc: 0.9739250540733337, corresponding to test acc:                         0.9595717191696167 / 0.9694790840148926
after epoch: 22,now: 2024-06-17 07:43:35.594327,epoch time: 0:14:44.677737,used: 5:23:00.972901,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_34_seed_0_21329044
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.97340184, 'precision': 0.83700705, 'recall': 0.68263876, 'specificity': 0.68263876, 'f1': 0.73508865, 'auroc': 0.95330787, 'binary_precision': 0.6955414, 'binary_recall': 0.3709239, 'binary_specificity': 0.9943536, 'binary_f1_score': 0.4838281}
confusion matrix:
       0    1
0  42089  239
1    926  546
---- Validation: 
scalar performance:
{'acc': 0.97227544, 'precision': 0.8596766, 'recall': 0.6428713, 'specificity': 0.6428713, 'f1': 0.70118684, 'auroc': 0.94739574, 'binary_precision': 0.744, 'binary_recall': 0.28926906, 'binary_specificity': 0.9964736, 'binary_f1_score': 0.41657338}
confusion matrix:
       0    1
0  18085   64
1    457  186
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590924, 'precision': 0.97952986, 'recall': 0.5095785, 'specificity': 0.5095785, 'f1': 0.508348, 'auroc': 0.8817345, 'binary_precision': 1.0, 'binary_recall': 0.019157087, 'binary_specificity': 1.0, 'binary_f1_score': 0.037593983}
confusion matrix:
      0  1
0  5997  0
1   256  5
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329044_23.png
early stop counter: 2
val acc:0.97227543592453, best validation acc: 0.9739250540733337, corresponding to test acc:                         0.9595717191696167 / 0.9694790840148926
after epoch: 23,now: 2024-06-17 07:58:16.221788,epoch time: 0:14:40.627461,used: 5:37:41.600362,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_34_seed_0_21329044
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9730822, 'precision': 0.83700275, 'recall': 0.673949, 'specificity': 0.673949, 'f1': 0.72743547, 'auroc': 0.95196813, 'binary_precision': 0.6961178, 'binary_recall': 0.35326087, 'binary_specificity': 0.99463713, 'binary_f1_score': 0.46867964}
confusion matrix:
       0    1
0  42101  227
1    952  520
---- Validation: 
scalar performance:
{'acc': 0.970679, 'precision': 0.8539301, 'recall': 0.61054254, 'specificity': 0.61054254, 'f1': 0.6641352, 'auroc': 0.94756067, 'binary_precision': 0.7346939, 'binary_recall': 0.22395024, 'binary_specificity': 0.9971348, 'binary_f1_score': 0.34326577}
confusion matrix:
       0    1
0  18097   52
1    499  144
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590924, 'precision': 0.97952986, 'recall': 0.5095785, 'specificity': 0.5095785, 'f1': 0.508348, 'auroc': 0.8868417, 'binary_precision': 1.0, 'binary_recall': 0.019157087, 'binary_specificity': 1.0, 'binary_f1_score': 0.037593983}
confusion matrix:
      0  1
0  5997  0
1   256  5
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329044_24.png
early stop counter: 3
val acc:0.970678985118866, best validation acc: 0.9739250540733337, corresponding to test acc:                         0.9595717191696167 / 0.9694790840148926
after epoch: 24,now: 2024-06-17 08:12:51.775866,epoch time: 0:14:35.554078,used: 5:52:17.154440,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_34_seed_0_21329044
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9729452, 'precision': 0.8092345, 'recall': 0.7217459, 'specificity': 0.7217459, 'f1': 0.7576369, 'auroc': 0.9509039, 'binary_precision': 0.6373206, 'binary_recall': 0.45244566, 'binary_specificity': 0.99104613, 'binary_f1_score': 0.52920145}
confusion matrix:
       0    1
0  41949  379
1    806  666
---- Validation: 
scalar performance:
{'acc': 0.9722222, 'precision': 0.838817, 'recall': 0.66159517, 'specificity': 0.66159517, 'f1': 0.7163936, 'auroc': 0.94529945, 'binary_precision': 0.7009967, 'binary_recall': 0.3281493, 'binary_specificity': 0.9950411, 'binary_f1_score': 0.4470339}
confusion matrix:
       0    1
0  18059   90
1    432  211
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.94904476, 'recall': 0.52865225, 'specificity': 0.52865225, 'f1': 0.54406095, 'auroc': 0.8852354, 'binary_precision': 0.9375, 'binary_recall': 0.057471264, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.10830325}
confusion matrix:
      0   1
0  5996   1
1   246  15
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329044_25.png
early stop counter: 4
val acc:0.9722222089767456, best validation acc: 0.9739250540733337, corresponding to test acc:                         0.9595717191696167 / 0.9694790840148926
after epoch: 25,now: 2024-06-17 08:27:31.216313,epoch time: 0:14:39.440447,used: 6:06:56.594887,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_34_seed_0_21329044
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.973379, 'precision': 0.8011344, 'recall': 0.76623166, 'specificity': 0.76623166, 'f1': 0.78250617, 'auroc': 0.9526871, 'binary_precision': 0.6180556, 'binary_recall': 0.5441576, 'binary_specificity': 0.9883056, 'binary_f1_score': 0.5787572}
confusion matrix:
       0    1
0  41833  495
1    671  801
---- Validation: 
scalar performance:
{'acc': 0.97259474, 'precision': 0.80618143, 'recall': 0.73529345, 'specificity': 0.73529345, 'f1': 0.7656629, 'auroc': 0.9476294, 'binary_precision': 0.63061225, 'binary_recall': 0.4805599, 'binary_specificity': 0.990027, 'binary_f1_score': 0.5454545}
confusion matrix:
       0    1
0  17968  181
1    334  309
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.96590406, 'recall': 0.5593036, 'specificity': 0.5593036, 'f1': 0.59635264, 'auroc': 0.8899014, 'binary_precision': 0.96875, 'binary_recall': 0.118773945, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.21160409}
confusion matrix:
      0   1
0  5996   1
1   230  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329044_26.png
early stop counter: 5
val acc:0.9725947380065918, best validation acc: 0.9739250540733337, corresponding to test acc:                         0.9595717191696167 / 0.9694790840148926
after epoch: 26,now: 2024-06-17 08:42:17.467906,epoch time: 0:14:46.251593,used: 6:21:42.846480,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_34_seed_0_21329044
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9742009, 'precision': 0.81418955, 'recall': 0.75272214, 'specificity': 0.75272214, 'f1': 0.7798195, 'auroc': 0.9517929, 'binary_precision': 0.6451064, 'binary_recall': 0.51529574, 'binary_specificity': 0.9901486, 'binary_f1_score': 0.5729403}
confusion matrix:
       0    1
0  41912  417
1    713  758
---- Validation: 
scalar performance:
{'acc': 0.97227544, 'precision': 0.83113074, 'recall': 0.67287356, 'specificity': 0.67287356, 'f1': 0.72515595, 'auroc': 0.95094323, 'binary_precision': 0.6848485, 'binary_recall': 0.35147744, 'binary_specificity': 0.99426967, 'binary_f1_score': 0.46454266}
confusion matrix:
       0    1
0  18045  104
1    417  226
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.8965738, 'recall': 0.51899034, 'specificity': 0.51899034, 'f1': 0.5262976, 'auroc': 0.8882685, 'binary_precision': 0.8333333, 'binary_recall': 0.038314175, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.07326008}
confusion matrix:
      0   1
0  5995   2
1   251  10
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329044_27.png
early stop counter: 6
val acc:0.97227543592453, best validation acc: 0.9739250540733337, corresponding to test acc:                         0.9595717191696167 / 0.9694790840148926
after epoch: 27,now: 2024-06-17 08:56:59.640090,epoch time: 0:14:42.172184,used: 6:36:25.018664,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_34_seed_0_21329044
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.973379, 'precision': 0.8246945, 'recall': 0.70164293, 'specificity': 0.70164293, 'f1': 0.7475823, 'auroc': 0.94902325, 'binary_precision': 0.6696231, 'binary_recall': 0.4103261, 'binary_specificity': 0.99295974, 'binary_f1_score': 0.50884587}
confusion matrix:
       0    1
0  42030  298
1    868  604
---- Validation: 
scalar performance:
{'acc': 0.97184974, 'precision': 0.83142567, 'recall': 0.6606523, 'specificity': 0.6606523, 'f1': 0.71406573, 'auroc': 0.9460311, 'binary_precision': 0.6862745, 'binary_recall': 0.32659408, 'binary_specificity': 0.99471045, 'binary_f1_score': 0.44257113}
confusion matrix:
       0    1
0  18053   96
1    433  210
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9600511, 'precision': 0.9416025, 'recall': 0.5229051, 'specificity': 0.5229051, 'f1': 0.5335849, 'auroc': 0.89322376, 'binary_precision': 0.9230769, 'binary_recall': 0.04597701, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.08759124}
confusion matrix:
      0   1
0  5996   1
1   249  12
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329044_28.png
early stop counter: 7
val acc:0.9718497395515442, best validation acc: 0.9739250540733337, corresponding to test acc:                         0.9595717191696167 / 0.9694790840148926
after epoch: 28,now: 2024-06-17 09:11:43.444882,epoch time: 0:14:43.804792,used: 6:51:08.823456,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_34_seed_0_21329044
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9726484, 'precision': 0.850371, 'recall': 0.6481514, 'specificity': 0.6481514, 'f1': 0.7052915, 'auroc': 0.94980323, 'binary_precision': 0.7245902, 'binary_recall': 0.30027175, 'binary_specificity': 0.996031, 'binary_f1_score': 0.42459175}
confusion matrix:
       0    1
0  42160  168
1   1030  442
---- Validation: 
scalar performance:
{'acc': 0.969934, 'precision': 0.836885, 'recall': 0.6041564, 'specificity': 0.6041564, 'f1': 0.6547974, 'auroc': 0.9465959, 'binary_precision': 0.7010309, 'binary_recall': 0.21150856, 'binary_specificity': 0.99680424, 'binary_f1_score': 0.32497013}
confusion matrix:
       0    1
0  18091   58
1    507  136
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.97983676, 'recall': 0.51724136, 'specificity': 0.51724136, 'f1': 0.5230443, 'auroc': 0.8919867, 'binary_precision': 1.0, 'binary_recall': 0.03448276, 'binary_specificity': 1.0, 'binary_f1_score': 0.06666667}
confusion matrix:
      0  1
0  5997  0
1   252  9
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329044_29.png
early stop counter: 8
val acc:0.9699339866638184, best validation acc: 0.9739250540733337, corresponding to test acc:                         0.9595717191696167 / 0.9694790840148926
after epoch: 29,now: 2024-06-17 09:27:40.234807,epoch time: 0:15:56.789925,used: 7:07:05.613381,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_34_seed_0_21329044
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9726484, 'precision': 0.80542755, 'recall': 0.7212645, 'specificity': 0.7212645, 'f1': 0.7560127, 'auroc': 0.95269597, 'binary_precision': 0.6297349, 'binary_recall': 0.4517663, 'binary_specificity': 0.9907626, 'binary_f1_score': 0.52610755}
confusion matrix:
       0    1
0  41937  391
1    807  665
---- Validation: 
scalar performance:
{'acc': 0.97259474, 'precision': 0.8236468, 'recall': 0.6940404, 'specificity': 0.6940404, 'f1': 0.7412463, 'auroc': 0.9487784, 'binary_precision': 0.66842103, 'binary_recall': 0.39502332, 'binary_specificity': 0.9930575, 'binary_f1_score': 0.49657866}
confusion matrix:
       0    1
0  18023  126
1    389  254
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608501, 'precision': 0.95267093, 'recall': 0.53248364, 'specificity': 0.53248364, 'f1': 0.55092126, 'auroc': 0.8830516, 'binary_precision': 0.9444444, 'binary_recall': 0.0651341, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.121863805}
confusion matrix:
      0   1
0  5996   1
1   244  17
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329044_30.png
early stop counter: 9
val acc:0.9725947380065918, best validation acc: 0.9739250540733337, corresponding to test acc:                         0.9595717191696167 / 0.9694790840148926
after epoch: 30,now: 2024-06-17 09:42:25.104250,epoch time: 0:14:44.869443,used: 7:21:50.482824,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_34_seed_0_21329044
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 7:21:50.482824 at 2024-06-17 09:42:25.104250
persisted model performance metric: 

scalar performance:
{'acc': 0.9595717, 'precision': 0.92983353, 'recall': 0.517158, 'specificity': 0.517158, 'f1': 0.5228796, 'auroc': 0.8737923, 'binary_precision': 0.9, 'binary_recall': 0.03448276, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.06642067}
confusion matrix:
      0  1
0  5996  1
1   252  9
oracle model performance metric: 

scalar performance:
{'acc': 0.9694791, 'precision': 0.9712051, 'recall': 0.6377643, 'specificity': 0.6377643, 'f1': 0.70708525, 'auroc': 0.90424764, 'binary_precision': 0.972973, 'binary_recall': 0.27586207, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.42985073}
confusion matrix:
      0   1
0  5995   2
1   189  72
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre3/rule_results/2.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre3/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre3/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204178 KiB |   1436 MiB | 404958 GiB | 404958 GiB |
|       from large pool | 167936 KiB |   1366 MiB | 404884 GiB | 404884 GiB |
|       from small pool |  36242 KiB |     72 MiB |     74 GiB |     74 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 204178 KiB |   1436 MiB | 404958 GiB | 404958 GiB |
|       from large pool | 167936 KiB |   1366 MiB | 404884 GiB | 404884 GiB |
|       from small pool |  36242 KiB |     72 MiB |     74 GiB |     74 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201088 KiB |   1428 MiB | 404935 GiB | 404935 GiB |
|       from large pool | 165120 KiB |   1358 MiB | 404863 GiB | 404863 GiB |
|       from small pool |  35968 KiB |     71 MiB |     71 GiB |     71 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1524 MiB |   1524 MiB |   1524 MiB |      0 B   |
|       from large pool |   1450 MiB |   1450 MiB |   1450 MiB |      0 B   |
|       from small pool |     74 MiB |     74 MiB |     74 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 320109 KiB | 749313 KiB | 302186 GiB | 302186 GiB |
|       from large pool | 311296 KiB | 748328 KiB | 302105 GiB | 302104 GiB |
|       from small pool |   8813 KiB |  12610 KiB |     81 GiB |     81 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1278    |    1935    |   13349 K  |   13348 K  |
|       from large pool |      36    |      76    |    5312 K  |    5312 K  |
|       from small pool |    1242    |    1864    |    8037 K  |    8036 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1278    |    1935    |   13349 K  |   13348 K  |
|       from large pool |      36    |      76    |    5312 K  |    5312 K  |
|       from small pool |    1242    |    1864    |    8037 K  |    8036 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      50    |      50    |      50    |       0    |
|       from large pool |      13    |      13    |      13    |       0    |
|       from small pool |      37    |      37    |      37    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      35    |     452    |    7141 K  |    7141 K  |
|       from large pool |       5    |      10    |    1973 K  |    1973 K  |
|       from small pool |      30    |     447    |    5168 K  |    5167 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1436 MiB | 404958 GiB | 404958 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 404884 GiB | 404884 GiB |
|       from small pool |      0 KiB |     72 MiB |     74 GiB |     74 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1436 MiB | 404958 GiB | 404958 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 404884 GiB | 404884 GiB |
|       from small pool |      0 KiB |     72 MiB |     74 GiB |     74 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1428 MiB | 404935 GiB | 404935 GiB |
|       from large pool |  16640 KiB |   1358 MiB | 404863 GiB | 404863 GiB |
|       from small pool |      0 KiB |     71 MiB |     71 GiB |     71 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 524288 KiB |   1524 MiB |   1524 MiB |   1012 MiB |
|       from large pool | 479232 KiB |   1450 MiB |   1450 MiB |    982 MiB |
|       from small pool |  45056 KiB |     74 MiB |     74 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 298752 KiB | 749313 KiB | 302186 GiB | 302186 GiB |
|       from large pool | 298752 KiB | 748328 KiB | 302105 GiB | 302105 GiB |
|       from small pool |      0 KiB |  16408 KiB |     81 GiB |     81 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1935    |   13349 K  |   13349 K  |
|       from large pool |       2    |      76    |    5312 K  |    5312 K  |
|       from small pool |       0    |    1864    |    8037 K  |    8037 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1935    |   13349 K  |   13349 K  |
|       from large pool |       2    |      76    |    5312 K  |    5312 K  |
|       from small pool |       0    |    1864    |    8037 K  |    8037 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      50    |      50    |      19    |
|       from large pool |       9    |      13    |      13    |       4    |
|       from small pool |      22    |      37    |      37    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     452    |    7142 K  |    7142 K  |
|       from large pool |       1    |      11    |    1973 K  |    1973 K  |
|       from small pool |       0    |     447    |    5168 K  |    5168 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1436 MiB | 404958 GiB | 404958 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 404884 GiB | 404884 GiB |
|       from small pool |      0 KiB |     72 MiB |     74 GiB |     74 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1436 MiB | 404958 GiB | 404958 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 404884 GiB | 404884 GiB |
|       from small pool |      0 KiB |     72 MiB |     74 GiB |     74 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1428 MiB | 404935 GiB | 404935 GiB |
|       from large pool |  16640 KiB |   1358 MiB | 404863 GiB | 404863 GiB |
|       from small pool |      0 KiB |     71 MiB |     71 GiB |     71 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 524288 KiB |   1524 MiB |   1524 MiB |   1012 MiB |
|       from large pool | 479232 KiB |   1450 MiB |   1450 MiB |    982 MiB |
|       from small pool |  45056 KiB |     74 MiB |     74 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 298752 KiB | 749313 KiB | 302186 GiB | 302186 GiB |
|       from large pool | 298752 KiB | 748328 KiB | 302105 GiB | 302105 GiB |
|       from small pool |      0 KiB |  16408 KiB |     81 GiB |     81 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1935    |   13349 K  |   13349 K  |
|       from large pool |       2    |      76    |    5312 K  |    5312 K  |
|       from small pool |       0    |    1864    |    8037 K  |    8037 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1935    |   13349 K  |   13349 K  |
|       from large pool |       2    |      76    |    5312 K  |    5312 K  |
|       from small pool |       0    |    1864    |    8037 K  |    8037 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      50    |      50    |      19    |
|       from large pool |       9    |      13    |      13    |       4    |
|       from small pool |      22    |      37    |      37    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     452    |    7142 K  |    7142 K  |
|       from large pool |       1    |      11    |    1973 K  |    1973 K  |
|       from small pool |       0    |     447    |    5168 K  |    5168 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0




!!!: not committed yet



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_49_19_seed_1_21329044

 Experiment start at: 2024-06-17 09:49:19.612321
before training, model accuracy: 0.14631003141403198
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96719176, 'precision': 0.74019265, 'recall': 0.6651827, 'specificity': 0.6651827, 'f1': 0.6950314, 'auroc': 0.9221556, 'binary_precision': 0.5025484, 'binary_recall': 0.34188628, 'binary_specificity': 0.98847914, 'binary_f1_score': 0.40693355}
confusion matrix:
       0    1
0  41870  488
1    949  493
---- Validation: 
scalar performance:
{'acc': 0.96659553, 'precision': 0.77622247, 'recall': 0.6236114, 'specificity': 0.6236114, 'f1': 0.66808033, 'auroc': 0.92032284, 'binary_precision': 0.579661, 'binary_recall': 0.25408617, 'binary_specificity': 0.99313664, 'binary_f1_score': 0.35330576}
confusion matrix:
       0    1
0  17943  124
1    502  171
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9648727, 'precision': 0.9823167, 'recall': 0.58076924, 'specificity': 0.58076924, 'f1': 0.630072, 'auroc': 0.8723289, 'binary_precision': 1.0, 'binary_recall': 0.16153847, 'binary_specificity': 1.0, 'binary_f1_score': 0.2781457}
confusion matrix:
      0   1
0  5946   0
1   218  42
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329044_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-17 10:04:33.077801,epoch time: 0:15:13.465480,used: 0:15:13.465480,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_49_19_seed_1_21329044
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.969726, 'precision': 0.76646763, 'recall': 0.70413977, 'specificity': 0.70413977, 'f1': 0.7307706, 'auroc': 0.93519354, 'binary_precision': 0.5525114, 'binary_recall': 0.41984734, 'binary_specificity': 0.9884322, 'binary_f1_score': 0.47712937}
confusion matrix:
       0    1
0  41869  490
1    836  605
---- Validation: 
scalar performance:
{'acc': 0.9689434, 'precision': 0.8086137, 'recall': 0.64914817, 'specificity': 0.64914817, 'f1': 0.698678, 'auroc': 0.93181115, 'binary_precision': 0.6426332, 'binary_recall': 0.30460623, 'binary_specificity': 0.99369013, 'binary_f1_score': 0.41330644}
confusion matrix:
       0    1
0  17953  114
1    468  205
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9653561, 'precision': 0.9825516, 'recall': 0.58653843, 'specificity': 0.58653843, 'f1': 0.6386618, 'auroc': 0.8851624, 'binary_precision': 1.0, 'binary_recall': 0.17307693, 'binary_specificity': 1.0, 'binary_f1_score': 0.295082}
confusion matrix:
      0   1
0  5946   0
1   215  45
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329044_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-17 10:19:47.166908,epoch time: 0:15:14.089107,used: 0:30:27.554587,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_49_19_seed_1_21329044
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96984017, 'precision': 0.76197076, 'recall': 0.77129304, 'specificity': 0.77129304, 'f1': 0.7665417, 'auroc': 0.9434517, 'binary_precision': 0.5389262, 'binary_recall': 0.5588031, 'binary_specificity': 0.983783, 'binary_f1_score': 0.54868466}
confusion matrix:
       0    1
0  41676  687
1    634  803
---- Validation: 
scalar performance:
{'acc': 0.96905017, 'precision': 0.7831952, 'recall': 0.7293135, 'specificity': 0.7293135, 'f1': 0.75312376, 'auroc': 0.9362534, 'binary_precision': 0.5859519, 'binary_recall': 0.47102526, 'binary_specificity': 0.9876017, 'binary_f1_score': 0.5222405}
confusion matrix:
       0    1
0  17843  224
1    356  317
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9730905, 'precision': 0.9668483, 'recall': 0.6862021, 'specificity': 0.6862021, 'f1': 0.7617692, 'auroc': 0.8975258, 'binary_precision': 0.96039605, 'binary_recall': 0.37307692, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.53739613}
confusion matrix:
      0   1
0  5942   4
1   163  97
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329044_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-17 10:37:40.121188,epoch time: 0:17:52.954280,used: 0:48:20.508867,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_49_19_seed_1_21329044
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9715525, 'precision': 0.7969955, 'recall': 0.6757013, 'specificity': 0.6757013, 'f1': 0.7194525, 'auroc': 0.942904, 'binary_precision': 0.6154762, 'binary_recall': 0.35902777, 'binary_specificity': 0.9923749, 'binary_f1_score': 0.45350876}
confusion matrix:
       0    1
0  42037  323
1    923  517
---- Validation: 
scalar performance:
{'acc': 0.96979725, 'precision': 0.86059946, 'recall': 0.61811924, 'specificity': 0.61811924, 'f1': 0.6735724, 'auroc': 0.9355682, 'binary_precision': 0.74883723, 'binary_recall': 0.23922734, 'binary_specificity': 0.9970111, 'binary_f1_score': 0.3626126}
confusion matrix:
       0    1
0  18013   54
1    512  161
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590719, 'precision': 0.97951615, 'recall': 0.51153845, 'specificity': 0.51153845, 'f1': 0.5121002, 'auroc': 0.88398314, 'binary_precision': 1.0, 'binary_recall': 0.023076924, 'binary_specificity': 1.0, 'binary_f1_score': 0.045112785}
confusion matrix:
      0  1
0  5946  0
1   254  6
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329044_4.png
better model found
persisted
after epoch: 4,now: 2024-06-17 10:53:31.391633,epoch time: 0:15:51.270445,used: 1:04:11.779312,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_49_19_seed_1_21329044
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9707078, 'precision': 0.77437073, 'recall': 0.72490656, 'specificity': 0.72490656, 'f1': 0.7469485, 'auroc': 0.948286, 'binary_precision': 0.5669224, 'binary_recall': 0.46180555, 'binary_specificity': 0.98800755, 'binary_f1_score': 0.50899345}
confusion matrix:
       0    1
0  41852  508
1    775  665
---- Validation: 
scalar performance:
{'acc': 0.97022414, 'precision': 0.80845416, 'recall': 0.69201314, 'specificity': 0.69201314, 'f1': 0.73542786, 'auroc': 0.9398978, 'binary_precision': 0.6392252, 'binary_recall': 0.3922734, 'binary_specificity': 0.9917529, 'binary_f1_score': 0.48618788}
confusion matrix:
       0    1
0  17918  149
1    409  264
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96326137, 'precision': 0.98153543, 'recall': 0.56153846, 'specificity': 0.56153846, 'f1': 0.6001831, 'auroc': 0.8901249, 'binary_precision': 1.0, 'binary_recall': 0.12307692, 'binary_specificity': 1.0, 'binary_f1_score': 0.21917808}
confusion matrix:
      0   1
0  5946   0
1   228  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329044_5.png
better model found
persisted
after epoch: 5,now: 2024-06-17 11:08:34.397727,epoch time: 0:15:03.006094,used: 1:19:14.785406,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_49_19_seed_1_21329044
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97178084, 'precision': 0.7869798, 'recall': 0.71764815, 'specificity': 0.71764815, 'f1': 0.74710864, 'auroc': 0.94809496, 'binary_precision': 0.5925926, 'binary_recall': 0.44568247, 'binary_specificity': 0.98961383, 'binary_f1_score': 0.50874406}
confusion matrix:
       0    1
0  41924  440
1    796  640
---- Validation: 
scalar performance:
{'acc': 0.96963716, 'precision': 0.80015564, 'recall': 0.69170874, 'specificity': 0.69170874, 'f1': 0.7328367, 'auroc': 0.94051254, 'binary_precision': 0.6226415, 'binary_recall': 0.3922734, 'binary_specificity': 0.99114406, 'binary_f1_score': 0.48131266}
confusion matrix:
       0    1
0  17907  160
1    409  264
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9658395, 'precision': 0.98278666, 'recall': 0.5923077, 'specificity': 0.5923077, 'f1': 0.64708674, 'auroc': 0.900146, 'binary_precision': 1.0, 'binary_recall': 0.18461539, 'binary_specificity': 1.0, 'binary_f1_score': 0.31168833}
confusion matrix:
      0   1
0  5946   0
1   212  48
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329044_6.png
early stop counter: 1
val acc:0.9696371555328369, best validation acc: 0.970224142074585, corresponding to test acc:                         0.9632613658905029 / 0.9730905294418335
after epoch: 6,now: 2024-06-17 11:23:33.332044,epoch time: 0:14:58.934317,used: 1:34:13.719723,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_49_19_seed_1_21329044
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9716895, 'precision': 0.782141, 'recall': 0.74336517, 'specificity': 0.74336517, 'f1': 0.76118314, 'auroc': 0.94650495, 'binary_precision': 0.58124495, 'binary_recall': 0.49895906, 'binary_specificity': 0.9877712, 'binary_f1_score': 0.5369679}
confusion matrix:
       0    1
0  41841  518
1    722  719
---- Validation: 
scalar performance:
{'acc': 0.97097117, 'precision': 0.8185579, 'recall': 0.6945464, 'specificity': 0.6945464, 'f1': 0.74020875, 'auroc': 0.94290924, 'binary_precision': 0.65925926, 'binary_recall': 0.39673105, 'binary_specificity': 0.9923618, 'binary_f1_score': 0.49536175}
confusion matrix:
       0    1
0  17929  138
1    406  267
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96165, 'precision': 0.98075676, 'recall': 0.5423077, 'specificity': 0.5423077, 'f1': 0.5682038, 'auroc': 0.8926927, 'binary_precision': 1.0, 'binary_recall': 0.08461539, 'binary_specificity': 1.0, 'binary_f1_score': 0.15602838}
confusion matrix:
      0   1
0  5946   0
1   238  22
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329044_7.png
better model found
persisted
after epoch: 7,now: 2024-06-17 11:38:37.430485,epoch time: 0:15:04.098441,used: 1:49:17.818164,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_49_19_seed_1_21329044
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9723516, 'precision': 0.81485665, 'recall': 0.6682925, 'specificity': 0.6682925, 'f1': 0.71755755, 'auroc': 0.94506365, 'binary_precision': 0.65171504, 'binary_recall': 0.3428175, 'binary_specificity': 0.99376756, 'binary_f1_score': 0.44929513}
confusion matrix:
       0    1
0  42095  264
1    947  494
---- Validation: 
scalar performance:
{'acc': 0.97017074, 'precision': 0.8456549, 'recall': 0.63762516, 'specificity': 0.63762516, 'f1': 0.6934214, 'auroc': 0.94127476, 'binary_precision': 0.71755725, 'binary_recall': 0.2793462, 'binary_specificity': 0.99590415, 'binary_f1_score': 0.40213904}
confusion matrix:
       0    1
0  17993   74
1    485  188
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95955527, 'precision': 0.97974825, 'recall': 0.5173077, 'specificity': 0.5173077, 'f1': 0.5231221, 'auroc': 0.88775146, 'binary_precision': 1.0, 'binary_recall': 0.034615386, 'binary_specificity': 1.0, 'binary_f1_score': 0.0669145}
confusion matrix:
      0  1
0  5946  0
1   251  9
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329044_8.png
early stop counter: 1
val acc:0.9701707363128662, best validation acc: 0.9709711670875549, corresponding to test acc:                         0.961650013923645 / 0.9730905294418335
after epoch: 8,now: 2024-06-17 11:53:25.462265,epoch time: 0:14:48.031780,used: 2:04:05.849944,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_49_19_seed_1_21329044
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9722831, 'precision': 0.8023483, 'recall': 0.6912968, 'specificity': 0.6912968, 'f1': 0.7332571, 'auroc': 0.9491946, 'binary_precision': 0.62513906, 'binary_recall': 0.390549, 'binary_specificity': 0.99204457, 'binary_f1_score': 0.4807528}
confusion matrix:
       0    1
0  42024  337
1    877  562
---- Validation: 
scalar performance:
{'acc': 0.9711846, 'precision': 0.8310031, 'recall': 0.6796365, 'specificity': 0.6796365, 'f1': 0.7309643, 'auroc': 0.9442836, 'binary_precision': 0.68523675, 'binary_recall': 0.36552748, 'binary_specificity': 0.9937455, 'binary_f1_score': 0.4767442}
confusion matrix:
       0    1
0  17954  113
1    427  246
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95955527, 'precision': 0.97974825, 'recall': 0.5173077, 'specificity': 0.5173077, 'f1': 0.5231221, 'auroc': 0.87749475, 'binary_precision': 1.0, 'binary_recall': 0.034615386, 'binary_specificity': 1.0, 'binary_f1_score': 0.0669145}
confusion matrix:
      0  1
0  5946  0
1   251  9
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329044_9.png
better model found
persisted
after epoch: 9,now: 2024-06-17 12:08:21.396670,epoch time: 0:14:55.934405,used: 2:19:01.784349,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_49_19_seed_1_21329044
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.973242, 'precision': 0.8152101, 'recall': 0.6968274, 'specificity': 0.6968274, 'f1': 0.74119335, 'auroc': 0.9472408, 'binary_precision': 0.65050733, 'binary_recall': 0.4009729, 'binary_specificity': 0.9926819, 'binary_f1_score': 0.4961307}
confusion matrix:
       0    1
0  42051  310
1    862  577
---- Validation: 
scalar performance:
{'acc': 0.9710246, 'precision': 0.84254897, 'recall': 0.6609565, 'specificity': 0.6609565, 'f1': 0.7163657, 'auroc': 0.9415982, 'binary_precision': 0.7096774, 'binary_recall': 0.3268945, 'binary_specificity': 0.99501854, 'binary_f1_score': 0.44760936}
confusion matrix:
       0    1
0  17977   90
1    453  220
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587496, 'precision': 0.97936153, 'recall': 0.50769234, 'specificity': 0.50769234, 'f1': 0.5046148, 'auroc': 0.8700856, 'binary_precision': 1.0, 'binary_recall': 0.015384615, 'binary_specificity': 1.0, 'binary_f1_score': 0.03030303}
confusion matrix:
      0  1
0  5946  0
1   256  4
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329044_10.png
early stop counter: 1
val acc:0.9710245728492737, best validation acc: 0.9711846113204956, corresponding to test acc:                         0.9595552682876587 / 0.9730905294418335
after epoch: 10,now: 2024-06-17 12:23:23.133620,epoch time: 0:15:01.736950,used: 2:34:03.521299,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_49_19_seed_1_21329044
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9724201, 'precision': 0.8046569, 'recall': 0.6915791, 'specificity': 0.6915791, 'f1': 0.7341331, 'auroc': 0.95145, 'binary_precision': 0.6297539, 'binary_recall': 0.39097223, 'binary_specificity': 0.992186, 'binary_f1_score': 0.48243362}
confusion matrix:
       0    1
0  42029  331
1    877  563
---- Validation: 
scalar performance:
{'acc': 0.9713447, 'precision': 0.8474691, 'recall': 0.6632684, 'specificity': 0.6632684, 'f1': 0.7194998, 'auroc': 0.943205, 'binary_precision': 0.71935487, 'binary_recall': 0.33135214, 'binary_specificity': 0.9951846, 'binary_f1_score': 0.45371315}
confusion matrix:
       0    1
0  17980   87
1    450  223
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590719, 'precision': 0.97951615, 'recall': 0.51153845, 'specificity': 0.51153845, 'f1': 0.5121002, 'auroc': 0.8823429, 'binary_precision': 1.0, 'binary_recall': 0.023076924, 'binary_specificity': 1.0, 'binary_f1_score': 0.045112785}
confusion matrix:
      0  1
0  5946  0
1   254  6
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329044_11.png
better model found
persisted
after epoch: 11,now: 2024-06-17 12:38:16.347158,epoch time: 0:14:53.213538,used: 2:48:56.734837,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_49_19_seed_1_21329044
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9734475, 'precision': 0.8234043, 'recall': 0.68842065, 'specificity': 0.68842065, 'f1': 0.73667914, 'auroc': 0.9487623, 'binary_precision': 0.6674728, 'binary_recall': 0.38333333, 'binary_specificity': 0.99350804, 'binary_f1_score': 0.48698723}
confusion matrix:
       0    1
0  42085  275
1    888  552
---- Validation: 
scalar performance:
{'acc': 0.9713447, 'precision': 0.8699094, 'recall': 0.6439561, 'specificity': 0.6439561, 'f1': 0.7036336, 'auroc': 0.94202363, 'binary_precision': 0.765625, 'binary_recall': 0.29123327, 'binary_specificity': 0.996679, 'binary_f1_score': 0.42195907}
confusion matrix:
       0    1
0  18007   60
1    477  196
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9585885, 'precision': 0.9792842, 'recall': 0.50576925, 'specificity': 0.50576925, 'f1': 0.5008299, 'auroc': 0.8782976, 'binary_precision': 1.0, 'binary_recall': 0.011538462, 'binary_specificity': 1.0, 'binary_f1_score': 0.022813687}
confusion matrix:
      0  1
0  5946  0
1   257  3
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329044_12.png
early stop counter: 1
val acc:0.9713447093963623, best validation acc: 0.9713447093963623, corresponding to test acc:                         0.9590718746185303 / 0.9730905294418335
after epoch: 12,now: 2024-06-17 12:53:13.966000,epoch time: 0:14:57.618842,used: 3:03:54.353679,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_49_19_seed_1_21329044
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9736758, 'precision': 0.8166124, 'recall': 0.7093347, 'specificity': 0.7093347, 'f1': 0.75110984, 'auroc': 0.95106167, 'binary_precision': 0.65249735, 'binary_recall': 0.4263889, 'binary_specificity': 0.9922804, 'binary_f1_score': 0.51574963}
confusion matrix:
       0    1
0  42033  327
1    826  614
---- Validation: 
scalar performance:
{'acc': 0.9710246, 'precision': 0.8364533, 'recall': 0.6681092, 'specificity': 0.6681092, 'f1': 0.72186905, 'auroc': 0.9423243, 'binary_precision': 0.6969697, 'binary_recall': 0.34175333, 'binary_specificity': 0.99446505, 'binary_f1_score': 0.45862412}
confusion matrix:
       0    1
0  17967  100
1    443  230
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95939416, 'precision': 0.9796709, 'recall': 0.5153846, 'specificity': 0.5153846, 'f1': 0.5194752, 'auroc': 0.880118, 'binary_precision': 1.0, 'binary_recall': 0.03076923, 'binary_specificity': 1.0, 'binary_f1_score': 0.05970149}
confusion matrix:
      0  1
0  5946  0
1   252  8
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329044_13.png
early stop counter: 2
val acc:0.9710245728492737, best validation acc: 0.9713447093963623, corresponding to test acc:                         0.9590718746185303 / 0.9730905294418335
after epoch: 13,now: 2024-06-17 13:08:03.529179,epoch time: 0:14:49.563179,used: 3:18:43.916858,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_49_19_seed_1_21329044
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9729909, 'precision': 0.81460744, 'recall': 0.6912916, 'specificity': 0.6912916, 'f1': 0.7366715, 'auroc': 0.9493866, 'binary_precision': 0.64971095, 'binary_recall': 0.38973647, 'binary_specificity': 0.99284667, 'binary_f1_score': 0.48721284}
confusion matrix:
       0    1
0  42055  303
1    880  562
---- Validation: 
scalar performance:
{'acc': 0.9716649, 'precision': 0.8444706, 'recall': 0.6741634, 'specificity': 0.6741634, 'f1': 0.7290662, 'auroc': 0.94307995, 'binary_precision': 0.71257484, 'binary_recall': 0.3536404, 'binary_specificity': 0.9946864, 'binary_f1_score': 0.47269115}
confusion matrix:
       0    1
0  17971   96
1    435  238
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95939416, 'precision': 0.92974496, 'recall': 0.5172236, 'specificity': 0.5172236, 'f1': 0.52295613, 'auroc': 0.88969326, 'binary_precision': 0.9, 'binary_recall': 0.034615386, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.06666667}
confusion matrix:
      0  1
0  5945  1
1   251  9
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329044_14.png
better model found
persisted
after epoch: 14,now: 2024-06-17 13:23:08.653877,epoch time: 0:15:05.124698,used: 3:33:49.041556,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_49_19_seed_1_21329044
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.97269404, 'precision': 0.7925717, 'recall': 0.7452252, 'specificity': 0.7452252, 'f1': 0.76661754, 'auroc': 0.95025945, 'binary_precision': 0.6019983, 'binary_recall': 0.5017349, 'binary_specificity': 0.9887155, 'binary_f1_score': 0.5473126}
confusion matrix:
       0    1
0  41881  478
1    718  723
---- Validation: 
scalar performance:
{'acc': 0.9710246, 'precision': 0.810313, 'recall': 0.7146016, 'specificity': 0.7146016, 'f1': 0.7529011, 'auroc': 0.94503015, 'binary_precision': 0.6413044, 'binary_recall': 0.4383358, 'binary_specificity': 0.9908673, 'binary_f1_score': 0.52074146}
confusion matrix:
       0    1
0  17902  165
1    378  295
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9629391, 'precision': 0.9521177, 'recall': 0.5613703, 'specificity': 0.5613703, 'f1': 0.59935355, 'auroc': 0.8871567, 'binary_precision': 0.9411765, 'binary_recall': 0.12307692, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.21768707}
confusion matrix:
      0   1
0  5944   2
1   228  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329044_15.png
early stop counter: 1
val acc:0.9710245728492737, best validation acc: 0.9716649055480957, corresponding to test acc:                         0.9593941569328308 / 0.9730905294418335
after epoch: 15,now: 2024-06-17 13:38:00.375503,epoch time: 0:14:51.721626,used: 3:48:40.763182,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_49_19_seed_1_21329044
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.97271687, 'precision': 0.83367276, 'recall': 0.65239286, 'specificity': 0.65239286, 'f1': 0.70671666, 'auroc': 0.9469594, 'binary_precision': 0.69040245, 'binary_recall': 0.30950728, 'binary_specificity': 0.9952785, 'binary_f1_score': 0.42740774}
confusion matrix:
       0    1
0  42159  200
1    995  446
---- Validation: 
scalar performance:
{'acc': 0.96915686, 'precision': 0.8653933, 'recall': 0.60205126, 'specificity': 0.60205126, 'f1': 0.65449214, 'auroc': 0.94179344, 'binary_precision': 0.75956285, 'binary_recall': 0.20653789, 'binary_specificity': 0.9975646, 'binary_f1_score': 0.32476634}
confusion matrix:
       0    1
0  18023   44
1    534  139
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590719, 'precision': 0.97951615, 'recall': 0.51153845, 'specificity': 0.51153845, 'f1': 0.5121002, 'auroc': 0.8791327, 'binary_precision': 1.0, 'binary_recall': 0.023076924, 'binary_specificity': 1.0, 'binary_f1_score': 0.045112785}
confusion matrix:
      0  1
0  5946  0
1   254  6
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329044_16.png
early stop counter: 2
val acc:0.9691568613052368, best validation acc: 0.9716649055480957, corresponding to test acc:                         0.9593941569328308 / 0.9730905294418335
after epoch: 16,now: 2024-06-17 13:53:02.036808,epoch time: 0:15:01.661305,used: 4:03:42.424487,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_49_19_seed_1_21329044
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9727626, 'precision': 0.83313215, 'recall': 0.65327936, 'specificity': 0.65327936, 'f1': 0.70748097, 'auroc': 0.95097363, 'binary_precision': 0.68923074, 'binary_recall': 0.3113273, 'binary_specificity': 0.99523145, 'binary_f1_score': 0.42891335}
confusion matrix:
       0    1
0  42159  202
1    991  448
---- Validation: 
scalar performance:
{'acc': 0.97033083, 'precision': 0.8675838, 'recall': 0.6248334, 'specificity': 0.6248334, 'f1': 0.6821332, 'auroc': 0.9422897, 'binary_precision': 0.76233184, 'binary_recall': 0.25260028, 'binary_specificity': 0.9970665, 'binary_f1_score': 0.37946424}
confusion matrix:
       0    1
0  18014   53
1    503  170
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589107, 'precision': 0.9794388, 'recall': 0.50961536, 'specificity': 0.50961536, 'f1': 0.50837153, 'auroc': 0.87273085, 'binary_precision': 1.0, 'binary_recall': 0.01923077, 'binary_specificity': 1.0, 'binary_f1_score': 0.037735853}
confusion matrix:
      0  1
0  5946  0
1   255  5
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329044_17.png
early stop counter: 3
val acc:0.9703308343887329, best validation acc: 0.9716649055480957, corresponding to test acc:                         0.9593941569328308 / 0.9730905294418335
after epoch: 17,now: 2024-06-17 14:08:01.734583,epoch time: 0:14:59.697775,used: 4:18:42.122262,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_49_19_seed_1_21329044
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.97347033, 'precision': 0.79719853, 'recall': 0.76238537, 'specificity': 0.76238537, 'f1': 0.77860653, 'auroc': 0.9534931, 'binary_precision': 0.6101026, 'binary_recall': 0.53643304, 'binary_specificity': 0.98833776, 'binary_f1_score': 0.57090104}
confusion matrix:
       0    1
0  41865  494
1    668  773
---- Validation: 
scalar performance:
{'acc': 0.9711846, 'precision': 0.829088, 'recall': 0.68249756, 'specificity': 0.68249756, 'f1': 0.7329752, 'auroc': 0.94297475, 'binary_precision': 0.6811989, 'binary_recall': 0.37147102, 'binary_specificity': 0.99352413, 'binary_f1_score': 0.48076925}
confusion matrix:
       0    1
0  17950  117
1    423  250
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96052206, 'precision': 0.9802132, 'recall': 0.52884614, 'specificity': 0.52884614, 'f1': 0.54445237, 'auroc': 0.8749245, 'binary_precision': 1.0, 'binary_recall': 0.057692308, 'binary_specificity': 1.0, 'binary_f1_score': 0.10909091}
confusion matrix:
      0   1
0  5946   0
1   245  15
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329044_18.png
early stop counter: 4
val acc:0.9711846113204956, best validation acc: 0.9716649055480957, corresponding to test acc:                         0.9593941569328308 / 0.9730905294418335
after epoch: 18,now: 2024-06-17 14:23:34.724648,epoch time: 0:15:32.990065,used: 4:34:15.112327,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_49_19_seed_1_21329044
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.97289956, 'precision': 0.8153595, 'recall': 0.68600506, 'specificity': 0.68600506, 'f1': 0.7326226, 'auroc': 0.94982004, 'binary_precision': 0.6515513, 'binary_recall': 0.37890354, 'binary_specificity': 0.99310654, 'binary_f1_score': 0.4791575}
confusion matrix:
       0    1
0  42067  292
1    895  546
---- Validation: 
scalar performance:
{'acc': 0.97097117, 'precision': 0.83654, 'recall': 0.666651, 'specificity': 0.666651, 'f1': 0.72054386, 'auroc': 0.9417918, 'binary_precision': 0.6972477, 'binary_recall': 0.33878157, 'binary_specificity': 0.9945204, 'binary_f1_score': 0.456}
confusion matrix:
       0    1
0  17968   99
1    445  228
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96036094, 'precision': 0.9801357, 'recall': 0.52692306, 'specificity': 0.52692306, 'f1': 0.54096144, 'auroc': 0.88046455, 'binary_precision': 1.0, 'binary_recall': 0.053846154, 'binary_specificity': 1.0, 'binary_f1_score': 0.10218979}
confusion matrix:
      0   1
0  5946   0
1   246  14
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329044_19.png
early stop counter: 5
val acc:0.9709711670875549, best validation acc: 0.9716649055480957, corresponding to test acc:                         0.9593941569328308 / 0.9730905294418335
after epoch: 19,now: 2024-06-17 14:38:44.310288,epoch time: 0:15:09.585640,used: 4:49:24.697967,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_49_19_seed_1_21329044
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9721461, 'precision': 0.7822925, 'recall': 0.7735841, 'specificity': 0.7735841, 'f1': 0.77786326, 'auroc': 0.9510877, 'binary_precision': 0.5795129, 'binary_recall': 0.56102633, 'binary_specificity': 0.9861419, 'binary_f1_score': 0.57011986}
confusion matrix:
       0    1
0  41771  587
1    633  809
---- Validation: 
scalar performance:
{'acc': 0.9716649, 'precision': 0.82024467, 'recall': 0.7120726, 'specificity': 0.7120726, 'f1': 0.7541549, 'auroc': 0.9448216, 'binary_precision': 0.66136366, 'binary_recall': 0.43239227, 'binary_specificity': 0.9917529, 'binary_f1_score': 0.5229111}
confusion matrix:
       0    1
0  17918  149
1    382  291
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96471155, 'precision': 0.9706859, 'recall': 0.58068514, 'specificity': 0.58068514, 'f1': 0.629571, 'auroc': 0.8905661, 'binary_precision': 0.9767442, 'binary_recall': 0.16153847, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.27722773}
confusion matrix:
      0   1
0  5945   1
1   218  42
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329044_20.png
early stop counter: 6
val acc:0.9716649055480957, best validation acc: 0.9716649055480957, corresponding to test acc:                         0.9593941569328308 / 0.9730905294418335
after epoch: 20,now: 2024-06-17 14:55:02.333827,epoch time: 0:16:18.023539,used: 5:05:42.721506,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_49_19_seed_1_21329044
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9742694, 'precision': 0.8193411, 'recall': 0.72391796, 'specificity': 0.72391796, 'f1': 0.762535, 'auroc': 0.95330274, 'binary_precision': 0.657, 'binary_recall': 0.4559334, 'binary_specificity': 0.99190253, 'binary_f1_score': 0.538304}
confusion matrix:
       0    1
0  42016  343
1    784  657
---- Validation: 
scalar performance:
{'acc': 0.9728388, 'precision': 0.85779774, 'recall': 0.68621653, 'specificity': 0.68621653, 'f1': 0.7427745, 'auroc': 0.94525826, 'binary_precision': 0.7383721, 'binary_recall': 0.37741455, 'binary_specificity': 0.99501854, 'binary_f1_score': 0.49950832}
confusion matrix:
       0    1
0  17977   90
1    419  254
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96052206, 'precision': 0.9802132, 'recall': 0.52884614, 'specificity': 0.52884614, 'f1': 0.54445237, 'auroc': 0.88575155, 'binary_precision': 1.0, 'binary_recall': 0.057692308, 'binary_specificity': 1.0, 'binary_f1_score': 0.10909091}
confusion matrix:
      0   1
0  5946   0
1   245  15
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329044_21.png
better model found
persisted
after epoch: 21,now: 2024-06-17 15:11:42.472797,epoch time: 0:16:40.138970,used: 5:22:22.860476,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_49_19_seed_1_21329044
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9734475, 'precision': 0.79725826, 'recall': 0.76020026, 'specificity': 0.76020026, 'f1': 0.7773812, 'auroc': 0.95369357, 'binary_precision': 0.61035854, 'binary_recall': 0.53194445, 'binary_specificity': 0.9884561, 'binary_f1_score': 0.5684601}
confusion matrix:
       0    1
0  41871  489
1    674  766
---- Validation: 
scalar performance:
{'acc': 0.9719317, 'precision': 0.818679, 'recall': 0.7236552, 'specificity': 0.7236552, 'f1': 0.762061, 'auroc': 0.9456625, 'binary_precision': 0.65738755, 'binary_recall': 0.45616642, 'binary_specificity': 0.99114406, 'binary_f1_score': 0.53859645}
confusion matrix:
       0    1
0  17907  160
1    366  307
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9656784, 'precision': 0.9725797, 'recall': 0.5922236, 'specificity': 0.5922236, 'f1': 0.64654034, 'auroc': 0.89133435, 'binary_precision': 0.97959185, 'binary_recall': 0.18461539, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.31067964}
confusion matrix:
      0   1
0  5945   1
1   212  48
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329044_22.png
early stop counter: 1
val acc:0.9719316959381104, best validation acc: 0.972838819026947, corresponding to test acc:                         0.9605220556259155 / 0.9730905294418335
after epoch: 22,now: 2024-06-17 15:28:15.639749,epoch time: 0:16:33.166952,used: 5:38:56.027428,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_49_19_seed_1_21329044
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9734247, 'precision': 0.79891837, 'recall': 0.75297683, 'specificity': 0.75297683, 'f1': 0.77385694, 'auroc': 0.9513179, 'binary_precision': 0.61417973, 'binary_recall': 0.5170021, 'binary_specificity': 0.98895156, 'binary_f1_score': 0.56141675}
confusion matrix:
       0    1
0  41891  468
1    696  745
---- Validation: 
scalar performance:
{'acc': 0.9723586, 'precision': 0.8287554, 'recall': 0.7152934, 'specificity': 0.7152934, 'f1': 0.75912464, 'auroc': 0.94540733, 'binary_precision': 0.6781609, 'binary_recall': 0.4383358, 'binary_specificity': 0.99225104, 'binary_f1_score': 0.532491}
confusion matrix:
       0    1
0  17927  140
1    378  295
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9619723, 'precision': 0.9617562, 'recall': 0.5479928, 'specificity': 0.5479928, 'f1': 0.5776814, 'auroc': 0.8861408, 'binary_precision': 0.96153843, 'binary_recall': 0.09615385, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.17482518}
confusion matrix:
      0   1
0  5945   1
1   235  25
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329044_23.png
early stop counter: 2
val acc:0.9723585844039917, best validation acc: 0.972838819026947, corresponding to test acc:                         0.9605220556259155 / 0.9730905294418335
after epoch: 23,now: 2024-06-17 15:44:55.457960,epoch time: 0:16:39.818211,used: 5:55:35.845639,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_49_19_seed_1_21329044
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9730137, 'precision': 0.7922328, 'recall': 0.762324, 'specificity': 0.762324, 'f1': 0.77639437, 'auroc': 0.9497354, 'binary_precision': 0.6001553, 'binary_recall': 0.53680557, 'binary_specificity': 0.9878423, 'binary_f1_score': 0.56671554}
confusion matrix:
       0    1
0  41845  515
1    667  773
---- Validation: 
scalar performance:
{'acc': 0.9726788, 'precision': 0.82308877, 'recall': 0.73620224, 'specificity': 0.73620224, 'f1': 0.77226186, 'auroc': 0.9463958, 'binary_precision': 0.66529775, 'binary_recall': 0.48142645, 'binary_specificity': 0.990978, 'binary_f1_score': 0.5586207}
confusion matrix:
       0    1
0  17904  163
1    349  324
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9619723, 'precision': 0.9809123, 'recall': 0.54615384, 'specificity': 0.54615384, 'f1': 0.5747775, 'auroc': 0.8825859, 'binary_precision': 1.0, 'binary_recall': 0.092307694, 'binary_specificity': 1.0, 'binary_f1_score': 0.1690141}
confusion matrix:
      0   1
0  5946   0
1   236  24
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329044_24.png
early stop counter: 3
val acc:0.9726787805557251, best validation acc: 0.972838819026947, corresponding to test acc:                         0.9605220556259155 / 0.9730905294418335
after epoch: 24,now: 2024-06-17 16:01:08.572448,epoch time: 0:16:13.114488,used: 6:11:48.960127,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_49_19_seed_1_21329044
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9733562, 'precision': 0.7945166, 'recall': 0.76936513, 'specificity': 0.76936513, 'f1': 0.781326, 'auroc': 0.95301205, 'binary_precision': 0.6042618, 'binary_recall': 0.55100626, 'binary_specificity': 0.987724, 'binary_f1_score': 0.57640654}
confusion matrix:
       0    1
0  41839  520
1    647  794
---- Validation: 
scalar performance:
{'acc': 0.9728388, 'precision': 0.8186739, 'recall': 0.75202113, 'specificity': 0.75202113, 'f1': 0.78107816, 'auroc': 0.946224, 'binary_precision': 0.655303, 'binary_recall': 0.51411587, 'binary_specificity': 0.9899264, 'binary_f1_score': 0.5761865}
confusion matrix:
       0    1
0  17885  182
1    327  346
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9648727, 'precision': 0.951293, 'recall': 0.5862862, 'specificity': 0.5862862, 'f1': 0.6370986, 'auroc': 0.8842219, 'binary_precision': 0.9375, 'binary_recall': 0.17307693, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.2922078}
confusion matrix:
      0   1
0  5943   3
1   215  45
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329044_25.png
early stop counter: 4
val acc:0.972838819026947, best validation acc: 0.972838819026947, corresponding to test acc:                         0.9605220556259155 / 0.9730905294418335
after epoch: 25,now: 2024-06-17 16:17:13.939242,epoch time: 0:16:05.366794,used: 6:27:54.326921,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_49_19_seed_1_21329044
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.97253424, 'precision': 0.78776526, 'recall': 0.7600635, 'specificity': 0.7600635, 'f1': 0.7731459, 'auroc': 0.950799, 'binary_precision': 0.5913647, 'binary_recall': 0.5326389, 'binary_specificity': 0.9874882, 'binary_f1_score': 0.56046766}
confusion matrix:
       0    1
0  41830  530
1    673  767
---- Validation: 
scalar performance:
{'acc': 0.9727855, 'precision': 0.82543504, 'recall': 0.7341118, 'specificity': 0.7341118, 'f1': 0.7716265, 'auroc': 0.94437087, 'binary_precision': 0.67014617, 'binary_recall': 0.4769688, 'binary_specificity': 0.99125475, 'binary_f1_score': 0.5572917}
confusion matrix:
       0    1
0  17909  158
1    352  321
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95939416, 'precision': 0.92974496, 'recall': 0.5172236, 'specificity': 0.5172236, 'f1': 0.52295613, 'auroc': 0.88948303, 'binary_precision': 0.9, 'binary_recall': 0.034615386, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.06666667}
confusion matrix:
      0  1
0  5945  1
1   251  9
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329044_26.png
early stop counter: 5
val acc:0.972785472869873, best validation acc: 0.972838819026947, corresponding to test acc:                         0.9605220556259155 / 0.9730905294418335
after epoch: 26,now: 2024-06-17 16:32:10.474676,epoch time: 0:14:56.535434,used: 6:42:50.862355,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_49_19_seed_1_21329044
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.97378993, 'precision': 0.81780016, 'recall': 0.71180093, 'specificity': 0.71180093, 'f1': 0.753297, 'auroc': 0.9523388, 'binary_precision': 0.6547368, 'binary_recall': 0.43134534, 'binary_specificity': 0.99225646, 'binary_f1_score': 0.52006686}
confusion matrix:
       0    1
0  42030  328
1    820  622
---- Validation: 
scalar performance:
{'acc': 0.97203845, 'precision': 0.8457954, 'recall': 0.68150985, 'specificity': 0.68150985, 'f1': 0.7359513, 'auroc': 0.94531286, 'binary_precision': 0.7146974, 'binary_recall': 0.36849925, 'binary_specificity': 0.9945204, 'binary_f1_score': 0.48627454}
confusion matrix:
       0    1
0  17968   99
1    425  248
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96036094, 'precision': 0.9801357, 'recall': 0.52692306, 'specificity': 0.52692306, 'f1': 0.54096144, 'auroc': 0.8780066, 'binary_precision': 1.0, 'binary_recall': 0.053846154, 'binary_specificity': 1.0, 'binary_f1_score': 0.10218979}
confusion matrix:
      0   1
0  5946   0
1   246  14
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329044_27.png
early stop counter: 6
val acc:0.9720384478569031, best validation acc: 0.972838819026947, corresponding to test acc:                         0.9605220556259155 / 0.9730905294418335
after epoch: 27,now: 2024-06-17 16:47:54.175280,epoch time: 0:15:43.700604,used: 6:58:34.562959,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_49_19_seed_1_21329044
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9736758, 'precision': 0.8258932, 'recall': 0.6906741, 'specificity': 0.6906741, 'f1': 0.7391673, 'auroc': 0.9496217, 'binary_precision': 0.67228913, 'binary_recall': 0.38776928, 'binary_specificity': 0.993579, 'binary_f1_score': 0.49184665}
confusion matrix:
       0    1
0  42089  272
1    881  558
---- Validation: 
scalar performance:
{'acc': 0.9713447, 'precision': 0.85636353, 'recall': 0.65468514, 'specificity': 0.65468514, 'f1': 0.71266896, 'auroc': 0.94254494, 'binary_precision': 0.7377622, 'binary_recall': 0.31352153, 'binary_specificity': 0.9958488, 'binary_f1_score': 0.44004172}
confusion matrix:
       0    1
0  17992   75
1    462  211
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589107, 'precision': 0.9794388, 'recall': 0.50961536, 'specificity': 0.50961536, 'f1': 0.50837153, 'auroc': 0.8847575, 'binary_precision': 1.0, 'binary_recall': 0.01923077, 'binary_specificity': 1.0, 'binary_f1_score': 0.037735853}
confusion matrix:
      0  1
0  5946  0
1   255  5
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329044_28.png
early stop counter: 7
val acc:0.9713447093963623, best validation acc: 0.972838819026947, corresponding to test acc:                         0.9605220556259155 / 0.9730905294418335
after epoch: 28,now: 2024-06-17 17:03:14.412118,epoch time: 0:15:20.236838,used: 7:13:54.799797,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_49_19_seed_1_21329044
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9724201, 'precision': 0.7860689, 'recall': 0.7633587, 'specificity': 0.7633587, 'f1': 0.7741985, 'auroc': 0.9509811, 'binary_precision': 0.58774585, 'binary_recall': 0.5395833, 'binary_specificity': 0.9871341, 'binary_f1_score': 0.56263584}
confusion matrix:
       0    1
0  41815  545
1    663  777
---- Validation: 
scalar performance:
{'acc': 0.9725187, 'precision': 0.8165312, 'recall': 0.7475635, 'specificity': 0.7475635, 'f1': 0.7774222, 'auroc': 0.9463749, 'binary_precision': 0.651341, 'binary_recall': 0.50520056, 'binary_specificity': 0.9899264, 'binary_f1_score': 0.5690376}
confusion matrix:
       0    1
0  17885  182
1    333  340
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9622946, 'precision': 0.9632856, 'recall': 0.551839, 'specificity': 0.551839, 'f1': 0.5840997, 'auroc': 0.89026105, 'binary_precision': 0.96428573, 'binary_recall': 0.103846155, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.1875}
confusion matrix:
      0   1
0  5945   1
1   233  27
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329044_29.png
early stop counter: 8
val acc:0.9725186824798584, best validation acc: 0.972838819026947, corresponding to test acc:                         0.9605220556259155 / 0.9730905294418335
after epoch: 29,now: 2024-06-17 17:19:39.121417,epoch time: 0:16:24.709299,used: 7:30:19.509096,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_49_19_seed_1_21329044
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9732648, 'precision': 0.82610595, 'recall': 0.67826366, 'specificity': 0.67826366, 'f1': 0.72880876, 'auroc': 0.9525664, 'binary_precision': 0.6735484, 'binary_recall': 0.3625, 'binary_specificity': 0.9940274, 'binary_f1_score': 0.47133186}
confusion matrix:
       0    1
0  42107  253
1    918  522
---- Validation: 
scalar performance:
{'acc': 0.9703842, 'precision': 0.84251857, 'recall': 0.64560384, 'specificity': 0.64560384, 'f1': 0.7012172, 'auroc': 0.9410294, 'binary_precision': 0.7107143, 'binary_recall': 0.29569092, 'binary_specificity': 0.9955167, 'binary_f1_score': 0.41762853}
confusion matrix:
       0    1
0  17986   81
1    474  199
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590719, 'precision': 0.97951615, 'recall': 0.51153845, 'specificity': 0.51153845, 'f1': 0.5121002, 'auroc': 0.8805365, 'binary_precision': 1.0, 'binary_recall': 0.023076924, 'binary_specificity': 1.0, 'binary_f1_score': 0.045112785}
confusion matrix:
      0  1
0  5946  0
1   254  6
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329044_30.png
early stop counter: 9
val acc:0.9703841805458069, best validation acc: 0.972838819026947, corresponding to test acc:                         0.9605220556259155 / 0.9730905294418335
after epoch: 30,now: 2024-06-17 17:36:16.576024,epoch time: 0:16:37.454607,used: 7:46:56.963703,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_49_19_seed_1_21329044
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 7:46:56.963703 at 2024-06-17 17:36:16.576024
persisted model performance metric: 

scalar performance:
{'acc': 0.96052206, 'precision': 0.9802132, 'recall': 0.52884614, 'specificity': 0.52884614, 'f1': 0.54445237, 'auroc': 0.88575155, 'binary_precision': 1.0, 'binary_recall': 0.057692308, 'binary_specificity': 1.0, 'binary_f1_score': 0.10909091}
confusion matrix:
      0   1
0  5946   0
1   245  15
oracle model performance metric: 

scalar performance:
{'acc': 0.9730905, 'precision': 0.9668483, 'recall': 0.6862021, 'specificity': 0.6862021, 'f1': 0.7617692, 'auroc': 0.8975258, 'binary_precision': 0.96039605, 'binary_recall': 0.37307692, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.53739613}
confusion matrix:
      0   1
0  5942   4
1   163  97
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre3/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre3/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204178 KiB |   1436 MiB |    790 TiB |    790 TiB |
|       from large pool | 167936 KiB |   1366 MiB |    790 TiB |    790 TiB |
|       from small pool |  36242 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 204178 KiB |   1436 MiB |    790 TiB |    790 TiB |
|       from large pool | 167936 KiB |   1366 MiB |    790 TiB |    790 TiB |
|       from small pool |  36242 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201086 KiB |   1428 MiB |    790 TiB |    790 TiB |
|       from large pool | 165120 KiB |   1358 MiB |    790 TiB |    790 TiB |
|       from small pool |  35966 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1466 MiB |   1524 MiB |   2478 MiB |   1012 MiB |
|       from large pool |   1392 MiB |   1450 MiB |   2374 MiB |    982 MiB |
|       from small pool |     74 MiB |     74 MiB |    104 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 320109 KiB | 749313 KiB | 617915 GiB | 617915 GiB |
|       from large pool | 311296 KiB | 748328 KiB | 617754 GiB | 617753 GiB |
|       from small pool |   8813 KiB |  16408 KiB |    161 GiB |    161 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1278    |    1935    |   26699 K  |   26698 K  |
|       from large pool |      36    |      76    |   10623 K  |   10623 K  |
|       from small pool |    1242    |    1864    |   16076 K  |   16074 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1278    |    1935    |   26699 K  |   26698 K  |
|       from large pool |      36    |      76    |   10623 K  |   10623 K  |
|       from small pool |    1242    |    1864    |   16076 K  |   16074 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      49    |      50    |      68    |      19    |
|       from large pool |      12    |      13    |      16    |       4    |
|       from small pool |      37    |      37    |      52    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      36    |     453    |   15140 K  |   15140 K  |
|       from large pool |       5    |      11    |    4127 K  |    4127 K  |
|       from small pool |      31    |     448    |   11012 K  |   11012 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1436 MiB |    790 TiB |    790 TiB |
|       from large pool |  16640 KiB |   1366 MiB |    790 TiB |    790 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1436 MiB |    790 TiB |    790 TiB |
|       from large pool |  16640 KiB |   1366 MiB |    790 TiB |    790 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1428 MiB |    790 TiB |    790 TiB |
|       from large pool |  16640 KiB |   1358 MiB |    790 TiB |    790 TiB |
|       from small pool |      0 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 524288 KiB |   1524 MiB |   2478 MiB |   1966 MiB |
|       from large pool | 479232 KiB |   1450 MiB |   2374 MiB |   1906 MiB |
|       from small pool |  45056 KiB |     74 MiB |    104 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 298752 KiB | 749313 KiB | 617915 GiB | 617915 GiB |
|       from large pool | 298752 KiB | 748328 KiB | 617754 GiB | 617753 GiB |
|       from small pool |      0 KiB |  16408 KiB |    161 GiB |    161 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1935    |   26699 K  |   26699 K  |
|       from large pool |       2    |      76    |   10623 K  |   10623 K  |
|       from small pool |       0    |    1864    |   16076 K  |   16076 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1935    |   26699 K  |   26699 K  |
|       from large pool |       2    |      76    |   10623 K  |   10623 K  |
|       from small pool |       0    |    1864    |   16076 K  |   16076 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      50    |      68    |      37    |
|       from large pool |       9    |      13    |      16    |       7    |
|       from small pool |      22    |      37    |      52    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     453    |   15140 K  |   15140 K  |
|       from large pool |       1    |      11    |    4127 K  |    4127 K  |
|       from small pool |       0    |     448    |   11012 K  |   11012 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1436 MiB |    790 TiB |    790 TiB |
|       from large pool |  16640 KiB |   1366 MiB |    790 TiB |    790 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1436 MiB |    790 TiB |    790 TiB |
|       from large pool |  16640 KiB |   1366 MiB |    790 TiB |    790 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1428 MiB |    790 TiB |    790 TiB |
|       from large pool |  16640 KiB |   1358 MiB |    790 TiB |    790 TiB |
|       from small pool |      0 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 524288 KiB |   1524 MiB |   2478 MiB |   1966 MiB |
|       from large pool | 479232 KiB |   1450 MiB |   2374 MiB |   1906 MiB |
|       from small pool |  45056 KiB |     74 MiB |    104 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 298752 KiB | 749313 KiB | 617915 GiB | 617915 GiB |
|       from large pool | 298752 KiB | 748328 KiB | 617754 GiB | 617753 GiB |
|       from small pool |      0 KiB |  16408 KiB |    161 GiB |    161 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1935    |   26699 K  |   26699 K  |
|       from large pool |       2    |      76    |   10623 K  |   10623 K  |
|       from small pool |       0    |    1864    |   16076 K  |   16076 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1935    |   26699 K  |   26699 K  |
|       from large pool |       2    |      76    |   10623 K  |   10623 K  |
|       from small pool |       0    |    1864    |   16076 K  |   16076 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      50    |      68    |      37    |
|       from large pool |       9    |      13    |      16    |       7    |
|       from small pool |      22    |      37    |      52    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     453    |   15140 K  |   15140 K  |
|       from large pool |       1    |      11    |    4127 K  |    4127 K  |
|       from small pool |       0    |     448    |   11012 K  |   11012 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0




!!!: not committed yet



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_17_44_17_seed_2_21329044

 Experiment start at: 2024-06-17 17:44:17.529941
before training, model accuracy: 0.0544959120452404
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96627855, 'precision': 0.74679625, 'recall': 0.69619644, 'specificity': 0.69619644, 'f1': 0.71828806, 'auroc': 0.92755985, 'binary_precision': 0.5146689, 'binary_recall': 0.40608466, 'binary_specificity': 0.98630816, 'binary_f1_score': 0.45397413}
confusion matrix:
       0    1
0  41709  579
1    898  614
---- Validation: 
scalar performance:
{'acc': 0.9676663, 'precision': 0.73657453, 'recall': 0.67251784, 'specificity': 0.67251784, 'f1': 0.69901586, 'auroc': 0.92149615, 'binary_precision': 0.49425286, 'binary_recall': 0.35714287, 'binary_specificity': 0.9878928, 'binary_f1_score': 0.41465768}
confusion matrix:
       0    1
0  17951  220
1    387  215
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9764385, 'precision': 0.9453362, 'recall': 0.7161084, 'specificity': 0.7161084, 'f1': 0.7880538, 'auroc': 0.89292115, 'binary_precision': 0.9130435, 'binary_recall': 0.4338843, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.5882353}
confusion matrix:
      0    1
0  5987   10
1   137  105
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329044_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-17 18:00:17.123237,epoch time: 0:15:59.593296,used: 0:15:59.593296,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_17_44_17_seed_2_21329044
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9686758, 'precision': 0.77934945, 'recall': 0.65831333, 'specificity': 0.65831333, 'f1': 0.7005338, 'auroc': 0.93450385, 'binary_precision': 0.58244365, 'binary_recall': 0.32495037, 'binary_specificity': 0.99167633, 'binary_f1_score': 0.41716227}
confusion matrix:
       0    1
0  41937  352
1   1020  491
---- Validation: 
scalar performance:
{'acc': 0.9696373, 'precision': 0.80850124, 'recall': 0.557897, 'specificity': 0.557897, 'f1': 0.5919817, 'auroc': 0.9227762, 'binary_precision': 0.6454545, 'binary_recall': 0.1179402, 'binary_specificity': 0.9978537, 'binary_f1_score': 0.19943821}
confusion matrix:
       0   1
0  18132  39
1    531  71
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9632954, 'precision': 0.98160934, 'recall': 0.5268595, 'specificity': 0.5268595, 'f1': 0.5416128, 'auroc': 0.8627916, 'binary_precision': 1.0, 'binary_recall': 0.053719006, 'binary_specificity': 1.0, 'binary_f1_score': 0.10196078}
confusion matrix:
      0   1
0  5997   0
1   229  13
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329044_2.png
better model found
persisted
after epoch: 2,now: 2024-06-17 18:16:49.998439,epoch time: 0:16:32.875202,used: 0:32:32.468498,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_17_44_17_seed_2_21329044
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9693607, 'precision': 0.78900236, 'recall': 0.66357505, 'specificity': 0.66357505, 'f1': 0.70732373, 'auroc': 0.94028413, 'binary_precision': 0.6014235, 'binary_recall': 0.33509582, 'binary_specificity': 0.9920543, 'binary_f1_score': 0.4303905}
confusion matrix:
       0    1
0  41951  336
1   1006  507
---- Validation: 
scalar performance:
{'acc': 0.9702765, 'precision': 0.80290985, 'recall': 0.5855308, 'specificity': 0.5855308, 'f1': 0.6291327, 'auroc': 0.9296007, 'binary_precision': 0.6325301, 'binary_recall': 0.1744186, 'binary_specificity': 0.996643, 'binary_f1_score': 0.2734375}
confusion matrix:
       0    1
0  18110   61
1    497  105
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9632954, 'precision': 0.98160934, 'recall': 0.5268595, 'specificity': 0.5268595, 'f1': 0.5416128, 'auroc': 0.88046366, 'binary_precision': 1.0, 'binary_recall': 0.053719006, 'binary_specificity': 1.0, 'binary_f1_score': 0.10196078}
confusion matrix:
      0   1
0  5997   0
1   229  13
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329044_3.png
better model found
persisted
after epoch: 3,now: 2024-06-17 18:38:25.223385,epoch time: 0:21:35.224946,used: 0:54:07.693444,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_17_44_17_seed_2_21329044
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.970137, 'precision': 0.7785972, 'recall': 0.75399584, 'specificity': 0.75399584, 'f1': 0.76566863, 'auroc': 0.94820595, 'binary_precision': 0.5742358, 'binary_recall': 0.5218254, 'binary_specificity': 0.9861663, 'binary_f1_score': 0.5467775}
confusion matrix:
       0    1
0  41703  585
1    723  789
---- Validation: 
scalar performance:
{'acc': 0.97128856, 'precision': 0.7795507, 'recall': 0.6864347, 'specificity': 0.6864347, 'f1': 0.72285616, 'auroc': 0.93699825, 'binary_precision': 0.5793451, 'binary_recall': 0.3820598, 'binary_specificity': 0.99080956, 'binary_f1_score': 0.46046048}
confusion matrix:
       0    1
0  18004  167
1    372  230
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9692258, 'precision': 0.9844886, 'recall': 0.6033058, 'specificity': 0.6033058, 'f1': 0.663355, 'auroc': 0.8858937, 'binary_precision': 1.0, 'binary_recall': 0.20661157, 'binary_specificity': 1.0, 'binary_f1_score': 0.34246573}
confusion matrix:
      0   1
0  5997   0
1   192  50
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329044_4.png
better model found
persisted
after epoch: 4,now: 2024-06-17 19:00:04.069178,epoch time: 0:21:38.845793,used: 1:15:46.539237,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_17_44_17_seed_2_21329044
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97018266, 'precision': 0.79078925, 'recall': 0.6950296, 'specificity': 0.6950296, 'f1': 0.73257995, 'auroc': 0.94805264, 'binary_precision': 0.6027944, 'binary_recall': 0.3994709, 'binary_specificity': 0.99058837, 'binary_f1_score': 0.48050913}
confusion matrix:
       0    1
0  41890  398
1    908  604
---- Validation: 
scalar performance:
{'acc': 0.97134185, 'precision': 0.782992, 'recall': 0.67521954, 'specificity': 0.67521954, 'f1': 0.71532583, 'auroc': 0.93844235, 'binary_precision': 0.5869565, 'binary_recall': 0.358804, 'binary_specificity': 0.991635, 'binary_f1_score': 0.4453608}
confusion matrix:
       0    1
0  18019  152
1    386  216
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9716301, 'precision': 0.9856657, 'recall': 0.6342975, 'specificity': 0.6342975, 'f1': 0.704455, 'auroc': 0.8894569, 'binary_precision': 1.0, 'binary_recall': 0.26859504, 'binary_specificity': 1.0, 'binary_f1_score': 0.4234528}
confusion matrix:
      0   1
0  5997   0
1   177  65
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329044_5.png
better model found
persisted
after epoch: 5,now: 2024-06-17 19:15:59.245431,epoch time: 0:15:55.176253,used: 1:31:41.715490,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_17_44_17_seed_2_21329044
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9717352, 'precision': 0.8202679, 'recall': 0.68169296, 'specificity': 0.68169296, 'f1': 0.73022777, 'auroc': 0.9475312, 'binary_precision': 0.6627219, 'binary_recall': 0.3701256, 'binary_specificity': 0.9932603, 'binary_f1_score': 0.47497883}
confusion matrix:
       0    1
0  42002  285
1    953  560
---- Validation: 
scalar performance:
{'acc': 0.97208756, 'precision': 0.8219974, 'recall': 0.62661874, 'specificity': 0.62661874, 'f1': 0.6787147, 'auroc': 0.93577325, 'binary_precision': 0.66810346, 'binary_recall': 0.25747508, 'binary_specificity': 0.99576247, 'binary_f1_score': 0.37170264}
confusion matrix:
       0    1
0  18094   77
1    447  155
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9634557, 'precision': 0.9816867, 'recall': 0.5289256, 'specificity': 0.5289256, 'f1': 0.5453601, 'auroc': 0.87772155, 'binary_precision': 1.0, 'binary_recall': 0.05785124, 'binary_specificity': 1.0, 'binary_f1_score': 0.10937501}
confusion matrix:
      0   1
0  5997   0
1   228  14
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329044_6.png
better model found
persisted
after epoch: 6,now: 2024-06-17 19:37:25.907075,epoch time: 0:21:26.661644,used: 1:53:08.377134,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_17_44_17_seed_2_21329044
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97152966, 'precision': 0.8179158, 'recall': 0.67776805, 'specificity': 0.67776805, 'f1': 0.7263478, 'auroc': 0.949741, 'binary_precision': 0.65824306, 'binary_recall': 0.36225167, 'binary_specificity': 0.99328446, 'binary_f1_score': 0.46732166}
confusion matrix:
       0    1
0  42006  284
1    963  547
---- Validation: 
scalar performance:
{'acc': 0.97240716, 'precision': 0.84688914, 'recall': 0.61313206, 'specificity': 0.61313206, 'f1': 0.6667563, 'auroc': 0.9377105, 'binary_precision': 0.71875, 'binary_recall': 0.22923589, 'binary_specificity': 0.99702823, 'binary_f1_score': 0.34760708}
confusion matrix:
       0    1
0  18117   54
1    464  138
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9623337, 'precision': 0.98114574, 'recall': 0.5144628, 'specificity': 0.5144628, 'f1': 0.51850414, 'auroc': 0.8777546, 'binary_precision': 1.0, 'binary_recall': 0.02892562, 'binary_specificity': 1.0, 'binary_f1_score': 0.056224898}
confusion matrix:
      0  1
0  5997  0
1   235  7
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329044_7.png
better model found
persisted
after epoch: 7,now: 2024-06-17 20:00:54.104092,epoch time: 0:23:28.197017,used: 2:16:36.574151,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_17_44_17_seed_2_21329044
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9716667, 'precision': 0.8091077, 'recall': 0.7018566, 'specificity': 0.7018566, 'f1': 0.74321234, 'auroc': 0.9506575, 'binary_precision': 0.63897437, 'binary_recall': 0.41203704, 'binary_specificity': 0.99167615, 'binary_f1_score': 0.50100523}
confusion matrix:
       0    1
0  41936  352
1    889  623
---- Validation: 
scalar performance:
{'acc': 0.9717147, 'precision': 0.7996071, 'recall': 0.6473054, 'specificity': 0.6473054, 'f1': 0.6954439, 'auroc': 0.93947196, 'binary_precision': 0.6219931, 'binary_recall': 0.30066445, 'binary_specificity': 0.9939464, 'binary_f1_score': 0.40537512}
confusion matrix:
       0    1
0  18061  110
1    421  181
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9648982, 'precision': 0.96245897, 'recall': 0.5495034, 'specificity': 0.5495034, 'f1': 0.5809203, 'auroc': 0.88619626, 'binary_precision': 0.96, 'binary_recall': 0.09917355, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.17977527}
confusion matrix:
      0   1
0  5996   1
1   218  24
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329044_8.png
early stop counter: 1
val acc:0.9717146754264832, best validation acc: 0.9724071621894836, corresponding to test acc:                         0.9623336791992188 / 0.9764385223388672
after epoch: 8,now: 2024-06-17 20:21:18.067041,epoch time: 0:20:23.962949,used: 2:37:00.537100,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_17_44_17_seed_2_21329044
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.97121006, 'precision': 0.8187247, 'recall': 0.66642696, 'specificity': 0.66642696, 'f1': 0.71667975, 'auroc': 0.9516008, 'binary_precision': 0.6606452, 'binary_recall': 0.33907285, 'binary_specificity': 0.99378103, 'binary_f1_score': 0.44814003}
confusion matrix:
       0    1
0  42027  263
1    998  512
---- Validation: 
scalar performance:
{'acc': 0.97230065, 'precision': 0.8294148, 'recall': 0.6251228, 'specificity': 0.6251228, 'f1': 0.6781494, 'auroc': 0.93548506, 'binary_precision': 0.68303573, 'binary_recall': 0.25415283, 'binary_specificity': 0.9960927, 'binary_f1_score': 0.37046006}
confusion matrix:
       0    1
0  18100   71
1    449  153
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9634557, 'precision': 0.9505112, 'recall': 0.53090835, 'specificity': 0.53090835, 'f1': 0.5488106, 'auroc': 0.8893064, 'binary_precision': 0.9375, 'binary_recall': 0.06198347, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.116279066}
confusion matrix:
      0   1
0  5996   1
1   227  15
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329044_9.png
early stop counter: 2
val acc:0.97230064868927, best validation acc: 0.9724071621894836, corresponding to test acc:                         0.9623336791992188 / 0.9764385223388672
after epoch: 9,now: 2024-06-17 20:37:21.412779,epoch time: 0:16:03.345738,used: 2:53:03.882838,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_17_44_17_seed_2_21329044
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.97212327, 'precision': 0.7965515, 'recall': 0.7621926, 'specificity': 0.7621926, 'f1': 0.77820987, 'auroc': 0.9516284, 'binary_precision': 0.6096096, 'binary_recall': 0.53668207, 'binary_specificity': 0.9877031, 'binary_f1_score': 0.570826}
confusion matrix:
       0    1
0  41767  520
1    701  812
---- Validation: 
scalar performance:
{'acc': 0.97331274, 'precision': 0.8263607, 'recall': 0.6593736, 'specificity': 0.6593736, 'f1': 0.71202123, 'auroc': 0.93935907, 'binary_precision': 0.6747405, 'binary_recall': 0.32392028, 'binary_specificity': 0.9948269, 'binary_f1_score': 0.43771043}
confusion matrix:
       0    1
0  18077   94
1    407  195
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9648982, 'precision': 0.9823842, 'recall': 0.54752064, 'specificity': 0.54752064, 'f1': 0.57782656, 'auroc': 0.8892399, 'binary_precision': 1.0, 'binary_recall': 0.09504132, 'binary_specificity': 1.0, 'binary_f1_score': 0.17358491}
confusion matrix:
      0   1
0  5997   0
1   219  23
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329044_10.png
better model found
persisted
after epoch: 10,now: 2024-06-17 20:58:50.544954,epoch time: 0:21:29.132175,used: 3:14:33.015013,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_17_44_17_seed_2_21329044
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.97164387, 'precision': 0.83662546, 'recall': 0.6558354, 'specificity': 0.6558354, 'f1': 0.71045566, 'auroc': 0.95164835, 'binary_precision': 0.69723433, 'binary_recall': 0.31658956, 'binary_specificity': 0.99508125, 'binary_f1_score': 0.43545458}
confusion matrix:
       0    1
0  42079  208
1   1034  479
---- Validation: 
scalar performance:
{'acc': 0.97235394, 'precision': 0.8270817, 'recall': 0.62916553, 'specificity': 0.62916553, 'f1': 0.6821528, 'auroc': 0.93857956, 'binary_precision': 0.6781116, 'binary_recall': 0.26245847, 'binary_specificity': 0.99587256, 'binary_f1_score': 0.3784431}
confusion matrix:
       0    1
0  18096   75
1    444  158
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9634557, 'precision': 0.9505112, 'recall': 0.53090835, 'specificity': 0.53090835, 'f1': 0.5488106, 'auroc': 0.8897519, 'binary_precision': 0.9375, 'binary_recall': 0.06198347, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.116279066}
confusion matrix:
      0   1
0  5996   1
1   227  15
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329044_11.png
early stop counter: 1
val acc:0.9723539352416992, best validation acc: 0.9733127355575562, corresponding to test acc:                         0.9648982286453247 / 0.9764385223388672
after epoch: 11,now: 2024-06-17 21:21:06.278279,epoch time: 0:22:15.733325,used: 3:36:48.748338,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_17_44_17_seed_2_21329044
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9729452, 'precision': 0.8259473, 'recall': 0.70781124, 'specificity': 0.70781124, 'f1': 0.7526754, 'auroc': 0.951339, 'binary_precision': 0.6722689, 'binary_recall': 0.42300066, 'binary_specificity': 0.99262184, 'binary_f1_score': 0.5192698}
confusion matrix:
       0    1
0  41975  312
1    873  640
---- Validation: 
scalar performance:
{'acc': 0.97278005, 'precision': 0.82257116, 'recall': 0.64785576, 'specificity': 0.64785576, 'f1': 0.70036405, 'auroc': 0.938125, 'binary_precision': 0.6678967, 'binary_recall': 0.30066445, 'binary_specificity': 0.99504703, 'binary_f1_score': 0.41466206}
confusion matrix:
       0    1
0  18081   90
1    421  181
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96281457, 'precision': 0.9813774, 'recall': 0.5206612, 'specificity': 0.5206612, 'f1': 0.5301945, 'auroc': 0.8802024, 'binary_precision': 1.0, 'binary_recall': 0.041322313, 'binary_specificity': 1.0, 'binary_f1_score': 0.079365075}
confusion matrix:
      0   1
0  5997   0
1   232  10
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329044_12.png
early stop counter: 2
val acc:0.9727800488471985, best validation acc: 0.9733127355575562, corresponding to test acc:                         0.9648982286453247 / 0.9764385223388672
after epoch: 12,now: 2024-06-17 21:44:27.513277,epoch time: 0:23:21.234998,used: 4:00:09.983336,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_17_44_17_seed_2_21329044
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.97150683, 'precision': 0.815716, 'recall': 0.6828493, 'specificity': 0.6828493, 'f1': 0.7300518, 'auroc': 0.9522339, 'binary_precision': 0.6535342, 'binary_recall': 0.37276933, 'binary_specificity': 0.9929293, 'binary_f1_score': 0.47474745}
confusion matrix:
       0    1
0  41988  299
1    949  564
---- Validation: 
scalar performance:
{'acc': 0.97219414, 'precision': 0.8263912, 'recall': 0.6250677, 'specificity': 0.6250677, 'f1': 0.67767435, 'auroc': 0.93982506, 'binary_precision': 0.67699116, 'binary_recall': 0.25415283, 'binary_specificity': 0.9959826, 'binary_f1_score': 0.36956522}
confusion matrix:
       0    1
0  18098   73
1    449  153
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9620131, 'precision': 0.98099136, 'recall': 0.51033056, 'specificity': 0.51033056, 'f1': 0.5105544, 'auroc': 0.87543994, 'binary_precision': 1.0, 'binary_recall': 0.020661157, 'binary_specificity': 1.0, 'binary_f1_score': 0.04048583}
confusion matrix:
      0  1
0  5997  0
1   237  5
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329044_13.png
early stop counter: 3
val acc:0.9721941351890564, best validation acc: 0.9733127355575562, corresponding to test acc:                         0.9648982286453247 / 0.9764385223388672
after epoch: 13,now: 2024-06-17 22:07:22.742979,epoch time: 0:22:55.229702,used: 4:23:05.213038,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_17_44_17_seed_2_21329044
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9714612, 'precision': 0.7859303, 'recall': 0.7859303, 'specificity': 0.7859303, 'f1': 0.7859303, 'auroc': 0.9502288, 'binary_precision': 0.58664024, 'binary_recall': 0.58664024, 'binary_specificity': 0.9852204, 'binary_f1_score': 0.58664024}
confusion matrix:
       0    1
0  41663  625
1    625  887
---- Validation: 
scalar performance:
{'acc': 0.97293985, 'precision': 0.7889805, 'recall': 0.7394858, 'specificity': 0.7394858, 'f1': 0.76170146, 'auroc': 0.94226503, 'binary_precision': 0.5947581, 'binary_recall': 0.4900332, 'binary_specificity': 0.9889384, 'binary_f1_score': 0.53734064}
confusion matrix:
       0    1
0  17970  201
1    307  295
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9679436, 'precision': 0.9622751, 'recall': 0.59074235, 'specificity': 0.59074235, 'f1': 0.64457434, 'auroc': 0.87932014, 'binary_precision': 0.95652175, 'binary_recall': 0.18181819, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.30555555}
confusion matrix:
      0   1
0  5995   2
1   198  44
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329044_14.png
early stop counter: 4
val acc:0.9729398488998413, best validation acc: 0.9733127355575562, corresponding to test acc:                         0.9648982286453247 / 0.9764385223388672
after epoch: 14,now: 2024-06-17 22:26:49.482532,epoch time: 0:19:26.739553,used: 4:42:31.952591,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_17_44_17_seed_2_21329044
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9730365, 'precision': 0.8067472, 'recall': 0.75932384, 'specificity': 0.75932384, 'f1': 0.78085685, 'auroc': 0.95286834, 'binary_precision': 0.6302124, 'binary_recall': 0.5297619, 'binary_specificity': 0.98888576, 'binary_f1_score': 0.5756378}
confusion matrix:
       0    1
0  41818  470
1    711  801
---- Validation: 
scalar performance:
{'acc': 0.9740052, 'precision': 0.81647444, 'recall': 0.69908065, 'specificity': 0.69908065, 'f1': 0.74332786, 'auroc': 0.94143355, 'binary_precision': 0.6524064, 'binary_recall': 0.4053156, 'binary_specificity': 0.9928457, 'binary_f1_score': 0.5}
confusion matrix:
       0    1
0  18041  130
1    358  244
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621734, 'precision': 0.9810685, 'recall': 0.5123967, 'specificity': 0.5123967, 'f1': 0.51454514, 'auroc': 0.85052234, 'binary_precision': 1.0, 'binary_recall': 0.024793388, 'binary_specificity': 1.0, 'binary_f1_score': 0.048387095}
confusion matrix:
      0  1
0  5997  0
1   236  6
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329044_15.png
better model found
persisted
after epoch: 15,now: 2024-06-17 22:48:04.233622,epoch time: 0:21:14.751090,used: 5:03:46.703681,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_17_44_17_seed_2_21329044
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.97253424, 'precision': 0.795964, 'recall': 0.78329736, 'specificity': 0.78329736, 'f1': 0.789478, 'auroc': 0.95338416, 'binary_precision': 0.6069204, 'binary_recall': 0.58002645, 'binary_specificity': 0.9865683, 'binary_f1_score': 0.59316874}
confusion matrix:
       0    1
0  41720  568
1    635  877
---- Validation: 
scalar performance:
{'acc': 0.97325945, 'precision': 0.7893038, 'recall': 0.7557119, 'specificity': 0.7557119, 'f1': 0.7713756, 'auroc': 0.9453026, 'binary_precision': 0.5943396, 'binary_recall': 0.5232558, 'binary_specificity': 0.98816794, 'binary_f1_score': 0.55653715}
confusion matrix:
       0    1
0  17956  215
1    287  315
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9661805, 'precision': 0.9426907, 'recall': 0.5699978, 'specificity': 0.5699978, 'f1': 0.6132155, 'auroc': 0.8718462, 'binary_precision': 0.9189189, 'binary_recall': 0.14049587, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.2437276}
confusion matrix:
      0   1
0  5994   3
1   208  34
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329044_16.png
early stop counter: 1
val acc:0.973259449005127, best validation acc: 0.9740052223205566, corresponding to test acc:                         0.9621734023094177 / 0.9764385223388672
after epoch: 16,now: 2024-06-17 23:03:35.570038,epoch time: 0:15:31.336416,used: 5:19:18.040097,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_17_44_17_seed_2_21329044
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.97289956, 'precision': 0.8144773, 'recall': 0.731686, 'specificity': 0.731686, 'f1': 0.76622987, 'auroc': 0.9529569, 'binary_precision': 0.64764494, 'binary_recall': 0.47257105, 'binary_specificity': 0.990801, 'binary_f1_score': 0.5464272}
confusion matrix:
       0    1
0  41898  389
1    798  715
---- Validation: 
scalar performance:
{'acc': 0.97341925, 'precision': 0.81604934, 'recall': 0.6795048, 'specificity': 0.6795048, 'f1': 0.7274761, 'auroc': 0.94044274, 'binary_precision': 0.652819, 'binary_recall': 0.3654485, 'binary_specificity': 0.99356115, 'binary_f1_score': 0.46858358}
confusion matrix:
       0    1
0  18054  117
1    382  220
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9632954, 'precision': 0.98160934, 'recall': 0.5268595, 'specificity': 0.5268595, 'f1': 0.5416128, 'auroc': 0.8667071, 'binary_precision': 1.0, 'binary_recall': 0.053719006, 'binary_specificity': 1.0, 'binary_f1_score': 0.10196078}
confusion matrix:
      0   1
0  5997   0
1   229  13
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329044_17.png
early stop counter: 2
val acc:0.9734192490577698, best validation acc: 0.9740052223205566, corresponding to test acc:                         0.9621734023094177 / 0.9764385223388672
after epoch: 17,now: 2024-06-17 23:23:15.011616,epoch time: 0:19:39.441578,used: 5:38:57.481675,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_17_44_17_seed_2_21329044
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.97196347, 'precision': 0.7918052, 'recall': 0.7772622, 'specificity': 0.7772622, 'f1': 0.78432876, 'auroc': 0.9557395, 'binary_precision': 0.5990237, 'binary_recall': 0.5681217, 'binary_specificity': 0.98640275, 'binary_f1_score': 0.5831636}
confusion matrix:
       0    1
0  41713  575
1    653  859
---- Validation: 
scalar performance:
{'acc': 0.9740585, 'precision': 0.80689985, 'recall': 0.7248057, 'specificity': 0.7248057, 'f1': 0.7589701, 'auroc': 0.9437022, 'binary_precision': 0.6315789, 'binary_recall': 0.45847178, 'binary_specificity': 0.9911397, 'binary_f1_score': 0.5312801}
confusion matrix:
       0    1
0  18010  161
1    326  276
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96537906, 'precision': 0.96483487, 'recall': 0.55570173, 'specificity': 0.55570173, 'f1': 0.5911533, 'auroc': 0.879165, 'binary_precision': 0.96428573, 'binary_recall': 0.11157025, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.19999999}
confusion matrix:
      0   1
0  5996   1
1   215  27
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329044_18.png
