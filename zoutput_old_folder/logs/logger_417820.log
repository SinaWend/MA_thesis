Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0




!!!: not committed yet



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504644

 Experiment start at: 2024-06-18 20:01:53.732093
before training, model accuracy: 0.31622418761253357
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9532762, 'precision': 0.97313535, 'recall': 0.7537806, 'specificity': 0.7537806, 'f1': 0.8236573, 'auroc': 0.9531537, 'binary_precision': 0.99511325, 'binary_recall': 0.5078214, 'binary_specificity': 0.9997399, 'binary_f1_score': 0.67247075}
confusion matrix:
       0     1
0  42278    11
1   2171  2240
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.73301566, 'recall': 0.50375026, 'specificity': 0.50375026, 'f1': 0.49895155, 'auroc': 0.5710616, 'binary_precision': 0.5, 'binary_recall': 0.00777605, 'binary_specificity': 0.9997245, 'binary_f1_score': 0.015313936}
confusion matrix:
       0  1
0  18144  5
1    638  5
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8843658, 'precision': 0.6567041, 'recall': 0.5015822, 'specificity': 0.5015822, 'f1': 0.47310054, 'auroc': 0.60785437, 'binary_precision': 0.42857143, 'binary_recall': 0.0038314175, 'binary_specificity': 0.999333, 'binary_f1_score': 0.0075949365}
confusion matrix:
      0  1
0  5993  4
1   780  3
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504644_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-18 20:26:56.224904,epoch time: 0:25:02.492811,used: 0:25:02.492811,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504644
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9730835, 'precision': 0.9815059, 'recall': 0.86026335, 'specificity': 0.86026335, 'f1': 0.910139, 'auroc': 0.97821987, 'binary_precision': 0.9912691, 'binary_recall': 0.7211887, 'binary_specificity': 0.9993379, 'binary_f1_score': 0.834931}
confusion matrix:
       0     1
0  42264    28
1   1229  3179
---- Validation: 
scalar performance:
{'acc': 0.96620905, 'precision': 0.7589942, 'recall': 0.53322285, 'specificity': 0.53322285, 'f1': 0.55224407, 'auroc': 0.6820369, 'binary_precision': 0.55, 'binary_recall': 0.06842924, 'binary_specificity': 0.9980164, 'binary_f1_score': 0.12171508}
confusion matrix:
       0   1
0  18113  36
1    599  44
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8915929, 'precision': 0.8501308, 'recall': 0.5389793, 'specificity': 0.5389793, 'f1': 0.5442315, 'auroc': 0.73489285, 'binary_precision': 0.8076923, 'binary_recall': 0.08045977, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.14634146}
confusion matrix:
      0   1
0  5982  15
1   720  63
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504644_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-18 20:45:56.230049,epoch time: 0:19:00.005145,used: 0:44:02.497956,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504644
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9796788, 'precision': 0.9823075, 'recall': 0.89766145, 'specificity': 0.89766145, 'f1': 0.93493223, 'auroc': 0.98690915, 'binary_precision': 0.9854097, 'binary_recall': 0.7965525, 'binary_specificity': 0.9987704, 'binary_f1_score': 0.8809733}
confusion matrix:
       0     1
0  42239    52
1    897  3512
---- Validation: 
scalar performance:
{'acc': 0.9669008, 'precision': 0.7787746, 'recall': 0.5530824, 'specificity': 0.5530824, 'f1': 0.5834175, 'auroc': 0.71177447, 'binary_precision': 0.5882353, 'binary_recall': 0.108864695, 'binary_specificity': 0.99730015, 'binary_f1_score': 0.18372703}
confusion matrix:
       0   1
0  18100  49
1    573  70
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8942478, 'precision': 0.85942864, 'recall': 0.5521391, 'specificity': 0.5521391, 'f1': 0.56663126, 'auroc': 0.7217558, 'binary_precision': 0.8235294, 'binary_recall': 0.107279696, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.18983051}
confusion matrix:
      0   1
0  5979  18
1   699  84
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504644_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-18 21:06:29.574025,epoch time: 0:20:33.343976,used: 1:04:35.841932,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504644
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98359746, 'precision': 0.9806895, 'recall': 0.9219873, 'specificity': 0.9219873, 'f1': 0.9489548, 'auroc': 0.9887445, 'binary_precision': 0.9772132, 'binary_recall': 0.8460317, 'binary_specificity': 0.9979428, 'binary_f1_score': 0.90690327}
confusion matrix:
       0     1
0  42203    87
1    679  3731
---- Validation: 
scalar performance:
{'acc': 0.96722007, 'precision': 0.7706454, 'recall': 0.5832499, 'specificity': 0.5832499, 'f1': 0.62319756, 'auroc': 0.7406136, 'binary_precision': 0.5699482, 'binary_recall': 0.1710731, 'binary_specificity': 0.9954268, 'binary_f1_score': 0.2631579}
confusion matrix:
       0    1
0  18066   83
1    533  110
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90309733, 'precision': 0.8831235, 'recall': 0.59378445, 'specificity': 0.59378445, 'f1': 0.6306746, 'auroc': 0.7548672, 'binary_precision': 0.86206895, 'binary_recall': 0.19157088, 'binary_specificity': 0.995998, 'binary_f1_score': 0.3134796}
confusion matrix:
      0    1
0  5973   24
1   633  150
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504644_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-18 21:25:44.108308,epoch time: 0:19:14.534283,used: 1:23:50.376215,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504644
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98541754, 'precision': 0.9820261, 'recall': 0.93152285, 'specificity': 0.93152285, 'f1': 0.9550285, 'auroc': 0.9911907, 'binary_precision': 0.9779544, 'binary_recall': 0.86507934, 'binary_specificity': 0.9979664, 'binary_f1_score': 0.91806036}
confusion matrix:
       0     1
0  42204    86
1    595  3815
---- Validation: 
scalar performance:
{'acc': 0.9665815, 'precision': 0.7545961, 'recall': 0.5799191, 'specificity': 0.5799191, 'f1': 0.61764485, 'auroc': 0.76457703, 'binary_precision': 0.53807104, 'binary_recall': 0.16485226, 'binary_specificity': 0.99498594, 'binary_f1_score': 0.25238094}
confusion matrix:
       0    1
0  18058   91
1    537  106
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90073746, 'precision': 0.87293243, 'recall': 0.58412254, 'specificity': 0.58412254, 'f1': 0.61648977, 'auroc': 0.77275884, 'binary_precision': 0.84375, 'binary_recall': 0.1724138, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.28632024}
confusion matrix:
      0    1
0  5972   25
1   648  135
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504644_5.png
early stop counter: 1
val acc:0.9665815234184265, best validation acc: 0.9672200679779053, corresponding to test acc:                         0.9030973315238953 / 0.9030973315238953
after epoch: 5,now: 2024-06-18 21:46:33.159257,epoch time: 0:20:49.050949,used: 1:44:39.427164,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504644
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98623127, 'precision': 0.9797654, 'recall': 0.93852615, 'specificity': 0.93852615, 'f1': 0.95798445, 'auroc': 0.9914955, 'binary_precision': 0.97196496, 'binary_recall': 0.87970096, 'binary_specificity': 0.99735135, 'binary_f1_score': 0.92353433}
confusion matrix:
       0     1
0  42174   112
1    531  3883
---- Validation: 
scalar performance:
{'acc': 0.96647507, 'precision': 0.7494086, 'recall': 0.5971153, 'specificity': 0.5971153, 'f1': 0.6366862, 'auroc': 0.7893417, 'binary_precision': 0.5265306, 'binary_recall': 0.20062208, 'binary_specificity': 0.9936085, 'binary_f1_score': 0.29054055}
confusion matrix:
       0    1
0  18033  116
1    514  129
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9056047, 'precision': 0.8885503, 'recall': 0.60519534, 'specificity': 0.60519534, 'f1': 0.64670205, 'auroc': 0.79433346, 'binary_precision': 0.8704663, 'binary_recall': 0.21455939, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.3442623}
confusion matrix:
      0    1
0  5972   25
1   615  168
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504644_6.png
new oracle model saved
early stop counter: 2
val acc:0.9664750695228577, best validation acc: 0.9672200679779053, corresponding to test acc:                         0.9030973315238953 / 0.9056047201156616
after epoch: 6,now: 2024-06-18 22:08:27.282344,epoch time: 0:21:54.123087,used: 2:06:33.550251,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504644
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9867666, 'precision': 0.9809874, 'recall': 0.9405201, 'specificity': 0.9405201, 'f1': 0.9596396, 'auroc': 0.9923831, 'binary_precision': 0.974013, 'binary_recall': 0.88349956, 'binary_specificity': 0.99754065, 'binary_f1_score': 0.926551}
confusion matrix:
       0     1
0  42184   104
1    514  3898
---- Validation: 
scalar performance:
{'acc': 0.96674114, 'precision': 0.753929, 'recall': 0.6032535, 'specificity': 0.6032535, 'f1': 0.6438731, 'auroc': 0.79026455, 'binary_precision': 0.53515625, 'binary_recall': 0.21306376, 'binary_specificity': 0.9934432, 'binary_f1_score': 0.30478308}
confusion matrix:
       0    1
0  18030  119
1    506  137
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90501475, 'precision': 0.8746565, 'recall': 0.6065274, 'specificity': 0.6065274, 'f1': 0.6478196, 'auroc': 0.7991194, 'binary_precision': 0.84236455, 'binary_recall': 0.21839081, 'binary_specificity': 0.994664, 'binary_f1_score': 0.34685597}
confusion matrix:
      0    1
0  5965   32
1   612  171
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504644_7.png
early stop counter: 3
val acc:0.966741144657135, best validation acc: 0.9672200679779053, corresponding to test acc:                         0.9030973315238953 / 0.9056047201156616
after epoch: 7,now: 2024-06-18 22:29:46.896907,epoch time: 0:21:19.614563,used: 2:27:53.164814,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504644
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9875803, 'precision': 0.9861026, 'recall': 0.9405501, 'specificity': 0.9405501, 'f1': 0.9619255, 'auroc': 0.99355066, 'binary_precision': 0.9843236, 'binary_recall': 0.88256633, 'binary_specificity': 0.9985339, 'binary_f1_score': 0.9306718}
confusion matrix:
       0     1
0  42227    62
1    518  3893
---- Validation: 
scalar performance:
{'acc': 0.9672733, 'precision': 0.7717799, 'recall': 0.5840275, 'specificity': 0.5840275, 'f1': 0.6242485, 'auroc': 0.78225386, 'binary_precision': 0.57216495, 'binary_recall': 0.1726283, 'binary_specificity': 0.9954268, 'binary_f1_score': 0.26523298}
confusion matrix:
       0    1
0  18066   83
1    532  111
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90073746, 'precision': 0.87293243, 'recall': 0.58412254, 'specificity': 0.58412254, 'f1': 0.61648977, 'auroc': 0.78242284, 'binary_precision': 0.84375, 'binary_recall': 0.1724138, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.28632024}
confusion matrix:
      0    1
0  5972   25
1   648  135
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504644_8.png
better model found
persisted
after epoch: 8,now: 2024-06-18 22:52:21.914962,epoch time: 0:22:35.018055,used: 2:50:28.182869,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504644
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9886081, 'precision': 0.98288167, 'recall': 0.949635, 'specificity': 0.949635, 'f1': 0.96551436, 'auroc': 0.9935585, 'binary_precision': 0.975945, 'binary_recall': 0.9015873, 'binary_specificity': 0.9976827, 'binary_f1_score': 0.93729377}
confusion matrix:
       0     1
0  42192    98
1    434  3976
---- Validation: 
scalar performance:
{'acc': 0.9670072, 'precision': 0.7611836, 'recall': 0.5951406, 'specificity': 0.5951406, 'f1': 0.6360513, 'auroc': 0.80114406, 'binary_precision': 0.55021834, 'binary_recall': 0.19595645, 'binary_specificity': 0.99432474, 'binary_f1_score': 0.28899083}
confusion matrix:
       0    1
0  18046  103
1    517  126
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90575224, 'precision': 0.8753098, 'recall': 0.61027545, 'specificity': 0.61027545, 'f1': 0.652824, 'auroc': 0.7987826, 'binary_precision': 0.8428571, 'binary_recall': 0.22605364, 'binary_specificity': 0.99449724, 'binary_f1_score': 0.3564955}
confusion matrix:
      0    1
0  5964   33
1   606  177
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504644_9.png
new oracle model saved
early stop counter: 1
val acc:0.9670072197914124, best validation acc: 0.9672732949256897, corresponding to test acc:                         0.900737464427948 / 0.9057522416114807
after epoch: 9,now: 2024-06-18 23:15:10.823162,epoch time: 0:22:48.908200,used: 3:13:17.091069,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504644
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98888654, 'precision': 0.9847629, 'recall': 0.9494728, 'specificity': 0.9494728, 'f1': 0.9662819, 'auroc': 0.99478936, 'binary_precision': 0.97977304, 'binary_recall': 0.90088457, 'binary_specificity': 0.99806106, 'binary_f1_score': 0.9386742}
confusion matrix:
       0     1
0  42209    82
1    437  3972
---- Validation: 
scalar performance:
{'acc': 0.96706045, 'precision': 0.7601903, 'recall': 0.60416883, 'specificity': 0.60416883, 'f1': 0.64575416, 'auroc': 0.808329, 'binary_precision': 0.54761904, 'binary_recall': 0.21461898, 'binary_specificity': 0.9937187, 'binary_f1_score': 0.30837992}
confusion matrix:
       0    1
0  18035  114
1    505  138
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90147495, 'precision': 0.86244, 'recall': 0.5912017, 'specificity': 0.5912017, 'f1': 0.6262945, 'auroc': 0.79736274, 'binary_precision': 0.82122904, 'binary_recall': 0.18773946, 'binary_specificity': 0.994664, 'binary_f1_score': 0.3056133}
confusion matrix:
      0    1
0  5965   32
1   636  147
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504644_10.png
early stop counter: 2
val acc:0.9670604467391968, best validation acc: 0.9672732949256897, corresponding to test acc:                         0.900737464427948 / 0.9057522416114807
after epoch: 10,now: 2024-06-18 23:34:30.312046,epoch time: 0:19:19.488884,used: 3:32:36.579953,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504644
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9901713, 'precision': 0.9852001, 'recall': 0.9567312, 'specificity': 0.9567312, 'f1': 0.9704251, 'auroc': 0.9951792, 'binary_precision': 0.9791616, 'binary_recall': 0.9154962, 'binary_specificity': 0.99796623, 'binary_f1_score': 0.9462592}
confusion matrix:
       0     1
0  42200    86
1    373  4041
---- Validation: 
scalar performance:
{'acc': 0.9671137, 'precision': 0.763609, 'recall': 0.5951957, 'specificity': 0.5951957, 'f1': 0.6364112, 'auroc': 0.7975469, 'binary_precision': 0.5550661, 'binary_recall': 0.19595645, 'binary_specificity': 0.99443495, 'binary_f1_score': 0.28965515}
confusion matrix:
       0    1
0  18048  101
1    517  126
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90117997, 'precision': 0.8578882, 'recall': 0.591035, 'specificity': 0.591035, 'f1': 0.62589383, 'auroc': 0.77297395, 'binary_precision': 0.8121547, 'binary_recall': 0.18773946, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.30497926}
confusion matrix:
      0    1
0  5963   34
1   636  147
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504644_11.png
early stop counter: 3
val acc:0.9671136736869812, best validation acc: 0.9672732949256897, corresponding to test acc:                         0.900737464427948 / 0.9057522416114807
after epoch: 11,now: 2024-06-18 23:57:29.714856,epoch time: 0:22:59.402810,used: 3:55:35.982763,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504644
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99012846, 'precision': 0.9849578, 'recall': 0.9566884, 'specificity': 0.9566884, 'f1': 0.97029, 'auroc': 0.9955853, 'binary_precision': 0.97867703, 'binary_recall': 0.91545784, 'binary_specificity': 0.997919, 'binary_f1_score': 0.94601244}
confusion matrix:
       0     1
0  42200    88
1    373  4039
---- Validation: 
scalar performance:
{'acc': 0.96674114, 'precision': 0.75319624, 'recall': 0.6085039, 'specificity': 0.6085039, 'f1': 0.6492001, 'auroc': 0.81151056, 'binary_precision': 0.53333336, 'binary_recall': 0.22395024, 'binary_specificity': 0.9930575, 'binary_f1_score': 0.3154436}
confusion matrix:
       0    1
0  18023  126
1    499  144
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9033923, 'precision': 0.86610556, 'recall': 0.60061353, 'specificity': 0.60061353, 'f1': 0.63944364, 'auroc': 0.7976463, 'binary_precision': 0.82653064, 'binary_recall': 0.20689656, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.33094993}
confusion matrix:
      0    1
0  5963   34
1   621  162
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504644_12.png
early stop counter: 4
val acc:0.966741144657135, best validation acc: 0.9672732949256897, corresponding to test acc:                         0.900737464427948 / 0.9057522416114807
after epoch: 12,now: 2024-06-19 00:18:59.822217,epoch time: 0:21:30.107361,used: 4:17:06.090124,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504644
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9901713, 'precision': 0.9836443, 'recall': 0.95825297, 'specificity': 0.95825297, 'f1': 0.97051823, 'auroc': 0.9960393, 'binary_precision': 0.97570366, 'binary_recall': 0.9188944, 'binary_specificity': 0.9976115, 'binary_f1_score': 0.9464474}
confusion matrix:
       0     1
0  42185   101
1    358  4056
---- Validation: 
scalar performance:
{'acc': 0.96695405, 'precision': 0.7574737, 'recall': 0.60711396, 'specificity': 0.60711396, 'f1': 0.6484407, 'auroc': 0.8235359, 'binary_precision': 0.54198474, 'binary_recall': 0.22083981, 'binary_specificity': 0.99338806, 'binary_f1_score': 0.31381217}
confusion matrix:
       0    1
0  18029  120
1    501  142
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89852506, 'precision': 0.85167396, 'recall': 0.57787514, 'specificity': 0.57787514, 'f1': 0.6067842, 'auroc': 0.8082981, 'binary_precision': 0.80254775, 'binary_recall': 0.16091955, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.26808512}
confusion matrix:
      0    1
0  5966   31
1   657  126
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504644_13.png
early stop counter: 5
val acc:0.9669540524482727, best validation acc: 0.9672732949256897, corresponding to test acc:                         0.900737464427948 / 0.9057522416114807
after epoch: 13,now: 2024-06-19 00:38:04.161475,epoch time: 0:19:04.339258,used: 4:36:10.429382,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504644
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99098504, 'precision': 0.9863589, 'recall': 0.9604182, 'specificity': 0.9604182, 'f1': 0.97294194, 'auroc': 0.99648166, 'binary_precision': 0.9807322, 'binary_recall': 0.9227283, 'binary_specificity': 0.99810815, 'binary_f1_score': 0.9508465}
confusion matrix:
       0     1
0  42207    80
1    341  4072
---- Validation: 
scalar performance:
{'acc': 0.966688, 'precision': 0.75428486, 'recall': 0.5942252, 'specificity': 0.5942252, 'f1': 0.6341673, 'auroc': 0.817196, 'binary_precision': 0.53648067, 'binary_recall': 0.19440125, 'binary_specificity': 0.99404925, 'binary_f1_score': 0.2853881}
confusion matrix:
       0    1
0  18041  108
1    518  125
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8960177, 'precision': 0.83478373, 'recall': 0.56812984, 'specificity': 0.56812984, 'f1': 0.591838, 'auroc': 0.80425346, 'binary_precision': 0.7708333, 'binary_recall': 0.14176245, 'binary_specificity': 0.99449724, 'binary_f1_score': 0.23948221}
confusion matrix:
      0    1
0  5964   33
1   672  111
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504644_14.png
early stop counter: 6
val acc:0.9666879773139954, best validation acc: 0.9672732949256897, corresponding to test acc:                         0.900737464427948 / 0.9057522416114807
after epoch: 14,now: 2024-06-19 01:00:38.919857,epoch time: 0:22:34.758382,used: 4:58:45.187764,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504644
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99149895, 'precision': 0.98784006, 'recall': 0.96202123, 'specificity': 0.96202123, 'f1': 0.9744898, 'auroc': 0.99654186, 'binary_precision': 0.9833895, 'binary_recall': 0.92567414, 'binary_specificity': 0.99836826, 'binary_f1_score': 0.9536594}
confusion matrix:
       0     1
0  42218    69
1    328  4085
---- Validation: 
scalar performance:
{'acc': 0.9668476, 'precision': 0.7581198, 'recall': 0.59280777, 'specificity': 0.59280777, 'f1': 0.6330577, 'auroc': 0.81014335, 'binary_precision': 0.5442478, 'binary_recall': 0.19129083, 'binary_specificity': 0.99432474, 'binary_f1_score': 0.28308403}
confusion matrix:
       0    1
0  18046  103
1    520  123
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89247787, 'precision': 0.8102478, 'recall': 0.5528042, 'specificity': 0.5528042, 'f1': 0.5675472, 'auroc': 0.7880205, 'binary_precision': 0.725, 'binary_recall': 0.11111111, 'binary_specificity': 0.99449724, 'binary_f1_score': 0.19269103}
confusion matrix:
      0   1
0  5964  33
1   696  87
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504644_15.png
early stop counter: 7
val acc:0.9668475985527039, best validation acc: 0.9672732949256897, corresponding to test acc:                         0.900737464427948 / 0.9057522416114807
after epoch: 15,now: 2024-06-19 01:23:02.333222,epoch time: 0:22:23.413365,used: 5:21:08.601129,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504644
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99104923, 'precision': 0.9857732, 'recall': 0.96134996, 'specificity': 0.96134996, 'f1': 0.97316575, 'auroc': 0.996138, 'binary_precision': 0.97935176, 'binary_recall': 0.92473364, 'binary_specificity': 0.99796635, 'binary_f1_score': 0.9512594}
confusion matrix:
       0     1
0  42203    86
1    332  4079
---- Validation: 
scalar performance:
{'acc': 0.9661558, 'precision': 0.7431729, 'recall': 0.59544986, 'specificity': 0.59544986, 'f1': 0.63403034, 'auroc': 0.829888, 'binary_precision': 0.51417005, 'binary_recall': 0.19751166, 'binary_specificity': 0.99338806, 'binary_f1_score': 0.28539324}
confusion matrix:
       0    1
0  18029  120
1    516  127
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89852506, 'precision': 0.84129643, 'recall': 0.5812063, 'specificity': 0.5812063, 'f1': 0.6113712, 'auroc': 0.81115, 'binary_precision': 0.7810651, 'binary_recall': 0.16858238, 'binary_specificity': 0.99383026, 'binary_f1_score': 0.27731094}
confusion matrix:
      0    1
0  5960   37
1   651  132
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504644_16.png
early stop counter: 8
val acc:0.9661558270454407, best validation acc: 0.9672732949256897, corresponding to test acc:                         0.900737464427948 / 0.9057522416114807
after epoch: 16,now: 2024-06-19 01:48:05.016452,epoch time: 0:25:02.683230,used: 5:46:11.284359,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504644
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.991606, 'precision': 0.98821926, 'recall': 0.96226656, 'specificity': 0.96226656, 'f1': 0.9747979, 'auroc': 0.9962292, 'binary_precision': 0.9841002, 'binary_recall': 0.9260939, 'binary_specificity': 0.9984393, 'binary_f1_score': 0.9542163}
confusion matrix:
       0     1
0  42223    66
1    326  4085
---- Validation: 
scalar performance:
{'acc': 0.96722007, 'precision': 0.7673457, 'recall': 0.5915005, 'specificity': 0.5915005, 'f1': 0.6326392, 'auroc': 0.8242682, 'binary_precision': 0.5627907, 'binary_recall': 0.1881804, 'binary_specificity': 0.99482065, 'binary_f1_score': 0.2820513}
confusion matrix:
       0    1
0  18055   94
1    522  121
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8951327, 'precision': 0.8484234, 'recall': 0.5593017, 'specificity': 0.5593017, 'f1': 0.5782251, 'auroc': 0.79989904, 'binary_precision': 0.8, 'binary_recall': 0.12260536, 'binary_specificity': 0.995998, 'binary_f1_score': 0.21262458}
confusion matrix:
      0   1
0  5973  24
1   687  96
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504644_17.png
early stop counter: 9
val acc:0.9672200679779053, best validation acc: 0.9672732949256897, corresponding to test acc:                         0.900737464427948 / 0.9057522416114807
after epoch: 17,now: 2024-06-19 02:08:16.948887,epoch time: 0:20:11.932435,used: 6:06:23.216794,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504644
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99083513, 'precision': 0.98604554, 'recall': 0.95980144, 'specificity': 0.95980144, 'f1': 0.97246605, 'auroc': 0.9968697, 'binary_precision': 0.9802219, 'binary_recall': 0.9215419, 'binary_specificity': 0.998061, 'binary_f1_score': 0.9499766}
confusion matrix:
       0     1
0  42208    82
1    346  4064
---- Validation: 
scalar performance:
{'acc': 0.9662622, 'precision': 0.7448739, 'recall': 0.60225546, 'specificity': 0.60225546, 'f1': 0.6414676, 'auroc': 0.82909256, 'binary_precision': 0.5171103, 'binary_recall': 0.21150856, 'binary_specificity': 0.99300236, 'binary_f1_score': 0.30022076}
confusion matrix:
       0    1
0  18022  127
1    507  136
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8936578, 'precision': 0.8036139, 'recall': 0.5634647, 'specificity': 0.5634647, 'f1': 0.58423656, 'auroc': 0.8169321, 'binary_precision': 0.7094595, 'binary_recall': 0.13409962, 'binary_specificity': 0.99282974, 'binary_f1_score': 0.22556391}
confusion matrix:
      0    1
0  5954   43
1   678  105
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504644_18.png
early stop counter: 10
val acc:0.9662622213363647, best validation acc: 0.9672732949256897, corresponding to test acc:                         0.900737464427948 / 0.9057522416114807
after epoch: 18,now: 2024-06-19 02:32:17.988834,epoch time: 0:24:01.039947,used: 6:30:24.256741,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504644
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99203426, 'precision': 0.98632085, 'recall': 0.96666574, 'specificity': 0.96666574, 'f1': 0.97623825, 'auroc': 0.99669707, 'binary_precision': 0.9793496, 'binary_recall': 0.9353888, 'binary_specificity': 0.99794275, 'binary_f1_score': 0.95686454}
confusion matrix:
       0     1
0  42202    87
1    285  4126
---- Validation: 
scalar performance:
{'acc': 0.96706045, 'precision': 0.7582955, 'recall': 0.6139195, 'specificity': 0.6139195, 'f1': 0.6555105, 'auroc': 0.8357283, 'binary_precision': 0.54316545, 'binary_recall': 0.2348367, 'binary_specificity': 0.99300236, 'binary_f1_score': 0.32790443}
confusion matrix:
       0    1
0  18022  127
1    492  151
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8938053, 'precision': 0.8104143, 'recall': 0.5618825, 'specificity': 0.5618825, 'f1': 0.5818996, 'auroc': 0.81500554, 'binary_precision': 0.7234042, 'binary_recall': 0.1302682, 'binary_specificity': 0.9934968, 'binary_f1_score': 0.22077923}
confusion matrix:
      0    1
0  5958   39
1   681  102
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504644_19.png
early stop counter: 11
val acc:0.9670604467391968, best validation acc: 0.9672732949256897, corresponding to test acc:                         0.900737464427948 / 0.9057522416114807
after epoch: 19,now: 2024-06-19 02:53:01.337750,epoch time: 0:20:43.348916,used: 6:51:07.605657,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504644
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9920771, 'precision': 0.9860457, 'recall': 0.9672042, 'specificity': 0.9672042, 'f1': 0.97639066, 'auroc': 0.9966872, 'binary_precision': 0.9786831, 'binary_recall': 0.9365367, 'binary_specificity': 0.99787176, 'binary_f1_score': 0.9571462}
confusion matrix:
       0     1
0  42198    90
1    280  4132
---- Validation: 
scalar performance:
{'acc': 0.96647507, 'precision': 0.7485961, 'recall': 0.6053659, 'specificity': 0.6053659, 'f1': 0.645257, 'auroc': 0.82704043, 'binary_precision': 0.52434456, 'binary_recall': 0.21772939, 'binary_specificity': 0.99300236, 'binary_f1_score': 0.30769232}
confusion matrix:
       0    1
0  18022  127
1    503  140
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8938053, 'precision': 0.8104143, 'recall': 0.5618825, 'specificity': 0.5618825, 'f1': 0.5818996, 'auroc': 0.79639184, 'binary_precision': 0.7234042, 'binary_recall': 0.1302682, 'binary_specificity': 0.9934968, 'binary_f1_score': 0.22077923}
confusion matrix:
      0    1
0  5958   39
1   681  102
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504644_20.png
early stop counter: 12
val acc:0.9664750695228577, best validation acc: 0.9672732949256897, corresponding to test acc:                         0.900737464427948 / 0.9057522416114807
after epoch: 20,now: 2024-06-19 03:12:23.702610,epoch time: 0:19:22.364860,used: 7:10:29.970517,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504644
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99182016, 'precision': 0.9855668, 'recall': 0.9661414, 'specificity': 0.9661414, 'f1': 0.9756046, 'auroc': 0.99682426, 'binary_precision': 0.97793597, 'binary_recall': 0.934482, 'binary_specificity': 0.9978008, 'binary_f1_score': 0.9557153}
confusion matrix:
       0     1
0  42196    93
1    289  4122
---- Validation: 
scalar performance:
{'acc': 0.9667944, 'precision': 0.7554804, 'recall': 0.6002808, 'specificity': 0.6002808, 'f1': 0.6409355, 'auroc': 0.82442474, 'binary_precision': 0.53846157, 'binary_recall': 0.20684293, 'binary_specificity': 0.9937187, 'binary_f1_score': 0.29887643}
confusion matrix:
       0    1
0  18035  114
1    510  133
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89321536, 'precision': 0.80922484, 'recall': 0.5582178, 'specificity': 0.5582178, 'f1': 0.5761733, 'auroc': 0.80109084, 'binary_precision': 0.7218045, 'binary_recall': 0.12260536, 'binary_specificity': 0.99383026, 'binary_f1_score': 0.20960698}
confusion matrix:
      0   1
0  5960  37
1   687  96
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504644_21.png
early stop counter: 13
val acc:0.9667943716049194, best validation acc: 0.9672732949256897, corresponding to test acc:                         0.900737464427948 / 0.9057522416114807
after epoch: 21,now: 2024-06-19 03:30:39.716404,epoch time: 0:18:16.013794,used: 7:28:45.984311,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504644
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9924839, 'precision': 0.98589885, 'recall': 0.96973056, 'specificity': 0.96973056, 'f1': 0.97764254, 'auroc': 0.996014, 'binary_precision': 0.9778511, 'binary_recall': 0.9416837, 'binary_specificity': 0.9977774, 'binary_f1_score': 0.95942664}
confusion matrix:
       0     1
0  42199    94
1    257  4150
---- Validation: 
scalar performance:
{'acc': 0.96737975, 'precision': 0.7652153, 'recall': 0.6103346, 'specificity': 0.6103346, 'f1': 0.65296966, 'auroc': 0.83381975, 'binary_precision': 0.55725193, 'binary_recall': 0.22706065, 'binary_specificity': 0.9936085, 'binary_f1_score': 0.3226519}
confusion matrix:
       0    1
0  18033  116
1    497  146
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89277285, 'precision': 0.8058126, 'recall': 0.55630213, 'specificity': 0.55630213, 'f1': 0.57312, 'auroc': 0.8054794, 'binary_precision': 0.7153846, 'binary_recall': 0.118773945, 'binary_specificity': 0.99383026, 'binary_f1_score': 0.20372398}
confusion matrix:
      0   1
0  5960  37
1   690  93
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504644_22.png
better model found
persisted
after epoch: 22,now: 2024-06-19 03:47:26.181470,epoch time: 0:16:46.465066,used: 7:45:32.449377,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504644
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9926981, 'precision': 0.9857508, 'recall': 0.971195, 'specificity': 0.971195, 'f1': 0.9783334, 'auroc': 0.99747765, 'binary_precision': 0.9772514, 'binary_recall': 0.94468373, 'binary_specificity': 0.99770623, 'binary_f1_score': 0.9606917}
confusion matrix:
       0     1
0  42192    97
1    244  4167
---- Validation: 
scalar performance:
{'acc': 0.96647507, 'precision': 0.7481684, 'recall': 0.61061627, 'specificity': 0.61061627, 'f1': 0.65049845, 'auroc': 0.83335185, 'binary_precision': 0.52313167, 'binary_recall': 0.22861587, 'binary_specificity': 0.99261665, 'binary_f1_score': 0.3181818}
confusion matrix:
       0    1
0  18015  134
1    496  147
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8920354, 'precision': 0.778988, 'recall': 0.56254756, 'specificity': 0.56254756, 'f1': 0.5824588, 'auroc': 0.8022145, 'binary_precision': 0.6603774, 'binary_recall': 0.13409962, 'binary_specificity': 0.9909955, 'binary_f1_score': 0.22292995}
confusion matrix:
      0    1
0  5943   54
1   678  105
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504644_23.png
early stop counter: 1
val acc:0.9664750695228577, best validation acc: 0.9673797488212585, corresponding to test acc:                         0.8927728533744812 / 0.9057522416114807
after epoch: 23,now: 2024-06-19 04:05:23.003941,epoch time: 0:17:56.822471,used: 8:03:29.271848,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504644
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.992848, 'precision': 0.98838925, 'recall': 0.9694569, 'specificity': 0.9694569, 'f1': 0.9786877, 'auroc': 0.9970439, 'binary_precision': 0.98294646, 'binary_recall': 0.9406165, 'binary_specificity': 0.9982974, 'binary_f1_score': 0.9613157}
confusion matrix:
       0     1
0  42216    72
1    262  4150
---- Validation: 
scalar performance:
{'acc': 0.9668476, 'precision': 0.75920796, 'recall': 0.5883075, 'specificity': 0.5883075, 'f1': 0.62804127, 'auroc': 0.8292713, 'binary_precision': 0.54672897, 'binary_recall': 0.18195957, 'binary_specificity': 0.9946554, 'binary_f1_score': 0.2730455}
confusion matrix:
       0    1
0  18052   97
1    526  117
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89247787, 'precision': 0.8376627, 'recall': 0.54614186, 'specificity': 0.54614186, 'f1': 0.5565804, 'auroc': 0.80083525, 'binary_precision': 0.78125, 'binary_recall': 0.09578544, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.17064846}
confusion matrix:
      0   1
0  5976  21
1   708  75
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504644_24.png
early stop counter: 2
val acc:0.9668475985527039, best validation acc: 0.9673797488212585, corresponding to test acc:                         0.8927728533744812 / 0.9057522416114807
after epoch: 24,now: 2024-06-19 04:21:20.909489,epoch time: 0:15:57.905548,used: 8:19:27.177396,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504644
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99252677, 'precision': 0.98891544, 'recall': 0.9670756, 'specificity': 0.9670756, 'f1': 0.9776818, 'auroc': 0.9973187, 'binary_precision': 0.98451275, 'binary_recall': 0.9356884, 'binary_specificity': 0.9984628, 'binary_f1_score': 0.95947987}
confusion matrix:
       0     1
0  42219    65
1    284  4132
---- Validation: 
scalar performance:
{'acc': 0.96706045, 'precision': 0.76324624, 'recall': 0.5921679, 'specificity': 0.5921679, 'f1': 0.6329389, 'auroc': 0.8285017, 'binary_precision': 0.55454546, 'binary_recall': 0.18973562, 'binary_specificity': 0.99460024, 'binary_f1_score': 0.28273466}
confusion matrix:
       0    1
0  18051   98
1    521  122
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8923304, 'precision': 0.81894386, 'recall': 0.54938966, 'specificity': 0.54938966, 'f1': 0.56199443, 'auroc': 0.8034848, 'binary_precision': 0.74311924, 'binary_recall': 0.10344828, 'binary_specificity': 0.995331, 'binary_f1_score': 0.18161435}
confusion matrix:
      0   1
0  5969  28
1   702  81
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504644_25.png
early stop counter: 3
val acc:0.9670604467391968, best validation acc: 0.9673797488212585, corresponding to test acc:                         0.8927728533744812 / 0.9057522416114807
after epoch: 25,now: 2024-06-19 04:37:49.381639,epoch time: 0:16:28.472150,used: 8:35:55.649546,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504644
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99222696, 'precision': 0.9877824, 'recall': 0.96636605, 'specificity': 0.96636605, 'f1': 0.976772, 'auroc': 0.99699414, 'binary_precision': 0.9823642, 'binary_recall': 0.934482, 'binary_specificity': 0.9982501, 'binary_f1_score': 0.957825}
confusion matrix:
       0     1
0  42215    74
1    289  4122
---- Validation: 
scalar performance:
{'acc': 0.9671137, 'precision': 0.7645131, 'recall': 0.5921955, 'specificity': 0.5921955, 'f1': 0.6331167, 'auroc': 0.835754, 'binary_precision': 0.55707765, 'binary_recall': 0.18973562, 'binary_specificity': 0.9946554, 'binary_f1_score': 0.28306264}
confusion matrix:
       0    1
0  18052   97
1    521  122
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8926254, 'precision': 0.8133018, 'recall': 0.55288756, 'specificity': 0.55288756, 'f1': 0.56769586, 'auroc': 0.8056412, 'binary_precision': 0.73109245, 'binary_recall': 0.11111111, 'binary_specificity': 0.994664, 'binary_f1_score': 0.19290467}
confusion matrix:
      0   1
0  5965  32
1   696  87
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504644_26.png
early stop counter: 4
val acc:0.9671136736869812, best validation acc: 0.9673797488212585, corresponding to test acc:                         0.8927728533744812 / 0.9057522416114807
after epoch: 26,now: 2024-06-19 04:54:38.168976,epoch time: 0:16:48.787337,used: 8:52:44.436883,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504644
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9933833, 'precision': 0.99205315, 'recall': 0.96902823, 'specificity': 0.96902823, 'f1': 0.98019433, 'auroc': 0.99747175, 'binary_precision': 0.9904329, 'binary_recall': 0.9390023, 'binary_specificity': 0.99905413, 'binary_f1_score': 0.9640321}
confusion matrix:
       0     1
0  42250    40
1    269  4141
---- Validation: 
scalar performance:
{'acc': 0.9672733, 'precision': 0.7765701, 'recall': 0.57502687, 'specificity': 0.57502687, 'f1': 0.6134087, 'auroc': 0.8212302, 'binary_precision': 0.58235294, 'binary_recall': 0.15396579, 'binary_specificity': 0.99608797, 'binary_f1_score': 0.24354243}
confusion matrix:
       0   1
0  18078  71
1    544  99
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8926254, 'precision': 0.83336127, 'recall': 0.5478908, 'specificity': 0.5478908, 'f1': 0.55951965, 'auroc': 0.79751647, 'binary_precision': 0.77227724, 'binary_recall': 0.099616855, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.17647058}
confusion matrix:
      0   1
0  5974  23
1   705  78
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504644_27.png
early stop counter: 5
val acc:0.9672732949256897, best validation acc: 0.9673797488212585, corresponding to test acc:                         0.8927728533744812 / 0.9057522416114807
after epoch: 27,now: 2024-06-19 05:11:47.449909,epoch time: 0:17:09.280933,used: 9:09:53.717816,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504644
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9927409, 'precision': 0.9889383, 'recall': 0.9682743, 'specificity': 0.9682743, 'f1': 0.97832584, 'auroc': 0.99704635, 'binary_precision': 0.9843007, 'binary_recall': 0.9381093, 'binary_specificity': 0.9984393, 'binary_f1_score': 0.96064997}
confusion matrix:
       0     1
0  42223    66
1    273  4138
---- Validation: 
scalar performance:
{'acc': 0.9671669, 'precision': 0.7668258, 'recall': 0.5892228, 'specificity': 0.5892228, 'f1': 0.62993646, 'auroc': 0.8302625, 'binary_precision': 0.5619048, 'binary_recall': 0.18351477, 'binary_specificity': 0.99493086, 'binary_f1_score': 0.27667058}
confusion matrix:
       0    1
0  18057   92
1    525  118
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8920354, 'precision': 0.8258018, 'recall': 0.54589176, 'specificity': 0.54589176, 'f1': 0.5561651, 'auroc': 0.7984134, 'binary_precision': 0.75757575, 'binary_recall': 0.09578544, 'binary_specificity': 0.995998, 'binary_f1_score': 0.17006803}
confusion matrix:
      0   1
0  5973  24
1   708  75
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504644_28.png
early stop counter: 6
val acc:0.9671669006347656, best validation acc: 0.9673797488212585, corresponding to test acc:                         0.8927728533744812 / 0.9057522416114807
after epoch: 28,now: 2024-06-19 05:28:55.584395,epoch time: 0:17:08.134486,used: 9:27:01.852302,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504644
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9929979, 'precision': 0.98766387, 'recall': 0.97104967, 'specificity': 0.97104967, 'f1': 0.97917557, 'auroc': 0.99741757, 'binary_precision': 0.98114544, 'binary_recall': 0.94399095, 'binary_specificity': 0.9981083, 'binary_f1_score': 0.9622097}
confusion matrix:
       0     1
0  42210    80
1    247  4163
---- Validation: 
scalar performance:
{'acc': 0.9665815, 'precision': 0.75118697, 'recall': 0.6001706, 'specificity': 0.6001706, 'f1': 0.64021134, 'auroc': 0.83473504, 'binary_precision': 0.52988046, 'binary_recall': 0.20684293, 'binary_specificity': 0.99349827, 'binary_f1_score': 0.29753914}
confusion matrix:
       0    1
0  18031  118
1    510  133
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8933628, 'precision': 0.7988688, 'recall': 0.5632979, 'specificity': 0.5632979, 'f1': 0.58391106, 'auroc': 0.8066907, 'binary_precision': 0.7, 'binary_recall': 0.13409962, 'binary_specificity': 0.99249625, 'binary_f1_score': 0.22508039}
confusion matrix:
      0    1
0  5952   45
1   678  105
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504644_29.png
early stop counter: 7
val acc:0.9665815234184265, best validation acc: 0.9673797488212585, corresponding to test acc:                         0.8927728533744812 / 0.9057522416114807
after epoch: 29,now: 2024-06-19 05:46:02.315762,epoch time: 0:17:06.731367,used: 9:44:08.583669,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504644
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99312633, 'precision': 0.99032295, 'recall': 0.9691978, 'specificity': 0.9691978, 'f1': 0.9794681, 'auroc': 0.9972346, 'binary_precision': 0.98690474, 'binary_recall': 0.9396962, 'binary_specificity': 0.9986994, 'binary_f1_score': 0.96272206}
confusion matrix:
       0     1
0  42234    55
1    266  4145
---- Validation: 
scalar performance:
{'acc': 0.96737975, 'precision': 0.7690507, 'recall': 0.59758365, 'specificity': 0.59758365, 'f1': 0.63975704, 'auroc': 0.8367592, 'binary_precision': 0.56578946, 'binary_recall': 0.20062208, 'binary_specificity': 0.99454516, 'binary_f1_score': 0.29621124}
confusion matrix:
       0    1
0  18050   99
1    514  129
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89483774, 'precision': 0.8293632, 'recall': 0.5624661, 'specificity': 0.5624661, 'f1': 0.5830349, 'auroc': 0.81150585, 'binary_precision': 0.76119405, 'binary_recall': 0.1302682, 'binary_specificity': 0.994664, 'binary_f1_score': 0.22246456}
confusion matrix:
      0    1
0  5965   32
1   681  102
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504644_30.png
early stop counter: 8
val acc:0.9673797488212585, best validation acc: 0.9673797488212585, corresponding to test acc:                         0.8927728533744812 / 0.9057522416114807
after epoch: 30,now: 2024-06-19 06:05:23.430458,epoch time: 0:19:21.114696,used: 10:03:29.698365,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504644
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 10:03:29.698365 at 2024-06-19 06:05:23.430458
persisted model performance metric: 

scalar performance:
{'acc': 0.89277285, 'precision': 0.8058126, 'recall': 0.55630213, 'specificity': 0.55630213, 'f1': 0.57312, 'auroc': 0.8054794, 'binary_precision': 0.7153846, 'binary_recall': 0.118773945, 'binary_specificity': 0.99383026, 'binary_f1_score': 0.20372398}
confusion matrix:
      0   1
0  5960  37
1   690  93
oracle model performance metric: 

scalar performance:
{'acc': 0.90575224, 'precision': 0.8753098, 'recall': 0.61027545, 'specificity': 0.61027545, 'f1': 0.652824, 'auroc': 0.7987826, 'binary_precision': 0.8428571, 'binary_recall': 0.22605364, 'binary_specificity': 0.99449724, 'binary_f1_score': 0.3564955}
confusion matrix:
      0    1
0  5964   33
1   606  177
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4_classbalancing/rule_results/4.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4_classbalancing/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4_classbalancing/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204211 KiB |   1436 MiB | 418099 GiB | 418099 GiB |
|       from large pool | 167936 KiB |   1366 MiB | 417971 GiB | 417971 GiB |
|       from small pool |  36275 KiB |     72 MiB |    127 GiB |    127 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 204211 KiB |   1436 MiB | 418099 GiB | 418099 GiB |
|       from large pool | 167936 KiB |   1366 MiB | 417971 GiB | 417971 GiB |
|       from small pool |  36275 KiB |     72 MiB |    127 GiB |    127 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201112 KiB |   1428 MiB | 418075 GiB | 418074 GiB |
|       from large pool | 165120 KiB |   1358 MiB | 417950 GiB | 417950 GiB |
|       from small pool |  35992 KiB |     71 MiB |    124 GiB |    124 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1524 MiB |   1524 MiB |   1524 MiB |      0 B   |
|       from large pool |   1450 MiB |   1450 MiB |   1450 MiB |      0 B   |
|       from small pool |     74 MiB |     74 MiB |     74 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 320076 KiB | 628877 KiB | 300434 GiB | 300433 GiB |
|       from large pool | 311296 KiB | 627520 KiB | 300285 GiB | 300285 GiB |
|       from small pool |   8780 KiB |  12547 KiB |    148 GiB |    148 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1308    |    1965    |   14572 K  |   14570 K  |
|       from large pool |      36    |      76    |    4895 K  |    4895 K  |
|       from small pool |    1272    |    1894    |    9676 K  |    9675 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1308    |    1965    |   14572 K  |   14570 K  |
|       from large pool |      36    |      76    |    4895 K  |    4895 K  |
|       from small pool |    1272    |    1894    |    9676 K  |    9675 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      50    |      50    |      50    |       0    |
|       from large pool |      13    |      13    |      13    |       0    |
|       from small pool |      37    |      37    |      37    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      31    |     479    |    7756 K  |    7756 K  |
|       from large pool |       5    |      10    |    2049 K  |    2049 K  |
|       from small pool |      26    |     474    |    5707 K  |    5707 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1436 MiB | 418099 GiB | 418099 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 417971 GiB | 417971 GiB |
|       from small pool |      0 KiB |     72 MiB |    127 GiB |    127 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1436 MiB | 418099 GiB | 418099 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 417971 GiB | 417971 GiB |
|       from small pool |      0 KiB |     72 MiB |    127 GiB |    127 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1428 MiB | 418075 GiB | 418075 GiB |
|       from large pool |  16640 KiB |   1358 MiB | 417950 GiB | 417950 GiB |
|       from small pool |      0 KiB |     71 MiB |    124 GiB |    124 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 524288 KiB |   1524 MiB |   1524 MiB |   1012 MiB |
|       from large pool | 479232 KiB |   1450 MiB |   1450 MiB |    982 MiB |
|       from small pool |  45056 KiB |     74 MiB |     74 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 298752 KiB | 628877 KiB | 300434 GiB | 300433 GiB |
|       from large pool | 298752 KiB | 627520 KiB | 300285 GiB | 300285 GiB |
|       from small pool |      0 KiB |  16375 KiB |    148 GiB |    148 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1965    |   14572 K  |   14572 K  |
|       from large pool |       2    |      76    |    4895 K  |    4895 K  |
|       from small pool |       0    |    1894    |    9676 K  |    9676 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1965    |   14572 K  |   14572 K  |
|       from large pool |       2    |      76    |    4895 K  |    4895 K  |
|       from small pool |       0    |    1894    |    9676 K  |    9676 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      50    |      50    |      19    |
|       from large pool |       9    |      13    |      13    |       4    |
|       from small pool |      22    |      37    |      37    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     479    |    7757 K  |    7757 K  |
|       from large pool |       1    |      11    |    2049 K  |    2049 K  |
|       from small pool |       0    |     474    |    5707 K  |    5707 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1436 MiB | 418099 GiB | 418099 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 417971 GiB | 417971 GiB |
|       from small pool |      0 KiB |     72 MiB |    127 GiB |    127 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1436 MiB | 418099 GiB | 418099 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 417971 GiB | 417971 GiB |
|       from small pool |      0 KiB |     72 MiB |    127 GiB |    127 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1428 MiB | 418075 GiB | 418075 GiB |
|       from large pool |  16640 KiB |   1358 MiB | 417950 GiB | 417950 GiB |
|       from small pool |      0 KiB |     71 MiB |    124 GiB |    124 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 524288 KiB |   1524 MiB |   1524 MiB |   1012 MiB |
|       from large pool | 479232 KiB |   1450 MiB |   1450 MiB |    982 MiB |
|       from small pool |  45056 KiB |     74 MiB |     74 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 298752 KiB | 628877 KiB | 300434 GiB | 300433 GiB |
|       from large pool | 298752 KiB | 627520 KiB | 300285 GiB | 300285 GiB |
|       from small pool |      0 KiB |  16375 KiB |    148 GiB |    148 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1965    |   14572 K  |   14572 K  |
|       from large pool |       2    |      76    |    4895 K  |    4895 K  |
|       from small pool |       0    |    1894    |    9676 K  |    9676 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1965    |   14572 K  |   14572 K  |
|       from large pool |       2    |      76    |    4895 K  |    4895 K  |
|       from small pool |       0    |    1894    |    9676 K  |    9676 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      50    |      50    |      19    |
|       from large pool |       9    |      13    |      13    |       4    |
|       from small pool |      22    |      37    |      37    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     479    |    7757 K  |    7757 K  |
|       from large pool |       1    |      11    |    2049 K  |    2049 K  |
|       from small pool |       0    |     474    |    5707 K  |    5707 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0




!!!: not committed yet



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_06_12_41_seed_1_21504644

 Experiment start at: 2024-06-19 06:12:41.269791
before training, model accuracy: 0.20428188145160675
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9484154, 'precision': 0.93972254, 'recall': 0.7371105, 'specificity': 0.7371105, 'f1': 0.80181843, 'auroc': 0.9472397, 'binary_precision': 0.93011725, 'binary_recall': 0.47787815, 'binary_specificity': 0.9963429, 'binary_f1_score': 0.63136953}
confusion matrix:
       0     1
0  42228   155
1   2254  2063
---- Validation: 
scalar performance:
{'acc': 0.96387404, 'precision': 0.56539804, 'recall': 0.50060457, 'specificity': 0.50060457, 'f1': 0.49227464, 'auroc': 0.5405422, 'binary_precision': 0.16666667, 'binary_recall': 0.0014858841, 'binary_specificity': 0.99972326, 'binary_f1_score': 0.0029455079}
confusion matrix:
       0  1
0  18062  5
1    672  1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88403213, 'precision': 0.44201607, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4692235, 'auroc': 0.5590835, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   780  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504644_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-19 06:32:18.774422,epoch time: 0:19:37.504631,used: 0:19:37.504631,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_06_12_41_seed_1_21504644
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97301924, 'precision': 0.9813757, 'recall': 0.85714304, 'specificity': 0.85714304, 'f1': 0.90799356, 'auroc': 0.97585917, 'binary_precision': 0.9910199, 'binary_recall': 0.7149468, 'binary_specificity': 0.9993393, 'binary_f1_score': 0.83064514}
confusion matrix:
       0     1
0  42350    28
1   1232  3090
---- Validation: 
scalar performance:
{'acc': 0.9652081, 'precision': 0.8051503, 'recall': 0.5341987, 'specificity': 0.5341987, 'f1': 0.55412805, 'auroc': 0.6567426, 'binary_precision': 0.6438356, 'binary_recall': 0.06983655, 'binary_specificity': 0.9985609, 'binary_f1_score': 0.12600535}
confusion matrix:
       0   1
0  18041  26
1    626  47
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8850728, 'precision': 0.7957046, 'recall': 0.5072719, 'specificity': 0.5072719, 'f1': 0.48451516, 'auroc': 0.69529617, 'binary_precision': 0.7058824, 'binary_recall': 0.015384615, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.030112924}
confusion matrix:
      0   1
0  5941   5
1   768  12
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504644_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-19 06:48:55.987940,epoch time: 0:16:37.213518,used: 0:36:14.718149,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_06_12_41_seed_1_21504644
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97877944, 'precision': 0.9806725, 'recall': 0.8914834, 'specificity': 0.8914834, 'f1': 0.9304507, 'auroc': 0.98500514, 'binary_precision': 0.9828936, 'binary_recall': 0.7843591, 'binary_specificity': 0.99860775, 'binary_f1_score': 0.8724746}
confusion matrix:
       0     1
0  42319    59
1    932  3390
---- Validation: 
scalar performance:
{'acc': 0.9657951, 'precision': 0.7947258, 'recall': 0.5595375, 'specificity': 0.5595375, 'f1': 0.59312445, 'auroc': 0.7193144, 'binary_precision': 0.6212121, 'binary_recall': 0.121842496, 'binary_specificity': 0.9972325, 'binary_f1_score': 0.20372671}
confusion matrix:
       0   1
0  18017  50
1    591  82
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89607495, 'precision': 0.8909768, 'recall': 0.5586063, 'specificity': 0.5586063, 'f1': 0.57727385, 'auroc': 0.7535602, 'binary_precision': 0.8857143, 'binary_recall': 0.11923077, 'binary_specificity': 0.99798185, 'binary_f1_score': 0.2101695}
confusion matrix:
      0   1
0  5934  12
1   687  93
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504644_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-19 07:06:09.901217,epoch time: 0:17:13.913277,used: 0:53:28.631426,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_06_12_41_seed_1_21504644
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9838972, 'precision': 0.9814594, 'recall': 0.9213323, 'specificity': 0.9213323, 'f1': 0.9489095, 'auroc': 0.9893309, 'binary_precision': 0.978558, 'binary_recall': 0.8445524, 'binary_specificity': 0.9981122, 'binary_f1_score': 0.9066303}
confusion matrix:
       0     1
0  42297    80
1    672  3651
---- Validation: 
scalar performance:
{'acc': 0.9659018, 'precision': 0.77597225, 'recall': 0.5874883, 'specificity': 0.5874883, 'f1': 0.6286142, 'auroc': 0.7557234, 'binary_precision': 0.5817308, 'binary_recall': 0.17979197, 'binary_specificity': 0.9951846, 'binary_f1_score': 0.27468786}
confusion matrix:
       0    1
0  17980   87
1    552  121
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9054416, 'precision': 0.89653003, 'recall': 0.6040033, 'specificity': 0.6040033, 'f1': 0.64533895, 'auroc': 0.7812859, 'binary_precision': 0.88709676, 'binary_recall': 0.21153846, 'binary_specificity': 0.9964682, 'binary_f1_score': 0.34161493}
confusion matrix:
      0    1
0  5925   21
1   615  165
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504644_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-19 07:23:20.029599,epoch time: 0:17:10.128382,used: 1:10:38.759808,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_06_12_41_seed_1_21504644
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98543894, 'precision': 0.97988725, 'recall': 0.9320487, 'specificity': 0.9320487, 'f1': 0.9544052, 'auroc': 0.9905155, 'binary_precision': 0.9732398, 'binary_recall': 0.86652786, 'binary_specificity': 0.99756944, 'binary_f1_score': 0.916789}
confusion matrix:
       0     1
0  42274   103
1    577  3746
---- Validation: 
scalar performance:
{'acc': 0.9660619, 'precision': 0.7798206, 'recall': 0.5882866, 'specificity': 0.5882866, 'f1': 0.62994784, 'auroc': 0.76032686, 'binary_precision': 0.589372, 'binary_recall': 0.18127786, 'binary_specificity': 0.9952953, 'binary_f1_score': 0.27727273}
confusion matrix:
       0    1
0  17982   85
1    551  122
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.906631, 'precision': 0.89190483, 'recall': 0.6113593, 'specificity': 0.6113593, 'f1': 0.655064, 'auroc': 0.78162175, 'binary_precision': 0.87623763, 'binary_recall': 0.22692308, 'binary_specificity': 0.9957955, 'binary_f1_score': 0.3604888}
confusion matrix:
      0    1
0  5921   25
1   603  177
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504644_5.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-06-19 07:43:07.446432,epoch time: 0:19:47.416833,used: 1:30:26.176641,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_06_12_41_seed_1_21504644
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98620987, 'precision': 0.97943664, 'recall': 0.9371472, 'specificity': 0.9371472, 'f1': 0.95707536, 'auroc': 0.9914892, 'binary_precision': 0.9713041, 'binary_recall': 0.8769373, 'binary_specificity': 0.9973571, 'binary_f1_score': 0.9217117}
confusion matrix:
       0     1
0  42265   112
1    532  3791
---- Validation: 
scalar performance:
{'acc': 0.9657951, 'precision': 0.7698674, 'recall': 0.59530085, 'specificity': 0.59530085, 'f1': 0.63709354, 'auroc': 0.787472, 'binary_precision': 0.5689655, 'binary_recall': 0.1961367, 'binary_specificity': 0.99446505, 'binary_f1_score': 0.2917127}
confusion matrix:
       0    1
0  17967  100
1    541  132
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91109127, 'precision': 0.90200305, 'recall': 0.6305901, 'specificity': 0.6305901, 'f1': 0.6805101, 'auroc': 0.81327444, 'binary_precision': 0.89224136, 'binary_recall': 0.2653846, 'binary_specificity': 0.9957955, 'binary_f1_score': 0.4090909}
confusion matrix:
      0    1
0  5921   25
1   573  207
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504644_6.png
new oracle model saved
early stop counter: 1
val acc:0.96579509973526, best validation acc: 0.9660618901252747, corresponding to test acc:                         0.9066309928894043 / 0.9110912680625916
after epoch: 6,now: 2024-06-19 08:04:55.606569,epoch time: 0:21:48.160137,used: 1:52:14.336778,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_06_12_41_seed_1_21504644
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98680943, 'precision': 0.979429, 'recall': 0.94080114, 'specificity': 0.94080114, 'f1': 0.9591032, 'auroc': 0.9921155, 'binary_precision': 0.9705509, 'binary_recall': 0.8843396, 'binary_specificity': 0.99726266, 'binary_f1_score': 0.9254418}
confusion matrix:
       0     1
0  42261   116
1    500  3823
---- Validation: 
scalar performance:
{'acc': 0.966222, 'precision': 0.7796642, 'recall': 0.59623754, 'specificity': 0.59623754, 'f1': 0.6392901, 'auroc': 0.79585195, 'binary_precision': 0.58849555, 'binary_recall': 0.19762258, 'binary_specificity': 0.9948525, 'binary_f1_score': 0.2958843}
confusion matrix:
       0    1
0  17974   93
1    540  133
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91124, 'precision': 0.89911747, 'recall': 0.63234496, 'specificity': 0.63234496, 'f1': 0.68248487, 'auroc': 0.8101742, 'binary_precision': 0.886076, 'binary_recall': 0.26923078, 'binary_specificity': 0.99545914, 'binary_f1_score': 0.41297936}
confusion matrix:
      0    1
0  5919   27
1   570  210
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504644_7.png
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-06-19 08:23:09.073644,epoch time: 0:18:13.467075,used: 2:10:27.803853,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_06_12_41_seed_1_21504644
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98946464, 'precision': 0.9834205, 'recall': 0.95303404, 'specificity': 0.95303404, 'f1': 0.9676115, 'auroc': 0.9933959, 'binary_precision': 0.9761194, 'binary_recall': 0.90833336, 'binary_specificity': 0.9977348, 'binary_f1_score': 0.94100714}
confusion matrix:
       0     1
0  42284    96
1    396  3924
---- Validation: 
scalar performance:
{'acc': 0.9667022, 'precision': 0.7904326, 'recall': 0.5986324, 'specificity': 0.5986324, 'f1': 0.64325744, 'auroc': 0.7872815, 'binary_precision': 0.6098655, 'binary_recall': 0.20208023, 'binary_specificity': 0.9951846, 'binary_f1_score': 0.30357143}
confusion matrix:
       0    1
0  17980   87
1    537  136
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90767175, 'precision': 0.8814429, 'recall': 0.62030196, 'specificity': 0.62030196, 'f1': 0.666099, 'auroc': 0.7869816, 'binary_precision': 0.85333335, 'binary_recall': 0.24615385, 'binary_specificity': 0.99445003, 'binary_f1_score': 0.38208956}
confusion matrix:
      0    1
0  5913   33
1   588  192
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504644_8.png
better model found
persisted
after epoch: 8,now: 2024-06-19 08:42:50.150543,epoch time: 0:19:41.076899,used: 2:30:08.880752,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_06_12_41_seed_1_21504644
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.989015, 'precision': 0.98215425, 'recall': 0.9515499, 'specificity': 0.9515499, 'f1': 0.9662254, 'auroc': 0.9942324, 'binary_precision': 0.9738676, 'binary_recall': 0.9055774, 'binary_specificity': 0.99752235, 'binary_f1_score': 0.9384818}
confusion matrix:
       0     1
0  42274   105
1    408  3913
---- Validation: 
scalar performance:
{'acc': 0.966809, 'precision': 0.78630424, 'recall': 0.61013204, 'specificity': 0.61013204, 'f1': 0.6556389, 'auroc': 0.8072543, 'binary_precision': 0.6007905, 'binary_recall': 0.22585438, 'binary_specificity': 0.9944097, 'binary_f1_score': 0.3282937}
confusion matrix:
       0    1
0  17966  101
1    521  152
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90767175, 'precision': 0.8860942, 'recall': 0.6186311, 'specificity': 0.6186311, 'f1': 0.66425544, 'auroc': 0.80873775, 'binary_precision': 0.8630137, 'binary_recall': 0.2423077, 'binary_specificity': 0.9949546, 'binary_f1_score': 0.37837836}
confusion matrix:
      0    1
0  5916   30
1   591  189
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504644_9.png
better model found
persisted
after epoch: 9,now: 2024-06-19 09:02:50.564894,epoch time: 0:20:00.414351,used: 2:50:09.295103,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_06_12_41_seed_1_21504644
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9889507, 'precision': 0.98052853, 'recall': 0.952772, 'specificity': 0.952772, 'f1': 0.96613413, 'auroc': 0.9941143, 'binary_precision': 0.9703411, 'binary_recall': 0.90837574, 'binary_specificity': 0.99716836, 'binary_f1_score': 0.93833655}
confusion matrix:
       0     1
0  42258   120
1    396  3926
---- Validation: 
scalar performance:
{'acc': 0.9668623, 'precision': 0.7899234, 'recall': 0.6058681, 'specificity': 0.6058681, 'f1': 0.6514211, 'auroc': 0.8159198, 'binary_precision': 0.60833335, 'binary_recall': 0.21693908, 'binary_specificity': 0.99479717, 'binary_f1_score': 0.31982473}
confusion matrix:
       0    1
0  17973   94
1    527  146
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90484685, 'precision': 0.87178254, 'recall': 0.6086794, 'specificity': 0.6086794, 'f1': 0.65043944, 'auroc': 0.8221951, 'binary_precision': 0.83653843, 'binary_recall': 0.22307692, 'binary_specificity': 0.9942819, 'binary_f1_score': 0.35222673}
confusion matrix:
      0    1
0  5912   34
1   606  174
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504644_10.png
better model found
persisted
after epoch: 10,now: 2024-06-19 09:23:39.728297,epoch time: 0:20:49.163403,used: 3:10:58.458506,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_06_12_41_seed_1_21504644
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9892077, 'precision': 0.98378074, 'recall': 0.9511144, 'specificity': 0.9511144, 'f1': 0.9667352, 'auroc': 0.9951453, 'binary_precision': 0.97723293, 'binary_recall': 0.90437603, 'binary_specificity': 0.9978528, 'binary_f1_score': 0.93939394}
confusion matrix:
       0     1
0  42290    91
1    413  3906
---- Validation: 
scalar performance:
{'acc': 0.9665422, 'precision': 0.79556674, 'recall': 0.5856746, 'specificity': 0.5856746, 'f1': 0.6281707, 'auroc': 0.81731737, 'binary_precision': 0.6210526, 'binary_recall': 0.17533432, 'binary_specificity': 0.99601483, 'binary_f1_score': 0.27346465}
confusion matrix:
       0    1
0  17995   72
1    555  118
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8962236, 'precision': 0.8667003, 'recall': 0.5637028, 'specificity': 0.5637028, 'f1': 0.58527327, 'auroc': 0.82787085, 'binary_precision': 0.8360656, 'binary_recall': 0.13076924, 'binary_specificity': 0.9966364, 'binary_f1_score': 0.22616409}
confusion matrix:
      0    1
0  5926   20
1   678  102
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504644_11.png
early stop counter: 1
val acc:0.9665421843528748, best validation acc: 0.9668623208999634, corresponding to test acc:                         0.9048468470573425 / 0.9112399816513062
after epoch: 11,now: 2024-06-19 09:43:59.258636,epoch time: 0:20:19.530339,used: 3:31:17.988845,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_06_12_41_seed_1_21504644
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9903212, 'precision': 0.98636556, 'recall': 0.95540726, 'specificity': 0.95540726, 'f1': 0.9702512, 'auroc': 0.99478817, 'binary_precision': 0.98158747, 'binary_recall': 0.9125607, 'binary_specificity': 0.99825376, 'binary_f1_score': 0.9458164}
confusion matrix:
       0     1
0  42303    74
1    378  3945
---- Validation: 
scalar performance:
{'acc': 0.96659553, 'precision': 0.79203284, 'recall': 0.59213966, 'specificity': 0.59213966, 'f1': 0.63576627, 'auroc': 0.81487495, 'binary_precision': 0.6135266, 'binary_recall': 0.18870728, 'binary_specificity': 0.99557203, 'binary_f1_score': 0.28863636}
confusion matrix:
       0    1
0  17987   80
1    546  127
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8988998, 'precision': 0.8586694, 'recall': 0.5802537, 'specificity': 0.5802537, 'f1': 0.61035705, 'auroc': 0.8159319, 'binary_precision': 0.8164557, 'binary_recall': 0.16538462, 'binary_specificity': 0.9951228, 'binary_f1_score': 0.27505332}
confusion matrix:
      0    1
0  5917   29
1   651  129
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504644_12.png
early stop counter: 2
val acc:0.9665955305099487, best validation acc: 0.9668623208999634, corresponding to test acc:                         0.9048468470573425 / 0.9112399816513062
after epoch: 12,now: 2024-06-19 10:03:04.352769,epoch time: 0:19:05.094133,used: 3:50:23.082978,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_06_12_41_seed_1_21504644
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99029976, 'precision': 0.9863516, 'recall': 0.95529157, 'specificity': 0.95529157, 'f1': 0.97018206, 'auroc': 0.99530244, 'binary_precision': 0.9815829, 'binary_recall': 0.9123294, 'binary_specificity': 0.99825376, 'binary_f1_score': 0.9456899}
confusion matrix:
       0     1
0  42303    74
1    379  3944
---- Validation: 
scalar performance:
{'acc': 0.9664888, 'precision': 0.7900952, 'recall': 0.5906538, 'specificity': 0.5906538, 'f1': 0.63379025, 'auroc': 0.81935143, 'binary_precision': 0.6097561, 'binary_recall': 0.18573551, 'binary_specificity': 0.99557203, 'binary_f1_score': 0.28473803}
confusion matrix:
       0    1
0  17987   80
1    548  125
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89711565, 'precision': 0.85030496, 'recall': 0.5725614, 'specificity': 0.5725614, 'f1': 0.59872735, 'auroc': 0.81234217, 'binary_precision': 0.80136985, 'binary_recall': 0.15, 'binary_specificity': 0.9951228, 'binary_f1_score': 0.2526998}
confusion matrix:
      0    1
0  5917   29
1   663  117
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504644_13.png
early stop counter: 3
val acc:0.966488778591156, best validation acc: 0.9668623208999634, corresponding to test acc:                         0.9048468470573425 / 0.9112399816513062
after epoch: 13,now: 2024-06-19 10:22:07.647975,epoch time: 0:19:03.295206,used: 4:09:26.378184,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_06_12_41_seed_1_21504644
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.990621, 'precision': 0.98720574, 'recall': 0.9563836, 'specificity': 0.9563836, 'f1': 0.9711663, 'auroc': 0.9953762, 'binary_precision': 0.9830804, 'binary_recall': 0.91437167, 'binary_specificity': 0.99839544, 'binary_f1_score': 0.947482}
confusion matrix:
       0     1
0  42311    68
1    370  3951
---- Validation: 
scalar performance:
{'acc': 0.9667556, 'precision': 0.80224794, 'recall': 0.58578527, 'specificity': 0.58578527, 'f1': 0.628863, 'auroc': 0.8145474, 'binary_precision': 0.6344086, 'binary_recall': 0.17533432, 'binary_specificity': 0.9962362, 'binary_f1_score': 0.27473804}
confusion matrix:
       0    1
0  17999   68
1    555  118
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89592624, 'precision': 0.8526788, 'recall': 0.56520545, 'specificity': 0.56520545, 'f1': 0.5874784, 'auroc': 0.8015655, 'binary_precision': 0.8076923, 'binary_recall': 0.13461539, 'binary_specificity': 0.9957955, 'binary_f1_score': 0.23076923}
confusion matrix:
      0    1
0  5921   25
1   675  105
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504644_14.png
early stop counter: 4
val acc:0.9667556285858154, best validation acc: 0.9668623208999634, corresponding to test acc:                         0.9048468470573425 / 0.9112399816513062
after epoch: 14,now: 2024-06-19 10:40:57.137575,epoch time: 0:18:49.489600,used: 4:28:15.867784,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_06_12_41_seed_1_21504644
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99104923, 'precision': 0.9867306, 'recall': 0.95944357, 'specificity': 0.95944357, 'f1': 0.9725956, 'auroc': 0.9955234, 'binary_precision': 0.9815043, 'binary_recall': 0.920657, 'binary_specificity': 0.99823016, 'binary_f1_score': 0.95010746}
confusion matrix:
       0     1
0  42302    75
1    343  3980
---- Validation: 
scalar performance:
{'acc': 0.966809, 'precision': 0.79808056, 'recall': 0.59225035, 'specificity': 0.59225035, 'f1': 0.63648087, 'auroc': 0.82025266, 'binary_precision': 0.6256158, 'binary_recall': 0.18870728, 'binary_specificity': 0.99579346, 'binary_f1_score': 0.28995433}
confusion matrix:
       0    1
0  17991   76
1    546  127
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89592624, 'precision': 0.8526788, 'recall': 0.56520545, 'specificity': 0.56520545, 'f1': 0.5874784, 'auroc': 0.81470853, 'binary_precision': 0.8076923, 'binary_recall': 0.13461539, 'binary_specificity': 0.9957955, 'binary_f1_score': 0.23076923}
confusion matrix:
      0    1
0  5921   25
1   675  105
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504644_15.png
early stop counter: 5
val acc:0.9668089747428894, best validation acc: 0.9668623208999634, corresponding to test acc:                         0.9048468470573425 / 0.9112399816513062
after epoch: 15,now: 2024-06-19 10:59:35.784117,epoch time: 0:18:38.646542,used: 4:46:54.514326,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_06_12_41_seed_1_21504644
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99169165, 'precision': 0.9858774, 'recall': 0.9641517, 'specificity': 0.9641517, 'f1': 0.9747038, 'auroc': 0.99570996, 'binary_precision': 0.9788218, 'binary_recall': 0.9303563, 'binary_specificity': 0.99794704, 'binary_f1_score': 0.9539739}
confusion matrix:
       0     1
0  42291    87
1    301  4021
---- Validation: 
scalar performance:
{'acc': 0.9664888, 'precision': 0.7876697, 'recall': 0.5942301, 'specificity': 0.5942301, 'f1': 0.6378153, 'auroc': 0.8336623, 'binary_precision': 0.60465115, 'binary_recall': 0.19316493, 'binary_specificity': 0.9952953, 'binary_f1_score': 0.29279277}
confusion matrix:
       0    1
0  17982   85
1    543  130
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8935474, 'precision': 0.81774944, 'recall': 0.5605184, 'specificity': 0.5605184, 'f1': 0.57976186, 'auroc': 0.81765, 'binary_precision': 0.73880595, 'binary_recall': 0.12692308, 'binary_specificity': 0.9941137, 'binary_f1_score': 0.2166302}
confusion matrix:
      0   1
0  5911  35
1   681  99
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504644_16.png
early stop counter: 6
val acc:0.966488778591156, best validation acc: 0.9668623208999634, corresponding to test acc:                         0.9048468470573425 / 0.9112399816513062
after epoch: 16,now: 2024-06-19 11:26:42.985903,epoch time: 0:27:07.201786,used: 5:14:01.716112,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_06_12_41_seed_1_21504644
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99201286, 'precision': 0.9879857, 'recall': 0.9639926, 'specificity': 0.9639926, 'f1': 0.9756113, 'auroc': 0.99686587, 'binary_precision': 0.9831048, 'binary_recall': 0.92961335, 'binary_specificity': 0.9983719, 'binary_f1_score': 0.9556111}
confusion matrix:
       0     1
0  42312    69
1    304  4015
---- Validation: 
scalar performance:
{'acc': 0.9665422, 'precision': 0.79556674, 'recall': 0.5856746, 'specificity': 0.5856746, 'f1': 0.6281707, 'auroc': 0.83298177, 'binary_precision': 0.6210526, 'binary_recall': 0.17533432, 'binary_specificity': 0.99601483, 'binary_f1_score': 0.27346465}
confusion matrix:
       0    1
0  17995   72
1    555  118
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8917633, 'precision': 0.8153553, 'recall': 0.5494845, 'specificity': 0.5494845, 'f1': 0.56203496, 'auroc': 0.8168654, 'binary_precision': 0.73636365, 'binary_recall': 0.103846155, 'binary_specificity': 0.9951228, 'binary_f1_score': 0.18202248}
confusion matrix:
      0   1
0  5917  29
1   699  81
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504644_17.png
early stop counter: 7
val acc:0.9665421843528748, best validation acc: 0.9668623208999634, corresponding to test acc:                         0.9048468470573425 / 0.9112399816513062
after epoch: 17,now: 2024-06-19 11:59:29.772092,epoch time: 0:32:46.786189,used: 5:46:48.502301,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_06_12_41_seed_1_21504644
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9915846, 'precision': 0.9866463, 'recall': 0.9627254, 'specificity': 0.9627254, 'f1': 0.97430915, 'auroc': 0.99640787, 'binary_precision': 0.980661, 'binary_recall': 0.9273148, 'binary_specificity': 0.9981359, 'binary_f1_score': 0.9532421}
confusion matrix:
       0     1
0  42301    79
1    314  4006
---- Validation: 
scalar performance:
{'acc': 0.9665422, 'precision': 0.7988027, 'recall': 0.58209825, 'specificity': 0.58209825, 'f1': 0.62391436, 'auroc': 0.83321005, 'binary_precision': 0.62777776, 'binary_recall': 0.1679049, 'binary_specificity': 0.9962916, 'binary_f1_score': 0.26494724}
confusion matrix:
       0    1
0  18000   67
1    560  113
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89131725, 'precision': 0.8114568, 'recall': 0.5475614, 'specificity': 0.5475614, 'f1': 0.5588481, 'auroc': 0.82248306, 'binary_precision': 0.72897196, 'binary_recall': 0.1, 'binary_specificity': 0.9951228, 'binary_f1_score': 0.17587373}
confusion matrix:
      0   1
0  5917  29
1   702  78
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504644_18.png
early stop counter: 8
val acc:0.9665421843528748, best validation acc: 0.9668623208999634, corresponding to test acc:                         0.9048468470573425 / 0.9112399816513062
after epoch: 18,now: 2024-06-19 12:21:31.243486,epoch time: 0:22:01.471394,used: 6:08:49.973695,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_06_12_41_seed_1_21504644
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99149895, 'precision': 0.9838824, 'recall': 0.96500385, 'specificity': 0.96500385, 'f1': 0.9742079, 'auroc': 0.99637115, 'binary_precision': 0.9746254, 'binary_recall': 0.9324855, 'binary_specificity': 0.9975221, 'binary_f1_score': 0.9530899}
confusion matrix:
       0     1
0  42270   105
1    292  4033
---- Validation: 
scalar performance:
{'acc': 0.96568835, 'precision': 0.76794094, 'recall': 0.59381497, 'specificity': 0.59381497, 'f1': 0.6351749, 'auroc': 0.8344451, 'binary_precision': 0.5652174, 'binary_recall': 0.19316493, 'binary_specificity': 0.99446505, 'binary_f1_score': 0.28792912}
confusion matrix:
       0    1
0  17967  100
1    543  130
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8925067, 'precision': 0.7993554, 'recall': 0.5599297, 'specificity': 0.5599297, 'f1': 0.57864344, 'auroc': 0.8148762, 'binary_precision': 0.70212764, 'binary_recall': 0.12692308, 'binary_specificity': 0.99293643, 'binary_f1_score': 0.21498373}
confusion matrix:
      0   1
0  5904  42
1   681  99
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504644_19.png
