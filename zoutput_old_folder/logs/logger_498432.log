Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0




!!!: not committed yet



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316513

 Experiment start at: 2024-06-13 16:52:51.591088
before training, model accuracy: 0.9563758969306946
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9674598, 'precision': 0.7953759, 'recall': 0.5398984, 'specificity': 0.5398984, 'f1': 0.56377935, 'auroc': 0.94603974, 'binary_precision': 0.6217617, 'binary_recall': 0.08152174, 'binary_specificity': 0.99827504, 'binary_f1_score': 0.14414415}
confusion matrix:
       0    1
0  42247   73
1   1352  120
---- Validation: 
scalar performance:
{'acc': 0.9660494, 'precision': 0.7625623, 'recall': 0.51813906, 'specificity': 0.51813906, 'f1': 0.52633995, 'auroc': 0.9418082, 'binary_precision': 0.55813956, 'binary_recall': 0.03732504, 'binary_specificity': 0.9989531, 'binary_f1_score': 0.069970846}
confusion matrix:
       0   1
0  18130  19
1    619  24
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.9236328, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316513_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-13 17:21:59.524595,epoch time: 0:29:07.933507,used: 0:29:07.933507,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316513
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9694008, 'precision': 0.7629678, 'recall': 0.78980243, 'specificity': 0.78980243, 'f1': 0.7756616, 'auroc': 0.94704235, 'binary_precision': 0.5399754, 'binary_recall': 0.5972789, 'binary_specificity': 0.982326, 'binary_f1_score': 0.5671835}
confusion matrix:
       0    1
0  41574  748
1    592  878
---- Validation: 
scalar performance:
{'acc': 0.9671669, 'precision': 0.75156146, 'recall': 0.781987, 'specificity': 0.781987, 'f1': 0.76580524, 'auroc': 0.9418681, 'binary_precision': 0.5179558, 'binary_recall': 0.58320373, 'binary_specificity': 0.9807703, 'binary_f1_score': 0.5486466}
confusion matrix:
       0    1
0  17800  349
1    268  375
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9705976, 'precision': 0.88633525, 'recall': 0.69515026, 'specificity': 0.69515026, 'f1': 0.75651556, 'auroc': 0.91738576, 'binary_precision': 0.79844964, 'binary_recall': 0.394636, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.5282051}
confusion matrix:
      0    1
0  5971   26
1   158  103
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316513_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-13 17:49:53.846599,epoch time: 0:27:54.322004,used: 0:57:02.255511,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316513
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9707937, 'precision': 0.7999419, 'recall': 0.6620484, 'specificity': 0.6620484, 'f1': 0.7086619, 'auroc': 0.94941163, 'binary_precision': 0.62276214, 'binary_recall': 0.3310673, 'binary_specificity': 0.9930295, 'binary_f1_score': 0.4323125}
confusion matrix:
       0    1
0  42026  295
1    984  487
---- Validation: 
scalar performance:
{'acc': 0.9683376, 'precision': 0.77224797, 'recall': 0.6505834, 'specificity': 0.6505834, 'f1': 0.6922724, 'auroc': 0.9442874, 'binary_precision': 0.56857145, 'binary_recall': 0.30948678, 'binary_specificity': 0.99167997, 'binary_f1_score': 0.40080565}
confusion matrix:
       0    1
0  17998  151
1    444  199
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589326, 'precision': 0.8961932, 'recall': 0.50949514, 'specificity': 0.50949514, 'f1': 0.50823593, 'auroc': 0.9059287, 'binary_precision': 0.8333333, 'binary_recall': 0.019157087, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.037453182}
confusion matrix:
      0  1
0  5996  1
1   256  5
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316513_3.png
better model found
persisted
after epoch: 3,now: 2024-06-13 18:18:07.692792,epoch time: 0:28:13.846193,used: 1:25:16.101704,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316513
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97294027, 'precision': 0.8118717, 'recall': 0.71486, 'specificity': 0.71486, 'f1': 0.75364447, 'auroc': 0.9524271, 'binary_precision': 0.6430708, 'binary_recall': 0.43817934, 'binary_specificity': 0.9915407, 'binary_f1_score': 0.52121216}
confusion matrix:
       0    1
0  41962  358
1    827  645
---- Validation: 
scalar performance:
{'acc': 0.9695083, 'precision': 0.7769234, 'recall': 0.70519346, 'specificity': 0.70519346, 'f1': 0.7351933, 'auroc': 0.94872653, 'binary_precision': 0.5741525, 'binary_recall': 0.4214619, 'binary_specificity': 0.988925, 'binary_f1_score': 0.48609868}
confusion matrix:
       0    1
0  17948  201
1    372  271
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96356666, 'precision': 0.9006511, 'recall': 0.57787704, 'specificity': 0.57787704, 'f1': 0.6229184, 'auroc': 0.92159796, 'binary_precision': 0.8367347, 'binary_recall': 0.15708812, 'binary_specificity': 0.998666, 'binary_f1_score': 0.26451614}
confusion matrix:
      0   1
0  5989   8
1   220  41
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316513_4.png
better model found
persisted
after epoch: 4,now: 2024-06-13 18:46:40.401338,epoch time: 0:28:32.708546,used: 1:53:48.810250,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316513
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97168434, 'precision': 0.80950594, 'recall': 0.6749766, 'specificity': 0.6749766, 'f1': 0.7219887, 'auroc': 0.95720184, 'binary_precision': 0.64102566, 'binary_recall': 0.35690007, 'binary_specificity': 0.9930531, 'binary_f1_score': 0.4585153}
confusion matrix:
       0    1
0  42027  294
1    946  525
---- Validation: 
scalar performance:
{'acc': 0.968923, 'precision': 0.78395003, 'recall': 0.6433859, 'specificity': 0.6433859, 'f1': 0.6884923, 'auroc': 0.9527597, 'binary_precision': 0.5924765, 'binary_recall': 0.29393467, 'binary_specificity': 0.9928371, 'binary_f1_score': 0.39293137}
confusion matrix:
       0    1
0  18019  130
1    454  189
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.8366661, 'recall': 0.5094118, 'specificity': 0.5094118, 'f1': 0.50812435, 'auroc': 0.924947, 'binary_precision': 0.71428573, 'binary_recall': 0.019157087, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.037313428}
confusion matrix:
      0  1
0  5995  2
1   256  5
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316513_5.png
early stop counter: 1
val acc:0.9689229726791382, best validation acc: 0.9695082902908325, corresponding to test acc:                         0.9635666608810425 / 0.9705976247787476
after epoch: 5,now: 2024-06-13 19:15:13.201171,epoch time: 0:28:32.799833,used: 2:22:21.610083,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316513
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97319144, 'precision': 0.80736345, 'recall': 0.73662865, 'specificity': 0.73662865, 'f1': 0.766976, 'auroc': 0.957589, 'binary_precision': 0.6325623, 'binary_recall': 0.4830163, 'binary_specificity': 0.990241, 'binary_f1_score': 0.5477658}
confusion matrix:
       0    1
0  41907  413
1    761  711
---- Validation: 
scalar performance:
{'acc': 0.97009367, 'precision': 0.788048, 'recall': 0.68824524, 'specificity': 0.68824524, 'f1': 0.7267114, 'auroc': 0.9490513, 'binary_precision': 0.5975904, 'binary_recall': 0.38569206, 'binary_specificity': 0.9907984, 'binary_f1_score': 0.4688091}
confusion matrix:
       0    1
0  17982  167
1    395  248
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.86909723, 'recall': 0.52648646, 'specificity': 0.52648646, 'f1': 0.5399234, 'auroc': 0.9159539, 'binary_precision': 0.7777778, 'binary_recall': 0.053639848, 'binary_specificity': 0.999333, 'binary_f1_score': 0.100358434}
confusion matrix:
      0   1
0  5993   4
1   247  14
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316513_6.png
better model found
persisted
after epoch: 6,now: 2024-06-13 19:43:51.734243,epoch time: 0:28:38.533072,used: 2:51:00.143155,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316513
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9717985, 'precision': 0.81937116, 'recall': 0.6618118, 'specificity': 0.6618118, 'f1': 0.7127222, 'auroc': 0.9554415, 'binary_precision': 0.66166437, 'binary_recall': 0.3294837, 'binary_specificity': 0.9941399, 'binary_f1_score': 0.43990928}
confusion matrix:
       0    1
0  42072  248
1    987  485
---- Validation: 
scalar performance:
{'acc': 0.9688165, 'precision': 0.8003572, 'recall': 0.6065781, 'specificity': 0.6065781, 'f1': 0.65368307, 'auroc': 0.94749904, 'binary_precision': 0.62780267, 'binary_recall': 0.21772939, 'binary_specificity': 0.9954268, 'binary_f1_score': 0.32332563}
confusion matrix:
       0    1
0  18066   83
1    503  140
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9600511, 'precision': 0.8750222, 'recall': 0.52840215, 'specificity': 0.52840215, 'f1': 0.54335564, 'auroc': 0.922343, 'binary_precision': 0.7894737, 'binary_recall': 0.057471264, 'binary_specificity': 0.999333, 'binary_f1_score': 0.10714286}
confusion matrix:
      0   1
0  5993   4
1   246  15
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316513_7.png
early stop counter: 1
val acc:0.9688165187835693, best validation acc: 0.9700936675071716, corresponding to test acc:                         0.9598913192749023 / 0.9705976247787476
after epoch: 7,now: 2024-06-13 20:12:30.460841,epoch time: 0:28:38.726598,used: 3:19:38.869753,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316513
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97157013, 'precision': 0.77980256, 'recall': 0.79171765, 'specificity': 0.79171765, 'f1': 0.7856229, 'auroc': 0.9564779, 'binary_precision': 0.5735677, 'binary_recall': 0.5989123, 'binary_specificity': 0.98452306, 'binary_f1_score': 0.58596605}
confusion matrix:
       0    1
0  41666  655
1    590  881
---- Validation: 
scalar performance:
{'acc': 0.9678587, 'precision': 0.75635076, 'recall': 0.7793449, 'specificity': 0.7793449, 'f1': 0.7672977, 'auroc': 0.94610137, 'binary_precision': 0.5277383, 'binary_recall': 0.5769829, 'binary_specificity': 0.981707, 'binary_f1_score': 0.551263}
confusion matrix:
       0    1
0  17817  332
1    272  371
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642058, 'precision': 0.8033049, 'recall': 0.66249794, 'specificity': 0.66249794, 'f1': 0.70935047, 'auroc': 0.9176681, 'binary_precision': 0.63503647, 'binary_recall': 0.33333334, 'binary_specificity': 0.9916625, 'binary_f1_score': 0.4371859}
confusion matrix:
      0   1
0  5947  50
1   174  87
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316513_8.png
early stop counter: 2
val acc:0.9678586721420288, best validation acc: 0.9700936675071716, corresponding to test acc:                         0.9598913192749023 / 0.9705976247787476
after epoch: 8,now: 2024-06-13 20:41:14.117588,epoch time: 0:28:43.656747,used: 3:48:22.526500,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316513
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9703827, 'precision': 0.7695508, 'recall': 0.804227, 'specificity': 0.804227, 'f1': 0.785726, 'auroc': 0.95665616, 'binary_precision': 0.5521583, 'binary_recall': 0.6261047, 'binary_specificity': 0.9823492, 'binary_f1_score': 0.5868111}
confusion matrix:
       0    1
0  41574  747
1    550  921
---- Validation: 
scalar performance:
{'acc': 0.9705726, 'precision': 0.77981234, 'recall': 0.75749826, 'specificity': 0.75749826, 'f1': 0.76814383, 'auroc': 0.95145595, 'binary_precision': 0.5762712, 'binary_recall': 0.5287714, 'binary_specificity': 0.9862251, 'binary_f1_score': 0.55150044}
confusion matrix:
       0    1
0  17899  250
1    303  340
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959412, 'precision': 0.7736223, 'recall': 0.54455966, 'specificity': 0.54455966, 'f1': 0.5690723, 'auroc': 0.92212343, 'binary_precision': 0.58536583, 'binary_recall': 0.09195402, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.15894039}
confusion matrix:
      0   1
0  5980  17
1   237  24
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316513_9.png
better model found
persisted
after epoch: 9,now: 2024-06-13 21:10:04.108657,epoch time: 0:28:49.991069,used: 4:17:12.517569,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316513
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.97255206, 'precision': 0.7936869, 'recall': 0.76040095, 'specificity': 0.76040095, 'f1': 0.7759464, 'auroc': 0.95362145, 'binary_precision': 0.6035412, 'binary_recall': 0.5329708, 'binary_specificity': 0.9878311, 'binary_f1_score': 0.56606495}
confusion matrix:
       0    1
0  41806  515
1    687  784
---- Validation: 
scalar performance:
{'acc': 0.97035974, 'precision': 0.78496206, 'recall': 0.7146349, 'specificity': 0.7146349, 'f1': 0.7443652, 'auroc': 0.949456, 'binary_precision': 0.58958334, 'binary_recall': 0.44012442, 'binary_specificity': 0.9891454, 'binary_f1_score': 0.5040071}
confusion matrix:
       0    1
0  17952  197
1    360  283
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96276766, 'precision': 0.83016753, 'recall': 0.5939512, 'specificity': 0.5939512, 'f1': 0.6405876, 'auroc': 0.92809623, 'binary_precision': 0.6944444, 'binary_recall': 0.19157088, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.3003003}
confusion matrix:
      0   1
0  5975  22
1   211  50
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316513_10.png
early stop counter: 1
val acc:0.970359742641449, best validation acc: 0.9705725908279419, corresponding to test acc:                         0.9594119787216187 / 0.9705976247787476
after epoch: 10,now: 2024-06-13 21:38:55.905480,epoch time: 0:28:51.796823,used: 4:46:04.314392,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316513
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96930945, 'precision': 0.9107244, 'recall': 0.55233043, 'specificity': 0.55233043, 'f1': 0.5858919, 'auroc': 0.95843977, 'binary_precision': 0.85164833, 'binary_recall': 0.105298914, 'binary_specificity': 0.999362, 'binary_f1_score': 0.18742442}
confusion matrix:
       0    1
0  42293   27
1   1317  155
---- Validation: 
scalar performance:
{'acc': 0.9669008, 'precision': 0.875523, 'recall': 0.52233016, 'specificity': 0.52233016, 'f1': 0.5342198, 'auroc': 0.94697833, 'binary_precision': 0.7837838, 'binary_recall': 0.045101088, 'binary_specificity': 0.9995592, 'binary_f1_score': 0.08529412}
confusion matrix:
       0   1
0  18141   8
1    614  29
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.7292199, 'recall': 0.5018323, 'specificity': 0.5018323, 'f1': 0.49315178, 'auroc': 0.90580213, 'binary_precision': 0.5, 'binary_recall': 0.0038314175, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.007604562}
confusion matrix:
      0  1
0  5996  1
1   260  1
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316513_11.png
early stop counter: 2
val acc:0.9669008255004883, best validation acc: 0.9705725908279419, corresponding to test acc:                         0.9594119787216187 / 0.9705976247787476
after epoch: 11,now: 2024-06-13 22:07:34.548538,epoch time: 0:28:38.643058,used: 5:14:42.957450,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316513
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.973808, 'precision': 0.8498957, 'recall': 0.6772773, 'specificity': 0.6772773, 'f1': 0.7331922, 'auroc': 0.9570306, 'binary_precision': 0.72169167, 'binary_recall': 0.359375, 'binary_specificity': 0.9951796, 'binary_f1_score': 0.47981858}
confusion matrix:
       0    1
0  42116  204
1    943  529
---- Validation: 
scalar performance:
{'acc': 0.9705726, 'precision': 0.8670653, 'recall': 0.60073674, 'specificity': 0.60073674, 'f1': 0.65321624, 'auroc': 0.95259875, 'binary_precision': 0.7616279, 'binary_recall': 0.2037325, 'binary_specificity': 0.9977409, 'binary_f1_score': 0.3214724}
confusion matrix:
       0    1
0  18108   41
1    512  131
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.92551243, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316513_12.png
early stop counter: 3
val acc:0.9705725908279419, best validation acc: 0.9705725908279419, corresponding to test acc:                         0.9594119787216187 / 0.9705976247787476
after epoch: 12,now: 2024-06-13 22:36:05.492036,epoch time: 0:28:30.943498,used: 5:43:13.900948,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316513
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9721867, 'precision': 0.80929106, 'recall': 0.69274724, 'specificity': 0.69274724, 'f1': 0.7363239, 'auroc': 0.96055233, 'binary_precision': 0.6393805, 'binary_recall': 0.39319727, 'binary_specificity': 0.9922972, 'binary_f1_score': 0.48694187}
confusion matrix:
       0    1
0  41996  326
1    892  578
---- Validation: 
scalar performance:
{'acc': 0.97046614, 'precision': 0.7994333, 'recall': 0.6711868, 'specificity': 0.6711868, 'f1': 0.7162943, 'auroc': 0.9521569, 'binary_precision': 0.621547, 'binary_recall': 0.34992224, 'binary_specificity': 0.99245137, 'binary_f1_score': 0.4477612}
confusion matrix:
       0    1
0  18012  137
1    418  225
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9603707, 'precision': 0.8852012, 'recall': 0.53223354, 'specificity': 0.53223354, 'f1': 0.550148, 'auroc': 0.93012965, 'binary_precision': 0.8095238, 'binary_recall': 0.0651341, 'binary_specificity': 0.999333, 'binary_f1_score': 0.120567374}
confusion matrix:
      0   1
0  5993   4
1   244  17
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316513_13.png
early stop counter: 4
val acc:0.970466136932373, best validation acc: 0.9705725908279419, corresponding to test acc:                         0.9594119787216187 / 0.9705976247787476
after epoch: 13,now: 2024-06-13 23:04:58.182120,epoch time: 0:28:52.690084,used: 6:12:06.591032,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316513
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9736025, 'precision': 0.8284485, 'recall': 0.7017604, 'specificity': 0.7017604, 'f1': 0.7487167, 'auroc': 0.96004796, 'binary_precision': 0.67713004, 'binary_recall': 0.4103261, 'binary_specificity': 0.9931947, 'binary_f1_score': 0.5109983}
confusion matrix:
       0    1
0  42032  288
1    868  604
---- Validation: 
scalar performance:
{'acc': 0.97078544, 'precision': 0.8409747, 'recall': 0.6225985, 'specificity': 0.6225985, 'f1': 0.6766432, 'auroc': 0.95147914, 'binary_precision': 0.7079646, 'binary_recall': 0.2488336, 'binary_specificity': 0.99636346, 'binary_f1_score': 0.36823934}
confusion matrix:
       0    1
0  18083   66
1    483  160
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589326, 'precision': 0.8130804, 'recall': 0.5149922, 'specificity': 0.5149922, 'f1': 0.51880825, 'auroc': 0.9288514, 'binary_precision': 0.6666667, 'binary_recall': 0.03065134, 'binary_specificity': 0.999333, 'binary_f1_score': 0.058608055}
confusion matrix:
      0  1
0  5993  4
1   253  8
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316513_14.png
better model found
persisted
after epoch: 14,now: 2024-06-13 23:34:04.192240,epoch time: 0:29:06.010120,used: 6:41:12.601152,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316513
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.97387654, 'precision': 0.8116039, 'recall': 0.74944174, 'specificity': 0.74944174, 'f1': 0.7767633, 'auroc': 0.9585382, 'binary_precision': 0.64017093, 'binary_recall': 0.5088315, 'binary_specificity': 0.990052, 'binary_f1_score': 0.5669947}
confusion matrix:
       0    1
0  41899  421
1    723  749
---- Validation: 
scalar performance:
{'acc': 0.97195613, 'precision': 0.8291211, 'recall': 0.6667078, 'specificity': 0.6667078, 'f1': 0.7191806, 'auroc': 0.95091903, 'binary_precision': 0.68125, 'binary_recall': 0.33903578, 'binary_specificity': 0.9943799, 'binary_f1_score': 0.45275185}
confusion matrix:
       0    1
0  18047  102
1    425  218
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.957814, 'precision': 0.6940837, 'recall': 0.5162409, 'specificity': 0.5162409, 'f1': 0.5211253, 'auroc': 0.91854626, 'binary_precision': 0.42857143, 'binary_recall': 0.03448276, 'binary_specificity': 0.997999, 'binary_f1_score': 0.06382979}
confusion matrix:
      0   1
0  5985  12
1   252   9
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316513_15.png
better model found
persisted
after epoch: 15,now: 2024-06-14 00:03:06.962677,epoch time: 0:29:02.770437,used: 7:10:15.371589,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316513
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9728946, 'precision': 0.79692173, 'recall': 0.7627038, 'specificity': 0.7627038, 'f1': 0.7786652, 'auroc': 0.9578719, 'binary_precision': 0.60986894, 'binary_recall': 0.5373641, 'binary_specificity': 0.9880435, 'binary_f1_score': 0.5713254}
confusion matrix:
       0    1
0  41814  506
1    681  791
---- Validation: 
scalar performance:
{'acc': 0.97227544, 'precision': 0.81033534, 'recall': 0.7118764, 'specificity': 0.7118764, 'f1': 0.75098884, 'auroc': 0.9528235, 'binary_precision': 0.640553, 'binary_recall': 0.43234837, 'binary_specificity': 0.9914045, 'binary_f1_score': 0.5162488}
confusion matrix:
       0    1
0  17993  156
1    365  278
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.7651576, 'recall': 0.50741273, 'specificity': 0.50741273, 'f1': 0.5043114, 'auroc': 0.9186788, 'binary_precision': 0.5714286, 'binary_recall': 0.01532567, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.029850746}
confusion matrix:
      0  1
0  5994  3
1   257  4
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316513_16.png
better model found
persisted
after epoch: 16,now: 2024-06-14 00:32:08.873601,epoch time: 0:29:01.910924,used: 7:39:17.282513,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316513
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9743104, 'precision': 0.8291628, 'recall': 0.72147036, 'specificity': 0.72147036, 'f1': 0.76389456, 'auroc': 0.95948565, 'binary_precision': 0.67722166, 'binary_recall': 0.4504076, 'binary_specificity': 0.9925331, 'binary_f1_score': 0.54100364}
confusion matrix:
       0    1
0  42004  316
1    809  663
---- Validation: 
scalar performance:
{'acc': 0.9710515, 'precision': 0.82294405, 'recall': 0.6489882, 'specificity': 0.6489882, 'f1': 0.7013579, 'auroc': 0.952154, 'binary_precision': 0.6701031, 'binary_recall': 0.30326593, 'binary_specificity': 0.99471045, 'binary_f1_score': 0.41755888}
confusion matrix:
       0    1
0  18053   96
1    448  195
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.79201996, 'recall': 0.5093284, 'specificity': 0.5093284, 'f1': 0.50801337, 'auroc': 0.91973555, 'binary_precision': 0.625, 'binary_recall': 0.019157087, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.03717472}
confusion matrix:
      0  1
0  5994  3
1   256  5
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316513_17.png
early stop counter: 1
val acc:0.9710515141487122, best validation acc: 0.97227543592453, corresponding to test acc:                         0.9584531784057617 / 0.9705976247787476
after epoch: 17,now: 2024-06-14 01:01:02.034313,epoch time: 0:28:53.160712,used: 8:08:10.443225,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316513
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.97195834, 'precision': 0.83893776, 'recall': 0.64132506, 'specificity': 0.64132506, 'f1': 0.69648767, 'auroc': 0.95809186, 'binary_precision': 0.70216304, 'binary_recall': 0.2868797, 'binary_specificity': 0.9957704, 'binary_f1_score': 0.4073359}
confusion matrix:
       0    1
0  42142  179
1   1049  422
---- Validation: 
scalar performance:
{'acc': 0.96929544, 'precision': 0.84149575, 'recall': 0.5850744, 'specificity': 0.5850744, 'f1': 0.6310808, 'auroc': 0.9512389, 'binary_precision': 0.71153843, 'binary_recall': 0.1726283, 'binary_specificity': 0.9975205, 'binary_f1_score': 0.27784732}
confusion matrix:
       0    1
0  18104   45
1    532  111
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.7292932, 'recall': 0.5036647, 'specificity': 0.5036647, 'f1': 0.496895, 'auroc': 0.923145, 'binary_precision': 0.5, 'binary_recall': 0.007662835, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.015094339}
confusion matrix:
      0  1
0  5995  2
1   259  2
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316513_18.png
early stop counter: 2
val acc:0.9692954421043396, best validation acc: 0.97227543592453, corresponding to test acc:                         0.9584531784057617 / 0.9705976247787476
after epoch: 18,now: 2024-06-14 01:29:56.292347,epoch time: 0:28:54.258034,used: 8:37:04.701259,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316513
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9745844, 'precision': 0.8191979, 'recall': 0.75275874, 'specificity': 0.75275874, 'f1': 0.781772, 'auroc': 0.95910007, 'binary_precision': 0.6551426, 'binary_recall': 0.5149456, 'binary_specificity': 0.99057186, 'binary_f1_score': 0.5766451}
confusion matrix:
       0    1
0  41921  399
1    714  758
---- Validation: 
scalar performance:
{'acc': 0.9714772, 'precision': 0.8037814, 'recall': 0.6994623, 'specificity': 0.6994623, 'f1': 0.73983216, 'auroc': 0.94915116, 'binary_precision': 0.6282974, 'binary_recall': 0.407465, 'binary_specificity': 0.9914596, 'binary_f1_score': 0.4943396}
confusion matrix:
       0    1
0  17994  155
1    381  262
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959412, 'precision': 0.78367287, 'recall': 0.5372303, 'specificity': 0.5372303, 'f1': 0.5576361, 'auroc': 0.9265816, 'binary_precision': 0.6060606, 'binary_recall': 0.07662835, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.13605443}
confusion matrix:
      0   1
0  5984  13
1   241  20
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316513_19.png
early stop counter: 3
val acc:0.971477210521698, best validation acc: 0.97227543592453, corresponding to test acc:                         0.9584531784057617 / 0.9705976247787476
after epoch: 19,now: 2024-06-14 01:59:17.807481,epoch time: 0:29:21.515134,used: 9:06:26.216393,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316513
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9743104, 'precision': 0.81937873, 'recall': 0.74310905, 'specificity': 0.74310905, 'f1': 0.77561235, 'auroc': 0.9575293, 'binary_precision': 0.6561656, 'binary_recall': 0.49524456, 'binary_specificity': 0.99097353, 'binary_f1_score': 0.5644599}
confusion matrix:
       0    1
0  41938  382
1    743  729
---- Validation: 
scalar performance:
{'acc': 0.97184974, 'precision': 0.80822444, 'recall': 0.7019053, 'specificity': 0.7019053, 'f1': 0.7429944, 'auroc': 0.9517666, 'binary_precision': 0.6370192, 'binary_recall': 0.41213062, 'binary_specificity': 0.99167997, 'binary_f1_score': 0.5004721}
confusion matrix:
       0    1
0  17998  151
1    378  265
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589326, 'precision': 0.8130804, 'recall': 0.5149922, 'specificity': 0.5149922, 'f1': 0.51880825, 'auroc': 0.9230212, 'binary_precision': 0.6666667, 'binary_recall': 0.03065134, 'binary_specificity': 0.999333, 'binary_f1_score': 0.058608055}
confusion matrix:
      0  1
0  5993  4
1   253  8
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316513_20.png
early stop counter: 4
val acc:0.9718497395515442, best validation acc: 0.97227543592453, corresponding to test acc:                         0.9584531784057617 / 0.9705976247787476
after epoch: 20,now: 2024-06-14 02:28:11.034979,epoch time: 0:28:53.227498,used: 9:35:19.443891,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316513
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.97396785, 'precision': 0.80120623, 'recall': 0.7921107, 'specificity': 0.7921107, 'f1': 0.79658186, 'auroc': 0.9595716, 'binary_precision': 0.61640954, 'binary_recall': 0.59714675, 'binary_specificity': 0.9870747, 'binary_f1_score': 0.60662526}
confusion matrix:
       0    1
0  41773  547
1    593  879
---- Validation: 
scalar performance:
{'acc': 0.9721158, 'precision': 0.7965934, 'recall': 0.7500466, 'specificity': 0.7500466, 'f1': 0.7711444, 'auroc': 0.95115507, 'binary_precision': 0.6103896, 'binary_recall': 0.5116641, 'binary_specificity': 0.9884291, 'binary_f1_score': 0.5566836}
confusion matrix:
       0    1
0  17939  210
1    314  329
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959412, 'precision': 0.8003465, 'recall': 0.52990097, 'specificity': 0.52990097, 'f1': 0.54555976, 'auroc': 0.9226935, 'binary_precision': 0.64, 'binary_recall': 0.06130268, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.11188811}
confusion matrix:
      0   1
0  5988   9
1   245  16
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316513_21.png
early stop counter: 5
val acc:0.9721158146858215, best validation acc: 0.97227543592453, corresponding to test acc:                         0.9584531784057617 / 0.9705976247787476
after epoch: 21,now: 2024-06-14 02:57:31.368634,epoch time: 0:29:20.333655,used: 10:04:39.777546,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316513
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.97227806, 'precision': 0.8980794, 'recall': 0.6109139, 'specificity': 0.6109139, 'f1': 0.668666, 'auroc': 0.96088433, 'binary_precision': 0.8225, 'binary_recall': 0.22350544, 'binary_specificity': 0.9983223, 'binary_f1_score': 0.3514957}
confusion matrix:
       0    1
0  42249   71
1   1143  329
---- Validation: 
scalar performance:
{'acc': 0.96828437, 'precision': 0.8696605, 'recall': 0.55154854, 'specificity': 0.55154854, 'f1': 0.5836949, 'auroc': 0.9513704, 'binary_precision': 0.77011496, 'binary_recall': 0.10419907, 'binary_specificity': 0.998898, 'binary_f1_score': 0.18356164}
confusion matrix:
       0   1
0  18129  20
1    576  67
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.97922325, 'recall': 0.5019157, 'specificity': 0.5019157, 'f1': 0.49320802, 'auroc': 0.9148692, 'binary_precision': 1.0, 'binary_recall': 0.0038314175, 'binary_specificity': 1.0, 'binary_f1_score': 0.007633588}
confusion matrix:
      0  1
0  5997  0
1   260  1
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316513_22.png
early stop counter: 6
val acc:0.9682843685150146, best validation acc: 0.97227543592453, corresponding to test acc:                         0.9584531784057617 / 0.9705976247787476
after epoch: 22,now: 2024-06-14 03:26:44.507398,epoch time: 0:29:13.138764,used: 10:33:52.916310,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316513
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9742647, 'precision': 0.84422356, 'recall': 0.6958737, 'specificity': 0.6958737, 'f1': 0.74807286, 'auroc': 0.9605534, 'binary_precision': 0.7090909, 'binary_recall': 0.39741847, 'binary_specificity': 0.9943289, 'binary_f1_score': 0.50936}
confusion matrix:
       0    1
0  42080  240
1    887  585
---- Validation: 
scalar performance:
{'acc': 0.96977437, 'precision': 0.8159908, 'recall': 0.6190748, 'specificity': 0.6190748, 'f1': 0.6695351, 'auroc': 0.9503711, 'binary_precision': 0.65822786, 'binary_recall': 0.24261275, 'binary_specificity': 0.9955369, 'binary_f1_score': 0.35454544}
confusion matrix:
       0    1
0  18068   81
1    487  156
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.72958696, 'recall': 0.510994, 'specificity': 0.510994, 'f1': 0.51131886, 'auroc': 0.91604453, 'binary_precision': 0.5, 'binary_recall': 0.022988506, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.043956045}
confusion matrix:
      0  1
0  5991  6
1   255  6
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316513_23.png
early stop counter: 7
val acc:0.9697743654251099, best validation acc: 0.97227543592453, corresponding to test acc:                         0.9584531784057617 / 0.9705976247787476
after epoch: 23,now: 2024-06-14 03:55:57.098510,epoch time: 0:29:12.591112,used: 11:03:05.507422,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316513
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9746072, 'precision': 0.83374214, 'recall': 0.72110915, 'specificity': 0.72110915, 'f1': 0.7650398, 'auroc': 0.9617856, 'binary_precision': 0.68639666, 'binary_recall': 0.44935417, 'binary_specificity': 0.9928641, 'binary_f1_score': 0.54313886}
confusion matrix:
       0    1
0  42019  302
1    810  661
---- Validation: 
scalar performance:
{'acc': 0.972169, 'precision': 0.830117, 'recall': 0.67131835, 'specificity': 0.67131835, 'f1': 0.72354776, 'auroc': 0.9497824, 'binary_precision': 0.68292683, 'binary_recall': 0.34836704, 'binary_specificity': 0.99426967, 'binary_f1_score': 0.46138003}
confusion matrix:
       0    1
0  18045  104
1    419  224
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579738, 'precision': 0.6794334, 'recall': 0.5071626, 'specificity': 0.5071626, 'f1': 0.50402105, 'auroc': 0.9113772, 'binary_precision': 0.4, 'binary_recall': 0.01532567, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.029520296}
confusion matrix:
      0  1
0  5991  6
1   257  4
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316513_24.png
early stop counter: 8
val acc:0.9721689820289612, best validation acc: 0.97227543592453, corresponding to test acc:                         0.9584531784057617 / 0.9705976247787476
after epoch: 24,now: 2024-06-14 04:25:10.906973,epoch time: 0:29:13.808463,used: 11:32:19.315885,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316513
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.97529227, 'precision': 0.8270941, 'recall': 0.7552569, 'specificity': 0.7552569, 'f1': 0.78635365, 'auroc': 0.9599738, 'binary_precision': 0.67076385, 'binary_recall': 0.51937455, 'binary_specificity': 0.9911392, 'binary_f1_score': 0.58544064}
confusion matrix:
       0    1
0  41946  375
1    707  764
---- Validation: 
scalar performance:
{'acc': 0.97259474, 'precision': 0.8216176, 'recall': 0.6977907, 'specificity': 0.6977907, 'f1': 0.7436811, 'auroc': 0.9532014, 'binary_precision': 0.66410255, 'binary_recall': 0.40279937, 'binary_specificity': 0.992782, 'binary_f1_score': 0.5014521}
confusion matrix:
       0    1
0  18018  131
1    384  259
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.7657528, 'recall': 0.52223814, 'specificity': 0.52223814, 'f1': 0.5320088, 'auroc': 0.91370404, 'binary_precision': 0.5714286, 'binary_recall': 0.04597701, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.08510638}
confusion matrix:
      0   1
0  5988   9
1   249  12
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316513_25.png
better model found
persisted
after epoch: 25,now: 2024-06-14 04:54:17.779343,epoch time: 0:29:06.872370,used: 12:01:26.188255,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316513
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9749498, 'precision': 0.81932604, 'recall': 0.7647507, 'specificity': 0.7647507, 'f1': 0.78925633, 'auroc': 0.96091306, 'binary_precision': 0.6545754, 'binary_recall': 0.5394022, 'binary_specificity': 0.99009925, 'binary_f1_score': 0.5914339}
confusion matrix:
       0    1
0  41901  419
1    678  794
---- Validation: 
scalar performance:
{'acc': 0.97307366, 'precision': 0.81867766, 'recall': 0.71904016, 'specificity': 0.71904016, 'f1': 0.75881004, 'auroc': 0.9533362, 'binary_precision': 0.65675056, 'binary_recall': 0.44634527, 'binary_specificity': 0.9917351, 'binary_f1_score': 0.53148156}
confusion matrix:
       0    1
0  17999  150
1    356  287
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.7610642, 'recall': 0.51665777, 'specificity': 0.51665777, 'f1': 0.5219101, 'auroc': 0.9165245, 'binary_precision': 0.5625, 'binary_recall': 0.03448276, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.064981945}
confusion matrix:
      0  1
0  5990  7
1   252  9
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316513_26.png
better model found
persisted
after epoch: 26,now: 2024-06-14 05:23:38.822632,epoch time: 0:29:21.043289,used: 12:30:47.231544,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316513
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.97093076, 'precision': 0.902048, 'recall': 0.58370566, 'specificity': 0.58370566, 'f1': 0.63277507, 'auroc': 0.9593827, 'binary_precision': 0.8322148, 'binary_recall': 0.1685928, 'binary_specificity': 0.9988186, 'binary_f1_score': 0.28038442}
confusion matrix:
       0    1
0  42271   50
1   1223  248
---- Validation: 
scalar performance:
{'acc': 0.9677522, 'precision': 0.868302, 'recall': 0.54077226, 'specificity': 0.54077226, 'f1': 0.5662206, 'auroc': 0.9517533, 'binary_precision': 0.76811594, 'binary_recall': 0.08242613, 'binary_specificity': 0.9991184, 'binary_f1_score': 0.1488764}
confusion matrix:
       0   1
0  18133  16
1    590  53
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.7292199, 'recall': 0.5018323, 'specificity': 0.5018323, 'f1': 0.49315178, 'auroc': 0.9224534, 'binary_precision': 0.5, 'binary_recall': 0.0038314175, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.007604562}
confusion matrix:
      0  1
0  5996  1
1   260  1
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316513_27.png
early stop counter: 1
val acc:0.96775221824646, best validation acc: 0.9730736613273621, corresponding to test acc:                         0.9586129784584045 / 0.9705976247787476
after epoch: 27,now: 2024-06-14 05:53:06.410180,epoch time: 0:29:27.587548,used: 13:00:14.819092,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316513
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9737167, 'precision': 0.8024799, 'recall': 0.77397764, 'specificity': 0.77397764, 'f1': 0.7874562, 'auroc': 0.9607094, 'binary_precision': 0.6201959, 'binary_recall': 0.5598639, 'binary_specificity': 0.9880913, 'binary_f1_score': 0.5884876}
confusion matrix:
       0    1
0  41818  504
1    647  823
---- Validation: 
scalar performance:
{'acc': 0.9716369, 'precision': 0.79655004, 'recall': 0.7287971, 'specificity': 0.7287971, 'f1': 0.75788665, 'auroc': 0.95279944, 'binary_precision': 0.61178863, 'binary_recall': 0.4681182, 'binary_specificity': 0.989476, 'binary_f1_score': 0.53039646}
confusion matrix:
       0    1
0  17958  191
1    342  301
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590924, 'precision': 0.8035006, 'recall': 0.52057254, 'specificity': 0.52057254, 'f1': 0.5291091, 'auroc': 0.9238117, 'binary_precision': 0.64705884, 'binary_recall': 0.042145595, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.07913669}
confusion matrix:
      0   1
0  5991   6
1   250  11
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316513_28.png
early stop counter: 2
val acc:0.9716368913650513, best validation acc: 0.9730736613273621, corresponding to test acc:                         0.9586129784584045 / 0.9705976247787476
after epoch: 28,now: 2024-06-14 06:22:42.443928,epoch time: 0:29:36.033748,used: 13:29:50.852840,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316513
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9719355, 'precision': 0.87633526, 'recall': 0.6137537, 'specificity': 0.6137537, 'f1': 0.6702557, 'auroc': 0.9609518, 'binary_precision': 0.77880186, 'binary_recall': 0.22977567, 'binary_specificity': 0.9977316, 'binary_f1_score': 0.35485563}
confusion matrix:
       0    1
0  42225   96
1   1133  338
---- Validation: 
scalar performance:
{'acc': 0.96855044, 'precision': 0.8648331, 'recall': 0.5584368, 'specificity': 0.5584368, 'f1': 0.5942671, 'auroc': 0.9525281, 'binary_precision': 0.76, 'binary_recall': 0.11819596, 'binary_specificity': 0.9986776, 'binary_f1_score': 0.20457606}
confusion matrix:
       0   1
0  18125  24
1    567  76
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581336, 'precision': 0.6458833, 'recall': 0.501749, 'specificity': 0.501749, 'f1': 0.49309576, 'auroc': 0.9186966, 'binary_precision': 0.33333334, 'binary_recall': 0.0038314175, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.0075757573}
confusion matrix:
      0  1
0  5995  2
1   260  1
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316513_29.png
early stop counter: 3
val acc:0.968550443649292, best validation acc: 0.9730736613273621, corresponding to test acc:                         0.9586129784584045 / 0.9705976247787476
after epoch: 29,now: 2024-06-14 06:52:28.668384,epoch time: 0:29:46.224456,used: 13:59:37.077296,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316513
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9749498, 'precision': 0.8409394, 'recall': 0.71885043, 'specificity': 0.71885043, 'f1': 0.7654941, 'auroc': 0.958924, 'binary_precision': 0.7009646, 'binary_recall': 0.44429347, 'binary_specificity': 0.99340737, 'binary_f1_score': 0.54386693}
confusion matrix:
       0    1
0  42041  279
1    818  654
---- Validation: 
scalar performance:
{'acc': 0.9714772, 'precision': 0.8364521, 'recall': 0.6447083, 'specificity': 0.6447083, 'f1': 0.69947493, 'auroc': 0.9511287, 'binary_precision': 0.69741696, 'binary_recall': 0.29393467, 'binary_specificity': 0.99548185, 'binary_f1_score': 0.41356674}
confusion matrix:
       0    1
0  18067   82
1    454  189
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.7651576, 'recall': 0.50741273, 'specificity': 0.50741273, 'f1': 0.5043114, 'auroc': 0.9145852, 'binary_precision': 0.5714286, 'binary_recall': 0.01532567, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.029850746}
confusion matrix:
      0  1
0  5994  3
1   257  4
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316513_30.png
early stop counter: 4
val acc:0.971477210521698, best validation acc: 0.9730736613273621, corresponding to test acc:                         0.9586129784584045 / 0.9705976247787476
after epoch: 30,now: 2024-06-14 07:22:11.809978,epoch time: 0:29:43.141594,used: 14:29:20.218890,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316513
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 14:29:20.218890 at 2024-06-14 07:22:11.809978
persisted model performance metric: 

scalar performance:
{'acc': 0.958613, 'precision': 0.7610642, 'recall': 0.51665777, 'specificity': 0.51665777, 'f1': 0.5219101, 'auroc': 0.9165245, 'binary_precision': 0.5625, 'binary_recall': 0.03448276, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.064981945}
confusion matrix:
      0  1
0  5990  7
1   252  9
oracle model performance metric: 

scalar performance:
{'acc': 0.9705976, 'precision': 0.88633525, 'recall': 0.69515026, 'specificity': 0.69515026, 'f1': 0.75651556, 'auroc': 0.91738576, 'binary_precision': 0.79844964, 'binary_recall': 0.394636, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.5282051}
confusion matrix:
      0    1
0  5971   26
1   158  103
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_vit_resnet_dinov2_bs16_different_learningrates/rule_results/11.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_vit_resnet_dinov2_bs16_different_learningrates/rule_results/11.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_vit_resnet_dinov2_bs16_different_learningrates/confusion_matrix/11.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 688276 KiB |   1449 MiB | 462789 GiB | 462788 GiB |
|       from large pool | 684800 KiB |   1444 MiB | 451908 GiB | 451907 GiB |
|       from small pool |   3476 KiB |      8 MiB |  10880 GiB |  10880 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 688276 KiB |   1449 MiB | 462789 GiB | 462788 GiB |
|       from large pool | 684800 KiB |   1444 MiB | 451908 GiB | 451907 GiB |
|       from small pool |   3476 KiB |      8 MiB |  10880 GiB |  10880 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 687268 KiB |   1445 MiB | 461986 GiB | 461985 GiB |
|       from large pool | 684800 KiB |   1441 MiB | 451123 GiB | 451123 GiB |
|       from small pool |   2468 KiB |      6 MiB |  10862 GiB |  10862 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1628 MiB |   1628 MiB |   1628 MiB |      0 B   |
|       from large pool |   1618 MiB |   1618 MiB |   1618 MiB |      0 B   |
|       from small pool |     10 MiB |     10 MiB |     10 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 116587 KiB | 208026 KiB | 201086 GiB | 201086 GiB |
|       from large pool | 113920 KiB | 204800 KiB | 190204 GiB | 190204 GiB |
|       from small pool |   2667 KiB |   3932 KiB |  10882 GiB |  10882 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2916    |    5887    |   90913 K  |   90910 K  |
|       from large pool |     100    |     205    |   28247 K  |   28247 K  |
|       from small pool |    2816    |    5786    |   62666 K  |   62663 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2916    |    5887    |   90913 K  |   90910 K  |
|       from large pool |     100    |     205    |   28247 K  |   28247 K  |
|       from small pool |    2816    |    5786    |   62666 K  |   62663 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      79    |      79    |      79    |       0    |
|       from large pool |      74    |      74    |      74    |       0    |
|       from small pool |       5    |       5    |       5    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      53    |    2787    |   37274 K  |   37274 K  |
|       from large pool |      39    |      69    |   11234 K  |   11234 K  |
|       from small pool |      14    |    2748    |   26039 K  |   26039 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1449 MiB | 462789 GiB | 462789 GiB |
|       from large pool |  16640 KiB |   1444 MiB | 451908 GiB | 451908 GiB |
|       from small pool |      0 KiB |      8 MiB |  10880 GiB |  10880 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1449 MiB | 462789 GiB | 462789 GiB |
|       from large pool |  16640 KiB |   1444 MiB | 451908 GiB | 451908 GiB |
|       from small pool |      0 KiB |      8 MiB |  10880 GiB |  10880 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1445 MiB | 461986 GiB | 461986 GiB |
|       from large pool |  16640 KiB |   1441 MiB | 451123 GiB | 451123 GiB |
|       from small pool |      0 KiB |      6 MiB |  10862 GiB |  10862 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    786 MiB |   1628 MiB |   1628 MiB |    842 MiB |
|       from large pool |    780 MiB |   1618 MiB |   1618 MiB |    838 MiB |
|       from small pool |      6 MiB |     10 MiB |     10 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 208026 KiB | 201087 GiB | 201087 GiB |
|       from large pool |  24320 KiB | 204800 KiB | 190204 GiB | 190204 GiB |
|       from small pool |      0 KiB |   5048 KiB |  10882 GiB |  10882 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    5887    |   90913 K  |   90913 K  |
|       from large pool |       2    |     205    |   28247 K  |   28247 K  |
|       from small pool |       0    |    5786    |   62666 K  |   62666 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    5887    |   90913 K  |   90913 K  |
|       from large pool |       2    |     205    |   28247 K  |   28247 K  |
|       from small pool |       0    |    5786    |   62666 K  |   62666 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      42    |      79    |      79    |      37    |
|       from large pool |      39    |      74    |      74    |      35    |
|       from small pool |       3    |       5    |       5    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    2787    |   37275 K  |   37275 K  |
|       from large pool |       2    |      69    |   11234 K  |   11234 K  |
|       from small pool |       0    |    2748    |   26041 K  |   26041 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1449 MiB | 462789 GiB | 462789 GiB |
|       from large pool |  16640 KiB |   1444 MiB | 451908 GiB | 451908 GiB |
|       from small pool |      0 KiB |      8 MiB |  10880 GiB |  10880 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1449 MiB | 462789 GiB | 462789 GiB |
|       from large pool |  16640 KiB |   1444 MiB | 451908 GiB | 451908 GiB |
|       from small pool |      0 KiB |      8 MiB |  10880 GiB |  10880 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1445 MiB | 461986 GiB | 461986 GiB |
|       from large pool |  16640 KiB |   1441 MiB | 451123 GiB | 451123 GiB |
|       from small pool |      0 KiB |      6 MiB |  10862 GiB |  10862 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    786 MiB |   1628 MiB |   1628 MiB |    842 MiB |
|       from large pool |    780 MiB |   1618 MiB |   1618 MiB |    838 MiB |
|       from small pool |      6 MiB |     10 MiB |     10 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 208026 KiB | 201087 GiB | 201087 GiB |
|       from large pool |  24320 KiB | 204800 KiB | 190204 GiB | 190204 GiB |
|       from small pool |      0 KiB |   5048 KiB |  10882 GiB |  10882 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    5887    |   90913 K  |   90913 K  |
|       from large pool |       2    |     205    |   28247 K  |   28247 K  |
|       from small pool |       0    |    5786    |   62666 K  |   62666 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    5887    |   90913 K  |   90913 K  |
|       from large pool |       2    |     205    |   28247 K  |   28247 K  |
|       from small pool |       0    |    5786    |   62666 K  |   62666 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      42    |      79    |      79    |      37    |
|       from large pool |      39    |      74    |      74    |      35    |
|       from small pool |       3    |       5    |       5    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    2787    |   37275 K  |   37275 K  |
|       from large pool |       2    |      69    |   11234 K  |   11234 K  |
|       from small pool |       0    |    2748    |   26041 K  |   26041 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0




!!!: not committed yet



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_07_31_37_seed_1_21316513

 Experiment start at: 2024-06-14 07:31:37.512984
before training, model accuracy: 0.04785691574215889
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9686474, 'precision': 0.7616936, 'recall': 0.6290765, 'specificity': 0.6290765, 'f1': 0.6708541, 'auroc': 0.9418899, 'binary_precision': 0.5479256, 'binary_recall': 0.26560333, 'binary_specificity': 0.99254966, 'binary_f1_score': 0.35777676}
confusion matrix:
       0    1
0  42098  316
1   1059  383
---- Validation: 
scalar performance:
{'acc': 0.965048, 'precision': 0.7500839, 'recall': 0.62495464, 'specificity': 0.62495464, 'f1': 0.6645013, 'auroc': 0.9458918, 'binary_precision': 0.5272727, 'binary_recall': 0.25854382, 'binary_specificity': 0.9913655, 'binary_f1_score': 0.34695908}
confusion matrix:
       0    1
0  17911  156
1    499  174
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95762163, 'precision': 0.5791163, 'recall': 0.50158674, 'specificity': 0.50158674, 'f1': 0.49294788, 'auroc': 0.9207276, 'binary_precision': 0.2, 'binary_recall': 0.0038461538, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.00754717}
confusion matrix:
      0  1
0  5942  4
1   259  1
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316513_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-14 08:01:34.684946,epoch time: 0:29:57.171962,used: 0:29:57.171962,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_07_31_37_seed_1_21316513
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97022074, 'precision': 0.77057934, 'recall': 0.71396285, 'specificity': 0.71396285, 'f1': 0.73863935, 'auroc': 0.9443185, 'binary_precision': 0.5600707, 'binary_recall': 0.43966714, 'binary_specificity': 0.9882586, 'binary_f1_score': 0.4926185}
confusion matrix:
       0    1
0  41916  498
1    808  634
---- Validation: 
scalar performance:
{'acc': 0.96792954, 'precision': 0.7734469, 'recall': 0.71943384, 'specificity': 0.71943384, 'f1': 0.74316263, 'auroc': 0.9497839, 'binary_precision': 0.5671642, 'binary_recall': 0.45170876, 'binary_specificity': 0.9871589, 'binary_f1_score': 0.50289494}
confusion matrix:
       0    1
0  17835  232
1    369  304
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95987755, 'precision': 0.8404239, 'recall': 0.53402674, 'specificity': 0.53402674, 'f1': 0.55289155, 'auroc': 0.93084025, 'binary_precision': 0.72, 'binary_recall': 0.06923077, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.12631579}
confusion matrix:
      0   1
0  5939   7
1   242  18
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316513_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-14 08:30:31.936798,epoch time: 0:28:57.251852,used: 0:58:54.423814,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_07_31_37_seed_1_21316513
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9700611, 'precision': 0.7668063, 'recall': 0.7343124, 'specificity': 0.7343124, 'f1': 0.74939895, 'auroc': 0.94699943, 'binary_precision': 0.5511499, 'binary_recall': 0.48196948, 'binary_specificity': 0.98665535, 'binary_f1_score': 0.5142434}
confusion matrix:
       0    1
0  41848  566
1    747  695
---- Validation: 
scalar performance:
{'acc': 0.9680363, 'precision': 0.7775646, 'recall': 0.7008922, 'specificity': 0.7008922, 'f1': 0.7324476, 'auroc': 0.95110184, 'binary_precision': 0.5767635, 'binary_recall': 0.41307577, 'binary_specificity': 0.9887087, 'binary_f1_score': 0.4813853}
confusion matrix:
       0    1
0  17863  204
1    395  278
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582662, 'precision': 0.73536384, 'recall': 0.56077063, 'specificity': 0.56077063, 'f1': 0.5908245, 'auroc': 0.9263804, 'binary_precision': 0.50769234, 'binary_recall': 0.12692308, 'binary_specificity': 0.99461824, 'binary_f1_score': 0.20307693}
confusion matrix:
      0   1
0  5914  32
1   227  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316513_3.png
better model found
persisted
after epoch: 3,now: 2024-06-14 08:59:12.415510,epoch time: 0:28:40.478712,used: 1:27:34.902526,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_07_31_37_seed_1_21316513
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97197646, 'precision': 0.7942276, 'recall': 0.70227414, 'specificity': 0.70227414, 'f1': 0.7389745, 'auroc': 0.95019746, 'binary_precision': 0.60816324, 'binary_recall': 0.41360167, 'binary_specificity': 0.9909466, 'binary_f1_score': 0.49235854}
confusion matrix:
       0    1
0  42031  384
1    845  596
---- Validation: 
scalar performance:
{'acc': 0.96782285, 'precision': 0.7951012, 'recall': 0.63426167, 'specificity': 0.63426167, 'f1': 0.68187493, 'auroc': 0.95133734, 'binary_precision': 0.6166667, 'binary_recall': 0.27488855, 'binary_specificity': 0.9936348, 'binary_f1_score': 0.38026723}
confusion matrix:
       0    1
0  17952  115
1    488  185
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95617145, 'precision': 0.59301865, 'recall': 0.50818586, 'specificity': 0.50818586, 'f1': 0.50651866, 'auroc': 0.92667955, 'binary_precision': 0.22727273, 'binary_recall': 0.01923077, 'binary_specificity': 0.99714094, 'binary_f1_score': 0.035460994}
confusion matrix:
      0   1
0  5929  17
1   255   5
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316513_4.png
early stop counter: 1
val acc:0.9678228497505188, best validation acc: 0.9680362939834595, corresponding to test acc:                         0.9582661986351013 / 0.9598775506019592
after epoch: 4,now: 2024-06-14 09:27:41.102501,epoch time: 0:28:28.686991,used: 1:56:03.589517,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_07_31_37_seed_1_21316513
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9722729, 'precision': 0.8189353, 'recall': 0.6584169, 'specificity': 0.6584169, 'f1': 0.70957655, 'auroc': 0.95235485, 'binary_precision': 0.6605114, 'binary_recall': 0.3224688, 'binary_specificity': 0.9943651, 'binary_f1_score': 0.43336442}
confusion matrix:
       0    1
0  42175  239
1    977  465
---- Validation: 
scalar performance:
{'acc': 0.9671825, 'precision': 0.78883386, 'recall': 0.62105477, 'specificity': 0.62105477, 'f1': 0.6675572, 'auroc': 0.95396936, 'binary_precision': 0.60507244, 'binary_recall': 0.24814264, 'binary_specificity': 0.9939669, 'binary_f1_score': 0.35194942}
confusion matrix:
       0    1
0  17958  109
1    506  167
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584273, 'precision': 0.76097536, 'recall': 0.51671904, 'specificity': 0.51671904, 'f1': 0.5219792, 'auroc': 0.9247996, 'binary_precision': 0.5625, 'binary_recall': 0.034615386, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.0652174}
confusion matrix:
      0  1
0  5939  7
1   251  9
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316513_5.png
early stop counter: 2
val acc:0.9671825170516968, best validation acc: 0.9680362939834595, corresponding to test acc:                         0.9582661986351013 / 0.9598775506019592
after epoch: 5,now: 2024-06-14 09:56:21.404583,epoch time: 0:28:40.302082,used: 2:24:43.891599,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_07_31_37_seed_1_21316513
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97172564, 'precision': 0.85501516, 'recall': 0.6078912, 'specificity': 0.6078912, 'f1': 0.66122663, 'auroc': 0.9522989, 'binary_precision': 0.7359813, 'binary_recall': 0.2184466, 'binary_specificity': 0.9973358, 'binary_f1_score': 0.3368984}
confusion matrix:
       0    1
0  42301  113
1   1127  315
---- Validation: 
scalar performance:
{'acc': 0.9667556, 'precision': 0.8437842, 'recall': 0.56003565, 'specificity': 0.56003565, 'f1': 0.5957038, 'auroc': 0.95701826, 'binary_precision': 0.71929824, 'binary_recall': 0.121842496, 'binary_specificity': 0.9982288, 'binary_f1_score': 0.20838627}
confusion matrix:
       0   1
0  18035  32
1    591  82
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95762163, 'precision': 0.4790424, 'recall': 0.49974772, 'specificity': 0.49974772, 'f1': 0.48917606, 'auroc': 0.9274913, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5943  3
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316513_6.png
early stop counter: 3
val acc:0.9667556285858154, best validation acc: 0.9680362939834595, corresponding to test acc:                         0.9582661986351013 / 0.9598775506019592
after epoch: 6,now: 2024-06-14 10:25:07.530222,epoch time: 0:28:46.125639,used: 2:53:30.017238,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_07_31_37_seed_1_21316513
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9727289, 'precision': 0.7909883, 'recall': 0.75377905, 'specificity': 0.75377905, 'f1': 0.77099144, 'auroc': 0.95280975, 'binary_precision': 0.5982428, 'binary_recall': 0.51941746, 'binary_specificity': 0.9881407, 'binary_f1_score': 0.5560505}
confusion matrix:
       0    1
0  41911  503
1    693  749
---- Validation: 
scalar performance:
{'acc': 0.97017074, 'precision': 0.7898787, 'recall': 0.7527832, 'specificity': 0.7527832, 'f1': 0.76992905, 'auroc': 0.954834, 'binary_precision': 0.5976027, 'binary_recall': 0.5185735, 'binary_specificity': 0.98699284, 'binary_f1_score': 0.55529034}
confusion matrix:
       0    1
0  17832  235
1    324  349
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95955527, 'precision': 0.80807835, 'recall': 0.5356976, 'specificity': 0.5356976, 'f1': 0.5553918, 'auroc': 0.930302, 'binary_precision': 0.6551724, 'binary_recall': 0.073076926, 'binary_specificity': 0.9983182, 'binary_f1_score': 0.1314879}
confusion matrix:
      0   1
0  5936  10
1   241  19
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316513_7.png
better model found
persisted
after epoch: 7,now: 2024-06-14 10:54:01.731466,epoch time: 0:28:54.201244,used: 3:22:24.218482,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_07_31_37_seed_1_21316513
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
