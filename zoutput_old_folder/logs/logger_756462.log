Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0




!!!: not committed yet



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_14_52_seed_0_21512106

 Experiment start at: 2024-06-19 23:14:52.488886
before training, model accuracy: 0.31128156185150146
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9055008, 'precision': 0.4527504, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.47520357, 'auroc': 0.54320955, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42305  0
1   4415  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.33935696, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.29587352, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512106_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-19 23:47:08.239329,epoch time: 0:32:15.750443,used: 0:32:15.750443,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_14_52_seed_0_21512106
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9055437, 'precision': 0.45277184, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.47521538, 'auroc': 0.73747754, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42307  0
1   4413  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.3619833, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.35979804, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512106_2.png
early stop counter: 1
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 2,now: 2024-06-20 00:23:00.225185,epoch time: 0:35:51.985856,used: 1:08:07.736299,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_14_52_seed_0_21512106
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.90757704, 'precision': 0.918049, 'recall': 0.51168615, 'specificity': 0.51168615, 'f1': 0.49869645, 'auroc': 0.85668325, 'binary_precision': 0.9285714, 'binary_recall': 0.023561396, 'binary_specificity': 0.9998109, 'binary_f1_score': 0.045956694}
confusion matrix:
       0    1
0  42298    8
1   4310  104
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.42989436, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.5609261, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512106_3.png
early stop counter: 2
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 3,now: 2024-06-20 00:57:43.755168,epoch time: 0:34:43.529983,used: 1:42:51.266282,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_14_52_seed_0_21512106
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.91988444, 'precision': 0.94419473, 'recall': 0.57833564, 'specificity': 0.57833564, 'f1': 0.6140637, 'auroc': 0.89236677, 'binary_precision': 0.96927375, 'binary_recall': 0.1571914, 'binary_specificity': 0.99947995, 'binary_f1_score': 0.2705126}
confusion matrix:
       0    1
0  42283   22
1   3721  694
---- Validation: 
scalar performance:
{'acc': 0.96557045, 'precision': 0.482888, 'recall': 0.4998898, 'specificity': 0.4998898, 'f1': 0.49124184, 'auroc': 0.43280673, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9997796, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18145  4
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.54829204, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512106_4.png
early stop counter: 3
val acc:0.9655704498291016, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 4,now: 2024-06-20 01:30:49.980356,epoch time: 0:33:06.225188,used: 2:15:57.491470,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_14_52_seed_0_21512106
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9371789, 'precision': 0.93751144, 'recall': 0.6782607, 'specificity': 0.6782607, 'f1': 0.74282014, 'auroc': 0.9218788, 'binary_precision': 0.93786985, 'binary_recall': 0.3590034, 'binary_specificity': 0.997518, 'binary_f1_score': 0.5192466}
confusion matrix:
       0     1
0  42200   105
1   2830  1585
---- Validation: 
scalar performance:
{'acc': 0.9646126, 'precision': 0.4828716, 'recall': 0.4993939, 'specificity': 0.4993939, 'f1': 0.49099383, 'auroc': 0.5111593, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9987878, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18127  22
1    643   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.957814, 'precision': 0.6795771, 'recall': 0.5107439, 'specificity': 0.5107439, 'f1': 0.5109548, 'auroc': 0.66853106, 'binary_precision': 0.4, 'binary_recall': 0.022988506, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.04347826}
confusion matrix:
      0  1
0  5988  9
1   255  6
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512106_5.png
early stop counter: 4
val acc:0.964612603187561, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 5,now: 2024-06-20 02:01:46.136978,epoch time: 0:30:56.156622,used: 2:46:53.648092,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_14_52_seed_0_21512106
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9480736, 'precision': 0.9428615, 'recall': 0.7396424, 'specificity': 0.7396424, 'f1': 0.80459404, 'auroc': 0.93841946, 'binary_precision': 0.93708754, 'binary_recall': 0.48266485, 'binary_specificity': 0.99661994, 'binary_f1_score': 0.63715225}
confusion matrix:
       0     1
0  42164   143
1   2283  2130
---- Validation: 
scalar performance:
{'acc': 0.9632822, 'precision': 0.5025063, 'recall': 0.5002053, 'specificity': 0.5002053, 'f1': 0.4935297, 'auroc': 0.57676053, 'binary_precision': 0.039215688, 'binary_recall': 0.00311042, 'binary_specificity': 0.99730015, 'binary_f1_score': 0.005763689}
confusion matrix:
       0   1
0  18100  49
1    641   2
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.7795465, 'recall': 0.5576361, 'specificity': 0.5576361, 'f1': 0.58875716, 'auroc': 0.7392285, 'binary_precision': 0.59615386, 'binary_recall': 0.118773945, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.19808307}
confusion matrix:
      0   1
0  5976  21
1   230  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512106_6.png
new oracle model saved
early stop counter: 5
val acc:0.9632822275161743, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9598913192749023
after epoch: 6,now: 2024-06-20 02:35:09.358595,epoch time: 0:33:23.221617,used: 3:20:16.869709,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_14_52_seed_0_21512106
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.95284677, 'precision': 0.94510114, 'recall': 0.7667353, 'specificity': 0.7667353, 'f1': 0.8286618, 'auroc': 0.9394876, 'binary_precision': 0.9364139, 'binary_recall': 0.5372762, 'binary_specificity': 0.9961945, 'binary_f1_score': 0.6827934}
confusion matrix:
       0     1
0  42146   161
1   2042  2371
---- Validation: 
scalar performance:
{'acc': 0.9627501, 'precision': 0.5202774, 'recall': 0.5021799, 'specificity': 0.5021799, 'f1': 0.49755046, 'auroc': 0.5740353, 'binary_precision': 0.07462686, 'binary_recall': 0.00777605, 'binary_specificity': 0.9965838, 'binary_f1_score': 0.014084507}
confusion matrix:
       0   1
0  18087  62
1    638   5
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9610099, 'precision': 0.78656167, 'recall': 0.5893694, 'specificity': 0.5893694, 'f1': 0.6311568, 'auroc': 0.73690295, 'binary_precision': 0.6075949, 'binary_recall': 0.18390805, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.28235295}
confusion matrix:
      0   1
0  5966  31
1   213  48
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512106_7.png
new oracle model saved
early stop counter: 6
val acc:0.9627500772476196, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9610099196434021
after epoch: 7,now: 2024-06-20 03:06:22.662295,epoch time: 0:31:13.303700,used: 3:51:30.173409,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_14_52_seed_0_21512106
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9552226, 'precision': 0.9242493, 'recall': 0.79662037, 'specificity': 0.79662037, 'f1': 0.84641564, 'auroc': 0.94932604, 'binary_precision': 0.88873994, 'binary_recall': 0.6010879, 'binary_specificity': 0.9921528, 'binary_f1_score': 0.7171444}
confusion matrix:
       0     1
0  41976   332
1   1760  2652
---- Validation: 
scalar performance:
{'acc': 0.9593976, 'precision': 0.55693614, 'recall': 0.5154454, 'specificity': 0.5154454, 'f1': 0.5203753, 'auroc': 0.63598216, 'binary_precision': 0.14705883, 'binary_recall': 0.038880248, 'binary_specificity': 0.9920106, 'binary_f1_score': 0.061500613}
confusion matrix:
       0    1
0  18004  145
1    618   25
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9610099, 'precision': 0.7636541, 'recall': 0.6553334, 'specificity': 0.6553334, 'f1': 0.69380426, 'auroc': 0.79298526, 'binary_precision': 0.5562914, 'binary_recall': 0.3218391, 'binary_specificity': 0.98882776, 'binary_f1_score': 0.407767}
confusion matrix:
      0   1
0  5930  67
1   177  84
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512106_8.png
early stop counter: 7
val acc:0.9593976140022278, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9610099196434021
after epoch: 8,now: 2024-06-20 03:37:50.974402,epoch time: 0:31:28.312107,used: 4:22:58.485516,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_14_52_seed_0_21512106
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9583048, 'precision': 0.9425255, 'recall': 0.8014246, 'specificity': 0.8014246, 'f1': 0.85548556, 'auroc': 0.95074785, 'binary_precision': 0.9245088, 'binary_recall': 0.6080254, 'binary_specificity': 0.9948238, 'binary_f1_score': 0.73358864}
confusion matrix:
       0     1
0  42090   219
1   1729  2682
---- Validation: 
scalar performance:
{'acc': 0.96110046, 'precision': 0.5666935, 'recall': 0.5140768, 'specificity': 0.5140768, 'f1': 0.5184575, 'auroc': 0.6329694, 'binary_precision': 0.16666667, 'binary_recall': 0.03421462, 'binary_specificity': 0.99393904, 'binary_f1_score': 0.056774195}
confusion matrix:
       0    1
0  18039  110
1    621   22
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.7946021, 'recall': 0.6454233, 'specificity': 0.6454233, 'f1': 0.6920278, 'auroc': 0.78641367, 'binary_precision': 0.61904764, 'binary_recall': 0.29885057, 'binary_specificity': 0.991996, 'binary_f1_score': 0.4031008}
confusion matrix:
      0   1
0  5949  48
1   183  78
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512106_9.png
new oracle model saved
early stop counter: 8
val acc:0.9611004590988159, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.963087260723114
after epoch: 9,now: 2024-06-20 04:08:11.352235,epoch time: 0:30:20.377833,used: 4:53:18.863349,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_14_52_seed_0_21512106
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9624144, 'precision': 0.9428508, 'recall': 0.82653904, 'specificity': 0.82653904, 'f1': 0.8737911, 'auroc': 0.9545184, 'binary_precision': 0.92022794, 'binary_recall': 0.65903425, 'binary_specificity': 0.9940438, 'binary_f1_score': 0.7680317}
confusion matrix:
       0     1
0  42057   252
1   1504  2907
---- Validation: 
scalar performance:
{'acc': 0.96030223, 'precision': 0.55817664, 'recall': 0.5136636, 'specificity': 0.5136636, 'f1': 0.5177106, 'auroc': 0.62674546, 'binary_precision': 0.14965986, 'binary_recall': 0.03421462, 'binary_specificity': 0.99311256, 'binary_f1_score': 0.055696204}
confusion matrix:
       0    1
0  18024  125
1    621   22
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96356666, 'precision': 0.7992692, 'recall': 0.6511704, 'specificity': 0.6511704, 'f1': 0.698291, 'auroc': 0.77582425, 'binary_precision': 0.627907, 'binary_recall': 0.31034482, 'binary_specificity': 0.991996, 'binary_f1_score': 0.4153846}
confusion matrix:
      0   1
0  5949  48
1   180  81
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512106_10.png
new oracle model saved
early stop counter: 9
val acc:0.9603022336959839, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9635666608810425
after epoch: 10,now: 2024-06-20 04:38:29.888603,epoch time: 0:30:18.536368,used: 5:23:37.399717,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_14_52_seed_0_21512106
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9609375, 'precision': 0.9367255, 'recall': 0.8225532, 'specificity': 0.8225532, 'f1': 0.86897385, 'auroc': 0.95414543, 'binary_precision': 0.90871763, 'binary_recall': 0.6519375, 'binary_specificity': 0.99316895, 'binary_f1_score': 0.7592031}
confusion matrix:
       0     1
0  42018   289
1   1536  2877
---- Validation: 
scalar performance:
{'acc': 0.9600894, 'precision': 0.5907466, 'recall': 0.52705437, 'specificity': 0.52705437, 'f1': 0.5379898, 'auroc': 0.6691521, 'binary_precision': 0.21390374, 'binary_recall': 0.0622084, 'binary_specificity': 0.9919004, 'binary_f1_score': 0.096385546}
confusion matrix:
       0    1
0  18002  147
1    603   40
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9637264, 'precision': 0.789678, 'recall': 0.68057114, 'specificity': 0.68057114, 'f1': 0.72101974, 'auroc': 0.8043817, 'binary_precision': 0.60625, 'binary_recall': 0.3716475, 'binary_specificity': 0.98949474, 'binary_f1_score': 0.46080756}
confusion matrix:
      0   1
0  5934  63
1   164  97
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512106_11.png
new oracle model saved
early stop counter: 10
val acc:0.960089385509491, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9637264013290405
after epoch: 11,now: 2024-06-20 05:08:47.286965,epoch time: 0:30:17.398362,used: 5:53:54.798079,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_14_52_seed_0_21512106
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9629495, 'precision': 0.9261954, 'recall': 0.8455168, 'specificity': 0.8455168, 'f1': 0.8805582, 'auroc': 0.9618126, 'binary_precision': 0.88295746, 'binary_recall': 0.70072496, 'binary_specificity': 0.9903087, 'binary_f1_score': 0.7813566}
confusion matrix:
       0     1
0  41896   410
1   1321  3093
---- Validation: 
scalar performance:
{'acc': 0.95753515, 'precision': 0.5933486, 'recall': 0.5407331, 'specificity': 0.5407331, 'f1': 0.55447745, 'auroc': 0.6806958, 'binary_precision': 0.21818182, 'binary_recall': 0.0933126, 'binary_specificity': 0.98815364, 'binary_f1_score': 0.13071896}
confusion matrix:
       0    1
0  17934  215
1    583   60
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.74813676, 'recall': 0.7059718, 'specificity': 0.7059718, 'f1': 0.724829, 'auroc': 0.8195195, 'binary_precision': 0.52093023, 'binary_recall': 0.42911878, 'binary_specificity': 0.98282474, 'binary_f1_score': 0.47058824}
confusion matrix:
      0    1
0  5894  103
1   149  112
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512106_12.png
early stop counter: 11
val acc:0.9575351476669312, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9637264013290405
after epoch: 12,now: 2024-06-20 05:39:01.725859,epoch time: 0:30:14.438894,used: 6:24:09.236973,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_14_52_seed_0_21512106
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.96605307, 'precision': 0.946463, 'recall': 0.84621596, 'specificity': 0.84621596, 'f1': 0.8884493, 'auroc': 0.9607736, 'binary_precision': 0.92360693, 'binary_recall': 0.69845945, 'binary_specificity': 0.9939725, 'binary_f1_score': 0.7954076}
confusion matrix:
       0     1
0  42051   255
1   1331  3083
---- Validation: 
scalar performance:
{'acc': 0.96051514, 'precision': 0.60297495, 'recall': 0.53102505, 'specificity': 0.53102505, 'f1': 0.54399186, 'auroc': 0.6688218, 'binary_precision': 0.23809524, 'binary_recall': 0.06998445, 'binary_specificity': 0.99206567, 'binary_f1_score': 0.10817308}
confusion matrix:
       0    1
0  18005  144
1    598   45
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9646852, 'precision': 0.8007463, 'recall': 0.6829037, 'specificity': 0.6829037, 'f1': 0.725879, 'auroc': 0.80739987, 'binary_precision': 0.6282051, 'binary_recall': 0.37547892, 'binary_specificity': 0.9903285, 'binary_f1_score': 0.470024}
confusion matrix:
      0   1
0  5939  58
1   163  98
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512106_13.png
new oracle model saved
early stop counter: 12
val acc:0.9605151414871216, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9646852016448975
after epoch: 13,now: 2024-06-20 06:09:37.651089,epoch time: 0:30:35.925230,used: 6:54:45.162203,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_14_52_seed_0_21512106
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9641267, 'precision': 0.9291746, 'recall': 0.85019237, 'specificity': 0.85019237, 'f1': 0.88465726, 'auroc': 0.9642596, 'binary_precision': 0.8880068, 'binary_recall': 0.70972127, 'binary_specificity': 0.99066347, 'binary_f1_score': 0.78891695}
confusion matrix:
       0     1
0  41912   395
1   1281  3132
---- Validation: 
scalar performance:
{'acc': 0.9596637, 'precision': 0.6160799, 'recall': 0.5448353, 'specificity': 0.5448353, 'f1': 0.56190723, 'auroc': 0.6909653, 'binary_precision': 0.26337448, 'binary_recall': 0.09953344, 'binary_specificity': 0.9901372, 'binary_f1_score': 0.14446953}
confusion matrix:
       0    1
0  17970  179
1    579   64
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964845, 'precision': 0.79374754, 'recall': 0.70863974, 'specificity': 0.70863974, 'f1': 0.7431402, 'auroc': 0.81683576, 'binary_precision': 0.61202186, 'binary_recall': 0.42911878, 'binary_specificity': 0.9881607, 'binary_f1_score': 0.5045045}
confusion matrix:
      0    1
0  5926   71
1   149  112
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512106_14.png
new oracle model saved
early stop counter: 13
val acc:0.9596636891365051, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9648450016975403
after epoch: 14,now: 2024-06-20 06:40:27.903940,epoch time: 0:30:50.252851,used: 7:25:35.415054,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_14_52_seed_0_21512106
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.96436214, 'precision': 0.9221592, 'recall': 0.8594153, 'specificity': 0.8594153, 'f1': 0.88760525, 'auroc': 0.96386635, 'binary_precision': 0.8720238, 'binary_recall': 0.73001134, 'binary_specificity': 0.9888193, 'binary_f1_score': 0.7947232}
confusion matrix:
       0     1
0  41832   473
1   1192  3223
---- Validation: 
scalar performance:
{'acc': 0.95737547, 'precision': 0.6113503, 'recall': 0.5564016, 'specificity': 0.5564016, 'f1': 0.5731758, 'auroc': 0.70190644, 'binary_precision': 0.253125, 'binary_recall': 0.125972, 'binary_specificity': 0.98683125, 'binary_f1_score': 0.16822429}
confusion matrix:
       0    1
0  17910  239
1    562   81
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9638862, 'precision': 0.7785773, 'recall': 0.73745686, 'specificity': 0.73745686, 'f1': 0.75617003, 'auroc': 0.83494174, 'binary_precision': 0.57918555, 'binary_recall': 0.49042144, 'binary_specificity': 0.98449224, 'binary_f1_score': 0.5311203}
confusion matrix:
      0    1
0  5904   93
1   133  128
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512106_15.png
early stop counter: 14
val acc:0.9573754668235779, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9648450016975403
after epoch: 15,now: 2024-06-20 07:11:00.801375,epoch time: 0:30:32.897435,used: 7:56:08.312489,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_14_52_seed_0_21512106
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9659033, 'precision': 0.91857266, 'recall': 0.87423694, 'specificity': 0.87423694, 'f1': 0.89482963, 'auroc': 0.9682684, 'binary_precision': 0.8617594, 'binary_recall': 0.7612143, 'binary_specificity': 0.9872595, 'binary_f1_score': 0.8083725}
confusion matrix:
       0     1
0  41767   539
1   1054  3360
---- Validation: 
scalar performance:
{'acc': 0.95806724, 'precision': 0.6198208, 'recall': 0.55976, 'specificity': 0.55976, 'f1': 0.57796913, 'auroc': 0.70290476, 'binary_precision': 0.26984128, 'binary_recall': 0.13219285, 'binary_specificity': 0.9873271, 'binary_f1_score': 0.17745304}
confusion matrix:
       0    1
0  17919  230
1    558   85
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96340686, 'precision': 0.77493596, 'recall': 0.7353744, 'specificity': 0.7353744, 'f1': 0.7534244, 'auroc': 0.8268918, 'binary_precision': 0.5720721, 'binary_recall': 0.48659003, 'binary_specificity': 0.98415875, 'binary_f1_score': 0.52587986}
confusion matrix:
      0    1
0  5902   95
1   134  127
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512106_16.png
early stop counter: 15
val acc:0.9580672383308411, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9648450016975403
after epoch: 16,now: 2024-06-20 07:42:44.737246,epoch time: 0:31:43.935871,used: 8:27:52.248360,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_14_52_seed_0_21512106
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.96440494, 'precision': 0.9143756, 'recall': 0.86891747, 'specificity': 0.86891747, 'f1': 0.8899693, 'auroc': 0.96631503, 'binary_precision': 0.85438144, 'binary_recall': 0.75118965, 'binary_specificity': 0.9866452, 'binary_f1_score': 0.7994695}
confusion matrix:
       0     1
0  41742   565
1   1098  3315
---- Validation: 
scalar performance:
{'acc': 0.9568433, 'precision': 0.6098559, 'recall': 0.55837625, 'specificity': 0.55837625, 'f1': 0.5747241, 'auroc': 0.7066786, 'binary_precision': 0.25, 'binary_recall': 0.13063763, 'binary_specificity': 0.9861149, 'binary_f1_score': 0.17160366}
confusion matrix:
       0    1
0  17897  252
1    559   84
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9643656, 'precision': 0.7804936, 'recall': 0.75053334, 'specificity': 0.75053334, 'f1': 0.76455975, 'auroc': 0.83443767, 'binary_precision': 0.58189654, 'binary_recall': 0.51724136, 'binary_specificity': 0.98382527, 'binary_f1_score': 0.5476673}
confusion matrix:
      0    1
0  5900   97
1   126  135
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512106_17.png
early stop counter: 16
val acc:0.9568433165550232, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9648450016975403
after epoch: 17,now: 2024-06-20 08:14:18.377872,epoch time: 0:31:33.640626,used: 8:59:25.888986,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_14_52_seed_0_21512106
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.96543235, 'precision': 0.9227176, 'recall': 0.8658749, 'specificity': 0.8658749, 'f1': 0.89170486, 'auroc': 0.96555716, 'binary_precision': 0.8718085, 'binary_recall': 0.7431421, 'binary_specificity': 0.98860765, 'binary_f1_score': 0.80234975}
confusion matrix:
       0     1
0  41827   482
1   1133  3278
---- Validation: 
scalar performance:
{'acc': 0.9581737, 'precision': 0.6206845, 'recall': 0.55981505, 'specificity': 0.55981505, 'f1': 0.57818264, 'auroc': 0.70565814, 'binary_precision': 0.2715655, 'binary_recall': 0.13219285, 'binary_specificity': 0.9874373, 'binary_f1_score': 0.17782427}
confusion matrix:
       0    1
0  17921  228
1    558   85
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650048, 'precision': 0.78696215, 'recall': 0.7435374, 'specificity': 0.7435374, 'f1': 0.7632508, 'auroc': 0.8328571, 'binary_precision': 0.5954546, 'binary_recall': 0.5019157, 'binary_specificity': 0.9851592, 'binary_f1_score': 0.54469854}
confusion matrix:
      0    1
0  5908   89
1   130  131
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512106_18.png
new oracle model saved
early stop counter: 17
val acc:0.9581736922264099, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9650048017501831
after epoch: 18,now: 2024-06-20 08:49:37.365315,epoch time: 0:35:18.987443,used: 9:34:44.876429,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_14_52_seed_0_21512106
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9680865, 'precision': 0.93318784, 'recall': 0.8720387, 'specificity': 0.8720387, 'f1': 0.89968663, 'auroc': 0.9717437, 'binary_precision': 0.89166, 'binary_recall': 0.75362647, 'binary_specificity': 0.990451, 'binary_f1_score': 0.8168529}
confusion matrix:
       0     1
0  41904   404
1   1087  3325
---- Validation: 
scalar performance:
{'acc': 0.95843977, 'precision': 0.62583035, 'recall': 0.56295305, 'specificity': 0.56295305, 'f1': 0.5821429, 'auroc': 0.7145361, 'binary_precision': 0.28164557, 'binary_recall': 0.13841368, 'binary_specificity': 0.98749244, 'binary_f1_score': 0.18561}
confusion matrix:
       0    1
0  17922  227
1    554   89
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645254, 'precision': 0.7829515, 'recall': 0.7432873, 'specificity': 0.7432873, 'f1': 0.76143575, 'auroc': 0.8370948, 'binary_precision': 0.58744395, 'binary_recall': 0.5019157, 'binary_specificity': 0.984659, 'binary_f1_score': 0.5413223}
confusion matrix:
      0    1
0  5905   92
1   130  131
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512106_19.png
early stop counter: 18
val acc:0.9584397673606873, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9650048017501831
after epoch: 19,now: 2024-06-20 09:25:55.221603,epoch time: 0:36:17.856288,used: 10:11:02.732717,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_14_52_seed_0_21512106
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9663099, 'precision': 0.91106, 'recall': 0.88701844, 'specificity': 0.88701844, 'f1': 0.89857566, 'auroc': 0.97327256, 'binary_precision': 0.84395444, 'binary_recall': 0.789259, 'binary_specificity': 0.9847779, 'binary_f1_score': 0.8156908}
confusion matrix:
       0     1
0  41663   644
1    930  3483
---- Validation: 
scalar performance:
{'acc': 0.95466155, 'precision': 0.6106573, 'recall': 0.5729979, 'specificity': 0.5729979, 'f1': 0.5872059, 'auroc': 0.7193308, 'binary_precision': 0.25059667, 'binary_recall': 0.16329704, 'binary_specificity': 0.9826988, 'binary_f1_score': 0.19774012}
confusion matrix:
       0    1
0  17835  314
1    538  105
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9603707, 'precision': 0.7520355, 'recall': 0.7667723, 'specificity': 0.7667723, 'f1': 0.75916445, 'auroc': 0.84370536, 'binary_precision': 0.5234657, 'binary_recall': 0.5555556, 'binary_specificity': 0.977989, 'binary_f1_score': 0.5390335}
confusion matrix:
      0    1
0  5865  132
1   116  145
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512106_20.png
early stop counter: 19
val acc:0.9546615481376648, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9650048017501831
after epoch: 20,now: 2024-06-20 10:04:40.031672,epoch time: 0:38:44.810069,used: 10:49:47.542786,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_14_52_seed_0_21512106
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.96744436, 'precision': 0.9157907, 'recall': 0.88863623, 'specificity': 0.88863623, 'f1': 0.90162814, 'auroc': 0.97315776, 'binary_precision': 0.85316396, 'binary_recall': 0.7914778, 'binary_specificity': 0.98579466, 'binary_f1_score': 0.821164}
confusion matrix:
       0     1
0  41707   601
1    920  3492
---- Validation: 
scalar performance:
{'acc': 0.9585994, 'precision': 0.6319772, 'recall': 0.56828606, 'specificity': 0.56828606, 'f1': 0.5883447, 'auroc': 0.726478, 'binary_precision': 0.29357797, 'binary_recall': 0.14930016, 'binary_specificity': 0.987272, 'binary_f1_score': 0.19793814}
confusion matrix:
       0    1
0  17918  231
1    547   96
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9678811, 'precision': 0.8071035, 'recall': 0.76519394, 'specificity': 0.76519394, 'f1': 0.7844301, 'auroc': 0.8433713, 'binary_precision': 0.6339286, 'binary_recall': 0.5440613, 'binary_specificity': 0.9863265, 'binary_f1_score': 0.585567}
confusion matrix:
      0    1
0  5915   82
1   119  142
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512106_21.png
new oracle model saved
early stop counter: 20
val acc:0.9585993885993958, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9678810834884644
after epoch: 21,now: 2024-06-20 10:41:33.184520,epoch time: 0:36:53.152848,used: 11:26:40.695634,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_14_52_seed_0_21512106
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.96864295, 'precision': 0.9224714, 'recall': 0.88843185, 'specificity': 0.88843185, 'f1': 0.9045423, 'auroc': 0.9735166, 'binary_precision': 0.8666998, 'binary_recall': 0.7895333, 'binary_specificity': 0.9873304, 'binary_f1_score': 0.8263189}
confusion matrix:
       0     1
0  41770   536
1    929  3485
---- Validation: 
scalar performance:
{'acc': 0.9575883, 'precision': 0.62522393, 'recall': 0.56926274, 'specificity': 0.56926274, 'f1': 0.58780015, 'auroc': 0.7121979, 'binary_precision': 0.28, 'binary_recall': 0.15241058, 'binary_specificity': 0.9861149, 'binary_f1_score': 0.19738166}
confusion matrix:
       0    1
0  17897  252
1    545   98
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96628314, 'precision': 0.7986938, 'recall': 0.74237216, 'specificity': 0.74237216, 'f1': 0.7672497, 'auroc': 0.83774775, 'binary_precision': 0.61904764, 'binary_recall': 0.49808428, 'binary_specificity': 0.98666, 'binary_f1_score': 0.552017}
confusion matrix:
      0    1
0  5917   80
1   131  130
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512106_22.png
early stop counter: 21
val acc:0.9575883150100708, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9678810834884644
after epoch: 22,now: 2024-06-20 11:22:25.233815,epoch time: 0:40:52.049295,used: 12:07:32.744929,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_14_52_seed_0_21512106
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9697988, 'precision': 0.92306244, 'recall': 0.8958102, 'specificity': 0.8958102, 'f1': 0.9088582, 'auroc': 0.9760723, 'binary_precision': 0.8663741, 'binary_recall': 0.80457425, 'binary_specificity': 0.9870461, 'binary_f1_score': 0.83433133}
confusion matrix:
       0     1
0  41756   548
1    863  3553
---- Validation: 
scalar performance:
{'acc': 0.95806724, 'precision': 0.6282735, 'recall': 0.56876063, 'specificity': 0.56876063, 'f1': 0.5880135, 'auroc': 0.71235406, 'binary_precision': 0.2861357, 'binary_recall': 0.15085536, 'binary_specificity': 0.9866659, 'binary_f1_score': 0.19755602}
confusion matrix:
       0    1
0  17907  242
1    546   97
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964845, 'precision': 0.7825594, 'recall': 0.7617774, 'specificity': 0.7617774, 'f1': 0.7717205, 'auroc': 0.84034806, 'binary_precision': 0.58506227, 'binary_recall': 0.54022986, 'binary_specificity': 0.983325, 'binary_f1_score': 0.56175303}
confusion matrix:
      0    1
0  5897  100
1   120  141
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512106_23.png
early stop counter: 22
val acc:0.9580672383308411, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9678810834884644
after epoch: 23,now: 2024-06-20 11:56:19.496410,epoch time: 0:33:54.262595,used: 12:41:27.007524,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_14_52_seed_0_21512106
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9650899, 'precision': 0.90083027, 'recall': 0.8932457, 'specificity': 0.8932457, 'f1': 0.89699125, 'auroc': 0.9726078, 'binary_precision': 0.8219907, 'binary_recall': 0.804668, 'binary_specificity': 0.9818233, 'binary_f1_score': 0.8132372}
confusion matrix:
       0     1
0  41538   769
1    862  3551
---- Validation: 
scalar performance:
{'acc': 0.95572585, 'precision': 0.62453157, 'recall': 0.58329964, 'specificity': 0.58329964, 'f1': 0.5990946, 'auroc': 0.73200285, 'binary_precision': 0.27764705, 'binary_recall': 0.18351477, 'binary_specificity': 0.98308444, 'binary_f1_score': 0.22097377}
confusion matrix:
       0    1
0  17842  307
1    525  118
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96628314, 'precision': 0.7924456, 'recall': 0.76985717, 'specificity': 0.76985717, 'f1': 0.7806405, 'auroc': 0.8508601, 'binary_precision': 0.6041667, 'binary_recall': 0.5555556, 'binary_specificity': 0.98415875, 'binary_f1_score': 0.57884234}
confusion matrix:
      0    1
0  5902   95
1   116  145
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512106_24.png
early stop counter: 23
val acc:0.9557258486747742, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9678810834884644
after epoch: 24,now: 2024-06-20 12:34:46.894269,epoch time: 0:38:27.397859,used: 13:19:54.405383,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_14_52_seed_0_21512106
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9676156, 'precision': 0.9108974, 'recall': 0.8969156, 'specificity': 0.8969156, 'f1': 0.90375113, 'auroc': 0.975008, 'binary_precision': 0.8415725, 'binary_recall': 0.80973953, 'binary_specificity': 0.9840917, 'binary_f1_score': 0.82534915}
confusion matrix:
       0     1
0  41632   673
1    840  3575
---- Validation: 
scalar performance:
{'acc': 0.955513, 'precision': 0.6232341, 'recall': 0.5831894, 'specificity': 0.5831894, 'f1': 0.5986263, 'auroc': 0.7312854, 'binary_precision': 0.27505827, 'binary_recall': 0.18351477, 'binary_specificity': 0.9828641, 'binary_f1_score': 0.22014925}
confusion matrix:
       0    1
0  17838  311
1    525  118
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645254, 'precision': 0.7791892, 'recall': 0.76894003, 'specificity': 0.76894003, 'f1': 0.7739562, 'auroc': 0.8495506, 'binary_precision': 0.57768923, 'binary_recall': 0.5555556, 'binary_specificity': 0.9823245, 'binary_f1_score': 0.56640625}
confusion matrix:
      0    1
0  5891  106
1   116  145
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512106_25.png
early stop counter: 24
val acc:0.9555130004882812, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9678810834884644
after epoch: 25,now: 2024-06-20 13:11:43.613032,epoch time: 0:36:56.718763,used: 13:56:51.124146,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_14_52_seed_0_21512106
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9677868, 'precision': 0.90838194, 'recall': 0.9018185, 'specificity': 0.9018185, 'f1': 0.905066, 'auroc': 0.97613037, 'binary_precision': 0.83544886, 'binary_recall': 0.8204896, 'binary_specificity': 0.9831474, 'binary_f1_score': 0.82790166}
confusion matrix:
       0     1
0  41595   713
1    792  3620
---- Validation: 
scalar performance:
{'acc': 0.95540655, 'precision': 0.6268486, 'recall': 0.58913475, 'specificity': 0.58913475, 'f1': 0.604115, 'auroc': 0.74335015, 'binary_precision': 0.2818792, 'binary_recall': 0.19595645, 'binary_specificity': 0.9823131, 'binary_f1_score': 0.23119265}
confusion matrix:
       0    1
0  17828  321
1    517  126
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96612334, 'precision': 0.791536, 'recall': 0.7679415, 'specificity': 0.7679415, 'f1': 0.7791784, 'auroc': 0.851155, 'binary_precision': 0.60251045, 'binary_recall': 0.55172414, 'binary_specificity': 0.98415875, 'binary_f1_score': 0.5759999}
confusion matrix:
      0    1
0  5902   95
1   117  144
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512106_26.png
early stop counter: 25
val acc:0.9554065465927124, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9678810834884644
after epoch: 26,now: 2024-06-20 13:50:15.896935,epoch time: 0:38:32.283903,used: 14:35:23.408049,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_14_52_seed_0_21512106
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9677226, 'precision': 0.9113394, 'recall': 0.89691055, 'specificity': 0.89691055, 'f1': 0.90395975, 'auroc': 0.9735878, 'binary_precision': 0.8424528, 'binary_recall': 0.8096101, 'binary_specificity': 0.984211, 'binary_f1_score': 0.82570505}
confusion matrix:
       0     1
0  41640   668
1    840  3572
---- Validation: 
scalar performance:
{'acc': 0.9562048, 'precision': 0.62808526, 'recall': 0.58429766, 'specificity': 0.58429766, 'f1': 0.6008915, 'auroc': 0.7307006, 'binary_precision': 0.284689, 'binary_recall': 0.18506998, 'binary_specificity': 0.9835253, 'binary_f1_score': 0.22431667}
confusion matrix:
       0    1
0  17850  299
1    524  119
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642058, 'precision': 0.77669597, 'recall': 0.77060556, 'specificity': 0.77060556, 'f1': 0.7736124, 'auroc': 0.84833217, 'binary_precision': 0.57254905, 'binary_recall': 0.55938697, 'binary_specificity': 0.9818242, 'binary_f1_score': 0.56589144}
confusion matrix:
      0    1
0  5888  109
1   115  146
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512106_27.png
early stop counter: 26
val acc:0.9562047719955444, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9678810834884644
after epoch: 27,now: 2024-06-20 14:32:07.213441,epoch time: 0:41:51.316506,used: 15:17:14.724555,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_14_52_seed_0_21512106
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.96744436, 'precision': 0.9045447, 'recall': 0.90528375, 'specificity': 0.90528375, 'f1': 0.9049138, 'auroc': 0.9756485, 'binary_precision': 0.82696223, 'binary_recall': 0.82864916, 'binary_specificity': 0.98191833, 'binary_f1_score': 0.8278048}
confusion matrix:
       0     1
0  41543   765
1    756  3656
---- Validation: 
scalar performance:
{'acc': 0.9548744, 'precision': 0.62775636, 'recall': 0.5948597, 'specificity': 0.5948597, 'f1': 0.60844505, 'auroc': 0.7397595, 'binary_precision': 0.2832981, 'binary_recall': 0.20839813, 'binary_specificity': 0.9813213, 'binary_f1_score': 0.24014337}
confusion matrix:
       0    1
0  17810  339
1    509  134
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9637264, 'precision': 0.7730198, 'recall': 0.77402014, 'specificity': 0.77402014, 'f1': 0.7735189, 'auroc': 0.85562193, 'binary_precision': 0.5648855, 'binary_recall': 0.5670498, 'binary_specificity': 0.98099047, 'binary_f1_score': 0.5659656}
confusion matrix:
      0    1
0  5883  114
1   113  148
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512106_28.png
early stop counter: 27
val acc:0.9548743963241577, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9678810834884644
after epoch: 28,now: 2024-06-20 15:20:04.866223,epoch time: 0:47:57.652782,used: 16:05:12.377337,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_14_52_seed_0_21512106
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9692209, 'precision': 0.9109074, 'recall': 0.908738, 'specificity': 0.908738, 'f1': 0.909819, 'auroc': 0.977625, 'binary_precision': 0.8391067, 'binary_recall': 0.834164, 'binary_specificity': 0.9833121, 'binary_f1_score': 0.8366281}
confusion matrix:
       0     1
0  41600   706
1    732  3682
---- Validation: 
scalar performance:
{'acc': 0.95455515, 'precision': 0.6235006, 'recall': 0.5909442, 'specificity': 0.5909442, 'f1': 0.6042996, 'auroc': 0.7431536, 'binary_precision': 0.2750533, 'binary_recall': 0.20062208, 'binary_specificity': 0.9812662, 'binary_f1_score': 0.23201439}
confusion matrix:
       0    1
0  17809  340
1    514  129
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9646852, 'precision': 0.7805888, 'recall': 0.76719105, 'specificity': 0.76719105, 'f1': 0.7737047, 'auroc': 0.8483111, 'binary_precision': 0.58064514, 'binary_recall': 0.55172414, 'binary_specificity': 0.98265797, 'binary_f1_score': 0.5658153}
confusion matrix:
      0    1
0  5893  104
1   117  144
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512106_29.png
early stop counter: 28
val acc:0.9545551538467407, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9678810834884644
after epoch: 29,now: 2024-06-20 15:44:29.792240,epoch time: 0:24:24.926017,used: 16:29:37.303354,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_14_52_seed_0_21512106
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.96851456, 'precision': 0.90773153, 'recall': 0.9083109, 'specificity': 0.9083109, 'f1': 0.9080209, 'auroc': 0.97705114, 'binary_precision': 0.8327676, 'binary_recall': 0.83408886, 'binary_specificity': 0.98253286, 'binary_f1_score': 0.83342767}
confusion matrix:
       0     1
0  41569   739
1    732  3680
---- Validation: 
scalar performance:
{'acc': 0.9551937, 'precision': 0.6250784, 'recall': 0.5882745, 'specificity': 0.5882745, 'f1': 0.6029321, 'auroc': 0.7380209, 'binary_precision': 0.27839643, 'binary_recall': 0.19440125, 'binary_specificity': 0.98214775, 'binary_f1_score': 0.22893773}
confusion matrix:
       0    1
0  17825  324
1    518  125
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96596354, 'precision': 0.7892995, 'recall': 0.77335507, 'specificity': 0.77335507, 'f1': 0.7810725, 'auroc': 0.8561471, 'binary_precision': 0.597561, 'binary_recall': 0.5632184, 'binary_specificity': 0.9834917, 'binary_f1_score': 0.57988167}
confusion matrix:
      0    1
0  5898   99
1   114  147
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512106_30.png
early stop counter: 29
val acc:0.9551936984062195, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9678810834884644
after epoch: 30,now: 2024-06-20 16:10:12.133466,epoch time: 0:25:42.341226,used: 16:55:19.644580,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_14_52_seed_0_21512106
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 16:55:19.644580 at 2024-06-20 16:10:12.133466
persisted model performance metric: 

scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.29587352, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
oracle model performance metric: 

scalar performance:
{'acc': 0.9678811, 'precision': 0.8071035, 'recall': 0.76519394, 'specificity': 0.76519394, 'f1': 0.7844301, 'auroc': 0.8433713, 'binary_precision': 0.6339286, 'binary_recall': 0.5440613, 'binary_specificity': 0.9863265, 'binary_f1_score': 0.585567}
confusion matrix:
      0    1
0  5915   82
1   119  142
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_irm_resnet_different_bs128_lre4_classbalancing/rule_results/9.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_irm_resnet_different_bs128_lre4_classbalancing/rule_results/9.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_irm_resnet_different_bs128_lre4_classbalancing/confusion_matrix/9.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204097 KiB |   1730 MiB | 424469 GiB | 424468 GiB |
|       from large pool | 167936 KiB |   1660 MiB | 424349 GiB | 424349 GiB |
|       from small pool |  36161 KiB |     72 MiB |    119 GiB |    119 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 204097 KiB |   1730 MiB | 424469 GiB | 424468 GiB |
|       from large pool | 167936 KiB |   1660 MiB | 424349 GiB | 424349 GiB |
|       from small pool |  36161 KiB |     72 MiB |    119 GiB |    119 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201088 KiB |   1723 MiB | 424463 GiB | 424463 GiB |
|       from large pool | 165120 KiB |   1653 MiB | 424346 GiB | 424346 GiB |
|       from small pool |  35968 KiB |     71 MiB |    117 GiB |    117 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1876 MiB |   1876 MiB |   1876 MiB |      0 B   |
|       from large pool |   1802 MiB |   1802 MiB |   1802 MiB |      0 B   |
|       from small pool |     74 MiB |     74 MiB |     74 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 404158 KiB | 758032 KiB | 301037 GiB | 301036 GiB |
|       from large pool | 397312 KiB | 756864 KiB | 300912 GiB | 300911 GiB |
|       from small pool |   6846 KiB |  12716 KiB |    124 GiB |    124 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1194    |    1851    |   12615 K  |   12614 K  |
|       from large pool |      36    |      76    |    4030 K  |    4030 K  |
|       from small pool |    1158    |    1780    |    8585 K  |    8583 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1194    |    1851    |   12615 K  |   12614 K  |
|       from large pool |      36    |      76    |    4030 K  |    4030 K  |
|       from small pool |    1158    |    1780    |    8585 K  |    8583 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      50    |      50    |      50    |       0    |
|       from large pool |      13    |      13    |      13    |       0    |
|       from small pool |      37    |      37    |      37    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      41    |     382    |    7244 K  |    7244 K  |
|       from large pool |       5    |      10    |    1595 K  |    1595 K  |
|       from small pool |      36    |     377    |    5649 K  |    5649 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1730 MiB | 424469 GiB | 424469 GiB |
|       from large pool |  16640 KiB |   1660 MiB | 424349 GiB | 424349 GiB |
|       from small pool |      0 KiB |     72 MiB |    119 GiB |    119 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1730 MiB | 424469 GiB | 424469 GiB |
|       from large pool |  16640 KiB |   1660 MiB | 424349 GiB | 424349 GiB |
|       from small pool |      0 KiB |     72 MiB |    119 GiB |    119 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1723 MiB | 424463 GiB | 424463 GiB |
|       from large pool |  16640 KiB |   1653 MiB | 424346 GiB | 424346 GiB |
|       from small pool |      0 KiB |     71 MiB |    117 GiB |    117 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 608256 KiB |   1876 MiB |   1876 MiB |   1282 MiB |
|       from large pool | 565248 KiB |   1802 MiB |   1802 MiB |   1250 MiB |
|       from small pool |  43008 KiB |     74 MiB |     74 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 384768 KiB | 758032 KiB | 301037 GiB | 301036 GiB |
|       from large pool | 384768 KiB | 756864 KiB | 300912 GiB | 300912 GiB |
|       from small pool |      0 KiB |  14441 KiB |    124 GiB |    124 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1851    |   12615 K  |   12615 K  |
|       from large pool |       2    |      76    |    4030 K  |    4030 K  |
|       from small pool |       0    |    1780    |    8585 K  |    8585 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1851    |   12615 K  |   12615 K  |
|       from large pool |       2    |      76    |    4030 K  |    4030 K  |
|       from small pool |       0    |    1780    |    8585 K  |    8585 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      30    |      50    |      50    |      20    |
|       from large pool |       9    |      13    |      13    |       4    |
|       from small pool |      21    |      37    |      37    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     382    |    7245 K  |    7245 K  |
|       from large pool |       1    |      11    |    1595 K  |    1595 K  |
|       from small pool |       0    |     377    |    5649 K  |    5649 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1730 MiB | 424469 GiB | 424469 GiB |
|       from large pool |  16640 KiB |   1660 MiB | 424349 GiB | 424349 GiB |
|       from small pool |      0 KiB |     72 MiB |    119 GiB |    119 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1730 MiB | 424469 GiB | 424469 GiB |
|       from large pool |  16640 KiB |   1660 MiB | 424349 GiB | 424349 GiB |
|       from small pool |      0 KiB |     72 MiB |    119 GiB |    119 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1723 MiB | 424463 GiB | 424463 GiB |
|       from large pool |  16640 KiB |   1653 MiB | 424346 GiB | 424346 GiB |
|       from small pool |      0 KiB |     71 MiB |    117 GiB |    117 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 608256 KiB |   1876 MiB |   1876 MiB |   1282 MiB |
|       from large pool | 565248 KiB |   1802 MiB |   1802 MiB |   1250 MiB |
|       from small pool |  43008 KiB |     74 MiB |     74 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 384768 KiB | 758032 KiB | 301037 GiB | 301036 GiB |
|       from large pool | 384768 KiB | 756864 KiB | 300912 GiB | 300912 GiB |
|       from small pool |      0 KiB |  14441 KiB |    124 GiB |    124 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1851    |   12615 K  |   12615 K  |
|       from large pool |       2    |      76    |    4030 K  |    4030 K  |
|       from small pool |       0    |    1780    |    8585 K  |    8585 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1851    |   12615 K  |   12615 K  |
|       from large pool |       2    |      76    |    4030 K  |    4030 K  |
|       from small pool |       0    |    1780    |    8585 K  |    8585 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      30    |      50    |      50    |      20    |
|       from large pool |       9    |      13    |      13    |       4    |
|       from small pool |      21    |      37    |      37    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     382    |    7245 K  |    7245 K  |
|       from large pool |       1    |      11    |    1595 K  |    1595 K  |
|       from small pool |       0    |     377    |    5649 K  |    5649 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0




!!!: not committed yet



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_23_12_seed_1_21512106

 Experiment start at: 2024-06-20 16:23:12.680584
before training, model accuracy: 0.1456654816865921
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9072132, 'precision': 0.4537037, 'recall': 0.49988207, 'specificity': 0.49988207, 'f1': 0.47567478, 'auroc': 0.5242145, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99976414, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  42385  10
1   4325   0
---- Validation: 
scalar performance:
{'acc': 0.96392745, 'precision': 0.48204088, 'recall': 0.49991697, 'specificity': 0.49991697, 'f1': 0.4908162, 'auroc': 0.32688653, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99983394, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18064  3
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.19813707, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512106_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-20 16:42:12.907973,epoch time: 0:19:00.227389,used: 0:19:00.227389,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_23_12_seed_1_21512106
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9069563, 'precision': 0.45371124, 'recall': 0.49971697, 'specificity': 0.49971697, 'f1': 0.47560415, 'auroc': 0.71699727, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99943393, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  42373  24
1   4323   0
---- Validation: 
scalar performance:
{'acc': 0.96392745, 'precision': 0.48204088, 'recall': 0.49991697, 'specificity': 0.49991697, 'f1': 0.4908162, 'auroc': 0.35515347, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99983394, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18064  3
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.25222838, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512106_2.png
early stop counter: 1
val acc:0.9639274477958679, best validation acc: 0.9639274477958679, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 2,now: 2024-06-20 16:59:27.994293,epoch time: 0:17:15.086320,used: 0:36:15.313709,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_23_12_seed_1_21512106
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9062286, 'precision': 0.5644554, 'recall': 0.50170493, 'specificity': 0.50170493, 'f1': 0.48058662, 'auroc': 0.8142133, 'binary_precision': 0.22115384, 'binary_recall': 0.0053203795, 'binary_specificity': 0.9980895, 'binary_f1_score': 0.010390784}
confusion matrix:
       0   1
0  42316  81
1   4300  23
---- Validation: 
scalar performance:
{'acc': 0.96350056, 'precision': 0.48203322, 'recall': 0.49969557, 'specificity': 0.49969557, 'f1': 0.49070552, 'auroc': 0.39187768, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99939114, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18056  11
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.36322156, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512106_3.png
early stop counter: 2
val acc:0.9635005593299866, best validation acc: 0.9639274477958679, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 3,now: 2024-06-20 17:16:17.236883,epoch time: 0:16:49.242590,used: 0:53:04.556299,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_23_12_seed_1_21512106
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.91605306, 'precision': 0.8386934, 'recall': 0.56610644, 'specificity': 0.56610644, 'f1': 0.5935922, 'auroc': 0.89300907, 'binary_precision': 0.75866497, 'binary_recall': 0.1366474, 'binary_specificity': 0.99556553, 'binary_f1_score': 0.23158309}
confusion matrix:
       0    1
0  42207  188
1   3734  591
---- Validation: 
scalar performance:
{'acc': 0.9626467, 'precision': 0.48201784, 'recall': 0.4992528, 'specificity': 0.4992528, 'f1': 0.49048397, 'auroc': 0.45777774, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9985056, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18040  27
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.5238197, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512106_4.png
early stop counter: 3
val acc:0.9626467227935791, best validation acc: 0.9639274477958679, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 4,now: 2024-06-20 17:33:46.320256,epoch time: 0:17:29.083373,used: 1:10:33.639672,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_23_12_seed_1_21512106
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.931143, 'precision': 0.8903141, 'recall': 0.6533679, 'specificity': 0.6533679, 'f1': 0.70986956, 'auroc': 0.9152289, 'binary_precision': 0.8464912, 'binary_recall': 0.31251445, 'binary_specificity': 0.99422127, 'binary_f1_score': 0.45649603}
confusion matrix:
       0     1
0  42152   245
1   2972  1351
---- Validation: 
scalar performance:
{'acc': 0.9627535, 'precision': 0.48201978, 'recall': 0.49930814, 'specificity': 0.49930814, 'f1': 0.4905117, 'auroc': 0.49747103, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9986163, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18042  25
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.6167842, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512106_5.png
early stop counter: 4
val acc:0.9627534747123718, best validation acc: 0.9639274477958679, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 5,now: 2024-06-20 17:49:59.451186,epoch time: 0:16:13.130930,used: 1:26:46.770602,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_23_12_seed_1_21512106
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9428724, 'precision': 0.9107242, 'recall': 0.7198658, 'specificity': 0.7198658, 'f1': 0.78018713, 'auroc': 0.9300195, 'binary_precision': 0.87522686, 'binary_recall': 0.4462179, 'binary_specificity': 0.9935137, 'binary_f1_score': 0.59108317}
confusion matrix:
       0     1
0  42122   275
1   2394  1929
---- Validation: 
scalar performance:
{'acc': 0.96125937, 'precision': 0.49110857, 'recall': 0.4992485, 'specificity': 0.4992485, 'f1': 0.4914966, 'auroc': 0.5575942, 'binary_precision': 0.018181818, 'binary_recall': 0.0014858841, 'binary_specificity': 0.9970111, 'binary_f1_score': 0.0027472526}
confusion matrix:
       0   1
0  18013  54
1    672   1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582662, 'precision': 0.7488045, 'recall': 0.512957, 'specificity': 0.512957, 'f1': 0.514973, 'auroc': 0.70737755, 'binary_precision': 0.53846157, 'binary_recall': 0.026923077, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.051282056}
confusion matrix:
      0  1
0  5940  6
1   253  7
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512106_6.png
new oracle model saved
early stop counter: 5
val acc:0.9612593650817871, best validation acc: 0.9639274477958679, corresponding to test acc:                         0.9581050872802734 / 0.9582661986351013
after epoch: 6,now: 2024-06-20 18:05:46.043201,epoch time: 0:15:46.592015,used: 1:42:33.362617,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_23_12_seed_1_21512106
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.947774, 'precision': 0.9213493, 'recall': 0.7449105, 'specificity': 0.7449105, 'f1': 0.8046523, 'auroc': 0.9323617, 'binary_precision': 0.8918919, 'binary_recall': 0.49595377, 'binary_specificity': 0.9938672, 'binary_f1_score': 0.6374443}
confusion matrix:
       0     1
0  42135   260
1   2180  2145
---- Validation: 
scalar performance:
{'acc': 0.9615795, 'precision': 0.49222752, 'recall': 0.49941456, 'specificity': 0.49941456, 'f1': 0.49159127, 'auroc': 0.5690236, 'binary_precision': 0.020408163, 'binary_recall': 0.0014858841, 'binary_specificity': 0.99734324, 'binary_f1_score': 0.002770083}
confusion matrix:
       0   1
0  18019  48
1    672   1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959233, 'precision': 0.790756, 'recall': 0.5336904, 'specificity': 0.5336904, 'f1': 0.551849, 'auroc': 0.7222268, 'binary_precision': 0.62068963, 'binary_recall': 0.06923077, 'binary_specificity': 0.99815, 'binary_f1_score': 0.12456747}
confusion matrix:
      0   1
0  5935  11
1   242  18
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512106_7.png
new oracle model saved
early stop counter: 6
val acc:0.9615795016288757, best validation acc: 0.9639274477958679, corresponding to test acc:                         0.9581050872802734 / 0.9592329859733582
after epoch: 7,now: 2024-06-20 18:22:53.227779,epoch time: 0:17:07.184578,used: 1:59:40.547195,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_23_12_seed_1_21512106
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9506635, 'precision': 0.9292583, 'recall': 0.7580259, 'specificity': 0.7580259, 'f1': 0.81763256, 'auroc': 0.92989004, 'binary_precision': 0.9052969, 'binary_recall': 0.5216185, 'binary_specificity': 0.9944333, 'binary_f1_score': 0.6618747}
confusion matrix:
       0     1
0  42159   236
1   2069  2256
---- Validation: 
scalar performance:
{'acc': 0.96120596, 'precision': 0.49928293, 'recall': 0.4999361, 'specificity': 0.4999361, 'f1': 0.49284455, 'auroc': 0.56173575, 'binary_precision': 0.03448276, 'binary_recall': 0.0029717681, 'binary_specificity': 0.99690044, 'binary_f1_score': 0.005471956}
confusion matrix:
       0   1
0  18011  56
1    671   2
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95955527, 'precision': 0.78855824, 'recall': 0.5448925, 'specificity': 0.5448925, 'f1': 0.56990683, 'auroc': 0.7112254, 'binary_precision': 0.61538464, 'binary_recall': 0.092307694, 'binary_specificity': 0.9974773, 'binary_f1_score': 0.16053511}
confusion matrix:
      0   1
0  5931  15
1   236  24
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512106_8.png
new oracle model saved
early stop counter: 7
val acc:0.9612059593200684, best validation acc: 0.9639274477958679, corresponding to test acc:                         0.9581050872802734 / 0.9595552682876587
after epoch: 8,now: 2024-06-20 18:39:04.756866,epoch time: 0:16:11.529087,used: 2:15:52.076282,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_23_12_seed_1_21512106
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9582192, 'precision': 0.93522215, 'recall': 0.8016969, 'specificity': 0.8016969, 'f1': 0.8535744, 'auroc': 0.94723403, 'binary_precision': 0.9089655, 'binary_recall': 0.60962075, 'binary_specificity': 0.993773, 'binary_f1_score': 0.7297896}
confusion matrix:
       0     1
0  42132   264
1   1688  2636
---- Validation: 
scalar performance:
{'acc': 0.9600854, 'precision': 0.534852, 'recall': 0.50507706, 'specificity': 0.50507706, 'f1': 0.5028334, 'auroc': 0.6125405, 'binary_precision': 0.10526316, 'binary_recall': 0.014858841, 'binary_specificity': 0.9952953, 'binary_f1_score': 0.026041666}
confusion matrix:
       0   1
0  17982  85
1    663  10
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9619723, 'precision': 0.8138763, 'recall': 0.5921285, 'specificity': 0.5921285, 'f1': 0.6369368, 'auroc': 0.7562207, 'binary_precision': 0.6621622, 'binary_recall': 0.18846154, 'binary_specificity': 0.9957955, 'binary_f1_score': 0.2934132}
confusion matrix:
      0   1
0  5921  25
1   211  49
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512106_9.png
new oracle model saved
early stop counter: 8
val acc:0.960085391998291, best validation acc: 0.9639274477958679, corresponding to test acc:                         0.9581050872802734 / 0.9619722962379456
after epoch: 9,now: 2024-06-20 18:55:58.015970,epoch time: 0:16:53.259104,used: 2:32:45.335386,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_23_12_seed_1_21512106
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.95646405, 'precision': 0.91780186, 'recall': 0.8052826, 'specificity': 0.8052826, 'f1': 0.8506737, 'auroc': 0.94658875, 'binary_precision': 0.8732899, 'binary_recall': 0.6197411, 'binary_specificity': 0.99082416, 'binary_f1_score': 0.72498643}
confusion matrix:
       0     1
0  42005   389
1   1645  2681
---- Validation: 
scalar performance:
{'acc': 0.9587513, 'precision': 0.55126184, 'recall': 0.5108226, 'specificity': 0.5108226, 'f1': 0.5128876, 'auroc': 0.637755, 'binary_precision': 0.13768116, 'binary_recall': 0.028231798, 'binary_specificity': 0.9934134, 'binary_f1_score': 0.046855733}
confusion matrix:
       0    1
0  17948  119
1    654   19
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.962778, 'precision': 0.79471606, 'recall': 0.6403626, 'specificity': 0.6403626, 'f1': 0.6872502, 'auroc': 0.7853308, 'binary_precision': 0.6198347, 'binary_recall': 0.28846154, 'binary_specificity': 0.99226373, 'binary_f1_score': 0.3937008}
confusion matrix:
      0   1
0  5900  46
1   185  75
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512106_10.png
new oracle model saved
early stop counter: 9
val acc:0.9587513208389282, best validation acc: 0.9639274477958679, corresponding to test acc:                         0.9581050872802734 / 0.9627779722213745
after epoch: 10,now: 2024-06-20 19:13:04.436860,epoch time: 0:17:06.420890,used: 2:49:51.756276,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_23_12_seed_1_21512106
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96010274, 'precision': 0.9302207, 'recall': 0.8181031, 'specificity': 0.8181031, 'f1': 0.8637601, 'auroc': 0.9506748, 'binary_precision': 0.8957529, 'binary_recall': 0.6438483, 'binary_specificity': 0.9923578, 'binary_f1_score': 0.7491927}
confusion matrix:
       0     1
0  42072   324
1   1540  2784
---- Validation: 
scalar performance:
{'acc': 0.9582711, 'precision': 0.5589709, 'recall': 0.51414984, 'specificity': 0.51414984, 'f1': 0.5182472, 'auroc': 0.652689, 'binary_precision': 0.15286624, 'binary_recall': 0.035661217, 'binary_specificity': 0.9926385, 'binary_f1_score': 0.05783132}
confusion matrix:
       0    1
0  17934  133
1    649   24
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96165, 'precision': 0.77553177, 'recall': 0.64712995, 'specificity': 0.64712995, 'f1': 0.6895915, 'auroc': 0.79085684, 'binary_precision': 0.5808824, 'binary_recall': 0.30384615, 'binary_specificity': 0.9904137, 'binary_f1_score': 0.3989899}
confusion matrix:
      0   1
0  5889  57
1   181  79
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512106_11.png
early stop counter: 10
val acc:0.9582710862159729, best validation acc: 0.9639274477958679, corresponding to test acc:                         0.9581050872802734 / 0.9627779722213745
after epoch: 11,now: 2024-06-20 19:31:07.812405,epoch time: 0:18:03.375545,used: 3:07:55.131821,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_23_12_seed_1_21512106
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9631207, 'precision': 0.9310662, 'recall': 0.8372111, 'specificity': 0.8372111, 'f1': 0.87700677, 'auroc': 0.957477, 'binary_precision': 0.89373296, 'binary_recall': 0.68270123, 'binary_specificity': 0.9917209, 'binary_f1_score': 0.7740921}
confusion matrix:
       0     1
0  42045   351
1   1372  2952
---- Validation: 
scalar performance:
{'acc': 0.95816433, 'precision': 0.5935904, 'recall': 0.5283998, 'specificity': 0.5283998, 'f1': 0.5397507, 'auroc': 0.6770412, 'binary_precision': 0.22110553, 'binary_recall': 0.0653789, 'binary_specificity': 0.9914208, 'binary_f1_score': 0.10091743}
confusion matrix:
       0    1
0  17912  155
1    629   44
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96374476, 'precision': 0.7903598, 'recall': 0.68500286, 'specificity': 0.68500286, 'f1': 0.72465897, 'auroc': 0.81132245, 'binary_precision': 0.607362, 'binary_recall': 0.38076922, 'binary_specificity': 0.9892365, 'binary_f1_score': 0.4680851}
confusion matrix:
      0   1
0  5882  64
1   161  99
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512106_12.png
new oracle model saved
early stop counter: 11
val acc:0.9581643342971802, best validation acc: 0.9639274477958679, corresponding to test acc:                         0.9581050872802734 / 0.9637447595596313
after epoch: 12,now: 2024-06-20 19:48:17.918342,epoch time: 0:17:10.105937,used: 3:25:05.237758,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_23_12_seed_1_21512106
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.96284246, 'precision': 0.92284894, 'recall': 0.8435997, 'specificity': 0.8435997, 'f1': 0.8780993, 'auroc': 0.9587703, 'binary_precision': 0.8759442, 'binary_recall': 0.69727105, 'binary_specificity': 0.9899283, 'binary_f1_score': 0.7764615}
confusion matrix:
       0     1
0  41969   427
1   1309  3015
---- Validation: 
scalar performance:
{'acc': 0.9557097, 'precision': 0.58957577, 'recall': 0.53714055, 'specificity': 0.53714055, 'f1': 0.5499515, 'auroc': 0.67197263, 'binary_precision': 0.21245421, 'binary_recall': 0.086181276, 'binary_specificity': 0.9880999, 'binary_f1_score': 0.12262156}
confusion matrix:
       0    1
0  17852  215
1    615   58
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95955527, 'precision': 0.7482277, 'recall': 0.69752836, 'specificity': 0.69752836, 'f1': 0.71960276, 'auroc': 0.8056463, 'binary_precision': 0.5219512, 'binary_recall': 0.41153845, 'binary_specificity': 0.9835183, 'binary_f1_score': 0.46021503}
confusion matrix:
      0    1
0  5848   98
1   153  107
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512106_13.png
early stop counter: 12
val acc:0.95570969581604, best validation acc: 0.9639274477958679, corresponding to test acc:                         0.9581050872802734 / 0.9637447595596313
after epoch: 13,now: 2024-06-20 20:04:18.798150,epoch time: 0:16:00.879808,used: 3:41:06.117566,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_23_12_seed_1_21512106
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96284246, 'precision': 0.9215809, 'recall': 0.8449496, 'specificity': 0.8449496, 'f1': 0.8784692, 'auroc': 0.95895505, 'binary_precision': 0.87312573, 'binary_recall': 0.7002775, 'binary_specificity': 0.98962164, 'binary_f1_score': 0.7772074}
confusion matrix:
       0     1
0  41956   440
1   1296  3028
---- Validation: 
scalar performance:
{'acc': 0.957524, 'precision': 0.6047182, 'recall': 0.53808147, 'specificity': 0.53808147, 'f1': 0.5527127, 'auroc': 0.6984327, 'binary_precision': 0.24267782, 'binary_recall': 0.086181276, 'binary_specificity': 0.9899817, 'binary_f1_score': 0.12719299}
confusion matrix:
       0    1
0  17886  181
1    615   58
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614889, 'precision': 0.76468563, 'recall': 0.6966985, 'specificity': 0.6966985, 'f1': 0.72504246, 'auroc': 0.8203349, 'binary_precision': 0.55497384, 'binary_recall': 0.4076923, 'binary_specificity': 0.98570466, 'binary_f1_score': 0.47006655}
confusion matrix:
      0    1
0  5861   85
1   154  106
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512106_14.png
early stop counter: 13
val acc:0.9575240015983582, best validation acc: 0.9639274477958679, corresponding to test acc:                         0.9581050872802734 / 0.9637447595596313
after epoch: 14,now: 2024-06-20 20:22:44.709415,epoch time: 0:18:25.911265,used: 3:59:32.028831,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_23_12_seed_1_21512106
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.96571064, 'precision': 0.93130255, 'recall': 0.8542141, 'specificity': 0.8542141, 'f1': 0.8880328, 'auroc': 0.96416736, 'binary_precision': 0.8908673, 'binary_recall': 0.7173913, 'binary_specificity': 0.9910369, 'binary_f1_score': 0.7947732}
confusion matrix:
       0     1
0  42016   380
1   1222  3102
---- Validation: 
scalar performance:
{'acc': 0.9588581, 'precision': 0.6241528, 'recall': 0.5423497, 'specificity': 0.5423497, 'f1': 0.55969644, 'auroc': 0.71150404, 'binary_precision': 0.28125, 'binary_recall': 0.0936107, 'binary_specificity': 0.99108875, 'binary_f1_score': 0.14046822}
confusion matrix:
       0    1
0  17906  161
1    610   63
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.965195, 'precision': 0.79766035, 'recall': 0.71334445, 'specificity': 0.71334445, 'f1': 0.74773264, 'auroc': 0.8279257, 'binary_precision': 0.6195652, 'binary_recall': 0.43846154, 'binary_specificity': 0.98822737, 'binary_f1_score': 0.51351345}
confusion matrix:
      0    1
0  5876   70
1   146  114
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512106_15.png
new oracle model saved
early stop counter: 14
val acc:0.958858072757721, best validation acc: 0.9639274477958679, corresponding to test acc:                         0.9581050872802734 / 0.9651950001716614
after epoch: 15,now: 2024-06-20 20:41:34.385645,epoch time: 0:18:49.676230,used: 4:18:21.705061,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_23_12_seed_1_21512106
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.96397686, 'precision': 0.91624033, 'recall': 0.85903215, 'specificity': 0.85903215, 'f1': 0.8849765, 'auroc': 0.96264845, 'binary_precision': 0.85959184, 'binary_recall': 0.73023576, 'binary_specificity': 0.9878285, 'binary_f1_score': 0.7896513}
confusion matrix:
       0     1
0  41878   516
1   1167  3159
---- Validation: 
scalar performance:
{'acc': 0.95715046, 'precision': 0.61049426, 'recall': 0.5443252, 'specificity': 0.5443252, 'f1': 0.5605177, 'auroc': 0.70133865, 'binary_precision': 0.25378788, 'binary_recall': 0.09955423, 'binary_specificity': 0.98909616, 'binary_f1_score': 0.14300959}
confusion matrix:
       0    1
0  17870  197
1    606   67
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9661618, 'precision': 0.8047745, 'recall': 0.7230439, 'specificity': 0.7230439, 'f1': 0.7568487, 'auroc': 0.82437444, 'binary_precision': 0.63297874, 'binary_recall': 0.4576923, 'binary_specificity': 0.9883956, 'binary_f1_score': 0.53124994}
confusion matrix:
      0    1
0  5877   69
1   141  119
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512106_16.png
new oracle model saved
early stop counter: 15
val acc:0.9571504592895508, best validation acc: 0.9639274477958679, corresponding to test acc:                         0.9581050872802734 / 0.9661617875099182
after epoch: 16,now: 2024-06-20 21:02:56.228341,epoch time: 0:21:21.842696,used: 4:39:43.547757,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_23_12_seed_1_21512106
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.96577483, 'precision': 0.9240628, 'recall': 0.86248326, 'specificity': 0.86248326, 'f1': 0.8902448, 'auroc': 0.96490574, 'binary_precision': 0.8746564, 'binary_recall': 0.73572254, 'binary_specificity': 0.98924404, 'binary_f1_score': 0.7991963}
confusion matrix:
       0     1
0  41939   456
1   1143  3182
---- Validation: 
scalar performance:
{'acc': 0.9577908, 'precision': 0.6193458, 'recall': 0.54680306, 'specificity': 0.54680306, 'f1': 0.5643669, 'auroc': 0.70559543, 'binary_precision': 0.27131784, 'binary_recall': 0.104011886, 'binary_specificity': 0.9895943, 'binary_f1_score': 0.15037595}
confusion matrix:
       0    1
0  17879  188
1    603   70
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9660006, 'precision': 0.8024986, 'recall': 0.72479886, 'specificity': 0.72479886, 'f1': 0.7572551, 'auroc': 0.82773554, 'binary_precision': 0.62827224, 'binary_recall': 0.46153846, 'binary_specificity': 0.9880592, 'binary_f1_score': 0.53215075}
confusion matrix:
      0    1
0  5875   71
1   140  120
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512106_17.png
early stop counter: 16
val acc:0.9577907919883728, best validation acc: 0.9639274477958679, corresponding to test acc:                         0.9581050872802734 / 0.9661617875099182
after epoch: 17,now: 2024-06-20 21:20:01.510528,epoch time: 0:17:05.282187,used: 4:56:48.829944,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_23_12_seed_1_21512106
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9645976, 'precision': 0.9149158, 'recall': 0.8648602, 'specificity': 0.8648602, 'f1': 0.8878596, 'auroc': 0.964731, 'binary_precision': 0.85573334, 'binary_recall': 0.74248034, 'binary_specificity': 0.98723996, 'binary_f1_score': 0.7950942}
confusion matrix:
       0     1
0  41857   541
1   1113  3209
---- Validation: 
scalar performance:
{'acc': 0.9569904, 'precision': 0.6279508, 'recall': 0.5606933, 'specificity': 0.5606933, 'f1': 0.580235, 'auroc': 0.7197685, 'binary_precision': 0.28753993, 'binary_recall': 0.13372956, 'binary_specificity': 0.98765707, 'binary_f1_score': 0.18255578}
confusion matrix:
       0    1
0  17844  223
1    583   90
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96406704, 'precision': 0.7806157, 'recall': 0.74217963, 'specificity': 0.74217963, 'f1': 0.7598042, 'auroc': 0.83601713, 'binary_precision': 0.58295965, 'binary_recall': 0.5, 'binary_specificity': 0.9843592, 'binary_f1_score': 0.5383023}
confusion matrix:
      0    1
0  5853   93
1   130  130
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512106_18.png
early stop counter: 17
val acc:0.9569904208183289, best validation acc: 0.9639274477958679, corresponding to test acc:                         0.9581050872802734 / 0.9661617875099182
after epoch: 18,now: 2024-06-20 21:36:13.776827,epoch time: 0:16:12.266299,used: 5:13:01.096243,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_23_12_seed_1_21512106
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9667166, 'precision': 0.926875, 'recall': 0.86580515, 'specificity': 0.86580515, 'f1': 0.89338624, 'auroc': 0.96711504, 'binary_precision': 0.87966007, 'binary_recall': 0.7419653, 'binary_specificity': 0.989645, 'binary_f1_score': 0.8049667}
confusion matrix:
       0     1
0  41956   439
1   1116  3209
---- Validation: 
scalar performance:
{'acc': 0.9579509, 'precision': 0.6253254, 'recall': 0.5504624, 'specificity': 0.5504624, 'f1': 0.56917524, 'auroc': 0.709445, 'binary_precision': 0.28301886, 'binary_recall': 0.11144131, 'binary_specificity': 0.9894836, 'binary_f1_score': 0.1599147}
confusion matrix:
       0    1
0  17877  190
1    598   75
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9690622, 'precision': 0.83126545, 'recall': 0.73743045, 'specificity': 0.73743045, 'f1': 0.77576244, 'auroc': 0.83125174, 'binary_precision': 0.6847826, 'binary_recall': 0.4846154, 'binary_specificity': 0.9902455, 'binary_f1_score': 0.5675675}
confusion matrix:
      0    1
0  5888   58
1   134  126
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512106_19.png
new oracle model saved
early stop counter: 18
val acc:0.9579508900642395, best validation acc: 0.9639274477958679, corresponding to test acc:                         0.9581050872802734 / 0.9690622091293335
after epoch: 19,now: 2024-06-20 21:50:19.811424,epoch time: 0:14:06.034597,used: 5:27:07.130840,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_23_12_seed_1_21512106
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9669949, 'precision': 0.9217808, 'recall': 0.87364066, 'specificity': 0.87364066, 'f1': 0.8958734, 'auroc': 0.96563137, 'binary_precision': 0.86782974, 'binary_recall': 0.75907516, 'binary_specificity': 0.98820615, 'binary_f1_score': 0.8098175}
confusion matrix:
       0     1
0  41895   500
1   1042  3283
---- Validation: 
scalar performance:
{'acc': 0.9562967, 'precision': 0.6229146, 'recall': 0.5610488, 'specificity': 0.5610488, 'f1': 0.5796834, 'auroc': 0.7154216, 'binary_precision': 0.27743903, 'binary_recall': 0.13521545, 'binary_specificity': 0.98688215, 'binary_f1_score': 0.18181819}
confusion matrix:
       0    1
0  17830  237
1    582   91
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96374476, 'precision': 0.77750194, 'recall': 0.7456894, 'specificity': 0.7456894, 'f1': 0.7605031, 'auroc': 0.8411751, 'binary_precision': 0.57641923, 'binary_recall': 0.50769234, 'binary_specificity': 0.9836865, 'binary_f1_score': 0.53987736}
confusion matrix:
      0    1
0  5849   97
1   128  132
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512106_20.png
early stop counter: 19
val acc:0.9562966823577881, best validation acc: 0.9639274477958679, corresponding to test acc:                         0.9581050872802734 / 0.9690622091293335
after epoch: 20,now: 2024-06-20 22:05:46.949855,epoch time: 0:15:27.138431,used: 5:42:34.269271,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_23_12_seed_1_21512106
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9666738, 'precision': 0.9219549, 'recall': 0.8711798, 'specificity': 0.8711798, 'f1': 0.894519, 'auroc': 0.96958876, 'binary_precision': 0.86867344, 'binary_recall': 0.75398844, 'binary_specificity': 0.98837125, 'binary_f1_score': 0.8072782}
confusion matrix:
       0     1
0  41902   493
1   1064  3261
---- Validation: 
scalar performance:
{'acc': 0.95715046, 'precision': 0.6293447, 'recall': 0.56077635, 'specificity': 0.56077635, 'f1': 0.58055556, 'auroc': 0.7302729, 'binary_precision': 0.29032257, 'binary_recall': 0.13372956, 'binary_specificity': 0.9878231, 'binary_f1_score': 0.18311292}
confusion matrix:
       0    1
0  17847  220
1    583   90
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96358365, 'precision': 0.7755479, 'recall': 0.7511223, 'specificity': 0.7511223, 'f1': 0.76269436, 'auroc': 0.8443698, 'binary_precision': 0.5720339, 'binary_recall': 0.5192308, 'binary_specificity': 0.9830138, 'binary_f1_score': 0.5443548}
confusion matrix:
      0    1
0  5845  101
1   125  135
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512106_21.png
early stop counter: 20
val acc:0.9571504592895508, best validation acc: 0.9639274477958679, corresponding to test acc:                         0.9581050872802734 / 0.9690622091293335
after epoch: 21,now: 2024-06-20 22:20:03.212068,epoch time: 0:14:16.262213,used: 5:56:50.531484,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_23_12_seed_1_21512106
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9682791, 'precision': 0.92581487, 'recall': 0.8777473, 'specificity': 0.8777473, 'f1': 0.8999697, 'auroc': 0.96884686, 'binary_precision': 0.875132, 'binary_recall': 0.7666513, 'binary_specificity': 0.98884326, 'binary_f1_score': 0.8173078}
confusion matrix:
       0     1
0  41923   473
1   1009  3315
---- Validation: 
scalar performance:
{'acc': 0.95640343, 'precision': 0.63102865, 'recall': 0.5689721, 'specificity': 0.5689721, 'f1': 0.5886977, 'auroc': 0.7344941, 'binary_precision': 0.29310346, 'binary_recall': 0.15156017, 'binary_specificity': 0.98638403, 'binary_f1_score': 0.1998041}
confusion matrix:
       0    1
0  17821  246
1    571  102
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9656784, 'precision': 0.790384, 'recall': 0.76141036, 'specificity': 0.76141036, 'f1': 0.7750404, 'auroc': 0.84422946, 'binary_precision': 0.6008584, 'binary_recall': 0.53846157, 'binary_specificity': 0.9843592, 'binary_f1_score': 0.5679514}
confusion matrix:
      0    1
0  5853   93
1   120  140
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512106_22.png
early stop counter: 21
val acc:0.9564034342765808, best validation acc: 0.9639274477958679, corresponding to test acc:                         0.9581050872802734 / 0.9690622091293335
after epoch: 22,now: 2024-06-20 22:36:26.508268,epoch time: 0:16:23.296200,used: 6:13:13.827684,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_23_12_seed_1_21512106
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9669735, 'precision': 0.91385865, 'recall': 0.88359493, 'specificity': 0.88359493, 'f1': 0.89799774, 'auroc': 0.9711833, 'binary_precision': 0.8498491, 'binary_recall': 0.7812717, 'binary_specificity': 0.98591816, 'binary_f1_score': 0.8141188}
confusion matrix:
       0     1
0  41798   597
1    946  3379
---- Validation: 
scalar performance:
{'acc': 0.95640343, 'precision': 0.63800913, 'recall': 0.5775553, 'specificity': 0.5775553, 'f1': 0.5978791, 'auroc': 0.73946404, 'binary_precision': 0.30645162, 'binary_recall': 0.16939078, 'binary_specificity': 0.9857198, 'binary_f1_score': 0.2181818}
confusion matrix:
       0    1
0  17809  258
1    559  114
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9643893, 'precision': 0.7801453, 'recall': 0.76257664, 'specificity': 0.76257664, 'f1': 0.77103937, 'auroc': 0.846305, 'binary_precision': 0.5802469, 'binary_recall': 0.5423077, 'binary_specificity': 0.9828456, 'binary_f1_score': 0.56063616}
confusion matrix:
      0    1
0  5844  102
1   119  141
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512106_23.png
early stop counter: 22
val acc:0.9564034342765808, best validation acc: 0.9639274477958679, corresponding to test acc:                         0.9581050872802734 / 0.9690622091293335
after epoch: 23,now: 2024-06-20 22:52:39.782337,epoch time: 0:16:13.274069,used: 6:29:27.101753,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_23_12_seed_1_21512106
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.96714467, 'precision': 0.91746557, 'recall': 0.88002974, 'specificity': 0.88002974, 'f1': 0.8976353, 'auroc': 0.96691394, 'binary_precision': 0.85783935, 'binary_recall': 0.7731267, 'binary_specificity': 0.98693275, 'binary_f1_score': 0.813283}
confusion matrix:
       0     1
0  41842   554
1    981  3343
---- Validation: 
scalar performance:
{'acc': 0.95565635, 'precision': 0.62343353, 'recall': 0.56643885, 'specificity': 0.56643885, 'f1': 0.58481103, 'auroc': 0.71992135, 'binary_precision': 0.27808988, 'binary_recall': 0.14710252, 'binary_specificity': 0.9857752, 'binary_f1_score': 0.19241981}
confusion matrix:
       0    1
0  17810  257
1    574   99
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9634225, 'precision': 0.77260673, 'recall': 0.7675891, 'specificity': 0.7675891, 'f1': 0.77007145, 'auroc': 0.8432359, 'binary_precision': 0.5647059, 'binary_recall': 0.5538462, 'binary_specificity': 0.981332, 'binary_f1_score': 0.5592233}
confusion matrix:
      0    1
0  5835  111
1   116  144
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512106_24.png
early stop counter: 23
val acc:0.9556563496589661, best validation acc: 0.9639274477958679, corresponding to test acc:                         0.9581050872802734 / 0.9690622091293335
after epoch: 24,now: 2024-06-20 23:09:07.255364,epoch time: 0:16:27.473027,used: 6:45:54.574780,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_23_12_seed_1_21512106
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.965625, 'precision': 0.89743114, 'recall': 0.8980913, 'specificity': 0.8980913, 'f1': 0.89776087, 'auroc': 0.97324455, 'binary_precision': 0.8137119, 'binary_recall': 0.8152174, 'binary_specificity': 0.9809652, 'binary_f1_score': 0.8144639}
confusion matrix:
       0     1
0  41589   807
1    799  3525
---- Validation: 
scalar performance:
{'acc': 0.9525614, 'precision': 0.6226862, 'recall': 0.5884375, 'specificity': 0.5884375, 'f1': 0.60224783, 'auroc': 0.7492339, 'binary_precision': 0.275, 'binary_recall': 0.1961367, 'binary_specificity': 0.98073834, 'binary_f1_score': 0.2289679}
confusion matrix:
       0    1
0  17719  348
1    541  132
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96052206, 'precision': 0.75386894, 'recall': 0.7771094, 'specificity': 0.7771094, 'f1': 0.76490664, 'auroc': 0.8552977, 'binary_precision': 0.5263158, 'binary_recall': 0.5769231, 'binary_specificity': 0.97729564, 'binary_f1_score': 0.5504587}
confusion matrix:
      0    1
0  5811  135
1   110  150
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512106_25.png
early stop counter: 24
val acc:0.9525613784790039, best validation acc: 0.9639274477958679, corresponding to test acc:                         0.9581050872802734 / 0.9690622091293335
after epoch: 25,now: 2024-06-20 23:23:12.191378,epoch time: 0:14:04.936014,used: 6:59:59.510794,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_23_12_seed_1_21512106
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9672945, 'precision': 0.91040796, 'recall': 0.8906807, 'specificity': 0.8906807, 'f1': 0.9002349, 'auroc': 0.9707791, 'binary_precision': 0.8414366, 'binary_recall': 0.796669, 'binary_specificity': 0.98469234, 'binary_f1_score': 0.8184411}
confusion matrix:
       0     1
0  41748   649
1    879  3444
---- Validation: 
scalar performance:
{'acc': 0.9545357, 'precision': 0.62366086, 'recall': 0.57515615, 'specificity': 0.57515615, 'f1': 0.5923872, 'auroc': 0.73472536, 'binary_precision': 0.27791563, 'binary_recall': 0.16641901, 'binary_specificity': 0.9838933, 'binary_f1_score': 0.20817843}
confusion matrix:
       0    1
0  17776  291
1    561  112
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9624557, 'precision': 0.76587737, 'recall': 0.7707625, 'specificity': 0.7707625, 'f1': 0.7682946, 'auroc': 0.8547447, 'binary_precision': 0.5509434, 'binary_recall': 0.56153846, 'binary_specificity': 0.97998655, 'binary_f1_score': 0.55619043}
confusion matrix:
      0    1
0  5827  119
1   114  146
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512106_26.png
early stop counter: 25
val acc:0.954535722732544, best validation acc: 0.9639274477958679, corresponding to test acc:                         0.9581050872802734 / 0.9690622091293335
after epoch: 26,now: 2024-06-20 23:39:09.465242,epoch time: 0:15:57.273864,used: 7:15:56.784658,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_23_12_seed_1_21512106
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.96545374, 'precision': 0.89454126, 'recall': 0.9017352, 'specificity': 0.9017352, 'f1': 0.8980963, 'auroc': 0.97302043, 'binary_precision': 0.8071169, 'binary_recall': 0.823543, 'binary_specificity': 0.97992736, 'binary_f1_score': 0.81524724}
confusion matrix:
       0     1
0  41545   851
1    763  3561
---- Validation: 
scalar performance:
{'acc': 0.95133406, 'precision': 0.6193029, 'recall': 0.59209263, 'specificity': 0.59209263, 'f1': 0.60359687, 'auroc': 0.7530643, 'binary_precision': 0.26796117, 'binary_recall': 0.205052, 'binary_specificity': 0.97913325, 'binary_f1_score': 0.23232324}
confusion matrix:
       0    1
0  17690  377
1    535  138
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9569771, 'precision': 0.735913, 'recall': 0.78997123, 'specificity': 0.78997123, 'f1': 0.75972617, 'auroc': 0.86092395, 'binary_precision': 0.48916408, 'binary_recall': 0.6076923, 'binary_specificity': 0.9722502, 'binary_f1_score': 0.542024}
confusion matrix:
      0    1
0  5781  165
1   102  158
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512106_27.png
early stop counter: 26
val acc:0.9513340592384338, best validation acc: 0.9639274477958679, corresponding to test acc:                         0.9581050872802734 / 0.9690622091293335
after epoch: 27,now: 2024-06-20 23:59:13.859246,epoch time: 0:20:04.394004,used: 7:36:01.178662,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_23_12_seed_1_21512106
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.96607447, 'precision': 0.89863247, 'recall': 0.89954334, 'specificity': 0.89954334, 'f1': 0.89908725, 'auroc': 0.97488034, 'binary_precision': 0.81583196, 'binary_recall': 0.81790835, 'binary_specificity': 0.98117834, 'binary_f1_score': 0.81686884}
confusion matrix:
       0     1
0  41600   798
1    787  3535
---- Validation: 
scalar performance:
{'acc': 0.95176095, 'precision': 0.61998194, 'recall': 0.5901682, 'specificity': 0.5901682, 'f1': 0.60254174, 'auroc': 0.75541687, 'binary_precision': 0.26946107, 'binary_recall': 0.20059435, 'binary_specificity': 0.97974205, 'binary_f1_score': 0.22998297}
confusion matrix:
       0    1
0  17701  366
1    538  135
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606832, 'precision': 0.75474983, 'recall': 0.78271043, 'specificity': 0.78271043, 'f1': 0.7678969, 'auroc': 0.8630501, 'binary_precision': 0.5275862, 'binary_recall': 0.5884615, 'binary_specificity': 0.9769593, 'binary_f1_score': 0.55636364}
confusion matrix:
      0    1
0  5809  137
1   107  153
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512106_28.png
early stop counter: 27
val acc:0.9517609477043152, best validation acc: 0.9639274477958679, corresponding to test acc:                         0.9581050872802734 / 0.9690622091293335
after epoch: 28,now: 2024-06-21 00:20:05.694309,epoch time: 0:20:51.835063,used: 7:56:53.013725,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_23_12_seed_1_21512106
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9683219, 'precision': 0.9187819, 'recall': 0.88682944, 'specificity': 0.88682944, 'f1': 0.9020026, 'auroc': 0.9740249, 'binary_precision': 0.8591265, 'binary_recall': 0.7868208, 'binary_specificity': 0.98683804, 'binary_f1_score': 0.8213855}
confusion matrix:
       0     1
0  41837   558
1    922  3403
---- Validation: 
scalar performance:
{'acc': 0.9570971, 'precision': 0.64194125, 'recall': 0.57576925, 'specificity': 0.57576925, 'f1': 0.5971595, 'auroc': 0.7489116, 'binary_precision': 0.31444758, 'binary_recall': 0.16493313, 'binary_specificity': 0.9866054, 'binary_f1_score': 0.21637426}
confusion matrix:
       0    1
0  17825  242
1    562  111
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96890104, 'precision': 0.8173375, 'recall': 0.7667701, 'specificity': 0.7667701, 'f1': 0.7896085, 'auroc': 0.8555707, 'binary_precision': 0.6543779, 'binary_recall': 0.54615384, 'binary_specificity': 0.98738647, 'binary_f1_score': 0.5953879}
confusion matrix:
      0    1
0  5871   75
1   118  142
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512106_29.png
early stop counter: 28
val acc:0.9570971131324768, best validation acc: 0.9639274477958679, corresponding to test acc:                         0.9581050872802734 / 0.9690622091293335
after epoch: 29,now: 2024-06-21 00:41:46.984182,epoch time: 0:21:41.289873,used: 8:18:34.303598,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_23_12_seed_1_21512106
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.96748716, 'precision': 0.901085, 'recall': 0.90682065, 'specificity': 0.90682065, 'f1': 0.9039266, 'auroc': 0.97684234, 'binary_precision': 0.81929904, 'binary_recall': 0.8323699, 'binary_specificity': 0.9812714, 'binary_f1_score': 0.8257827}
confusion matrix:
       0     1
0  41601   794
1    725  3600
---- Validation: 
scalar performance:
{'acc': 0.9527215, 'precision': 0.62501746, 'recall': 0.59066635, 'specificity': 0.59066635, 'f1': 0.6045862, 'auroc': 0.7480896, 'binary_precision': 0.2795031, 'binary_recall': 0.20059435, 'binary_specificity': 0.98073834, 'binary_f1_score': 0.233564}
confusion matrix:
       0    1
0  17719  348
1    538  135
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587496, 'precision': 0.7442496, 'recall': 0.7817013, 'specificity': 0.7817013, 'f1': 0.7614403, 'auroc': 0.8607144, 'binary_precision': 0.5066225, 'binary_recall': 0.5884615, 'binary_specificity': 0.97494113, 'binary_f1_score': 0.54448396}
confusion matrix:
      0    1
0  5797  149
1   107  153
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512106_30.png
early stop counter: 29
val acc:0.9527214765548706, best validation acc: 0.9639274477958679, corresponding to test acc:                         0.9581050872802734 / 0.9690622091293335
after epoch: 30,now: 2024-06-21 01:02:58.765241,epoch time: 0:21:11.781059,used: 8:39:46.084657,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_16_23_12_seed_1_21512106
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 8:39:46.084657 at 2024-06-21 01:02:58.765241
persisted model performance metric: 

scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.19813707, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
oracle model performance metric: 

scalar performance:
{'acc': 0.9690622, 'precision': 0.83126545, 'recall': 0.73743045, 'specificity': 0.73743045, 'f1': 0.77576244, 'auroc': 0.83125174, 'binary_precision': 0.6847826, 'binary_recall': 0.4846154, 'binary_specificity': 0.9902455, 'binary_f1_score': 0.5675675}
confusion matrix:
      0    1
0  5888   58
1   134  126
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_irm_resnet_different_bs128_lre4_classbalancing/rule_results/9.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_irm_resnet_different_bs128_lre4_classbalancing/confusion_matrix/9.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204094 KiB |   1730 MiB |    828 TiB |    828 TiB |
|       from large pool | 167936 KiB |   1660 MiB |    828 TiB |    828 TiB |
|       from small pool |  36158 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 204094 KiB |   1730 MiB |    828 TiB |    828 TiB |
|       from large pool | 167936 KiB |   1660 MiB |    828 TiB |    828 TiB |
|       from small pool |  36158 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201086 KiB |   1723 MiB |    828 TiB |    828 TiB |
|       from large pool | 165120 KiB |   1653 MiB |    828 TiB |    828 TiB |
|       from small pool |  35966 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1802 MiB |   1876 MiB |   3084 MiB |   1282 MiB |
|       from large pool |   1728 MiB |   1802 MiB |   2978 MiB |   1250 MiB |
|       from small pool |     74 MiB |     74 MiB |    106 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 404161 KiB |    900 MiB | 626015 GiB | 626014 GiB |
|       from large pool | 397312 KiB |    899 MiB | 625766 GiB | 625765 GiB |
|       from small pool |   6849 KiB |     14 MiB |    249 GiB |    249 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1194    |    1851    |   25230 K  |   25229 K  |
|       from large pool |      36    |      76    |    8060 K  |    8060 K  |
|       from small pool |    1158    |    1780    |   17169 K  |   17168 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1194    |    1851    |   25230 K  |   25229 K  |
|       from large pool |      36    |      76    |    8060 K  |    8060 K  |
|       from small pool |    1158    |    1780    |   17169 K  |   17168 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      49    |      50    |      69    |      20    |
|       from large pool |      12    |      13    |      16    |       4    |
|       from small pool |      37    |      37    |      53    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      49    |     382    |   14477 K  |   14477 K  |
|       from large pool |       5    |      11    |    3213 K  |    3213 K  |
|       from small pool |      44    |     377    |   11264 K  |   11264 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1730 MiB |    828 TiB |    828 TiB |
|       from large pool |  16640 KiB |   1660 MiB |    828 TiB |    828 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1730 MiB |    828 TiB |    828 TiB |
|       from large pool |  16640 KiB |   1660 MiB |    828 TiB |    828 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1723 MiB |    828 TiB |    828 TiB |
|       from large pool |  16640 KiB |   1653 MiB |    828 TiB |    828 TiB |
|       from small pool |      0 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 608256 KiB |   1876 MiB |   3084 MiB |   2490 MiB |
|       from large pool | 565248 KiB |   1802 MiB |   2978 MiB |   2426 MiB |
|       from small pool |  43008 KiB |     74 MiB |    106 MiB |     64 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 384768 KiB |    900 MiB | 626015 GiB | 626015 GiB |
|       from large pool | 384768 KiB |    899 MiB | 625766 GiB | 625765 GiB |
|       from small pool |      0 KiB |     14 MiB |    249 GiB |    249 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1851    |   25230 K  |   25230 K  |
|       from large pool |       2    |      76    |    8060 K  |    8060 K  |
|       from small pool |       0    |    1780    |   17169 K  |   17169 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1851    |   25230 K  |   25230 K  |
|       from large pool |       2    |      76    |    8060 K  |    8060 K  |
|       from small pool |       0    |    1780    |   17169 K  |   17169 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      30    |      50    |      69    |      39    |
|       from large pool |       9    |      13    |      16    |       7    |
|       from small pool |      21    |      37    |      53    |      32    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     382    |   14477 K  |   14477 K  |
|       from large pool |       1    |      11    |    3213 K  |    3213 K  |
|       from small pool |       0    |     377    |   11264 K  |   11264 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1730 MiB |    828 TiB |    828 TiB |
|       from large pool |  16640 KiB |   1660 MiB |    828 TiB |    828 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1730 MiB |    828 TiB |    828 TiB |
|       from large pool |  16640 KiB |   1660 MiB |    828 TiB |    828 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1723 MiB |    828 TiB |    828 TiB |
|       from large pool |  16640 KiB |   1653 MiB |    828 TiB |    828 TiB |
|       from small pool |      0 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 608256 KiB |   1876 MiB |   3084 MiB |   2490 MiB |
|       from large pool | 565248 KiB |   1802 MiB |   2978 MiB |   2426 MiB |
|       from small pool |  43008 KiB |     74 MiB |    106 MiB |     64 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 384768 KiB |    900 MiB | 626015 GiB | 626015 GiB |
|       from large pool | 384768 KiB |    899 MiB | 625766 GiB | 625765 GiB |
|       from small pool |      0 KiB |     14 MiB |    249 GiB |    249 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1851    |   25230 K  |   25230 K  |
|       from large pool |       2    |      76    |    8060 K  |    8060 K  |
|       from small pool |       0    |    1780    |   17169 K  |   17169 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1851    |   25230 K  |   25230 K  |
|       from large pool |       2    |      76    |    8060 K  |    8060 K  |
|       from small pool |       0    |    1780    |   17169 K  |   17169 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      30    |      50    |      69    |      39    |
|       from large pool |       9    |      13    |      16    |       7    |
|       from small pool |      21    |      37    |      53    |      32    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     382    |   14477 K  |   14477 K  |
|       from large pool |       1    |      11    |    3213 K  |    3213 K  |
|       from small pool |       0    |     377    |   11264 K  |   11264 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0




!!!: not committed yet



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_01_13_55_seed_2_21512106

 Experiment start at: 2024-06-21 01:13:55.356943
before training, model accuracy: 0.0544959120452404
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9031122, 'precision': 0.4515561, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4745449, 'auroc': 0.50789464, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42309  0
1   4539  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.3394826, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.28924036, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512106_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-21 01:36:32.543226,epoch time: 0:22:37.186283,used: 0:22:37.186283,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_01_13_55_seed_2_21512106
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9031122, 'precision': 0.4515561, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4745449, 'auroc': 0.72956693, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42309  0
1   4539  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.38839412, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.4195851, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512106_2.png
early stop counter: 1
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 2,now: 2024-06-21 02:00:28.643548,epoch time: 0:23:56.100322,used: 0:46:33.286605,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_01_13_55_seed_2_21512106
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9056096, 'precision': 0.92602986, 'recall': 0.5135767, 'specificity': 0.5135767, 'f1': 0.50171703, 'auroc': 0.85774064, 'binary_precision': 0.9465649, 'binary_recall': 0.027318792, 'binary_specificity': 0.99983454, 'binary_f1_score': 0.053104922}
confusion matrix:
       0    1
0  42302    7
1   4415  124
---- Validation: 
scalar performance:
{'acc': 0.9678261, 'precision': 0.48396462, 'recall': 0.49994496, 'specificity': 0.49994496, 'f1': 0.49182498, 'auroc': 0.44642615, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998899, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18169  2
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.5787866, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512106_3.png
early stop counter: 2
val acc:0.9678261280059814, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 3,now: 2024-06-21 02:25:51.039262,epoch time: 0:25:22.395714,used: 1:11:55.682319,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_01_13_55_seed_2_21512106
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.92208844, 'precision': 0.938154, 'recall': 0.60216844, 'specificity': 0.60216844, 'f1': 0.6483284, 'auroc': 0.89335585, 'binary_precision': 0.954918, 'binary_recall': 0.20537682, 'binary_specificity': 0.9989601, 'binary_f1_score': 0.33804858}
confusion matrix:
       0    1
0  42266   44
1   3606  932
---- Validation: 
scalar performance:
{'acc': 0.9670271, 'precision': 0.4839518, 'recall': 0.49953222, 'specificity': 0.49953222, 'f1': 0.4916186, 'auroc': 0.490995, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99906445, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18154  17
1    602   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96105146, 'precision': 0.48060277, 'recall': 0.4999166, 'specificity': 0.4999166, 'f1': 0.49006948, 'auroc': 0.6555773, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5996  1
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512106_4.png
early stop counter: 3
val acc:0.9670271277427673, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 4,now: 2024-06-21 02:39:27.820930,epoch time: 0:13:36.781668,used: 1:25:32.463987,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_01_13_55_seed_2_21512106
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.935707, 'precision': 0.9451288, 'recall': 0.67558426, 'specificity': 0.67558426, 'f1': 0.74050665, 'auroc': 0.91122365, 'binary_precision': 0.95527726, 'binary_recall': 0.3529412, 'binary_specificity': 0.9982273, 'binary_f1_score': 0.515444}
confusion matrix:
       0     1
0  42234    75
1   2937  1602
---- Validation: 
scalar performance:
{'acc': 0.96644115, 'precision': 0.4839424, 'recall': 0.49922955, 'specificity': 0.49922955, 'f1': 0.49146712, 'auroc': 0.5176307, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9984591, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18143  28
1    602   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9623337, 'precision': 0.86598384, 'recall': 0.520411, 'specificity': 0.520411, 'f1': 0.5296027, 'auroc': 0.69020605, 'binary_precision': 0.7692308, 'binary_recall': 0.041322313, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.078431375}
confusion matrix:
      0   1
0  5994   3
1   232  10
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512106_5.png
new oracle model saved
early stop counter: 4
val acc:0.9664411544799805, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9623336791992188
after epoch: 5,now: 2024-06-21 03:01:01.959531,epoch time: 0:21:34.138601,used: 1:47:06.602588,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_01_13_55_seed_2_21512106
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.94599557, 'precision': 0.9418634, 'recall': 0.7354071, 'specificity': 0.7354071, 'f1': 0.8003328, 'auroc': 0.9267521, 'binary_precision': 0.9372822, 'binary_recall': 0.4742177, 'binary_specificity': 0.9965966, 'binary_f1_score': 0.6297922}
confusion matrix:
       0     1
0  42166   144
1   2386  2152
---- Validation: 
scalar performance:
{'acc': 0.9642572, 'precision': 0.49097446, 'recall': 0.4989044, 'specificity': 0.4989044, 'f1': 0.49238706, 'auroc': 0.56619304, 'binary_precision': 0.014084507, 'binary_recall': 0.0016611295, 'binary_specificity': 0.9961477, 'binary_f1_score': 0.0029717684}
confusion matrix:
       0   1
0  18101  70
1    601   1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9632954, 'precision': 0.7992829, 'recall': 0.5625488, 'specificity': 0.5625488, 'f1': 0.597134, 'auroc': 0.7280183, 'binary_precision': 0.63265306, 'binary_recall': 0.12809917, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.21305843}
confusion matrix:
      0   1
0  5979  18
1   211  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512106_6.png
new oracle model saved
early stop counter: 5
val acc:0.9642571806907654, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9632954001426697
after epoch: 6,now: 2024-06-21 03:27:01.687007,epoch time: 0:25:59.727476,used: 2:13:06.330064,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_01_13_55_seed_2_21512106
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9498805, 'precision': 0.942801, 'recall': 0.7574273, 'specificity': 0.7574273, 'f1': 0.82006645, 'auroc': 0.9352921, 'binary_precision': 0.93486893, 'binary_recall': 0.5187307, 'binary_specificity': 0.99612385, 'binary_f1_score': 0.6672335}
confusion matrix:
       0     1
0  42146   164
1   2184  2354
---- Validation: 
scalar performance:
{'acc': 0.96415067, 'precision': 0.4907798, 'recall': 0.4988494, 'specificity': 0.4988494, 'f1': 0.49235505, 'auroc': 0.60130316, 'binary_precision': 0.01369863, 'binary_recall': 0.0016611295, 'binary_specificity': 0.99603766, 'binary_f1_score': 0.002962963}
confusion matrix:
       0   1
0  18099  72
1    601   1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645777, 'precision': 0.81714165, 'recall': 0.58502597, 'specificity': 0.58502597, 'f1': 0.6286275, 'auroc': 0.7409159, 'binary_precision': 0.6666667, 'binary_recall': 0.17355372, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.27540985}
confusion matrix:
      0   1
0  5976  21
1   200  42
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512106_7.png
new oracle model saved
early stop counter: 6
val acc:0.9641506671905518, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9645776748657227
after epoch: 7,now: 2024-06-21 03:54:27.968980,epoch time: 0:27:26.281973,used: 2:40:32.612037,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_01_13_55_seed_2_21512106
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.95664704, 'precision': 0.93303055, 'recall': 0.80488884, 'specificity': 0.80488884, 'f1': 0.8550905, 'auroc': 0.9461509, 'binary_precision': 0.90582526, 'binary_recall': 0.61665565, 'binary_specificity': 0.99312204, 'binary_f1_score': 0.73377895}
confusion matrix:
       0     1
0  42018   291
1   1740  2799
---- Validation: 
scalar performance:
{'acc': 0.96196663, 'precision': 0.5398274, 'recall': 0.50976694, 'specificity': 0.50976694, 'f1': 0.51174664, 'auroc': 0.6307342, 'binary_precision': 0.11111111, 'binary_recall': 0.026578072, 'binary_specificity': 0.9929558, 'binary_f1_score': 0.04289544}
confusion matrix:
       0    1
0  18043  128
1    586   16
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9644174, 'precision': 0.77585953, 'recall': 0.64640754, 'specificity': 0.64640754, 'f1': 0.6892036, 'auroc': 0.768325, 'binary_precision': 0.5793651, 'binary_recall': 0.30165288, 'binary_specificity': 0.99116224, 'binary_f1_score': 0.39673913}
confusion matrix:
      0   1
0  5944  53
1   169  73
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512106_8.png
early stop counter: 7
val acc:0.9619666337966919, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9645776748657227
after epoch: 8,now: 2024-06-21 04:22:16.147007,epoch time: 0:27:48.178027,used: 3:08:20.790064,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_01_13_55_seed_2_21512106
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9564763, 'precision': 0.93342817, 'recall': 0.8035159, 'specificity': 0.8035159, 'f1': 0.8542062, 'auroc': 0.94447017, 'binary_precision': 0.90690106, 'binary_recall': 0.6137916, 'binary_specificity': 0.99324024, 'binary_f1_score': 0.73209834}
confusion matrix:
       0     1
0  42023   286
1   1753  2786
---- Validation: 
scalar performance:
{'acc': 0.9619134, 'precision': 0.5394434, 'recall': 0.50973946, 'specificity': 0.50973946, 'f1': 0.5117041, 'auroc': 0.63571644, 'binary_precision': 0.11034483, 'binary_recall': 0.026578072, 'binary_specificity': 0.9929008, 'binary_f1_score': 0.04283802}
confusion matrix:
       0    1
0  18042  129
1    586   16
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9661805, 'precision': 0.79858816, 'recall': 0.6572384, 'specificity': 0.6572384, 'f1': 0.703823, 'auroc': 0.7737932, 'binary_precision': 0.624, 'binary_recall': 0.32231405, 'binary_specificity': 0.99216276, 'binary_f1_score': 0.4250681}
confusion matrix:
      0   1
0  5950  47
1   164  78
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512106_9.png
new oracle model saved
early stop counter: 8
val acc:0.9619134068489075, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9661805033683777
after epoch: 9,now: 2024-06-21 04:50:50.208158,epoch time: 0:28:34.061151,used: 3:36:54.851215,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_01_13_55_seed_2_21512106
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9582266, 'precision': 0.9300985, 'recall': 0.8171313, 'specificity': 0.8171313, 'f1': 0.8629199, 'auroc': 0.9485986, 'binary_precision': 0.8974438, 'binary_recall': 0.6421331, 'binary_specificity': 0.9921295, 'binary_f1_score': 0.7486192}
confusion matrix:
       0     1
0  41977   333
1   1624  2914
---- Validation: 
scalar performance:
{'acc': 0.96079475, 'precision': 0.5637132, 'recall': 0.52120733, 'specificity': 0.52120733, 'f1': 0.528833, 'auroc': 0.6459861, 'binary_precision': 0.15816326, 'binary_recall': 0.051495016, 'binary_specificity': 0.9909196, 'binary_f1_score': 0.07769424}
confusion matrix:
       0    1
0  18006  165
1    571   31
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650585, 'precision': 0.77516246, 'recall': 0.68441314, 'specificity': 0.68441314, 'f1': 0.7198295, 'auroc': 0.78043425, 'binary_precision': 0.575, 'binary_recall': 0.38016528, 'binary_specificity': 0.988661, 'binary_f1_score': 0.45771143}
confusion matrix:
      0   1
0  5929  68
1   150  92
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512106_10.png
early stop counter: 9
val acc:0.9607947468757629, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9661805033683777
after epoch: 10,now: 2024-06-21 05:07:22.799375,epoch time: 0:16:32.591217,used: 3:53:27.442432,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_01_13_55_seed_2_21512106
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9582266, 'precision': 0.9217362, 'recall': 0.82493937, 'specificity': 0.82493937, 'f1': 0.8654298, 'auroc': 0.95071924, 'binary_precision': 0.879037, 'binary_recall': 0.65961665, 'binary_specificity': 0.9902621, 'binary_f1_score': 0.75368154}
confusion matrix:
       0     1
0  41897   412
1   1545  2994
---- Validation: 
scalar performance:
{'acc': 0.96127415, 'precision': 0.5793432, 'recall': 0.5270763, 'specificity': 0.5270763, 'f1': 0.5374295, 'auroc': 0.6619748, 'binary_precision': 0.18905473, 'binary_recall': 0.06312292, 'binary_specificity': 0.9910297, 'binary_f1_score': 0.094645076}
confusion matrix:
       0    1
0  18008  163
1    564   38
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96537906, 'precision': 0.7771362, 'recall': 0.69251084, 'specificity': 0.69251084, 'f1': 0.7263463, 'auroc': 0.78511983, 'binary_precision': 0.57831323, 'binary_recall': 0.3966942, 'binary_specificity': 0.9883275, 'binary_f1_score': 0.47058824}
confusion matrix:
      0   1
0  5927  70
1   146  96
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512106_11.png
early stop counter: 10
val acc:0.9612741470336914, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9661805033683777
after epoch: 11,now: 2024-06-21 05:42:39.135113,epoch time: 0:35:16.335738,used: 4:28:43.778170,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_01_13_55_seed_2_21512106
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.959977, 'precision': 0.9263747, 'recall': 0.83171046, 'specificity': 0.83171046, 'f1': 0.8715961, 'auroc': 0.9519403, 'binary_precision': 0.8869843, 'binary_recall': 0.6726151, 'binary_specificity': 0.99080575, 'binary_f1_score': 0.76506704}
confusion matrix:
       0     1
0  41920   389
1   1486  3053
---- Validation: 
scalar performance:
{'acc': 0.9610611, 'precision': 0.5863469, 'recall': 0.53178453, 'specificity': 0.53178453, 'f1': 0.5437723, 'auroc': 0.6811824, 'binary_precision': 0.20276497, 'binary_recall': 0.073089704, 'binary_specificity': 0.99047935, 'binary_f1_score': 0.10744811}
confusion matrix:
       0    1
0  17998  173
1    558   44
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96602017, 'precision': 0.7796131, 'recall': 0.7146545, 'specificity': 0.7146545, 'f1': 0.7423785, 'auroc': 0.8069345, 'binary_precision': 0.58152175, 'binary_recall': 0.44214877, 'binary_specificity': 0.98716027, 'binary_f1_score': 0.5023474}
confusion matrix:
      0    1
0  5920   77
1   135  107
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512106_12.png
early stop counter: 11
val acc:0.9610611200332642, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9661805033683777
after epoch: 12,now: 2024-06-21 06:22:22.713140,epoch time: 0:39:43.578027,used: 5:08:27.356197,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_01_13_55_seed_2_21512106
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9601904, 'precision': 0.9201349, 'recall': 0.83940065, 'specificity': 0.83940065, 'f1': 0.8743334, 'auroc': 0.95490944, 'binary_precision': 0.8728388, 'binary_recall': 0.6895792, 'binary_specificity': 0.98922217, 'binary_f1_score': 0.7704615}
confusion matrix:
       0     1
0  41853   456
1   1409  3130
---- Validation: 
scalar performance:
{'acc': 0.96020883, 'precision': 0.5907575, 'recall': 0.53857166, 'specificity': 0.53857166, 'f1': 0.55195457, 'auroc': 0.6837732, 'binary_precision': 0.21115538, 'binary_recall': 0.08803987, 'binary_specificity': 0.9891035, 'binary_f1_score': 0.124267295}
confusion matrix:
       0    1
0  17973  198
1    549   53
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9640968, 'precision': 0.7621096, 'recall': 0.70968854, 'specificity': 0.70968854, 'f1': 0.7326362, 'auroc': 0.8007902, 'binary_precision': 0.546875, 'binary_recall': 0.4338843, 'binary_specificity': 0.98549277, 'binary_f1_score': 0.48387098}
confusion matrix:
      0    1
0  5910   87
1   137  105
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512106_13.png
early stop counter: 12
val acc:0.9602088332176208, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9661805033683777
after epoch: 13,now: 2024-06-21 07:01:39.010706,epoch time: 0:39:16.297566,used: 5:47:43.653763,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_01_13_55_seed_2_21512106
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.962389, 'precision': 0.91994154, 'recall': 0.8541887, 'specificity': 0.8541887, 'f1': 0.88351345, 'auroc': 0.9593727, 'binary_precision': 0.8693802, 'binary_recall': 0.7199824, 'binary_specificity': 0.9883949, 'binary_f1_score': 0.78765965}
confusion matrix:
       0     1
0  41818   491
1   1271  3268
---- Validation: 
scalar performance:
{'acc': 0.9590369, 'precision': 0.58882356, 'recall': 0.54278463, 'specificity': 0.54278463, 'f1': 0.5560278, 'auroc': 0.69135845, 'binary_precision': 0.20701754, 'binary_recall': 0.09800664, 'binary_specificity': 0.9875626, 'binary_f1_score': 0.1330327}
confusion matrix:
       0    1
0  17945  226
1    543   59
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9644174, 'precision': 0.76407105, 'recall': 0.719769, 'specificity': 0.719769, 'f1': 0.73964643, 'auroc': 0.8064929, 'binary_precision': 0.55, 'binary_recall': 0.45454547, 'binary_specificity': 0.9849925, 'binary_f1_score': 0.49773756}
confusion matrix:
      0    1
0  5907   90
1   132  110
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512106_14.png
early stop counter: 13
val acc:0.9590368866920471, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9661805033683777
after epoch: 14,now: 2024-06-21 07:39:04.520024,epoch time: 0:37:25.509318,used: 6:25:09.163081,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_01_13_55_seed_2_21512106
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9631788, 'precision': 0.9260179, 'recall': 0.85275745, 'specificity': 0.85275745, 'f1': 0.8850204, 'auroc': 0.962677, 'binary_precision': 0.8819218, 'binary_recall': 0.7157964, 'binary_specificity': 0.9897185, 'binary_f1_score': 0.7902225}
confusion matrix:
       0     1
0  41874   435
1   1290  3249
---- Validation: 
scalar performance:
{'acc': 0.9617536, 'precision': 0.6166297, 'recall': 0.54820323, 'specificity': 0.54820323, 'f1': 0.5658681, 'auroc': 0.70820415, 'binary_precision': 0.26229507, 'binary_recall': 0.10631229, 'binary_specificity': 0.9900941, 'binary_f1_score': 0.15130024}
confusion matrix:
       0    1
0  17991  180
1    538   64
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9674627, 'precision': 0.79246294, 'recall': 0.72333586, 'specificity': 0.72333586, 'f1': 0.7527554, 'auroc': 0.81263345, 'binary_precision': 0.60655737, 'binary_recall': 0.45867768, 'binary_specificity': 0.987994, 'binary_f1_score': 0.522353}
confusion matrix:
      0    1
0  5925   72
1   131  111
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512106_15.png
new oracle model saved
early stop counter: 14
val acc:0.9617536067962646, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9674627184867859
after epoch: 15,now: 2024-06-21 08:21:46.238274,epoch time: 0:42:41.718250,used: 7:07:50.881331,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_01_13_55_seed_2_21512106
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.95927256, 'precision': 0.9045495, 'recall': 0.8512832, 'specificity': 0.8512832, 'f1': 0.8755111, 'auroc': 0.9583334, 'binary_precision': 0.83895904, 'binary_recall': 0.7173386, 'binary_specificity': 0.9852277, 'binary_f1_score': 0.7733967}
confusion matrix:
       0     1
0  41684   625
1   1283  3256
---- Validation: 
scalar performance:
{'acc': 0.96063495, 'precision': 0.6110476, 'recall': 0.5516406, 'specificity': 0.5516406, 'f1': 0.56860065, 'auroc': 0.6924941, 'binary_precision': 0.2509091, 'binary_recall': 0.114617944, 'binary_specificity': 0.98866326, 'binary_f1_score': 0.15735462}
confusion matrix:
       0    1
0  17965  206
1    533   69
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9661805, 'precision': 0.77907187, 'recall': 0.7266343, 'specificity': 0.7266343, 'f1': 0.7498195, 'auroc': 0.8068387, 'binary_precision': 0.5794872, 'binary_recall': 0.46694216, 'binary_specificity': 0.9863265, 'binary_f1_score': 0.51716244}
confusion matrix:
      0    1
0  5915   82
1   129  113
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512106_16.png
early stop counter: 15
val acc:0.9606349468231201, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9674627184867859
after epoch: 16,now: 2024-06-21 09:03:14.808705,epoch time: 0:41:28.570431,used: 7:49:19.451762,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_01_13_55_seed_2_21512106
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9638618, 'precision': 0.92328846, 'recall': 0.860216, 'specificity': 0.860216, 'f1': 0.8885236, 'auroc': 0.9621713, 'binary_precision': 0.8748683, 'binary_recall': 0.73165894, 'binary_specificity': 0.98877305, 'binary_f1_score': 0.7968806}
confusion matrix:
       0     1
0  41834   475
1   1218  3321
---- Validation: 
scalar performance:
{'acc': 0.9617536, 'precision': 0.6176214, 'recall': 0.5490062, 'specificity': 0.5490062, 'f1': 0.56686836, 'auroc': 0.6996515, 'binary_precision': 0.26422763, 'binary_recall': 0.10797342, 'binary_specificity': 0.99003905, 'binary_f1_score': 0.15330188}
confusion matrix:
       0    1
0  17990  181
1    537   65
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96826416, 'precision': 0.80038327, 'recall': 0.7257354, 'specificity': 0.7257354, 'f1': 0.7571912, 'auroc': 0.81132376, 'binary_precision': 0.62222224, 'binary_recall': 0.46280992, 'binary_specificity': 0.988661, 'binary_f1_score': 0.53080565}
confusion matrix:
      0    1
0  5929   68
1   130  112
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512106_17.png
new oracle model saved
early stop counter: 16
val acc:0.9617536067962646, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9682641625404358
after epoch: 17,now: 2024-06-21 09:43:31.498066,epoch time: 0:40:16.689361,used: 8:29:36.141123,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_01_13_55_seed_2_21512106
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9649505, 'precision': 0.91564965, 'recall': 0.8767496, 'specificity': 0.8767496, 'f1': 0.8949748, 'auroc': 0.9696547, 'binary_precision': 0.8559843, 'binary_recall': 0.76734966, 'binary_specificity': 0.9861495, 'binary_f1_score': 0.80924726}
confusion matrix:
       0     1
0  41723   586
1   1056  3483
---- Validation: 
scalar performance:
{'acc': 0.958451, 'precision': 0.6033761, 'recall': 0.5585429, 'specificity': 0.5585429, 'f1': 0.57356834, 'auroc': 0.7179223, 'binary_precision': 0.23511904, 'binary_recall': 0.13122924, 'binary_specificity': 0.9858566, 'binary_f1_score': 0.1684435}
confusion matrix:
       0    1
0  17914  257
1    523   79
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9644174, 'precision': 0.7623464, 'recall': 0.74356186, 'specificity': 0.74356186, 'f1': 0.7525618, 'auroc': 0.82247317, 'binary_precision': 0.54464287, 'binary_recall': 0.5041322, 'binary_specificity': 0.9829915, 'binary_f1_score': 0.52360517}
confusion matrix:
      0    1
0  5895  102
1   120  122
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512106_18.png
early stop counter: 17
val acc:0.958450973033905, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9682641625404358
after epoch: 18,now: 2024-06-21 10:10:57.706205,epoch time: 0:27:26.208139,used: 8:57:02.349262,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_01_13_55_seed_2_21512106
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9637978, 'precision': 0.91066587, 'recall': 0.8752007, 'specificity': 0.8752007, 'f1': 0.8919045, 'auroc': 0.9690988, 'binary_precision': 0.84624755, 'binary_recall': 0.7653151, 'binary_specificity': 0.98508626, 'binary_f1_score': 0.80374914}
confusion matrix:
       0     1
0  41679   631
1   1065  3473
---- Validation: 
scalar performance:
{'acc': 0.95925, 'precision': 0.6104946, 'recall': 0.5605618, 'specificity': 0.5605618, 'f1': 0.57693326, 'auroc': 0.7208442, 'binary_precision': 0.24923077, 'binary_recall': 0.1345515, 'binary_specificity': 0.986572, 'binary_f1_score': 0.17475729}
confusion matrix:
       0    1
0  17927  244
1    521   81
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645777, 'precision': 0.7637025, 'recall': 0.7416625, 'specificity': 0.7416625, 'f1': 0.75214225, 'auroc': 0.8237735, 'binary_precision': 0.54751134, 'binary_recall': 0.5, 'binary_specificity': 0.983325, 'binary_f1_score': 0.5226782}
confusion matrix:
      0    1
0  5897  100
1   121  121
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512106_19.png
