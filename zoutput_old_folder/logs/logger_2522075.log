Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0




!!!: not committed yet



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_15_seed_0_21520748

 Experiment start at: 2024-06-21 11:23:15.188284
before training, model accuracy: 0.31128156185150146
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9055223, 'precision': 0.45276114, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.47520947, 'auroc': 0.6477281, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42306  0
1   4414  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.35735464, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.32979134, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520748_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-21 11:39:59.663857,epoch time: 0:16:44.475573,used: 0:16:44.475573,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_15_seed_0_21520748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9055651, 'precision': 0.45278254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4752213, 'auroc': 0.8250254, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42308  0
1   4412  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.39354277, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.3700394, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520748_2.png
early stop counter: 1
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 2,now: 2024-06-21 11:54:34.649176,epoch time: 0:14:34.985319,used: 0:31:19.460892,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_15_seed_0_21520748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.90824056, 'precision': 0.95399725, 'recall': 0.51416594, 'specificity': 0.51416594, 'f1': 0.5034407, 'auroc': 0.8963002, 'binary_precision': 1.0, 'binary_recall': 0.028331822, 'binary_specificity': 1.0, 'binary_f1_score': 0.055102486}
confusion matrix:
       0    1
0  42308    0
1   4287  125
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.45145017, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.4239642, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520748_3.png
early stop counter: 2
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 3,now: 2024-06-21 12:09:43.589268,epoch time: 0:15:08.940092,used: 0:46:28.400984,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_15_seed_0_21520748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.92532104, 'precision': 0.9608474, 'recall': 0.6047145, 'specificity': 0.6047145, 'f1': 0.65333027, 'auroc': 0.929809, 'binary_precision': 0.99784017, 'binary_recall': 0.2094763, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.34626195}
confusion matrix:
       0    1
0  42307    2
1   3487  924
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.5006454, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.54784286, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520748_4.png
early stop counter: 3
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 4,now: 2024-06-21 12:24:03.772568,epoch time: 0:14:20.183300,used: 1:00:48.584284,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_15_seed_0_21520748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9434717, 'precision': 0.9614697, 'recall': 0.7043892, 'specificity': 0.7043892, 'f1': 0.77381, 'auroc': 0.9517315, 'binary_precision': 0.98100924, 'binary_recall': 0.4096058, 'binary_specificity': 0.9991727, 'binary_f1_score': 0.57791275}
confusion matrix:
       0     1
0  42271    35
1   2606  1808
---- Validation: 
scalar performance:
{'acc': 0.9657301, 'precision': 0.48289075, 'recall': 0.49997246, 'specificity': 0.49997246, 'f1': 0.4912832, 'auroc': 0.5889418, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9999449, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18148  1
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9576542, 'precision': 0.47913337, 'recall': 0.4996665, 'specificity': 0.4996665, 'f1': 0.48918456, 'auroc': 0.65978134, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.999333, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5993  4
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520748_5.png
early stop counter: 4
val acc:0.9657300710678101, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 5,now: 2024-06-21 12:37:59.552539,epoch time: 0:13:55.779971,used: 1:14:44.364255,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_15_seed_0_21520748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9540882, 'precision': 0.9699341, 'recall': 0.75991106, 'specificity': 0.75991106, 'f1': 0.8284817, 'auroc': 0.95624053, 'binary_precision': 0.98753226, 'binary_recall': 0.5205076, 'binary_specificity': 0.99931455, 'binary_f1_score': 0.68170345}
confusion matrix:
       0     1
0  42278    29
1   2116  2297
---- Validation: 
scalar performance:
{'acc': 0.9657301, 'precision': 0.7052122, 'recall': 0.50297266, 'specificity': 0.50297266, 'f1': 0.4974162, 'auroc': 0.5958369, 'binary_precision': 0.44444445, 'binary_recall': 0.00622084, 'binary_specificity': 0.9997245, 'binary_f1_score': 0.012269938}
confusion matrix:
       0  1
0  18144  5
1    639  4
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95717484, 'precision': 0.47912335, 'recall': 0.49941638, 'specificity': 0.49941638, 'f1': 0.48905948, 'auroc': 0.6576315, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5990  7
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520748_6.png
early stop counter: 5
val acc:0.9657300710678101, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 6,now: 2024-06-21 12:52:18.343873,epoch time: 0:14:18.791334,used: 1:29:03.155589,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_15_seed_0_21520748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.95858306, 'precision': 0.97455496, 'recall': 0.78283703, 'specificity': 0.78283703, 'f1': 0.849306, 'auroc': 0.965962, 'binary_precision': 0.99245733, 'binary_recall': 0.5661232, 'binary_specificity': 0.9995509, 'binary_f1_score': 0.7209805}
confusion matrix:
       0     1
0  42285    19
1   1916  2500
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.73301566, 'recall': 0.50375026, 'specificity': 0.50375026, 'f1': 0.49895155, 'auroc': 0.59431016, 'binary_precision': 0.5, 'binary_recall': 0.00777605, 'binary_specificity': 0.9997245, 'binary_f1_score': 0.015313936}
confusion matrix:
       0  1
0  18144  5
1    638  5
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9576542, 'precision': 0.6293534, 'recall': 0.5051635, 'specificity': 0.5051635, 'f1': 0.5002494, 'auroc': 0.6432961, 'binary_precision': 0.3, 'binary_recall': 0.011494253, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.022140222}
confusion matrix:
      0  1
0  5990  7
1   258  3
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520748_7.png
early stop counter: 6
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 7,now: 2024-06-21 13:08:39.469880,epoch time: 0:16:21.126007,used: 1:45:24.281596,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_15_seed_0_21520748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9667166, 'precision': 0.9704647, 'recall': 0.8316046, 'specificity': 0.8316046, 'f1': 0.88627505, 'auroc': 0.9721049, 'binary_precision': 0.9747676, 'binary_recall': 0.6650057, 'binary_specificity': 0.9982035, 'binary_f1_score': 0.7906288}
confusion matrix:
       0     1
0  42229    76
1   1479  2936
---- Validation: 
scalar performance:
{'acc': 0.9661026, 'precision': 0.7676091, 'recall': 0.51891667, 'specificity': 0.51891667, 'f1': 0.527758, 'auroc': 0.6451005, 'binary_precision': 0.5681818, 'binary_recall': 0.038880248, 'binary_specificity': 0.9989531, 'binary_f1_score': 0.07278021}
confusion matrix:
       0   1
0  18130  19
1    618  25
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.74186313, 'recall': 0.52023906, 'specificity': 0.52023906, 'f1': 0.528381, 'auroc': 0.7181776, 'binary_precision': 0.52380955, 'binary_recall': 0.042145595, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.07801419}
confusion matrix:
      0   1
0  5987  10
1   250  11
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520748_8.png
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-06-21 13:26:50.421463,epoch time: 0:18:10.951583,used: 2:03:35.233179,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_15_seed_0_21520748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9672303, 'precision': 0.97590816, 'recall': 0.83087397, 'specificity': 0.83087397, 'f1': 0.88742065, 'auroc': 0.9731959, 'binary_precision': 0.9858491, 'binary_recall': 0.66274065, 'binary_specificity': 0.9990072, 'binary_f1_score': 0.79263175}
confusion matrix:
       0     1
0  42263    42
1   1489  2926
---- Validation: 
scalar performance:
{'acc': 0.96620905, 'precision': 0.781139, 'recall': 0.5189718, 'specificity': 0.5189718, 'f1': 0.5278918, 'auroc': 0.6398647, 'binary_precision': 0.5952381, 'binary_recall': 0.038880248, 'binary_specificity': 0.9990633, 'binary_f1_score': 0.072992705}
confusion matrix:
       0   1
0  18132  17
1    618  25
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581336, 'precision': 0.71664655, 'recall': 0.5164076, 'specificity': 0.5164076, 'f1': 0.52143675, 'auroc': 0.6885805, 'binary_precision': 0.47368422, 'binary_recall': 0.03448276, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.06428572}
confusion matrix:
      0   1
0  5987  10
1   252   9
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520748_9.png
better model found
persisted
after epoch: 9,now: 2024-06-21 13:44:53.227064,epoch time: 0:18:02.805601,used: 2:21:38.038780,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_15_seed_0_21520748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9738442, 'precision': 0.9798713, 'recall': 0.8659395, 'specificity': 0.8659395, 'f1': 0.9134413, 'auroc': 0.97696054, 'binary_precision': 0.98688227, 'binary_recall': 0.7328953, 'binary_specificity': 0.9989836, 'binary_f1_score': 0.84113365}
confusion matrix:
       0     1
0  42263    43
1   1179  3235
---- Validation: 
scalar performance:
{'acc': 0.9662622, 'precision': 0.75370204, 'recall': 0.54750144, 'specificity': 0.54750144, 'f1': 0.5742862, 'auroc': 0.6771673, 'binary_precision': 0.53846157, 'binary_recall': 0.09797823, 'binary_specificity': 0.99702466, 'binary_f1_score': 0.16578947}
confusion matrix:
       0   1
0  18095  54
1    580  63
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590924, 'precision': 0.75878537, 'recall': 0.5462252, 'specificity': 0.5462252, 'f1': 0.57121617, 'auroc': 0.73765236, 'binary_precision': 0.5555556, 'binary_recall': 0.09578544, 'binary_specificity': 0.996665, 'binary_f1_score': 0.1633987}
confusion matrix:
      0   1
0  5977  20
1   236  25
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520748_10.png
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-06-21 14:02:47.374625,epoch time: 0:17:54.147561,used: 2:39:32.186341,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_15_seed_0_21520748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9723031, 'precision': 0.9801954, 'recall': 0.85687053, 'specificity': 0.85687053, 'f1': 0.9073534, 'auroc': 0.97748315, 'binary_precision': 0.989335, 'binary_recall': 0.71454465, 'binary_specificity': 0.99919635, 'binary_f1_score': 0.82978165}
confusion matrix:
       0     1
0  42272    34
1   1260  3154
---- Validation: 
scalar performance:
{'acc': 0.96647507, 'precision': 0.76424086, 'recall': 0.5461115, 'specificity': 0.5461115, 'f1': 0.57256466, 'auroc': 0.6774461, 'binary_precision': 0.559633, 'binary_recall': 0.09486781, 'binary_specificity': 0.9973552, 'binary_f1_score': 0.16223404}
confusion matrix:
       0   1
0  18101  48
1    582  61
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.77654564, 'recall': 0.54830766, 'specificity': 0.54830766, 'f1': 0.5748864, 'auroc': 0.72410023, 'binary_precision': 0.59090906, 'binary_recall': 0.099616855, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.17049181}
confusion matrix:
      0   1
0  5979  18
1   235  26
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520748_11.png
new oracle model saved
better model found
persisted
after epoch: 11,now: 2024-06-21 14:21:21.308204,epoch time: 0:18:33.933579,used: 2:58:06.119920,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_15_seed_0_21520748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.975, 'precision': 0.9795085, 'recall': 0.8728967, 'specificity': 0.8728967, 'f1': 0.9179647, 'auroc': 0.98096824, 'binary_precision': 0.98477155, 'binary_recall': 0.74699885, 'binary_specificity': 0.9987945, 'binary_f1_score': 0.8495621}
confusion matrix:
       0     1
0  42254    51
1   1117  3298
---- Validation: 
scalar performance:
{'acc': 0.96674114, 'precision': 0.76838756, 'recall': 0.5575001, 'specificity': 0.5575001, 'f1': 0.58932185, 'auroc': 0.6951685, 'binary_precision': 0.5671642, 'binary_recall': 0.11819596, 'binary_specificity': 0.99680424, 'binary_f1_score': 0.1956242}
confusion matrix:
       0   1
0  18091  58
1    567  76
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9592522, 'precision': 0.7612339, 'recall': 0.5518056, 'specificity': 0.5518056, 'f1': 0.5795856, 'auroc': 0.73437417, 'binary_precision': 0.56, 'binary_recall': 0.107279696, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.1800643}
confusion matrix:
      0   1
0  5975  22
1   233  28
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520748_12.png
better model found
persisted
after epoch: 12,now: 2024-06-21 14:39:36.478537,epoch time: 0:18:15.170333,used: 3:16:21.290253,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_15_seed_0_21520748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9766267, 'precision': 0.9797474, 'recall': 0.8820592, 'specificity': 0.8820592, 'f1': 0.924049, 'auroc': 0.98097885, 'binary_precision': 0.9834061, 'binary_recall': 0.7654657, 'binary_specificity': 0.9986527, 'binary_f1_score': 0.8608563}
confusion matrix:
       0     1
0  42250    57
1   1035  3378
---- Validation: 
scalar performance:
{'acc': 0.96647507, 'precision': 0.7602409, 'recall': 0.552862, 'specificity': 0.552862, 'f1': 0.5823526, 'auroc': 0.697679, 'binary_precision': 0.5511811, 'binary_recall': 0.108864695, 'binary_specificity': 0.9968593, 'binary_f1_score': 0.18181819}
confusion matrix:
       0   1
0  18092  57
1    573  70
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9603707, 'precision': 0.8035517, 'recall': 0.5542216, 'specificity': 0.5542216, 'f1': 0.5846156, 'auroc': 0.73680377, 'binary_precision': 0.64444447, 'binary_recall': 0.11111111, 'binary_specificity': 0.997332, 'binary_f1_score': 0.1895425}
confusion matrix:
      0   1
0  5981  16
1   232  29
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520748_13.png
new oracle model saved
early stop counter: 1
val acc:0.9664750695228577, best validation acc: 0.966741144657135, corresponding to test acc:                         0.9592521786689758 / 0.9603707194328308
after epoch: 13,now: 2024-06-21 14:58:30.038354,epoch time: 0:18:53.559817,used: 3:35:14.850070,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_15_seed_0_21520748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9807577, 'precision': 0.9817648, 'recall': 0.90443385, 'specificity': 0.90443385, 'f1': 0.9389043, 'auroc': 0.983868, 'binary_precision': 0.98295766, 'binary_recall': 0.81033313, 'binary_specificity': 0.9985345, 'binary_f1_score': 0.88833684}
confusion matrix:
       0     1
0  42245    62
1    837  3576
---- Validation: 
scalar performance:
{'acc': 0.96620905, 'precision': 0.7453591, 'recall': 0.5797262, 'specificity': 0.5797262, 'f1': 0.616505, 'auroc': 0.7426663, 'binary_precision': 0.51960784, 'binary_recall': 0.16485226, 'binary_specificity': 0.99460024, 'binary_f1_score': 0.25029516}
confusion matrix:
       0    1
0  18051   98
1    537  106
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9600511, 'precision': 0.7637972, 'recall': 0.5925338, 'specificity': 0.5925338, 'f1': 0.6325826, 'auroc': 0.77573013, 'binary_precision': 0.56179774, 'binary_recall': 0.19157088, 'binary_specificity': 0.9934968, 'binary_f1_score': 0.28571427}
confusion matrix:
      0   1
0  5958  39
1   211  50
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520748_14.png
early stop counter: 2
val acc:0.9662090539932251, best validation acc: 0.966741144657135, corresponding to test acc:                         0.9592521786689758 / 0.9603707194328308
after epoch: 14,now: 2024-06-21 15:14:09.766307,epoch time: 0:15:39.727953,used: 3:50:54.578023,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_15_seed_0_21520748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.97889555, 'precision': 0.9814453, 'recall': 0.8938662, 'specificity': 0.8938662, 'f1': 0.93222064, 'auroc': 0.9851806, 'binary_precision': 0.9844501, 'binary_recall': 0.7890324, 'binary_specificity': 0.99869996, 'binary_f1_score': 0.87597483}
confusion matrix:
       0     1
0  42252    55
1    931  3482
---- Validation: 
scalar performance:
{'acc': 0.96674114, 'precision': 0.7670238, 'recall': 0.55975026, 'specificity': 0.55975026, 'f1': 0.5924024, 'auroc': 0.729087, 'binary_precision': 0.5642857, 'binary_recall': 0.12286159, 'binary_specificity': 0.99663895, 'binary_f1_score': 0.20178801}
confusion matrix:
       0   1
0  18088  61
1    564  79
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614893, 'precision': 0.8104466, 'recall': 0.57862556, 'specificity': 0.57862556, 'f1': 0.61934644, 'auroc': 0.77785444, 'binary_precision': 0.65625, 'binary_recall': 0.16091955, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.25846156}
confusion matrix:
      0   1
0  5975  22
1   219  42
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520748_15.png
new oracle model saved
early stop counter: 3
val acc:0.966741144657135, best validation acc: 0.966741144657135, corresponding to test acc:                         0.9592521786689758 / 0.9614893198013306
after epoch: 15,now: 2024-06-21 15:28:21.460821,epoch time: 0:14:11.694514,used: 4:05:06.272537,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_15_seed_0_21520748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9801156, 'precision': 0.9805, 'recall': 0.90176725, 'specificity': 0.90176725, 'f1': 0.9367659, 'auroc': 0.98650146, 'binary_precision': 0.980955, 'binary_recall': 0.8051654, 'binary_specificity': 0.99836904, 'binary_f1_score': 0.8844096}
confusion matrix:
       0     1
0  42237    69
1    860  3554
---- Validation: 
scalar performance:
{'acc': 0.9661026, 'precision': 0.7427905, 'recall': 0.5804212, 'specificity': 0.5804212, 'f1': 0.61706376, 'auroc': 0.7605572, 'binary_precision': 0.5144231, 'binary_recall': 0.16640747, 'binary_specificity': 0.99443495, 'binary_f1_score': 0.25146887}
confusion matrix:
       0    1
0  18048  101
1    536  107
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.7865646, 'recall': 0.5949498, 'specificity': 0.5949498, 'f1': 0.6378434, 'auroc': 0.7899965, 'binary_precision': 0.60714287, 'binary_recall': 0.1954023, 'binary_specificity': 0.99449724, 'binary_f1_score': 0.29565215}
confusion matrix:
      0   1
0  5964  33
1   210  51
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520748_16.png
early stop counter: 4
val acc:0.9661026000976562, best validation acc: 0.966741144657135, corresponding to test acc:                         0.9592521786689758 / 0.9614893198013306
after epoch: 16,now: 2024-06-21 15:42:54.416713,epoch time: 0:14:32.955892,used: 4:19:39.228429,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_15_seed_0_21520748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9802012, 'precision': 0.9792342, 'recall': 0.9033797, 'specificity': 0.9033797, 'f1': 0.93725026, 'auroc': 0.98614585, 'binary_precision': 0.9780882, 'binary_recall': 0.8086504, 'binary_specificity': 0.9981089, 'binary_f1_score': 0.8853353}
confusion matrix:
       0     1
0  42224    80
1    845  3571
---- Validation: 
scalar performance:
{'acc': 0.96631545, 'precision': 0.7480314, 'recall': 0.5790313, 'specificity': 0.5790313, 'f1': 0.6159408, 'auroc': 0.7555022, 'binary_precision': 0.525, 'binary_recall': 0.16329704, 'binary_specificity': 0.9947656, 'binary_f1_score': 0.2491103}
confusion matrix:
       0    1
0  18054   95
1    538  105
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.7853943, 'recall': 0.5967821, 'specificity': 0.5967821, 'f1': 0.63987154, 'auroc': 0.78225255, 'binary_precision': 0.60465115, 'binary_recall': 0.19923371, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.29971182}
confusion matrix:
      0   1
0  5963  34
1   209  52
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520748_17.png
early stop counter: 5
val acc:0.9663154482841492, best validation acc: 0.966741144657135, corresponding to test acc:                         0.9592521786689758 / 0.9614893198013306
after epoch: 17,now: 2024-06-21 16:00:19.087038,epoch time: 0:17:24.670325,used: 4:37:03.898754,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_15_seed_0_21520748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9832406, 'precision': 0.977865, 'recall': 0.92244804, 'specificity': 0.92244804, 'f1': 0.9480238, 'auroc': 0.9872612, 'binary_precision': 0.9714286, 'binary_recall': 0.84749603, 'binary_specificity': 0.9974, 'binary_f1_score': 0.90524024}
confusion matrix:
       0     1
0  42197   110
1    673  3740
---- Validation: 
scalar performance:
{'acc': 0.9665283, 'precision': 0.74973226, 'recall': 0.6038933, 'specificity': 0.6038933, 'f1': 0.64391184, 'auroc': 0.7605575, 'binary_precision': 0.52671754, 'binary_recall': 0.21461898, 'binary_specificity': 0.99316764, 'binary_f1_score': 0.30497238}
confusion matrix:
       0    1
0  18025  124
1    505  138
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96244806, 'precision': 0.79772484, 'recall': 0.6194371, 'specificity': 0.6194371, 'f1': 0.66664016, 'auroc': 0.7888885, 'binary_precision': 0.627451, 'binary_recall': 0.24521072, 'binary_specificity': 0.9936635, 'binary_f1_score': 0.35261708}
confusion matrix:
      0   1
0  5959  38
1   197  64
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520748_18.png
new oracle model saved
early stop counter: 6
val acc:0.9665282964706421, best validation acc: 0.966741144657135, corresponding to test acc:                         0.9592521786689758 / 0.9624480605125427
after epoch: 18,now: 2024-06-21 16:15:49.172840,epoch time: 0:15:30.085802,used: 4:52:33.984556,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_15_seed_0_21520748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9815711, 'precision': 0.9839865, 'recall': 0.9073602, 'specificity': 0.9073602, 'f1': 0.94157875, 'auroc': 0.98773164, 'binary_precision': 0.9868493, 'binary_recall': 0.815855, 'binary_specificity': 0.99886537, 'binary_f1_score': 0.89324236}
confusion matrix:
       0     1
0  42257    48
1    813  3602
---- Validation: 
scalar performance:
{'acc': 0.9669008, 'precision': 0.7622911, 'recall': 0.5823346, 'specificity': 0.5823346, 'f1': 0.62129796, 'auroc': 0.7575332, 'binary_precision': 0.5532995, 'binary_recall': 0.16951789, 'binary_specificity': 0.9951512, 'binary_f1_score': 0.2595238}
confusion matrix:
       0    1
0  18061   88
1    534  109
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96276766, 'precision': 0.8252014, 'recall': 0.59761584, 'specificity': 0.59761584, 'f1': 0.64473706, 'auroc': 0.7875271, 'binary_precision': 0.68421054, 'binary_recall': 0.19923371, 'binary_specificity': 0.995998, 'binary_f1_score': 0.30860534}
confusion matrix:
      0   1
0  5973  24
1   209  52
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520748_19.png
new oracle model saved
better model found
persisted
after epoch: 19,now: 2024-06-21 16:29:34.616152,epoch time: 0:13:45.443312,used: 5:06:19.427868,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_15_seed_0_21520748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9825342, 'precision': 0.981251, 'recall': 0.91523963, 'specificity': 0.91523963, 'f1': 0.9452158, 'auroc': 0.9887136, 'binary_precision': 0.9797225, 'binary_recall': 0.8322756, 'binary_specificity': 0.99820364, 'binary_f1_score': 0.90000004}
confusion matrix:
       0     1
0  42232    76
1    740  3672
---- Validation: 
scalar performance:
{'acc': 0.96674114, 'precision': 0.7560328, 'recall': 0.59125257, 'specificity': 0.59125257, 'f1': 0.6310507, 'auroc': 0.7629864, 'binary_precision': 0.5401786, 'binary_recall': 0.1881804, 'binary_specificity': 0.99432474, 'binary_f1_score': 0.27912343}
confusion matrix:
       0    1
0  18046  103
1    522  121
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96292746, 'precision': 0.8168855, 'recall': 0.60869324, 'specificity': 0.60869324, 'f1': 0.65713346, 'auroc': 0.79377115, 'binary_precision': 0.6666667, 'binary_recall': 0.22222222, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.33333334}
confusion matrix:
      0   1
0  5968  29
1   203  58
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520748_20.png
new oracle model saved
early stop counter: 1
val acc:0.966741144657135, best validation acc: 0.9669008255004883, corresponding to test acc:                         0.9627676606178284 / 0.9629274606704712
after epoch: 20,now: 2024-06-21 16:43:13.300605,epoch time: 0:13:38.684453,used: 5:19:58.112321,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_15_seed_0_21520748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9838827, 'precision': 0.9783236, 'recall': 0.9258635, 'specificity': 0.9258635, 'f1': 0.95018935, 'auroc': 0.9881902, 'binary_precision': 0.9716568, 'binary_recall': 0.85432714, 'binary_specificity': 0.99739987, 'binary_f1_score': 0.90922236}
confusion matrix:
       0     1
0  42196   110
1    643  3771
---- Validation: 
scalar performance:
{'acc': 0.96631545, 'precision': 0.7452317, 'recall': 0.6142839, 'specificity': 0.6142839, 'f1': 0.6535834, 'auroc': 0.76164854, 'binary_precision': 0.5170068, 'binary_recall': 0.23639192, 'binary_specificity': 0.9921759, 'binary_f1_score': 0.3244397}
confusion matrix:
       0    1
0  18007  142
1    491  152
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96276766, 'precision': 0.8067693, 'recall': 0.6159392, 'specificity': 0.6159392, 'f1': 0.6640881, 'auroc': 0.7891644, 'binary_precision': 0.6458333, 'binary_recall': 0.23754789, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.3473389}
confusion matrix:
      0   1
0  5963  34
1   199  62
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520748_21.png
early stop counter: 2
val acc:0.9663154482841492, best validation acc: 0.9669008255004883, corresponding to test acc:                         0.9627676606178284 / 0.9629274606704712
after epoch: 21,now: 2024-06-21 16:56:24.582804,epoch time: 0:13:11.282199,used: 5:33:09.394520,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_15_seed_0_21520748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9834118, 'precision': 0.9780835, 'recall': 0.9231846, 'specificity': 0.9231846, 'f1': 0.94854355, 'auroc': 0.9897536, 'binary_precision': 0.971703, 'binary_recall': 0.8489453, 'binary_specificity': 0.9974238, 'binary_f1_score': 0.9061856}
confusion matrix:
       0     1
0  42202   109
1    666  3743
---- Validation: 
scalar performance:
{'acc': 0.96695405, 'precision': 0.7567076, 'recall': 0.6116143, 'specificity': 0.6116143, 'f1': 0.65292776, 'auroc': 0.770676, 'binary_precision': 0.540146, 'binary_recall': 0.23017107, 'binary_specificity': 0.9930575, 'binary_f1_score': 0.3227917}
confusion matrix:
       0    1
0  18023  126
1    495  148
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9637264, 'precision': 0.8176576, 'recall': 0.6274335, 'specificity': 0.6274335, 'f1': 0.6779885, 'auroc': 0.8007387, 'binary_precision': 0.6666667, 'binary_recall': 0.2605364, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.37465566}
confusion matrix:
      0   1
0  5963  34
1   193  68
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520748_22.png
new oracle model saved
better model found
persisted
after epoch: 22,now: 2024-06-21 17:09:44.715694,epoch time: 0:13:20.132890,used: 5:46:29.527410,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_15_seed_0_21520748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.98407537, 'precision': 0.97758436, 'recall': 0.9276947, 'specificity': 0.9276947, 'f1': 0.9509181, 'auroc': 0.98896444, 'binary_precision': 0.96979004, 'binary_recall': 0.8581785, 'binary_specificity': 0.9972108, 'binary_f1_score': 0.9105769}
confusion matrix:
       0     1
0  42188   118
1    626  3788
---- Validation: 
scalar performance:
{'acc': 0.9663687, 'precision': 0.74586594, 'recall': 0.61956185, 'specificity': 0.61956185, 'f1': 0.65874255, 'auroc': 0.7871503, 'binary_precision': 0.5179153, 'binary_recall': 0.24727838, 'binary_specificity': 0.9918453, 'binary_f1_score': 0.33473682}
confusion matrix:
       0    1
0  18001  148
1    484  159
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964046, 'precision': 0.81381065, 'recall': 0.6404265, 'specificity': 0.6404265, 'f1': 0.6907339, 'auroc': 0.80846167, 'binary_precision': 0.65789473, 'binary_recall': 0.28735632, 'binary_specificity': 0.9934968, 'binary_f1_score': 0.4}
confusion matrix:
      0   1
0  5958  39
1   186  75
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520748_23.png
new oracle model saved
early stop counter: 1
val acc:0.9663686752319336, best validation acc: 0.9669540524482727, corresponding to test acc:                         0.9637264013290405 / 0.9640460014343262
after epoch: 23,now: 2024-06-21 17:24:10.832136,epoch time: 0:14:26.116442,used: 6:00:55.643852,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_15_seed_0_21520748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.98354024, 'precision': 0.9793127, 'recall': 0.9229694, 'specificity': 0.9229694, 'f1': 0.94894195, 'auroc': 0.9893656, 'binary_precision': 0.9742523, 'binary_recall': 0.848279, 'binary_specificity': 0.9976598, 'binary_f1_score': 0.906912}
confusion matrix:
       0     1
0  42205    99
1    670  3746
---- Validation: 
scalar performance:
{'acc': 0.9665283, 'precision': 0.74847424, 'recall': 0.6188944, 'specificity': 0.6188944, 'f1': 0.658612, 'auroc': 0.77610016, 'binary_precision': 0.5231788, 'binary_recall': 0.24572317, 'binary_specificity': 0.99206567, 'binary_f1_score': 0.33439153}
confusion matrix:
       0    1
0  18005  144
1    485  158
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96340686, 'precision': 0.809867, 'recall': 0.629099, 'specificity': 0.629099, 'f1': 0.67858624, 'auroc': 0.79805994, 'binary_precision': 0.6509434, 'binary_recall': 0.26436782, 'binary_specificity': 0.99383026, 'binary_f1_score': 0.3760218}
confusion matrix:
      0   1
0  5960  37
1   192  69
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520748_24.png
early stop counter: 2
val acc:0.9665282964706421, best validation acc: 0.9669540524482727, corresponding to test acc:                         0.9637264013290405 / 0.9640460014343262
after epoch: 24,now: 2024-06-21 17:38:13.537037,epoch time: 0:14:02.704901,used: 6:14:58.348753,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_15_seed_0_21520748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9833048, 'precision': 0.9811886, 'recall': 0.9198628, 'specificity': 0.9198628, 'f1': 0.9479211, 'auroc': 0.9893817, 'binary_precision': 0.9786618, 'binary_recall': 0.84164023, 'binary_specificity': 0.9980854, 'binary_f1_score': 0.9049939}
confusion matrix:
       0     1
0  42225    81
1    699  3715
---- Validation: 
scalar performance:
{'acc': 0.96722007, 'precision': 0.76311386, 'recall': 0.6057516, 'specificity': 0.6057516, 'f1': 0.6478549, 'auroc': 0.7765794, 'binary_precision': 0.5533597, 'binary_recall': 0.21772939, 'binary_specificity': 0.99377376, 'binary_f1_score': 0.3125}
confusion matrix:
       0    1
0  18036  113
1    503  140
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650048, 'precision': 0.84839904, 'recall': 0.62626815, 'specificity': 0.62626815, 'f1': 0.680799, 'auroc': 0.8034967, 'binary_precision': 0.7282609, 'binary_recall': 0.256705, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.3796034}
confusion matrix:
      0   1
0  5972  25
1   194  67
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520748_25.png
new oracle model saved
better model found
persisted
after epoch: 25,now: 2024-06-21 17:53:24.950904,epoch time: 0:15:11.413867,used: 6:30:09.762620,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_15_seed_0_21520748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.98420376, 'precision': 0.9778943, 'recall': 0.9281714, 'specificity': 0.9281714, 'f1': 0.9513246, 'auroc': 0.99135256, 'binary_precision': 0.9703173, 'binary_recall': 0.8590847, 'binary_specificity': 0.99725807, 'binary_f1_score': 0.91131943}
confusion matrix:
       0     1
0  42190   116
1    622  3792
---- Validation: 
scalar performance:
{'acc': 0.9665283, 'precision': 0.7491677, 'recall': 0.60989374, 'specificity': 0.60989374, 'f1': 0.6499452, 'auroc': 0.7787919, 'binary_precision': 0.52517986, 'binary_recall': 0.22706065, 'binary_specificity': 0.99272686, 'binary_f1_score': 0.31704667}
confusion matrix:
       0    1
0  18017  132
1    497  146
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.8063533, 'recall': 0.6252676, 'specificity': 0.6252676, 'f1': 0.6740563, 'auroc': 0.8001173, 'binary_precision': 0.6442308, 'binary_recall': 0.256705, 'binary_specificity': 0.99383026, 'binary_f1_score': 0.3671233}
confusion matrix:
      0   1
0  5960  37
1   194  67
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520748_26.png
early stop counter: 1
val acc:0.9665282964706421, best validation acc: 0.9672200679779053, corresponding to test acc:                         0.9650048017501831 / 0.9650048017501831
after epoch: 26,now: 2024-06-21 18:07:27.308339,epoch time: 0:14:02.357435,used: 6:44:12.120055,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_15_seed_0_21520748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9858305, 'precision': 0.9796933, 'recall': 0.93615746, 'specificity': 0.93615746, 'f1': 0.95662844, 'auroc': 0.9923099, 'binary_precision': 0.97229916, 'binary_recall': 0.874915, 'binary_specificity': 0.9974, 'binary_f1_score': 0.92104}
confusion matrix:
       0     1
0  42197   110
1    552  3861
---- Validation: 
scalar performance:
{'acc': 0.9665283, 'precision': 0.74923337, 'recall': 0.60914373, 'specificity': 0.60914373, 'f1': 0.6492026, 'auroc': 0.78029263, 'binary_precision': 0.5253623, 'binary_recall': 0.22550544, 'binary_specificity': 0.992782, 'binary_f1_score': 0.3155604}
confusion matrix:
       0    1
0  18018  131
1    498  145
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645254, 'precision': 0.8328979, 'recall': 0.62968266, 'specificity': 0.62968266, 'f1': 0.6825354, 'auroc': 0.8029141, 'binary_precision': 0.6969697, 'binary_recall': 0.26436782, 'binary_specificity': 0.9949975, 'binary_f1_score': 0.38333336}
confusion matrix:
      0   1
0  5967  30
1   192  69
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520748_27.png
early stop counter: 2
val acc:0.9665282964706421, best validation acc: 0.9672200679779053, corresponding to test acc:                         0.9650048017501831 / 0.9650048017501831
after epoch: 27,now: 2024-06-21 18:21:42.110894,epoch time: 0:14:14.802555,used: 6:58:26.922610,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_15_seed_0_21520748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.986173, 'precision': 0.9788796, 'recall': 0.9390255, 'specificity': 0.9390255, 'f1': 0.9578669, 'auroc': 0.9925678, 'binary_precision': 0.97007483, 'binary_recall': 0.8808877, 'binary_specificity': 0.9971634, 'binary_f1_score': 0.9233326}
confusion matrix:
       0     1
0  42184   120
1    526  3890
---- Validation: 
scalar performance:
{'acc': 0.9669008, 'precision': 0.754319, 'recall': 0.6220875, 'specificity': 0.6220875, 'f1': 0.66275895, 'auroc': 0.7898772, 'binary_precision': 0.5346535, 'binary_recall': 0.251944, 'binary_specificity': 0.99223095, 'binary_f1_score': 0.34249473}
confusion matrix:
       0    1
0  18008  141
1    481  162
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9653244, 'precision': 0.84682286, 'recall': 0.6337642, 'specificity': 0.6337642, 'f1': 0.6888467, 'auroc': 0.8126637, 'binary_precision': 0.7244898, 'binary_recall': 0.27203065, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.39554316}
confusion matrix:
      0   1
0  5970  27
1   190  71
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520748_28.png
new oracle model saved
early stop counter: 3
val acc:0.9669008255004883, best validation acc: 0.9672200679779053, corresponding to test acc:                         0.9650048017501831 / 0.9653244018554688
after epoch: 28,now: 2024-06-21 18:35:17.216264,epoch time: 0:13:35.105370,used: 7:12:02.027980,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_15_seed_0_21520748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9849957, 'precision': 0.98074734, 'recall': 0.93020093, 'specificity': 0.93020093, 'f1': 0.95371974, 'auroc': 0.9917892, 'binary_precision': 0.9756473, 'binary_recall': 0.86264735, 'binary_specificity': 0.9977546, 'binary_f1_score': 0.91567427}
confusion matrix:
       0     1
0  42213    95
1    606  3806
---- Validation: 
scalar performance:
{'acc': 0.9669008, 'precision': 0.7552874, 'recall': 0.61458695, 'specificity': 0.61458695, 'f1': 0.6556631, 'auroc': 0.78401613, 'binary_precision': 0.53710246, 'binary_recall': 0.23639192, 'binary_specificity': 0.992782, 'binary_f1_score': 0.32829377}
confusion matrix:
       0    1
0  18018  131
1    491  152
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96260786, 'precision': 0.80627894, 'recall': 0.61219114, 'specificity': 0.61219114, 'f1': 0.65987146, 'auroc': 0.8031323, 'binary_precision': 0.6451613, 'binary_recall': 0.22988506, 'binary_specificity': 0.99449724, 'binary_f1_score': 0.33898306}
confusion matrix:
      0   1
0  5964  33
1   201  60
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520748_29.png
early stop counter: 4
val acc:0.9669008255004883, best validation acc: 0.9672200679779053, corresponding to test acc:                         0.9650048017501831 / 0.9653244018554688
after epoch: 29,now: 2024-06-21 18:50:13.430362,epoch time: 0:14:56.214098,used: 7:26:58.242078,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_15_seed_0_21520748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9864512, 'precision': 0.9791803, 'recall': 0.9403829, 'specificity': 0.9403829, 'f1': 0.9587544, 'auroc': 0.99143124, 'binary_precision': 0.970398, 'binary_recall': 0.8835787, 'binary_specificity': 0.9971871, 'binary_f1_score': 0.92495555}
confusion matrix:
       0     1
0  42186   119
1    514  3901
---- Validation: 
scalar performance:
{'acc': 0.9662622, 'precision': 0.7439717, 'recall': 0.6285074, 'specificity': 0.6285074, 'f1': 0.6665456, 'auroc': 0.78122115, 'binary_precision': 0.5135135, 'binary_recall': 0.2659409, 'binary_specificity': 0.9910739, 'binary_f1_score': 0.3504098}
confusion matrix:
       0    1
0  17987  162
1    472  171
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96324706, 'precision': 0.80208933, 'recall': 0.636345, 'specificity': 0.636345, 'f1': 0.6846761, 'auroc': 0.7941154, 'binary_precision': 0.6347826, 'binary_recall': 0.27969348, 'binary_specificity': 0.9929965, 'binary_f1_score': 0.3882979}
confusion matrix:
      0   1
0  5955  42
1   188  73
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520748_30.png
early stop counter: 5
val acc:0.9662622213363647, best validation acc: 0.9672200679779053, corresponding to test acc:                         0.9650048017501831 / 0.9653244018554688
after epoch: 30,now: 2024-06-21 19:05:28.026086,epoch time: 0:15:14.595724,used: 7:42:12.837802,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_15_seed_0_21520748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 7:42:12.837802 at 2024-06-21 19:05:28.026086
persisted model performance metric: 

scalar performance:
{'acc': 0.9650048, 'precision': 0.84839904, 'recall': 0.62626815, 'specificity': 0.62626815, 'f1': 0.680799, 'auroc': 0.8034967, 'binary_precision': 0.7282609, 'binary_recall': 0.256705, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.3796034}
confusion matrix:
      0   1
0  5972  25
1   194  67
oracle model performance metric: 

scalar performance:
{'acc': 0.9653244, 'precision': 0.84682286, 'recall': 0.6337642, 'specificity': 0.6337642, 'f1': 0.6888467, 'auroc': 0.8126637, 'binary_precision': 0.7244898, 'binary_recall': 0.27203065, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.39554316}
confusion matrix:
      0   1
0  5970  27
1   190  71
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_differentbatchsizes_lre5_classbalancing3/rule_results/2.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_differentbatchsizes_lre5_classbalancing3/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_resnet_differentbatchsizes_lre5_classbalancing3/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204097 KiB |   1056 MiB | 416178 GiB | 416178 GiB |
|       from large pool | 167936 KiB |    986 MiB | 416003 GiB | 416003 GiB |
|       from small pool |  36161 KiB |     71 MiB |    175 GiB |    175 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 204097 KiB |   1056 MiB | 416178 GiB | 416178 GiB |
|       from large pool | 167936 KiB |    986 MiB | 416003 GiB | 416003 GiB |
|       from small pool |  36161 KiB |     71 MiB |    175 GiB |    175 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201088 KiB |   1049 MiB | 416089 GiB | 416089 GiB |
|       from large pool | 165120 KiB |    980 MiB | 415917 GiB | 415917 GiB |
|       from small pool |  35968 KiB |     71 MiB |    171 GiB |    171 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1250 MiB |   1250 MiB |   1250 MiB |      0 B   |
|       from large pool |   1178 MiB |   1178 MiB |   1178 MiB |      0 B   |
|       from small pool |     72 MiB |     72 MiB |     72 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 203454 KiB | 457399 KiB | 300905 GiB | 300904 GiB |
|       from large pool | 196608 KiB | 456608 KiB | 300719 GiB | 300719 GiB |
|       from small pool |   6846 KiB |  12716 KiB |    185 GiB |    185 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1488    |    2209    |   22349 K  |   22348 K  |
|       from large pool |      36    |      76    |    7350 K  |    7350 K  |
|       from small pool |    1452    |    2172    |   14999 K  |   14998 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1488    |    2209    |   22349 K  |   22348 K  |
|       from large pool |      36    |      76    |    7350 K  |    7350 K  |
|       from small pool |    1452    |    2172    |   14999 K  |   14998 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      50    |      50    |      50    |       0    |
|       from large pool |      14    |      14    |      14    |       0    |
|       from small pool |      36    |      36    |      36    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      32    |     742    |    9291 K  |    9291 K  |
|       from large pool |       5    |      10    |    2940 K  |    2940 K  |
|       from small pool |      27    |     737    |    6350 K  |    6350 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1056 MiB | 416178 GiB | 416178 GiB |
|       from large pool |  16640 KiB |    986 MiB | 416003 GiB | 416003 GiB |
|       from small pool |      0 KiB |     71 MiB |    175 GiB |    175 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1056 MiB | 416178 GiB | 416178 GiB |
|       from large pool |  16640 KiB |    986 MiB | 416003 GiB | 416003 GiB |
|       from small pool |      0 KiB |     71 MiB |    175 GiB |    175 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1049 MiB | 416089 GiB | 416089 GiB |
|       from large pool |  16640 KiB |    980 MiB | 415917 GiB | 415917 GiB |
|       from small pool |      0 KiB |     71 MiB |    171 GiB |    171 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 407552 KiB |   1250 MiB |   1250 MiB |    852 MiB |
|       from large pool | 364544 KiB |   1178 MiB |   1178 MiB |    822 MiB |
|       from small pool |  43008 KiB |     72 MiB |     72 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 184064 KiB | 457399 KiB | 300905 GiB | 300904 GiB |
|       from large pool | 184064 KiB | 456608 KiB | 300719 GiB | 300719 GiB |
|       from small pool |      0 KiB |  14441 KiB |    185 GiB |    185 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2209    |   22349 K  |   22349 K  |
|       from large pool |       2    |      76    |    7350 K  |    7350 K  |
|       from small pool |       0    |    2172    |   14999 K  |   14999 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2209    |   22349 K  |   22349 K  |
|       from large pool |       2    |      76    |    7350 K  |    7350 K  |
|       from small pool |       0    |    2172    |   14999 K  |   14999 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      30    |      50    |      50    |      20    |
|       from large pool |       9    |      14    |      14    |       5    |
|       from small pool |      21    |      36    |      36    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     742    |    9292 K  |    9292 K  |
|       from large pool |       1    |      11    |    2940 K  |    2940 K  |
|       from small pool |       0    |     737    |    6351 K  |    6351 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1056 MiB | 416178 GiB | 416178 GiB |
|       from large pool |  16640 KiB |    986 MiB | 416003 GiB | 416003 GiB |
|       from small pool |      0 KiB |     71 MiB |    175 GiB |    175 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1056 MiB | 416178 GiB | 416178 GiB |
|       from large pool |  16640 KiB |    986 MiB | 416003 GiB | 416003 GiB |
|       from small pool |      0 KiB |     71 MiB |    175 GiB |    175 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1049 MiB | 416089 GiB | 416089 GiB |
|       from large pool |  16640 KiB |    980 MiB | 415917 GiB | 415917 GiB |
|       from small pool |      0 KiB |     71 MiB |    171 GiB |    171 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 407552 KiB |   1250 MiB |   1250 MiB |    852 MiB |
|       from large pool | 364544 KiB |   1178 MiB |   1178 MiB |    822 MiB |
|       from small pool |  43008 KiB |     72 MiB |     72 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 184064 KiB | 457399 KiB | 300905 GiB | 300904 GiB |
|       from large pool | 184064 KiB | 456608 KiB | 300719 GiB | 300719 GiB |
|       from small pool |      0 KiB |  14441 KiB |    185 GiB |    185 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2209    |   22349 K  |   22349 K  |
|       from large pool |       2    |      76    |    7350 K  |    7350 K  |
|       from small pool |       0    |    2172    |   14999 K  |   14999 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2209    |   22349 K  |   22349 K  |
|       from large pool |       2    |      76    |    7350 K  |    7350 K  |
|       from small pool |       0    |    2172    |   14999 K  |   14999 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      30    |      50    |      50    |      20    |
|       from large pool |       9    |      14    |      14    |       5    |
|       from small pool |      21    |      36    |      36    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     742    |    9292 K  |    9292 K  |
|       from large pool |       1    |      11    |    2940 K  |    2940 K  |
|       from small pool |       0    |     737    |    6351 K  |    6351 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0




!!!: not committed yet



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_11_25_seed_1_21520748

 Experiment start at: 2024-06-21 19:11:26.058380
before training, model accuracy: 0.1456654816865921
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9072774, 'precision': 0.4537164, 'recall': 0.49990565, 'specificity': 0.49990565, 'f1': 0.47569242, 'auroc': 0.55667436, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998113, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42388  8
1   4324  0
---- Validation: 
scalar performance:
{'acc': 0.9639808, 'precision': 0.48204184, 'recall': 0.49994466, 'specificity': 0.49994466, 'f1': 0.49083003, 'auroc': 0.31115758, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998893, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18065  2
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.2164503, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520748_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-21 19:25:13.839056,epoch time: 0:13:47.780676,used: 0:13:47.780676,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_11_25_seed_1_21520748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9072132, 'precision': 0.453694, 'recall': 0.49989384, 'specificity': 0.49989384, 'f1': 0.47567475, 'auroc': 0.78203416, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9997877, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42385  9
1   4326  0
---- Validation: 
scalar performance:
{'acc': 0.9639808, 'precision': 0.48204184, 'recall': 0.49994466, 'specificity': 0.49994466, 'f1': 0.49083003, 'auroc': 0.37184045, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998893, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18065  2
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.28684056, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520748_2.png
early stop counter: 1
val acc:0.9639807939529419, best validation acc: 0.9639807939529419, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 2,now: 2024-06-21 19:38:54.059659,epoch time: 0:13:40.220603,used: 0:27:28.001279,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_11_25_seed_1_21520748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.90595037, 'precision': 0.6192989, 'recall': 0.5062356, 'specificity': 0.5062356, 'f1': 0.4903007, 'auroc': 0.87459195, 'binary_precision': 0.33009708, 'binary_recall': 0.015726179, 'binary_specificity': 0.996745, 'binary_f1_score': 0.030022074}
confusion matrix:
       0    1
0  42258  138
1   4256   68
---- Validation: 
scalar performance:
{'acc': 0.9628068, 'precision': 0.48202074, 'recall': 0.4993358, 'specificity': 0.4993358, 'f1': 0.4905255, 'auroc': 0.40256095, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9986716, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18043  24
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.32807767, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520748_3.png
early stop counter: 2
val acc:0.9628068208694458, best validation acc: 0.9639807939529419, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 3,now: 2024-06-21 19:52:10.921109,epoch time: 0:13:16.861450,used: 0:40:44.862729,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_11_25_seed_1_21520748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9187286, 'precision': 0.86579615, 'recall': 0.5774561, 'specificity': 0.5774561, 'f1': 0.61120665, 'auroc': 0.9148669, 'binary_precision': 0.8108747, 'binary_recall': 0.1586861, 'binary_specificity': 0.99622613, 'binary_f1_score': 0.26542854}
confusion matrix:
       0    1
0  42237  160
1   3637  686
---- Validation: 
scalar performance:
{'acc': 0.9629669, 'precision': 0.48202363, 'recall': 0.49941882, 'specificity': 0.49941882, 'f1': 0.49056706, 'auroc': 0.45942563, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99883765, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18046  21
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.43661544, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520748_4.png
early stop counter: 3
val acc:0.9629669189453125, best validation acc: 0.9639807939529419, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 4,now: 2024-06-21 20:05:18.457293,epoch time: 0:13:07.536184,used: 0:53:52.398913,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_11_25_seed_1_21520748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.93420374, 'precision': 0.91025925, 'recall': 0.6642182, 'specificity': 0.6642182, 'f1': 0.7242857, 'auroc': 0.936031, 'binary_precision': 0.8845209, 'binary_recall': 0.33287102, 'binary_specificity': 0.9955654, 'binary_f1_score': 0.4837084}
confusion matrix:
       0     1
0  42206   188
1   2886  1440
---- Validation: 
scalar performance:
{'acc': 0.96237993, 'precision': 0.48201305, 'recall': 0.4991144, 'specificity': 0.4991144, 'f1': 0.49041468, 'auroc': 0.5248836, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9982288, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18035  32
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.5321978, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520748_5.png
early stop counter: 4
val acc:0.9623799324035645, best validation acc: 0.9639807939529419, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 5,now: 2024-06-21 20:19:06.524113,epoch time: 0:13:48.066820,used: 1:07:40.465733,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_11_25_seed_1_21520748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.94449914, 'precision': 0.9245848, 'recall': 0.721737, 'specificity': 0.721737, 'f1': 0.78467536, 'auroc': 0.9458884, 'binary_precision': 0.9026549, 'binary_recall': 0.4484035, 'binary_specificity': 0.9950705, 'binary_f1_score': 0.59916526}
confusion matrix:
       0     1
0  42189   209
1   2384  1938
---- Validation: 
scalar performance:
{'acc': 0.96350056, 'precision': 0.52051955, 'recall': 0.50041085, 'specificity': 0.50041085, 'f1': 0.49216273, 'auroc': 0.555254, 'binary_precision': 0.07692308, 'binary_recall': 0.0014858841, 'binary_specificity': 0.9993358, 'binary_f1_score': 0.002915452}
confusion matrix:
       0   1
0  18055  12
1    672   1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.57901675, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520748_6.png
early stop counter: 5
val acc:0.9635005593299866, best validation acc: 0.9639807939529419, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 6,now: 2024-06-21 20:32:41.957211,epoch time: 0:13:35.433098,used: 1:21:15.898831,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_11_25_seed_1_21520748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9546447, 'precision': 0.9450221, 'recall': 0.7723136, 'specificity': 0.7723136, 'f1': 0.8333838, 'auroc': 0.95666957, 'binary_precision': 0.9342261, 'binary_recall': 0.54856616, 'binary_specificity': 0.99606097, 'binary_f1_score': 0.69124293}
confusion matrix:
       0     1
0  42229   167
1   1952  2372
---- Validation: 
scalar performance:
{'acc': 0.9638207, 'precision': 0.63598424, 'recall': 0.5027227, 'specificity': 0.5027227, 'f1': 0.4966175, 'auroc': 0.59780264, 'binary_precision': 0.30769232, 'binary_recall': 0.0059435363, 'binary_specificity': 0.9995019, 'binary_f1_score': 0.011661808}
confusion matrix:
       0  1
0  18058  9
1    669  4
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579439, 'precision': 0.47904915, 'recall': 0.4999159, 'specificity': 0.4999159, 'f1': 0.48926014, 'auroc': 0.6411576, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5945  1
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520748_7.png
early stop counter: 6
val acc:0.9638206958770752, best validation acc: 0.9639807939529419, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 7,now: 2024-06-21 20:47:27.396725,epoch time: 0:14:45.439514,used: 1:36:01.338345,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_11_25_seed_1_21520748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.96005994, 'precision': 0.95681137, 'recall': 0.7973223, 'specificity': 0.7973223, 'f1': 0.85652316, 'auroc': 0.9637971, 'binary_precision': 0.9531365, 'binary_recall': 0.59764, 'binary_specificity': 0.99700457, 'binary_f1_score': 0.7346416}
confusion matrix:
       0     1
0  42271   127
1   1739  2583
---- Validation: 
scalar performance:
{'acc': 0.96451443, 'precision': 0.8233324, 'recall': 0.5109504, 'specificity': 0.5109504, 'f1': 0.51254374, 'auroc': 0.6292981, 'binary_precision': 0.6818182, 'binary_recall': 0.022288261, 'binary_specificity': 0.99961257, 'binary_f1_score': 0.043165464}
confusion matrix:
       0   1
0  18060   7
1    658  15
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579439, 'precision': 0.6457897, 'recall': 0.5017549, 'specificity': 0.5017549, 'f1': 0.49306068, 'auroc': 0.69325984, 'binary_precision': 0.33333334, 'binary_recall': 0.0038461538, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.007604562}
confusion matrix:
      0  1
0  5944  2
1   259  1
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520748_8.png
better model found
persisted
after epoch: 8,now: 2024-06-21 21:01:01.954390,epoch time: 0:13:34.557665,used: 1:49:35.896010,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_11_25_seed_1_21520748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9673587, 'precision': 0.9594842, 'recall': 0.8395767, 'specificity': 0.8395767, 'f1': 0.88846916, 'auroc': 0.9717065, 'binary_precision': 0.95040256, 'binary_recall': 0.68278575, 'binary_specificity': 0.99636775, 'binary_f1_score': 0.79466814}
confusion matrix:
       0     1
0  42244   154
1   1371  2951
---- Validation: 
scalar performance:
{'acc': 0.9647812, 'precision': 0.7899432, 'recall': 0.52539414, 'specificity': 0.52539414, 'f1': 0.5389656, 'auroc': 0.6679088, 'binary_precision': 0.61403507, 'binary_recall': 0.052005943, 'binary_specificity': 0.99878234, 'binary_f1_score': 0.0958904}
confusion matrix:
       0   1
0  18045  22
1    638  35
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579439, 'precision': 0.69355655, 'recall': 0.5054329, 'specificity': 0.5054329, 'f1': 0.5004908, 'auroc': 0.7227645, 'binary_precision': 0.42857143, 'binary_recall': 0.011538462, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.02247191}
confusion matrix:
      0  1
0  5942  4
1   257  3
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520748_9.png
better model found
persisted
after epoch: 9,now: 2024-06-21 21:14:02.153546,epoch time: 0:13:00.199156,used: 2:02:36.095166,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_11_25_seed_1_21520748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9686858, 'precision': 0.96904504, 'recall': 0.8404118, 'specificity': 0.8404118, 'f1': 0.89220726, 'auroc': 0.9728277, 'binary_precision': 0.9694581, 'binary_recall': 0.68301713, 'binary_specificity': 0.9978065, 'binary_f1_score': 0.80141175}
confusion matrix:
       0     1
0  42305    93
1   1370  2952
---- Validation: 
scalar performance:
{'acc': 0.9645678, 'precision': 0.7698072, 'recall': 0.5252834, 'specificity': 0.5252834, 'f1': 0.53864896, 'auroc': 0.67723554, 'binary_precision': 0.57377046, 'binary_recall': 0.052005943, 'binary_specificity': 0.9985609, 'binary_f1_score': 0.09536785}
confusion matrix:
       0   1
0  18041  26
1    638  35
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582662, 'precision': 0.7488045, 'recall': 0.512957, 'specificity': 0.512957, 'f1': 0.514973, 'auroc': 0.74884605, 'binary_precision': 0.53846157, 'binary_recall': 0.026923077, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.051282056}
confusion matrix:
      0  1
0  5940  6
1   253  7
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520748_10.png
new oracle model saved
early stop counter: 1
val acc:0.9645677804946899, best validation acc: 0.9647812247276306, corresponding to test acc:                         0.9579439163208008 / 0.9582661986351013
after epoch: 10,now: 2024-06-21 21:26:52.768800,epoch time: 0:12:50.615254,used: 2:15:26.710420,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_11_25_seed_1_21520748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9725599, 'precision': 0.9707261, 'recall': 0.86241233, 'specificity': 0.86241233, 'f1': 0.90790325, 'auroc': 0.9755249, 'binary_precision': 0.96859604, 'binary_recall': 0.7272307, 'binary_specificity': 0.997594, 'binary_f1_score': 0.83073676}
confusion matrix:
       0     1
0  42292   102
1   1180  3146
---- Validation: 
scalar performance:
{'acc': 0.96499467, 'precision': 0.7700546, 'recall': 0.54839337, 'specificity': 0.54839337, 'f1': 0.57587034, 'auroc': 0.6981782, 'binary_precision': 0.5726496, 'binary_recall': 0.09955423, 'binary_specificity': 0.9972325, 'binary_f1_score': 0.16962026}
confusion matrix:
       0   1
0  18017  50
1    606  67
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95955527, 'precision': 0.80314744, 'recall': 0.53753656, 'specificity': 0.53753656, 'f1': 0.5583746, 'auroc': 0.75784963, 'binary_precision': 0.6451613, 'binary_recall': 0.07692308, 'binary_specificity': 0.99815, 'binary_f1_score': 0.13745706}
confusion matrix:
      0   1
0  5935  11
1   240  20
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520748_11.png
new oracle model saved
better model found
persisted
after epoch: 11,now: 2024-06-21 21:40:05.305945,epoch time: 0:13:12.537145,used: 2:28:39.247565,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_11_25_seed_1_21520748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9736943, 'precision': 0.97640383, 'recall': 0.86473966, 'specificity': 0.86473966, 'f1': 0.9114654, 'auroc': 0.9782852, 'binary_precision': 0.97954756, 'binary_recall': 0.73103607, 'binary_specificity': 0.99844325, 'binary_f1_score': 0.83724004}
confusion matrix:
       0     1
0  42330    66
1   1163  3161
---- Validation: 
scalar performance:
{'acc': 0.9647279, 'precision': 0.7659581, 'recall': 0.537526, 'specificity': 0.537526, 'f1': 0.55897206, 'auroc': 0.6943568, 'binary_precision': 0.5652174, 'binary_recall': 0.07726597, 'binary_specificity': 0.99778605, 'binary_f1_score': 0.1359477}
confusion matrix:
       0   1
0  18027  40
1    621  52
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597164, 'precision': 0.82657456, 'recall': 0.53394264, 'specificity': 0.53394264, 'f1': 0.55262864, 'auroc': 0.74671113, 'binary_precision': 0.6923077, 'binary_recall': 0.06923077, 'binary_specificity': 0.99865454, 'binary_f1_score': 0.12587413}
confusion matrix:
      0   1
0  5938   8
1   242  18
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520748_12.png
new oracle model saved
early stop counter: 1
val acc:0.9647278785705566, best validation acc: 0.9649946689605713, corresponding to test acc:                         0.9595552682876587 / 0.9597163796424866
after epoch: 12,now: 2024-06-21 21:53:42.659296,epoch time: 0:13:37.353351,used: 2:42:16.600916,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_11_25_seed_1_21520748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9770762, 'precision': 0.97984076, 'recall': 0.8820752, 'specificity': 0.8820752, 'f1': 0.9241282, 'auroc': 0.9784068, 'binary_precision': 0.98307097, 'binary_recall': 0.7654949, 'binary_specificity': 0.99865556, 'binary_f1_score': 0.8607463}
confusion matrix:
       0     1
0  42339    57
1   1014  3310
---- Validation: 
scalar performance:
{'acc': 0.96568835, 'precision': 0.78703564, 'recall': 0.56234324, 'specificity': 0.56234324, 'f1': 0.5967529, 'auroc': 0.7171682, 'binary_precision': 0.6056338, 'binary_recall': 0.12778603, 'binary_specificity': 0.99690044, 'binary_f1_score': 0.21104293}
confusion matrix:
       0   1
0  18011  56
1    587  86
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597164, 'precision': 0.7905426, 'recall': 0.54865456, 'specificity': 0.54865456, 'f1': 0.5757707, 'auroc': 0.76331306, 'binary_precision': 0.61904764, 'binary_recall': 0.1, 'binary_specificity': 0.9973091, 'binary_f1_score': 0.17218544}
confusion matrix:
      0   1
0  5930  16
1   234  26
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520748_13.png
better model found
persisted
after epoch: 13,now: 2024-06-21 22:07:10.138628,epoch time: 0:13:27.479332,used: 2:55:44.080248,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_11_25_seed_1_21520748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9790668, 'precision': 0.97833186, 'recall': 0.8951616, 'specificity': 0.8951616, 'f1': 0.93185174, 'auroc': 0.9822223, 'binary_precision': 0.9774672, 'binary_recall': 0.7921868, 'binary_specificity': 0.9981365, 'binary_f1_score': 0.8751276}
confusion matrix:
       0     1
0  42315    79
1    899  3427
---- Validation: 
scalar performance:
{'acc': 0.9653148, 'precision': 0.7738176, 'recall': 0.56071895, 'specificity': 0.56071895, 'f1': 0.59382474, 'auroc': 0.723117, 'binary_precision': 0.57931036, 'binary_recall': 0.124814264, 'binary_specificity': 0.9966237, 'binary_f1_score': 0.20537896}
confusion matrix:
       0   1
0  18006  61
1    589  84
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96052206, 'precision': 0.81119657, 'recall': 0.5582699, 'specificity': 0.5582699, 'f1': 0.5908574, 'auroc': 0.76871264, 'binary_precision': 0.65957445, 'binary_recall': 0.11923077, 'binary_specificity': 0.9973091, 'binary_f1_score': 0.20195441}
confusion matrix:
      0   1
0  5930  16
1   229  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520748_14.png
new oracle model saved
early stop counter: 1
val acc:0.9653148055076599, best validation acc: 0.9656883478164673, corresponding to test acc:                         0.9597163796424866 / 0.9605220556259155
after epoch: 14,now: 2024-06-21 22:20:27.530721,epoch time: 0:13:17.392093,used: 3:09:01.472341,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_11_25_seed_1_21520748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.979345, 'precision': 0.98040277, 'recall': 0.8950593, 'specificity': 0.8950593, 'f1': 0.93259335, 'auroc': 0.9829149, 'binary_precision': 0.9816461, 'binary_recall': 0.7916281, 'binary_specificity': 0.99849045, 'binary_f1_score': 0.87645626}
confusion matrix:
       0     1
0  42332    64
1    901  3423
---- Validation: 
scalar performance:
{'acc': 0.9657951, 'precision': 0.77870655, 'recall': 0.57741916, 'specificity': 0.57741916, 'f1': 0.61639535, 'auroc': 0.7538379, 'binary_precision': 0.5879121, 'binary_recall': 0.1589896, 'binary_specificity': 0.9958488, 'binary_f1_score': 0.2502924}
confusion matrix:
       0    1
0  17992   75
1    566  107
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9618111, 'precision': 0.82360744, 'recall': 0.5810105, 'specificity': 0.5810105, 'f1': 0.62332463, 'auroc': 0.79900515, 'binary_precision': 0.6825397, 'binary_recall': 0.16538462, 'binary_specificity': 0.9966364, 'binary_f1_score': 0.26625386}
confusion matrix:
      0   1
0  5926  20
1   217  43
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520748_15.png
new oracle model saved
better model found
persisted
after epoch: 15,now: 2024-06-21 22:33:30.529524,epoch time: 0:13:02.998803,used: 3:22:04.471144,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_11_25_seed_1_21520748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9786387, 'precision': 0.9789256, 'recall': 0.8921236, 'specificity': 0.8921236, 'f1': 0.9301827, 'auroc': 0.98502266, 'binary_precision': 0.97926265, 'binary_recall': 0.7859455, 'binary_specificity': 0.9983016, 'binary_f1_score': 0.8720185}
confusion matrix:
       0     1
0  42322    72
1    926  3400
---- Validation: 
scalar performance:
{'acc': 0.96568835, 'precision': 0.78132063, 'recall': 0.5687806, 'specificity': 0.5687806, 'f1': 0.6052727, 'auroc': 0.74522847, 'binary_precision': 0.59375, 'binary_recall': 0.14115898, 'binary_specificity': 0.99640226, 'binary_f1_score': 0.22809123}
confusion matrix:
       0   1
0  18002  65
1    578  95
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621334, 'precision': 0.8545149, 'recall': 0.57198375, 'specificity': 0.57198375, 'f1': 0.6124765, 'auroc': 0.78515553, 'binary_precision': 0.74509805, 'binary_recall': 0.14615385, 'binary_specificity': 0.99781364, 'binary_f1_score': 0.244373}
confusion matrix:
      0   1
0  5933  13
1   222  38
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520748_16.png
new oracle model saved
early stop counter: 1
val acc:0.9656883478164673, best validation acc: 0.96579509973526, corresponding to test acc:                         0.9618111252784729 / 0.9621334075927734
after epoch: 16,now: 2024-06-21 22:46:32.042562,epoch time: 0:13:01.513038,used: 3:35:05.984182,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_11_25_seed_1_21520748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98107874, 'precision': 0.9804232, 'recall': 0.9053818, 'specificity': 0.9053818, 'f1': 0.9389676, 'auroc': 0.98527014, 'binary_precision': 0.9796487, 'binary_recall': 0.8124856, 'binary_specificity': 0.9982781, 'binary_f1_score': 0.88827103}
confusion matrix:
       0     1
0  42322    73
1    811  3514
---- Validation: 
scalar performance:
{'acc': 0.9655283, 'precision': 0.77196336, 'recall': 0.575135, 'specificity': 0.575135, 'f1': 0.612961, 'auroc': 0.7431525, 'binary_precision': 0.5745856, 'binary_recall': 0.15453194, 'binary_specificity': 0.9957381, 'binary_f1_score': 0.2435597}
confusion matrix:
       0    1
0  17990   77
1    569  104
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96165, 'precision': 0.80337834, 'recall': 0.5937993, 'specificity': 0.5937993, 'f1': 0.6380731, 'auroc': 0.7834964, 'binary_precision': 0.64102566, 'binary_recall': 0.1923077, 'binary_specificity': 0.99529094, 'binary_f1_score': 0.295858}
confusion matrix:
      0   1
0  5918  28
1   210  50
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520748_17.png
early stop counter: 2
val acc:0.9655283093452454, best validation acc: 0.96579509973526, corresponding to test acc:                         0.9618111252784729 / 0.9621334075927734
after epoch: 17,now: 2024-06-21 22:59:46.462900,epoch time: 0:13:14.420338,used: 3:48:20.404520,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_11_25_seed_1_21520748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98139983, 'precision': 0.97906256, 'recall': 0.9084655, 'specificity': 0.9084655, 'f1': 0.9402839, 'auroc': 0.9862399, 'binary_precision': 0.9762955, 'binary_recall': 0.81895953, 'binary_specificity': 0.9979715, 'binary_f1_score': 0.89073306}
confusion matrix:
       0     1
0  42309    86
1    783  3542
---- Validation: 
scalar performance:
{'acc': 0.96611524, 'precision': 0.7816787, 'recall': 0.587599, 'specificity': 0.587599, 'f1': 0.6292962, 'auroc': 0.7535567, 'binary_precision': 0.59313726, 'binary_recall': 0.17979197, 'binary_specificity': 0.995406, 'binary_f1_score': 0.2759407}
confusion matrix:
       0    1
0  17984   83
1    552  121
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9626168, 'precision': 0.83280635, 'recall': 0.59246486, 'specificity': 0.59246486, 'f1': 0.6388838, 'auroc': 0.78330064, 'binary_precision': 0.7, 'binary_recall': 0.18846154, 'binary_specificity': 0.9964682, 'binary_f1_score': 0.2969697}
confusion matrix:
      0   1
0  5925  21
1   211  49
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520748_18.png
new oracle model saved
better model found
persisted
after epoch: 18,now: 2024-06-21 23:13:20.084237,epoch time: 0:13:33.621337,used: 4:01:54.025857,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_11_25_seed_1_21520748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.98142123, 'precision': 0.976943, 'recall': 0.9104701, 'specificity': 0.9104701, 'f1': 0.9406166, 'auroc': 0.9864043, 'binary_precision': 0.9716312, 'binary_recall': 0.82339346, 'binary_specificity': 0.99754685, 'binary_f1_score': 0.89139146}
confusion matrix:
       0     1
0  42290   104
1    764  3562
---- Validation: 
scalar performance:
{'acc': 0.96584845, 'precision': 0.7756703, 'recall': 0.5853148, 'specificity': 0.5853148, 'f1': 0.62596095, 'auroc': 0.75081646, 'binary_precision': 0.58128077, 'binary_recall': 0.17533432, 'binary_specificity': 0.9952953, 'binary_f1_score': 0.26940638}
confusion matrix:
       0    1
0  17982   85
1    555  118
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96422815, 'precision': 0.8468424, 'recall': 0.6153736, 'specificity': 0.6153736, 'f1': 0.6681277, 'auroc': 0.79214066, 'binary_precision': 0.72619045, 'binary_recall': 0.23461539, 'binary_specificity': 0.99613184, 'binary_f1_score': 0.35465115}
confusion matrix:
      0   1
0  5923  23
1   199  61
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520748_19.png
new oracle model saved
early stop counter: 1
val acc:0.965848445892334, best validation acc: 0.9661152362823486, corresponding to test acc:                         0.9626168012619019 / 0.9642281532287598
after epoch: 19,now: 2024-06-21 23:26:55.043562,epoch time: 0:13:34.959325,used: 4:15:28.985182,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_11_25_seed_1_21520748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9829195, 'precision': 0.9800973, 'recall': 0.9166546, 'specificity': 0.9166546, 'f1': 0.9455906, 'auroc': 0.9892312, 'binary_precision': 0.9767442, 'binary_recall': 0.83533764, 'binary_specificity': 0.99797153, 'binary_f1_score': 0.90052354}
confusion matrix:
       0     1
0  42310    86
1    712  3612
---- Validation: 
scalar performance:
{'acc': 0.9659552, 'precision': 0.7766276, 'recall': 0.58894646, 'specificity': 0.58894646, 'f1': 0.6304235, 'auroc': 0.770476, 'binary_precision': 0.5829384, 'binary_recall': 0.18276374, 'binary_specificity': 0.9951292, 'binary_f1_score': 0.27828053}
confusion matrix:
       0    1
0  17979   88
1    550  123
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9648727, 'precision': 0.8754209, 'recall': 0.610193, 'specificity': 0.610193, 'f1': 0.664628, 'auroc': 0.8080848, 'binary_precision': 0.7837838, 'binary_recall': 0.22307692, 'binary_specificity': 0.9973091, 'binary_f1_score': 0.3473054}
confusion matrix:
      0   1
0  5930  16
1   202  58
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520748_20.png
new oracle model saved
early stop counter: 2
val acc:0.9659551978111267, best validation acc: 0.9661152362823486, corresponding to test acc:                         0.9626168012619019 / 0.9648727178573608
after epoch: 20,now: 2024-06-21 23:40:38.078935,epoch time: 0:13:43.035373,used: 4:29:12.020555,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_11_25_seed_1_21520748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.98197776, 'precision': 0.9790979, 'recall': 0.9118782, 'specificity': 0.9118782, 'f1': 0.942343, 'auroc': 0.9886664, 'binary_precision': 0.97568303, 'binary_recall': 0.8258557, 'binary_specificity': 0.9979007, 'binary_f1_score': 0.89453906}
confusion matrix:
       0     1
0  42307    89
1    753  3571
---- Validation: 
scalar performance:
{'acc': 0.96584845, 'precision': 0.7729042, 'recall': 0.5910369, 'specificity': 0.5910369, 'f1': 0.6325096, 'auroc': 0.7504483, 'binary_precision': 0.5753425, 'binary_recall': 0.1872214, 'binary_specificity': 0.9948525, 'binary_f1_score': 0.2825112}
confusion matrix:
       0    1
0  17974   93
1    547  126
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96358365, 'precision': 0.83477426, 'recall': 0.6113593, 'specificity': 0.6113593, 'f1': 0.662148, 'auroc': 0.7820066, 'binary_precision': 0.70238096, 'binary_recall': 0.22692308, 'binary_specificity': 0.9957955, 'binary_f1_score': 0.34302324}
confusion matrix:
      0   1
0  5921  25
1   201  59
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520748_21.png
early stop counter: 3
val acc:0.965848445892334, best validation acc: 0.9661152362823486, corresponding to test acc:                         0.9626168012619019 / 0.9648727178573608
after epoch: 21,now: 2024-06-21 23:53:56.042065,epoch time: 0:13:17.963130,used: 4:42:29.983685,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_11_25_seed_1_21520748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9832406, 'precision': 0.9799618, 'recall': 0.9186821, 'specificity': 0.9186821, 'f1': 0.94672763, 'auroc': 0.98848045, 'binary_precision': 0.9760624, 'binary_recall': 0.83946335, 'binary_specificity': 0.9979008, 'binary_f1_score': 0.902624}
confusion matrix:
       0     1
0  42308    89
1    694  3629
---- Validation: 
scalar performance:
{'acc': 0.96600854, 'precision': 0.7724767, 'recall': 0.6011337, 'specificity': 0.6011337, 'f1': 0.6439607, 'auroc': 0.7835896, 'binary_precision': 0.57377046, 'binary_recall': 0.20802377, 'binary_specificity': 0.9942436, 'binary_f1_score': 0.3053435}
confusion matrix:
       0    1
0  17963  104
1    533  140
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96455044, 'precision': 0.8528764, 'recall': 0.6173808, 'specificity': 0.6173808, 'f1': 0.67111754, 'auroc': 0.8177682, 'binary_precision': 0.7380952, 'binary_recall': 0.23846154, 'binary_specificity': 0.99630004, 'binary_f1_score': 0.36046514}
confusion matrix:
      0   1
0  5924  22
1   198  62
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520748_22.png
early stop counter: 4
val acc:0.9660085439682007, best validation acc: 0.9661152362823486, corresponding to test acc:                         0.9626168012619019 / 0.9648727178573608
after epoch: 22,now: 2024-06-22 00:06:57.049612,epoch time: 0:13:01.007547,used: 4:55:30.991232,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_11_25_seed_1_21520748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9838185, 'precision': 0.9773934, 'recall': 0.9245225, 'specificity': 0.9245225, 'f1': 0.9490292, 'auroc': 0.9898634, 'binary_precision': 0.9697209, 'binary_recall': 0.85175765, 'binary_specificity': 0.99728745, 'binary_f1_score': 0.9069195}
confusion matrix:
       0     1
0  42281   115
1    641  3683
---- Validation: 
scalar performance:
{'acc': 0.96510136, 'precision': 0.75264347, 'recall': 0.6085312, 'specificity': 0.6085312, 'f1': 0.6489968, 'auroc': 0.780227, 'binary_precision': 0.5335689, 'binary_recall': 0.2243685, 'binary_specificity': 0.99269384, 'binary_f1_score': 0.31589958}
confusion matrix:
       0    1
0  17935  132
1    522  151
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9653561, 'precision': 0.8419814, 'recall': 0.6417081, 'specificity': 0.6417081, 'f1': 0.6965561, 'auroc': 0.8154305, 'binary_precision': 0.71428573, 'binary_recall': 0.28846154, 'binary_specificity': 0.9949546, 'binary_f1_score': 0.4109589}
confusion matrix:
      0   1
0  5916  30
1   185  75
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520748_23.png
new oracle model saved
early stop counter: 5
val acc:0.9651013612747192, best validation acc: 0.9661152362823486, corresponding to test acc:                         0.9626168012619019 / 0.9653561115264893
after epoch: 23,now: 2024-06-22 00:20:52.489290,epoch time: 0:13:55.439678,used: 5:09:26.430910,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_11_25_seed_1_21520748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.98418236, 'precision': 0.98365295, 'recall': 0.92108864, 'specificity': 0.92108864, 'f1': 0.94968724, 'auroc': 0.98995614, 'binary_precision': 0.98302346, 'binary_recall': 0.8436633, 'binary_specificity': 0.998514, 'binary_f1_score': 0.9080274}
confusion matrix:
       0     1
0  42333    63
1    676  3648
---- Validation: 
scalar performance:
{'acc': 0.96568835, 'precision': 0.77353525, 'recall': 0.5809402, 'specificity': 0.5809402, 'f1': 0.6204, 'auroc': 0.7670443, 'binary_precision': 0.57731956, 'binary_recall': 0.16641901, 'binary_specificity': 0.99546134, 'binary_f1_score': 0.25836214}
confusion matrix:
       0    1
0  17985   82
1    561  112
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9639059, 'precision': 0.84601295, 'recall': 0.60968846, 'specificity': 0.60968846, 'f1': 0.6613106, 'auroc': 0.7923777, 'binary_precision': 0.725, 'binary_recall': 0.22307692, 'binary_specificity': 0.99630004, 'binary_f1_score': 0.34117648}
confusion matrix:
      0   1
0  5924  22
1   202  58
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520748_24.png
early stop counter: 6
val acc:0.9656883478164673, best validation acc: 0.9661152362823486, corresponding to test acc:                         0.9626168012619019 / 0.9653561115264893
after epoch: 24,now: 2024-06-22 00:34:39.358231,epoch time: 0:13:46.868941,used: 5:23:13.299851,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_11_25_seed_1_21520748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.98319775, 'precision': 0.9797052, 'recall': 0.91869557, 'specificity': 0.91869557, 'f1': 0.9466276, 'auroc': 0.9903194, 'binary_precision': 0.9755508, 'binary_recall': 0.83953756, 'binary_specificity': 0.9978535, 'binary_f1_score': 0.9024481}
confusion matrix:
       0     1
0  42304    91
1    694  3631
---- Validation: 
scalar performance:
{'acc': 0.9660619, 'precision': 0.7778883, 'recall': 0.5918629, 'specificity': 0.5918629, 'f1': 0.6340058, 'auroc': 0.780957, 'binary_precision': 0.5852535, 'binary_recall': 0.18870728, 'binary_specificity': 0.99501854, 'binary_f1_score': 0.28539324}
confusion matrix:
       0    1
0  17977   90
1    546  127
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96422815, 'precision': 0.85844207, 'recall': 0.6080177, 'specificity': 0.6080177, 'f1': 0.66045105, 'auroc': 0.8033693, 'binary_precision': 0.75, 'binary_recall': 0.21923077, 'binary_specificity': 0.9968046, 'binary_f1_score': 0.33928573}
confusion matrix:
      0   1
0  5927  19
1   203  57
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520748_25.png
early stop counter: 7
val acc:0.9660618901252747, best validation acc: 0.9661152362823486, corresponding to test acc:                         0.9626168012619019 / 0.9653561115264893
after epoch: 25,now: 2024-06-22 00:48:22.786905,epoch time: 0:13:43.428674,used: 5:36:56.728525,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_11_25_seed_1_21520748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9851242, 'precision': 0.9770209, 'recall': 0.9328375, 'specificity': 0.9328375, 'f1': 0.9535912, 'auroc': 0.99121845, 'binary_precision': 0.9673017, 'binary_recall': 0.8686705, 'binary_specificity': 0.9970044, 'binary_f1_score': 0.91533685}
confusion matrix:
       0     1
0  42268   127
1    568  3757
---- Validation: 
scalar performance:
{'acc': 0.9659018, 'precision': 0.76758695, 'recall': 0.6089463, 'specificity': 0.6089463, 'f1': 0.6517235, 'auroc': 0.7936841, 'binary_precision': 0.5634328, 'binary_recall': 0.2243685, 'binary_specificity': 0.99352413, 'binary_f1_score': 0.3209352}
confusion matrix:
       0    1
0  17950  117
1    522  151
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9648727, 'precision': 0.84158945, 'recall': 0.63226086, 'specificity': 0.63226086, 'f1': 0.6864881, 'auroc': 0.8110695, 'binary_precision': 0.71428573, 'binary_recall': 0.26923078, 'binary_specificity': 0.99529094, 'binary_f1_score': 0.39106148}
confusion matrix:
      0   1
0  5918  28
1   190  70
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520748_26.png
early stop counter: 8
val acc:0.965901792049408, best validation acc: 0.9661152362823486, corresponding to test acc:                         0.9626168012619019 / 0.9653561115264893
after epoch: 26,now: 2024-06-22 01:02:30.208891,epoch time: 0:14:07.421986,used: 5:51:04.150511,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_11_25_seed_1_21520748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9854024, 'precision': 0.97953284, 'recall': 0.93216026, 'specificity': 0.93216026, 'f1': 0.95431346, 'auroc': 0.99069244, 'binary_precision': 0.97250324, 'binary_recall': 0.8668208, 'binary_specificity': 0.9974997, 'binary_f1_score': 0.9166259}
confusion matrix:
       0     1
0  42289   106
1    576  3749
---- Validation: 
scalar performance:
{'acc': 0.96574175, 'precision': 0.76890826, 'recall': 0.59455794, 'specificity': 0.59455794, 'f1': 0.6361352, 'auroc': 0.78585654, 'binary_precision': 0.5670996, 'binary_recall': 0.19465081, 'binary_specificity': 0.99446505, 'binary_f1_score': 0.289823}
confusion matrix:
       0    1
0  17967  100
1    542  131
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9639059, 'precision': 0.82427776, 'recall': 0.62807834, 'specificity': 0.62807834, 'f1': 0.6795958, 'auroc': 0.8061323, 'binary_precision': 0.68, 'binary_recall': 0.26153848, 'binary_specificity': 0.99461824, 'binary_f1_score': 0.3777778}
confusion matrix:
      0   1
0  5914  32
1   192  68
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520748_27.png
early stop counter: 9
val acc:0.965741753578186, best validation acc: 0.9661152362823486, corresponding to test acc:                         0.9626168012619019 / 0.9653561115264893
after epoch: 27,now: 2024-06-22 01:17:06.663279,epoch time: 0:14:36.454388,used: 6:05:40.604899,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_11_25_seed_1_21520748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.98600173, 'precision': 0.98105216, 'recall': 0.93429947, 'specificity': 0.93429947, 'f1': 0.95618916, 'auroc': 0.9931131, 'binary_precision': 0.9751231, 'binary_recall': 0.8708632, 'binary_specificity': 0.9977358, 'binary_f1_score': 0.92004883}
confusion matrix:
       0     1
0  42303    96
1    558  3763
---- Validation: 
scalar performance:
{'acc': 0.965048, 'precision': 0.7526484, 'recall': 0.60135084, 'specificity': 0.60135084, 'f1': 0.64151824, 'auroc': 0.7914617, 'binary_precision': 0.53409094, 'binary_recall': 0.20950966, 'binary_specificity': 0.993192, 'binary_f1_score': 0.3009605}
confusion matrix:
       0    1
0  17944  123
1    532  141
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.965195, 'precision': 0.8405283, 'recall': 0.639785, 'specificity': 0.639785, 'f1': 0.69433254, 'auroc': 0.82059073, 'binary_precision': 0.71153843, 'binary_recall': 0.2846154, 'binary_specificity': 0.9949546, 'binary_f1_score': 0.4065934}
confusion matrix:
      0   1
0  5916  30
1   186  74
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520748_28.png
early stop counter: 10
val acc:0.9650480151176453, best validation acc: 0.9661152362823486, corresponding to test acc:                         0.9626168012619019 / 0.9653561115264893
after epoch: 28,now: 2024-06-22 01:31:32.549814,epoch time: 0:14:25.886535,used: 6:20:06.491434,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_11_25_seed_1_21520748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9854666, 'precision': 0.97661114, 'recall': 0.9352664, 'specificity': 0.9352664, 'f1': 0.95476913, 'auroc': 0.9914154, 'binary_precision': 0.96597594, 'binary_recall': 0.8736696, 'binary_specificity': 0.99686307, 'binary_f1_score': 0.91750693}
confusion matrix:
       0     1
0  42265   133
1    546  3776
---- Validation: 
scalar performance:
{'acc': 0.96542156, 'precision': 0.7567136, 'recall': 0.61871094, 'specificity': 0.61871094, 'f1': 0.6598354, 'auroc': 0.80088365, 'binary_precision': 0.5409836, 'binary_recall': 0.24517088, 'binary_specificity': 0.99225104, 'binary_f1_score': 0.33742332}
confusion matrix:
       0    1
0  17927  140
1    508  165
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9663229, 'precision': 0.84107447, 'recall': 0.6624415, 'specificity': 0.6624415, 'f1': 0.7170359, 'auroc': 0.8328565, 'binary_precision': 0.7107438, 'binary_recall': 0.33076924, 'binary_specificity': 0.9941137, 'binary_f1_score': 0.45144358}
confusion matrix:
      0   1
0  5911  35
1   174  86
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520748_29.png
new oracle model saved
early stop counter: 11
val acc:0.9654215574264526, best validation acc: 0.9661152362823486, corresponding to test acc:                         0.9626168012619019 / 0.9663228988647461
after epoch: 29,now: 2024-06-22 01:45:25.682512,epoch time: 0:13:53.132698,used: 6:33:59.624132,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_11_25_seed_1_21520748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.98557365, 'precision': 0.97898626, 'recall': 0.93369305, 'specificity': 0.93369305, 'f1': 0.954939, 'auroc': 0.99078095, 'binary_precision': 0.9710893, 'binary_recall': 0.8700278, 'binary_specificity': 0.99735826, 'binary_f1_score': 0.9177848}
confusion matrix:
       0     1
0  42284   112
1    562  3762
---- Validation: 
scalar performance:
{'acc': 0.96574175, 'precision': 0.765434, 'recall': 0.60528696, 'specificity': 0.60528696, 'f1': 0.6475335, 'auroc': 0.7951399, 'binary_precision': 0.55938697, 'binary_recall': 0.21693908, 'binary_specificity': 0.9936348, 'binary_f1_score': 0.31263384}
confusion matrix:
       0    1
0  17952  115
1    527  146
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650338, 'precision': 0.8390486, 'recall': 0.6378619, 'specificity': 0.6378619, 'f1': 0.69209707, 'auroc': 0.8128979, 'binary_precision': 0.70873785, 'binary_recall': 0.28076923, 'binary_specificity': 0.9949546, 'binary_f1_score': 0.40220386}
confusion matrix:
      0   1
0  5916  30
1   187  73
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520748_30.png
early stop counter: 12
val acc:0.965741753578186, best validation acc: 0.9661152362823486, corresponding to test acc:                         0.9626168012619019 / 0.9663228988647461
after epoch: 30,now: 2024-06-22 01:58:36.070713,epoch time: 0:13:10.388201,used: 6:47:10.012333,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_11_25_seed_1_21520748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 6:47:10.012333 at 2024-06-22 01:58:36.070713
persisted model performance metric: 

scalar performance:
{'acc': 0.9626168, 'precision': 0.83280635, 'recall': 0.59246486, 'specificity': 0.59246486, 'f1': 0.6388838, 'auroc': 0.78330064, 'binary_precision': 0.7, 'binary_recall': 0.18846154, 'binary_specificity': 0.9964682, 'binary_f1_score': 0.2969697}
confusion matrix:
      0   1
0  5925  21
1   211  49
oracle model performance metric: 

scalar performance:
{'acc': 0.9663229, 'precision': 0.84107447, 'recall': 0.6624415, 'specificity': 0.6624415, 'f1': 0.7170359, 'auroc': 0.8328565, 'binary_precision': 0.7107438, 'binary_recall': 0.33076924, 'binary_specificity': 0.9941137, 'binary_f1_score': 0.45144358}
confusion matrix:
      0   1
0  5911  35
1   174  86
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_differentbatchsizes_lre5_classbalancing3/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_resnet_differentbatchsizes_lre5_classbalancing3/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204094 KiB |   1056 MiB |    812 TiB |    812 TiB |
|       from large pool | 167936 KiB |    986 MiB |    811 TiB |    811 TiB |
|       from small pool |  36158 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 204094 KiB |   1056 MiB |    812 TiB |    812 TiB |
|       from large pool | 167936 KiB |    986 MiB |    811 TiB |    811 TiB |
|       from small pool |  36158 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201086 KiB |   1049 MiB |    812 TiB |    812 TiB |
|       from large pool | 165120 KiB |    980 MiB |    811 TiB |    811 TiB |
|       from small pool |  35966 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1212 MiB |   1250 MiB |   2064 MiB |    852 MiB |
|       from large pool |   1140 MiB |   1178 MiB |   1962 MiB |    822 MiB |
|       from small pool |     72 MiB |     72 MiB |    102 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 203457 KiB | 457399 KiB | 635077 GiB | 635077 GiB |
|       from large pool | 196608 KiB | 456608 KiB | 634706 GiB | 634706 GiB |
|       from small pool |   6849 KiB |  14441 KiB |    371 GiB |    371 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1482    |    2209    |   44664 K  |   44663 K  |
|       from large pool |      36    |      76    |   14688 K  |   14688 K  |
|       from small pool |    1446    |    2172    |   29976 K  |   29974 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1482    |    2209    |   44664 K  |   44663 K  |
|       from large pool |      36    |      76    |   14688 K  |   14688 K  |
|       from small pool |    1446    |    2172    |   29976 K  |   29974 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      49    |      50    |      69    |      20    |
|       from large pool |      13    |      14    |      18    |       5    |
|       from small pool |      36    |      36    |      51    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      32    |     744    |   18398 K  |   18398 K  |
|       from large pool |       5    |      11    |    5704 K  |    5704 K  |
|       from small pool |      27    |     739    |   12693 K  |   12693 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1056 MiB |    812 TiB |    812 TiB |
|       from large pool |  16640 KiB |    986 MiB |    811 TiB |    811 TiB |
|       from small pool |      0 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1056 MiB |    812 TiB |    812 TiB |
|       from large pool |  16640 KiB |    986 MiB |    811 TiB |    811 TiB |
|       from small pool |      0 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1049 MiB |    812 TiB |    812 TiB |
|       from large pool |  16640 KiB |    980 MiB |    811 TiB |    811 TiB |
|       from small pool |      0 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 407552 KiB |   1250 MiB |   2064 MiB |   1666 MiB |
|       from large pool | 364544 KiB |   1178 MiB |   1962 MiB |   1606 MiB |
|       from small pool |  43008 KiB |     72 MiB |    102 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 184064 KiB | 457399 KiB | 635077 GiB | 635077 GiB |
|       from large pool | 184064 KiB | 456608 KiB | 634706 GiB | 634706 GiB |
|       from small pool |      0 KiB |  14444 KiB |    371 GiB |    371 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2209    |   44664 K  |   44664 K  |
|       from large pool |       2    |      76    |   14688 K  |   14688 K  |
|       from small pool |       0    |    2172    |   29976 K  |   29976 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2209    |   44664 K  |   44664 K  |
|       from large pool |       2    |      76    |   14688 K  |   14688 K  |
|       from small pool |       0    |    2172    |   29976 K  |   29976 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      30    |      50    |      69    |      39    |
|       from large pool |       9    |      14    |      18    |       9    |
|       from small pool |      21    |      36    |      51    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     744    |   18398 K  |   18398 K  |
|       from large pool |       1    |      11    |    5704 K  |    5704 K  |
|       from small pool |       0    |     739    |   12694 K  |   12694 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1056 MiB |    812 TiB |    812 TiB |
|       from large pool |  16640 KiB |    986 MiB |    811 TiB |    811 TiB |
|       from small pool |      0 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1056 MiB |    812 TiB |    812 TiB |
|       from large pool |  16640 KiB |    986 MiB |    811 TiB |    811 TiB |
|       from small pool |      0 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1049 MiB |    812 TiB |    812 TiB |
|       from large pool |  16640 KiB |    980 MiB |    811 TiB |    811 TiB |
|       from small pool |      0 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 407552 KiB |   1250 MiB |   2064 MiB |   1666 MiB |
|       from large pool | 364544 KiB |   1178 MiB |   1962 MiB |   1606 MiB |
|       from small pool |  43008 KiB |     72 MiB |    102 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 184064 KiB | 457399 KiB | 635077 GiB | 635077 GiB |
|       from large pool | 184064 KiB | 456608 KiB | 634706 GiB | 634706 GiB |
|       from small pool |      0 KiB |  14444 KiB |    371 GiB |    371 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2209    |   44664 K  |   44664 K  |
|       from large pool |       2    |      76    |   14688 K  |   14688 K  |
|       from small pool |       0    |    2172    |   29976 K  |   29976 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2209    |   44664 K  |   44664 K  |
|       from large pool |       2    |      76    |   14688 K  |   14688 K  |
|       from small pool |       0    |    2172    |   29976 K  |   29976 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      30    |      50    |      69    |      39    |
|       from large pool |       9    |      14    |      18    |       9    |
|       from small pool |      21    |      36    |      51    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     744    |   18398 K  |   18398 K  |
|       from large pool |       1    |      11    |    5704 K  |    5704 K  |
|       from small pool |       0    |     739    |   12694 K  |   12694 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0




!!!: not committed yet



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_02_04_24_seed_2_21520748

 Experiment start at: 2024-06-22 02:04:24.231775
before training, model accuracy: 0.0544959120452404
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9031335, 'precision': 0.45156676, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.47455078, 'auroc': 0.6259066, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42310  0
1   4538  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.35579318, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.28258067, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520748_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-22 02:18:14.336387,epoch time: 0:13:50.104612,used: 0:13:50.104612,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_02_04_24_seed_2_21520748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9031122, 'precision': 0.4515561, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4745449, 'auroc': 0.80334914, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42309  0
1   4539  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.39611512, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.33340085, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520748_2.png
early stop counter: 1
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 2,now: 2024-06-22 02:31:38.017423,epoch time: 0:13:23.681036,used: 0:27:13.785648,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_02_04_24_seed_2_21520748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.90787226, 'precision': 0.949328, 'recall': 0.52476156, 'specificity': 0.52476156, 'f1': 0.5229431, 'auroc': 0.8893248, 'binary_precision': 0.9911894, 'binary_recall': 0.04957039, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.094418794}
confusion matrix:
       0    1
0  42307    2
1   4314  225
---- Validation: 
scalar performance:
{'acc': 0.9678794, 'precision': 0.4839655, 'recall': 0.4999725, 'specificity': 0.4999725, 'f1': 0.4918388, 'auroc': 0.44628727, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.999945, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18170  1
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.44952708, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520748_3.png
early stop counter: 2
val acc:0.9678794145584106, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 3,now: 2024-06-22 02:45:00.362747,epoch time: 0:13:22.345324,used: 0:40:36.130972,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_02_04_24_seed_2_21520748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9270193, 'precision': 0.95832294, 'recall': 0.6243586, 'specificity': 0.6243586, 'f1': 0.6795563, 'auroc': 0.92845833, 'binary_precision': 0.99122804, 'binary_recall': 0.24895352, 'binary_specificity': 0.99976367, 'binary_f1_score': 0.39795738}
confusion matrix:
       0     1
0  42299    10
1   3409  1130
---- Validation: 
scalar performance:
{'acc': 0.96761304, 'precision': 0.4839612, 'recall': 0.4998349, 'specificity': 0.4998349, 'f1': 0.49176997, 'auroc': 0.5170603, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9996698, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18165  6
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96105146, 'precision': 0.48060277, 'recall': 0.4999166, 'specificity': 0.4999166, 'f1': 0.49006948, 'auroc': 0.5537603, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5996  1
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520748_4.png
early stop counter: 3
val acc:0.9676130414009094, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 4,now: 2024-06-22 02:58:19.350309,epoch time: 0:13:18.987562,used: 0:53:55.118534,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_02_04_24_seed_2_21520748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.94031763, 'precision': 0.96020555, 'recall': 0.6952478, 'specificity': 0.6952478, 'f1': 0.7637682, 'auroc': 0.9484298, 'binary_precision': 0.9817579, 'binary_recall': 0.3912756, 'binary_specificity': 0.99922, 'binary_f1_score': 0.5595463}
confusion matrix:
       0     1
0  42276    33
1   2763  1776
---- Validation: 
scalar performance:
{'acc': 0.9672402, 'precision': 0.48395523, 'recall': 0.49964228, 'specificity': 0.49964228, 'f1': 0.49167365, 'auroc': 0.5777309, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99928457, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18158  13
1    602   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96105146, 'precision': 0.48060277, 'recall': 0.4999166, 'specificity': 0.4999166, 'f1': 0.49006948, 'auroc': 0.6224489, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5996  1
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520748_5.png
early stop counter: 4
val acc:0.9672402143478394, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 5,now: 2024-06-22 03:11:32.836117,epoch time: 0:13:13.485808,used: 1:07:08.604342,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_02_04_24_seed_2_21520748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9559853, 'precision': 0.9686377, 'recall': 0.77718437, 'specificity': 0.77718437, 'f1': 0.84296405, 'auroc': 0.9605681, 'binary_precision': 0.982846, 'binary_recall': 0.55540866, 'binary_specificity': 0.99896, 'binary_f1_score': 0.709741}
confusion matrix:
       0     1
0  42265    44
1   2018  2521
---- Validation: 
scalar performance:
{'acc': 0.9676663, 'precision': 0.67463785, 'recall': 0.5062868, 'specificity': 0.5062868, 'f1': 0.50462127, 'auroc': 0.64377594, 'binary_precision': 0.3809524, 'binary_recall': 0.013289036, 'binary_specificity': 0.99928457, 'binary_f1_score': 0.025682183}
confusion matrix:
       0   1
0  18158  13
1    594   8
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9604103, 'precision': 0.4805903, 'recall': 0.49958313, 'specificity': 0.49958313, 'f1': 0.4899027, 'auroc': 0.69615245, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5992  5
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520748_6.png
early stop counter: 5
val acc:0.9676663279533386, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 6,now: 2024-06-22 03:24:52.050971,epoch time: 0:13:19.214854,used: 1:20:27.819196,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_02_04_24_seed_2_21520748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9585041, 'precision': 0.97234833, 'recall': 0.7890028, 'specificity': 0.7890028, 'f1': 0.8537252, 'auroc': 0.9632244, 'binary_precision': 0.9879654, 'binary_recall': 0.5787618, 'binary_specificity': 0.9992437, 'binary_f1_score': 0.729925}
confusion matrix:
       0     1
0  42277    32
1   1912  2627
---- Validation: 
scalar performance:
{'acc': 0.9676663, 'precision': 0.67983884, 'recall': 0.50708985, 'specificity': 0.50708985, 'f1': 0.50617975, 'auroc': 0.6070175, 'binary_precision': 0.39130434, 'binary_recall': 0.014950166, 'binary_specificity': 0.99922955, 'binary_f1_score': 0.028800001}
confusion matrix:
       0   1
0  18157  14
1    593   9
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608912, 'precision': 0.6056736, 'recall': 0.501816, 'specificity': 0.501816, 'f1': 0.49409118, 'auroc': 0.64417887, 'binary_precision': 0.25, 'binary_recall': 0.004132231, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.008130081}
confusion matrix:
      0  1
0  5994  3
1   241  1
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520748_7.png
early stop counter: 6
val acc:0.9676663279533386, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 7,now: 2024-06-22 03:38:11.048253,epoch time: 0:13:18.997282,used: 1:33:46.816478,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_02_04_24_seed_2_21520748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9636911, 'precision': 0.97223043, 'recall': 0.81783587, 'specificity': 0.81783587, 'f1': 0.8764773, 'auroc': 0.9683, 'binary_precision': 0.9819973, 'binary_recall': 0.63692445, 'binary_specificity': 0.9987473, 'binary_f1_score': 0.7726848}
confusion matrix:
       0     1
0  42256    53
1   1648  2891
---- Validation: 
scalar performance:
{'acc': 0.9679859, 'precision': 0.73988605, 'recall': 0.5193007, 'specificity': 0.5193007, 'f1': 0.52883565, 'auroc': 0.68689275, 'binary_precision': 0.5106383, 'binary_recall': 0.03986711, 'binary_specificity': 0.99873424, 'binary_f1_score': 0.07395995}
confusion matrix:
       0   1
0  18148  23
1    578  24
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96025, 'precision': 0.63720775, 'recall': 0.5094134, 'specificity': 0.5094134, 'f1': 0.5092325, 'auroc': 0.73063135, 'binary_precision': 0.3125, 'binary_recall': 0.020661157, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.038759694}
confusion matrix:
      0   1
0  5986  11
1   237   5
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520748_8.png
better model found
persisted
after epoch: 8,now: 2024-06-22 03:51:14.062902,epoch time: 0:13:03.014649,used: 1:46:49.831127,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_02_04_24_seed_2_21520748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9691342, 'precision': 0.970026, 'recall': 0.850056, 'specificity': 0.850056, 'f1': 0.89914906, 'auroc': 0.9743917, 'binary_precision': 0.9710631, 'binary_recall': 0.70235735, 'binary_specificity': 0.99775463, 'binary_f1_score': 0.8151368}
confusion matrix:
       0     1
0  42214    95
1   1351  3188
---- Validation: 
scalar performance:
{'acc': 0.9683055, 'precision': 0.7589458, 'recall': 0.53231454, 'specificity': 0.53231454, 'f1': 0.5511906, 'auroc': 0.6933722, 'binary_precision': 0.5479452, 'binary_recall': 0.06644518, 'binary_specificity': 0.9981839, 'binary_f1_score': 0.11851851}
confusion matrix:
       0   1
0  18138  33
1    562  40
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9616926, 'precision': 0.7672196, 'recall': 0.524043, 'specificity': 0.524043, 'f1': 0.5358443, 'auroc': 0.7254774, 'binary_precision': 0.5714286, 'binary_recall': 0.049586777, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.091254756}
confusion matrix:
      0   1
0  5988   9
1   230  12
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520748_9.png
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-06-22 04:04:30.997246,epoch time: 0:13:16.934344,used: 2:00:06.765471,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_02_04_24_seed_2_21520748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.97120476, 'precision': 0.97858834, 'recall': 0.8555292, 'specificity': 0.8555292, 'f1': 0.90581584, 'auroc': 0.97623384, 'binary_precision': 0.98717165, 'binary_recall': 0.7120511, 'binary_specificity': 0.9990073, 'binary_f1_score': 0.82733905}
confusion matrix:
       0     1
0  42267    42
1   1307  3232
---- Validation: 
scalar performance:
{'acc': 0.9688382, 'precision': 0.7864376, 'recall': 0.5406202, 'specificity': 0.5406202, 'f1': 0.56505746, 'auroc': 0.6864383, 'binary_precision': 0.60240966, 'binary_recall': 0.08305648, 'binary_specificity': 0.9981839, 'binary_f1_score': 0.14598541}
confusion matrix:
       0   1
0  18138  33
1    552  50
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9632954, 'precision': 0.815914, 'recall': 0.55263513, 'specificity': 0.55263513, 'f1': 0.5831391, 'auroc': 0.7162118, 'binary_precision': 0.6666667, 'binary_recall': 0.10743801, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.18505338}
confusion matrix:
      0   1
0  5984  13
1   216  26
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520748_10.png
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-06-22 04:17:47.063267,epoch time: 0:13:16.066021,used: 2:13:22.831492,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_02_04_24_seed_2_21520748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.97387296, 'precision': 0.9768289, 'recall': 0.87185556, 'specificity': 0.87185556, 'f1': 0.9162635, 'auroc': 0.9784198, 'binary_precision': 0.98029554, 'binary_recall': 0.74531835, 'binary_specificity': 0.99839276, 'binary_f1_score': 0.8468085}
confusion matrix:
       0     1
0  42241    68
1   1156  3383
---- Validation: 
scalar performance:
{'acc': 0.9682523, 'precision': 0.7492894, 'recall': 0.54593885, 'specificity': 0.54593885, 'f1': 0.5721918, 'auroc': 0.70608413, 'binary_precision': 0.5277778, 'binary_recall': 0.094684385, 'binary_specificity': 0.99719334, 'binary_f1_score': 0.16056338}
confusion matrix:
       0   1
0  18120  51
1    545  57
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96281457, 'precision': 0.77931976, 'recall': 0.56428146, 'specificity': 0.56428146, 'f1': 0.59858584, 'auroc': 0.72855437, 'binary_precision': 0.5925926, 'binary_recall': 0.1322314, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.2162162}
confusion matrix:
      0   1
0  5975  22
1   210  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520748_11.png
early stop counter: 1
val acc:0.9682523012161255, best validation acc: 0.9688382148742676, corresponding to test acc:                         0.9632954001426697 / 0.9632954001426697
after epoch: 11,now: 2024-06-22 04:30:49.859473,epoch time: 0:13:02.796206,used: 2:26:25.627698,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_02_04_24_seed_2_21520748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.97645575, 'precision': 0.97753906, 'recall': 0.8859712, 'specificity': 0.8859712, 'f1': 0.9256947, 'auroc': 0.9821209, 'binary_precision': 0.9788183, 'binary_recall': 0.7737387, 'binary_specificity': 0.9982037, 'binary_f1_score': 0.8642795}
confusion matrix:
       0     1
0  42233    76
1   1027  3512
---- Validation: 
scalar performance:
{'acc': 0.9685719, 'precision': 0.75510067, 'recall': 0.5685893, 'specificity': 0.5685893, 'f1': 0.60382277, 'auroc': 0.7354938, 'binary_precision': 0.53797466, 'binary_recall': 0.14119601, 'binary_specificity': 0.9959826, 'binary_f1_score': 0.2236842}
confusion matrix:
       0   1
0  18098  73
1    517  85
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.962494, 'precision': 0.7675761, 'recall': 0.56609744, 'specificity': 0.56609744, 'f1': 0.6003925, 'auroc': 0.7614296, 'binary_precision': 0.5689655, 'binary_recall': 0.13636364, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.22}
confusion matrix:
      0   1
0  5972  25
1   209  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520748_12.png
early stop counter: 2
val acc:0.9685719013214111, best validation acc: 0.9688382148742676, corresponding to test acc:                         0.9632954001426697 / 0.9632954001426697
after epoch: 12,now: 2024-06-22 04:43:53.243009,epoch time: 0:13:03.383536,used: 2:39:29.011234,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_02_04_24_seed_2_21520748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9766265, 'precision': 0.978263, 'recall': 0.8863359, 'specificity': 0.8863359, 'f1': 0.92620075, 'auroc': 0.98267996, 'binary_precision': 0.9801953, 'binary_recall': 0.7743499, 'binary_specificity': 0.9983219, 'binary_f1_score': 0.8651976}
confusion matrix:
       0     1
0  42239    71
1   1024  3514
---- Validation: 
scalar performance:
{'acc': 0.9685186, 'precision': 0.7513077, 'recall': 0.5790014, 'specificity': 0.5790014, 'f1': 0.61648464, 'auroc': 0.7469448, 'binary_precision': 0.5297297, 'binary_recall': 0.1627907, 'binary_specificity': 0.99521214, 'binary_f1_score': 0.24904703}
confusion matrix:
       0   1
0  18084  87
1    504  98
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96473795, 'precision': 0.8317983, 'recall': 0.57916117, 'specificity': 0.57916117, 'f1': 0.6218413, 'auroc': 0.7757544, 'binary_precision': 0.6964286, 'binary_recall': 0.16115703, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.26174498}
confusion matrix:
      0   1
0  5980  17
1   203  39
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520748_13.png
new oracle model saved
early stop counter: 3
val acc:0.9685186147689819, best validation acc: 0.9688382148742676, corresponding to test acc:                         0.9632954001426697 / 0.9647379517555237
after epoch: 13,now: 2024-06-22 04:57:02.249601,epoch time: 0:13:09.006592,used: 2:52:38.017826,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_02_04_24_seed_2_21520748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9778859, 'precision': 0.9776479, 'recall': 0.89399385, 'specificity': 0.89399385, 'f1': 0.93080103, 'auroc': 0.9838573, 'binary_precision': 0.9773657, 'binary_recall': 0.7899493, 'binary_specificity': 0.99803835, 'binary_f1_score': 0.87372017}
confusion matrix:
       0     1
0  42228    83
1    953  3584
---- Validation: 
scalar performance:
{'acc': 0.9685719, 'precision': 0.75164723, 'recall': 0.58545333, 'specificity': 0.58545333, 'f1': 0.62414104, 'auroc': 0.7449467, 'binary_precision': 0.53, 'binary_recall': 0.17607974, 'binary_specificity': 0.9948269, 'binary_f1_score': 0.26433915}
confusion matrix:
       0    1
0  18077   94
1    496  106
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96602017, 'precision': 0.82856894, 'recall': 0.611552, 'specificity': 0.611552, 'f1': 0.6620875, 'auroc': 0.76868826, 'binary_precision': 0.6875, 'binary_recall': 0.22727273, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.3416149}
confusion matrix:
      0   1
0  5972  25
1   187  55
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520748_14.png
new oracle model saved
early stop counter: 4
val acc:0.9685719013214111, best validation acc: 0.9688382148742676, corresponding to test acc:                         0.9632954001426697 / 0.9660201668739319
after epoch: 14,now: 2024-06-22 05:10:10.338716,epoch time: 0:13:08.089115,used: 3:05:46.106941,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_02_04_24_seed_2_21520748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.97841954, 'precision': 0.9822378, 'recall': 0.89335215, 'specificity': 0.89335215, 'f1': 0.9321642, 'auroc': 0.984649, 'binary_precision': 0.98675495, 'binary_recall': 0.78783876, 'binary_specificity': 0.9988655, 'binary_f1_score': 0.87614846}
confusion matrix:
       0     1
0  42261    48
1    963  3576
---- Validation: 
scalar performance:
{'acc': 0.968998, 'precision': 0.7690394, 'recall': 0.5696125, 'specificity': 0.5696125, 'f1': 0.606149, 'auroc': 0.73740405, 'binary_precision': 0.56578946, 'binary_recall': 0.14285715, 'binary_specificity': 0.9963678, 'binary_f1_score': 0.22811674}
confusion matrix:
       0   1
0  18105  66
1    516  86
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645777, 'precision': 0.81714165, 'recall': 0.58502597, 'specificity': 0.58502597, 'f1': 0.6286275, 'auroc': 0.75588346, 'binary_precision': 0.6666667, 'binary_recall': 0.17355372, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.27540985}
confusion matrix:
      0   1
0  5976  21
1   200  42
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520748_15.png
better model found
persisted
after epoch: 15,now: 2024-06-22 05:25:25.374184,epoch time: 0:15:15.035468,used: 3:21:01.142409,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_02_04_24_seed_2_21520748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.97933745, 'precision': 0.9800414, 'recall': 0.90035063, 'specificity': 0.90035063, 'f1': 0.935683, 'auroc': 0.9832283, 'binary_precision': 0.980878, 'binary_recall': 0.80237937, 'binary_specificity': 0.9983219, 'binary_f1_score': 0.8826951}
confusion matrix:
       0     1
0  42238    71
1    897  3642
---- Validation: 
scalar performance:
{'acc': 0.9683588, 'precision': 0.7468263, 'recall': 0.58132803, 'specificity': 0.58132803, 'f1': 0.6188028, 'auroc': 0.7416634, 'binary_precision': 0.52061856, 'binary_recall': 0.16777408, 'binary_specificity': 0.9948819, 'binary_f1_score': 0.25376883}
confusion matrix:
       0    1
0  18078   93
1    501  101
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9648982, 'precision': 0.79948485, 'recall': 0.6129511, 'specificity': 0.6129511, 'f1': 0.6601697, 'auroc': 0.7625261, 'binary_precision': 0.6292135, 'binary_recall': 0.23140496, 'binary_specificity': 0.99449724, 'binary_f1_score': 0.33836856}
confusion matrix:
      0   1
0  5964  33
1   186  56
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520748_16.png
early stop counter: 1
val acc:0.9683588147163391, best validation acc: 0.9689980149269104, corresponding to test acc:                         0.9645776748657227 / 0.9660201668739319
after epoch: 16,now: 2024-06-22 05:42:58.240611,epoch time: 0:17:32.866427,used: 3:38:34.008836,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_02_04_24_seed_2_21520748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98008454, 'precision': 0.9767341, 'recall': 0.9074513, 'specificity': 0.9074513, 'f1': 0.93868566, 'auroc': 0.9855348, 'binary_precision': 0.97273207, 'binary_recall': 0.81736064, 'binary_specificity': 0.9975419, 'binary_f1_score': 0.88830364}
confusion matrix:
       0     1
0  42205   104
1    829  3710
---- Validation: 
scalar performance:
{'acc': 0.9680925, 'precision': 0.7401655, 'recall': 0.6020697, 'specificity': 0.6020697, 'f1': 0.64072394, 'auroc': 0.76014924, 'binary_precision': 0.5059761, 'binary_recall': 0.21096346, 'binary_specificity': 0.9931759, 'binary_f1_score': 0.29777256}
confusion matrix:
       0    1
0  18047  124
1    475  127
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96666133, 'precision': 0.82980794, 'recall': 0.62576467, 'specificity': 0.62576467, 'f1': 0.6781845, 'auroc': 0.77400905, 'binary_precision': 0.6888889, 'binary_recall': 0.25619835, 'binary_specificity': 0.995331, 'binary_f1_score': 0.37349397}
confusion matrix:
      0   1
0  5969  28
1   180  62
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520748_17.png
new oracle model saved
early stop counter: 2
val acc:0.9680925011634827, best validation acc: 0.9689980149269104, corresponding to test acc:                         0.9645776748657227 / 0.9666613340377808
after epoch: 17,now: 2024-06-22 05:59:17.294762,epoch time: 0:16:19.054151,used: 3:54:53.062987,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_02_04_24_seed_2_21520748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98160005, 'precision': 0.97991776, 'recall': 0.9134039, 'specificity': 0.9134039, 'f1': 0.9435527, 'auroc': 0.98599803, 'binary_precision': 0.97790486, 'binary_recall': 0.8288169, 'binary_specificity': 0.99799097, 'binary_f1_score': 0.89720964}
confusion matrix:
       0     1
0  42224    85
1    777  3762
---- Validation: 
scalar performance:
{'acc': 0.9684653, 'precision': 0.7493245, 'recall': 0.58298916, 'specificity': 0.58298916, 'f1': 0.6210178, 'auroc': 0.7498197, 'binary_precision': 0.5255102, 'binary_recall': 0.17109634, 'binary_specificity': 0.9948819, 'binary_f1_score': 0.25814536}
confusion matrix:
       0    1
0  18078   93
1    499  103
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9656996, 'precision': 0.816362, 'recall': 0.6153507, 'specificity': 0.6153507, 'f1': 0.6649739, 'auroc': 0.7604959, 'binary_precision': 0.6627907, 'binary_recall': 0.23553719, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.347561}
confusion matrix:
      0   1
0  5968  29
1   185  57
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520748_18.png
early stop counter: 3
val acc:0.9684653282165527, best validation acc: 0.9689980149269104, corresponding to test acc:                         0.9645776748657227 / 0.9666613340377808
after epoch: 18,now: 2024-06-22 06:19:40.321432,epoch time: 0:20:23.026670,used: 4:15:16.089657,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_02_04_24_seed_2_21520748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.982027, 'precision': 0.98065394, 'recall': 0.9152137, 'specificity': 0.9152137, 'f1': 0.9449334, 'auroc': 0.9881321, 'binary_precision': 0.9790101, 'binary_recall': 0.8323419, 'binary_specificity': 0.9980855, 'binary_f1_score': 0.899738}
confusion matrix:
       0     1
0  42228    81
1    761  3778
---- Validation: 
scalar performance:
{'acc': 0.9684653, 'precision': 0.74794257, 'recall': 0.59583795, 'specificity': 0.59583795, 'f1': 0.6353116, 'auroc': 0.76349056, 'binary_precision': 0.5219298, 'binary_recall': 0.19767442, 'binary_specificity': 0.99400145, 'binary_f1_score': 0.28674698}
confusion matrix:
       0    1
0  18062  109
1    483  119
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96826416, 'precision': 0.855412, 'recall': 0.63849485, 'specificity': 0.63849485, 'f1': 0.69544065, 'auroc': 0.77382016, 'binary_precision': 0.73913044, 'binary_recall': 0.28099173, 'binary_specificity': 0.995998, 'binary_f1_score': 0.4071856}
confusion matrix:
      0   1
0  5973  24
1   174  68
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520748_19.png
new oracle model saved
early stop counter: 4
val acc:0.9684653282165527, best validation acc: 0.9689980149269104, corresponding to test acc:                         0.9645776748657227 / 0.9682641625404358
after epoch: 19,now: 2024-06-22 06:46:29.349287,epoch time: 0:26:49.027855,used: 4:42:05.117512,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_02_04_24_seed_2_21520748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.98160005, 'precision': 0.97856784, 'recall': 0.91456544, 'specificity': 0.91456544, 'f1': 0.9436859, 'auroc': 0.9888823, 'binary_precision': 0.9749354, 'binary_recall': 0.8314235, 'binary_specificity': 0.9977074, 'binary_f1_score': 0.8974786}
confusion matrix:
       0     1
0  42213    97
1    765  3773
---- Validation: 
scalar performance:
{'acc': 0.9685719, 'precision': 0.75044143, 'recall': 0.59428686, 'specificity': 0.59428686, 'f1': 0.63395697, 'auroc': 0.7663574, 'binary_precision': 0.527027, 'binary_recall': 0.19435216, 'binary_specificity': 0.99422157, 'binary_f1_score': 0.28398058}
confusion matrix:
       0    1
0  18066  105
1    485  117
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96714216, 'precision': 0.84169245, 'recall': 0.6260148, 'specificity': 0.6260148, 'f1': 0.6800129, 'auroc': 0.7729617, 'binary_precision': 0.7126437, 'binary_recall': 0.25619835, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.3768997}
confusion matrix:
      0   1
0  5972  25
1   180  62
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520748_20.png
early stop counter: 5
val acc:0.9685719013214111, best validation acc: 0.9689980149269104, corresponding to test acc:                         0.9645776748657227 / 0.9682641625404358
after epoch: 20,now: 2024-06-22 07:18:02.653330,epoch time: 0:31:33.304043,used: 5:13:38.421555,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_02_04_24_seed_2_21520748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9826673, 'precision': 0.980966, 'recall': 0.9186168, 'specificity': 0.9186168, 'f1': 0.94707716, 'auroc': 0.9876192, 'binary_precision': 0.9789257, 'binary_recall': 0.83917165, 'binary_specificity': 0.9980619, 'binary_f1_score': 0.90367734}
confusion matrix:
       0     1
0  42227    82
1    730  3809
---- Validation: 
scalar performance:
{'acc': 0.9684653, 'precision': 0.7477381, 'recall': 0.59824705, 'specificity': 0.59824705, 'f1': 0.63786983, 'auroc': 0.7620269, 'binary_precision': 0.52136755, 'binary_recall': 0.2026578, 'binary_specificity': 0.99383634, 'binary_f1_score': 0.29186603}
confusion matrix:
       0    1
0  18059  112
1    480  122
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9679436, 'precision': 0.84313864, 'recall': 0.6422936, 'specificity': 0.6422936, 'f1': 0.69764376, 'auroc': 0.77066493, 'binary_precision': 0.71428573, 'binary_recall': 0.2892562, 'binary_specificity': 0.995331, 'binary_f1_score': 0.41176468}
confusion matrix:
      0   1
0  5969  28
1   172  70
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520748_21.png
early stop counter: 6
val acc:0.9684653282165527, best validation acc: 0.9689980149269104, corresponding to test acc:                         0.9645776748657227 / 0.9682641625404358
after epoch: 21,now: 2024-06-22 07:50:48.902066,epoch time: 0:32:46.248736,used: 5:46:24.670291,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_02_04_24_seed_2_21520748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.982582, 'precision': 0.9776071, 'recall': 0.9211263, 'specificity': 0.9211263, 'f1': 0.9471327, 'auroc': 0.9889213, 'binary_precision': 0.971624, 'binary_recall': 0.8448998, 'binary_specificity': 0.99735284, 'binary_f1_score': 0.9038417}
confusion matrix:
       0     1
0  42197   112
1    704  3835
---- Validation: 
scalar performance:
{'acc': 0.9678794, 'precision': 0.7366504, 'recall': 0.61320233, 'specificity': 0.61320233, 'f1': 0.651098, 'auroc': 0.7857884, 'binary_precision': 0.49823323, 'binary_recall': 0.23421927, 'binary_specificity': 0.99218535, 'binary_f1_score': 0.31864405}
confusion matrix:
       0    1
0  18029  142
1    461  141
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.968745, 'precision': 0.8463591, 'recall': 0.6565896, 'specificity': 0.6565896, 'f1': 0.71259177, 'auroc': 0.7951882, 'binary_precision': 0.7196262, 'binary_recall': 0.3181818, 'binary_specificity': 0.9949975, 'binary_f1_score': 0.44126076}
confusion matrix:
      0   1
0  5967  30
1   165  77
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520748_22.png
new oracle model saved
early stop counter: 7
val acc:0.9678794145584106, best validation acc: 0.9689980149269104, corresponding to test acc:                         0.9645776748657227 / 0.9687449932098389
after epoch: 22,now: 2024-06-22 08:22:42.252462,epoch time: 0:31:53.350396,used: 6:18:18.020687,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_02_04_24_seed_2_21520748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9831796, 'precision': 0.978783, 'recall': 0.9235223, 'specificity': 0.9235223, 'f1': 0.9490224, 'auroc': 0.99043584, 'binary_precision': 0.97349155, 'binary_recall': 0.84952635, 'binary_specificity': 0.99751824, 'binary_f1_score': 0.90729415}
confusion matrix:
       0     1
0  42204   105
1    683  3856
---- Validation: 
scalar performance:
{'acc': 0.968199, 'precision': 0.74206525, 'recall': 0.61176133, 'specificity': 0.61176133, 'f1': 0.65071714, 'auroc': 0.78790677, 'binary_precision': 0.50915754, 'binary_recall': 0.23089701, 'binary_specificity': 0.9926256, 'binary_f1_score': 0.31771427}
confusion matrix:
       0    1
0  18037  134
1    463  139
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96890527, 'precision': 0.86116314, 'recall': 0.64675933, 'specificity': 0.64675933, 'f1': 0.7050277, 'auroc': 0.79788303, 'binary_precision': 0.75, 'binary_recall': 0.29752067, 'binary_specificity': 0.995998, 'binary_f1_score': 0.42603552}
confusion matrix:
      0   1
0  5973  24
1   170  72
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520748_23.png
new oracle model saved
early stop counter: 8
val acc:0.9681990146636963, best validation acc: 0.9689980149269104, corresponding to test acc:                         0.9645776748657227 / 0.9689052700996399
after epoch: 23,now: 2024-06-22 08:55:24.824184,epoch time: 0:32:42.571722,used: 6:51:00.592409,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_02_04_24_seed_2_21520748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9835425, 'precision': 0.9794607, 'recall': 0.9249691, 'specificity': 0.9249691, 'f1': 0.9501486, 'auroc': 0.9892101, 'binary_precision': 0.9745464, 'binary_recall': 0.8523253, 'binary_specificity': 0.9976129, 'binary_f1_score': 0.9093475}
confusion matrix:
       0     1
0  42210   101
1    670  3867
---- Validation: 
scalar performance:
{'acc': 0.9678261, 'precision': 0.7354224, 'recall': 0.6059474, 'specificity': 0.6059474, 'f1': 0.6438399, 'auroc': 0.78692377, 'binary_precision': 0.49624062, 'binary_recall': 0.2192691, 'binary_specificity': 0.9926256, 'binary_f1_score': 0.30414745}
confusion matrix:
       0    1
0  18037  134
1    470  132
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9685847, 'precision': 0.85350555, 'recall': 0.64659256, 'specificity': 0.64659256, 'f1': 0.7036909, 'auroc': 0.7958987, 'binary_precision': 0.7346939, 'binary_recall': 0.29752067, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.42352942}
confusion matrix:
      0   1
0  5971  26
1   170  72
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520748_24.png
early stop counter: 9
val acc:0.9678261280059814, best validation acc: 0.9689980149269104, corresponding to test acc:                         0.9645776748657227 / 0.9689052700996399
after epoch: 24,now: 2024-06-22 09:30:54.379463,epoch time: 0:35:29.555279,used: 7:26:30.147688,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_02_04_24_seed_2_21520748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.98446035, 'precision': 0.97682905, 'recall': 0.932758, 'specificity': 0.932758, 'f1': 0.95344555, 'auroc': 0.99045694, 'binary_precision': 0.96759146, 'binary_recall': 0.86863565, 'binary_specificity': 0.99688023, 'binary_f1_score': 0.9154471}
confusion matrix:
       0     1
0  42179   132
1    596  3941
---- Validation: 
scalar performance:
{'acc': 0.9681457, 'precision': 0.7411418, 'recall': 0.6189612, 'specificity': 0.6189612, 'f1': 0.6573903, 'auroc': 0.79061735, 'binary_precision': 0.5068493, 'binary_recall': 0.24584718, 'binary_specificity': 0.99207526, 'binary_f1_score': 0.3310962}
confusion matrix:
       0    1
0  18027  144
1    454  148
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96714216, 'precision': 0.82749164, 'recall': 0.639894, 'specificity': 0.639894, 'f1': 0.6927196, 'auroc': 0.79381704, 'binary_precision': 0.6831683, 'binary_recall': 0.28512397, 'binary_specificity': 0.994664, 'binary_f1_score': 0.40233237}
confusion matrix:
      0   1
0  5965  32
1   173  69
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520748_25.png
early stop counter: 10
val acc:0.9681457281112671, best validation acc: 0.9689980149269104, corresponding to test acc:                         0.9645776748657227 / 0.9689052700996399
after epoch: 25,now: 2024-06-22 10:14:18.159257,epoch time: 0:43:23.779794,used: 8:09:53.927482,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_02_04_24_seed_2_21520748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9845244, 'precision': 0.97928953, 'recall': 0.9308555, 'specificity': 0.9308555, 'f1': 0.9534478, 'auroc': 0.9909071, 'binary_precision': 0.97296625, 'binary_recall': 0.8642873, 'binary_specificity': 0.9974237, 'binary_f1_score': 0.9154125}
confusion matrix:
       0     1
0  42200   109
1    616  3923
---- Validation: 
scalar performance:
{'acc': 0.9679859, 'precision': 0.7382547, 'recall': 0.60602987, 'specificity': 0.60602987, 'f1': 0.6444089, 'auroc': 0.7931613, 'binary_precision': 0.50190115, 'binary_recall': 0.2192691, 'binary_specificity': 0.9927907, 'binary_f1_score': 0.3052023}
confusion matrix:
       0    1
0  18040  131
1    470  132
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9681039, 'precision': 0.84466076, 'recall': 0.6443597, 'specificity': 0.6443597, 'f1': 0.70001304, 'auroc': 0.7927648, 'binary_precision': 0.7171717, 'binary_recall': 0.29338843, 'binary_specificity': 0.995331, 'binary_f1_score': 0.41642228}
confusion matrix:
      0   1
0  5969  28
1   171  71
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520748_26.png
early stop counter: 11
val acc:0.9679859280586243, best validation acc: 0.9689980149269104, corresponding to test acc:                         0.9645776748657227 / 0.9689052700996399
after epoch: 26,now: 2024-06-22 10:31:04.790510,epoch time: 0:16:46.631253,used: 8:26:40.558735,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_02_04_24_seed_2_21520748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.98420423, 'precision': 0.9801334, 'recall': 0.92820424, 'specificity': 0.92820424, 'f1': 0.95229936, 'auroc': 0.9887289, 'binary_precision': 0.9752252, 'binary_recall': 0.8587484, 'binary_specificity': 0.9976601, 'binary_f1_score': 0.91328806}
confusion matrix:
       0     1
0  42211    99
1    641  3897
---- Validation: 
scalar performance:
{'acc': 0.9686251, 'precision': 0.7501838, 'recall': 0.60716313, 'specificity': 0.60716313, 'f1': 0.64752907, 'auroc': 0.7937834, 'binary_precision': 0.5256917, 'binary_recall': 0.22093023, 'binary_specificity': 0.99339604, 'binary_f1_score': 0.31111112}
confusion matrix:
       0    1
0  18051  120
1    469  133
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96842444, 'precision': 0.8520588, 'recall': 0.6445265, 'specificity': 0.6445265, 'f1': 0.7013252, 'auroc': 0.80517066, 'binary_precision': 0.73195875, 'binary_recall': 0.29338843, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.418879}
confusion matrix:
      0   1
0  5971  26
1   171  71
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520748_27.png
early stop counter: 12
val acc:0.9686251282691956, best validation acc: 0.9689980149269104, corresponding to test acc:                         0.9645776748657227 / 0.9689052700996399
after epoch: 27,now: 2024-06-22 10:44:32.797790,epoch time: 0:13:28.007280,used: 8:40:08.566015,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_02_04_24_seed_2_21520748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.984375, 'precision': 0.9802501, 'recall': 0.9290857, 'specificity': 0.9290857, 'f1': 0.9528548, 'auroc': 0.98971236, 'binary_precision': 0.97527474, 'binary_recall': 0.86051124, 'binary_specificity': 0.9976601, 'binary_f1_score': 0.9143058}
confusion matrix:
       0     1
0  42211    99
1    633  3905
---- Validation: 
scalar performance:
{'acc': 0.9686251, 'precision': 0.75152814, 'recall': 0.59511745, 'specificity': 0.59511745, 'f1': 0.63501036, 'auroc': 0.78487396, 'binary_precision': 0.529148, 'binary_recall': 0.19601329, 'binary_specificity': 0.99422157, 'binary_f1_score': 0.2860606}
confusion matrix:
       0    1
0  18066  105
1    484  118
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9677833, 'precision': 0.84832376, 'recall': 0.63427925, 'specificity': 0.63427925, 'f1': 0.68992317, 'auroc': 0.78505164, 'binary_precision': 0.72527474, 'binary_recall': 0.27272728, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.39639637}
confusion matrix:
      0   1
0  5972  25
1   176  66
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520748_28.png
early stop counter: 13
val acc:0.9686251282691956, best validation acc: 0.9689980149269104, corresponding to test acc:                         0.9645776748657227 / 0.9689052700996399
after epoch: 28,now: 2024-06-22 10:58:01.674332,epoch time: 0:13:28.876542,used: 8:53:37.442557,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_02_04_24_seed_2_21520748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9860186, 'precision': 0.98105526, 'recall': 0.93786466, 'specificity': 0.93786466, 'f1': 0.95817924, 'auroc': 0.9919454, 'binary_precision': 0.9750428, 'binary_recall': 0.87814015, 'binary_specificity': 0.99758923, 'binary_f1_score': 0.92405796}
confusion matrix:
       0     1
0  42208   102
1    553  3985
---- Validation: 
scalar performance:
{'acc': 0.9680925, 'precision': 0.7401698, 'recall': 0.6036758, 'specificity': 0.6036758, 'f1': 0.6423619, 'auroc': 0.79206705, 'binary_precision': 0.5058824, 'binary_recall': 0.21428572, 'binary_specificity': 0.9930659, 'binary_f1_score': 0.3010502}
confusion matrix:
       0    1
0  18045  126
1    473  129
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9681039, 'precision': 0.84907913, 'recall': 0.6403942, 'specificity': 0.6403942, 'f1': 0.6965524, 'auroc': 0.7899795, 'binary_precision': 0.7263158, 'binary_recall': 0.28512397, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.40949556}
confusion matrix:
      0   1
0  5971  26
1   173  69
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520748_29.png
early stop counter: 14
val acc:0.9680925011634827, best validation acc: 0.9689980149269104, corresponding to test acc:                         0.9645776748657227 / 0.9689052700996399
after epoch: 29,now: 2024-06-22 11:11:29.594198,epoch time: 0:13:27.919866,used: 9:07:05.362423,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_02_04_24_seed_2_21520748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9840975, 'precision': 0.9812556, 'recall': 0.9265872, 'specificity': 0.9265872, 'f1': 0.95185006, 'auroc': 0.9912536, 'binary_precision': 0.97783375, 'binary_recall': 0.8552545, 'binary_specificity': 0.99792004, 'binary_f1_score': 0.91244566}
confusion matrix:
       0     1
0  42221    88
1    657  3882
---- Validation: 
scalar performance:
{'acc': 0.9688915, 'precision': 0.75667626, 'recall': 0.60007334, 'specificity': 0.60007334, 'f1': 0.64108515, 'auroc': 0.7876117, 'binary_precision': 0.53913045, 'binary_recall': 0.20598006, 'binary_specificity': 0.99416655, 'binary_f1_score': 0.29807693}
confusion matrix:
       0    1
0  18065  106
1    478  124
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96842444, 'precision': 0.85947543, 'recall': 0.63857824, 'specificity': 0.63857824, 'f1': 0.69609386, 'auroc': 0.78714156, 'binary_precision': 0.74725276, 'binary_recall': 0.28099173, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.4084084}
confusion matrix:
      0   1
0  5974  23
1   174  68
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520748_30.png
early stop counter: 15
val acc:0.9688915014266968, best validation acc: 0.9689980149269104, corresponding to test acc:                         0.9645776748657227 / 0.9689052700996399
after epoch: 30,now: 2024-06-22 11:24:50.224862,epoch time: 0:13:20.630664,used: 9:20:25.993087,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_02_04_24_seed_2_21520748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 9:20:25.993087 at 2024-06-22 11:24:50.224862
persisted model performance metric: 

scalar performance:
{'acc': 0.9645777, 'precision': 0.81714165, 'recall': 0.58502597, 'specificity': 0.58502597, 'f1': 0.6286275, 'auroc': 0.75588346, 'binary_precision': 0.6666667, 'binary_recall': 0.17355372, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.27540985}
confusion matrix:
      0   1
0  5976  21
1   200  42
oracle model performance metric: 

scalar performance:
{'acc': 0.96890527, 'precision': 0.86116314, 'recall': 0.64675933, 'specificity': 0.64675933, 'f1': 0.7050277, 'auroc': 0.79788303, 'binary_precision': 0.75, 'binary_recall': 0.29752067, 'binary_specificity': 0.995998, 'binary_f1_score': 0.42603552}
confusion matrix:
      0   1
0  5973  24
1   170  72
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_differentbatchsizes_lre5_classbalancing3/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_resnet_differentbatchsizes_lre5_classbalancing3/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204097 KiB |   1056 MiB |   1219 TiB |   1219 TiB |
|       from large pool | 167936 KiB |    986 MiB |   1218 TiB |   1218 TiB |
|       from small pool |  36161 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 204097 KiB |   1056 MiB |   1219 TiB |   1219 TiB |
|       from large pool | 167936 KiB |    986 MiB |   1218 TiB |   1218 TiB |
|       from small pool |  36161 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201087 KiB |   1049 MiB |   1219 TiB |   1219 TiB |
|       from large pool | 165120 KiB |    980 MiB |   1218 TiB |   1218 TiB |
|       from small pool |  35967 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1212 MiB |   1250 MiB |   2878 MiB |   1666 MiB |
|       from large pool |   1140 MiB |   1178 MiB |   2746 MiB |   1606 MiB |
|       from small pool |     72 MiB |     72 MiB |    132 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 203454 KiB | 459294 KiB |    947 TiB |    947 TiB |
|       from large pool | 196608 KiB | 458268 KiB |    947 TiB |    947 TiB |
|       from small pool |   6846 KiB |  14444 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    1488    |    2213    |   67054 K  |   67053 K  |
|       from large pool |      36    |      76    |   22053 K  |   22053 K  |
|       from small pool |    1452    |    2176    |   45000 K  |   44999 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1488    |    2213    |   67054 K  |   67053 K  |
|       from large pool |      36    |      76    |   22053 K  |   22053 K  |
|       from small pool |    1452    |    2176    |   45000 K  |   44999 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      49    |      50    |      88    |      39    |
|       from large pool |      13    |      14    |      22    |       9    |
|       from small pool |      36    |      36    |      66    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      33    |     744    |   27577 K  |   27577 K  |
|       from large pool |       5    |      11    |    8479 K  |    8479 K  |
|       from small pool |      28    |     739    |   19098 K  |   19098 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1056 MiB |   1219 TiB |   1219 TiB |
|       from large pool |  16640 KiB |    986 MiB |   1218 TiB |   1218 TiB |
|       from small pool |      0 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1056 MiB |   1219 TiB |   1219 TiB |
|       from large pool |  16640 KiB |    986 MiB |   1218 TiB |   1218 TiB |
|       from small pool |      0 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1049 MiB |   1219 TiB |   1219 TiB |
|       from large pool |  16640 KiB |    980 MiB |   1218 TiB |   1218 TiB |
|       from small pool |      0 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 407552 KiB |   1250 MiB |   2878 MiB |   2480 MiB |
|       from large pool | 364544 KiB |   1178 MiB |   2746 MiB |   2390 MiB |
|       from small pool |  43008 KiB |     72 MiB |    132 MiB |     90 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 184064 KiB | 459294 KiB |    947 TiB |    947 TiB |
|       from large pool | 184064 KiB | 458268 KiB |    947 TiB |    947 TiB |
|       from small pool |      0 KiB |  14444 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2213    |   67054 K  |   67054 K  |
|       from large pool |       2    |      76    |   22053 K  |   22053 K  |
|       from small pool |       0    |    2176    |   45000 K  |   45000 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2213    |   67054 K  |   67054 K  |
|       from large pool |       2    |      76    |   22053 K  |   22053 K  |
|       from small pool |       0    |    2176    |   45000 K  |   45000 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      30    |      50    |      88    |      58    |
|       from large pool |       9    |      14    |      22    |      13    |
|       from small pool |      21    |      36    |      66    |      45    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     744    |   27577 K  |   27577 K  |
|       from large pool |       1    |      11    |    8479 K  |    8479 K  |
|       from small pool |       0    |     739    |   19098 K  |   19098 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

