Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0




!!!: not committed yet



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_11_32_25_seed_0_21546986

 Experiment start at: 2024-06-22 11:32:25.406885
before training, model accuracy: 0.31128156185150146
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.99101025, 'precision': 0.9745614, 'recall': 0.97282815, 'specificity': 0.97282815, 'f1': 0.9736928, 'auroc': 0.9970457, 'binary_precision': 0.9542974, 'binary_recall': 0.9504076, 'binary_specificity': 0.9952487, 'binary_f1_score': 0.9523486}
confusion matrix:
       0     1
0  42103   201
1    219  4197
---- Validation: 
scalar performance:
{'acc': 0.9556726, 'precision': 0.67335933, 'recall': 0.69278014, 'specificity': 0.69278014, 'f1': 0.6824768, 'auroc': 0.83425194, 'binary_precision': 0.36768803, 'binary_recall': 0.41057542, 'binary_specificity': 0.9749848, 'binary_f1_score': 0.38795003}
confusion matrix:
       0    1
0  17695  454
1    379  264
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9496644, 'precision': 0.6863142, 'recall': 0.68972516, 'specificity': 0.68972516, 'f1': 0.6880015, 'auroc': 0.8166468, 'binary_precision': 0.39849624, 'binary_recall': 0.40613025, 'binary_specificity': 0.97332, 'binary_f1_score': 0.40227705}
confusion matrix:
      0    1
0  5837  160
1   155  106
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546986_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-22 11:50:13.594224,epoch time: 0:17:48.187339,used: 0:17:48.187339,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_11_32_25_seed_0_21546986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9772046, 'precision': 0.9077625, 'recall': 0.97645324, 'specificity': 0.97645324, 'f1': 0.93860424, 'auroc': 0.9968169, 'binary_precision': 0.81813, 'binary_recall': 0.97552687, 'binary_specificity': 0.9773796, 'binary_f1_score': 0.8899225}
confusion matrix:
       0     1
0  41350   957
1    108  4305
---- Validation: 
scalar performance:
{'acc': 0.9447105, 'precision': 0.63912666, 'recall': 0.7081064, 'specificity': 0.7081064, 'f1': 0.66546756, 'auroc': 0.8548008, 'binary_precision': 0.29795918, 'binary_recall': 0.4541213, 'binary_specificity': 0.96209157, 'binary_f1_score': 0.3598275}
confusion matrix:
       0    1
0  17461  688
1    351  292
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9352828, 'precision': 0.61011136, 'recall': 0.62175435, 'specificity': 0.62175435, 'f1': 0.61556196, 'auroc': 0.76214594, 'binary_precision': 0.25172412, 'binary_recall': 0.27969348, 'binary_specificity': 0.9638152, 'binary_f1_score': 0.26497275}
confusion matrix:
      0    1
0  5780  217
1   188   73
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546986_2.png
early stop counter: 1
val acc:0.9447104930877686, best validation acc: 0.9556726217269897, corresponding to test acc:                         0.9496644139289856 / 0.9496644139289856
after epoch: 2,now: 2024-06-22 12:07:45.487745,epoch time: 0:17:31.893521,used: 0:35:20.080860,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_11_32_25_seed_0_21546986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9921875, 'precision': 0.98370993, 'recall': 0.9702076, 'specificity': 0.9702076, 'f1': 0.97683823, 'auroc': 0.99633837, 'binary_precision': 0.97333336, 'binary_recall': 0.9431097, 'binary_specificity': 0.99730545, 'binary_f1_score': 0.95798314}
confusion matrix:
       0     1
0  42194   114
1    251  4161
---- Validation: 
scalar performance:
{'acc': 0.96248406, 'precision': 0.6721369, 'recall': 0.567297, 'specificity': 0.567297, 'f1': 0.59388083, 'auroc': 0.7574209, 'binary_precision': 0.37398374, 'binary_recall': 0.14307931, 'binary_specificity': 0.9915147, 'binary_f1_score': 0.20697413}
confusion matrix:
       0    1
0  17995  154
1    551   92
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.957814, 'precision': 0.71898615, 'recall': 0.55288756, 'specificity': 0.55288756, 'f1': 0.5792371, 'auroc': 0.6978857, 'binary_precision': 0.47540984, 'binary_recall': 0.11111111, 'binary_specificity': 0.994664, 'binary_f1_score': 0.18012422}
confusion matrix:
      0   1
0  5965  32
1   232  29
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546986_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-22 12:25:43.385265,epoch time: 0:17:57.897520,used: 0:53:17.978380,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_11_32_25_seed_0_21546986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.99233735, 'precision': 0.9848136, 'recall': 0.9699988, 'specificity': 0.9699988, 'f1': 0.9772614, 'auroc': 0.9956739, 'binary_precision': 0.9756098, 'binary_recall': 0.9424558, 'binary_specificity': 0.9975417, 'binary_f1_score': 0.9587463}
confusion matrix:
       0     1
0  42202   104
1    254  4160
---- Validation: 
scalar performance:
{'acc': 0.96546406, 'precision': 0.71872616, 'recall': 0.5343372, 'specificity': 0.5343372, 'f1': 0.55327064, 'auroc': 0.74005675, 'binary_precision': 0.46938777, 'binary_recall': 0.071539655, 'binary_specificity': 0.9971348, 'binary_f1_score': 0.12415654}
confusion matrix:
       0   1
0  18097  52
1    597  46
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95637584, 'precision': 0.64665705, 'recall': 0.5209875, 'specificity': 0.5209875, 'f1': 0.5292329, 'auroc': 0.65044606, 'binary_precision': 0.33333334, 'binary_recall': 0.04597701, 'binary_specificity': 0.995998, 'binary_f1_score': 0.08080808}
confusion matrix:
      0   1
0  5973  24
1   249  12
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546986_4.png
better model found
persisted
after epoch: 4,now: 2024-06-22 12:43:55.917725,epoch time: 0:18:12.532460,used: 1:11:30.510840,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_11_32_25_seed_0_21546986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.991631, 'precision': 0.97650087, 'recall': 0.97446823, 'specificity': 0.97446823, 'f1': 0.9754818, 'auroc': 0.9964204, 'binary_precision': 0.95786834, 'binary_recall': 0.9533092, 'binary_specificity': 0.9956273, 'binary_f1_score': 0.95558333}
confusion matrix:
       0     1
0  42123   185
1    206  4206
---- Validation: 
scalar performance:
{'acc': 0.9600894, 'precision': 0.6757662, 'recall': 0.6208113, 'specificity': 0.6208113, 'f1': 0.64250493, 'auroc': 0.81571794, 'binary_precision': 0.37757438, 'binary_recall': 0.25660965, 'binary_specificity': 0.98501295, 'binary_f1_score': 0.30555558}
confusion matrix:
       0    1
0  17877  272
1    478  165
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94503033, 'precision': 0.5320657, 'recall': 0.5132355, 'specificity': 0.5132355, 'f1': 0.5158983, 'auroc': 0.57870376, 'binary_precision': 0.104761906, 'binary_recall': 0.042145595, 'binary_specificity': 0.98432547, 'binary_f1_score': 0.060109288}
confusion matrix:
      0   1
0  5903  94
1   250  11
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546986_5.png
early stop counter: 1
val acc:0.960089385509491, best validation acc: 0.9654640555381775, corresponding to test acc:                         0.9563758373260498 / 0.9578139781951904
after epoch: 5,now: 2024-06-22 13:00:52.140255,epoch time: 0:16:56.222530,used: 1:28:26.733370,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_11_32_25_seed_0_21546986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9911815, 'precision': 0.9729657, 'recall': 0.9756509, 'specificity': 0.9756509, 'f1': 0.9743035, 'auroc': 0.99647945, 'binary_precision': 0.9504728, 'binary_recall': 0.956502, 'binary_specificity': 0.9947998, 'binary_f1_score': 0.95347786}
confusion matrix:
       0     1
0  42086   220
1    192  4222
---- Validation: 
scalar performance:
{'acc': 0.9645594, 'precision': 0.71240413, 'recall': 0.58337253, 'specificity': 0.58337253, 'f1': 0.61676764, 'auroc': 0.7569115, 'binary_precision': 0.4534413, 'binary_recall': 0.17418352, 'binary_specificity': 0.9925616, 'binary_f1_score': 0.2516854}
confusion matrix:
       0    1
0  18014  135
1    531  112
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9480665, 'precision': 0.5391966, 'recall': 0.5129873, 'specificity': 0.5129873, 'f1': 0.51563406, 'auroc': 0.5957784, 'binary_precision': 0.11904762, 'binary_recall': 0.038314175, 'binary_specificity': 0.98766047, 'binary_f1_score': 0.057971016}
confusion matrix:
      0   1
0  5923  74
1   251  10
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546986_6.png
early stop counter: 2
val acc:0.9645593762397766, best validation acc: 0.9654640555381775, corresponding to test acc:                         0.9563758373260498 / 0.9578139781951904
after epoch: 6,now: 2024-06-22 13:17:46.667623,epoch time: 0:16:54.527368,used: 1:45:21.260738,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_11_32_25_seed_0_21546986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9886772, 'precision': 0.958792, 'recall': 0.97668624, 'specificity': 0.97668624, 'f1': 0.9675206, 'auroc': 0.9967222, 'binary_precision': 0.92157286, 'binary_recall': 0.96190476, 'binary_specificity': 0.9914677, 'binary_f1_score': 0.94130695}
confusion matrix:
       0     1
0  41949   361
1    168  4242
---- Validation: 
scalar performance:
{'acc': 0.9569498, 'precision': 0.63957375, 'recall': 0.594434, 'specificity': 0.594434, 'f1': 0.6119407, 'auroc': 0.77136254, 'binary_precision': 0.30697674, 'binary_recall': 0.20528771, 'binary_specificity': 0.98358035, 'binary_f1_score': 0.24603915}
confusion matrix:
       0    1
0  17851  298
1    511  132
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93256634, 'precision': 0.5234677, 'recall': 0.5177263, 'specificity': 0.5177263, 'f1': 0.5197848, 'auroc': 0.56898725, 'binary_precision': 0.08717949, 'binary_recall': 0.0651341, 'binary_specificity': 0.9703185, 'binary_f1_score': 0.0745614}
confusion matrix:
      0    1
0  5819  178
1   244   17
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546986_7.png
early stop counter: 3
val acc:0.956949770450592, best validation acc: 0.9654640555381775, corresponding to test acc:                         0.9563758373260498 / 0.9578139781951904
after epoch: 7,now: 2024-06-22 13:34:17.397051,epoch time: 0:16:30.729428,used: 2:01:51.990166,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_11_32_25_seed_0_21546986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.99253, 'precision': 0.98008955, 'recall': 0.97609115, 'specificity': 0.97609115, 'f1': 0.97807974, 'auroc': 0.9960536, 'binary_precision': 0.9647839, 'binary_recall': 0.9558224, 'binary_specificity': 0.9963598, 'binary_f1_score': 0.9602822}
confusion matrix:
       0     1
0  42152   154
1    195  4219
---- Validation: 
scalar performance:
{'acc': 0.96126014, 'precision': 0.6798132, 'recall': 0.6064163, 'specificity': 0.6064163, 'f1': 0.6324815, 'auroc': 0.7802811, 'binary_precision': 0.38666666, 'binary_recall': 0.22550544, 'binary_specificity': 0.9873271, 'binary_f1_score': 0.28487226}
confusion matrix:
       0    1
0  17919  230
1    498  145
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9490253, 'precision': 0.5726054, 'recall': 0.5263139, 'specificity': 0.5263139, 'f1': 0.5350451, 'auroc': 0.687881, 'binary_precision': 0.18478261, 'binary_recall': 0.0651341, 'binary_specificity': 0.98749375, 'binary_f1_score': 0.096317284}
confusion matrix:
      0   1
0  5922  75
1   244  17
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546986_8.png
early stop counter: 4
val acc:0.9612601399421692, best validation acc: 0.9654640555381775, corresponding to test acc:                         0.9563758373260498 / 0.9578139781951904
after epoch: 8,now: 2024-06-22 13:50:51.879670,epoch time: 0:16:34.482619,used: 2:18:26.472785,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_11_32_25_seed_0_21546986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9928296, 'precision': 0.9828948, 'recall': 0.9749429, 'specificity': 0.9749429, 'f1': 0.9788772, 'auroc': 0.99606276, 'binary_precision': 0.9706968, 'binary_recall': 0.9528879, 'binary_specificity': 0.996998, 'binary_f1_score': 0.9617099}
confusion matrix:
       0     1
0  42178   127
1    208  4207
---- Validation: 
scalar performance:
{'acc': 0.9653044, 'precision': 0.72352934, 'recall': 0.5687571, 'specificity': 0.5687571, 'f1': 0.6011766, 'auroc': 0.77049136, 'binary_precision': 0.47668394, 'binary_recall': 0.14307931, 'binary_specificity': 0.99443495, 'binary_f1_score': 0.2200957}
confusion matrix:
       0    1
0  18048  101
1    551   92
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9504634, 'precision': 0.5861999, 'recall': 0.52889663, 'specificity': 0.52889663, 'f1': 0.5392869, 'auroc': 0.6686996, 'binary_precision': 0.21176471, 'binary_recall': 0.06896552, 'binary_specificity': 0.98882776, 'binary_f1_score': 0.10404624}
confusion matrix:
      0   1
0  5930  67
1   243  18
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546986_9.png
early stop counter: 5
val acc:0.9653043746948242, best validation acc: 0.9654640555381775, corresponding to test acc:                         0.9563758373260498 / 0.9578139781951904
after epoch: 9,now: 2024-06-22 14:07:33.014380,epoch time: 0:16:41.134710,used: 2:35:07.607495,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_11_32_25_seed_0_21546986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99242294, 'precision': 0.9738748, 'recall': 0.982319, 'specificity': 0.982319, 'f1': 0.9780495, 'auroc': 0.9978434, 'binary_precision': 0.9508998, 'binary_recall': 0.96986175, 'binary_specificity': 0.99477625, 'binary_f1_score': 0.96028715}
confusion matrix:
       0     1
0  42086   221
1    133  4280
---- Validation: 
scalar performance:
{'acc': 0.9583333, 'precision': 0.6766101, 'recall': 0.65665483, 'specificity': 0.65665483, 'f1': 0.66594994, 'auroc': 0.84158385, 'binary_precision': 0.37676057, 'binary_recall': 0.33281493, 'binary_specificity': 0.9804948, 'binary_f1_score': 0.3534269}
confusion matrix:
       0    1
0  17795  354
1    429  214
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94247365, 'precision': 0.56457686, 'recall': 0.5375542, 'specificity': 0.5375542, 'f1': 0.54610693, 'auroc': 0.69382536, 'binary_precision': 0.16778524, 'binary_recall': 0.09578544, 'binary_specificity': 0.97932297, 'binary_f1_score': 0.12195122}
confusion matrix:
      0    1
0  5873  124
1   236   25
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546986_10.png
early stop counter: 6
val acc:0.9583333134651184, best validation acc: 0.9654640555381775, corresponding to test acc:                         0.9563758373260498 / 0.9578139781951904
after epoch: 10,now: 2024-06-22 14:24:12.272671,epoch time: 0:16:39.258291,used: 2:51:46.865786,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_11_32_25_seed_0_21546986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9895976, 'precision': 0.9604034, 'recall': 0.9806575, 'specificity': 0.9806575, 'f1': 0.97025204, 'auroc': 0.9963156, 'binary_precision': 0.9239905, 'binary_recall': 0.9696352, 'binary_specificity': 0.99167985, 'binary_f1_score': 0.94626266}
confusion matrix:
       0     1
0  41955   352
1    134  4279
---- Validation: 
scalar performance:
{'acc': 0.9552469, 'precision': 0.66049325, 'recall': 0.6588073, 'specificity': 0.6588073, 'f1': 0.6596451, 'auroc': 0.8185253, 'binary_precision': 0.3443396, 'binary_recall': 0.34059098, 'binary_specificity': 0.97702354, 'binary_f1_score': 0.34245506}
confusion matrix:
       0    1
0  17732  417
1    424  219
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93831897, 'precision': 0.5657897, 'recall': 0.5482128, 'specificity': 0.5482128, 'f1': 0.55511576, 'auroc': 0.721678, 'binary_precision': 0.16931216, 'binary_recall': 0.12260536, 'binary_specificity': 0.97382027, 'binary_f1_score': 0.14222221}
confusion matrix:
      0    1
0  5840  157
1   229   32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546986_11.png
early stop counter: 7
val acc:0.9552469253540039, best validation acc: 0.9654640555381775, corresponding to test acc:                         0.9563758373260498 / 0.9578139781951904
after epoch: 11,now: 2024-06-22 14:40:55.718523,epoch time: 0:16:43.445852,used: 3:08:30.311638,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_11_32_25_seed_0_21546986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99092466, 'precision': 0.97052526, 'recall': 0.976819, 'specificity': 0.976819, 'f1': 0.97364557, 'auroc': 0.9966368, 'binary_precision': 0.94528806, 'binary_recall': 0.95942885, 'binary_specificity': 0.9942091, 'binary_f1_score': 0.952306}
confusion matrix:
       0     1
0  42063   245
1    179  4233
---- Validation: 
scalar performance:
{'acc': 0.95929116, 'precision': 0.66883636, 'recall': 0.6188979, 'specificity': 0.6188979, 'f1': 0.6389227, 'auroc': 0.8008511, 'binary_precision': 0.3638393, 'binary_recall': 0.2534992, 'binary_specificity': 0.9842967, 'binary_f1_score': 0.2988084}
confusion matrix:
       0    1
0  17864  285
1    480  163
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94135505, 'precision': 0.5714022, 'recall': 0.54613227, 'specificity': 0.54613227, 'f1': 0.5550785, 'auroc': 0.66766113, 'binary_precision': 0.18072289, 'binary_recall': 0.11494253, 'binary_specificity': 0.977322, 'binary_f1_score': 0.14051522}
confusion matrix:
      0    1
0  5861  136
1   231   30
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546986_12.png
early stop counter: 8
val acc:0.9592911601066589, best validation acc: 0.9654640555381775, corresponding to test acc:                         0.9563758373260498 / 0.9578139781951904
after epoch: 12,now: 2024-06-22 14:57:56.340956,epoch time: 0:17:00.622433,used: 3:25:30.934071,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_11_32_25_seed_0_21546986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.990732, 'precision': 0.993124, 'recall': 0.9525641, 'specificity': 0.9525641, 'f1': 0.9717561, 'auroc': 0.99284524, 'binary_precision': 0.996012, 'binary_recall': 0.90550643, 'binary_specificity': 0.9996218, 'binary_f1_score': 0.94860536}
confusion matrix:
       0     1
0  42291    16
1    417  3996
---- Validation: 
scalar performance:
{'acc': 0.96546406, 'precision': 0.7285745, 'recall': 0.5785905, 'specificity': 0.5785905, 'f1': 0.6133992, 'auroc': 0.76844895, 'binary_precision': 0.4861111, 'binary_recall': 0.16329704, 'binary_specificity': 0.99388397, 'binary_f1_score': 0.2444703}
confusion matrix:
       0    1
0  18038  111
1    538  105
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590924, 'precision': 0.7845403, 'recall': 0.5260696, 'specificity': 0.5260696, 'f1': 0.5388314, 'auroc': 0.6529311, 'binary_precision': 0.6086956, 'binary_recall': 0.053639848, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.09859155}
confusion matrix:
      0   1
0  5988   9
1   247  14
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546986_13.png
new oracle model saved
early stop counter: 9
val acc:0.9654640555381775, best validation acc: 0.9654640555381775, corresponding to test acc:                         0.9563758373260498 / 0.959092378616333
after epoch: 13,now: 2024-06-22 15:15:07.228027,epoch time: 0:17:10.887071,used: 3:42:41.821142,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_11_32_25_seed_0_21546986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9922731, 'precision': 0.98057044, 'recall': 0.97402704, 'specificity': 0.97402704, 'f1': 0.97727036, 'auroc': 0.99677306, 'binary_precision': 0.96619135, 'binary_recall': 0.9515289, 'binary_specificity': 0.9965252, 'binary_f1_score': 0.9588041}
confusion matrix:
       0     1
0  42158   147
1    214  4201
---- Validation: 
scalar performance:
{'acc': 0.96439976, 'precision': 0.7105891, 'recall': 0.5862901, 'specificity': 0.5862901, 'f1': 0.6196272, 'auroc': 0.77467215, 'binary_precision': 0.4496124, 'binary_recall': 0.18040435, 'binary_specificity': 0.9921759, 'binary_f1_score': 0.25749168}
confusion matrix:
       0    1
0  18007  142
1    527  116
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95302016, 'precision': 0.57984847, 'recall': 0.5174043, 'specificity': 0.5174043, 'f1': 0.522761, 'auroc': 0.6330166, 'binary_precision': 0.2, 'binary_recall': 0.042145595, 'binary_specificity': 0.992663, 'binary_f1_score': 0.06962026}
confusion matrix:
      0   1
0  5953  44
1   250  11
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546986_14.png
early stop counter: 10
val acc:0.9643997550010681, best validation acc: 0.9654640555381775, corresponding to test acc:                         0.9563758373260498 / 0.959092378616333
after epoch: 14,now: 2024-06-22 15:32:31.694304,epoch time: 0:17:24.466277,used: 4:00:06.287419,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_11_32_25_seed_0_21546986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99083906, 'precision': 0.96830654, 'recall': 0.97891533, 'specificity': 0.97891533, 'f1': 0.9735354, 'auroc': 0.9970459, 'binary_precision': 0.94035786, 'binary_recall': 0.9642129, 'binary_specificity': 0.9936178, 'binary_f1_score': 0.952136}
confusion matrix:
       0     1
0  42035   270
1    158  4257
---- Validation: 
scalar performance:
{'acc': 0.9521605, 'precision': 0.65394574, 'recall': 0.678961, 'specificity': 0.678961, 'f1': 0.6653569, 'auroc': 0.8223575, 'binary_precision': 0.32978722, 'binary_recall': 0.38569206, 'binary_specificity': 0.9722299, 'binary_f1_score': 0.35555556}
confusion matrix:
       0    1
0  17645  504
1    395  248
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9442314, 'precision': 0.59755695, 'recall': 0.5622917, 'specificity': 0.5622917, 'f1': 0.5749795, 'auroc': 0.6902803, 'binary_precision': 0.23170732, 'binary_recall': 0.14559387, 'binary_specificity': 0.9789895, 'binary_f1_score': 0.17882352}
confusion matrix:
      0    1
0  5871  126
1   223   38
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546986_15.png
early stop counter: 11
val acc:0.9521604776382446, best validation acc: 0.9654640555381775, corresponding to test acc:                         0.9563758373260498 / 0.959092378616333
after epoch: 15,now: 2024-06-22 15:49:35.663959,epoch time: 0:17:03.969655,used: 4:17:10.257074,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_11_32_25_seed_0_21546986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.992851, 'precision': 0.9770914, 'recall': 0.98134494, 'specificity': 0.98134494, 'f1': 0.97920614, 'auroc': 0.99702924, 'binary_precision': 0.9576138, 'binary_recall': 0.9671574, 'binary_specificity': 0.99553245, 'binary_f1_score': 0.96236193}
confusion matrix:
       0     1
0  42116   189
1    145  4270
---- Validation: 
scalar performance:
{'acc': 0.96003616, 'precision': 0.69246054, 'recall': 0.67478776, 'specificity': 0.67478776, 'f1': 0.6831418, 'auroc': 0.8176715, 'binary_precision': 0.4072165, 'binary_recall': 0.36858475, 'binary_specificity': 0.9809907, 'binary_f1_score': 0.38693878}
confusion matrix:
       0    1
0  17804  345
1    406  237
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9504634, 'precision': 0.6600649, 'recall': 0.6040223, 'specificity': 0.6040223, 'f1': 0.62502784, 'auroc': 0.7509991, 'binary_precision': 0.35329342, 'binary_recall': 0.22605364, 'binary_specificity': 0.981991, 'binary_f1_score': 0.27570093}
confusion matrix:
      0    1
0  5889  108
1   202   59
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546986_16.png
early stop counter: 12
val acc:0.9600361585617065, best validation acc: 0.9654640555381775, corresponding to test acc:                         0.9563758373260498 / 0.959092378616333
after epoch: 16,now: 2024-06-22 16:06:33.286636,epoch time: 0:16:57.622677,used: 4:34:07.879751,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_11_32_25_seed_0_21546986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99233735, 'precision': 0.97789454, 'recall': 0.9773129, 'specificity': 0.9773129, 'f1': 0.97760355, 'auroc': 0.99622685, 'binary_precision': 0.9600907, 'binary_recall': 0.95878625, 'binary_specificity': 0.99583966, 'binary_f1_score': 0.959438}
confusion matrix:
       0     1
0  42128   176
1    182  4234
---- Validation: 
scalar performance:
{'acc': 0.96248406, 'precision': 0.68063784, 'recall': 0.58079803, 'specificity': 0.58079803, 'f1': 0.6093033, 'auroc': 0.744293, 'binary_precision': 0.39007092, 'binary_recall': 0.1710731, 'binary_specificity': 0.9905229, 'binary_f1_score': 0.23783785}
confusion matrix:
       0    1
0  17977  172
1    533  110
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9487057, 'precision': 0.61236143, 'recall': 0.5554645, 'specificity': 0.5554645, 'f1': 0.5720386, 'auroc': 0.68243957, 'binary_precision': 0.26190478, 'binary_recall': 0.12643678, 'binary_specificity': 0.98449224, 'binary_f1_score': 0.17054264}
confusion matrix:
      0   1
0  5904  93
1   228  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546986_17.png
early stop counter: 13
val acc:0.9624840617179871, best validation acc: 0.9654640555381775, corresponding to test acc:                         0.9563758373260498 / 0.959092378616333
after epoch: 17,now: 2024-06-22 16:23:25.026729,epoch time: 0:16:51.740093,used: 4:50:59.619844,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_11_32_25_seed_0_21546986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99355733, 'precision': 0.9839835, 'recall': 0.9781803, 'specificity': 0.9781803, 'f1': 0.9810598, 'auroc': 0.99719185, 'binary_precision': 0.97221583, 'binary_recall': 0.95922065, 'binary_specificity': 0.9971399, 'binary_f1_score': 0.9656745}
confusion matrix:
       0     1
0  42185   121
1    180  4234
---- Validation: 
scalar performance:
{'acc': 0.9656237, 'precision': 0.7318821, 'recall': 0.57717305, 'specificity': 0.57717305, 'f1': 0.6120986, 'auroc': 0.77086586, 'binary_precision': 0.49282297, 'binary_recall': 0.16018662, 'binary_specificity': 0.99415946, 'binary_f1_score': 0.24178404}
confusion matrix:
       0    1
0  18043  106
1    540  103
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95573664, 'precision': 0.66405296, 'recall': 0.5389773, 'specificity': 0.5389773, 'f1': 0.5571787, 'auroc': 0.70132, 'binary_precision': 0.36666667, 'binary_recall': 0.08429119, 'binary_specificity': 0.9936635, 'binary_f1_score': 0.13707165}
confusion matrix:
      0   1
0  5959  38
1   239  22
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546986_18.png
better model found
persisted
after epoch: 18,now: 2024-06-22 16:40:05.480457,epoch time: 0:16:40.453728,used: 5:07:40.073572,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_11_32_25_seed_0_21546986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.978125, 'precision': 0.9097947, 'recall': 0.9797015, 'specificity': 0.9797015, 'f1': 0.9411422, 'auroc': 0.9975388, 'binary_precision': 0.8215437, 'binary_recall': 0.98164517, 'binary_specificity': 0.9777578, 'binary_f1_score': 0.8944869}
confusion matrix:
       0     1
0  41366   941
1     81  4332
---- Validation: 
scalar performance:
{'acc': 0.9397616, 'precision': 0.61780417, 'recall': 0.68079245, 'specificity': 0.68079245, 'f1': 0.6412186, 'auroc': 0.81801224, 'binary_precision': 0.25719962, 'binary_recall': 0.40279937, 'binary_specificity': 0.9587856, 'binary_f1_score': 0.31393936}
confusion matrix:
       0    1
0  17401  748
1    384  259
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9009268, 'precision': 0.55435663, 'recall': 0.60016406, 'specificity': 0.60016406, 'f1': 0.5668019, 'auroc': 0.69282913, 'binary_precision': 0.14171657, 'binary_recall': 0.27203065, 'binary_specificity': 0.92829746, 'binary_f1_score': 0.18635172}
confusion matrix:
      0    1
0  5567  430
1   190   71
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546986_19.png
early stop counter: 1
val acc:0.9397615790367126, best validation acc: 0.965623676776886, corresponding to test acc:                         0.9557366371154785 / 0.959092378616333
after epoch: 19,now: 2024-06-22 16:57:01.584554,epoch time: 0:16:56.104097,used: 5:24:36.177669,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_11_32_25_seed_0_21546986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99379283, 'precision': 0.98609996, 'recall': 0.977402, 'specificity': 0.977402, 'f1': 0.98170143, 'auroc': 0.99757075, 'binary_precision': 0.97665817, 'binary_recall': 0.9571914, 'binary_specificity': 0.9976126, 'binary_f1_score': 0.9668268}
confusion matrix:
       0     1
0  42204   101
1    189  4226
---- Validation: 
scalar performance:
{'acc': 0.9656769, 'precision': 0.7352655, 'recall': 0.61770356, 'specificity': 0.61770356, 'f1': 0.65490675, 'auroc': 0.82194006, 'binary_precision': 0.49683544, 'binary_recall': 0.24416797, 'binary_specificity': 0.9912392, 'binary_f1_score': 0.3274244}
confusion matrix:
       0    1
0  17990  159
1    486  157
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.79147553, 'recall': 0.55780286, 'specificity': 0.55780286, 'f1': 0.58947766, 'auroc': 0.7510885, 'binary_precision': 0.62, 'binary_recall': 0.118773945, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.19935691}
confusion matrix:
      0   1
0  5978  19
1   230  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546986_20.png
new oracle model saved
better model found
persisted
after epoch: 20,now: 2024-06-22 17:14:58.259997,epoch time: 0:17:56.675443,used: 5:42:32.853112,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_11_32_25_seed_0_21546986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9848031, 'precision': 0.9377587, 'recall': 0.98003983, 'specificity': 0.98003983, 'f1': 0.95764124, 'auroc': 0.99666286, 'binary_precision': 0.8782431, 'binary_recall': 0.9741672, 'binary_specificity': 0.9859125, 'binary_f1_score': 0.92372155}
confusion matrix:
       0     1
0  41711   596
1    114  4299
---- Validation: 
scalar performance:
{'acc': 0.96216476, 'precision': 0.70282423, 'recall': 0.6533881, 'specificity': 0.6533881, 'f1': 0.67424935, 'auroc': 0.83102447, 'binary_precision': 0.4294606, 'binary_recall': 0.32192847, 'binary_specificity': 0.98484766, 'binary_f1_score': 0.36800003}
confusion matrix:
       0    1
0  17874  275
1    436  207
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9400767, 'precision': 0.5879913, 'recall': 0.56745327, 'specificity': 0.56745327, 'f1': 0.5759522, 'auroc': 0.70110136, 'binary_precision': 0.21212122, 'binary_recall': 0.16091955, 'binary_specificity': 0.973987, 'binary_f1_score': 0.18300655}
confusion matrix:
      0    1
0  5841  156
1   219   42
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546986_21.png
early stop counter: 1
val acc:0.9621647596359253, best validation acc: 0.9656769037246704, corresponding to test acc:                         0.960210919380188 / 0.960210919380188
after epoch: 21,now: 2024-06-22 17:32:35.745342,epoch time: 0:17:37.485345,used: 6:00:10.338457,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_11_32_25_seed_0_21546986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9885916, 'precision': 0.95724255, 'recall': 0.97817767, 'specificity': 0.97817767, 'f1': 0.9674106, 'auroc': 0.9968265, 'binary_precision': 0.9181211, 'binary_recall': 0.9653376, 'binary_specificity': 0.9910178, 'binary_f1_score': 0.94113755}
confusion matrix:
       0     1
0  41926   380
1    153  4261
---- Validation: 
scalar performance:
{'acc': 0.95109624, 'precision': 0.65506625, 'recall': 0.6949112, 'specificity': 0.6949112, 'f1': 0.67233855, 'auroc': 0.8600123, 'binary_precision': 0.33088234, 'binary_recall': 0.41990668, 'binary_specificity': 0.9699157, 'binary_f1_score': 0.3701165}
confusion matrix:
       0    1
0  17603  546
1    373  270
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94534993, 'precision': 0.62700194, 'recall': 0.59402496, 'specificity': 0.59402496, 'f1': 0.607507, 'auroc': 0.777439, 'binary_precision': 0.28795812, 'binary_recall': 0.21072797, 'binary_specificity': 0.977322, 'binary_f1_score': 0.24336284}
confusion matrix:
      0    1
0  5861  136
1   206   55
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546986_22.png
early stop counter: 2
val acc:0.95109623670578, best validation acc: 0.9656769037246704, corresponding to test acc:                         0.960210919380188 / 0.960210919380188
after epoch: 22,now: 2024-06-22 17:49:09.688492,epoch time: 0:16:33.943150,used: 6:16:44.281607,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_11_32_25_seed_0_21546986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9921233, 'precision': 0.988446, 'recall': 0.9651044, 'specificity': 0.9651044, 'f1': 0.9764162, 'auroc': 0.99571383, 'binary_precision': 0.9839675, 'binary_recall': 0.93179244, 'binary_specificity': 0.99841636, 'binary_f1_score': 0.95716953}
confusion matrix:
       0     1
0  42240    67
1    301  4112
---- Validation: 
scalar performance:
{'acc': 0.9661558, 'precision': 0.74421024, 'recall': 0.5781986, 'specificity': 0.5781986, 'f1': 0.61456734, 'auroc': 0.7810709, 'binary_precision': 0.51741296, 'binary_recall': 0.16174184, 'binary_specificity': 0.9946554, 'binary_f1_score': 0.24644549}
confusion matrix:
       0    1
0  18052   97
1    539  104
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9533397, 'precision': 0.5940383, 'recall': 0.5212357, 'specificity': 0.5212357, 'f1': 0.52891135, 'auroc': 0.66614187, 'binary_precision': 0.22807017, 'binary_recall': 0.049808428, 'binary_specificity': 0.992663, 'binary_f1_score': 0.08176101}
confusion matrix:
      0   1
0  5953  44
1   248  13
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546986_23.png
better model found
persisted
after epoch: 23,now: 2024-06-22 18:05:43.621905,epoch time: 0:16:33.933413,used: 6:33:18.215020,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_11_32_25_seed_0_21546986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99021834, 'precision': 0.96504056, 'recall': 0.9788652, 'specificity': 0.9788652, 'f1': 0.97182393, 'auroc': 0.99647117, 'binary_precision': 0.9337574, 'binary_recall': 0.96486855, 'binary_specificity': 0.99286187, 'binary_f1_score': 0.9490581}
confusion matrix:
       0     1
0  42006   302
1    155  4257
---- Validation: 
scalar performance:
{'acc': 0.95407623, 'precision': 0.65824205, 'recall': 0.6679519, 'specificity': 0.6679519, 'f1': 0.6629293, 'auroc': 0.8226234, 'binary_precision': 0.33918127, 'binary_recall': 0.3608087, 'binary_specificity': 0.97509503, 'binary_f1_score': 0.34966087}
confusion matrix:
       0    1
0  17697  452
1    411  232
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9399169, 'precision': 0.5606667, 'recall': 0.5398849, 'specificity': 0.5398849, 'f1': 0.54723555, 'auroc': 0.67896736, 'binary_precision': 0.1597633, 'binary_recall': 0.10344828, 'binary_specificity': 0.9763215, 'binary_f1_score': 0.1255814}
confusion matrix:
      0    1
0  5855  142
1   234   27
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546986_24.png
early stop counter: 1
val acc:0.9540762305259705, best validation acc: 0.9661558270454407, corresponding to test acc:                         0.953339695930481 / 0.960210919380188
after epoch: 24,now: 2024-06-22 18:22:29.988860,epoch time: 0:16:46.366955,used: 6:50:04.581975,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_11_32_25_seed_0_21546986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9925942, 'precision': 0.97788745, 'recall': 0.9788574, 'specificity': 0.9788574, 'f1': 0.97837174, 'auroc': 0.9970727, 'binary_precision': 0.9597467, 'binary_recall': 0.96192205, 'binary_specificity': 0.99579275, 'binary_f1_score': 0.96083313}
confusion matrix:
       0     1
0  42130   178
1    168  4244
---- Validation: 
scalar performance:
{'acc': 0.95796084, 'precision': 0.6717478, 'recall': 0.6489614, 'specificity': 0.6489614, 'f1': 0.659428, 'auroc': 0.7935734, 'binary_precision': 0.36756757, 'binary_recall': 0.31726283, 'binary_specificity': 0.9806601, 'binary_f1_score': 0.3405676}
confusion matrix:
       0    1
0  17798  351
1    439  204
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9482263, 'precision': 0.59867, 'recall': 0.5460527, 'specificity': 0.5460527, 'f1': 0.5603355, 'auroc': 0.6602323, 'binary_precision': 0.23529412, 'binary_recall': 0.107279696, 'binary_specificity': 0.98482573, 'binary_f1_score': 0.14736843}
confusion matrix:
      0   1
0  5906  91
1   233  28
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546986_25.png
early stop counter: 2
val acc:0.957960844039917, best validation acc: 0.9661558270454407, corresponding to test acc:                         0.953339695930481 / 0.960210919380188
after epoch: 25,now: 2024-06-22 18:40:21.761505,epoch time: 0:17:51.772645,used: 7:07:56.354620,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_11_32_25_seed_0_21546986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99201626, 'precision': 0.9734522, 'recall': 0.98026395, 'specificity': 0.98026395, 'f1': 0.9768272, 'auroc': 0.9972427, 'binary_precision': 0.95047957, 'binary_recall': 0.96577513, 'binary_specificity': 0.99475276, 'binary_f1_score': 0.9580663}
confusion matrix:
       0     1
0  42086   222
1    151  4261
---- Validation: 
scalar performance:
{'acc': 0.96243083, 'precision': 0.70441115, 'recall': 0.65052557, 'specificity': 0.65052557, 'f1': 0.6728753, 'auroc': 0.82855976, 'binary_precision': 0.43283582, 'binary_recall': 0.31570762, 'binary_specificity': 0.9853435, 'binary_f1_score': 0.3651079}
confusion matrix:
       0    1
0  17883  266
1    440  203
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95174176, 'precision': 0.6318014, 'recall': 0.553384, 'specificity': 0.553384, 'f1': 0.5727389, 'auroc': 0.74074316, 'binary_precision': 0.30097088, 'binary_recall': 0.118773945, 'binary_specificity': 0.987994, 'binary_f1_score': 0.17032968}
confusion matrix:
      0   1
0  5925  72
1   230  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546986_26.png
early stop counter: 3
val acc:0.9624308347702026, best validation acc: 0.9661558270454407, corresponding to test acc:                         0.953339695930481 / 0.960210919380188
after epoch: 26,now: 2024-06-22 18:57:22.320906,epoch time: 0:17:00.559401,used: 7:24:56.914021,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_11_32_25_seed_0_21546986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9914598, 'precision': 0.99025536, 'recall': 0.95945185, 'specificity': 0.95945185, 'f1': 0.9742271, 'auroc': 0.9932907, 'binary_precision': 0.98879415, 'binary_recall': 0.91999096, 'binary_specificity': 0.99891275, 'binary_f1_score': 0.95315254}
confusion matrix:
       0     1
0  42262    46
1    353  4059
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.7338873, 'recall': 0.5300022, 'specificity': 0.5300022, 'f1': 0.5466031, 'auroc': 0.7592432, 'binary_precision': 0.5, 'binary_recall': 0.0622084, 'binary_specificity': 0.997796, 'binary_f1_score': 0.11065007}
confusion matrix:
       0   1
0  18109  40
1    603  40
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95717484, 'precision': 0.65362436, 'recall': 0.51407504, 'specificity': 0.51407504, 'f1': 0.5172141, 'auroc': 0.6269417, 'binary_precision': 0.3478261, 'binary_recall': 0.03065134, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.056338027}
confusion matrix:
      0   1
0  5982  15
1   253   8
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546986_27.png
early stop counter: 4
val acc:0.9657832980155945, best validation acc: 0.9661558270454407, corresponding to test acc:                         0.953339695930481 / 0.960210919380188
after epoch: 27,now: 2024-06-22 19:14:18.036447,epoch time: 0:16:55.715541,used: 7:41:52.629562,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_11_32_25_seed_0_21546986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9926798, 'precision': 0.98544264, 'recall': 0.9713992, 'specificity': 0.9713992, 'f1': 0.97829103, 'auroc': 0.9954349, 'binary_precision': 0.9765863, 'binary_recall': 0.945162, 'binary_specificity': 0.9976363, 'binary_f1_score': 0.9606172}
confusion matrix:
       0     1
0  42207   100
1    242  4171
---- Validation: 
scalar performance:
{'acc': 0.9634951, 'precision': 0.6969866, 'recall': 0.5865718, 'specificity': 0.5865718, 'f1': 0.61781865, 'auroc': 0.78909457, 'binary_precision': 0.42238268, 'binary_recall': 0.18195957, 'binary_specificity': 0.9911841, 'binary_f1_score': 0.25434783}
confusion matrix:
       0    1
0  17989  160
1    526  117
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9501438, 'precision': 0.6280041, 'recall': 0.5617119, 'specificity': 0.5617119, 'f1': 0.58089143, 'auroc': 0.7080474, 'binary_precision': 0.29268292, 'binary_recall': 0.13793103, 'binary_specificity': 0.98549277, 'binary_f1_score': 0.18750001}
confusion matrix:
      0   1
0  5910  87
1   225  36
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546986_28.png
early stop counter: 5
val acc:0.9634950757026672, best validation acc: 0.9661558270454407, corresponding to test acc:                         0.953339695930481 / 0.960210919380188
after epoch: 28,now: 2024-06-22 19:31:20.457408,epoch time: 0:17:02.420961,used: 7:58:55.050523,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_11_32_25_seed_0_21546986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9928082, 'precision': 0.9770441, 'recall': 0.98110723, 'specificity': 0.98110723, 'f1': 0.9790648, 'auroc': 0.99695814, 'binary_precision': 0.95756626, 'binary_recall': 0.9666818, 'binary_specificity': 0.99553275, 'binary_f1_score': 0.9621025}
confusion matrix:
       0     1
0  42119   189
1    147  4265
---- Validation: 
scalar performance:
{'acc': 0.9612069, 'precision': 0.6847578, 'recall': 0.61988974, 'specificity': 0.61988974, 'f1': 0.644524, 'auroc': 0.7754461, 'binary_precision': 0.39563107, 'binary_recall': 0.2534992, 'binary_specificity': 0.98628026, 'binary_f1_score': 0.30900475}
confusion matrix:
       0    1
0  17900  249
1    480  163
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9403963, 'precision': 0.5793045, 'recall': 0.556626, 'specificity': 0.556626, 'f1': 0.56544864, 'auroc': 0.64416736, 'binary_precision': 0.19565217, 'binary_recall': 0.13793103, 'binary_specificity': 0.975321, 'binary_f1_score': 0.16179775}
confusion matrix:
      0    1
0  5849  148
1   225   36
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546986_29.png
early stop counter: 6
val acc:0.9612069129943848, best validation acc: 0.9661558270454407, corresponding to test acc:                         0.953339695930481 / 0.960210919380188
after epoch: 29,now: 2024-06-22 19:48:21.083784,epoch time: 0:17:00.626376,used: 8:15:55.676899,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_11_32_25_seed_0_21546986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9925514, 'precision': 0.9866544, 'recall': 0.96936667, 'specificity': 0.96936667, 'f1': 0.97781384, 'auroc': 0.9953383, 'binary_precision': 0.9794521, 'binary_recall': 0.94078946, 'binary_specificity': 0.9979438, 'binary_f1_score': 0.9597315}
confusion matrix:
       0     1
0  42225    87
1    261  4147
---- Validation: 
scalar performance:
{'acc': 0.9650383, 'precision': 0.7202126, 'recall': 0.5798702, 'specificity': 0.5798702, 'f1': 0.6138995, 'auroc': 0.7460067, 'binary_precision': 0.46929824, 'binary_recall': 0.16640747, 'binary_specificity': 0.993333, 'binary_f1_score': 0.2456946}
confusion matrix:
       0    1
0  18028  121
1    536  107
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9552573, 'precision': 0.6770098, 'recall': 0.5607152, 'specificity': 0.5607152, 'f1': 0.5861955, 'auroc': 0.7031907, 'binary_precision': 0.3908046, 'binary_recall': 0.1302682, 'binary_specificity': 0.99116224, 'binary_f1_score': 0.1954023}
confusion matrix:
      0   1
0  5944  53
1   227  34
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546986_30.png
early stop counter: 7
val acc:0.9650382995605469, best validation acc: 0.9661558270454407, corresponding to test acc:                         0.953339695930481 / 0.960210919380188
after epoch: 30,now: 2024-06-22 20:05:32.621077,epoch time: 0:17:11.537293,used: 8:33:07.214192,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_11_32_25_seed_0_21546986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 8:33:07.214192 at 2024-06-22 20:05:32.621077
persisted model performance metric: 

scalar performance:
{'acc': 0.9533397, 'precision': 0.5940383, 'recall': 0.5212357, 'specificity': 0.5212357, 'f1': 0.52891135, 'auroc': 0.66614187, 'binary_precision': 0.22807017, 'binary_recall': 0.049808428, 'binary_specificity': 0.992663, 'binary_f1_score': 0.08176101}
confusion matrix:
      0   1
0  5953  44
1   248  13
oracle model performance metric: 

scalar performance:
{'acc': 0.9602109, 'precision': 0.79147553, 'recall': 0.55780286, 'specificity': 0.55780286, 'f1': 0.58947766, 'auroc': 0.7510885, 'binary_precision': 0.62, 'binary_recall': 0.118773945, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.19935691}
confusion matrix:
      0   1
0  5978  19
1   230  31
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_resnet_differentlearningrates_bs32_classbalancing3/rule_results/0.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_resnet_differentlearningrates_bs32_classbalancing3/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_resnet_differentlearningrates_bs32_classbalancing3/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204391 KiB | 737101 KiB | 402802 GiB | 402802 GiB |
|       from large pool | 167936 KiB | 664960 KiB | 402482 GiB | 402481 GiB |
|       from small pool |  36455 KiB |  73422 KiB |    320 GiB |    320 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 204391 KiB | 737101 KiB | 402802 GiB | 402802 GiB |
|       from large pool | 167936 KiB | 664960 KiB | 402482 GiB | 402481 GiB |
|       from small pool |  36455 KiB |  73422 KiB |    320 GiB |    320 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201088 KiB | 730152 KiB | 402686 GiB | 402686 GiB |
|       from large pool | 165120 KiB | 658560 KiB | 402373 GiB | 402373 GiB |
|       from small pool |  35968 KiB |  72872 KiB |    312 GiB |    312 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    900 MiB |    900 MiB |    900 MiB |      0 B   |
|       from large pool |    828 MiB |    828 MiB |    828 MiB |      0 B   |
|       from small pool |     72 MiB |     72 MiB |     72 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 104856 KiB | 260793 KiB | 271582 GiB | 271582 GiB |
|       from large pool |  96256 KiB | 259208 KiB | 271258 GiB | 271258 GiB |
|       from small pool |   8600 KiB |  12448 KiB |    323 GiB |    323 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2076    |    3669    |   44149 K  |   44147 K  |
|       from large pool |      36    |      76    |   14817 K  |   14817 K  |
|       from small pool |    2040    |    3632    |   29332 K  |   29330 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2076    |    3669    |   44149 K  |   44147 K  |
|       from large pool |      36    |      76    |   14817 K  |   14817 K  |
|       from small pool |    2040    |    3632    |   29332 K  |   29330 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      51    |      51    |      51    |       0    |
|       from large pool |      15    |      15    |      15    |       0    |
|       from small pool |      36    |      36    |      36    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      34    |    1476    |   19468 K  |   19468 K  |
|       from large pool |       5    |      10    |    5530 K  |    5530 K  |
|       from small pool |      29    |    1471    |   13937 K  |   13937 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 737101 KiB | 402802 GiB | 402802 GiB |
|       from large pool |  16640 KiB | 664960 KiB | 402482 GiB | 402482 GiB |
|       from small pool |      0 KiB |  73422 KiB |    320 GiB |    320 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 737101 KiB | 402802 GiB | 402802 GiB |
|       from large pool |  16640 KiB | 664960 KiB | 402482 GiB | 402482 GiB |
|       from small pool |      0 KiB |  73422 KiB |    320 GiB |    320 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 730152 KiB | 402686 GiB | 402686 GiB |
|       from large pool |  16640 KiB | 658560 KiB | 402373 GiB | 402373 GiB |
|       from small pool |      0 KiB |  72872 KiB |    312 GiB |    312 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 309248 KiB |    900 MiB |    900 MiB | 612352 KiB |
|       from large pool | 264192 KiB |    828 MiB |    828 MiB | 583680 KiB |
|       from small pool |  45056 KiB |     72 MiB |     72 MiB |  28672 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  83712 KiB | 260793 KiB | 271582 GiB | 271582 GiB |
|       from large pool |  83712 KiB | 259208 KiB | 271259 GiB | 271259 GiB |
|       from small pool |      0 KiB |  16195 KiB |    323 GiB |    323 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3669    |   44149 K  |   44149 K  |
|       from large pool |       2    |      76    |   14817 K  |   14817 K  |
|       from small pool |       0    |    3632    |   29332 K  |   29332 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3669    |   44149 K  |   44149 K  |
|       from large pool |       2    |      76    |   14817 K  |   14817 K  |
|       from small pool |       0    |    3632    |   29332 K  |   29332 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      51    |      51    |      20    |
|       from large pool |       9    |      15    |      15    |       6    |
|       from small pool |      22    |      36    |      36    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |    1476    |   19469 K  |   19469 K  |
|       from large pool |       1    |      11    |    5530 K  |    5530 K  |
|       from small pool |       0    |    1471    |   13938 K  |   13938 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 737101 KiB | 402802 GiB | 402802 GiB |
|       from large pool |  16640 KiB | 664960 KiB | 402482 GiB | 402482 GiB |
|       from small pool |      0 KiB |  73422 KiB |    320 GiB |    320 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 737101 KiB | 402802 GiB | 402802 GiB |
|       from large pool |  16640 KiB | 664960 KiB | 402482 GiB | 402482 GiB |
|       from small pool |      0 KiB |  73422 KiB |    320 GiB |    320 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 730152 KiB | 402686 GiB | 402686 GiB |
|       from large pool |  16640 KiB | 658560 KiB | 402373 GiB | 402373 GiB |
|       from small pool |      0 KiB |  72872 KiB |    312 GiB |    312 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 309248 KiB |    900 MiB |    900 MiB | 612352 KiB |
|       from large pool | 264192 KiB |    828 MiB |    828 MiB | 583680 KiB |
|       from small pool |  45056 KiB |     72 MiB |     72 MiB |  28672 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  83712 KiB | 260793 KiB | 271582 GiB | 271582 GiB |
|       from large pool |  83712 KiB | 259208 KiB | 271259 GiB | 271259 GiB |
|       from small pool |      0 KiB |  16195 KiB |    323 GiB |    323 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3669    |   44149 K  |   44149 K  |
|       from large pool |       2    |      76    |   14817 K  |   14817 K  |
|       from small pool |       0    |    3632    |   29332 K  |   29332 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3669    |   44149 K  |   44149 K  |
|       from large pool |       2    |      76    |   14817 K  |   14817 K  |
|       from small pool |       0    |    3632    |   29332 K  |   29332 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      51    |      51    |      20    |
|       from large pool |       9    |      15    |      15    |       6    |
|       from small pool |      22    |      36    |      36    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |    1476    |   19469 K  |   19469 K  |
|       from large pool |       1    |      11    |    5530 K  |    5530 K  |
|       from small pool |       0    |    1471    |   13938 K  |   13938 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0




!!!: not committed yet



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_20_12_21_seed_1_21546986

 Experiment start at: 2024-06-22 20:12:21.607276
before training, model accuracy: 0.1456654816865921
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.99086046, 'precision': 0.9840703, 'recall': 0.96092206, 'specificity': 0.96092206, 'f1': 0.97214144, 'auroc': 0.9952579, 'binary_precision': 0.975836, 'binary_recall': 0.9241794, 'binary_specificity': 0.99766475, 'binary_f1_score': 0.9493055}
confusion matrix:
       0     1
0  42295    99
1    328  3998
---- Validation: 
scalar performance:
{'acc': 0.9626467, 'precision': 0.6711124, 'recall': 0.5285787, 'specificity': 0.5285787, 'f1': 0.54289234, 'auroc': 0.7498764, 'binary_precision': 0.3761468, 'binary_recall': 0.060921248, 'binary_specificity': 0.9962362, 'binary_f1_score': 0.10485933}
confusion matrix:
       0   1
0  17999  68
1    632  41
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9516597, 'precision': 0.5871787, 'recall': 0.5242212, 'specificity': 0.5242212, 'f1': 0.5330394, 'auroc': 0.7366209, 'binary_precision': 0.21428572, 'binary_recall': 0.057692308, 'binary_specificity': 0.9907501, 'binary_f1_score': 0.09090909}
confusion matrix:
      0   1
0  5891  55
1   245  15
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546986_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-22 20:29:59.643462,epoch time: 0:17:38.036186,used: 0:17:38.036186,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_20_12_21_seed_1_21546986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9910959, 'precision': 0.9746946, 'recall': 0.9721277, 'specificity': 0.9721277, 'f1': 0.9734067, 'auroc': 0.9950774, 'binary_precision': 0.95459837, 'binary_recall': 0.94885445, 'binary_specificity': 0.99540085, 'binary_f1_score': 0.9517177}
confusion matrix:
       0     1
0  42204   195
1    221  4100
---- Validation: 
scalar performance:
{'acc': 0.9639808, 'precision': 0.73069274, 'recall': 0.55430496, 'specificity': 0.55430496, 'f1': 0.5826905, 'auroc': 0.716285, 'binary_precision': 0.4935065, 'binary_recall': 0.11292719, 'binary_specificity': 0.9956827, 'binary_f1_score': 0.18379685}
confusion matrix:
       0   1
0  17989  78
1    597  76
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95246536, 'precision': 0.50472325, 'recall': 0.5007348, 'specificity': 0.5007348, 'f1': 0.49451196, 'auroc': 0.5957303, 'binary_precision': 0.051282052, 'binary_recall': 0.0076923077, 'binary_specificity': 0.99377733, 'binary_f1_score': 0.013377927}
confusion matrix:
      0   1
0  5909  37
1   258   2
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546986_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-22 20:47:03.943627,epoch time: 0:17:04.300165,used: 0:34:42.336351,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_20_12_21_seed_1_21546986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9896832, 'precision': 0.96518517, 'recall': 0.9740564, 'specificity': 0.9740564, 'f1': 0.9695678, 'auroc': 0.996418, 'binary_precision': 0.9349796, 'binary_recall': 0.954882, 'binary_specificity': 0.9932308, 'binary_f1_score': 0.944826}
confusion matrix:
       0     1
0  42111   287
1    195  4127
---- Validation: 
scalar performance:
{'acc': 0.96109927, 'precision': 0.6539441, 'recall': 0.5413662, 'specificity': 0.5413662, 'f1': 0.5607208, 'auroc': 0.72904545, 'binary_precision': 0.3409091, 'binary_recall': 0.089153044, 'binary_specificity': 0.99357945, 'binary_f1_score': 0.14134274}
confusion matrix:
       0    1
0  17951  116
1    613   60
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94956493, 'precision': 0.5189272, 'recall': 0.50473815, 'specificity': 0.50473815, 'f1': 0.5025342, 'auroc': 0.59845066, 'binary_precision': 0.07936508, 'binary_recall': 0.01923077, 'binary_specificity': 0.9902455, 'binary_f1_score': 0.030959755}
confusion matrix:
      0   1
0  5888  58
1   255   5
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546986_3.png
early stop counter: 1
val acc:0.9610992670059204, best validation acc: 0.9639807939529419, corresponding to test acc:                         0.9524653553962708 / 0.9524653553962708
after epoch: 3,now: 2024-06-22 21:04:17.467110,epoch time: 0:17:13.523483,used: 0:51:55.859834,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_20_12_21_seed_1_21546986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.99240154, 'precision': 0.98707724, 'recall': 0.9672352, 'specificity': 0.9672352, 'f1': 0.9768982, 'auroc': 0.9963982, 'binary_precision': 0.9806108, 'binary_recall': 0.9363573, 'binary_specificity': 0.99811316, 'binary_f1_score': 0.95797324}
confusion matrix:
       0     1
0  42319    80
1    275  4046
---- Validation: 
scalar performance:
{'acc': 0.96109927, 'precision': 0.6591725, 'recall': 0.5456578, 'specificity': 0.5456578, 'f1': 0.5667012, 'auroc': 0.76977384, 'binary_precision': 0.35106382, 'binary_recall': 0.09806835, 'binary_specificity': 0.99324733, 'binary_f1_score': 0.1533101}
confusion matrix:
       0    1
0  17945  122
1    607   66
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9531099, 'precision': 0.57773054, 'recall': 0.5157831, 'specificity': 0.5157831, 'f1': 0.5201305, 'auroc': 0.7036647, 'binary_precision': 0.19607843, 'binary_recall': 0.03846154, 'binary_specificity': 0.99310464, 'binary_f1_score': 0.06430869}
confusion matrix:
      0   1
0  5905  41
1   250  10
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546986_4.png
new oracle model saved
early stop counter: 2
val acc:0.9610992670059204, best validation acc: 0.9639807939529419, corresponding to test acc:                         0.9524653553962708 / 0.9531099200248718
after epoch: 4,now: 2024-06-22 21:21:18.180817,epoch time: 0:17:00.713707,used: 1:08:56.573541,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_20_12_21_seed_1_21546986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9897474, 'precision': 0.9640591, 'recall': 0.97587204, 'specificity': 0.97587204, 'f1': 0.96987164, 'auroc': 0.99684227, 'binary_precision': 0.9323291, 'binary_recall': 0.95884395, 'binary_specificity': 0.99290013, 'binary_f1_score': 0.94540066}
confusion matrix:
       0     1
0  42094   301
1    178  4147
---- Validation: 
scalar performance:
{'acc': 0.9596051, 'precision': 0.7053573, 'recall': 0.69151276, 'specificity': 0.69151276, 'f1': 0.6981607, 'auroc': 0.83779085, 'binary_precision': 0.43290734, 'binary_recall': 0.4026746, 'binary_specificity': 0.9803509, 'binary_f1_score': 0.41724405}
confusion matrix:
       0    1
0  17712  355
1    402  271
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9513374, 'precision': 0.68182325, 'recall': 0.63990915, 'specificity': 0.63990915, 'f1': 0.65767395, 'auroc': 0.81905127, 'binary_precision': 0.3939394, 'binary_recall': 0.3, 'binary_specificity': 0.97981834, 'binary_f1_score': 0.34061134}
confusion matrix:
      0    1
0  5826  120
1   182   78
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546986_5.png
early stop counter: 3
val acc:0.9596050977706909, best validation acc: 0.9639807939529419, corresponding to test acc:                         0.9524653553962708 / 0.9531099200248718
after epoch: 5,now: 2024-06-22 21:38:15.026913,epoch time: 0:16:56.846096,used: 1:25:53.419637,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_20_12_21_seed_1_21546986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9922517, 'precision': 0.9813862, 'recall': 0.97217107, 'specificity': 0.97217107, 'f1': 0.9767227, 'auroc': 0.995655, 'binary_precision': 0.96811527, 'binary_recall': 0.9475266, 'binary_specificity': 0.99681556, 'binary_f1_score': 0.9577103}
confusion matrix:
       0     1
0  42259   135
1    227  4099
---- Validation: 
scalar performance:
{'acc': 0.9597652, 'precision': 0.6840945, 'recall': 0.60862476, 'specificity': 0.60862476, 'f1': 0.6353241, 'auroc': 0.793802, 'binary_precision': 0.39641944, 'binary_recall': 0.23031203, 'binary_specificity': 0.9869375, 'binary_f1_score': 0.2913534}
confusion matrix:
       0    1
0  17831  236
1    518  155
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95294875, 'precision': 0.67006004, 'recall': 0.58558047, 'specificity': 0.58558047, 'f1': 0.6115689, 'auroc': 0.7551656, 'binary_precision': 0.375, 'binary_recall': 0.18461539, 'binary_specificity': 0.98654556, 'binary_f1_score': 0.2474227}
confusion matrix:
      0   1
0  5866  80
1   212  48
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546986_6.png
early stop counter: 4
val acc:0.9597651958465576, best validation acc: 0.9639807939529419, corresponding to test acc:                         0.9524653553962708 / 0.9531099200248718
after epoch: 6,now: 2024-06-22 21:55:19.314215,epoch time: 0:17:04.287302,used: 1:42:57.706939,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_20_12_21_seed_1_21546986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.99203765, 'precision': 0.9841436, 'recall': 0.9679842, 'specificity': 0.9679842, 'f1': 0.9758921, 'auroc': 0.99605393, 'binary_precision': 0.9745376, 'binary_recall': 0.93846864, 'binary_specificity': 0.9974998, 'binary_f1_score': 0.95616305}
confusion matrix:
       0     1
0  42291   106
1    266  4057
---- Validation: 
scalar performance:
{'acc': 0.9603522, 'precision': 0.69540596, 'recall': 0.62538034, 'specificity': 0.62538034, 'f1': 0.6517541, 'auroc': 0.80991197, 'binary_precision': 0.41784036, 'binary_recall': 0.26448736, 'binary_specificity': 0.9862733, 'binary_f1_score': 0.32393083}
confusion matrix:
       0    1
0  17819  248
1    495  178
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9548824, 'precision': 0.6925778, 'recall': 0.5939455, 'specificity': 0.5939455, 'f1': 0.62377715, 'auroc': 0.7530992, 'binary_precision': 0.41935483, 'binary_recall': 0.2, 'binary_specificity': 0.987891, 'binary_f1_score': 0.27083334}
confusion matrix:
      0   1
0  5874  72
1   208  52
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546986_7.png
new oracle model saved
early stop counter: 5
val acc:0.9603521823883057, best validation acc: 0.9639807939529419, corresponding to test acc:                         0.9524653553962708 / 0.9548823833465576
after epoch: 7,now: 2024-06-22 22:13:03.825261,epoch time: 0:17:44.511046,used: 2:00:42.217985,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_20_12_21_seed_1_21546986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9925942, 'precision': 0.9781356, 'recall': 0.97773814, 'specificity': 0.97773814, 'f1': 0.97793674, 'auroc': 0.9978497, 'binary_precision': 0.9603983, 'binary_recall': 0.9595095, 'binary_specificity': 0.9959668, 'binary_f1_score': 0.95995367}
confusion matrix:
       0     1
0  42227   171
1    175  4147
---- Validation: 
scalar performance:
{'acc': 0.96205974, 'precision': 0.71409184, 'recall': 0.63484913, 'specificity': 0.63484913, 'f1': 0.6643827, 'auroc': 0.8115441, 'binary_precision': 0.45454547, 'binary_recall': 0.28231797, 'binary_specificity': 0.9873803, 'binary_f1_score': 0.3483043}
confusion matrix:
       0    1
0  17839  228
1    483  190
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9569771, 'precision': 0.7231152, 'recall': 0.6336574, 'specificity': 0.6336574, 'f1': 0.66562957, 'auroc': 0.8177697, 'binary_precision': 0.47712418, 'binary_recall': 0.28076923, 'binary_specificity': 0.98654556, 'binary_f1_score': 0.3535109}
confusion matrix:
      0   1
0  5866  80
1   187  73
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546986_8.png
new oracle model saved
early stop counter: 6
val acc:0.962059736251831, best validation acc: 0.9639807939529419, corresponding to test acc:                         0.9524653553962708 / 0.956977128982544
after epoch: 8,now: 2024-06-22 22:29:53.291859,epoch time: 0:16:49.466598,used: 2:17:31.684583,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_20_12_21_seed_1_21546986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9907748, 'precision': 0.9897212, 'recall': 0.9549179, 'specificity': 0.9549179, 'f1': 0.9715205, 'auroc': 0.9937091, 'binary_precision': 0.98845094, 'binary_recall': 0.91092086, 'binary_specificity': 0.998915, 'binary_f1_score': 0.94810355}
confusion matrix:
       0     1
0  42352    46
1    385  3937
---- Validation: 
scalar performance:
{'acc': 0.96334046, 'precision': 0.7103945, 'recall': 0.54825073, 'specificity': 0.54825073, 'f1': 0.57325387, 'auroc': 0.73527676, 'binary_precision': 0.45333335, 'binary_recall': 0.10104012, 'binary_specificity': 0.99546134, 'binary_f1_score': 0.1652491}
confusion matrix:
       0   1
0  17985  82
1    605  68
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589107, 'precision': 0.7556634, 'recall': 0.55191207, 'specificity': 0.55191207, 'f1': 0.57949585, 'auroc': 0.7253406, 'binary_precision': 0.54901963, 'binary_recall': 0.10769231, 'binary_specificity': 0.99613184, 'binary_f1_score': 0.18006432}
confusion matrix:
      0   1
0  5923  23
1   232  28
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546986_9.png
new oracle model saved
early stop counter: 7
val acc:0.9633404612541199, best validation acc: 0.9639807939529419, corresponding to test acc:                         0.9524653553962708 / 0.9589107036590576
after epoch: 9,now: 2024-06-22 22:46:33.086037,epoch time: 0:16:39.794178,used: 2:34:11.478761,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_20_12_21_seed_1_21546986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.96851456, 'precision': 0.87564516, 'recall': 0.97434795, 'specificity': 0.97434795, 'f1': 0.917366, 'auroc': 0.99668884, 'binary_precision': 0.75323755, 'binary_recall': 0.9815072, 'binary_specificity': 0.9671888, 'binary_f1_score': 0.8523537}
confusion matrix:
       0     1
0  41003  1391
1     80  4246
---- Validation: 
scalar performance:
{'acc': 0.9221451, 'precision': 0.6061121, 'recall': 0.7207233, 'specificity': 0.7207233, 'f1': 0.63799304, 'auroc': 0.8278412, 'binary_precision': 0.23155738, 'binary_recall': 0.5037147, 'binary_specificity': 0.9377318, 'binary_f1_score': 0.3172672}
confusion matrix:
       0     1
0  16942  1125
1    334   339
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91153723, 'precision': 0.5992733, 'recall': 0.69085944, 'specificity': 0.69085944, 'f1': 0.6258205, 'auroc': 0.8065716, 'binary_precision': 0.22370937, 'binary_recall': 0.45, 'binary_specificity': 0.9317188, 'binary_f1_score': 0.29885057}
confusion matrix:
      0    1
0  5540  406
1   143  117
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546986_10.png
early stop counter: 8
val acc:0.9221451282501221, best validation acc: 0.9639807939529419, corresponding to test acc:                         0.9524653553962708 / 0.9589107036590576
after epoch: 10,now: 2024-06-22 23:03:17.049464,epoch time: 0:16:43.963427,used: 2:50:55.442188,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_20_12_21_seed_1_21546986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9922517, 'precision': 0.976663, 'recall': 0.9772566, 'specificity': 0.9772566, 'f1': 0.9769596, 'auroc': 0.9970837, 'binary_precision': 0.9575254, 'binary_recall': 0.9588534, 'binary_specificity': 0.99565977, 'binary_f1_score': 0.95818895}
confusion matrix:
       0     1
0  42210   184
1    178  4148
---- Validation: 
scalar performance:
{'acc': 0.95848453, 'precision': 0.6687896, 'recall': 0.60009265, 'specificity': 0.60009265, 'f1': 0.62440175, 'auroc': 0.7594276, 'binary_precision': 0.36641222, 'binary_recall': 0.21396731, 'binary_specificity': 0.986218, 'binary_f1_score': 0.27016887}
confusion matrix:
       0    1
0  17818  249
1    529  144
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9429584, 'precision': 0.5898907, 'recall': 0.55829906, 'specificity': 0.55829906, 'f1': 0.5697398, 'auroc': 0.71439314, 'binary_precision': 0.21686748, 'binary_recall': 0.13846155, 'binary_specificity': 0.97813654, 'binary_f1_score': 0.1690141}
confusion matrix:
      0    1
0  5816  130
1   224   36
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546986_11.png
early stop counter: 9
val acc:0.9584845304489136, best validation acc: 0.9639807939529419, corresponding to test acc:                         0.9524653553962708 / 0.9589107036590576
after epoch: 11,now: 2024-06-22 23:20:00.990690,epoch time: 0:16:43.941226,used: 3:07:39.383414,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_20_12_21_seed_1_21546986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9910959, 'precision': 0.97386724, 'recall': 0.9730798, 'specificity': 0.9730798, 'f1': 0.9734731, 'auroc': 0.9954177, 'binary_precision': 0.952734, 'binary_recall': 0.9509713, 'binary_specificity': 0.99518824, 'binary_f1_score': 0.9518518}
confusion matrix:
       0     1
0  42192   204
1    212  4112
---- Validation: 
scalar performance:
{'acc': 0.95410883, 'precision': 0.642938, 'recall': 0.607837, 'specificity': 0.607837, 'f1': 0.6225093, 'auroc': 0.7652446, 'binary_precision': 0.31411532, 'binary_recall': 0.23476969, 'binary_specificity': 0.9809044, 'binary_f1_score': 0.26870748}
confusion matrix:
       0    1
0  17722  345
1    515  158
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9447309, 'precision': 0.6487286, 'recall': 0.6383005, 'specificity': 0.6383005, 'f1': 0.6432861, 'auroc': 0.7697424, 'binary_precision': 0.32780084, 'binary_recall': 0.30384615, 'binary_specificity': 0.9727548, 'binary_f1_score': 0.31536925}
confusion matrix:
      0    1
0  5784  162
1   181   79
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546986_12.png
early stop counter: 10
val acc:0.9541088342666626, best validation acc: 0.9639807939529419, corresponding to test acc:                         0.9524653553962708 / 0.9589107036590576
after epoch: 12,now: 2024-06-22 23:36:42.201065,epoch time: 0:16:41.210375,used: 3:24:20.593789,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_20_12_21_seed_1_21546986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9906464, 'precision': 0.9651252, 'recall': 0.98041606, 'specificity': 0.98041606, 'f1': 0.97261405, 'auroc': 0.99711686, 'binary_precision': 0.9335415, 'binary_recall': 0.9678613, 'binary_specificity': 0.9929709, 'binary_f1_score': 0.95039165}
confusion matrix:
       0     1
0  42097   298
1    139  4186
---- Validation: 
scalar performance:
{'acc': 0.9505336, 'precision': 0.64959687, 'recall': 0.65962785, 'specificity': 0.65962785, 'f1': 0.6544209, 'auroc': 0.8214967, 'binary_precision': 0.3236111, 'binary_recall': 0.346211, 'binary_specificity': 0.97304475, 'binary_f1_score': 0.3345298}
confusion matrix:
       0    1
0  17580  487
1    440  233
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9437641, 'precision': 0.6515621, 'recall': 0.6543468, 'specificity': 0.6543468, 'f1': 0.65293914, 'auroc': 0.8192712, 'binary_precision': 0.33207548, 'binary_recall': 0.33846155, 'binary_specificity': 0.97023207, 'binary_f1_score': 0.33523813}
confusion matrix:
      0    1
0  5769  177
1   172   88
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546986_13.png
early stop counter: 11
val acc:0.9505336284637451, best validation acc: 0.9639807939529419, corresponding to test acc:                         0.9524653553962708 / 0.9589107036590576
after epoch: 13,now: 2024-06-22 23:53:22.689302,epoch time: 0:16:40.488237,used: 3:41:01.082026,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_20_12_21_seed_1_21546986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
