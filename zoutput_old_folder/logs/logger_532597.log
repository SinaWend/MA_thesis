Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0




!!!: not committed yet



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512110

 Experiment start at: 2024-06-19 23:10:44.364402
before training, model accuracy: 0.31128156185150146
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9055651, 'precision': 0.45278254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4752213, 'auroc': 0.56384283, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42308  0
1   4412  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.32663167, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.27492243, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512110_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-19 23:29:11.756542,epoch time: 0:18:27.392140,used: 0:18:27.392140,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512110
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9055223, 'precision': 0.45276114, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.47520947, 'auroc': 0.76628613, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42306  0
1   4414  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.38266477, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.429048, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512110_2.png
early stop counter: 1
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 2,now: 2024-06-19 23:46:21.834700,epoch time: 0:17:10.078158,used: 0:35:37.470298,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512110
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9100599, 'precision': 0.941485, 'recall': 0.5246233, 'specificity': 0.5246233, 'f1': 0.5233437, 'auroc': 0.8811139, 'binary_precision': 0.97321427, 'binary_recall': 0.049388308, 'binary_specificity': 0.9998582, 'binary_f1_score': 0.09400603}
confusion matrix:
       0    1
0  42300    6
1   4196  218
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.4653631, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.62688875, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512110_3.png
early stop counter: 2
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 3,now: 2024-06-20 00:05:04.838144,epoch time: 0:18:43.003444,used: 0:54:20.473742,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512110
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.92848885, 'precision': 0.9459952, 'recall': 0.6254506, 'specificity': 0.6254506, 'f1': 0.68070287, 'auroc': 0.9092257, 'binary_precision': 0.9644097, 'binary_recall': 0.25187033, 'binary_specificity': 0.99903095, 'binary_f1_score': 0.3994248}
confusion matrix:
       0     1
0  42268    41
1   3300  1111
---- Validation: 
scalar performance:
{'acc': 0.9653576, 'precision': 0.48288438, 'recall': 0.4997796, 'specificity': 0.4997796, 'f1': 0.49118674, 'auroc': 0.52247864, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9995592, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18141  8
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.81262994, 'recall': 0.50374806, 'specificity': 0.50374806, 'f1': 0.49696523, 'auroc': 0.7007961, 'binary_precision': 0.6666667, 'binary_recall': 0.007662835, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.015151515}
confusion matrix:
      0  1
0  5996  1
1   259  2
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512110_4.png
new oracle model saved
early stop counter: 3
val acc:0.9653576016426086, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9584531784057617
after epoch: 4,now: 2024-06-20 00:22:20.975633,epoch time: 0:17:16.137489,used: 1:11:36.611231,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512110
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.941738, 'precision': 0.946131, 'recall': 0.70086193, 'specificity': 0.70086193, 'f1': 0.7678711, 'auroc': 0.9261377, 'binary_precision': 0.9509072, 'binary_recall': 0.40389845, 'binary_specificity': 0.99782544, 'binary_f1_score': 0.5669742}
confusion matrix:
       0     1
0  42216    92
1   2630  1782
---- Validation: 
scalar performance:
{'acc': 0.964453, 'precision': 0.5174013, 'recall': 0.5008114, 'specificity': 0.5008114, 'f1': 0.49392766, 'auroc': 0.53340137, 'binary_precision': 0.06896552, 'binary_recall': 0.00311042, 'binary_specificity': 0.9985123, 'binary_f1_score': 0.005952381}
confusion matrix:
       0   1
0  18122  27
1    641   2
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.79723823, 'recall': 0.53548133, 'specificity': 0.53548133, 'f1': 0.55494446, 'auroc': 0.71334267, 'binary_precision': 0.6333333, 'binary_recall': 0.07279693, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.1305842}
confusion matrix:
      0   1
0  5986  11
1   242  19
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512110_5.png
new oracle model saved
early stop counter: 4
val acc:0.9644529819488525, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9595717191696167
after epoch: 5,now: 2024-06-20 00:41:03.393854,epoch time: 0:18:42.418221,used: 1:30:19.029452,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512110
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9495077, 'precision': 0.945896, 'recall': 0.74636465, 'specificity': 0.74636465, 'f1': 0.81126654, 'auroc': 0.9367697, 'binary_precision': 0.9418855, 'binary_recall': 0.4959202, 'binary_specificity': 0.9968091, 'binary_f1_score': 0.64974016}
confusion matrix:
       0     1
0  42173   135
1   2224  2188
---- Validation: 
scalar performance:
{'acc': 0.9636015, 'precision': 0.5396071, 'recall': 0.50337076, 'specificity': 0.50337076, 'f1': 0.49934936, 'auroc': 0.61004114, 'binary_precision': 0.11320755, 'binary_recall': 0.00933126, 'binary_specificity': 0.9974103, 'binary_f1_score': 0.01724138}
confusion matrix:
       0   1
0  18102  47
1    637   6
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.7967518, 'recall': 0.5821234, 'specificity': 0.5821234, 'f1': 0.62295926, 'auroc': 0.7748344, 'binary_precision': 0.62857145, 'binary_recall': 0.16858238, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.26586103}
confusion matrix:
      0   1
0  5971  26
1   217  44
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512110_6.png
new oracle model saved
early stop counter: 5
val acc:0.9636015295982361, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9611697196960449
after epoch: 6,now: 2024-06-20 00:57:06.112857,epoch time: 0:16:02.719003,used: 1:46:21.748455,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512110
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9552868, 'precision': 0.9424081, 'recall': 0.7832036, 'specificity': 0.7832036, 'f1': 0.8413842, 'auroc': 0.9426725, 'binary_precision': 0.92783505, 'binary_recall': 0.5710401, 'binary_specificity': 0.99536717, 'binary_f1_score': 0.70697147}
confusion matrix:
       0     1
0  42111   196
1   1893  2520
---- Validation: 
scalar performance:
{'acc': 0.96184546, 'precision': 0.54038966, 'recall': 0.50621194, 'specificity': 0.50621194, 'f1': 0.505155, 'auroc': 0.6187627, 'binary_precision': 0.114583336, 'binary_recall': 0.01710731, 'binary_specificity': 0.99531657, 'binary_f1_score': 0.029769959}
confusion matrix:
       0   1
0  18064  85
1    632  11
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96356666, 'precision': 0.8129693, 'recall': 0.6291824, 'specificity': 0.6291824, 'f1': 0.6791419, 'auroc': 0.7915778, 'binary_precision': 0.6571429, 'binary_recall': 0.26436782, 'binary_specificity': 0.993997, 'binary_f1_score': 0.37704918}
confusion matrix:
      0   1
0  5961  36
1   192  69
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512110_7.png
new oracle model saved
early stop counter: 6
val acc:0.9618454575538635, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9635666608810425
after epoch: 7,now: 2024-06-20 01:15:56.512224,epoch time: 0:18:50.399367,used: 2:05:12.147822,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512110
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9582192, 'precision': 0.93404627, 'recall': 0.8076992, 'specificity': 0.8076992, 'f1': 0.85753834, 'auroc': 0.95044476, 'binary_precision': 0.9062706, 'binary_recall': 0.62211144, 'binary_specificity': 0.993287, 'binary_f1_score': 0.7377754}
confusion matrix:
       0     1
0  42022   284
1   1668  2746
---- Validation: 
scalar performance:
{'acc': 0.9601426, 'precision': 0.56784433, 'recall': 0.51733124, 'specificity': 0.51733124, 'f1': 0.52344203, 'auroc': 0.6287744, 'binary_precision': 0.16875, 'binary_recall': 0.041990668, 'binary_specificity': 0.9926718, 'binary_f1_score': 0.06724782}
confusion matrix:
       0    1
0  18016  133
1    616   27
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96228826, 'precision': 0.78213537, 'recall': 0.6468388, 'specificity': 0.6468388, 'f1': 0.69077325, 'auroc': 0.7859607, 'binary_precision': 0.59398496, 'binary_recall': 0.30268198, 'binary_specificity': 0.9909955, 'binary_f1_score': 0.40101522}
confusion matrix:
      0   1
0  5943  54
1   182  79
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512110_8.png
early stop counter: 7
val acc:0.9601426124572754, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9635666608810425
after epoch: 8,now: 2024-06-20 01:31:03.611551,epoch time: 0:15:07.099327,used: 2:20:19.247149,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512110
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.96147263, 'precision': 0.93668526, 'recall': 0.82607174, 'specificity': 0.82607174, 'f1': 0.87140274, 'auroc': 0.95670986, 'binary_precision': 0.9079563, 'binary_recall': 0.6591166, 'binary_specificity': 0.99302685, 'binary_f1_score': 0.7637796}
confusion matrix:
       0     1
0  42010   295
1   1505  2910
---- Validation: 
scalar performance:
{'acc': 0.9597169, 'precision': 0.5770444, 'recall': 0.5223612, 'specificity': 0.5223612, 'f1': 0.5309153, 'auroc': 0.66505945, 'binary_precision': 0.18681319, 'binary_recall': 0.05287714, 'binary_specificity': 0.9918453, 'binary_f1_score': 0.082424246}
confusion matrix:
       0    1
0  18001  148
1    609   34
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645254, 'precision': 0.80258083, 'recall': 0.67365867, 'specificity': 0.67365867, 'f1': 0.7187737, 'auroc': 0.8075762, 'binary_precision': 0.63265306, 'binary_recall': 0.35632184, 'binary_specificity': 0.9909955, 'binary_f1_score': 0.45588234}
confusion matrix:
      0   1
0  5943  54
1   168  93
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512110_9.png
new oracle model saved
early stop counter: 8
val acc:0.9597169160842896, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9645254015922546
after epoch: 9,now: 2024-06-20 01:47:27.153075,epoch time: 0:16:23.541524,used: 2:36:42.788673,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512110
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.96078765, 'precision': 0.9246149, 'recall': 0.83268356, 'specificity': 0.83268356, 'f1': 0.87165874, 'auroc': 0.95473254, 'binary_precision': 0.8823355, 'binary_recall': 0.6747507, 'binary_specificity': 0.99061644, 'binary_f1_score': 0.76470584}
confusion matrix:
       0     1
0  41911   397
1   1435  2977
---- Validation: 
scalar performance:
{'acc': 0.9590783, 'precision': 0.5894337, 'recall': 0.5310313, 'specificity': 0.5310313, 'f1': 0.542956, 'auroc': 0.65467465, 'binary_precision': 0.21100917, 'binary_recall': 0.071539655, 'binary_specificity': 0.9905229, 'binary_f1_score': 0.10685249}
confusion matrix:
       0    1
0  17977  172
1    597   46
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96260786, 'precision': 0.7750621, 'recall': 0.68914914, 'specificity': 0.68914914, 'f1': 0.72318965, 'auroc': 0.80683696, 'binary_precision': 0.5762712, 'binary_recall': 0.3908046, 'binary_specificity': 0.98749375, 'binary_f1_score': 0.4657534}
confusion matrix:
      0    1
0  5922   75
1   159  102
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512110_10.png
early stop counter: 9
val acc:0.959078311920166, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9645254015922546
after epoch: 10,now: 2024-06-20 02:02:55.311594,epoch time: 0:15:28.158519,used: 2:52:10.947192,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512110
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96078765, 'precision': 0.9240364, 'recall': 0.8333658, 'specificity': 0.8333658, 'f1': 0.87189806, 'auroc': 0.95270884, 'binary_precision': 0.88105077, 'binary_recall': 0.6762574, 'binary_specificity': 0.99047416, 'binary_f1_score': 0.7651884}
confusion matrix:
       0     1
0  41903   403
1   1429  2985
---- Validation: 
scalar performance:
{'acc': 0.95902514, 'precision': 0.6013353, 'recall': 0.5385043, 'specificity': 0.5385043, 'f1': 0.5530022, 'auroc': 0.6650254, 'binary_precision': 0.23430963, 'binary_recall': 0.08709176, 'binary_specificity': 0.9899168, 'binary_f1_score': 0.12698413}
confusion matrix:
       0    1
0  17966  183
1    587   56
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96340686, 'precision': 0.77835786, 'recall': 0.7133864, 'specificity': 0.7133864, 'f1': 0.7410481, 'auroc': 0.82084525, 'binary_precision': 0.5808081, 'binary_recall': 0.44061303, 'binary_specificity': 0.98615974, 'binary_f1_score': 0.50108933}
confusion matrix:
      0    1
0  5914   83
1   146  115
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512110_11.png
early stop counter: 10
val acc:0.9590251445770264, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9645254015922546
after epoch: 11,now: 2024-06-20 02:20:53.434560,epoch time: 0:17:58.122966,used: 3:10:09.070158,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512110
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.96393406, 'precision': 0.9205665, 'recall': 0.8582047, 'specificity': 0.8582047, 'f1': 0.8862298, 'auroc': 0.96047795, 'binary_precision': 0.86904764, 'binary_recall': 0.72784954, 'binary_specificity': 0.98855984, 'binary_f1_score': 0.7922062}
confusion matrix:
       0     1
0  41823   484
1   1201  3212
---- Validation: 
scalar performance:
{'acc': 0.95838654, 'precision': 0.6099724, 'recall': 0.54867446, 'specificity': 0.54867446, 'f1': 0.5652569, 'auroc': 0.6904174, 'binary_precision': 0.25089607, 'binary_recall': 0.108864695, 'binary_specificity': 0.9884842, 'binary_f1_score': 0.15184382}
confusion matrix:
       0    1
0  17940  209
1    573   70
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.965644, 'precision': 0.79661214, 'recall': 0.72738, 'specificity': 0.72738, 'f1': 0.7568792, 'auroc': 0.8276955, 'binary_precision': 0.61616164, 'binary_recall': 0.46743295, 'binary_specificity': 0.987327, 'binary_f1_score': 0.53159046}
confusion matrix:
      0    1
0  5921   76
1   139  122
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512110_12.png
new oracle model saved
early stop counter: 11
val acc:0.9583865404129028, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9656440019607544
after epoch: 12,now: 2024-06-20 02:35:12.095457,epoch time: 0:14:18.660897,used: 3:24:27.731055,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512110
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.96545374, 'precision': 0.9237352, 'recall': 0.8649006, 'specificity': 0.8649006, 'f1': 0.89154387, 'auroc': 0.9673014, 'binary_precision': 0.87406415, 'binary_recall': 0.74093384, 'binary_specificity': 0.98886734, 'binary_f1_score': 0.8020118}
confusion matrix:
       0     1
0  41837   471
1   1143  3269
---- Validation: 
scalar performance:
{'acc': 0.9581737, 'precision': 0.6167879, 'recall': 0.5560648, 'specificity': 0.5560648, 'f1': 0.57384, 'auroc': 0.72114897, 'binary_precision': 0.2640264, 'binary_recall': 0.1244168, 'binary_specificity': 0.9877128, 'binary_f1_score': 0.16913319}
confusion matrix:
       0    1
0  17926  223
1    563   80
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96644294, 'precision': 0.7964727, 'recall': 0.7571142, 'specificity': 0.7571142, 'f1': 0.7752224, 'auroc': 0.8398113, 'binary_precision': 0.61333334, 'binary_recall': 0.52873564, 'binary_specificity': 0.98549277, 'binary_f1_score': 0.56790125}
confusion matrix:
      0    1
0  5910   87
1   123  138
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512110_13.png
new oracle model saved
early stop counter: 12
val acc:0.9581736922264099, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9664429426193237
after epoch: 13,now: 2024-06-20 02:50:16.396673,epoch time: 0:15:04.301216,used: 3:39:32.032271,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512110
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96429795, 'precision': 0.91354287, 'recall': 0.8693201, 'specificity': 0.8693201, 'f1': 0.88984215, 'auroc': 0.9665539, 'binary_precision': 0.85263157, 'binary_recall': 0.75220835, 'binary_specificity': 0.98643184, 'binary_f1_score': 0.79927796}
confusion matrix:
       0     1
0  41731   574
1   1094  3321
---- Validation: 
scalar performance:
{'acc': 0.9556194, 'precision': 0.6077077, 'recall': 0.56374305, 'specificity': 0.56374305, 'f1': 0.57896924, 'auroc': 0.71131665, 'binary_precision': 0.24533333, 'binary_recall': 0.14307931, 'binary_specificity': 0.9844068, 'binary_f1_score': 0.18074656}
confusion matrix:
       0    1
0  17866  283
1    551   92
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9613295, 'precision': 0.75805247, 'recall': 0.7599432, 'specificity': 0.7599432, 'f1': 0.7589939, 'auroc': 0.8417108, 'binary_precision': 0.53612167, 'binary_recall': 0.54022986, 'binary_specificity': 0.9796565, 'binary_f1_score': 0.5381679}
confusion matrix:
      0    1
0  5875  122
1   120  141
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512110_14.png
early stop counter: 13
val acc:0.9556193947792053, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9664429426193237
after epoch: 14,now: 2024-06-20 03:05:18.585444,epoch time: 0:15:02.188771,used: 3:54:34.221042,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512110
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9641481, 'precision': 0.9090386, 'recall': 0.87423414, 'specificity': 0.87423414, 'f1': 0.8906487, 'auroc': 0.96589494, 'binary_precision': 0.84253937, 'binary_recall': 0.7633605, 'binary_specificity': 0.9851078, 'binary_f1_score': 0.80099803}
confusion matrix:
       0     1
0  41674   630
1   1045  3371
---- Validation: 
scalar performance:
{'acc': 0.9548744, 'precision': 0.6154925, 'recall': 0.57760847, 'specificity': 0.57760847, 'f1': 0.5921263, 'auroc': 0.73579204, 'binary_precision': 0.25995317, 'binary_recall': 0.1726283, 'binary_specificity': 0.9825886, 'binary_f1_score': 0.20747663}
confusion matrix:
       0    1
0  17833  316
1    532  111
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9613295, 'precision': 0.75817144, 'recall': 0.7562785, 'specificity': 0.7562785, 'f1': 0.757221, 'auroc': 0.84454554, 'binary_precision': 0.53667957, 'binary_recall': 0.532567, 'binary_specificity': 0.97999, 'binary_f1_score': 0.5346154}
confusion matrix:
      0    1
0  5877  120
1   122  139
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512110_15.png
early stop counter: 14
val acc:0.9548743963241577, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9664429426193237
after epoch: 15,now: 2024-06-20 03:21:49.951541,epoch time: 0:16:31.366097,used: 4:11:05.587139,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512110
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9658818, 'precision': 0.9175172, 'recall': 0.8752612, 'specificity': 0.8752612, 'f1': 0.8949573, 'auroc': 0.96843386, 'binary_precision': 0.8594029, 'binary_recall': 0.7635457, 'binary_specificity': 0.98697674, 'binary_f1_score': 0.8086434}
confusion matrix:
       0     1
0  41758   551
1   1043  3368
---- Validation: 
scalar performance:
{'acc': 0.9543955, 'precision': 0.6097937, 'recall': 0.5736102, 'specificity': 0.5736102, 'f1': 0.5874232, 'auroc': 0.7342781, 'binary_precision': 0.2488263, 'binary_recall': 0.16485226, 'binary_specificity': 0.9823682, 'binary_f1_score': 0.19831619}
confusion matrix:
       0    1
0  17829  320
1    537  106
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.7570355, 'recall': 0.7598598, 'specificity': 0.7598598, 'f1': 0.7584388, 'auroc': 0.8491519, 'binary_precision': 0.53409094, 'binary_recall': 0.54022986, 'binary_specificity': 0.97948974, 'binary_f1_score': 0.5371429}
confusion matrix:
      0    1
0  5874  123
1   120  141
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512110_16.png
early stop counter: 15
val acc:0.9543954730033875, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9664429426193237
after epoch: 16,now: 2024-06-20 03:36:47.906335,epoch time: 0:14:57.954794,used: 4:26:03.541933,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512110
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9661601, 'precision': 0.9192482, 'recall': 0.8751904, 'specificity': 0.8751904, 'f1': 0.8956671, 'auroc': 0.9703763, 'binary_precision': 0.86292595, 'binary_recall': 0.7630267, 'binary_specificity': 0.98735404, 'binary_f1_score': 0.8099073}
confusion matrix:
       0     1
0  41771   535
1   1046  3368
---- Validation: 
scalar performance:
{'acc': 0.95843977, 'precision': 0.62654245, 'recall': 0.5637031, 'specificity': 0.5637031, 'f1': 0.58298975, 'auroc': 0.72240126, 'binary_precision': 0.28301886, 'binary_recall': 0.1399689, 'binary_specificity': 0.9874373, 'binary_f1_score': 0.1873049}
confusion matrix:
       0    1
0  17921  228
1    553   90
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96612334, 'precision': 0.7954211, 'recall': 0.7496181, 'specificity': 0.7496181, 'f1': 0.77035975, 'auroc': 0.8410361, 'binary_precision': 0.61187214, 'binary_recall': 0.51341, 'binary_specificity': 0.98582625, 'binary_f1_score': 0.55833334}
confusion matrix:
      0    1
0  5912   85
1   127  134
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512110_17.png
early stop counter: 16
val acc:0.9584397673606873, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9664429426193237
after epoch: 17,now: 2024-06-20 03:51:30.362341,epoch time: 0:14:42.456006,used: 4:40:45.997939,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512110
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9669092, 'precision': 0.91821766, 'recall': 0.88164115, 'specificity': 0.88164115, 'f1': 0.8988646, 'auroc': 0.96907234, 'binary_precision': 0.8595083, 'binary_recall': 0.7765186, 'binary_specificity': 0.9867637, 'binary_f1_score': 0.81590855}
confusion matrix:
       0     1
0  41748   560
1    986  3426
---- Validation: 
scalar performance:
{'acc': 0.95732224, 'precision': 0.61917776, 'recall': 0.56462467, 'specificity': 0.56462467, 'f1': 0.5823494, 'auroc': 0.7145946, 'binary_precision': 0.2682216, 'binary_recall': 0.14307931, 'binary_specificity': 0.98617005, 'binary_f1_score': 0.18661258}
confusion matrix:
       0    1
0  17898  251
1    551   92
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9637264, 'precision': 0.77511424, 'recall': 0.75386447, 'specificity': 0.75386447, 'f1': 0.76400656, 'auroc': 0.84077096, 'binary_precision': 0.5708333, 'binary_recall': 0.5249042, 'binary_specificity': 0.98282474, 'binary_f1_score': 0.54690623}
confusion matrix:
      0    1
0  5894  103
1   124  137
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512110_18.png
early stop counter: 17
val acc:0.9573222398757935, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9664429426193237
after epoch: 18,now: 2024-06-20 04:05:53.676514,epoch time: 0:14:23.314173,used: 4:55:09.312112,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512110
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.96686643, 'precision': 0.91282403, 'recall': 0.8886918, 'specificity': 0.8886918, 'f1': 0.9002931, 'auroc': 0.97023153, 'binary_precision': 0.8471785, 'binary_recall': 0.792299, 'binary_specificity': 0.98508453, 'binary_f1_score': 0.81882024}
confusion matrix:
       0     1
0  41674   631
1    917  3498
---- Validation: 
scalar performance:
{'acc': 0.9562048, 'precision': 0.6135048, 'recall': 0.5662963, 'specificity': 0.5662963, 'f1': 0.58252877, 'auroc': 0.71138734, 'binary_precision': 0.25675675, 'binary_recall': 0.14774494, 'binary_specificity': 0.98484766, 'binary_f1_score': 0.1875617}
confusion matrix:
       0    1
0  17874  275
1    548   95
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645254, 'precision': 0.7794212, 'recall': 0.7671077, 'specificity': 0.7671077, 'f1': 0.7731076, 'auroc': 0.84024376, 'binary_precision': 0.57831323, 'binary_recall': 0.55172414, 'binary_specificity': 0.98249125, 'binary_f1_score': 0.5647059}
confusion matrix:
      0    1
0  5892  105
1   117  144
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512110_19.png
early stop counter: 18
val acc:0.9562047719955444, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9664429426193237
after epoch: 19,now: 2024-06-20 04:21:02.693568,epoch time: 0:15:09.017054,used: 5:10:18.329166,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512110
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9671019, 'precision': 0.91395986, 'recall': 0.88862675, 'specificity': 0.88862675, 'f1': 0.9007822, 'auroc': 0.97277844, 'binary_precision': 0.84946495, 'binary_recall': 0.79188395, 'binary_specificity': 0.98536956, 'binary_f1_score': 0.8196644}
confusion matrix:
       0     1
0  41690   619
1    918  3493
---- Validation: 
scalar performance:
{'acc': 0.9551937, 'precision': 0.624031, 'recall': 0.5867744, 'specificity': 0.5867744, 'f1': 0.60151595, 'auroc': 0.7496288, 'binary_precision': 0.2764045, 'binary_recall': 0.19129083, 'binary_specificity': 0.98225796, 'binary_f1_score': 0.22610295}
confusion matrix:
       0    1
0  17827  322
1    520  123
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96292746, 'precision': 0.7676012, 'recall': 0.7754356, 'specificity': 0.7754356, 'f1': 0.77145416, 'auroc': 0.8549907, 'binary_precision': 0.55390334, 'binary_recall': 0.57088125, 'binary_specificity': 0.97999, 'binary_f1_score': 0.5622642}
confusion matrix:
      0    1
0  5877  120
1   112  149
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512110_20.png
early stop counter: 19
val acc:0.9551936984062195, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9664429426193237
after epoch: 20,now: 2024-06-20 04:35:29.546424,epoch time: 0:14:26.852856,used: 5:24:45.182022,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512110
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.97009844, 'precision': 0.92787015, 'recall': 0.89181805, 'specificity': 0.89181805, 'f1': 0.90883684, 'auroc': 0.9742977, 'binary_precision': 0.8769039, 'binary_recall': 0.7952899, 'binary_specificity': 0.9883463, 'binary_f1_score': 0.8341052}
confusion matrix:
       0     1
0  41811   493
1    904  3512
---- Validation: 
scalar performance:
{'acc': 0.95721585, 'precision': 0.6244134, 'recall': 0.57132006, 'specificity': 0.57132006, 'f1': 0.5894074, 'auroc': 0.7375231, 'binary_precision': 0.27823693, 'binary_recall': 0.15707621, 'binary_specificity': 0.98556393, 'binary_f1_score': 0.20079523}
confusion matrix:
       0    1
0  17887  262
1    542  101
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96676254, 'precision': 0.7974871, 'recall': 0.7646103, 'specificity': 0.7646103, 'f1': 0.7799685, 'auroc': 0.84867084, 'binary_precision': 0.6147186, 'binary_recall': 0.5440613, 'binary_specificity': 0.9851592, 'binary_f1_score': 0.5772358}
confusion matrix:
      0    1
0  5908   89
1   119  142
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512110_21.png
new oracle model saved
early stop counter: 20
val acc:0.9572158455848694, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9667625427246094
after epoch: 21,now: 2024-06-20 04:50:11.956396,epoch time: 0:14:42.409972,used: 5:39:27.591994,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512110
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9672731, 'precision': 0.905818, 'recall': 0.9019409, 'specificity': 0.9019409, 'f1': 0.9038674, 'auroc': 0.97417164, 'binary_precision': 0.83024055, 'binary_recall': 0.8213962, 'binary_specificity': 0.9824856, 'binary_f1_score': 0.8257947}
confusion matrix:
       0     1
0  41567   741
1    788  3624
---- Validation: 
scalar performance:
{'acc': 0.9543955, 'precision': 0.6255891, 'recall': 0.5953618, 'specificity': 0.5953618, 'f1': 0.6080335, 'auroc': 0.74882853, 'binary_precision': 0.27892563, 'binary_recall': 0.20995334, 'binary_specificity': 0.9807703, 'binary_f1_score': 0.23957409}
confusion matrix:
       0    1
0  17800  349
1    508  135
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.7678106, 'recall': 0.78834534, 'specificity': 0.78834534, 'f1': 0.77764606, 'auroc': 0.8582407, 'binary_precision': 0.5531915, 'binary_recall': 0.59770113, 'binary_specificity': 0.9789895, 'binary_f1_score': 0.5745856}
confusion matrix:
      0    1
0  5871  126
1   105  156
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512110_22.png
early stop counter: 21
val acc:0.9543954730033875, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9667625427246094
after epoch: 22,now: 2024-06-20 05:05:22.515700,epoch time: 0:15:10.559304,used: 5:54:38.151298,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512110
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9637842, 'precision': 0.8880314, 'recall': 0.90541315, 'specificity': 0.90541315, 'f1': 0.896474, 'auroc': 0.97618103, 'binary_precision': 0.7935275, 'binary_recall': 0.8334466, 'binary_specificity': 0.9773796, 'binary_f1_score': 0.81299734}
confusion matrix:
       0     1
0  41350   957
1    735  3678
---- Validation: 
scalar performance:
{'acc': 0.9521605, 'precision': 0.6226816, 'recall': 0.6077057, 'specificity': 0.6077057, 'f1': 0.61461484, 'auroc': 0.75395525, 'binary_precision': 0.27224198, 'binary_recall': 0.23794712, 'binary_specificity': 0.9774643, 'binary_f1_score': 0.2539419}
confusion matrix:
       0    1
0  17740  409
1    490  153
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.7487781, 'recall': 0.7957561, 'specificity': 0.7957561, 'f1': 0.7699368, 'auroc': 0.8635678, 'binary_precision': 0.514377, 'binary_recall': 0.61685824, 'binary_specificity': 0.974654, 'binary_f1_score': 0.5609756}
confusion matrix:
      0    1
0  5845  152
1   100  161
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512110_23.png
early stop counter: 22
val acc:0.9521604776382446, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9667625427246094
after epoch: 23,now: 2024-06-20 05:20:01.751109,epoch time: 0:14:39.235409,used: 6:09:17.386707,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512110
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.96472603, 'precision': 0.89396435, 'recall': 0.9020964, 'specificity': 0.9020964, 'f1': 0.89797646, 'auroc': 0.9722597, 'binary_precision': 0.8062445, 'binary_recall': 0.8248754, 'binary_specificity': 0.97931737, 'binary_f1_score': 0.8154535}
confusion matrix:
       0     1
0  41431   875
1    773  3641
---- Validation: 
scalar performance:
{'acc': 0.95258623, 'precision': 0.6139241, 'recall': 0.5906749, 'specificity': 0.5906749, 'f1': 0.6007173, 'auroc': 0.73428917, 'binary_precision': 0.2559055, 'binary_recall': 0.2021773, 'binary_specificity': 0.9791724, 'binary_f1_score': 0.22589053}
confusion matrix:
       0    1
0  17771  378
1    513  130
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95733464, 'precision': 0.7367758, 'recall': 0.79084086, 'specificity': 0.79084086, 'f1': 0.7606056, 'auroc': 0.8567885, 'binary_precision': 0.49074075, 'binary_recall': 0.6091954, 'binary_specificity': 0.97248626, 'binary_f1_score': 0.5435898}
confusion matrix:
      0    1
0  5832  165
1   102  159
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512110_24.png
early stop counter: 23
val acc:0.9525862336158752, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9667625427246094
after epoch: 24,now: 2024-06-20 05:34:11.892245,epoch time: 0:14:10.141136,used: 6:23:27.527843,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512110
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.964512, 'precision': 0.8899746, 'recall': 0.90789884, 'specificity': 0.90789884, 'f1': 0.8986743, 'auroc': 0.9768007, 'binary_precision': 0.7969423, 'binary_recall': 0.83808875, 'binary_specificity': 0.97770894, 'binary_f1_score': 0.8169978}
confusion matrix:
       0     1
0  41361   943
1    715  3701
---- Validation: 
scalar performance:
{'acc': 0.9529055, 'precision': 0.62869096, 'recall': 0.61259174, 'specificity': 0.61259174, 'f1': 0.6200067, 'auroc': 0.7628733, 'binary_precision': 0.28392857, 'binary_recall': 0.24727838, 'binary_specificity': 0.9779051, 'binary_f1_score': 0.26433915}
confusion matrix:
       0    1
0  17748  401
1    484  159
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959412, 'precision': 0.74709654, 'recall': 0.793757, 'specificity': 0.793757, 'f1': 0.76811093, 'auroc': 0.8639307, 'binary_precision': 0.5111821, 'binary_recall': 0.6130268, 'binary_specificity': 0.97448725, 'binary_f1_score': 0.5574913}
confusion matrix:
      0    1
0  5844  153
1   101  160
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512110_25.png
early stop counter: 24
val acc:0.9529054760932922, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9667625427246094
after epoch: 25,now: 2024-06-20 05:48:23.314487,epoch time: 0:14:11.422242,used: 6:37:38.950085,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512110
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.96500427, 'precision': 0.89007664, 'recall': 0.9116855, 'specificity': 0.9116855, 'f1': 0.9005012, 'auroc': 0.9774244, 'binary_precision': 0.7963318, 'binary_recall': 0.8459447, 'binary_specificity': 0.97742635, 'binary_f1_score': 0.8203889}
confusion matrix:
       0     1
0  41351   955
1    680  3734
---- Validation: 
scalar performance:
{'acc': 0.954023, 'precision': 0.6304626, 'recall': 0.6064198, 'specificity': 0.6064198, 'f1': 0.6170044, 'auroc': 0.7536329, 'binary_precision': 0.28790787, 'binary_recall': 0.2332815, 'binary_specificity': 0.9795581, 'binary_f1_score': 0.25773197}
confusion matrix:
       0    1
0  17778  371
1    493  150
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96292746, 'precision': 0.76673275, 'recall': 0.79009426, 'specificity': 0.79009426, 'f1': 0.7778549, 'auroc': 0.8621399, 'binary_precision': 0.5508772, 'binary_recall': 0.6015326, 'binary_specificity': 0.978656, 'binary_f1_score': 0.5750916}
confusion matrix:
      0    1
0  5869  128
1   104  157
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512110_26.png
early stop counter: 25
val acc:0.954023003578186, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9667625427246094
after epoch: 26,now: 2024-06-20 06:06:34.624537,epoch time: 0:18:11.310050,used: 6:55:50.260135,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512110
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.96643835, 'precision': 0.89589584, 'recall': 0.9123587, 'specificity': 0.9123587, 'f1': 0.90390927, 'auroc': 0.97690797, 'binary_precision': 0.80796707, 'binary_recall': 0.8456832, 'binary_specificity': 0.9790342, 'binary_f1_score': 0.826395}
confusion matrix:
       0     1
0  41420   887
1    681  3732
---- Validation: 
scalar performance:
{'acc': 0.9546083, 'precision': 0.6257836, 'recall': 0.5939719, 'specificity': 0.5939719, 'f1': 0.60716003, 'auroc': 0.7445252, 'binary_precision': 0.27941176, 'binary_recall': 0.20684293, 'binary_specificity': 0.9811009, 'binary_f1_score': 0.23771225}
confusion matrix:
       0    1
0  17806  343
1    510  133
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96340686, 'precision': 0.7697892, 'recall': 0.78851205, 'specificity': 0.78851205, 'f1': 0.7787932, 'auroc': 0.8603114, 'binary_precision': 0.55714285, 'binary_recall': 0.59770113, 'binary_specificity': 0.97932297, 'binary_f1_score': 0.57670975}
confusion matrix:
      0    1
0  5873  124
1   105  156
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512110_27.png
early stop counter: 26
val acc:0.9546083211898804, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9667625427246094
after epoch: 27,now: 2024-06-20 06:21:35.125679,epoch time: 0:15:00.501142,used: 7:10:50.761277,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512110
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9658818, 'precision': 0.897253, 'recall': 0.905455, 'specificity': 0.905455, 'f1': 0.9012997, 'auroc': 0.97542715, 'binary_precision': 0.8121816, 'binary_recall': 0.830954, 'binary_specificity': 0.97995603, 'binary_f1_score': 0.8214606}
confusion matrix:
       0     1
0  41459   848
1    746  3667
---- Validation: 
scalar performance:
{'acc': 0.95226693, 'precision': 0.62774134, 'recall': 0.61601144, 'specificity': 0.61601144, 'f1': 0.6215422, 'auroc': 0.7601272, 'binary_precision': 0.28178695, 'binary_recall': 0.25505444, 'binary_specificity': 0.9769684, 'binary_f1_score': 0.26775512}
confusion matrix:
       0    1
0  17731  418
1    479  164
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.74440414, 'recall': 0.8080822, 'specificity': 0.8080822, 'f1': 0.77200794, 'auroc': 0.86669326, 'binary_precision': 0.5045045, 'binary_recall': 0.6436782, 'binary_specificity': 0.97248626, 'binary_f1_score': 0.5656566}
confusion matrix:
      0    1
0  5832  165
1    93  168
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512110_28.png
early stop counter: 27
val acc:0.9522669315338135, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9667625427246094
after epoch: 28,now: 2024-06-20 06:37:29.572361,epoch time: 0:15:54.446682,used: 7:26:45.207959,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512110
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9672303, 'precision': 0.8984071, 'recall': 0.9140984, 'specificity': 0.9140984, 'f1': 0.906056, 'auroc': 0.97644556, 'binary_precision': 0.81267637, 'binary_recall': 0.8485947, 'binary_specificity': 0.979602, 'binary_f1_score': 0.8302473}
confusion matrix:
       0     1
0  41445   863
1    668  3744
---- Validation: 
scalar performance:
{'acc': 0.95391655, 'precision': 0.6290373, 'recall': 0.6048646, 'specificity': 0.6048646, 'f1': 0.6154782, 'auroc': 0.75200284, 'binary_precision': 0.2851638, 'binary_recall': 0.23017107, 'binary_specificity': 0.9795581, 'binary_f1_score': 0.25473323}
confusion matrix:
       0    1
0  17778  371
1    495  148
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96244806, 'precision': 0.7638593, 'recall': 0.78984416, 'specificity': 0.78984416, 'f1': 0.7761558, 'auroc': 0.8637569, 'binary_precision': 0.5451389, 'binary_recall': 0.6015326, 'binary_specificity': 0.97815573, 'binary_f1_score': 0.57194895}
confusion matrix:
      0    1
0  5866  131
1   104  157
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512110_29.png
early stop counter: 28
val acc:0.9539165496826172, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9667625427246094
after epoch: 29,now: 2024-06-20 06:51:55.109080,epoch time: 0:14:25.536719,used: 7:41:10.744678,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512110
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9672731, 'precision': 0.9002092, 'recall': 0.9112973, 'specificity': 0.9112973, 'f1': 0.90565515, 'auroc': 0.97792006, 'binary_precision': 0.8169231, 'binary_recall': 0.84228414, 'binary_specificity': 0.98031056, 'binary_f1_score': 0.82940984}
confusion matrix:
       0     1
0  41474   833
1    696  3717
---- Validation: 
scalar performance:
{'acc': 0.95407623, 'precision': 0.6341047, 'recall': 0.6124478, 'specificity': 0.6124478, 'f1': 0.6221591, 'auroc': 0.76282513, 'binary_precision': 0.2947761, 'binary_recall': 0.24572317, 'binary_specificity': 0.9791724, 'binary_f1_score': 0.26802376}
confusion matrix:
       0    1
0  17771  378
1    485  158
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96324706, 'precision': 0.7681521, 'recall': 0.7994227, 'specificity': 0.7994227, 'f1': 0.78280497, 'auroc': 0.86658335, 'binary_precision': 0.552901, 'binary_recall': 0.62068963, 'binary_specificity': 0.97815573, 'binary_f1_score': 0.58483756}
confusion matrix:
      0    1
0  5866  131
1    99  162
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512110_30.png
early stop counter: 29
val acc:0.9540762305259705, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9667625427246094
after epoch: 30,now: 2024-06-20 07:07:05.461079,epoch time: 0:15:10.351999,used: 7:56:21.096677,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512110
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 7:56:21.096677 at 2024-06-20 07:07:05.461079
persisted model performance metric: 

scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.27492243, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
oracle model performance metric: 

scalar performance:
{'acc': 0.96676254, 'precision': 0.7974871, 'recall': 0.7646103, 'specificity': 0.7646103, 'f1': 0.7799685, 'auroc': 0.84867084, 'binary_precision': 0.6147186, 'binary_recall': 0.5440613, 'binary_specificity': 0.9851592, 'binary_f1_score': 0.5772358}
confusion matrix:
      0    1
0  5908   89
1   119  142
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_irm_resnet_different_bs128_lre4_classbalancing/rule_results/8.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_irm_resnet_different_bs128_lre4_classbalancing/rule_results/8.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_irm_resnet_different_bs128_lre4_classbalancing/confusion_matrix/8.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204097 KiB |   1730 MiB | 424469 GiB | 424468 GiB |
|       from large pool | 167936 KiB |   1660 MiB | 424349 GiB | 424349 GiB |
|       from small pool |  36161 KiB |     72 MiB |    119 GiB |    119 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 204097 KiB |   1730 MiB | 424469 GiB | 424468 GiB |
|       from large pool | 167936 KiB |   1660 MiB | 424349 GiB | 424349 GiB |
|       from small pool |  36161 KiB |     72 MiB |    119 GiB |    119 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201088 KiB |   1723 MiB | 424463 GiB | 424463 GiB |
|       from large pool | 165120 KiB |   1653 MiB | 424346 GiB | 424345 GiB |
|       from small pool |  35968 KiB |     71 MiB |    117 GiB |    117 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1876 MiB |   1876 MiB |   1876 MiB |      0 B   |
|       from large pool |   1802 MiB |   1802 MiB |   1802 MiB |      0 B   |
|       from small pool |     74 MiB |     74 MiB |     74 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 404158 KiB | 758032 KiB | 301036 GiB | 301036 GiB |
|       from large pool | 397312 KiB | 756864 KiB | 300912 GiB | 300911 GiB |
|       from small pool |   6846 KiB |  12716 KiB |    124 GiB |    124 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1194    |    1851    |   12614 K  |   12613 K  |
|       from large pool |      36    |      76    |    4030 K  |    4030 K  |
|       from small pool |    1158    |    1780    |    8584 K  |    8583 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1194    |    1851    |   12614 K  |   12613 K  |
|       from large pool |      36    |      76    |    4030 K  |    4030 K  |
|       from small pool |    1158    |    1780    |    8584 K  |    8583 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      50    |      50    |      50    |       0    |
|       from large pool |      13    |      13    |      13    |       0    |
|       from small pool |      37    |      37    |      37    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      41    |     382    |    7244 K  |    7244 K  |
|       from large pool |       5    |      10    |    1595 K  |    1595 K  |
|       from small pool |      36    |     377    |    5649 K  |    5649 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1730 MiB | 424469 GiB | 424469 GiB |
|       from large pool |  16640 KiB |   1660 MiB | 424349 GiB | 424349 GiB |
|       from small pool |      0 KiB |     72 MiB |    119 GiB |    119 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1730 MiB | 424469 GiB | 424469 GiB |
|       from large pool |  16640 KiB |   1660 MiB | 424349 GiB | 424349 GiB |
|       from small pool |      0 KiB |     72 MiB |    119 GiB |    119 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1723 MiB | 424463 GiB | 424463 GiB |
|       from large pool |  16640 KiB |   1653 MiB | 424346 GiB | 424346 GiB |
|       from small pool |      0 KiB |     71 MiB |    117 GiB |    117 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 608256 KiB |   1876 MiB |   1876 MiB |   1282 MiB |
|       from large pool | 565248 KiB |   1802 MiB |   1802 MiB |   1250 MiB |
|       from small pool |  43008 KiB |     74 MiB |     74 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 384768 KiB | 758032 KiB | 301037 GiB | 301036 GiB |
|       from large pool | 384768 KiB | 756864 KiB | 300912 GiB | 300912 GiB |
|       from small pool |      0 KiB |  14441 KiB |    124 GiB |    124 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1851    |   12614 K  |   12614 K  |
|       from large pool |       2    |      76    |    4030 K  |    4030 K  |
|       from small pool |       0    |    1780    |    8584 K  |    8584 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1851    |   12614 K  |   12614 K  |
|       from large pool |       2    |      76    |    4030 K  |    4030 K  |
|       from small pool |       0    |    1780    |    8584 K  |    8584 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      30    |      50    |      50    |      20    |
|       from large pool |       9    |      13    |      13    |       4    |
|       from small pool |      21    |      37    |      37    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     382    |    7244 K  |    7244 K  |
|       from large pool |       1    |      11    |    1595 K  |    1595 K  |
|       from small pool |       0    |     377    |    5649 K  |    5649 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1730 MiB | 424469 GiB | 424469 GiB |
|       from large pool |  16640 KiB |   1660 MiB | 424349 GiB | 424349 GiB |
|       from small pool |      0 KiB |     72 MiB |    119 GiB |    119 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1730 MiB | 424469 GiB | 424469 GiB |
|       from large pool |  16640 KiB |   1660 MiB | 424349 GiB | 424349 GiB |
|       from small pool |      0 KiB |     72 MiB |    119 GiB |    119 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1723 MiB | 424463 GiB | 424463 GiB |
|       from large pool |  16640 KiB |   1653 MiB | 424346 GiB | 424346 GiB |
|       from small pool |      0 KiB |     71 MiB |    117 GiB |    117 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 608256 KiB |   1876 MiB |   1876 MiB |   1282 MiB |
|       from large pool | 565248 KiB |   1802 MiB |   1802 MiB |   1250 MiB |
|       from small pool |  43008 KiB |     74 MiB |     74 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 384768 KiB | 758032 KiB | 301037 GiB | 301036 GiB |
|       from large pool | 384768 KiB | 756864 KiB | 300912 GiB | 300912 GiB |
|       from small pool |      0 KiB |  14441 KiB |    124 GiB |    124 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1851    |   12614 K  |   12614 K  |
|       from large pool |       2    |      76    |    4030 K  |    4030 K  |
|       from small pool |       0    |    1780    |    8584 K  |    8584 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1851    |   12614 K  |   12614 K  |
|       from large pool |       2    |      76    |    4030 K  |    4030 K  |
|       from small pool |       0    |    1780    |    8584 K  |    8584 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      30    |      50    |      50    |      20    |
|       from large pool |       9    |      13    |      13    |       4    |
|       from small pool |      21    |      37    |      37    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     382    |    7244 K  |    7244 K  |
|       from large pool |       1    |      11    |    1595 K  |    1595 K  |
|       from small pool |       0    |     377    |    5649 K  |    5649 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0




!!!: not committed yet



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_13_35_seed_1_21512110

 Experiment start at: 2024-06-20 07:13:35.046331
before training, model accuracy: 0.1456654816865921
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9074058, 'precision': 0.45374176, 'recall': 0.49995282, 'specificity': 0.49995282, 'f1': 0.4757277, 'auroc': 0.5184815, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99990565, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42394  4
1   4322  0
---- Validation: 
scalar performance:
{'acc': 0.96392745, 'precision': 0.48204088, 'recall': 0.49991697, 'specificity': 0.49991697, 'f1': 0.4908162, 'auroc': 0.32359585, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99983394, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18064  3
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.20952612, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512110_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-20 07:28:39.101484,epoch time: 0:15:04.055153,used: 0:15:04.055153,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_13_35_seed_1_21512110
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.907256, 'precision': 0.4537154, 'recall': 0.49989384, 'specificity': 0.49989384, 'f1': 0.47568655, 'auroc': 0.7179003, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9997877, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42387  9
1   4324  0
---- Validation: 
scalar performance:
{'acc': 0.96403414, 'precision': 0.4820428, 'recall': 0.4999723, 'specificity': 0.4999723, 'f1': 0.49084386, 'auroc': 0.36536747, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9999446, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18066  1
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.30281055, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512110_2.png
better model found
persisted
after epoch: 2,now: 2024-06-20 07:43:27.752896,epoch time: 0:14:48.651412,used: 0:29:52.706565,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_13_35_seed_1_21512110
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.90742725, 'precision': 0.6994706, 'recall': 0.5053775, 'specificity': 0.5053775, 'f1': 0.48744607, 'auroc': 0.8357208, 'binary_precision': 0.49056605, 'binary_recall': 0.012028684, 'binary_specificity': 0.9987263, 'binary_f1_score': 0.0234816}
confusion matrix:
       0   1
0  42343  54
1   4271  52
---- Validation: 
scalar performance:
{'acc': 0.96387404, 'precision': 0.48203993, 'recall': 0.4998893, 'specificity': 0.4998893, 'f1': 0.49080238, 'auroc': 0.40530095, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9997786, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18063  4
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.42878324, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512110_3.png
early stop counter: 1
val acc:0.9638740420341492, best validation acc: 0.9640341401100159, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 3,now: 2024-06-20 07:57:55.053146,epoch time: 0:14:27.300250,used: 0:44:20.006815,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_13_35_seed_1_21512110
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.91752994, 'precision': 0.86764044, 'recall': 0.5686895, 'specificity': 0.5686895, 'f1': 0.59814465, 'auroc': 0.87922883, 'binary_precision': 0.8161074, 'binary_recall': 0.14061055, 'binary_specificity': 0.99676853, 'binary_f1_score': 0.23988952}
confusion matrix:
       0    1
0  42259  137
1   3716  608
---- Validation: 
scalar performance:
{'acc': 0.96344715, 'precision': 0.48203224, 'recall': 0.4996679, 'specificity': 0.4996679, 'f1': 0.49069163, 'auroc': 0.44978702, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9993358, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18055  12
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.53844213, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512110_4.png
early stop counter: 2
val acc:0.9634471535682678, best validation acc: 0.9640341401100159, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 4,now: 2024-06-20 08:12:48.445316,epoch time: 0:14:53.392170,used: 0:59:13.398985,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_13_35_seed_1_21512110
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.93210614, 'precision': 0.9014864, 'recall': 0.6544179, 'specificity': 0.6544179, 'f1': 0.71234137, 'auroc': 0.90157723, 'binary_precision': 0.8686739, 'binary_recall': 0.31367105, 'binary_specificity': 0.99516475, 'binary_f1_score': 0.46091098}
confusion matrix:
       0     1
0  42192   205
1   2967  1356
---- Validation: 
scalar performance:
{'acc': 0.9626467, 'precision': 0.48201784, 'recall': 0.4992528, 'specificity': 0.4992528, 'f1': 0.49048397, 'auroc': 0.49387228, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9985056, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18040  27
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.63569367, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512110_5.png
early stop counter: 3
val acc:0.9626467227935791, best validation acc: 0.9640341401100159, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 5,now: 2024-06-20 08:30:52.454621,epoch time: 0:18:04.009305,used: 1:17:17.408290,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_13_35_seed_1_21512110
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9436644, 'precision': 0.9071398, 'recall': 0.72769696, 'specificity': 0.72769696, 'f1': 0.78646773, 'auroc': 0.9245876, 'binary_precision': 0.8666089, 'binary_recall': 0.46265897, 'binary_specificity': 0.99273497, 'binary_f1_score': 0.603256}
confusion matrix:
       0     1
0  42087   308
1   2324  2001
---- Validation: 
scalar performance:
{'acc': 0.96125937, 'precision': 0.49110857, 'recall': 0.4992485, 'specificity': 0.4992485, 'f1': 0.4914966, 'auroc': 0.51723444, 'binary_precision': 0.018181818, 'binary_recall': 0.0014858841, 'binary_specificity': 0.9970111, 'binary_f1_score': 0.0027472526}
confusion matrix:
       0   1
0  18013  54
1    672   1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9577828, 'precision': 0.6877489, 'recall': 0.50902677, 'specificity': 0.50902677, 'f1': 0.5075916, 'auroc': 0.6753881, 'binary_precision': 0.41666666, 'binary_recall': 0.01923077, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.036764707}
confusion matrix:
      0  1
0  5939  7
1   255  5
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512110_6.png
early stop counter: 4
val acc:0.9612593650817871, best validation acc: 0.9640341401100159, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 6,now: 2024-06-20 08:48:59.566987,epoch time: 0:18:07.112366,used: 1:35:24.520656,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_13_35_seed_1_21512110
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.95047086, 'precision': 0.91644764, 'recall': 0.76601475, 'specificity': 0.76601475, 'f1': 0.82085884, 'auroc': 0.935568, 'binary_precision': 0.87805796, 'binary_recall': 0.53967154, 'binary_specificity': 0.99235797, 'binary_f1_score': 0.6684814}
confusion matrix:
       0     1
0  42073   324
1   1990  2333
---- Validation: 
scalar performance:
{'acc': 0.9604055, 'precision': 0.49572575, 'recall': 0.499521, 'specificity': 0.499521, 'f1': 0.4925813, 'auroc': 0.5707942, 'binary_precision': 0.02739726, 'binary_recall': 0.0029717681, 'binary_specificity': 0.9960702, 'binary_f1_score': 0.0053619305}
confusion matrix:
       0   1
0  17996  71
1    671   2
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9585885, 'precision': 0.7531258, 'recall': 0.53335404, 'specificity': 0.53335404, 'f1': 0.55083025, 'auroc': 0.7489587, 'binary_precision': 0.54545456, 'binary_recall': 0.06923077, 'binary_specificity': 0.9974773, 'binary_f1_score': 0.12286689}
confusion matrix:
      0   1
0  5931  15
1   242  18
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512110_7.png
new oracle model saved
early stop counter: 5
val acc:0.9604055285453796, best validation acc: 0.9640341401100159, corresponding to test acc:                         0.9581050872802734 / 0.9585884809494019
after epoch: 7,now: 2024-06-20 09:07:39.563062,epoch time: 0:18:39.996075,used: 1:54:04.516731,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_13_35_seed_1_21512110
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.95297515, 'precision': 0.9286305, 'recall': 0.7731589, 'specificity': 0.7731589, 'f1': 0.8298044, 'auroc': 0.9357637, 'binary_precision': 0.90116936, 'binary_recall': 0.5524977, 'binary_specificity': 0.9938202, 'binary_f1_score': 0.68501794}
confusion matrix:
       0     1
0  42134   262
1   1935  2389
---- Validation: 
scalar performance:
{'acc': 0.96093917, 'precision': 0.51193714, 'recall': 0.5012283, 'specificity': 0.5012283, 'f1': 0.4954435, 'auroc': 0.60370004, 'binary_precision': 0.05970149, 'binary_recall': 0.0059435363, 'binary_specificity': 0.996513, 'binary_f1_score': 0.010810811}
confusion matrix:
       0   1
0  18004  63
1    669   4
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590719, 'precision': 0.75653267, 'recall': 0.5611911, 'specificity': 0.5611911, 'f1': 0.5926222, 'auroc': 0.7589608, 'binary_precision': 0.55, 'binary_recall': 0.12692308, 'binary_specificity': 0.99545914, 'binary_f1_score': 0.20625001}
confusion matrix:
      0   1
0  5919  27
1   227  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512110_8.png
new oracle model saved
early stop counter: 6
val acc:0.9609391689300537, best validation acc: 0.9640341401100159, corresponding to test acc:                         0.9581050872802734 / 0.9590718746185303
after epoch: 8,now: 2024-06-20 09:26:31.049088,epoch time: 0:18:51.486026,used: 2:12:56.002757,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_13_35_seed_1_21512110
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9570848, 'precision': 0.9307977, 'recall': 0.7979566, 'specificity': 0.7979566, 'f1': 0.849465, 'auroc': 0.9428433, 'binary_precision': 0.90079504, 'binary_recall': 0.6026827, 'binary_specificity': 0.9932305, 'binary_f1_score': 0.7221837}
confusion matrix:
       0     1
0  42109   287
1   1718  2606
---- Validation: 
scalar performance:
{'acc': 0.9590182, 'precision': 0.5256796, 'recall': 0.5045236, 'specificity': 0.5045236, 'f1': 0.50222486, 'auroc': 0.61812913, 'binary_precision': 0.08695652, 'binary_recall': 0.014858841, 'binary_specificity': 0.9941883, 'binary_f1_score': 0.02538071}
confusion matrix:
       0    1
0  17962  105
1    663   10
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96019983, 'precision': 0.7644797, 'recall': 0.6095934, 'specificity': 0.6095934, 'f1': 0.65139234, 'auroc': 0.7796489, 'binary_precision': 0.5619048, 'binary_recall': 0.22692308, 'binary_specificity': 0.99226373, 'binary_f1_score': 0.32328767}
confusion matrix:
      0   1
0  5900  46
1   201  59
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512110_9.png
new oracle model saved
early stop counter: 7
val acc:0.9590181708335876, best validation acc: 0.9640341401100159, corresponding to test acc:                         0.9581050872802734 / 0.9601998329162598
after epoch: 9,now: 2024-06-20 09:45:42.945571,epoch time: 0:19:11.896483,used: 2:32:07.899240,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_13_35_seed_1_21512110
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9588185, 'precision': 0.92156756, 'recall': 0.81741714, 'specificity': 0.81741714, 'f1': 0.8603695, 'auroc': 0.947464, 'binary_precision': 0.8784722, 'binary_recall': 0.6439149, 'binary_specificity': 0.9909194, 'binary_f1_score': 0.7431242}
confusion matrix:
       0     1
0  42013   385
1   1539  2783
---- Validation: 
scalar performance:
{'acc': 0.9578442, 'precision': 0.55305743, 'recall': 0.51321316, 'specificity': 0.51321316, 'f1': 0.5167326, 'auroc': 0.64758337, 'binary_precision': 0.1411043, 'binary_recall': 0.034175333, 'binary_specificity': 0.99225104, 'binary_f1_score': 0.05502392}
confusion matrix:
       0    1
0  17927  140
1    650   23
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96084434, 'precision': 0.7648761, 'recall': 0.6485485, 'specificity': 0.6485485, 'f1': 0.6883937, 'auroc': 0.793505, 'binary_precision': 0.55944055, 'binary_recall': 0.30769232, 'binary_specificity': 0.9894046, 'binary_f1_score': 0.39702234}
confusion matrix:
      0   1
0  5883  63
1   180  80
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512110_10.png
new oracle model saved
early stop counter: 8
val acc:0.9578441977500916, best validation acc: 0.9640341401100159, corresponding to test acc:                         0.9581050872802734 / 0.9608443379402161
after epoch: 10,now: 2024-06-20 10:02:38.058953,epoch time: 0:16:55.113382,used: 2:49:03.012622,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_13_35_seed_1_21512110
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9599743, 'precision': 0.9171163, 'recall': 0.829832, 'specificity': 0.829832, 'f1': 0.8671006, 'auroc': 0.9512108, 'binary_precision': 0.86710566, 'binary_recall': 0.67013645, 'binary_specificity': 0.9895276, 'binary_f1_score': 0.75600207}
confusion matrix:
       0     1
0  41953   444
1   1426  2897
---- Validation: 
scalar performance:
{'acc': 0.95522946, 'precision': 0.5682794, 'recall': 0.52616245, 'specificity': 0.52616245, 'f1': 0.53501064, 'auroc': 0.6626476, 'binary_precision': 0.17063493, 'binary_recall': 0.06389301, 'binary_specificity': 0.98843193, 'binary_f1_score': 0.09297297}
confusion matrix:
       0    1
0  17858  209
1    630   43
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959233, 'precision': 0.74584043, 'recall': 0.67713135, 'specificity': 0.67713135, 'f1': 0.7051596, 'auroc': 0.80801964, 'binary_precision': 0.51891893, 'binary_recall': 0.36923078, 'binary_specificity': 0.98503196, 'binary_f1_score': 0.43146068}
confusion matrix:
      0   1
0  5857  89
1   164  96
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512110_11.png
early stop counter: 9
val acc:0.9552294611930847, best validation acc: 0.9640341401100159, corresponding to test acc:                         0.9581050872802734 / 0.9608443379402161
after epoch: 11,now: 2024-06-20 10:20:15.107334,epoch time: 0:17:37.048381,used: 3:06:40.061003,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_13_35_seed_1_21512110
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9627783, 'precision': 0.9284811, 'recall': 0.83743775, 'specificity': 0.83743775, 'f1': 0.8762194, 'auroc': 0.95714617, 'binary_precision': 0.8884881, 'binary_recall': 0.6836263, 'binary_specificity': 0.9912492, 'binary_f1_score': 0.7727095}
confusion matrix:
       0     1
0  42025   371
1   1368  2956
---- Validation: 
scalar performance:
{'acc': 0.95763075, 'precision': 0.59106, 'recall': 0.52955365, 'specificity': 0.52955365, 'f1': 0.5410699, 'auroc': 0.6954482, 'binary_precision': 0.21596244, 'binary_recall': 0.068350665, 'binary_specificity': 0.99075663, 'binary_f1_score': 0.10383747}
confusion matrix:
       0    1
0  17900  167
1    627   46
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96422815, 'precision': 0.79183245, 'recall': 0.698128, 'specificity': 0.698128, 'f1': 0.73497266, 'auroc': 0.82599336, 'binary_precision': 0.6091954, 'binary_recall': 0.4076923, 'binary_specificity': 0.9885637, 'binary_f1_score': 0.4884793}
confusion matrix:
      0    1
0  5878   68
1   154  106
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512110_12.png
new oracle model saved
early stop counter: 10
val acc:0.9576307535171509, best validation acc: 0.9640341401100159, corresponding to test acc:                         0.9581050872802734 / 0.9642281532287598
after epoch: 12,now: 2024-06-20 10:37:29.848256,epoch time: 0:17:14.740922,used: 3:23:54.801925,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_13_35_seed_1_21512110
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9644478, 'precision': 0.93127227, 'recall': 0.84586865, 'specificity': 0.84586865, 'f1': 0.8827199, 'auroc': 0.9587009, 'binary_precision': 0.8924573, 'binary_recall': 0.7003468, 'binary_specificity': 0.99139047, 'binary_f1_score': 0.7848166}
confusion matrix:
       0     1
0  42030   365
1   1296  3029
---- Validation: 
scalar performance:
{'acc': 0.9572572, 'precision': 0.6022272, 'recall': 0.5379431, 'specificity': 0.5379431, 'f1': 0.55229604, 'auroc': 0.6839392, 'binary_precision': 0.23770492, 'binary_recall': 0.086181276, 'binary_specificity': 0.98970497, 'binary_f1_score': 0.12649944}
confusion matrix:
       0    1
0  17881  186
1    615   58
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650338, 'precision': 0.79653996, 'recall': 0.7114214, 'specificity': 0.7114214, 'f1': 0.746014, 'auroc': 0.8182045, 'binary_precision': 0.61748636, 'binary_recall': 0.43461537, 'binary_specificity': 0.98822737, 'binary_f1_score': 0.51015806}
confusion matrix:
      0    1
0  5876   70
1   147  113
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512110_13.png
new oracle model saved
early stop counter: 11
val acc:0.9572572112083435, best validation acc: 0.9640341401100159, corresponding to test acc:                         0.9581050872802734 / 0.9650338292121887
after epoch: 13,now: 2024-06-20 10:55:31.058373,epoch time: 0:18:01.210117,used: 3:41:56.012042,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_13_35_seed_1_21512110
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9630137, 'precision': 0.92677116, 'recall': 0.8406113, 'specificity': 0.8406113, 'f1': 0.8776574, 'auroc': 0.95978963, 'binary_precision': 0.8844102, 'binary_recall': 0.6904211, 'binary_specificity': 0.99080145, 'binary_f1_score': 0.7754678}
confusion matrix:
       0     1
0  42008   390
1   1338  2984
---- Validation: 
scalar performance:
{'acc': 0.95720387, 'precision': 0.6028323, 'recall': 0.5386307, 'specificity': 0.5386307, 'f1': 0.55316216, 'auroc': 0.68961006, 'binary_precision': 0.2388664, 'binary_recall': 0.08766716, 'binary_specificity': 0.9895943, 'binary_f1_score': 0.12826088}
confusion matrix:
       0    1
0  17879  188
1    614   59
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9653561, 'precision': 0.79656553, 'recall': 0.72262347, 'specificity': 0.72262347, 'f1': 0.7537041, 'auroc': 0.83018386, 'binary_precision': 0.6165803, 'binary_recall': 0.4576923, 'binary_specificity': 0.98755467, 'binary_f1_score': 0.5253863}
confusion matrix:
      0    1
0  5872   74
1   141  119
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512110_14.png
new oracle model saved
early stop counter: 12
val acc:0.9572038650512695, best validation acc: 0.9640341401100159, corresponding to test acc:                         0.9581050872802734 / 0.9653561115264893
after epoch: 14,now: 2024-06-20 11:14:55.480050,epoch time: 0:19:24.421677,used: 4:01:20.433719,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_13_35_seed_1_21512110
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9645762, 'precision': 0.92547464, 'recall': 0.85265446, 'specificity': 0.85265446, 'f1': 0.8847979, 'auroc': 0.95878386, 'binary_precision': 0.8794427, 'binary_recall': 0.7153099, 'binary_specificity': 0.98999906, 'binary_f1_score': 0.78893006}
confusion matrix:
       0     1
0  41972   424
1   1231  3093
---- Validation: 
scalar performance:
{'acc': 0.95522946, 'precision': 0.59710586, 'recall': 0.5447594, 'specificity': 0.5447594, 'f1': 0.55913216, 'auroc': 0.69341767, 'binary_precision': 0.22697368, 'binary_recall': 0.102526, 'binary_specificity': 0.98699284, 'binary_f1_score': 0.14124872}
confusion matrix:
       0    1
0  17832  235
1    604   69
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.962778, 'precision': 0.7726838, 'recall': 0.72311705, 'specificity': 0.72311705, 'f1': 0.74510455, 'auroc': 0.8262856, 'binary_precision': 0.5687204, 'binary_recall': 0.46153846, 'binary_specificity': 0.9846956, 'binary_f1_score': 0.50955415}
confusion matrix:
      0    1
0  5855   91
1   140  120
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512110_15.png
early stop counter: 13
val acc:0.9552294611930847, best validation acc: 0.9640341401100159, corresponding to test acc:                         0.9581050872802734 / 0.9653561115264893
after epoch: 15,now: 2024-06-20 11:34:10.196392,epoch time: 0:19:14.716342,used: 4:20:35.150061,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_13_35_seed_1_21512110
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9637628, 'precision': 0.9176612, 'recall': 0.85573685, 'specificity': 0.85573685, 'f1': 0.88358045, 'auroc': 0.95823777, 'binary_precision': 0.8630969, 'binary_recall': 0.72317296, 'binary_specificity': 0.9883008, 'binary_f1_score': 0.78696364}
confusion matrix:
       0     1
0  41900   496
1   1197  3127
---- Validation: 
scalar performance:
{'acc': 0.956937, 'precision': 0.6183581, 'recall': 0.5520824, 'specificity': 0.5520824, 'f1': 0.56994724, 'auroc': 0.70715857, 'binary_precision': 0.2689655, 'binary_recall': 0.11589896, 'binary_specificity': 0.9882659, 'binary_f1_score': 0.16199377}
confusion matrix:
       0    1
0  17855  212
1    595   78
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.965195, 'precision': 0.7921481, 'recall': 0.7335733, 'specificity': 0.7335733, 'f1': 0.7591996, 'auroc': 0.83887386, 'binary_precision': 0.60679615, 'binary_recall': 0.48076922, 'binary_specificity': 0.9863774, 'binary_f1_score': 0.53648067}
confusion matrix:
      0    1
0  5865   81
1   135  125
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512110_16.png
early stop counter: 14
val acc:0.9569370150566101, best validation acc: 0.9640341401100159, corresponding to test acc:                         0.9581050872802734 / 0.9653561115264893
after epoch: 16,now: 2024-06-20 11:53:18.404126,epoch time: 0:19:08.207734,used: 4:39:43.357795,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_13_35_seed_1_21512110
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9624786, 'precision': 0.9007038, 'recall': 0.8683492, 'specificity': 0.8683492, 'f1': 0.88365984, 'auroc': 0.9648644, 'binary_precision': 0.8263959, 'binary_recall': 0.75283235, 'binary_specificity': 0.98386604, 'binary_f1_score': 0.7879008}
confusion matrix:
       0     1
0  41711   684
1   1069  3256
---- Validation: 
scalar performance:
{'acc': 0.9527748, 'precision': 0.6010235, 'recall': 0.5606528, 'specificity': 0.5606528, 'f1': 0.57468116, 'auroc': 0.7145452, 'binary_precision': 0.23366834, 'binary_recall': 0.13818721, 'binary_specificity': 0.9831184, 'binary_f1_score': 0.17366947}
confusion matrix:
       0    1
0  17762  305
1    580   93
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96019983, 'precision': 0.7520516, 'recall': 0.7622293, 'specificity': 0.7622293, 'f1': 0.7570252, 'auroc': 0.847306, 'binary_precision': 0.52398527, 'binary_recall': 0.54615384, 'binary_specificity': 0.97830474, 'binary_f1_score': 0.53483987}
confusion matrix:
      0    1
0  5817  129
1   118  142
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512110_17.png
early stop counter: 15
val acc:0.9527748227119446, best validation acc: 0.9640341401100159, corresponding to test acc:                         0.9581050872802734 / 0.9653561115264893
after epoch: 17,now: 2024-06-20 12:14:23.131397,epoch time: 0:21:04.727271,used: 5:00:48.085066,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_13_35_seed_1_21512110
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.96393406, 'precision': 0.896712, 'recall': 0.8857131, 'specificity': 0.8857131, 'f1': 0.8911134, 'auroc': 0.968809, 'binary_precision': 0.81479716, 'binary_recall': 0.78972936, 'binary_specificity': 0.98169684, 'binary_f1_score': 0.8020674}
confusion matrix:
       0     1
0  41621   776
1    909  3414
---- Validation: 
scalar performance:
{'acc': 0.9508004, 'precision': 0.6041927, 'recall': 0.57464945, 'specificity': 0.57464945, 'f1': 0.58644116, 'auroc': 0.7280588, 'binary_precision': 0.2389937, 'binary_recall': 0.16939078, 'binary_specificity': 0.9799081, 'binary_f1_score': 0.19826084}
confusion matrix:
       0    1
0  17704  363
1    559  114
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589107, 'precision': 0.7448801, 'recall': 0.77442944, 'specificity': 0.77442944, 'f1': 0.7586881, 'auroc': 0.8500519, 'binary_precision': 0.5085324, 'binary_recall': 0.5730769, 'binary_specificity': 0.97578204, 'binary_f1_score': 0.53887886}
confusion matrix:
      0    1
0  5802  144
1   111  149
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512110_18.png
early stop counter: 16
val acc:0.9508004188537598, best validation acc: 0.9640341401100159, corresponding to test acc:                         0.9581050872802734 / 0.9653561115264893
after epoch: 18,now: 2024-06-20 12:32:56.431828,epoch time: 0:18:33.300431,used: 5:19:21.385497,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_13_35_seed_1_21512110
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9634418, 'precision': 0.89815766, 'recall': 0.8795214, 'specificity': 0.8795214, 'f1': 0.888554, 'auroc': 0.9676019, 'binary_precision': 0.8189802, 'binary_recall': 0.7765441, 'binary_specificity': 0.98249876, 'binary_f1_score': 0.7971978}
confusion matrix:
       0     1
0  41655   742
1    966  3357
---- Validation: 
scalar performance:
{'acc': 0.95325506, 'precision': 0.6152456, 'recall': 0.57377666, 'specificity': 0.57377666, 'f1': 0.5890539, 'auroc': 0.73458564, 'binary_precision': 0.26117647, 'binary_recall': 0.16493313, 'binary_specificity': 0.98262024, 'binary_f1_score': 0.20218578}
confusion matrix:
       0    1
0  17753  314
1    562  111
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96358365, 'precision': 0.77253824, 'recall': 0.78054607, 'specificity': 0.78054607, 'f1': 0.77647626, 'auroc': 0.8533696, 'binary_precision': 0.5634328, 'binary_recall': 0.58076924, 'binary_specificity': 0.9803229, 'binary_f1_score': 0.5719697}
confusion matrix:
      0    1
0  5829  117
1   109  151
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512110_19.png
early stop counter: 17
val acc:0.9532550573348999, best validation acc: 0.9640341401100159, corresponding to test acc:                         0.9581050872802734 / 0.9653561115264893
after epoch: 19,now: 2024-06-20 12:50:58.622129,epoch time: 0:18:02.190301,used: 5:37:23.575798,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_13_35_seed_1_21512110
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.96581763, 'precision': 0.90565395, 'recall': 0.8865915, 'specificity': 0.8865915, 'f1': 0.8958301, 'auroc': 0.9686371, 'binary_precision': 0.8326829, 'binary_recall': 0.78936416, 'binary_specificity': 0.9838188, 'binary_f1_score': 0.8104451}
confusion matrix:
       0     1
0  41709   686
1    911  3414
---- Validation: 
scalar performance:
{'acc': 0.95234793, 'precision': 0.61309004, 'recall': 0.57688254, 'specificity': 0.57688254, 'f1': 0.59082943, 'auroc': 0.7331916, 'binary_precision': 0.25663716, 'binary_recall': 0.17236255, 'binary_specificity': 0.9814026, 'binary_f1_score': 0.2062222}
confusion matrix:
       0    1
0  17731  336
1    557  116
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96165, 'precision': 0.7605684, 'recall': 0.775859, 'specificity': 0.775859, 'f1': 0.76796484, 'auroc': 0.8519975, 'binary_precision': 0.53985506, 'binary_recall': 0.5730769, 'binary_specificity': 0.9786411, 'binary_f1_score': 0.55597013}
confusion matrix:
      0    1
0  5819  127
1   111  149
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512110_20.png
early stop counter: 18
val acc:0.9523479342460632, best validation acc: 0.9640341401100159, corresponding to test acc:                         0.9581050872802734 / 0.9653561115264893
after epoch: 20,now: 2024-06-20 13:09:00.899777,epoch time: 0:18:02.277648,used: 5:55:25.853446,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_13_35_seed_1_21512110
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.96791524, 'precision': 0.9114429, 'recall': 0.8938271, 'specificity': 0.8938271, 'f1': 0.9023894, 'auroc': 0.97209966, 'binary_precision': 0.8428849, 'binary_recall': 0.8029146, 'binary_specificity': 0.9847395, 'binary_f1_score': 0.8224144}
confusion matrix:
       0     1
0  41750   647
1    852  3471
---- Validation: 
scalar performance:
{'acc': 0.9544824, 'precision': 0.6244593, 'recall': 0.576559, 'specificity': 0.576559, 'f1': 0.5937406, 'auroc': 0.74228466, 'binary_precision': 0.27941176, 'binary_recall': 0.16939078, 'binary_specificity': 0.9837272, 'binary_f1_score': 0.21091582}
confusion matrix:
       0    1
0  17773  294
1    559  114
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9660006, 'precision': 0.78956884, 'recall': 0.77996844, 'specificity': 0.77996844, 'f1': 0.78467727, 'auroc': 0.85372454, 'binary_precision': 0.5976096, 'binary_recall': 0.5769231, 'binary_specificity': 0.9830138, 'binary_f1_score': 0.5870842}
confusion matrix:
      0    1
0  5845  101
1   110  150
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512110_21.png
new oracle model saved
early stop counter: 19
val acc:0.95448237657547, best validation acc: 0.9640341401100159, corresponding to test acc:                         0.9581050872802734 / 0.9660006165504456
after epoch: 21,now: 2024-06-20 13:29:20.180195,epoch time: 0:20:19.280418,used: 6:15:45.133864,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_13_35_seed_1_21512110
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.96748716, 'precision': 0.91179454, 'recall': 0.890187, 'specificity': 0.890187, 'f1': 0.9006202, 'auroc': 0.97056866, 'binary_precision': 0.8443408, 'binary_recall': 0.7953284, 'binary_specificity': 0.98504573, 'binary_f1_score': 0.8191021}
confusion matrix:
       0     1
0  41762   634
1    885  3439
---- Validation: 
scalar performance:
{'acc': 0.9539488, 'precision': 0.6233453, 'recall': 0.57914335, 'specificity': 0.57914335, 'f1': 0.5955097, 'auroc': 0.7367605, 'binary_precision': 0.2769953, 'binary_recall': 0.17533432, 'binary_specificity': 0.98295236, 'binary_f1_score': 0.21474065}
confusion matrix:
       0    1
0  17759  308
1    555  118
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96422815, 'precision': 0.778041, 'recall': 0.76984847, 'specificity': 0.76984847, 'f1': 0.7738754, 'auroc': 0.8500848, 'binary_precision': 0.57539684, 'binary_recall': 0.5576923, 'binary_specificity': 0.9820047, 'binary_f1_score': 0.5664063}
confusion matrix:
      0    1
0  5839  107
1   115  145
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512110_22.png
early stop counter: 20
val acc:0.9539487957954407, best validation acc: 0.9640341401100159, corresponding to test acc:                         0.9581050872802734 / 0.9660006165504456
after epoch: 22,now: 2024-06-20 13:49:19.637548,epoch time: 0:19:59.457353,used: 6:35:44.591217,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_13_35_seed_1_21512110
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9673373, 'precision': 0.9095253, 'recall': 0.8924348, 'specificity': 0.8924348, 'f1': 0.9007478, 'auroc': 0.9707763, 'binary_precision': 0.83931166, 'binary_recall': 0.80050856, 'binary_specificity': 0.984361, 'binary_f1_score': 0.81945103}
confusion matrix:
       0     1
0  41731   663
1    863  3463
---- Validation: 
scalar performance:
{'acc': 0.9528815, 'precision': 0.6154359, 'recall': 0.57644403, 'specificity': 0.57644403, 'f1': 0.5911842, 'auroc': 0.73552406, 'binary_precision': 0.26136363, 'binary_recall': 0.17087667, 'binary_specificity': 0.9820114, 'binary_f1_score': 0.20664868}
confusion matrix:
       0    1
0  17742  325
1    558  115
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9622946, 'precision': 0.7645441, 'recall': 0.7761954, 'specificity': 0.7761954, 'f1': 0.7702267, 'auroc': 0.85544837, 'binary_precision': 0.5477941, 'binary_recall': 0.5730769, 'binary_specificity': 0.97931385, 'binary_f1_score': 0.5601503}
confusion matrix:
      0    1
0  5823  123
1   111  149
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512110_23.png
early stop counter: 21
val acc:0.9528815150260925, best validation acc: 0.9640341401100159, corresponding to test acc:                         0.9581050872802734 / 0.9660006165504456
after epoch: 23,now: 2024-06-20 14:14:39.422198,epoch time: 0:25:19.784650,used: 7:01:04.375867,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_13_35_seed_1_21512110
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.96496147, 'precision': 0.89263654, 'recall': 0.90117264, 'specificity': 0.90117264, 'f1': 0.89684534, 'auroc': 0.97014105, 'binary_precision': 0.80338603, 'binary_recall': 0.82289016, 'binary_specificity': 0.9794551, 'binary_f1_score': 0.8130211}
confusion matrix:
       0     1
0  41524   871
1    766  3559
---- Validation: 
scalar performance:
{'acc': 0.9519744, 'precision': 0.62155294, 'recall': 0.5909942, 'specificity': 0.5909942, 'f1': 0.603647, 'auroc': 0.7372215, 'binary_precision': 0.2725451, 'binary_recall': 0.20208023, 'binary_specificity': 0.9799081, 'binary_f1_score': 0.2320819}
confusion matrix:
       0    1
0  17704  363
1    537  136
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959233, 'precision': 0.74675363, 'recall': 0.78011465, 'specificity': 0.78011465, 'f1': 0.76221985, 'auroc': 0.8579433, 'binary_precision': 0.5117845, 'binary_recall': 0.5846154, 'binary_specificity': 0.97561383, 'binary_f1_score': 0.54578096}
confusion matrix:
      0    1
0  5801  145
1   108  152
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512110_24.png
early stop counter: 22
val acc:0.9519743919372559, best validation acc: 0.9640341401100159, corresponding to test acc:                         0.9581050872802734 / 0.9660006165504456
after epoch: 24,now: 2024-06-20 14:42:01.830566,epoch time: 0:27:22.408368,used: 7:28:26.784235,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_13_35_seed_1_21512110
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9665882, 'precision': 0.89954144, 'recall': 0.90227664, 'specificity': 0.90227664, 'f1': 0.900903, 'auroc': 0.97666657, 'binary_precision': 0.8171179, 'binary_recall': 0.8233526, 'binary_specificity': 0.98120064, 'binary_f1_score': 0.8202234}
confusion matrix:
       0     1
0  41598   797
1    764  3561
---- Validation: 
scalar performance:
{'acc': 0.95368195, 'precision': 0.6304417, 'recall': 0.59116447, 'specificity': 0.59116447, 'f1': 0.606687, 'auroc': 0.7446287, 'binary_precision': 0.29032257, 'binary_recall': 0.20059435, 'binary_specificity': 0.98173463, 'binary_f1_score': 0.23725836}
confusion matrix:
       0    1
0  17737  330
1    538  135
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96455044, 'precision': 0.7783879, 'recall': 0.78656757, 'specificity': 0.78656757, 'f1': 0.78241056, 'auroc': 0.8585138, 'binary_precision': 0.57462686, 'binary_recall': 0.5923077, 'binary_specificity': 0.98082745, 'binary_f1_score': 0.5833334}
confusion matrix:
      0    1
0  5832  114
1   106  154
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512110_25.png
early stop counter: 23
val acc:0.9536819458007812, best validation acc: 0.9640341401100159, corresponding to test acc:                         0.9581050872802734 / 0.9660006165504456
after epoch: 25,now: 2024-06-20 15:09:51.589293,epoch time: 0:27:49.758727,used: 7:56:16.542962,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_13_35_seed_1_21512110
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.96571064, 'precision': 0.89339554, 'recall': 0.90592647, 'specificity': 0.90592647, 'f1': 0.8995341, 'auroc': 0.9743638, 'binary_precision': 0.80393034, 'binary_recall': 0.83256245, 'binary_specificity': 0.9792905, 'binary_f1_score': 0.8179959}
confusion matrix:
       0     1
0  41518   878
1    724  3600
---- Validation: 
scalar performance:
{'acc': 0.95202774, 'precision': 0.6277926, 'recall': 0.60032034, 'specificity': 0.60032034, 'f1': 0.61208916, 'auroc': 0.7609092, 'binary_precision': 0.28435114, 'binary_recall': 0.22139673, 'binary_specificity': 0.97924393, 'binary_f1_score': 0.24895573}
confusion matrix:
       0    1
0  17692  375
1    524  149
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611666, 'precision': 0.7573891, 'recall': 0.7903186, 'specificity': 0.7903186, 'f1': 0.7727201, 'auroc': 0.86333346, 'binary_precision': 0.5322034, 'binary_recall': 0.60384613, 'binary_specificity': 0.97679114, 'binary_f1_score': 0.5657658}
confusion matrix:
      0    1
0  5808  138
1   103  157
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512110_26.png
early stop counter: 24
val acc:0.9520277380943298, best validation acc: 0.9640341401100159, corresponding to test acc:                         0.9581050872802734 / 0.9660006165504456
after epoch: 26,now: 2024-06-20 15:32:07.649376,epoch time: 0:22:16.060083,used: 8:18:32.603045,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_13_35_seed_1_21512110
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9629923, 'precision': 0.88014776, 'recall': 0.90899765, 'specificity': 0.90899765, 'f1': 0.89388543, 'auroc': 0.9726845, 'binary_precision': 0.7764756, 'binary_recall': 0.8427382, 'binary_specificity': 0.9752571, 'binary_f1_score': 0.8082511}
confusion matrix:
       0     1
0  41347  1049
1    680  3644
---- Validation: 
scalar performance:
{'acc': 0.94978654, 'precision': 0.62150884, 'recall': 0.60631067, 'specificity': 0.60631067, 'f1': 0.61330104, 'auroc': 0.747766, 'binary_precision': 0.27133107, 'binary_recall': 0.23625557, 'binary_specificity': 0.97636575, 'binary_f1_score': 0.25258142}
confusion matrix:
       0    1
0  17640  427
1    514  159
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95327103, 'precision': 0.72003317, 'recall': 0.7917152, 'specificity': 0.7917152, 'f1': 0.75000906, 'auroc': 0.8654629, 'binary_precision': 0.45714286, 'binary_recall': 0.61538464, 'binary_specificity': 0.9680458, 'binary_f1_score': 0.52459013}
confusion matrix:
      0    1
0  5756  190
1   100  160
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512110_27.png
early stop counter: 25
val acc:0.9497865438461304, best validation acc: 0.9640341401100159, corresponding to test acc:                         0.9581050872802734 / 0.9660006165504456
after epoch: 27,now: 2024-06-20 15:55:26.873593,epoch time: 0:23:19.224217,used: 8:41:51.827262,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_13_35_seed_1_21512110
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9610017, 'precision': 0.8767544, 'recall': 0.89834756, 'specificity': 0.89834756, 'f1': 0.88715935, 'auroc': 0.96726, 'binary_precision': 0.7718383, 'binary_recall': 0.8214616, 'binary_specificity': 0.9752335, 'binary_f1_score': 0.7958772}
confusion matrix:
       0     1
0  41346  1050
1    772  3552
---- Validation: 
scalar performance:
{'acc': 0.9495731, 'precision': 0.6126297, 'recall': 0.59332514, 'specificity': 0.59332514, 'f1': 0.601881, 'auroc': 0.7362478, 'binary_precision': 0.25451264, 'binary_recall': 0.20950966, 'binary_specificity': 0.97714067, 'binary_f1_score': 0.22982886}
confusion matrix:
       0    1
0  17654  413
1    532  141
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95617145, 'precision': 0.73203903, 'recall': 0.78771186, 'specificity': 0.78771186, 'f1': 0.756418, 'auroc': 0.86577916, 'binary_precision': 0.4815951, 'binary_recall': 0.60384613, 'binary_specificity': 0.9715775, 'binary_f1_score': 0.53583616}
confusion matrix:
      0    1
0  5777  169
1   103  157
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512110_28.png
early stop counter: 26
val acc:0.9495730996131897, best validation acc: 0.9640341401100159, corresponding to test acc:                         0.9581050872802734 / 0.9660006165504456
after epoch: 28,now: 2024-06-20 16:20:23.899688,epoch time: 0:24:57.026095,used: 9:06:48.853357,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_13_35_seed_1_21512110
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.96748716, 'precision': 0.89835, 'recall': 0.9112985, 'specificity': 0.9112985, 'f1': 0.9046908, 'auroc': 0.97822535, 'binary_precision': 0.8128211, 'binary_recall': 0.8423611, 'binary_specificity': 0.9802359, 'binary_f1_score': 0.82732755}
confusion matrix:
       0     1
0  41562   838
1    681  3639
---- Validation: 
scalar performance:
{'acc': 0.9524013, 'precision': 0.63144034, 'recall': 0.60337514, 'specificity': 0.60337514, 'f1': 0.6154202, 'auroc': 0.7551687, 'binary_precision': 0.29142857, 'binary_recall': 0.22734027, 'binary_specificity': 0.97941, 'binary_f1_score': 0.2554257}
confusion matrix:
       0    1
0  17695  372
1    520  153
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96100545, 'precision': 0.7564318, 'recall': 0.7957515, 'specificity': 0.7957515, 'f1': 0.77448654, 'auroc': 0.86719126, 'binary_precision': 0.5298013, 'binary_recall': 0.61538464, 'binary_specificity': 0.9761184, 'binary_f1_score': 0.569395}
confusion matrix:
      0    1
0  5804  142
1   100  160
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512110_29.png
early stop counter: 27
val acc:0.9524012804031372, best validation acc: 0.9640341401100159, corresponding to test acc:                         0.9581050872802734 / 0.9660006165504456
after epoch: 29,now: 2024-06-20 16:47:43.243465,epoch time: 0:27:19.343777,used: 9:34:08.197134,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_13_35_seed_1_21512110
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9627569, 'precision': 0.87773967, 'recall': 0.91217375, 'specificity': 0.91217375, 'f1': 0.8939762, 'auroc': 0.97426796, 'binary_precision': 0.7709251, 'binary_recall': 0.8501041, 'binary_specificity': 0.97424346, 'binary_f1_score': 0.8085809}
confusion matrix:
       0     1
0  41305  1092
1    648  3675
---- Validation: 
scalar performance:
{'acc': 0.9503202, 'precision': 0.63382125, 'recall': 0.62518436, 'specificity': 0.62518436, 'f1': 0.62933177, 'auroc': 0.7655393, 'binary_precision': 0.29458597, 'binary_recall': 0.27488855, 'binary_specificity': 0.97548014, 'binary_f1_score': 0.28439662}
confusion matrix:
       0    1
0  17624  443
1    488  185
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95681596, 'precision': 0.7362223, 'recall': 0.8064381, 'specificity': 0.8064381, 'f1': 0.7660623, 'auroc': 0.8718492, 'binary_precision': 0.4883041, 'binary_recall': 0.6423077, 'binary_specificity': 0.9705685, 'binary_f1_score': 0.5548173}
confusion matrix:
      0    1
0  5771  175
1    93  167
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512110_30.png
early stop counter: 28
val acc:0.9503201842308044, best validation acc: 0.9640341401100159, corresponding to test acc:                         0.9581050872802734 / 0.9660006165504456
after epoch: 30,now: 2024-06-20 17:16:18.908951,epoch time: 0:28:35.665486,used: 10:02:43.862620,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_13_35_seed_1_21512110
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 10:02:43.862620 at 2024-06-20 17:16:18.908951
persisted model performance metric: 

scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.30281055, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
oracle model performance metric: 

scalar performance:
{'acc': 0.9660006, 'precision': 0.78956884, 'recall': 0.77996844, 'specificity': 0.77996844, 'f1': 0.78467727, 'auroc': 0.85372454, 'binary_precision': 0.5976096, 'binary_recall': 0.5769231, 'binary_specificity': 0.9830138, 'binary_f1_score': 0.5870842}
confusion matrix:
      0    1
0  5845  101
1   110  150
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_irm_resnet_different_bs128_lre4_classbalancing/rule_results/8.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_irm_resnet_different_bs128_lre4_classbalancing/confusion_matrix/8.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204094 KiB |   1730 MiB |    828 TiB |    828 TiB |
|       from large pool | 167936 KiB |   1660 MiB |    828 TiB |    828 TiB |
|       from small pool |  36158 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 204094 KiB |   1730 MiB |    828 TiB |    828 TiB |
|       from large pool | 167936 KiB |   1660 MiB |    828 TiB |    828 TiB |
|       from small pool |  36158 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201086 KiB |   1723 MiB |    828 TiB |    828 TiB |
|       from large pool | 165120 KiB |   1653 MiB |    828 TiB |    828 TiB |
|       from small pool |  35966 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1802 MiB |   1876 MiB |   3084 MiB |   1282 MiB |
|       from large pool |   1728 MiB |   1802 MiB |   2978 MiB |   1250 MiB |
|       from small pool |     74 MiB |     74 MiB |    106 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 404161 KiB |    900 MiB | 626015 GiB | 626014 GiB |
|       from large pool | 397312 KiB |    899 MiB | 625765 GiB | 625765 GiB |
|       from small pool |   6849 KiB |     14 MiB |    249 GiB |    249 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1194    |    1851    |   25229 K  |   25228 K  |
|       from large pool |      36    |      76    |    8060 K  |    8060 K  |
|       from small pool |    1158    |    1780    |   17169 K  |   17168 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1194    |    1851    |   25229 K  |   25228 K  |
|       from large pool |      36    |      76    |    8060 K  |    8060 K  |
|       from small pool |    1158    |    1780    |   17169 K  |   17168 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      49    |      50    |      69    |      20    |
|       from large pool |      12    |      13    |      16    |       4    |
|       from small pool |      37    |      37    |      53    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      49    |     382    |   14477 K  |   14477 K  |
|       from large pool |       5    |      11    |    3213 K  |    3213 K  |
|       from small pool |      44    |     377    |   11264 K  |   11264 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1730 MiB |    828 TiB |    828 TiB |
|       from large pool |  16640 KiB |   1660 MiB |    828 TiB |    828 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1730 MiB |    828 TiB |    828 TiB |
|       from large pool |  16640 KiB |   1660 MiB |    828 TiB |    828 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1723 MiB |    828 TiB |    828 TiB |
|       from large pool |  16640 KiB |   1653 MiB |    828 TiB |    828 TiB |
|       from small pool |      0 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 608256 KiB |   1876 MiB |   3084 MiB |   2490 MiB |
|       from large pool | 565248 KiB |   1802 MiB |   2978 MiB |   2426 MiB |
|       from small pool |  43008 KiB |     74 MiB |    106 MiB |     64 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 384768 KiB |    900 MiB | 626015 GiB | 626014 GiB |
|       from large pool | 384768 KiB |    899 MiB | 625766 GiB | 625765 GiB |
|       from small pool |      0 KiB |     14 MiB |    249 GiB |    249 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1851    |   25229 K  |   25229 K  |
|       from large pool |       2    |      76    |    8060 K  |    8060 K  |
|       from small pool |       0    |    1780    |   17169 K  |   17169 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1851    |   25229 K  |   25229 K  |
|       from large pool |       2    |      76    |    8060 K  |    8060 K  |
|       from small pool |       0    |    1780    |   17169 K  |   17169 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      30    |      50    |      69    |      39    |
|       from large pool |       9    |      13    |      16    |       7    |
|       from small pool |      21    |      37    |      53    |      32    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     382    |   14477 K  |   14477 K  |
|       from large pool |       1    |      11    |    3213 K  |    3213 K  |
|       from small pool |       0    |     377    |   11264 K  |   11264 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1730 MiB |    828 TiB |    828 TiB |
|       from large pool |  16640 KiB |   1660 MiB |    828 TiB |    828 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1730 MiB |    828 TiB |    828 TiB |
|       from large pool |  16640 KiB |   1660 MiB |    828 TiB |    828 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1723 MiB |    828 TiB |    828 TiB |
|       from large pool |  16640 KiB |   1653 MiB |    828 TiB |    828 TiB |
|       from small pool |      0 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 608256 KiB |   1876 MiB |   3084 MiB |   2490 MiB |
|       from large pool | 565248 KiB |   1802 MiB |   2978 MiB |   2426 MiB |
|       from small pool |  43008 KiB |     74 MiB |    106 MiB |     64 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 384768 KiB |    900 MiB | 626015 GiB | 626014 GiB |
|       from large pool | 384768 KiB |    899 MiB | 625766 GiB | 625765 GiB |
|       from small pool |      0 KiB |     14 MiB |    249 GiB |    249 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1851    |   25229 K  |   25229 K  |
|       from large pool |       2    |      76    |    8060 K  |    8060 K  |
|       from small pool |       0    |    1780    |   17169 K  |   17169 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1851    |   25229 K  |   25229 K  |
|       from large pool |       2    |      76    |    8060 K  |    8060 K  |
|       from small pool |       0    |    1780    |   17169 K  |   17169 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      30    |      50    |      69    |      39    |
|       from large pool |       9    |      13    |      16    |       7    |
|       from small pool |      21    |      37    |      53    |      32    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     382    |   14477 K  |   14477 K  |
|       from large pool |       1    |      11    |    3213 K  |    3213 K  |
|       from small pool |       0    |     377    |   11264 K  |   11264 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0




!!!: not committed yet



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_27_39_seed_2_21512110

 Experiment start at: 2024-06-20 17:27:39.540415
before training, model accuracy: 0.0544959120452404
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9031122, 'precision': 0.4515561, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4745449, 'auroc': 0.5177046, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42309  0
1   4539  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.33149672, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.28049594, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512110_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-20 17:50:06.188674,epoch time: 0:22:26.648259,used: 0:22:26.648259,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_27_39_seed_2_21512110
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9031335, 'precision': 0.95156574, 'recall': 0.50011015, 'specificity': 0.50011015, 'f1': 0.4747705, 'auroc': 0.73113763, 'binary_precision': 1.0, 'binary_recall': 0.00022031284, 'binary_specificity': 1.0, 'binary_f1_score': 0.00044052862}
confusion matrix:
       0  1
0  42309  0
1   4538  1
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.37296134, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.40314165, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512110_2.png
early stop counter: 1
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 2,now: 2024-06-20 18:12:15.077288,epoch time: 0:22:08.888614,used: 0:44:35.536873,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_27_39_seed_2_21512110
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9059939, 'precision': 0.9492202, 'recall': 0.51496947, 'specificity': 0.51496947, 'f1': 0.50434864, 'auroc': 0.8533888, 'binary_precision': 0.99270076, 'binary_recall': 0.029962547, 'binary_specificity': 0.99997634, 'binary_f1_score': 0.058169372}
confusion matrix:
       0    1
0  42308    1
1   4403  136
---- Validation: 
scalar performance:
{'acc': 0.9678261, 'precision': 0.48396462, 'recall': 0.49994496, 'specificity': 0.49994496, 'f1': 0.49182498, 'auroc': 0.4391942, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998899, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18169  2
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.5855598, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512110_3.png
early stop counter: 2
val acc:0.9678261280059814, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 3,now: 2024-06-20 18:31:52.837775,epoch time: 0:19:37.760487,used: 1:04:13.297360,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_27_39_seed_2_21512110
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9239028, 'precision': 0.9383274, 'recall': 0.61220926, 'specificity': 0.61220926, 'f1': 0.66219705, 'auroc': 0.8948854, 'binary_precision': 0.9534451, 'binary_recall': 0.22560035, 'binary_specificity': 0.9988182, 'binary_f1_score': 0.36486727}
confusion matrix:
       0     1
0  42259    50
1   3515  1024
---- Validation: 
scalar performance:
{'acc': 0.96681404, 'precision': 0.48394838, 'recall': 0.49942216, 'specificity': 0.49942216, 'f1': 0.49156353, 'auroc': 0.5052944, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9988443, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18150  21
1    602   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96105146, 'precision': 0.48060277, 'recall': 0.4999166, 'specificity': 0.4999166, 'f1': 0.49006948, 'auroc': 0.685043, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5996  1
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512110_4.png
early stop counter: 3
val acc:0.9668140411376953, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 4,now: 2024-06-20 18:55:22.920461,epoch time: 0:23:30.082686,used: 1:27:43.380046,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_27_39_seed_2_21512110
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9402536, 'precision': 0.9450658, 'recall': 0.7011127, 'specificity': 0.7011127, 'f1': 0.7676827, 'auroc': 0.91611785, 'binary_precision': 0.9503106, 'binary_recall': 0.40449437, 'binary_specificity': 0.997731, 'binary_f1_score': 0.5674548}
confusion matrix:
       0     1
0  42213    96
1   2703  1836
---- Validation: 
scalar performance:
{'acc': 0.96569544, 'precision': 0.48393038, 'recall': 0.49884433, 'specificity': 0.49884433, 'f1': 0.49127418, 'auroc': 0.5598674, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99768865, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18129  42
1    602   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9623337, 'precision': 0.8236969, 'recall': 0.52635926, 'specificity': 0.52635926, 'f1': 0.5401907, 'auroc': 0.72639626, 'binary_precision': 0.68421054, 'binary_recall': 0.053719006, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.09961686}
confusion matrix:
      0   1
0  5991   6
1   229  13
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512110_5.png
new oracle model saved
early stop counter: 4
val acc:0.9656954407691956, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9623336791992188
after epoch: 5,now: 2024-06-20 19:19:27.024691,epoch time: 0:24:04.104230,used: 1:51:47.484276,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_27_39_seed_2_21512110
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9449923, 'precision': 0.938722, 'recall': 0.7313694, 'specificity': 0.7313694, 'f1': 0.7959908, 'auroc': 0.9246235, 'binary_precision': 0.9317782, 'binary_recall': 0.4664023, 'binary_specificity': 0.99633646, 'binary_f1_score': 0.62164146}
confusion matrix:
       0     1
0  42154   155
1   2422  2117
---- Validation: 
scalar performance:
{'acc': 0.96494967, 'precision': 0.48391837, 'recall': 0.49845907, 'specificity': 0.49845907, 'f1': 0.49108112, 'auroc': 0.57612216, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99691814, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18115  56
1    602   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650585, 'precision': 0.8488984, 'recall': 0.57734513, 'specificity': 0.57734513, 'f1': 0.62030554, 'auroc': 0.74719524, 'binary_precision': 0.7307692, 'binary_recall': 0.1570248, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.2585034}
confusion matrix:
      0   1
0  5983  14
1   204  38
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512110_6.png
new oracle model saved
early stop counter: 5
val acc:0.9649496674537659, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9650585055351257
after epoch: 6,now: 2024-06-20 19:42:28.551778,epoch time: 0:23:01.527087,used: 2:14:49.011363,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_27_39_seed_2_21512110
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.95163083, 'precision': 0.92569125, 'recall': 0.77969044, 'specificity': 0.77969044, 'f1': 0.8339268, 'auroc': 0.9348639, 'binary_precision': 0.89613104, 'binary_recall': 0.5664243, 'binary_specificity': 0.9929566, 'binary_f1_score': 0.69411445}
confusion matrix:
       0     1
0  42011   298
1   1968  2571
---- Validation: 
scalar performance:
{'acc': 0.96196663, 'precision': 0.53422153, 'recall': 0.5081608, 'specificity': 0.5081608, 'f1': 0.5091679, 'auroc': 0.6112036, 'binary_precision': 0.1, 'binary_recall': 0.023255814, 'binary_specificity': 0.9930659, 'binary_f1_score': 0.037735846}
confusion matrix:
       0    1
0  18045  126
1    588   14
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645777, 'precision': 0.7821768, 'recall': 0.6345945, 'specificity': 0.6345945, 'f1': 0.67961746, 'auroc': 0.77311385, 'binary_precision': 0.59292036, 'binary_recall': 0.2768595, 'binary_specificity': 0.9923295, 'binary_f1_score': 0.3774648}
confusion matrix:
      0   1
0  5951  46
1   175  67
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512110_7.png
early stop counter: 6
val acc:0.9619666337966919, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9650585055351257
after epoch: 7,now: 2024-06-20 20:03:45.568114,epoch time: 0:21:17.016336,used: 2:36:06.027699,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_27_39_seed_2_21512110
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9556651, 'precision': 0.9351839, 'recall': 0.79716647, 'specificity': 0.79716647, 'f1': 0.85001457, 'auroc': 0.94075024, 'binary_precision': 0.9117057, 'binary_recall': 0.6005728, 'binary_specificity': 0.99376017, 'binary_f1_score': 0.7241334}
confusion matrix:
       0     1
0  42045   264
1   1813  2726
---- Validation: 
scalar performance:
{'acc': 0.96212643, 'precision': 0.54639363, 'recall': 0.5114556, 'specificity': 0.5114556, 'f1': 0.51443577, 'auroc': 0.63346934, 'binary_precision': 0.12413793, 'binary_recall': 0.029900333, 'binary_specificity': 0.9930108, 'binary_f1_score': 0.04819277}
confusion matrix:
       0    1
0  18044  127
1    584   18
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650585, 'precision': 0.7846504, 'recall': 0.64872384, 'specificity': 0.64872384, 'f1': 0.69318646, 'auroc': 0.77378994, 'binary_precision': 0.5967742, 'binary_recall': 0.30578512, 'binary_specificity': 0.9916625, 'binary_f1_score': 0.4043716}
confusion matrix:
      0   1
0  5947  50
1   168  74
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512110_8.png
early stop counter: 7
val acc:0.9621264338493347, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9650585055351257
after epoch: 8,now: 2024-06-20 20:23:48.197955,epoch time: 0:20:02.629841,used: 2:56:08.657540,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_27_39_seed_2_21512110
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.957138, 'precision': 0.9225235, 'recall': 0.817158, 'specificity': 0.817158, 'f1': 0.8604065, 'auroc': 0.9515331, 'binary_precision': 0.8822108, 'binary_recall': 0.6435338, 'binary_specificity': 0.9907821, 'binary_f1_score': 0.7442038}
confusion matrix:
       0     1
0  41919   390
1   1618  2921
---- Validation: 
scalar performance:
{'acc': 0.96036863, 'precision': 0.5704248, 'recall': 0.5258055, 'specificity': 0.5258055, 'f1': 0.53510374, 'auroc': 0.66349065, 'binary_precision': 0.1712963, 'binary_recall': 0.061461795, 'binary_specificity': 0.99014914, 'binary_f1_score': 0.09046455}
confusion matrix:
       0    1
0  17992  179
1    565   37
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9648982, 'precision': 0.7737458, 'recall': 0.68234706, 'specificity': 0.68234706, 'f1': 0.7178658, 'auroc': 0.7927607, 'binary_precision': 0.572327, 'binary_recall': 0.37603307, 'binary_specificity': 0.988661, 'binary_f1_score': 0.45386532}
confusion matrix:
      0   1
0  5929  68
1   151  91
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512110_9.png
early stop counter: 8
val acc:0.9603686332702637, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9650585055351257
after epoch: 9,now: 2024-06-20 20:45:32.049739,epoch time: 0:21:43.851784,used: 3:17:52.509324,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_27_39_seed_2_21512110
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.95811987, 'precision': 0.92394346, 'recall': 0.8221268, 'specificity': 0.8221268, 'f1': 0.8642951, 'auroc': 0.95145094, 'binary_precision': 0.88405365, 'binary_recall': 0.65344787, 'binary_specificity': 0.99080575, 'binary_f1_score': 0.75145674}
confusion matrix:
       0     1
0  41920   389
1   1573  2966
---- Validation: 
scalar performance:
{'acc': 0.96143395, 'precision': 0.57588834, 'recall': 0.5247497, 'specificity': 0.5247497, 'f1': 0.5342308, 'auroc': 0.6655467, 'binary_precision': 0.18229167, 'binary_recall': 0.058139537, 'binary_specificity': 0.99135983, 'binary_f1_score': 0.08816121}
confusion matrix:
       0    1
0  18014  157
1    567   35
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9668216, 'precision': 0.7986396, 'recall': 0.6793821, 'specificity': 0.6793821, 'f1': 0.7226102, 'auroc': 0.7915392, 'binary_precision': 0.62237763, 'binary_recall': 0.3677686, 'binary_specificity': 0.9909955, 'binary_f1_score': 0.46233764}
confusion matrix:
      0   1
0  5943  54
1   153  89
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512110_10.png
new oracle model saved
early stop counter: 9
val acc:0.9614339470863342, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9668216109275818
after epoch: 10,now: 2024-06-20 21:05:33.702239,epoch time: 0:20:01.652500,used: 3:37:54.161824,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_27_39_seed_2_21512110
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9608094, 'precision': 0.90764654, 'recall': 0.8581032, 'specificity': 0.8581032, 'f1': 0.88082075, 'auroc': 0.95937, 'binary_precision': 0.8437659, 'binary_recall': 0.7307184, 'binary_specificity': 0.98548806, 'binary_f1_score': 0.78318375}
confusion matrix:
       0     1
0  41696   614
1   1222  3316
---- Validation: 
scalar performance:
{'acc': 0.9585575, 'precision': 0.58564776, 'recall': 0.542537, 'specificity': 0.542537, 'f1': 0.55523425, 'auroc': 0.6706897, 'binary_precision': 0.20068027, 'binary_recall': 0.09800664, 'binary_specificity': 0.9870673, 'binary_f1_score': 0.13169642}
confusion matrix:
       0    1
0  17936  235
1    543   59
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9634557, 'precision': 0.75605047, 'recall': 0.71926874, 'specificity': 0.71926874, 'f1': 0.73605937, 'auroc': 0.7996154, 'binary_precision': 0.5339806, 'binary_recall': 0.45454547, 'binary_specificity': 0.983992, 'binary_f1_score': 0.4910714}
confusion matrix:
      0    1
0  5901   96
1   132  110
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512110_11.png
early stop counter: 10
val acc:0.9585574865341187, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9668216109275818
after epoch: 11,now: 2024-06-20 21:24:31.379892,epoch time: 0:18:57.677653,used: 3:56:51.839477,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_27_39_seed_2_21512110
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9593366, 'precision': 0.9117336, 'recall': 0.8429599, 'specificity': 0.8429599, 'f1': 0.87335646, 'auroc': 0.95524067, 'binary_precision': 0.855178, 'binary_recall': 0.69861203, 'binary_specificity': 0.98730767, 'binary_f1_score': 0.76900685}
confusion matrix:
       0     1
0  41772   537
1   1368  3171
---- Validation: 
scalar performance:
{'acc': 0.9581314, 'precision': 0.5850254, 'recall': 0.5439229, 'specificity': 0.5439229, 'f1': 0.556454, 'auroc': 0.6940408, 'binary_precision': 0.19934641, 'binary_recall': 0.1013289, 'binary_specificity': 0.98651695, 'binary_f1_score': 0.13436124}
confusion matrix:
       0    1
0  17926  245
1    541   61
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96537906, 'precision': 0.77157694, 'recall': 0.7282002, 'specificity': 0.7282002, 'f1': 0.7477822, 'auroc': 0.8106417, 'binary_precision': 0.56435645, 'binary_recall': 0.47107437, 'binary_specificity': 0.985326, 'binary_f1_score': 0.5135135}
confusion matrix:
      0    1
0  5909   88
1   128  114
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512110_12.png
early stop counter: 11
val acc:0.9581313729286194, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9668216109275818
after epoch: 12,now: 2024-06-20 21:42:59.709301,epoch time: 0:18:28.329409,used: 4:15:20.168886,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_27_39_seed_2_21512110
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9608735, 'precision': 0.9040996, 'recall': 0.8632536, 'specificity': 0.8632536, 'f1': 0.88227844, 'auroc': 0.962703, 'binary_precision': 0.8355247, 'binary_recall': 0.7421772, 'binary_specificity': 0.98432994, 'binary_f1_score': 0.7860894}
confusion matrix:
       0     1
0  41647   663
1   1170  3368
---- Validation: 
scalar performance:
{'acc': 0.956267, 'precision': 0.5921354, 'recall': 0.5590208, 'specificity': 0.5590208, 'f1': 0.5711736, 'auroc': 0.71392816, 'binary_precision': 0.21259843, 'binary_recall': 0.1345515, 'binary_specificity': 0.98349017, 'binary_f1_score': 0.16480164}
confusion matrix:
       0    1
0  17871  300
1    521   81
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.7400718, 'recall': 0.7438771, 'specificity': 0.7438771, 'f1': 0.7419574, 'auroc': 0.8233346, 'binary_precision': 0.5, 'binary_recall': 0.5082645, 'binary_specificity': 0.97948974, 'binary_f1_score': 0.50409836}
confusion matrix:
      0    1
0  5874  123
1   119  123
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512110_13.png
early stop counter: 12
val acc:0.9562669992446899, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9668216109275818
after epoch: 13,now: 2024-06-20 22:01:15.719719,epoch time: 0:18:16.010418,used: 4:33:36.179304,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_27_39_seed_2_21512110
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9625171, 'precision': 0.92161167, 'recall': 0.8531778, 'specificity': 0.8531778, 'f1': 0.88355523, 'auroc': 0.9627497, 'binary_precision': 0.87295634, 'binary_recall': 0.7175589, 'binary_specificity': 0.9887967, 'binary_f1_score': 0.78766626}
confusion matrix:
       0     1
0  41835   474
1   1282  3257
---- Validation: 
scalar performance:
{'acc': 0.95935655, 'precision': 0.5941679, 'recall': 0.5453589, 'specificity': 0.5453589, 'f1': 0.5594918, 'auroc': 0.71015286, 'binary_precision': 0.21754386, 'binary_recall': 0.10299003, 'binary_specificity': 0.9877277, 'binary_f1_score': 0.13979706}
confusion matrix:
       0    1
0  17948  223
1    540   62
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9658599, 'precision': 0.77500784, 'recall': 0.73439854, 'specificity': 0.73439854, 'f1': 0.7528928, 'auroc': 0.8191167, 'binary_precision': 0.5707317, 'binary_recall': 0.48347107, 'binary_specificity': 0.985326, 'binary_f1_score': 0.5234899}
confusion matrix:
      0    1
0  5909   88
1   125  117
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512110_14.png
early stop counter: 13
val acc:0.9593565464019775, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9668216109275818
after epoch: 14,now: 2024-06-20 22:19:55.068477,epoch time: 0:18:39.348758,used: 4:52:15.528062,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_27_39_seed_2_21512110
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9617059, 'precision': 0.9047793, 'recall': 0.8683646, 'specificity': 0.8683646, 'f1': 0.8854678, 'auroc': 0.9633944, 'binary_precision': 0.8358209, 'binary_recall': 0.7525887, 'binary_specificity': 0.9841405, 'binary_f1_score': 0.79202414}
confusion matrix:
       0     1
0  41638   671
1   1123  3416
---- Validation: 
scalar performance:
{'acc': 0.9563202, 'precision': 0.5954757, 'recall': 0.5622605, 'specificity': 0.5622605, 'f1': 0.5746429, 'auroc': 0.71649575, 'binary_precision': 0.21907216, 'binary_recall': 0.14119601, 'binary_specificity': 0.98332506, 'binary_f1_score': 0.17171717}
confusion matrix:
       0    1
0  17868  303
1    517   85
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9616926, 'precision': 0.74349934, 'recall': 0.75602365, 'specificity': 0.75602365, 'f1': 0.74958324, 'auroc': 0.83094585, 'binary_precision': 0.5058824, 'binary_recall': 0.53305787, 'binary_specificity': 0.9789895, 'binary_f1_score': 0.51911473}
confusion matrix:
      0    1
0  5871  126
1   113  129
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512110_15.png
early stop counter: 14
val acc:0.9563202261924744, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9668216109275818
after epoch: 15,now: 2024-06-20 22:37:51.632525,epoch time: 0:17:56.564048,used: 5:10:12.092110,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_27_39_seed_2_21512110
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.957757, 'precision': 0.88083154, 'recall': 0.8764055, 'specificity': 0.8764055, 'f1': 0.8786016, 'auroc': 0.9636184, 'binary_precision': 0.78571427, 'binary_recall': 0.7755012, 'binary_specificity': 0.97730976, 'binary_f1_score': 0.7805744}
confusion matrix:
       0     1
0  41349   960
1   1019  3520
---- Validation: 
scalar performance:
{'acc': 0.9514196, 'precision': 0.5855299, 'recall': 0.5733809, 'specificity': 0.5733809, 'f1': 0.57888067, 'auroc': 0.72660965, 'binary_precision': 0.19844358, 'binary_recall': 0.16943522, 'binary_specificity': 0.9773265, 'binary_f1_score': 0.1827957}
confusion matrix:
       0    1
0  17759  412
1    500  102
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9552813, 'precision': 0.7122083, 'recall': 0.7744988, 'specificity': 0.7744988, 'f1': 0.7387432, 'auroc': 0.8359772, 'binary_precision': 0.44164038, 'binary_recall': 0.5785124, 'binary_specificity': 0.97048527, 'binary_f1_score': 0.5008944}
confusion matrix:
      0    1
0  5820  177
1   102  140
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512110_16.png
early stop counter: 15
val acc:0.9514195919036865, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9668216109275818
after epoch: 16,now: 2024-06-20 22:56:00.890689,epoch time: 0:18:09.258164,used: 5:28:21.350274,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_27_39_seed_2_21512110
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9588883, 'precision': 0.8845074, 'recall': 0.8789003, 'specificity': 0.8789003, 'f1': 0.8816769, 'auroc': 0.96413493, 'binary_precision': 0.79260916, 'binary_recall': 0.77968717, 'binary_specificity': 0.9781134, 'binary_f1_score': 0.7860951}
confusion matrix:
       0     1
0  41383   926
1   1000  3539
---- Validation: 
scalar performance:
{'acc': 0.9523784, 'precision': 0.58976114, 'recall': 0.5746792, 'specificity': 0.5746792, 'f1': 0.58137167, 'auroc': 0.71343505, 'binary_precision': 0.20682731, 'binary_recall': 0.17109634, 'binary_specificity': 0.97826207, 'binary_f1_score': 0.18727273}
confusion matrix:
       0    1
0  17776  395
1    499  103
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9572047, 'precision': 0.71981287, 'recall': 0.76558566, 'specificity': 0.76558566, 'f1': 0.74021673, 'auroc': 0.83398587, 'binary_precision': 0.45762712, 'binary_recall': 0.55785125, 'binary_specificity': 0.97332, 'binary_f1_score': 0.5027933}
confusion matrix:
      0    1
0  5837  160
1   107  135
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512110_17.png
early stop counter: 16
val acc:0.9523783922195435, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9668216109275818
after epoch: 17,now: 2024-06-20 23:14:54.321252,epoch time: 0:18:53.430563,used: 5:47:14.780837,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_27_39_seed_2_21512110
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.96326417, 'precision': 0.9053689, 'recall': 0.8787414, 'specificity': 0.8787414, 'f1': 0.8914715, 'auroc': 0.9667103, 'binary_precision': 0.8347992, 'binary_recall': 0.7739092, 'binary_specificity': 0.9835736, 'binary_f1_score': 0.8032018}
confusion matrix:
       0     1
0  41615   695
1   1026  3512
---- Validation: 
scalar performance:
{'acc': 0.95418954, 'precision': 0.5973642, 'recall': 0.57561475, 'specificity': 0.57561475, 'f1': 0.5848356, 'auroc': 0.7310036, 'binary_precision': 0.22198276, 'binary_recall': 0.17109634, 'binary_specificity': 0.9801332, 'binary_f1_score': 0.19324577}
confusion matrix:
       0    1
0  17810  361
1    499  103
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9607309, 'precision': 0.73828524, 'recall': 0.7674199, 'specificity': 0.7674199, 'f1': 0.751896, 'auroc': 0.83922195, 'binary_precision': 0.4945055, 'binary_recall': 0.55785125, 'binary_specificity': 0.9769885, 'binary_f1_score': 0.5242719}
confusion matrix:
      0    1
0  5859  138
1   107  135
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512110_18.png
early stop counter: 17
val acc:0.9541895389556885, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9668216109275818
after epoch: 18,now: 2024-06-20 23:33:24.436519,epoch time: 0:18:30.115267,used: 6:05:44.896104,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_27_39_seed_2_21512110
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.96358436, 'precision': 0.9024692, 'recall': 0.88543373, 'specificity': 0.88543373, 'f1': 0.8937129, 'auroc': 0.9697807, 'binary_precision': 0.82751447, 'binary_recall': 0.78849965, 'binary_specificity': 0.9823678, 'binary_f1_score': 0.80753607}
confusion matrix:
       0     1
0  41563   746
1    960  3579
---- Validation: 
scalar performance:
{'acc': 0.9561604, 'precision': 0.6063745, 'recall': 0.5758298, 'specificity': 0.5758298, 'f1': 0.5880503, 'auroc': 0.73748064, 'binary_precision': 0.24, 'binary_recall': 0.16943522, 'binary_specificity': 0.9822244, 'binary_f1_score': 0.19863681}
confusion matrix:
       0    1
0  17848  323
1    500  102
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9639365, 'precision': 0.7578609, 'recall': 0.7690874, 'specificity': 0.7690874, 'f1': 0.763339, 'auroc': 0.8366883, 'binary_precision': 0.5335968, 'binary_recall': 0.55785125, 'binary_specificity': 0.9803235, 'binary_f1_score': 0.54545456}
confusion matrix:
      0    1
0  5879  118
1   107  135
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512110_19.png
early stop counter: 18
val acc:0.9561604261398315, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9668216109275818
after epoch: 19,now: 2024-06-20 23:57:54.924568,epoch time: 0:24:30.488049,used: 6:30:15.384153,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_27_39_seed_2_21512110
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.96503586, 'precision': 0.90854824, 'recall': 0.88702404, 'specificity': 0.88702404, 'f1': 0.8974101, 'auroc': 0.97034293, 'binary_precision': 0.83945704, 'binary_recall': 0.79026216, 'binary_specificity': 0.9837859, 'binary_f1_score': 0.8141171}
confusion matrix:
       0     1
0  41623   686
1    952  3587
---- Validation: 
scalar performance:
{'acc': 0.9563735, 'precision': 0.6015305, 'recall': 0.5687125, 'specificity': 0.5687125, 'f1': 0.5813307, 'auroc': 0.7308337, 'binary_precision': 0.23076923, 'binary_recall': 0.15448505, 'binary_specificity': 0.98293984, 'binary_f1_score': 0.18507463}
confusion matrix:
       0    1
0  17861  310
1    509   93
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642571, 'precision': 0.76006126, 'recall': 0.7672714, 'specificity': 0.7672714, 'f1': 0.7636107, 'auroc': 0.83807397, 'binary_precision': 0.53815264, 'binary_recall': 0.553719, 'binary_specificity': 0.98082376, 'binary_f1_score': 0.5458249}
confusion matrix:
      0    1
0  5882  115
1   108  134
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512110_20.png
early stop counter: 19
val acc:0.9563735127449036, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9668216109275818
after epoch: 20,now: 2024-06-21 00:21:56.745650,epoch time: 0:24:01.821082,used: 6:54:17.205235,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_27_39_seed_2_21512110
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9632855, 'precision': 0.8961978, 'recall': 0.8932337, 'specificity': 0.8932337, 'f1': 0.8947085, 'auroc': 0.9702524, 'binary_precision': 0.8131526, 'binary_recall': 0.806345, 'binary_specificity': 0.98012245, 'binary_f1_score': 0.8097345}
confusion matrix:
       0     1
0  41468   841
1    879  3660
---- Validation: 
scalar performance:
{'acc': 0.95546794, 'precision': 0.61231005, 'recall': 0.5883209, 'specificity': 0.5883209, 'f1': 0.5986144, 'auroc': 0.74973404, 'binary_precision': 0.25106382, 'binary_recall': 0.19601329, 'binary_specificity': 0.9806285, 'binary_f1_score': 0.22014925}
confusion matrix:
       0    1
0  17819  352
1    484  118
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96185285, 'precision': 0.7449083, 'recall': 0.77196896, 'specificity': 0.77196896, 'f1': 0.7576333, 'auroc': 0.8484483, 'binary_precision': 0.5074074, 'binary_recall': 0.5661157, 'binary_specificity': 0.97782224, 'binary_f1_score': 0.53515625}
confusion matrix:
      0    1
0  5864  133
1   105  137
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512110_21.png
early stop counter: 20
val acc:0.955467939376831, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9668216109275818
after epoch: 21,now: 2024-06-21 00:45:19.826848,epoch time: 0:23:23.081198,used: 7:17:40.286433,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_27_39_seed_2_21512110
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9649291, 'precision': 0.90867054, 'recall': 0.8860799, 'specificity': 0.8860799, 'f1': 0.8969607, 'auroc': 0.96939397, 'binary_precision': 0.8399061, 'binary_recall': 0.78827935, 'binary_specificity': 0.9838805, 'binary_f1_score': 0.8132742}
confusion matrix:
       0     1
0  41627   682
1    961  3578
---- Validation: 
scalar performance:
{'acc': 0.9570127, 'precision': 0.6165949, 'recall': 0.5834975, 'specificity': 0.5834975, 'f1': 0.5968221, 'auroc': 0.74777305, 'binary_precision': 0.25995317, 'binary_recall': 0.18438539, 'binary_specificity': 0.9826096, 'binary_f1_score': 0.21574345}
confusion matrix:
       0    1
0  17855  316
1    491  111
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9648982, 'precision': 0.7643508, 'recall': 0.76958764, 'specificity': 0.76958764, 'f1': 0.76694024, 'auroc': 0.84528697, 'binary_precision': 0.5465587, 'binary_recall': 0.55785125, 'binary_specificity': 0.981324, 'binary_f1_score': 0.5521472}
confusion matrix:
      0    1
0  5885  112
1   107  135
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512110_22.png
early stop counter: 21
val acc:0.9570127129554749, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9668216109275818
after epoch: 22,now: 2024-06-21 01:12:46.399932,epoch time: 0:27:26.573084,used: 7:45:06.859517,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_27_39_seed_2_21512110
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9647584, 'precision': 0.90329593, 'recall': 0.8928691, 'specificity': 0.8928691, 'f1': 0.8979939, 'auroc': 0.9697397, 'binary_precision': 0.82758623, 'binary_recall': 0.8037013, 'binary_specificity': 0.98203695, 'binary_f1_score': 0.81546885}
confusion matrix:
       0     1
0  41549   760
1    891  3648
---- Validation: 
scalar performance:
{'acc': 0.9565333, 'precision': 0.6115086, 'recall': 0.58003765, 'specificity': 0.58003765, 'f1': 0.5927103, 'auroc': 0.74065566, 'binary_precision': 0.25, 'binary_recall': 0.17774086, 'binary_specificity': 0.9823345, 'binary_f1_score': 0.20776698}
confusion matrix:
       0    1
0  17850  321
1    495  107
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9640968, 'precision': 0.75880325, 'recall': 0.7731362, 'specificity': 0.7731362, 'f1': 0.7657515, 'auroc': 0.84398466, 'binary_precision': 0.53515625, 'binary_recall': 0.5661157, 'binary_specificity': 0.9801567, 'binary_f1_score': 0.5502008}
confusion matrix:
      0    1
0  5878  119
1   105  137
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512110_23.png
early stop counter: 22
val acc:0.9565333127975464, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9668216109275818
after epoch: 23,now: 2024-06-21 01:41:49.957065,epoch time: 0:29:03.557133,used: 8:14:10.416650,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_27_39_seed_2_21512110
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.96522796, 'precision': 0.90248924, 'recall': 0.8976526, 'specificity': 0.8976526, 'f1': 0.90005195, 'auroc': 0.9728309, 'binary_precision': 0.82492185, 'binary_recall': 0.8138356, 'binary_specificity': 0.9814697, 'binary_f1_score': 0.81934124}
confusion matrix:
       0     1
0  41525   784
1    845  3694
---- Validation: 
scalar performance:
{'acc': 0.957066, 'precision': 0.617486, 'recall': 0.58432806, 'specificity': 0.58432806, 'f1': 0.59770155, 'auroc': 0.7484615, 'binary_precision': 0.26168224, 'binary_recall': 0.18604651, 'binary_specificity': 0.9826096, 'binary_f1_score': 0.21747571}
confusion matrix:
       0    1
0  17855  316
1    490  112
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9639365, 'precision': 0.75776064, 'recall': 0.7730528, 'specificity': 0.7730528, 'f1': 0.7651577, 'auroc': 0.8512941, 'binary_precision': 0.5330739, 'binary_recall': 0.5661157, 'binary_specificity': 0.97999, 'binary_f1_score': 0.5490982}
confusion matrix:
      0    1
0  5877  120
1   105  137
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512110_24.png
early stop counter: 23
val acc:0.957065999507904, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9668216109275818
after epoch: 24,now: 2024-06-21 02:09:58.472440,epoch time: 0:28:08.515375,used: 8:42:18.932025,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_27_39_seed_2_21512110
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.96142846, 'precision': 0.8867084, 'recall': 0.89543045, 'specificity': 0.89543045, 'f1': 0.89100564, 'auroc': 0.9692513, 'binary_precision': 0.79346657, 'binary_recall': 0.81357425, 'binary_specificity': 0.9772867, 'binary_f1_score': 0.8033946}
confusion matrix:
       0     1
0  41349   961
1    846  3692
---- Validation: 
scalar performance:
{'acc': 0.95381665, 'precision': 0.60985583, 'recall': 0.5954984, 'specificity': 0.5954984, 'f1': 0.6020786, 'auroc': 0.74407613, 'binary_precision': 0.24568138, 'binary_recall': 0.21262458, 'binary_specificity': 0.97837216, 'binary_f1_score': 0.22796081}
confusion matrix:
       0    1
0  17778  393
1    474  128
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9586472, 'precision': 0.728586, 'recall': 0.78418064, 'specificity': 0.78418064, 'f1': 0.75292504, 'auroc': 0.8517754, 'binary_precision': 0.47368422, 'binary_recall': 0.59504133, 'binary_specificity': 0.97332, 'binary_f1_score': 0.52747256}
confusion matrix:
      0    1
0  5837  160
1    98  144
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512110_25.png
early stop counter: 24
val acc:0.9538166522979736, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9668216109275818
after epoch: 25,now: 2024-06-21 02:37:41.634471,epoch time: 0:27:43.162031,used: 9:10:02.094056,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_27_39_seed_2_21512110
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9638405, 'precision': 0.89197826, 'recall': 0.90502834, 'specificity': 0.90502834, 'f1': 0.89836323, 'auroc': 0.9738325, 'binary_precision': 0.8020391, 'binary_recall': 0.8320846, 'binary_specificity': 0.9779721, 'binary_f1_score': 0.81678563}
confusion matrix:
       0     1
0  41378   932
1    762  3776
---- Validation: 
scalar performance:
{'acc': 0.95402974, 'precision': 0.610293, 'recall': 0.59480536, 'specificity': 0.59480536, 'f1': 0.6018525, 'auroc': 0.7493441, 'binary_precision': 0.24660194, 'binary_recall': 0.21096346, 'binary_specificity': 0.9786473, 'binary_f1_score': 0.22739482}
confusion matrix:
       0    1
0  17783  388
1    475  127
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95928836, 'precision': 0.7318971, 'recall': 0.7864969, 'specificity': 0.7864969, 'f1': 0.7559023, 'auroc': 0.8523642, 'binary_precision': 0.48013246, 'binary_recall': 0.59917355, 'binary_specificity': 0.97382027, 'binary_f1_score': 0.53308827}
confusion matrix:
      0    1
0  5840  157
1    97  145
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512110_26.png
early stop counter: 25
val acc:0.9540297389030457, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9668216109275818
after epoch: 26,now: 2024-06-21 03:04:55.985396,epoch time: 0:27:14.350925,used: 9:37:16.444981,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_27_39_seed_2_21512110
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.95730877, 'precision': 0.8648703, 'recall': 0.9082157, 'specificity': 0.9082157, 'f1': 0.8849179, 'auroc': 0.9733293, 'binary_precision': 0.7463613, 'binary_recall': 0.8473232, 'binary_specificity': 0.9691082, 'binary_f1_score': 0.7936442}
confusion matrix:
       0     1
0  41002  1307
1    693  3846
---- Validation: 
scalar performance:
{'acc': 0.9499281, 'precision': 0.6033062, 'recall': 0.60794455, 'specificity': 0.60794455, 'f1': 0.6055639, 'auroc': 0.7573379, 'binary_precision': 0.23174603, 'binary_recall': 0.24252492, 'binary_specificity': 0.9733642, 'binary_f1_score': 0.237013}
confusion matrix:
       0    1
0  17687  484
1    456  146
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9554416, 'precision': 0.71683866, 'recall': 0.80630606, 'specificity': 0.80630606, 'f1': 0.7527143, 'auroc': 0.85871774, 'binary_precision': 0.44827586, 'binary_recall': 0.6446281, 'binary_specificity': 0.967984, 'binary_f1_score': 0.52881354}
confusion matrix:
      0    1
0  5805  192
1    86  156
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512110_27.png
early stop counter: 26
val acc:0.9499281048774719, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9668216109275818
after epoch: 27,now: 2024-06-21 03:31:29.424054,epoch time: 0:26:33.438658,used: 10:03:49.883639,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_27_39_seed_2_21512110
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.96044654, 'precision': 0.87309825, 'recall': 0.9166399, 'specificity': 0.9166399, 'f1': 0.8932693, 'auroc': 0.97788703, 'binary_precision': 0.7611824, 'binary_recall': 0.86230445, 'binary_specificity': 0.97097546, 'binary_f1_score': 0.80859417}
confusion matrix:
       0     1
0  41081  1228
1    625  3914
---- Validation: 
scalar performance:
{'acc': 0.94886273, 'precision': 0.6040995, 'recall': 0.6154247, 'specificity': 0.6154247, 'f1': 0.6094089, 'auroc': 0.76342046, 'binary_precision': 0.23283581, 'binary_recall': 0.2591362, 'binary_specificity': 0.9717132, 'binary_f1_score': 0.245283}
confusion matrix:
       0    1
0  17657  514
1    446  156
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9525565, 'precision': 0.7046387, 'recall': 0.79687434, 'specificity': 0.79687434, 'f1': 0.74087334, 'auroc': 0.8610903, 'binary_precision': 0.424581, 'binary_recall': 0.6280992, 'binary_specificity': 0.9656495, 'binary_f1_score': 0.50666666}
confusion matrix:
      0    1
0  5791  206
1    90  152
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512110_28.png
early stop counter: 27
val acc:0.9488627314567566, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9668216109275818
after epoch: 28,now: 2024-06-21 03:59:11.086534,epoch time: 0:27:41.662480,used: 10:31:31.546119,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_27_39_seed_2_21512110
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.964118, 'precision': 0.89221287, 'recall': 0.906872, 'specificity': 0.906872, 'f1': 0.899366, 'auroc': 0.9730024, 'binary_precision': 0.8021142, 'binary_recall': 0.8358669, 'binary_specificity': 0.977877, 'binary_f1_score': 0.81864274}
confusion matrix:
       0     1
0  41373   936
1    745  3794
---- Validation: 
scalar performance:
{'acc': 0.95381665, 'precision': 0.6128746, 'recall': 0.60031664, 'specificity': 0.60031664, 'f1': 0.60615593, 'auroc': 0.7564653, 'binary_precision': 0.25140712, 'binary_recall': 0.22259136, 'binary_specificity': 0.97804195, 'binary_f1_score': 0.23612332}
confusion matrix:
       0    1
0  17772  399
1    468  134
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589678, 'precision': 0.73015726, 'recall': 0.7843474, 'specificity': 0.7843474, 'f1': 0.7539802, 'auroc': 0.8534914, 'binary_precision': 0.47682118, 'binary_recall': 0.59504133, 'binary_specificity': 0.9736535, 'binary_f1_score': 0.5294118}
confusion matrix:
      0    1
0  5839  158
1    98  144
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512110_29.png
early stop counter: 28
val acc:0.9538166522979736, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9668216109275818
after epoch: 29,now: 2024-06-21 04:31:15.325754,epoch time: 0:32:04.239220,used: 11:03:35.785339,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_27_39_seed_2_21512110
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.96796024, 'precision': 0.91000545, 'recall': 0.906049, 'specificity': 0.906049, 'f1': 0.9080148, 'auroc': 0.9754865, 'binary_precision': 0.8383073, 'binary_recall': 0.82925755, 'binary_specificity': 0.98284054, 'binary_f1_score': 0.8337579}
confusion matrix:
       0     1
0  41583   726
1    775  3764
---- Validation: 
scalar performance:
{'acc': 0.9563202, 'precision': 0.6150603, 'recall': 0.586352, 'specificity': 0.586352, 'f1': 0.59828967, 'auroc': 0.75854295, 'binary_precision': 0.25669643, 'binary_recall': 0.1910299, 'binary_specificity': 0.9816741, 'binary_f1_score': 0.21904764}
confusion matrix:
       0    1
0  17838  333
1    487  115
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9639365, 'precision': 0.75758445, 'recall': 0.7809838, 'specificity': 0.7809838, 'f1': 0.76870877, 'auroc': 0.85779667, 'binary_precision': 0.53207546, 'binary_recall': 0.58264464, 'binary_specificity': 0.97932297, 'binary_f1_score': 0.556213}
confusion matrix:
      0    1
0  5873  124
1   101  141
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512110_30.png
early stop counter: 29
val acc:0.9563202261924744, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9668216109275818
after epoch: 30,now: 2024-06-21 05:07:30.844278,epoch time: 0:36:15.518524,used: 11:39:51.303863,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_27_39_seed_2_21512110
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 11:39:51.303863 at 2024-06-21 05:07:30.844278
persisted model performance metric: 

scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.28049594, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
oracle model performance metric: 

scalar performance:
{'acc': 0.9668216, 'precision': 0.7986396, 'recall': 0.6793821, 'specificity': 0.6793821, 'f1': 0.7226102, 'auroc': 0.7915392, 'binary_precision': 0.62237763, 'binary_recall': 0.3677686, 'binary_specificity': 0.9909955, 'binary_f1_score': 0.46233764}
confusion matrix:
      0   1
0  5943  54
1   153  89
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_irm_resnet_different_bs128_lre4_classbalancing/rule_results/8.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_irm_resnet_different_bs128_lre4_classbalancing/confusion_matrix/8.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204097 KiB |   1730 MiB |   1243 TiB |   1243 TiB |
|       from large pool | 167936 KiB |   1660 MiB |   1242 TiB |   1242 TiB |
|       from small pool |  36161 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 204097 KiB |   1730 MiB |   1243 TiB |   1243 TiB |
|       from large pool | 167936 KiB |   1660 MiB |   1242 TiB |   1242 TiB |
|       from small pool |  36161 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201087 KiB |   1723 MiB |   1243 TiB |   1243 TiB |
|       from large pool | 165120 KiB |   1653 MiB |   1242 TiB |   1242 TiB |
|       from small pool |  35967 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1802 MiB |   1876 MiB |   4292 MiB |   2490 MiB |
|       from large pool |   1728 MiB |   1802 MiB |   4154 MiB |   2426 MiB |
|       from small pool |     74 MiB |     74 MiB |    138 MiB |     64 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 404158 KiB |    900 MiB |    929 TiB |    929 TiB |
|       from large pool | 397312 KiB |    899 MiB |    929 TiB |    929 TiB |
|       from small pool |   6846 KiB |     14 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    1194    |    1851    |   37855 K  |   37854 K  |
|       from large pool |      36    |      76    |   12094 K  |   12094 K  |
|       from small pool |    1158    |    1780    |   25761 K  |   25759 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1194    |    1851    |   37855 K  |   37854 K  |
|       from large pool |      36    |      76    |   12094 K  |   12094 K  |
|       from small pool |    1158    |    1780    |   25761 K  |   25759 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      49    |      50    |      88    |      39    |
|       from large pool |      12    |      13    |      19    |       7    |
|       from small pool |      37    |      37    |      69    |      32    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      48    |     383    |   21745 K  |   21745 K  |
|       from large pool |       5    |      11    |    4833 K  |    4833 K  |
|       from small pool |      43    |     378    |   16912 K  |   16912 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1730 MiB |   1243 TiB |   1243 TiB |
|       from large pool |  16640 KiB |   1660 MiB |   1242 TiB |   1242 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1730 MiB |   1243 TiB |   1243 TiB |
|       from large pool |  16640 KiB |   1660 MiB |   1242 TiB |   1242 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1723 MiB |   1243 TiB |   1243 TiB |
|       from large pool |  16640 KiB |   1653 MiB |   1242 TiB |   1242 TiB |
|       from small pool |      0 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 608256 KiB |   1876 MiB |   4292 MiB |   3698 MiB |
|       from large pool | 565248 KiB |   1802 MiB |   4154 MiB |   3602 MiB |
|       from small pool |  43008 KiB |     74 MiB |    138 MiB |     96 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 384768 KiB |    900 MiB |    929 TiB |    929 TiB |
|       from large pool | 384768 KiB |    899 MiB |    929 TiB |    929 TiB |
|       from small pool |      0 KiB |     14 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1851    |   37855 K  |   37855 K  |
|       from large pool |       2    |      76    |   12094 K  |   12094 K  |
|       from small pool |       0    |    1780    |   25761 K  |   25761 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1851    |   37855 K  |   37855 K  |
|       from large pool |       2    |      76    |   12094 K  |   12094 K  |
|       from small pool |       0    |    1780    |   25761 K  |   25761 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      30    |      50    |      88    |      58    |
|       from large pool |       9    |      13    |      19    |      10    |
|       from small pool |      21    |      37    |      69    |      48    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     383    |   21745 K  |   21745 K  |
|       from large pool |       1    |      11    |    4833 K  |    4833 K  |
|       from small pool |       0    |     378    |   16912 K  |   16912 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

