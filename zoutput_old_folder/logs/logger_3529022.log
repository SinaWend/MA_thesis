Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0




!!!: not committed yet



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504646

 Experiment start at: 2024-06-18 20:01:53.748223
before training, model accuracy: 0.31563422083854675
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.95528907, 'precision': 0.96874285, 'recall': 0.7671206, 'specificity': 0.7671206, 'f1': 0.83454967, 'auroc': 0.9566387, 'binary_precision': 0.98373646, 'binary_recall': 0.53516334, 'binary_specificity': 0.99907786, 'binary_f1_score': 0.69321185}
confusion matrix:
       0     1
0  42253    39
1   2049  2359
---- Validation: 
scalar performance:
{'acc': 0.9656237, 'precision': 0.6648063, 'recall': 0.5029176, 'specificity': 0.5029176, 'f1': 0.49736995, 'auroc': 0.578272, 'binary_precision': 0.36363637, 'binary_recall': 0.00622084, 'binary_specificity': 0.9996143, 'binary_f1_score': 0.012232415}
confusion matrix:
       0  1
0  18142  7
1    639  4
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8836283, 'precision': 0.4422055, 'recall': 0.49949974, 'specificity': 0.49949974, 'f1': 0.46910968, 'auroc': 0.627964, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5991  6
1   783  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504646_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-18 20:20:21.285739,epoch time: 0:18:27.537516,used: 0:18:27.537516,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504646
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9755032, 'precision': 0.98088634, 'recall': 0.8746617, 'specificity': 0.8746617, 'f1': 0.9196284, 'auroc': 0.9821967, 'binary_precision': 0.9871718, 'binary_recall': 0.75034016, 'binary_specificity': 0.9989832, 'binary_f1_score': 0.8526153}
confusion matrix:
       0     1
0  42247    43
1   1101  3309
---- Validation: 
scalar performance:
{'acc': 0.9663687, 'precision': 0.76205, 'recall': 0.5415561, 'specificity': 0.5415561, 'f1': 0.5655468, 'auroc': 0.6926172, 'binary_precision': 0.5555556, 'binary_recall': 0.08553655, 'binary_specificity': 0.99757564, 'binary_f1_score': 0.14824799}
confusion matrix:
       0   1
0  18105  44
1    588  55
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89321536, 'precision': 0.8591652, 'recall': 0.54655874, 'specificity': 0.54655874, 'f1': 0.55727696, 'auroc': 0.73326755, 'binary_precision': 0.82417583, 'binary_recall': 0.09578544, 'binary_specificity': 0.997332, 'binary_f1_score': 0.1716247}
confusion matrix:
      0   1
0  5981  16
1   708  75
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504646_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-18 20:42:47.635266,epoch time: 0:22:26.349527,used: 0:40:53.887043,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504646
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.980621, 'precision': 0.9837702, 'recall': 0.90202856, 'specificity': 0.90202856, 'f1': 0.93821585, 'auroc': 0.98725206, 'binary_precision': 0.98749304, 'binary_recall': 0.80512124, 'binary_specificity': 0.9989358, 'binary_f1_score': 0.88703036}
confusion matrix:
       0     1
0  42242    45
1    860  3553
---- Validation: 
scalar performance:
{'acc': 0.9667944, 'precision': 0.7672955, 'recall': 0.562778, 'specificity': 0.562778, 'f1': 0.5965836, 'auroc': 0.71713006, 'binary_precision': 0.56462586, 'binary_recall': 0.12908243, 'binary_specificity': 0.9964736, 'binary_f1_score': 0.21012658}
confusion matrix:
       0   1
0  18085  64
1    560  83
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8966077, 'precision': 0.87540364, 'recall': 0.561801, 'specificity': 0.561801, 'f1': 0.58243895, 'auroc': 0.7440935, 'binary_precision': 0.8534483, 'binary_recall': 0.12643678, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.22024474}
confusion matrix:
      0   1
0  5980  17
1   684  99
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504646_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-18 21:06:03.129281,epoch time: 0:23:15.494015,used: 1:04:09.381058,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504646
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9827195, 'precision': 0.9826572, 'recall': 0.91508543, 'specificity': 0.91508543, 'f1': 0.9457034, 'auroc': 0.9905474, 'binary_precision': 0.98258305, 'binary_recall': 0.8317079, 'binary_specificity': 0.99846303, 'binary_f1_score': 0.9008721}
confusion matrix:
       0     1
0  42226    65
1    742  3667
---- Validation: 
scalar performance:
{'acc': 0.96706045, 'precision': 0.77143395, 'recall': 0.57191646, 'specificity': 0.57191646, 'f1': 0.6090129, 'auroc': 0.7347238, 'binary_precision': 0.57228917, 'binary_recall': 0.14774494, 'binary_specificity': 0.99608797, 'binary_f1_score': 0.23485783}
confusion matrix:
       0   1
0  18078  71
1    548  95
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89926255, 'precision': 0.87864673, 'recall': 0.5749608, 'specificity': 0.5749608, 'f1': 0.60298705, 'auroc': 0.75523025, 'binary_precision': 0.85714287, 'binary_recall': 0.1532567, 'binary_specificity': 0.996665, 'binary_f1_score': 0.26002166}
confusion matrix:
      0    1
0  5977   20
1   663  120
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504646_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-18 21:23:50.842725,epoch time: 0:17:47.713444,used: 1:21:57.094502,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504646
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98473233, 'precision': 0.9830309, 'recall': 0.9265417, 'specificity': 0.9265417, 'f1': 0.95259595, 'auroc': 0.990901, 'binary_precision': 0.9809945, 'binary_recall': 0.85480946, 'binary_specificity': 0.9982739, 'binary_f1_score': 0.9135653}
confusion matrix:
       0     1
0  42219    73
1    640  3768
---- Validation: 
scalar performance:
{'acc': 0.96647507, 'precision': 0.7514888, 'recall': 0.58211416, 'specificity': 0.58211416, 'f1': 0.61996305, 'auroc': 0.7626052, 'binary_precision': 0.53170735, 'binary_recall': 0.16951789, 'binary_specificity': 0.99471045, 'binary_f1_score': 0.2570755}
confusion matrix:
       0    1
0  18053   96
1    534  109
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90250736, 'precision': 0.8792021, 'recall': 0.5917854, 'specificity': 0.5917854, 'f1': 0.627707, 'auroc': 0.78272986, 'binary_precision': 0.85465115, 'binary_recall': 0.18773946, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.3078534}
confusion matrix:
      0    1
0  5972   25
1   636  147
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504646_5.png
new oracle model saved
early stop counter: 1
val acc:0.9664750695228577, best validation acc: 0.9670604467391968, corresponding to test acc:                         0.899262547492981 / 0.9025073647499084
after epoch: 5,now: 2024-06-18 21:46:02.792757,epoch time: 0:22:11.950032,used: 1:44:09.044534,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504646
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9862955, 'precision': 0.9802154, 'recall': 0.9383646, 'specificity': 0.9383646, 'f1': 0.9580951, 'auroc': 0.99211, 'binary_precision': 0.9728848, 'binary_recall': 0.87928295, 'binary_specificity': 0.99744636, 'binary_f1_score': 0.9237187}
confusion matrix:
       0     1
0  42185   108
1    532  3875
---- Validation: 
scalar performance:
{'acc': 0.9663687, 'precision': 0.7474078, 'recall': 0.5955601, 'specificity': 0.5955601, 'f1': 0.63473004, 'auroc': 0.78528225, 'binary_precision': 0.52263373, 'binary_recall': 0.19751166, 'binary_specificity': 0.9936085, 'binary_f1_score': 0.28668168}
confusion matrix:
       0    1
0  18033  116
1    516  127
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9078171, 'precision': 0.8842711, 'recall': 0.618105, 'specificity': 0.618105, 'f1': 0.6635482, 'auroc': 0.7910285, 'binary_precision': 0.8590909, 'binary_recall': 0.2413793, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.37686938}
confusion matrix:
      0    1
0  5966   31
1   594  189
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504646_6.png
new oracle model saved
early stop counter: 2
val acc:0.9663686752319336, best validation acc: 0.9670604467391968, corresponding to test acc:                         0.899262547492981 / 0.9078171253204346
after epoch: 6,now: 2024-06-18 22:07:59.944777,epoch time: 0:21:57.152020,used: 2:06:06.196554,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504646
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98764455, 'precision': 0.9846043, 'recall': 0.9423244, 'specificity': 0.9423244, 'f1': 0.96225655, 'auroc': 0.99298817, 'binary_precision': 0.9809381, 'binary_recall': 0.88644606, 'binary_specificity': 0.9982028, 'binary_f1_score': 0.9313013}
confusion matrix:
       0     1
0  42212    76
1    501  3911
---- Validation: 
scalar performance:
{'acc': 0.96631545, 'precision': 0.74658155, 'recall': 0.5925323, 'specificity': 0.5925323, 'f1': 0.6313089, 'auroc': 0.7874682, 'binary_precision': 0.5211864, 'binary_recall': 0.19129083, 'binary_specificity': 0.99377376, 'binary_f1_score': 0.27986348}
confusion matrix:
       0    1
0  18036  113
1    520  123
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90471977, 'precision': 0.87538517, 'recall': 0.6046951, 'specificity': 0.6046951, 'f1': 0.6453997, 'auroc': 0.7940937, 'binary_precision': 0.8442211, 'binary_recall': 0.21455939, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.34215885}
confusion matrix:
      0    1
0  5966   31
1   615  168
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504646_7.png
early stop counter: 3
val acc:0.9663154482841492, best validation acc: 0.9670604467391968, corresponding to test acc:                         0.899262547492981 / 0.9078171253204346
after epoch: 7,now: 2024-06-18 22:28:12.433756,epoch time: 0:20:12.488979,used: 2:26:18.685533,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504646
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.988758, 'precision': 0.9839474, 'recall': 0.94957054, 'specificity': 0.94957054, 'f1': 0.9659645, 'auroc': 0.9947243, 'binary_precision': 0.97812194, 'binary_recall': 0.9012458, 'binary_specificity': 0.99789524, 'binary_f1_score': 0.93811154}
confusion matrix:
       0     1
0  42196    89
1    436  3979
---- Validation: 
scalar performance:
{'acc': 0.9669008, 'precision': 0.7569668, 'recall': 0.60408616, 'specificity': 0.60408616, 'f1': 0.6451975, 'auroc': 0.79759717, 'binary_precision': 0.5411765, 'binary_recall': 0.21461898, 'binary_specificity': 0.99355334, 'binary_f1_score': 0.30734968}
confusion matrix:
       0    1
0  18032  117
1    505  138
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9082596, 'precision': 0.8902302, 'recall': 0.61835515, 'specificity': 0.61835515, 'f1': 0.66423887, 'auroc': 0.8143147, 'binary_precision': 0.87096775, 'binary_recall': 0.2413793, 'binary_specificity': 0.995331, 'binary_f1_score': 0.378}
confusion matrix:
      0    1
0  5969   28
1   594  189
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504646_8.png
new oracle model saved
early stop counter: 4
val acc:0.9669008255004883, best validation acc: 0.9670604467391968, corresponding to test acc:                         0.899262547492981 / 0.9082595705986023
after epoch: 8,now: 2024-06-18 22:51:43.275548,epoch time: 0:23:30.841792,used: 2:49:49.527325,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504646
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9891863, 'precision': 0.9821465, 'recall': 0.95386404, 'specificity': 0.95386404, 'f1': 0.967468, 'auroc': 0.9936096, 'binary_precision': 0.97359496, 'binary_recall': 0.9103058, 'binary_specificity': 0.9974223, 'binary_f1_score': 0.9408873}
confusion matrix:
       0     1
0  42176   109
1    396  4019
---- Validation: 
scalar performance:
{'acc': 0.9669008, 'precision': 0.7552874, 'recall': 0.61458695, 'specificity': 0.61458695, 'f1': 0.6556631, 'auroc': 0.80484265, 'binary_precision': 0.53710246, 'binary_recall': 0.23639192, 'binary_specificity': 0.992782, 'binary_f1_score': 0.32829377}
confusion matrix:
       0    1
0  18018  131
1    491  152
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90678465, 'precision': 0.8709768, 'recall': 0.6175214, 'specificity': 0.6175214, 'f1': 0.6619494, 'auroc': 0.8019166, 'binary_precision': 0.8325991, 'binary_recall': 0.2413793, 'binary_specificity': 0.9936635, 'binary_f1_score': 0.37425742}
confusion matrix:
      0    1
0  5959   38
1   594  189
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504646_9.png
early stop counter: 5
val acc:0.9669008255004883, best validation acc: 0.9670604467391968, corresponding to test acc:                         0.899262547492981 / 0.9082595705986023
after epoch: 9,now: 2024-06-18 23:14:41.169125,epoch time: 0:22:57.893577,used: 3:12:47.420902,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504646
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9880942, 'precision': 0.98233473, 'recall': 0.9471754, 'specificity': 0.9471754, 'f1': 0.96392035, 'auroc': 0.99346936, 'binary_precision': 0.9753634, 'binary_recall': 0.89671576, 'binary_specificity': 0.99763507, 'binary_f1_score': 0.93438756}
confusion matrix:
       0     1
0  42185   100
1    456  3959
---- Validation: 
scalar performance:
{'acc': 0.9672733, 'precision': 0.7678455, 'recall': 0.59377825, 'specificity': 0.59377825, 'f1': 0.6353109, 'auroc': 0.794435, 'binary_precision': 0.56363636, 'binary_recall': 0.19284603, 'binary_specificity': 0.99471045, 'binary_f1_score': 0.28736967}
confusion matrix:
       0    1
0  18053   96
1    519  124
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9004425, 'precision': 0.8677093, 'recall': 0.58395576, 'specificity': 0.58395576, 'f1': 0.6161033, 'auroc': 0.7786876, 'binary_precision': 0.8333333, 'binary_recall': 0.1724138, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.2857143}
confusion matrix:
      0    1
0  5970   27
1   648  135
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504646_10.png
better model found
persisted
after epoch: 10,now: 2024-06-18 23:33:34.816868,epoch time: 0:18:53.647743,used: 3:31:41.068645,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504646
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9900428, 'precision': 0.98478884, 'recall': 0.9563077, 'specificity': 0.9563077, 'f1': 0.97000694, 'auroc': 0.9955473, 'binary_precision': 0.9784085, 'binary_recall': 0.9147199, 'binary_specificity': 0.99789554, 'binary_f1_score': 0.94549286}
confusion matrix:
       0     1
0  42202    89
1    376  4033
---- Validation: 
scalar performance:
{'acc': 0.966688, 'precision': 0.75138927, 'recall': 0.61597687, 'specificity': 0.61597687, 'f1': 0.65634197, 'auroc': 0.8196839, 'binary_precision': 0.5292096, 'binary_recall': 0.23950233, 'binary_specificity': 0.99245137, 'binary_f1_score': 0.32976446}
confusion matrix:
       0    1
0  18012  137
1    489  154
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90707964, 'precision': 0.8791614, 'recall': 0.6160226, 'specificity': 0.6160226, 'f1': 0.6605451, 'auroc': 0.8112765, 'binary_precision': 0.84931505, 'binary_recall': 0.23754789, 'binary_specificity': 0.99449724, 'binary_f1_score': 0.37125748}
confusion matrix:
      0    1
0  5964   33
1   597  186
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504646_11.png
early stop counter: 1
val acc:0.9666879773139954, best validation acc: 0.9672732949256897, corresponding to test acc:                         0.9004424810409546 / 0.9082595705986023
after epoch: 11,now: 2024-06-18 23:57:01.818422,epoch time: 0:23:27.001554,used: 3:55:08.070199,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504646
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99081373, 'precision': 0.98645175, 'recall': 0.95929086, 'specificity': 0.95929086, 'f1': 0.9723814, 'auroc': 0.99581987, 'binary_precision': 0.9811503, 'binary_recall': 0.9204262, 'binary_specificity': 0.99815553, 'binary_f1_score': 0.94981873}
confusion matrix:
       0     1
0  42211    78
1    351  4060
---- Validation: 
scalar performance:
{'acc': 0.9671137, 'precision': 0.7629763, 'recall': 0.59744585, 'specificity': 0.59744585, 'f1': 0.63884246, 'auroc': 0.80785954, 'binary_precision': 0.55364805, 'binary_recall': 0.20062208, 'binary_specificity': 0.99426967, 'binary_f1_score': 0.29452053}
confusion matrix:
       0    1
0  18045  104
1    514  129
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89778763, 'precision': 0.8626821, 'recall': 0.57079595, 'specificity': 0.57079595, 'f1': 0.59636337, 'auroc': 0.79975367, 'binary_precision': 0.82608694, 'binary_recall': 0.14559387, 'binary_specificity': 0.995998, 'binary_f1_score': 0.247557}
confusion matrix:
      0    1
0  5973   24
1   669  114
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504646_12.png
early stop counter: 2
val acc:0.9671136736869812, best validation acc: 0.9672732949256897, corresponding to test acc:                         0.9004424810409546 / 0.9082595705986023
after epoch: 12,now: 2024-06-19 00:17:28.791422,epoch time: 0:20:26.973000,used: 4:15:35.043199,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504646
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99027836, 'precision': 0.9848491, 'recall': 0.95768476, 'specificity': 0.95768476, 'f1': 0.970775, 'auroc': 0.9964255, 'binary_precision': 0.9782504, 'binary_recall': 0.91749775, 'binary_specificity': 0.99787176, 'binary_f1_score': 0.9469006}
confusion matrix:
       0     1
0  42198    90
1    364  4048
---- Validation: 
scalar performance:
{'acc': 0.9663687, 'precision': 0.7476913, 'recall': 0.5925598, 'specificity': 0.5925598, 'f1': 0.6314821, 'auroc': 0.8201753, 'binary_precision': 0.52340424, 'binary_recall': 0.19129083, 'binary_specificity': 0.99382883, 'binary_f1_score': 0.2801822}
confusion matrix:
       0    1
0  18037  112
1    520  123
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89955753, 'precision': 0.86409557, 'recall': 0.5801244, 'specificity': 0.5801244, 'f1': 0.61040133, 'auroc': 0.8068129, 'binary_precision': 0.8269231, 'binary_recall': 0.16475096, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.27476037}
confusion matrix:
      0    1
0  5970   27
1   654  129
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504646_13.png
early stop counter: 3
val acc:0.9663686752319336, best validation acc: 0.9672732949256897, corresponding to test acc:                         0.9004424810409546 / 0.9082595705986023
after epoch: 13,now: 2024-06-19 00:36:35.591956,epoch time: 0:19:06.800534,used: 4:34:41.843733,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504646
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99134904, 'precision': 0.987434, 'recall': 0.9615495, 'specificity': 0.9615495, 'f1': 0.97404814, 'auroc': 0.9971559, 'binary_precision': 0.9826715, 'binary_recall': 0.9248018, 'binary_specificity': 0.9982973, 'binary_f1_score': 0.9528588}
confusion matrix:
       0     1
0  42213    72
1    332  4083
---- Validation: 
scalar performance:
{'acc': 0.9667944, 'precision': 0.7549791, 'recall': 0.603281, 'specificity': 0.603281, 'f1': 0.6440567, 'auroc': 0.8209482, 'binary_precision': 0.5372549, 'binary_recall': 0.21306376, 'binary_specificity': 0.99349827, 'binary_f1_score': 0.3051225}
confusion matrix:
       0    1
0  18031  118
1    506  137
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8982301, 'precision': 0.84147596, 'recall': 0.57937396, 'specificity': 0.57937396, 'f1': 0.608721, 'auroc': 0.8128279, 'binary_precision': 0.7818182, 'binary_recall': 0.16475096, 'binary_specificity': 0.993997, 'binary_f1_score': 0.27215192}
confusion matrix:
      0    1
0  5961   36
1   654  129
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504646_14.png
early stop counter: 4
val acc:0.9667943716049194, best validation acc: 0.9672732949256897, corresponding to test acc:                         0.9004424810409546 / 0.9082595705986023
after epoch: 14,now: 2024-06-19 01:00:07.260701,epoch time: 0:23:31.668745,used: 4:58:13.512478,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504646
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99149895, 'precision': 0.9875262, 'recall': 0.96232563, 'specificity': 0.96232563, 'f1': 0.97450584, 'auroc': 0.9965905, 'binary_precision': 0.9826923, 'binary_recall': 0.92635393, 'binary_specificity': 0.99829733, 'binary_f1_score': 0.95369184}
confusion matrix:
       0     1
0  42215    72
1    325  4088
---- Validation: 
scalar performance:
{'acc': 0.9672733, 'precision': 0.7698301, 'recall': 0.58852786, 'specificity': 0.58852786, 'f1': 0.6294384, 'auroc': 0.82349765, 'binary_precision': 0.56796116, 'binary_recall': 0.18195957, 'binary_specificity': 0.99509615, 'binary_f1_score': 0.27561837}
confusion matrix:
       0    1
0  18060   89
1    526  117
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8938053, 'precision': 0.8326118, 'recall': 0.5552201, 'specificity': 0.5552201, 'f1': 0.57156396, 'auroc': 0.8121963, 'binary_precision': 0.7692308, 'binary_recall': 0.11494253, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.19999999}
confusion matrix:
      0   1
0  5970  27
1   693  90
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504646_15.png
early stop counter: 5
val acc:0.9672732949256897, best validation acc: 0.9672732949256897, corresponding to test acc:                         0.9004424810409546 / 0.9082595705986023
after epoch: 15,now: 2024-06-19 01:22:26.784188,epoch time: 0:22:19.523487,used: 5:20:33.035965,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504646
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9915846, 'precision': 0.9872687, 'recall': 0.96308327, 'specificity': 0.96308327, 'f1': 0.97478914, 'auroc': 0.995765, 'binary_precision': 0.9820144, 'binary_recall': 0.9279402, 'binary_specificity': 0.9982264, 'binary_f1_score': 0.9542119}
confusion matrix:
       0     1
0  42212    75
1    318  4095
---- Validation: 
scalar performance:
{'acc': 0.96722007, 'precision': 0.76845753, 'recall': 0.5885003, 'specificity': 0.5885003, 'f1': 0.62926245, 'auroc': 0.811766, 'binary_precision': 0.5652174, 'binary_recall': 0.18195957, 'binary_specificity': 0.9950411, 'binary_f1_score': 0.27529413}
confusion matrix:
       0    1
0  18059   90
1    526  117
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8963127, 'precision': 0.84626114, 'recall': 0.566631, 'specificity': 0.566631, 'f1': 0.5897127, 'auroc': 0.7973406, 'binary_precision': 0.7941176, 'binary_recall': 0.13793103, 'binary_specificity': 0.995331, 'binary_f1_score': 0.23503809}
confusion matrix:
      0    1
0  5969   28
1   675  108
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504646_16.png
early stop counter: 6
val acc:0.9672200679779053, best validation acc: 0.9672732949256897, corresponding to test acc:                         0.9004424810409546 / 0.9082595705986023
after epoch: 16,now: 2024-06-19 01:47:14.745954,epoch time: 0:24:47.961766,used: 5:45:20.997731,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504646
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9903212, 'precision': 0.98666364, 'recall': 0.9561956, 'specificity': 0.9561956, 'f1': 0.9708116, 'auroc': 0.9953563, 'binary_precision': 0.9822255, 'binary_recall': 0.9141174, 'binary_specificity': 0.99827373, 'binary_f1_score': 0.9469484}
confusion matrix:
       0     1
0  42214    73
1    379  4034
---- Validation: 
scalar performance:
{'acc': 0.96706045, 'precision': 0.76657146, 'recall': 0.58241725, 'specificity': 0.58241725, 'f1': 0.6218046, 'auroc': 0.81782144, 'binary_precision': 0.5618557, 'binary_recall': 0.16951789, 'binary_specificity': 0.99531657, 'binary_f1_score': 0.260454}
confusion matrix:
       0    1
0  18064   85
1    534  109
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89498526, 'precision': 0.8383584, 'recall': 0.5608839, 'specificity': 0.5608839, 'f1': 0.5806489, 'auroc': 0.80526197, 'binary_precision': 0.77952754, 'binary_recall': 0.12643678, 'binary_specificity': 0.995331, 'binary_f1_score': 0.21758243}
confusion matrix:
      0   1
0  5969  28
1   684  99
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504646_17.png
early stop counter: 7
val acc:0.9670604467391968, best validation acc: 0.9672732949256897, corresponding to test acc:                         0.9004424810409546 / 0.9082595705986023
after epoch: 17,now: 2024-06-19 02:07:27.719888,epoch time: 0:20:12.973934,used: 6:05:33.971665,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504646
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99182016, 'precision': 0.98721135, 'recall': 0.96452475, 'specificity': 0.96452475, 'f1': 0.97552806, 'auroc': 0.99660146, 'binary_precision': 0.9815965, 'binary_recall': 0.93087035, 'binary_specificity': 0.99817914, 'binary_f1_score': 0.9555607}
confusion matrix:
       0     1
0  42211    77
1    305  4107
---- Validation: 
scalar performance:
{'acc': 0.96722007, 'precision': 0.7623981, 'recall': 0.6087518, 'specificity': 0.6087518, 'f1': 0.6508951, 'auroc': 0.83339405, 'binary_precision': 0.55172414, 'binary_recall': 0.22395024, 'binary_specificity': 0.99355334, 'binary_f1_score': 0.31858408}
confusion matrix:
       0    1
0  18032  117
1    499  144
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8964602, 'precision': 0.84300697, 'recall': 0.56838, 'specificity': 0.56838, 'f1': 0.5923521, 'auroc': 0.8146051, 'binary_precision': 0.78723407, 'binary_recall': 0.14176245, 'binary_specificity': 0.9949975, 'binary_f1_score': 0.24025974}
confusion matrix:
      0    1
0  5967   30
1   672  111
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504646_18.png
early stop counter: 8
val acc:0.9672200679779053, best validation acc: 0.9672732949256897, corresponding to test acc:                         0.9004424810409546 / 0.9082595705986023
after epoch: 18,now: 2024-06-19 02:31:41.976938,epoch time: 0:24:14.257050,used: 6:29:48.228715,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504646
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9919272, 'precision': 0.9873821, 'recall': 0.96498215, 'specificity': 0.96498215, 'f1': 0.97585094, 'auroc': 0.9973101, 'binary_precision': 0.98184425, 'binary_recall': 0.9317615, 'binary_specificity': 0.99820286, 'binary_f1_score': 0.95614755}
confusion matrix:
       0     1
0  42213    76
1    301  4110
---- Validation: 
scalar performance:
{'acc': 0.9667944, 'precision': 0.75616455, 'recall': 0.59653056, 'specificity': 0.59653056, 'f1': 0.6369541, 'auroc': 0.8294476, 'binary_precision': 0.54008436, 'binary_recall': 0.19906688, 'binary_specificity': 0.9939942, 'binary_f1_score': 0.29090908}
confusion matrix:
       0    1
0  18040  109
1    515  128
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89321536, 'precision': 0.8142854, 'recall': 0.55655223, 'specificity': 0.55655223, 'f1': 0.5735812, 'auroc': 0.81292415, 'binary_precision': 0.7322835, 'binary_recall': 0.118773945, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.2043956}
confusion matrix:
      0   1
0  5963  34
1   690  93
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504646_19.png
early stop counter: 9
val acc:0.9667943716049194, best validation acc: 0.9672732949256897, corresponding to test acc:                         0.9004424810409546 / 0.9082595705986023
after epoch: 19,now: 2024-06-19 02:51:19.480945,epoch time: 0:19:37.504007,used: 6:49:25.732722,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504646
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9924839, 'precision': 0.98682344, 'recall': 0.9688499, 'specificity': 0.9688499, 'f1': 0.97762394, 'auroc': 0.9967642, 'binary_precision': 0.9799102, 'binary_recall': 0.9397099, 'binary_specificity': 0.99798995, 'binary_f1_score': 0.95938915}
confusion matrix:
       0     1
0  42203    85
1    266  4146
---- Validation: 
scalar performance:
{'acc': 0.96647507, 'precision': 0.7492465, 'recall': 0.5986154, 'specificity': 0.5986154, 'f1': 0.638276, 'auroc': 0.8257028, 'binary_precision': 0.5261044, 'binary_recall': 0.2037325, 'binary_specificity': 0.99349827, 'binary_f1_score': 0.29372197}
confusion matrix:
       0    1
0  18031  118
1    512  131
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8946903, 'precision': 0.816465, 'recall': 0.5657139, 'specificity': 0.5657139, 'f1': 0.58786297, 'auroc': 0.80884993, 'binary_precision': 0.7346939, 'binary_recall': 0.13793103, 'binary_specificity': 0.9934968, 'binary_f1_score': 0.23225807}
confusion matrix:
      0    1
0  5958   39
1   675  108
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504646_20.png
early stop counter: 10
val acc:0.9664750695228577, best validation acc: 0.9672732949256897, corresponding to test acc:                         0.9004424810409546 / 0.9082595705986023
after epoch: 20,now: 2024-06-19 03:05:10.634390,epoch time: 0:13:51.153445,used: 7:03:16.886167,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504646
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99237686, 'precision': 0.98818696, 'recall': 0.96684766, 'specificity': 0.96684766, 'f1': 0.97721756, 'auroc': 0.99665487, 'binary_precision': 0.98307914, 'binary_recall': 0.93537414, 'binary_specificity': 0.9983211, 'binary_f1_score': 0.95863354}
confusion matrix:
       0     1
0  42219    71
1    285  4125
---- Validation: 
scalar performance:
{'acc': 0.96674114, 'precision': 0.75489706, 'recall': 0.597253, 'specificity': 0.597253, 'f1': 0.6375781, 'auroc': 0.8286774, 'binary_precision': 0.5375, 'binary_recall': 0.20062208, 'binary_specificity': 0.99388397, 'binary_f1_score': 0.29218575}
confusion matrix:
       0    1
0  18038  111
1    514  129
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89321536, 'precision': 0.8142854, 'recall': 0.55655223, 'specificity': 0.55655223, 'f1': 0.5735812, 'auroc': 0.81137824, 'binary_precision': 0.7322835, 'binary_recall': 0.118773945, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.2043956}
confusion matrix:
      0   1
0  5963  34
1   690  93
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504646_21.png
early stop counter: 11
val acc:0.966741144657135, best validation acc: 0.9672732949256897, corresponding to test acc:                         0.9004424810409546 / 0.9082595705986023
after epoch: 21,now: 2024-06-19 03:20:22.749870,epoch time: 0:15:12.115480,used: 7:18:29.001647,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504646
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99252677, 'precision': 0.98756856, 'recall': 0.968373, 'specificity': 0.968373, 'f1': 0.97772825, 'auroc': 0.99661124, 'binary_precision': 0.9815166, 'binary_recall': 0.9385905, 'binary_specificity': 0.9981555, 'binary_f1_score': 0.95957375}
confusion matrix:
       0     1
0  42209    78
1    271  4142
---- Validation: 
scalar performance:
{'acc': 0.966688, 'precision': 0.75309753, 'recall': 0.6017258, 'specificity': 0.6017258, 'f1': 0.64213824, 'auroc': 0.832782, 'binary_precision': 0.5335968, 'binary_recall': 0.20995334, 'binary_specificity': 0.99349827, 'binary_f1_score': 0.30133927}
confusion matrix:
       0    1
0  18031  118
1    508  135
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8920354, 'precision': 0.81223327, 'recall': 0.5492229, 'specificity': 0.5492229, 'f1': 0.5617078, 'auroc': 0.808056, 'binary_precision': 0.7297297, 'binary_recall': 0.10344828, 'binary_specificity': 0.9949975, 'binary_f1_score': 0.18120806}
confusion matrix:
      0   1
0  5967  30
1   702  81
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504646_22.png
early stop counter: 12
val acc:0.9666879773139954, best validation acc: 0.9672732949256897, corresponding to test acc:                         0.9004424810409546 / 0.9082595705986023
after epoch: 22,now: 2024-06-19 03:32:48.160982,epoch time: 0:12:25.411112,used: 7:30:54.412759,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504646
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9917987, 'precision': 0.99003553, 'recall': 0.96167934, 'specificity': 0.96167934, 'f1': 0.97532725, 'auroc': 0.99644494, 'binary_precision': 0.98789346, 'binary_recall': 0.9245411, 'binary_specificity': 0.9988176, 'binary_f1_score': 0.955168}
confusion matrix:
       0     1
0  42237    50
1    333  4080
---- Validation: 
scalar performance:
{'acc': 0.96753937, 'precision': 0.7853975, 'recall': 0.5751646, 'specificity': 0.5751646, 'f1': 0.6142313, 'auroc': 0.8236139, 'binary_precision': 0.6, 'binary_recall': 0.15396579, 'binary_specificity': 0.99636346, 'binary_f1_score': 0.2450495}
confusion matrix:
       0   1
0  18083  66
1    544  99
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8896755, 'precision': 0.8260759, 'recall': 0.531233, 'specificity': 0.531233, 'f1': 0.5305743, 'auroc': 0.78821707, 'binary_precision': 0.76119405, 'binary_recall': 0.0651341, 'binary_specificity': 0.997332, 'binary_f1_score': 0.120000005}
confusion matrix:
      0   1
0  5981  16
1   732  51
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504646_23.png
better model found
persisted
after epoch: 23,now: 2024-06-19 03:45:46.145096,epoch time: 0:12:57.984114,used: 7:43:52.396873,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504646
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99235547, 'precision': 0.9896323, 'recall': 0.9653048, 'specificity': 0.9653048, 'f1': 0.9770793, 'auroc': 0.9971156, 'binary_precision': 0.9863178, 'binary_recall': 0.93195736, 'binary_specificity': 0.9986522, 'binary_f1_score': 0.95836735}
confusion matrix:
       0     1
0  42234    57
1    300  4109
---- Validation: 
scalar performance:
{'acc': 0.9671137, 'precision': 0.76834154, 'recall': 0.5816947, 'specificity': 0.5816947, 'f1': 0.62108827, 'auroc': 0.82748765, 'binary_precision': 0.565445, 'binary_recall': 0.16796267, 'binary_specificity': 0.9954268, 'binary_f1_score': 0.2589928}
confusion matrix:
       0    1
0  18066   83
1    535  108
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89277285, 'precision': 0.8294833, 'recall': 0.54963976, 'specificity': 0.54963976, 'f1': 0.5624261, 'auroc': 0.79566264, 'binary_precision': 0.7641509, 'binary_recall': 0.10344828, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.18222722}
confusion matrix:
      0   1
0  5972  25
1   702  81
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504646_24.png
early stop counter: 1
val acc:0.9671136736869812, best validation acc: 0.967539370059967, corresponding to test acc:                         0.889675498008728 / 0.9082595705986023
after epoch: 24,now: 2024-06-19 03:59:10.230832,epoch time: 0:13:24.085736,used: 7:57:16.482609,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504646
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9927195, 'precision': 0.98768926, 'recall': 0.9693793, 'specificity': 0.9693793, 'f1': 0.9783139, 'auroc': 0.99776304, 'binary_precision': 0.9815472, 'binary_recall': 0.940603, 'binary_specificity': 0.99815553, 'binary_f1_score': 0.96063906}
confusion matrix:
       0     1
0  42211    78
1    262  4149
---- Validation: 
scalar performance:
{'acc': 0.96753937, 'precision': 0.77139187, 'recall': 0.6014165, 'specificity': 0.6014165, 'f1': 0.6443103, 'auroc': 0.83884126, 'binary_precision': 0.5702128, 'binary_recall': 0.20839813, 'binary_specificity': 0.99443495, 'binary_f1_score': 0.30523917}
confusion matrix:
       0    1
0  18048  101
1    509  134
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8918879, 'precision': 0.822006, 'recall': 0.5458083, 'specificity': 0.5458083, 'f1': 0.5560271, 'auroc': 0.80769837, 'binary_precision': 0.75, 'binary_recall': 0.09578544, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.16987543}
confusion matrix:
      0   1
0  5972  25
1   708  75
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504646_25.png
early stop counter: 2
val acc:0.967539370059967, best validation acc: 0.967539370059967, corresponding to test acc:                         0.889675498008728 / 0.9082595705986023
after epoch: 25,now: 2024-06-19 04:11:37.199812,epoch time: 0:12:26.968980,used: 8:09:43.451589,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504646
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99205565, 'precision': 0.98818564, 'recall': 0.9649284, 'specificity': 0.9649284, 'f1': 0.97620046, 'auroc': 0.9964655, 'binary_precision': 0.98347306, 'binary_recall': 0.9314882, 'binary_specificity': 0.9983685, 'binary_f1_score': 0.956775}
confusion matrix:
       0     1
0  42223    69
1    302  4106
---- Validation: 
scalar performance:
{'acc': 0.96722007, 'precision': 0.7736043, 'recall': 0.57724947, 'specificity': 0.57724947, 'f1': 0.61601245, 'auroc': 0.8232058, 'binary_precision': 0.5762712, 'binary_recall': 0.15863141, 'binary_specificity': 0.99586755, 'binary_f1_score': 0.24878047}
confusion matrix:
       0    1
0  18074   75
1    541  102
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89056045, 'precision': 0.8090419, 'recall': 0.54006124, 'specificity': 0.54006124, 'f1': 0.54627, 'auroc': 0.7919872, 'binary_precision': 0.72527474, 'binary_recall': 0.08429119, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.15102977}
confusion matrix:
      0   1
0  5972  25
1   717  66
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504646_26.png
early stop counter: 3
val acc:0.9672200679779053, best validation acc: 0.967539370059967, corresponding to test acc:                         0.889675498008728 / 0.9082595705986023
after epoch: 26,now: 2024-06-19 04:23:33.516797,epoch time: 0:11:56.316985,used: 8:21:39.768574,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504646
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9926981, 'precision': 0.98850125, 'recall': 0.9684676, 'specificity': 0.9684676, 'f1': 0.97822064, 'auroc': 0.9969394, 'binary_precision': 0.9833808, 'binary_recall': 0.9385905, 'binary_specificity': 0.99834466, 'binary_f1_score': 0.9604637}
confusion matrix:
       0     1
0  42217    70
1    271  4142
---- Validation: 
scalar performance:
{'acc': 0.96737975, 'precision': 0.7810763, 'recall': 0.5735818, 'specificity': 0.5735818, 'f1': 0.61186427, 'auroc': 0.8242113, 'binary_precision': 0.5914634, 'binary_recall': 0.15085536, 'binary_specificity': 0.9963083, 'binary_f1_score': 0.24039653}
confusion matrix:
       0   1
0  18082  67
1    546  97
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8886431, 'precision': 0.7981885, 'recall': 0.52898383, 'specificity': 0.52898383, 'f1': 0.52670085, 'auroc': 0.7851325, 'binary_precision': 0.7058824, 'binary_recall': 0.06130268, 'binary_specificity': 0.996665, 'binary_f1_score': 0.11280846}
confusion matrix:
      0   1
0  5977  20
1   735  48
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504646_27.png
early stop counter: 4
val acc:0.9673797488212585, best validation acc: 0.967539370059967, corresponding to test acc:                         0.889675498008728 / 0.9082595705986023
after epoch: 27,now: 2024-06-19 04:35:45.933374,epoch time: 0:12:12.416577,used: 8:33:52.185151,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504646
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9928908, 'precision': 0.9884187, 'recall': 0.96969026, 'specificity': 0.96969026, 'f1': 0.9788242, 'auroc': 0.99670637, 'binary_precision': 0.98295856, 'binary_recall': 0.9410832, 'binary_specificity': 0.99829733, 'binary_f1_score': 0.9615652}
confusion matrix:
       0     1
0  42215    72
1    260  4153
---- Validation: 
scalar performance:
{'acc': 0.9676458, 'precision': 0.77572703, 'recall': 0.5969713, 'specificity': 0.5969713, 'f1': 0.6398693, 'auroc': 0.8341098, 'binary_precision': 0.57918555, 'binary_recall': 0.19906688, 'binary_specificity': 0.9948757, 'binary_f1_score': 0.2962963}
confusion matrix:
       0    1
0  18056   93
1    515  128
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.889823, 'precision': 0.780051, 'recall': 0.5429755, 'specificity': 0.5429755, 'f1': 0.5513267, 'auroc': 0.8039882, 'binary_precision': 0.6666667, 'binary_recall': 0.09195402, 'binary_specificity': 0.993997, 'binary_f1_score': 0.16161616}
confusion matrix:
      0   1
0  5961  36
1   711  72
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504646_28.png
better model found
persisted
after epoch: 28,now: 2024-06-19 04:49:11.355034,epoch time: 0:13:25.421660,used: 8:47:17.606811,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504646
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9928694, 'precision': 0.99027014, 'recall': 0.96774316, 'specificity': 0.96774316, 'f1': 0.9786739, 'auroc': 0.9967805, 'binary_precision': 0.9871029, 'binary_recall': 0.93676335, 'binary_specificity': 0.99872303, 'binary_f1_score': 0.96127456}
confusion matrix:
       0     1
0  42234    54
1    279  4133
---- Validation: 
scalar performance:
{'acc': 0.96780545, 'precision': 0.7873355, 'recall': 0.584303, 'specificity': 0.584303, 'f1': 0.62599033, 'auroc': 0.8318875, 'binary_precision': 0.6032609, 'binary_recall': 0.1726283, 'binary_specificity': 0.99597776, 'binary_f1_score': 0.26844016}
confusion matrix:
       0    1
0  18076   73
1    532  111
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89277285, 'precision': 0.83723056, 'recall': 0.54797417, 'specificity': 0.54797417, 'f1': 0.55966127, 'auroc': 0.8050908, 'binary_precision': 0.78, 'binary_recall': 0.099616855, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.17667043}
confusion matrix:
      0   1
0  5975  22
1   705  78
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504646_29.png
better model found
persisted
after epoch: 29,now: 2024-06-19 05:04:29.272700,epoch time: 0:15:17.917666,used: 9:02:35.524477,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504646
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99291223, 'precision': 0.98997843, 'recall': 0.9682533, 'specificity': 0.9682533, 'f1': 0.97880644, 'auroc': 0.997278, 'binary_precision': 0.9864027, 'binary_recall': 0.9378544, 'binary_specificity': 0.9986522, 'binary_f1_score': 0.96151614}
confusion matrix:
       0     1
0  42234    57
1    274  4135
---- Validation: 
scalar performance:
{'acc': 0.9671137, 'precision': 0.77075255, 'recall': 0.5764443, 'specificity': 0.5764443, 'f1': 0.61476576, 'auroc': 0.82221866, 'binary_precision': 0.5706215, 'binary_recall': 0.15707621, 'binary_specificity': 0.9958124, 'binary_f1_score': 0.24634145}
confusion matrix:
       0    1
0  18073   76
1    542  101
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8893805, 'precision': 0.8056376, 'recall': 0.5327319, 'specificity': 0.5327319, 'f1': 0.5334142, 'auroc': 0.7847856, 'binary_precision': 0.72, 'binary_recall': 0.06896552, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.12587413}
confusion matrix:
      0   1
0  5976  21
1   729  54
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504646_30.png
early stop counter: 1
val acc:0.9671136736869812, best validation acc: 0.9678054451942444, corresponding to test acc:                         0.8927728533744812 / 0.9082595705986023
after epoch: 30,now: 2024-06-19 05:17:42.911552,epoch time: 0:13:13.638852,used: 9:15:49.163329,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504646
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 9:15:49.163329 at 2024-06-19 05:17:42.911552
persisted model performance metric: 

scalar performance:
{'acc': 0.89277285, 'precision': 0.83723056, 'recall': 0.54797417, 'specificity': 0.54797417, 'f1': 0.55966127, 'auroc': 0.8050908, 'binary_precision': 0.78, 'binary_recall': 0.099616855, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.17667043}
confusion matrix:
      0   1
0  5975  22
1   705  78
oracle model performance metric: 

scalar performance:
{'acc': 0.9082596, 'precision': 0.8902302, 'recall': 0.61835515, 'specificity': 0.61835515, 'f1': 0.66423887, 'auroc': 0.8143147, 'binary_precision': 0.87096775, 'binary_recall': 0.2413793, 'binary_specificity': 0.995331, 'binary_f1_score': 0.378}
confusion matrix:
      0    1
0  5969   28
1   594  189
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4_classbalancing/rule_results/1.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4_classbalancing/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4_classbalancing/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204211 KiB |   1436 MiB | 428252 GiB | 428252 GiB |
|       from large pool | 167936 KiB |   1366 MiB | 428173 GiB | 428173 GiB |
|       from small pool |  36275 KiB |     72 MiB |     78 GiB |     78 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 204211 KiB |   1436 MiB | 428252 GiB | 428252 GiB |
|       from large pool | 167936 KiB |   1366 MiB | 428173 GiB | 428173 GiB |
|       from small pool |  36275 KiB |     72 MiB |     78 GiB |     78 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201112 KiB |   1428 MiB | 428227 GiB | 428227 GiB |
|       from large pool | 165120 KiB |   1358 MiB | 428151 GiB | 428151 GiB |
|       from small pool |  35992 KiB |     71 MiB |     75 GiB |     75 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1524 MiB |   1524 MiB |   1524 MiB |      0 B   |
|       from large pool |   1450 MiB |   1450 MiB |   1450 MiB |      0 B   |
|       from small pool |     74 MiB |     74 MiB |     74 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 320076 KiB | 628877 KiB | 319528 GiB | 319528 GiB |
|       from large pool | 311296 KiB | 627520 KiB | 319443 GiB | 319443 GiB |
|       from small pool |   8780 KiB |  12547 KiB |     85 GiB |     85 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1308    |    1965    |   14080 K  |   14079 K  |
|       from large pool |      36    |      76    |    5616 K  |    5616 K  |
|       from small pool |    1272    |    1894    |    8464 K  |    8462 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1308    |    1965    |   14080 K  |   14079 K  |
|       from large pool |      36    |      76    |    5616 K  |    5616 K  |
|       from small pool |    1272    |    1894    |    8464 K  |    8462 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      50    |      50    |      50    |       0    |
|       from large pool |      13    |      13    |      13    |       0    |
|       from small pool |      37    |      37    |      37    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      31    |     479    |    7460 K  |    7460 K  |
|       from large pool |       5    |      10    |    2087 K  |    2087 K  |
|       from small pool |      26    |     474    |    5373 K  |    5373 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1436 MiB | 428252 GiB | 428252 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 428173 GiB | 428173 GiB |
|       from small pool |      0 KiB |     72 MiB |     78 GiB |     78 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1436 MiB | 428252 GiB | 428252 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 428173 GiB | 428173 GiB |
|       from small pool |      0 KiB |     72 MiB |     78 GiB |     78 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1428 MiB | 428227 GiB | 428227 GiB |
|       from large pool |  16640 KiB |   1358 MiB | 428151 GiB | 428151 GiB |
|       from small pool |      0 KiB |     71 MiB |     75 GiB |     75 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 524288 KiB |   1524 MiB |   1524 MiB |   1012 MiB |
|       from large pool | 479232 KiB |   1450 MiB |   1450 MiB |    982 MiB |
|       from small pool |  45056 KiB |     74 MiB |     74 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 298752 KiB | 628877 KiB | 319529 GiB | 319528 GiB |
|       from large pool | 298752 KiB | 627520 KiB | 319443 GiB | 319443 GiB |
|       from small pool |      0 KiB |  16375 KiB |     85 GiB |     85 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1965    |   14080 K  |   14080 K  |
|       from large pool |       2    |      76    |    5616 K  |    5616 K  |
|       from small pool |       0    |    1894    |    8464 K  |    8464 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1965    |   14080 K  |   14080 K  |
|       from large pool |       2    |      76    |    5616 K  |    5616 K  |
|       from small pool |       0    |    1894    |    8464 K  |    8464 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      50    |      50    |      19    |
|       from large pool |       9    |      13    |      13    |       4    |
|       from small pool |      22    |      37    |      37    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     479    |    7461 K  |    7461 K  |
|       from large pool |       1    |      11    |    2087 K  |    2087 K  |
|       from small pool |       0    |     474    |    5373 K  |    5373 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1436 MiB | 428252 GiB | 428252 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 428173 GiB | 428173 GiB |
|       from small pool |      0 KiB |     72 MiB |     78 GiB |     78 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1436 MiB | 428252 GiB | 428252 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 428173 GiB | 428173 GiB |
|       from small pool |      0 KiB |     72 MiB |     78 GiB |     78 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1428 MiB | 428227 GiB | 428227 GiB |
|       from large pool |  16640 KiB |   1358 MiB | 428151 GiB | 428151 GiB |
|       from small pool |      0 KiB |     71 MiB |     75 GiB |     75 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 524288 KiB |   1524 MiB |   1524 MiB |   1012 MiB |
|       from large pool | 479232 KiB |   1450 MiB |   1450 MiB |    982 MiB |
|       from small pool |  45056 KiB |     74 MiB |     74 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 298752 KiB | 628877 KiB | 319529 GiB | 319528 GiB |
|       from large pool | 298752 KiB | 627520 KiB | 319443 GiB | 319443 GiB |
|       from small pool |      0 KiB |  16375 KiB |     85 GiB |     85 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1965    |   14080 K  |   14080 K  |
|       from large pool |       2    |      76    |    5616 K  |    5616 K  |
|       from small pool |       0    |    1894    |    8464 K  |    8464 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1965    |   14080 K  |   14080 K  |
|       from large pool |       2    |      76    |    5616 K  |    5616 K  |
|       from small pool |       0    |    1894    |    8464 K  |    8464 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      50    |      50    |      19    |
|       from large pool |       9    |      13    |      13    |       4    |
|       from small pool |      22    |      37    |      37    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     479    |    7461 K  |    7461 K  |
|       from large pool |       1    |      11    |    2087 K  |    2087 K  |
|       from small pool |       0    |     474    |    5373 K  |    5373 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0




!!!: not committed yet



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_05_22_53_seed_1_21504646

 Experiment start at: 2024-06-19 05:22:54.022957
before training, model accuracy: 0.2048765867948532
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.94550323, 'precision': 0.9433259, 'recall': 0.7179389, 'specificity': 0.7179389, 'f1': 0.7845794, 'auroc': 0.94779, 'binary_precision': 0.94094294, 'binary_recall': 0.4386858, 'binary_specificity': 0.99719197, 'binary_f1_score': 0.5983904}
confusion matrix:
       0     1
0  42259   119
1   2426  1896
---- Validation: 
scalar performance:
{'acc': 0.9639808, 'precision': 0.60706663, 'recall': 0.5006599, 'specificity': 0.5006599, 'f1': 0.49230665, 'auroc': 0.5393651, 'binary_precision': 0.25, 'binary_recall': 0.0014858841, 'binary_specificity': 0.99983394, 'binary_f1_score': 0.0029542097}
confusion matrix:
       0  1
0  18064  3
1    672  1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88403213, 'precision': 0.44201607, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4692235, 'auroc': 0.55744827, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   780  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504646_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-19 05:36:00.504527,epoch time: 0:13:06.481570,used: 0:13:06.481570,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_05_22_53_seed_1_21504646
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9730407, 'precision': 0.9809519, 'recall': 0.8576361, 'specificity': 0.8576361, 'f1': 0.9081906, 'auroc': 0.97642004, 'binary_precision': 0.9900863, 'binary_recall': 0.7160037, 'binary_specificity': 0.9992685, 'binary_f1_score': 0.8310294}
confusion matrix:
       0     1
0  42345    31
1   1228  3096
---- Validation: 
scalar performance:
{'acc': 0.9649413, 'precision': 0.79192656, 'recall': 0.530484, 'specificity': 0.530484, 'f1': 0.54773873, 'auroc': 0.65303445, 'binary_precision': 0.61764705, 'binary_recall': 0.062407132, 'binary_specificity': 0.9985609, 'binary_f1_score': 0.11336032}
confusion matrix:
       0   1
0  18041  26
1    631  42
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8847755, 'precision': 0.75853586, 'recall': 0.5071037, 'specificity': 0.5071037, 'f1': 0.48439363, 'auroc': 0.6909732, 'binary_precision': 0.6315789, 'binary_recall': 0.015384615, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.030037548}
confusion matrix:
      0   1
0  5939   7
1   768  12
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504646_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-19 05:48:01.855441,epoch time: 0:12:01.350914,used: 0:25:07.832484,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_05_22_53_seed_1_21504646
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97974306, 'precision': 0.9847826, 'recall': 0.8938354, 'specificity': 0.8938354, 'f1': 0.9335077, 'auroc': 0.98552984, 'binary_precision': 0.99069226, 'binary_recall': 0.7884259, 'binary_specificity': 0.9992449, 'binary_f1_score': 0.87806135}
confusion matrix:
       0     1
0  42348    32
1    914  3406
---- Validation: 
scalar performance:
{'acc': 0.96568835, 'precision': 0.8008058, 'recall': 0.5516142, 'specificity': 0.5516142, 'f1': 0.5816844, 'auroc': 0.71632135, 'binary_precision': 0.6339286, 'binary_recall': 0.10549777, 'binary_specificity': 0.9977307, 'binary_f1_score': 0.18089171}
confusion matrix:
       0   1
0  18026  41
1    602  71
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89325005, 'precision': 0.90048873, 'recall': 0.54364216, 'specificity': 0.54364216, 'f1': 0.5521064, 'auroc': 0.7497603, 'binary_precision': 0.90789473, 'binary_recall': 0.08846154, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.16121496}
confusion matrix:
      0   1
0  5939   7
1   711  69
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504646_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-19 06:00:46.243908,epoch time: 0:12:44.388467,used: 0:37:52.220951,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_05_22_53_seed_1_21504646
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.982334, 'precision': 0.97874856, 'recall': 0.91432357, 'specificity': 0.91432357, 'f1': 0.943652, 'auroc': 0.9870411, 'binary_precision': 0.9744912, 'binary_recall': 0.8308653, 'binary_specificity': 0.9977819, 'binary_f1_score': 0.89696515}
confusion matrix:
       0     1
0  42284    94
1    731  3591
---- Validation: 
scalar performance:
{'acc': 0.96611524, 'precision': 0.783478, 'recall': 0.5847379, 'specificity': 0.5847379, 'f1': 0.62596524, 'auroc': 0.74427736, 'binary_precision': 0.5969388, 'binary_recall': 0.17384844, 'binary_specificity': 0.9956274, 'binary_f1_score': 0.269275}
confusion matrix:
       0    1
0  17988   79
1    556  117
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90172464, 'precision': 0.8906245, 'recall': 0.5868638, 'specificity': 0.5868638, 'f1': 0.62087023, 'auroc': 0.7635101, 'binary_precision': 0.8789809, 'binary_recall': 0.17692308, 'binary_specificity': 0.9968046, 'binary_f1_score': 0.29455712}
confusion matrix:
      0    1
0  5927   19
1   642  138
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504646_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-19 06:12:50.273884,epoch time: 0:12:04.029976,used: 0:49:56.250927,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_05_22_53_seed_1_21504646
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98394006, 'precision': 0.9843328, 'recall': 0.91905236, 'specificity': 0.91905236, 'f1': 0.94876873, 'auroc': 0.9905788, 'binary_precision': 0.98479915, 'binary_recall': 0.8394262, 'binary_specificity': 0.99867857, 'binary_f1_score': 0.9063203}
confusion matrix:
       0     1
0  42322    56
1    694  3628
---- Validation: 
scalar performance:
{'acc': 0.9663287, 'precision': 0.7972082, 'recall': 0.5762654, 'specificity': 0.5762654, 'f1': 0.6162403, 'auroc': 0.75924873, 'binary_precision': 0.625, 'binary_recall': 0.15601783, 'binary_specificity': 0.996513, 'binary_f1_score': 0.24970272}
confusion matrix:
       0    1
0  18004   63
1    568  105
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90291405, 'precision': 0.906216, 'recall': 0.58920735, 'specificity': 0.58920735, 'f1': 0.6247176, 'auroc': 0.7816331, 'binary_precision': 0.90967745, 'binary_recall': 0.18076923, 'binary_specificity': 0.9976455, 'binary_f1_score': 0.30160427}
confusion matrix:
      0    1
0  5932   14
1   639  141
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504646_5.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-06-19 06:24:46.710151,epoch time: 0:11:56.436267,used: 1:01:52.687194,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_05_22_53_seed_1_21504646
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98642397, 'precision': 0.98324907, 'recall': 0.93483186, 'specificity': 0.93483186, 'f1': 0.95745194, 'auroc': 0.9915755, 'binary_precision': 0.9794485, 'binary_recall': 0.8715278, 'binary_specificity': 0.9981359, 'binary_f1_score': 0.92234206}
confusion matrix:
       0     1
0  42301    79
1    555  3765
---- Validation: 
scalar performance:
{'acc': 0.9665422, 'precision': 0.79379, 'recall': 0.58782035, 'specificity': 0.58782035, 'f1': 0.63067746, 'auroc': 0.78140795, 'binary_precision': 0.61734694, 'binary_recall': 0.17979197, 'binary_specificity': 0.9958488, 'binary_f1_score': 0.278481}
confusion matrix:
       0    1
0  17992   75
1    552  121
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.906631, 'precision': 0.90341187, 'recall': 0.6080177, 'specificity': 0.6080177, 'f1': 0.65113246, 'auroc': 0.7975402, 'binary_precision': 0.9, 'binary_recall': 0.21923077, 'binary_specificity': 0.9968046, 'binary_f1_score': 0.35257733}
confusion matrix:
      0    1
0  5927   19
1   609  171
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504646_6.png
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-06-19 06:36:46.195657,epoch time: 0:11:59.485506,used: 1:13:52.172700,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_05_22_53_seed_1_21504646
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98764455, 'precision': 0.98284805, 'recall': 0.94262445, 'specificity': 0.94262445, 'f1': 0.9616464, 'auroc': 0.9933529, 'binary_precision': 0.9770817, 'binary_recall': 0.8873728, 'binary_specificity': 0.99787617, 'binary_f1_score': 0.9300691}
confusion matrix:
       0     1
0  42286    90
1    487  3837
---- Validation: 
scalar performance:
{'acc': 0.9664888, 'precision': 0.78676486, 'recall': 0.5956606, 'specificity': 0.5956606, 'f1': 0.6394, 'auroc': 0.79209644, 'binary_precision': 0.60273975, 'binary_recall': 0.1961367, 'binary_specificity': 0.9951846, 'binary_f1_score': 0.29596412}
confusion matrix:
       0    1
0  17980   87
1    541  132
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9084151, 'precision': 0.9015493, 'recall': 0.6173808, 'specificity': 0.6173808, 'f1': 0.66354793, 'auroc': 0.8078437, 'binary_precision': 0.8942308, 'binary_recall': 0.23846154, 'binary_specificity': 0.99630004, 'binary_f1_score': 0.37651822}
confusion matrix:
      0    1
0  5924   22
1   594  186
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504646_7.png
new oracle model saved
early stop counter: 1
val acc:0.966488778591156, best validation acc: 0.9665421843528748, corresponding to test acc:                         0.9066309928894043 / 0.9084150791168213
after epoch: 7,now: 2024-06-19 06:48:27.588993,epoch time: 0:11:41.393336,used: 1:25:33.566036,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_05_22_53_seed_1_21504646
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9872377, 'precision': 0.984585, 'recall': 0.9385584, 'specificity': 0.9385584, 'f1': 0.9601433, 'auroc': 0.99300873, 'binary_precision': 0.98140496, 'binary_recall': 0.8788159, 'binary_specificity': 0.9983009, 'binary_f1_score': 0.92728156}
confusion matrix:
       0     1
0  42304    72
1    524  3800
---- Validation: 
scalar performance:
{'acc': 0.96659553, 'precision': 0.79310054, 'recall': 0.5907091, 'specificity': 0.5907091, 'f1': 0.6341431, 'auroc': 0.8027896, 'binary_precision': 0.61576355, 'binary_recall': 0.18573551, 'binary_specificity': 0.9956827, 'binary_f1_score': 0.2853881}
confusion matrix:
       0    1
0  17989   78
1    548  125
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90336007, 'precision': 0.8931289, 'recall': 0.59447205, 'specificity': 0.59447205, 'f1': 0.6318989, 'auroc': 0.81422997, 'binary_precision': 0.88235295, 'binary_recall': 0.1923077, 'binary_specificity': 0.9966364, 'binary_f1_score': 0.31578946}
confusion matrix:
      0    1
0  5926   20
1   630  150
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504646_8.png
better model found
persisted
after epoch: 8,now: 2024-06-19 07:00:17.857176,epoch time: 0:11:50.268183,used: 1:37:23.834219,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_05_22_53_seed_1_21504646
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98753744, 'precision': 0.9835502, 'recall': 0.94131947, 'specificity': 0.94131947, 'f1': 0.9612334, 'auroc': 0.99400616, 'binary_precision': 0.9787615, 'binary_recall': 0.8845976, 'binary_specificity': 0.99804133, 'binary_f1_score': 0.9293003}
confusion matrix:
       0     1
0  42293    83
1    499  3825
---- Validation: 
scalar performance:
{'acc': 0.9667556, 'precision': 0.7965464, 'recall': 0.5922227, 'specificity': 0.5922227, 'f1': 0.63630164, 'auroc': 0.80361176, 'binary_precision': 0.622549, 'binary_recall': 0.18870728, 'binary_specificity': 0.9957381, 'binary_f1_score': 0.2896237}
confusion matrix:
       0    1
0  17990   77
1    546  127
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9042522, 'precision': 0.8955482, 'recall': 0.5983182, 'specificity': 0.5983182, 'f1': 0.63741165, 'auroc': 0.8187468, 'binary_precision': 0.8863636, 'binary_recall': 0.2, 'binary_specificity': 0.9966364, 'binary_f1_score': 0.3263598}
confusion matrix:
      0    1
0  5926   20
1   624  156
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504646_9.png
better model found
persisted
after epoch: 9,now: 2024-06-19 07:11:57.043666,epoch time: 0:11:39.186490,used: 1:49:03.020709,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_05_22_53_seed_1_21504646
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9893576, 'precision': 0.98357606, 'recall': 0.95230126, 'specificity': 0.95230126, 'f1': 0.9672859, 'auroc': 0.99418133, 'binary_precision': 0.9765936, 'binary_recall': 0.90682083, 'binary_specificity': 0.9977817, 'binary_f1_score': 0.9404148}
confusion matrix:
       0     1
0  42281    94
1    403  3922
---- Validation: 
scalar performance:
{'acc': 0.966809, 'precision': 0.7922189, 'recall': 0.6001183, 'specificity': 0.6001183, 'f1': 0.6451734, 'auroc': 0.8059199, 'binary_precision': 0.61333334, 'binary_recall': 0.205052, 'binary_specificity': 0.9951846, 'binary_f1_score': 0.30734965}
confusion matrix:
       0    1
0  17980   87
1    535  138
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9042522, 'precision': 0.8835889, 'recall': 0.6016598, 'specificity': 0.6016598, 'f1': 0.64156234, 'auroc': 0.8032365, 'binary_precision': 0.86170214, 'binary_recall': 0.20769231, 'binary_specificity': 0.9956273, 'binary_f1_score': 0.33471075}
confusion matrix:
      0    1
0  5920   26
1   618  162
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504646_10.png
better model found
persisted
after epoch: 10,now: 2024-06-19 07:23:44.682523,epoch time: 0:11:47.638857,used: 2:00:50.659566,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_05_22_53_seed_1_21504646
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9895289, 'precision': 0.98093355, 'recall': 0.9558759, 'specificity': 0.9558759, 'f1': 0.9679855, 'auroc': 0.9946093, 'binary_precision': 0.97052324, 'binary_recall': 0.9145833, 'binary_specificity': 0.9971685, 'binary_f1_score': 0.9417233}
confusion matrix:
       0     1
0  42260   120
1    369  3951
---- Validation: 
scalar performance:
{'acc': 0.9665422, 'precision': 0.78047884, 'recall': 0.60999364, 'specificity': 0.60999364, 'f1': 0.65468776, 'auroc': 0.8237597, 'binary_precision': 0.58914727, 'binary_recall': 0.22585438, 'binary_specificity': 0.99413294, 'binary_f1_score': 0.3265306}
confusion matrix:
       0    1
0  17961  106
1    521  152
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90796906, 'precision': 0.88528335, 'recall': 0.6204701, 'specificity': 0.6204701, 'f1': 0.6665643, 'auroc': 0.8326328, 'binary_precision': 0.86098653, 'binary_recall': 0.24615385, 'binary_specificity': 0.9947864, 'binary_f1_score': 0.38285142}
confusion matrix:
      0    1
0  5915   31
1   588  192
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504646_11.png
early stop counter: 1
val acc:0.9665421843528748, best validation acc: 0.9668089747428894, corresponding to test acc:                         0.9042521715164185 / 0.9084150791168213
after epoch: 11,now: 2024-06-19 07:37:35.262941,epoch time: 0:13:50.580418,used: 2:14:41.239984,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_05_22_53_seed_1_21504646
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9893362, 'precision': 0.9805987, 'recall': 0.9550722, 'specificity': 0.9550722, 'f1': 0.9673997, 'auroc': 0.99511254, 'binary_precision': 0.9700172, 'binary_recall': 0.91302335, 'binary_specificity': 0.9971211, 'binary_f1_score': 0.9406578}
confusion matrix:
       0     1
0  42255   122
1    376  3947
---- Validation: 
scalar performance:
{'acc': 0.966809, 'precision': 0.79128003, 'recall': 0.60154885, 'specificity': 0.60154885, 'f1': 0.64670825, 'auroc': 0.8215387, 'binary_precision': 0.6113537, 'binary_recall': 0.20802377, 'binary_specificity': 0.9950739, 'binary_f1_score': 0.3104213}
confusion matrix:
       0    1
0  17978   89
1    533  140
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90261674, 'precision': 0.8693986, 'recall': 0.5973932, 'specificity': 0.5973932, 'f1': 0.6350922, 'auroc': 0.81351525, 'binary_precision': 0.8342246, 'binary_recall': 0.2, 'binary_specificity': 0.9947864, 'binary_f1_score': 0.32264736}
confusion matrix:
      0    1
0  5915   31
1   624  156
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504646_12.png
early stop counter: 2
val acc:0.9668089747428894, best validation acc: 0.9668089747428894, corresponding to test acc:                         0.9042521715164185 / 0.9084150791168213
after epoch: 12,now: 2024-06-19 07:51:39.797534,epoch time: 0:14:04.534593,used: 2:28:45.774577,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_05_22_53_seed_1_21504646
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.990364, 'precision': 0.9847724, 'recall': 0.9571579, 'specificity': 0.9571579, 'f1': 0.9704594, 'auroc': 0.9954424, 'binary_precision': 0.9780084, 'binary_recall': 0.9164158, 'binary_specificity': 0.9979, 'binary_f1_score': 0.9462108}
confusion matrix:
       0     1
0  42292    89
1    361  3958
---- Validation: 
scalar performance:
{'acc': 0.9668623, 'precision': 0.79358876, 'recall': 0.60014594, 'specificity': 0.60014594, 'f1': 0.64535856, 'auroc': 0.8285765, 'binary_precision': 0.6160714, 'binary_recall': 0.205052, 'binary_specificity': 0.9952399, 'binary_f1_score': 0.30769232}
confusion matrix:
       0    1
0  17981   86
1    535  138
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90261674, 'precision': 0.8804872, 'recall': 0.5940516, 'specificity': 0.5940516, 'f1': 0.63086176, 'auroc': 0.82444763, 'binary_precision': 0.85714287, 'binary_recall': 0.1923077, 'binary_specificity': 0.9957955, 'binary_f1_score': 0.31413615}
confusion matrix:
      0    1
0  5921   25
1   630  150
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504646_13.png
better model found
persisted
after epoch: 13,now: 2024-06-19 08:04:26.911580,epoch time: 0:12:47.114046,used: 2:41:32.888623,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_05_22_53_seed_1_21504646
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.990621, 'precision': 0.9864545, 'recall': 0.9571401, 'specificity': 0.9571401, 'f1': 0.9712286, 'auroc': 0.9955534, 'binary_precision': 0.98141724, 'binary_recall': 0.91604996, 'binary_specificity': 0.99823016, 'binary_f1_score': 0.9476077}
confusion matrix:
       0     1
0  42301    75
1    363  3961
---- Validation: 
scalar performance:
{'acc': 0.966809, 'precision': 0.7969177, 'recall': 0.59368086, 'specificity': 0.59368086, 'f1': 0.63809365, 'auroc': 0.82407534, 'binary_precision': 0.6231884, 'binary_recall': 0.19167905, 'binary_specificity': 0.9956827, 'binary_f1_score': 0.2931818}
confusion matrix:
       0    1
0  17989   78
1    544  129
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89681834, 'precision': 0.87226623, 'recall': 0.56571, 'specificity': 0.56571, 'f1': 0.5884966, 'auroc': 0.823041, 'binary_precision': 0.8467742, 'binary_recall': 0.13461539, 'binary_specificity': 0.9968046, 'binary_f1_score': 0.23230089}
confusion matrix:
      0    1
0  5927   19
1   675  105
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504646_14.png
early stop counter: 1
val acc:0.9668089747428894, best validation acc: 0.9668623208999634, corresponding to test acc:                         0.9026167392730713 / 0.9084150791168213
after epoch: 14,now: 2024-06-19 08:16:14.397362,epoch time: 0:11:47.485782,used: 2:53:20.374405,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_05_22_53_seed_1_21504646
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9912848, 'precision': 0.9865657, 'recall': 0.9610362, 'specificity': 0.9610362, 'f1': 0.97337115, 'auroc': 0.9962579, 'binary_precision': 0.9808495, 'binary_recall': 0.92391306, 'binary_specificity': 0.99815935, 'binary_f1_score': 0.95153034}
confusion matrix:
       0     1
0  42298    78
1    329  3995
---- Validation: 
scalar performance:
{'acc': 0.966809, 'precision': 0.79808056, 'recall': 0.59225035, 'specificity': 0.59225035, 'f1': 0.63648087, 'auroc': 0.82941055, 'binary_precision': 0.6256158, 'binary_recall': 0.18870728, 'binary_specificity': 0.99579346, 'binary_f1_score': 0.28995433}
confusion matrix:
       0    1
0  17991   76
1    546  127
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89533156, 'precision': 0.8470583, 'recall': 0.56319827, 'specificity': 0.56319827, 'f1': 0.5842736, 'auroc': 0.8246809, 'binary_precision': 0.796875, 'binary_recall': 0.13076924, 'binary_specificity': 0.9956273, 'binary_f1_score': 0.2246696}
confusion matrix:
      0    1
0  5920   26
1   678  102
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504646_15.png
early stop counter: 2
val acc:0.9668089747428894, best validation acc: 0.9668623208999634, corresponding to test acc:                         0.9026167392730713 / 0.9084150791168213
after epoch: 15,now: 2024-06-19 08:29:09.007987,epoch time: 0:12:54.610625,used: 3:06:14.985030,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_05_22_53_seed_1_21504646
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.991242, 'precision': 0.98579216, 'recall': 0.9615231, 'specificity': 0.9615231, 'f1': 0.973269, 'auroc': 0.9962388, 'binary_precision': 0.9791871, 'binary_recall': 0.92505205, 'binary_specificity': 0.9979942, 'binary_f1_score': 0.9513501}
confusion matrix:
       0     1
0  42292    85
1    324  3999
---- Validation: 
scalar performance:
{'acc': 0.96659553, 'precision': 0.79002225, 'recall': 0.59500074, 'specificity': 0.59500074, 'f1': 0.63896877, 'auroc': 0.82586575, 'binary_precision': 0.60930234, 'binary_recall': 0.19465081, 'binary_specificity': 0.99535066, 'binary_f1_score': 0.29504505}
confusion matrix:
       0    1
0  17983   84
1    542  131
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9003866, 'precision': 0.85593, 'recall': 0.58944863, 'specificity': 0.58944863, 'f1': 0.6235003, 'auroc': 0.81900144, 'binary_precision': 0.80898875, 'binary_recall': 0.18461539, 'binary_specificity': 0.9942819, 'binary_f1_score': 0.3006263}
confusion matrix:
      0    1
0  5912   34
1   636  144
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504646_16.png
early stop counter: 3
val acc:0.9665955305099487, best validation acc: 0.9668623208999634, corresponding to test acc:                         0.9026167392730713 / 0.9084150791168213
after epoch: 16,now: 2024-06-19 08:42:22.419644,epoch time: 0:13:13.411657,used: 3:19:28.396687,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_05_22_53_seed_1_21504646
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9919486, 'precision': 0.98367095, 'recall': 0.96792936, 'specificity': 0.96792936, 'f1': 0.97563696, 'auroc': 0.996889, 'binary_precision': 0.9735958, 'binary_recall': 0.9384544, 'binary_specificity': 0.99740434, 'binary_f1_score': 0.9557021}
confusion matrix:
       0     1
0  42268   110
1    266  4056
---- Validation: 
scalar performance:
{'acc': 0.9665422, 'precision': 0.77865106, 'recall': 0.6142853, 'specificity': 0.6142853, 'f1': 0.65897006, 'auroc': 0.8442126, 'binary_precision': 0.58518517, 'binary_recall': 0.23476969, 'binary_specificity': 0.9938009, 'binary_f1_score': 0.33510074}
confusion matrix:
       0    1
0  17955  112
1    515  158
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89994055, 'precision': 0.8446462, 'recall': 0.59086716, 'specificity': 0.59086716, 'f1': 0.6250642, 'auroc': 0.8320123, 'binary_precision': 0.7860963, 'binary_recall': 0.18846154, 'binary_specificity': 0.9932728, 'binary_f1_score': 0.30403307}
confusion matrix:
      0    1
0  5906   40
1   633  147
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504646_17.png
early stop counter: 4
val acc:0.9665421843528748, best validation acc: 0.9668623208999634, corresponding to test acc:                         0.9026167392730713 / 0.9084150791168213
after epoch: 17,now: 2024-06-19 08:55:12.120203,epoch time: 0:12:49.700559,used: 3:32:18.097246,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_05_22_53_seed_1_21504646
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9924839, 'precision': 0.9864036, 'recall': 0.96843207, 'specificity': 0.96843207, 'f1': 0.9772062, 'auroc': 0.99728036, 'binary_precision': 0.9790109, 'binary_recall': 0.93891716, 'binary_specificity': 0.99794704, 'binary_f1_score': 0.95854497}
confusion matrix:
       0     1
0  42291    87
1    264  4058
---- Validation: 
scalar performance:
{'acc': 0.96691567, 'precision': 0.79397476, 'recall': 0.60160416, 'specificity': 0.60160416, 'f1': 0.647081, 'auroc': 0.83383256, 'binary_precision': 0.6167401, 'binary_recall': 0.20802377, 'binary_specificity': 0.9951846, 'binary_f1_score': 0.3111111}
confusion matrix:
       0    1
0  17980   87
1    533  140
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8950342, 'precision': 0.8550242, 'recall': 0.5596885, 'specificity': 0.5596885, 'f1': 0.57878566, 'auroc': 0.81449825, 'binary_precision': 0.8135593, 'binary_recall': 0.12307692, 'binary_specificity': 0.99630004, 'binary_f1_score': 0.21380846}
confusion matrix:
      0   1
0  5924  22
1   684  96
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504646_18.png
better model found
persisted
after epoch: 18,now: 2024-06-19 09:10:17.425491,epoch time: 0:15:05.305288,used: 3:47:23.402534,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_05_22_53_seed_1_21504646
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9928908, 'precision': 0.9876067, 'recall': 0.9696884, 'specificity': 0.9696884, 'f1': 0.97843766, 'auroc': 0.9970863, 'binary_precision': 0.98118216, 'binary_recall': 0.9412173, 'binary_specificity': 0.99815947, 'binary_f1_score': 0.96078426}
confusion matrix:
       0     1
0  42301    78
1    254  4067
---- Validation: 
scalar performance:
{'acc': 0.96584845, 'precision': 0.7675954, 'recall': 0.60534227, 'specificity': 0.60534227, 'f1': 0.64789677, 'auroc': 0.8479736, 'binary_precision': 0.5637066, 'binary_recall': 0.21693908, 'binary_specificity': 0.9937455, 'binary_f1_score': 0.31330472}
confusion matrix:
       0    1
0  17954  113
1    527  146
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89800775, 'precision': 0.8342861, 'recall': 0.5830908, 'specificity': 0.5830908, 'f1': 0.6137646, 'auroc': 0.8416976, 'binary_precision': 0.76704544, 'binary_recall': 0.17307693, 'binary_specificity': 0.99310464, 'binary_f1_score': 0.2824268}
confusion matrix:
      0    1
0  5905   41
1   645  135
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504646_19.png
early stop counter: 1
val acc:0.965848445892334, best validation acc: 0.9669156670570374, corresponding to test acc:                         0.8950341939926147 / 0.9084150791168213
after epoch: 19,now: 2024-06-19 09:23:16.108323,epoch time: 0:12:58.682832,used: 4:00:22.085366,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_05_22_53_seed_1_21504646
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99205565, 'precision': 0.9871679, 'recall': 0.9650716, 'specificity': 0.9650716, 'f1': 0.9757992, 'auroc': 0.99631864, 'binary_precision': 0.9812378, 'binary_recall': 0.93196017, 'binary_specificity': 0.9981831, 'binary_f1_score': 0.9559644}
confusion matrix:
       0     1
0  42302    77
1    294  4027
---- Validation: 
scalar performance:
{'acc': 0.9663287, 'precision': 0.7819036, 'recall': 0.59700817, 'specificity': 0.59700817, 'f1': 0.6404298, 'auroc': 0.83581346, 'binary_precision': 0.59292036, 'binary_recall': 0.19910847, 'binary_specificity': 0.99490786, 'binary_f1_score': 0.298109}
confusion matrix:
       0    1
0  17975   92
1    539  134
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89533156, 'precision': 0.834697, 'recall': 0.5665399, 'specificity': 0.5665399, 'f1': 0.5893032, 'auroc': 0.82606816, 'binary_precision': 0.7714286, 'binary_recall': 0.13846155, 'binary_specificity': 0.99461824, 'binary_f1_score': 0.23478262}
confusion matrix:
      0    1
0  5914   32
1   672  108
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504646_20.png
early stop counter: 2
val acc:0.9663286805152893, best validation acc: 0.9669156670570374, corresponding to test acc:                         0.8950341939926147 / 0.9084150791168213
after epoch: 20,now: 2024-06-19 09:43:24.010587,epoch time: 0:20:07.902264,used: 4:20:29.987630,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_05_22_53_seed_1_21504646
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99252677, 'precision': 0.98874915, 'recall': 0.9663931, 'specificity': 0.9663931, 'f1': 0.977244, 'auroc': 0.9972414, 'binary_precision': 0.98416567, 'binary_recall': 0.9343201, 'binary_specificity': 0.99846613, 'binary_f1_score': 0.95859534}
confusion matrix:
       0     1
0  42311    65
1    284  4040
---- Validation: 
scalar performance:
{'acc': 0.96691567, 'precision': 0.7999592, 'recall': 0.59373623, 'specificity': 0.59373623, 'f1': 0.6384554, 'auroc': 0.84232116, 'binary_precision': 0.6292683, 'binary_recall': 0.19167905, 'binary_specificity': 0.99579346, 'binary_f1_score': 0.29384965}
confusion matrix:
       0    1
0  17991   76
1    544  129
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8938448, 'precision': 0.8355018, 'recall': 0.557345, 'specificity': 0.557345, 'f1': 0.5748916, 'auroc': 0.8260057, 'binary_precision': 0.775, 'binary_recall': 0.11923077, 'binary_specificity': 0.99545914, 'binary_f1_score': 0.20666668}
confusion matrix:
      0   1
0  5919  27
1   687  93
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504646_21.png
early stop counter: 3
val acc:0.9669156670570374, best validation acc: 0.9669156670570374, corresponding to test acc:                         0.8950341939926147 / 0.9084150791168213
after epoch: 21,now: 2024-06-19 10:02:28.455459,epoch time: 0:19:04.444872,used: 4:39:34.432502,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_05_22_53_seed_1_21504646
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99203426, 'precision': 0.98715615, 'recall': 0.9649638, 'specificity': 0.9649638, 'f1': 0.97573656, 'auroc': 0.9976227, 'binary_precision': 0.9812378, 'binary_recall': 0.9317446, 'binary_specificity': 0.998183, 'binary_f1_score': 0.9558509}
confusion matrix:
       0     1
0  42301    77
1    295  4027
---- Validation: 
scalar performance:
{'acc': 0.9663821, 'precision': 0.783222, 'recall': 0.5970358, 'specificity': 0.5970358, 'f1': 0.6406097, 'auroc': 0.8385111, 'binary_precision': 0.59555554, 'binary_recall': 0.19910847, 'binary_specificity': 0.99496317, 'binary_f1_score': 0.29844096}
confusion matrix:
       0    1
0  17976   91
1    539  134
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8936961, 'precision': 0.8261267, 'recall': 0.55893165, 'specificity': 0.55893165, 'f1': 0.577346, 'auroc': 0.8141972, 'binary_precision': 0.7559055, 'binary_recall': 0.12307692, 'binary_specificity': 0.9947864, 'binary_f1_score': 0.21168688}
confusion matrix:
      0   1
0  5915  31
1   684  96
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504646_22.png
early stop counter: 4
val acc:0.9663820862770081, best validation acc: 0.9669156670570374, corresponding to test acc:                         0.8950341939926147 / 0.9084150791168213
after epoch: 22,now: 2024-06-19 10:21:25.852679,epoch time: 0:18:57.397220,used: 4:58:31.829722,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_05_22_53_seed_1_21504646
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99220556, 'precision': 0.9889716, 'recall': 0.9642352, 'specificity': 0.9642352, 'f1': 0.97620237, 'auroc': 0.9969908, 'binary_precision': 0.9850527, 'binary_recall': 0.92990977, 'binary_specificity': 0.99856055, 'binary_f1_score': 0.9566873}
confusion matrix:
       0     1
0  42316    61
1    303  4020
---- Validation: 
scalar performance:
{'acc': 0.9671291, 'precision': 0.80622375, 'recall': 0.5938469, 'specificity': 0.5938469, 'f1': 0.63918334, 'auroc': 0.8407348, 'binary_precision': 0.64179105, 'binary_recall': 0.19167905, 'binary_specificity': 0.99601483, 'binary_f1_score': 0.2951945}
confusion matrix:
       0    1
0  17995   72
1    544  129
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89295274, 'precision': 0.836305, 'recall': 0.551828, 'specificity': 0.551828, 'f1': 0.56594133, 'auroc': 0.8217282, 'binary_precision': 0.7777778, 'binary_recall': 0.10769231, 'binary_specificity': 0.9959637, 'binary_f1_score': 0.1891892}
confusion matrix:
      0   1
0  5922  24
1   696  84
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504646_23.png
better model found
persisted
after epoch: 23,now: 2024-06-19 10:39:52.993283,epoch time: 0:18:27.140604,used: 5:16:58.970326,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_05_22_53_seed_1_21504646
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9924197, 'precision': 0.98985827, 'recall': 0.9646647, 'specificity': 0.9646647, 'f1': 0.9768462, 'auroc': 0.9972296, 'binary_precision': 0.98675495, 'binary_recall': 0.93060374, 'binary_specificity': 0.9987257, 'binary_f1_score': 0.9578572}
confusion matrix:
       0     1
0  42323    54
1    300  4023
---- Validation: 
scalar performance:
{'acc': 0.9667556, 'precision': 0.8044121, 'recall': 0.58363944, 'specificity': 0.58363944, 'f1': 0.6263136, 'auroc': 0.837904, 'binary_precision': 0.6388889, 'binary_recall': 0.17087667, 'binary_specificity': 0.99640226, 'binary_f1_score': 0.26963657}
confusion matrix:
       0    1
0  18002   65
1    558  115
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8907226, 'precision': 0.8255372, 'recall': 0.54054177, 'specificity': 0.54054177, 'f1': 0.54692316, 'auroc': 0.8184174, 'binary_precision': 0.7586207, 'binary_recall': 0.08461539, 'binary_specificity': 0.9964682, 'binary_f1_score': 0.15224914}
confusion matrix:
      0   1
0  5925  21
1   714  66
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504646_24.png
early stop counter: 1
val acc:0.9667556285858154, best validation acc: 0.967129111289978, corresponding to test acc:                         0.8929527401924133 / 0.9084150791168213
after epoch: 24,now: 2024-06-19 10:56:09.355733,epoch time: 0:16:16.362450,used: 5:33:15.332776,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_05_22_53_seed_1_21504646
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99291223, 'precision': 0.98899364, 'recall': 0.9684745, 'specificity': 0.9684745, 'f1': 0.9784591, 'auroc': 0.99749565, 'binary_precision': 0.9842348, 'binary_recall': 0.9384829, 'binary_specificity': 0.99846613, 'binary_f1_score': 0.9608145}
confusion matrix:
       0     1
0  42311    65
1    266  4058
---- Validation: 
scalar performance:
{'acc': 0.9671291, 'precision': 0.8069109, 'recall': 0.59313166, 'specificity': 0.59313166, 'f1': 0.6383755, 'auroc': 0.8351319, 'binary_precision': 0.6432161, 'binary_recall': 0.19019316, 'binary_specificity': 0.9960702, 'binary_f1_score': 0.29357797}
confusion matrix:
       0    1
0  17996   71
1    545  128
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89220935, 'precision': 0.82570213, 'recall': 0.54973674, 'specificity': 0.54973674, 'f1': 0.562469, 'auroc': 0.80826396, 'binary_precision': 0.7570093, 'binary_recall': 0.103846155, 'binary_specificity': 0.9956273, 'binary_f1_score': 0.18263811}
confusion matrix:
      0   1
0  5920  26
1   699  81
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504646_25.png
early stop counter: 2
val acc:0.967129111289978, best validation acc: 0.967129111289978, corresponding to test acc:                         0.8929527401924133 / 0.9084150791168213
after epoch: 25,now: 2024-06-19 11:16:34.080375,epoch time: 0:20:24.724642,used: 5:53:40.057418,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_05_22_53_seed_1_21504646
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99237686, 'precision': 0.9887624, 'recall': 0.9654876, 'specificity': 0.9654876, 'f1': 0.97677016, 'auroc': 0.9968479, 'binary_precision': 0.9843788, 'binary_recall': 0.9324855, 'binary_specificity': 0.9984897, 'binary_f1_score': 0.9577297}
confusion matrix:
       0     1
0  42311    64
1    292  4033
---- Validation: 
scalar performance:
{'acc': 0.9669691, 'precision': 0.8041019, 'recall': 0.59090286, 'specificity': 0.59090286, 'f1': 0.63538975, 'auroc': 0.8540987, 'binary_precision': 0.6377551, 'binary_recall': 0.18573551, 'binary_specificity': 0.9960702, 'binary_f1_score': 0.287687}
confusion matrix:
       0    1
0  17996   71
1    548  125
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8931014, 'precision': 0.832559, 'recall': 0.55358285, 'specificity': 0.55358285, 'f1': 0.5687995, 'auroc': 0.8289791, 'binary_precision': 0.7699115, 'binary_recall': 0.11153846, 'binary_specificity': 0.9956273, 'binary_f1_score': 0.19484884}
confusion matrix:
      0   1
0  5920  26
1   693  87
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504646_26.png
early stop counter: 3
val acc:0.9669690728187561, best validation acc: 0.967129111289978, corresponding to test acc:                         0.8929527401924133 / 0.9084150791168213
after epoch: 26,now: 2024-06-19 11:38:33.904528,epoch time: 0:21:59.824153,used: 6:15:39.881571,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_05_22_53_seed_1_21504646
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99327624, 'precision': 0.98529, 'recall': 0.9743635, 'specificity': 0.9743635, 'f1': 0.9797487, 'auroc': 0.99744713, 'binary_precision': 0.97554606, 'binary_recall': 0.9511574, 'binary_specificity': 0.9975696, 'binary_f1_score': 0.9631974}
confusion matrix:
       0     1
0  42277   103
1    211  4109
---- Validation: 
scalar performance:
{'acc': 0.9667022, 'precision': 0.78291893, 'recall': 0.6122225, 'specificity': 0.6122225, 'f1': 0.6574157, 'auroc': 0.85193014, 'binary_precision': 0.59386975, 'binary_recall': 0.23031203, 'binary_specificity': 0.99413294, 'binary_f1_score': 0.33190575}
confusion matrix:
       0    1
0  17961  106
1    518  155
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89443946, 'precision': 0.81879914, 'recall': 0.56603533, 'specificity': 0.56603533, 'f1': 0.5882896, 'auroc': 0.8285018, 'binary_precision': 0.739726, 'binary_recall': 0.13846155, 'binary_specificity': 0.99360913, 'binary_f1_score': 0.23326136}
confusion matrix:
      0    1
0  5908   38
1   672  108
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504646_27.png
early stop counter: 4
val acc:0.9667022228240967, best validation acc: 0.967129111289978, corresponding to test acc:                         0.8929527401924133 / 0.9084150791168213
after epoch: 27,now: 2024-06-19 12:03:54.386582,epoch time: 0:25:20.482054,used: 6:41:00.363625,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_05_22_53_seed_1_21504646
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9928051, 'precision': 0.98579973, 'recall': 0.9710178, 'specificity': 0.9710178, 'f1': 0.97826564, 'auroc': 0.99760675, 'binary_precision': 0.97726727, 'binary_recall': 0.94427747, 'binary_specificity': 0.9977581, 'binary_f1_score': 0.96048915}
confusion matrix:
       0     1
0  42280    95
1    241  4084
---- Validation: 
scalar performance:
{'acc': 0.9657951, 'precision': 0.76694036, 'recall': 0.6038841, 'specificity': 0.6038841, 'f1': 0.64623684, 'auroc': 0.84794414, 'binary_precision': 0.5625, 'binary_recall': 0.21396731, 'binary_specificity': 0.9938009, 'binary_f1_score': 0.31001076}
confusion matrix:
       0    1
0  17955  112
1    529  144
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89414215, 'precision': 0.82355845, 'recall': 0.5625256, 'specificity': 0.5625256, 'f1': 0.58295554, 'auroc': 0.8191253, 'binary_precision': 0.75, 'binary_recall': 0.13076924, 'binary_specificity': 0.9942819, 'binary_f1_score': 0.22270742}
confusion matrix:
      0    1
0  5912   34
1   678  102
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504646_28.png
early stop counter: 5
val acc:0.96579509973526, best validation acc: 0.967129111289978, corresponding to test acc:                         0.8929527401924133 / 0.9084150791168213
after epoch: 28,now: 2024-06-19 12:21:03.941529,epoch time: 0:17:09.554947,used: 6:58:09.918572,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_05_22_53_seed_1_21504646
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99376875, 'precision': 0.99037325, 'recall': 0.97225046, 'specificity': 0.97225046, 'f1': 0.9810985, 'auroc': 0.99756384, 'binary_precision': 0.98624516, 'binary_recall': 0.94584584, 'binary_specificity': 0.998655, 'binary_f1_score': 0.96562314}
confusion matrix:
       0     1
0  42322    57
1    234  4087
---- Validation: 
scalar performance:
{'acc': 0.96627533, 'precision': 0.7870922, 'recall': 0.58625144, 'specificity': 0.58625144, 'f1': 0.62815005, 'auroc': 0.85199106, 'binary_precision': 0.6040609, 'binary_recall': 0.1768202, 'binary_specificity': 0.9956827, 'binary_f1_score': 0.2735632}
confusion matrix:
       0    1
0  17989   78
1    554  119
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89295274, 'precision': 0.8291742, 'recall': 0.5534988, 'specificity': 0.5534988, 'f1': 0.56864846, 'auroc': 0.8357887, 'binary_precision': 0.7631579, 'binary_recall': 0.11153846, 'binary_specificity': 0.99545914, 'binary_f1_score': 0.19463088}
confusion matrix:
      0   1
0  5919  27
1   693  87
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504646_29.png
early stop counter: 6
val acc:0.9662753343582153, best validation acc: 0.967129111289978, corresponding to test acc:                         0.8929527401924133 / 0.9084150791168213
after epoch: 29,now: 2024-06-19 12:37:35.457751,epoch time: 0:16:31.516222,used: 7:14:41.434794,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_05_22_53_seed_1_21504646
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9930621, 'precision': 0.99047196, 'recall': 0.96793413, 'specificity': 0.96793413, 'f1': 0.9788719, 'auroc': 0.9976646, 'binary_precision': 0.9873294, 'binary_recall': 0.9370953, 'binary_specificity': 0.9987729, 'binary_f1_score': 0.96155673}
confusion matrix:
       0     1
0  42324    52
1    272  4052
---- Validation: 
scalar performance:
{'acc': 0.9663821, 'precision': 0.7820574, 'recall': 0.59918165, 'specificity': 0.59918165, 'f1': 0.64293647, 'auroc': 0.851937, 'binary_precision': 0.5930736, 'binary_recall': 0.20356612, 'binary_specificity': 0.99479717, 'binary_f1_score': 0.30309734}
confusion matrix:
       0    1
0  17973   94
1    536  137
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8899792, 'precision': 0.7876291, 'recall': 0.54513377, 'specificity': 0.54513377, 'f1': 0.5548157, 'auroc': 0.83367294, 'binary_precision': 0.6818182, 'binary_recall': 0.09615385, 'binary_specificity': 0.9941137, 'binary_f1_score': 0.16853932}
confusion matrix:
      0   1
0  5911  35
1   705  75
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504646_30.png
early stop counter: 7
val acc:0.9663820862770081, best validation acc: 0.967129111289978, corresponding to test acc:                         0.8929527401924133 / 0.9084150791168213
after epoch: 30,now: 2024-06-19 13:03:26.342871,epoch time: 0:25:50.885120,used: 7:40:32.319914,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_05_22_53_seed_1_21504646
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 7:40:32.319914 at 2024-06-19 13:03:26.342871
persisted model performance metric: 

scalar performance:
{'acc': 0.89295274, 'precision': 0.836305, 'recall': 0.551828, 'specificity': 0.551828, 'f1': 0.56594133, 'auroc': 0.8217282, 'binary_precision': 0.7777778, 'binary_recall': 0.10769231, 'binary_specificity': 0.9959637, 'binary_f1_score': 0.1891892}
confusion matrix:
      0   1
0  5922  24
1   696  84
oracle model performance metric: 

scalar performance:
{'acc': 0.9084151, 'precision': 0.9015493, 'recall': 0.6173808, 'specificity': 0.6173808, 'f1': 0.66354793, 'auroc': 0.8078437, 'binary_precision': 0.8942308, 'binary_recall': 0.23846154, 'binary_specificity': 0.99630004, 'binary_f1_score': 0.37651822}
confusion matrix:
      0    1
0  5924   22
1   594  186
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4_classbalancing/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4_classbalancing/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204208 KiB |   1436 MiB |    835 TiB |    835 TiB |
|       from large pool | 167936 KiB |   1366 MiB |    835 TiB |    835 TiB |
|       from small pool |  36272 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 204208 KiB |   1436 MiB |    835 TiB |    835 TiB |
|       from large pool | 167936 KiB |   1366 MiB |    835 TiB |    835 TiB |
|       from small pool |  36272 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201110 KiB |   1428 MiB |    835 TiB |    835 TiB |
|       from large pool | 165120 KiB |   1358 MiB |    835 TiB |    835 TiB |
|       from small pool |  35990 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1466 MiB |   1524 MiB |   2478 MiB |   1012 MiB |
|       from large pool |   1392 MiB |   1450 MiB |   2374 MiB |    982 MiB |
|       from small pool |     74 MiB |     74 MiB |    104 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 320079 KiB | 628877 KiB | 653570 GiB | 653570 GiB |
|       from large pool | 311296 KiB | 627520 KiB | 653400 GiB | 653399 GiB |
|       from small pool |   8783 KiB |  16375 KiB |    170 GiB |    170 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1308    |    1965    |   28163 K  |   28162 K  |
|       from large pool |      36    |      76    |   11233 K  |   11233 K  |
|       from small pool |    1272    |    1894    |   16930 K  |   16929 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1308    |    1965    |   28163 K  |   28162 K  |
|       from large pool |      36    |      76    |   11233 K  |   11233 K  |
|       from small pool |    1272    |    1894    |   16930 K  |   16929 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      49    |      50    |      68    |      19    |
|       from large pool |      12    |      13    |      16    |       4    |
|       from small pool |      37    |      37    |      52    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      36    |     482    |   15324 K  |   15324 K  |
|       from large pool |       5    |      11    |    4363 K  |    4363 K  |
|       from small pool |      31    |     477    |   10960 K  |   10960 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1436 MiB |    835 TiB |    835 TiB |
|       from large pool |  16640 KiB |   1366 MiB |    835 TiB |    835 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1436 MiB |    835 TiB |    835 TiB |
|       from large pool |  16640 KiB |   1366 MiB |    835 TiB |    835 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1428 MiB |    835 TiB |    835 TiB |
|       from large pool |  16640 KiB |   1358 MiB |    835 TiB |    835 TiB |
|       from small pool |      0 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 524288 KiB |   1524 MiB |   2478 MiB |   1966 MiB |
|       from large pool | 479232 KiB |   1450 MiB |   2374 MiB |   1906 MiB |
|       from small pool |  45056 KiB |     74 MiB |    104 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 298752 KiB | 628877 KiB | 653570 GiB | 653570 GiB |
|       from large pool | 298752 KiB | 627520 KiB | 653400 GiB | 653399 GiB |
|       from small pool |      0 KiB |  16378 KiB |    170 GiB |    170 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1965    |   28163 K  |   28163 K  |
|       from large pool |       2    |      76    |   11233 K  |   11233 K  |
|       from small pool |       0    |    1894    |   16930 K  |   16930 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1965    |   28163 K  |   28163 K  |
|       from large pool |       2    |      76    |   11233 K  |   11233 K  |
|       from small pool |       0    |    1894    |   16930 K  |   16930 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      50    |      68    |      37    |
|       from large pool |       9    |      13    |      16    |       7    |
|       from small pool |      22    |      37    |      52    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     482    |   15324 K  |   15324 K  |
|       from large pool |       1    |      11    |    4363 K  |    4363 K  |
|       from small pool |       0    |     477    |   10960 K  |   10960 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1436 MiB |    835 TiB |    835 TiB |
|       from large pool |  16640 KiB |   1366 MiB |    835 TiB |    835 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1436 MiB |    835 TiB |    835 TiB |
|       from large pool |  16640 KiB |   1366 MiB |    835 TiB |    835 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1428 MiB |    835 TiB |    835 TiB |
|       from large pool |  16640 KiB |   1358 MiB |    835 TiB |    835 TiB |
|       from small pool |      0 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 524288 KiB |   1524 MiB |   2478 MiB |   1966 MiB |
|       from large pool | 479232 KiB |   1450 MiB |   2374 MiB |   1906 MiB |
|       from small pool |  45056 KiB |     74 MiB |    104 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 298752 KiB | 628877 KiB | 653570 GiB | 653570 GiB |
|       from large pool | 298752 KiB | 627520 KiB | 653400 GiB | 653399 GiB |
|       from small pool |      0 KiB |  16378 KiB |    170 GiB |    170 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1965    |   28163 K  |   28163 K  |
|       from large pool |       2    |      76    |   11233 K  |   11233 K  |
|       from small pool |       0    |    1894    |   16930 K  |   16930 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1965    |   28163 K  |   28163 K  |
|       from large pool |       2    |      76    |   11233 K  |   11233 K  |
|       from small pool |       0    |    1894    |   16930 K  |   16930 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      50    |      68    |      37    |
|       from large pool |       9    |      13    |      16    |       7    |
|       from small pool |      22    |      37    |      52    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     482    |   15324 K  |   15324 K  |
|       from large pool |       1    |      11    |    4363 K  |    4363 K  |
|       from small pool |       0    |     477    |   10960 K  |   10960 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0




!!!: not committed yet



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_13_10_55_seed_2_21504646

 Experiment start at: 2024-06-19 13:10:55.485002
before training, model accuracy: 0.12167187035083771
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.95166665, 'precision': 0.9706807, 'recall': 0.75247645, 'specificity': 0.75247645, 'f1': 0.82175714, 'auroc': 0.95323396, 'binary_precision': 0.99177843, 'binary_recall': 0.50540245, 'binary_specificity': 0.99955046, 'binary_f1_score': 0.669588}
confusion matrix:
       0     1
0  42246    19
1   2243  2292
---- Validation: 
scalar performance:
{'acc': 0.9676663, 'precision': 0.637908, 'recall': 0.5030746, 'specificity': 0.5030746, 'f1': 0.49828604, 'auroc': 0.5863664, 'binary_precision': 0.30769232, 'binary_recall': 0.006644518, 'binary_specificity': 0.9995047, 'binary_f1_score': 0.013008131}
confusion matrix:
       0  1
0  18162  9
1    598  4
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8915663, 'precision': 0.44598213, 'recall': 0.49974987, 'specificity': 0.49974987, 'f1': 0.4713376, 'auroc': 0.625894, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5994  3
1   726  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504646_1.png
