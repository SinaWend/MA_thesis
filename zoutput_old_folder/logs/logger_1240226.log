Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0




!!!: not committed yet



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_16_seed_0_21327285

 Experiment start at: 2024-06-15 22:21:16.148339
before training, model accuracy: 0.3103227913379669
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9663927, 'precision': 0.48319635, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49145457, 'auroc': 0.4846235, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42328  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.41073096, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.42878658, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327285_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-15 22:37:42.238261,epoch time: 0:16:26.089922,used: 0:16:26.089922,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_16_seed_0_21327285
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9663927, 'precision': 0.48319635, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49145457, 'auroc': 0.5000114, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42328  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.41447505, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.41326138, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327285_2.png
early stop counter: 1
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 2,now: 2024-06-15 22:53:07.465586,epoch time: 0:15:25.227325,used: 0:31:51.317247,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_16_seed_0_21327285
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9664155, 'precision': 0.48320776, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49146047, 'auroc': 0.5114291, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42329  0
1   1471  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.43637824, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.44520998, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327285_3.png
early stop counter: 2
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 3,now: 2024-06-15 23:08:30.784041,epoch time: 0:15:23.318455,used: 0:47:14.635702,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_16_seed_0_21327285
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9663927, 'precision': 0.48319635, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49145457, 'auroc': 0.5432612, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42328  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.47043908, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.49510896, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327285_4.png
early stop counter: 3
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 4,now: 2024-06-15 23:23:41.848551,epoch time: 0:15:11.064510,used: 1:02:25.700212,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_16_seed_0_21327285
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9664155, 'precision': 0.48320776, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49146047, 'auroc': 0.58347684, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42329  0
1   1471  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.50731194, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.5043925, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327285_5.png
early stop counter: 4
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 5,now: 2024-06-15 23:38:51.462857,epoch time: 0:15:09.614306,used: 1:17:35.314518,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_16_seed_0_21327285
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9663927, 'precision': 0.48319635, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49145457, 'auroc': 0.64670444, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42328  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.58909214, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.575106, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327285_6.png
early stop counter: 5
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 6,now: 2024-06-15 23:54:00.851952,epoch time: 0:15:09.389095,used: 1:32:44.703613,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_16_seed_0_21327285
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9663927, 'precision': 0.48319635, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49145457, 'auroc': 0.67966104, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42328  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.61779904, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.6320025, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327285_7.png
early stop counter: 6
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 7,now: 2024-06-16 00:09:23.666380,epoch time: 0:15:22.814428,used: 1:48:07.518041,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_16_seed_0_21327285
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9663927, 'precision': 0.48319635, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49145457, 'auroc': 0.72344196, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42328  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.6727518, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.70023423, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327285_8.png
early stop counter: 7
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 8,now: 2024-06-16 00:24:36.780082,epoch time: 0:15:13.113702,used: 2:03:20.631743,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_16_seed_0_21327285
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9663927, 'precision': 0.48319635, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49145457, 'auroc': 0.7527549, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42328  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.70047903, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.72365046, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327285_9.png
early stop counter: 8
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 9,now: 2024-06-16 00:40:00.800534,epoch time: 0:15:24.020452,used: 2:18:44.652195,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_16_seed_0_21327285
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9663927, 'precision': 0.48319635, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49145457, 'auroc': 0.7755728, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42328  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.740493, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.7517707, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327285_10.png
early stop counter: 9
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 10,now: 2024-06-16 00:55:23.648573,epoch time: 0:15:22.848039,used: 2:34:07.500234,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_16_seed_0_21327285
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9663927, 'precision': 0.48319635, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49145457, 'auroc': 0.8159243, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42328  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.78995883, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.79170203, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327285_11.png
early stop counter: 10
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 11,now: 2024-06-16 01:10:40.830345,epoch time: 0:15:17.181772,used: 2:49:24.682006,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_16_seed_0_21327285
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.96643835, 'precision': 0.48321918, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4914664, 'auroc': 0.8242345, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42330  0
1   1470  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.8020613, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.80648565, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327285_12.png
early stop counter: 11
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 12,now: 2024-06-16 01:25:49.887799,epoch time: 0:15:09.057454,used: 3:04:33.739460,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_16_seed_0_21327285
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9663927, 'precision': 0.48320737, 'recall': 0.4999882, 'specificity': 0.4999882, 'f1': 0.4914546, 'auroc': 0.83630955, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42328  1
1   1471  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.81793314, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.8224123, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327285_13.png
early stop counter: 12
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 13,now: 2024-06-16 01:41:03.394803,epoch time: 0:15:13.507004,used: 3:19:47.246464,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_16_seed_0_21327285
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9664155, 'precision': 0.7832287, 'recall': 0.5009954, 'specificity': 0.5009954, 'f1': 0.49349102, 'auroc': 0.852128, 'binary_precision': 0.6, 'binary_recall': 0.0020380435, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.004062288}
confusion matrix:
       0  1
0  42326  2
1   1469  3
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.8402609, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.83966506, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327285_14.png
early stop counter: 13
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 14,now: 2024-06-16 01:56:13.173172,epoch time: 0:15:09.778369,used: 3:34:57.024833,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_16_seed_0_21327285
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.96634704, 'precision': 0.67556757, 'recall': 0.50160503, 'specificity': 0.50160503, 'f1': 0.49481106, 'auroc': 0.86446726, 'binary_precision': 0.3846154, 'binary_recall': 0.0033990482, 'binary_specificity': 0.999811, 'binary_f1_score': 0.0067385444}
confusion matrix:
       0  1
0  42321  8
1   1466  5
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.8470565, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.8406229, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327285_15.png
early stop counter: 14
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 15,now: 2024-06-16 02:11:27.756699,epoch time: 0:15:14.583527,used: 3:50:11.608360,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_16_seed_0_21327285
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9664155, 'precision': 0.74646115, 'recall': 0.5032904, 'specificity': 0.5032904, 'f1': 0.49816537, 'auroc': 0.86613226, 'binary_precision': 0.5263158, 'binary_recall': 0.006793478, 'binary_specificity': 0.9997874, 'binary_f1_score': 0.013413815}
confusion matrix:
       0   1
0  42319   9
1   1462  10
---- Validation: 
scalar performance:
{'acc': 0.9657301, 'precision': 0.48289075, 'recall': 0.49997246, 'specificity': 0.49997246, 'f1': 0.4912832, 'auroc': 0.8560509, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9999449, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18148  1
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.8511582, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327285_16.png
early stop counter: 15
val acc:0.9657300710678101, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 16,now: 2024-06-16 02:26:44.036982,epoch time: 0:15:16.280283,used: 4:05:27.888643,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_16_seed_0_21327285
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9668265, 'precision': 0.8086305, 'recall': 0.51300824, 'specificity': 0.51300824, 'f1': 0.5170326, 'auroc': 0.880037, 'binary_precision': 0.65, 'binary_recall': 0.026512576, 'binary_specificity': 0.9995039, 'binary_f1_score': 0.050947096}
confusion matrix:
       0   1
0  42308  21
1   1432  39
---- Validation: 
scalar performance:
{'acc': 0.9657301, 'precision': 0.6495822, 'recall': 0.5007225, 'specificity': 0.5007225, 'f1': 0.4928307, 'auroc': 0.86583394, 'binary_precision': 0.33333334, 'binary_recall': 0.00155521, 'binary_specificity': 0.9998898, 'binary_f1_score': 0.0030959754}
confusion matrix:
       0  1
0  18147  2
1    642  1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.86002326, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327285_17.png
early stop counter: 16
val acc:0.9657300710678101, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 17,now: 2024-06-16 02:42:05.479689,epoch time: 0:15:21.442707,used: 4:20:49.331350,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_16_seed_0_21327285
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.966484, 'precision': 0.75020576, 'recall': 0.5105388, 'specificity': 0.5105388, 'f1': 0.51235956, 'auroc': 0.8813243, 'binary_precision': 0.53333336, 'binary_recall': 0.02173913, 'binary_specificity': 0.9993385, 'binary_f1_score': 0.041775458}
confusion matrix:
       0   1
0  42300  28
1   1440  32
---- Validation: 
scalar performance:
{'acc': 0.9656237, 'precision': 0.48288894, 'recall': 0.49991736, 'specificity': 0.49991736, 'f1': 0.4912556, 'auroc': 0.8685682, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998347, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18146  3
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.97922325, 'recall': 0.5019157, 'specificity': 0.5019157, 'f1': 0.49320802, 'auroc': 0.85738033, 'binary_precision': 1.0, 'binary_recall': 0.0038314175, 'binary_specificity': 1.0, 'binary_f1_score': 0.007633588}
confusion matrix:
      0  1
0  5997  0
1   260  1
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327285_18.png
new oracle model saved
early stop counter: 17
val acc:0.965623676776886, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9584531784057617
after epoch: 18,now: 2024-06-16 02:57:20.096209,epoch time: 0:15:14.616520,used: 4:36:03.947870,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_16_seed_0_21327285
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9659589, 'precision': 0.6913504, 'recall': 0.5158403, 'specificity': 0.5158403, 'f1': 0.52216953, 'auroc': 0.8867151, 'binary_precision': 0.41525424, 'binary_recall': 0.033310674, 'binary_specificity': 0.99836993, 'binary_f1_score': 0.06167401}
confusion matrix:
       0   1
0  42260  69
1   1422  49
---- Validation: 
scalar performance:
{'acc': 0.9656237, 'precision': 0.64963, 'recall': 0.5021675, 'specificity': 0.5021675, 'f1': 0.49585545, 'auroc': 0.8776976, 'binary_precision': 0.33333334, 'binary_recall': 0.00466563, 'binary_specificity': 0.99966943, 'binary_f1_score': 0.009202453}
confusion matrix:
       0  1
0  18143  6
1    640  3
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590924, 'precision': 0.97952986, 'recall': 0.5095785, 'specificity': 0.5095785, 'f1': 0.508348, 'auroc': 0.8635365, 'binary_precision': 1.0, 'binary_recall': 0.019157087, 'binary_specificity': 1.0, 'binary_f1_score': 0.037593983}
confusion matrix:
      0  1
0  5997  0
1   256  5
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327285_19.png
new oracle model saved
early stop counter: 18
val acc:0.965623676776886, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.959092378616333
after epoch: 19,now: 2024-06-16 03:12:38.855590,epoch time: 0:15:18.759381,used: 4:51:22.707251,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_16_seed_0_21327285
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.966621, 'precision': 0.75262594, 'recall': 0.52372414, 'specificity': 0.52372414, 'f1': 0.5363313, 'auroc': 0.8889675, 'binary_precision': 0.53731346, 'binary_recall': 0.048913043, 'binary_specificity': 0.9985353, 'binary_f1_score': 0.08966376}
confusion matrix:
       0   1
0  42266  62
1   1400  72
---- Validation: 
scalar performance:
{'acc': 0.96557045, 'precision': 0.6329624, 'recall': 0.50214, 'specificity': 0.50214, 'f1': 0.49583462, 'auroc': 0.88072073, 'binary_precision': 0.3, 'binary_recall': 0.00466563, 'binary_specificity': 0.9996143, 'binary_f1_score': 0.009188361}
confusion matrix:
       0  1
0  18142  7
1    640  3
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590924, 'precision': 0.97952986, 'recall': 0.5095785, 'specificity': 0.5095785, 'f1': 0.508348, 'auroc': 0.8658806, 'binary_precision': 1.0, 'binary_recall': 0.019157087, 'binary_specificity': 1.0, 'binary_f1_score': 0.037593983}
confusion matrix:
      0  1
0  5997  0
1   256  5
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327285_20.png
early stop counter: 19
val acc:0.9655704498291016, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.959092378616333
after epoch: 20,now: 2024-06-16 03:27:50.490400,epoch time: 0:15:11.634810,used: 5:06:34.342061,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_16_seed_0_21327285
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9668265, 'precision': 0.7619544, 'recall': 0.529741, 'specificity': 0.529741, 'f1': 0.5466624, 'auroc': 0.89399654, 'binary_precision': 0.5555556, 'binary_recall': 0.061182868, 'binary_specificity': 0.99829906, 'binary_f1_score': 0.11022658}
confusion matrix:
       0   1
0  42257  72
1   1381  90
---- Validation: 
scalar performance:
{'acc': 0.9655172, 'precision': 0.6496778, 'recall': 0.5036125, 'specificity': 0.5036125, 'f1': 0.49882448, 'auroc': 0.88360155, 'binary_precision': 0.33333334, 'binary_recall': 0.00777605, 'binary_specificity': 0.999449, 'binary_f1_score': 0.015197569}
confusion matrix:
       0   1
0  18139  10
1    638   5
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959412, 'precision': 0.9796833, 'recall': 0.51341, 'specificity': 0.51341, 'f1': 0.51575035, 'auroc': 0.8683173, 'binary_precision': 1.0, 'binary_recall': 0.026819924, 'binary_specificity': 1.0, 'binary_f1_score': 0.052238807}
confusion matrix:
      0  1
0  5997  0
1   254  7
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327285_21.png
new oracle model saved
early stop counter: 20
val acc:0.9655172228813171, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9594119787216187
after epoch: 21,now: 2024-06-16 03:43:17.964939,epoch time: 0:15:27.474539,used: 5:22:01.816600,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_16_seed_0_21327285
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 21 with time: 5:22:01.816600 at 2024-06-16 03:43:17.964939
persisted model performance metric: 

scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.42878658, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
oracle model performance metric: 

scalar performance:
{'acc': 0.959412, 'precision': 0.9796833, 'recall': 0.51341, 'specificity': 0.51341, 'f1': 0.51575035, 'auroc': 0.8683173, 'binary_precision': 1.0, 'binary_recall': 0.026819924, 'binary_specificity': 1.0, 'binary_f1_score': 0.052238807}
confusion matrix:
      0  1
0  5997  0
1   254  7
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_bs16_different_batchsizes/rule_results/1.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_bs16_different_batchsizes/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_resnet_bs16_different_batchsizes/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204178 KiB |   1436 MiB | 284107 GiB | 284107 GiB |
|       from large pool | 167936 KiB |   1366 MiB | 284055 GiB | 284055 GiB |
|       from small pool |  36242 KiB |     72 MiB |     52 GiB |     51 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 204178 KiB |   1436 MiB | 284107 GiB | 284107 GiB |
|       from large pool | 167936 KiB |   1366 MiB | 284055 GiB | 284055 GiB |
|       from small pool |  36242 KiB |     72 MiB |     52 GiB |     51 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201088 KiB |   1428 MiB | 284091 GiB | 284091 GiB |
|       from large pool | 165120 KiB |   1358 MiB | 284041 GiB | 284041 GiB |
|       from small pool |  35968 KiB |     71 MiB |     50 GiB |     50 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1524 MiB |   1524 MiB |   1524 MiB |      0 B   |
|       from large pool |   1450 MiB |   1450 MiB |   1450 MiB |      0 B   |
|       from small pool |     74 MiB |     74 MiB |     74 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 320109 KiB | 749313 KiB | 212041 GiB | 212040 GiB |
|       from large pool | 311296 KiB | 748328 KiB | 211983 GiB | 211983 GiB |
|       from small pool |   8813 KiB |  12610 KiB |     57 GiB |     57 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1278    |    1935    |    9363 K  |    9362 K  |
|       from large pool |      36    |      76    |    3727 K  |    3726 K  |
|       from small pool |    1242    |    1864    |    5636 K  |    5635 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1278    |    1935    |    9363 K  |    9362 K  |
|       from large pool |      36    |      76    |    3727 K  |    3726 K  |
|       from small pool |    1242    |    1864    |    5636 K  |    5635 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      50    |      50    |      50    |       0    |
|       from large pool |      13    |      13    |      13    |       0    |
|       from small pool |      37    |      37    |      37    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      35    |     452    |    4943 K  |    4943 K  |
|       from large pool |       5    |      10    |    1384 K  |    1384 K  |
|       from small pool |      30    |     447    |    3559 K  |    3558 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1436 MiB | 284107 GiB | 284107 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 284055 GiB | 284055 GiB |
|       from small pool |      0 KiB |     72 MiB |     52 GiB |     52 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1436 MiB | 284107 GiB | 284107 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 284055 GiB | 284055 GiB |
|       from small pool |      0 KiB |     72 MiB |     52 GiB |     52 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1428 MiB | 284091 GiB | 284091 GiB |
|       from large pool |  16640 KiB |   1358 MiB | 284041 GiB | 284041 GiB |
|       from small pool |      0 KiB |     71 MiB |     50 GiB |     50 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 524288 KiB |   1524 MiB |   1524 MiB |   1012 MiB |
|       from large pool | 479232 KiB |   1450 MiB |   1450 MiB |    982 MiB |
|       from small pool |  45056 KiB |     74 MiB |     74 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 298752 KiB | 749313 KiB | 212041 GiB | 212040 GiB |
|       from large pool | 298752 KiB | 748328 KiB | 211983 GiB | 211983 GiB |
|       from small pool |      0 KiB |  16408 KiB |     57 GiB |     57 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1935    |    9363 K  |    9363 K  |
|       from large pool |       2    |      76    |    3727 K  |    3727 K  |
|       from small pool |       0    |    1864    |    5636 K  |    5636 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1935    |    9363 K  |    9363 K  |
|       from large pool |       2    |      76    |    3727 K  |    3727 K  |
|       from small pool |       0    |    1864    |    5636 K  |    5636 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      50    |      50    |      19    |
|       from large pool |       9    |      13    |      13    |       4    |
|       from small pool |      22    |      37    |      37    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     452    |    4944 K  |    4944 K  |
|       from large pool |       1    |      11    |    1384 K  |    1384 K  |
|       from small pool |       0    |     447    |    3559 K  |    3559 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1436 MiB | 284107 GiB | 284107 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 284055 GiB | 284055 GiB |
|       from small pool |      0 KiB |     72 MiB |     52 GiB |     52 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1436 MiB | 284107 GiB | 284107 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 284055 GiB | 284055 GiB |
|       from small pool |      0 KiB |     72 MiB |     52 GiB |     52 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1428 MiB | 284091 GiB | 284091 GiB |
|       from large pool |  16640 KiB |   1358 MiB | 284041 GiB | 284041 GiB |
|       from small pool |      0 KiB |     71 MiB |     50 GiB |     50 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 524288 KiB |   1524 MiB |   1524 MiB |   1012 MiB |
|       from large pool | 479232 KiB |   1450 MiB |   1450 MiB |    982 MiB |
|       from small pool |  45056 KiB |     74 MiB |     74 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 298752 KiB | 749313 KiB | 212041 GiB | 212040 GiB |
|       from large pool | 298752 KiB | 748328 KiB | 211983 GiB | 211983 GiB |
|       from small pool |      0 KiB |  16408 KiB |     57 GiB |     57 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1935    |    9363 K  |    9363 K  |
|       from large pool |       2    |      76    |    3727 K  |    3727 K  |
|       from small pool |       0    |    1864    |    5636 K  |    5636 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1935    |    9363 K  |    9363 K  |
|       from large pool |       2    |      76    |    3727 K  |    3727 K  |
|       from small pool |       0    |    1864    |    5636 K  |    5636 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      50    |      50    |      19    |
|       from large pool |       9    |      13    |      13    |       4    |
|       from small pool |      22    |      37    |      37    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     452    |    4944 K  |    4944 K  |
|       from large pool |       1    |      11    |    1384 K  |    1384 K  |
|       from small pool |       0    |     447    |    3559 K  |    3559 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0




!!!: not committed yet



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_50_16_seed_1_21327285

 Experiment start at: 2024-06-16 03:50:16.845779
before training, model accuracy: 0.14631003141403198
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9665525, 'precision': 0.48355225, 'recall': 0.4997049, 'specificity': 0.4997049, 'f1': 0.49149588, 'auroc': 0.44150963, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9994098, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  42335  25
1   1440   0
---- Validation: 
scalar performance:
{'acc': 0.96237993, 'precision': 0.48201305, 'recall': 0.4991144, 'specificity': 0.4991144, 'f1': 0.49041468, 'auroc': 0.37726027, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9982288, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18035  32
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.32283825, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327285_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-16 04:05:47.339598,epoch time: 0:15:30.493819,used: 0:15:30.493819,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_50_16_seed_1_21327285
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96710044, 'precision': 0.48355022, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49163756, 'auroc': 0.45035625, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42359  0
1   1441  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.39087045, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.33266935, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327285_2.png
better model found
persisted
after epoch: 2,now: 2024-06-16 04:21:17.147856,epoch time: 0:15:29.808258,used: 0:31:00.302077,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_50_16_seed_1_21327285
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96712327, 'precision': 0.48356164, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49164346, 'auroc': 0.47960478, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42360  0
1   1440  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.4040152, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.3820262, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327285_3.png
early stop counter: 1
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 3,now: 2024-06-16 04:37:02.245203,epoch time: 0:15:45.097347,used: 0:46:45.399424,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_50_16_seed_1_21327285
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9670776, 'precision': 0.4835388, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49163166, 'auroc': 0.5230469, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42358  0
1   1442  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.44281048, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.41527513, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327285_4.png
early stop counter: 2
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 4,now: 2024-06-16 04:52:31.730945,epoch time: 0:15:29.485742,used: 1:02:14.885166,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_50_16_seed_1_21327285
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9670776, 'precision': 0.4835388, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49163166, 'auroc': 0.535927, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42358  0
1   1442  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.48439413, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.4225014, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327285_5.png
early stop counter: 3
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 5,now: 2024-06-16 05:08:02.957574,epoch time: 0:15:31.226629,used: 1:17:46.111795,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_50_16_seed_1_21327285
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9670776, 'precision': 0.4835388, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49163166, 'auroc': 0.5889809, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42358  0
1   1442  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.5154924, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.5059814, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327285_6.png
early stop counter: 4
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 6,now: 2024-06-16 05:23:39.192950,epoch time: 0:15:36.235376,used: 1:33:22.347171,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_50_16_seed_1_21327285
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9671461, 'precision': 0.48357305, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49164933, 'auroc': 0.64615095, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42361  0
1   1439  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.55510086, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.56697655, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327285_7.png
early stop counter: 5
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 7,now: 2024-06-16 05:39:10.942298,epoch time: 0:15:31.749348,used: 1:48:54.096519,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_50_16_seed_1_21327285
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.96710044, 'precision': 0.48355022, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49163756, 'auroc': 0.6749462, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42359  0
1   1441  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.6183778, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.63052505, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327285_8.png
early stop counter: 6
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 8,now: 2024-06-16 05:54:42.070711,epoch time: 0:15:31.128413,used: 2:04:25.224932,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_50_16_seed_1_21327285
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9671461, 'precision': 0.48357305, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49164933, 'auroc': 0.7111906, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42361  0
1   1439  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.6619686, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.6703477, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327285_9.png
early stop counter: 7
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 9,now: 2024-06-16 06:11:01.071035,epoch time: 0:16:19.000324,used: 2:20:44.225256,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_50_16_seed_1_21327285
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.96719176, 'precision': 0.48359588, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49166116, 'auroc': 0.7473428, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42363  0
1   1437  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.70026636, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.7187573, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327285_10.png
early stop counter: 8
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 10,now: 2024-06-16 06:26:28.055179,epoch time: 0:15:26.984144,used: 2:36:11.209400,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_50_16_seed_1_21327285
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96712327, 'precision': 0.48356164, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49164346, 'auroc': 0.7902175, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42360  0
1   1440  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.7470441, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.7619723, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327285_11.png
early stop counter: 9
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 11,now: 2024-06-16 06:41:56.681699,epoch time: 0:15:28.626520,used: 2:51:39.835920,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_50_16_seed_1_21327285
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9671461, 'precision': 0.48357305, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49164933, 'auroc': 0.80145925, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42361  0
1   1439  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.7637287, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.76927084, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327285_12.png
early stop counter: 10
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 12,now: 2024-06-16 06:57:47.210886,epoch time: 0:15:50.529187,used: 3:07:30.365107,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_50_16_seed_1_21327285
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9671461, 'precision': 0.9835727, 'recall': 0.5003472, 'specificity': 0.5003472, 'f1': 0.49234313, 'auroc': 0.82536983, 'binary_precision': 1.0, 'binary_recall': 0.00069444446, 'binary_specificity': 1.0, 'binary_f1_score': 0.0013879251}
confusion matrix:
       0  1
0  42360  0
1   1439  1
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.7903967, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.7933975, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327285_13.png
early stop counter: 11
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 13,now: 2024-06-16 07:13:39.882589,epoch time: 0:15:52.671703,used: 3:23:23.036810,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_50_16_seed_1_21327285
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9671461, 'precision': 0.858583, 'recall': 0.50102913, 'specificity': 0.50102913, 'f1': 0.49372488, 'auroc': 0.83686435, 'binary_precision': 0.75, 'binary_recall': 0.0020818876, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.004152249}
confusion matrix:
       0  1
0  42358  1
1   1438  3
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.80520403, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.80758166, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327285_14.png
early stop counter: 12
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 14,now: 2024-06-16 07:29:21.721267,epoch time: 0:15:41.838678,used: 3:39:04.875488,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_50_16_seed_1_21327285
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9670091, 'precision': 0.65025806, 'recall': 0.5012935, 'specificity': 0.5012935, 'f1': 0.4943661, 'auroc': 0.84375095, 'binary_precision': 0.33333334, 'binary_recall': 0.00277585, 'binary_specificity': 0.9998111, 'binary_f1_score': 0.0055058496}
confusion matrix:
       0  1
0  42351  8
1   1437  4
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.8221942, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.8166356, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327285_15.png
early stop counter: 13
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 15,now: 2024-06-16 07:44:53.606922,epoch time: 0:15:31.885655,used: 3:54:36.761143,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_50_16_seed_1_21327285
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9672146, 'precision': 0.7694166, 'recall': 0.50406337, 'specificity': 0.50406337, 'f1': 0.49988392, 'auroc': 0.86183023, 'binary_precision': 0.5714286, 'binary_recall': 0.008339125, 'binary_specificity': 0.99978757, 'binary_f1_score': 0.016438358}
confusion matrix:
       0   1
0  42352   9
1   1427  12
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.8355027, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.8322356, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327285_16.png
early stop counter: 14
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 16,now: 2024-06-16 08:00:00.786653,epoch time: 0:15:07.179731,used: 4:09:43.940874,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_50_16_seed_1_21327285
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.96719176, 'precision': 0.7670665, 'recall': 0.50574523, 'specificity': 0.50574523, 'f1': 0.50321466, 'auroc': 0.8631561, 'binary_precision': 0.56666666, 'binary_recall': 0.011797363, 'binary_specificity': 0.9996931, 'binary_f1_score': 0.023113528}
confusion matrix:
       0   1
0  42346  13
1   1424  17
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.8410326, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.8317487, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327285_17.png
early stop counter: 15
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 17,now: 2024-06-16 08:15:08.811513,epoch time: 0:15:08.024860,used: 4:24:51.965734,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_50_16_seed_1_21327285
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9670091, 'precision': 0.709942, 'recall': 0.50632113, 'specificity': 0.50632113, 'f1': 0.50442207, 'auroc': 0.8725966, 'binary_precision': 0.45238096, 'binary_recall': 0.013185288, 'binary_specificity': 0.999457, 'binary_f1_score': 0.025623735}
confusion matrix:
       0   1
0  42336  23
1   1422  19
---- Validation: 
scalar performance:
{'acc': 0.9639808, 'precision': 0.60706663, 'recall': 0.5006599, 'specificity': 0.5006599, 'f1': 0.49230665, 'auroc': 0.8552067, 'binary_precision': 0.25, 'binary_recall': 0.0014858841, 'binary_specificity': 0.99983394, 'binary_f1_score': 0.0029542097}
confusion matrix:
       0  1
0  18064  3
1    672  1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.8392401, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327285_18.png
early stop counter: 16
val acc:0.9639807939529419, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 18,now: 2024-06-16 08:30:19.988974,epoch time: 0:15:11.177461,used: 4:40:03.143195,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_50_16_seed_1_21327285
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9672603, 'precision': 0.7542615, 'recall': 0.5134876, 'specificity': 0.5134876, 'f1': 0.5180912, 'auroc': 0.87913156, 'binary_precision': 0.5405405, 'binary_recall': 0.027777778, 'binary_specificity': 0.99919736, 'binary_f1_score': 0.05284016}
confusion matrix:
       0   1
0  42326  34
1   1400  40
---- Validation: 
scalar performance:
{'acc': 0.96403414, 'precision': 0.68209237, 'recall': 0.50140285, 'specificity': 0.50140285, 'f1': 0.49379277, 'auroc': 0.86486006, 'binary_precision': 0.4, 'binary_recall': 0.0029717681, 'binary_specificity': 0.99983394, 'binary_f1_score': 0.005899705}
confusion matrix:
       0  1
0  18064  3
1    671  2
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.84484947, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327285_19.png
early stop counter: 17
val acc:0.9640341401100159, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 19,now: 2024-06-16 08:45:32.266086,epoch time: 0:15:12.277112,used: 4:55:15.420307,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_50_16_seed_1_21327285
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.96710044, 'precision': 0.73209137, 'recall': 0.5197779, 'specificity': 0.5197779, 'f1': 0.5294708, 'auroc': 0.87799287, 'binary_precision': 0.49579832, 'binary_recall': 0.04097222, 'binary_specificity': 0.99858356, 'binary_f1_score': 0.07568955}
confusion matrix:
       0   1
0  42300  60
1   1381  59
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.73221725, 'recall': 0.50500685, 'specificity': 0.50500685, 'f1': 0.50104344, 'auroc': 0.8692756, 'binary_precision': 0.5, 'binary_recall': 0.010401188, 'binary_specificity': 0.99961257, 'binary_f1_score': 0.020378456}
confusion matrix:
       0  1
0  18060  7
1    666  7
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589107, 'precision': 0.9794388, 'recall': 0.50961536, 'specificity': 0.50961536, 'f1': 0.50837153, 'auroc': 0.8512529, 'binary_precision': 1.0, 'binary_recall': 0.01923077, 'binary_specificity': 1.0, 'binary_f1_score': 0.037735853}
confusion matrix:
      0  1
0  5946  0
1   255  5
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327285_20.png
new oracle model saved
early stop counter: 18
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9589107036590576
after epoch: 20,now: 2024-06-16 09:00:38.002097,epoch time: 0:15:05.736011,used: 5:10:21.156318,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_50_16_seed_1_21327285
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.96694064, 'precision': 0.72059834, 'recall': 0.5230495, 'specificity': 0.5230495, 'f1': 0.5350885, 'auroc': 0.88811797, 'binary_precision': 0.47260273, 'binary_recall': 0.047916666, 'binary_specificity': 0.99818224, 'binary_f1_score': 0.087011345}
confusion matrix:
       0   1
0  42283  77
1   1371  69
---- Validation: 
scalar performance:
{'acc': 0.96419424, 'precision': 0.75162363, 'recall': 0.5100691, 'specificity': 0.5100691, 'f1': 0.510907, 'auroc': 0.88020957, 'binary_precision': 0.53846157, 'binary_recall': 0.020802377, 'binary_specificity': 0.9993358, 'binary_f1_score': 0.040057223}
confusion matrix:
       0   1
0  18055  12
1    659  14
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95939416, 'precision': 0.9796709, 'recall': 0.5153846, 'specificity': 0.5153846, 'f1': 0.5194752, 'auroc': 0.8564762, 'binary_precision': 1.0, 'binary_recall': 0.03076923, 'binary_specificity': 1.0, 'binary_f1_score': 0.05970149}
confusion matrix:
      0  1
0  5946  0
1   252  8
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327285_21.png
new oracle model saved
better model found
persisted
after epoch: 21,now: 2024-06-16 09:15:45.160201,epoch time: 0:15:07.158104,used: 5:25:28.314422,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_50_16_seed_1_21327285
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9674886, 'precision': 0.7674575, 'recall': 0.5260026, 'specificity': 0.5260026, 'f1': 0.540519, 'auroc': 0.88364494, 'binary_precision': 0.5661765, 'binary_recall': 0.053398058, 'binary_specificity': 0.9986071, 'binary_f1_score': 0.097591884}
confusion matrix:
       0   1
0  42299  59
1   1365  77
---- Validation: 
scalar performance:
{'acc': 0.964301, 'precision': 0.7658026, 'recall': 0.5122702, 'specificity': 0.5122702, 'f1': 0.5150867, 'auroc': 0.8727534, 'binary_precision': 0.56666666, 'binary_recall': 0.02526003, 'binary_specificity': 0.99928045, 'binary_f1_score': 0.04836415}
confusion matrix:
       0   1
0  18054  13
1    656  17
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95939416, 'precision': 0.9796709, 'recall': 0.5153846, 'specificity': 0.5153846, 'f1': 0.5194752, 'auroc': 0.8518899, 'binary_precision': 1.0, 'binary_recall': 0.03076923, 'binary_specificity': 1.0, 'binary_f1_score': 0.05970149}
confusion matrix:
      0  1
0  5946  0
1   252  8
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327285_22.png
better model found
persisted
after epoch: 22,now: 2024-06-16 09:31:17.616314,epoch time: 0:15:32.456113,used: 5:41:00.770535,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_50_16_seed_1_21327285
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.96710044, 'precision': 0.7358667, 'recall': 0.53350544, 'specificity': 0.53350544, 'f1': 0.5525566, 'auroc': 0.89352787, 'binary_precision': 0.5025126, 'binary_recall': 0.06934813, 'binary_specificity': 0.9976628, 'binary_f1_score': 0.12187691}
confusion matrix:
       0    1
0  42259   99
1   1342  100
---- Validation: 
scalar performance:
{'acc': 0.96435434, 'precision': 0.7663534, 'recall': 0.51515895, 'specificity': 0.51515895, 'f1': 0.520494, 'auroc': 0.87914336, 'binary_precision': 0.5675676, 'binary_recall': 0.031203566, 'binary_specificity': 0.9991144, 'binary_f1_score': 0.059154928}
confusion matrix:
       0   1
0  18051  16
1    652  21
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597164, 'precision': 0.97982574, 'recall': 0.5192308, 'specificity': 0.5192308, 'f1': 0.52674216, 'auroc': 0.8551812, 'binary_precision': 1.0, 'binary_recall': 0.03846154, 'binary_specificity': 1.0, 'binary_f1_score': 0.074074075}
confusion matrix:
      0   1
0  5946   0
1   250  10
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327285_23.png
new oracle model saved
better model found
persisted
after epoch: 23,now: 2024-06-16 09:46:44.127709,epoch time: 0:15:26.511395,used: 5:56:27.281930,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_50_16_seed_1_21327285
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.96730596, 'precision': 0.7431712, 'recall': 0.530302, 'specificity': 0.530302, 'f1': 0.54750454, 'auroc': 0.8951857, 'binary_precision': 0.51724136, 'binary_recall': 0.062586926, 'binary_specificity': 0.9980171, 'binary_f1_score': 0.11166253}
confusion matrix:
       0   1
0  42278  84
1   1348  90
---- Validation: 
scalar performance:
{'acc': 0.964461, 'precision': 0.7699548, 'recall': 0.5195059, 'specificity': 0.5195059, 'f1': 0.52844125, 'auroc': 0.8858197, 'binary_precision': 0.5744681, 'binary_recall': 0.04011887, 'binary_specificity': 0.998893, 'binary_f1_score': 0.074999996}
confusion matrix:
       0   1
0  18047  20
1    646  27
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96003866, 'precision': 0.9799806, 'recall': 0.52307695, 'specificity': 0.52307695, 'f1': 0.5339035, 'auroc': 0.8608116, 'binary_precision': 1.0, 'binary_recall': 0.046153847, 'binary_specificity': 1.0, 'binary_f1_score': 0.08823529}
confusion matrix:
      0   1
0  5946   0
1   248  12
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327285_24.png
new oracle model saved
better model found
persisted
after epoch: 24,now: 2024-06-16 10:03:15.206238,epoch time: 0:16:31.078529,used: 6:12:58.360459,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_50_16_seed_1_21327285
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9674201, 'precision': 0.7469302, 'recall': 0.54845375, 'specificity': 0.54845375, 'f1': 0.5756574, 'auroc': 0.89478314, 'binary_precision': 0.52363634, 'binary_recall': 0.1, 'binary_specificity': 0.9969075, 'binary_f1_score': 0.16793002}
confusion matrix:
       0    1
0  42229  131
1   1296  144
---- Validation: 
scalar performance:
{'acc': 0.964461, 'precision': 0.7658144, 'recall': 0.52165174, 'specificity': 0.52165174, 'f1': 0.5322621, 'auroc': 0.8869611, 'binary_precision': 0.5660377, 'binary_recall': 0.044576522, 'binary_specificity': 0.99872696, 'binary_f1_score': 0.08264463}
confusion matrix:
       0   1
0  18044  23
1    643  30
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96036094, 'precision': 0.9801357, 'recall': 0.52692306, 'specificity': 0.52692306, 'f1': 0.54096144, 'auroc': 0.8613499, 'binary_precision': 1.0, 'binary_recall': 0.053846154, 'binary_specificity': 1.0, 'binary_f1_score': 0.10218979}
confusion matrix:
      0   1
0  5946   0
1   246  14
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327285_25.png
new oracle model saved
early stop counter: 1
val acc:0.9644610285758972, best validation acc: 0.9644610285758972, corresponding to test acc:                         0.9600386619567871 / 0.9603609442710876
after epoch: 25,now: 2024-06-16 10:19:24.004639,epoch time: 0:16:08.798401,used: 6:29:07.158860,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_50_16_seed_1_21327285
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.96780825, 'precision': 0.76104856, 'recall': 0.5523696, 'specificity': 0.5523696, 'f1': 0.58190715, 'auroc': 0.9005312, 'binary_precision': 0.5516014, 'binary_recall': 0.10771369, 'binary_specificity': 0.99702555, 'binary_f1_score': 0.18023255}
confusion matrix:
       0    1
0  42235  126
1   1284  155
---- Validation: 
scalar performance:
{'acc': 0.964461, 'precision': 0.76708436, 'recall': 0.5209365, 'specificity': 0.5209365, 'f1': 0.53099555, 'auroc': 0.8874098, 'binary_precision': 0.5686275, 'binary_recall': 0.043090638, 'binary_specificity': 0.99878234, 'binary_f1_score': 0.0801105}
confusion matrix:
       0   1
0  18045  22
1    644  29
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606832, 'precision': 0.9802908, 'recall': 0.5307692, 'specificity': 0.5307692, 'f1': 0.5479183, 'auroc': 0.86009085, 'binary_precision': 1.0, 'binary_recall': 0.06153846, 'binary_specificity': 1.0, 'binary_f1_score': 0.11594203}
confusion matrix:
      0   1
0  5946   0
1   244  16
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327285_26.png
new oracle model saved
early stop counter: 2
val acc:0.9644610285758972, best validation acc: 0.9644610285758972, corresponding to test acc:                         0.9600386619567871 / 0.9606832265853882
after epoch: 26,now: 2024-06-16 10:35:49.024657,epoch time: 0:16:25.020018,used: 6:45:32.178878,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_50_16_seed_1_21327285
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.96671236, 'precision': 0.71913743, 'recall': 0.54439825, 'specificity': 0.54439825, 'f1': 0.56865716, 'auroc': 0.900102, 'binary_precision': 0.46830985, 'binary_recall': 0.09236111, 'binary_specificity': 0.99643534, 'binary_f1_score': 0.15429233}
confusion matrix:
       0    1
0  42209  151
1   1307  133
---- Validation: 
scalar performance:
{'acc': 0.964301, 'precision': 0.7512864, 'recall': 0.52085346, 'specificity': 0.52085346, 'f1': 0.53078866, 'auroc': 0.89103043, 'binary_precision': 0.537037, 'binary_recall': 0.043090638, 'binary_specificity': 0.9986163, 'binary_f1_score': 0.079779916}
confusion matrix:
       0   1
0  18042  25
1    644  29
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606832, 'precision': 0.9802908, 'recall': 0.5307692, 'specificity': 0.5307692, 'f1': 0.5479183, 'auroc': 0.8640858, 'binary_precision': 1.0, 'binary_recall': 0.06153846, 'binary_specificity': 1.0, 'binary_f1_score': 0.11594203}
confusion matrix:
      0   1
0  5946   0
1   244  16
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327285_27.png
early stop counter: 3
val acc:0.9643009901046753, best validation acc: 0.9644610285758972, corresponding to test acc:                         0.9600386619567871 / 0.9606832265853882
after epoch: 27,now: 2024-06-16 10:52:31.201180,epoch time: 0:16:42.176523,used: 7:02:14.355401,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_50_16_seed_1_21327285
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.966895, 'precision': 0.72925186, 'recall': 0.5592202, 'specificity': 0.5592202, 'f1': 0.58966506, 'auroc': 0.9034915, 'binary_precision': 0.4876033, 'binary_recall': 0.12283137, 'binary_specificity': 0.995609, 'binary_f1_score': 0.1962306}
confusion matrix:
       0    1
0  42173  186
1   1264  177
---- Validation: 
scalar performance:
{'acc': 0.9645678, 'precision': 0.76234245, 'recall': 0.53100556, 'specificity': 0.53100556, 'f1': 0.5482944, 'auroc': 0.89615154, 'binary_precision': 0.5584416, 'binary_recall': 0.06389301, 'binary_specificity': 0.9981181, 'binary_f1_score': 0.114666656}
confusion matrix:
       0   1
0  18033  34
1    630  43
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96052206, 'precision': 0.9802132, 'recall': 0.52884614, 'specificity': 0.52884614, 'f1': 0.54445237, 'auroc': 0.86794746, 'binary_precision': 1.0, 'binary_recall': 0.057692308, 'binary_specificity': 1.0, 'binary_f1_score': 0.10909091}
confusion matrix:
      0   1
0  5946   0
1   245  15
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327285_28.png
better model found
persisted
after epoch: 28,now: 2024-06-16 11:08:14.052835,epoch time: 0:15:42.851655,used: 7:17:57.207056,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_50_16_seed_1_21327285
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9679452, 'precision': 0.75995386, 'recall': 0.56687385, 'specificity': 0.56687385, 'f1': 0.60181814, 'auroc': 0.9039334, 'binary_precision': 0.54847646, 'binary_recall': 0.13759555, 'binary_specificity': 0.9961521, 'binary_f1_score': 0.22000001}
confusion matrix:
       0    1
0  42198  163
1   1241  198
---- Validation: 
scalar performance:
{'acc': 0.96451443, 'precision': 0.76009786, 'recall': 0.52954733, 'specificity': 0.52954733, 'f1': 0.5458344, 'auroc': 0.89160204, 'binary_precision': 0.5540541, 'binary_recall': 0.060921248, 'binary_specificity': 0.9981735, 'binary_f1_score': 0.10977243}
confusion matrix:
       0   1
0  18034  33
1    632  41
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96100545, 'precision': 0.980446, 'recall': 0.5346154, 'specificity': 0.5346154, 'f1': 0.55477625, 'auroc': 0.86271393, 'binary_precision': 1.0, 'binary_recall': 0.06923077, 'binary_specificity': 1.0, 'binary_f1_score': 0.12949641}
confusion matrix:
      0   1
0  5946   0
1   242  18
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327285_29.png
new oracle model saved
early stop counter: 1
val acc:0.964514434337616, best validation acc: 0.9645677804946899, corresponding to test acc:                         0.9605220556259155 / 0.961005449295044
after epoch: 29,now: 2024-06-16 11:24:48.716188,epoch time: 0:16:34.663353,used: 7:34:31.870409,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_50_16_seed_1_21327285
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9669863, 'precision': 0.73190874, 'recall': 0.558597, 'specificity': 0.558597, 'f1': 0.58901256, 'auroc': 0.90713954, 'binary_precision': 0.49295774, 'binary_recall': 0.12144344, 'binary_specificity': 0.9957506, 'binary_f1_score': 0.1948775}
confusion matrix:
       0    1
0  42179  180
1   1266  175
---- Validation: 
scalar performance:
{'acc': 0.9648346, 'precision': 0.7759341, 'recall': 0.53472024, 'specificity': 0.53472024, 'f1': 0.55460405, 'auroc': 0.89470595, 'binary_precision': 0.58536583, 'binary_recall': 0.07132243, 'binary_specificity': 0.9981181, 'binary_f1_score': 0.12715231}
confusion matrix:
       0   1
0  18033  34
1    625  48
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606832, 'precision': 0.9802908, 'recall': 0.5307692, 'specificity': 0.5307692, 'f1': 0.5479183, 'auroc': 0.86362374, 'binary_precision': 1.0, 'binary_recall': 0.06153846, 'binary_specificity': 1.0, 'binary_f1_score': 0.11594203}
confusion matrix:
      0   1
0  5946   0
1   244  16
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327285_30.png
better model found
persisted
after epoch: 30,now: 2024-06-16 11:40:46.555646,epoch time: 0:15:57.839458,used: 7:50:29.709867,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_50_16_seed_1_21327285
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 7:50:29.709867 at 2024-06-16 11:40:46.555646
persisted model performance metric: 

scalar performance:
{'acc': 0.9606832, 'precision': 0.9802908, 'recall': 0.5307692, 'specificity': 0.5307692, 'f1': 0.5479183, 'auroc': 0.86362374, 'binary_precision': 1.0, 'binary_recall': 0.06153846, 'binary_specificity': 1.0, 'binary_f1_score': 0.11594203}
confusion matrix:
      0   1
0  5946   0
1   244  16
oracle model performance metric: 

scalar performance:
{'acc': 0.96100545, 'precision': 0.980446, 'recall': 0.5346154, 'specificity': 0.5346154, 'f1': 0.55477625, 'auroc': 0.86271393, 'binary_precision': 1.0, 'binary_recall': 0.06923077, 'binary_specificity': 1.0, 'binary_f1_score': 0.12949641}
confusion matrix:
      0   1
0  5946   0
1   242  18
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_bs16_different_batchsizes/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_resnet_bs16_different_batchsizes/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204178 KiB |   1436 MiB | 688519 GiB | 688518 GiB |
|       from large pool | 167936 KiB |   1366 MiB | 688392 GiB | 688392 GiB |
|       from small pool |  36242 KiB |     72 MiB |    126 GiB |    126 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 204178 KiB |   1436 MiB | 688519 GiB | 688518 GiB |
|       from large pool | 167936 KiB |   1366 MiB | 688392 GiB | 688392 GiB |
|       from small pool |  36242 KiB |     72 MiB |    126 GiB |    126 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201086 KiB |   1428 MiB | 688498 GiB | 688498 GiB |
|       from large pool | 165120 KiB |   1358 MiB | 688375 GiB | 688375 GiB |
|       from small pool |  35966 KiB |     71 MiB |    122 GiB |    122 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1466 MiB |   1524 MiB |   2478 MiB |   1012 MiB |
|       from large pool |   1392 MiB |   1450 MiB |   2374 MiB |    982 MiB |
|       from small pool |     74 MiB |     74 MiB |    104 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 320109 KiB | 749313 KiB | 527770 GiB | 527769 GiB |
|       from large pool | 311296 KiB | 748328 KiB | 527632 GiB | 527632 GiB |
|       from small pool |   8813 KiB |  16408 KiB |    137 GiB |    137 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1278    |    1935    |   22715 K  |   22714 K  |
|       from large pool |      36    |      76    |    9038 K  |    9038 K  |
|       from small pool |    1242    |    1864    |   13677 K  |   13675 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1278    |    1935    |   22715 K  |   22714 K  |
|       from large pool |      36    |      76    |    9038 K  |    9038 K  |
|       from small pool |    1242    |    1864    |   13677 K  |   13675 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      49    |      50    |      68    |      19    |
|       from large pool |      12    |      13    |      16    |       4    |
|       from small pool |      37    |      37    |      52    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      35    |     453    |   12958 K  |   12958 K  |
|       from large pool |       5    |      11    |    3538 K  |    3538 K  |
|       from small pool |      30    |     448    |    9419 K  |    9419 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1436 MiB | 688519 GiB | 688519 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 688392 GiB | 688392 GiB |
|       from small pool |      0 KiB |     72 MiB |    126 GiB |    126 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1436 MiB | 688519 GiB | 688519 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 688392 GiB | 688392 GiB |
|       from small pool |      0 KiB |     72 MiB |    126 GiB |    126 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1428 MiB | 688498 GiB | 688498 GiB |
|       from large pool |  16640 KiB |   1358 MiB | 688375 GiB | 688375 GiB |
|       from small pool |      0 KiB |     71 MiB |    122 GiB |    122 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 524288 KiB |   1524 MiB |   2478 MiB |   1966 MiB |
|       from large pool | 479232 KiB |   1450 MiB |   2374 MiB |   1906 MiB |
|       from small pool |  45056 KiB |     74 MiB |    104 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 298752 KiB | 749313 KiB | 527770 GiB | 527770 GiB |
|       from large pool | 298752 KiB | 748328 KiB | 527632 GiB | 527632 GiB |
|       from small pool |      0 KiB |  16408 KiB |    137 GiB |    137 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1935    |   22715 K  |   22715 K  |
|       from large pool |       2    |      76    |    9038 K  |    9038 K  |
|       from small pool |       0    |    1864    |   13677 K  |   13677 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1935    |   22715 K  |   22715 K  |
|       from large pool |       2    |      76    |    9038 K  |    9038 K  |
|       from small pool |       0    |    1864    |   13677 K  |   13677 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      50    |      68    |      37    |
|       from large pool |       9    |      13    |      16    |       7    |
|       from small pool |      22    |      37    |      52    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     453    |   12958 K  |   12958 K  |
|       from large pool |       1    |      11    |    3538 K  |    3538 K  |
|       from small pool |       0    |     448    |    9419 K  |    9419 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1436 MiB | 688519 GiB | 688519 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 688392 GiB | 688392 GiB |
|       from small pool |      0 KiB |     72 MiB |    126 GiB |    126 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1436 MiB | 688519 GiB | 688519 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 688392 GiB | 688392 GiB |
|       from small pool |      0 KiB |     72 MiB |    126 GiB |    126 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1428 MiB | 688498 GiB | 688498 GiB |
|       from large pool |  16640 KiB |   1358 MiB | 688375 GiB | 688375 GiB |
|       from small pool |      0 KiB |     71 MiB |    122 GiB |    122 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 524288 KiB |   1524 MiB |   2478 MiB |   1966 MiB |
|       from large pool | 479232 KiB |   1450 MiB |   2374 MiB |   1906 MiB |
|       from small pool |  45056 KiB |     74 MiB |    104 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 298752 KiB | 749313 KiB | 527770 GiB | 527770 GiB |
|       from large pool | 298752 KiB | 748328 KiB | 527632 GiB | 527632 GiB |
|       from small pool |      0 KiB |  16408 KiB |    137 GiB |    137 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1935    |   22715 K  |   22715 K  |
|       from large pool |       2    |      76    |    9038 K  |    9038 K  |
|       from small pool |       0    |    1864    |   13677 K  |   13677 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1935    |   22715 K  |   22715 K  |
|       from large pool |       2    |      76    |    9038 K  |    9038 K  |
|       from small pool |       0    |    1864    |   13677 K  |   13677 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      50    |      68    |      37    |
|       from large pool |       9    |      13    |      16    |       7    |
|       from small pool |      22    |      37    |      52    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     453    |   12958 K  |   12958 K  |
|       from large pool |       1    |      11    |    3538 K  |    3538 K  |
|       from small pool |       0    |     448    |    9419 K  |    9419 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0




!!!: not committed yet



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_47_50_seed_2_21327285

 Experiment start at: 2024-06-16 11:47:50.353119
before training, model accuracy: 0.0544959120452404
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96547943, 'precision': 0.48273972, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4912183, 'auroc': 0.4403496, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42288  0
1   1512  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.37220454, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.36551473, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327285_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-16 12:04:20.713409,epoch time: 0:16:30.360290,used: 0:16:30.360290,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_47_50_seed_2_21327285
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96547943, 'precision': 0.48273972, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4912183, 'auroc': 0.44702095, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42288  0
1   1512  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.36656812, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.35139644, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327285_2.png
early stop counter: 1
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 2,now: 2024-06-16 12:20:02.012271,epoch time: 0:15:41.298862,used: 0:32:11.659152,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_47_50_seed_2_21327285
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96547943, 'precision': 0.48273972, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4912183, 'auroc': 0.4908508, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42288  0
1   1512  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.42872742, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.4056279, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327285_3.png
early stop counter: 2
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 3,now: 2024-06-16 12:35:41.839367,epoch time: 0:15:39.827096,used: 0:47:51.486248,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_47_50_seed_2_21327285
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9654566, 'precision': 0.4827283, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49121237, 'auroc': 0.51543593, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42287  0
1   1513  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.44118074, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.44000357, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327285_4.png
early stop counter: 3
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 4,now: 2024-06-16 12:51:20.904336,epoch time: 0:15:39.064969,used: 1:03:30.551217,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_47_50_seed_2_21327285
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9654566, 'precision': 0.4827283, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49121237, 'auroc': 0.5581918, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42287  0
1   1513  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.4844622, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.48545364, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327285_5.png
early stop counter: 4
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 5,now: 2024-06-16 13:06:47.813393,epoch time: 0:15:26.909057,used: 1:18:57.460274,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_47_50_seed_2_21327285
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96547943, 'precision': 0.48273972, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4912183, 'auroc': 0.62613094, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42288  0
1   1512  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.56964684, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.5358399, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327285_6.png
early stop counter: 5
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 6,now: 2024-06-16 13:21:59.040086,epoch time: 0:15:11.226693,used: 1:34:08.686967,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_47_50_seed_2_21327285
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96547943, 'precision': 0.48273972, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4912183, 'auroc': 0.67382574, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42288  0
1   1512  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.6317555, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.5979732, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327285_7.png
early stop counter: 6
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 7,now: 2024-06-16 13:37:06.631050,epoch time: 0:15:07.590964,used: 1:49:16.277931,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_47_50_seed_2_21327285
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.96547943, 'precision': 0.48273972, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4912183, 'auroc': 0.69567263, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42288  0
1   1512  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.6413444, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.6479273, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327285_8.png
early stop counter: 7
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 8,now: 2024-06-16 13:52:14.788442,epoch time: 0:15:08.157392,used: 2:04:24.435323,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_47_50_seed_2_21327285
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9654566, 'precision': 0.4827283, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49121237, 'auroc': 0.7353951, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42287  0
1   1513  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.7040067, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.687738, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327285_9.png
early stop counter: 8
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 9,now: 2024-06-16 14:07:26.639590,epoch time: 0:15:11.851148,used: 2:19:36.286471,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_47_50_seed_2_21327285
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.96550226, 'precision': 0.48275113, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4912242, 'auroc': 0.77328575, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42289  0
1   1511  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.7444267, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.7335305, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327285_10.png
early stop counter: 9
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 10,now: 2024-06-16 14:23:03.804330,epoch time: 0:15:37.164740,used: 2:35:13.451211,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_47_50_seed_2_21327285
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96547943, 'precision': 0.48273972, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4912183, 'auroc': 0.79784197, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42288  0
1   1512  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.7624742, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.7559531, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327285_11.png
early stop counter: 10
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 11,now: 2024-06-16 14:38:25.672414,epoch time: 0:15:21.868084,used: 2:50:35.319295,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_47_50_seed_2_21327285
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9655251, 'precision': 0.48276255, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4912301, 'auroc': 0.82134193, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42290  0
1   1510  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.7951651, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.77742624, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327285_12.png
early stop counter: 11
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 12,now: 2024-06-16 14:53:40.718975,epoch time: 0:15:15.046561,used: 3:05:50.365856,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_47_50_seed_2_21327285
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.96550226, 'precision': 0.9827508, 'recall': 0.5003307, 'specificity': 0.5003307, 'f1': 0.49188492, 'auroc': 0.840029, 'binary_precision': 1.0, 'binary_recall': 0.00066137564, 'binary_specificity': 1.0, 'binary_f1_score': 0.001321877}
confusion matrix:
       0  1
0  42288  0
1   1511  1
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.81861806, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.8023912, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327285_13.png
early stop counter: 12
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 13,now: 2024-06-16 15:09:03.441272,epoch time: 0:15:22.722297,used: 3:21:13.088153,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_47_50_seed_2_21327285
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9655251, 'precision': 0.7685083, 'recall': 0.5012882, 'specificity': 0.5012882, 'f1': 0.49386433, 'auroc': 0.84878635, 'binary_precision': 0.5714286, 'binary_recall': 0.0026472535, 'binary_specificity': 0.9999291, 'binary_f1_score': 0.005270092}
confusion matrix:
       0  1
0  42286  3
1   1507  4
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.8378993, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.81189835, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327285_14.png
early stop counter: 13
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 14,now: 2024-06-16 15:25:05.808822,epoch time: 0:16:02.367550,used: 3:37:15.455703,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_47_50_seed_2_21327285
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.96559364, 'precision': 0.81618136, 'recall': 0.50324774, 'specificity': 0.50324774, 'f1': 0.49779457, 'auroc': 0.84925103, 'binary_precision': 0.6666667, 'binary_recall': 0.0066137565, 'binary_specificity': 0.99988174, 'binary_f1_score': 0.013097578}
confusion matrix:
       0   1
0  42283   5
1   1502  10
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.8430271, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.82248557, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327285_15.png
early stop counter: 14
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 15,now: 2024-06-16 15:40:16.021785,epoch time: 0:15:10.212963,used: 3:52:25.668666,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_47_50_seed_2_21327285
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.96557075, 'precision': 0.77919674, 'recall': 0.5051575, 'specificity': 0.5051575, 'f1': 0.5016283, 'auroc': 0.8654666, 'binary_precision': 0.5925926, 'binary_recall': 0.010575017, 'binary_specificity': 0.9997399, 'binary_f1_score': 0.020779222}
confusion matrix:
       0   1
0  42276  11
1   1497  16
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.85464156, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.8297038, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327285_16.png
early stop counter: 15
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 16,now: 2024-06-16 15:55:25.796932,epoch time: 0:15:09.775147,used: 4:07:35.443813,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_47_50_seed_2_21327285
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.96557075, 'precision': 0.7596026, 'recall': 0.5083439, 'specificity': 0.5083439, 'f1': 0.5079033, 'auroc': 0.87024605, 'binary_precision': 0.5531915, 'binary_recall': 0.0171844, 'binary_specificity': 0.9995034, 'binary_f1_score': 0.033333335}
confusion matrix:
       0   1
0  42266  21
1   1487  26
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.73399127, 'recall': 0.50080305, 'specificity': 0.50080305, 'f1': 0.49350777, 'auroc': 0.8643868, 'binary_precision': 0.5, 'binary_recall': 0.0016611295, 'binary_specificity': 0.999945, 'binary_f1_score': 0.0033112583}
confusion matrix:
       0  1
0  18170  1
1    601  1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.8385756, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327285_17.png
early stop counter: 16
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 17,now: 2024-06-16 16:10:40.342851,epoch time: 0:15:14.545919,used: 4:22:49.989732,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_47_50_seed_2_21327285
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9655479, 'precision': 0.74430746, 'recall': 0.5111957, 'specificity': 0.5111957, 'f1': 0.51339483, 'auroc': 0.8760919, 'binary_precision': 0.52238804, 'binary_recall': 0.023148147, 'binary_specificity': 0.99924326, 'binary_f1_score': 0.044331856}
confusion matrix:
       0   1
0  42256  32
1   1477  35
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.73399127, 'recall': 0.50080305, 'specificity': 0.50080305, 'f1': 0.49350777, 'auroc': 0.8686235, 'binary_precision': 0.5, 'binary_recall': 0.0016611295, 'binary_specificity': 0.999945, 'binary_f1_score': 0.0033112583}
confusion matrix:
       0  1
0  18170  1
1    601  1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.961372, 'precision': 0.9806829, 'recall': 0.50206614, 'specificity': 0.50206614, 'f1': 0.49426642, 'auroc': 0.8396714, 'binary_precision': 1.0, 'binary_recall': 0.004132231, 'binary_specificity': 1.0, 'binary_f1_score': 0.008230452}
confusion matrix:
      0  1
0  5997  0
1   241  1
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327285_18.png
new oracle model saved
early stop counter: 17
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9613720178604126
after epoch: 18,now: 2024-06-16 16:26:06.424953,epoch time: 0:15:26.082102,used: 4:38:16.071834,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_47_50_seed_2_21327285
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9658219, 'precision': 0.7591196, 'recall': 0.5260053, 'specificity': 0.5260053, 'f1': 0.5401151, 'auroc': 0.8792795, 'binary_precision': 0.5510204, 'binary_recall': 0.05357143, 'binary_specificity': 0.99843925, 'binary_f1_score': 0.09764919}
confusion matrix:
       0   1
0  42222  66
1   1431  81
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.73409104, 'recall': 0.50401527, 'specificity': 0.50401527, 'f1': 0.50002027, 'auroc': 0.8758187, 'binary_precision': 0.5, 'binary_recall': 0.008305647, 'binary_specificity': 0.99972486, 'binary_f1_score': 0.016339868}
confusion matrix:
       0  1
0  18166  5
1    597  5
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9620131, 'precision': 0.98099136, 'recall': 0.51033056, 'specificity': 0.51033056, 'f1': 0.5105544, 'auroc': 0.84930295, 'binary_precision': 1.0, 'binary_recall': 0.020661157, 'binary_specificity': 1.0, 'binary_f1_score': 0.04048583}
confusion matrix:
      0  1
0  5997  0
1   237  5
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327285_19.png
new oracle model saved
early stop counter: 18
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9620131254196167
after epoch: 19,now: 2024-06-16 16:41:18.668415,epoch time: 0:15:12.243462,used: 4:53:28.315296,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_47_50_seed_2_21327285
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9656393, 'precision': 0.74970484, 'recall': 0.51825804, 'specificity': 0.51825804, 'f1': 0.52645504, 'auroc': 0.88387597, 'binary_precision': 0.53271025, 'binary_recall': 0.037698414, 'binary_specificity': 0.9988176, 'binary_f1_score': 0.07041384}
confusion matrix:
       0   1
0  42238  50
1   1455  57
---- Validation: 
scalar performance:
{'acc': 0.9679859, 'precision': 0.7568441, 'recall': 0.5048458, 'specificity': 0.5048458, 'f1': 0.5016516, 'auroc': 0.8746363, 'binary_precision': 0.54545456, 'binary_recall': 0.009966778, 'binary_specificity': 0.99972486, 'binary_f1_score': 0.019575857}
confusion matrix:
       0  1
0  18166  5
1    596  6
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96185285, 'precision': 0.98091424, 'recall': 0.5082645, 'specificity': 0.5082645, 'f1': 0.5065316, 'auroc': 0.8467423, 'binary_precision': 1.0, 'binary_recall': 0.016528925, 'binary_specificity': 1.0, 'binary_f1_score': 0.032520324}
confusion matrix:
      0  1
0  5997  0
1   238  4
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327285_20.png
better model found
persisted
after epoch: 20,now: 2024-06-16 16:56:41.092300,epoch time: 0:15:22.423885,used: 5:08:50.739181,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_47_50_seed_2_21327285
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.96515983, 'precision': 0.71081805, 'recall': 0.5237539, 'specificity': 0.5237539, 'f1': 0.5358695, 'auroc': 0.8931744, 'binary_precision': 0.45454547, 'binary_recall': 0.049636003, 'binary_specificity': 0.9978718, 'binary_f1_score': 0.08949881}
confusion matrix:
       0   1
0  42199  90
1   1436  75
---- Validation: 
scalar performance:
{'acc': 0.9679859, 'precision': 0.74513626, 'recall': 0.5096641, 'specificity': 0.5096641, 'f1': 0.5110611, 'auroc': 0.8825836, 'binary_precision': 0.5217391, 'binary_recall': 0.019933555, 'binary_specificity': 0.99939466, 'binary_f1_score': 0.038399998}
confusion matrix:
       0   1
0  18160  11
1    590  12
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96281457, 'precision': 0.9813774, 'recall': 0.5206612, 'specificity': 0.5206612, 'f1': 0.5301945, 'auroc': 0.8551934, 'binary_precision': 1.0, 'binary_recall': 0.041322313, 'binary_specificity': 1.0, 'binary_f1_score': 0.079365075}
confusion matrix:
      0   1
0  5997   0
1   232  10
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327285_21.png
new oracle model saved
early stop counter: 1
val acc:0.9679859280586243, best validation acc: 0.9679859280586243, corresponding to test acc:                         0.9618528485298157 / 0.9628145694732666
after epoch: 21,now: 2024-06-16 17:11:58.597409,epoch time: 0:15:17.505109,used: 5:24:08.244290,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_47_50_seed_2_21327285
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.96621007, 'precision': 0.776266, 'recall': 0.53671575, 'specificity': 0.53671575, 'f1': 0.5581293, 'auroc': 0.89529645, 'binary_precision': 0.5846154, 'binary_recall': 0.07534699, 'binary_specificity': 0.99808455, 'binary_f1_score': 0.13348946}
confusion matrix:
       0    1
0  42206   81
1   1399  114
---- Validation: 
scalar performance:
{'acc': 0.9680925, 'precision': 0.75714564, 'recall': 0.51453745, 'specificity': 0.51453745, 'f1': 0.5202324, 'auroc': 0.88565505, 'binary_precision': 0.54545456, 'binary_recall': 0.029900333, 'binary_specificity': 0.99917454, 'binary_f1_score': 0.056692917}
confusion matrix:
       0   1
0  18156  15
1    584  18
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96297485, 'precision': 0.98145473, 'recall': 0.52272725, 'specificity': 0.52272725, 'f1': 0.53403044, 'auroc': 0.8598371, 'binary_precision': 1.0, 'binary_recall': 0.045454547, 'binary_specificity': 1.0, 'binary_f1_score': 0.08695653}
confusion matrix:
      0   1
0  5997   0
1   231  11
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327285_22.png
new oracle model saved
better model found
persisted
after epoch: 22,now: 2024-06-16 17:27:11.964848,epoch time: 0:15:13.367439,used: 5:39:21.611729,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_47_50_seed_2_21327285
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.96593606, 'precision': 0.7560022, 'recall': 0.5397756, 'specificity': 0.5397756, 'f1': 0.56257576, 'auroc': 0.89301527, 'binary_precision': 0.54385966, 'binary_recall': 0.08201058, 'binary_specificity': 0.99754065, 'binary_f1_score': 0.14252874}
confusion matrix:
       0    1
0  42184  104
1   1388  124
---- Validation: 
scalar performance:
{'acc': 0.9680392, 'precision': 0.7469926, 'recall': 0.516919, 'specificity': 0.516919, 'f1': 0.524581, 'auroc': 0.8830818, 'binary_precision': 0.525, 'binary_recall': 0.034883723, 'binary_specificity': 0.99895436, 'binary_f1_score': 0.06542056}
confusion matrix:
       0   1
0  18152  19
1    581  21
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9634557, 'precision': 0.9816867, 'recall': 0.5289256, 'specificity': 0.5289256, 'f1': 0.5453601, 'auroc': 0.8569665, 'binary_precision': 1.0, 'binary_recall': 0.05785124, 'binary_specificity': 1.0, 'binary_f1_score': 0.10937501}
confusion matrix:
      0   1
0  5997   0
1   228  14
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327285_23.png
new oracle model saved
early stop counter: 1
val acc:0.9680392146110535, best validation acc: 0.9680925011634827, corresponding to test acc:                         0.9629748463630676 / 0.9634556770324707
after epoch: 23,now: 2024-06-16 17:42:21.285987,epoch time: 0:15:09.321139,used: 5:54:30.932868,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_47_50_seed_2_21327285
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.96607304, 'precision': 0.75611556, 'recall': 0.54817915, 'specificity': 0.54817915, 'f1': 0.5753283, 'auroc': 0.8987506, 'binary_precision': 0.54347825, 'binary_recall': 0.09933775, 'binary_specificity': 0.99702054, 'binary_f1_score': 0.16797312}
confusion matrix:
       0    1
0  42164  126
1   1360  150
---- Validation: 
scalar performance:
{'acc': 0.9681457, 'precision': 0.7546446, 'recall': 0.52179235, 'specificity': 0.52179235, 'f1': 0.5333067, 'auroc': 0.88830465, 'binary_precision': 0.54, 'binary_recall': 0.0448505, 'binary_specificity': 0.99873424, 'binary_f1_score': 0.082822084}
confusion matrix:
       0   1
0  18148  23
1    575  27
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642571, 'precision': 0.98207396, 'recall': 0.5392562, 'specificity': 0.5392562, 'f1': 0.5636703, 'auroc': 0.8617165, 'binary_precision': 1.0, 'binary_recall': 0.0785124, 'binary_specificity': 1.0, 'binary_f1_score': 0.14559387}
confusion matrix:
      0   1
0  5997   0
1   223  19
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327285_24.png
new oracle model saved
better model found
persisted
after epoch: 24,now: 2024-06-16 17:57:49.344330,epoch time: 0:15:28.058343,used: 6:09:58.991211,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_47_50_seed_2_21327285
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.96600455, 'precision': 0.7583848, 'recall': 0.5436195, 'specificity': 0.5436195, 'f1': 0.56855565, 'auroc': 0.8979077, 'binary_precision': 0.5483871, 'binary_recall': 0.08988764, 'binary_specificity': 0.9973514, 'binary_f1_score': 0.1544577}
confusion matrix:
       0    1
0  42175  112
1   1377  136
---- Validation: 
scalar performance:
{'acc': 0.9681457, 'precision': 0.75951934, 'recall': 0.51777714, 'specificity': 0.51777714, 'f1': 0.52616584, 'auroc': 0.8877388, 'binary_precision': 0.55, 'binary_recall': 0.036544852, 'binary_specificity': 0.99900943, 'binary_f1_score': 0.06853583}
confusion matrix:
       0   1
0  18153  18
1    580  22
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9640968, 'precision': 0.9819965, 'recall': 0.5371901, 'specificity': 0.5371901, 'f1': 0.56006396, 'auroc': 0.85888195, 'binary_precision': 1.0, 'binary_recall': 0.07438017, 'binary_specificity': 1.0, 'binary_f1_score': 0.13846155}
confusion matrix:
      0   1
0  5997   0
1   224  18
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327285_25.png
early stop counter: 1
val acc:0.9681457281112671, best validation acc: 0.9681457281112671, corresponding to test acc:                         0.9642571210861206 / 0.9642571210861206
after epoch: 25,now: 2024-06-16 18:15:35.537609,epoch time: 0:17:46.193279,used: 6:27:45.184490,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_47_50_seed_2_21327285
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.96636987, 'precision': 0.769402, 'recall': 0.5511605, 'specificity': 0.5511605, 'f1': 0.58019423, 'auroc': 0.9024236, 'binary_precision': 0.56989247, 'binary_recall': 0.10515873, 'binary_specificity': 0.99716234, 'binary_f1_score': 0.17755444}
confusion matrix:
       0    1
0  42168  120
1   1353  159
---- Validation: 
scalar performance:
{'acc': 0.9681457, 'precision': 0.7554529, 'recall': 0.5209893, 'specificity': 0.5209893, 'f1': 0.5318961, 'auroc': 0.8903476, 'binary_precision': 0.5416667, 'binary_recall': 0.04318937, 'binary_specificity': 0.99878925, 'binary_f1_score': 0.080000006}
confusion matrix:
       0   1
0  18149  22
1    576  26
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9648982, 'precision': 0.9823842, 'recall': 0.54752064, 'specificity': 0.54752064, 'f1': 0.57782656, 'auroc': 0.858966, 'binary_precision': 1.0, 'binary_recall': 0.09504132, 'binary_specificity': 1.0, 'binary_f1_score': 0.17358491}
confusion matrix:
      0   1
0  5997   0
1   219  23
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327285_26.png
new oracle model saved
early stop counter: 2
val acc:0.9681457281112671, best validation acc: 0.9681457281112671, corresponding to test acc:                         0.9642571210861206 / 0.9648982286453247
after epoch: 26,now: 2024-06-16 18:30:49.395504,epoch time: 0:15:13.857895,used: 6:42:59.042385,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_47_50_seed_2_21327285
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.96600455, 'precision': 0.75147283, 'recall': 0.5586241, 'specificity': 0.5586241, 'f1': 0.5899696, 'auroc': 0.90551156, 'binary_precision': 0.5335277, 'binary_recall': 0.121031746, 'binary_specificity': 0.9962164, 'binary_f1_score': 0.19730458}
confusion matrix:
       0    1
0  42128  160
1   1329  183
---- Validation: 
scalar performance:
{'acc': 0.9680392, 'precision': 0.74307656, 'recall': 0.52494955, 'specificity': 0.52494955, 'f1': 0.53869414, 'auroc': 0.89338005, 'binary_precision': 0.51666665, 'binary_recall': 0.051495016, 'binary_specificity': 0.998404, 'binary_f1_score': 0.093655586}
confusion matrix:
       0   1
0  18142  29
1    571  31
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9656996, 'precision': 0.98277247, 'recall': 0.55785125, 'specificity': 0.55785125, 'f1': 0.59493893, 'auroc': 0.86477196, 'binary_precision': 1.0, 'binary_recall': 0.11570248, 'binary_specificity': 1.0, 'binary_f1_score': 0.2074074}
confusion matrix:
      0   1
0  5997   0
1   214  28
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327285_27.png
new oracle model saved
early stop counter: 3
val acc:0.9680392146110535, best validation acc: 0.9681457281112671, corresponding to test acc:                         0.9642571210861206 / 0.9656996130943298
after epoch: 27,now: 2024-06-16 18:46:01.704490,epoch time: 0:15:12.308986,used: 6:58:11.351371,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_47_50_seed_2_21327285
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9660502, 'precision': 0.752391, 'recall': 0.56087977, 'specificity': 0.56087977, 'f1': 0.59309524, 'auroc': 0.9032661, 'binary_precision': 0.53521127, 'binary_recall': 0.12566137, 'binary_specificity': 0.99609816, 'binary_f1_score': 0.2035351}
confusion matrix:
       0    1
0  42123  165
1   1322  190
---- Validation: 
scalar performance:
{'acc': 0.9680392, 'precision': 0.74167573, 'recall': 0.53057086, 'specificity': 0.53057086, 'f1': 0.54807633, 'auroc': 0.8953383, 'binary_precision': 0.5135135, 'binary_recall': 0.06312292, 'binary_specificity': 0.9980188, 'binary_f1_score': 0.112426035}
confusion matrix:
       0   1
0  18135  36
1    564  38
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9661805, 'precision': 0.98300576, 'recall': 0.5640496, 'specificity': 0.5640496, 'f1': 0.6049091, 'auroc': 0.86585283, 'binary_precision': 1.0, 'binary_recall': 0.12809917, 'binary_specificity': 1.0, 'binary_f1_score': 0.22710621}
confusion matrix:
      0   1
0  5997   0
1   211  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327285_28.png
new oracle model saved
early stop counter: 4
val acc:0.9680392146110535, best validation acc: 0.9681457281112671, corresponding to test acc:                         0.9642571210861206 / 0.9661805033683777
after epoch: 28,now: 2024-06-16 19:02:53.049942,epoch time: 0:16:51.345452,used: 7:15:02.696823,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_47_50_seed_2_21327285
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.96591324, 'precision': 0.7473864, 'recall': 0.5677893, 'specificity': 0.5677893, 'f1': 0.60187715, 'auroc': 0.9049328, 'binary_precision': 0.5247525, 'binary_recall': 0.14011897, 'binary_specificity': 0.9954596, 'binary_f1_score': 0.22117895}
confusion matrix:
       0    1
0  42095  192
1   1301  212
---- Validation: 
scalar performance:
{'acc': 0.9679859, 'precision': 0.738133, 'recall': 0.53214943, 'specificity': 0.53214943, 'f1': 0.5505858, 'auroc': 0.89680755, 'binary_precision': 0.5063291, 'binary_recall': 0.06644518, 'binary_specificity': 0.9978537, 'binary_f1_score': 0.1174743}
confusion matrix:
       0   1
0  18132  39
1    562  40
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9663408, 'precision': 0.9830836, 'recall': 0.5661157, 'specificity': 0.5661157, 'f1': 0.6081846, 'auroc': 0.8670501, 'binary_precision': 1.0, 'binary_recall': 0.1322314, 'binary_specificity': 1.0, 'binary_f1_score': 0.23357664}
confusion matrix:
      0   1
0  5997   0
1   210  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327285_29.png
new oracle model saved
early stop counter: 5
val acc:0.9679859280586243, best validation acc: 0.9681457281112671, corresponding to test acc:                         0.9642571210861206 / 0.9663407802581787
after epoch: 29,now: 2024-06-16 19:18:08.939893,epoch time: 0:15:15.889951,used: 7:30:18.586774,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_47_50_seed_2_21327285
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9665753, 'precision': 0.7620992, 'recall': 0.5799647, 'specificity': 0.5799647, 'f1': 0.61836374, 'auroc': 0.9076445, 'binary_precision': 0.55333334, 'binary_recall': 0.16468254, 'binary_specificity': 0.9952469, 'binary_f1_score': 0.25382262}
confusion matrix:
       0    1
0  42087  201
1   1263  249
---- Validation: 
scalar performance:
{'acc': 0.9681457, 'precision': 0.7449386, 'recall': 0.5434747, 'specificity': 0.5434747, 'f1': 0.56837106, 'auroc': 0.89789325, 'binary_precision': 0.5192308, 'binary_recall': 0.089701, 'binary_specificity': 0.99724835, 'binary_f1_score': 0.15297452}
confusion matrix:
       0   1
0  18121  50
1    548  54
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96714216, 'precision': 0.98347306, 'recall': 0.5764463, 'specificity': 0.5764463, 'f1': 0.6242141, 'auroc': 0.87131715, 'binary_precision': 1.0, 'binary_recall': 0.15289256, 'binary_specificity': 1.0, 'binary_f1_score': 0.26523295}
confusion matrix:
      0   1
0  5997   0
1   205  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327285_30.png
new oracle model saved
early stop counter: 6
val acc:0.9681457281112671, best validation acc: 0.9681457281112671, corresponding to test acc:                         0.9642571210861206 / 0.9671421647071838
after epoch: 30,now: 2024-06-16 19:33:23.571909,epoch time: 0:15:14.632016,used: 7:45:33.218790,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_47_50_seed_2_21327285
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 7:45:33.218790 at 2024-06-16 19:33:23.571909
persisted model performance metric: 

scalar performance:
{'acc': 0.9642571, 'precision': 0.98207396, 'recall': 0.5392562, 'specificity': 0.5392562, 'f1': 0.5636703, 'auroc': 0.8617165, 'binary_precision': 1.0, 'binary_recall': 0.0785124, 'binary_specificity': 1.0, 'binary_f1_score': 0.14559387}
confusion matrix:
      0   1
0  5997   0
1   223  19
oracle model performance metric: 

scalar performance:
{'acc': 0.96714216, 'precision': 0.98347306, 'recall': 0.5764463, 'specificity': 0.5764463, 'f1': 0.6242141, 'auroc': 0.87131715, 'binary_precision': 1.0, 'binary_recall': 0.15289256, 'binary_specificity': 1.0, 'binary_f1_score': 0.26523295}
confusion matrix:
      0   1
0  5997   0
1   205  37
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_bs16_different_batchsizes/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_resnet_bs16_different_batchsizes/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204178 KiB |   1436 MiB |   1067 TiB |   1067 TiB |
|       from large pool | 167936 KiB |   1366 MiB |   1067 TiB |   1067 TiB |
|       from small pool |  36242 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 204178 KiB |   1436 MiB |   1067 TiB |   1067 TiB |
|       from large pool | 167936 KiB |   1366 MiB |   1067 TiB |   1067 TiB |
|       from small pool |  36242 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201087 KiB |   1428 MiB |   1067 TiB |   1067 TiB |
|       from large pool | 165120 KiB |   1358 MiB |   1067 TiB |   1067 TiB |
|       from small pool |  35967 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1466 MiB |   1524 MiB |   3432 MiB |   1966 MiB |
|       from large pool |   1392 MiB |   1450 MiB |   3298 MiB |   1906 MiB |
|       from small pool |     74 MiB |     74 MiB |    134 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 320109 KiB | 749313 KiB |    824 TiB |    824 TiB |
|       from large pool | 311296 KiB | 748328 KiB |    823 TiB |    823 TiB |
|       from small pool |   8813 KiB |  16408 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    1278    |    1935    |   36067 K  |   36066 K  |
|       from large pool |      36    |      76    |   14350 K  |   14350 K  |
|       from small pool |    1242    |    1864    |   21716 K  |   21715 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1278    |    1935    |   36067 K  |   36066 K  |
|       from large pool |      36    |      76    |   14350 K  |   14350 K  |
|       from small pool |    1242    |    1864    |   21716 K  |   21715 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      49    |      50    |      86    |      37    |
|       from large pool |      12    |      13    |      19    |       7    |
|       from small pool |      37    |      37    |      67    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      35    |     453    |   20280 K  |   20280 K  |
|       from large pool |       5    |      11    |    5692 K  |    5692 K  |
|       from small pool |      30    |     448    |   14587 K  |   14587 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1436 MiB |   1067 TiB |   1067 TiB |
|       from large pool |  16640 KiB |   1366 MiB |   1067 TiB |   1067 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1436 MiB |   1067 TiB |   1067 TiB |
|       from large pool |  16640 KiB |   1366 MiB |   1067 TiB |   1067 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1428 MiB |   1067 TiB |   1067 TiB |
|       from large pool |  16640 KiB |   1358 MiB |   1067 TiB |   1067 TiB |
|       from small pool |      0 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 524288 KiB |   1524 MiB |   3432 MiB |   2920 MiB |
|       from large pool | 479232 KiB |   1450 MiB |   3298 MiB |   2830 MiB |
|       from small pool |  45056 KiB |     74 MiB |    134 MiB |     90 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 298752 KiB | 749313 KiB |    824 TiB |    824 TiB |
|       from large pool | 298752 KiB | 748328 KiB |    823 TiB |    823 TiB |
|       from small pool |      0 KiB |  16408 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1935    |   36067 K  |   36067 K  |
|       from large pool |       2    |      76    |   14350 K  |   14350 K  |
|       from small pool |       0    |    1864    |   21716 K  |   21716 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1935    |   36067 K  |   36067 K  |
|       from large pool |       2    |      76    |   14350 K  |   14350 K  |
|       from small pool |       0    |    1864    |   21716 K  |   21716 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      50    |      86    |      55    |
|       from large pool |       9    |      13    |      19    |      10    |
|       from small pool |      22    |      37    |      67    |      45    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     453    |   20280 K  |   20280 K  |
|       from large pool |       1    |      11    |    5692 K  |    5692 K  |
|       from small pool |       0    |     448    |   14588 K  |   14588 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

