Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0




!!!: not committed yet



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_13_25_00_seed_0_21546988

 Experiment start at: 2024-06-22 13:25:00.685278
before training, model accuracy: 0.31128156185150146
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9056079, 'precision': 0.45280394, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.47523305, 'auroc': 0.7995933, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42310  0
1   4410  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.41512883, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.43428242, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546988_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-22 13:40:00.980243,epoch time: 0:15:00.294965,used: 0:15:00.294965,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_13_25_00_seed_0_21546988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.91883564, 'precision': 0.95573187, 'recall': 0.5708635, 'specificity': 0.5708635, 'f1': 0.6026589, 'auroc': 0.93109167, 'binary_precision': 0.9936508, 'binary_recall': 0.14182147, 'binary_specificity': 0.99990547, 'binary_f1_score': 0.2482157}
confusion matrix:
       0    1
0  42302    4
1   3788  626
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.52268136, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.5986598, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546988_2.png
early stop counter: 1
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 2,now: 2024-06-22 13:54:00.529224,epoch time: 0:13:59.548981,used: 0:28:59.843946,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_13_25_00_seed_0_21546988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9452269, 'precision': 0.9634561, 'recall': 0.71330863, 'specificity': 0.71330863, 'f1': 0.78321075, 'auroc': 0.9503613, 'binary_precision': 0.98331594, 'binary_recall': 0.42737368, 'binary_specificity': 0.9992436, 'binary_f1_score': 0.5957985}
confusion matrix:
       0     1
0  42275    32
1   2527  1886
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.56593215, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9574944, 'precision': 0.47913003, 'recall': 0.49958313, 'specificity': 0.49958313, 'f1': 0.48914286, 'auroc': 0.6228983, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5992  5
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546988_3.png
early stop counter: 2
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 3,now: 2024-06-22 14:08:22.505005,epoch time: 0:14:21.975781,used: 0:43:21.819727,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_13_25_00_seed_0_21546988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9576841, 'precision': 0.9495714, 'recall': 0.79279387, 'specificity': 0.79279387, 'f1': 0.8508854, 'auroc': 0.96511936, 'binary_precision': 0.94036865, 'binary_recall': 0.58948797, 'binary_specificity': 0.9960998, 'binary_f1_score': 0.72469014}
confusion matrix:
       0     1
0  42141   165
1   1812  2602
---- Validation: 
scalar performance:
{'acc': 0.96557045, 'precision': 0.6974716, 'recall': 0.50889045, 'specificity': 0.50889045, 'f1': 0.5091199, 'auroc': 0.6609937, 'binary_precision': 0.42857143, 'binary_recall': 0.01866252, 'binary_specificity': 0.9991184, 'binary_f1_score': 0.03576751}
confusion matrix:
       0   1
0  18133  16
1    631  12
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95717484, 'precision': 0.65362436, 'recall': 0.51407504, 'specificity': 0.51407504, 'f1': 0.5172141, 'auroc': 0.7337922, 'binary_precision': 0.3478261, 'binary_recall': 0.03065134, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.056338027}
confusion matrix:
      0   1
0  5982  15
1   253   8
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546988_4.png
early stop counter: 3
val acc:0.9655704498291016, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 4,now: 2024-06-22 14:22:08.134457,epoch time: 0:13:45.629452,used: 0:57:07.449179,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_13_25_00_seed_0_21546988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9634632, 'precision': 0.95935035, 'recall': 0.8202944, 'specificity': 0.8202944, 'f1': 0.874572, 'auroc': 0.9672437, 'binary_precision': 0.9546371, 'binary_recall': 0.64377975, 'binary_specificity': 0.99680907, 'binary_f1_score': 0.768981}
confusion matrix:
       0     1
0  42172   135
1   1572  2841
---- Validation: 
scalar performance:
{'acc': 0.96557045, 'precision': 0.7083351, 'recall': 0.5133908, 'specificity': 0.5133908, 'f1': 0.51758766, 'auroc': 0.66414857, 'binary_precision': 0.45, 'binary_recall': 0.02799378, 'binary_specificity': 0.9987878, 'binary_f1_score': 0.05270864}
confusion matrix:
       0   1
0  18127  22
1    625  18
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95733464, 'precision': 0.68000966, 'recall': 0.5214878, 'specificity': 0.5214878, 'f1': 0.5303168, 'auroc': 0.72979146, 'binary_precision': 0.4, 'binary_recall': 0.04597701, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.082474224}
confusion matrix:
      0   1
0  5979  18
1   249  12
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546988_5.png
early stop counter: 4
val acc:0.9655704498291016, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 5,now: 2024-06-22 14:35:53.025273,epoch time: 0:13:44.890816,used: 1:10:52.339995,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_13_25_00_seed_0_21546988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9716182, 'precision': 0.96329015, 'recall': 0.8657365, 'specificity': 0.8657365, 'f1': 0.90738773, 'auroc': 0.97627705, 'binary_precision': 0.95354307, 'binary_recall': 0.73520744, 'binary_specificity': 0.9962656, 'binary_f1_score': 0.8302611}
confusion matrix:
       0     1
0  42151   158
1   1168  3243
---- Validation: 
scalar performance:
{'acc': 0.9656237, 'precision': 0.7265092, 'recall': 0.53592, 'specificity': 0.53592, 'f1': 0.55592287, 'auroc': 0.69994956, 'binary_precision': 0.4848485, 'binary_recall': 0.07465008, 'binary_specificity': 0.99718994, 'binary_f1_score': 0.12938006}
confusion matrix:
       0   1
0  18098  51
1    595  48
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.7410728, 'recall': 0.54780746, 'specificity': 0.54780746, 'f1': 0.5729909, 'auroc': 0.75254977, 'binary_precision': 0.52, 'binary_recall': 0.099616855, 'binary_specificity': 0.995998, 'binary_f1_score': 0.16720255}
confusion matrix:
      0   1
0  5973  24
1   235  26
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546988_6.png
new oracle model saved
early stop counter: 5
val acc:0.965623676776886, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9586129784584045
after epoch: 6,now: 2024-06-22 14:49:36.911950,epoch time: 0:13:43.886677,used: 1:24:36.226672,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_13_25_00_seed_0_21546988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97433645, 'precision': 0.9691696, 'recall': 0.87711376, 'specificity': 0.87711376, 'f1': 0.9169241, 'auroc': 0.9793366, 'binary_precision': 0.96310174, 'binary_recall': 0.75725293, 'binary_specificity': 0.9969746, 'binary_f1_score': 0.84786195}
confusion matrix:
       0     1
0  42180   128
1   1071  3341
---- Validation: 
scalar performance:
{'acc': 0.9664219, 'precision': 0.7544575, 'recall': 0.5625852, 'specificity': 0.5625852, 'f1': 0.5955641, 'auroc': 0.696735, 'binary_precision': 0.53896105, 'binary_recall': 0.12908243, 'binary_specificity': 0.99608797, 'binary_f1_score': 0.20828106}
confusion matrix:
       0   1
0  18078  71
1    560  83
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589326, 'precision': 0.7469021, 'recall': 0.56446517, 'specificity': 0.56446517, 'f1': 0.59649134, 'auroc': 0.746961, 'binary_precision': 0.530303, 'binary_recall': 0.13409962, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.21406728}
confusion matrix:
      0   1
0  5966  31
1   226  35
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546988_7.png
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-06-22 15:03:21.978296,epoch time: 0:13:45.066346,used: 1:38:21.293018,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_13_25_00_seed_0_21546988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97746146, 'precision': 0.97310495, 'recall': 0.89233994, 'specificity': 0.89233994, 'f1': 0.9280335, 'auroc': 0.982549, 'binary_precision': 0.9679577, 'binary_recall': 0.787398, 'binary_specificity': 0.99728185, 'binary_f1_score': 0.8683915}
confusion matrix:
       0     1
0  42193   115
1    938  3474
---- Validation: 
scalar performance:
{'acc': 0.96647507, 'precision': 0.7527868, 'recall': 0.5753637, 'specificity': 0.5753637, 'f1': 0.6119114, 'auroc': 0.70838916, 'binary_precision': 0.53475934, 'binary_recall': 0.15552099, 'binary_specificity': 0.99520636, 'binary_f1_score': 0.24096385}
confusion matrix:
       0    1
0  18062   87
1    543  100
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959412, 'precision': 0.7573465, 'recall': 0.5702123, 'specificity': 0.5702123, 'f1': 0.6047297, 'auroc': 0.75591147, 'binary_precision': 0.5507246, 'binary_recall': 0.14559387, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.23030302}
confusion matrix:
      0   1
0  5966  31
1   223  38
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546988_8.png
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-06-22 15:17:12.529207,epoch time: 0:13:50.550911,used: 1:52:11.843929,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_13_25_00_seed_0_21546988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.97846746, 'precision': 0.9739675, 'recall': 0.89758766, 'specificity': 0.89758766, 'f1': 0.9316095, 'auroc': 0.9847341, 'binary_precision': 0.96863824, 'binary_recall': 0.7978699, 'binary_specificity': 0.9973054, 'binary_f1_score': 0.875}
confusion matrix:
       0     1
0  42193   114
1    892  3521
---- Validation: 
scalar performance:
{'acc': 0.96695405, 'precision': 0.76115054, 'recall': 0.5906127, 'specificity': 0.5906127, 'f1': 0.63091767, 'auroc': 0.7537699, 'binary_precision': 0.5504587, 'binary_recall': 0.1866252, 'binary_specificity': 0.99460024, 'binary_f1_score': 0.27874565}
confusion matrix:
       0    1
0  18051   98
1    523  120
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96244806, 'precision': 0.80576634, 'recall': 0.60844314, 'specificity': 0.60844314, 'f1': 0.6555833, 'auroc': 0.7983724, 'binary_precision': 0.64444447, 'binary_recall': 0.22222222, 'binary_specificity': 0.994664, 'binary_f1_score': 0.33048436}
confusion matrix:
      0   1
0  5965  32
1   203  58
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546988_9.png
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-06-22 15:31:06.816167,epoch time: 0:13:54.286960,used: 2:06:06.130889,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_13_25_00_seed_0_21546988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9794521, 'precision': 0.98056006, 'recall': 0.89787275, 'specificity': 0.89787275, 'f1': 0.934382, 'auroc': 0.9853272, 'binary_precision': 0.9818689, 'binary_recall': 0.797282, 'binary_specificity': 0.9984635, 'binary_f1_score': 0.88}
confusion matrix:
       0     1
0  42240    65
1    895  3520
---- Validation: 
scalar performance:
{'acc': 0.9668476, 'precision': 0.7634772, 'recall': 0.57480645, 'specificity': 0.57480645, 'f1': 0.61211145, 'auroc': 0.7277346, 'binary_precision': 0.55617976, 'binary_recall': 0.15396579, 'binary_specificity': 0.99564713, 'binary_f1_score': 0.2411693}
confusion matrix:
       0   1
0  18070  79
1    544  99
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606903, 'precision': 0.7801516, 'recall': 0.58737034, 'specificity': 0.58737034, 'f1': 0.6281334, 'auroc': 0.7640907, 'binary_precision': 0.5949367, 'binary_recall': 0.18007663, 'binary_specificity': 0.994664, 'binary_f1_score': 0.2764706}
confusion matrix:
      0   1
0  5965  32
1   214  47
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546988_10.png
early stop counter: 1
val acc:0.9668475985527039, best validation acc: 0.9669540524482727, corresponding to test acc:                         0.9624480605125427 / 0.9624480605125427
after epoch: 10,now: 2024-06-22 15:45:13.886021,epoch time: 0:14:07.069854,used: 2:20:13.200743,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_13_25_00_seed_0_21546988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9818493, 'precision': 0.9749695, 'recall': 0.9168086, 'specificity': 0.9168086, 'f1': 0.9435176, 'auroc': 0.9873062, 'binary_precision': 0.9667452, 'binary_recall': 0.8366191, 'binary_specificity': 0.99699813, 'binary_f1_score': 0.8969874}
confusion matrix:
       0     1
0  42180   127
1    721  3692
---- Validation: 
scalar performance:
{'acc': 0.9661558, 'precision': 0.74273086, 'recall': 0.60895085, 'specificity': 0.60895085, 'f1': 0.6479127, 'auroc': 0.76583016, 'binary_precision': 0.5123675, 'binary_recall': 0.22550544, 'binary_specificity': 0.9923963, 'binary_f1_score': 0.31317493}
confusion matrix:
       0    1
0  18011  138
1    498  145
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96244806, 'precision': 0.79339474, 'recall': 0.62676644, 'specificity': 0.62676644, 'f1': 0.67361367, 'auroc': 0.800436, 'binary_precision': 0.6181818, 'binary_recall': 0.2605364, 'binary_specificity': 0.9929965, 'binary_f1_score': 0.36657682}
confusion matrix:
      0   1
0  5955  42
1   193  68
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546988_11.png
early stop counter: 2
val acc:0.9661558270454407, best validation acc: 0.9669540524482727, corresponding to test acc:                         0.9624480605125427 / 0.9624480605125427
after epoch: 11,now: 2024-06-22 15:59:31.157361,epoch time: 0:14:17.271340,used: 2:34:30.472083,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_13_25_00_seed_0_21546988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9816353, 'precision': 0.9789054, 'recall': 0.91204184, 'specificity': 0.91204184, 'f1': 0.9423449, 'auroc': 0.9878681, 'binary_precision': 0.97565544, 'binary_recall': 0.8262347, 'binary_specificity': 0.997849, 'binary_f1_score': 0.89474976}
confusion matrix:
       0     1
0  42215    91
1    767  3647
---- Validation: 
scalar performance:
{'acc': 0.9667944, 'precision': 0.75451446, 'recall': 0.6062812, 'specificity': 0.6062812, 'f1': 0.6471227, 'auroc': 0.7460035, 'binary_precision': 0.53612167, 'binary_recall': 0.21928461, 'binary_specificity': 0.99327785, 'binary_f1_score': 0.3112583}
confusion matrix:
       0    1
0  18027  122
1    502  141
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606903, 'precision': 0.77434486, 'recall': 0.5983643, 'specificity': 0.5983643, 'f1': 0.6404564, 'auroc': 0.7879684, 'binary_precision': 0.5824176, 'binary_recall': 0.20306513, 'binary_specificity': 0.9936635, 'binary_f1_score': 0.30113634}
confusion matrix:
      0   1
0  5959  38
1   208  53
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546988_12.png
early stop counter: 3
val acc:0.9667943716049194, best validation acc: 0.9669540524482727, corresponding to test acc:                         0.9624480605125427 / 0.9624480605125427
after epoch: 12,now: 2024-06-22 16:13:53.666342,epoch time: 0:14:22.508981,used: 2:48:52.981064,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_13_25_00_seed_0_21546988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9825985, 'precision': 0.97410846, 'recall': 0.9221107, 'specificity': 0.9221107, 'f1': 0.9462204, 'auroc': 0.9876118, 'binary_precision': 0.96392685, 'binary_recall': 0.8475306, 'binary_specificity': 0.99669075, 'binary_f1_score': 0.9019892}
confusion matrix:
       0     1
0  42166   140
1    673  3741
---- Validation: 
scalar performance:
{'acc': 0.96647507, 'precision': 0.7473957, 'recall': 0.6226171, 'specificity': 0.6226171, 'f1': 0.6619021, 'auroc': 0.7565237, 'binary_precision': 0.5207668, 'binary_recall': 0.2534992, 'binary_specificity': 0.9917351, 'binary_f1_score': 0.3410042}
confusion matrix:
       0    1
0  17999  150
1    480  163
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.76668274, 'recall': 0.6111073, 'specificity': 0.6111073, 'f1': 0.65332234, 'auroc': 0.78465164, 'binary_precision': 0.5660377, 'binary_recall': 0.22988506, 'binary_specificity': 0.9923295, 'binary_f1_score': 0.3269755}
confusion matrix:
      0   1
0  5951  46
1   201  60
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546988_13.png
early stop counter: 4
val acc:0.9664750695228577, best validation acc: 0.9669540524482727, corresponding to test acc:                         0.9624480605125427 / 0.9624480605125427
after epoch: 13,now: 2024-06-22 16:27:51.012450,epoch time: 0:13:57.346108,used: 3:02:50.327172,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_13_25_00_seed_0_21546988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9832406, 'precision': 0.9814886, 'recall': 0.91920054, 'specificity': 0.91920054, 'f1': 0.9476574, 'auroc': 0.9897651, 'binary_precision': 0.9793978, 'binary_recall': 0.8402447, 'binary_specificity': 0.9981563, 'binary_f1_score': 0.9045005}
confusion matrix:
       0     1
0  42229    78
1    705  3708
---- Validation: 
scalar performance:
{'acc': 0.96706045, 'precision': 0.7605234, 'recall': 0.6026687, 'specificity': 0.6026687, 'f1': 0.64420265, 'auroc': 0.7759697, 'binary_precision': 0.5483871, 'binary_recall': 0.21150856, 'binary_specificity': 0.99382883, 'binary_f1_score': 0.30527496}
confusion matrix:
       0    1
0  18037  112
1    507  136
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.8076912, 'recall': 0.62343526, 'specificity': 0.62343526, 'f1': 0.67231435, 'auroc': 0.80407685, 'binary_precision': 0.64705884, 'binary_recall': 0.25287357, 'binary_specificity': 0.993997, 'binary_f1_score': 0.36363637}
confusion matrix:
      0   1
0  5961  36
1   195  66
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546988_14.png
new oracle model saved
better model found
persisted
after epoch: 14,now: 2024-06-22 16:41:22.184442,epoch time: 0:13:31.171992,used: 3:16:21.499164,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_13_25_00_seed_0_21546988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.983262, 'precision': 0.98070157, 'recall': 0.9200421, 'specificity': 0.9200421, 'f1': 0.94782203, 'auroc': 0.988575, 'binary_precision': 0.9776434, 'binary_recall': 0.84209335, 'binary_specificity': 0.99799085, 'binary_f1_score': 0.9048199}
confusion matrix:
       0     1
0  42221    85
1    697  3717
---- Validation: 
scalar performance:
{'acc': 0.9669008, 'precision': 0.75798446, 'recall': 0.59883577, 'specificity': 0.59883577, 'f1': 0.6397159, 'auroc': 0.77268815, 'binary_precision': 0.5435685, 'binary_recall': 0.2037325, 'binary_specificity': 0.99393904, 'binary_f1_score': 0.2963801}
confusion matrix:
       0    1
0  18039  110
1    512  131
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9643656, 'precision': 0.8373673, 'recall': 0.6222699, 'specificity': 0.6222699, 'f1': 0.67496884, 'auroc': 0.8087543, 'binary_precision': 0.70652175, 'binary_recall': 0.24904214, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.36827195}
confusion matrix:
      0   1
0  5970  27
1   196  65
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546988_15.png
new oracle model saved
early stop counter: 1
val acc:0.9669008255004883, best validation acc: 0.9670604467391968, corresponding to test acc:                         0.963087260723114 / 0.9643656015396118
after epoch: 15,now: 2024-06-22 16:55:33.979875,epoch time: 0:14:11.795433,used: 3:30:33.294597,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_13_25_00_seed_0_21546988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9840325, 'precision': 0.9753983, 'recall': 0.92949724, 'specificity': 0.92949724, 'f1': 0.9509881, 'auroc': 0.98843575, 'binary_precision': 0.96501017, 'binary_recall': 0.86225647, 'binary_specificity': 0.9967381, 'binary_f1_score': 0.9107442}
confusion matrix:
       0     1
0  42168   138
1    608  3806
---- Validation: 
scalar performance:
{'acc': 0.9662622, 'precision': 0.74394286, 'recall': 0.6300075, 'specificity': 0.6300075, 'f1': 0.6678704, 'auroc': 0.7946378, 'binary_precision': 0.5133531, 'binary_recall': 0.2690513, 'binary_specificity': 0.9909637, 'binary_f1_score': 0.3530612}
confusion matrix:
       0    1
0  17985  164
1    470  173
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96260786, 'precision': 0.7897191, 'recall': 0.63967615, 'specificity': 0.63967615, 'f1': 0.6856686, 'auroc': 0.81313777, 'binary_precision': 0.6097561, 'binary_recall': 0.28735632, 'binary_specificity': 0.991996, 'binary_f1_score': 0.390625}
confusion matrix:
      0   1
0  5949  48
1   186  75
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546988_16.png
early stop counter: 2
val acc:0.9662622213363647, best validation acc: 0.9670604467391968, corresponding to test acc:                         0.963087260723114 / 0.9643656015396118
after epoch: 16,now: 2024-06-22 17:09:18.651909,epoch time: 0:13:44.672034,used: 3:44:17.966631,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_13_25_00_seed_0_21546988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9833476, 'precision': 0.9758507, 'recall': 0.92492604, 'specificity': 0.92492604, 'f1': 0.948586, 'auroc': 0.9901501, 'binary_precision': 0.9668551, 'binary_recall': 0.85290116, 'binary_specificity': 0.9969509, 'binary_f1_score': 0.90631026}
confusion matrix:
       0     1
0  42179   129
1    649  3763
---- Validation: 
scalar performance:
{'acc': 0.9665815, 'precision': 0.74902016, 'recall': 0.6234223, 'specificity': 0.6234223, 'f1': 0.66297543, 'auroc': 0.77105784, 'binary_precision': 0.52396166, 'binary_recall': 0.25505444, 'binary_specificity': 0.9917902, 'binary_f1_score': 0.34309626}
confusion matrix:
       0    1
0  18000  149
1    479  164
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96324706, 'precision': 0.80556995, 'recall': 0.630848, 'specificity': 0.630848, 'f1': 0.67972106, 'auroc': 0.79163575, 'binary_precision': 0.64220184, 'binary_recall': 0.26819924, 'binary_specificity': 0.9934968, 'binary_f1_score': 0.37837836}
confusion matrix:
      0   1
0  5958  39
1   191  70
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546988_17.png
early stop counter: 3
val acc:0.9665815234184265, best validation acc: 0.9670604467391968, corresponding to test acc:                         0.963087260723114 / 0.9643656015396118
after epoch: 17,now: 2024-06-22 17:23:16.824375,epoch time: 0:13:58.172466,used: 3:58:16.139097,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_13_25_00_seed_0_21546988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9848459, 'precision': 0.97844684, 'recall': 0.93140745, 'specificity': 0.93140745, 'f1': 0.9534042, 'auroc': 0.9906491, 'binary_precision': 0.9707528, 'binary_recall': 0.8655329, 'binary_specificity': 0.99728197, 'binary_f1_score': 0.9151283}
confusion matrix:
       0     1
0  42195   115
1    593  3817
---- Validation: 
scalar performance:
{'acc': 0.96647507, 'precision': 0.7476558, 'recall': 0.6181168, 'specificity': 0.6181168, 'f1': 0.6577164, 'auroc': 0.7796327, 'binary_precision': 0.5215947, 'binary_recall': 0.24416797, 'binary_specificity': 0.99206567, 'binary_f1_score': 0.33262712}
confusion matrix:
       0    1
0  18005  144
1    486  157
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96340686, 'precision': 0.8126744, 'recall': 0.6254344, 'specificity': 0.6254344, 'f1': 0.67515147, 'auroc': 0.8036338, 'binary_precision': 0.65686274, 'binary_recall': 0.256705, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.36914602}
confusion matrix:
      0   1
0  5962  35
1   194  67
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546988_18.png
early stop counter: 4
val acc:0.9664750695228577, best validation acc: 0.9670604467391968, corresponding to test acc:                         0.963087260723114 / 0.9643656015396118
after epoch: 18,now: 2024-06-22 17:37:12.174381,epoch time: 0:13:55.350006,used: 4:12:11.489103,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_13_25_00_seed_0_21546988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.98529536, 'precision': 0.97570103, 'recall': 0.9367615, 'specificity': 0.9367615, 'f1': 0.955188, 'auroc': 0.9915944, 'binary_precision': 0.96411663, 'binary_recall': 0.87692654, 'binary_specificity': 0.9965964, 'binary_f1_score': 0.9184569}
confusion matrix:
       0     1
0  42164   144
1    543  3869
---- Validation: 
scalar performance:
{'acc': 0.96631545, 'precision': 0.74516875, 'recall': 0.615784, 'specificity': 0.615784, 'f1': 0.6550183, 'auroc': 0.7869566, 'binary_precision': 0.5167785, 'binary_recall': 0.23950233, 'binary_specificity': 0.99206567, 'binary_f1_score': 0.32731137}
confusion matrix:
       0    1
0  18005  144
1    489  154
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.7973485, 'recall': 0.6399263, 'specificity': 0.6399263, 'f1': 0.6873325, 'auroc': 0.80679995, 'binary_precision': 0.625, 'binary_recall': 0.28735632, 'binary_specificity': 0.99249625, 'binary_f1_score': 0.3937008}
confusion matrix:
      0   1
0  5952  45
1   186  75
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546988_19.png
early stop counter: 5
val acc:0.9663154482841492, best validation acc: 0.9670604467391968, corresponding to test acc:                         0.963087260723114 / 0.9643656015396118
after epoch: 19,now: 2024-06-22 17:51:22.935941,epoch time: 0:14:10.761560,used: 4:26:22.250663,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_13_25_00_seed_0_21546988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9851242, 'precision': 0.97411215, 'recall': 0.93724847, 'specificity': 0.93724847, 'f1': 0.9547436, 'auroc': 0.99184144, 'binary_precision': 0.96080375, 'binary_recall': 0.8782313, 'binary_specificity': 0.99626565, 'binary_f1_score': 0.9176638}
confusion matrix:
       0     1
0  42152   158
1    537  3873
---- Validation: 
scalar performance:
{'acc': 0.96663475, 'precision': 0.74866366, 'recall': 0.6437013, 'specificity': 0.6437013, 'f1': 0.6807249, 'auroc': 0.7900105, 'binary_precision': 0.5218579, 'binary_recall': 0.2970451, 'binary_specificity': 0.9903576, 'binary_f1_score': 0.3785927}
confusion matrix:
       0    1
0  17974  175
1    452  191
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9651646, 'precision': 0.82029235, 'recall': 0.6593335, 'specificity': 0.6593335, 'f1': 0.7100847, 'auroc': 0.81161684, 'binary_precision': 0.6692913, 'binary_recall': 0.3256705, 'binary_specificity': 0.9929965, 'binary_f1_score': 0.43814433}
confusion matrix:
      0   1
0  5955  42
1   176  85
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546988_20.png
new oracle model saved
early stop counter: 6
val acc:0.9666347503662109, best validation acc: 0.9670604467391968, corresponding to test acc:                         0.963087260723114 / 0.9651646018028259
after epoch: 20,now: 2024-06-22 18:05:42.872754,epoch time: 0:14:19.936813,used: 4:40:42.187476,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_13_25_00_seed_0_21546988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9848887, 'precision': 0.97353405, 'recall': 0.93644935, 'specificity': 0.93644935, 'f1': 0.954042, 'auroc': 0.990924, 'binary_precision': 0.95981145, 'binary_recall': 0.8767279, 'binary_specificity': 0.9961708, 'binary_f1_score': 0.91639036}
confusion matrix:
       0     1
0  42145   162
1    544  3869
---- Validation: 
scalar performance:
{'acc': 0.96557045, 'precision': 0.73469037, 'recall': 0.63489974, 'specificity': 0.63489974, 'f1': 0.6699045, 'auroc': 0.7871687, 'binary_precision': 0.4945055, 'binary_recall': 0.2799378, 'binary_specificity': 0.9898617, 'binary_f1_score': 0.35749757}
confusion matrix:
       0    1
0  17965  184
1    463  180
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642058, 'precision': 0.80718434, 'recall': 0.65516853, 'specificity': 0.65516853, 'f1': 0.70358413, 'auroc': 0.8087602, 'binary_precision': 0.64341086, 'binary_recall': 0.31800765, 'binary_specificity': 0.9923295, 'binary_f1_score': 0.425641}
confusion matrix:
      0   1
0  5951  46
1   178  83
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546988_21.png
early stop counter: 7
val acc:0.9655704498291016, best validation acc: 0.9670604467391968, corresponding to test acc:                         0.963087260723114 / 0.9651646018028259
after epoch: 21,now: 2024-06-22 18:20:35.987478,epoch time: 0:14:53.114724,used: 4:55:35.302200,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_13_25_00_seed_0_21546988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9864298, 'precision': 0.9791615, 'recall': 0.9402565, 'specificity': 0.9402565, 'f1': 0.9586761, 'auroc': 0.99302423, 'binary_precision': 0.9703833, 'binary_recall': 0.88332576, 'binary_specificity': 0.99718714, 'binary_f1_score': 0.9248103}
confusion matrix:
       0     1
0  42187   119
1    515  3899
---- Validation: 
scalar performance:
{'acc': 0.9670072, 'precision': 0.7551631, 'recall': 0.62964314, 'specificity': 0.62964314, 'f1': 0.6699579, 'auroc': 0.78558815, 'binary_precision': 0.53582555, 'binary_recall': 0.2674961, 'binary_specificity': 0.9917902, 'binary_f1_score': 0.35684645}
confusion matrix:
       0    1
0  18000  149
1    471  172
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650048, 'precision': 0.8272127, 'recall': 0.64642376, 'specificity': 0.64642376, 'f1': 0.698981, 'auroc': 0.81263, 'binary_precision': 0.68421054, 'binary_recall': 0.29885057, 'binary_specificity': 0.993997, 'binary_f1_score': 0.416}
confusion matrix:
      0   1
0  5961  36
1   183  78
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546988_22.png
early stop counter: 8
val acc:0.9670072197914124, best validation acc: 0.9670604467391968, corresponding to test acc:                         0.963087260723114 / 0.9651646018028259
after epoch: 22,now: 2024-06-22 18:34:59.335126,epoch time: 0:14:23.347648,used: 5:09:58.649848,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_13_25_00_seed_0_21546988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.98600173, 'precision': 0.9788597, 'recall': 0.9380046, 'specificity': 0.9380046, 'f1': 0.9572903, 'auroc': 0.99186766, 'binary_precision': 0.97024256, 'binary_recall': 0.8788222, 'binary_specificity': 0.9971871, 'binary_f1_score': 0.9222724}
confusion matrix:
       0     1
0  42186   119
1    535  3880
---- Validation: 
scalar performance:
{'acc': 0.9663687, 'precision': 0.7455747, 'recall': 0.6270624, 'specificity': 0.6270624, 'f1': 0.6655962, 'auroc': 0.7924828, 'binary_precision': 0.5168196, 'binary_recall': 0.2628305, 'binary_specificity': 0.99129426, 'binary_f1_score': 0.3484536}
confusion matrix:
       0    1
0  17991  158
1    474  169
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645254, 'precision': 0.8184335, 'recall': 0.64617366, 'specificity': 0.64617366, 'f1': 0.69720435, 'auroc': 0.8128841, 'binary_precision': 0.6666667, 'binary_recall': 0.29885057, 'binary_specificity': 0.9934968, 'binary_f1_score': 0.4126984}
confusion matrix:
      0   1
0  5958  39
1   183  78
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546988_23.png
early stop counter: 9
val acc:0.9663686752319336, best validation acc: 0.9670604467391968, corresponding to test acc:                         0.963087260723114 / 0.9651646018028259
after epoch: 23,now: 2024-06-22 18:49:22.868888,epoch time: 0:14:23.533762,used: 5:24:22.183610,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_13_25_00_seed_0_21546988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.98634416, 'precision': 0.9809154, 'recall': 0.9380786, 'specificity': 0.9380786, 'f1': 0.95824575, 'auroc': 0.9913869, 'binary_precision': 0.97437185, 'binary_recall': 0.8785682, 'binary_specificity': 0.997589, 'binary_f1_score': 0.9239933}
confusion matrix:
       0     1
0  42204   102
1    536  3878
---- Validation: 
scalar performance:
{'acc': 0.966688, 'precision': 0.7515417, 'recall': 0.61447674, 'specificity': 0.61447674, 'f1': 0.65490156, 'auroc': 0.7874652, 'binary_precision': 0.5296167, 'binary_recall': 0.23639192, 'binary_specificity': 0.9925616, 'binary_f1_score': 0.32688174}
confusion matrix:
       0    1
0  18014  135
1    491  152
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964845, 'precision': 0.8444811, 'recall': 0.6261847, 'specificity': 0.6261847, 'f1': 0.68022096, 'auroc': 0.8055008, 'binary_precision': 0.72043014, 'binary_recall': 0.256705, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.3785311}
confusion matrix:
      0   1
0  5971  26
1   194  67
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546988_24.png
early stop counter: 10
val acc:0.9666879773139954, best validation acc: 0.9670604467391968, corresponding to test acc:                         0.963087260723114 / 0.9651646018028259
after epoch: 24,now: 2024-06-22 19:03:39.840663,epoch time: 0:14:16.971775,used: 5:38:39.155385,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_13_25_00_seed_0_21546988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9865154, 'precision': 0.9765264, 'recall': 0.94337225, 'specificity': 0.94337225, 'f1': 0.9591981, 'auroc': 0.9926391, 'binary_precision': 0.9644259, 'binary_recall': 0.8901721, 'binary_specificity': 0.99657243, 'binary_f1_score': 0.92581254}
confusion matrix:
       0     1
0  42159   145
1    485  3931
---- Validation: 
scalar performance:
{'acc': 0.96599615, 'precision': 0.7402421, 'recall': 0.6343701, 'specificity': 0.6343701, 'f1': 0.670806, 'auroc': 0.81285715, 'binary_precision': 0.50564975, 'binary_recall': 0.27838257, 'binary_specificity': 0.9903576, 'binary_f1_score': 0.35907722}
confusion matrix:
       0    1
0  17974  175
1    464  179
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96324706, 'precision': 0.80208933, 'recall': 0.636345, 'specificity': 0.636345, 'f1': 0.6846761, 'auroc': 0.8225441, 'binary_precision': 0.6347826, 'binary_recall': 0.27969348, 'binary_specificity': 0.9929965, 'binary_f1_score': 0.3882979}
confusion matrix:
      0   1
0  5955  42
1   188  73
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546988_25.png
early stop counter: 11
val acc:0.9659961462020874, best validation acc: 0.9670604467391968, corresponding to test acc:                         0.963087260723114 / 0.9651646018028259
after epoch: 25,now: 2024-06-22 19:17:51.620619,epoch time: 0:14:11.779956,used: 5:52:50.935341,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_13_25_00_seed_0_21546988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.98634416, 'precision': 0.9740517, 'recall': 0.94476277, 'specificity': 0.94476277, 'f1': 0.9588196, 'auroc': 0.99246883, 'binary_precision': 0.95913404, 'binary_recall': 0.8934965, 'binary_specificity': 0.996029, 'binary_f1_score': 0.92515254}
confusion matrix:
       0     1
0  42139   168
1    470  3943
---- Validation: 
scalar performance:
{'acc': 0.96631545, 'precision': 0.74462104, 'recall': 0.6337853, 'specificity': 0.6337853, 'f1': 0.67133105, 'auroc': 0.7945075, 'binary_precision': 0.51445085, 'binary_recall': 0.27682737, 'binary_specificity': 0.9907433, 'binary_f1_score': 0.35995954}
confusion matrix:
       0    1
0  17981  168
1    465  178
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96324706, 'precision': 0.7980122, 'recall': 0.6436743, 'specificity': 0.6436743, 'f1': 0.69104177, 'auroc': 0.8203738, 'binary_precision': 0.62601626, 'binary_recall': 0.29501915, 'binary_specificity': 0.9923295, 'binary_f1_score': 0.40104166}
confusion matrix:
      0   1
0  5951  46
1   184  77
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546988_26.png
early stop counter: 12
val acc:0.9663154482841492, best validation acc: 0.9670604467391968, corresponding to test acc:                         0.963087260723114 / 0.9651646018028259
after epoch: 26,now: 2024-06-22 19:31:50.740513,epoch time: 0:13:59.119894,used: 6:06:50.055235,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_13_25_00_seed_0_21546988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9855094, 'precision': 0.9667845, 'recall': 0.94726735, 'specificity': 0.94726735, 'f1': 0.9567627, 'auroc': 0.9917928, 'binary_precision': 0.94394296, 'binary_recall': 0.9001132, 'binary_specificity': 0.9944215, 'binary_f1_score': 0.9215073}
confusion matrix:
       0     1
0  42069   236
1    441  3974
---- Validation: 
scalar performance:
{'acc': 0.96482545, 'precision': 0.7282894, 'recall': 0.660766, 'specificity': 0.660766, 'f1': 0.68801033, 'auroc': 0.81051034, 'binary_precision': 0.4799107, 'binary_recall': 0.33437014, 'binary_specificity': 0.9871618, 'binary_f1_score': 0.3941338}
confusion matrix:
       0    1
0  17916  233
1    428  215
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96260786, 'precision': 0.7811426, 'recall': 0.6634965, 'specificity': 0.6634965, 'f1': 0.7049695, 'auroc': 0.82145655, 'binary_precision': 0.590604, 'binary_recall': 0.33716476, 'binary_specificity': 0.9898282, 'binary_f1_score': 0.4292683}
confusion matrix:
      0   1
0  5936  61
1   173  88
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546988_27.png
early stop counter: 13
val acc:0.964825451374054, best validation acc: 0.9670604467391968, corresponding to test acc:                         0.963087260723114 / 0.9651646018028259
after epoch: 27,now: 2024-06-22 19:45:46.264855,epoch time: 0:13:55.524342,used: 6:20:45.579577,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_13_25_00_seed_0_21546988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.987607, 'precision': 0.98115385, 'recall': 0.9453827, 'specificity': 0.9453827, 'f1': 0.9624015, 'auroc': 0.99310744, 'binary_precision': 0.9733465, 'binary_recall': 0.89331824, 'binary_specificity': 0.99744713, 'binary_f1_score': 0.9316169}
confusion matrix:
       0     1
0  42197   108
1    471  3944
---- Validation: 
scalar performance:
{'acc': 0.9664219, 'precision': 0.7465657, 'recall': 0.6225896, 'specificity': 0.6225896, 'f1': 0.6617101, 'auroc': 0.80180466, 'binary_precision': 0.5191083, 'binary_recall': 0.2534992, 'binary_specificity': 0.99167997, 'binary_f1_score': 0.34064785}
confusion matrix:
       0    1
0  17998  151
1    480  163
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964046, 'precision': 0.8165287, 'recall': 0.6367619, 'specificity': 0.6367619, 'f1': 0.68750244, 'auroc': 0.81917524, 'binary_precision': 0.6636364, 'binary_recall': 0.27969348, 'binary_specificity': 0.99383026, 'binary_f1_score': 0.39353102}
confusion matrix:
      0   1
0  5960  37
1   188  73
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546988_28.png
early stop counter: 14
val acc:0.966421902179718, best validation acc: 0.9670604467391968, corresponding to test acc:                         0.963087260723114 / 0.9651646018028259
after epoch: 28,now: 2024-06-22 19:59:32.117456,epoch time: 0:13:45.852601,used: 6:34:31.432178,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_13_25_00_seed_0_21546988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.98707193, 'precision': 0.97433126, 'recall': 0.9489527, 'specificity': 0.9489527, 'f1': 0.9612024, 'auroc': 0.992841, 'binary_precision': 0.9588349, 'binary_recall': 0.90194744, 'binary_specificity': 0.99595785, 'binary_f1_score': 0.92952156}
confusion matrix:
       0     1
0  42133   171
1    433  3983
---- Validation: 
scalar performance:
{'acc': 0.9650915, 'precision': 0.7293517, 'recall': 0.6414023, 'specificity': 0.6414023, 'f1': 0.6738113, 'auroc': 0.809112, 'binary_precision': 0.48337597, 'binary_recall': 0.29393467, 'binary_specificity': 0.9888699, 'binary_f1_score': 0.36557063}
confusion matrix:
       0    1
0  17947  202
1    454  189
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9654842, 'precision': 0.8230145, 'recall': 0.6631649, 'specificity': 0.6631649, 'f1': 0.71417046, 'auroc': 0.8234523, 'binary_precision': 0.6744186, 'binary_recall': 0.33333334, 'binary_specificity': 0.9929965, 'binary_f1_score': 0.44615388}
confusion matrix:
      0   1
0  5955  42
1   174  87
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546988_29.png
new oracle model saved
early stop counter: 15
val acc:0.9650915265083313, best validation acc: 0.9670604467391968, corresponding to test acc:                         0.963087260723114 / 0.9654842019081116
after epoch: 29,now: 2024-06-22 20:13:09.063844,epoch time: 0:13:36.946388,used: 6:48:08.378566,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_13_25_00_seed_0_21546988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.98764986, 'precision': 0.9767567, 'recall': 0.9499598, 'specificity': 0.9499598, 'f1': 0.9628705, 'auroc': 0.99329853, 'binary_precision': 0.9635178, 'binary_recall': 0.9034889, 'binary_specificity': 0.99643075, 'binary_f1_score': 0.93253833}
confusion matrix:
       0     1
0  42155   151
1    426  3988
---- Validation: 
scalar performance:
{'acc': 0.9665815, 'precision': 0.7483578, 'recall': 0.6346731, 'specificity': 0.6346731, 'f1': 0.67296183, 'auroc': 0.79567116, 'binary_precision': 0.5218659, 'binary_recall': 0.27838257, 'binary_specificity': 0.9909637, 'binary_f1_score': 0.36308312}
confusion matrix:
       0    1
0  17985  164
1    464  179
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.79292405, 'recall': 0.64908797, 'specificity': 0.64908797, 'f1': 0.6950778, 'auroc': 0.81187004, 'binary_precision': 0.61538464, 'binary_recall': 0.3065134, 'binary_specificity': 0.9916625, 'binary_f1_score': 0.40920717}
confusion matrix:
      0   1
0  5947  50
1   181  80
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546988_30.png
early stop counter: 16
val acc:0.9665815234184265, best validation acc: 0.9670604467391968, corresponding to test acc:                         0.963087260723114 / 0.9654842019081116
after epoch: 30,now: 2024-06-22 20:26:57.067021,epoch time: 0:13:48.003177,used: 7:01:56.381743,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_13_25_00_seed_0_21546988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 7:01:56.381743 at 2024-06-22 20:26:57.067021
persisted model performance metric: 

scalar performance:
{'acc': 0.96308726, 'precision': 0.8076912, 'recall': 0.62343526, 'specificity': 0.62343526, 'f1': 0.67231435, 'auroc': 0.80407685, 'binary_precision': 0.64705884, 'binary_recall': 0.25287357, 'binary_specificity': 0.993997, 'binary_f1_score': 0.36363637}
confusion matrix:
      0   1
0  5961  36
1   195  66
oracle model performance metric: 

scalar performance:
{'acc': 0.9654842, 'precision': 0.8230145, 'recall': 0.6631649, 'specificity': 0.6631649, 'f1': 0.71417046, 'auroc': 0.8234523, 'binary_precision': 0.6744186, 'binary_recall': 0.33333334, 'binary_specificity': 0.9929965, 'binary_f1_score': 0.44615388}
confusion matrix:
      0   1
0  5955  42
1   174  87
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_resnet_differentlearningrates_bs32_classbalancing3/rule_results/3.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_resnet_differentlearningrates_bs32_classbalancing3/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_resnet_differentlearningrates_bs32_classbalancing3/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204391 KiB | 737101 KiB | 402803 GiB | 402802 GiB |
|       from large pool | 167936 KiB | 664960 KiB | 402482 GiB | 402482 GiB |
|       from small pool |  36455 KiB |  73422 KiB |    320 GiB |    320 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 204391 KiB | 737101 KiB | 402803 GiB | 402802 GiB |
|       from large pool | 167936 KiB | 664960 KiB | 402482 GiB | 402482 GiB |
|       from small pool |  36455 KiB |  73422 KiB |    320 GiB |    320 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201088 KiB | 730152 KiB | 402686 GiB | 402686 GiB |
|       from large pool | 165120 KiB | 658560 KiB | 402374 GiB | 402374 GiB |
|       from small pool |  35968 KiB |  72872 KiB |    312 GiB |    312 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    900 MiB |    900 MiB |    900 MiB |      0 B   |
|       from large pool |    828 MiB |    828 MiB |    828 MiB |      0 B   |
|       from small pool |     72 MiB |     72 MiB |     72 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 104856 KiB | 260793 KiB | 271582 GiB | 271582 GiB |
|       from large pool |  96256 KiB | 259208 KiB | 271259 GiB | 271259 GiB |
|       from small pool |   8600 KiB |  12473 KiB |    323 GiB |    323 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2076    |    3669    |   44152 K  |   44150 K  |
|       from large pool |      36    |      76    |   14817 K  |   14817 K  |
|       from small pool |    2040    |    3632    |   29334 K  |   29332 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2076    |    3669    |   44152 K  |   44150 K  |
|       from large pool |      36    |      76    |   14817 K  |   14817 K  |
|       from small pool |    2040    |    3632    |   29334 K  |   29332 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      51    |      51    |      51    |       0    |
|       from large pool |      15    |      15    |      15    |       0    |
|       from small pool |      36    |      36    |      36    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      35    |    1476    |   19448 K  |   19448 K  |
|       from large pool |       5    |      10    |    5530 K  |    5530 K  |
|       from small pool |      30    |    1471    |   13917 K  |   13917 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 737101 KiB | 402803 GiB | 402803 GiB |
|       from large pool |  16640 KiB | 664960 KiB | 402482 GiB | 402482 GiB |
|       from small pool |      0 KiB |  73422 KiB |    320 GiB |    320 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 737101 KiB | 402803 GiB | 402803 GiB |
|       from large pool |  16640 KiB | 664960 KiB | 402482 GiB | 402482 GiB |
|       from small pool |      0 KiB |  73422 KiB |    320 GiB |    320 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 730152 KiB | 402686 GiB | 402686 GiB |
|       from large pool |  16640 KiB | 658560 KiB | 402374 GiB | 402374 GiB |
|       from small pool |      0 KiB |  72872 KiB |    312 GiB |    312 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 309248 KiB |    900 MiB |    900 MiB | 612352 KiB |
|       from large pool | 264192 KiB |    828 MiB |    828 MiB | 583680 KiB |
|       from small pool |  45056 KiB |     72 MiB |     72 MiB |  28672 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  83712 KiB | 260793 KiB | 271582 GiB | 271582 GiB |
|       from large pool |  83712 KiB | 259208 KiB | 271259 GiB | 271259 GiB |
|       from small pool |      0 KiB |  16195 KiB |    323 GiB |    323 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3669    |   44152 K  |   44152 K  |
|       from large pool |       2    |      76    |   14817 K  |   14817 K  |
|       from small pool |       0    |    3632    |   29334 K  |   29334 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3669    |   44152 K  |   44152 K  |
|       from large pool |       2    |      76    |   14817 K  |   14817 K  |
|       from small pool |       0    |    3632    |   29334 K  |   29334 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      51    |      51    |      20    |
|       from large pool |       9    |      15    |      15    |       6    |
|       from small pool |      22    |      36    |      36    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |    1476    |   19449 K  |   19449 K  |
|       from large pool |       1    |      11    |    5530 K  |    5530 K  |
|       from small pool |       0    |    1471    |   13918 K  |   13918 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 737101 KiB | 402803 GiB | 402803 GiB |
|       from large pool |  16640 KiB | 664960 KiB | 402482 GiB | 402482 GiB |
|       from small pool |      0 KiB |  73422 KiB |    320 GiB |    320 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 737101 KiB | 402803 GiB | 402803 GiB |
|       from large pool |  16640 KiB | 664960 KiB | 402482 GiB | 402482 GiB |
|       from small pool |      0 KiB |  73422 KiB |    320 GiB |    320 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 730152 KiB | 402686 GiB | 402686 GiB |
|       from large pool |  16640 KiB | 658560 KiB | 402374 GiB | 402374 GiB |
|       from small pool |      0 KiB |  72872 KiB |    312 GiB |    312 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 309248 KiB |    900 MiB |    900 MiB | 612352 KiB |
|       from large pool | 264192 KiB |    828 MiB |    828 MiB | 583680 KiB |
|       from small pool |  45056 KiB |     72 MiB |     72 MiB |  28672 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  83712 KiB | 260793 KiB | 271582 GiB | 271582 GiB |
|       from large pool |  83712 KiB | 259208 KiB | 271259 GiB | 271259 GiB |
|       from small pool |      0 KiB |  16195 KiB |    323 GiB |    323 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3669    |   44152 K  |   44152 K  |
|       from large pool |       2    |      76    |   14817 K  |   14817 K  |
|       from small pool |       0    |    3632    |   29334 K  |   29334 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3669    |   44152 K  |   44152 K  |
|       from large pool |       2    |      76    |   14817 K  |   14817 K  |
|       from small pool |       0    |    3632    |   29334 K  |   29334 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      51    |      51    |      20    |
|       from large pool |       9    |      15    |      15    |       6    |
|       from small pool |      22    |      36    |      36    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |    1476    |   19449 K  |   19449 K  |
|       from large pool |       1    |      11    |    5530 K  |    5530 K  |
|       from small pool |       0    |    1471    |   13918 K  |   13918 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0




!!!: not committed yet



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_20_32_10_seed_1_21546988

 Experiment start at: 2024-06-22 20:32:10.485158
before training, model accuracy: 0.1456654816865921
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.90744865, 'precision': 0.703733, 'recall': 0.50010383, 'specificity': 0.50010383, 'f1': 0.4759701, 'auroc': 0.7537579, 'binary_precision': 0.5, 'binary_recall': 0.00023126735, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.00046232087}
confusion matrix:
       0  1
0  42395  1
1   4323  1
---- Validation: 
scalar performance:
{'acc': 0.96403414, 'precision': 0.4820428, 'recall': 0.4999723, 'specificity': 0.4999723, 'f1': 0.49084386, 'auroc': 0.37137824, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9999446, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18066  1
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.285726, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546988_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-22 20:46:09.666801,epoch time: 0:13:59.181643,used: 0:13:59.181643,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_20_32_10_seed_1_21546988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9115368, 'precision': 0.80424905, 'recall': 0.5374517, 'specificity': 0.5374517, 'f1': 0.5471472, 'auroc': 0.9070955, 'binary_precision': 0.6946721, 'binary_recall': 0.07841776, 'binary_specificity': 0.9964856, 'binary_f1_score': 0.14092703}
confusion matrix:
       0    1
0  42248  149
1   3984  339
---- Validation: 
scalar performance:
{'acc': 0.963127, 'precision': 0.4820265, 'recall': 0.49950185, 'specificity': 0.49950185, 'f1': 0.4906086, 'auroc': 0.4824075, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9990037, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18049  18
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.48929888, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546988_2.png
early stop counter: 1
val acc:0.9631270170211792, best validation acc: 0.9640341401100159, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 2,now: 2024-06-22 20:59:42.195204,epoch time: 0:13:32.528403,used: 0:27:31.710046,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_20_32_10_seed_1_21546988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.94188786, 'precision': 0.91605836, 'recall': 0.7102493, 'specificity': 0.7102493, 'f1': 0.7722614, 'auroc': 0.94089305, 'binary_precision': 0.88771087, 'binary_recall': 0.42599446, 'binary_specificity': 0.9945042, 'binary_f1_score': 0.57571495}
confusion matrix:
       0     1
0  42163   233
1   2482  1842
---- Validation: 
scalar performance:
{'acc': 0.96125937, 'precision': 0.49110857, 'recall': 0.4992485, 'specificity': 0.4992485, 'f1': 0.4914966, 'auroc': 0.54147124, 'binary_precision': 0.018181818, 'binary_recall': 0.0014858841, 'binary_specificity': 0.9970111, 'binary_f1_score': 0.0027472526}
confusion matrix:
       0   1
0  18013  54
1    672   1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579439, 'precision': 0.47904915, 'recall': 0.4999159, 'specificity': 0.4999159, 'f1': 0.48926014, 'auroc': 0.5789926, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5945  1
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546988_3.png
early stop counter: 2
val acc:0.9612593650817871, best validation acc: 0.9640341401100159, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 3,now: 2024-06-22 21:13:16.375889,epoch time: 0:13:34.180685,used: 0:41:05.890731,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_20_32_10_seed_1_21546988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9495505, 'precision': 0.9262455, 'recall': 0.75277936, 'specificity': 0.75277936, 'f1': 0.81250435, 'auroc': 0.95295817, 'binary_precision': 0.90020365, 'binary_recall': 0.51133734, 'binary_specificity': 0.99422145, 'binary_f1_score': 0.652206}
confusion matrix:
       0     1
0  42153   245
1   2112  2210
---- Validation: 
scalar performance:
{'acc': 0.963127, 'precision': 0.5070513, 'recall': 0.5002171, 'specificity': 0.5002171, 'f1': 0.4920511, 'auroc': 0.5817629, 'binary_precision': 0.05, 'binary_recall': 0.0014858841, 'binary_specificity': 0.99894834, 'binary_f1_score': 0.0028860029}
confusion matrix:
       0   1
0  18048  19
1    672   1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9577828, 'precision': 0.47904578, 'recall': 0.49983183, 'specificity': 0.49983183, 'f1': 0.4892181, 'auroc': 0.64587796, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5944  2
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546988_4.png
early stop counter: 3
val acc:0.9631270170211792, best validation acc: 0.9640341401100159, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 4,now: 2024-06-22 21:26:45.550531,epoch time: 0:13:29.174642,used: 0:54:35.065373,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_20_32_10_seed_1_21546988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96279967, 'precision': 0.9468013, 'recall': 0.8214581, 'specificity': 0.8214581, 'f1': 0.8715467, 'auroc': 0.96811455, 'binary_precision': 0.9284294, 'binary_recall': 0.6480111, 'binary_specificity': 0.9949052, 'binary_f1_score': 0.7632797}
confusion matrix:
       0     1
0  42180   216
1   1522  2802
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.7327392, 'recall': 0.52002746, 'specificity': 0.52002746, 'f1': 0.5292526, 'auroc': 0.664278, 'binary_precision': 0.5, 'binary_recall': 0.041604754, 'binary_specificity': 0.9984502, 'binary_f1_score': 0.07681756}
confusion matrix:
       0   1
0  18039  28
1    645  28
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95713824, 'precision': 0.5791801, 'recall': 0.5031734, 'specificity': 0.5031734, 'f1': 0.49645367, 'auroc': 0.7452353, 'binary_precision': 0.2, 'binary_recall': 0.0076923077, 'binary_specificity': 0.99865454, 'binary_f1_score': 0.014814815}
confusion matrix:
      0  1
0  5938  8
1   258  2
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546988_5.png
better model found
persisted
after epoch: 5,now: 2024-06-22 21:40:11.330892,epoch time: 0:13:25.780361,used: 1:08:00.845734,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_20_32_10_seed_1_21546988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9669092, 'precision': 0.9537133, 'recall': 0.8414792, 'specificity': 0.8414792, 'f1': 0.8878295, 'auroc': 0.97567403, 'binary_precision': 0.938447, 'binary_recall': 0.6875578, 'binary_specificity': 0.9954005, 'binary_f1_score': 0.7936466}
confusion matrix:
       0     1
0  42201   195
1   1351  2973
---- Validation: 
scalar performance:
{'acc': 0.9638207, 'precision': 0.7147184, 'recall': 0.52275014, 'specificity': 0.52275014, 'f1': 0.5338992, 'auroc': 0.6934563, 'binary_precision': 0.46376812, 'binary_recall': 0.04754829, 'binary_specificity': 0.99795204, 'binary_f1_score': 0.08625337}
confusion matrix:
       0   1
0  18030  37
1    641  32
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9569771, 'precision': 0.61265814, 'recall': 0.50676733, 'specificity': 0.50676733, 'f1': 0.503546, 'auroc': 0.7593458, 'binary_precision': 0.26666668, 'binary_recall': 0.015384615, 'binary_specificity': 0.99815, 'binary_f1_score': 0.02909091}
confusion matrix:
      0   1
0  5935  11
1   256   4
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546988_6.png
early stop counter: 1
val acc:0.9638206958770752, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9571382403373718 / 0.9581050872802734
after epoch: 6,now: 2024-06-22 21:53:35.369508,epoch time: 0:13:24.038616,used: 1:21:24.884350,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_20_32_10_seed_1_21546988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97035533, 'precision': 0.9668691, 'recall': 0.8521005, 'specificity': 0.8521005, 'f1': 0.89959645, 'auroc': 0.9760772, 'binary_precision': 0.96283466, 'binary_recall': 0.7069843, 'binary_specificity': 0.9972167, 'binary_f1_score': 0.8153087}
confusion matrix:
       0     1
0  42278   118
1   1267  3057
---- Validation: 
scalar performance:
{'acc': 0.9648879, 'precision': 0.77458596, 'recall': 0.5383243, 'specificity': 0.5383243, 'f1': 0.56041104, 'auroc': 0.70426106, 'binary_precision': 0.5824176, 'binary_recall': 0.078751855, 'binary_specificity': 0.99789673, 'binary_f1_score': 0.13874345}
confusion matrix:
       0   1
0  18029  38
1    620  53
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587496, 'precision': 0.76863956, 'recall': 0.52792114, 'specificity': 0.52792114, 'f1': 0.5418917, 'auroc': 0.77088284, 'binary_precision': 0.5769231, 'binary_recall': 0.057692308, 'binary_specificity': 0.99815, 'binary_f1_score': 0.10489511}
confusion matrix:
      0   1
0  5935  11
1   245  15
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546988_7.png
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-06-22 22:07:02.789593,epoch time: 0:13:27.420085,used: 1:34:52.304435,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_20_32_10_seed_1_21546988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9751284, 'precision': 0.96603024, 'recall': 0.881702, 'specificity': 0.881702, 'f1': 0.9186717, 'auroc': 0.97908473, 'binary_precision': 0.95534426, 'binary_recall': 0.7670599, 'binary_specificity': 0.9963441, 'binary_f1_score': 0.8509109}
confusion matrix:
       0     1
0  42242   155
1   1007  3316
---- Validation: 
scalar performance:
{'acc': 0.96510136, 'precision': 0.756908, 'recall': 0.5849274, 'specificity': 0.5849274, 'f1': 0.6236474, 'auroc': 0.7257029, 'binary_precision': 0.5437788, 'binary_recall': 0.17533432, 'binary_specificity': 0.9945204, 'binary_f1_score': 0.26516852}
confusion matrix:
       0    1
0  17968   99
1    555  118
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96084434, 'precision': 0.79567754, 'recall': 0.578667, 'specificity': 0.578667, 'f1': 0.61838657, 'auroc': 0.7773875, 'binary_precision': 0.6268657, 'binary_recall': 0.16153847, 'binary_specificity': 0.9957955, 'binary_f1_score': 0.25688073}
confusion matrix:
      0   1
0  5921  25
1   218  42
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546988_8.png
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-06-22 22:20:27.340651,epoch time: 0:13:24.551058,used: 1:48:16.855493,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_20_32_10_seed_1_21546988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9765839, 'precision': 0.9729414, 'recall': 0.88473785, 'specificity': 0.88473785, 'f1': 0.92323405, 'auroc': 0.9812, 'binary_precision': 0.9686684, 'binary_recall': 0.77202314, 'binary_specificity': 0.99745256, 'binary_f1_score': 0.8592383}
confusion matrix:
       0     1
0  42287   108
1    986  3339
---- Validation: 
scalar performance:
{'acc': 0.965048, 'precision': 0.7675389, 'recall': 0.55485845, 'specificity': 0.55485845, 'f1': 0.5852457, 'auroc': 0.7399433, 'binary_precision': 0.5671642, 'binary_recall': 0.11292719, 'binary_specificity': 0.99678975, 'binary_f1_score': 0.18835193}
confusion matrix:
       0   1
0  18009  58
1    597  76
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959233, 'precision': 0.76554847, 'recall': 0.55391926, 'specificity': 0.55391926, 'f1': 0.58279395, 'auroc': 0.7903588, 'binary_precision': 0.5686275, 'binary_recall': 0.11153846, 'binary_specificity': 0.99630004, 'binary_f1_score': 0.18649518}
confusion matrix:
      0   1
0  5924  22
1   231  29
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546988_9.png
early stop counter: 1
val acc:0.9650480151176453, best validation acc: 0.9651013612747192, corresponding to test acc:                         0.9608443379402161 / 0.9608443379402161
after epoch: 9,now: 2024-06-22 22:33:53.559658,epoch time: 0:13:26.219007,used: 2:01:43.074500,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_20_32_10_seed_1_21546988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.97921664, 'precision': 0.97308815, 'recall': 0.90053725, 'specificity': 0.90053725, 'f1': 0.93307614, 'auroc': 0.9852835, 'binary_precision': 0.96584284, 'binary_recall': 0.80397594, 'binary_specificity': 0.9970986, 'binary_f1_score': 0.87750727}
confusion matrix:
       0     1
0  42271   123
1    848  3478
---- Validation: 
scalar performance:
{'acc': 0.9659552, 'precision': 0.77816033, 'recall': 0.58608544, 'specificity': 0.58608544, 'f1': 0.62712985, 'auroc': 0.72769237, 'binary_precision': 0.5862069, 'binary_recall': 0.1768202, 'binary_specificity': 0.99535066, 'binary_f1_score': 0.27168947}
confusion matrix:
       0    1
0  17983   84
1    554  119
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96165, 'precision': 0.8133685, 'recall': 0.5846044, 'specificity': 0.5846044, 'f1': 0.6273474, 'auroc': 0.78448504, 'binary_precision': 0.6617647, 'binary_recall': 0.17307693, 'binary_specificity': 0.99613184, 'binary_f1_score': 0.27439025}
confusion matrix:
      0   1
0  5923  23
1   215  45
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546988_10.png
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-06-22 22:47:18.667155,epoch time: 0:13:25.107497,used: 2:15:08.181997,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_20_32_10_seed_1_21546988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9808005, 'precision': 0.9709493, 'recall': 0.91200066, 'specificity': 0.91200066, 'f1': 0.9390265, 'auroc': 0.98505557, 'binary_precision': 0.95922744, 'binary_recall': 0.82758623, 'binary_specificity': 0.996415, 'binary_f1_score': 0.8885576}
confusion matrix:
       0     1
0  42247   152
1    745  3576
---- Validation: 
scalar performance:
{'acc': 0.96584845, 'precision': 0.7710998, 'recall': 0.59532857, 'specificity': 0.59532857, 'f1': 0.6372688, 'auroc': 0.7457491, 'binary_precision': 0.5714286, 'binary_recall': 0.1961367, 'binary_specificity': 0.9945204, 'binary_f1_score': 0.29203537}
confusion matrix:
       0    1
0  17968   99
1    541  132
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9619723, 'precision': 0.80627, 'recall': 0.59948444, 'specificity': 0.59948444, 'f1': 0.6451945, 'auroc': 0.7898736, 'binary_precision': 0.64634144, 'binary_recall': 0.20384616, 'binary_specificity': 0.9951228, 'binary_f1_score': 0.30994153}
confusion matrix:
      0   1
0  5917  29
1   207  53
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546988_11.png
new oracle model saved
early stop counter: 1
val acc:0.965848445892334, best validation acc: 0.9659551978111267, corresponding to test acc:                         0.961650013923645 / 0.9619722962379456
after epoch: 11,now: 2024-06-22 23:00:41.118188,epoch time: 0:13:22.451033,used: 2:28:30.633030,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_20_32_10_seed_1_21546988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9797731, 'precision': 0.9742044, 'recall': 0.9028755, 'specificity': 0.9028755, 'f1': 0.93494254, 'auroc': 0.98432374, 'binary_precision': 0.9676169, 'binary_recall': 0.80851066, 'binary_specificity': 0.9972403, 'binary_f1_score': 0.8809374}
confusion matrix:
       0     1
0  42279   117
1    828  3496
---- Validation: 
scalar performance:
{'acc': 0.96584845, 'precision': 0.7716782, 'recall': 0.593898, 'specificity': 0.593898, 'f1': 0.63569653, 'auroc': 0.7761278, 'binary_precision': 0.5726872, 'binary_recall': 0.19316493, 'binary_specificity': 0.9946311, 'binary_f1_score': 0.28888887}
confusion matrix:
       0    1
0  17970   97
1    543  130
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.962778, 'precision': 0.8116802, 'recall': 0.6146168, 'specificity': 0.6146168, 'f1': 0.6632266, 'auroc': 0.8090321, 'binary_precision': 0.65591395, 'binary_recall': 0.23461539, 'binary_specificity': 0.99461824, 'binary_f1_score': 0.34560907}
confusion matrix:
      0   1
0  5914  32
1   199  61
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546988_12.png
new oracle model saved
early stop counter: 2
val acc:0.965848445892334, best validation acc: 0.9659551978111267, corresponding to test acc:                         0.961650013923645 / 0.9627779722213745
after epoch: 12,now: 2024-06-22 23:14:08.052376,epoch time: 0:13:26.934188,used: 2:41:57.567218,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_20_32_10_seed_1_21546988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98137844, 'precision': 0.9705361, 'recall': 0.9160131, 'specificity': 0.9160131, 'f1': 0.9411859, 'auroc': 0.986068, 'binary_precision': 0.95760465, 'binary_recall': 0.8358002, 'binary_specificity': 0.9962261, 'binary_f1_score': 0.892566}
confusion matrix:
       0     1
0  42236   160
1    710  3614
---- Validation: 
scalar performance:
{'acc': 0.96499467, 'precision': 0.74973357, 'recall': 0.6192048, 'specificity': 0.6192048, 'f1': 0.65902793, 'auroc': 0.77875704, 'binary_precision': 0.52698416, 'binary_recall': 0.24665676, 'binary_specificity': 0.9917529, 'binary_f1_score': 0.3360324}
confusion matrix:
       0    1
0  17918  149
1    507  166
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96358365, 'precision': 0.80929554, 'recall': 0.6389441, 'specificity': 0.6389441, 'f1': 0.68847406, 'auroc': 0.81365836, 'binary_precision': 0.64912283, 'binary_recall': 0.2846154, 'binary_specificity': 0.9932728, 'binary_f1_score': 0.39572194}
confusion matrix:
      0   1
0  5906  40
1   186  74
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546988_13.png
new oracle model saved
early stop counter: 3
val acc:0.9649946689605713, best validation acc: 0.9659551978111267, corresponding to test acc:                         0.961650013923645 / 0.9635836482048035
after epoch: 13,now: 2024-06-22 23:27:36.845252,epoch time: 0:13:28.792876,used: 2:55:26.360094,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_20_32_10_seed_1_21546988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98416096, 'precision': 0.9751104, 'recall': 0.92879313, 'specificity': 0.92879313, 'f1': 0.9504719, 'auroc': 0.9887966, 'binary_precision': 0.9642672, 'binary_recall': 0.86084145, 'binary_specificity': 0.9967448, 'binary_f1_score': 0.90962386}
confusion matrix:
       0     1
0  42256   138
1    602  3724
---- Validation: 
scalar performance:
{'acc': 0.965048, 'precision': 0.7512144, 'recall': 0.6127951, 'specificity': 0.6127951, 'f1': 0.6530528, 'auroc': 0.7571552, 'binary_precision': 0.5304054, 'binary_recall': 0.2332838, 'binary_specificity': 0.9923064, 'binary_f1_score': 0.3240454}
confusion matrix:
       0    1
0  17928  139
1    516  157
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96422815, 'precision': 0.8242128, 'recall': 0.6356025, 'specificity': 0.6356025, 'f1': 0.6875066, 'auroc': 0.7954701, 'binary_precision': 0.6792453, 'binary_recall': 0.2769231, 'binary_specificity': 0.9942819, 'binary_f1_score': 0.3934426}
confusion matrix:
      0   1
0  5912  34
1   188  72
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546988_14.png
new oracle model saved
early stop counter: 4
val acc:0.9650480151176453, best validation acc: 0.9659551978111267, corresponding to test acc:                         0.961650013923645 / 0.9642281532287598
after epoch: 14,now: 2024-06-22 23:41:36.649791,epoch time: 0:13:59.804539,used: 3:09:26.164633,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_20_32_10_seed_1_21546988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9832834, 'precision': 0.97204566, 'recall': 0.9263045, 'specificity': 0.9263045, 'f1': 0.94772196, 'auroc': 0.99007964, 'binary_precision': 0.9585814, 'binary_recall': 0.85638297, 'binary_specificity': 0.9962261, 'binary_f1_score': 0.90460485}
confusion matrix:
       0     1
0  42236   160
1    621  3703
---- Validation: 
scalar performance:
