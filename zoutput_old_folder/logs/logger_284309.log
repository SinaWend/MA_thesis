Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0




!!!: not committed yet



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_53_07_seed_0_21404213

 Experiment start at: 2024-06-18 03:53:07.934810
before training, model accuracy: 0.3103227913379669
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9663927, 'precision': 0.48319635, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49145457, 'auroc': 0.72368366, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42328  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.68612427, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.6995594, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21404213_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-18 04:14:03.416995,epoch time: 0:20:55.482185,used: 0:20:55.482185,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_53_07_seed_0_21404213
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96650684, 'precision': 0.7554586, 'recall': 0.5102228, 'specificity': 0.5102228, 'f1': 0.51175267, 'auroc': 0.86528516, 'binary_precision': 0.54385966, 'binary_recall': 0.021059783, 'binary_specificity': 0.9993858, 'binary_f1_score': 0.040549375}
confusion matrix:
       0   1
0  42302  26
1   1441  31
---- Validation: 
scalar performance:
{'acc': 0.9657301, 'precision': 0.48289075, 'recall': 0.49997246, 'specificity': 0.49997246, 'f1': 0.4912832, 'auroc': 0.8450642, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9999449, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18148  1
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.8381772, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21404213_2.png
early stop counter: 1
val acc:0.9657300710678101, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 2,now: 2024-06-18 04:33:28.145050,epoch time: 0:19:24.728055,used: 0:40:20.210240,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_53_07_seed_0_21404213
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9665753, 'precision': 0.7435178, 'recall': 0.53223574, 'specificity': 0.53223574, 'f1': 0.55051863, 'auroc': 0.8910315, 'binary_precision': 0.5185185, 'binary_recall': 0.06662135, 'binary_specificity': 0.9978502, 'binary_f1_score': 0.118072286}
confusion matrix:
       0   1
0  42238  91
1   1373  98
---- Validation: 
scalar performance:
{'acc': 0.9656237, 'precision': 0.68303776, 'recall': 0.50441766, 'specificity': 0.50441766, 'f1': 0.50037134, 'auroc': 0.8790429, 'binary_precision': 0.4, 'binary_recall': 0.00933126, 'binary_specificity': 0.9995041, 'binary_f1_score': 0.018237082}
confusion matrix:
       0  1
0  18140  9
1    637  6
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.97976, 'recall': 0.51532567, 'specificity': 0.51532567, 'f1': 0.5194107, 'auroc': 0.8639781, 'binary_precision': 1.0, 'binary_recall': 0.03065134, 'binary_specificity': 1.0, 'binary_f1_score': 0.059479553}
confusion matrix:
      0  1
0  5997  0
1   253  8
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21404213_3.png
new oracle model saved
early stop counter: 2
val acc:0.965623676776886, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9595717191696167
after epoch: 3,now: 2024-06-18 04:52:21.594795,epoch time: 0:18:53.449745,used: 0:59:13.659985,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_53_07_seed_0_21404213
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96650684, 'precision': 0.738497, 'recall': 0.5666149, 'specificity': 0.5666149, 'f1': 0.59982604, 'auroc': 0.89854443, 'binary_precision': 0.5062344, 'binary_recall': 0.13790761, 'binary_specificity': 0.9953222, 'binary_f1_score': 0.21676455}
confusion matrix:
       0    1
0  42130  198
1   1269  203
---- Validation: 
scalar performance:
{'acc': 0.9665815, 'precision': 0.7803966, 'recall': 0.5364159, 'specificity': 0.5364159, 'f1': 0.5577796, 'auroc': 0.8949455, 'binary_precision': 0.5925926, 'binary_recall': 0.07465008, 'binary_specificity': 0.9981817, 'binary_f1_score': 0.1325967}
confusion matrix:
       0   1
0  18116  33
1    595  48
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96340686, 'precision': 0.98160934, 'recall': 0.56130266, 'specificity': 0.56130266, 'f1': 0.59984744, 'auroc': 0.87604386, 'binary_precision': 1.0, 'binary_recall': 0.12260536, 'binary_specificity': 1.0, 'binary_f1_score': 0.21843004}
confusion matrix:
      0   1
0  5997   0
1   229  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21404213_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-18 05:11:15.658998,epoch time: 0:18:54.064203,used: 1:18:07.724188,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_53_07_seed_0_21404213
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9666895, 'precision': 0.7420618, 'recall': 0.5952334, 'specificity': 0.5952334, 'f1': 0.6337005, 'auroc': 0.9123286, 'binary_precision': 0.5114638, 'binary_recall': 0.19701087, 'binary_specificity': 0.9934559, 'binary_f1_score': 0.28445315}
confusion matrix:
       0    1
0  42051  277
1   1182  290
---- Validation: 
scalar performance:
{'acc': 0.9670072, 'precision': 0.7925135, 'recall': 0.546387, 'specificity': 0.546387, 'f1': 0.5737959, 'auroc': 0.90387404, 'binary_precision': 0.61616164, 'binary_recall': 0.09486781, 'binary_specificity': 0.9979062, 'binary_f1_score': 0.16442049}
confusion matrix:
       0   1
0  18111  38
1    582  61
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9637264, 'precision': 0.98176414, 'recall': 0.5651341, 'specificity': 0.5651341, 'f1': 0.6059669, 'auroc': 0.8782544, 'binary_precision': 1.0, 'binary_recall': 0.1302682, 'binary_specificity': 1.0, 'binary_f1_score': 0.23050848}
confusion matrix:
      0   1
0  5997   0
1   227  34
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21404213_5.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-06-18 05:31:05.865101,epoch time: 0:19:50.206103,used: 1:37:57.930291,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_53_07_seed_0_21404213
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9672603, 'precision': 0.75066626, 'recall': 0.6227412, 'specificity': 0.6227412, 'f1': 0.6627071, 'auroc': 0.91805613, 'binary_precision': 0.52683616, 'binary_recall': 0.25339675, 'binary_specificity': 0.99208564, 'binary_f1_score': 0.34220183}
confusion matrix:
       0    1
0  41993  335
1   1099  373
---- Validation: 
scalar performance:
{'acc': 0.9668476, 'precision': 0.76640993, 'recall': 0.568056, 'specificity': 0.568056, 'f1': 0.6036107, 'auroc': 0.9144623, 'binary_precision': 0.5625, 'binary_recall': 0.1399689, 'binary_specificity': 0.99614304, 'binary_f1_score': 0.22415942}
confusion matrix:
       0   1
0  18079  70
1    553  90
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96692234, 'precision': 0.98331726, 'recall': 0.6034483, 'specificity': 0.6034483, 'f1': 0.6629456, 'auroc': 0.8857725, 'binary_precision': 1.0, 'binary_recall': 0.20689656, 'binary_specificity': 1.0, 'binary_f1_score': 0.34285715}
confusion matrix:
      0   1
0  5997   0
1   207  54
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21404213_6.png
new oracle model saved
early stop counter: 1
val acc:0.9668475985527039, best validation acc: 0.9670072197914124, corresponding to test acc:                         0.9637264013290405 / 0.9669223427772522
after epoch: 6,now: 2024-06-18 05:50:48.932860,epoch time: 0:19:43.067759,used: 1:57:40.998050,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_53_07_seed_0_21404213
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9674201, 'precision': 0.75464904, 'recall': 0.6116766, 'specificity': 0.6116766, 'f1': 0.65269965, 'auroc': 0.92064977, 'binary_precision': 0.53554505, 'binary_recall': 0.2302989, 'binary_specificity': 0.9930543, 'binary_f1_score': 0.32209024}
confusion matrix:
       0    1
0  42034  294
1   1133  339
---- Validation: 
scalar performance:
{'acc': 0.9673265, 'precision': 0.7837996, 'recall': 0.5675539, 'specificity': 0.5675539, 'f1': 0.6040295, 'auroc': 0.91524416, 'binary_precision': 0.59731543, 'binary_recall': 0.13841368, 'binary_specificity': 0.996694, 'binary_f1_score': 0.22474746}
confusion matrix:
       0   1
0  18089  60
1    554  89
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650048, 'precision': 0.9823842, 'recall': 0.5804598, 'specificity': 0.5804598, 'f1': 0.629648, 'auroc': 0.8869098, 'binary_precision': 1.0, 'binary_recall': 0.16091955, 'binary_specificity': 1.0, 'binary_f1_score': 0.27722773}
confusion matrix:
      0   1
0  5997   0
1   219  42
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21404213_7.png
better model found
persisted
after epoch: 7,now: 2024-06-18 06:14:22.885775,epoch time: 0:23:33.952915,used: 2:21:14.950965,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_53_07_seed_0_21404213
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9671689, 'precision': 0.7481669, 'recall': 0.64138204, 'specificity': 0.64138204, 'f1': 0.6786904, 'auroc': 0.92620814, 'binary_precision': 0.5205811, 'binary_recall': 0.29211956, 'binary_specificity': 0.9906445, 'binary_f1_score': 0.3742385}
confusion matrix:
       0    1
0  41932  396
1   1042  430
---- Validation: 
scalar performance:
{'acc': 0.96753937, 'precision': 0.77689815, 'recall': 0.5886656, 'specificity': 0.5886656, 'f1': 0.630324, 'auroc': 0.921206, 'binary_precision': 0.58208954, 'binary_recall': 0.18195957, 'binary_specificity': 0.99537164, 'binary_f1_score': 0.27725118}
confusion matrix:
       0    1
0  18065   84
1    526  117
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96596354, 'precision': 0.98285025, 'recall': 0.591954, 'specificity': 0.591954, 'f1': 0.64661527, 'auroc': 0.8873417, 'binary_precision': 1.0, 'binary_recall': 0.18390805, 'binary_specificity': 1.0, 'binary_f1_score': 0.3106796}
confusion matrix:
      0   1
0  5997   0
1   213  48
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21404213_8.png
better model found
persisted
after epoch: 8,now: 2024-06-18 06:38:02.961207,epoch time: 0:23:40.075432,used: 2:44:55.026397,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_53_07_seed_0_21404213
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9678311, 'precision': 0.7572371, 'recall': 0.6453311, 'specificity': 0.6453311, 'f1': 0.68423414, 'auroc': 0.9249836, 'binary_precision': 0.53846157, 'binary_recall': 0.2995924, 'binary_specificity': 0.99106973, 'binary_f1_score': 0.38498476}
confusion matrix:
       0    1
0  41950  378
1   1031  441
---- Validation: 
scalar performance:
{'acc': 0.96748614, 'precision': 0.7795552, 'recall': 0.58113754, 'specificity': 0.58113754, 'f1': 0.6213861, 'auroc': 0.9263941, 'binary_precision': 0.5879121, 'binary_recall': 0.16640747, 'binary_specificity': 0.99586755, 'binary_f1_score': 0.25939396}
confusion matrix:
       0    1
0  18074   75
1    536  107
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.965644, 'precision': 0.9723531, 'recall': 0.5899549, 'specificity': 0.5899549, 'f1': 0.64329714, 'auroc': 0.89140964, 'binary_precision': 0.9791667, 'binary_recall': 0.18007663, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.30420712}
confusion matrix:
      0   1
0  5996   1
1   214  47
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21404213_9.png
early stop counter: 1
val acc:0.9674861431121826, best validation acc: 0.967539370059967, corresponding to test acc:                         0.9659635424613953 / 0.9669223427772522
after epoch: 9,now: 2024-06-18 06:58:31.385340,epoch time: 0:20:28.424133,used: 3:05:23.450530,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_53_07_seed_0_21404213
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.96769404, 'precision': 0.7560071, 'recall': 0.6380472, 'specificity': 0.6380472, 'f1': 0.67768455, 'auroc': 0.9237518, 'binary_precision': 0.5364917, 'binary_recall': 0.28464675, 'binary_specificity': 0.99144775, 'binary_f1_score': 0.37194854}
confusion matrix:
       0    1
0  41966  362
1   1053  419
---- Validation: 
scalar performance:
{'acc': 0.9675926, 'precision': 0.7800236, 'recall': 0.58569294, 'specificity': 0.58569294, 'f1': 0.62704337, 'auroc': 0.9272204, 'binary_precision': 0.5885417, 'binary_recall': 0.17573872, 'binary_specificity': 0.99564713, 'binary_f1_score': 0.27065867}
confusion matrix:
       0    1
0  18070   79
1    530  113
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650048, 'precision': 0.9823842, 'recall': 0.5804598, 'specificity': 0.5804598, 'f1': 0.629648, 'auroc': 0.892571, 'binary_precision': 1.0, 'binary_recall': 0.16091955, 'binary_specificity': 1.0, 'binary_f1_score': 0.27722773}
confusion matrix:
      0   1
0  5997   0
1   219  42
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21404213_10.png
better model found
persisted
after epoch: 10,now: 2024-06-18 07:20:55.272436,epoch time: 0:22:23.887096,used: 3:27:47.337626,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_53_07_seed_0_21404213
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96872145, 'precision': 0.76540494, 'recall': 0.6766107, 'specificity': 0.6766107, 'f1': 0.7112186, 'auroc': 0.93000853, 'binary_precision': 0.552686, 'binary_recall': 0.3634511, 'binary_specificity': 0.98977035, 'binary_f1_score': 0.4385246}
confusion matrix:
       0    1
0  41895  433
1    937  535
---- Validation: 
scalar performance:
{'acc': 0.96812475, 'precision': 0.780625, 'recall': 0.6114703, 'specificity': 0.6114703, 'f1': 0.65645087, 'auroc': 0.9317819, 'binary_precision': 0.588, 'binary_recall': 0.22861587, 'binary_specificity': 0.99432474, 'binary_f1_score': 0.32922733}
confusion matrix:
       0    1
0  18046  103
1    496  147
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96708214, 'precision': 0.9746985, 'recall': 0.60719633, 'specificity': 0.60719633, 'f1': 0.66765666, 'auroc': 0.8940176, 'binary_precision': 0.98245615, 'binary_recall': 0.21455939, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.35220128}
confusion matrix:
      0   1
0  5996   1
1   205  56
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21404213_11.png
new oracle model saved
better model found
persisted
after epoch: 11,now: 2024-06-18 07:44:13.269730,epoch time: 0:23:17.997294,used: 3:51:05.334920,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_53_07_seed_0_21404213
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.96863014, 'precision': 0.7730043, 'recall': 0.63033503, 'specificity': 0.63033503, 'f1': 0.67419773, 'auroc': 0.93049884, 'binary_precision': 0.57101446, 'binary_recall': 0.26766303, 'binary_specificity': 0.993007, 'binary_f1_score': 0.3644773}
confusion matrix:
       0    1
0  42032  296
1   1078  394
---- Validation: 
scalar performance:
{'acc': 0.96722007, 'precision': 0.7787391, 'recall': 0.5689989, 'specificity': 0.5689989, 'f1': 0.60566235, 'auroc': 0.9311324, 'binary_precision': 0.58709675, 'binary_recall': 0.1415241, 'binary_specificity': 0.9964736, 'binary_f1_score': 0.22807017}
confusion matrix:
       0   1
0  18085  64
1    552  91
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.98145473, 'recall': 0.5574713, 'specificity': 0.5574713, 'f1': 0.5936449, 'auroc': 0.8930144, 'binary_precision': 1.0, 'binary_recall': 0.11494253, 'binary_specificity': 1.0, 'binary_f1_score': 0.20618556}
confusion matrix:
      0   1
0  5997   0
1   231  30
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21404213_12.png
early stop counter: 1
val acc:0.9672200679779053, best validation acc: 0.9681247472763062, corresponding to test acc:                         0.967082142829895 / 0.967082142829895
after epoch: 12,now: 2024-06-18 08:05:06.413140,epoch time: 0:20:53.143410,used: 4:11:58.478330,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_53_07_seed_0_21404213
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.968242, 'precision': 0.7624644, 'recall': 0.64891475, 'specificity': 0.64891475, 'f1': 0.6885327, 'auroc': 0.9318641, 'binary_precision': 0.5486618, 'binary_recall': 0.30659416, 'binary_specificity': 0.9912353, 'binary_f1_score': 0.39337116}
confusion matrix:
       0    1
0  41958  371
1   1020  451
---- Validation: 
scalar performance:
{'acc': 0.9673265, 'precision': 0.7803244, 'recall': 0.5720542, 'specificity': 0.5720542, 'f1': 0.60981226, 'auroc': 0.93088484, 'binary_precision': 0.59006214, 'binary_recall': 0.14774494, 'binary_specificity': 0.99636346, 'binary_f1_score': 0.2363184}
confusion matrix:
       0   1
0  18083  66
1    548  95
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96228826, 'precision': 0.9810685, 'recall': 0.5478927, 'specificity': 0.5478927, 'f1': 0.57776415, 'auroc': 0.8903179, 'binary_precision': 1.0, 'binary_recall': 0.09578544, 'binary_specificity': 1.0, 'binary_f1_score': 0.17482518}
confusion matrix:
      0   1
0  5997   0
1   236  25
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21404213_13.png
early stop counter: 2
val acc:0.9673265218734741, best validation acc: 0.9681247472763062, corresponding to test acc:                         0.967082142829895 / 0.967082142829895
after epoch: 13,now: 2024-06-18 08:33:47.582241,epoch time: 0:28:41.169101,used: 4:40:39.647431,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_53_07_seed_0_21404213
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9693379, 'precision': 0.7793784, 'recall': 0.65102863, 'specificity': 0.65102863, 'f1': 0.6943492, 'auroc': 0.93495035, 'binary_precision': 0.58237547, 'binary_recall': 0.3097826, 'binary_specificity': 0.99227464, 'binary_f1_score': 0.4044346}
confusion matrix:
       0    1
0  42001  327
1   1016  456
---- Validation: 
scalar performance:
{'acc': 0.96780545, 'precision': 0.79270625, 'recall': 0.5775525, 'specificity': 0.5775525, 'f1': 0.61785585, 'auroc': 0.9350084, 'binary_precision': 0.61445785, 'binary_recall': 0.15863141, 'binary_specificity': 0.9964736, 'binary_f1_score': 0.25216314}
confusion matrix:
       0    1
0  18085   64
1    541  102
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96244806, 'precision': 0.98114574, 'recall': 0.54980844, 'specificity': 0.54980844, 'f1': 0.580984, 'auroc': 0.8932079, 'binary_precision': 1.0, 'binary_recall': 0.099616855, 'binary_specificity': 1.0, 'binary_f1_score': 0.18118466}
confusion matrix:
      0   1
0  5997   0
1   235  26
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21404213_14.png
early stop counter: 3
val acc:0.9678054451942444, best validation acc: 0.9681247472763062, corresponding to test acc:                         0.967082142829895 / 0.967082142829895
after epoch: 14,now: 2024-06-18 09:11:57.703321,epoch time: 0:38:10.121080,used: 5:18:49.768511,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_53_07_seed_0_21404213
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9694749, 'precision': 0.77380764, 'recall': 0.68268996, 'specificity': 0.68268996, 'f1': 0.7182869, 'auroc': 0.9358325, 'binary_precision': 0.5690722, 'binary_recall': 0.37525493, 'binary_specificity': 0.990125, 'binary_f1_score': 0.45227367}
confusion matrix:
       0    1
0  41911  418
1    919  552
---- Validation: 
scalar performance:
{'acc': 0.9678587, 'precision': 0.7781863, 'recall': 0.60308194, 'specificity': 0.60308194, 'f1': 0.64702404, 'auroc': 0.93784344, 'binary_precision': 0.583691, 'binary_recall': 0.21150856, 'binary_specificity': 0.9946554, 'binary_f1_score': 0.3105023}
confusion matrix:
       0    1
0  18052   97
1    507  136
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642058, 'precision': 0.9819965, 'recall': 0.57088125, 'specificity': 0.57088125, 'f1': 0.6149943, 'auroc': 0.89781994, 'binary_precision': 1.0, 'binary_recall': 0.14176245, 'binary_specificity': 1.0, 'binary_f1_score': 0.24832213}
confusion matrix:
      0   1
0  5997   0
1   224  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21404213_15.png
early stop counter: 4
val acc:0.9678586721420288, best validation acc: 0.9681247472763062, corresponding to test acc:                         0.967082142829895 / 0.967082142829895
after epoch: 15,now: 2024-06-18 09:43:31.001037,epoch time: 0:31:33.297716,used: 5:50:23.066227,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_53_07_seed_0_21404213
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9695434, 'precision': 0.77671695, 'recall': 0.6740852, 'specificity': 0.6740852, 'f1': 0.71262527, 'auroc': 0.93503875, 'binary_precision': 0.5754923, 'binary_recall': 0.35733697, 'binary_specificity': 0.99083346, 'binary_f1_score': 0.4409053}
confusion matrix:
       0    1
0  41940  388
1    946  526
---- Validation: 
scalar performance:
{'acc': 0.968178, 'precision': 0.78717387, 'recall': 0.6009971, 'specificity': 0.6009971, 'f1': 0.6457925, 'auroc': 0.93757725, 'binary_precision': 0.60181, 'binary_recall': 0.20684293, 'binary_specificity': 0.9951512, 'binary_f1_score': 0.3078704}
confusion matrix:
       0    1
0  18061   88
1    510  133
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964046, 'precision': 0.981919, 'recall': 0.5689655, 'specificity': 0.5689655, 'f1': 0.6120051, 'auroc': 0.8968871, 'binary_precision': 1.0, 'binary_recall': 0.13793103, 'binary_specificity': 1.0, 'binary_f1_score': 0.24242425}
confusion matrix:
      0   1
0  5997   0
1   225  36
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21404213_16.png
better model found
persisted
after epoch: 16,now: 2024-06-18 10:17:50.073740,epoch time: 0:34:19.072703,used: 6:24:42.138930,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_53_07_seed_0_21404213
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9696347, 'precision': 0.77767694, 'recall': 0.67424226, 'specificity': 0.67424226, 'f1': 0.7130194, 'auroc': 0.9381299, 'binary_precision': 0.5773875, 'binary_recall': 0.3575799, 'binary_specificity': 0.99090457, 'binary_f1_score': 0.44164568}
confusion matrix:
       0    1
0  41944  385
1    945  526
---- Validation: 
scalar performance:
{'acc': 0.9683908, 'precision': 0.7976009, 'recall': 0.5943568, 'specificity': 0.5943568, 'f1': 0.639185, 'auroc': 0.9370129, 'binary_precision': 0.6231156, 'binary_recall': 0.19284603, 'binary_specificity': 0.99586755, 'binary_f1_score': 0.29453683}
confusion matrix:
       0    1
0  18074   75
1    519  124
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96196866, 'precision': 0.98091424, 'recall': 0.5440613, 'specificity': 0.5440613, 'f1': 0.57125735, 'auroc': 0.89657795, 'binary_precision': 1.0, 'binary_recall': 0.08812261, 'binary_specificity': 1.0, 'binary_f1_score': 0.16197184}
confusion matrix:
      0   1
0  5997   0
1   238  23
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21404213_17.png
better model found
persisted
after epoch: 17,now: 2024-06-18 10:44:30.759294,epoch time: 0:26:40.685554,used: 6:51:22.824484,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_53_07_seed_0_21404213
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9694521, 'precision': 0.77784073, 'recall': 0.66354644, 'specificity': 0.66354644, 'f1': 0.70453644, 'auroc': 0.9376866, 'binary_precision': 0.5784543, 'binary_recall': 0.3355978, 'binary_specificity': 0.991495, 'binary_f1_score': 0.42476353}
confusion matrix:
       0    1
0  41968  360
1    978  494
---- Validation: 
scalar performance:
{'acc': 0.9683376, 'precision': 0.79229504, 'recall': 0.59957963, 'specificity': 0.59957963, 'f1': 0.6447585, 'auroc': 0.9381366, 'binary_precision': 0.61214954, 'binary_recall': 0.2037325, 'binary_specificity': 0.9954268, 'binary_f1_score': 0.30571765}
confusion matrix:
       0    1
0  18066   83
1    512  131
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96340686, 'precision': 0.98160934, 'recall': 0.56130266, 'specificity': 0.56130266, 'f1': 0.59984744, 'auroc': 0.89491713, 'binary_precision': 1.0, 'binary_recall': 0.12260536, 'binary_specificity': 1.0, 'binary_f1_score': 0.21843004}
confusion matrix:
      0   1
0  5997   0
1   229  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21404213_18.png
early stop counter: 1
val acc:0.9683375954627991, best validation acc: 0.9683908224105835, corresponding to test acc:                         0.9619686603546143 / 0.967082142829895
after epoch: 18,now: 2024-06-18 11:15:47.677664,epoch time: 0:31:16.918370,used: 7:22:39.742854,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_53_07_seed_0_21404213
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9687671, 'precision': 0.7663405, 'recall': 0.67215294, 'specificity': 0.67215294, 'f1': 0.7081535, 'auroc': 0.9398439, 'binary_precision': 0.5548456, 'binary_recall': 0.35418084, 'binary_specificity': 0.990125, 'binary_f1_score': 0.43236518}
confusion matrix:
       0    1
0  41911  418
1    950  521
---- Validation: 
scalar performance:
{'acc': 0.9683908, 'precision': 0.7894804, 'recall': 0.6063577, 'specificity': 0.6063577, 'f1': 0.65209264, 'auroc': 0.94080734, 'binary_precision': 0.6060606, 'binary_recall': 0.21772939, 'binary_specificity': 0.99498594, 'binary_f1_score': 0.3203661}
confusion matrix:
       0    1
0  18058   91
1    503  140
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96260786, 'precision': 0.9812229, 'recall': 0.55172414, 'specificity': 0.55172414, 'f1': 0.5841818, 'auroc': 0.8967522, 'binary_precision': 1.0, 'binary_recall': 0.10344828, 'binary_specificity': 1.0, 'binary_f1_score': 0.1875}
confusion matrix:
      0   1
0  5997   0
1   234  27
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21404213_19.png
early stop counter: 2
val acc:0.9683908224105835, best validation acc: 0.9683908224105835, corresponding to test acc:                         0.9619686603546143 / 0.967082142829895
after epoch: 19,now: 2024-06-18 11:58:14.757060,epoch time: 0:42:27.079396,used: 8:05:06.822250,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_53_07_seed_0_21404213
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9708219, 'precision': 0.78836405, 'recall': 0.69769704, 'specificity': 0.69769704, 'f1': 0.7337894, 'auroc': 0.9399927, 'binary_precision': 0.5971944, 'binary_recall': 0.4048913, 'binary_specificity': 0.9905027, 'binary_f1_score': 0.4825911}
confusion matrix:
       0    1
0  41926  402
1    876  596
---- Validation: 
scalar performance:
{'acc': 0.9686569, 'precision': 0.79618824, 'recall': 0.6064954, 'specificity': 0.6064954, 'f1': 0.65308344, 'auroc': 0.940422, 'binary_precision': 0.61946905, 'binary_recall': 0.21772939, 'binary_specificity': 0.99526143, 'binary_f1_score': 0.32220945}
confusion matrix:
       0    1
0  18063   86
1    503  140
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.98145473, 'recall': 0.5574713, 'specificity': 0.5574713, 'f1': 0.5936449, 'auroc': 0.89550877, 'binary_precision': 1.0, 'binary_recall': 0.11494253, 'binary_specificity': 1.0, 'binary_f1_score': 0.20618556}
confusion matrix:
      0   1
0  5997   0
1   231  30
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21404213_20.png
better model found
persisted
after epoch: 20,now: 2024-06-18 12:43:08.701451,epoch time: 0:44:53.944391,used: 8:50:00.766641,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_53_07_seed_0_21404213
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.97077626, 'precision': 0.78961414, 'recall': 0.68992513, 'specificity': 0.68992513, 'f1': 0.7284598, 'auroc': 0.9373845, 'binary_precision': 0.6002099, 'binary_recall': 0.38885114, 'binary_specificity': 0.9909991, 'binary_f1_score': 0.47194722}
confusion matrix:
       0    1
0  41948  381
1    899  572
---- Validation: 
scalar performance:
{'acc': 0.96886975, 'precision': 0.78764725, 'recall': 0.63135743, 'specificity': 0.63135743, 'f1': 0.6778414, 'auroc': 0.94330966, 'binary_precision': 0.6006944, 'binary_recall': 0.2690513, 'binary_specificity': 0.99366355, 'binary_f1_score': 0.3716434}
confusion matrix:
       0    1
0  18034  115
1    470  173
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964845, 'precision': 0.97075343, 'recall': 0.5803764, 'specificity': 0.5803764, 'f1': 0.6291504, 'auroc': 0.8992078, 'binary_precision': 0.9767442, 'binary_recall': 0.16091955, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.27631578}
confusion matrix:
      0   1
0  5996   1
1   219  42
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21404213_21.png
better model found
persisted
after epoch: 21,now: 2024-06-18 13:18:50.702273,epoch time: 0:35:42.000822,used: 9:25:42.767463,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_53_07_seed_0_21404213
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.96984017, 'precision': 0.7798418, 'recall': 0.67850095, 'specificity': 0.67850095, 'f1': 0.71692467, 'auroc': 0.93860674, 'binary_precision': 0.5814455, 'binary_recall': 0.36616847, 'binary_specificity': 0.99083346, 'binary_f1_score': 0.4493539}
confusion matrix:
       0    1
0  41940  388
1    933  539
---- Validation: 
scalar performance:
{'acc': 0.9691358, 'precision': 0.7965069, 'recall': 0.6247447, 'specificity': 0.6247447, 'f1': 0.6727097, 'auroc': 0.9424484, 'binary_precision': 0.61886793, 'binary_recall': 0.25505444, 'binary_specificity': 0.99443495, 'binary_f1_score': 0.3612335}
confusion matrix:
       0    1
0  18048  101
1    479  164
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.98145473, 'recall': 0.5574713, 'specificity': 0.5574713, 'f1': 0.5936449, 'auroc': 0.8963043, 'binary_precision': 1.0, 'binary_recall': 0.11494253, 'binary_specificity': 1.0, 'binary_f1_score': 0.20618556}
confusion matrix:
      0   1
0  5997   0
1   231  30
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21404213_22.png
better model found
persisted
after epoch: 22,now: 2024-06-18 13:49:30.895369,epoch time: 0:30:40.193096,used: 9:56:22.960559,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_53_07_seed_0_21404213
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.97025114, 'precision': 0.7876209, 'recall': 0.6718285, 'specificity': 0.6718285, 'f1': 0.71382093, 'auroc': 0.94136953, 'binary_precision': 0.59746253, 'binary_recall': 0.3519022, 'binary_specificity': 0.9917549, 'binary_f1_score': 0.44292432}
confusion matrix:
       0    1
0  41979  349
1    954  518
---- Validation: 
scalar performance:
{'acc': 0.969189, 'precision': 0.8105351, 'recall': 0.6067709, 'specificity': 0.6067709, 'f1': 0.65509725, 'auroc': 0.94173265, 'binary_precision': 0.6481481, 'binary_recall': 0.21772939, 'binary_specificity': 0.9958124, 'binary_f1_score': 0.32596043}
confusion matrix:
       0    1
0  18073   76
1    503  140
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96292746, 'precision': 0.9813774, 'recall': 0.5555556, 'specificity': 0.5555556, 'f1': 0.59051204, 'auroc': 0.8957386, 'binary_precision': 1.0, 'binary_recall': 0.11111111, 'binary_specificity': 1.0, 'binary_f1_score': 0.19999999}
confusion matrix:
      0   1
0  5997   0
1   232  29
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21404213_23.png
better model found
persisted
after epoch: 23,now: 2024-06-18 14:24:22.411781,epoch time: 0:34:51.516412,used: 10:31:14.476971,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_53_07_seed_0_21404213
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.97059363, 'precision': 0.79143006, 'recall': 0.67626786, 'specificity': 0.67626786, 'f1': 0.71840316, 'auroc': 0.9393531, 'binary_precision': 0.6047836, 'binary_recall': 0.3607337, 'binary_specificity': 0.9918021, 'binary_f1_score': 0.45191488}
confusion matrix:
       0    1
0  41981  347
1    941  531
---- Validation: 
scalar performance:
{'acc': 0.9686569, 'precision': 0.792011, 'recall': 0.61324596, 'specificity': 0.61324596, 'f1': 0.65995675, 'auroc': 0.943081, 'binary_precision': 0.6106557, 'binary_recall': 0.23172629, 'binary_specificity': 0.9947656, 'binary_f1_score': 0.33596393}
confusion matrix:
       0    1
0  18054   95
1    494  149
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.98145473, 'recall': 0.5574713, 'specificity': 0.5574713, 'f1': 0.5936449, 'auroc': 0.89669514, 'binary_precision': 1.0, 'binary_recall': 0.11494253, 'binary_specificity': 1.0, 'binary_f1_score': 0.20618556}
confusion matrix:
      0   1
0  5997   0
1   231  30
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21404213_24.png
early stop counter: 1
val acc:0.9686568975448608, best validation acc: 0.9691889882087708, corresponding to test acc:                         0.9629274606704712 / 0.967082142829895
after epoch: 24,now: 2024-06-18 14:59:17.309005,epoch time: 0:34:54.897224,used: 11:06:09.374195,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_53_07_seed_0_21404213
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9707078, 'precision': 0.80159295, 'recall': 0.6556717, 'specificity': 0.6556717, 'f1': 0.70339245, 'auroc': 0.94185936, 'binary_precision': 0.62650603, 'binary_recall': 0.31793478, 'binary_specificity': 0.9934086, 'binary_f1_score': 0.4218116}
confusion matrix:
       0    1
0  42049  279
1   1004  468
---- Validation: 
scalar performance:
{'acc': 0.968923, 'precision': 0.80498564, 'recall': 0.604383, 'specificity': 0.604383, 'f1': 0.6517229, 'auroc': 0.9431969, 'binary_precision': 0.6372093, 'binary_recall': 0.21306376, 'binary_specificity': 0.99570227, 'binary_f1_score': 0.31934732}
confusion matrix:
       0    1
0  18071   78
1    506  137
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96340686, 'precision': 0.98160934, 'recall': 0.56130266, 'specificity': 0.56130266, 'f1': 0.59984744, 'auroc': 0.89648795, 'binary_precision': 1.0, 'binary_recall': 0.12260536, 'binary_specificity': 1.0, 'binary_f1_score': 0.21843004}
confusion matrix:
      0   1
0  5997   0
1   229  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21404213_25.png
early stop counter: 2
val acc:0.9689229726791382, best validation acc: 0.9691889882087708, corresponding to test acc:                         0.9629274606704712 / 0.967082142829895
after epoch: 25,now: 2024-06-18 15:52:17.434234,epoch time: 0:53:00.125229,used: 11:59:09.499424,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_53_07_seed_0_21404213
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9711644, 'precision': 0.7919762, 'recall': 0.7011528, 'specificity': 0.7011528, 'f1': 0.73743, 'auroc': 0.94385755, 'binary_precision': 0.6041874, 'binary_recall': 0.41168478, 'binary_specificity': 0.99062085, 'binary_f1_score': 0.48969695}
confusion matrix:
       0    1
0  41931  397
1    866  606
---- Validation: 
scalar performance:
{'acc': 0.96977437, 'precision': 0.7996036, 'recall': 0.64382666, 'specificity': 0.64382666, 'f1': 0.6920371, 'auroc': 0.9442837, 'binary_precision': 0.62376237, 'binary_recall': 0.29393467, 'binary_specificity': 0.9937187, 'binary_f1_score': 0.39957714}
confusion matrix:
       0    1
0  18035  114
1    454  189
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9651646, 'precision': 0.9824618, 'recall': 0.58237547, 'specificity': 0.58237547, 'f1': 0.6325217, 'auroc': 0.8985047, 'binary_precision': 1.0, 'binary_recall': 0.16475096, 'binary_specificity': 1.0, 'binary_f1_score': 0.28289476}
confusion matrix:
      0   1
0  5997   0
1   218  43
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21404213_26.png
better model found
persisted
after epoch: 26,now: 2024-06-18 16:56:42.605734,epoch time: 1:04:25.171500,used: 13:03:34.670924,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_53_07_seed_0_21404213
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.97118723, 'precision': 0.79661965, 'recall': 0.6865287, 'specificity': 0.6865287, 'f1': 0.7279141, 'auroc': 0.94328785, 'binary_precision': 0.61445785, 'binary_recall': 0.38137323, 'binary_specificity': 0.9916842, 'binary_f1_score': 0.47063762}
confusion matrix:
       0    1
0  41977  352
1    910  561
---- Validation: 
scalar performance:
{'acc': 0.969189, 'precision': 0.8056304, 'recall': 0.61277133, 'specificity': 0.61277133, 'f1': 0.6612565, 'auroc': 0.94469273, 'binary_precision': 0.63793105, 'binary_recall': 0.23017107, 'binary_specificity': 0.99537164, 'binary_f1_score': 0.3382857}
confusion matrix:
       0    1
0  18065   84
1    495  148
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96244806, 'precision': 0.98114574, 'recall': 0.54980844, 'specificity': 0.54980844, 'f1': 0.580984, 'auroc': 0.8960686, 'binary_precision': 1.0, 'binary_recall': 0.099616855, 'binary_specificity': 1.0, 'binary_f1_score': 0.18118466}
confusion matrix:
      0   1
0  5997   0
1   235  26
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21404213_27.png
early stop counter: 1
val acc:0.9691889882087708, best validation acc: 0.9697743654251099, corresponding to test acc:                         0.9651646018028259 / 0.967082142829895
after epoch: 27,now: 2024-06-18 18:18:38.088309,epoch time: 1:21:55.482575,used: 14:25:30.153499,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_53_07_seed_0_21404213
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.97059363, 'precision': 0.79557973, 'recall': 0.6647928, 'specificity': 0.6647928, 'f1': 0.7099958, 'auroc': 0.9448546, 'binary_precision': 0.6138614, 'binary_recall': 0.33695653, 'binary_specificity': 0.992629, 'binary_f1_score': 0.4350877}
confusion matrix:
       0    1
0  42016  312
1    976  496
---- Validation: 
scalar performance:
{'acc': 0.969189, 'precision': 0.81549084, 'recall': 0.60152054, 'specificity': 0.60152054, 'f1': 0.6495165, 'auroc': 0.9429214, 'binary_precision': 0.65841585, 'binary_recall': 0.20684293, 'binary_specificity': 0.9961981, 'binary_f1_score': 0.3147929}
confusion matrix:
       0    1
0  18080   69
1    510  133
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96180886, 'precision': 0.9808371, 'recall': 0.5421456, 'specificity': 0.5421456, 'f1': 0.56796986, 'auroc': 0.8952532, 'binary_precision': 1.0, 'binary_recall': 0.08429119, 'binary_specificity': 1.0, 'binary_f1_score': 0.15547703}
confusion matrix:
      0   1
0  5997   0
1   239  22
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21404213_28.png
early stop counter: 2
val acc:0.9691889882087708, best validation acc: 0.9697743654251099, corresponding to test acc:                         0.9651646018028259 / 0.967082142829895
after epoch: 28,now: 2024-06-18 19:38:48.687737,epoch time: 1:20:10.599428,used: 15:45:40.752927,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_53_07_seed_0_21404213
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.971621, 'precision': 0.7979137, 'recall': 0.7020448, 'specificity': 0.7020448, 'f1': 0.73995537, 'auroc': 0.9447206, 'binary_precision': 0.6160081, 'binary_recall': 0.41304347, 'binary_specificity': 0.99104613, 'binary_f1_score': 0.49451}
confusion matrix:
       0    1
0  41949  379
1    864  608
---- Validation: 
scalar performance:
{'acc': 0.97009367, 'precision': 0.8137309, 'recall': 0.6319911, 'specificity': 0.6319911, 'f1': 0.68286693, 'auroc': 0.9460566, 'binary_precision': 0.6528302, 'binary_recall': 0.2690513, 'binary_specificity': 0.99493086, 'binary_f1_score': 0.38105726}
confusion matrix:
       0    1
0  18057   92
1    470  173
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96356666, 'precision': 0.9816867, 'recall': 0.5632184, 'specificity': 0.5632184, 'f1': 0.60291743, 'auroc': 0.8967014, 'binary_precision': 1.0, 'binary_recall': 0.12643678, 'binary_specificity': 1.0, 'binary_f1_score': 0.2244898}
confusion matrix:
      0   1
0  5997   0
1   228  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21404213_29.png
better model found
persisted
after epoch: 29,now: 2024-06-18 20:20:13.936992,epoch time: 0:41:25.249255,used: 16:27:06.002182,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_53_07_seed_0_21404213
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.97075343, 'precision': 0.7844578, 'recall': 0.71044815, 'specificity': 0.71044815, 'f1': 0.74139106, 'auroc': 0.94323933, 'binary_precision': 0.5885079, 'binary_recall': 0.43138587, 'binary_specificity': 0.9895105, 'binary_f1_score': 0.497844}
confusion matrix:
       0    1
0  41884  444
1    837  635
---- Validation: 
scalar performance:
{'acc': 0.97051936, 'precision': 0.81846106, 'recall': 0.638962, 'specificity': 0.638962, 'f1': 0.6907024, 'auroc': 0.9461506, 'binary_precision': 0.6618182, 'binary_recall': 0.2830482, 'binary_specificity': 0.9948757, 'binary_f1_score': 0.39651418}
confusion matrix:
       0    1
0  18056   93
1    461  182
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96180886, 'precision': 0.9808371, 'recall': 0.5421456, 'specificity': 0.5421456, 'f1': 0.56796986, 'auroc': 0.89508307, 'binary_precision': 1.0, 'binary_recall': 0.08429119, 'binary_specificity': 1.0, 'binary_f1_score': 0.15547703}
confusion matrix:
      0   1
0  5997   0
1   239  22
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21404213_30.png
better model found
persisted
after epoch: 30,now: 2024-06-18 20:42:44.945851,epoch time: 0:22:31.008859,used: 16:49:37.011041,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_53_07_seed_0_21404213
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 16:49:37.011041 at 2024-06-18 20:42:44.945851
persisted model performance metric: 

scalar performance:
{'acc': 0.96180886, 'precision': 0.9808371, 'recall': 0.5421456, 'specificity': 0.5421456, 'f1': 0.56796986, 'auroc': 0.89508307, 'binary_precision': 1.0, 'binary_recall': 0.08429119, 'binary_specificity': 1.0, 'binary_f1_score': 0.15547703}
confusion matrix:
      0   1
0  5997   0
1   239  22
oracle model performance metric: 

scalar performance:
{'acc': 0.96708214, 'precision': 0.9746985, 'recall': 0.60719633, 'specificity': 0.60719633, 'f1': 0.66765666, 'auroc': 0.8940176, 'binary_precision': 0.98245615, 'binary_recall': 0.21455939, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.35220128}
confusion matrix:
      0   1
0  5996   1
1   205  56
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4_rest/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4_rest/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204178 KiB |   1436 MiB | 404959 GiB | 404959 GiB |
|       from large pool | 167936 KiB |   1366 MiB | 404885 GiB | 404884 GiB |
|       from small pool |  36242 KiB |     72 MiB |     74 GiB |     74 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 204178 KiB |   1436 MiB | 404959 GiB | 404959 GiB |
|       from large pool | 167936 KiB |   1366 MiB | 404885 GiB | 404884 GiB |
|       from small pool |  36242 KiB |     72 MiB |     74 GiB |     74 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201088 KiB |   1428 MiB | 404936 GiB | 404936 GiB |
|       from large pool | 165120 KiB |   1358 MiB | 404864 GiB | 404864 GiB |
|       from small pool |  35968 KiB |     71 MiB |     71 GiB |     71 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1524 MiB |   1524 MiB |   1524 MiB |      0 B   |
|       from large pool |   1450 MiB |   1450 MiB |   1450 MiB |      0 B   |
|       from small pool |     74 MiB |     74 MiB |     74 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 320109 KiB | 749313 KiB | 302188 GiB | 302187 GiB |
|       from large pool | 311296 KiB | 748328 KiB | 302106 GiB | 302106 GiB |
|       from small pool |   8813 KiB |  12610 KiB |     81 GiB |     81 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1278    |    1935    |   13356 K  |   13354 K  |
|       from large pool |      36    |      76    |    5312 K  |    5312 K  |
|       from small pool |    1242    |    1864    |    8043 K  |    8042 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1278    |    1935    |   13356 K  |   13354 K  |
|       from large pool |      36    |      76    |    5312 K  |    5312 K  |
|       from small pool |    1242    |    1864    |    8043 K  |    8042 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      50    |      50    |      50    |       0    |
|       from large pool |      13    |      13    |      13    |       0    |
|       from small pool |      37    |      37    |      37    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      35    |     452    |    7142 K  |    7142 K  |
|       from large pool |       5    |      10    |    1973 K  |    1973 K  |
|       from small pool |      30    |     447    |    5168 K  |    5168 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1436 MiB | 404959 GiB | 404959 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 404885 GiB | 404885 GiB |
|       from small pool |      0 KiB |     72 MiB |     74 GiB |     74 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1436 MiB | 404959 GiB | 404959 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 404885 GiB | 404885 GiB |
|       from small pool |      0 KiB |     72 MiB |     74 GiB |     74 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1428 MiB | 404936 GiB | 404936 GiB |
|       from large pool |  16640 KiB |   1358 MiB | 404864 GiB | 404864 GiB |
|       from small pool |      0 KiB |     71 MiB |     71 GiB |     71 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 524288 KiB |   1524 MiB |   1524 MiB |   1012 MiB |
|       from large pool | 479232 KiB |   1450 MiB |   1450 MiB |    982 MiB |
|       from small pool |  45056 KiB |     74 MiB |     74 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 298752 KiB | 749313 KiB | 302188 GiB | 302188 GiB |
|       from large pool | 298752 KiB | 748328 KiB | 302106 GiB | 302106 GiB |
|       from small pool |      0 KiB |  16408 KiB |     81 GiB |     81 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1935    |   13356 K  |   13356 K  |
|       from large pool |       2    |      76    |    5312 K  |    5312 K  |
|       from small pool |       0    |    1864    |    8043 K  |    8043 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1935    |   13356 K  |   13356 K  |
|       from large pool |       2    |      76    |    5312 K  |    5312 K  |
|       from small pool |       0    |    1864    |    8043 K  |    8043 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      50    |      50    |      19    |
|       from large pool |       9    |      13    |      13    |       4    |
|       from small pool |      22    |      37    |      37    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     452    |    7142 K  |    7142 K  |
|       from large pool |       1    |      11    |    1973 K  |    1973 K  |
|       from small pool |       0    |     447    |    5168 K  |    5168 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

