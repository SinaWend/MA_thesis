Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0




!!!: not committed yet



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_58_29_seed_0_21405195

 Experiment start at: 2024-06-18 03:58:29.860696
before training, model accuracy: 0.31128156185150146
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9663927, 'precision': 0.48319635, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49145457, 'auroc': 0.72652364, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42328  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.6955106, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.70465314, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21405195_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-18 04:26:08.239372,epoch time: 0:27:38.378676,used: 0:27:38.378676,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_58_29_seed_0_21405195
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9664155, 'precision': 0.74260515, 'recall': 0.50460184, 'specificity': 0.50460184, 'f1': 0.5007973, 'auroc': 0.85265315, 'binary_precision': 0.5185185, 'binary_recall': 0.009510869, 'binary_specificity': 0.99969286, 'binary_f1_score': 0.018679118}
confusion matrix:
       0   1
0  42315  13
1   1458  14
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.846413, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.8399409, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21405195_2.png
early stop counter: 1
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 2,now: 2024-06-18 04:52:45.549712,epoch time: 0:26:37.310340,used: 0:54:15.689016,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_58_29_seed_0_21405195
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9663927, 'precision': 0.7344812, 'recall': 0.53934336, 'specificity': 0.53934336, 'f1': 0.56152415, 'auroc': 0.8926275, 'binary_precision': 0.5, 'binary_recall': 0.08152174, 'binary_specificity': 0.997165, 'binary_f1_score': 0.14018692}
confusion matrix:
       0    1
0  42208  120
1   1352  120
---- Validation: 
scalar performance:
{'acc': 0.9657301, 'precision': 0.7246176, 'recall': 0.51047325, 'specificity': 0.51047325, 'f1': 0.5121099, 'auroc': 0.8831899, 'binary_precision': 0.4827586, 'binary_recall': 0.02177294, 'binary_specificity': 0.9991735, 'binary_f1_score': 0.041666668}
confusion matrix:
       0   1
0  18134  15
1    629  14
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.98006725, 'recall': 0.5229885, 'specificity': 0.5229885, 'f1': 0.533787, 'auroc': 0.86894214, 'binary_precision': 1.0, 'binary_recall': 0.04597701, 'binary_specificity': 1.0, 'binary_f1_score': 0.08791209}
confusion matrix:
      0   1
0  5997   0
1   249  12
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21405195_3.png
new oracle model saved
early stop counter: 2
val acc:0.9657300710678101, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.960210919380188
after epoch: 3,now: 2024-06-18 05:18:20.899009,epoch time: 0:25:35.349297,used: 1:19:51.038313,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_58_29_seed_0_21405195
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9658904, 'precision': 0.72459584, 'recall': 0.5771154, 'specificity': 0.5771154, 'f1': 0.6113175, 'auroc': 0.9029096, 'binary_precision': 0.4777328, 'binary_recall': 0.1603261, 'binary_specificity': 0.99390477, 'binary_f1_score': 0.24008138}
confusion matrix:
       0    1
0  42070  258
1   1236  236
---- Validation: 
scalar performance:
{'acc': 0.96631545, 'precision': 0.7619239, 'recall': 0.53777826, 'specificity': 0.53777826, 'f1': 0.5596242, 'auroc': 0.89488435, 'binary_precision': 0.5555556, 'binary_recall': 0.077760495, 'binary_specificity': 0.997796, 'binary_f1_score': 0.13642564}
confusion matrix:
       0   1
0  18109  40
1    593  50
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96260786, 'precision': 0.9812229, 'recall': 0.55172414, 'specificity': 0.55172414, 'f1': 0.5841818, 'auroc': 0.87710524, 'binary_precision': 1.0, 'binary_recall': 0.10344828, 'binary_specificity': 1.0, 'binary_f1_score': 0.1875}
confusion matrix:
      0   1
0  5997   0
1   234  27
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21405195_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-18 05:51:21.803604,epoch time: 0:33:00.904595,used: 1:52:51.942908,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_58_29_seed_0_21405195
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96694064, 'precision': 0.7458976, 'recall': 0.6143793, 'specificity': 0.6143793, 'f1': 0.65384126, 'auroc': 0.90855825, 'binary_precision': 0.51785713, 'binary_recall': 0.23641305, 'binary_specificity': 0.9923455, 'binary_f1_score': 0.32462686}
confusion matrix:
       0    1
0  42004  324
1   1124  348
---- Validation: 
scalar performance:
{'acc': 0.9671137, 'precision': 0.7770345, 'recall': 0.56594354, 'specificity': 0.56594354, 'f1': 0.6014499, 'auroc': 0.9068264, 'binary_precision': 0.58389264, 'binary_recall': 0.13530326, 'binary_specificity': 0.9965838, 'binary_f1_score': 0.21969695}
confusion matrix:
       0   1
0  18087  62
1    556  87
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.965644, 'precision': 0.98269475, 'recall': 0.5881226, 'specificity': 0.5881226, 'f1': 0.64103216, 'auroc': 0.8811519, 'binary_precision': 1.0, 'binary_recall': 0.17624521, 'binary_specificity': 1.0, 'binary_f1_score': 0.29967427}
confusion matrix:
      0   1
0  5997   0
1   215  46
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21405195_5.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-06-18 06:20:45.017196,epoch time: 0:29:23.213592,used: 2:22:15.156500,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_58_29_seed_0_21405195
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9670776, 'precision': 0.7479929, 'recall': 0.61805665, 'specificity': 0.61805665, 'f1': 0.65776503, 'auroc': 0.9157062, 'binary_precision': 0.5218023, 'binary_recall': 0.24388587, 'binary_specificity': 0.9922274, 'binary_f1_score': 0.3324074}
confusion matrix:
       0    1
0  41999  329
1   1113  359
---- Validation: 
scalar performance:
{'acc': 0.9669008, 'precision': 0.7707237, 'recall': 0.5635832, 'specificity': 0.5635832, 'f1': 0.59787667, 'auroc': 0.9128643, 'binary_precision': 0.5714286, 'binary_recall': 0.13063763, 'binary_specificity': 0.99652874, 'binary_f1_score': 0.21265823}
confusion matrix:
       0   1
0  18086  63
1    559  84
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9651646, 'precision': 0.97142553, 'recall': 0.5842078, 'specificity': 0.5842078, 'f1': 0.63486373, 'auroc': 0.8867486, 'binary_precision': 0.9777778, 'binary_recall': 0.16858238, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.2875817}
confusion matrix:
      0   1
0  5996   1
1   217  44
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21405195_6.png
early stop counter: 1
val acc:0.9669008255004883, best validation acc: 0.9671136736869812, corresponding to test acc:                         0.9656440019607544 / 0.9656440019607544
after epoch: 6,now: 2024-06-18 06:56:26.201313,epoch time: 0:35:41.184117,used: 2:57:56.340617,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_58_29_seed_0_21405195
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96812785, 'precision': 0.7620894, 'recall': 0.6399972, 'specificity': 0.6399972, 'f1': 0.68077075, 'auroc': 0.91866946, 'binary_precision': 0.5485123, 'binary_recall': 0.2882393, 'binary_specificity': 0.99175507, 'binary_f1_score': 0.3778966}
confusion matrix:
       0    1
0  41980  349
1   1047  424
---- Validation: 
scalar performance:
{'acc': 0.96722007, 'precision': 0.7753084, 'recall': 0.57424927, 'specificity': 0.57424927, 'f1': 0.61231375, 'auroc': 0.9171189, 'binary_precision': 0.57988167, 'binary_recall': 0.15241058, 'binary_specificity': 0.99608797, 'binary_f1_score': 0.24137934}
confusion matrix:
       0   1
0  18078  71
1    545  98
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96724194, 'precision': 0.98347306, 'recall': 0.6072797, 'specificity': 0.6072797, 'f1': 0.6682538, 'auroc': 0.8895861, 'binary_precision': 1.0, 'binary_recall': 0.21455939, 'binary_specificity': 1.0, 'binary_f1_score': 0.35331228}
confusion matrix:
      0   1
0  5997   0
1   205  56
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21405195_7.png
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-06-18 07:26:18.616112,epoch time: 0:29:52.414799,used: 3:27:48.755416,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_58_29_seed_0_21405195
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9675114, 'precision': 0.7535479, 'recall': 0.63500196, 'specificity': 0.63500196, 'f1': 0.67445534, 'auroc': 0.9244987, 'binary_precision': 0.5317769, 'binary_recall': 0.2785326, 'binary_specificity': 0.99147135, 'binary_f1_score': 0.36558178}
confusion matrix:
       0    1
0  41967  361
1   1062  410
---- Validation: 
scalar performance:
{'acc': 0.9672733, 'precision': 0.78121895, 'recall': 0.56827635, 'specificity': 0.56827635, 'f1': 0.6048491, 'auroc': 0.9209398, 'binary_precision': 0.59210527, 'binary_recall': 0.1399689, 'binary_specificity': 0.9965838, 'binary_f1_score': 0.22641511}
confusion matrix:
       0   1
0  18087  62
1    553  90
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964845, 'precision': 0.9823066, 'recall': 0.5785441, 'specificity': 0.5785441, 'f1': 0.6267555, 'auroc': 0.89098746, 'binary_precision': 1.0, 'binary_recall': 0.15708812, 'binary_specificity': 1.0, 'binary_f1_score': 0.27152315}
confusion matrix:
      0   1
0  5997   0
1   220  41
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21405195_8.png
better model found
persisted
after epoch: 8,now: 2024-06-18 08:03:32.934446,epoch time: 0:37:14.318334,used: 4:05:03.073750,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_58_29_seed_0_21405195
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9681507, 'precision': 0.765885, 'recall': 0.6238576, 'specificity': 0.6238576, 'f1': 0.66666293, 'auroc': 0.92597187, 'binary_precision': 0.5572065, 'binary_recall': 0.25475544, 'binary_specificity': 0.99295974, 'binary_f1_score': 0.34965032}
confusion matrix:
       0    1
0  42030  298
1   1097  375
---- Validation: 
scalar performance:
{'acc': 0.96722007, 'precision': 0.78493863, 'recall': 0.56149834, 'specificity': 0.56149834, 'f1': 0.5957449, 'auroc': 0.92492276, 'binary_precision': 0.6, 'binary_recall': 0.125972, 'binary_specificity': 0.99702466, 'binary_f1_score': 0.2082262}
confusion matrix:
       0   1
0  18095  54
1    562  81
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96260786, 'precision': 0.9640558, 'recall': 0.55355644, 'specificity': 0.55355644, 'f1': 0.58698195, 'auroc': 0.8899188, 'binary_precision': 0.9655172, 'binary_recall': 0.107279696, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.19310345}
confusion matrix:
      0   1
0  5996   1
1   233  28
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21405195_9.png
early stop counter: 1
val acc:0.9672200679779053, best validation acc: 0.9672732949256897, corresponding to test acc:                         0.9648450016975403 / 0.9672419428825378
after epoch: 9,now: 2024-06-18 08:38:23.929945,epoch time: 0:34:50.995499,used: 4:39:54.069249,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_58_29_seed_0_21405195
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9677169, 'precision': 0.75484574, 'recall': 0.65379643, 'specificity': 0.65379643, 'f1': 0.6905996, 'auroc': 0.9271976, 'binary_precision': 0.533105, 'binary_recall': 0.31725544, 'binary_specificity': 0.9903374, 'binary_f1_score': 0.39778534}
confusion matrix:
       0    1
0  41919  409
1   1005  467
---- Validation: 
scalar performance:
{'acc': 0.967699, 'precision': 0.7753927, 'recall': 0.60074914, 'specificity': 0.60074914, 'f1': 0.644081, 'auroc': 0.9287118, 'binary_precision': 0.5782609, 'binary_recall': 0.20684293, 'binary_specificity': 0.9946554, 'binary_f1_score': 0.30469647}
confusion matrix:
       0    1
0  18052   97
1    510  133
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9653244, 'precision': 0.9825394, 'recall': 0.5842912, 'specificity': 0.5842912, 'f1': 0.6353768, 'auroc': 0.8933277, 'binary_precision': 1.0, 'binary_recall': 0.16858238, 'binary_specificity': 1.0, 'binary_f1_score': 0.28852457}
confusion matrix:
      0   1
0  5997   0
1   217  44
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21405195_10.png
better model found
persisted
after epoch: 10,now: 2024-06-18 09:18:46.876103,epoch time: 0:40:22.946158,used: 5:20:17.015407,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_58_29_seed_0_21405195
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96803653, 'precision': 0.761214, 'recall': 0.6385523, 'specificity': 0.6385523, 'f1': 0.6792994, 'auroc': 0.92969394, 'binary_precision': 0.546875, 'binary_recall': 0.2853261, 'binary_specificity': 0.9917785, 'binary_f1_score': 0.37499997}
confusion matrix:
       0    1
0  41980  348
1   1052  420
---- Validation: 
scalar performance:
{'acc': 0.9673265, 'precision': 0.7756014, 'recall': 0.57955474, 'specificity': 0.57955474, 'f1': 0.6190757, 'auroc': 0.93171436, 'binary_precision': 0.5801105, 'binary_recall': 0.16329704, 'binary_specificity': 0.9958124, 'binary_f1_score': 0.25485435}
confusion matrix:
       0    1
0  18073   76
1    538  105
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96356666, 'precision': 0.96747553, 'recall': 0.5650507, 'specificity': 0.5650507, 'f1': 0.6055359, 'auroc': 0.89467096, 'binary_precision': 0.9714286, 'binary_recall': 0.1302682, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.22972974}
confusion matrix:
      0   1
0  5996   1
1   227  34
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21405195_11.png
early stop counter: 1
val acc:0.9673265218734741, best validation acc: 0.9676989912986755, corresponding to test acc:                         0.9653244018554688 / 0.9672419428825378
after epoch: 11,now: 2024-06-18 10:01:52.155341,epoch time: 0:43:05.279238,used: 6:03:22.294645,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_58_29_seed_0_21405195
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.96865296, 'precision': 0.7706774, 'recall': 0.6380569, 'specificity': 0.6380569, 'f1': 0.680905, 'auroc': 0.9280045, 'binary_precision': 0.56580734, 'binary_recall': 0.28367347, 'binary_specificity': 0.99244034, 'binary_f1_score': 0.37788856}
confusion matrix:
       0    1
0  42010  320
1   1053  417
---- Validation: 
scalar performance:
{'acc': 0.967433, 'precision': 0.7740292, 'recall': 0.58861053, 'specificity': 0.58861053, 'f1': 0.62996864, 'auroc': 0.9326739, 'binary_precision': 0.5763547, 'binary_recall': 0.18195957, 'binary_specificity': 0.99526143, 'binary_f1_score': 0.27659574}
confusion matrix:
       0    1
0  18063   86
1    526  117
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9638862, 'precision': 0.98184156, 'recall': 0.5670498, 'specificity': 0.5670498, 'f1': 0.60899615, 'auroc': 0.893707, 'binary_precision': 1.0, 'binary_recall': 0.13409962, 'binary_specificity': 1.0, 'binary_f1_score': 0.2364865}
confusion matrix:
      0   1
0  5997   0
1   226  35
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21405195_12.png
early stop counter: 2
val acc:0.967432975769043, best validation acc: 0.9676989912986755, corresponding to test acc:                         0.9653244018554688 / 0.9672419428825378
after epoch: 12,now: 2024-06-18 10:41:44.642332,epoch time: 0:39:52.486991,used: 6:43:14.781636,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_58_29_seed_0_21405195
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9687671, 'precision': 0.7629607, 'recall': 0.7038469, 'specificity': 0.7038469, 'f1': 0.72927976, 'auroc': 0.9358724, 'binary_precision': 0.5459364, 'binary_recall': 0.41983697, 'binary_specificity': 0.98785675, 'binary_f1_score': 0.4746544}
confusion matrix:
       0    1
0  41814  514
1    854  618
---- Validation: 
scalar performance:
{'acc': 0.96780545, 'precision': 0.7688503, 'recall': 0.62780625, 'specificity': 0.62780625, 'f1': 0.67095953, 'auroc': 0.9350538, 'binary_precision': 0.56333333, 'binary_recall': 0.2628305, 'binary_specificity': 0.992782, 'binary_f1_score': 0.35843056}
confusion matrix:
       0    1
0  18018  131
1    474  169
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9680409, 'precision': 0.97600216, 'recall': 0.61869055, 'specificity': 0.61869055, 'f1': 0.68315595, 'auroc': 0.897132, 'binary_precision': 0.984127, 'binary_recall': 0.23754789, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.38271603}
confusion matrix:
      0   1
0  5996   1
1   199  62
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21405195_13.png
new oracle model saved
better model found
persisted
after epoch: 13,now: 2024-06-18 11:22:09.645628,epoch time: 0:40:25.003296,used: 7:23:39.784932,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_58_29_seed_0_21405195
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9681735, 'precision': 0.75795156, 'recall': 0.68583524, 'specificity': 0.68583524, 'f1': 0.71543956, 'auroc': 0.9304448, 'binary_precision': 0.5371429, 'binary_recall': 0.3831522, 'binary_specificity': 0.98851824, 'binary_f1_score': 0.44726408}
confusion matrix:
       0    1
0  41842  486
1    908  564
---- Validation: 
scalar performance:
{'acc': 0.96796507, 'precision': 0.77417666, 'recall': 0.61963826, 'specificity': 0.61963826, 'f1': 0.6639041, 'auroc': 0.9361513, 'binary_precision': 0.57454544, 'binary_recall': 0.24572317, 'binary_specificity': 0.99355334, 'binary_f1_score': 0.34422657}
confusion matrix:
       0    1
0  18032  117
1    485  158
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9651646, 'precision': 0.97142553, 'recall': 0.5842078, 'specificity': 0.5842078, 'f1': 0.63486373, 'auroc': 0.8950923, 'binary_precision': 0.9777778, 'binary_recall': 0.16858238, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.2875817}
confusion matrix:
      0   1
0  5996   1
1   217  44
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21405195_14.png
better model found
persisted
after epoch: 14,now: 2024-06-18 12:15:18.240499,epoch time: 0:53:08.594871,used: 8:16:48.379803,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_58_29_seed_0_21405195
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9687671, 'precision': 0.7662033, 'recall': 0.67499506, 'specificity': 0.67499506, 'f1': 0.71025586, 'auroc': 0.93398046, 'binary_precision': 0.5543933, 'binary_recall': 0.36005434, 'binary_specificity': 0.98993576, 'binary_f1_score': 0.43657327}
confusion matrix:
       0    1
0  41902  426
1    942  530
---- Validation: 
scalar performance:
{'acc': 0.9678587, 'precision': 0.777531, 'recall': 0.6045821, 'specificity': 0.6045821, 'f1': 0.6485902, 'auroc': 0.9372077, 'binary_precision': 0.5822785, 'binary_recall': 0.21461898, 'binary_specificity': 0.99454516, 'binary_f1_score': 0.31363636}
confusion matrix:
       0    1
0  18050   99
1    505  138
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96356666, 'precision': 0.9816867, 'recall': 0.5632184, 'specificity': 0.5632184, 'f1': 0.60291743, 'auroc': 0.89355963, 'binary_precision': 1.0, 'binary_recall': 0.12643678, 'binary_specificity': 1.0, 'binary_f1_score': 0.2244898}
confusion matrix:
      0   1
0  5997   0
1   228  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21405195_15.png
early stop counter: 1
val acc:0.9678586721420288, best validation acc: 0.9679650664329529, corresponding to test acc:                         0.9651646018028259 / 0.9680408835411072
after epoch: 15,now: 2024-06-18 13:08:25.629381,epoch time: 0:53:07.388882,used: 9:09:55.768685,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_58_29_seed_0_21405195
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9691096, 'precision': 0.7719945, 'recall': 0.6676314, 'specificity': 0.6676314, 'f1': 0.7062581, 'auroc': 0.93599474, 'binary_precision': 0.56648046, 'binary_recall': 0.34442934, 'binary_specificity': 0.99083346, 'binary_f1_score': 0.42839038}
confusion matrix:
       0    1
0  41940  388
1    965  507
---- Validation: 
scalar performance:
{'acc': 0.9680715, 'precision': 0.7857303, 'recall': 0.5986918, 'specificity': 0.5986918, 'f1': 0.64299375, 'auroc': 0.9370872, 'binary_precision': 0.59907836, 'binary_recall': 0.2021773, 'binary_specificity': 0.99520636, 'binary_f1_score': 0.30232558}
confusion matrix:
       0    1
0  18062   87
1    513  130
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96340686, 'precision': 0.98160934, 'recall': 0.56130266, 'specificity': 0.56130266, 'f1': 0.59984744, 'auroc': 0.89168096, 'binary_precision': 1.0, 'binary_recall': 0.12260536, 'binary_specificity': 1.0, 'binary_f1_score': 0.21843004}
confusion matrix:
      0   1
0  5997   0
1   229  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21405195_16.png
better model found
persisted
after epoch: 16,now: 2024-06-18 13:48:34.315981,epoch time: 0:40:08.686600,used: 9:50:04.455285,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_58_29_seed_0_21405195
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9697032, 'precision': 0.77811563, 'recall': 0.67777437, 'specificity': 0.67777437, 'f1': 0.7158692, 'auroc': 0.93722296, 'binary_precision': 0.5780409, 'binary_recall': 0.36480978, 'binary_specificity': 0.990739, 'binary_f1_score': 0.4473136}
confusion matrix:
       0    1
0  41936  392
1    935  537
---- Validation: 
scalar performance:
{'acc': 0.9684972, 'precision': 0.78950906, 'recall': 0.6109131, 'specificity': 0.6109131, 'f1': 0.657093, 'auroc': 0.9387469, 'binary_precision': 0.60580915, 'binary_recall': 0.22706065, 'binary_specificity': 0.9947656, 'binary_f1_score': 0.33031675}
confusion matrix:
       0    1
0  18054   95
1    497  146
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96292746, 'precision': 0.9813774, 'recall': 0.5555556, 'specificity': 0.5555556, 'f1': 0.59051204, 'auroc': 0.894199, 'binary_precision': 1.0, 'binary_recall': 0.11111111, 'binary_specificity': 1.0, 'binary_f1_score': 0.19999999}
confusion matrix:
      0   1
0  5997   0
1   232  29
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21405195_17.png
better model found
persisted
after epoch: 17,now: 2024-06-18 14:26:24.398561,epoch time: 0:37:50.082580,used: 10:27:54.537865,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_58_29_seed_0_21405195
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.96940637, 'precision': 0.7748388, 'recall': 0.67401433, 'specificity': 0.67401433, 'f1': 0.7120366, 'auroc': 0.93677473, 'binary_precision': 0.57173914, 'binary_recall': 0.35733697, 'binary_specificity': 0.9906917, 'binary_f1_score': 0.43979937}
confusion matrix:
       0    1
0  41934  394
1    946  526
---- Validation: 
scalar performance:
{'acc': 0.96828437, 'precision': 0.7872889, 'recall': 0.60555255, 'specificity': 0.60555255, 'f1': 0.6509212, 'auroc': 0.94011706, 'binary_precision': 0.6017316, 'binary_recall': 0.21617419, 'binary_specificity': 0.99493086, 'binary_f1_score': 0.3180778}
confusion matrix:
       0    1
0  18057   92
1    504  139
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.98145473, 'recall': 0.5574713, 'specificity': 0.5574713, 'f1': 0.5936449, 'auroc': 0.89485466, 'binary_precision': 1.0, 'binary_recall': 0.11494253, 'binary_specificity': 1.0, 'binary_f1_score': 0.20618556}
confusion matrix:
      0   1
0  5997   0
1   231  30
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21405195_18.png
early stop counter: 1
val acc:0.9682843685150146, best validation acc: 0.9684972167015076, corresponding to test acc:                         0.9629274606704712 / 0.9680408835411072
after epoch: 18,now: 2024-06-18 15:13:24.802592,epoch time: 0:47:00.404031,used: 11:14:54.941896,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_58_29_seed_0_21405195
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.96952057, 'precision': 0.78344643, 'recall': 0.6478445, 'specificity': 0.6478445, 'f1': 0.69245076, 'auroc': 0.9357672, 'binary_precision': 0.59072846, 'binary_recall': 0.30298913, 'binary_specificity': 0.99269986, 'binary_f1_score': 0.40053883}
confusion matrix:
       0    1
0  42019  309
1   1026  446
---- Validation: 
scalar performance:
{'acc': 0.9683376, 'precision': 0.80545485, 'recall': 0.58382845, 'specificity': 0.58382845, 'f1': 0.62687826, 'auroc': 0.940113, 'binary_precision': 0.6395349, 'binary_recall': 0.1710731, 'binary_specificity': 0.9965838, 'binary_f1_score': 0.26993865}
confusion matrix:
       0    1
0  18087   62
1    533  110
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9610099, 'precision': 0.9804518, 'recall': 0.532567, 'specificity': 0.532567, 'f1': 0.55118215, 'auroc': 0.892681, 'binary_precision': 1.0, 'binary_recall': 0.0651341, 'binary_specificity': 1.0, 'binary_f1_score': 0.12230217}
confusion matrix:
      0   1
0  5997   0
1   244  17
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21405195_19.png
early stop counter: 2
val acc:0.9683375954627991, best validation acc: 0.9684972167015076, corresponding to test acc:                         0.9629274606704712 / 0.9680408835411072
after epoch: 19,now: 2024-06-18 16:13:41.282814,epoch time: 1:00:16.480222,used: 12:15:11.422118,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_58_29_seed_0_21405195
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9703196, 'precision': 0.78558326, 'recall': 0.6823555, 'specificity': 0.6823555, 'f1': 0.72153753, 'auroc': 0.9393989, 'binary_precision': 0.5926724, 'binary_recall': 0.3736413, 'binary_specificity': 0.99106973, 'binary_f1_score': 0.45833334}
confusion matrix:
       0    1
0  41950  378
1    922  550
---- Validation: 
scalar performance:
{'acc': 0.969189, 'precision': 0.8045125, 'recall': 0.61427146, 'specificity': 0.61427146, 'f1': 0.6627612, 'auroc': 0.9421878, 'binary_precision': 0.63559324, 'binary_recall': 0.2332815, 'binary_specificity': 0.99526143, 'binary_f1_score': 0.34129694}
confusion matrix:
       0    1
0  18063   86
1    493  150
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96324706, 'precision': 0.98153204, 'recall': 0.55938697, 'specificity': 0.55938697, 'f1': 0.59675664, 'auroc': 0.89463615, 'binary_precision': 1.0, 'binary_recall': 0.118773945, 'binary_specificity': 1.0, 'binary_f1_score': 0.21232876}
confusion matrix:
      0   1
0  5997   0
1   230  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21405195_20.png
better model found
persisted
after epoch: 20,now: 2024-06-18 17:39:16.542955,epoch time: 1:25:35.260141,used: 13:40:46.682259,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_58_29_seed_0_21405195
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.970548, 'precision': 0.79172176, 'recall': 0.67329353, 'specificity': 0.67329353, 'f1': 0.71608585, 'auroc': 0.9394692, 'binary_precision': 0.60556847, 'binary_recall': 0.35461956, 'binary_specificity': 0.9919675, 'binary_f1_score': 0.4473008}
confusion matrix:
       0    1
0  41988  340
1    950  522
---- Validation: 
scalar performance:
{'acc': 0.9684972, 'precision': 0.7972019, 'recall': 0.59891224, 'specificity': 0.59891224, 'f1': 0.6445238, 'auroc': 0.9403702, 'binary_precision': 0.6220096, 'binary_recall': 0.2021773, 'binary_specificity': 0.99564713, 'binary_f1_score': 0.30516434}
confusion matrix:
       0    1
0  18070   79
1    513  130
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96276766, 'precision': 0.9813002, 'recall': 0.5536398, 'specificity': 0.5536398, 'f1': 0.5873577, 'auroc': 0.89435524, 'binary_precision': 1.0, 'binary_recall': 0.107279696, 'binary_specificity': 1.0, 'binary_f1_score': 0.19377163}
confusion matrix:
      0   1
0  5997   0
1   233  28
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21405195_21.png
early stop counter: 1
val acc:0.9684972167015076, best validation acc: 0.9691889882087708, corresponding to test acc:                         0.9632470607757568 / 0.9680408835411072
after epoch: 21,now: 2024-06-18 19:15:08.210342,epoch time: 1:35:51.667387,used: 15:16:38.349646,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_58_29_seed_0_21405195
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.96940637, 'precision': 0.7754543, 'recall': 0.6710636, 'specificity': 0.6710636, 'f1': 0.70991445, 'auroc': 0.9404173, 'binary_precision': 0.5731707, 'binary_recall': 0.3512228, 'binary_specificity': 0.9909044, 'binary_f1_score': 0.4355518}
confusion matrix:
       0    1
0  41943  385
1    955  517
---- Validation: 
scalar performance:
{'acc': 0.96855044, 'precision': 0.8010962, 'recall': 0.5959395, 'specificity': 0.5959395, 'f1': 0.6414234, 'auroc': 0.94134533, 'binary_precision': 0.63, 'binary_recall': 0.19595645, 'binary_specificity': 0.9959226, 'binary_f1_score': 0.29893237}
confusion matrix:
       0    1
0  18075   74
1    517  126
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96180886, 'precision': 0.9808371, 'recall': 0.5421456, 'specificity': 0.5421456, 'f1': 0.56796986, 'auroc': 0.8936047, 'binary_precision': 1.0, 'binary_recall': 0.08429119, 'binary_specificity': 1.0, 'binary_f1_score': 0.15547703}
confusion matrix:
      0   1
0  5997   0
1   239  22
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21405195_22.png
early stop counter: 2
val acc:0.968550443649292, best validation acc: 0.9691889882087708, corresponding to test acc:                         0.9632470607757568 / 0.9680408835411072
after epoch: 22,now: 2024-06-18 20:20:07.591895,epoch time: 1:04:59.381553,used: 16:21:37.731199,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_58_29_seed_0_21405195
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9701598, 'precision': 0.7955972, 'recall': 0.64564174, 'specificity': 0.64564174, 'f1': 0.69299066, 'auroc': 0.939486, 'binary_precision': 0.6151685, 'binary_recall': 0.29775664, 'binary_specificity': 0.9935269, 'binary_f1_score': 0.40128267}
confusion matrix:
       0    1
0  42055  274
1   1033  438
---- Validation: 
scalar performance:
{'acc': 0.968444, 'precision': 0.8092184, 'recall': 0.5838836, 'specificity': 0.5838836, 'f1': 0.627238, 'auroc': 0.94135153, 'binary_precision': 0.64705884, 'binary_recall': 0.1710731, 'binary_specificity': 0.996694, 'binary_f1_score': 0.2706027}
confusion matrix:
       0    1
0  18089   60
1    533  110
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9613295, 'precision': 0.98060584, 'recall': 0.5363985, 'specificity': 0.5363985, 'f1': 0.5579683, 'auroc': 0.8958082, 'binary_precision': 1.0, 'binary_recall': 0.07279693, 'binary_specificity': 1.0, 'binary_f1_score': 0.13571428}
confusion matrix:
      0   1
0  5997   0
1   242  19
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21405195_23.png
early stop counter: 3
val acc:0.9684439897537231, best validation acc: 0.9691889882087708, corresponding to test acc:                         0.9632470607757568 / 0.9680408835411072
after epoch: 23,now: 2024-06-18 20:46:26.056447,epoch time: 0:26:18.464552,used: 16:47:56.195751,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_58_29_seed_0_21405195
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9702968, 'precision': 0.78644395, 'recall': 0.6780815, 'specificity': 0.6780815, 'f1': 0.71847254, 'auroc': 0.9437199, 'binary_precision': 0.59468436, 'binary_recall': 0.36480978, 'binary_specificity': 0.9913532, 'binary_f1_score': 0.45221055}
confusion matrix:
       0    1
0  41962  366
1    935  537
---- Validation: 
scalar performance:
{'acc': 0.9691358, 'precision': 0.80969065, 'recall': 0.6059933, 'specificity': 0.6059933, 'f1': 0.65410835, 'auroc': 0.9421308, 'binary_precision': 0.6465116, 'binary_recall': 0.21617419, 'binary_specificity': 0.9958124, 'binary_f1_score': 0.32400933}
confusion matrix:
       0    1
0  18073   76
1    504  139
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96324706, 'precision': 0.9664549, 'recall': 0.5612193, 'specificity': 0.5612193, 'f1': 0.59943426, 'auroc': 0.89623994, 'binary_precision': 0.969697, 'binary_recall': 0.12260536, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.21768707}
confusion matrix:
      0   1
0  5996   1
1   229  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21405195_24.png
early stop counter: 4
val acc:0.9691358208656311, best validation acc: 0.9691889882087708, corresponding to test acc:                         0.9632470607757568 / 0.9680408835411072
after epoch: 24,now: 2024-06-18 21:21:37.094135,epoch time: 0:35:11.037688,used: 17:23:07.233439,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_58_29_seed_0_21405195
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.969863, 'precision': 0.7809504, 'recall': 0.6752342, 'specificity': 0.6752342, 'f1': 0.71471137, 'auroc': 0.93894756, 'binary_precision': 0.5838852, 'binary_recall': 0.359375, 'binary_specificity': 0.99109334, 'binary_f1_score': 0.4449117}
confusion matrix:
       0    1
0  41951  377
1    943  529
---- Validation: 
scalar performance:
{'acc': 0.969189, 'precision': 0.81120193, 'recall': 0.60602087, 'specificity': 0.60602087, 'f1': 0.65431124, 'auroc': 0.94239175, 'binary_precision': 0.64953274, 'binary_recall': 0.21617419, 'binary_specificity': 0.99586755, 'binary_f1_score': 0.3243874}
confusion matrix:
       0    1
0  18074   75
1    504  139
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9637264, 'precision': 0.98176414, 'recall': 0.5651341, 'specificity': 0.5651341, 'f1': 0.6059669, 'auroc': 0.89387226, 'binary_precision': 1.0, 'binary_recall': 0.1302682, 'binary_specificity': 1.0, 'binary_f1_score': 0.23050848}
confusion matrix:
      0   1
0  5997   0
1   227  34
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21405195_25.png
early stop counter: 5
val acc:0.9691889882087708, best validation acc: 0.9691889882087708, corresponding to test acc:                         0.9632470607757568 / 0.9680408835411072
after epoch: 25,now: 2024-06-18 21:47:06.053199,epoch time: 0:25:28.959064,used: 17:48:36.192503,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_58_29_seed_0_21405195
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9703653, 'precision': 0.78705466, 'recall': 0.6794284, 'specificity': 0.6794284, 'f1': 0.7196953, 'auroc': 0.93974805, 'binary_precision': 0.595815, 'binary_recall': 0.3675272, 'binary_specificity': 0.9913296, 'binary_f1_score': 0.45462185}
confusion matrix:
       0    1
0  41961  367
1    931  541
---- Validation: 
scalar performance:
{'acc': 0.9691358, 'precision': 0.8090409, 'recall': 0.60674334, 'specificity': 0.60674334, 'f1': 0.65489393, 'auroc': 0.94337916, 'binary_precision': 0.6451613, 'binary_recall': 0.21772939, 'binary_specificity': 0.99575734, 'binary_f1_score': 0.32558137}
confusion matrix:
       0    1
0  18072   77
1    503  140
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96196866, 'precision': 0.98091424, 'recall': 0.5440613, 'specificity': 0.5440613, 'f1': 0.57125735, 'auroc': 0.89779913, 'binary_precision': 1.0, 'binary_recall': 0.08812261, 'binary_specificity': 1.0, 'binary_f1_score': 0.16197184}
confusion matrix:
      0   1
0  5997   0
1   238  23
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21405195_26.png
early stop counter: 6
val acc:0.9691358208656311, best validation acc: 0.9691889882087708, corresponding to test acc:                         0.9632470607757568 / 0.9680408835411072
after epoch: 26,now: 2024-06-18 22:27:58.886204,epoch time: 0:40:52.833005,used: 18:29:29.025508,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_58_29_seed_0_21405195
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9713927, 'precision': 0.801929, 'recall': 0.68159926, 'specificity': 0.68159926, 'f1': 0.7254873, 'auroc': 0.9427713, 'binary_precision': 0.6254296, 'binary_recall': 0.3709239, 'binary_specificity': 0.99227464, 'binary_f1_score': 0.46567163}
confusion matrix:
       0    1
0  42001  327
1    926  546
---- Validation: 
scalar performance:
{'acc': 0.9694019, 'precision': 0.8196955, 'recall': 0.6038809, 'specificity': 0.6038809, 'f1': 0.65274084, 'auroc': 0.94424003, 'binary_precision': 0.6666667, 'binary_recall': 0.21150856, 'binary_specificity': 0.99625325, 'binary_f1_score': 0.3211334}
confusion matrix:
       0    1
0  18081   68
1    507  136
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614893, 'precision': 0.9806829, 'recall': 0.53831416, 'specificity': 0.53831416, 'f1': 0.56132555, 'auroc': 0.89602864, 'binary_precision': 1.0, 'binary_recall': 0.07662835, 'binary_specificity': 1.0, 'binary_f1_score': 0.14234875}
confusion matrix:
      0   1
0  5997   0
1   241  20
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21405195_27.png
better model found
persisted
after epoch: 27,now: 2024-06-18 22:57:57.412701,epoch time: 0:29:58.526497,used: 18:59:27.552005,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_58_29_seed_0_21405195
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.97075343, 'precision': 0.78656584, 'recall': 0.7012681, 'specificity': 0.7012681, 'f1': 0.73576057, 'auroc': 0.94432086, 'binary_precision': 0.59335285, 'binary_recall': 0.41236413, 'binary_specificity': 0.99017197, 'binary_f1_score': 0.4865731}
confusion matrix:
       0    1
0  41912  416
1    865  607
---- Validation: 
scalar performance:
{'acc': 0.96945506, 'precision': 0.8013315, 'recall': 0.62866026, 'specificity': 0.62866026, 'f1': 0.67748094, 'auroc': 0.9445847, 'binary_precision': 0.6282528, 'binary_recall': 0.2628305, 'binary_specificity': 0.99449, 'binary_f1_score': 0.37061405}
confusion matrix:
       0    1
0  18049  100
1    474  169
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96260786, 'precision': 0.9640558, 'recall': 0.55355644, 'specificity': 0.55355644, 'f1': 0.58698195, 'auroc': 0.89627796, 'binary_precision': 0.9655172, 'binary_recall': 0.107279696, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.19310345}
confusion matrix:
      0   1
0  5996   1
1   233  28
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21405195_28.png
better model found
persisted
after epoch: 28,now: 2024-06-18 23:33:48.585396,epoch time: 0:35:51.172695,used: 19:35:18.724700,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_58_29_seed_0_21405195
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.97050226, 'precision': 0.7902678, 'recall': 0.67556494, 'specificity': 0.67556494, 'f1': 0.7175287, 'auroc': 0.94587874, 'binary_precision': 0.6025057, 'binary_recall': 0.359375, 'binary_specificity': 0.9917549, 'binary_f1_score': 0.45021278}
confusion matrix:
       0    1
0  41979  349
1    943  529
---- Validation: 
scalar performance:
{'acc': 0.9692422, 'precision': 0.8148624, 'recall': 0.6037983, 'specificity': 0.6037983, 'f1': 0.65213263, 'auroc': 0.9451719, 'binary_precision': 0.65700483, 'binary_recall': 0.21150856, 'binary_specificity': 0.99608797, 'binary_f1_score': 0.32000002}
confusion matrix:
       0    1
0  18078   71
1    507  136
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.98052883, 'recall': 0.5344828, 'specificity': 0.5344828, 'f1': 0.55458724, 'auroc': 0.89420974, 'binary_precision': 1.0, 'binary_recall': 0.06896552, 'binary_specificity': 1.0, 'binary_f1_score': 0.12903225}
confusion matrix:
      0   1
0  5997   0
1   243  18
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21405195_29.png
early stop counter: 1
val acc:0.9692422151565552, best validation acc: 0.9694550633430481, corresponding to test acc:                         0.9626078605651855 / 0.9680408835411072
after epoch: 29,now: 2024-06-19 00:14:22.995323,epoch time: 0:40:34.409927,used: 20:15:53.134627,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_58_29_seed_0_21405195
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.97068495, 'precision': 0.78488743, 'recall': 0.70365775, 'specificity': 0.70365775, 'f1': 0.7368816, 'auroc': 0.9437325, 'binary_precision': 0.58981746, 'binary_recall': 0.41740313, 'binary_specificity': 0.98991233, 'binary_f1_score': 0.48885348}
confusion matrix:
       0    1
0  41902  427
1    857  614
---- Validation: 
scalar performance:
{'acc': 0.9702533, 'precision': 0.80780554, 'recall': 0.64632475, 'specificity': 0.64632475, 'f1': 0.69597745, 'auroc': 0.9476373, 'binary_precision': 0.64, 'binary_recall': 0.29860032, 'binary_specificity': 0.99404925, 'binary_f1_score': 0.40721104}
confusion matrix:
       0    1
0  18041  108
1    451  192
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.96590406, 'recall': 0.5593036, 'specificity': 0.5593036, 'f1': 0.59635264, 'auroc': 0.8984946, 'binary_precision': 0.96875, 'binary_recall': 0.118773945, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.21160409}
confusion matrix:
      0   1
0  5996   1
1   230  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21405195_30.png
better model found
persisted
after epoch: 30,now: 2024-06-19 00:40:32.915367,epoch time: 0:26:09.920044,used: 20:42:03.054671,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_58_29_seed_0_21405195
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 20:42:03.054671 at 2024-06-19 00:40:32.915367
persisted model performance metric: 

scalar performance:
{'acc': 0.96308726, 'precision': 0.96590406, 'recall': 0.5593036, 'specificity': 0.5593036, 'f1': 0.59635264, 'auroc': 0.8984946, 'binary_precision': 0.96875, 'binary_recall': 0.118773945, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.21160409}
confusion matrix:
      0   1
0  5996   1
1   230  31
oracle model performance metric: 

scalar performance:
{'acc': 0.9680409, 'precision': 0.97600216, 'recall': 0.61869055, 'specificity': 0.61869055, 'f1': 0.68315595, 'auroc': 0.897132, 'binary_precision': 0.984127, 'binary_recall': 0.23754789, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.38271603}
confusion matrix:
      0   1
0  5996   1
1   199  62
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4_rest/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4_rest/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204178 KiB |   1436 MiB | 395293 GiB | 395293 GiB |
|       from large pool | 167936 KiB |   1366 MiB | 395172 GiB | 395172 GiB |
|       from small pool |  36242 KiB |     72 MiB |    120 GiB |    120 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 204178 KiB |   1436 MiB | 395293 GiB | 395293 GiB |
|       from large pool | 167936 KiB |   1366 MiB | 395172 GiB | 395172 GiB |
|       from small pool |  36242 KiB |     72 MiB |    120 GiB |    120 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201088 KiB |   1428 MiB | 395270 GiB | 395270 GiB |
|       from large pool | 165120 KiB |   1358 MiB | 395152 GiB | 395152 GiB |
|       from small pool |  35968 KiB |     71 MiB |    118 GiB |    118 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1524 MiB |   1524 MiB |   1524 MiB |      0 B   |
|       from large pool |   1450 MiB |   1450 MiB |   1450 MiB |      0 B   |
|       from small pool |     74 MiB |     74 MiB |     74 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 320109 KiB | 749313 KiB | 284057 GiB | 284057 GiB |
|       from large pool | 311296 KiB | 748328 KiB | 283918 GiB | 283918 GiB |
|       from small pool |   8813 KiB |  12610 KiB |    138 GiB |    138 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1278    |    1935    |   13821 K  |   13819 K  |
|       from large pool |      36    |      76    |    4630 K  |    4630 K  |
|       from small pool |    1242    |    1864    |    9190 K  |    9189 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1278    |    1935    |   13821 K  |   13819 K  |
|       from large pool |      36    |      76    |    4630 K  |    4630 K  |
|       from small pool |    1242    |    1864    |    9190 K  |    9189 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      50    |      50    |      50    |       0    |
|       from large pool |      13    |      13    |      13    |       0    |
|       from small pool |      37    |      37    |      37    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      35    |     452    |    7386 K  |    7386 K  |
|       from large pool |       5    |      10    |    1938 K  |    1938 K  |
|       from small pool |      30    |     447    |    5448 K  |    5448 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1436 MiB | 395293 GiB | 395293 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 395172 GiB | 395172 GiB |
|       from small pool |      0 KiB |     72 MiB |    120 GiB |    120 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1436 MiB | 395293 GiB | 395293 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 395172 GiB | 395172 GiB |
|       from small pool |      0 KiB |     72 MiB |    120 GiB |    120 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1428 MiB | 395270 GiB | 395270 GiB |
|       from large pool |  16640 KiB |   1358 MiB | 395152 GiB | 395152 GiB |
|       from small pool |      0 KiB |     71 MiB |    118 GiB |    118 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 524288 KiB |   1524 MiB |   1524 MiB |   1012 MiB |
|       from large pool | 479232 KiB |   1450 MiB |   1450 MiB |    982 MiB |
|       from small pool |  45056 KiB |     74 MiB |     74 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 298752 KiB | 749313 KiB | 284057 GiB | 284057 GiB |
|       from large pool | 298752 KiB | 748328 KiB | 283918 GiB | 283918 GiB |
|       from small pool |      0 KiB |  16408 KiB |    138 GiB |    138 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1935    |   13821 K  |   13821 K  |
|       from large pool |       2    |      76    |    4630 K  |    4630 K  |
|       from small pool |       0    |    1864    |    9190 K  |    9190 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1935    |   13821 K  |   13821 K  |
|       from large pool |       2    |      76    |    4630 K  |    4630 K  |
|       from small pool |       0    |    1864    |    9190 K  |    9190 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      50    |      50    |      19    |
|       from large pool |       9    |      13    |      13    |       4    |
|       from small pool |      22    |      37    |      37    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     452    |    7386 K  |    7386 K  |
|       from large pool |       1    |      11    |    1938 K  |    1938 K  |
|       from small pool |       0    |     447    |    5448 K  |    5448 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

