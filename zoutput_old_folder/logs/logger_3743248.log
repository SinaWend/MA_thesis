Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0




!!!: not committed yet



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324353

 Experiment start at: 2024-06-14 13:05:43.794464
before training, model accuracy: 0.3101629912853241
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96638656, 'precision': 0.48319328, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.491453, 'auroc': 0.5470028, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42320  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.51200044, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.42814383, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324353_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-14 13:27:06.349231,epoch time: 0:21:22.554767,used: 0:21:22.554767,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324353
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9664094, 'precision': 0.4832047, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4914589, 'auroc': 0.690289, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42321  0
1   1471  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.66961634, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.6826811, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324353_2.png
early stop counter: 1
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 2,now: 2024-06-14 13:47:25.116196,epoch time: 0:20:18.766965,used: 0:41:41.321732,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324353
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96638656, 'precision': 0.48319328, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.491453, 'auroc': 0.7959236, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42320  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.7956927, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.8093108, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324353_3.png
early stop counter: 2
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 3,now: 2024-06-14 14:05:49.114878,epoch time: 0:18:23.998682,used: 1:00:05.320414,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324353
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9664322, 'precision': 0.4832161, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4914648, 'auroc': 0.8468436, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42322  0
1   1470  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.83738434, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.8358843, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324353_4.png
early stop counter: 3
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 4,now: 2024-06-14 14:22:27.486104,epoch time: 0:16:38.371226,used: 1:16:43.691640,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324353
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96638656, 'precision': 0.73326784, 'recall': 0.502295, 'specificity': 0.502295, 'f1': 0.49616224, 'auroc': 0.86083066, 'binary_precision': 0.5, 'binary_recall': 0.0047554346, 'binary_specificity': 0.9998346, 'binary_f1_score': 0.009421265}
confusion matrix:
       0  1
0  42313  7
1   1465  7
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.8569026, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.97922325, 'recall': 0.5019157, 'specificity': 0.5019157, 'f1': 0.49320802, 'auroc': 0.8490752, 'binary_precision': 1.0, 'binary_recall': 0.0038314175, 'binary_specificity': 1.0, 'binary_f1_score': 0.007633588}
confusion matrix:
      0  1
0  5997  0
1   260  1
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324353_5.png
new oracle model saved
early stop counter: 4
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9584531784057617
after epoch: 5,now: 2024-06-14 14:40:47.678285,epoch time: 0:18:20.192181,used: 1:35:03.883821,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324353
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96663773, 'precision': 0.76019174, 'recall': 0.51553744, 'specificity': 0.51553744, 'f1': 0.52173376, 'auroc': 0.87924707, 'binary_precision': 0.5529412, 'binary_recall': 0.03197279, 'binary_specificity': 0.9991021, 'binary_f1_score': 0.060450166}
confusion matrix:
       0   1
0  42284  38
1   1423  47
---- Validation: 
scalar performance:
{'acc': 0.9657301, 'precision': 0.7102875, 'recall': 0.5037227, 'specificity': 0.5037227, 'f1': 0.49892604, 'auroc': 0.87711614, 'binary_precision': 0.45454547, 'binary_recall': 0.00777605, 'binary_specificity': 0.99966943, 'binary_f1_score': 0.01529052}
confusion matrix:
       0  1
0  18143  6
1    638  5
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9600511, 'precision': 0.97999036, 'recall': 0.5210728, 'specificity': 0.5210728, 'f1': 0.53023213, 'auroc': 0.86431706, 'binary_precision': 1.0, 'binary_recall': 0.042145595, 'binary_specificity': 1.0, 'binary_f1_score': 0.080882356}
confusion matrix:
      0   1
0  5997   0
1   250  11
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324353_6.png
new oracle model saved
early stop counter: 5
val acc:0.9657300710678101, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9600511193275452
after epoch: 6,now: 2024-06-14 14:59:06.957087,epoch time: 0:18:19.278802,used: 1:53:23.162623,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324353
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96618104, 'precision': 0.7157687, 'recall': 0.5208796, 'specificity': 0.5208796, 'f1': 0.5311633, 'auroc': 0.8890489, 'binary_precision': 0.46376812, 'binary_recall': 0.043507818, 'binary_specificity': 0.99825144, 'binary_f1_score': 0.07955252}
confusion matrix:
       0   1
0  42247  74
1   1407  64
---- Validation: 
scalar performance:
{'acc': 0.96588975, 'precision': 0.75112295, 'recall': 0.5113059, 'specificity': 0.5113059, 'f1': 0.5136721, 'auroc': 0.8801355, 'binary_precision': 0.53571427, 'binary_recall': 0.02332815, 'binary_specificity': 0.99928373, 'binary_f1_score': 0.044709392}
confusion matrix:
       0   1
0  18136  13
1    628  15
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96212846, 'precision': 0.98099136, 'recall': 0.545977, 'specificity': 0.545977, 'f1': 0.574522, 'auroc': 0.8749331, 'binary_precision': 1.0, 'binary_recall': 0.09195402, 'binary_specificity': 1.0, 'binary_f1_score': 0.16842106}
confusion matrix:
      0   1
0  5997   0
1   237  24
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324353_7.png
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-06-14 15:16:28.915553,epoch time: 0:17:21.958466,used: 2:10:45.121089,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324353
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9663181, 'precision': 0.73088115, 'recall': 0.5350455, 'specificity': 0.5350455, 'f1': 0.55476505, 'auroc': 0.8949536, 'binary_precision': 0.49308756, 'binary_recall': 0.07269022, 'binary_specificity': 0.99740076, 'binary_f1_score': 0.12670219}
confusion matrix:
       0    1
0  42210  110
1   1365  107
---- Validation: 
scalar performance:
{'acc': 0.9658365, 'precision': 0.7395118, 'recall': 0.5157787, 'specificity': 0.5157787, 'f1': 0.5220026, 'auroc': 0.89459586, 'binary_precision': 0.5121951, 'binary_recall': 0.032659408, 'binary_specificity': 0.998898, 'binary_f1_score': 0.06140351}
confusion matrix:
       0   1
0  18129  20
1    622  21
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9637264, 'precision': 0.98176414, 'recall': 0.5651341, 'specificity': 0.5651341, 'f1': 0.6059669, 'auroc': 0.87898624, 'binary_precision': 1.0, 'binary_recall': 0.1302682, 'binary_specificity': 1.0, 'binary_f1_score': 0.23050848}
confusion matrix:
      0   1
0  5997   0
1   227  34
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324353_8.png
new oracle model saved
early stop counter: 1
val acc:0.9658365249633789, best validation acc: 0.9658897519111633, corresponding to test acc:                         0.9621284604072571 / 0.9637264013290405
after epoch: 8,now: 2024-06-14 15:33:13.610408,epoch time: 0:16:44.694855,used: 2:27:29.815944,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324353
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9662495, 'precision': 0.72849774, 'recall': 0.53992796, 'specificity': 0.53992796, 'f1': 0.562241, 'auroc': 0.8913729, 'binary_precision': 0.488, 'binary_recall': 0.08288044, 'binary_specificity': 0.9969754, 'binary_f1_score': 0.14169572}
confusion matrix:
       0    1
0  42192  128
1   1350  122
---- Validation: 
scalar performance:
{'acc': 0.96588975, 'precision': 0.7411171, 'recall': 0.52630705, 'specificity': 0.52630705, 'f1': 0.5405345, 'auroc': 0.90126157, 'binary_precision': 0.5147059, 'binary_recall': 0.054432347, 'binary_specificity': 0.9981817, 'binary_f1_score': 0.09845289}
confusion matrix:
       0   1
0  18116  33
1    608  35
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964845, 'precision': 0.9602339, 'recall': 0.58220875, 'specificity': 0.58220875, 'f1': 0.63151383, 'auroc': 0.8764318, 'binary_precision': 0.95555556, 'binary_recall': 0.16475096, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.28104576}
confusion matrix:
      0   1
0  5995   2
1   218  43
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324353_9.png
new oracle model saved
early stop counter: 2
val acc:0.9658897519111633, best validation acc: 0.9658897519111633, corresponding to test acc:                         0.9621284604072571 / 0.9648450016975403
after epoch: 9,now: 2024-06-14 15:54:34.436031,epoch time: 0:21:20.825623,used: 2:48:50.641567,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324353
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9667291, 'precision': 0.74693906, 'recall': 0.55394614, 'specificity': 0.55394614, 'f1': 0.583386, 'auroc': 0.8931353, 'binary_precision': 0.52396166, 'binary_recall': 0.11141305, 'binary_specificity': 0.9964792, 'binary_f1_score': 0.1837535}
confusion matrix:
       0    1
0  42171  149
1   1308  164
---- Validation: 
scalar performance:
{'acc': 0.96588975, 'precision': 0.74075854, 'recall': 0.5278071, 'specificity': 0.5278071, 'f1': 0.5430553, 'auroc': 0.8949584, 'binary_precision': 0.5138889, 'binary_recall': 0.057542767, 'binary_specificity': 0.9980715, 'binary_f1_score': 0.10349651}
confusion matrix:
       0   1
0  18114  35
1    606  37
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96724194, 'precision': 0.98347306, 'recall': 0.6072797, 'specificity': 0.6072797, 'f1': 0.6682538, 'auroc': 0.8805846, 'binary_precision': 1.0, 'binary_recall': 0.21455939, 'binary_specificity': 1.0, 'binary_f1_score': 0.35331228}
confusion matrix:
      0   1
0  5997   0
1   205  56
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324353_10.png
new oracle model saved
early stop counter: 3
val acc:0.9658897519111633, best validation acc: 0.9658897519111633, corresponding to test acc:                         0.9621284604072571 / 0.9672419428825378
after epoch: 10,now: 2024-06-14 16:14:54.973167,epoch time: 0:20:20.537136,used: 3:09:11.178703,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324353
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96599835, 'precision': 0.72203815, 'recall': 0.55392224, 'specificity': 0.55392224, 'f1': 0.5820285, 'auroc': 0.90216327, 'binary_precision': 0.47413793, 'binary_recall': 0.112168595, 'binary_specificity': 0.9956759, 'binary_f1_score': 0.18141836}
confusion matrix:
       0    1
0  42138  183
1   1306  165
---- Validation: 
scalar performance:
{'acc': 0.9660494, 'precision': 0.74755764, 'recall': 0.53689045, 'specificity': 0.53689045, 'f1': 0.5579189, 'auroc': 0.9010332, 'binary_precision': 0.5268817, 'binary_recall': 0.07620529, 'binary_specificity': 0.99757564, 'binary_f1_score': 0.13315217}
confusion matrix:
       0   1
0  18105  44
1    594  49
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9688399, 'precision': 0.97697663, 'recall': 0.6282691, 'specificity': 0.6282691, 'f1': 0.6956471, 'auroc': 0.8824505, 'binary_precision': 0.9852941, 'binary_recall': 0.256705, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.4072948}
confusion matrix:
      0   1
0  5996   1
1   194  67
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324353_11.png
new oracle model saved
better model found
persisted
after epoch: 11,now: 2024-06-14 16:34:00.887703,epoch time: 0:19:05.914536,used: 3:28:17.093239,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324353
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9667063, 'precision': 0.74288464, 'recall': 0.5860645, 'specificity': 0.5860645, 'f1': 0.62367356, 'auroc': 0.9017923, 'binary_precision': 0.5137255, 'binary_recall': 0.17798913, 'binary_specificity': 0.9941399, 'binary_f1_score': 0.2643794}
confusion matrix:
       0    1
0  42072  248
1   1210  262
---- Validation: 
scalar performance:
{'acc': 0.9663687, 'precision': 0.7610214, 'recall': 0.5430562, 'specificity': 0.5430562, 'f1': 0.56782943, 'auroc': 0.90326244, 'binary_precision': 0.5533981, 'binary_recall': 0.08864697, 'binary_specificity': 0.99746543, 'binary_f1_score': 0.15281503}
confusion matrix:
       0   1
0  18103  46
1    586  57
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96772134, 'precision': 0.97558576, 'recall': 0.61485916, 'specificity': 0.61485916, 'f1': 0.67805266, 'auroc': 0.8843055, 'binary_precision': 0.9836066, 'binary_recall': 0.22988506, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.3726708}
confusion matrix:
      0   1
0  5996   1
1   201  60
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324353_12.png
better model found
persisted
after epoch: 12,now: 2024-06-14 16:51:41.899620,epoch time: 0:17:41.011917,used: 3:45:58.105156,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324353
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9661354, 'precision': 0.72829044, 'recall': 0.562819, 'specificity': 0.562819, 'f1': 0.5941882, 'auroc': 0.90439606, 'binary_precision': 0.48607594, 'binary_recall': 0.13043478, 'binary_specificity': 0.9952032, 'binary_f1_score': 0.20567754}
confusion matrix:
       0    1
0  42117  203
1   1280  192
---- Validation: 
scalar performance:
{'acc': 0.9664219, 'precision': 0.7616962, 'recall': 0.546084, 'specificity': 0.546084, 'f1': 0.5724431, 'auroc': 0.90218854, 'binary_precision': 0.55454546, 'binary_recall': 0.09486781, 'binary_specificity': 0.99730015, 'binary_f1_score': 0.16201858}
confusion matrix:
       0   1
0  18100  49
1    582  61
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9697987, 'precision': 0.98472357, 'recall': 0.63793105, 'specificity': 0.63793105, 'f1': 0.7084595, 'auroc': 0.8836334, 'binary_precision': 1.0, 'binary_recall': 0.27586207, 'binary_specificity': 1.0, 'binary_f1_score': 0.4324324}
confusion matrix:
      0   1
0  5997   0
1   189  72
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324353_13.png
new oracle model saved
better model found
persisted
after epoch: 13,now: 2024-06-14 17:08:31.992071,epoch time: 0:16:50.092451,used: 4:02:48.197607,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324353
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9663637, 'precision': 0.7345974, 'recall': 0.5754372, 'specificity': 0.5754372, 'f1': 0.61038715, 'auroc': 0.9063922, 'binary_precision': 0.4978355, 'binary_recall': 0.15635622, 'binary_specificity': 0.9945181, 'binary_f1_score': 0.23797205}
confusion matrix:
       0    1
0  42089  232
1   1241  230
---- Validation: 
scalar performance:
{'acc': 0.96706045, 'precision': 0.77667844, 'recall': 0.5636658, 'specificity': 0.5636658, 'f1': 0.5983234, 'auroc': 0.90539837, 'binary_precision': 0.5833333, 'binary_recall': 0.13063763, 'binary_specificity': 0.996694, 'binary_f1_score': 0.21346886}
confusion matrix:
       0   1
0  18089  60
1    559  84
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9693193, 'precision': 0.96471614, 'recall': 0.6376809, 'specificity': 0.6376809, 'f1': 0.706404, 'auroc': 0.8854165, 'binary_precision': 0.96, 'binary_recall': 0.27586207, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.42857143}
confusion matrix:
      0   1
0  5994   3
1   189  72
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324353_14.png
better model found
persisted
after epoch: 14,now: 2024-06-14 17:31:22.256755,epoch time: 0:22:50.264684,used: 4:25:38.462291,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324353
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9669118, 'precision': 0.7480694, 'recall': 0.58125293, 'specificity': 0.58125293, 'f1': 0.61866325, 'auroc': 0.9098763, 'binary_precision': 0.52441615, 'binary_recall': 0.1677989, 'binary_specificity': 0.994707, 'binary_f1_score': 0.254246}
confusion matrix:
       0    1
0  42096  224
1   1225  247
---- Validation: 
scalar performance:
{'acc': 0.9662622, 'precision': 0.75401133, 'recall': 0.5467514, 'specificity': 0.5467514, 'f1': 0.57318616, 'auroc': 0.91112113, 'binary_precision': 0.53913045, 'binary_recall': 0.096423015, 'binary_specificity': 0.99707973, 'binary_f1_score': 0.16358837}
confusion matrix:
       0   1
0  18096  53
1    581  62
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9683605, 'precision': 0.97640264, 'recall': 0.622522, 'specificity': 0.622522, 'f1': 0.6881976, 'auroc': 0.8825847, 'binary_precision': 0.9846154, 'binary_recall': 0.24521072, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.39263803}
confusion matrix:
      0   1
0  5996   1
1   197  64
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324353_15.png
early stop counter: 1
val acc:0.9662622213363647, best validation acc: 0.9670604467391968, corresponding to test acc:                         0.9693192839622498 / 0.9697986841201782
after epoch: 15,now: 2024-06-14 17:53:39.995991,epoch time: 0:22:17.739236,used: 4:47:56.201527,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324353
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9664322, 'precision': 0.73655415, 'recall': 0.561989, 'specificity': 0.561989, 'f1': 0.59369993, 'auroc': 0.90668106, 'binary_precision': 0.50265956, 'binary_recall': 0.12839673, 'binary_specificity': 0.99558127, 'binary_f1_score': 0.20454544}
confusion matrix:
       0    1
0  42133  187
1   1283  189
---- Validation: 
scalar performance:
{'acc': 0.96631545, 'precision': 0.7583599, 'recall': 0.54302865, 'specificity': 0.54302865, 'f1': 0.5677133, 'auroc': 0.90266824, 'binary_precision': 0.5480769, 'binary_recall': 0.08864697, 'binary_specificity': 0.9974103, 'binary_f1_score': 0.15261045}
confusion matrix:
       0   1
0  18102  47
1    586  57
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9678811, 'precision': 0.9837851, 'recall': 0.61494255, 'specificity': 0.61494255, 'f1': 0.6786748, 'auroc': 0.88194084, 'binary_precision': 1.0, 'binary_recall': 0.22988506, 'binary_specificity': 1.0, 'binary_f1_score': 0.37383175}
confusion matrix:
      0   1
0  5997   0
1   201  60
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324353_16.png
early stop counter: 2
val acc:0.9663154482841492, best validation acc: 0.9670604467391968, corresponding to test acc:                         0.9693192839622498 / 0.9697986841201782
after epoch: 16,now: 2024-06-14 18:15:39.812300,epoch time: 0:21:59.816309,used: 5:09:56.017836,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324353
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9663181, 'precision': 0.7353818, 'recall': 0.6025845, 'specificity': 0.6025845, 'f1': 0.64034927, 'auroc': 0.9097781, 'binary_precision': 0.49761525, 'binary_recall': 0.21263587, 'binary_specificity': 0.9925331, 'binary_f1_score': 0.29795337}
confusion matrix:
       0    1
0  42004  316
1   1159  313
---- Validation: 
scalar performance:
{'acc': 0.9665815, 'precision': 0.7567109, 'recall': 0.5716685, 'specificity': 0.5716685, 'f1': 0.6075964, 'auroc': 0.9074666, 'binary_precision': 0.54285717, 'binary_recall': 0.14774494, 'binary_specificity': 0.99559206, 'binary_f1_score': 0.23227382}
confusion matrix:
       0   1
0  18069  80
1    548  95
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.971876, 'precision': 0.98574436, 'recall': 0.66283524, 'specificity': 0.66283524, 'f1': 0.73843384, 'auroc': 0.8847867, 'binary_precision': 1.0, 'binary_recall': 0.3256705, 'binary_specificity': 1.0, 'binary_f1_score': 0.4913295}
confusion matrix:
      0   1
0  5997   0
1   176  85
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324353_17.png
new oracle model saved
early stop counter: 3
val acc:0.9665815234184265, best validation acc: 0.9670604467391968, corresponding to test acc:                         0.9693192839622498 / 0.9718760251998901
after epoch: 17,now: 2024-06-14 18:37:19.201016,epoch time: 0:21:39.388716,used: 5:31:35.406552,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324353
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.96723145, 'precision': 0.7547598, 'recall': 0.5876477, 'specificity': 0.5876477, 'f1': 0.62685096, 'auroc': 0.9144659, 'binary_precision': 0.5373737, 'binary_recall': 0.18070652, 'binary_specificity': 0.99458885, 'binary_f1_score': 0.27046263}
confusion matrix:
       0    1
0  42091  229
1   1206  266
---- Validation: 
scalar performance:
{'acc': 0.966688, 'precision': 0.767197, 'recall': 0.5559724, 'specificity': 0.5559724, 'f1': 0.5871041, 'auroc': 0.9009369, 'binary_precision': 0.5648855, 'binary_recall': 0.115085535, 'binary_specificity': 0.9968593, 'binary_f1_score': 0.19121447}
confusion matrix:
       0   1
0  18092  57
1    569  74
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9701182, 'precision': 0.9663584, 'recall': 0.6472595, 'specificity': 0.6472595, 'f1': 0.7181268, 'auroc': 0.880414, 'binary_precision': 0.9625, 'binary_recall': 0.29501915, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.4516129}
confusion matrix:
      0   1
0  5994   3
1   184  77
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324353_18.png
early stop counter: 4
val acc:0.9666879773139954, best validation acc: 0.9670604467391968, corresponding to test acc:                         0.9693192839622498 / 0.9718760251998901
after epoch: 18,now: 2024-06-14 19:00:15.524269,epoch time: 0:22:56.323253,used: 5:54:31.729805,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324353
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9671858, 'precision': 0.7541764, 'recall': 0.5850012, 'specificity': 0.5850012, 'f1': 0.6237138, 'auroc': 0.9148806, 'binary_precision': 0.53638256, 'binary_recall': 0.17527173, 'binary_specificity': 0.99473065, 'binary_f1_score': 0.2642089}
confusion matrix:
       0    1
0  42097  223
1   1214  258
---- Validation: 
scalar performance:
{'acc': 0.96620905, 'precision': 0.7483612, 'recall': 0.5587247, 'specificity': 0.5587247, 'f1': 0.58997995, 'auroc': 0.91408396, 'binary_precision': 0.527027, 'binary_recall': 0.121306375, 'binary_specificity': 0.99614304, 'binary_f1_score': 0.1972187}
confusion matrix:
       0   1
0  18079  70
1    565  78
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9689997, 'precision': 0.9843321, 'recall': 0.6283525, 'specificity': 0.6283525, 'f1': 0.6963096, 'auroc': 0.8867232, 'binary_precision': 1.0, 'binary_recall': 0.256705, 'binary_specificity': 1.0, 'binary_f1_score': 0.40853658}
confusion matrix:
      0   1
0  5997   0
1   194  67
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324353_19.png
early stop counter: 5
val acc:0.9662090539932251, best validation acc: 0.9670604467391968, corresponding to test acc:                         0.9693192839622498 / 0.9718760251998901
after epoch: 19,now: 2024-06-14 19:22:51.425285,epoch time: 0:22:35.901016,used: 6:17:07.630821,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324353
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9672086, 'precision': 0.7503718, 'recall': 0.6171432, 'specificity': 0.6171432, 'f1': 0.6573316, 'auroc': 0.91577643, 'binary_precision': 0.52662724, 'binary_recall': 0.24184783, 'binary_specificity': 0.99243855, 'binary_f1_score': 0.33147115}
confusion matrix:
       0    1
0  42000  320
1   1116  356
---- Validation: 
scalar performance:
{'acc': 0.966688, 'precision': 0.7569697, 'recall': 0.5814743, 'specificity': 0.5814743, 'f1': 0.61974716, 'auroc': 0.91956925, 'binary_precision': 0.5427136, 'binary_recall': 0.16796267, 'binary_specificity': 0.99498594, 'binary_f1_score': 0.25653207}
confusion matrix:
       0    1
0  18058   91
1    535  108
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9709172, 'precision': 0.9678543, 'recall': 0.656838, 'specificity': 0.656838, 'f1': 0.7295168, 'auroc': 0.8903296, 'binary_precision': 0.9647059, 'binary_recall': 0.31417623, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.4739884}
confusion matrix:
      0   1
0  5994   3
1   179  82
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324353_20.png
early stop counter: 6
val acc:0.9666879773139954, best validation acc: 0.9670604467391968, corresponding to test acc:                         0.9693192839622498 / 0.9718760251998901
after epoch: 20,now: 2024-06-14 19:42:08.646611,epoch time: 0:19:17.221326,used: 6:36:24.852147,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324353
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9667291, 'precision': 0.74230766, 'recall': 0.6336159, 'specificity': 0.6336159, 'f1': 0.67067707, 'auroc': 0.91553485, 'binary_precision': 0.5093867, 'binary_recall': 0.27649456, 'binary_specificity': 0.99073726, 'binary_f1_score': 0.3584324}
confusion matrix:
       0    1
0  41928  392
1   1065  407
---- Validation: 
scalar performance:
{'acc': 0.9670072, 'precision': 0.76008606, 'recall': 0.59964097, 'specificity': 0.59964097, 'f1': 0.6408744, 'auroc': 0.91481334, 'binary_precision': 0.54771787, 'binary_recall': 0.20528771, 'binary_specificity': 0.9939942, 'binary_f1_score': 0.29864255}
confusion matrix:
       0    1
0  18040  109
1    511  132
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.971876, 'precision': 0.9645449, 'recall': 0.6701646, 'specificity': 0.6701646, 'f1': 0.74417675, 'auroc': 0.88677037, 'binary_precision': 0.9569892, 'binary_recall': 0.34099618, 'binary_specificity': 0.999333, 'binary_f1_score': 0.50282484}
confusion matrix:
      0   1
0  5993   4
1   172  89
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324353_21.png
early stop counter: 7
val acc:0.9670072197914124, best validation acc: 0.9670604467391968, corresponding to test acc:                         0.9693192839622498 / 0.9718760251998901
after epoch: 21,now: 2024-06-14 20:00:32.299371,epoch time: 0:18:23.652760,used: 6:54:48.504907,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324353
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.96629524, 'precision': 0.73614544, 'recall': 0.6278178, 'specificity': 0.6278178, 'f1': 0.6642234, 'auroc': 0.9166086, 'binary_precision': 0.49744898, 'binary_recall': 0.26494566, 'binary_specificity': 0.99069, 'binary_f1_score': 0.34574467}
confusion matrix:
       0    1
0  41926  394
1   1082  390
---- Validation: 
scalar performance:
{'acc': 0.96706045, 'precision': 0.76599735, 'recall': 0.5839173, 'specificity': 0.5839173, 'f1': 0.62356234, 'auroc': 0.9167445, 'binary_precision': 0.56060606, 'binary_recall': 0.1726283, 'binary_specificity': 0.99520636, 'binary_f1_score': 0.26397145}
confusion matrix:
       0    1
0  18062   87
1    532  111
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9707574, 'precision': 0.9675656, 'recall': 0.65492225, 'specificity': 0.65492225, 'f1': 0.7272647, 'auroc': 0.88752353, 'binary_precision': 0.96428573, 'binary_recall': 0.31034482, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.46956518}
confusion matrix:
      0   1
0  5994   3
1   180  81
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324353_22.png
early stop counter: 8
val acc:0.9670604467391968, best validation acc: 0.9670604467391968, corresponding to test acc:                         0.9693192839622498 / 0.9718760251998901
after epoch: 22,now: 2024-06-14 20:17:58.142455,epoch time: 0:17:25.843084,used: 7:12:14.347991,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324353
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.96663773, 'precision': 0.7410955, 'recall': 0.59914345, 'specificity': 0.59914345, 'f1': 0.63770497, 'auroc': 0.9135051, 'binary_precision': 0.5092749, 'binary_recall': 0.20516305, 'binary_specificity': 0.9931238, 'binary_f1_score': 0.29249394}
confusion matrix:
       0    1
0  42029  291
1   1170  302
---- Validation: 
scalar performance:
{'acc': 0.9667944, 'precision': 0.7630632, 'recall': 0.57177866, 'specificity': 0.57177866, 'f1': 0.6082224, 'auroc': 0.9162915, 'binary_precision': 0.5555556, 'binary_recall': 0.14774494, 'binary_specificity': 0.9958124, 'binary_f1_score': 0.23341523}
confusion matrix:
       0   1
0  18073  76
1    548  95
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9693193, 'precision': 0.9588181, 'recall': 0.63951325, 'specificity': 0.63951325, 'f1': 0.7080933, 'auroc': 0.88793874, 'binary_precision': 0.9480519, 'binary_recall': 0.27969348, 'binary_specificity': 0.999333, 'binary_f1_score': 0.4319527}
confusion matrix:
      0   1
0  5993   4
1   188  73
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324353_23.png
early stop counter: 9
val acc:0.9667943716049194, best validation acc: 0.9670604467391968, corresponding to test acc:                         0.9693192839622498 / 0.9718760251998901
after epoch: 23,now: 2024-06-14 20:35:00.075470,epoch time: 0:17:01.933015,used: 7:29:16.281006,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324353
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9664779, 'precision': 0.7385541, 'recall': 0.6210273, 'specificity': 0.6210273, 'f1': 0.658674, 'auroc': 0.9185443, 'binary_precision': 0.50272477, 'binary_recall': 0.25067934, 'binary_specificity': 0.9913752, 'binary_f1_score': 0.33454213}
confusion matrix:
       0    1
0  41955  365
1   1103  369
---- Validation: 
scalar performance:
{'acc': 0.9665815, 'precision': 0.7544302, 'recall': 0.58066916, 'specificity': 0.58066916, 'f1': 0.6185323, 'auroc': 0.9182141, 'binary_precision': 0.53768843, 'binary_recall': 0.16640747, 'binary_specificity': 0.99493086, 'binary_f1_score': 0.25415677}
confusion matrix:
       0    1
0  18057   92
1    536  107
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.970278, 'precision': 0.97245264, 'recall': 0.6473428, 'specificity': 0.6473428, 'f1': 0.7188326, 'auroc': 0.88712394, 'binary_precision': 0.9746835, 'binary_recall': 0.29501915, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.45294115}
confusion matrix:
      0   1
0  5995   2
1   184  77
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324353_24.png
early stop counter: 10
val acc:0.9665815234184265, best validation acc: 0.9670604467391968, corresponding to test acc:                         0.9693192839622498 / 0.9718760251998901
after epoch: 24,now: 2024-06-14 20:52:37.431292,epoch time: 0:17:37.355822,used: 7:46:53.636828,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324353
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.96864724, 'precision': 0.77438045, 'recall': 0.62706757, 'specificity': 0.62706757, 'f1': 0.6713208, 'auroc': 0.9193179, 'binary_precision': 0.57399106, 'binary_recall': 0.26086956, 'binary_specificity': 0.99326557, 'binary_f1_score': 0.35871089}
confusion matrix:
       0    1
0  42035  285
1   1088  384
---- Validation: 
scalar performance:
{'acc': 0.96674114, 'precision': 0.761172, 'recall': 0.5725012, 'specificity': 0.5725012, 'f1': 0.6090036, 'auroc': 0.92089146, 'binary_precision': 0.55172414, 'binary_recall': 0.14930016, 'binary_specificity': 0.99570227, 'binary_f1_score': 0.23500612}
confusion matrix:
       0   1
0  18071  78
1    547  96
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9707574, 'precision': 0.97902036, 'recall': 0.65125763, 'specificity': 0.65125763, 'f1': 0.72415614, 'auroc': 0.88903713, 'binary_precision': 0.9875, 'binary_recall': 0.30268198, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.46334308}
confusion matrix:
      0   1
0  5996   1
1   182  79
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324353_25.png
early stop counter: 11
val acc:0.966741144657135, best validation acc: 0.9670604467391968, corresponding to test acc:                         0.9693192839622498 / 0.9718760251998901
after epoch: 25,now: 2024-06-14 21:13:09.070924,epoch time: 0:20:31.639632,used: 8:07:25.276460,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324353
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9665464, 'precision': 0.7392423, 'recall': 0.62048006, 'specificity': 0.62048006, 'f1': 0.6583153, 'auroc': 0.91636944, 'binary_precision': 0.5041209, 'binary_recall': 0.24949014, 'binary_specificity': 0.99147, 'binary_f1_score': 0.3337881}
confusion matrix:
       0    1
0  41960  361
1   1104  367
---- Validation: 
scalar performance:
{'acc': 0.967433, 'precision': 0.775494, 'recall': 0.5856103, 'specificity': 0.5856103, 'f1': 0.6265174, 'auroc': 0.91813344, 'binary_precision': 0.5794872, 'binary_recall': 0.17573872, 'binary_specificity': 0.99548185, 'binary_f1_score': 0.26968974}
confusion matrix:
       0    1
0  18067   82
1    530  113
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9717162, 'precision': 0.96922827, 'recall': 0.6664165, 'specificity': 0.6664165, 'f1': 0.7405883, 'auroc': 0.88804615, 'binary_precision': 0.96666664, 'binary_recall': 0.33333334, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.49572653}
confusion matrix:
      0   1
0  5994   3
1   174  87
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324353_26.png
better model found
persisted
after epoch: 26,now: 2024-06-14 21:30:57.889006,epoch time: 0:17:48.818082,used: 8:25:14.094542,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324353
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9669346, 'precision': 0.7448759, 'recall': 0.63478875, 'specificity': 0.63478875, 'f1': 0.6722899, 'auroc': 0.9150241, 'binary_precision': 0.5144291, 'binary_recall': 0.27872196, 'binary_specificity': 0.9908556, 'binary_f1_score': 0.36155203}
confusion matrix:
       0    1
0  41934  387
1   1061  410
---- Validation: 
scalar performance:
{'acc': 0.9671669, 'precision': 0.77016896, 'recall': 0.5809722, 'specificity': 0.5809722, 'f1': 0.62036663, 'auroc': 0.9174438, 'binary_precision': 0.56914896, 'binary_recall': 0.16640747, 'binary_specificity': 0.9955369, 'binary_f1_score': 0.25752106}
confusion matrix:
       0    1
0  18068   81
1    536  107
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.971077, 'precision': 0.97359896, 'recall': 0.6569214, 'specificity': 0.6569214, 'f1': 0.7302455, 'auroc': 0.8900255, 'binary_precision': 0.97619045, 'binary_recall': 0.31417623, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.47536233}
confusion matrix:
      0   1
0  5995   2
1   179  82
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324353_27.png
early stop counter: 1
val acc:0.9671669006347656, best validation acc: 0.967432975769043, corresponding to test acc:                         0.9717162251472473 / 0.9718760251998901
after epoch: 27,now: 2024-06-14 21:48:11.322813,epoch time: 0:17:13.433807,used: 8:42:27.528349,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324353
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9667063, 'precision': 0.74171233, 'recall': 0.61695373, 'specificity': 0.61695373, 'f1': 0.6555204, 'auroc': 0.9178672, 'binary_precision': 0.509299, 'binary_recall': 0.24201223, 'binary_specificity': 0.99189526, 'binary_f1_score': 0.3281106}
confusion matrix:
       0    1
0  41978  343
1   1115  356
---- Validation: 
scalar performance:
{'acc': 0.9669008, 'precision': 0.76779467, 'recall': 0.5688336, 'specificity': 0.5688336, 'f1': 0.6047284, 'auroc': 0.9182507, 'binary_precision': 0.5652174, 'binary_recall': 0.1415241, 'binary_specificity': 0.99614304, 'binary_f1_score': 0.22636817}
confusion matrix:
       0   1
0  18079  70
1    552  91
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9699584, 'precision': 0.98480195, 'recall': 0.63984674, 'specificity': 0.63984674, 'f1': 0.71084654, 'auroc': 0.8859277, 'binary_precision': 1.0, 'binary_recall': 0.27969348, 'binary_specificity': 1.0, 'binary_f1_score': 0.43712574}
confusion matrix:
      0   1
0  5997   0
1   188  73
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324353_28.png
early stop counter: 2
val acc:0.9669008255004883, best validation acc: 0.967432975769043, corresponding to test acc:                         0.9717162251472473 / 0.9718760251998901
after epoch: 28,now: 2024-06-14 22:07:52.608284,epoch time: 0:19:41.285471,used: 9:02:08.813820,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324353
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.96702594, 'precision': 0.74685293, 'recall': 0.62557304, 'specificity': 0.62557304, 'f1': 0.66455054, 'auroc': 0.92162216, 'binary_precision': 0.51902175, 'binary_recall': 0.25951087, 'binary_specificity': 0.99163514, 'binary_f1_score': 0.3460145}
confusion matrix:
       0    1
0  41966  354
1   1090  382
---- Validation: 
scalar performance:
{'acc': 0.9665283, 'precision': 0.7538796, 'recall': 0.5768913, 'specificity': 0.5768913, 'f1': 0.61389136, 'auroc': 0.9212975, 'binary_precision': 0.5368421, 'binary_recall': 0.15863141, 'binary_specificity': 0.9951512, 'binary_f1_score': 0.24489795}
confusion matrix:
       0    1
0  18061   88
1    541  102
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9713966, 'precision': 0.9796323, 'recall': 0.6589204, 'specificity': 0.6589204, 'f1': 0.7332262, 'auroc': 0.8884078, 'binary_precision': 0.9880952, 'binary_recall': 0.31800765, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.4811594}
confusion matrix:
      0   1
0  5996   1
1   178  83
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324353_29.png
early stop counter: 3
val acc:0.9665282964706421, best validation acc: 0.967432975769043, corresponding to test acc:                         0.9717162251472473 / 0.9718760251998901
after epoch: 29,now: 2024-06-14 22:25:19.770465,epoch time: 0:17:27.162181,used: 9:19:35.976001,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324353
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.96675193, 'precision': 0.74236286, 'recall': 0.65208304, 'specificity': 0.65208304, 'f1': 0.68583006, 'auroc': 0.91886663, 'binary_precision': 0.5082327, 'binary_recall': 0.31475186, 'binary_specificity': 0.9894142, 'binary_f1_score': 0.38874897}
confusion matrix:
       0    1
0  41873  448
1   1008  463
---- Validation: 
scalar performance:
{'acc': 0.9672733, 'precision': 0.7629292, 'recall': 0.6110295, 'specificity': 0.6110295, 'f1': 0.65333176, 'auroc': 0.92067355, 'binary_precision': 0.55263156, 'binary_recall': 0.22861587, 'binary_specificity': 0.9934432, 'binary_f1_score': 0.32343236}
confusion matrix:
       0    1
0  18030  119
1    496  147
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97251517, 'precision': 0.97049963, 'recall': 0.6759951, 'specificity': 0.6759951, 'f1': 0.7513546, 'auroc': 0.89305615, 'binary_precision': 0.96842104, 'binary_recall': 0.35249043, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.5168539}
confusion matrix:
      0   1
0  5994   3
1   169  92
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324353_30.png
new oracle model saved
early stop counter: 4
val acc:0.9672732949256897, best validation acc: 0.967432975769043, corresponding to test acc:                         0.9717162251472473 / 0.9725151658058167
after epoch: 30,now: 2024-06-14 22:42:26.848461,epoch time: 0:17:07.077996,used: 9:36:43.053997,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324353
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 9:36:43.053997 at 2024-06-14 22:42:26.848461
persisted model performance metric: 

scalar performance:
{'acc': 0.9717162, 'precision': 0.96922827, 'recall': 0.6664165, 'specificity': 0.6664165, 'f1': 0.7405883, 'auroc': 0.88804615, 'binary_precision': 0.96666664, 'binary_recall': 0.33333334, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.49572653}
confusion matrix:
      0   1
0  5994   3
1   174  87
oracle model performance metric: 

scalar performance:
{'acc': 0.97251517, 'precision': 0.97049963, 'recall': 0.6759951, 'specificity': 0.6759951, 'f1': 0.7513546, 'auroc': 0.89305615, 'binary_precision': 0.96842104, 'binary_recall': 0.35249043, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.5168539}
confusion matrix:
      0   1
0  5994   3
1   169  92
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_bs16_different_learningrates/rule_results/2.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_bs16_different_learningrates/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_resnet_bs16_different_learningrates/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204979 KiB | 640729 KiB |    942 TiB |    942 TiB |
|       from large pool | 167936 KiB | 568000 KiB |    942 TiB |    942 TiB |
|       from small pool |  37043 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 204979 KiB | 640729 KiB |    942 TiB |    942 TiB |
|       from large pool | 167936 KiB | 568000 KiB |    942 TiB |    942 TiB |
|       from small pool |  37043 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201088 KiB | 632296 KiB |    940 TiB |    940 TiB |
|       from large pool | 165120 KiB | 560704 KiB |    940 TiB |    940 TiB |
|       from small pool |  35968 KiB |  73944 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 755712 KiB | 755712 KiB | 755712 KiB |      0 B   |
|       from large pool | 679936 KiB | 679936 KiB | 679936 KiB |      0 B   |
|       from small pool |  75776 KiB |  75776 KiB |  75776 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  79692 KiB | 215750 KiB | 380507 GiB | 380507 GiB |
|       from large pool |  67584 KiB | 213792 KiB | 380202 GiB | 380202 GiB |
|       from small pool |  12108 KiB |  14049 KiB |    304 GiB |    304 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3252    |    6223    |   83720 K  |   83716 K  |
|       from large pool |      36    |      76    |   33845 K  |   33845 K  |
|       from small pool |    3216    |    6186    |   49874 K  |   49871 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3252    |    6223    |   83720 K  |   83716 K  |
|       from large pool |      36    |      76    |   33845 K  |   33845 K  |
|       from small pool |    3216    |    6186    |   49874 K  |   49871 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      51    |      51    |      51    |       0    |
|       from large pool |      14    |      14    |      14    |       0    |
|       from small pool |      37    |      37    |      37    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      39    |    2753    |   37650 K  |   37650 K  |
|       from large pool |       7    |      11    |   12101 K  |   12101 K  |
|       from small pool |      32    |    2746    |   25548 K  |   25548 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 640729 KiB |    942 TiB |    942 TiB |
|       from large pool |  16640 KiB | 568000 KiB |    942 TiB |    942 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 640729 KiB |    942 TiB |    942 TiB |
|       from large pool |  16640 KiB | 568000 KiB |    942 TiB |    942 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 632296 KiB |    940 TiB |    940 TiB |
|       from large pool |  16640 KiB | 560704 KiB |    940 TiB |    940 TiB |
|       from small pool |      0 KiB |  73944 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 284672 KiB | 755712 KiB | 755712 KiB | 471040 KiB |
|       from large pool | 235520 KiB | 679936 KiB | 679936 KiB | 444416 KiB |
|       from small pool |  49152 KiB |  75776 KiB |  75776 KiB |  26624 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  55040 KiB | 215750 KiB | 380507 GiB | 380507 GiB |
|       from large pool |  55040 KiB | 213792 KiB | 380202 GiB | 380202 GiB |
|       from small pool |      0 KiB |  19703 KiB |    304 GiB |    304 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6223    |   83720 K  |   83720 K  |
|       from large pool |       2    |      76    |   33845 K  |   33845 K  |
|       from small pool |       0    |    6186    |   49874 K  |   49874 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6223    |   83720 K  |   83720 K  |
|       from large pool |       2    |      76    |   33845 K  |   33845 K  |
|       from small pool |       0    |    6186    |   49874 K  |   49874 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      34    |      51    |      51    |      17    |
|       from large pool |      10    |      14    |      14    |       4    |
|       from small pool |      24    |      37    |      37    |      13    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2753    |   37651 K  |   37651 K  |
|       from large pool |       3    |      13    |   12101 K  |   12101 K  |
|       from small pool |       0    |    2746    |   25549 K  |   25549 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 640729 KiB |    942 TiB |    942 TiB |
|       from large pool |  16640 KiB | 568000 KiB |    942 TiB |    942 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 640729 KiB |    942 TiB |    942 TiB |
|       from large pool |  16640 KiB | 568000 KiB |    942 TiB |    942 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 632296 KiB |    940 TiB |    940 TiB |
|       from large pool |  16640 KiB | 560704 KiB |    940 TiB |    940 TiB |
|       from small pool |      0 KiB |  73944 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 284672 KiB | 755712 KiB | 755712 KiB | 471040 KiB |
|       from large pool | 235520 KiB | 679936 KiB | 679936 KiB | 444416 KiB |
|       from small pool |  49152 KiB |  75776 KiB |  75776 KiB |  26624 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  55040 KiB | 215750 KiB | 380507 GiB | 380507 GiB |
|       from large pool |  55040 KiB | 213792 KiB | 380202 GiB | 380202 GiB |
|       from small pool |      0 KiB |  19703 KiB |    304 GiB |    304 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6223    |   83720 K  |   83720 K  |
|       from large pool |       2    |      76    |   33845 K  |   33845 K  |
|       from small pool |       0    |    6186    |   49874 K  |   49874 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6223    |   83720 K  |   83720 K  |
|       from large pool |       2    |      76    |   33845 K  |   33845 K  |
|       from small pool |       0    |    6186    |   49874 K  |   49874 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      34    |      51    |      51    |      17    |
|       from large pool |      10    |      14    |      14    |       4    |
|       from small pool |      24    |      37    |      37    |      13    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2753    |   37651 K  |   37651 K  |
|       from large pool |       3    |      13    |   12101 K  |   12101 K  |
|       from small pool |       0    |    2746    |   25549 K  |   25549 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0




!!!: not committed yet



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_22_49_53_seed_1_21324353

 Experiment start at: 2024-06-14 22:49:53.711567
before training, model accuracy: 0.14647115767002106
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9671197, 'precision': 0.48355985, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49164253, 'auroc': 0.56585985, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42414  0
1   1442  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.55597484, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.45223957, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324353_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-14 23:07:02.906692,epoch time: 0:17:09.195125,used: 0:17:09.195125,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_22_49_53_seed_1_21324353
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9671197, 'precision': 0.48355985, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49164253, 'auroc': 0.6760644, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42414  0
1   1442  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.669081, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.6499264, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324353_2.png
early stop counter: 1
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 2,now: 2024-06-14 23:24:29.001854,epoch time: 0:17:26.095162,used: 0:34:35.290287,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_22_49_53_seed_1_21324353
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9671197, 'precision': 0.48355985, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49164253, 'auroc': 0.7944442, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42414  0
1   1442  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.8012881, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.7826774, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324353_3.png
early stop counter: 2
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 3,now: 2024-06-14 23:42:49.639085,epoch time: 0:18:20.637231,used: 0:52:55.927518,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_22_49_53_seed_1_21324353
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9671197, 'precision': 0.48355985, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49164253, 'auroc': 0.8246181, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42414  0
1   1442  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.81318617, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.8246255, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324353_4.png
early stop counter: 3
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 4,now: 2024-06-15 00:01:01.219456,epoch time: 0:18:11.580371,used: 1:11:07.507889,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_22_49_53_seed_1_21324353
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96723366, 'precision': 0.8725252, 'recall': 0.5024036, 'specificity': 0.5024036, 'f1': 0.4964949, 'auroc': 0.8434441, 'binary_precision': 0.7777778, 'binary_recall': 0.004854369, 'binary_specificity': 0.99995285, 'binary_f1_score': 0.009648519}
confusion matrix:
       0  1
0  42412  2
1   1435  7
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.8457025, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.82775426, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324353_5.png
early stop counter: 4
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 5,now: 2024-06-15 00:19:08.267544,epoch time: 0:18:07.048088,used: 1:29:14.555977,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_22_49_53_seed_1_21324353
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9671653, 'precision': 0.74279845, 'recall': 0.5097372, 'specificity': 0.5097372, 'f1': 0.51100785, 'auroc': 0.87846833, 'binary_precision': 0.51785713, 'binary_recall': 0.020110957, 'binary_specificity': 0.9993634, 'binary_f1_score': 0.038718294}
confusion matrix:
       0   1
0  42387  27
1   1413  29
---- Validation: 
scalar performance:
{'acc': 0.96419424, 'precision': 0.7946695, 'recall': 0.50363165, 'specificity': 0.50363165, 'f1': 0.498225, 'auroc': 0.8816755, 'binary_precision': 0.625, 'binary_recall': 0.0074294205, 'binary_specificity': 0.99983394, 'binary_f1_score': 0.014684287}
confusion matrix:
       0  1
0  18064  3
1    668  5
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9585885, 'precision': 0.9792842, 'recall': 0.50576925, 'specificity': 0.50576925, 'f1': 0.5008299, 'auroc': 0.85589015, 'binary_precision': 1.0, 'binary_recall': 0.011538462, 'binary_specificity': 1.0, 'binary_f1_score': 0.022813687}
confusion matrix:
      0  1
0  5946  0
1   257  3
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324353_6.png
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-06-15 00:36:28.040578,epoch time: 0:17:19.773034,used: 1:46:34.329011,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_22_49_53_seed_1_21324353
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9673021, 'precision': 0.7486392, 'recall': 0.52488077, 'specificity': 0.52488077, 'f1': 0.5384516, 'auroc': 0.87887144, 'binary_precision': 0.5285714, 'binary_recall': 0.051317614, 'binary_specificity': 0.9984439, 'binary_f1_score': 0.093552455}
confusion matrix:
       0   1
0  42348  66
1   1368  74
---- Validation: 
scalar performance:
{'acc': 0.96419424, 'precision': 0.75162363, 'recall': 0.5100691, 'specificity': 0.5100691, 'f1': 0.510907, 'auroc': 0.87411726, 'binary_precision': 0.53846157, 'binary_recall': 0.020802377, 'binary_specificity': 0.9993358, 'binary_f1_score': 0.040057223}
confusion matrix:
       0   1
0  18055  12
1    659  14
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590719, 'precision': 0.97951615, 'recall': 0.51153845, 'specificity': 0.51153845, 'f1': 0.5121002, 'auroc': 0.85361075, 'binary_precision': 1.0, 'binary_recall': 0.023076924, 'binary_specificity': 1.0, 'binary_f1_score': 0.045112785}
confusion matrix:
      0  1
0  5946  0
1   254  6
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324353_7.png
new oracle model saved
early stop counter: 1
val acc:0.9641942381858826, best validation acc: 0.9641942381858826, corresponding to test acc:                         0.9585884809494019 / 0.9590718746185303
after epoch: 7,now: 2024-06-15 00:53:58.515931,epoch time: 0:17:30.475353,used: 2:04:04.804364,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_22_49_53_seed_1_21324353
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9676669, 'precision': 0.7687292, 'recall': 0.53377813, 'specificity': 0.53377813, 'f1': 0.55356956, 'auroc': 0.88990515, 'binary_precision': 0.5681818, 'binary_recall': 0.06934813, 'binary_specificity': 0.99820817, 'binary_f1_score': 0.12360939}
confusion matrix:
       0    1
0  42338   76
1   1342  100
---- Validation: 
scalar performance:
{'acc': 0.96419424, 'precision': 0.74449646, 'recall': 0.51579124, 'specificity': 0.51579124, 'f1': 0.5216437, 'auroc': 0.8831262, 'binary_precision': 0.52380955, 'binary_recall': 0.03268945, 'binary_specificity': 0.998893, 'binary_f1_score': 0.061538458}
confusion matrix:
       0   1
0  18047  20
1    651  22
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614889, 'precision': 0.98067904, 'recall': 0.5403846, 'specificity': 0.5403846, 'f1': 0.56488234, 'auroc': 0.8625105, 'binary_precision': 1.0, 'binary_recall': 0.08076923, 'binary_specificity': 1.0, 'binary_f1_score': 0.1494662}
confusion matrix:
      0   1
0  5946   0
1   239  21
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324353_8.png
new oracle model saved
early stop counter: 2
val acc:0.9641942381858826, best validation acc: 0.9641942381858826, corresponding to test acc:                         0.9585884809494019 / 0.9614889025688171
after epoch: 8,now: 2024-06-15 01:10:46.115674,epoch time: 0:16:47.599743,used: 2:20:52.404107,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_22_49_53_seed_1_21324353
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9672565, 'precision': 0.74164176, 'recall': 0.5375854, 'specificity': 0.5375854, 'f1': 0.5591261, 'auroc': 0.889662, 'binary_precision': 0.51376146, 'binary_recall': 0.0776699, 'binary_specificity': 0.99750084, 'binary_f1_score': 0.13493976}
confusion matrix:
       0    1
0  42308  106
1   1330  112
---- Validation: 
scalar performance:
{'acc': 0.96403414, 'precision': 0.7296294, 'recall': 0.5264372, 'specificity': 0.5264372, 'f1': 0.54029065, 'auroc': 0.896505, 'binary_precision': 0.49333334, 'binary_recall': 0.05497771, 'binary_specificity': 0.99789673, 'binary_f1_score': 0.09893048}
confusion matrix:
       0   1
0  18029  38
1    636  37
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9634225, 'precision': 0.9816135, 'recall': 0.56346154, 'specificity': 0.56346154, 'f1': 0.60326254, 'auroc': 0.870029, 'binary_precision': 1.0, 'binary_recall': 0.12692308, 'binary_specificity': 1.0, 'binary_f1_score': 0.22525598}
confusion matrix:
      0   1
0  5946   0
1   227  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324353_9.png
new oracle model saved
early stop counter: 3
val acc:0.9640341401100159, best validation acc: 0.9641942381858826, corresponding to test acc:                         0.9585884809494019 / 0.9634224772453308
after epoch: 9,now: 2024-06-15 01:27:38.734629,epoch time: 0:16:52.618955,used: 2:37:45.023062,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_22_49_53_seed_1_21324353
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.96787214, 'precision': 0.75787103, 'recall': 0.5683843, 'specificity': 0.5683843, 'f1': 0.603644, 'auroc': 0.89431643, 'binary_precision': 0.54423594, 'binary_recall': 0.1407767, 'binary_specificity': 0.9959919, 'binary_f1_score': 0.22369145}
confusion matrix:
       0    1
0  42244  170
1   1239  203
---- Validation: 
scalar performance:
{'acc': 0.9642476, 'precision': 0.74130577, 'recall': 0.53441584, 'specificity': 0.53441584, 'f1': 0.5535386, 'auroc': 0.89494467, 'binary_precision': 0.516129, 'binary_recall': 0.07132243, 'binary_specificity': 0.9975093, 'binary_f1_score': 0.12532637}
confusion matrix:
       0   1
0  18022  45
1    625  48
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96455044, 'precision': 0.9821602, 'recall': 0.5769231, 'specificity': 0.5769231, 'f1': 0.6242515, 'auroc': 0.86806077, 'binary_precision': 1.0, 'binary_recall': 0.15384616, 'binary_specificity': 1.0, 'binary_f1_score': 0.26666668}
confusion matrix:
      0   1
0  5946   0
1   220  40
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324353_10.png
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-06-15 01:44:19.919824,epoch time: 0:16:41.185195,used: 2:54:26.208257,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_22_49_53_seed_1_21324353
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96723366, 'precision': 0.7388153, 'recall': 0.57207364, 'specificity': 0.57207364, 'f1': 0.6067883, 'auroc': 0.8983381, 'binary_precision': 0.5058824, 'binary_recall': 0.14909847, 'binary_specificity': 0.9950488, 'binary_f1_score': 0.23031601}
confusion matrix:
       0    1
0  42204  210
1   1227  215
---- Validation: 
scalar performance:
{'acc': 0.9644077, 'precision': 0.74630654, 'recall': 0.5445126, 'specificity': 0.5445126, 'f1': 0.5692919, 'auroc': 0.89798284, 'binary_precision': 0.5254237, 'binary_recall': 0.09212481, 'binary_specificity': 0.99690044, 'binary_f1_score': 0.15676358}
confusion matrix:
       0   1
0  18011  56
1    611  62
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650338, 'precision': 0.96126926, 'recall': 0.5863703, 'specificity': 0.5863703, 'f1': 0.6376166, 'auroc': 0.8698456, 'binary_precision': 0.9574468, 'binary_recall': 0.17307693, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.29315963}
confusion matrix:
      0   1
0  5944   2
1   215  45
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324353_11.png
new oracle model saved
better model found
persisted
after epoch: 11,now: 2024-06-15 02:01:05.375220,epoch time: 0:16:45.455396,used: 3:11:11.663653,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_22_49_53_seed_1_21324353
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.96702844, 'precision': 0.7333246, 'recall': 0.5682831, 'specificity': 0.5682831, 'f1': 0.6016115, 'auroc': 0.89938724, 'binary_precision': 0.49514562, 'binary_recall': 0.14147018, 'binary_specificity': 0.99509597, 'binary_f1_score': 0.22006471}
confusion matrix:
       0    1
0  42206  208
1   1238  204
---- Validation: 
scalar performance:
{'acc': 0.9639808, 'precision': 0.72861993, 'recall': 0.5371385, 'specificity': 0.5371385, 'f1': 0.5575563, 'auroc': 0.9075085, 'binary_precision': 0.49056605, 'binary_recall': 0.07726597, 'binary_specificity': 0.9970111, 'binary_f1_score': 0.1335045}
confusion matrix:
       0   1
0  18013  54
1    621  52
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9655172, 'precision': 0.9826299, 'recall': 0.5884615, 'specificity': 0.5884615, 'f1': 0.6414882, 'auroc': 0.8689282, 'binary_precision': 1.0, 'binary_recall': 0.17692308, 'binary_specificity': 1.0, 'binary_f1_score': 0.3006536}
confusion matrix:
      0   1
0  5946   0
1   214  46
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324353_12.png
new oracle model saved
early stop counter: 1
val acc:0.9639807939529419, best validation acc: 0.9644076824188232, corresponding to test acc:                         0.9650338292121887 / 0.9655172228813171
after epoch: 12,now: 2024-06-15 02:17:48.513106,epoch time: 0:16:43.137886,used: 3:27:54.801539,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_22_49_53_seed_1_21324353
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.96600235, 'precision': 0.7105265, 'recall': 0.57348824, 'specificity': 0.57348824, 'f1': 0.60563916, 'auroc': 0.905908, 'binary_precision': 0.44918698, 'binary_recall': 0.15336572, 'binary_specificity': 0.99361074, 'binary_f1_score': 0.22866012}
confusion matrix:
       0    1
0  42144  271
1   1220  221
---- Validation: 
scalar performance:
{'acc': 0.9646211, 'precision': 0.7493124, 'recall': 0.56322026, 'specificity': 0.56322026, 'f1': 0.5958395, 'auroc': 0.9117681, 'binary_precision': 0.5301205, 'binary_recall': 0.1307578, 'binary_specificity': 0.9956827, 'binary_f1_score': 0.20977353}
confusion matrix:
       0   1
0  17989  78
1    585  88
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9687399, 'precision': 0.94619906, 'recall': 0.637957, 'specificity': 0.637957, 'f1': 0.70498395, 'auroc': 0.8772528, 'binary_precision': 0.9230769, 'binary_recall': 0.2769231, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.4260355}
confusion matrix:
      0   1
0  5940   6
1   188  72
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324353_13.png
new oracle model saved
better model found
persisted
after epoch: 13,now: 2024-06-15 02:34:41.468725,epoch time: 0:16:52.955619,used: 3:44:47.757158,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_22_49_53_seed_1_21324353
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9671197, 'precision': 0.7362642, 'recall': 0.58407295, 'specificity': 0.58407295, 'f1': 0.6207088, 'auroc': 0.90135276, 'binary_precision': 0.5, 'binary_recall': 0.1740638, 'binary_specificity': 0.99408215, 'binary_f1_score': 0.25823045}
confusion matrix:
       0    1
0  42163  251
1   1191  251
---- Validation: 
scalar performance:
{'acc': 0.9654749, 'precision': 0.7770541, 'recall': 0.5643783, 'specificity': 0.5643783, 'f1': 0.59905326, 'auroc': 0.8965863, 'binary_precision': 0.5855263, 'binary_recall': 0.13224368, 'binary_specificity': 0.996513, 'binary_f1_score': 0.21575755}
confusion matrix:
       0   1
0  18004  63
1    584  89
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96809536, 'precision': 0.9761504, 'recall': 0.6210697, 'specificity': 0.6210697, 'f1': 0.6862545, 'auroc': 0.86883605, 'binary_precision': 0.984375, 'binary_recall': 0.2423077, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.3888889}
confusion matrix:
      0   1
0  5945   1
1   197  63
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324353_14.png
better model found
persisted
after epoch: 14,now: 2024-06-15 02:51:26.428374,epoch time: 0:16:44.959649,used: 4:01:32.716807,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_22_49_53_seed_1_21324353
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.96723366, 'precision': 0.7389388, 'recall': 0.60355914, 'specificity': 0.60355914, 'f1': 0.64197683, 'auroc': 0.901923, 'binary_precision': 0.5040783, 'binary_recall': 0.21428572, 'binary_specificity': 0.99283254, 'binary_f1_score': 0.30072993}
confusion matrix:
       0    1
0  42110  304
1   1133  309
---- Validation: 
scalar performance:
{'acc': 0.96526146, 'precision': 0.7661239, 'recall': 0.57070506, 'specificity': 0.57070506, 'f1': 0.60681707, 'auroc': 0.9026041, 'binary_precision': 0.5632184, 'binary_recall': 0.14561664, 'binary_specificity': 0.99579346, 'binary_f1_score': 0.23140495}
confusion matrix:
       0   1
0  17991  76
1    575  98
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96841764, 'precision': 0.96284455, 'recall': 0.62859386, 'specificity': 0.62859386, 'f1': 0.69491905, 'auroc': 0.8764813, 'binary_precision': 0.95714283, 'binary_recall': 0.2576923, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.40606058}
confusion matrix:
      0   1
0  5943   3
1   193  67
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324353_15.png
early stop counter: 1
val acc:0.9652614593505859, best validation acc: 0.9654749035835266, corresponding to test acc:                         0.9680953621864319 / 0.968739926815033
after epoch: 15,now: 2024-06-15 03:08:06.901126,epoch time: 0:16:40.472752,used: 4:18:13.189559,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_22_49_53_seed_1_21324353
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.96714246, 'precision': 0.73703766, 'recall': 0.5941333, 'specificity': 0.5941333, 'f1': 0.6318832, 'auroc': 0.90869284, 'binary_precision': 0.50089127, 'binary_recall': 0.19486824, 'binary_specificity': 0.9933984, 'binary_f1_score': 0.28057912}
confusion matrix:
       0    1
0  42134  280
1   1161  281
---- Validation: 
scalar performance:
{'acc': 0.9641409, 'precision': 0.73561, 'recall': 0.55653375, 'specificity': 0.55653375, 'f1': 0.5860129, 'auroc': 0.9131197, 'binary_precision': 0.50318474, 'binary_recall': 0.11738484, 'binary_specificity': 0.9956827, 'binary_f1_score': 0.19036144}
confusion matrix:
       0   1
0  17989  78
1    594  79
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96841764, 'precision': 0.9565717, 'recall': 0.6304329, 'specificity': 0.6304329, 'f1': 0.69670665, 'auroc': 0.8753842, 'binary_precision': 0.9444444, 'binary_recall': 0.26153848, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.40963855}
confusion matrix:
      0   1
0  5942   4
1   192  68
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324353_16.png
early stop counter: 2
val acc:0.9641408920288086, best validation acc: 0.9654749035835266, corresponding to test acc:                         0.9680953621864319 / 0.968739926815033
after epoch: 16,now: 2024-06-15 03:24:50.170168,epoch time: 0:16:43.269042,used: 4:34:56.458601,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_22_49_53_seed_1_21324353
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9674161, 'precision': 0.742426, 'recall': 0.5972893, 'specificity': 0.5972893, 'f1': 0.6360135, 'auroc': 0.91232246, 'binary_precision': 0.5114638, 'binary_recall': 0.20110957, 'binary_specificity': 0.9934691, 'binary_f1_score': 0.28870085}
confusion matrix:
       0    1
0  42137  277
1   1152  290
---- Validation: 
scalar performance:
{'acc': 0.96376735, 'precision': 0.72118866, 'recall': 0.54131943, 'specificity': 0.54131943, 'f1': 0.5637015, 'auroc': 0.9153286, 'binary_precision': 0.47540984, 'binary_recall': 0.086181276, 'binary_specificity': 0.99645764, 'binary_f1_score': 0.14591195}
confusion matrix:
       0   1
0  18003  64
1    615  58
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9656784, 'precision': 0.9827082, 'recall': 0.5903846, 'specificity': 0.5903846, 'f1': 0.64429647, 'auroc': 0.8765503, 'binary_precision': 1.0, 'binary_recall': 0.18076923, 'binary_specificity': 1.0, 'binary_f1_score': 0.30618894}
confusion matrix:
      0   1
0  5946   0
1   213  47
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324353_17.png
early stop counter: 3
val acc:0.9637673497200012, best validation acc: 0.9654749035835266, corresponding to test acc:                         0.9680953621864319 / 0.968739926815033
after epoch: 17,now: 2024-06-15 03:41:32.512316,epoch time: 0:16:42.342148,used: 4:51:38.800749,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_22_49_53_seed_1_21324353
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.96727926, 'precision': 0.7400389, 'recall': 0.57109237, 'specificity': 0.57109237, 'f1': 0.6056825, 'auroc': 0.9061529, 'binary_precision': 0.5083933, 'binary_recall': 0.14701803, 'binary_specificity': 0.9951667, 'binary_f1_score': 0.22807962}
confusion matrix:
       0    1
0  42209  205
1   1230  212
---- Validation: 
scalar performance:
{'acc': 0.964301, 'precision': 0.7420424, 'recall': 0.543742, 'specificity': 0.543742, 'f1': 0.56800044, 'auroc': 0.9120711, 'binary_precision': 0.5169492, 'binary_recall': 0.09063893, 'binary_specificity': 0.99684507, 'binary_f1_score': 0.15423514}
confusion matrix:
       0   1
0  18010  57
1    612  61
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9658395, 'precision': 0.98278666, 'recall': 0.5923077, 'specificity': 0.5923077, 'f1': 0.64708674, 'auroc': 0.87324864, 'binary_precision': 1.0, 'binary_recall': 0.18461539, 'binary_specificity': 1.0, 'binary_f1_score': 0.31168833}
confusion matrix:
      0   1
0  5946   0
1   212  48
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324353_18.png
early stop counter: 4
val acc:0.9643009901046753, best validation acc: 0.9654749035835266, corresponding to test acc:                         0.9680953621864319 / 0.968739926815033
after epoch: 18,now: 2024-06-15 03:58:16.065428,epoch time: 0:16:43.553112,used: 5:08:22.353861,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_22_49_53_seed_1_21324353
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9676441, 'precision': 0.7503718, 'recall': 0.57027614, 'specificity': 0.57027614, 'f1': 0.6055105, 'auroc': 0.91439533, 'binary_precision': 0.52911395, 'binary_recall': 0.14493759, 'binary_specificity': 0.99561465, 'binary_f1_score': 0.22754492}
confusion matrix:
       0    1
0  42228  186
1   1233  209
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.7333137, 'recall': 0.53647864, 'specificity': 0.53647864, 'f1': 0.5566387, 'auroc': 0.91529363, 'binary_precision': 0.5, 'binary_recall': 0.075780086, 'binary_specificity': 0.9971772, 'binary_f1_score': 0.1316129}
confusion matrix:
       0   1
0  18016  51
1    622  51
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96406704, 'precision': 0.9819257, 'recall': 0.5711539, 'specificity': 0.5711539, 'f1': 0.61537564, 'auroc': 0.87733257, 'binary_precision': 1.0, 'binary_recall': 0.1423077, 'binary_specificity': 1.0, 'binary_f1_score': 0.24915825}
confusion matrix:
      0   1
0  5946   0
1   223  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324353_19.png
early stop counter: 5
val acc:0.9640874862670898, best validation acc: 0.9654749035835266, corresponding to test acc:                         0.9680953621864319 / 0.968739926815033
after epoch: 19,now: 2024-06-15 04:14:57.959637,epoch time: 0:16:41.894209,used: 5:25:04.248070,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_22_49_53_seed_1_21324353
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.96684605, 'precision': 0.7321535, 'recall': 0.6084493, 'specificity': 0.6084493, 'f1': 0.6456469, 'auroc': 0.91624904, 'binary_precision': 0.49016643, 'binary_recall': 0.22484386, 'binary_specificity': 0.9920547, 'binary_f1_score': 0.30827785}
confusion matrix:
       0    1
0  42078  337
1   1117  324
---- Validation: 
scalar performance:
{'acc': 0.96611524, 'precision': 0.783478, 'recall': 0.5847379, 'specificity': 0.5847379, 'f1': 0.62596524, 'auroc': 0.9129806, 'binary_precision': 0.5969388, 'binary_recall': 0.17384844, 'binary_specificity': 0.9956274, 'binary_f1_score': 0.269275}
confusion matrix:
       0    1
0  17988   79
1    556  117
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9666452, 'precision': 0.95069563, 'recall': 0.60927904, 'specificity': 0.60927904, 'f1': 0.66901004, 'auroc': 0.8806769, 'binary_precision': 0.93442625, 'binary_recall': 0.21923077, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.3551402}
confusion matrix:
      0   1
0  5942   4
1   203  57
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324353_20.png
better model found
persisted
after epoch: 20,now: 2024-06-15 04:31:40.975368,epoch time: 0:16:43.015731,used: 5:41:47.263801,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_22_49_53_seed_1_21324353
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9675985, 'precision': 0.74500716, 'recall': 0.6198254, 'specificity': 0.6198254, 'f1': 0.65891063, 'auroc': 0.9104881, 'binary_precision': 0.5151515, 'binary_recall': 0.24757281, 'binary_specificity': 0.99207807, 'binary_f1_score': 0.33442622}
confusion matrix:
       0    1
0  42078  336
1   1085  357
---- Validation: 
scalar performance:
{'acc': 0.9657951, 'precision': 0.7704215, 'recall': 0.59387034, 'specificity': 0.59387034, 'f1': 0.63552225, 'auroc': 0.9156007, 'binary_precision': 0.5701754, 'binary_recall': 0.19316493, 'binary_specificity': 0.99457574, 'binary_f1_score': 0.28856826}
confusion matrix:
       0    1
0  17969   98
1    543  130
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9687399, 'precision': 0.95168924, 'recall': 0.636118, 'specificity': 0.636118, 'f1': 0.7032771, 'auroc': 0.8819452, 'binary_precision': 0.93421054, 'binary_recall': 0.27307692, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.42261904}
confusion matrix:
      0   1
0  5941   5
1   189  71
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324353_21.png
early stop counter: 1
val acc:0.96579509973526, best validation acc: 0.9661152362823486, corresponding to test acc:                         0.9666451811790466 / 0.968739926815033
after epoch: 21,now: 2024-06-15 04:48:30.157586,epoch time: 0:16:49.182218,used: 5:58:36.446019,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_22_49_53_seed_1_21324353
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9662304, 'precision': 0.72080255, 'recall': 0.59600645, 'specificity': 0.59600645, 'f1': 0.6313646, 'auroc': 0.9100699, 'binary_precision': 0.46829268, 'binary_recall': 0.1997226, 'binary_specificity': 0.99229026, 'binary_f1_score': 0.28001943}
confusion matrix:
       0    1
0  42087  327
1   1154  288
---- Validation: 
scalar performance:
{'acc': 0.9653682, 'precision': 0.7676098, 'recall': 0.5743367, 'specificity': 0.5743367, 'f1': 0.61160773, 'auroc': 0.913146, 'binary_precision': 0.56593406, 'binary_recall': 0.15304606, 'binary_specificity': 0.9956274, 'binary_f1_score': 0.24093565}
confusion matrix:
       0    1
0  17988   79
1    570  103
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96841764, 'precision': 0.9694909, 'recall': 0.6267549, 'specificity': 0.6267549, 'f1': 0.69310963, 'auroc': 0.88006806, 'binary_precision': 0.9705882, 'binary_recall': 0.25384617, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.40243903}
confusion matrix:
      0   1
0  5944   2
1   194  66
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324353_22.png
early stop counter: 2
val acc:0.9653682112693787, best validation acc: 0.9661152362823486, corresponding to test acc:                         0.9666451811790466 / 0.968739926815033
after epoch: 22,now: 2024-06-15 05:05:20.941154,epoch time: 0:16:50.783568,used: 6:15:27.229587,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_22_49_53_seed_1_21324353
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9676441, 'precision': 0.74720997, 'recall': 0.5950626, 'specificity': 0.5950626, 'f1': 0.63429296, 'auroc': 0.91277343, 'binary_precision': 0.52117866, 'binary_recall': 0.1962552, 'binary_specificity': 0.99386996, 'binary_f1_score': 0.28513855}
confusion matrix:
       0    1
0  42154  260
1   1159  283
---- Validation: 
scalar performance:
{'acc': 0.9647279, 'precision': 0.7559601, 'recall': 0.5532619, 'specificity': 0.5532619, 'f1': 0.5824584, 'auroc': 0.9179914, 'binary_precision': 0.5441176, 'binary_recall': 0.10995542, 'binary_specificity': 0.9965683, 'binary_f1_score': 0.1829419}
confusion matrix:
       0   1
0  18005  62
1    599  74
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96455044, 'precision': 0.9821602, 'recall': 0.5769231, 'specificity': 0.5769231, 'f1': 0.6242515, 'auroc': 0.87620294, 'binary_precision': 1.0, 'binary_recall': 0.15384616, 'binary_specificity': 1.0, 'binary_f1_score': 0.26666668}
confusion matrix:
      0   1
0  5946   0
1   220  40
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324353_23.png
early stop counter: 3
val acc:0.9647278785705566, best validation acc: 0.9661152362823486, corresponding to test acc:                         0.9666451811790466 / 0.968739926815033
after epoch: 23,now: 2024-06-15 05:22:04.997408,epoch time: 0:16:44.056254,used: 6:32:11.285841,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_22_49_53_seed_1_21324353
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9668688, 'precision': 0.73262155, 'recall': 0.60471034, 'specificity': 0.60471034, 'f1': 0.6420693, 'auroc': 0.91694665, 'binary_precision': 0.4913658, 'binary_recall': 0.21705964, 'binary_specificity': 0.992361, 'binary_f1_score': 0.3011063}
confusion matrix:
       0    1
0  42090  324
1   1129  313
---- Validation: 
scalar performance:
{'acc': 0.96584845, 'precision': 0.7729042, 'recall': 0.5910369, 'specificity': 0.5910369, 'f1': 0.6325096, 'auroc': 0.9226048, 'binary_precision': 0.5753425, 'binary_recall': 0.1872214, 'binary_specificity': 0.9948525, 'binary_f1_score': 0.2825112}
confusion matrix:
       0    1
0  17974   93
1    547  126
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9695456, 'precision': 0.9347251, 'recall': 0.65308934, 'specificity': 0.65308934, 'f1': 0.7213925, 'auroc': 0.890175, 'binary_precision': 0.8988764, 'binary_recall': 0.30769232, 'binary_specificity': 0.9984864, 'binary_f1_score': 0.45845276}
confusion matrix:
      0   1
0  5937   9
1   180  80
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324353_24.png
new oracle model saved
early stop counter: 4
val acc:0.965848445892334, best validation acc: 0.9661152362823486, corresponding to test acc:                         0.9666451811790466 / 0.9695456027984619
after epoch: 24,now: 2024-06-15 05:38:43.536822,epoch time: 0:16:38.539414,used: 6:48:49.825255,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_22_49_53_seed_1_21324353
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9657515, 'precision': 0.7184061, 'recall': 0.6226319, 'specificity': 0.6226319, 'f1': 0.65564626, 'auroc': 0.9146029, 'binary_precision': 0.4617315, 'binary_recall': 0.25537822, 'binary_specificity': 0.9898856, 'binary_f1_score': 0.32886508}
confusion matrix:
       0    1
0  41986  429
1   1073  368
---- Validation: 
scalar performance:
{'acc': 0.9665422, 'precision': 0.77865106, 'recall': 0.6142853, 'specificity': 0.6142853, 'f1': 0.65897006, 'auroc': 0.915724, 'binary_precision': 0.58518517, 'binary_recall': 0.23476969, 'binary_specificity': 0.9938009, 'binary_f1_score': 0.33510074}
confusion matrix:
       0    1
0  17955  112
1    515  158
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9705124, 'precision': 0.93839496, 'recall': 0.6646278, 'specificity': 0.6646278, 'f1': 0.73466456, 'auroc': 0.88248193, 'binary_precision': 0.9052632, 'binary_recall': 0.33076924, 'binary_specificity': 0.9984864, 'binary_f1_score': 0.48450705}
confusion matrix:
      0   1
0  5937   9
1   174  86
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324353_25.png
new oracle model saved
better model found
persisted
after epoch: 25,now: 2024-06-15 05:55:23.162176,epoch time: 0:16:39.625354,used: 7:05:29.450609,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_22_49_53_seed_1_21324353
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9679405, 'precision': 0.7537131, 'recall': 0.5945459, 'specificity': 0.5945459, 'f1': 0.63458574, 'auroc': 0.9184605, 'binary_precision': 0.5342205, 'binary_recall': 0.19486824, 'binary_specificity': 0.9942236, 'binary_f1_score': 0.2855691}
confusion matrix:
       0    1
0  42169  245
1   1161  281
---- Validation: 
scalar performance:
{'acc': 0.9647812, 'precision': 0.75939214, 'recall': 0.55042845, 'specificity': 0.55042845, 'f1': 0.57850325, 'auroc': 0.91933584, 'binary_precision': 0.5511811, 'binary_recall': 0.104011886, 'binary_specificity': 0.99684507, 'binary_f1_score': 0.175}
confusion matrix:
       0   1
0  18010  57
1    603  70
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9656784, 'precision': 0.9827082, 'recall': 0.5903846, 'specificity': 0.5903846, 'f1': 0.64429647, 'auroc': 0.8819399, 'binary_precision': 1.0, 'binary_recall': 0.18076923, 'binary_specificity': 1.0, 'binary_f1_score': 0.30618894}
confusion matrix:
      0   1
0  5946   0
1   213  47
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324353_26.png
early stop counter: 1
val acc:0.9647812247276306, best validation acc: 0.9665421843528748, corresponding to test acc:                         0.9705123901367188 / 0.9705123901367188
after epoch: 26,now: 2024-06-15 06:12:04.433460,epoch time: 0:16:41.271284,used: 7:22:10.721893,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_22_49_53_seed_1_21324353
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9674389, 'precision': 0.7423687, 'recall': 0.6287866, 'specificity': 0.6287866, 'f1': 0.6665141, 'auroc': 0.91882, 'binary_precision': 0.50928384, 'binary_recall': 0.2662968, 'binary_specificity': 0.99127644, 'binary_f1_score': 0.34972677}
confusion matrix:
       0    1
0  42044  370
1   1058  384
---- Validation: 
scalar performance:
{'acc': 0.96499467, 'precision': 0.7563118, 'recall': 0.5770041, 'specificity': 0.5770041, 'f1': 0.61402917, 'auroc': 0.9222132, 'binary_precision': 0.5431472, 'binary_recall': 0.1589896, 'binary_specificity': 0.99501854, 'binary_f1_score': 0.245977}
confusion matrix:
       0    1
0  17977   90
1    566  107
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97115695, 'precision': 0.97944057, 'recall': 0.6576082, 'specificity': 0.6576082, 'f1': 0.73165137, 'auroc': 0.88249487, 'binary_precision': 0.9879518, 'binary_recall': 0.31538463, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.47813413}
confusion matrix:
      0   1
0  5945   1
1   178  82
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324353_27.png
new oracle model saved
early stop counter: 2
val acc:0.9649946689605713, best validation acc: 0.9665421843528748, corresponding to test acc:                         0.9705123901367188 / 0.9711569547653198
after epoch: 27,now: 2024-06-15 06:28:43.382930,epoch time: 0:16:38.949470,used: 7:38:49.671363,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_22_49_53_seed_1_21324353
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.96723366, 'precision': 0.7393828, 'recall': 0.6296854, 'specificity': 0.6296854, 'f1': 0.6666305, 'auroc': 0.91350055, 'binary_precision': 0.50325096, 'binary_recall': 0.26837724, 'binary_specificity': 0.99099356, 'binary_f1_score': 0.35006782}
confusion matrix:
       0    1
0  42032  382
1   1055  387
---- Validation: 
scalar performance:
{'acc': 0.96627533, 'precision': 0.77214754, 'recall': 0.6177232, 'specificity': 0.6177232, 'f1': 0.6614938, 'auroc': 0.91949344, 'binary_precision': 0.5719298, 'binary_recall': 0.24219911, 'binary_specificity': 0.99324733, 'binary_f1_score': 0.34029227}
confusion matrix:
       0    1
0  17945  122
1    510  163
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97115695, 'precision': 0.9490849, 'recall': 0.66864216, 'specificity': 0.66864216, 'f1': 0.74046427, 'auroc': 0.8857548, 'binary_precision': 0.9263158, 'binary_recall': 0.33846155, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.4957747}
confusion matrix:
      0   1
0  5939   7
1   172  88
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324353_28.png
early stop counter: 3
val acc:0.9662753343582153, best validation acc: 0.9665421843528748, corresponding to test acc:                         0.9705123901367188 / 0.9711569547653198
after epoch: 28,now: 2024-06-15 06:45:27.135557,epoch time: 0:16:43.752627,used: 7:55:33.423990,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_22_49_53_seed_1_21324353
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9671653, 'precision': 0.7384229, 'recall': 0.63031995, 'specificity': 0.63031995, 'f1': 0.66696155, 'auroc': 0.9193549, 'binary_precision': 0.50128865, 'binary_recall': 0.2697642, 'binary_specificity': 0.99087566, 'binary_f1_score': 0.35076645}
confusion matrix:
       0    1
0  42027  387
1   1053  389
---- Validation: 
scalar performance:
{'acc': 0.965635, 'precision': 0.7674774, 'recall': 0.5916415, 'specificity': 0.5916415, 'f1': 0.63262326, 'auroc': 0.9236266, 'binary_precision': 0.5644444, 'binary_recall': 0.18870728, 'binary_specificity': 0.99457574, 'binary_f1_score': 0.28285077}
confusion matrix:
       0    1
0  17969   98
1    546  127
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.970029, 'precision': 0.9721664, 'recall': 0.64598566, 'specificity': 0.64598566, 'f1': 0.71714956, 'auroc': 0.8834716, 'binary_precision': 0.974359, 'binary_recall': 0.2923077, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.44970417}
confusion matrix:
      0   1
0  5944   2
1   184  76
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324353_29.png
early stop counter: 4
val acc:0.9656350016593933, best validation acc: 0.9665421843528748, corresponding to test acc:                         0.9705123901367188 / 0.9711569547653198
after epoch: 29,now: 2024-06-15 07:02:02.850304,epoch time: 0:16:35.714747,used: 8:12:09.138737,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_22_49_53_seed_1_21324353
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9676897, 'precision': 0.74609625, 'recall': 0.6302561, 'specificity': 0.6302561, 'f1': 0.6686419, 'auroc': 0.9177767, 'binary_precision': 0.5166445, 'binary_recall': 0.26907074, 'binary_specificity': 0.9914415, 'binary_f1_score': 0.3538532}
confusion matrix:
       0    1
0  42051  363
1   1054  388
---- Validation: 
scalar performance:
{'acc': 0.9666489, 'precision': 0.7853149, 'recall': 0.60504216, 'specificity': 0.60504216, 'f1': 0.6499235, 'auroc': 0.9240507, 'binary_precision': 0.59917355, 'binary_recall': 0.2154532, 'binary_specificity': 0.9946311, 'binary_f1_score': 0.3169399}
confusion matrix:
       0    1
0  17970   97
1    528  145
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.970029, 'precision': 0.96631366, 'recall': 0.64782465, 'specificity': 0.64782465, 'f1': 0.7187668, 'auroc': 0.88869905, 'binary_precision': 0.9625, 'binary_recall': 0.29615384, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.45294115}
confusion matrix:
      0   1
0  5943   3
1   183  77
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324353_30.png
better model found
persisted
after epoch: 30,now: 2024-06-15 07:18:39.707739,epoch time: 0:16:36.857435,used: 8:28:45.996172,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_22_49_53_seed_1_21324353
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 8:28:45.996172 at 2024-06-15 07:18:39.707739
persisted model performance metric: 

scalar performance:
{'acc': 0.970029, 'precision': 0.96631366, 'recall': 0.64782465, 'specificity': 0.64782465, 'f1': 0.7187668, 'auroc': 0.88869905, 'binary_precision': 0.9625, 'binary_recall': 0.29615384, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.45294115}
confusion matrix:
      0   1
0  5943   3
1   183  77
oracle model performance metric: 

scalar performance:
{'acc': 0.97115695, 'precision': 0.97944057, 'recall': 0.6576082, 'specificity': 0.6576082, 'f1': 0.73165137, 'auroc': 0.88249487, 'binary_precision': 0.9879518, 'binary_recall': 0.31538463, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.47813413}
confusion matrix:
      0   1
0  5945   1
1   178  82
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_bs16_different_learningrates/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_resnet_bs16_different_learningrates/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204071 KiB | 640729 KiB |   1888 TiB |   1888 TiB |
|       from large pool | 167040 KiB | 568000 KiB |   1888 TiB |   1888 TiB |
|       from small pool |  37031 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 204071 KiB | 640729 KiB |   1888 TiB |   1888 TiB |
|       from large pool | 167040 KiB | 568000 KiB |   1888 TiB |   1888 TiB |
|       from small pool |  37031 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201086 KiB | 632296 KiB |   1880 TiB |   1880 TiB |
|       from large pool | 165120 KiB | 560704 KiB |   1880 TiB |   1880 TiB |
|       from small pool |  35966 KiB |  73944 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 675840 KiB | 755712 KiB |   1120 MiB | 471040 KiB |
|       from large pool | 600064 KiB | 679936 KiB |   1020 MiB | 444416 KiB |
|       from small pool |  75776 KiB |  75776 KiB |    100 MiB |  26624 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  80600 KiB | 218089 KiB | 709583 GiB | 709583 GiB |
|       from large pool |  68480 KiB | 217080 KiB | 708974 GiB | 708974 GiB |
|       from small pool |  12120 KiB |  19703 KiB |    608 GiB |    608 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3228    |    6231    |  167413 K  |  167410 K  |
|       from large pool |      36    |      76    |   67679 K  |   67679 K  |
|       from small pool |    3192    |    6194    |   99734 K  |   99731 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3228    |    6231    |  167413 K  |  167410 K  |
|       from large pool |      36    |      76    |   67679 K  |   67679 K  |
|       from small pool |    3192    |    6194    |   99734 K  |   99731 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      51    |      51    |      68    |      17    |
|       from large pool |      14    |      14    |      18    |       4    |
|       from small pool |      37    |      37    |      50    |      13    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      38    |    2755    |   76314 K  |   76314 K  |
|       from large pool |       5    |      13    |   25320 K  |   25320 K  |
|       from small pool |      33    |    2750    |   50993 K  |   50993 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 640729 KiB |   1888 TiB |   1888 TiB |
|       from large pool |  16640 KiB | 568000 KiB |   1888 TiB |   1888 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 640729 KiB |   1888 TiB |   1888 TiB |
|       from large pool |  16640 KiB | 568000 KiB |   1888 TiB |   1888 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 632296 KiB |   1880 TiB |   1880 TiB |
|       from large pool |  16640 KiB | 560704 KiB |   1880 TiB |   1880 TiB |
|       from small pool |      0 KiB |  73944 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 284672 KiB | 755712 KiB |   1120 MiB |    842 MiB |
|       from large pool | 235520 KiB | 679936 KiB |   1020 MiB |    790 MiB |
|       from small pool |  49152 KiB |  75776 KiB |    100 MiB |     52 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  55040 KiB | 218089 KiB | 709583 GiB | 709583 GiB |
|       from large pool |  55040 KiB | 217080 KiB | 708974 GiB | 708974 GiB |
|       from small pool |      0 KiB |  19715 KiB |    608 GiB |    608 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6231    |  167413 K  |  167413 K  |
|       from large pool |       2    |      76    |   67679 K  |   67679 K  |
|       from small pool |       0    |    6194    |   99734 K  |   99734 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6231    |  167413 K  |  167413 K  |
|       from large pool |       2    |      76    |   67679 K  |   67679 K  |
|       from small pool |       0    |    6194    |   99734 K  |   99734 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      34    |      51    |      68    |      34    |
|       from large pool |      10    |      14    |      18    |       8    |
|       from small pool |      24    |      37    |      50    |      26    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2755    |   76315 K  |   76315 K  |
|       from large pool |       3    |      13    |   25320 K  |   25320 K  |
|       from small pool |       0    |    2750    |   50995 K  |   50995 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 640729 KiB |   1888 TiB |   1888 TiB |
|       from large pool |  16640 KiB | 568000 KiB |   1888 TiB |   1888 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 640729 KiB |   1888 TiB |   1888 TiB |
|       from large pool |  16640 KiB | 568000 KiB |   1888 TiB |   1888 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 632296 KiB |   1880 TiB |   1880 TiB |
|       from large pool |  16640 KiB | 560704 KiB |   1880 TiB |   1880 TiB |
|       from small pool |      0 KiB |  73944 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 284672 KiB | 755712 KiB |   1120 MiB |    842 MiB |
|       from large pool | 235520 KiB | 679936 KiB |   1020 MiB |    790 MiB |
|       from small pool |  49152 KiB |  75776 KiB |    100 MiB |     52 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  55040 KiB | 218089 KiB | 709583 GiB | 709583 GiB |
|       from large pool |  55040 KiB | 217080 KiB | 708974 GiB | 708974 GiB |
|       from small pool |      0 KiB |  19715 KiB |    608 GiB |    608 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6231    |  167413 K  |  167413 K  |
|       from large pool |       2    |      76    |   67679 K  |   67679 K  |
|       from small pool |       0    |    6194    |   99734 K  |   99734 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6231    |  167413 K  |  167413 K  |
|       from large pool |       2    |      76    |   67679 K  |   67679 K  |
|       from small pool |       0    |    6194    |   99734 K  |   99734 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      34    |      51    |      68    |      34    |
|       from large pool |      10    |      14    |      18    |       8    |
|       from small pool |      24    |      37    |      50    |      26    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2755    |   76315 K  |   76315 K  |
|       from large pool |       3    |      13    |   25320 K  |   25320 K  |
|       from small pool |       0    |    2750    |   50995 K  |   50995 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0




!!!: not committed yet



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_07_26_04_seed_2_21324353

 Experiment start at: 2024-06-15 07:26:04.089532
before training, model accuracy: 0.0544959120452404
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96547556, 'precision': 0.48273778, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4912173, 'auroc': 0.5159328, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42311  0
1   1513  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.46474057, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.4011593, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324353_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-15 07:43:05.575002,epoch time: 0:17:01.485470,used: 0:17:01.485470,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_07_26_04_seed_2_21324353
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96547556, 'precision': 0.48273778, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4912173, 'auroc': 0.6967689, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42311  0
1   1513  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.7092568, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.67308795, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324353_2.png
early stop counter: 1
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 2,now: 2024-06-15 07:59:39.991619,epoch time: 0:16:34.416617,used: 0:33:35.902087,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_07_26_04_seed_2_21324353
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96547556, 'precision': 0.48273778, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4912173, 'auroc': 0.79780084, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42311  0
1   1513  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.80697066, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.7870728, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324353_3.png
early stop counter: 2
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 3,now: 2024-06-15 08:16:12.993791,epoch time: 0:16:33.002172,used: 0:50:08.904259,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_07_26_04_seed_2_21324353
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96547556, 'precision': 0.48273778, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4912173, 'auroc': 0.8345969, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42311  0
1   1513  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.83894, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.81894696, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324353_4.png
early stop counter: 3
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 4,now: 2024-06-15 08:32:58.021227,epoch time: 0:16:45.027436,used: 1:06:53.931695,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_07_26_04_seed_2_21324353
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96547556, 'precision': 0.73280156, 'recall': 0.50191194, 'specificity': 0.50191194, 'f1': 0.49515048, 'auroc': 0.8533509, 'binary_precision': 0.5, 'binary_recall': 0.003965631, 'binary_specificity': 0.9998582, 'binary_f1_score': 0.0078688525}
confusion matrix:
       0  1
0  42305  6
1   1507  6
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.73399127, 'recall': 0.50080305, 'specificity': 0.50080305, 'f1': 0.49350777, 'auroc': 0.86773324, 'binary_precision': 0.5, 'binary_recall': 0.0016611295, 'binary_specificity': 0.999945, 'binary_f1_score': 0.0033112583}
confusion matrix:
       0  1
0  18170  1
1    601  1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.8403685, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324353_5.png
early stop counter: 4
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 5,now: 2024-06-15 08:49:35.696041,epoch time: 0:16:37.674814,used: 1:23:31.606509,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_07_26_04_seed_2_21324353
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96545273, 'precision': 0.72989494, 'recall': 0.51209694, 'specificity': 0.51209694, 'f1': 0.515103, 'auroc': 0.87322783, 'binary_precision': 0.4935065, 'binary_recall': 0.025115665, 'binary_specificity': 0.9990783, 'binary_f1_score': 0.047798745}
confusion matrix:
       0   1
0  42272  39
1   1475  38
---- Validation: 
scalar performance:
{'acc': 0.9677196, 'precision': 0.5673212, 'recall': 0.500693, 'specificity': 0.500693, 'f1': 0.49344182, 'auroc': 0.87826633, 'binary_precision': 0.16666667, 'binary_recall': 0.0016611295, 'binary_specificity': 0.99972486, 'binary_f1_score': 0.0032894735}
confusion matrix:
       0  1
0  18166  5
1    601  1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9616926, 'precision': 0.9808371, 'recall': 0.50619835, 'specificity': 0.50619835, 'f1': 0.5024762, 'auroc': 0.85445696, 'binary_precision': 1.0, 'binary_recall': 0.012396694, 'binary_specificity': 1.0, 'binary_f1_score': 0.024489796}
confusion matrix:
      0  1
0  5997  0
1   239  3
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324353_6.png
new oracle model saved
early stop counter: 5
val acc:0.9677196145057678, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9616925716400146
after epoch: 6,now: 2024-06-15 09:06:13.481806,epoch time: 0:16:37.785765,used: 1:40:09.392274,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_07_26_04_seed_2_21324353
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9653614, 'precision': 0.7247298, 'recall': 0.5219279, 'specificity': 0.5219279, 'f1': 0.53284025, 'auroc': 0.88490784, 'binary_precision': 0.48251748, 'binary_recall': 0.045604758, 'binary_specificity': 0.998251, 'binary_f1_score': 0.08333333}
confusion matrix:
       0   1
0  42237  74
1   1444  69
---- Validation: 
scalar performance:
{'acc': 0.96745324, 'precision': 0.65084994, 'recall': 0.5069798, 'specificity': 0.5069798, 'f1': 0.5060331, 'auroc': 0.8902766, 'binary_precision': 0.33333334, 'binary_recall': 0.014950166, 'binary_specificity': 0.99900943, 'binary_f1_score': 0.028616853}
confusion matrix:
       0   1
0  18153  18
1    593   9
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96473795, 'precision': 0.961548, 'recall': 0.54743725, 'specificity': 0.54743725, 'f1': 0.5774586, 'auroc': 0.8650467, 'binary_precision': 0.9583333, 'binary_recall': 0.09504132, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.17293233}
confusion matrix:
      0   1
0  5996   1
1   219  23
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324353_7.png
new oracle model saved
early stop counter: 6
val acc:0.9674532413482666, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9647379517555237
after epoch: 7,now: 2024-06-15 09:22:44.228766,epoch time: 0:16:30.746960,used: 1:56:40.139234,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_07_26_04_seed_2_21324353
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9648594, 'precision': 0.7083225, 'recall': 0.5372819, 'specificity': 0.5372819, 'f1': 0.5574746, 'auroc': 0.8867729, 'binary_precision': 0.4486692, 'binary_recall': 0.07799075, 'binary_specificity': 0.996573, 'binary_f1_score': 0.13288288}
confusion matrix:
       0    1
0  42166  145
1   1395  118
---- Validation: 
scalar performance:
{'acc': 0.9679859, 'precision': 0.7389546, 'recall': 0.52411896, 'specificity': 0.52411896, 'f1': 0.53723884, 'auroc': 0.89051557, 'binary_precision': 0.5084746, 'binary_recall': 0.049833886, 'binary_specificity': 0.998404, 'binary_f1_score': 0.090771556}
confusion matrix:
       0   1
0  18142  29
1    572  30
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9663408, 'precision': 0.9684528, 'recall': 0.5680984, 'specificity': 0.5680984, 'f1': 0.61096007, 'auroc': 0.85991496, 'binary_precision': 0.9705882, 'binary_recall': 0.13636364, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.23913045}
confusion matrix:
      0   1
0  5996   1
1   209  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324353_8.png
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-06-15 09:39:38.909375,epoch time: 0:16:54.680609,used: 2:13:34.819843,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_07_26_04_seed_2_21324353
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9655668, 'precision': 0.7378907, 'recall': 0.54402125, 'specificity': 0.54402125, 'f1': 0.5685237, 'auroc': 0.9018648, 'binary_precision': 0.50735295, 'binary_recall': 0.091209516, 'binary_specificity': 0.99683297, 'binary_f1_score': 0.15462185}
confusion matrix:
       0    1
0  42177  134
1   1375  138
---- Validation: 
scalar performance:
{'acc': 0.9676663, 'precision': 0.70900166, 'recall': 0.5175295, 'specificity': 0.5175295, 'f1': 0.52556807, 'auroc': 0.9022485, 'binary_precision': 0.4489796, 'binary_recall': 0.036544852, 'binary_specificity': 0.9985141, 'binary_f1_score': 0.06758832}
confusion matrix:
       0   1
0  18144  27
1    580  22
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9669819, 'precision': 0.9585457, 'recall': 0.57834566, 'specificity': 0.57834566, 'f1': 0.62630635, 'auroc': 0.8692123, 'binary_precision': 0.95, 'binary_recall': 0.1570248, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.26950356}
confusion matrix:
      0   1
0  5995   2
1   204  38
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324353_9.png
new oracle model saved
early stop counter: 1
val acc:0.9676663279533386, best validation acc: 0.9679859280586243, corresponding to test acc:                         0.9663407802581787 / 0.9669818878173828
after epoch: 9,now: 2024-06-15 09:56:25.677222,epoch time: 0:16:46.767847,used: 2:30:21.587690,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_07_26_04_seed_2_21324353
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.965795, 'precision': 0.748683, 'recall': 0.5406343, 'specificity': 0.5406343, 'f1': 0.5637215, 'auroc': 0.89265126, 'binary_precision': 0.52916664, 'binary_recall': 0.083939195, 'binary_specificity': 0.9973293, 'binary_f1_score': 0.14489447}
confusion matrix:
       0    1
0  42198  113
1   1386  127
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.734842, 'recall': 0.5281067, 'specificity': 0.5281067, 'f1': 0.5439204, 'auroc': 0.8993963, 'binary_precision': 0.5, 'binary_recall': 0.058139537, 'binary_specificity': 0.9980739, 'binary_f1_score': 0.104166664}
confusion matrix:
       0   1
0  18136  35
1    567  35
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96666133, 'precision': 0.9694256, 'recall': 0.57223064, 'specificity': 0.57223064, 'f1': 0.61737466, 'auroc': 0.87227947, 'binary_precision': 0.9722222, 'binary_recall': 0.1446281, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.25179857}
confusion matrix:
      0   1
0  5996   1
1   207  35
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324353_10.png
early stop counter: 2
val acc:0.9679326415061951, best validation acc: 0.9679859280586243, corresponding to test acc:                         0.9663407802581787 / 0.9669818878173828
after epoch: 10,now: 2024-06-15 10:13:04.574756,epoch time: 0:16:38.897534,used: 2:47:00.485224,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_07_26_04_seed_2_21324353
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96552116, 'precision': 0.73618674, 'recall': 0.56694055, 'specificity': 0.56694055, 'f1': 0.59993804, 'auroc': 0.9008131, 'binary_precision': 0.50239235, 'binary_recall': 0.13879709, 'binary_specificity': 0.99508405, 'binary_f1_score': 0.21750388}
confusion matrix:
       0    1
0  42103  208
1   1303  210
---- Validation: 
scalar performance:
{'acc': 0.9682523, 'precision': 0.752194, 'recall': 0.5379084, 'specificity': 0.5379084, 'f1': 0.56003046, 'auroc': 0.9010973, 'binary_precision': 0.53409094, 'binary_recall': 0.07807309, 'binary_specificity': 0.99774367, 'binary_f1_score': 0.1362319}
confusion matrix:
       0   1
0  18130  41
1    555  47
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9685847, 'precision': 0.964327, 'recall': 0.59900683, 'specificity': 0.59900683, 'f1': 0.65634155, 'auroc': 0.876837, 'binary_precision': 0.96, 'binary_recall': 0.1983471, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.32876712}
confusion matrix:
      0   1
0  5995   2
1   194  48
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324353_11.png
new oracle model saved
better model found
persisted
after epoch: 11,now: 2024-06-15 10:29:46.314115,epoch time: 0:16:41.739359,used: 3:03:42.224583,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_07_26_04_seed_2_21324353
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9660688, 'precision': 0.7510736, 'recall': 0.5691361, 'specificity': 0.5691361, 'f1': 0.60388595, 'auroc': 0.9087076, 'binary_precision': 0.5320197, 'binary_recall': 0.14276272, 'binary_specificity': 0.99550945, 'binary_f1_score': 0.22511724}
confusion matrix:
       0    1
0  42121  190
1   1297  216
---- Validation: 
scalar performance:
{'acc': 0.96761304, 'precision': 0.722654, 'recall': 0.54480565, 'specificity': 0.54480565, 'f1': 0.56952274, 'auroc': 0.907593, 'binary_precision': 0.47457626, 'binary_recall': 0.093023255, 'binary_specificity': 0.996588, 'binary_f1_score': 0.15555556}
confusion matrix:
       0   1
0  18109  62
1    546  56
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9705081, 'precision': 0.9619067, 'recall': 0.6257829, 'specificity': 0.6257829, 'f1': 0.6917881, 'auroc': 0.87184703, 'binary_precision': 0.953125, 'binary_recall': 0.2520661, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.3986928}
confusion matrix:
      0   1
0  5994   3
1   181  61
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324353_12.png
new oracle model saved
early stop counter: 1
val acc:0.9676130414009094, best validation acc: 0.9682523012161255, corresponding to test acc:                         0.9685847163200378 / 0.9705080986022949
after epoch: 12,now: 2024-06-15 10:47:04.845373,epoch time: 0:17:18.531258,used: 3:21:00.755841,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_07_26_04_seed_2_21324353
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.96577215, 'precision': 0.7440361, 'recall': 0.557511, 'specificity': 0.557511, 'f1': 0.5880317, 'auroc': 0.9106365, 'binary_precision': 0.518732, 'binary_recall': 0.118968934, 'binary_specificity': 0.99605304, 'binary_f1_score': 0.1935484}
confusion matrix:
       0    1
0  42144  167
1   1333  180
---- Validation: 
scalar performance:
{'acc': 0.96761304, 'precision': 0.7194636, 'recall': 0.53597206, 'specificity': 0.53597206, 'f1': 0.5562198, 'auroc': 0.9089608, 'binary_precision': 0.46875, 'binary_recall': 0.07475083, 'binary_specificity': 0.99719334, 'binary_f1_score': 0.12893984}
confusion matrix:
       0   1
0  18120  51
1    557  45
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9695464, 'precision': 0.98464525, 'recall': 0.607438, 'specificity': 0.607438, 'f1': 0.6690736, 'auroc': 0.8740205, 'binary_precision': 1.0, 'binary_recall': 0.21487603, 'binary_specificity': 1.0, 'binary_f1_score': 0.35374147}
confusion matrix:
      0   1
0  5997   0
1   190  52
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324353_13.png
early stop counter: 2
val acc:0.9676130414009094, best validation acc: 0.9682523012161255, corresponding to test acc:                         0.9685847163200378 / 0.9705080986022949
after epoch: 13,now: 2024-06-15 11:03:59.540402,epoch time: 0:16:54.695029,used: 3:37:55.450870,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_07_26_04_seed_2_21324353
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96611446, 'precision': 0.74805963, 'recall': 0.59751976, 'specificity': 0.59751976, 'f1': 0.63690585, 'auroc': 0.91068584, 'binary_precision': 0.524055, 'binary_recall': 0.20158625, 'binary_specificity': 0.99345326, 'binary_f1_score': 0.29116943}
confusion matrix:
       0    1
0  42034  277
1   1208  305
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.7358508, 'recall': 0.56022865, 'specificity': 0.56022865, 'f1': 0.5915534, 'auroc': 0.9085713, 'binary_precision': 0.5, 'binary_recall': 0.12458472, 'binary_specificity': 0.99587256, 'binary_f1_score': 0.19946808}
confusion matrix:
       0   1
0  18096  75
1    527  75
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97259176, 'precision': 0.96688753, 'recall': 0.6526424, 'specificity': 0.6526424, 'f1': 0.7249431, 'auroc': 0.88050175, 'binary_precision': 0.96103895, 'binary_recall': 0.30578512, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.46394986}
confusion matrix:
      0   1
0  5994   3
1   168  74
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324353_14.png
new oracle model saved
early stop counter: 3
val acc:0.9679326415061951, best validation acc: 0.9682523012161255, corresponding to test acc:                         0.9685847163200378 / 0.972591757774353
after epoch: 14,now: 2024-06-15 11:20:33.722361,epoch time: 0:16:34.181959,used: 3:54:29.632829,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_07_26_04_seed_2_21324353
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.96590906, 'precision': 0.7446704, 'recall': 0.5875352, 'specificity': 0.5875352, 'f1': 0.62545615, 'auroc': 0.898335, 'binary_precision': 0.5179584, 'binary_recall': 0.18109716, 'binary_specificity': 0.9939732, 'binary_f1_score': 0.26836437}
confusion matrix:
       0    1
0  42056  255
1   1239  274
---- Validation: 
scalar performance:
{'acc': 0.96745324, 'precision': 0.7203859, 'recall': 0.55516267, 'specificity': 0.55516267, 'f1': 0.5838205, 'auroc': 0.91348046, 'binary_precision': 0.46938777, 'binary_recall': 0.114617944, 'binary_specificity': 0.99570745, 'binary_f1_score': 0.18424568}
confusion matrix:
       0   1
0  18093  78
1    533  69
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9722712, 'precision': 0.972435, 'recall': 0.64652747, 'specificity': 0.64652747, 'f1': 0.7182851, 'auroc': 0.8800938, 'binary_precision': 0.9726027, 'binary_recall': 0.29338843, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.45079362}
confusion matrix:
      0   1
0  5995   2
1   171  71
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324353_15.png
early stop counter: 4
val acc:0.9674532413482666, best validation acc: 0.9682523012161255, corresponding to test acc:                         0.9685847163200378 / 0.972591757774353
after epoch: 15,now: 2024-06-15 11:37:12.459135,epoch time: 0:16:38.736774,used: 4:11:08.369603,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_07_26_04_seed_2_21324353
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.96643394, 'precision': 0.7528364, 'recall': 0.60915667, 'specificity': 0.60915667, 'f1': 0.6497808, 'auroc': 0.9106351, 'binary_precision': 0.5328125, 'binary_recall': 0.22538003, 'binary_specificity': 0.9929333, 'binary_f1_score': 0.31676728}
confusion matrix:
       0    1
0  42012  299
1   1172  341
---- Validation: 
scalar performance:
{'acc': 0.9679859, 'precision': 0.7376288, 'recall': 0.57230186, 'specificity': 0.57230186, 'f1': 0.60706335, 'auroc': 0.9112554, 'binary_precision': 0.5027933, 'binary_recall': 0.14950167, 'binary_specificity': 0.9951021, 'binary_f1_score': 0.23047376}
confusion matrix:
       0   1
0  18082  89
1    512  90
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9729123, 'precision': 0.96191144, 'recall': 0.65875745, 'specificity': 0.65875745, 'f1': 0.7314382, 'auroc': 0.8812256, 'binary_precision': 0.9506173, 'binary_recall': 0.3181818, 'binary_specificity': 0.999333, 'binary_f1_score': 0.4767802}
confusion matrix:
      0   1
0  5993   4
1   165  77
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324353_16.png
new oracle model saved
early stop counter: 5
val acc:0.9679859280586243, best validation acc: 0.9682523012161255, corresponding to test acc:                         0.9685847163200378 / 0.9729123115539551
after epoch: 16,now: 2024-06-15 11:54:07.330918,epoch time: 0:16:54.871783,used: 4:28:03.241386,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_07_26_04_seed_2_21324353
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.96584064, 'precision': 0.74227375, 'recall': 0.617453, 'specificity': 0.617453, 'f1': 0.6560376, 'auroc': 0.9171881, 'binary_precision': 0.51111114, 'binary_recall': 0.24322538, 'binary_specificity': 0.9916806, 'binary_f1_score': 0.32960144}
confusion matrix:
       0    1
0  41959  352
1   1145  368
---- Validation: 
scalar performance:
{'acc': 0.9686251, 'precision': 0.7538749, 'recall': 0.58066255, 'specificity': 0.58066255, 'f1': 0.6187306, 'auroc': 0.90834934, 'binary_precision': 0.53475934, 'binary_recall': 0.16611296, 'binary_specificity': 0.99521214, 'binary_f1_score': 0.2534854}
confusion matrix:
       0    1
0  18084   87
1    502  100
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9729123, 'precision': 0.96753865, 'recall': 0.65677464, 'specificity': 0.65677464, 'f1': 0.7298094, 'auroc': 0.8788483, 'binary_precision': 0.96202534, 'binary_recall': 0.3140496, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.47352028}
confusion matrix:
      0   1
0  5994   3
1   166  76
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324353_17.png
better model found
persisted
after epoch: 17,now: 2024-06-15 12:10:57.182415,epoch time: 0:16:49.851497,used: 4:44:53.092883,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_07_26_04_seed_2_21324353
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9662514, 'precision': 0.7516742, 'recall': 0.59121764, 'specificity': 0.59121764, 'f1': 0.6304531, 'auroc': 0.90873003, 'binary_precision': 0.5317164, 'binary_recall': 0.18836749, 'binary_specificity': 0.9940677, 'binary_f1_score': 0.27818447}
confusion matrix:
       0    1
0  42060  251
1   1228  285
---- Validation: 
scalar performance:
{'acc': 0.9682523, 'precision': 0.74843246, 'recall': 0.54915106, 'specificity': 0.54915106, 'f1': 0.57686657, 'auroc': 0.91512847, 'binary_precision': 0.5258621, 'binary_recall': 0.1013289, 'binary_specificity': 0.9969732, 'binary_f1_score': 0.16991644}
confusion matrix:
       0   1
0  18116  55
1    541  61
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.969867, 'precision': 0.9677125, 'recall': 0.61553574, 'specificity': 0.61553574, 'f1': 0.6789478, 'auroc': 0.8804712, 'binary_precision': 0.9655172, 'binary_recall': 0.23140496, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.37333333}
confusion matrix:
      0   1
0  5995   2
1   186  56
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324353_18.png
early stop counter: 1
val acc:0.9682523012161255, best validation acc: 0.9686251282691956, corresponding to test acc:                         0.9729123115539551 / 0.9729123115539551
after epoch: 18,now: 2024-06-15 12:27:48.411891,epoch time: 0:16:51.229476,used: 5:01:44.322359,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_07_26_04_seed_2_21324353
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.96611446, 'precision': 0.74673146, 'recall': 0.61536425, 'specificity': 0.61536425, 'f1': 0.6548802, 'auroc': 0.9159044, 'binary_precision': 0.5201729, 'binary_recall': 0.23859881, 'binary_specificity': 0.9921297, 'binary_f1_score': 0.3271409}
confusion matrix:
       0    1
0  41978  333
1   1152  361
---- Validation: 
scalar performance:
{'acc': 0.9686251, 'precision': 0.7575612, 'recall': 0.5662077, 'specificity': 0.5662077, 'f1': 0.6008935, 'auroc': 0.91446435, 'binary_precision': 0.54304636, 'binary_recall': 0.13621262, 'binary_specificity': 0.99620277, 'binary_f1_score': 0.21779549}
confusion matrix:
       0   1
0  18102  69
1    520  82
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97146976, 'precision': 0.9710338, 'recall': 0.6361969, 'specificity': 0.6361969, 'f1': 0.705589, 'auroc': 0.88113856, 'binary_precision': 0.9705882, 'binary_recall': 0.27272728, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.4258065}
confusion matrix:
      0   1
0  5995   2
1   176  66
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324353_19.png
early stop counter: 2
val acc:0.9686251282691956, best validation acc: 0.9686251282691956, corresponding to test acc:                         0.9729123115539551 / 0.9729123115539551
after epoch: 19,now: 2024-06-15 12:44:25.555553,epoch time: 0:16:37.143662,used: 5:18:21.466021,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_07_26_04_seed_2_21324353
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.966548, 'precision': 0.7571658, 'recall': 0.5964697, 'specificity': 0.5964697, 'f1': 0.63698614, 'auroc': 0.9166273, 'binary_precision': 0.54234236, 'binary_recall': 0.1989425, 'binary_specificity': 0.99399686, 'binary_f1_score': 0.29110253}
confusion matrix:
       0    1
0  42057  254
1   1212  301
---- Validation: 
scalar performance:
{'acc': 0.9682523, 'precision': 0.7465191, 'recall': 0.55878764, 'specificity': 0.55878764, 'f1': 0.5902858, 'auroc': 0.9084523, 'binary_precision': 0.5214286, 'binary_recall': 0.12126246, 'binary_specificity': 0.9963128, 'binary_f1_score': 0.1967655}
confusion matrix:
       0   1
0  18104  67
1    529  73
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9717904, 'precision': 0.9716115, 'recall': 0.6403291, 'specificity': 0.6403291, 'f1': 0.7107155, 'auroc': 0.8751638, 'binary_precision': 0.9714286, 'binary_recall': 0.28099173, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.43589744}
confusion matrix:
      0   1
0  5995   2
1   174  68
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324353_20.png
early stop counter: 3
val acc:0.9682523012161255, best validation acc: 0.9686251282691956, corresponding to test acc:                         0.9729123115539551 / 0.9729123115539551
after epoch: 20,now: 2024-06-15 13:01:02.106625,epoch time: 0:16:36.551072,used: 5:34:58.017093,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_07_26_04_seed_2_21324353
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9662514, 'precision': 0.7497268, 'recall': 0.6071502, 'specificity': 0.6071502, 'f1': 0.64723724, 'auroc': 0.91131186, 'binary_precision': 0.5267296, 'binary_recall': 0.2214144, 'binary_specificity': 0.992886, 'binary_f1_score': 0.3117729}
confusion matrix:
       0    1
0  42010  301
1   1178  335
---- Validation: 
scalar performance:
{'acc': 0.9683588, 'precision': 0.7487179, 'recall': 0.56687313, 'specificity': 0.56687313, 'f1': 0.6011368, 'auroc': 0.91059464, 'binary_precision': 0.5253165, 'binary_recall': 0.13787375, 'binary_specificity': 0.99587256, 'binary_f1_score': 0.21842106}
confusion matrix:
       0   1
0  18096  75
1    519  83
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9716301, 'precision': 0.97132576, 'recall': 0.638263, 'specificity': 0.638263, 'f1': 0.7081603, 'auroc': 0.8801038, 'binary_precision': 0.9710145, 'binary_recall': 0.2768595, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.43086815}
confusion matrix:
      0   1
0  5995   2
1   175  67
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324353_21.png
early stop counter: 4
val acc:0.9683588147163391, best validation acc: 0.9686251282691956, corresponding to test acc:                         0.9729123115539551 / 0.9729123115539551
after epoch: 21,now: 2024-06-15 13:17:44.154387,epoch time: 0:16:42.047762,used: 5:51:40.064855,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_07_26_04_seed_2_21324353
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9660004, 'precision': 0.745296, 'recall': 0.60606426, 'specificity': 0.60606426, 'f1': 0.6454178, 'auroc': 0.9184627, 'binary_precision': 0.5179407, 'binary_recall': 0.2194316, 'binary_specificity': 0.99269694, 'binary_f1_score': 0.30826372}
confusion matrix:
       0    1
0  42002  309
1   1181  332
---- Validation: 
scalar performance:
{'acc': 0.9686784, 'precision': 0.7590904, 'recall': 0.56703824, 'specificity': 0.56703824, 'f1': 0.6020887, 'auroc': 0.9127556, 'binary_precision': 0.54605263, 'binary_recall': 0.13787375, 'binary_specificity': 0.99620277, 'binary_f1_score': 0.22015916}
confusion matrix:
       0   1
0  18102  69
1    519  83
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9705081, 'precision': 0.9768585, 'recall': 0.62181747, 'specificity': 0.62181747, 'f1': 0.68780845, 'auroc': 0.879883, 'binary_precision': 0.98333335, 'binary_recall': 0.24380165, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.3907285}
confusion matrix:
      0   1
0  5996   1
1   183  59
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324353_22.png
better model found
persisted
after epoch: 22,now: 2024-06-15 13:34:20.226730,epoch time: 0:16:36.072343,used: 6:08:16.137198,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_07_26_04_seed_2_21324353
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9664111, 'precision': 0.7523432, 'recall': 0.60978216, 'specificity': 0.60978216, 'f1': 0.65033424, 'auroc': 0.918481, 'binary_precision': 0.5317829, 'binary_recall': 0.22670192, 'binary_specificity': 0.9928624, 'binary_f1_score': 0.31788692}
confusion matrix:
       0    1
0  42009  302
1   1170  343
---- Validation: 
scalar performance:
{'acc': 0.968998, 'precision': 0.7648585, 'recall': 0.5792491, 'specificity': 0.5792491, 'f1': 0.6180495, 'auroc': 0.9171348, 'binary_precision': 0.5568182, 'binary_recall': 0.1627907, 'binary_specificity': 0.99570745, 'binary_f1_score': 0.251928}
confusion matrix:
       0   1
0  18093  78
1    504  98
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9730726, 'precision': 0.9737077, 'recall': 0.6568581, 'specificity': 0.6568581, 'f1': 0.730591, 'auroc': 0.8827234, 'binary_precision': 0.974359, 'binary_recall': 0.3140496, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.47500002}
confusion matrix:
      0   1
0  5995   2
1   166  76
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324353_23.png
new oracle model saved
better model found
persisted
after epoch: 23,now: 2024-06-15 13:51:02.853822,epoch time: 0:16:42.627092,used: 6:24:58.764290,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_07_26_04_seed_2_21324353
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.96686745, 'precision': 0.76486015, 'recall': 0.5944046, 'specificity': 0.5944046, 'f1': 0.6356371, 'auroc': 0.9194038, 'binary_precision': 0.55787474, 'binary_recall': 0.19431593, 'binary_specificity': 0.9944932, 'binary_f1_score': 0.28823528}
confusion matrix:
       0    1
0  42078  233
1   1219  294
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.73559785, 'recall': 0.5521982, 'specificity': 0.5521982, 'f1': 0.5806216, 'auroc': 0.9163386, 'binary_precision': 0.5, 'binary_recall': 0.10797342, 'binary_specificity': 0.9964229, 'binary_f1_score': 0.17759563}
confusion matrix:
       0   1
0  18106  65
1    537  65
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97018754, 'precision': 0.9764141, 'recall': 0.6176852, 'specificity': 0.6176852, 'f1': 0.6823633, 'auroc': 0.8849218, 'binary_precision': 0.98275864, 'binary_recall': 0.23553719, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.38}
confusion matrix:
      0   1
0  5996   1
1   185  57
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324353_24.png
early stop counter: 1
val acc:0.9679326415061951, best validation acc: 0.9689980149269104, corresponding to test acc:                         0.9730725884437561 / 0.9730725884437561
after epoch: 24,now: 2024-06-15 14:07:39.026120,epoch time: 0:16:36.172298,used: 6:41:34.936588,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_07_26_04_seed_2_21324353
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.96611446, 'precision': 0.74593556, 'recall': 0.6335274, 'specificity': 0.6335274, 'f1': 0.671393, 'auroc': 0.9216843, 'binary_precision': 0.5173267, 'binary_recall': 0.2762723, 'binary_specificity': 0.99078256, 'binary_f1_score': 0.36018956}
confusion matrix:
       0    1
0  41921  390
1   1095  418
---- Validation: 
scalar performance:
{'acc': 0.9686251, 'precision': 0.7527088, 'recall': 0.5870869, 'specificity': 0.5870869, 'f1': 0.6261459, 'auroc': 0.91821814, 'binary_precision': 0.5320197, 'binary_recall': 0.179402, 'binary_specificity': 0.9947719, 'binary_f1_score': 0.26832297}
confusion matrix:
       0    1
0  18076   95
1    494  108
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9741946, 'precision': 0.9699173, 'recall': 0.6733036, 'specificity': 0.6733036, 'f1': 0.7486931, 'auroc': 0.8796464, 'binary_precision': 0.9655172, 'binary_recall': 0.34710744, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.5106383}
confusion matrix:
      0   1
0  5994   3
1   158  84
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324353_25.png
new oracle model saved
early stop counter: 2
val acc:0.9686251282691956, best validation acc: 0.9689980149269104, corresponding to test acc:                         0.9730725884437561 / 0.9741945862770081
after epoch: 25,now: 2024-06-15 14:24:08.243028,epoch time: 0:16:29.216908,used: 6:58:04.153496,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_07_26_04_seed_2_21324353
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.96622854, 'precision': 0.74788326, 'recall': 0.62689483, 'specificity': 0.62689483, 'f1': 0.6659145, 'auroc': 0.92379713, 'binary_precision': 0.521682, 'binary_recall': 0.2623926, 'binary_specificity': 0.991397, 'binary_f1_score': 0.3491645}
confusion matrix:
       0    1
0  41947  364
1   1116  397
---- Validation: 
scalar performance:
{'acc': 0.9678794, 'precision': 0.7355369, 'recall': 0.58670175, 'specificity': 0.58670175, 'f1': 0.6236589, 'auroc': 0.92248905, 'binary_precision': 0.49769586, 'binary_recall': 0.179402, 'binary_specificity': 0.99400145, 'binary_f1_score': 0.26373628}
confusion matrix:
       0    1
0  18062  109
1    494  108
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9748357, 'precision': 0.96131444, 'recall': 0.6855335, 'specificity': 0.6855335, 'f1': 0.76059663, 'auroc': 0.88811225, 'binary_precision': 0.94736844, 'binary_recall': 0.37190083, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.5341246}
confusion matrix:
      0   1
0  5992   5
1   152  90
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324353_26.png
new oracle model saved
early stop counter: 3
val acc:0.9678794145584106, best validation acc: 0.9689980149269104, corresponding to test acc:                         0.9730725884437561 / 0.9748356938362122
after epoch: 26,now: 2024-06-15 14:40:33.584880,epoch time: 0:16:25.341852,used: 7:14:29.495348,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_07_26_04_seed_2_21324353
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9663883, 'precision': 0.74945825, 'recall': 0.64004225, 'specificity': 0.64004225, 'f1': 0.677828, 'auroc': 0.917143, 'binary_precision': 0.52392346, 'binary_recall': 0.2894911, 'binary_specificity': 0.99059343, 'binary_f1_score': 0.37292466}
confusion matrix:
       0    1
0  41913  398
1   1075  438
---- Validation: 
scalar performance:
{'acc': 0.968998, 'precision': 0.75904226, 'recall': 0.6001283, 'specificity': 0.6001283, 'f1': 0.6414719, 'auroc': 0.915849, 'binary_precision': 0.54385966, 'binary_recall': 0.20598006, 'binary_specificity': 0.9942766, 'binary_f1_score': 0.2987952}
confusion matrix:
       0    1
0  18067  104
1    478  124
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9735535, 'precision': 0.96338964, 'recall': 0.6670219, 'specificity': 0.6670219, 'f1': 0.74091685, 'auroc': 0.8846467, 'binary_precision': 0.9529412, 'binary_recall': 0.33471075, 'binary_specificity': 0.999333, 'binary_f1_score': 0.49541286}
confusion matrix:
      0   1
0  5993   4
1   161  81
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324353_27.png
early stop counter: 4
val acc:0.9689980149269104, best validation acc: 0.9689980149269104, corresponding to test acc:                         0.9730725884437561 / 0.9748356938362122
after epoch: 27,now: 2024-06-15 14:56:58.541155,epoch time: 0:16:24.956275,used: 7:30:54.451623,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_07_26_04_seed_2_21324353
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9662514, 'precision': 0.74915504, 'recall': 0.61352324, 'specificity': 0.61352324, 'f1': 0.6535212, 'auroc': 0.9189234, 'binary_precision': 0.5251479, 'binary_recall': 0.23463318, 'binary_specificity': 0.99241334, 'binary_f1_score': 0.324349}
confusion matrix:
       0    1
0  41990  321
1   1158  355
---- Validation: 
scalar performance:
{'acc': 0.9680925, 'precision': 0.7406267, 'recall': 0.5675386, 'specificity': 0.5675386, 'f1': 0.6013744, 'auroc': 0.916795, 'binary_precision': 0.5090909, 'binary_recall': 0.13953489, 'binary_specificity': 0.99554235, 'binary_f1_score': 0.21903521}
confusion matrix:
       0   1
0  18090  81
1    518  84
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9713095, 'precision': 0.97073567, 'recall': 0.6341308, 'specificity': 0.6341308, 'f1': 0.70300126, 'auroc': 0.88256454, 'binary_precision': 0.9701493, 'binary_recall': 0.26859504, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.420712}
confusion matrix:
      0   1
0  5995   2
1   177  65
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324353_28.png
early stop counter: 5
val acc:0.9680925011634827, best validation acc: 0.9689980149269104, corresponding to test acc:                         0.9730725884437561 / 0.9748356938362122
after epoch: 28,now: 2024-06-15 15:13:26.522411,epoch time: 0:16:27.981256,used: 7:47:22.432879,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_07_26_04_seed_2_21324353
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.965795, 'precision': 0.74152994, 'recall': 0.6349552, 'specificity': 0.6349552, 'f1': 0.6715975, 'auroc': 0.92416114, 'binary_precision': 0.50841343, 'binary_recall': 0.279577, 'binary_specificity': 0.9903335, 'binary_f1_score': 0.36076757}
confusion matrix:
       0    1
0  41902  409
1   1090  423
---- Validation: 
scalar performance:
{'acc': 0.9687317, 'precision': 0.7567669, 'recall': 0.58071756, 'specificity': 0.58071756, 'f1': 0.61908036, 'auroc': 0.91878545, 'binary_precision': 0.5405405, 'binary_recall': 0.16611296, 'binary_specificity': 0.9953222, 'binary_f1_score': 0.25412962}
confusion matrix:
       0    1
0  18086   85
1    502  100
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97018754, 'precision': 0.9609934, 'recall': 0.6216507, 'specificity': 0.6216507, 'f1': 0.68643975, 'auroc': 0.88479036, 'binary_precision': 0.9516129, 'binary_recall': 0.24380165, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.38815787}
confusion matrix:
      0   1
0  5994   3
1   183  59
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324353_29.png
early stop counter: 6
val acc:0.968731701374054, best validation acc: 0.9689980149269104, corresponding to test acc:                         0.9730725884437561 / 0.9748356938362122
after epoch: 29,now: 2024-06-15 15:29:55.243257,epoch time: 0:16:28.720846,used: 8:03:51.153725,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_07_26_04_seed_2_21324353
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.96611446, 'precision': 0.746768, 'recall': 0.61472696, 'specificity': 0.61472696, 'f1': 0.6542698, 'auroc': 0.92203176, 'binary_precision': 0.52028984, 'binary_recall': 0.23727693, 'binary_specificity': 0.99217695, 'binary_f1_score': 0.3259192}
confusion matrix:
       0    1
0  41980  331
1   1154  359
---- Validation: 
scalar performance:
{'acc': 0.9683055, 'precision': 0.74486125, 'recall': 0.590134, 'specificity': 0.590134, 'f1': 0.62865186, 'auroc': 0.9195879, 'binary_precision': 0.516129, 'binary_recall': 0.18604651, 'binary_specificity': 0.99422157, 'binary_f1_score': 0.27350426}
confusion matrix:
       0    1
0  18066  105
1    490  112
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97451514, 'precision': 0.96058977, 'recall': 0.6814013, 'specificity': 0.6814013, 'f1': 0.7561396, 'auroc': 0.8872175, 'binary_precision': 0.94623655, 'binary_recall': 0.36363637, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.52537316}
confusion matrix:
      0   1
0  5992   5
1   154  88
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324353_30.png
early stop counter: 7
val acc:0.9683055281639099, best validation acc: 0.9689980149269104, corresponding to test acc:                         0.9730725884437561 / 0.9748356938362122
after epoch: 30,now: 2024-06-15 15:46:21.911141,epoch time: 0:16:26.667884,used: 8:20:17.821609,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_07_26_04_seed_2_21324353
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 8:20:17.821609 at 2024-06-15 15:46:21.911141
persisted model performance metric: 

scalar performance:
{'acc': 0.9730726, 'precision': 0.9737077, 'recall': 0.6568581, 'specificity': 0.6568581, 'f1': 0.730591, 'auroc': 0.8827234, 'binary_precision': 0.974359, 'binary_recall': 0.3140496, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.47500002}
confusion matrix:
      0   1
0  5995   2
1   166  76
oracle model performance metric: 

scalar performance:
{'acc': 0.9748357, 'precision': 0.96131444, 'recall': 0.6855335, 'specificity': 0.6855335, 'f1': 0.76059663, 'auroc': 0.88811225, 'binary_precision': 0.94736844, 'binary_recall': 0.37190083, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.5341246}
confusion matrix:
      0   1
0  5992   5
1   152  90
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_bs16_different_learningrates/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_resnet_bs16_different_learningrates/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204077 KiB | 640729 KiB |   2834 TiB |   2834 TiB |
|       from large pool | 167040 KiB | 568000 KiB |   2833 TiB |   2833 TiB |
|       from small pool |  37037 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 204077 KiB | 640729 KiB |   2834 TiB |   2834 TiB |
|       from large pool | 167040 KiB | 568000 KiB |   2833 TiB |   2833 TiB |
|       from small pool |  37037 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201087 KiB | 632296 KiB |   2820 TiB |   2820 TiB |
|       from large pool | 165120 KiB | 560704 KiB |   2820 TiB |   2820 TiB |
|       from small pool |  35967 KiB |  73944 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 675840 KiB | 755712 KiB |   1502 MiB |    842 MiB |
|       from large pool | 600064 KiB | 679936 KiB |   1376 MiB |    790 MiB |
|       from small pool |  75776 KiB |  75776 KiB |    126 MiB |     52 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  80594 KiB | 218089 KiB |   1014 TiB |   1014 TiB |
|       from large pool |  68480 KiB | 217080 KiB |   1013 TiB |   1013 TiB |
|       from small pool |  12114 KiB |  19715 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3240    |    6231    |  251125 K  |  251122 K  |
|       from large pool |      36    |      76    |  101521 K  |  101521 K  |
|       from small pool |    3204    |    6194    |  149603 K  |  149600 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3240    |    6231    |  251125 K  |  251122 K  |
|       from large pool |      36    |      76    |  101521 K  |  101521 K  |
|       from small pool |    3204    |    6194    |  149603 K  |  149600 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      51    |      51    |      85    |      34    |
|       from large pool |      14    |      14    |      22    |       8    |
|       from small pool |      37    |      37    |      63    |      26    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      39    |    2755    |  115074 K  |  115074 K  |
|       from large pool |       5    |      13    |   38542 K  |   38542 K  |
|       from small pool |      34    |    2750    |   76531 K  |   76531 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 640729 KiB |   2834 TiB |   2834 TiB |
|       from large pool |  16640 KiB | 568000 KiB |   2833 TiB |   2833 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 640729 KiB |   2834 TiB |   2834 TiB |
|       from large pool |  16640 KiB | 568000 KiB |   2833 TiB |   2833 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 632296 KiB |   2820 TiB |   2820 TiB |
|       from large pool |  16640 KiB | 560704 KiB |   2820 TiB |   2820 TiB |
|       from small pool |      0 KiB |  73944 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 284672 KiB | 755712 KiB |   1502 MiB |   1224 MiB |
|       from large pool | 235520 KiB | 679936 KiB |   1376 MiB |   1146 MiB |
|       from small pool |  49152 KiB |  75776 KiB |    126 MiB |     78 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  55040 KiB | 218089 KiB |   1014 TiB |   1014 TiB |
|       from large pool |  55040 KiB | 217080 KiB |   1013 TiB |   1013 TiB |
|       from small pool |      0 KiB |  19715 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6231    |  251125 K  |  251125 K  |
|       from large pool |       2    |      76    |  101521 K  |  101521 K  |
|       from small pool |       0    |    6194    |  149603 K  |  149603 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6231    |  251125 K  |  251125 K  |
|       from large pool |       2    |      76    |  101521 K  |  101521 K  |
|       from small pool |       0    |    6194    |  149603 K  |  149603 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      34    |      51    |      85    |      51    |
|       from large pool |      10    |      14    |      22    |      12    |
|       from small pool |      24    |      37    |      63    |      39    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2755    |  115075 K  |  115075 K  |
|       from large pool |       3    |      13    |   38542 K  |   38542 K  |
|       from small pool |       0    |    2750    |   76533 K  |   76533 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

