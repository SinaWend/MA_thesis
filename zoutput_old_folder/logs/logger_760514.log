Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0




!!!: not committed yet



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_15_49_03_seed_0_21585200

 Experiment start at: 2024-06-26 15:49:03.731957
before training, model accuracy: 0.3804730176925659
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9653843, 'precision': 0.48269215, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49119368, 'auroc': 0.6414424, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
        0  1
0  193324  0
1    6932  0
---- Validation: 
scalar performance:
{'acc': 0.96476674, 'precision': 0.48238337, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49103373, 'auroc': 0.63320345, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  82804  0
1   3024  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9653843, 'precision': 0.48269215, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49119368, 'auroc': 0.64154375, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  48331  0
1   1733  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21585200_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-26 18:25:20.720803,epoch time: 2:36:16.988846,used: 2:36:16.988846,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_15_49_03_seed_0_21585200
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9654492, 'precision': 0.9493925, 'recall': 0.5010072, 'specificity': 0.5010072, 'f1': 0.4932251, 'auroc': 0.8382596, 'binary_precision': 0.93333334, 'binary_recall': 0.002019619, 'binary_specificity': 0.9999948, 'binary_f1_score': 0.0040305164}
confusion matrix:
        0   1
0  193323   1
1    6918  14
---- Validation: 
scalar performance:
{'acc': 0.96476674, 'precision': 0.48238337, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49103373, 'auroc': 0.84452915, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  82804  0
1   3024  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96546423, 'precision': 0.98273075, 'recall': 0.50115407, 'specificity': 0.50115407, 'f1': 0.49351645, 'auroc': 0.83058405, 'binary_precision': 1.0, 'binary_recall': 0.002308136, 'binary_specificity': 1.0, 'binary_f1_score': 0.0046056416}
confusion matrix:
       0  1
0  48331  0
1   1729  4
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21585200_2.png
new oracle model saved
early stop counter: 1
val acc:0.9647667407989502, best validation acc: 0.9647667407989502, corresponding to test acc:                         0.965384304523468 / 0.9654642343521118
after epoch: 2,now: 2024-06-26 20:48:07.141353,epoch time: 2:22:46.420550,used: 4:59:03.409396,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_15_49_03_seed_0_21585200
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96619326, 'precision': 0.8496791, 'recall': 0.5181524, 'specificity': 0.5181524, 'f1': 0.52641934, 'auroc': 0.8640349, 'binary_precision': 0.73275864, 'binary_recall': 0.03678592, 'binary_specificity': 0.99951893, 'binary_f1_score': 0.07005495}
confusion matrix:
        0    1
0  193231   93
1    6677  255
---- Validation: 
scalar performance:
{'acc': 0.96513957, 'precision': 0.83269346, 'recall': 0.5091143, 'specificity': 0.5091143, 'f1': 0.50916564, 'auroc': 0.8630196, 'binary_precision': 0.7, 'binary_recall': 0.018518519, 'binary_specificity': 0.99971014, 'binary_f1_score': 0.036082473}
confusion matrix:
       0   1
0  82780  24
1   2968  56
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9662432, 'precision': 0.8597736, 'recall': 0.51824784, 'specificity': 0.51824784, 'f1': 0.5266082, 'auroc': 0.8691462, 'binary_precision': 0.7529412, 'binary_recall': 0.036930177, 'binary_specificity': 0.9995655, 'binary_f1_score': 0.07040704}
confusion matrix:
       0   1
0  48310  21
1   1669  64
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21585200_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-26 22:51:28.305397,epoch time: 2:03:21.164044,used: 7:02:24.573440,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_15_49_03_seed_0_21585200
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
