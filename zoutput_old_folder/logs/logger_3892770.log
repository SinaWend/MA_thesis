Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0




!!!: not committed yet



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_53_21_seed_0_21316512

 Experiment start at: 2024-06-13 16:53:21.119141
before training, model accuracy: 0.9563758969306946
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9671173, 'precision': 0.7538858, 'recall': 0.5725852, 'specificity': 0.5725852, 'f1': 0.6086203, 'auroc': 0.9246073, 'binary_precision': 0.5365854, 'binary_recall': 0.14965986, 'binary_specificity': 0.99551064, 'binary_f1_score': 0.23404254}
confusion matrix:
       0    1
0  42132  190
1   1250  220
---- Validation: 
scalar performance:
{'acc': 0.9648787, 'precision': 0.70718116, 'recall': 0.55128545, 'specificity': 0.55128545, 'f1': 0.57749534, 'auroc': 0.9188067, 'binary_precision': 0.44516128, 'binary_recall': 0.10730949, 'binary_specificity': 0.99526143, 'binary_f1_score': 0.17293233}
confusion matrix:
       0   1
0  18063  86
1    574  69
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9592522, 'precision': 0.87975353, 'recall': 0.51515895, 'specificity': 0.51515895, 'f1': 0.5191079, 'auroc': 0.90537786, 'binary_precision': 0.8, 'binary_recall': 0.03065134, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.05904059}
confusion matrix:
      0  1
0  5995  2
1   253  8
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316512_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-13 17:21:29.132293,epoch time: 0:28:08.013152,used: 0:28:08.013152,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_53_21_seed_0_21316512
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9680992, 'precision': 0.7680702, 'recall': 0.6117025, 'specificity': 0.6117025, 'f1': 0.65488017, 'auroc': 0.9323732, 'binary_precision': 0.562396, 'binary_recall': 0.22961956, 'binary_specificity': 0.99378544, 'binary_f1_score': 0.32609746}
confusion matrix:
       0    1
0  42057  263
1   1134  338
---- Validation: 
scalar performance:
{'acc': 0.9655172, 'precision': 0.7294628, 'recall': 0.5763679, 'specificity': 0.5763679, 'f1': 0.61089766, 'auroc': 0.9282993, 'binary_precision': 0.48803827, 'binary_recall': 0.15863141, 'binary_specificity': 0.9941044, 'binary_f1_score': 0.23943661}
confusion matrix:
       0    1
0  18042  107
1    541  102
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959412, 'precision': 0.86451936, 'recall': 0.51890695, 'specificity': 0.51890695, 'f1': 0.5261222, 'auroc': 0.91247225, 'binary_precision': 0.7692308, 'binary_recall': 0.038314175, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.0729927}
confusion matrix:
      0   1
0  5994   3
1   251  10
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316512_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-13 17:48:39.067185,epoch time: 0:27:09.934892,used: 0:55:17.948044,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_53_21_seed_0_21316512
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.968122, 'precision': 0.7596751, 'recall': 0.65804136, 'specificity': 0.65804136, 'f1': 0.69529384, 'auroc': 0.93695, 'binary_precision': 0.54246885, 'binary_recall': 0.32562882, 'binary_specificity': 0.9904539, 'binary_f1_score': 0.40696687}
confusion matrix:
       0    1
0  41917  404
1    992  479
---- Validation: 
scalar performance:
{'acc': 0.96588975, 'precision': 0.73880255, 'recall': 0.63356495, 'specificity': 0.63356495, 'f1': 0.6697756, 'auroc': 0.93332267, 'binary_precision': 0.50282484, 'binary_recall': 0.27682737, 'binary_specificity': 0.9903025, 'binary_f1_score': 0.3570712}
confusion matrix:
       0    1
0  17973  176
1    465  178
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614893, 'precision': 0.90955055, 'recall': 0.5456435, 'specificity': 0.5456435, 'f1': 0.57318974, 'auroc': 0.91697127, 'binary_precision': 0.85714287, 'binary_recall': 0.09195402, 'binary_specificity': 0.999333, 'binary_f1_score': 0.16608995}
confusion matrix:
      0   1
0  5993   4
1   237  24
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316512_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-13 18:16:15.337964,epoch time: 0:27:36.270779,used: 1:22:54.218823,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_53_21_seed_0_21316512
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96789366, 'precision': 0.75577664, 'recall': 0.67192227, 'specificity': 0.67192227, 'f1': 0.7048036, 'auroc': 0.9381299, 'binary_precision': 0.5337423, 'binary_recall': 0.35461956, 'binary_specificity': 0.989225, 'binary_f1_score': 0.42612243}
confusion matrix:
       0    1
0  41864  456
1    950  522
---- Validation: 
scalar performance:
{'acc': 0.96631545, 'precision': 0.7445204, 'recall': 0.6390357, 'specificity': 0.6390357, 'f1': 0.67579466, 'auroc': 0.9371253, 'binary_precision': 0.5138889, 'binary_recall': 0.28771386, 'binary_specificity': 0.9903576, 'binary_f1_score': 0.36889336}
confusion matrix:
       0    1
0  17974  175
1    458  185
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9643656, 'precision': 0.9303643, 'recall': 0.5819586, 'specificity': 0.5819586, 'f1': 0.6300245, 'auroc': 0.92022353, 'binary_precision': 0.8958333, 'binary_recall': 0.16475096, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.27831715}
confusion matrix:
      0   1
0  5992   5
1   218  43
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316512_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-13 18:44:30.183655,epoch time: 0:28:14.845691,used: 1:51:09.064514,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_53_21_seed_0_21316512
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9686244, 'precision': 0.7673173, 'recall': 0.6559074, 'specificity': 0.6559074, 'f1': 0.69556665, 'auroc': 0.9415922, 'binary_precision': 0.5579196, 'binary_recall': 0.3206522, 'binary_specificity': 0.9911626, 'binary_f1_score': 0.40724763}
confusion matrix:
       0    1
0  41946  374
1   1000  472
---- Validation: 
scalar performance:
{'acc': 0.9663687, 'precision': 0.745741, 'recall': 0.62256205, 'specificity': 0.62256205, 'f1': 0.66151834, 'auroc': 0.93917584, 'binary_precision': 0.51746035, 'binary_recall': 0.2534992, 'binary_specificity': 0.9916249, 'binary_f1_score': 0.34029227}
confusion matrix:
       0    1
0  17997  152
1    480  163
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9600511, 'precision': 0.89197624, 'recall': 0.5265698, 'specificity': 0.5265698, 'f1': 0.5401456, 'auroc': 0.9201858, 'binary_precision': 0.8235294, 'binary_recall': 0.053639848, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.10071943}
confusion matrix:
      0   1
0  5994   3
1   247  14
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316512_5.png
better model found
persisted
after epoch: 5,now: 2024-06-13 19:12:27.640601,epoch time: 0:27:57.456946,used: 2:19:06.521460,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_53_21_seed_0_21316512
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9693551, 'precision': 0.76858133, 'recall': 0.71071005, 'specificity': 0.71071005, 'f1': 0.73580015, 'auroc': 0.94198346, 'binary_precision': 0.556719, 'binary_recall': 0.4334239, 'binary_specificity': 0.9879962, 'binary_f1_score': 0.48739493}
confusion matrix:
       0    1
0  41812  508
1    834  638
---- Validation: 
scalar performance:
{'acc': 0.96722007, 'precision': 0.7537966, 'recall': 0.68300724, 'specificity': 0.68300724, 'f1': 0.7120657, 'auroc': 0.94038033, 'binary_precision': 0.5294118, 'binary_recall': 0.377916, 'binary_specificity': 0.9880985, 'binary_f1_score': 0.44101638}
confusion matrix:
       0    1
0  17933  216
1    400  243
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96244806, 'precision': 0.9344934, 'recall': 0.5553054, 'specificity': 0.5553054, 'f1': 0.5893631, 'auroc': 0.919446, 'binary_precision': 0.90625, 'binary_recall': 0.11111111, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.19795221}
confusion matrix:
      0   1
0  5994   3
1   232  29
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316512_6.png
better model found
persisted
after epoch: 6,now: 2024-06-13 19:40:32.819400,epoch time: 0:28:05.178799,used: 2:47:11.700259,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_53_21_seed_0_21316512
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96951497, 'precision': 0.7822816, 'recall': 0.6514503, 'specificity': 0.6514503, 'f1': 0.69537926, 'auroc': 0.9451214, 'binary_precision': 0.58815956, 'binary_recall': 0.31046197, 'binary_specificity': 0.99243855, 'binary_f1_score': 0.40640283}
confusion matrix:
       0    1
0  42000  320
1   1015  457
---- Validation: 
scalar performance:
{'acc': 0.966688, 'precision': 0.75258636, 'recall': 0.6054761, 'specificity': 0.6054761, 'f1': 0.6459917, 'auroc': 0.94214904, 'binary_precision': 0.53231937, 'binary_recall': 0.21772939, 'binary_specificity': 0.9932228, 'binary_f1_score': 0.30905077}
confusion matrix:
       0    1
0  18026  123
1    503  140
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.89695513, 'recall': 0.5284855, 'specificity': 0.5284855, 'f1': 0.54358935, 'auroc': 0.9213959, 'binary_precision': 0.8333333, 'binary_recall': 0.057471264, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.10752688}
confusion matrix:
      0   1
0  5994   3
1   246  15
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316512_7.png
early stop counter: 1
val acc:0.9666879773139954, best validation acc: 0.9672200679779053, corresponding to test acc:                         0.9624480605125427 / 0.9643656015396118
after epoch: 7,now: 2024-06-13 20:08:33.075668,epoch time: 0:28:00.256268,used: 3:15:11.956527,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_53_21_seed_0_21316512
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97008586, 'precision': 0.79193324, 'recall': 0.6520735, 'specificity': 0.6520735, 'f1': 0.69807667, 'auroc': 0.9458864, 'binary_precision': 0.60742706, 'binary_recall': 0.3111413, 'binary_specificity': 0.9930057, 'binary_f1_score': 0.41150048}
confusion matrix:
       0    1
0  42024  296
1   1014  458
---- Validation: 
scalar performance:
{'acc': 0.96695405, 'precision': 0.76017106, 'recall': 0.594363, 'specificity': 0.594363, 'f1': 0.63505566, 'auroc': 0.9435246, 'binary_precision': 0.5482456, 'binary_recall': 0.19440125, 'binary_specificity': 0.99432474, 'binary_f1_score': 0.2870264}
confusion matrix:
       0    1
0  18046  103
1    518  125
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.77936995, 'recall': 0.50558037, 'specificity': 0.50558037, 'f1': 0.50066596, 'auroc': 0.92140406, 'binary_precision': 0.6, 'binary_recall': 0.011494253, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.02255639}
confusion matrix:
      0  1
0  5995  2
1   258  3
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316512_8.png
early stop counter: 2
val acc:0.9669540524482727, best validation acc: 0.9672200679779053, corresponding to test acc:                         0.9624480605125427 / 0.9643656015396118
after epoch: 8,now: 2024-06-13 20:36:42.835606,epoch time: 0:28:09.759938,used: 3:43:21.716465,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_53_21_seed_0_21316512
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9697433, 'precision': 0.781409, 'recall': 0.66697776, 'specificity': 0.66697776, 'f1': 0.7082597, 'auroc': 0.9490487, 'binary_precision': 0.58536583, 'binary_recall': 0.3423913, 'binary_specificity': 0.9915643, 'binary_f1_score': 0.43206173}
confusion matrix:
       0    1
0  41963  357
1    968  504
---- Validation: 
scalar performance:
{'acc': 0.96748614, 'precision': 0.7627599, 'recall': 0.6306411, 'specificity': 0.6306411, 'f1': 0.67243236, 'auroc': 0.94491863, 'binary_precision': 0.5509554, 'binary_recall': 0.2690513, 'binary_specificity': 0.99223095, 'binary_f1_score': 0.3615465}
confusion matrix:
       0    1
0  18008  141
1    470  173
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959412, 'precision': 0.86451936, 'recall': 0.51890695, 'specificity': 0.51890695, 'f1': 0.5261222, 'auroc': 0.9223316, 'binary_precision': 0.7692308, 'binary_recall': 0.038314175, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.0729927}
confusion matrix:
      0   1
0  5994   3
1   251  10
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316512_9.png
better model found
persisted
after epoch: 9,now: 2024-06-13 21:05:03.611401,epoch time: 0:28:20.775795,used: 4:11:42.492260,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_53_21_seed_0_21316512
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9709536, 'precision': 0.7937173, 'recall': 0.6833604, 'specificity': 0.6833604, 'f1': 0.7246338, 'auroc': 0.9467313, 'binary_precision': 0.60883975, 'binary_recall': 0.3750851, 'binary_specificity': 0.99163574, 'binary_f1_score': 0.4641954}
confusion matrix:
       0    1
0  41969  354
1    918  551
---- Validation: 
scalar performance:
{'acc': 0.9676458, 'precision': 0.7654193, 'recall': 0.63072383, 'specificity': 0.63072383, 'f1': 0.67304254, 'auroc': 0.9455257, 'binary_precision': 0.5562701, 'binary_recall': 0.2690513, 'binary_specificity': 0.9923963, 'binary_f1_score': 0.36268345}
confusion matrix:
       0    1
0  18011  138
1    470  173
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.8863846, 'recall': 0.5246541, 'specificity': 0.5246541, 'f1': 0.5366773, 'auroc': 0.92254627, 'binary_precision': 0.8125, 'binary_recall': 0.049808428, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.09386282}
confusion matrix:
      0   1
0  5994   3
1   248  13
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316512_10.png
better model found
persisted
after epoch: 10,now: 2024-06-13 21:33:03.408760,epoch time: 0:27:59.797359,used: 4:39:42.289619,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_53_21_seed_0_21316512
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.97083944, 'precision': 0.7963593, 'recall': 0.67344636, 'specificity': 0.67344636, 'f1': 0.7174145, 'auroc': 0.9462185, 'binary_precision': 0.614841, 'binary_recall': 0.35461956, 'binary_specificity': 0.99227315, 'binary_f1_score': 0.44980612}
confusion matrix:
       0    1
0  41993  327
1    950  522
---- Validation: 
scalar performance:
{'acc': 0.9680183, 'precision': 0.77309406, 'recall': 0.6264163, 'specificity': 0.6264163, 'f1': 0.6704102, 'auroc': 0.9464574, 'binary_precision': 0.57191783, 'binary_recall': 0.25972006, 'binary_specificity': 0.99311256, 'binary_f1_score': 0.35721925}
confusion matrix:
       0    1
0  18024  125
1    476  167
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.8366661, 'recall': 0.5094118, 'specificity': 0.5094118, 'f1': 0.50812435, 'auroc': 0.92171264, 'binary_precision': 0.71428573, 'binary_recall': 0.019157087, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.037313428}
confusion matrix:
      0  1
0  5995  2
1   256  5
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316512_11.png
better model found
persisted
after epoch: 11,now: 2024-06-13 22:01:14.371825,epoch time: 0:28:10.963065,used: 5:07:53.252684,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_53_21_seed_0_21316512
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9699488, 'precision': 0.7964228, 'recall': 0.63626534, 'specificity': 0.63626534, 'f1': 0.684247, 'auroc': 0.94869053, 'binary_precision': 0.6174699, 'binary_recall': 0.2785326, 'binary_specificity': 0.9939981, 'binary_f1_score': 0.3838951}
confusion matrix:
       0    1
0  42066  254
1   1062  410
---- Validation: 
scalar performance:
{'acc': 0.96695405, 'precision': 0.76697284, 'recall': 0.5741115, 'specificity': 0.5741115, 'f1': 0.611506, 'auroc': 0.9474366, 'binary_precision': 0.5632184, 'binary_recall': 0.15241058, 'binary_specificity': 0.9958124, 'binary_f1_score': 0.23990211}
confusion matrix:
       0   1
0  18073  76
1    545  98
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.7292932, 'recall': 0.5036647, 'specificity': 0.5036647, 'f1': 0.496895, 'auroc': 0.92336524, 'binary_precision': 0.5, 'binary_recall': 0.007662835, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.015094339}
confusion matrix:
      0  1
0  5995  2
1   259  2
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316512_12.png
early stop counter: 1
val acc:0.9669540524482727, best validation acc: 0.9680182933807373, corresponding to test acc:                         0.9587727785110474 / 0.9643656015396118
after epoch: 12,now: 2024-06-13 22:29:10.904806,epoch time: 0:27:56.532981,used: 5:35:49.785665,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_53_21_seed_0_21316512
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9704056, 'precision': 0.7949892, 'recall': 0.6584682, 'specificity': 0.6584682, 'f1': 0.7044063, 'auroc': 0.9494101, 'binary_precision': 0.61311054, 'binary_recall': 0.3240489, 'binary_specificity': 0.9928875, 'binary_f1_score': 0.42400002}
confusion matrix:
       0    1
0  42019  301
1    995  477
---- Validation: 
scalar performance:
{'acc': 0.9680715, 'precision': 0.7740774, 'recall': 0.62644386, 'specificity': 0.62644386, 'f1': 0.6706153, 'auroc': 0.9476795, 'binary_precision': 0.5738832, 'binary_recall': 0.25972006, 'binary_specificity': 0.99316764, 'binary_f1_score': 0.3576017}
confusion matrix:
       0    1
0  18025  124
1    476  167
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.77936995, 'recall': 0.50558037, 'specificity': 0.50558037, 'f1': 0.50066596, 'auroc': 0.92237353, 'binary_precision': 0.6, 'binary_recall': 0.011494253, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.02255639}
confusion matrix:
      0  1
0  5995  2
1   258  3
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316512_13.png
better model found
persisted
after epoch: 13,now: 2024-06-13 22:57:15.869359,epoch time: 0:28:04.964553,used: 6:03:54.750218,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_53_21_seed_0_21316512
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.97104496, 'precision': 0.80337304, 'recall': 0.66502833, 'specificity': 0.66502833, 'f1': 0.7120385, 'auroc': 0.94918907, 'binary_precision': 0.6294416, 'binary_recall': 0.33695653, 'binary_specificity': 0.99310017, 'binary_f1_score': 0.43893808}
confusion matrix:
       0    1
0  42028  292
1    976  496
---- Validation: 
scalar performance:
{'acc': 0.9676458, 'precision': 0.76884866, 'recall': 0.6164728, 'specificity': 0.6164728, 'f1': 0.65983164, 'auroc': 0.94765925, 'binary_precision': 0.5641026, 'binary_recall': 0.23950233, 'binary_specificity': 0.9934432, 'binary_f1_score': 0.33624455}
confusion matrix:
       0    1
0  18030  119
1    489  154
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.77936995, 'recall': 0.50558037, 'specificity': 0.50558037, 'f1': 0.50066596, 'auroc': 0.921995, 'binary_precision': 0.6, 'binary_recall': 0.011494253, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.02255639}
confusion matrix:
      0  1
0  5995  2
1   258  3
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316512_14.png
early stop counter: 1
val acc:0.9676458239555359, best validation acc: 0.9680715203285217, corresponding to test acc:                         0.9584531784057617 / 0.9643656015396118
after epoch: 14,now: 2024-06-13 23:25:30.832402,epoch time: 0:28:14.963043,used: 6:32:09.713261,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_53_21_seed_0_21316512
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.97138745, 'precision': 0.78951883, 'recall': 0.7219252, 'specificity': 0.7219252, 'f1': 0.7508303, 'auroc': 0.9517392, 'binary_precision': 0.5978552, 'binary_recall': 0.4544837, 'binary_specificity': 0.9893667, 'binary_f1_score': 0.51640296}
confusion matrix:
       0    1
0  41870  450
1    803  669
---- Validation: 
scalar performance:
{'acc': 0.96934867, 'precision': 0.77752995, 'recall': 0.6916098, 'specificity': 0.6916098, 'f1': 0.72593623, 'auroc': 0.94844294, 'binary_precision': 0.5763098, 'binary_recall': 0.3934681, 'binary_specificity': 0.9897515, 'binary_f1_score': 0.46765247}
confusion matrix:
       0    1
0  17963  186
1    390  253
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9610099, 'precision': 0.88822913, 'recall': 0.54172873, 'specificity': 0.54172873, 'f1': 0.5664118, 'auroc': 0.92291677, 'binary_precision': 0.8148148, 'binary_recall': 0.08429119, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.15277778}
confusion matrix:
      0   1
0  5992   5
1   239  22
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316512_15.png
better model found
persisted
after epoch: 15,now: 2024-06-13 23:54:24.032901,epoch time: 0:28:53.200499,used: 7:01:02.913760,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_53_21_seed_0_21316512
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.97170717, 'precision': 0.80483484, 'recall': 0.68614346, 'specificity': 0.68614346, 'f1': 0.729897, 'auroc': 0.94995975, 'binary_precision': 0.63092554, 'binary_recall': 0.38001359, 'binary_specificity': 0.99227333, 'binary_f1_score': 0.4743318}
confusion matrix:
       0    1
0  41994  327
1    912  559
---- Validation: 
scalar performance:
{'acc': 0.9688165, 'precision': 0.77997774, 'recall': 0.6500813, 'specificity': 0.6500813, 'f1': 0.6936243, 'auroc': 0.94825286, 'binary_precision': 0.5840708, 'binary_recall': 0.30793157, 'binary_specificity': 0.99223095, 'binary_f1_score': 0.40325868}
confusion matrix:
       0    1
0  18008  141
1    445  198
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9603707, 'precision': 0.92146814, 'recall': 0.52856886, 'specificity': 0.52856886, 'f1': 0.5438245, 'auroc': 0.92324114, 'binary_precision': 0.88235295, 'binary_recall': 0.057471264, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.10791367}
confusion matrix:
      0   1
0  5995   2
1   246  15
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316512_16.png
early stop counter: 1
val acc:0.9688165187835693, best validation acc: 0.969348669052124, corresponding to test acc:                         0.9610099196434021 / 0.9643656015396118
after epoch: 16,now: 2024-06-14 00:22:53.613142,epoch time: 0:28:29.580241,used: 7:29:32.494001,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_53_21_seed_0_21316512
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.97150165, 'precision': 0.80337906, 'recall': 0.681772, 'specificity': 0.681772, 'f1': 0.7260132, 'auroc': 0.95068955, 'binary_precision': 0.6283084, 'binary_recall': 0.37117606, 'binary_specificity': 0.99236786, 'binary_f1_score': 0.46666664}
confusion matrix:
       0    1
0  41998  323
1    925  546
---- Validation: 
scalar performance:
{'acc': 0.9686037, 'precision': 0.7828036, 'recall': 0.6304697, 'specificity': 0.6304697, 'f1': 0.6761051, 'auroc': 0.9500971, 'binary_precision': 0.5910653, 'binary_recall': 0.2674961, 'binary_specificity': 0.9934432, 'binary_f1_score': 0.36830837}
confusion matrix:
       0    1
0  18030  119
1    471  172
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581336, 'precision': 0.693649, 'recall': 0.50541365, 'specificity': 0.50541365, 'f1': 0.5004984, 'auroc': 0.9241851, 'binary_precision': 0.42857143, 'binary_recall': 0.011494253, 'binary_specificity': 0.999333, 'binary_f1_score': 0.02238806}
confusion matrix:
      0  1
0  5993  4
1   258  3
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316512_17.png
early stop counter: 2
val acc:0.9686036705970764, best validation acc: 0.969348669052124, corresponding to test acc:                         0.9610099196434021 / 0.9643656015396118
after epoch: 17,now: 2024-06-14 00:51:02.248510,epoch time: 0:28:08.635368,used: 7:57:41.129369,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_53_21_seed_0_21316512
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9716615, 'precision': 0.7965729, 'recall': 0.7082969, 'specificity': 0.7082969, 'f1': 0.7440102, 'auroc': 0.9489285, 'binary_precision': 0.61290324, 'binary_recall': 0.4259511, 'binary_specificity': 0.9906427, 'binary_f1_score': 0.5026052}
confusion matrix:
       0    1
0  41924  396
1    845  627
---- Validation: 
scalar performance:
{'acc': 0.96929544, 'precision': 0.7795722, 'recall': 0.67883134, 'specificity': 0.67883134, 'f1': 0.71707964, 'auroc': 0.948987, 'binary_precision': 0.58128077, 'binary_recall': 0.36702955, 'binary_specificity': 0.9906331, 'binary_f1_score': 0.4499523}
confusion matrix:
       0    1
0  17979  170
1    407  236
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608501, 'precision': 0.8973372, 'recall': 0.5379807, 'specificity': 0.5379807, 'f1': 0.5601599, 'auroc': 0.9230915, 'binary_precision': 0.8333333, 'binary_recall': 0.07662835, 'binary_specificity': 0.999333, 'binary_f1_score': 0.14035088}
confusion matrix:
      0   1
0  5993   4
1   241  20
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316512_18.png
early stop counter: 3
val acc:0.9692954421043396, best validation acc: 0.969348669052124, corresponding to test acc:                         0.9610099196434021 / 0.9643656015396118
after epoch: 18,now: 2024-06-14 01:19:19.871771,epoch time: 0:28:17.623261,used: 8:25:58.752630,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_53_21_seed_0_21316512
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9717528, 'precision': 0.79385114, 'recall': 0.72127277, 'specificity': 0.72127277, 'f1': 0.7519697, 'auroc': 0.95337963, 'binary_precision': 0.60655737, 'binary_recall': 0.45275322, 'binary_specificity': 0.9897923, 'binary_f1_score': 0.5184897}
confusion matrix:
       0    1
0  41889  432
1    805  666
---- Validation: 
scalar performance:
{'acc': 0.9699872, 'precision': 0.7911193, 'recall': 0.67318904, 'specificity': 0.67318904, 'f1': 0.7158169, 'auroc': 0.9501621, 'binary_precision': 0.60477453, 'binary_recall': 0.35458788, 'binary_specificity': 0.9917902, 'binary_f1_score': 0.44705886}
confusion matrix:
       0    1
0  18000  149
1    415  228
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9600511, 'precision': 0.8750222, 'recall': 0.52840215, 'specificity': 0.52840215, 'f1': 0.54335564, 'auroc': 0.9250021, 'binary_precision': 0.7894737, 'binary_recall': 0.057471264, 'binary_specificity': 0.999333, 'binary_f1_score': 0.10714286}
confusion matrix:
      0   1
0  5993   4
1   246  15
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316512_19.png
better model found
persisted
after epoch: 19,now: 2024-06-14 01:47:32.046263,epoch time: 0:28:12.174492,used: 8:54:10.927122,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_53_21_seed_0_21316512
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.97198117, 'precision': 0.8033974, 'recall': 0.70039314, 'specificity': 0.70039314, 'f1': 0.74043006, 'auroc': 0.9549998, 'binary_precision': 0.62708336, 'binary_recall': 0.4092454, 'binary_specificity': 0.99154085, 'binary_f1_score': 0.49526945}
confusion matrix:
       0    1
0  41963  358
1    869  602
---- Validation: 
scalar performance:
{'acc': 0.9691358, 'precision': 0.7868571, 'recall': 0.64574623, 'specificity': 0.64574623, 'f1': 0.691251, 'auroc': 0.94995165, 'binary_precision': 0.5981308, 'binary_recall': 0.29860032, 'binary_specificity': 0.99289215, 'binary_f1_score': 0.39834026}
confusion matrix:
       0    1
0  18020  129
1    451  192
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.77959347, 'recall': 0.5111608, 'specificity': 0.5111608, 'f1': 0.5115645, 'auroc': 0.92418385, 'binary_precision': 0.6, 'binary_recall': 0.022988506, 'binary_specificity': 0.999333, 'binary_f1_score': 0.044280443}
confusion matrix:
      0  1
0  5993  4
1   255  6
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316512_20.png
early stop counter: 1
val acc:0.9691358208656311, best validation acc: 0.9699872136116028, corresponding to test acc:                         0.9600511193275452 / 0.9643656015396118
after epoch: 20,now: 2024-06-14 02:15:48.996646,epoch time: 0:28:16.950383,used: 9:22:27.877505,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_53_21_seed_0_21316512
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9710906, 'precision': 0.8210467, 'recall': 0.636939, 'specificity': 0.636939, 'f1': 0.68914473, 'auroc': 0.95080084, 'binary_precision': 0.6666667, 'binary_recall': 0.27872196, 'binary_specificity': 0.99515605, 'binary_f1_score': 0.39309683}
confusion matrix:
       0    1
0  42116  205
1   1061  410
---- Validation: 
scalar performance:
{'acc': 0.96855044, 'precision': 0.805811, 'recall': 0.5906892, 'specificity': 0.5906892, 'f1': 0.6355067, 'auroc': 0.94977677, 'binary_precision': 0.63978493, 'binary_recall': 0.18506998, 'binary_specificity': 0.9963083, 'binary_f1_score': 0.28709286}
confusion matrix:
       0    1
0  18082   67
1    524  119
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.97922325, 'recall': 0.5019157, 'specificity': 0.5019157, 'f1': 0.49320802, 'auroc': 0.9230752, 'binary_precision': 1.0, 'binary_recall': 0.0038314175, 'binary_specificity': 1.0, 'binary_f1_score': 0.007633588}
confusion matrix:
      0  1
0  5997  0
1   260  1
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316512_21.png
early stop counter: 2
val acc:0.968550443649292, best validation acc: 0.9699872136116028, corresponding to test acc:                         0.9600511193275452 / 0.9643656015396118
after epoch: 21,now: 2024-06-14 02:44:23.143592,epoch time: 0:28:34.146946,used: 9:51:02.024451,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_53_21_seed_0_21316512
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9720497, 'precision': 0.80630124, 'recall': 0.6955072, 'specificity': 0.6955072, 'f1': 0.73760307, 'auroc': 0.95433, 'binary_precision': 0.63322544, 'binary_recall': 0.39904827, 'binary_specificity': 0.9919662, 'binary_f1_score': 0.4895746}
confusion matrix:
       0    1
0  41981  340
1    884  587
---- Validation: 
scalar performance:
{'acc': 0.96961474, 'precision': 0.7931926, 'recall': 0.6512446, 'specificity': 0.6512446, 'f1': 0.697569, 'auroc': 0.9500371, 'binary_precision': 0.61042947, 'binary_recall': 0.30948678, 'binary_specificity': 0.99300236, 'binary_f1_score': 0.4107327}
confusion matrix:
       0    1
0  18022  127
1    444  199
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.79201996, 'recall': 0.5093284, 'specificity': 0.5093284, 'f1': 0.50801337, 'auroc': 0.9246448, 'binary_precision': 0.625, 'binary_recall': 0.019157087, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.03717472}
confusion matrix:
      0  1
0  5994  3
1   256  5
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316512_22.png
early stop counter: 3
val acc:0.9696147441864014, best validation acc: 0.9699872136116028, corresponding to test acc:                         0.9600511193275452 / 0.9643656015396118
after epoch: 22,now: 2024-06-14 03:12:50.262098,epoch time: 0:28:27.118506,used: 10:19:29.142957,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_53_21_seed_0_21316512
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.97074807, 'precision': 0.8218591, 'recall': 0.6261874, 'specificity': 0.6261874, 'f1': 0.6780799, 'auroc': 0.9529742, 'binary_precision': 0.66902655, 'binary_recall': 0.25679347, 'binary_specificity': 0.99558127, 'binary_f1_score': 0.37113404}
confusion matrix:
       0    1
0  42133  187
1   1094  378
---- Validation: 
scalar performance:
{'acc': 0.9686037, 'precision': 0.8132273, 'recall': 0.5854663, 'specificity': 0.5854663, 'f1': 0.6295693, 'auroc': 0.94959956, 'binary_precision': 0.65497077, 'binary_recall': 0.17418352, 'binary_specificity': 0.9967491, 'binary_f1_score': 0.2751843}
confusion matrix:
       0    1
0  18090   59
1    531  112
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.97922325, 'recall': 0.5019157, 'specificity': 0.5019157, 'f1': 0.49320802, 'auroc': 0.9227376, 'binary_precision': 1.0, 'binary_recall': 0.0038314175, 'binary_specificity': 1.0, 'binary_f1_score': 0.007633588}
confusion matrix:
      0  1
0  5997  0
1   260  1
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316512_23.png
early stop counter: 4
val acc:0.9686036705970764, best validation acc: 0.9699872136116028, corresponding to test acc:                         0.9600511193275452 / 0.9643656015396118
after epoch: 23,now: 2024-06-14 03:41:23.577103,epoch time: 0:28:33.315005,used: 10:48:02.457962,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_53_21_seed_0_21316512
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9720954, 'precision': 0.7915387, 'recall': 0.7468731, 'specificity': 0.7468731, 'f1': 0.7671735, 'auroc': 0.95518804, 'binary_precision': 0.60016155, 'binary_recall': 0.5054422, 'binary_specificity': 0.98830396, 'binary_f1_score': 0.54874456}
confusion matrix:
       0    1
0  41827  495
1    727  743
---- Validation: 
scalar performance:
{'acc': 0.97009367, 'precision': 0.7842803, 'recall': 0.70324636, 'specificity': 0.70324636, 'f1': 0.73637855, 'auroc': 0.9513558, 'binary_precision': 0.589011, 'binary_recall': 0.41679627, 'binary_specificity': 0.9896964, 'binary_f1_score': 0.48816028}
confusion matrix:
       0    1
0  17962  187
1    375  268
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.83742183, 'recall': 0.5282354, 'specificity': 0.5282354, 'f1': 0.54289234, 'auroc': 0.9263107, 'binary_precision': 0.71428573, 'binary_recall': 0.057471264, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.10638297}
confusion matrix:
      0   1
0  5991   6
1   246  15
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316512_24.png
better model found
persisted
after epoch: 24,now: 2024-06-14 04:10:07.887447,epoch time: 0:28:44.310344,used: 11:16:46.768306,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_53_21_seed_0_21316512
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9723694, 'precision': 0.80305135, 'recall': 0.71751535, 'specificity': 0.71751535, 'f1': 0.75261784, 'auroc': 0.9534316, 'binary_precision': 0.625239, 'binary_recall': 0.44429347, 'binary_specificity': 0.99073726, 'binary_f1_score': 0.5194599}
confusion matrix:
       0    1
0  41928  392
1    818  654
---- Validation: 
scalar performance:
{'acc': 0.9698276, 'precision': 0.78780305, 'recall': 0.6761066, 'specificity': 0.6761066, 'f1': 0.7172684, 'auroc': 0.9509292, 'binary_precision': 0.5979381, 'binary_recall': 0.3608087, 'binary_specificity': 0.9914045, 'binary_f1_score': 0.4500485}
confusion matrix:
       0    1
0  17993  156
1    411  232
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.8863846, 'recall': 0.5246541, 'specificity': 0.5246541, 'f1': 0.5366773, 'auroc': 0.9253956, 'binary_precision': 0.8125, 'binary_recall': 0.049808428, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.09386282}
confusion matrix:
      0   1
0  5994   3
1   248  13
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316512_25.png
early stop counter: 1
val acc:0.9698275923728943, best validation acc: 0.9700936675071716, corresponding to test acc:                         0.9597315192222595 / 0.9643656015396118
after epoch: 25,now: 2024-06-14 04:38:37.317324,epoch time: 0:28:29.429877,used: 11:45:16.198183,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_53_21_seed_0_21316512
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9716387, 'precision': 0.80507135, 'recall': 0.6836957, 'specificity': 0.6836957, 'f1': 0.7280086, 'auroc': 0.95337564, 'binary_precision': 0.6315789, 'binary_recall': 0.375, 'binary_specificity': 0.9923913, 'binary_f1_score': 0.47058824}
confusion matrix:
       0    1
0  41998  322
1    920  552
---- Validation: 
scalar performance:
{'acc': 0.9688165, 'precision': 0.7847955, 'recall': 0.6358302, 'specificity': 0.6358302, 'f1': 0.6816219, 'auroc': 0.9501358, 'binary_precision': 0.59468436, 'binary_recall': 0.27838257, 'binary_specificity': 0.99327785, 'binary_f1_score': 0.37923726}
confusion matrix:
       0    1
0  18027  122
1    464  179
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.8800577, 'recall': 0.5227384, 'specificity': 0.5227384, 'f1': 0.5331842, 'auroc': 0.92485833, 'binary_precision': 0.8, 'binary_recall': 0.04597701, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.08695652}
confusion matrix:
      0   1
0  5994   3
1   249  12
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316512_26.png
early stop counter: 2
val acc:0.9688165187835693, best validation acc: 0.9700936675071716, corresponding to test acc:                         0.9597315192222595 / 0.9643656015396118
after epoch: 26,now: 2024-06-14 05:07:16.609601,epoch time: 0:28:39.292277,used: 12:13:55.490460,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_53_21_seed_0_21316512
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9729859, 'precision': 0.8208092, 'recall': 0.6968514, 'specificity': 0.6968514, 'f1': 0.7427418, 'auroc': 0.95355093, 'binary_precision': 0.6621773, 'binary_recall': 0.40081522, 'binary_specificity': 0.9928875, 'binary_f1_score': 0.4993652}
confusion matrix:
       0    1
0  42019  301
1    882  590
---- Validation: 
scalar performance:
{'acc': 0.9694019, 'precision': 0.7942559, 'recall': 0.6398835, 'specificity': 0.6398835, 'f1': 0.6872756, 'auroc': 0.95151615, 'binary_precision': 0.61333334, 'binary_recall': 0.28615862, 'binary_specificity': 0.9936085, 'binary_f1_score': 0.39024392}
confusion matrix:
       0    1
0  18033  116
1    459  184
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.77936995, 'recall': 0.50558037, 'specificity': 0.50558037, 'f1': 0.50066596, 'auroc': 0.92507505, 'binary_precision': 0.6, 'binary_recall': 0.011494253, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.02255639}
confusion matrix:
      0  1
0  5995  2
1   258  3
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316512_27.png
early stop counter: 3
val acc:0.9694018959999084, best validation acc: 0.9700936675071716, corresponding to test acc:                         0.9597315192222595 / 0.9643656015396118
after epoch: 27,now: 2024-06-14 05:35:52.520884,epoch time: 0:28:35.911283,used: 12:42:31.401743,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_53_21_seed_0_21316512
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9723237, 'precision': 0.823712, 'recall': 0.6712636, 'specificity': 0.6712636, 'f1': 0.722122, 'auroc': 0.95548666, 'binary_precision': 0.6697128, 'binary_recall': 0.34850544, 'binary_specificity': 0.9940217, 'binary_f1_score': 0.458445}
confusion matrix:
       0    1
0  42067  253
1    959  513
---- Validation: 
scalar performance:
{'acc': 0.9687633, 'precision': 0.79593015, 'recall': 0.61105084, 'specificity': 0.61105084, 'f1': 0.6581017, 'auroc': 0.95170945, 'binary_precision': 0.61864406, 'binary_recall': 0.22706065, 'binary_specificity': 0.9950411, 'binary_f1_score': 0.33219567}
confusion matrix:
       0    1
0  18059   90
1    497  146
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590924, 'precision': 0.97952986, 'recall': 0.5095785, 'specificity': 0.5095785, 'f1': 0.508348, 'auroc': 0.9266335, 'binary_precision': 1.0, 'binary_recall': 0.019157087, 'binary_specificity': 1.0, 'binary_f1_score': 0.037593983}
confusion matrix:
      0  1
0  5997  0
1   256  5
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316512_28.png
early stop counter: 4
val acc:0.9687632918357849, best validation acc: 0.9700936675071716, corresponding to test acc:                         0.9597315192222595 / 0.9643656015396118
after epoch: 28,now: 2024-06-14 06:04:27.909814,epoch time: 0:28:35.388930,used: 13:11:06.790673,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_53_21_seed_0_21316512
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.97170717, 'precision': 0.8169695, 'recall': 0.6627481, 'specificity': 0.6627481, 'f1': 0.71305937, 'auroc': 0.9550299, 'binary_precision': 0.65679675, 'binary_recall': 0.33152175, 'binary_specificity': 0.9939745, 'binary_f1_score': 0.44063208}
confusion matrix:
       0    1
0  42065  255
1    984  488
---- Validation: 
scalar performance:
{'acc': 0.9686037, 'precision': 0.7963314, 'recall': 0.6042177, 'specificity': 0.6042177, 'f1': 0.65053105, 'auroc': 0.9512912, 'binary_precision': 0.6199095, 'binary_recall': 0.21306376, 'binary_specificity': 0.99537164, 'binary_f1_score': 0.31712964}
confusion matrix:
       0    1
0  18065   84
1    506  137
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.8127799, 'recall': 0.5074961, 'specificity': 0.5074961, 'f1': 0.504409, 'auroc': 0.9269985, 'binary_precision': 0.6666667, 'binary_recall': 0.01532567, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.029962545}
confusion matrix:
      0  1
0  5995  2
1   257  4
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316512_29.png
early stop counter: 5
val acc:0.9686036705970764, best validation acc: 0.9700936675071716, corresponding to test acc:                         0.9597315192222595 / 0.9643656015396118
after epoch: 29,now: 2024-06-14 06:33:06.720272,epoch time: 0:28:38.810458,used: 13:39:45.601131,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_53_21_seed_0_21316512
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.97255206, 'precision': 0.8189448, 'recall': 0.6859244, 'specificity': 0.6859244, 'f1': 0.7334525, 'auroc': 0.954849, 'binary_precision': 0.6591716, 'binary_recall': 0.37865397, 'binary_specificity': 0.9931949, 'binary_f1_score': 0.4810017}
confusion matrix:
       0    1
0  42033  288
1    914  557
---- Validation: 
scalar performance:
{'acc': 0.96886975, 'precision': 0.78669673, 'recall': 0.6336076, 'specificity': 0.6336076, 'f1': 0.67985195, 'auroc': 0.9503969, 'binary_precision': 0.5986394, 'binary_recall': 0.27371696, 'binary_specificity': 0.99349827, 'binary_f1_score': 0.375667}
confusion matrix:
       0    1
0  18031  118
1    467  176
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.77936995, 'recall': 0.50558037, 'specificity': 0.50558037, 'f1': 0.50066596, 'auroc': 0.92304343, 'binary_precision': 0.6, 'binary_recall': 0.011494253, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.02255639}
confusion matrix:
      0  1
0  5995  2
1   258  3
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316512_30.png
early stop counter: 6
val acc:0.9688697457313538, best validation acc: 0.9700936675071716, corresponding to test acc:                         0.9597315192222595 / 0.9643656015396118
after epoch: 30,now: 2024-06-14 07:01:49.436691,epoch time: 0:28:42.716419,used: 14:08:28.317550,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_53_21_seed_0_21316512
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 14:08:28.317550 at 2024-06-14 07:01:49.436691
persisted model performance metric: 

scalar performance:
{'acc': 0.9597315, 'precision': 0.83742183, 'recall': 0.5282354, 'specificity': 0.5282354, 'f1': 0.54289234, 'auroc': 0.9263107, 'binary_precision': 0.71428573, 'binary_recall': 0.057471264, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.10638297}
confusion matrix:
      0   1
0  5991   6
1   246  15
oracle model performance metric: 

scalar performance:
{'acc': 0.9643656, 'precision': 0.9303643, 'recall': 0.5819586, 'specificity': 0.5819586, 'f1': 0.6300245, 'auroc': 0.92022353, 'binary_precision': 0.8958333, 'binary_recall': 0.16475096, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.27831715}
confusion matrix:
      0   1
0  5992   5
1   218  43
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_vit_resnet_dinov2_bs16_different_learningrates/rule_results/9.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_vit_resnet_dinov2_bs16_different_learningrates/rule_results/9.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_vit_resnet_dinov2_bs16_different_learningrates/confusion_matrix/9.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 688276 KiB |   1449 MiB | 462790 GiB | 462790 GiB |
|       from large pool | 684800 KiB |   1444 MiB | 451909 GiB | 451909 GiB |
|       from small pool |   3476 KiB |      8 MiB |  10881 GiB |  10881 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 688276 KiB |   1449 MiB | 462790 GiB | 462790 GiB |
|       from large pool | 684800 KiB |   1444 MiB | 451909 GiB | 451909 GiB |
|       from small pool |   3476 KiB |      8 MiB |  10881 GiB |  10881 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 687268 KiB |   1445 MiB | 461987 GiB | 461986 GiB |
|       from large pool | 684800 KiB |   1441 MiB | 451124 GiB | 451124 GiB |
|       from small pool |   2468 KiB |      6 MiB |  10862 GiB |  10862 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1628 MiB |   1628 MiB |   1628 MiB |      0 B   |
|       from large pool |   1618 MiB |   1618 MiB |   1618 MiB |      0 B   |
|       from small pool |     10 MiB |     10 MiB |     10 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 116587 KiB | 208026 KiB | 201088 GiB | 201088 GiB |
|       from large pool | 113920 KiB | 204800 KiB | 190206 GiB | 190205 GiB |
|       from small pool |   2667 KiB |   3932 KiB |  10882 GiB |  10882 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2916    |    5887    |   90915 K  |   90912 K  |
|       from large pool |     100    |     205    |   28247 K  |   28247 K  |
|       from small pool |    2816    |    5786    |   62667 K  |   62664 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2916    |    5887    |   90915 K  |   90912 K  |
|       from large pool |     100    |     205    |   28247 K  |   28247 K  |
|       from small pool |    2816    |    5786    |   62667 K  |   62664 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      79    |      79    |      79    |       0    |
|       from large pool |      74    |      74    |      74    |       0    |
|       from small pool |       5    |       5    |       5    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      54    |    2787    |   37322 K  |   37322 K  |
|       from large pool |      39    |      69    |   11234 K  |   11234 K  |
|       from small pool |      15    |    2748    |   26087 K  |   26087 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1449 MiB | 462790 GiB | 462790 GiB |
|       from large pool |  16640 KiB |   1444 MiB | 451909 GiB | 451909 GiB |
|       from small pool |      0 KiB |      8 MiB |  10881 GiB |  10881 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1449 MiB | 462790 GiB | 462790 GiB |
|       from large pool |  16640 KiB |   1444 MiB | 451909 GiB | 451909 GiB |
|       from small pool |      0 KiB |      8 MiB |  10881 GiB |  10881 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1445 MiB | 461987 GiB | 461987 GiB |
|       from large pool |  16640 KiB |   1441 MiB | 451124 GiB | 451124 GiB |
|       from small pool |      0 KiB |      6 MiB |  10862 GiB |  10862 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    786 MiB |   1628 MiB |   1628 MiB |    842 MiB |
|       from large pool |    780 MiB |   1618 MiB |   1618 MiB |    838 MiB |
|       from small pool |      6 MiB |     10 MiB |     10 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 208026 KiB | 201088 GiB | 201088 GiB |
|       from large pool |  24320 KiB | 204800 KiB | 190206 GiB | 190206 GiB |
|       from small pool |      0 KiB |   5244 KiB |  10882 GiB |  10882 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    5887    |   90915 K  |   90915 K  |
|       from large pool |       2    |     205    |   28247 K  |   28247 K  |
|       from small pool |       0    |    5786    |   62667 K  |   62667 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    5887    |   90915 K  |   90915 K  |
|       from large pool |       2    |     205    |   28247 K  |   28247 K  |
|       from small pool |       0    |    5786    |   62667 K  |   62667 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      42    |      79    |      79    |      37    |
|       from large pool |      39    |      74    |      74    |      35    |
|       from small pool |       3    |       5    |       5    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    2787    |   37323 K  |   37323 K  |
|       from large pool |       2    |      69    |   11234 K  |   11234 K  |
|       from small pool |       0    |    2748    |   26088 K  |   26088 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1449 MiB | 462790 GiB | 462790 GiB |
|       from large pool |  16640 KiB |   1444 MiB | 451909 GiB | 451909 GiB |
|       from small pool |      0 KiB |      8 MiB |  10881 GiB |  10881 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1449 MiB | 462790 GiB | 462790 GiB |
|       from large pool |  16640 KiB |   1444 MiB | 451909 GiB | 451909 GiB |
|       from small pool |      0 KiB |      8 MiB |  10881 GiB |  10881 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1445 MiB | 461987 GiB | 461987 GiB |
|       from large pool |  16640 KiB |   1441 MiB | 451124 GiB | 451124 GiB |
|       from small pool |      0 KiB |      6 MiB |  10862 GiB |  10862 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    786 MiB |   1628 MiB |   1628 MiB |    842 MiB |
|       from large pool |    780 MiB |   1618 MiB |   1618 MiB |    838 MiB |
|       from small pool |      6 MiB |     10 MiB |     10 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 208026 KiB | 201088 GiB | 201088 GiB |
|       from large pool |  24320 KiB | 204800 KiB | 190206 GiB | 190206 GiB |
|       from small pool |      0 KiB |   5244 KiB |  10882 GiB |  10882 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    5887    |   90915 K  |   90915 K  |
|       from large pool |       2    |     205    |   28247 K  |   28247 K  |
|       from small pool |       0    |    5786    |   62667 K  |   62667 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    5887    |   90915 K  |   90915 K  |
|       from large pool |       2    |     205    |   28247 K  |   28247 K  |
|       from small pool |       0    |    5786    |   62667 K  |   62667 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      42    |      79    |      79    |      37    |
|       from large pool |      39    |      74    |      74    |      35    |
|       from small pool |       3    |       5    |       5    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    2787    |   37323 K  |   37323 K  |
|       from large pool |       2    |      69    |   11234 K  |   11234 K  |
|       from small pool |       0    |    2748    |   26088 K  |   26088 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0




!!!: not committed yet



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_07_11_22_seed_1_21316512

 Experiment start at: 2024-06-14 07:11:22.670470
before training, model accuracy: 0.04785691574215889
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9673021, 'precision': 0.7445874, 'recall': 0.53526425, 'specificity': 0.53526425, 'f1': 0.555538, 'auroc': 0.91579247, 'binary_precision': 0.519802, 'binary_recall': 0.07281554, 'binary_specificity': 0.997713, 'binary_f1_score': 0.12773724}
confusion matrix:
       0    1
0  42317   97
1   1337  105
---- Validation: 
scalar performance:
{'acc': 0.9635539, 'precision': 0.69996, 'recall': 0.52332705, 'specificity': 0.52332705, 'f1': 0.5347614, 'auroc': 0.92823994, 'binary_precision': 0.43421054, 'binary_recall': 0.049034175, 'binary_specificity': 0.99762, 'binary_f1_score': 0.08811749}
confusion matrix:
       0   1
0  18024  43
1    640  33
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95762163, 'precision': 0.6459308, 'recall': 0.5052647, 'specificity': 0.5052647, 'f1': 0.5003231, 'auroc': 0.9111861, 'binary_precision': 0.33333334, 'binary_recall': 0.011538462, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.022304833}
confusion matrix:
      0  1
0  5940  6
1   257  3
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316512_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-14 07:40:41.538531,epoch time: 0:29:18.868061,used: 0:29:18.868061,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_07_11_22_seed_1_21316512
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96800894, 'precision': 0.7505684, 'recall': 0.63678527, 'specificity': 0.63678527, 'f1': 0.67537624, 'auroc': 0.9275913, 'binary_precision': 0.52516127, 'binary_recall': 0.2822469, 'binary_specificity': 0.9913236, 'binary_f1_score': 0.36716282}
confusion matrix:
       0    1
0  42046  368
1   1035  407
---- Validation: 
scalar performance:
{'acc': 0.96510136, 'precision': 0.7503685, 'recall': 0.6314197, 'specificity': 0.6314197, 'f1': 0.67044306, 'auroc': 0.9385688, 'binary_precision': 0.52737755, 'binary_recall': 0.27191678, 'binary_specificity': 0.9909227, 'binary_f1_score': 0.3588235}
confusion matrix:
       0    1
0  17903  164
1    490  183
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621334, 'precision': 0.87062883, 'recall': 0.5664668, 'specificity': 0.5664668, 'f1': 0.60504895, 'auroc': 0.9222561, 'binary_precision': 0.7777778, 'binary_recall': 0.13461539, 'binary_specificity': 0.9983182, 'binary_f1_score': 0.2295082}
confusion matrix:
      0   1
0  5936  10
1   225  35
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316512_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-14 08:09:05.026867,epoch time: 0:28:23.488336,used: 0:57:42.356397,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_07_11_22_seed_1_21316512
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9677125, 'precision': 0.74625283, 'recall': 0.63596207, 'specificity': 0.63596207, 'f1': 0.6736586, 'auroc': 0.933781, 'binary_precision': 0.51658165, 'binary_recall': 0.28085992, 'binary_specificity': 0.99106425, 'binary_f1_score': 0.36388138}
confusion matrix:
       0    1
0  42035  379
1   1037  405
---- Validation: 
scalar performance:
{'acc': 0.9649413, 'precision': 0.74868906, 'recall': 0.62203825, 'specificity': 0.62203825, 'f1': 0.6615073, 'auroc': 0.9426379, 'binary_precision': 0.52469134, 'binary_recall': 0.25260028, 'binary_specificity': 0.9914762, 'binary_f1_score': 0.34102306}
confusion matrix:
       0    1
0  17913  154
1    503  170
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611666, 'precision': 0.8370521, 'recall': 0.5604453, 'specificity': 0.5604453, 'f1': 0.5949651, 'auroc': 0.92532814, 'binary_precision': 0.7111111, 'binary_recall': 0.12307692, 'binary_specificity': 0.99781364, 'binary_f1_score': 0.20983607}
confusion matrix:
      0   1
0  5933  13
1   228  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316512_3.png
early stop counter: 1
val acc:0.9649413228034973, best validation acc: 0.9651013612747192, corresponding to test acc:                         0.9621334075927734 / 0.9621334075927734
after epoch: 3,now: 2024-06-14 08:37:22.639220,epoch time: 0:28:17.612353,used: 1:25:59.968750,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_07_11_22_seed_1_21316512
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.968579, 'precision': 0.755425, 'recall': 0.67827904, 'specificity': 0.67827904, 'f1': 0.7093114, 'auroc': 0.9344505, 'binary_precision': 0.5321285, 'binary_recall': 0.36754507, 'binary_specificity': 0.9890131, 'binary_f1_score': 0.4347826}
confusion matrix:
       0    1
0  41948  466
1    912  530
---- Validation: 
scalar performance:
{'acc': 0.9660619, 'precision': 0.7592564, 'recall': 0.6705423, 'specificity': 0.6705423, 'f1': 0.70477, 'auroc': 0.9447043, 'binary_precision': 0.5423341, 'binary_recall': 0.35215452, 'binary_specificity': 0.9889301, 'binary_f1_score': 0.42702702}
confusion matrix:
       0    1
0  17867  200
1    436  237
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95939416, 'precision': 0.7862687, 'recall': 0.5411304, 'specificity': 0.5411304, 'f1': 0.56392485, 'auroc': 0.9259323, 'binary_precision': 0.6111111, 'binary_recall': 0.08461539, 'binary_specificity': 0.9976455, 'binary_f1_score': 0.14864865}
confusion matrix:
      0   1
0  5932  14
1   238  22
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316512_4.png
better model found
persisted
after epoch: 4,now: 2024-06-14 09:05:29.679202,epoch time: 0:28:07.039982,used: 1:54:07.008732,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_07_11_22_seed_1_21316512
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9689666, 'precision': 0.7600183, 'recall': 0.6788144, 'specificity': 0.6788144, 'f1': 0.7111711, 'auroc': 0.936761, 'binary_precision': 0.5412844, 'binary_recall': 0.36823857, 'binary_specificity': 0.9893903, 'binary_f1_score': 0.43829966}
confusion matrix:
       0    1
0  41964  450
1    911  531
---- Validation: 
scalar performance:
{'acc': 0.966222, 'precision': 0.76066905, 'recall': 0.6749169, 'specificity': 0.6749169, 'f1': 0.70845383, 'auroc': 0.9463317, 'binary_precision': 0.5448431, 'binary_recall': 0.36106983, 'binary_specificity': 0.98876405, 'binary_f1_score': 0.43431637}
confusion matrix:
       0    1
0  17864  203
1    430  243
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9624557, 'precision': 0.86972684, 'recall': 0.5721519, 'specificity': 0.5721519, 'f1': 0.61335164, 'auroc': 0.927873, 'binary_precision': 0.7755102, 'binary_recall': 0.14615385, 'binary_specificity': 0.99815, 'binary_f1_score': 0.2459547}
confusion matrix:
      0   1
0  5935  11
1   222  38
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316512_5.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-06-14 09:33:33.558696,epoch time: 0:28:03.879494,used: 2:22:10.888226,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_07_11_22_seed_1_21316512
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9688526, 'precision': 0.76598155, 'recall': 0.62583303, 'specificity': 0.62583303, 'f1': 0.66863084, 'auroc': 0.9379826, 'binary_precision': 0.55671644, 'binary_recall': 0.2586685, 'binary_specificity': 0.9929976, 'binary_f1_score': 0.3532197}
confusion matrix:
       0    1
0  42117  297
1   1069  373
---- Validation: 
scalar performance:
{'acc': 0.9652081, 'precision': 0.75393206, 'recall': 0.61287814, 'specificity': 0.61287814, 'f1': 0.65359783, 'auroc': 0.9469297, 'binary_precision': 0.53583616, 'binary_recall': 0.2332838, 'binary_specificity': 0.99247247, 'binary_f1_score': 0.32505172}
confusion matrix:
       0    1
0  17931  136
1    516  157
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959233, 'precision': 0.7951515, 'recall': 0.5318514, 'specificity': 0.5318514, 'f1': 0.54880047, 'auroc': 0.9287593, 'binary_precision': 0.6296296, 'binary_recall': 0.06538462, 'binary_specificity': 0.9983182, 'binary_f1_score': 0.118466906}
confusion matrix:
      0   1
0  5936  10
1   243  17
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316512_6.png
early stop counter: 1
val acc:0.965208113193512, best validation acc: 0.9662219882011414, corresponding to test acc:                         0.962455689907074 / 0.962455689907074
after epoch: 6,now: 2024-06-14 10:01:46.038537,epoch time: 0:28:12.479841,used: 2:50:23.368067,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_07_11_22_seed_1_21316512
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96924025, 'precision': 0.7680172, 'recall': 0.64622307, 'specificity': 0.64622307, 'f1': 0.6875962, 'auroc': 0.94039524, 'binary_precision': 0.55943155, 'binary_recall': 0.30048576, 'binary_specificity': 0.9919604, 'binary_f1_score': 0.39097068}
confusion matrix:
       0    1
0  42074  341
1   1008  433
---- Validation: 
scalar performance:
{'acc': 0.96584845, 'precision': 0.76322895, 'recall': 0.6225087, 'specificity': 0.6225087, 'f1': 0.6647023, 'auroc': 0.9483807, 'binary_precision': 0.5537459, 'binary_recall': 0.25260028, 'binary_specificity': 0.9924171, 'binary_f1_score': 0.3469388}
confusion matrix:
       0    1
0  17930  137
1    503  170
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95955527, 'precision': 0.820343, 'recall': 0.53201956, 'specificity': 0.53201956, 'f1': 0.5493003, 'auroc': 0.9295806, 'binary_precision': 0.68, 'binary_recall': 0.06538462, 'binary_specificity': 0.99865454, 'binary_f1_score': 0.11929825}
confusion matrix:
      0   1
0  5938   8
1   243  17
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316512_7.png
early stop counter: 2
val acc:0.965848445892334, best validation acc: 0.9662219882011414, corresponding to test acc:                         0.962455689907074 / 0.962455689907074
after epoch: 7,now: 2024-06-14 10:29:51.652265,epoch time: 0:28:05.613728,used: 3:18:28.981795,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_07_11_22_seed_1_21316512
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9706768, 'precision': 0.7886944, 'recall': 0.6585966, 'specificity': 0.6585966, 'f1': 0.7030998, 'auroc': 0.94197106, 'binary_precision': 0.6, 'binary_recall': 0.32454923, 'binary_specificity': 0.99264395, 'binary_f1_score': 0.42124215}
confusion matrix:
       0    1
0  42102  312
1    974  468
---- Validation: 
scalar performance:
{'acc': 0.9660619, 'precision': 0.7678008, 'recall': 0.61904305, 'specificity': 0.61904305, 'f1': 0.66209847, 'auroc': 0.94948745, 'binary_precision': 0.5631399, 'binary_recall': 0.24517088, 'binary_specificity': 0.9929153, 'binary_f1_score': 0.34161487}
confusion matrix:
       0    1
0  17939  128
1    508  165
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9585885, 'precision': 0.77392054, 'recall': 0.5186421, 'specificity': 0.5186421, 'f1': 0.5255119, 'auroc': 0.93159705, 'binary_precision': 0.5882353, 'binary_recall': 0.03846154, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.07220217}
confusion matrix:
      0   1
0  5939   7
1   250  10
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316512_8.png
