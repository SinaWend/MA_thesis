Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0




!!!: not committed yet



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_30_seed_0_21329046

 Experiment start at: 2024-06-17 02:20:30.857613
before training, model accuracy: 0.3103227913379669
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96687216, 'precision': 0.74467766, 'recall': 0.60653824, 'specificity': 0.60653824, 'f1': 0.6458739, 'auroc': 0.91858935, 'binary_precision': 0.51592356, 'binary_recall': 0.22025833, 'binary_specificity': 0.9928182, 'binary_f1_score': 0.30871844}
confusion matrix:
       0    1
0  42025  304
1   1147  324
---- Validation: 
scalar performance:
{'acc': 0.9672733, 'precision': 0.774409, 'recall': 0.57877713, 'specificity': 0.57877713, 'f1': 0.6180021, 'auroc': 0.91638994, 'binary_precision': 0.5777778, 'binary_recall': 0.16174184, 'binary_specificity': 0.9958124, 'binary_f1_score': 0.25273392}
confusion matrix:
       0    1
0  18073   76
1    539  104
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96692234, 'precision': 0.96622634, 'recall': 0.60711294, 'specificity': 0.60711294, 'f1': 0.6670629, 'auroc': 0.89363074, 'binary_precision': 0.9655172, 'binary_recall': 0.21455939, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.3510972}
confusion matrix:
      0   1
0  5995   2
1   205  56
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329046_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-17 02:35:48.218883,epoch time: 0:15:17.361270,used: 0:15:17.361270,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_30_seed_0_21329046
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9692009, 'precision': 0.7795228, 'recall': 0.6427612, 'specificity': 0.6427612, 'f1': 0.68703526, 'auroc': 0.93014026, 'binary_precision': 0.58322054, 'binary_recall': 0.2927989, 'binary_specificity': 0.99272346, 'binary_f1_score': 0.38986883}
confusion matrix:
       0    1
0  42020  308
1   1041  431
---- Validation: 
scalar performance:
{'acc': 0.96753937, 'precision': 0.7680114, 'recall': 0.6119173, 'specificity': 0.6119173, 'f1': 0.6550398, 'auroc': 0.93400776, 'binary_precision': 0.56273764, 'binary_recall': 0.23017107, 'binary_specificity': 0.99366355, 'binary_f1_score': 0.32671082}
confusion matrix:
       0    1
0  18034  115
1    495  148
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96676254, 'precision': 0.9742236, 'recall': 0.6033649, 'specificity': 0.6033649, 'f1': 0.66236144, 'auroc': 0.89853394, 'binary_precision': 0.9818182, 'binary_recall': 0.20689656, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.34177217}
confusion matrix:
      0   1
0  5996   1
1   207  54
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329046_2.png
better model found
persisted
after epoch: 2,now: 2024-06-17 02:50:25.601158,epoch time: 0:14:37.382275,used: 0:29:54.743545,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_30_seed_0_21329046
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97018266, 'precision': 0.7744762, 'recall': 0.73211956, 'specificity': 0.73211956, 'f1': 0.75134826, 'auroc': 0.9404896, 'binary_precision': 0.5670436, 'binary_recall': 0.4769022, 'binary_specificity': 0.987337, 'binary_f1_score': 0.5180812}
confusion matrix:
       0    1
0  41792  536
1    770  702
---- Validation: 
scalar performance:
{'acc': 0.969668, 'precision': 0.79985356, 'recall': 0.63927126, 'specificity': 0.63927126, 'f1': 0.68773615, 'auroc': 0.9432789, 'binary_precision': 0.62457335, 'binary_recall': 0.28460342, 'binary_specificity': 0.99393904, 'binary_f1_score': 0.39102563}
confusion matrix:
       0    1
0  18039  110
1    460  183
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96756154, 'precision': 0.9753711, 'recall': 0.6129434, 'specificity': 0.6129434, 'f1': 0.67547756, 'auroc': 0.8995421, 'binary_precision': 0.98333335, 'binary_recall': 0.22605364, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.36760128}
confusion matrix:
      0   1
0  5996   1
1   202  59
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329046_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-17 03:05:08.563437,epoch time: 0:14:42.962279,used: 0:44:37.705824,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_30_seed_0_21329046
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9710274, 'precision': 0.7787335, 'recall': 0.7620642, 'specificity': 0.7620642, 'f1': 0.7701155, 'auroc': 0.9442842, 'binary_precision': 0.5734975, 'binary_recall': 0.5380435, 'binary_specificity': 0.9860849, 'binary_f1_score': 0.55520505}
confusion matrix:
       0    1
0  41739  589
1    680  792
---- Validation: 
scalar performance:
{'acc': 0.9692422, 'precision': 0.77885747, 'recall': 0.6788038, 'specificity': 0.6788038, 'f1': 0.7168515, 'auroc': 0.94519436, 'binary_precision': 0.5798526, 'binary_recall': 0.36702955, 'binary_specificity': 0.990578, 'binary_f1_score': 0.4495238}
confusion matrix:
       0    1
0  17978  171
1    407  236
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96724194, 'precision': 0.97492766, 'recall': 0.609112, 'specificity': 0.609112, 'f1': 0.6702797, 'auroc': 0.89630926, 'binary_precision': 0.98275864, 'binary_recall': 0.21839081, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.35736677}
confusion matrix:
      0   1
0  5996   1
1   204  57
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329046_4.png
early stop counter: 1
val acc:0.9692422151565552, best validation acc: 0.9696679711341858, corresponding to test acc:                         0.9675615429878235 / 0.9675615429878235
after epoch: 4,now: 2024-06-17 03:19:42.697600,epoch time: 0:14:34.134163,used: 0:59:11.839987,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_30_seed_0_21329046
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97164387, 'precision': 0.787029, 'recall': 0.74730146, 'specificity': 0.74730146, 'f1': 0.76554286, 'auroc': 0.9410276, 'binary_precision': 0.5911252, 'binary_recall': 0.5067935, 'binary_specificity': 0.9878095, 'binary_f1_score': 0.5457205}
confusion matrix:
       0    1
0  41812  516
1    726  746
---- Validation: 
scalar performance:
{'acc': 0.9713176, 'precision': 0.8114507, 'recall': 0.6761279, 'specificity': 0.6761279, 'f1': 0.7234024, 'auroc': 0.94788337, 'binary_precision': 0.6452514, 'binary_recall': 0.3592535, 'binary_specificity': 0.99300236, 'binary_f1_score': 0.46153843}
confusion matrix:
       0    1
0  18022  127
1    412  231
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96180886, 'precision': 0.96007776, 'recall': 0.5439779, 'specificity': 0.5439779, 'f1': 0.5709315, 'auroc': 0.8877584, 'binary_precision': 0.9583333, 'binary_recall': 0.08812261, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.1614035}
confusion matrix:
      0   1
0  5996   1
1   238  23
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329046_5.png
better model found
persisted
after epoch: 5,now: 2024-06-17 03:34:27.597641,epoch time: 0:14:44.900041,used: 1:13:56.740028,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_30_seed_0_21329046
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97212327, 'precision': 0.81450784, 'recall': 0.68066585, 'specificity': 0.68066585, 'f1': 0.7279835, 'auroc': 0.94230473, 'binary_precision': 0.6506603, 'binary_recall': 0.36820653, 'binary_specificity': 0.99312514, 'binary_f1_score': 0.47028202}
confusion matrix:
       0    1
0  42037  291
1    930  542
---- Validation: 
scalar performance:
{'acc': 0.97078544, 'precision': 0.8446884, 'recall': 0.61959827, 'specificity': 0.61959827, 'f1': 0.6737098, 'auroc': 0.9465196, 'binary_precision': 0.7155963, 'binary_recall': 0.24261275, 'binary_specificity': 0.9965838, 'binary_f1_score': 0.36236933}
confusion matrix:
       0    1
0  18087   62
1    487  156
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.97983676, 'recall': 0.51724136, 'specificity': 0.51724136, 'f1': 0.5230443, 'auroc': 0.8786012, 'binary_precision': 1.0, 'binary_recall': 0.03448276, 'binary_specificity': 1.0, 'binary_f1_score': 0.06666667}
confusion matrix:
      0  1
0  5997  0
1   252  9
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329046_6.png
early stop counter: 1
val acc:0.9707854390144348, best validation acc: 0.9713175892829895, corresponding to test acc:                         0.9618088603019714 / 0.9675615429878235
after epoch: 6,now: 2024-06-17 03:49:06.044189,epoch time: 0:14:38.446548,used: 1:28:35.186576,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_30_seed_0_21329046
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97187215, 'precision': 0.7963284, 'recall': 0.71823996, 'specificity': 0.71823996, 'f1': 0.7508094, 'auroc': 0.9443763, 'binary_precision': 0.6117318, 'binary_recall': 0.44633153, 'binary_specificity': 0.99014837, 'binary_f1_score': 0.5161037}
confusion matrix:
       0    1
0  41911  417
1    815  657
---- Validation: 
scalar performance:
{'acc': 0.97169006, 'precision': 0.82809234, 'recall': 0.6605696, 'specificity': 0.6605696, 'f1': 0.7133268, 'auroc': 0.9474194, 'binary_precision': 0.6796116, 'binary_recall': 0.32659408, 'binary_specificity': 0.99454516, 'binary_f1_score': 0.44117647}
confusion matrix:
       0    1
0  18050   99
1    433  210
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96292746, 'precision': 0.96532273, 'recall': 0.5573879, 'specificity': 0.5573879, 'f1': 0.5932502, 'auroc': 0.8909745, 'binary_precision': 0.9677419, 'binary_recall': 0.11494253, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.20547946}
confusion matrix:
      0   1
0  5996   1
1   231  30
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329046_7.png
better model found
persisted
after epoch: 7,now: 2024-06-17 04:03:37.413928,epoch time: 0:14:31.369739,used: 1:43:06.556315,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_30_seed_0_21329046
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9723288, 'precision': 0.7992469, 'recall': 0.7279842, 'specificity': 0.7279842, 'f1': 0.7583518, 'auroc': 0.9444535, 'binary_precision': 0.61690646, 'binary_recall': 0.4660326, 'binary_specificity': 0.98993576, 'binary_f1_score': 0.5309598}
confusion matrix:
       0    1
0  41902  426
1    786  686
---- Validation: 
scalar performance:
{'acc': 0.9716369, 'precision': 0.82140124, 'recall': 0.66879267, 'specificity': 0.66879267, 'f1': 0.71938705, 'auroc': 0.948389, 'binary_precision': 0.66566265, 'binary_recall': 0.3437014, 'binary_specificity': 0.99388397, 'binary_f1_score': 0.45333335}
confusion matrix:
       0    1
0  18038  111
1    422  221
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959412, 'precision': 0.92420125, 'recall': 0.5152423, 'specificity': 0.5152423, 'f1': 0.5192589, 'auroc': 0.8710085, 'binary_precision': 0.8888889, 'binary_recall': 0.03065134, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.05925926}
confusion matrix:
      0  1
0  5996  1
1   253  8
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329046_8.png
early stop counter: 1
val acc:0.9716368913650513, best validation acc: 0.9716900587081909, corresponding to test acc:                         0.9629274606704712 / 0.9675615429878235
after epoch: 8,now: 2024-06-17 04:18:12.574308,epoch time: 0:14:35.160380,used: 1:57:41.716695,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_30_seed_0_21329046
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9725114, 'precision': 0.80808306, 'recall': 0.70873487, 'specificity': 0.70873487, 'f1': 0.74801487, 'auroc': 0.94877374, 'binary_precision': 0.63590264, 'binary_recall': 0.4259511, 'binary_specificity': 0.9915186, 'binary_f1_score': 0.5101708}
confusion matrix:
       0    1
0  41969  359
1    845  627
---- Validation: 
scalar performance:
{'acc': 0.97083867, 'precision': 0.8341874, 'recall': 0.6301266, 'specificity': 0.6301266, 'f1': 0.6839747, 'auroc': 0.94888204, 'binary_precision': 0.6938776, 'binary_recall': 0.2643857, 'binary_specificity': 0.99586755, 'binary_f1_score': 0.3828829}
confusion matrix:
       0    1
0  18074   75
1    473  170
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.94442666, 'recall': 0.5248208, 'specificity': 0.5248208, 'f1': 0.537102, 'auroc': 0.8849091, 'binary_precision': 0.9285714, 'binary_recall': 0.049808428, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.094545454}
confusion matrix:
      0   1
0  5996   1
1   248  13
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329046_9.png
early stop counter: 2
val acc:0.9708386659622192, best validation acc: 0.9716900587081909, corresponding to test acc:                         0.9629274606704712 / 0.9675615429878235
after epoch: 9,now: 2024-06-17 04:32:54.431283,epoch time: 0:14:41.856975,used: 2:12:23.573670,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_30_seed_0_21329046
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9710274, 'precision': 0.7784445, 'recall': 0.76435924, 'specificity': 0.76435924, 'f1': 0.7712003, 'auroc': 0.94801724, 'binary_precision': 0.57275987, 'binary_recall': 0.54279894, 'binary_specificity': 0.9859195, 'binary_f1_score': 0.55737704}
confusion matrix:
       0    1
0  41732  596
1    673  799
---- Validation: 
scalar performance:
{'acc': 0.97153044, 'precision': 0.8039711, 'recall': 0.70098996, 'specificity': 0.70098996, 'f1': 0.74102914, 'auroc': 0.94992036, 'binary_precision': 0.62857145, 'binary_recall': 0.41057542, 'binary_specificity': 0.9914045, 'binary_f1_score': 0.4967074}
confusion matrix:
       0    1
0  17993  156
1    379  264
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96324706, 'precision': 0.9664549, 'recall': 0.5612193, 'specificity': 0.5612193, 'f1': 0.59943426, 'auroc': 0.88996434, 'binary_precision': 0.969697, 'binary_recall': 0.12260536, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.21768707}
confusion matrix:
      0   1
0  5996   1
1   229  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329046_10.png
early stop counter: 3
val acc:0.9715304374694824, best validation acc: 0.9716900587081909, corresponding to test acc:                         0.9629274606704712 / 0.9675615429878235
after epoch: 10,now: 2024-06-17 04:47:36.808302,epoch time: 0:14:42.377019,used: 2:27:05.950689,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_30_seed_0_21329046
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.97230595, 'precision': 0.79841673, 'recall': 0.7299395, 'specificity': 0.7299395, 'f1': 0.7593262, 'auroc': 0.9500091, 'binary_precision': 0.6151111, 'binary_recall': 0.4701087, 'binary_specificity': 0.98977035, 'binary_f1_score': 0.53292257}
confusion matrix:
       0    1
0  41895  433
1    780  692
---- Validation: 
scalar performance:
{'acc': 0.97275436, 'precision': 0.8229795, 'recall': 0.7001235, 'specificity': 0.7001235, 'f1': 0.7458913, 'auroc': 0.95250666, 'binary_precision': 0.6666667, 'binary_recall': 0.407465, 'binary_specificity': 0.992782, 'binary_f1_score': 0.5057915}
confusion matrix:
       0    1
0  18018  131
1    381  262
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650048, 'precision': 0.9710953, 'recall': 0.5822921, 'specificity': 0.5822921, 'f1': 0.6320163, 'auroc': 0.89465547, 'binary_precision': 0.97727275, 'binary_recall': 0.16475096, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.28196722}
confusion matrix:
      0   1
0  5996   1
1   218  43
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329046_11.png
better model found
persisted
after epoch: 11,now: 2024-06-17 05:02:15.725206,epoch time: 0:14:38.916904,used: 2:41:44.867593,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_30_seed_0_21329046
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.97280824, 'precision': 0.8029408, 'recall': 0.73544514, 'specificity': 0.73544514, 'f1': 0.76457, 'auroc': 0.9485579, 'binary_precision': 0.62378854, 'binary_recall': 0.48097825, 'binary_specificity': 0.9899121, 'binary_f1_score': 0.543153}
confusion matrix:
       0    1
0  41901  427
1    764  708
---- Validation: 
scalar performance:
{'acc': 0.97232866, 'precision': 0.82612836, 'recall': 0.68190175, 'specificity': 0.68190175, 'f1': 0.7318497, 'auroc': 0.9513061, 'binary_precision': 0.674221, 'binary_recall': 0.37013996, 'binary_specificity': 0.99366355, 'binary_f1_score': 0.47791168}
confusion matrix:
       0    1
0  18034  115
1    405  238
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9610099, 'precision': 0.9542099, 'recall': 0.5343994, 'specificity': 0.5343994, 'f1': 0.55431515, 'auroc': 0.88234043, 'binary_precision': 0.94736844, 'binary_recall': 0.06896552, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.12857144}
confusion matrix:
      0   1
0  5996   1
1   243  18
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329046_12.png
early stop counter: 1
val acc:0.9723286628723145, best validation acc: 0.9727543592453003, corresponding to test acc:                         0.9650048017501831 / 0.9675615429878235
after epoch: 12,now: 2024-06-17 05:16:50.187954,epoch time: 0:14:34.462748,used: 2:56:19.330341,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_30_seed_0_21329046
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.97296804, 'precision': 0.8011909, 'recall': 0.7483145, 'specificity': 0.7483145, 'f1': 0.77196836, 'auroc': 0.95033324, 'binary_precision': 0.619403, 'binary_recall': 0.5074728, 'binary_specificity': 0.9891561, 'binary_f1_score': 0.557879}
confusion matrix:
       0    1
0  41869  459
1    725  747
---- Validation: 
scalar performance:
{'acc': 0.9709983, 'precision': 0.82645446, 'recall': 0.6429602, 'specificity': 0.6429602, 'f1': 0.6960499, 'auroc': 0.94948274, 'binary_precision': 0.67753625, 'binary_recall': 0.29082426, 'binary_specificity': 0.99509615, 'binary_f1_score': 0.4069641}
confusion matrix:
       0    1
0  18060   89
1    456  187
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9603707, 'precision': 0.98014414, 'recall': 0.5249042, 'specificity': 0.5249042, 'f1': 0.53731614, 'auroc': 0.8859066, 'binary_precision': 1.0, 'binary_recall': 0.049808428, 'binary_specificity': 1.0, 'binary_f1_score': 0.09489051}
confusion matrix:
      0   1
0  5997   0
1   248  13
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329046_13.png
early stop counter: 2
val acc:0.9709982872009277, best validation acc: 0.9727543592453003, corresponding to test acc:                         0.9650048017501831 / 0.9675615429878235
after epoch: 13,now: 2024-06-17 05:31:22.530448,epoch time: 0:14:32.342494,used: 3:10:51.672835,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_30_seed_0_21329046
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9738813, 'precision': 0.8120427, 'recall': 0.7481313, 'specificity': 0.7481313, 'f1': 0.77610767, 'auroc': 0.94998014, 'binary_precision': 0.641136, 'binary_recall': 0.5061141, 'binary_specificity': 0.99014837, 'binary_f1_score': 0.56567955}
confusion matrix:
       0    1
0  41911  417
1    727  745
---- Validation: 
scalar performance:
{'acc': 0.97302043, 'precision': 0.83274347, 'recall': 0.6912606, 'specificity': 0.6912606, 'f1': 0.7413316, 'auroc': 0.9514594, 'binary_precision': 0.6868132, 'binary_recall': 0.3888025, 'binary_specificity': 0.9937187, 'binary_f1_score': 0.49652436}
confusion matrix:
       0    1
0  18035  114
1    393  250
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614893, 'precision': 0.9391643, 'recall': 0.54197884, 'specificity': 0.54197884, 'f1': 0.56734097, 'auroc': 0.8844576, 'binary_precision': 0.9166667, 'binary_recall': 0.08429119, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.15438597}
confusion matrix:
      0   1
0  5995   2
1   239  22
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329046_14.png
better model found
persisted
after epoch: 14,now: 2024-06-17 05:46:04.015642,epoch time: 0:14:41.485194,used: 3:25:33.158029,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_30_seed_0_21329046
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9723516, 'precision': 0.79762256, 'recall': 0.73488104, 'specificity': 0.73488104, 'f1': 0.76220775, 'auroc': 0.949584, 'binary_precision': 0.613183, 'binary_recall': 0.4802989, 'binary_specificity': 0.9894632, 'binary_f1_score': 0.53866667}
confusion matrix:
       0    1
0  41882  446
1    765  707
---- Validation: 
scalar performance:
{'acc': 0.97275436, 'precision': 0.8195646, 'recall': 0.706874, 'specificity': 0.706874, 'f1': 0.7501078, 'auroc': 0.9518746, 'binary_precision': 0.6593674, 'binary_recall': 0.4214619, 'binary_specificity': 0.9922861, 'binary_f1_score': 0.5142315}
confusion matrix:
       0    1
0  18009  140
1    372  271
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96228826, 'precision': 0.94673413, 'recall': 0.5515574, 'specificity': 0.5515574, 'f1': 0.58345187, 'auroc': 0.889592, 'binary_precision': 0.9310345, 'binary_recall': 0.10344828, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.18620689}
confusion matrix:
      0   1
0  5995   2
1   234  27
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329046_15.png
early stop counter: 1
val acc:0.9727543592453003, best validation acc: 0.9730204343795776, corresponding to test acc:                         0.9614893198013306 / 0.9675615429878235
after epoch: 15,now: 2024-06-17 06:00:46.844093,epoch time: 0:14:42.828451,used: 3:40:15.986480,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_30_seed_0_21329046
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9742922, 'precision': 0.8234743, 'recall': 0.73260653, 'specificity': 0.73260653, 'f1': 0.76997, 'auroc': 0.9505312, 'binary_precision': 0.6650763, 'binary_recall': 0.47350544, 'binary_specificity': 0.9917076, 'binary_f1_score': 0.5531746}
confusion matrix:
       0    1
0  41977  351
1    775  697
---- Validation: 
scalar performance:
{'acc': 0.9729672, 'precision': 0.8313241, 'recall': 0.6919831, 'specificity': 0.6919831, 'f1': 0.74157, 'auroc': 0.9499403, 'binary_precision': 0.6839237, 'binary_recall': 0.3903577, 'binary_specificity': 0.9936085, 'binary_f1_score': 0.4970297}
confusion matrix:
       0    1
0  18033  116
1    392  251
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608501, 'precision': 0.95267093, 'recall': 0.53248364, 'specificity': 0.53248364, 'f1': 0.55092126, 'auroc': 0.88584447, 'binary_precision': 0.9444444, 'binary_recall': 0.0651341, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.121863805}
confusion matrix:
      0   1
0  5996   1
1   244  17
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329046_16.png
early stop counter: 2
val acc:0.9729672074317932, best validation acc: 0.9730204343795776, corresponding to test acc:                         0.9614893198013306 / 0.9675615429878235
after epoch: 16,now: 2024-06-17 06:15:27.797115,epoch time: 0:14:40.953022,used: 3:54:56.939502,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_30_seed_0_21329046
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.97305936, 'precision': 0.7967527, 'recall': 0.7709842, 'specificity': 0.7709842, 'f1': 0.7832264, 'auroc': 0.95059013, 'binary_precision': 0.6089552, 'binary_recall': 0.5543478, 'binary_specificity': 0.9876205, 'binary_f1_score': 0.58036983}
confusion matrix:
       0    1
0  41804  524
1    656  816
---- Validation: 
scalar performance:
{'acc': 0.9722222, 'precision': 0.8183619, 'recall': 0.69234747, 'specificity': 0.69234747, 'f1': 0.73847467, 'auroc': 0.95041674, 'binary_precision': 0.65796345, 'binary_recall': 0.3919129, 'binary_specificity': 0.992782, 'binary_f1_score': 0.49122804}
confusion matrix:
       0    1
0  18018  131
1    391  252
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96212846, 'precision': 0.96183467, 'recall': 0.54780936, 'specificity': 0.54780936, 'f1': 0.5774179, 'auroc': 0.8883345, 'binary_precision': 0.96153843, 'binary_recall': 0.09578544, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.17421602}
confusion matrix:
      0   1
0  5996   1
1   236  25
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329046_17.png
early stop counter: 3
val acc:0.9722222089767456, best validation acc: 0.9730204343795776, corresponding to test acc:                         0.9614893198013306 / 0.9675615429878235
after epoch: 17,now: 2024-06-17 06:30:03.465058,epoch time: 0:14:35.667943,used: 4:09:32.607445,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_30_seed_0_21329046
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9731507, 'precision': 0.8271786, 'recall': 0.6903775, 'specificity': 0.6903775, 'f1': 0.73921937, 'auroc': 0.9506061, 'binary_precision': 0.67535543, 'binary_recall': 0.38722825, 'binary_specificity': 0.99352676, 'binary_f1_score': 0.49222794}
confusion matrix:
       0    1
0  42054  274
1    902  570
---- Validation: 
scalar performance:
{'acc': 0.97169006, 'precision': 0.86498654, 'recall': 0.6260671, 'specificity': 0.6260671, 'f1': 0.68345445, 'auroc': 0.94821656, 'binary_precision': 0.7557604, 'binary_recall': 0.25505444, 'binary_specificity': 0.99707973, 'binary_f1_score': 0.38139537}
confusion matrix:
       0    1
0  18096   53
1    479  164
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.9793765, 'recall': 0.50574714, 'specificity': 0.50574714, 'f1': 0.50083476, 'auroc': 0.8852645, 'binary_precision': 1.0, 'binary_recall': 0.011494253, 'binary_specificity': 1.0, 'binary_f1_score': 0.022727272}
confusion matrix:
      0  1
0  5997  0
1   258  3
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329046_18.png
early stop counter: 4
val acc:0.9716900587081909, best validation acc: 0.9730204343795776, corresponding to test acc:                         0.9614893198013306 / 0.9675615429878235
after epoch: 18,now: 2024-06-17 06:44:36.047672,epoch time: 0:14:32.582614,used: 4:24:05.190059,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_30_seed_0_21329046
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.97210044, 'precision': 0.8323996, 'recall': 0.65222335, 'specificity': 0.65222335, 'f1': 0.70626575, 'auroc': 0.94466704, 'binary_precision': 0.688351, 'binary_recall': 0.3093134, 'binary_specificity': 0.99513334, 'binary_f1_score': 0.42682925}
confusion matrix:
       0    1
0  42123  206
1   1016  455
---- Validation: 
scalar performance:
{'acc': 0.9713708, 'precision': 0.85585487, 'recall': 0.62515175, 'specificity': 0.62515175, 'f1': 0.6813317, 'auroc': 0.9472143, 'binary_precision': 0.7375566, 'binary_recall': 0.2534992, 'binary_specificity': 0.99680424, 'binary_f1_score': 0.3773148}
confusion matrix:
       0    1
0  18091   58
1    480  163
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.9793765, 'recall': 0.50574714, 'specificity': 0.50574714, 'f1': 0.50083476, 'auroc': 0.8780656, 'binary_precision': 1.0, 'binary_recall': 0.011494253, 'binary_specificity': 1.0, 'binary_f1_score': 0.022727272}
confusion matrix:
      0  1
0  5997  0
1   258  3
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329046_19.png
early stop counter: 5
val acc:0.9713708162307739, best validation acc: 0.9730204343795776, corresponding to test acc:                         0.9614893198013306 / 0.9675615429878235
after epoch: 19,now: 2024-06-17 06:59:10.556646,epoch time: 0:14:34.508974,used: 4:38:39.699033,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_30_seed_0_21329046
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.97347033, 'precision': 0.82373387, 'recall': 0.70628023, 'specificity': 0.70628023, 'f1': 0.75089574, 'auroc': 0.94909495, 'binary_precision': 0.6673866, 'binary_recall': 0.41983697, 'binary_specificity': 0.99272346, 'binary_f1_score': 0.51542956}
confusion matrix:
       0    1
0  42020  308
1    854  618
---- Validation: 
scalar performance:
{'acc': 0.9723819, 'precision': 0.84037155, 'recall': 0.66392803, 'specificity': 0.66392803, 'f1': 0.71889377, 'auroc': 0.95002127, 'binary_precision': 0.70394737, 'binary_recall': 0.33281493, 'binary_specificity': 0.9950411, 'binary_f1_score': 0.45195356}
confusion matrix:
       0    1
0  18059   90
1    429  214
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96164906, 'precision': 0.9590949, 'recall': 0.5420622, 'specificity': 0.5420622, 'f1': 0.56765443, 'auroc': 0.8856393, 'binary_precision': 0.95652175, 'binary_recall': 0.08429119, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.15492958}
confusion matrix:
      0   1
0  5996   1
1   239  22
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329046_20.png
early stop counter: 6
val acc:0.9723818898200989, best validation acc: 0.9730204343795776, corresponding to test acc:                         0.9614893198013306 / 0.9675615429878235
after epoch: 20,now: 2024-06-17 07:13:44.784296,epoch time: 0:14:34.227650,used: 4:53:13.926683,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_30_seed_0_21329046
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9731735, 'precision': 0.7973224, 'recall': 0.7728604, 'specificity': 0.7728604, 'f1': 0.7845154, 'auroc': 0.9502939, 'binary_precision': 0.60995543, 'binary_recall': 0.5581237, 'binary_specificity': 0.98759717, 'binary_f1_score': 0.5828896}
confusion matrix:
       0    1
0  41804  525
1    650  821
---- Validation: 
scalar performance:
{'acc': 0.97275436, 'precision': 0.8136178, 'recall': 0.72037494, 'specificity': 0.72037494, 'f1': 0.7581227, 'auroc': 0.9499557, 'binary_precision': 0.6465324, 'binary_recall': 0.44945568, 'binary_specificity': 0.99129426, 'binary_f1_score': 0.5302752}
confusion matrix:
       0    1
0  17991  158
1    354  289
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.98022103, 'recall': 0.52681994, 'specificity': 0.52681994, 'f1': 0.54082, 'auroc': 0.8822304, 'binary_precision': 1.0, 'binary_recall': 0.053639848, 'binary_specificity': 1.0, 'binary_f1_score': 0.10181818}
confusion matrix:
      0   1
0  5997   0
1   247  14
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329046_21.png
early stop counter: 7
val acc:0.9727543592453003, best validation acc: 0.9730204343795776, corresponding to test acc:                         0.9614893198013306 / 0.9675615429878235
after epoch: 21,now: 2024-06-17 07:28:23.386291,epoch time: 0:14:38.601995,used: 5:07:52.528678,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_30_seed_0_21329046
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9721689, 'precision': 0.7901882, 'recall': 0.75904834, 'specificity': 0.75904834, 'f1': 0.7736484, 'auroc': 0.9506875, 'binary_precision': 0.5966387, 'binary_recall': 0.5305706, 'binary_specificity': 0.987526, 'binary_f1_score': 0.56166846}
confusion matrix:
       0    1
0  41800  528
1    691  781
---- Validation: 
scalar performance:
{'acc': 0.9720626, 'precision': 0.81263256, 'recall': 0.6990153, 'specificity': 0.6990153, 'f1': 0.74209917, 'auroc': 0.9501637, 'binary_precision': 0.6460396, 'binary_recall': 0.4059098, 'binary_specificity': 0.9921208, 'binary_f1_score': 0.49856737}
confusion matrix:
       0    1
0  18006  143
1    382  261
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.94904476, 'recall': 0.52865225, 'specificity': 0.52865225, 'f1': 0.54406095, 'auroc': 0.88338536, 'binary_precision': 0.9375, 'binary_recall': 0.057471264, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.10830325}
confusion matrix:
      0   1
0  5996   1
1   246  15
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329046_22.png
early stop counter: 8
val acc:0.9720625877380371, best validation acc: 0.9730204343795776, corresponding to test acc:                         0.9614893198013306 / 0.9675615429878235
after epoch: 22,now: 2024-06-17 07:43:01.780217,epoch time: 0:14:38.393926,used: 5:22:30.922604,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_30_seed_0_21329046
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.97408676, 'precision': 0.8268831, 'recall': 0.7190579, 'specificity': 0.7190579, 'f1': 0.7614189, 'auroc': 0.953454, 'binary_precision': 0.6728205, 'binary_recall': 0.4456522, 'binary_specificity': 0.9924636, 'binary_f1_score': 0.5361667}
confusion matrix:
       0    1
0  42009  319
1    816  656
---- Validation: 
scalar performance:
{'acc': 0.9720626, 'precision': 0.8335554, 'recall': 0.6637627, 'specificity': 0.6637627, 'f1': 0.7173879, 'auroc': 0.95066273, 'binary_precision': 0.6903226, 'binary_recall': 0.33281493, 'binary_specificity': 0.99471045, 'binary_f1_score': 0.44910806}
confusion matrix:
       0    1
0  18053   96
1    429  214
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959412, 'precision': 0.9796833, 'recall': 0.51341, 'specificity': 0.51341, 'f1': 0.51575035, 'auroc': 0.8907132, 'binary_precision': 1.0, 'binary_recall': 0.026819924, 'binary_specificity': 1.0, 'binary_f1_score': 0.052238807}
confusion matrix:
      0  1
0  5997  0
1   254  7
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329046_23.png
early stop counter: 9
val acc:0.9720625877380371, best validation acc: 0.9730204343795776, corresponding to test acc:                         0.9614893198013306 / 0.9675615429878235
after epoch: 23,now: 2024-06-17 07:57:44.093790,epoch time: 0:14:42.313573,used: 5:37:13.236177,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_30_seed_0_21329046
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9733562, 'precision': 0.82762855, 'recall': 0.6957296, 'specificity': 0.6957296, 'f1': 0.74369067, 'auroc': 0.95141494, 'binary_precision': 0.6758939, 'binary_recall': 0.3980978, 'binary_specificity': 0.99336135, 'binary_f1_score': 0.5010688}
confusion matrix:
       0    1
0  42047  281
1    886  586
---- Validation: 
scalar performance:
{'acc': 0.9714772, 'precision': 0.87124515, 'recall': 0.6177063, 'specificity': 0.6177063, 'f1': 0.6744161, 'auroc': 0.94742835, 'binary_precision': 0.76884425, 'binary_recall': 0.23794712, 'binary_specificity': 0.99746543, 'binary_f1_score': 0.36342043}
confusion matrix:
       0    1
0  18103   46
1    490  153
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.8794768, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329046_24.png
early stop counter: 10
val acc:0.971477210521698, best validation acc: 0.9730204343795776, corresponding to test acc:                         0.9614893198013306 / 0.9675615429878235
after epoch: 24,now: 2024-06-17 08:12:17.754231,epoch time: 0:14:33.660441,used: 5:51:46.896618,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_30_seed_0_21329046
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.973379, 'precision': 0.83060825, 'recall': 0.6914792, 'specificity': 0.6914792, 'f1': 0.7410017, 'auroc': 0.94752085, 'binary_precision': 0.68214285, 'binary_recall': 0.3892663, 'binary_specificity': 0.9936921, 'binary_f1_score': 0.49567473}
confusion matrix:
       0    1
0  42061  267
1    899  573
---- Validation: 
scalar performance:
{'acc': 0.97169006, 'precision': 0.8584386, 'recall': 0.63056743, 'specificity': 0.63056743, 'f1': 0.6877085, 'auroc': 0.9477817, 'binary_precision': 0.7423581, 'binary_recall': 0.2643857, 'binary_specificity': 0.9967491, 'binary_f1_score': 0.38990825}
confusion matrix:
       0    1
0  18090   59
1    473  170
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959412, 'precision': 0.9796833, 'recall': 0.51341, 'specificity': 0.51341, 'f1': 0.51575035, 'auroc': 0.8768409, 'binary_precision': 1.0, 'binary_recall': 0.026819924, 'binary_specificity': 1.0, 'binary_f1_score': 0.052238807}
confusion matrix:
      0  1
0  5997  0
1   254  7
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329046_25.png
early stop counter: 11
val acc:0.9716900587081909, best validation acc: 0.9730204343795776, corresponding to test acc:                         0.9614893198013306 / 0.9675615429878235
after epoch: 25,now: 2024-06-17 08:26:53.867707,epoch time: 0:14:36.113476,used: 6:06:23.010094,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_30_seed_0_21329046
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9736073, 'precision': 0.80918, 'recall': 0.74667805, 'specificity': 0.74667805, 'f1': 0.7740916, 'auroc': 0.95271105, 'binary_precision': 0.635506, 'binary_recall': 0.50339675, 'binary_specificity': 0.98995936, 'binary_f1_score': 0.5617892}
confusion matrix:
       0    1
0  41903  425
1    731  741
---- Validation: 
scalar performance:
{'acc': 0.9728608, 'precision': 0.8208083, 'recall': 0.70767915, 'specificity': 0.70767915, 'f1': 0.75108397, 'auroc': 0.94800794, 'binary_precision': 0.6618005, 'binary_recall': 0.4230171, 'binary_specificity': 0.99234116, 'binary_f1_score': 0.516129}
confusion matrix:
       0    1
0  18010  139
1    371  272
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9603707, 'precision': 0.92146814, 'recall': 0.52856886, 'specificity': 0.52856886, 'f1': 0.5438245, 'auroc': 0.8892574, 'binary_precision': 0.88235295, 'binary_recall': 0.057471264, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.10791367}
confusion matrix:
      0   1
0  5995   2
1   246  15
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329046_26.png
early stop counter: 12
val acc:0.9728608131408691, best validation acc: 0.9730204343795776, corresponding to test acc:                         0.9614893198013306 / 0.9675615429878235
after epoch: 26,now: 2024-06-17 08:41:28.889055,epoch time: 0:14:35.021348,used: 6:20:58.031442,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_30_seed_0_21329046
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.973379, 'precision': 0.79518646, 'recall': 0.79363656, 'specificity': 0.79363656, 'f1': 0.7944093, 'auroc': 0.95185256, 'binary_precision': 0.60423785, 'binary_recall': 0.60095173, 'binary_specificity': 0.98632145, 'binary_f1_score': 0.6025903}
confusion matrix:
       0    1
0  41750  579
1    587  884
---- Validation: 
scalar performance:
{'acc': 0.97270113, 'precision': 0.80772245, 'recall': 0.73459846, 'specificity': 0.73459846, 'f1': 0.76577175, 'auroc': 0.95251596, 'binary_precision': 0.63374484, 'binary_recall': 0.47900465, 'binary_specificity': 0.9901923, 'binary_f1_score': 0.5456156}
confusion matrix:
       0    1
0  17971  178
1    335  308
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9610099, 'precision': 0.8680667, 'recall': 0.5453934, 'specificity': 0.5453934, 'f1': 0.5722114, 'auroc': 0.8902943, 'binary_precision': 0.7741935, 'binary_recall': 0.09195402, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.16438356}
confusion matrix:
      0   1
0  5990   7
1   237  24
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329046_27.png
early stop counter: 13
val acc:0.9727011322975159, best validation acc: 0.9730204343795776, corresponding to test acc:                         0.9614893198013306 / 0.9675615429878235
after epoch: 27,now: 2024-06-17 08:56:15.559391,epoch time: 0:14:46.670336,used: 6:35:44.701778,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_30_seed_0_21329046
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9736986, 'precision': 0.8391571, 'recall': 0.6877103, 'specificity': 0.6877103, 'f1': 0.7399513, 'auroc': 0.9516172, 'binary_precision': 0.6995013, 'binary_recall': 0.38111413, 'binary_specificity': 0.9943064, 'binary_f1_score': 0.4934037}
confusion matrix:
       0    1
0  42087  241
1    911  561
---- Validation: 
scalar performance:
{'acc': 0.9710515, 'precision': 0.8316395, 'recall': 0.63848746, 'specificity': 0.63848746, 'f1': 0.6923634, 'auroc': 0.9474374, 'binary_precision': 0.68821293, 'binary_recall': 0.281493, 'binary_specificity': 0.99548185, 'binary_f1_score': 0.3995585}
confusion matrix:
       0    1
0  18067   82
1    462  181
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9592522, 'precision': 0.9796065, 'recall': 0.5114943, 'specificity': 0.5114943, 'f1': 0.5120629, 'auroc': 0.8754792, 'binary_precision': 1.0, 'binary_recall': 0.022988506, 'binary_specificity': 1.0, 'binary_f1_score': 0.044943817}
confusion matrix:
      0  1
0  5997  0
1   255  6
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329046_28.png
early stop counter: 14
val acc:0.9710515141487122, best validation acc: 0.9730204343795776, corresponding to test acc:                         0.9614893198013306 / 0.9675615429878235
after epoch: 28,now: 2024-06-17 09:11:18.196679,epoch time: 0:15:02.637288,used: 6:50:47.339066,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_30_seed_0_21329046
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9727854, 'precision': 0.84173095, 'recall': 0.6603531, 'specificity': 0.6603531, 'f1': 0.7158158, 'auroc': 0.9502077, 'binary_precision': 0.7064897, 'binary_recall': 0.3254076, 'binary_specificity': 0.9952986, 'binary_f1_score': 0.44558138}
confusion matrix:
       0    1
0  42129  199
1    993  479
---- Validation: 
scalar performance:
{'acc': 0.97051936, 'precision': 0.8473029, 'recall': 0.6112099, 'specificity': 0.6112099, 'f1': 0.66426146, 'auroc': 0.9479437, 'binary_precision': 0.72139305, 'binary_recall': 0.22550544, 'binary_specificity': 0.99691445, 'binary_f1_score': 0.3436019}
confusion matrix:
       0    1
0  18093   56
1    498  145
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9592522, 'precision': 0.9796065, 'recall': 0.5114943, 'specificity': 0.5114943, 'f1': 0.5120629, 'auroc': 0.8819221, 'binary_precision': 1.0, 'binary_recall': 0.022988506, 'binary_specificity': 1.0, 'binary_f1_score': 0.044943817}
confusion matrix:
      0  1
0  5997  0
1   255  6
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329046_29.png
early stop counter: 15
val acc:0.9705193638801575, best validation acc: 0.9730204343795776, corresponding to test acc:                         0.9614893198013306 / 0.9675615429878235
after epoch: 29,now: 2024-06-17 09:27:40.939624,epoch time: 0:16:22.742945,used: 7:07:10.082011,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_30_seed_0_21329046
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9728539, 'precision': 0.81177306, 'recall': 0.7118628, 'specificity': 0.7118628, 'f1': 0.7514488, 'auroc': 0.9495344, 'binary_precision': 0.6430738, 'binary_recall': 0.43206522, 'binary_specificity': 0.99166036, 'binary_f1_score': 0.51686305}
confusion matrix:
       0    1
0  41975  353
1    836  636
---- Validation: 
scalar performance:
{'acc': 0.97184974, 'precision': 0.8216281, 'recall': 0.67490333, 'specificity': 0.67490333, 'f1': 0.72478884, 'auroc': 0.94910157, 'binary_precision': 0.6656977, 'binary_recall': 0.3561431, 'binary_specificity': 0.99366355, 'binary_f1_score': 0.4640324}
confusion matrix:
       0    1
0  18034  115
1    414  229
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.9799136, 'recall': 0.5191571, 'specificity': 0.5191571, 'f1': 0.52665126, 'auroc': 0.88107973, 'binary_precision': 1.0, 'binary_recall': 0.038314175, 'binary_specificity': 1.0, 'binary_f1_score': 0.073800735}
confusion matrix:
      0   1
0  5997   0
1   251  10
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329046_30.png
early stop counter: 16
val acc:0.9718497395515442, best validation acc: 0.9730204343795776, corresponding to test acc:                         0.9614893198013306 / 0.9675615429878235
after epoch: 30,now: 2024-06-17 09:42:24.021175,epoch time: 0:14:43.081551,used: 7:21:53.163562,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_30_seed_0_21329046
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 7:21:53.163562 at 2024-06-17 09:42:24.021175
persisted model performance metric: 

scalar performance:
{'acc': 0.9614893, 'precision': 0.9391643, 'recall': 0.54197884, 'specificity': 0.54197884, 'f1': 0.56734097, 'auroc': 0.8844576, 'binary_precision': 0.9166667, 'binary_recall': 0.08429119, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.15438597}
confusion matrix:
      0   1
0  5995   2
1   239  22
oracle model performance metric: 

scalar performance:
{'acc': 0.96756154, 'precision': 0.9753711, 'recall': 0.6129434, 'specificity': 0.6129434, 'f1': 0.67547756, 'auroc': 0.8995421, 'binary_precision': 0.98333335, 'binary_recall': 0.22605364, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.36760128}
confusion matrix:
      0   1
0  5996   1
1   202  59
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre3/rule_results/0.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre3/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre3/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204178 KiB |   1436 MiB | 404958 GiB | 404958 GiB |
|       from large pool | 167936 KiB |   1366 MiB | 404884 GiB | 404883 GiB |
|       from small pool |  36242 KiB |     72 MiB |     74 GiB |     74 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 204178 KiB |   1436 MiB | 404958 GiB | 404958 GiB |
|       from large pool | 167936 KiB |   1366 MiB | 404884 GiB | 404883 GiB |
|       from small pool |  36242 KiB |     72 MiB |     74 GiB |     74 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201088 KiB |   1428 MiB | 404935 GiB | 404934 GiB |
|       from large pool | 165120 KiB |   1358 MiB | 404863 GiB | 404863 GiB |
|       from small pool |  35968 KiB |     71 MiB |     71 GiB |     71 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1524 MiB |   1524 MiB |   1524 MiB |      0 B   |
|       from large pool |   1450 MiB |   1450 MiB |   1450 MiB |      0 B   |
|       from small pool |     74 MiB |     74 MiB |     74 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 320109 KiB | 749313 KiB | 302185 GiB | 302184 GiB |
|       from large pool | 311296 KiB | 748328 KiB | 302104 GiB | 302104 GiB |
|       from small pool |   8813 KiB |  12610 KiB |     80 GiB |     80 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1278    |    1935    |   13347 K  |   13346 K  |
|       from large pool |      36    |      76    |    5312 K  |    5312 K  |
|       from small pool |    1242    |    1864    |    8035 K  |    8034 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1278    |    1935    |   13347 K  |   13346 K  |
|       from large pool |      36    |      76    |    5312 K  |    5312 K  |
|       from small pool |    1242    |    1864    |    8035 K  |    8034 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      50    |      50    |      50    |       0    |
|       from large pool |      13    |      13    |      13    |       0    |
|       from small pool |      37    |      37    |      37    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      36    |     453    |    7176 K  |    7176 K  |
|       from large pool |       5    |      10    |    1973 K  |    1973 K  |
|       from small pool |      31    |     448    |    5202 K  |    5202 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1436 MiB | 404958 GiB | 404958 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 404884 GiB | 404884 GiB |
|       from small pool |      0 KiB |     72 MiB |     74 GiB |     74 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1436 MiB | 404958 GiB | 404958 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 404884 GiB | 404884 GiB |
|       from small pool |      0 KiB |     72 MiB |     74 GiB |     74 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1428 MiB | 404935 GiB | 404935 GiB |
|       from large pool |  16640 KiB |   1358 MiB | 404863 GiB | 404863 GiB |
|       from small pool |      0 KiB |     71 MiB |     71 GiB |     71 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 524288 KiB |   1524 MiB |   1524 MiB |   1012 MiB |
|       from large pool | 479232 KiB |   1450 MiB |   1450 MiB |    982 MiB |
|       from small pool |  45056 KiB |     74 MiB |     74 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 298752 KiB | 749313 KiB | 302185 GiB | 302185 GiB |
|       from large pool | 298752 KiB | 748328 KiB | 302104 GiB | 302104 GiB |
|       from small pool |      0 KiB |  16408 KiB |     80 GiB |     80 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1935    |   13347 K  |   13347 K  |
|       from large pool |       2    |      76    |    5312 K  |    5312 K  |
|       from small pool |       0    |    1864    |    8035 K  |    8035 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1935    |   13347 K  |   13347 K  |
|       from large pool |       2    |      76    |    5312 K  |    5312 K  |
|       from small pool |       0    |    1864    |    8035 K  |    8035 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      50    |      50    |      19    |
|       from large pool |       9    |      13    |      13    |       4    |
|       from small pool |      22    |      37    |      37    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     453    |    7176 K  |    7176 K  |
|       from large pool |       1    |      11    |    1973 K  |    1973 K  |
|       from small pool |       0    |     448    |    5202 K  |    5202 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1436 MiB | 404958 GiB | 404958 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 404884 GiB | 404884 GiB |
|       from small pool |      0 KiB |     72 MiB |     74 GiB |     74 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1436 MiB | 404958 GiB | 404958 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 404884 GiB | 404884 GiB |
|       from small pool |      0 KiB |     72 MiB |     74 GiB |     74 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1428 MiB | 404935 GiB | 404935 GiB |
|       from large pool |  16640 KiB |   1358 MiB | 404863 GiB | 404863 GiB |
|       from small pool |      0 KiB |     71 MiB |     71 GiB |     71 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 524288 KiB |   1524 MiB |   1524 MiB |   1012 MiB |
|       from large pool | 479232 KiB |   1450 MiB |   1450 MiB |    982 MiB |
|       from small pool |  45056 KiB |     74 MiB |     74 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 298752 KiB | 749313 KiB | 302185 GiB | 302185 GiB |
|       from large pool | 298752 KiB | 748328 KiB | 302104 GiB | 302104 GiB |
|       from small pool |      0 KiB |  16408 KiB |     80 GiB |     80 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1935    |   13347 K  |   13347 K  |
|       from large pool |       2    |      76    |    5312 K  |    5312 K  |
|       from small pool |       0    |    1864    |    8035 K  |    8035 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1935    |   13347 K  |   13347 K  |
|       from large pool |       2    |      76    |    5312 K  |    5312 K  |
|       from small pool |       0    |    1864    |    8035 K  |    8035 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      50    |      50    |      19    |
|       from large pool |       9    |      13    |      13    |       4    |
|       from small pool |      22    |      37    |      37    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     453    |    7176 K  |    7176 K  |
|       from large pool |       1    |      11    |    1973 K  |    1973 K  |
|       from small pool |       0    |     448    |    5202 K  |    5202 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0




!!!: not committed yet



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_49_19_seed_1_21329046

 Experiment start at: 2024-06-17 09:49:19.612327
before training, model accuracy: 0.14631003141403198
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9670548, 'precision': 0.7393044, 'recall': 0.6835334, 'specificity': 0.6835334, 'f1': 0.70735085, 'auroc': 0.9231628, 'binary_precision': 0.4995442, 'binary_recall': 0.38002774, 'binary_specificity': 0.987039, 'binary_f1_score': 0.43166605}
confusion matrix:
       0    1
0  41809  549
1    894  548
---- Validation: 
scalar performance:
{'acc': 0.966222, 'precision': 0.76453257, 'recall': 0.6463062, 'specificity': 0.6463062, 'f1': 0.6866949, 'auroc': 0.9219671, 'binary_precision': 0.5546448, 'binary_recall': 0.30163446, 'binary_specificity': 0.990978, 'binary_f1_score': 0.39076033}
confusion matrix:
       0    1
0  17904  163
1    470  203
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97067356, 'precision': 0.9622017, 'recall': 0.65735596, 'specificity': 0.65735596, 'f1': 0.7294524, 'auroc': 0.88194585, 'binary_precision': 0.95348835, 'binary_recall': 0.31538463, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.47398844}
confusion matrix:
      0   1
0  5942   4
1   178  82
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329046_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-17 10:04:33.724529,epoch time: 0:15:14.112202,used: 0:15:14.112202,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_49_19_seed_1_21329046
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9698858, 'precision': 0.76905864, 'recall': 0.695971, 'specificity': 0.695971, 'f1': 0.7262175, 'auroc': 0.9326191, 'binary_precision': 0.5582291, 'binary_recall': 0.4027778, 'binary_specificity': 0.9891643, 'binary_f1_score': 0.46793064}
confusion matrix:
       0    1
0  41901  459
1    860  580
---- Validation: 
scalar performance:
{'acc': 0.96808964, 'precision': 0.8071417, 'recall': 0.62367105, 'specificity': 0.62367105, 'f1': 0.67305434, 'auroc': 0.93081665, 'binary_precision': 0.6415094, 'binary_recall': 0.25260028, 'binary_specificity': 0.9947418, 'binary_f1_score': 0.36247334}
confusion matrix:
       0    1
0  17972   95
1    503  170
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96455044, 'precision': 0.9821602, 'recall': 0.5769231, 'specificity': 0.5769231, 'f1': 0.6242515, 'auroc': 0.8832415, 'binary_precision': 1.0, 'binary_recall': 0.15384616, 'binary_specificity': 1.0, 'binary_f1_score': 0.26666668}
confusion matrix:
      0   1
0  5946   0
1   220  40
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329046_2.png
better model found
persisted
after epoch: 2,now: 2024-06-17 10:19:49.697730,epoch time: 0:15:15.973201,used: 0:30:30.085403,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_49_19_seed_1_21329046
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.970274, 'precision': 0.76638454, 'recall': 0.76459706, 'specificity': 0.76459706, 'f1': 0.76548743, 'auroc': 0.94404066, 'binary_precision': 0.54825175, 'binary_recall': 0.54444444, 'binary_specificity': 0.98474973, 'binary_f1_score': 0.5463415}
confusion matrix:
       0    1
0  41714  646
1    656  784
---- Validation: 
scalar performance:
{'acc': 0.9687834, 'precision': 0.78964674, 'recall': 0.68840486, 'specificity': 0.68840486, 'f1': 0.72725284, 'auroc': 0.9370594, 'binary_precision': 0.6018519, 'binary_recall': 0.38632986, 'binary_specificity': 0.9904799, 'binary_f1_score': 0.47058827}
confusion matrix:
       0    1
0  17895  172
1    413  260
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9708347, 'precision': 0.9733348, 'recall': 0.655601, 'specificity': 0.655601, 'f1': 0.7286531, 'auroc': 0.8932409, 'binary_precision': 0.97590363, 'binary_recall': 0.31153846, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.4723032}
confusion matrix:
      0   1
0  5944   2
1   179  81
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329046_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-17 10:37:42.348339,epoch time: 0:17:52.650609,used: 0:48:22.736012,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_49_19_seed_1_21329046
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9709589, 'precision': 0.79392487, 'recall': 0.6576172, 'specificity': 0.6576172, 'f1': 0.70346177, 'auroc': 0.94014114, 'binary_precision': 0.6105263, 'binary_recall': 0.32222223, 'binary_specificity': 0.99301225, 'binary_f1_score': 0.4218182}
confusion matrix:
       0    1
0  42064  296
1    976  464
---- Validation: 
scalar performance:
{'acc': 0.96947706, 'precision': 0.86799335, 'recall': 0.60722417, 'specificity': 0.60722417, 'f1': 0.6611707, 'auroc': 0.937244, 'binary_precision': 0.7643979, 'binary_recall': 0.21693908, 'binary_specificity': 0.9975093, 'binary_f1_score': 0.33796296}
confusion matrix:
       0    1
0  18022   45
1    527  146
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587496, 'precision': 0.97936153, 'recall': 0.50769234, 'specificity': 0.50769234, 'f1': 0.5046148, 'auroc': 0.8777187, 'binary_precision': 1.0, 'binary_recall': 0.015384615, 'binary_specificity': 1.0, 'binary_f1_score': 0.03030303}
confusion matrix:
      0  1
0  5946  0
1   256  4
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329046_4.png
better model found
persisted
after epoch: 4,now: 2024-06-17 10:53:28.778121,epoch time: 0:15:46.429782,used: 1:04:09.165794,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_49_19_seed_1_21329046
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97178084, 'precision': 0.80284303, 'recall': 0.67078805, 'specificity': 0.67078805, 'f1': 0.7168672, 'auroc': 0.94812167, 'binary_precision': 0.6275, 'binary_recall': 0.34861112, 'binary_specificity': 0.99296504, 'binary_f1_score': 0.4482143}
confusion matrix:
       0    1
0  42062  298
1    938  502
---- Validation: 
scalar performance:
{'acc': 0.9708645, 'precision': 0.8423648, 'recall': 0.65729713, 'specificity': 0.65729713, 'f1': 0.71280825, 'auroc': 0.9402623, 'binary_precision': 0.70957094, 'binary_recall': 0.31946507, 'binary_specificity': 0.9951292, 'binary_f1_score': 0.44057372}
confusion matrix:
       0    1
0  17979   88
1    458  215
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9622946, 'precision': 0.98106796, 'recall': 0.55, 'specificity': 0.55, 'f1': 0.58126044, 'auroc': 0.8884892, 'binary_precision': 1.0, 'binary_recall': 0.1, 'binary_specificity': 1.0, 'binary_f1_score': 0.18181819}
confusion matrix:
      0   1
0  5946   0
1   234  26
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329046_5.png
better model found
persisted
after epoch: 5,now: 2024-06-17 11:08:32.609965,epoch time: 0:15:03.831844,used: 1:19:12.997638,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_49_19_seed_1_21329046
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9722603, 'precision': 0.7931235, 'recall': 0.7168868, 'specificity': 0.7168868, 'f1': 0.74878836, 'auroc': 0.9484813, 'binary_precision': 0.60493827, 'binary_recall': 0.44359332, 'binary_specificity': 0.9901803, 'binary_f1_score': 0.5118522}
confusion matrix:
       0    1
0  41948  416
1    799  637
---- Validation: 
scalar performance:
{'acc': 0.97017074, 'precision': 0.8198805, 'recall': 0.6683817, 'specificity': 0.6683817, 'f1': 0.71858263, 'auroc': 0.9406471, 'binary_precision': 0.6637931, 'binary_recall': 0.34323922, 'binary_specificity': 0.99352413, 'binary_f1_score': 0.45249757}
confusion matrix:
       0    1
0  17950  117
1    442  231
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9619723, 'precision': 0.9809123, 'recall': 0.54615384, 'specificity': 0.54615384, 'f1': 0.5747775, 'auroc': 0.8925422, 'binary_precision': 1.0, 'binary_recall': 0.092307694, 'binary_specificity': 1.0, 'binary_f1_score': 0.1690141}
confusion matrix:
      0   1
0  5946   0
1   236  24
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329046_6.png
early stop counter: 1
val acc:0.9701707363128662, best validation acc: 0.970864474773407, corresponding to test acc:                         0.9622945785522461 / 0.9708346724510193
after epoch: 6,now: 2024-06-17 11:23:37.362472,epoch time: 0:15:04.752507,used: 1:34:17.750145,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_49_19_seed_1_21329046
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9724429, 'precision': 0.7963743, 'recall': 0.71708274, 'specificity': 0.71708274, 'f1': 0.75005245, 'auroc': 0.9479421, 'binary_precision': 0.6114833, 'binary_recall': 0.44375, 'binary_specificity': 0.9904155, 'binary_f1_score': 0.51428574}
confusion matrix:
       0    1
0  41954  406
1    801  639
---- Validation: 
scalar performance:
{'acc': 0.97155815, 'precision': 0.8543836, 'recall': 0.66123325, 'specificity': 0.66123325, 'f1': 0.71880484, 'auroc': 0.94229937, 'binary_precision': 0.73333335, 'binary_recall': 0.3268945, 'binary_specificity': 0.99557203, 'binary_f1_score': 0.45220965}
confusion matrix:
       0    1
0  17987   80
1    453  220
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590719, 'precision': 0.97951615, 'recall': 0.51153845, 'specificity': 0.51153845, 'f1': 0.5121002, 'auroc': 0.8905314, 'binary_precision': 1.0, 'binary_recall': 0.023076924, 'binary_specificity': 1.0, 'binary_f1_score': 0.045112785}
confusion matrix:
      0  1
0  5946  0
1   254  6
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329046_7.png
better model found
persisted
after epoch: 7,now: 2024-06-17 11:38:37.261887,epoch time: 0:14:59.899415,used: 1:49:17.649560,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_49_19_seed_1_21329046
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97230595, 'precision': 0.7978746, 'recall': 0.7059431, 'specificity': 0.7059431, 'f1': 0.7427763, 'auroc': 0.94672173, 'binary_precision': 0.6152284, 'binary_recall': 0.42083332, 'binary_specificity': 0.99105287, 'binary_f1_score': 0.4997938}
confusion matrix:
       0    1
0  41981  379
1    834  606
---- Validation: 
scalar performance:
{'acc': 0.9705443, 'precision': 0.82872593, 'recall': 0.6657143, 'specificity': 0.6657143, 'f1': 0.7180791, 'auroc': 0.9422041, 'binary_precision': 0.6816817, 'binary_recall': 0.33729568, 'binary_specificity': 0.99413294, 'binary_f1_score': 0.45129222}
confusion matrix:
       0    1
0  17961  106
1    446  227
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96052206, 'precision': 0.9802132, 'recall': 0.52884614, 'specificity': 0.52884614, 'f1': 0.54445237, 'auroc': 0.8875208, 'binary_precision': 1.0, 'binary_recall': 0.057692308, 'binary_specificity': 1.0, 'binary_f1_score': 0.10909091}
confusion matrix:
      0   1
0  5946   0
1   245  15
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329046_8.png
early stop counter: 1
val acc:0.9705442786216736, best validation acc: 0.971558153629303, corresponding to test acc:                         0.9590718746185303 / 0.9708346724510193
after epoch: 8,now: 2024-06-17 11:53:26.362968,epoch time: 0:14:49.101081,used: 2:04:06.750641,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_49_19_seed_1_21329046
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9721461, 'precision': 0.7922845, 'recall': 0.71913326, 'specificity': 0.71913326, 'f1': 0.74999654, 'auroc': 0.9474472, 'binary_precision': 0.6031746, 'binary_recall': 0.4482998, 'binary_specificity': 0.9899667, 'binary_f1_score': 0.5143312}
confusion matrix:
       0    1
0  41934  425
1    795  646
---- Validation: 
scalar performance:
{'acc': 0.9726254, 'precision': 0.82846165, 'recall': 0.72329974, 'specificity': 0.72329974, 'f1': 0.7649446, 'auroc': 0.9458862, 'binary_precision': 0.67699116, 'binary_recall': 0.45468053, 'binary_specificity': 0.991919, 'binary_f1_score': 0.544}
confusion matrix:
       0    1
0  17921  146
1    367  306
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96036094, 'precision': 0.9801357, 'recall': 0.52692306, 'specificity': 0.52692306, 'f1': 0.54096144, 'auroc': 0.8816319, 'binary_precision': 1.0, 'binary_recall': 0.053846154, 'binary_specificity': 1.0, 'binary_f1_score': 0.10218979}
confusion matrix:
      0   1
0  5946   0
1   246  14
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329046_9.png
better model found
persisted
after epoch: 9,now: 2024-06-17 12:08:22.523990,epoch time: 0:14:56.161022,used: 2:19:02.911663,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_49_19_seed_1_21329046
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9731507, 'precision': 0.8084335, 'recall': 0.7100694, 'specificity': 0.7100694, 'f1': 0.7491144, 'auroc': 0.94677234, 'binary_precision': 0.6360825, 'binary_recall': 0.42847222, 'binary_specificity': 0.9916667, 'binary_f1_score': 0.51203316}
confusion matrix:
       0    1
0  42007  353
1    823  617
---- Validation: 
scalar performance:
{'acc': 0.97214514, 'precision': 0.8337615, 'recall': 0.70087737, 'specificity': 0.70087737, 'f1': 0.7493611, 'auroc': 0.94325155, 'binary_precision': 0.68922305, 'binary_recall': 0.40861812, 'binary_specificity': 0.99313664, 'binary_f1_score': 0.5130597}
confusion matrix:
       0    1
0  17943  124
1    398  275
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96036094, 'precision': 0.9801357, 'recall': 0.52692306, 'specificity': 0.52692306, 'f1': 0.54096144, 'auroc': 0.8788558, 'binary_precision': 1.0, 'binary_recall': 0.053846154, 'binary_specificity': 1.0, 'binary_f1_score': 0.10218979}
confusion matrix:
      0   1
0  5946   0
1   246  14
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329046_10.png
early stop counter: 1
val acc:0.972145140171051, best validation acc: 0.9726253747940063, corresponding to test acc:                         0.9603609442710876 / 0.9708346724510193
after epoch: 10,now: 2024-06-17 12:23:18.436077,epoch time: 0:14:55.912087,used: 2:33:58.823750,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_49_19_seed_1_21329046
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.97194064, 'precision': 0.7945149, 'recall': 0.70038754, 'specificity': 0.70038754, 'f1': 0.7377017, 'auroc': 0.94879484, 'binary_precision': 0.60887516, 'binary_recall': 0.4097222, 'binary_specificity': 0.99105287, 'binary_f1_score': 0.48982978}
confusion matrix:
       0    1
0  41981  379
1    850  590
---- Validation: 
scalar performance:
{'acc': 0.9716649, 'precision': 0.8360995, 'recall': 0.6848924, 'specificity': 0.6848924, 'f1': 0.73668766, 'auroc': 0.94453406, 'binary_precision': 0.69505495, 'binary_recall': 0.37592867, 'binary_specificity': 0.9938562, 'binary_f1_score': 0.48794597}
confusion matrix:
       0    1
0  17956  111
1    420  253
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96003866, 'precision': 0.9799806, 'recall': 0.52307695, 'specificity': 0.52307695, 'f1': 0.5339035, 'auroc': 0.8911241, 'binary_precision': 1.0, 'binary_recall': 0.046153847, 'binary_specificity': 1.0, 'binary_f1_score': 0.08823529}
confusion matrix:
      0   1
0  5946   0
1   248  12
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329046_11.png
early stop counter: 2
val acc:0.9716649055480957, best validation acc: 0.9726253747940063, corresponding to test acc:                         0.9603609442710876 / 0.9708346724510193
after epoch: 11,now: 2024-06-17 12:38:19.254220,epoch time: 0:15:00.818143,used: 2:48:59.641893,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_49_19_seed_1_21329046
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9724886, 'precision': 0.7964824, 'recall': 0.71878344, 'specificity': 0.71878344, 'f1': 0.75124395, 'auroc': 0.94837415, 'binary_precision': 0.611586, 'binary_recall': 0.44722223, 'binary_specificity': 0.99034464, 'binary_f1_score': 0.5166466}
confusion matrix:
       0    1
0  41951  409
1    796  644
---- Validation: 
scalar performance:
{'acc': 0.9717716, 'precision': 0.85700226, 'recall': 0.66348976, 'specificity': 0.66348976, 'f1': 0.7214724, 'auroc': 0.94308275, 'binary_precision': 0.7384106, 'binary_recall': 0.33135214, 'binary_specificity': 0.9956274, 'binary_f1_score': 0.4574359}
confusion matrix:
       0    1
0  17988   79
1    450  223
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584273, 'precision': 0.9792069, 'recall': 0.50384617, 'specificity': 0.50384617, 'f1': 0.4970163, 'auroc': 0.88044304, 'binary_precision': 1.0, 'binary_recall': 0.0076923077, 'binary_specificity': 1.0, 'binary_f1_score': 0.015267175}
confusion matrix:
      0  1
0  5946  0
1   258  2
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329046_12.png
early stop counter: 3
val acc:0.9717715978622437, best validation acc: 0.9726253747940063, corresponding to test acc:                         0.9603609442710876 / 0.9708346724510193
after epoch: 12,now: 2024-06-17 12:53:13.844464,epoch time: 0:14:54.590244,used: 3:03:54.232137,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_49_19_seed_1_21329046
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.97365296, 'precision': 0.80572385, 'recall': 0.73749804, 'specificity': 0.73749804, 'f1': 0.76694125, 'auroc': 0.9538427, 'binary_precision': 0.6288288, 'binary_recall': 0.48472223, 'binary_specificity': 0.99027383, 'binary_f1_score': 0.547451}
confusion matrix:
       0    1
0  41948  412
1    742  698
---- Validation: 
scalar performance:
{'acc': 0.97187835, 'precision': 0.8240035, 'recall': 0.7107528, 'specificity': 0.7107528, 'f1': 0.75429446, 'auroc': 0.94604164, 'binary_precision': 0.6689815, 'binary_recall': 0.4294205, 'binary_specificity': 0.99208504, 'binary_f1_score': 0.5230769}
confusion matrix:
       0    1
0  17924  143
1    384  289
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96003866, 'precision': 0.9799806, 'recall': 0.52307695, 'specificity': 0.52307695, 'f1': 0.5339035, 'auroc': 0.884796, 'binary_precision': 1.0, 'binary_recall': 0.046153847, 'binary_specificity': 1.0, 'binary_f1_score': 0.08823529}
confusion matrix:
      0   1
0  5946   0
1   248  12
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329046_13.png
early stop counter: 4
val acc:0.9718783497810364, best validation acc: 0.9726253747940063, corresponding to test acc:                         0.9603609442710876 / 0.9708346724510193
after epoch: 13,now: 2024-06-17 13:08:04.002107,epoch time: 0:14:50.157643,used: 3:18:44.389780,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_49_19_seed_1_21329046
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9729909, 'precision': 0.8008096, 'recall': 0.7260869, 'specificity': 0.7260869, 'f1': 0.75767225, 'auroc': 0.9532923, 'binary_precision': 0.6197577, 'binary_recall': 0.46180555, 'binary_specificity': 0.99036825, 'binary_f1_score': 0.52924794}
confusion matrix:
       0    1
0  41952  408
1    775  665
---- Validation: 
scalar performance:
{'acc': 0.97129136, 'precision': 0.8179947, 'recall': 0.7054415, 'specificity': 0.7054415, 'f1': 0.7485038, 'auroc': 0.9452374, 'binary_precision': 0.6573427, 'binary_recall': 0.4190193, 'binary_specificity': 0.9918636, 'binary_f1_score': 0.5117967}
confusion matrix:
       0    1
0  17920  147
1    391  282
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621334, 'precision': 0.94665694, 'recall': 0.5517549, 'specificity': 0.5517549, 'f1': 0.5837333, 'auroc': 0.8938566, 'binary_precision': 0.9310345, 'binary_recall': 0.103846155, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.18685122}
confusion matrix:
      0   1
0  5944   2
1   233  27
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329046_14.png
early stop counter: 5
val acc:0.9712913632392883, best validation acc: 0.9726253747940063, corresponding to test acc:                         0.9603609442710876 / 0.9708346724510193
after epoch: 14,now: 2024-06-17 13:23:10.205495,epoch time: 0:15:06.203388,used: 3:33:50.593168,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_49_19_seed_1_21329046
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9725799, 'precision': 0.79319143, 'recall': 0.7367867, 'specificity': 0.7367867, 'f1': 0.7617072, 'auroc': 0.9502245, 'binary_precision': 0.60380626, 'binary_recall': 0.48438585, 'binary_specificity': 0.98918766, 'binary_f1_score': 0.5375433}
confusion matrix:
       0    1
0  41901  458
1    743  698
---- Validation: 
scalar performance:
{'acc': 0.9717716, 'precision': 0.8159855, 'recall': 0.72500277, 'specificity': 0.72500277, 'f1': 0.7621186, 'auroc': 0.94496846, 'binary_precision': 0.65189874, 'binary_recall': 0.45913818, 'binary_specificity': 0.9908673, 'binary_f1_score': 0.5387969}
confusion matrix:
       0    1
0  17902  165
1    364  309
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.962778, 'precision': 0.9386693, 'recall': 0.5612862, 'specificity': 0.5612862, 'f1': 0.5989425, 'auroc': 0.8944108, 'binary_precision': 0.9142857, 'binary_recall': 0.12307692, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.21694915}
confusion matrix:
      0   1
0  5943   3
1   228  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329046_15.png
early stop counter: 6
val acc:0.9717715978622437, best validation acc: 0.9726253747940063, corresponding to test acc:                         0.9603609442710876 / 0.9708346724510193
after epoch: 15,now: 2024-06-17 13:37:58.709022,epoch time: 0:14:48.503527,used: 3:48:39.096695,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_49_19_seed_1_21329046
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9731507, 'precision': 0.8321201, 'recall': 0.6666946, 'specificity': 0.6666946, 'f1': 0.7198844, 'auroc': 0.9465343, 'binary_precision': 0.68635726, 'binary_recall': 0.3386537, 'binary_specificity': 0.9947355, 'binary_f1_score': 0.45353162}
confusion matrix:
       0    1
0  42136  223
1    953  488
---- Validation: 
scalar performance:
{'acc': 0.96974385, 'precision': 0.85356426, 'recall': 0.62166786, 'specificity': 0.62166786, 'f1': 0.6768997, 'auroc': 0.94247335, 'binary_precision': 0.7345133, 'binary_recall': 0.24665676, 'binary_specificity': 0.996679, 'binary_f1_score': 0.36929923}
confusion matrix:
       0    1
0  18007   60
1    507  166
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9585885, 'precision': 0.9792842, 'recall': 0.50576925, 'specificity': 0.50576925, 'f1': 0.5008299, 'auroc': 0.87483394, 'binary_precision': 1.0, 'binary_recall': 0.011538462, 'binary_specificity': 1.0, 'binary_f1_score': 0.022813687}
confusion matrix:
      0  1
0  5946  0
1   257  3
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329046_16.png
early stop counter: 7
val acc:0.9697438478469849, best validation acc: 0.9726253747940063, corresponding to test acc:                         0.9603609442710876 / 0.9708346724510193
after epoch: 16,now: 2024-06-17 13:53:02.808821,epoch time: 0:15:04.099799,used: 4:03:43.196494,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_49_19_seed_1_21329046
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9734247, 'precision': 0.8245491, 'recall': 0.68517375, 'specificity': 0.68517375, 'f1': 0.73428434, 'auroc': 0.95068365, 'binary_precision': 0.66996294, 'binary_recall': 0.37665045, 'binary_specificity': 0.99369705, 'binary_f1_score': 0.48220637}
confusion matrix:
       0    1
0  42094  267
1    897  542
---- Validation: 
scalar performance:
{'acc': 0.9705443, 'precision': 0.8441311, 'recall': 0.64783263, 'specificity': 0.64783263, 'f1': 0.70374036, 'auroc': 0.94378597, 'binary_precision': 0.71378094, 'binary_recall': 0.30014858, 'binary_specificity': 0.9955167, 'binary_f1_score': 0.42259413}
confusion matrix:
       0    1
0  17986   81
1    471  202
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590719, 'precision': 0.9170902, 'recall': 0.5133774, 'specificity': 0.5133774, 'f1': 0.51566154, 'auroc': 0.882332, 'binary_precision': 0.875, 'binary_recall': 0.026923077, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.052238807}
confusion matrix:
      0  1
0  5945  1
1   253  7
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329046_17.png
early stop counter: 8
val acc:0.9705442786216736, best validation acc: 0.9726253747940063, corresponding to test acc:                         0.9603609442710876 / 0.9708346724510193
after epoch: 17,now: 2024-06-17 14:08:00.181701,epoch time: 0:14:57.372880,used: 4:18:40.569374,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_49_19_seed_1_21329046
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.97289956, 'precision': 0.7924261, 'recall': 0.7563923, 'specificity': 0.7563923, 'f1': 0.77311325, 'auroc': 0.95373726, 'binary_precision': 0.6009539, 'binary_recall': 0.5246357, 'binary_specificity': 0.9881489, 'binary_f1_score': 0.5602074}
confusion matrix:
       0    1
0  41857  502
1    685  756
---- Validation: 
scalar performance:
{'acc': 0.9717716, 'precision': 0.8231802, 'recall': 0.7092669, 'specificity': 0.7092669, 'f1': 0.7529284, 'auroc': 0.9449356, 'binary_precision': 0.66744184, 'binary_recall': 0.42644873, 'binary_specificity': 0.99208504, 'binary_f1_score': 0.5203989}
confusion matrix:
       0    1
0  17924  143
1    386  287
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96406704, 'precision': 0.95768595, 'recall': 0.57483184, 'specificity': 0.57483184, 'f1': 0.62036157, 'auroc': 0.8870011, 'binary_precision': 0.9512195, 'binary_recall': 0.15, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.2591362}
confusion matrix:
      0   1
0  5944   2
1   221  39
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329046_18.png
early stop counter: 9
val acc:0.9717715978622437, best validation acc: 0.9726253747940063, corresponding to test acc:                         0.9603609442710876 / 0.9708346724510193
after epoch: 18,now: 2024-06-17 14:23:34.605229,epoch time: 0:15:34.423528,used: 4:34:14.992902,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_49_19_seed_1_21329046
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.97422373, 'precision': 0.82879245, 'recall': 0.70344853, 'specificity': 0.70344853, 'f1': 0.7501664, 'auroc': 0.9488412, 'binary_precision': 0.67727274, 'binary_recall': 0.41360167, 'binary_specificity': 0.99329543, 'binary_f1_score': 0.51357174}
confusion matrix:
       0    1
0  42075  284
1    845  596
---- Validation: 
scalar performance:
{'acc': 0.9708111, 'precision': 0.83681583, 'recall': 0.6622763, 'specificity': 0.6622763, 'f1': 0.71652067, 'auroc': 0.9427776, 'binary_precision': 0.6981132, 'binary_recall': 0.32986626, 'binary_specificity': 0.9946864, 'binary_f1_score': 0.44803226}
confusion matrix:
       0    1
0  17971   96
1    451  222
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959233, 'precision': 0.924112, 'recall': 0.5153005, 'specificity': 0.5153005, 'f1': 0.5193222, 'auroc': 0.8773104, 'binary_precision': 0.8888889, 'binary_recall': 0.03076923, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.059479553}
confusion matrix:
      0  1
0  5945  1
1   252  8
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329046_19.png
early stop counter: 10
val acc:0.970811128616333, best validation acc: 0.9726253747940063, corresponding to test acc:                         0.9603609442710876 / 0.9708346724510193
after epoch: 19,now: 2024-06-17 14:38:42.733132,epoch time: 0:15:08.127903,used: 4:49:23.120805,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_49_19_seed_1_21329046
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9723516, 'precision': 0.78319097, 'recall': 0.78072405, 'specificity': 0.78072405, 'f1': 0.78195155, 'auroc': 0.9496496, 'binary_precision': 0.58082575, 'binary_recall': 0.5755895, 'binary_specificity': 0.9858586, 'binary_f1_score': 0.57819575}
confusion matrix:
       0    1
0  41759  599
1    612  830
---- Validation: 
scalar performance:
{'acc': 0.97230524, 'precision': 0.8220353, 'recall': 0.7274253, 'specificity': 0.7274253, 'f1': 0.7658244, 'auroc': 0.9458316, 'binary_precision': 0.6638298, 'binary_recall': 0.46359584, 'binary_specificity': 0.99125475, 'binary_f1_score': 0.54593176}
confusion matrix:
       0    1
0  17909  158
1    361  312
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9655172, 'precision': 0.962781, 'recall': 0.59213954, 'specificity': 0.59213954, 'f1': 0.64599717, 'auroc': 0.8925724, 'binary_precision': 0.96, 'binary_recall': 0.18461539, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.30967742}
confusion matrix:
      0   1
0  5944   2
1   212  48
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329046_20.png
early stop counter: 11
val acc:0.9723052382469177, best validation acc: 0.9726253747940063, corresponding to test acc:                         0.9603609442710876 / 0.9708346724510193
after epoch: 20,now: 2024-06-17 14:55:02.416058,epoch time: 0:16:19.682926,used: 5:05:42.803731,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_49_19_seed_1_21329046
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9736758, 'precision': 0.81946814, 'recall': 0.7038356, 'specificity': 0.7038356, 'f1': 0.74781406, 'auroc': 0.9521243, 'binary_precision': 0.6585903, 'binary_recall': 0.4149896, 'binary_specificity': 0.9926816, 'binary_f1_score': 0.5091528}
confusion matrix:
       0    1
0  42049  310
1    843  598
---- Validation: 
scalar performance:
{'acc': 0.9716649, 'precision': 0.8420879, 'recall': 0.6770245, 'specificity': 0.6770245, 'f1': 0.73114264, 'auroc': 0.9448143, 'binary_precision': 0.7076023, 'binary_recall': 0.35958394, 'binary_specificity': 0.99446505, 'binary_f1_score': 0.47684726}
confusion matrix:
       0    1
0  17967  100
1    431  242
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96036094, 'precision': 0.94896, 'recall': 0.52876204, 'specificity': 0.52876204, 'f1': 0.5442127, 'auroc': 0.8846241, 'binary_precision': 0.9375, 'binary_recall': 0.057692308, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.108695656}
confusion matrix:
      0   1
0  5945   1
1   245  15
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329046_21.png
early stop counter: 12
val acc:0.9716649055480957, best validation acc: 0.9726253747940063, corresponding to test acc:                         0.9603609442710876 / 0.9708346724510193
after epoch: 21,now: 2024-06-17 15:11:41.813498,epoch time: 0:16:39.397440,used: 5:22:22.201171,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_49_19_seed_1_21329046
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.97321916, 'precision': 0.7941516, 'recall': 0.7642666, 'specificity': 0.7642666, 'f1': 0.7783328, 'auroc': 0.9523914, 'binary_precision': 0.603876, 'binary_recall': 0.5405968, 'binary_specificity': 0.98793644, 'binary_f1_score': 0.57048696}
confusion matrix:
       0    1
0  41848  511
1    662  779
---- Validation: 
scalar performance:
{'acc': 0.97187835, 'precision': 0.8243703, 'recall': 0.71003747, 'specificity': 0.71003747, 'f1': 0.7538625, 'auroc': 0.9447881, 'binary_precision': 0.66976744, 'binary_recall': 0.42793462, 'binary_specificity': 0.99214035, 'binary_f1_score': 0.5222122}
confusion matrix:
       0    1
0  17925  142
1    385  288
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.962778, 'precision': 0.9652475, 'recall': 0.5576082, 'specificity': 0.5576082, 'f1': 0.59356385, 'auroc': 0.8902871, 'binary_precision': 0.9677419, 'binary_recall': 0.115384616, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.20618556}
confusion matrix:
      0   1
0  5945   1
1   230  30
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329046_22.png
early stop counter: 13
val acc:0.9718783497810364, best validation acc: 0.9726253747940063, corresponding to test acc:                         0.9603609442710876 / 0.9708346724510193
after epoch: 22,now: 2024-06-17 15:28:17.582515,epoch time: 0:16:35.769017,used: 5:38:57.970188,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_49_19_seed_1_21329046
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9738356, 'precision': 0.8183099, 'recall': 0.7116273, 'specificity': 0.7116273, 'f1': 0.7533258, 'auroc': 0.95016223, 'binary_precision': 0.65575504, 'binary_recall': 0.43095073, 'binary_specificity': 0.9923039, 'binary_f1_score': 0.5201005}
confusion matrix:
       0    1
0  42033  326
1    820  621
---- Validation: 
scalar performance:
{'acc': 0.971238, 'precision': 0.84516215, 'recall': 0.663213, 'specificity': 0.663213, 'f1': 0.71901137, 'auroc': 0.9422496, 'binary_precision': 0.7147436, 'binary_recall': 0.33135214, 'binary_specificity': 0.9950739, 'binary_f1_score': 0.4527919}
confusion matrix:
       0    1
0  17978   89
1    450  223
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95939416, 'precision': 0.9796709, 'recall': 0.5153846, 'specificity': 0.5153846, 'f1': 0.5194752, 'auroc': 0.88249254, 'binary_precision': 1.0, 'binary_recall': 0.03076923, 'binary_specificity': 1.0, 'binary_f1_score': 0.05970149}
confusion matrix:
      0  1
0  5946  0
1   252  8
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329046_23.png
early stop counter: 14
val acc:0.9712380170822144, best validation acc: 0.9726253747940063, corresponding to test acc:                         0.9603609442710876 / 0.9708346724510193
after epoch: 23,now: 2024-06-17 15:44:54.847487,epoch time: 0:16:37.264972,used: 5:55:35.235160,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_49_19_seed_1_21329046
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.973242, 'precision': 0.8080795, 'recall': 0.71447706, 'specificity': 0.71447706, 'f1': 0.75216556, 'auroc': 0.9495765, 'binary_precision': 0.63508064, 'binary_recall': 0.4375, 'binary_specificity': 0.9914542, 'binary_f1_score': 0.5180921}
confusion matrix:
       0    1
0  41998  362
1    810  630
---- Validation: 
scalar performance:
{'acc': 0.9716115, 'precision': 0.83936673, 'recall': 0.6791426, 'specificity': 0.6791426, 'f1': 0.73243, 'auroc': 0.9429167, 'binary_precision': 0.70200574, 'binary_recall': 0.3640416, 'binary_specificity': 0.9942436, 'binary_f1_score': 0.47945207}
confusion matrix:
       0    1
0  17963  104
1    428  245
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589107, 'precision': 0.9080843, 'recall': 0.51145434, 'specificity': 0.51145434, 'f1': 0.5119738, 'auroc': 0.8803295, 'binary_precision': 0.85714287, 'binary_recall': 0.023076924, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.04494382}
confusion matrix:
      0  1
0  5945  1
1   254  6
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329046_24.png
early stop counter: 15
val acc:0.971611499786377, best validation acc: 0.9726253747940063, corresponding to test acc:                         0.9603609442710876 / 0.9708346724510193
after epoch: 24,now: 2024-06-17 16:01:07.527033,epoch time: 0:16:12.679546,used: 6:11:47.914706,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_49_19_seed_1_21329046
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.97331053, 'precision': 0.8026351, 'recall': 0.7327785, 'specificity': 0.7327785, 'f1': 0.7627384, 'auroc': 0.9512178, 'binary_precision': 0.6229508, 'binary_recall': 0.47533008, 'binary_specificity': 0.99022686, 'binary_f1_score': 0.53921956}
confusion matrix:
       0    1
0  41947  414
1    755  684
---- Validation: 
scalar performance:
{'acc': 0.972572, 'precision': 0.82699835, 'recall': 0.7247026, 'specificity': 0.7247026, 'f1': 0.76549625, 'auroc': 0.94257915, 'binary_precision': 0.6739606, 'binary_recall': 0.4576523, 'binary_specificity': 0.9917529, 'binary_f1_score': 0.54513276}
confusion matrix:
       0    1
0  17918  149
1    365  308
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96374476, 'precision': 0.95627886, 'recall': 0.5709857, 'specificity': 0.5709857, 'f1': 0.6144583, 'auroc': 0.88764197, 'binary_precision': 0.94871795, 'binary_recall': 0.1423077, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.24749166}
confusion matrix:
      0   1
0  5944   2
1   223  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329046_25.png
early stop counter: 16
val acc:0.9725720286369324, best validation acc: 0.9726253747940063, corresponding to test acc:                         0.9603609442710876 / 0.9708346724510193
after epoch: 25,now: 2024-06-17 16:17:14.086636,epoch time: 0:16:06.559603,used: 6:27:54.474309,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_49_19_seed_1_21329046
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9719178, 'precision': 0.7784797, 'recall': 0.78557205, 'specificity': 0.78557205, 'f1': 0.7819767, 'auroc': 0.9512018, 'binary_precision': 0.57104194, 'binary_recall': 0.5861111, 'binary_specificity': 0.98503304, 'binary_f1_score': 0.5784784}
confusion matrix:
       0    1
0  41726  634
1    596  844
---- Validation: 
scalar performance:
{'acc': 0.97203845, 'precision': 0.8058278, 'recall': 0.7644808, 'specificity': 0.7644808, 'f1': 0.7835029, 'auroc': 0.94425976, 'binary_precision': 0.6286701, 'binary_recall': 0.5408618, 'binary_specificity': 0.9880999, 'binary_f1_score': 0.58146966}
confusion matrix:
       0    1
0  17852  215
1    309  364
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9629391, 'precision': 0.9658295, 'recall': 0.5595313, 'specificity': 0.5595313, 'f1': 0.59667593, 'auroc': 0.8917161, 'binary_precision': 0.96875, 'binary_recall': 0.11923077, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.21232878}
confusion matrix:
      0   1
0  5945   1
1   229  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329046_26.png
early stop counter: 17
val acc:0.9720384478569031, best validation acc: 0.9726253747940063, corresponding to test acc:                         0.9603609442710876 / 0.9708346724510193
after epoch: 26,now: 2024-06-17 16:32:12.138390,epoch time: 0:14:58.051754,used: 6:42:52.526063,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_49_19_seed_1_21329046
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.973105, 'precision': 0.7951101, 'recall': 0.7541523, 'specificity': 0.7541523, 'f1': 0.7729597, 'auroc': 0.9500222, 'binary_precision': 0.60647774, 'binary_recall': 0.51977795, 'binary_specificity': 0.98852664, 'binary_f1_score': 0.55979073}
confusion matrix:
       0    1
0  41873  486
1    692  749
---- Validation: 
scalar performance:
{'acc': 0.9727321, 'precision': 0.81691706, 'recall': 0.7533963, 'specificity': 0.7533963, 'f1': 0.7812743, 'auroc': 0.94676024, 'binary_precision': 0.6516854, 'binary_recall': 0.51708764, 'binary_specificity': 0.98970497, 'binary_f1_score': 0.57663625}
confusion matrix:
       0    1
0  17881  186
1    325  348
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9643893, 'precision': 0.923711, 'recall': 0.58603394, 'specificity': 0.58603394, 'f1': 0.635563, 'auroc': 0.8921707, 'binary_precision': 0.88235295, 'binary_recall': 0.17307693, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.28938907}
confusion matrix:
      0   1
0  5940   6
1   215  45
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329046_27.png
better model found
persisted
after epoch: 27,now: 2024-06-17 16:47:55.637135,epoch time: 0:15:43.498745,used: 6:58:36.024808,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_49_19_seed_1_21329046
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9736758, 'precision': 0.8255024, 'recall': 0.69134545, 'specificity': 0.69134545, 'f1': 0.73961407, 'auroc': 0.94834733, 'binary_precision': 0.67146283, 'binary_recall': 0.38915914, 'binary_specificity': 0.99353176, 'binary_f1_score': 0.49274087}
confusion matrix:
       0    1
0  42087  274
1    879  560
---- Validation: 
scalar performance:
{'acc': 0.9721985, 'precision': 0.8507969, 'recall': 0.67944705, 'specificity': 0.67944705, 'f1': 0.73519135, 'auroc': 0.94247293, 'binary_precision': 0.7248521, 'binary_recall': 0.3640416, 'binary_specificity': 0.9948525, 'binary_f1_score': 0.48466867}
confusion matrix:
       0    1
0  17974   93
1    428  245
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96036094, 'precision': 0.9801357, 'recall': 0.52692306, 'specificity': 0.52692306, 'f1': 0.54096144, 'auroc': 0.8886155, 'binary_precision': 1.0, 'binary_recall': 0.053846154, 'binary_specificity': 1.0, 'binary_f1_score': 0.10218979}
confusion matrix:
      0   1
0  5946   0
1   246  14
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329046_28.png
early stop counter: 1
val acc:0.972198486328125, best validation acc: 0.9727321267127991, corresponding to test acc:                         0.9643893241882324 / 0.9708346724510193
after epoch: 28,now: 2024-06-17 17:03:13.739424,epoch time: 0:15:18.102289,used: 7:13:54.127097,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_49_19_seed_1_21329046
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.97390413, 'precision': 0.8045515, 'recall': 0.7517154, 'specificity': 0.7517154, 'f1': 0.7753944, 'auroc': 0.95075214, 'binary_precision': 0.62552834, 'binary_recall': 0.5138889, 'binary_specificity': 0.989542, 'binary_f1_score': 0.56423944}
confusion matrix:
       0    1
0  41917  443
1    700  740
---- Validation: 
scalar performance:
{'acc': 0.97363925, 'precision': 0.83781236, 'recall': 0.733124, 'specificity': 0.733124, 'f1': 0.7750067, 'auroc': 0.9447556, 'binary_precision': 0.6949891, 'binary_recall': 0.47399703, 'binary_specificity': 0.99225104, 'binary_f1_score': 0.5636043}
confusion matrix:
       0    1
0  17927  140
1    354  319
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9626168, 'precision': 0.9812237, 'recall': 0.5538462, 'specificity': 0.5538462, 'f1': 0.5876544, 'auroc': 0.88555443, 'binary_precision': 1.0, 'binary_recall': 0.10769231, 'binary_specificity': 1.0, 'binary_f1_score': 0.19444443}
confusion matrix:
      0   1
0  5946   0
1   232  28
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329046_29.png
better model found
persisted
after epoch: 29,now: 2024-06-17 17:19:39.100090,epoch time: 0:16:25.360666,used: 7:30:19.487763,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_49_19_seed_1_21329046
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9734475, 'precision': 0.80670834, 'recall': 0.7277008, 'specificity': 0.7277008, 'f1': 0.76084536, 'auroc': 0.95260894, 'binary_precision': 0.63147974, 'binary_recall': 0.46463245, 'binary_specificity': 0.99076915, 'binary_f1_score': 0.53535753}
confusion matrix:
       0    1
0  41967  391
1    772  670
---- Validation: 
scalar performance:
{'acc': 0.97145146, 'precision': 0.829515, 'recall': 0.6890733, 'specificity': 0.6890733, 'f1': 0.73862046, 'auroc': 0.9415594, 'binary_precision': 0.68157893, 'binary_recall': 0.38484398, 'binary_specificity': 0.9933027, 'binary_f1_score': 0.49192777}
confusion matrix:
       0    1
0  17946  121
1    414  259
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96132773, 'precision': 0.93908393, 'recall': 0.54213953, 'specificity': 0.54213953, 'f1': 0.5675703, 'auroc': 0.89350855, 'binary_precision': 0.9166667, 'binary_recall': 0.08461539, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.15492958}
confusion matrix:
      0   1
0  5944   2
1   238  22
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329046_30.png
early stop counter: 1
val acc:0.971451461315155, best validation acc: 0.9736392498016357, corresponding to test acc:                         0.9626168012619019 / 0.9708346724510193
after epoch: 30,now: 2024-06-17 17:36:13.777214,epoch time: 0:16:34.677124,used: 7:46:54.164887,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_49_19_seed_1_21329046
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 7:46:54.164887 at 2024-06-17 17:36:13.777214
persisted model performance metric: 

scalar performance:
{'acc': 0.9626168, 'precision': 0.9812237, 'recall': 0.5538462, 'specificity': 0.5538462, 'f1': 0.5876544, 'auroc': 0.88555443, 'binary_precision': 1.0, 'binary_recall': 0.10769231, 'binary_specificity': 1.0, 'binary_f1_score': 0.19444443}
confusion matrix:
      0   1
0  5946   0
1   232  28
oracle model performance metric: 

scalar performance:
{'acc': 0.9708347, 'precision': 0.9733348, 'recall': 0.655601, 'specificity': 0.655601, 'f1': 0.7286531, 'auroc': 0.8932409, 'binary_precision': 0.97590363, 'binary_recall': 0.31153846, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.4723032}
confusion matrix:
      0   1
0  5944   2
1   179  81
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre3/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre3/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204178 KiB |   1436 MiB |    790 TiB |    790 TiB |
|       from large pool | 167936 KiB |   1366 MiB |    790 TiB |    790 TiB |
|       from small pool |  36242 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 204178 KiB |   1436 MiB |    790 TiB |    790 TiB |
|       from large pool | 167936 KiB |   1366 MiB |    790 TiB |    790 TiB |
|       from small pool |  36242 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201086 KiB |   1428 MiB |    790 TiB |    790 TiB |
|       from large pool | 165120 KiB |   1358 MiB |    790 TiB |    790 TiB |
|       from small pool |  35966 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1466 MiB |   1524 MiB |   2478 MiB |   1012 MiB |
|       from large pool |   1392 MiB |   1450 MiB |   2374 MiB |    982 MiB |
|       from small pool |     74 MiB |     74 MiB |    104 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 320109 KiB | 749313 KiB | 617913 GiB | 617913 GiB |
|       from large pool | 311296 KiB | 748328 KiB | 617753 GiB | 617753 GiB |
|       from small pool |   8813 KiB |  16408 KiB |    160 GiB |    160 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1278    |    1935    |   26696 K  |   26695 K  |
|       from large pool |      36    |      76    |   10623 K  |   10623 K  |
|       from small pool |    1242    |    1864    |   16072 K  |   16071 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1278    |    1935    |   26696 K  |   26695 K  |
|       from large pool |      36    |      76    |   10623 K  |   10623 K  |
|       from small pool |    1242    |    1864    |   16072 K  |   16071 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      49    |      50    |      68    |      19    |
|       from large pool |      12    |      13    |      16    |       4    |
|       from small pool |      37    |      37    |      52    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      38    |     453    |   15169 K  |   15169 K  |
|       from large pool |       5    |      11    |    4127 K  |    4127 K  |
|       from small pool |      33    |     448    |   11042 K  |   11042 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1436 MiB |    790 TiB |    790 TiB |
|       from large pool |  16640 KiB |   1366 MiB |    790 TiB |    790 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1436 MiB |    790 TiB |    790 TiB |
|       from large pool |  16640 KiB |   1366 MiB |    790 TiB |    790 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1428 MiB |    790 TiB |    790 TiB |
|       from large pool |  16640 KiB |   1358 MiB |    790 TiB |    790 TiB |
|       from small pool |      0 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 524288 KiB |   1524 MiB |   2478 MiB |   1966 MiB |
|       from large pool | 479232 KiB |   1450 MiB |   2374 MiB |   1906 MiB |
|       from small pool |  45056 KiB |     74 MiB |    104 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 298752 KiB | 749313 KiB | 617913 GiB | 617913 GiB |
|       from large pool | 298752 KiB | 748328 KiB | 617753 GiB | 617753 GiB |
|       from small pool |      0 KiB |  16408 KiB |    160 GiB |    160 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1935    |   26696 K  |   26696 K  |
|       from large pool |       2    |      76    |   10623 K  |   10623 K  |
|       from small pool |       0    |    1864    |   16072 K  |   16072 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1935    |   26696 K  |   26696 K  |
|       from large pool |       2    |      76    |   10623 K  |   10623 K  |
|       from small pool |       0    |    1864    |   16072 K  |   16072 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      50    |      68    |      37    |
|       from large pool |       9    |      13    |      16    |       7    |
|       from small pool |      22    |      37    |      52    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     453    |   15170 K  |   15170 K  |
|       from large pool |       1    |      11    |    4127 K  |    4127 K  |
|       from small pool |       0    |     448    |   11042 K  |   11042 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1436 MiB |    790 TiB |    790 TiB |
|       from large pool |  16640 KiB |   1366 MiB |    790 TiB |    790 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1436 MiB |    790 TiB |    790 TiB |
|       from large pool |  16640 KiB |   1366 MiB |    790 TiB |    790 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1428 MiB |    790 TiB |    790 TiB |
|       from large pool |  16640 KiB |   1358 MiB |    790 TiB |    790 TiB |
|       from small pool |      0 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 524288 KiB |   1524 MiB |   2478 MiB |   1966 MiB |
|       from large pool | 479232 KiB |   1450 MiB |   2374 MiB |   1906 MiB |
|       from small pool |  45056 KiB |     74 MiB |    104 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 298752 KiB | 749313 KiB | 617913 GiB | 617913 GiB |
|       from large pool | 298752 KiB | 748328 KiB | 617753 GiB | 617753 GiB |
|       from small pool |      0 KiB |  16408 KiB |    160 GiB |    160 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1935    |   26696 K  |   26696 K  |
|       from large pool |       2    |      76    |   10623 K  |   10623 K  |
|       from small pool |       0    |    1864    |   16072 K  |   16072 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1935    |   26696 K  |   26696 K  |
|       from large pool |       2    |      76    |   10623 K  |   10623 K  |
|       from small pool |       0    |    1864    |   16072 K  |   16072 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      50    |      68    |      37    |
|       from large pool |       9    |      13    |      16    |       7    |
|       from small pool |      22    |      37    |      52    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     453    |   15170 K  |   15170 K  |
|       from large pool |       1    |      11    |    4127 K  |    4127 K  |
|       from small pool |       0    |     448    |   11042 K  |   11042 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0




!!!: not committed yet



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_17_44_17_seed_2_21329046

 Experiment start at: 2024-06-17 17:44:17.530988
before training, model accuracy: 0.0544959120452404
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96666664, 'precision': 0.7505912, 'recall': 0.69352764, 'specificity': 0.69352764, 'f1': 0.7179965, 'auroc': 0.9273143, 'binary_precision': 0.52245253, 'binary_recall': 0.40013227, 'binary_specificity': 0.986923, 'binary_f1_score': 0.45318353}
confusion matrix:
       0    1
0  41735  553
1    907  605
---- Validation: 
scalar performance:
{'acc': 0.9677196, 'precision': 0.7374356, 'recall': 0.67896974, 'specificity': 0.67896974, 'f1': 0.70367444, 'auroc': 0.92290235, 'binary_precision': 0.49555555, 'binary_recall': 0.3704319, 'binary_specificity': 0.9875076, 'binary_f1_score': 0.42395437}
confusion matrix:
       0    1
0  17944  227
1    379  223
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97627825, 'precision': 0.95609367, 'recall': 0.70809406, 'specificity': 0.70809406, 'f1': 0.78246987, 'auroc': 0.89553267, 'binary_precision': 0.9351852, 'binary_recall': 0.41735536, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.5771429}
confusion matrix:
      0    1
0  5990    7
1   141  101
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329046_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-17 18:00:16.739425,epoch time: 0:15:59.208437,used: 0:15:59.208437,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_17_44_17_seed_2_21329046
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96847034, 'precision': 0.77314687, 'recall': 0.6710749, 'specificity': 0.6710749, 'f1': 0.7092472, 'auroc': 0.935887, 'binary_precision': 0.56913185, 'binary_recall': 0.35165563, 'binary_specificity': 0.9904942, 'binary_f1_score': 0.43471143}
confusion matrix:
       0    1
0  41888  402
1    979  531
---- Validation: 
scalar performance:
{'acc': 0.9699569, 'precision': 0.8050493, 'recall': 0.57171386, 'specificity': 0.57171386, 'f1': 0.61125714, 'auroc': 0.92345643, 'binary_precision': 0.6376812, 'binary_recall': 0.14617941, 'binary_specificity': 0.99724835, 'binary_f1_score': 0.23783787}
confusion matrix:
       0   1
0  18121  50
1    514  88
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9634557, 'precision': 0.9816867, 'recall': 0.5289256, 'specificity': 0.5289256, 'f1': 0.5453601, 'auroc': 0.8699448, 'binary_precision': 1.0, 'binary_recall': 0.05785124, 'binary_specificity': 1.0, 'binary_f1_score': 0.10937501}
confusion matrix:
      0   1
0  5997   0
1   228  14
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329046_2.png
better model found
persisted
after epoch: 2,now: 2024-06-17 18:16:49.167889,epoch time: 0:16:32.428464,used: 0:32:31.636901,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_17_44_17_seed_2_21329046
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9699543, 'precision': 0.7958649, 'recall': 0.67057407, 'specificity': 0.67057407, 'f1': 0.7148765, 'auroc': 0.94174147, 'binary_precision': 0.6146682, 'binary_recall': 0.34897554, 'binary_specificity': 0.99217254, 'binary_f1_score': 0.44519392}
confusion matrix:
       0    1
0  41956  331
1    985  528
---- Validation: 
scalar performance:
{'acc': 0.97048956, 'precision': 0.80654234, 'recall': 0.5896561, 'specificity': 0.5896561, 'f1': 0.634586, 'auroc': 0.93124723, 'binary_precision': 0.6395349, 'binary_recall': 0.18272425, 'binary_specificity': 0.996588, 'binary_f1_score': 0.28423774}
confusion matrix:
       0    1
0  18109   62
1    492  110
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96297485, 'precision': 0.98145473, 'recall': 0.52272725, 'specificity': 0.52272725, 'f1': 0.53403044, 'auroc': 0.8793386, 'binary_precision': 1.0, 'binary_recall': 0.045454547, 'binary_specificity': 1.0, 'binary_f1_score': 0.08695653}
confusion matrix:
      0   1
0  5997   0
1   231  11
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329046_3.png
better model found
persisted
after epoch: 3,now: 2024-06-17 18:38:25.240414,epoch time: 0:21:36.072525,used: 0:54:07.709426,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_17_44_17_seed_2_21329046
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96899545, 'precision': 0.76711106, 'recall': 0.77221763, 'specificity': 0.77221763, 'f1': 0.7696375, 'auroc': 0.9487618, 'binary_precision': 0.54993516, 'binary_recall': 0.56084657, 'binary_specificity': 0.9835887, 'binary_f1_score': 0.5553373}
confusion matrix:
       0    1
0  41594  694
1    664  848
---- Validation: 
scalar performance:
{'acc': 0.9709157, 'precision': 0.76832175, 'recall': 0.73281884, 'specificity': 0.73281884, 'f1': 0.74918944, 'auroc': 0.9393847, 'binary_precision': 0.5538462, 'binary_recall': 0.47840533, 'binary_specificity': 0.9872324, 'binary_f1_score': 0.513369}
confusion matrix:
       0    1
0  17939  232
1    314  288
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9713095, 'precision': 0.97073567, 'recall': 0.6341308, 'specificity': 0.6341308, 'f1': 0.70300126, 'auroc': 0.8910166, 'binary_precision': 0.9701493, 'binary_recall': 0.26859504, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.420712}
confusion matrix:
      0   1
0  5995   2
1   177  65
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329046_4.png
better model found
persisted
after epoch: 4,now: 2024-06-17 19:00:04.069127,epoch time: 0:21:38.828713,used: 1:15:46.538139,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_17_44_17_seed_2_21329046
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.970274, 'precision': 0.8029446, 'recall': 0.66627854, 'specificity': 0.66627854, 'f1': 0.71296626, 'auroc': 0.9448341, 'binary_precision': 0.62913096, 'binary_recall': 0.3397224, 'binary_specificity': 0.9928347, 'binary_f1_score': 0.4412017}
confusion matrix:
       0    1
0  41984  303
1    999  514
---- Validation: 
scalar performance:
{'acc': 0.9712353, 'precision': 0.784711, 'recall': 0.6631187, 'specificity': 0.6631187, 'f1': 0.70599955, 'auroc': 0.9394429, 'binary_precision': 0.59117645, 'binary_recall': 0.33388704, 'binary_specificity': 0.99235046, 'binary_f1_score': 0.42675158}
confusion matrix:
       0    1
0  18032  139
1    401  201
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9692258, 'precision': 0.9844886, 'recall': 0.6033058, 'specificity': 0.6033058, 'f1': 0.663355, 'auroc': 0.88537884, 'binary_precision': 1.0, 'binary_recall': 0.20661157, 'binary_specificity': 1.0, 'binary_f1_score': 0.34246573}
confusion matrix:
      0   1
0  5997   0
1   192  50
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329046_5.png
better model found
persisted
after epoch: 5,now: 2024-06-17 19:15:58.872093,epoch time: 0:15:54.802966,used: 1:31:41.341105,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_17_44_17_seed_2_21329046
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9710959, 'precision': 0.8260445, 'recall': 0.65341246, 'specificity': 0.65341246, 'f1': 0.70616156, 'auroc': 0.9492283, 'binary_precision': 0.6762178, 'binary_recall': 0.3121693, 'binary_specificity': 0.99465567, 'binary_f1_score': 0.42714933}
confusion matrix:
       0    1
0  42062  226
1   1040  472
---- Validation: 
scalar performance:
{'acc': 0.97160816, 'precision': 0.817839, 'recall': 0.6159315, 'specificity': 0.6159315, 'f1': 0.66655076, 'auroc': 0.9370686, 'binary_precision': 0.6604651, 'binary_recall': 0.2358804, 'binary_specificity': 0.9959826, 'binary_f1_score': 0.34761322}
confusion matrix:
       0    1
0  18098   73
1    460  142
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645777, 'precision': 0.982229, 'recall': 0.5433884, 'specificity': 0.5433884, 'f1': 0.5708017, 'auroc': 0.8839675, 'binary_precision': 1.0, 'binary_recall': 0.08677686, 'binary_specificity': 1.0, 'binary_f1_score': 0.15969582}
confusion matrix:
      0   1
0  5997   0
1   221  21
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329046_6.png
better model found
persisted
after epoch: 6,now: 2024-06-17 19:37:32.295181,epoch time: 0:21:33.423088,used: 1:53:14.764193,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_17_44_17_seed_2_21329046
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.971484, 'precision': 0.81896305, 'recall': 0.67508364, 'specificity': 0.67508364, 'f1': 0.72430515, 'auroc': 0.9468596, 'binary_precision': 0.6605392, 'binary_recall': 0.3567174, 'binary_specificity': 0.9934498, 'binary_f1_score': 0.4632574}
confusion matrix:
       0    1
0  42012  277
1    972  539
---- Validation: 
scalar performance:
{'acc': 0.97208756, 'precision': 0.81995547, 'recall': 0.6290279, 'specificity': 0.6290279, 'f1': 0.68095744, 'auroc': 0.9403765, 'binary_precision': 0.66386557, 'binary_recall': 0.26245847, 'binary_specificity': 0.99559736, 'binary_f1_score': 0.3761905}
confusion matrix:
       0    1
0  18091   80
1    444  158
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9685847, 'precision': 0.97383463, 'recall': 0.5970241, 'specificity': 0.5970241, 'f1': 0.65402824, 'auroc': 0.8929399, 'binary_precision': 0.9791667, 'binary_recall': 0.19421488, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.32413793}
confusion matrix:
      0   1
0  5996   1
1   195  47
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329046_7.png
better model found
persisted
after epoch: 7,now: 2024-06-17 20:00:54.048297,epoch time: 0:23:21.753116,used: 2:16:36.517309,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_17_44_17_seed_2_21329046
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9715753, 'precision': 0.81967, 'recall': 0.6772567, 'specificity': 0.6772567, 'f1': 0.72633195, 'auroc': 0.9498774, 'binary_precision': 0.6618182, 'binary_recall': 0.3611111, 'binary_specificity': 0.99340236, 'binary_f1_score': 0.46726573}
confusion matrix:
       0    1
0  42009  279
1    966  546
---- Validation: 
scalar performance:
{'acc': 0.97262025, 'precision': 0.81621486, 'recall': 0.6517885, 'specificity': 0.6517885, 'f1': 0.7029219, 'auroc': 0.9406636, 'binary_precision': 0.6549296, 'binary_recall': 0.3089701, 'binary_specificity': 0.9946068, 'binary_f1_score': 0.41986457}
confusion matrix:
       0    1
0  18073   98
1    416  186
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9639365, 'precision': 0.95567775, 'recall': 0.5371067, 'specificity': 0.5371067, 'f1': 0.55975705, 'auroc': 0.88705266, 'binary_precision': 0.94736844, 'binary_recall': 0.07438017, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.13793103}
confusion matrix:
      0   1
0  5996   1
1   224  18
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329046_8.png
better model found
persisted
after epoch: 8,now: 2024-06-17 20:21:17.756228,epoch time: 0:20:23.707931,used: 2:37:00.225240,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_17_44_17_seed_2_21329046
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.97084475, 'precision': 0.8112253, 'recall': 0.6683709, 'specificity': 0.6683709, 'f1': 0.7167034, 'auroc': 0.9494326, 'binary_precision': 0.6455224, 'binary_recall': 0.34348112, 'binary_specificity': 0.9932607, 'binary_f1_score': 0.4483801}
confusion matrix:
       0    1
0  42004  285
1    992  519
---- Validation: 
scalar performance:
{'acc': 0.97251374, 'precision': 0.8401523, 'recall': 0.6212176, 'specificity': 0.6212176, 'f1': 0.67524254, 'auroc': 0.93706787, 'binary_precision': 0.7047619, 'binary_recall': 0.24584718, 'binary_specificity': 0.996588, 'binary_f1_score': 0.36453202}
confusion matrix:
       0    1
0  18109   62
1    454  148
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96297485, 'precision': 0.98145473, 'recall': 0.52272725, 'specificity': 0.52272725, 'f1': 0.53403044, 'auroc': 0.8824781, 'binary_precision': 1.0, 'binary_recall': 0.045454547, 'binary_specificity': 1.0, 'binary_f1_score': 0.08695653}
confusion matrix:
      0   1
0  5997   0
1   231  11
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329046_9.png
early stop counter: 1
val acc:0.972513735294342, best validation acc: 0.9726202487945557, corresponding to test acc:                         0.9639365077018738 / 0.9762782454490662
after epoch: 9,now: 2024-06-17 20:37:16.299132,epoch time: 0:15:58.542904,used: 2:52:58.768144,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_17_44_17_seed_2_21329046
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.97159815, 'precision': 0.7864967, 'recall': 0.78905547, 'specificity': 0.78905547, 'f1': 0.7877698, 'auroc': 0.94873726, 'binary_precision': 0.587541, 'binary_recall': 0.5929848, 'binary_specificity': 0.98512614, 'binary_f1_score': 0.5902503}
confusion matrix:
       0    1
0  41660  629
1    615  896
---- Validation: 
scalar performance:
{'acc': 0.97272676, 'precision': 0.7941179, 'recall': 0.7072538, 'specificity': 0.7072538, 'f1': 0.7425017, 'auroc': 0.9417279, 'binary_precision': 0.60714287, 'binary_recall': 0.42358804, 'binary_specificity': 0.9909196, 'binary_f1_score': 0.4990215}
confusion matrix:
       0    1
0  18006  165
1    347  255
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96970665, 'precision': 0.95952773, 'recall': 0.61545235, 'specificity': 0.61545235, 'f1': 0.67828596, 'auroc': 0.8874487, 'binary_precision': 0.9491525, 'binary_recall': 0.23140496, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.37209302}
confusion matrix:
      0   1
0  5994   3
1   186  56
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329046_10.png
better model found
persisted
after epoch: 10,now: 2024-06-17 20:58:50.438447,epoch time: 0:21:34.139315,used: 3:14:32.907459,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_17_44_17_seed_2_21329046
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.97269404, 'precision': 0.8154448, 'recall': 0.7223389, 'specificity': 0.7223389, 'f1': 0.7601013, 'auroc': 0.95394266, 'binary_precision': 0.65023696, 'binary_recall': 0.45340383, 'binary_specificity': 0.99127394, 'binary_f1_score': 0.5342679}
confusion matrix:
       0    1
0  41918  369
1    827  686
---- Validation: 
scalar performance:
{'acc': 0.97230065, 'precision': 0.79659843, 'recall': 0.67973006, 'specificity': 0.67973006, 'f1': 0.7226228, 'auroc': 0.94273955, 'binary_precision': 0.61388886, 'binary_recall': 0.36710963, 'binary_specificity': 0.99235046, 'binary_f1_score': 0.45945942}
confusion matrix:
       0    1
0  18032  139
1    381  221
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9661805, 'precision': 0.9545846, 'recall': 0.5680151, 'specificity': 0.5680151, 'f1': 0.61048675, 'auroc': 0.887913, 'binary_precision': 0.94285715, 'binary_recall': 0.13636364, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.23826717}
confusion matrix:
      0   1
0  5995   2
1   209  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329046_11.png
early stop counter: 1
val acc:0.97230064868927, best validation acc: 0.9727267622947693, corresponding to test acc:                         0.969706654548645 / 0.9762782454490662
after epoch: 11,now: 2024-06-17 21:21:06.278288,epoch time: 0:22:15.839841,used: 3:36:48.747300,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_17_44_17_seed_2_21329046
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9726712, 'precision': 0.81526744, 'recall': 0.7220084, 'specificity': 0.7220084, 'f1': 0.75981003, 'auroc': 0.9515385, 'binary_precision': 0.64990515, 'binary_recall': 0.4527429, 'binary_specificity': 0.99127394, 'binary_f1_score': 0.53369695}
confusion matrix:
       0    1
0  41918  369
1    828  685
---- Validation: 
scalar performance:
{'acc': 0.97246045, 'precision': 0.801427, 'recall': 0.67419124, 'specificity': 0.67419124, 'f1': 0.71939236, 'auroc': 0.9411447, 'binary_precision': 0.62390673, 'binary_recall': 0.3554817, 'binary_specificity': 0.9929008, 'binary_f1_score': 0.45291004}
confusion matrix:
       0    1
0  18042  129
1    388  214
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96473795, 'precision': 0.961548, 'recall': 0.54743725, 'specificity': 0.54743725, 'f1': 0.5774586, 'auroc': 0.87861943, 'binary_precision': 0.9583333, 'binary_recall': 0.09504132, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.17293233}
confusion matrix:
      0   1
0  5996   1
1   219  23
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329046_12.png
early stop counter: 2
val acc:0.9724604487419128, best validation acc: 0.9727267622947693, corresponding to test acc:                         0.969706654548645 / 0.9762782454490662
after epoch: 12,now: 2024-06-17 21:44:27.513105,epoch time: 0:23:21.234817,used: 4:00:09.982117,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_17_44_17_seed_2_21329046
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.97164387, 'precision': 0.8259144, 'recall': 0.6698558, 'specificity': 0.6698558, 'f1': 0.7213048, 'auroc': 0.9518104, 'binary_precision': 0.6748387, 'binary_recall': 0.34567085, 'binary_specificity': 0.9940407, 'binary_f1_score': 0.45716783}
confusion matrix:
       0    1
0  42035  252
1    990  523
---- Validation: 
scalar performance:
{'acc': 0.97214085, 'precision': 0.8264087, 'recall': 0.6234341, 'specificity': 0.6234341, 'f1': 0.67590904, 'auroc': 0.93908644, 'binary_precision': 0.67713004, 'binary_recall': 0.25083056, 'binary_specificity': 0.99603766, 'binary_f1_score': 0.36606058}
confusion matrix:
       0    1
0  18099   72
1    451  151
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9626543, 'precision': 0.9813002, 'recall': 0.51859504, 'specificity': 0.51859504, 'f1': 0.52632844, 'auroc': 0.8790532, 'binary_precision': 1.0, 'binary_recall': 0.037190083, 'binary_specificity': 1.0, 'binary_f1_score': 0.07171315}
confusion matrix:
      0  1
0  5997  0
1   233  9
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329046_13.png
early stop counter: 3
val acc:0.9721408486366272, best validation acc: 0.9727267622947693, corresponding to test acc:                         0.969706654548645 / 0.9762782454490662
after epoch: 13,now: 2024-06-17 22:07:18.466139,epoch time: 0:22:50.953034,used: 4:23:00.935151,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_17_44_17_seed_2_21329046
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9716895, 'precision': 0.78694415, 'recall': 0.7913363, 'specificity': 0.7913363, 'f1': 0.78912175, 'auroc': 0.9521034, 'binary_precision': 0.58827364, 'binary_recall': 0.59761745, 'binary_specificity': 0.9850552, 'binary_f1_score': 0.5929087}
confusion matrix:
       0    1
0  41657  632
1    608  903
---- Validation: 
scalar performance:
{'acc': 0.97256696, 'precision': 0.78573704, 'recall': 0.7344749, 'specificity': 0.7344749, 'f1': 0.75734603, 'auroc': 0.941542, 'binary_precision': 0.5885947, 'binary_recall': 0.48006645, 'binary_specificity': 0.9888834, 'binary_f1_score': 0.52881974}
confusion matrix:
       0    1
0  17969  202
1    313  289
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9709889, 'precision': 0.9701191, 'recall': 0.62999856, 'specificity': 0.62999856, 'f1': 0.697776, 'auroc': 0.887623, 'binary_precision': 0.9692308, 'binary_recall': 0.2603306, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.41042346}
confusion matrix:
      0   1
0  5995   2
1   179  63
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329046_14.png
early stop counter: 4
val acc:0.9725669622421265, best validation acc: 0.9727267622947693, corresponding to test acc:                         0.969706654548645 / 0.9762782454490662
after epoch: 14,now: 2024-06-17 22:26:49.482569,epoch time: 0:19:31.016430,used: 4:42:31.951581,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_17_44_17_seed_2_21329046
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9726484, 'precision': 0.81750643, 'recall': 0.7154384, 'specificity': 0.7154384, 'f1': 0.7558253, 'auroc': 0.9521129, 'binary_precision': 0.65483236, 'binary_recall': 0.43915343, 'binary_specificity': 0.9917234, 'binary_f1_score': 0.5257324}
confusion matrix:
       0    1
0  41938  350
1    848  664
---- Validation: 
scalar performance:
{'acc': 0.97325945, 'precision': 0.8224526, 'recall': 0.6633613, 'specificity': 0.6633613, 'f1': 0.7148798, 'auroc': 0.940573, 'binary_precision': 0.6666667, 'binary_recall': 0.33222592, 'binary_specificity': 0.9944967, 'binary_f1_score': 0.44345897}
confusion matrix:
       0    1
0  18071  100
1    402  200
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96185285, 'precision': 0.98091424, 'recall': 0.5082645, 'specificity': 0.5082645, 'f1': 0.5065316, 'auroc': 0.854774, 'binary_precision': 1.0, 'binary_recall': 0.016528925, 'binary_specificity': 1.0, 'binary_f1_score': 0.032520324}
confusion matrix:
      0  1
0  5997  0
1   238  4
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329046_15.png
better model found
persisted
after epoch: 15,now: 2024-06-17 22:48:03.975617,epoch time: 0:21:14.493048,used: 5:03:46.444629,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_17_44_17_seed_2_21329046
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9711644, 'precision': 0.783597, 'recall': 0.78450114, 'specificity': 0.78450114, 'f1': 0.78404826, 'auroc': 0.9527128, 'binary_precision': 0.5820699, 'binary_recall': 0.5839947, 'binary_specificity': 0.9850076, 'binary_f1_score': 0.5830307}
confusion matrix:
       0    1
0  41654  634
1    629  883
---- Validation: 
scalar performance:
{'acc': 0.97357905, 'precision': 0.79338706, 'recall': 0.7526648, 'specificity': 0.7526648, 'f1': 0.7713673, 'auroc': 0.94365907, 'binary_precision': 0.60271317, 'binary_recall': 0.5166113, 'binary_specificity': 0.9887183, 'binary_f1_score': 0.5563506}
confusion matrix:
       0    1
0  17966  205
1    291  311
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9661805, 'precision': 0.98300576, 'recall': 0.5640496, 'specificity': 0.5640496, 'f1': 0.6049091, 'auroc': 0.86617935, 'binary_precision': 1.0, 'binary_recall': 0.12809917, 'binary_specificity': 1.0, 'binary_f1_score': 0.22710621}
confusion matrix:
      0   1
0  5997   0
1   211  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329046_16.png
better model found
persisted
after epoch: 16,now: 2024-06-17 23:03:36.648360,epoch time: 0:15:32.672743,used: 5:19:19.117372,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_17_44_17_seed_2_21329046
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9725799, 'precision': 0.8283361, 'recall': 0.69296443, 'specificity': 0.69296443, 'f1': 0.74159235, 'auroc': 0.9531232, 'binary_precision': 0.67808217, 'binary_recall': 0.3925975, 'binary_specificity': 0.9933313, 'binary_f1_score': 0.4972792}
confusion matrix:
       0    1
0  42005  282
1    919  594
---- Validation: 
scalar performance:
{'acc': 0.97283334, 'precision': 0.81616634, 'recall': 0.6591259, 'specificity': 0.6591259, 'f1': 0.7097082, 'auroc': 0.9409739, 'binary_precision': 0.65436244, 'binary_recall': 0.32392028, 'binary_specificity': 0.9943316, 'binary_f1_score': 0.43333337}
confusion matrix:
       0    1
0  18068  103
1    407  195
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9626543, 'precision': 0.9813002, 'recall': 0.51859504, 'specificity': 0.51859504, 'f1': 0.52632844, 'auroc': 0.86897665, 'binary_precision': 1.0, 'binary_recall': 0.037190083, 'binary_specificity': 1.0, 'binary_f1_score': 0.07171315}
confusion matrix:
      0  1
0  5997  0
1   233  9
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329046_17.png
early stop counter: 1
val acc:0.9728333353996277, best validation acc: 0.9735790491104126, corresponding to test acc:                         0.9661805033683777 / 0.9762782454490662
after epoch: 17,now: 2024-06-17 23:23:15.011080,epoch time: 0:19:38.362720,used: 5:38:57.480092,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_17_44_17_seed_2_21329046
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9726027, 'precision': 0.8103834, 'recall': 0.7311834, 'specificity': 0.7311834, 'f1': 0.7644546, 'auroc': 0.9543558, 'binary_precision': 0.6394619, 'binary_recall': 0.47187293, 'binary_specificity': 0.99049395, 'binary_f1_score': 0.5430312}
confusion matrix:
       0    1
0  41887  402
1    798  713
---- Validation: 
scalar performance:
{'acc': 0.9740585, 'precision': 0.8185313, 'recall': 0.696699, 'specificity': 0.696699, 'f1': 0.7420528, 'auroc': 0.9404888, 'binary_precision': 0.65667576, 'binary_recall': 0.4003322, 'binary_specificity': 0.9930659, 'binary_f1_score': 0.49741998}
confusion matrix:
       0    1
0  18045  126
1    361  241
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9632954, 'precision': 0.98160934, 'recall': 0.5268595, 'specificity': 0.5268595, 'f1': 0.5416128, 'auroc': 0.8702692, 'binary_precision': 1.0, 'binary_recall': 0.053719006, 'binary_specificity': 1.0, 'binary_f1_score': 0.10196078}
confusion matrix:
      0   1
0  5997   0
1   229  13
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329046_18.png
better model found
persisted
after epoch: 18,now: 2024-06-17 23:44:42.151327,epoch time: 0:21:27.140247,used: 6:00:24.620339,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_17_44_17_seed_2_21329046
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.97269404, 'precision': 0.81185687, 'recall': 0.7315796, 'specificity': 0.7315796, 'f1': 0.76523983, 'auroc': 0.95582193, 'binary_precision': 0.6424079, 'binary_recall': 0.47257105, 'binary_specificity': 0.9905881, 'binary_f1_score': 0.5445545}
confusion matrix:
       0    1
0  41889  398
1    798  715
---- Validation: 
scalar performance:
{'acc': 0.97357905, 'precision': 0.8083203, 'recall': 0.70207274, 'specificity': 0.70207274, 'f1': 0.74321556, 'auroc': 0.9420217, 'binary_precision': 0.63589746, 'binary_recall': 0.41196012, 'binary_specificity': 0.99218535, 'binary_f1_score': 0.50000006}
confusion matrix:
       0    1
0  18029  142
1    354  248
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9644174, 'precision': 0.94063425, 'recall': 0.5452878, 'specificity': 0.5452878, 'f1': 0.57361734, 'auroc': 0.8749485, 'binary_precision': 0.9166667, 'binary_recall': 0.09090909, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.16541354}
confusion matrix:
      0   1
0  5995   2
1   220  22
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329046_19.png
early stop counter: 1
val acc:0.9735790491104126, best validation acc: 0.9740585088729858, corresponding to test acc:                         0.9632954001426697 / 0.9762782454490662
after epoch: 19,now: 2024-06-18 00:02:14.967453,epoch time: 0:17:32.816126,used: 6:17:57.436465,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_17_44_17_seed_2_21329046
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9717352, 'precision': 0.8382302, 'recall': 0.65543056, 'specificity': 0.65543056, 'f1': 0.71036196, 'auroc': 0.95391273, 'binary_precision': 0.7004405, 'binary_recall': 0.31568497, 'binary_specificity': 0.9951761, 'binary_f1_score': 0.43521902}
confusion matrix:
       0    1
0  42085  204
1   1034  477
---- Validation: 
scalar performance:
{'acc': 0.97214085, 'precision': 0.8464224, 'recall': 0.60657007, 'specificity': 0.60657007, 'f1': 0.6589149, 'auroc': 0.9376014, 'binary_precision': 0.71823204, 'binary_recall': 0.21594684, 'binary_specificity': 0.99719334, 'binary_f1_score': 0.3320562}
confusion matrix:
       0    1
0  18120   51
1    472  130
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.8593494, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329046_20.png
