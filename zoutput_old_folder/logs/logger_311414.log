Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0




!!!: not committed yet



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324357

 Experiment start at: 2024-06-14 13:05:43.807109
before training, model accuracy: 0.3101629912853241
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96627235, 'precision': 0.63708013, 'recall': 0.50125235, 'specificity': 0.50125235, 'f1': 0.49411628, 'auroc': 0.85074735, 'binary_precision': 0.30769232, 'binary_recall': 0.0027173914, 'binary_specificity': 0.99978733, 'binary_f1_score': 0.005387205}
confusion matrix:
       0  1
0  42311  9
1   1468  4
---- Validation: 
scalar performance:
{'acc': 0.9657301, 'precision': 0.48289075, 'recall': 0.49997246, 'specificity': 0.49997246, 'f1': 0.4912832, 'auroc': 0.8563018, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9999449, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18148  1
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.97922325, 'recall': 0.5019157, 'specificity': 0.5019157, 'f1': 0.49320802, 'auroc': 0.8504105, 'binary_precision': 1.0, 'binary_recall': 0.0038314175, 'binary_specificity': 1.0, 'binary_f1_score': 0.007633588}
confusion matrix:
      0  1
0  5997  0
1   260  1
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324357_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-14 13:27:11.841601,epoch time: 0:21:28.034492,used: 0:21:28.034492,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324357
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9668204, 'precision': 0.7514215, 'recall': 0.5474577, 'specificity': 0.5474577, 'f1': 0.57424796, 'auroc': 0.89279556, 'binary_precision': 0.53333336, 'binary_recall': 0.09789259, 'binary_specificity': 0.99702275, 'binary_f1_score': 0.16542217}
confusion matrix:
       0    1
0  42195  126
1   1327  144
---- Validation: 
scalar performance:
{'acc': 0.96599615, 'precision': 0.75282204, 'recall': 0.5211117, 'specificity': 0.5211117, 'f1': 0.53162664, 'auroc': 0.88888836, 'binary_precision': 0.53846157, 'binary_recall': 0.04354588, 'binary_specificity': 0.9986776, 'binary_f1_score': 0.08057553}
confusion matrix:
       0   1
0  18125  24
1    615  28
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964845, 'precision': 0.9823066, 'recall': 0.5785441, 'specificity': 0.5785441, 'f1': 0.6267555, 'auroc': 0.8788372, 'binary_precision': 1.0, 'binary_recall': 0.15708812, 'binary_specificity': 1.0, 'binary_f1_score': 0.27152315}
confusion matrix:
      0   1
0  5997   0
1   220  41
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324357_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-14 13:47:31.248987,epoch time: 0:20:19.407386,used: 0:41:47.441878,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324357
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96650076, 'precision': 0.7385144, 'recall': 0.565303, 'specificity': 0.565303, 'f1': 0.59814537, 'auroc': 0.9017892, 'binary_precision': 0.5063613, 'binary_recall': 0.13519022, 'binary_specificity': 0.99541587, 'binary_f1_score': 0.21340482}
confusion matrix:
       0    1
0  42126  194
1   1273  199
---- Validation: 
scalar performance:
{'acc': 0.9660494, 'precision': 0.7454294, 'recall': 0.54439104, 'specificity': 0.54439104, 'f1': 0.56938046, 'auroc': 0.90368223, 'binary_precision': 0.5221239, 'binary_recall': 0.09175739, 'binary_specificity': 0.99702466, 'binary_f1_score': 0.15608467}
confusion matrix:
       0   1
0  18095  54
1    584  59
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96756154, 'precision': 0.983629, 'recall': 0.6111111, 'specificity': 0.6111111, 'f1': 0.6734965, 'auroc': 0.8859104, 'binary_precision': 1.0, 'binary_recall': 0.22222222, 'binary_specificity': 1.0, 'binary_f1_score': 0.36363637}
confusion matrix:
      0   1
0  5997   0
1   203  58
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324357_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-14 14:07:11.645264,epoch time: 0:19:40.396277,used: 1:01:27.838155,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324357
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96743697, 'precision': 0.7541174, 'recall': 0.6128059, 'specificity': 0.6128059, 'f1': 0.65374357, 'auroc': 0.90692884, 'binary_precision': 0.534375, 'binary_recall': 0.23265307, 'binary_specificity': 0.9929587, 'binary_f1_score': 0.32417062}
confusion matrix:
       0    1
0  42024  298
1   1128  342
---- Validation: 
scalar performance:
{'acc': 0.96674114, 'precision': 0.7626226, 'recall': 0.5687509, 'specificity': 0.5687509, 'f1': 0.60426617, 'auroc': 0.91284937, 'binary_precision': 0.55487806, 'binary_recall': 0.1415241, 'binary_specificity': 0.99597776, 'binary_f1_score': 0.22552663}
confusion matrix:
       0   1
0  18076  73
1    552  91
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9694791, 'precision': 0.9845669, 'recall': 0.6340996, 'specificity': 0.6340996, 'f1': 0.70364285, 'auroc': 0.884321, 'binary_precision': 1.0, 'binary_recall': 0.26819924, 'binary_specificity': 1.0, 'binary_f1_score': 0.42296073}
confusion matrix:
      0   1
0  5997   0
1   191  70
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324357_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-14 14:27:05.025970,epoch time: 0:19:53.380706,used: 1:21:21.218861,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324357
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96704876, 'precision': 0.74632543, 'recall': 0.6404254, 'specificity': 0.6404254, 'f1': 0.6774349, 'auroc': 0.91238475, 'binary_precision': 0.5169492, 'binary_recall': 0.29027873, 'binary_specificity': 0.99057204, 'binary_f1_score': 0.3717893}
confusion matrix:
       0    1
0  41922  399
1   1044  427
---- Validation: 
scalar performance:
{'acc': 0.9669008, 'precision': 0.76504916, 'recall': 0.57483405, 'specificity': 0.57483405, 'f1': 0.6122723, 'auroc': 0.91183144, 'binary_precision': 0.55932206, 'binary_recall': 0.15396579, 'binary_specificity': 0.99570227, 'binary_f1_score': 0.24146342}
confusion matrix:
       0   1
0  18071  78
1    544  99
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9696389, 'precision': 0.9714637, 'recall': 0.63968, 'specificity': 0.63968, 'f1': 0.7094623, 'auroc': 0.8885493, 'binary_precision': 0.97333336, 'binary_recall': 0.27969348, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.43452382}
confusion matrix:
      0   1
0  5995   2
1   188  73
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324357_5.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-06-14 14:47:40.484985,epoch time: 0:20:35.459015,used: 1:41:56.677876,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324357
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96684325, 'precision': 0.7438648, 'recall': 0.6372814, 'specificity': 0.6372814, 'f1': 0.67418075, 'auroc': 0.91873, 'binary_precision': 0.5122549, 'binary_recall': 0.2839674, 'binary_specificity': 0.99059546, 'binary_f1_score': 0.3653846}
confusion matrix:
       0    1
0  41922  398
1   1054  418
---- Validation: 
scalar performance:
{'acc': 0.9667944, 'precision': 0.7566088, 'recall': 0.59428036, 'specificity': 0.59428036, 'f1': 0.63452154, 'auroc': 0.9224889, 'binary_precision': 0.54112554, 'binary_recall': 0.19440125, 'binary_specificity': 0.99415946, 'binary_f1_score': 0.28604117}
confusion matrix:
       0    1
0  18043  106
1    518  125
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97219557, 'precision': 0.9750658, 'recall': 0.67033136, 'specificity': 0.67033136, 'f1': 0.7456887, 'auroc': 0.88866514, 'binary_precision': 0.978022, 'binary_recall': 0.34099618, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.5056818}
confusion matrix:
      0   1
0  5995   2
1   172  89
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324357_6.png
new oracle model saved
early stop counter: 1
val acc:0.9667943716049194, best validation acc: 0.9669008255004883, corresponding to test acc:                         0.9696388840675354 / 0.972195565700531
after epoch: 6,now: 2024-06-14 15:09:53.763486,epoch time: 0:22:13.278501,used: 2:04:09.956377,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324357
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9673913, 'precision': 0.7515384, 'recall': 0.63887644, 'specificity': 0.63887644, 'f1': 0.67737013, 'auroc': 0.9229263, 'binary_precision': 0.5275, 'binary_recall': 0.28668478, 'binary_specificity': 0.99106807, 'binary_f1_score': 0.37147883}
confusion matrix:
       0    1
0  41942  378
1   1050  422
---- Validation: 
scalar performance:
{'acc': 0.9671669, 'precision': 0.76854944, 'recall': 0.58472246, 'specificity': 0.58472246, 'f1': 0.6247786, 'auroc': 0.91630745, 'binary_precision': 0.56565654, 'binary_recall': 0.17418352, 'binary_specificity': 0.99526143, 'binary_f1_score': 0.2663496}
confusion matrix:
       0    1
0  18063   86
1    531  112
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9715564, 'precision': 0.97978103, 'recall': 0.66083616, 'specificity': 0.66083616, 'f1': 0.73546153, 'auroc': 0.8876891, 'binary_precision': 0.9882353, 'binary_recall': 0.3218391, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.48554915}
confusion matrix:
      0   1
0  5996   1
1   177  84
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324357_7.png
better model found
persisted
after epoch: 7,now: 2024-06-14 15:31:58.524071,epoch time: 0:22:04.760585,used: 2:26:14.716962,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324357
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.967848, 'precision': 0.75503755, 'recall': 0.6748494, 'specificity': 0.6748494, 'f1': 0.7067085, 'auroc': 0.92652714, 'binary_precision': 0.53206414, 'binary_recall': 0.3607337, 'binary_specificity': 0.98896503, 'binary_f1_score': 0.4299595}
confusion matrix:
       0    1
0  41853  467
1    941  531
---- Validation: 
scalar performance:
{'acc': 0.9673265, 'precision': 0.7647221, 'recall': 0.60805684, 'specificity': 0.60805684, 'f1': 0.65052015, 'auroc': 0.92260164, 'binary_precision': 0.5564202, 'binary_recall': 0.22239502, 'binary_specificity': 0.9937187, 'binary_f1_score': 0.31777778}
confusion matrix:
       0    1
0  18035  114
1    500  143
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9682007, 'precision': 0.9762043, 'recall': 0.62060624, 'specificity': 0.62060624, 'f1': 0.6856844, 'auroc': 0.8894248, 'binary_precision': 0.984375, 'binary_recall': 0.2413793, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.3876923}
confusion matrix:
      0   1
0  5996   1
1   198  63
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324357_8.png
better model found
persisted
after epoch: 8,now: 2024-06-14 15:54:39.932056,epoch time: 0:22:41.407985,used: 2:48:56.124947,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324357
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.96882993, 'precision': 0.7686611, 'recall': 0.663329, 'specificity': 0.663329, 'f1': 0.70193714, 'auroc': 0.9289154, 'binary_precision': 0.5600907, 'binary_recall': 0.33582598, 'binary_specificity': 0.990832, 'binary_f1_score': 0.41988954}
confusion matrix:
       0    1
0  41933  388
1    977  494
---- Validation: 
scalar performance:
{'acc': 0.96753937, 'precision': 0.7765191, 'recall': 0.58941567, 'specificity': 0.58941567, 'f1': 0.6311779, 'auroc': 0.925104, 'binary_precision': 0.58128077, 'binary_recall': 0.18351477, 'binary_specificity': 0.99531657, 'binary_f1_score': 0.2789598}
confusion matrix:
       0    1
0  18064   85
1    525  118
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96708214, 'precision': 0.9833951, 'recall': 0.60536397, 'specificity': 0.60536397, 'f1': 0.66560805, 'auroc': 0.8831916, 'binary_precision': 1.0, 'binary_recall': 0.21072797, 'binary_specificity': 1.0, 'binary_f1_score': 0.3481013}
confusion matrix:
      0   1
0  5997   0
1   206  55
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324357_9.png
better model found
persisted
after epoch: 9,now: 2024-06-14 16:15:14.929128,epoch time: 0:20:34.997072,used: 3:09:31.122019,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324357
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9680307, 'precision': 0.7567296, 'recall': 0.6811732, 'specificity': 0.6811732, 'f1': 0.7117728, 'auroc': 0.9281454, 'binary_precision': 0.53501946, 'binary_recall': 0.3736413, 'binary_specificity': 0.9887051, 'binary_f1_score': 0.44}
confusion matrix:
       0    1
0  41842  478
1    922  550
---- Validation: 
scalar performance:
{'acc': 0.9680183, 'precision': 0.76802754, 'recall': 0.64741784, 'specificity': 0.64741784, 'f1': 0.68855894, 'auroc': 0.93434286, 'binary_precision': 0.5603448, 'binary_recall': 0.30326593, 'binary_specificity': 0.99156976, 'binary_f1_score': 0.39354187}
confusion matrix:
       0    1
0  17996  153
1    448  195
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97347397, 'precision': 0.96310747, 'recall': 0.691154, 'specificity': 0.691154, 'f1': 0.7663928, 'auroc': 0.89619267, 'binary_precision': 0.95238096, 'binary_recall': 0.38314176, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.5464481}
confusion matrix:
      0    1
0  5992    5
1   161  100
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324357_10.png
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-06-14 16:35:35.609291,epoch time: 0:20:20.680163,used: 3:29:51.802182,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324357
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.967711, 'precision': 0.75400805, 'recall': 0.66527057, 'specificity': 0.66527057, 'f1': 0.69930816, 'auroc': 0.9262305, 'binary_precision': 0.5306554, 'binary_recall': 0.3410326, 'binary_specificity': 0.9895085, 'binary_f1_score': 0.4152192}
confusion matrix:
       0    1
0  41876  444
1    970  502
---- Validation: 
scalar performance:
{'acc': 0.9675926, 'precision': 0.76667047, 'recall': 0.6209456, 'specificity': 0.6209456, 'f1': 0.66392106, 'auroc': 0.93032515, 'binary_precision': 0.55944055, 'binary_recall': 0.2488336, 'binary_specificity': 0.9930575, 'binary_f1_score': 0.3444564}
confusion matrix:
       0    1
0  18023  126
1    483  160
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9705976, 'precision': 0.97292227, 'recall': 0.65117425, 'specificity': 0.65117425, 'f1': 0.7234371, 'auroc': 0.892309, 'binary_precision': 0.97530866, 'binary_recall': 0.30268198, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.46198833}
confusion matrix:
      0   1
0  5995   2
1   182  79
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324357_11.png
early stop counter: 1
val acc:0.9675925970077515, best validation acc: 0.9680182933807373, corresponding to test acc:                         0.9734739661216736 / 0.9734739661216736
after epoch: 11,now: 2024-06-14 16:55:41.123535,epoch time: 0:20:05.514244,used: 3:49:57.316426,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324357
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9685102, 'precision': 0.7615932, 'recall': 0.6886342, 'specificity': 0.6886342, 'f1': 0.7186083, 'auroc': 0.93099153, 'binary_precision': 0.5442436, 'binary_recall': 0.38858697, 'binary_specificity': 0.9886815, 'binary_f1_score': 0.45342848}
confusion matrix:
       0    1
0  41841  479
1    900  572
---- Validation: 
scalar performance:
{'acc': 0.968444, 'precision': 0.78005147, 'recall': 0.62963694, 'specificity': 0.62963694, 'f1': 0.6747974, 'auroc': 0.93523335, 'binary_precision': 0.5856164, 'binary_recall': 0.2659409, 'binary_specificity': 0.993333, 'binary_f1_score': 0.36577538}
confusion matrix:
       0    1
0  18028  121
1    472  171
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9704378, 'precision': 0.978703, 'recall': 0.6474262, 'specificity': 0.6474262, 'f1': 0.7195423, 'auroc': 0.8927163, 'binary_precision': 0.98717946, 'binary_recall': 0.29501915, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.45427725}
confusion matrix:
      0   1
0  5996   1
1   184  77
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324357_12.png
better model found
persisted
after epoch: 12,now: 2024-06-14 17:15:50.622597,epoch time: 0:20:09.499062,used: 4:10:06.815488,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324357
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.967848, 'precision': 0.75822026, 'recall': 0.6372299, 'specificity': 0.6372299, 'f1': 0.6774653, 'auroc': 0.9232714, 'binary_precision': 0.5409623, 'binary_recall': 0.28280082, 'binary_specificity': 0.991659, 'binary_f1_score': 0.37142855}
confusion matrix:
       0    1
0  41968  353
1   1055  416
---- Validation: 
scalar performance:
{'acc': 0.9680715, 'precision': 0.777652, 'recall': 0.6159431, 'specificity': 0.6159431, 'f1': 0.66069484, 'auroc': 0.93036246, 'binary_precision': 0.581749, 'binary_recall': 0.23794712, 'binary_specificity': 0.99393904, 'binary_f1_score': 0.33774832}
confusion matrix:
       0    1
0  18039  110
1    490  153
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9701182, 'precision': 0.97221184, 'recall': 0.6454271, 'specificity': 0.6454271, 'f1': 0.71651036, 'auroc': 0.89309996, 'binary_precision': 0.974359, 'binary_recall': 0.29118773, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.44837758}
confusion matrix:
      0   1
0  5995   2
1   185  76
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324357_13.png
early stop counter: 1
val acc:0.9680715203285217, best validation acc: 0.9684439897537231, corresponding to test acc:                         0.9704378247261047 / 0.9734739661216736
after epoch: 13,now: 2024-06-14 17:37:32.521389,epoch time: 0:21:41.898792,used: 4:31:48.714280,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324357
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96853304, 'precision': 0.76594967, 'recall': 0.65618795, 'specificity': 0.65618795, 'f1': 0.69544727, 'auroc': 0.93187827, 'binary_precision': 0.55516434, 'binary_recall': 0.32133153, 'binary_specificity': 0.9910444, 'binary_f1_score': 0.4070568}
confusion matrix:
       0    1
0  41941  379
1    999  473
---- Validation: 
scalar performance:
{'acc': 0.96823114, 'precision': 0.78444105, 'recall': 0.6085252, 'specificity': 0.6085252, 'f1': 0.6538146, 'auroc': 0.927753, 'binary_precision': 0.59583336, 'binary_recall': 0.22239502, 'binary_specificity': 0.9946554, 'binary_f1_score': 0.32389578}
confusion matrix:
       0    1
0  18052   97
1    500  143
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650048, 'precision': 0.9823842, 'recall': 0.5804598, 'specificity': 0.5804598, 'f1': 0.629648, 'auroc': 0.89075255, 'binary_precision': 1.0, 'binary_recall': 0.16091955, 'binary_specificity': 1.0, 'binary_f1_score': 0.27722773}
confusion matrix:
      0   1
0  5997   0
1   219  42
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324357_14.png
early stop counter: 2
val acc:0.9682311415672302, best validation acc: 0.9684439897537231, corresponding to test acc:                         0.9704378247261047 / 0.9734739661216736
after epoch: 14,now: 2024-06-14 17:58:57.184881,epoch time: 0:21:24.663492,used: 4:53:13.377772,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324357
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.96768814, 'precision': 0.75582945, 'recall': 0.63968575, 'specificity': 0.63968575, 'f1': 0.6790697, 'auroc': 0.9295558, 'binary_precision': 0.53603035, 'binary_recall': 0.28804347, 'binary_specificity': 0.991328, 'binary_f1_score': 0.37472382}
confusion matrix:
       0    1
0  41953  367
1   1048  424
---- Validation: 
scalar performance:
{'acc': 0.9676458, 'precision': 0.77507406, 'recall': 0.59847146, 'specificity': 0.59847146, 'f1': 0.6414898, 'auroc': 0.93949676, 'binary_precision': 0.5777778, 'binary_recall': 0.2021773, 'binary_specificity': 0.9947656, 'binary_f1_score': 0.29953918}
confusion matrix:
       0    1
0  18054   95
1    513  130
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9691595, 'precision': 0.9773432, 'recall': 0.6321005, 'specificity': 0.6321005, 'f1': 0.70053965, 'auroc': 0.89827096, 'binary_precision': 0.98571426, 'binary_recall': 0.26436782, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.41691843}
confusion matrix:
      0   1
0  5996   1
1   192  69
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324357_15.png
early stop counter: 3
val acc:0.9676458239555359, best validation acc: 0.9684439897537231, corresponding to test acc:                         0.9704378247261047 / 0.9734739661216736
after epoch: 15,now: 2024-06-14 18:20:34.171092,epoch time: 0:21:36.986211,used: 5:14:50.363983,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324357
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9687843, 'precision': 0.76644546, 'recall': 0.67533374, 'specificity': 0.67533374, 'f1': 0.7105819, 'auroc': 0.93189263, 'binary_precision': 0.5548589, 'binary_recall': 0.3607337, 'binary_specificity': 0.98993385, 'binary_f1_score': 0.43721694}
confusion matrix:
       0    1
0  41894  426
1    941  531
---- Validation: 
scalar performance:
{'acc': 0.9684972, 'precision': 0.78190386, 'recall': 0.6274143, 'specificity': 0.6274143, 'f1': 0.6729594, 'auroc': 0.93056816, 'binary_precision': 0.58947366, 'binary_recall': 0.26127526, 'binary_specificity': 0.99355334, 'binary_f1_score': 0.36206895}
confusion matrix:
       0    1
0  18032  117
1    475  168
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9689997, 'precision': 0.9843321, 'recall': 0.6283525, 'specificity': 0.6283525, 'f1': 0.6963096, 'auroc': 0.891133, 'binary_precision': 1.0, 'binary_recall': 0.256705, 'binary_specificity': 1.0, 'binary_f1_score': 0.40853658}
confusion matrix:
      0   1
0  5997   0
1   194  67
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324357_16.png
better model found
persisted
after epoch: 16,now: 2024-06-14 18:42:29.812504,epoch time: 0:21:55.641412,used: 5:36:46.005395,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324357
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.96873856, 'precision': 0.7644383, 'recall': 0.6846076, 'specificity': 0.6846076, 'f1': 0.7167251, 'auroc': 0.93147326, 'binary_precision': 0.5501968, 'binary_recall': 0.38001359, 'binary_specificity': 0.9892016, 'binary_f1_score': 0.4495376}
confusion matrix:
       0    1
0  41864  457
1    912  559
---- Validation: 
scalar performance:
{'acc': 0.9679119, 'precision': 0.76888835, 'recall': 0.63536185, 'specificity': 0.63536185, 'f1': 0.67803174, 'auroc': 0.93590975, 'binary_precision': 0.5628931, 'binary_recall': 0.27838257, 'binary_specificity': 0.99234116, 'binary_f1_score': 0.3725286}
confusion matrix:
       0    1
0  18010  139
1    464  179
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9705976, 'precision': 0.97886264, 'recall': 0.6493419, 'specificity': 0.6493419, 'f1': 0.72185594, 'auroc': 0.8967118, 'binary_precision': 0.98734176, 'binary_recall': 0.29885057, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.45882353}
confusion matrix:
      0   1
0  5996   1
1   183  78
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324357_17.png
early stop counter: 1
val acc:0.9679118990898132, best validation acc: 0.9684972167015076, corresponding to test acc:                         0.9689996838569641 / 0.9734739661216736
after epoch: 17,now: 2024-06-14 19:04:21.762319,epoch time: 0:21:51.949815,used: 5:58:37.955210,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324357
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9693323, 'precision': 0.7736511, 'recall': 0.67528945, 'specificity': 0.67528945, 'f1': 0.7126744, 'auroc': 0.93857336, 'binary_precision': 0.5692803, 'binary_recall': 0.36005434, 'binary_specificity': 0.9905246, 'binary_f1_score': 0.44111526}
confusion matrix:
       0    1
0  41919  401
1    942  530
---- Validation: 
scalar performance:
{'acc': 0.9690826, 'precision': 0.7898216, 'recall': 0.63596797, 'specificity': 0.63596797, 'f1': 0.6827009, 'auroc': 0.9362154, 'binary_precision': 0.6047297, 'binary_recall': 0.27838257, 'binary_specificity': 0.99355334, 'binary_f1_score': 0.38125664}
confusion matrix:
       0    1
0  18032  117
1    464  179
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9689997, 'precision': 0.9771614, 'recall': 0.6301848, 'specificity': 0.6301848, 'f1': 0.6981006, 'auroc': 0.89480805, 'binary_precision': 0.98550725, 'binary_recall': 0.2605364, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.4121212}
confusion matrix:
      0   1
0  5996   1
1   193  68
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324357_18.png
better model found
persisted
after epoch: 18,now: 2024-06-14 19:25:07.869767,epoch time: 0:20:46.107448,used: 6:19:24.062658,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324357
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9687157, 'precision': 0.7602742, 'recall': 0.732497, 'specificity': 0.732497, 'f1': 0.74551964, 'auroc': 0.93568146, 'binary_precision': 0.53857905, 'binary_recall': 0.4792658, 'binary_specificity': 0.98572814, 'binary_f1_score': 0.5071942}
confusion matrix:
       0    1
0  41717  604
1    766  705
---- Validation: 
scalar performance:
{'acc': 0.968923, 'precision': 0.7752434, 'recall': 0.67563826, 'specificity': 0.67563826, 'f1': 0.7133819, 'auroc': 0.9400775, 'binary_precision': 0.5728395, 'binary_recall': 0.3608087, 'binary_specificity': 0.9904678, 'binary_f1_score': 0.44274804}
confusion matrix:
       0    1
0  17976  173
1    411  232
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97251517, 'precision': 0.9754598, 'recall': 0.67416275, 'specificity': 0.67416275, 'f1': 0.74999094, 'auroc': 0.8976661, 'binary_precision': 0.97849464, 'binary_recall': 0.348659, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.51412433}
confusion matrix:
      0   1
0  5995   2
1   170  91
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324357_19.png
early stop counter: 1
val acc:0.9689229726791382, best validation acc: 0.9690825939178467, corresponding to test acc:                         0.9689996838569641 / 0.9734739661216736
after epoch: 19,now: 2024-06-14 19:44:20.922158,epoch time: 0:19:13.052391,used: 6:38:37.115049,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324357
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.96867007, 'precision': 0.7608017, 'recall': 0.71986353, 'specificity': 0.71986353, 'f1': 0.7384071, 'auroc': 0.9376699, 'binary_precision': 0.54051864, 'binary_recall': 0.453125, 'binary_specificity': 0.98660207, 'binary_f1_score': 0.49297854}
confusion matrix:
       0    1
0  41753  567
1    805  667
---- Validation: 
scalar performance:
{'acc': 0.9686569, 'precision': 0.77188283, 'recall': 0.67475045, 'specificity': 0.67475045, 'f1': 0.71172947, 'auroc': 0.94117355, 'binary_precision': 0.5661765, 'binary_recall': 0.3592535, 'binary_specificity': 0.99024737, 'binary_f1_score': 0.43958136}
confusion matrix:
       0    1
0  17972  177
1    412  231
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9715564, 'precision': 0.9742455, 'recall': 0.6626685, 'specificity': 0.6626685, 'f1': 0.7369386, 'auroc': 0.8967824, 'binary_precision': 0.9770115, 'binary_recall': 0.3256705, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.48850575}
confusion matrix:
      0   1
0  5995   2
1   176  85
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324357_20.png
early stop counter: 2
val acc:0.9686568975448608, best validation acc: 0.9690825939178467, corresponding to test acc:                         0.9689996838569641 / 0.9734739661216736
after epoch: 20,now: 2024-06-14 20:02:24.086118,epoch time: 0:18:03.163960,used: 6:56:40.279009,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324357
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9688984, 'precision': 0.7685983, 'recall': 0.66927004, 'specificity': 0.66927004, 'f1': 0.70659196, 'auroc': 0.9369873, 'binary_precision': 0.55956286, 'binary_recall': 0.34806255, 'binary_specificity': 0.99047756, 'binary_f1_score': 0.42917013}
confusion matrix:
       0    1
0  41918  403
1    959  512
---- Validation: 
scalar performance:
{'acc': 0.96871006, 'precision': 0.78283155, 'recall': 0.6357751, 'specificity': 0.6357751, 'f1': 0.6811933, 'auroc': 0.94169605, 'binary_precision': 0.5907591, 'binary_recall': 0.27838257, 'binary_specificity': 0.99316764, 'binary_f1_score': 0.3784355}
confusion matrix:
       0    1
0  18025  124
1    464  179
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96596354, 'precision': 0.98285025, 'recall': 0.591954, 'specificity': 0.591954, 'f1': 0.64661527, 'auroc': 0.89314854, 'binary_precision': 1.0, 'binary_recall': 0.18390805, 'binary_specificity': 1.0, 'binary_f1_score': 0.3106796}
confusion matrix:
      0   1
0  5997   0
1   213  48
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324357_21.png
early stop counter: 3
val acc:0.9687100648880005, best validation acc: 0.9690825939178467, corresponding to test acc:                         0.9689996838569641 / 0.9734739661216736
after epoch: 21,now: 2024-06-14 20:20:55.702115,epoch time: 0:18:31.615997,used: 7:15:11.895006,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324357
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.96903545, 'precision': 0.76574767, 'recall': 0.7052989, 'specificity': 0.7052989, 'f1': 0.73125285, 'auroc': 0.9349588, 'binary_precision': 0.5514184, 'binary_recall': 0.42255434, 'binary_specificity': 0.9880435, 'binary_f1_score': 0.47846153}
confusion matrix:
       0    1
0  41814  506
1    850  622
---- Validation: 
scalar performance:
{'acc': 0.968923, 'precision': 0.7767037, 'recall': 0.66888773, 'specificity': 0.66888773, 'f1': 0.7085167, 'auroc': 0.94066334, 'binary_precision': 0.57622737, 'binary_recall': 0.34681183, 'binary_specificity': 0.9909637, 'binary_f1_score': 0.4330097}
confusion matrix:
       0    1
0  17985  164
1    420  223
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9704378, 'precision': 0.978703, 'recall': 0.6474262, 'specificity': 0.6474262, 'f1': 0.7195423, 'auroc': 0.8953163, 'binary_precision': 0.98717946, 'binary_recall': 0.29501915, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.45427725}
confusion matrix:
      0   1
0  5996   1
1   184  77
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324357_22.png
early stop counter: 4
val acc:0.9689229726791382, best validation acc: 0.9690825939178467, corresponding to test acc:                         0.9689996838569641 / 0.9734739661216736
after epoch: 22,now: 2024-06-14 20:40:07.933099,epoch time: 0:19:12.230984,used: 7:34:24.125990,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324357
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9695378, 'precision': 0.7701537, 'recall': 0.7104194, 'specificity': 0.7104194, 'f1': 0.7362031, 'auroc': 0.9337625, 'binary_precision': 0.55985916, 'binary_recall': 0.43265307, 'binary_specificity': 0.9881858, 'binary_f1_score': 0.48810437}
confusion matrix:
       0    1
0  41822  500
1    834  636
---- Validation: 
scalar performance:
{'acc': 0.96886975, 'precision': 0.77596056, 'recall': 0.6688602, 'specificity': 0.6688602, 'f1': 0.7082928, 'auroc': 0.9399315, 'binary_precision': 0.57474226, 'binary_recall': 0.34681183, 'binary_specificity': 0.99090856, 'binary_f1_score': 0.4325897}
confusion matrix:
       0    1
0  17984  165
1    420  223
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96676254, 'precision': 0.9742236, 'recall': 0.6033649, 'specificity': 0.6033649, 'f1': 0.66236144, 'auroc': 0.89404297, 'binary_precision': 0.9818182, 'binary_recall': 0.20689656, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.34177217}
confusion matrix:
      0   1
0  5996   1
1   207  54
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324357_23.png
early stop counter: 5
val acc:0.9688697457313538, best validation acc: 0.9690825939178467, corresponding to test acc:                         0.9689996838569641 / 0.9734739661216736
after epoch: 23,now: 2024-06-14 20:59:10.504660,epoch time: 0:19:02.571561,used: 7:53:26.697551,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324357
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9698347, 'precision': 0.7738794, 'recall': 0.7103025, 'specificity': 0.7103025, 'f1': 0.73750436, 'auroc': 0.937729, 'binary_precision': 0.56735057, 'binary_recall': 0.43206522, 'binary_specificity': 0.9885397, 'binary_f1_score': 0.4905515}
confusion matrix:
       0    1
0  41835  485
1    836  636
---- Validation: 
scalar performance:
{'acc': 0.9695615, 'precision': 0.78833866, 'recall': 0.6617178, 'specificity': 0.6617178, 'f1': 0.7056097, 'auroc': 0.94238687, 'binary_precision': 0.6, 'binary_recall': 0.33125973, 'binary_specificity': 0.9921759, 'binary_f1_score': 0.42685372}
confusion matrix:
       0    1
0  18007  142
1    430  213
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9682007, 'precision': 0.9762043, 'recall': 0.62060624, 'specificity': 0.62060624, 'f1': 0.6856844, 'auroc': 0.89490736, 'binary_precision': 0.984375, 'binary_recall': 0.2413793, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.3876923}
confusion matrix:
      0   1
0  5996   1
1   198  63
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324357_24.png
better model found
persisted
after epoch: 24,now: 2024-06-14 21:19:29.428333,epoch time: 0:20:18.923673,used: 8:13:45.621224,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324357
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.96962917, 'precision': 0.77616215, 'recall': 0.68265593, 'specificity': 0.68265593, 'f1': 0.7189774, 'auroc': 0.9391285, 'binary_precision': 0.57380456, 'binary_recall': 0.375, 'binary_specificity': 0.9903119, 'binary_f1_score': 0.45357433}
confusion matrix:
       0    1
0  41910  410
1    920  552
---- Validation: 
scalar performance:
{'acc': 0.96945506, 'precision': 0.79388165, 'recall': 0.6429113, 'specificity': 0.6429113, 'f1': 0.6900605, 'auroc': 0.94151425, 'binary_precision': 0.6123778, 'binary_recall': 0.29237947, 'binary_specificity': 0.9934432, 'binary_f1_score': 0.39578947}
confusion matrix:
       0    1
0  18030  119
1    455  188
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9688399, 'precision': 0.9842539, 'recall': 0.62643677, 'specificity': 0.62643677, 'f1': 0.69383585, 'auroc': 0.8953859, 'binary_precision': 1.0, 'binary_recall': 0.25287357, 'binary_specificity': 1.0, 'binary_f1_score': 0.40366974}
confusion matrix:
      0   1
0  5997   0
1   195  66
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324357_25.png
early stop counter: 1
val acc:0.9694550633430481, best validation acc: 0.9695615172386169, corresponding to test acc:                         0.96820068359375 / 0.9734739661216736
after epoch: 25,now: 2024-06-14 21:38:14.558366,epoch time: 0:18:45.130033,used: 8:32:30.751257,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324357
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9695606, 'precision': 0.7741757, 'recall': 0.688522, 'specificity': 0.688522, 'f1': 0.7226584, 'auroc': 0.934144, 'binary_precision': 0.5694306, 'binary_recall': 0.38722825, 'binary_specificity': 0.9898157, 'binary_f1_score': 0.46097857}
confusion matrix:
       0    1
0  41889  431
1    902  570
---- Validation: 
scalar performance:
{'acc': 0.969189, 'precision': 0.7843703, 'recall': 0.6555245, 'specificity': 0.6555245, 'f1': 0.69936913, 'auroc': 0.94681716, 'binary_precision': 0.59248555, 'binary_recall': 0.31881803, 'binary_specificity': 0.99223095, 'binary_f1_score': 0.41456017}
confusion matrix:
       0    1
0  18008  141
1    438  205
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96724194, 'precision': 0.97492766, 'recall': 0.609112, 'specificity': 0.609112, 'f1': 0.6702797, 'auroc': 0.89896643, 'binary_precision': 0.98275864, 'binary_recall': 0.21839081, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.35736677}
confusion matrix:
      0   1
0  5996   1
1   204  57
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324357_26.png
early stop counter: 2
val acc:0.9691889882087708, best validation acc: 0.9695615172386169, corresponding to test acc:                         0.96820068359375 / 0.9734739661216736
after epoch: 26,now: 2024-06-14 21:57:27.440020,epoch time: 0:19:12.881654,used: 8:51:43.632911,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324357
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9693551, 'precision': 0.7751641, 'recall': 0.6693998, 'specificity': 0.6693998, 'f1': 0.70852506, 'auroc': 0.9363701, 'binary_precision': 0.57270694, 'binary_recall': 0.3478261, 'binary_specificity': 0.99097353, 'binary_f1_score': 0.43279797}
confusion matrix:
       0    1
0  41938  382
1    960  512
---- Validation: 
scalar performance:
{'acc': 0.9692422, 'precision': 0.8070119, 'recall': 0.6127989, 'specificity': 0.6127989, 'f1': 0.66146386, 'auroc': 0.94166815, 'binary_precision': 0.64069265, 'binary_recall': 0.23017107, 'binary_specificity': 0.9954268, 'binary_f1_score': 0.33867276}
confusion matrix:
       0    1
0  18066   83
1    495  148
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650048, 'precision': 0.9823842, 'recall': 0.5804598, 'specificity': 0.5804598, 'f1': 0.629648, 'auroc': 0.890026, 'binary_precision': 1.0, 'binary_recall': 0.16091955, 'binary_specificity': 1.0, 'binary_f1_score': 0.27722773}
confusion matrix:
      0   1
0  5997   0
1   219  42
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324357_27.png
early stop counter: 3
val acc:0.9692422151565552, best validation acc: 0.9695615172386169, corresponding to test acc:                         0.96820068359375 / 0.9734739661216736
after epoch: 27,now: 2024-06-14 22:17:23.466821,epoch time: 0:19:56.026801,used: 9:11:39.659712,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324357
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.96885276, 'precision': 0.7635937, 'recall': 0.7074994, 'specificity': 0.7074994, 'f1': 0.7318661, 'auroc': 0.93689775, 'binary_precision': 0.54695654, 'binary_recall': 0.42730978, 'binary_specificity': 0.987689, 'binary_f1_score': 0.47978646}
confusion matrix:
       0    1
0  41799  521
1    843  629
---- Validation: 
scalar performance:
{'acc': 0.9690826, 'precision': 0.77895653, 'recall': 0.6689704, 'specificity': 0.6689704, 'f1': 0.70919085, 'auroc': 0.94425213, 'binary_precision': 0.5807292, 'binary_recall': 0.34681183, 'binary_specificity': 0.991129, 'binary_f1_score': 0.4342746}
confusion matrix:
       0    1
0  17988  161
1    420  223
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9683605, 'precision': 0.97640264, 'recall': 0.622522, 'specificity': 0.622522, 'f1': 0.6881976, 'auroc': 0.89430666, 'binary_precision': 0.9846154, 'binary_recall': 0.24521072, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.39263803}
confusion matrix:
      0   1
0  5996   1
1   197  64
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324357_28.png
early stop counter: 4
val acc:0.9690825939178467, best validation acc: 0.9695615172386169, corresponding to test acc:                         0.96820068359375 / 0.9734739661216736
after epoch: 28,now: 2024-06-14 22:37:00.244861,epoch time: 0:19:36.778040,used: 9:31:16.437752,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324357
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.96999454, 'precision': 0.7778327, 'recall': 0.6979265, 'specificity': 0.6979265, 'f1': 0.7305243, 'auroc': 0.93690825, 'binary_precision': 0.5761079, 'binary_recall': 0.40625, 'binary_specificity': 0.98960304, 'binary_f1_score': 0.476494}
confusion matrix:
       0    1
0  41880  440
1    874  598
---- Validation: 
scalar performance:
{'acc': 0.9698808, 'precision': 0.8020793, 'recall': 0.64313173, 'specificity': 0.64313173, 'f1': 0.69185203, 'auroc': 0.9410529, 'binary_precision': 0.62876254, 'binary_recall': 0.29237947, 'binary_specificity': 0.99388397, 'binary_f1_score': 0.39915076}
confusion matrix:
       0    1
0  18038  111
1    455  188
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9653244, 'precision': 0.9825394, 'recall': 0.5842912, 'specificity': 0.5842912, 'f1': 0.6353768, 'auroc': 0.8934632, 'binary_precision': 1.0, 'binary_recall': 0.16858238, 'binary_specificity': 1.0, 'binary_f1_score': 0.28852457}
confusion matrix:
      0   1
0  5997   0
1   217  44
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324357_29.png
better model found
persisted
after epoch: 29,now: 2024-06-14 22:56:20.264360,epoch time: 0:19:20.019499,used: 9:50:36.457251,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324357
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.96921813, 'precision': 0.76503146, 'recall': 0.73326147, 'specificity': 0.73326147, 'f1': 0.7480279, 'auroc': 0.937929, 'binary_precision': 0.548062, 'binary_recall': 0.4802989, 'binary_specificity': 0.986224, 'binary_f1_score': 0.5119479}
confusion matrix:
       0    1
0  41737  583
1    765  707
---- Validation: 
scalar performance:
{'acc': 0.9694019, 'precision': 0.77731, 'recall': 0.69613767, 'specificity': 0.69613767, 'f1': 0.72908384, 'auroc': 0.9436438, 'binary_precision': 0.57555556, 'binary_recall': 0.40279937, 'binary_specificity': 0.989476, 'binary_f1_score': 0.47392496}
confusion matrix:
       0    1
0  17958  191
1    384  259
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.971876, 'precision': 0.96949023, 'recall': 0.6683322, 'specificity': 0.6683322, 'f1': 0.74276555, 'auroc': 0.89904785, 'binary_precision': 0.96703297, 'binary_recall': 0.33716476, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.5}
confusion matrix:
      0   1
0  5994   3
1   173  88
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324357_30.png
early stop counter: 1
val acc:0.9694018959999084, best validation acc: 0.9698808193206787, corresponding to test acc:                         0.9653244018554688 / 0.9734739661216736
after epoch: 30,now: 2024-06-14 23:15:07.841824,epoch time: 0:18:47.577464,used: 10:09:24.034715,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324357
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 10:09:24.034715 at 2024-06-14 23:15:07.841824
persisted model performance metric: 

scalar performance:
{'acc': 0.9653244, 'precision': 0.9825394, 'recall': 0.5842912, 'specificity': 0.5842912, 'f1': 0.6353768, 'auroc': 0.8934632, 'binary_precision': 1.0, 'binary_recall': 0.16858238, 'binary_specificity': 1.0, 'binary_f1_score': 0.28852457}
confusion matrix:
      0   1
0  5997   0
1   217  44
oracle model performance metric: 

scalar performance:
{'acc': 0.97347397, 'precision': 0.96310747, 'recall': 0.691154, 'specificity': 0.691154, 'f1': 0.7663928, 'auroc': 0.89619267, 'binary_precision': 0.95238096, 'binary_recall': 0.38314176, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.5464481}
confusion matrix:
      0    1
0  5992    5
1   161  100
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_bs16_different_learningrates/rule_results/3.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_bs16_different_learningrates/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_resnet_bs16_different_learningrates/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204979 KiB | 640729 KiB |    942 TiB |    942 TiB |
|       from large pool | 167936 KiB | 568000 KiB |    942 TiB |    942 TiB |
|       from small pool |  37043 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 204979 KiB | 640729 KiB |    942 TiB |    942 TiB |
|       from large pool | 167936 KiB | 568000 KiB |    942 TiB |    942 TiB |
|       from small pool |  37043 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201088 KiB | 632296 KiB |    940 TiB |    940 TiB |
|       from large pool | 165120 KiB | 560704 KiB |    940 TiB |    940 TiB |
|       from small pool |  35968 KiB |  73944 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 755712 KiB | 755712 KiB | 755712 KiB |      0 B   |
|       from large pool | 679936 KiB | 679936 KiB | 679936 KiB |      0 B   |
|       from small pool |  75776 KiB |  75776 KiB |  75776 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  79692 KiB | 215750 KiB | 380570 GiB | 380569 GiB |
|       from large pool |  67584 KiB | 213792 KiB | 380265 GiB | 380265 GiB |
|       from small pool |  12108 KiB |  14049 KiB |    304 GiB |    304 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3252    |    6223    |   83722 K  |   83718 K  |
|       from large pool |      36    |      76    |   33845 K  |   33845 K  |
|       from small pool |    3216    |    6186    |   49876 K  |   49873 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3252    |    6223    |   83722 K  |   83718 K  |
|       from large pool |      36    |      76    |   33845 K  |   33845 K  |
|       from small pool |    3216    |    6186    |   49876 K  |   49873 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      51    |      51    |      51    |       0    |
|       from large pool |      14    |      14    |      14    |       0    |
|       from small pool |      37    |      37    |      37    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      39    |    2753    |   37652 K  |   37652 K  |
|       from large pool |       7    |      11    |   12103 K  |   12103 K  |
|       from small pool |      32    |    2746    |   25548 K  |   25548 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 640729 KiB |    942 TiB |    942 TiB |
|       from large pool |  16640 KiB | 568000 KiB |    942 TiB |    942 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 640729 KiB |    942 TiB |    942 TiB |
|       from large pool |  16640 KiB | 568000 KiB |    942 TiB |    942 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 632296 KiB |    940 TiB |    940 TiB |
|       from large pool |  16640 KiB | 560704 KiB |    940 TiB |    940 TiB |
|       from small pool |      0 KiB |  73944 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 284672 KiB | 755712 KiB | 755712 KiB | 471040 KiB |
|       from large pool | 235520 KiB | 679936 KiB | 679936 KiB | 444416 KiB |
|       from small pool |  49152 KiB |  75776 KiB |  75776 KiB |  26624 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  55040 KiB | 215750 KiB | 380570 GiB | 380570 GiB |
|       from large pool |  55040 KiB | 213792 KiB | 380265 GiB | 380265 GiB |
|       from small pool |      0 KiB |  19703 KiB |    304 GiB |    304 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6223    |   83722 K  |   83722 K  |
|       from large pool |       2    |      76    |   33845 K  |   33845 K  |
|       from small pool |       0    |    6186    |   49876 K  |   49876 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6223    |   83722 K  |   83722 K  |
|       from large pool |       2    |      76    |   33845 K  |   33845 K  |
|       from small pool |       0    |    6186    |   49876 K  |   49876 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      34    |      51    |      51    |      17    |
|       from large pool |      10    |      14    |      14    |       4    |
|       from small pool |      24    |      37    |      37    |      13    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2753    |   37653 K  |   37653 K  |
|       from large pool |       3    |      13    |   12103 K  |   12103 K  |
|       from small pool |       0    |    2746    |   25549 K  |   25549 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 640729 KiB |    942 TiB |    942 TiB |
|       from large pool |  16640 KiB | 568000 KiB |    942 TiB |    942 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 640729 KiB |    942 TiB |    942 TiB |
|       from large pool |  16640 KiB | 568000 KiB |    942 TiB |    942 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 632296 KiB |    940 TiB |    940 TiB |
|       from large pool |  16640 KiB | 560704 KiB |    940 TiB |    940 TiB |
|       from small pool |      0 KiB |  73944 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 284672 KiB | 755712 KiB | 755712 KiB | 471040 KiB |
|       from large pool | 235520 KiB | 679936 KiB | 679936 KiB | 444416 KiB |
|       from small pool |  49152 KiB |  75776 KiB |  75776 KiB |  26624 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  55040 KiB | 215750 KiB | 380570 GiB | 380570 GiB |
|       from large pool |  55040 KiB | 213792 KiB | 380265 GiB | 380265 GiB |
|       from small pool |      0 KiB |  19703 KiB |    304 GiB |    304 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6223    |   83722 K  |   83722 K  |
|       from large pool |       2    |      76    |   33845 K  |   33845 K  |
|       from small pool |       0    |    6186    |   49876 K  |   49876 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6223    |   83722 K  |   83722 K  |
|       from large pool |       2    |      76    |   33845 K  |   33845 K  |
|       from small pool |       0    |    6186    |   49876 K  |   49876 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      34    |      51    |      51    |      17    |
|       from large pool |      10    |      14    |      14    |       4    |
|       from small pool |      24    |      37    |      37    |      13    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2753    |   37653 K  |   37653 K  |
|       from large pool |       3    |      13    |   12103 K  |   12103 K  |
|       from small pool |       0    |    2746    |   25549 K  |   25549 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0




!!!: not committed yet



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_23_23_37_seed_1_21324357

 Experiment start at: 2024-06-14 23:23:37.861871
before training, model accuracy: 0.14647115767002106
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96714246, 'precision': 0.81691486, 'recall': 0.5006817, 'specificity': 0.5006817, 'f1': 0.49303207, 'auroc': 0.83749163, 'binary_precision': 0.6666667, 'binary_recall': 0.0013869626, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.0027681661}
confusion matrix:
       0  1
0  42413  1
1   1440  2
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.85397136, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.8259276, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324357_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-14 23:42:54.476443,epoch time: 0:19:16.614572,used: 0:19:16.614572,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_23_23_37_seed_1_21324357
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9669145, 'precision': 0.726939, 'recall': 0.54511243, 'specificity': 0.54511243, 'f1': 0.57000583, 'auroc': 0.89369786, 'binary_precision': 0.48387095, 'binary_recall': 0.09361997, 'binary_specificity': 0.9966049, 'binary_f1_score': 0.15688553}
confusion matrix:
       0    1
0  42270  144
1   1307  135
---- Validation: 
scalar performance:
{'acc': 0.9639808, 'precision': 0.72657657, 'recall': 0.5271248, 'specificity': 0.5271248, 'f1': 0.54141027, 'auroc': 0.8969995, 'binary_precision': 0.4871795, 'binary_recall': 0.056463595, 'binary_specificity': 0.99778605, 'binary_f1_score': 0.101198405}
confusion matrix:
       0   1
0  18027  40
1    635  38
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96471155, 'precision': 0.9822384, 'recall': 0.57884616, 'specificity': 0.57884616, 'f1': 0.6271713, 'auroc': 0.865906, 'binary_precision': 1.0, 'binary_recall': 0.15769231, 'binary_specificity': 1.0, 'binary_f1_score': 0.27242526}
confusion matrix:
      0   1
0  5946   0
1   219  41
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324357_2.png
new oracle model saved
early stop counter: 1
val acc:0.9639807939529419, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9647115468978882
after epoch: 2,now: 2024-06-15 00:01:32.889508,epoch time: 0:18:38.413065,used: 0:37:55.027637,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_23_23_37_seed_1_21324357
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96714246, 'precision': 0.73655516, 'recall': 0.57604593, 'specificity': 0.57604593, 'f1': 0.61139315, 'auroc': 0.9029095, 'binary_precision': 0.50110376, 'binary_recall': 0.15742025, 'binary_specificity': 0.9946716, 'binary_f1_score': 0.23957783}
confusion matrix:
       0    1
0  42188  226
1   1215  227
---- Validation: 
scalar performance:
{'acc': 0.9647279, 'precision': 0.76084757, 'recall': 0.5439634, 'specificity': 0.5439634, 'f1': 0.56889933, 'auroc': 0.90436816, 'binary_precision': 0.55454546, 'binary_recall': 0.09063893, 'binary_specificity': 0.99728787, 'binary_f1_score': 0.15581097}
confusion matrix:
       0   1
0  18018  49
1    612  61
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9658395, 'precision': 0.98278666, 'recall': 0.5923077, 'specificity': 0.5923077, 'f1': 0.64708674, 'auroc': 0.8768097, 'binary_precision': 1.0, 'binary_recall': 0.18461539, 'binary_specificity': 1.0, 'binary_f1_score': 0.31168833}
confusion matrix:
      0   1
0  5946   0
1   212  48
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324357_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-15 00:20:03.740950,epoch time: 0:18:30.851442,used: 0:56:25.879079,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_23_23_37_seed_1_21324357
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96718806, 'precision': 0.7376814, 'recall': 0.5774093, 'specificity': 0.5774093, 'f1': 0.6131303, 'auroc': 0.91110873, 'binary_precision': 0.503268, 'binary_recall': 0.16019417, 'binary_specificity': 0.99462444, 'binary_f1_score': 0.24303}
confusion matrix:
       0    1
0  42186  228
1   1211  231
---- Validation: 
scalar performance:
{'acc': 0.96435434, 'precision': 0.7429439, 'recall': 0.55092233, 'specificity': 0.55092233, 'f1': 0.57854605, 'auroc': 0.91870373, 'binary_precision': 0.5182482, 'binary_recall': 0.10549777, 'binary_specificity': 0.99634695, 'binary_f1_score': 0.17530864}
confusion matrix:
       0   1
0  18001  66
1    602  71
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96761197, 'precision': 0.98365057, 'recall': 0.61346155, 'specificity': 0.61346155, 'f1': 0.6766424, 'auroc': 0.8782996, 'binary_precision': 1.0, 'binary_recall': 0.22692308, 'binary_specificity': 1.0, 'binary_f1_score': 0.36990595}
confusion matrix:
      0   1
0  5946   0
1   201  59
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324357_4.png
new oracle model saved
early stop counter: 1
val acc:0.9643543362617493, best validation acc: 0.9647278785705566, corresponding to test acc:                         0.9658395051956177 / 0.9676119685173035
after epoch: 4,now: 2024-06-15 00:38:24.452769,epoch time: 0:18:20.711819,used: 1:14:46.590898,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_23_23_37_seed_1_21324357
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9673705, 'precision': 0.7413404, 'recall': 0.62138236, 'specificity': 0.62138236, 'f1': 0.6596186, 'auroc': 0.91101897, 'binary_precision': 0.5077139, 'binary_recall': 0.25104022, 'binary_specificity': 0.99172443, 'binary_f1_score': 0.33596286}
confusion matrix:
       0    1
0  42063  351
1   1080  362
---- Validation: 
scalar performance:
{'acc': 0.96584845, 'precision': 0.7729042, 'recall': 0.5910369, 'specificity': 0.5910369, 'f1': 0.6325096, 'auroc': 0.9150971, 'binary_precision': 0.5753425, 'binary_recall': 0.1872214, 'binary_specificity': 0.9948525, 'binary_f1_score': 0.2825112}
confusion matrix:
       0    1
0  17974   93
1    547  126
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9687399, 'precision': 0.95748043, 'recall': 0.634279, 'specificity': 0.634279, 'f1': 0.7015497, 'auroc': 0.87421685, 'binary_precision': 0.9459459, 'binary_recall': 0.26923078, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.4191617}
confusion matrix:
      0   1
0  5942   4
1   190  70
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324357_5.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-06-15 00:56:54.164784,epoch time: 0:18:29.712015,used: 1:33:16.302913,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_23_23_37_seed_1_21324357
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96807736, 'precision': 0.7509407, 'recall': 0.6468692, 'specificity': 0.6468692, 'f1': 0.68397933, 'auroc': 0.9212253, 'binary_precision': 0.52524036, 'binary_recall': 0.30305132, 'binary_specificity': 0.990687, 'binary_f1_score': 0.3843448}
confusion matrix:
       0    1
0  42019  395
1   1005  437
---- Validation: 
scalar performance:
{'acc': 0.9665422, 'precision': 0.77894336, 'recall': 0.61357, 'specificity': 0.61357, 'f1': 0.6582639, 'auroc': 0.919087, 'binary_precision': 0.5858209, 'binary_recall': 0.2332838, 'binary_specificity': 0.9938562, 'binary_f1_score': 0.33368754}
confusion matrix:
       0    1
0  17956  111
1    516  157
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9692233, 'precision': 0.9531757, 'recall': 0.64188725, 'specificity': 0.64188725, 'f1': 0.7103789, 'auroc': 0.8829553, 'binary_precision': 0.93670887, 'binary_recall': 0.2846154, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.4365782}
confusion matrix:
      0   1
0  5941   5
1   186  74
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324357_6.png
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-06-15 01:15:21.802282,epoch time: 0:18:27.637498,used: 1:51:43.940411,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_23_23_37_seed_1_21324357
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9679861, 'precision': 0.7498455, 'recall': 0.6378653, 'specificity': 0.6378653, 'f1': 0.67614084, 'auroc': 0.92383707, 'binary_precision': 0.5236271, 'binary_recall': 0.28452465, 'binary_specificity': 0.99120593, 'binary_f1_score': 0.36870506}
confusion matrix:
       0    1
0  42042  373
1   1031  410
---- Validation: 
scalar performance:
{'acc': 0.9654749, 'precision': 0.76544887, 'recall': 0.5865516, 'specificity': 0.5865516, 'f1': 0.626447, 'auroc': 0.9265398, 'binary_precision': 0.5607477, 'binary_recall': 0.17830609, 'binary_specificity': 0.99479717, 'binary_f1_score': 0.27057496}
confusion matrix:
       0    1
0  17973   94
1    553  120
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96809536, 'precision': 0.9761504, 'recall': 0.6210697, 'specificity': 0.6210697, 'f1': 0.6862545, 'auroc': 0.88380766, 'binary_precision': 0.984375, 'binary_recall': 0.2423077, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.3888889}
confusion matrix:
      0   1
0  5945   1
1   197  63
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324357_7.png
early stop counter: 1
val acc:0.9654749035835266, best validation acc: 0.9665421843528748, corresponding to test acc:                         0.9692233204841614 / 0.9692233204841614
after epoch: 7,now: 2024-06-15 01:33:50.244559,epoch time: 0:18:28.442277,used: 2:10:12.382688,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_23_23_37_seed_1_21324357
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.96732485, 'precision': 0.74097013, 'recall': 0.6501646, 'specificity': 0.6501646, 'f1': 0.6839656, 'auroc': 0.9216025, 'binary_precision': 0.5050733, 'binary_recall': 0.3106796, 'binary_specificity': 0.98964965, 'binary_f1_score': 0.38471448}
confusion matrix:
       0    1
0  41975  439
1    994  448
---- Validation: 
scalar performance:
{'acc': 0.96659553, 'precision': 0.78299266, 'recall': 0.6071603, 'specificity': 0.6071603, 'f1': 0.6519589, 'auroc': 0.9236571, 'binary_precision': 0.5943775, 'binary_recall': 0.21991085, 'binary_specificity': 0.9944097, 'binary_f1_score': 0.32104123}
confusion matrix:
       0    1
0  17966  101
1    525  148
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96890104, 'precision': 0.9639621, 'recall': 0.6343631, 'specificity': 0.6343631, 'f1': 0.70222116, 'auroc': 0.8846086, 'binary_precision': 0.9589041, 'binary_recall': 0.26923078, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.42042044}
confusion matrix:
      0   1
0  5943   3
1   190  70
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324357_8.png
better model found
persisted
after epoch: 8,now: 2024-06-15 01:52:22.856452,epoch time: 0:18:32.611893,used: 2:28:44.994581,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_23_23_37_seed_1_21324357
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.968465, 'precision': 0.7595125, 'recall': 0.62295306, 'specificity': 0.62295306, 'f1': 0.6646618, 'auroc': 0.93045974, 'binary_precision': 0.5439642, 'binary_recall': 0.25312066, 'binary_specificity': 0.9927854, 'binary_f1_score': 0.34548035}
confusion matrix:
       0    1
0  42108  306
1   1077  365
---- Validation: 
scalar performance:
{'acc': 0.966222, 'precision': 0.7819929, 'recall': 0.59194595, 'specificity': 0.59194595, 'f1': 0.63453007, 'auroc': 0.9257013, 'binary_precision': 0.59345794, 'binary_recall': 0.18870728, 'binary_specificity': 0.9951846, 'binary_f1_score': 0.2863585}
confusion matrix:
       0    1
0  17980   87
1    546  127
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9658395, 'precision': 0.98278666, 'recall': 0.5923077, 'specificity': 0.5923077, 'f1': 0.64708674, 'auroc': 0.88662815, 'binary_precision': 1.0, 'binary_recall': 0.18461539, 'binary_specificity': 1.0, 'binary_f1_score': 0.31168833}
confusion matrix:
      0   1
0  5946   0
1   212  48
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324357_9.png
early stop counter: 1
val acc:0.9662219882011414, best validation acc: 0.9665955305099487, corresponding to test acc:                         0.9689010381698608 / 0.9692233204841614
after epoch: 9,now: 2024-06-15 02:10:49.815037,epoch time: 0:18:26.958585,used: 2:47:11.953166,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_23_23_37_seed_1_21324357
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9678949, 'precision': 0.7481055, 'recall': 0.6564885, 'specificity': 0.6564885, 'f1': 0.690899, 'auroc': 0.9255105, 'binary_precision': 0.518931, 'binary_recall': 0.3231623, 'binary_specificity': 0.9898147, 'binary_f1_score': 0.39829063}
confusion matrix:
       0    1
0  41982  432
1    976  466
---- Validation: 
scalar performance:
{'acc': 0.9664888, 'precision': 0.77596384, 'recall': 0.61854917, 'specificity': 0.61854917, 'f1': 0.662951, 'auroc': 0.93360054, 'binary_precision': 0.5795053, 'binary_recall': 0.24368499, 'binary_specificity': 0.9934134, 'binary_f1_score': 0.34309626}
confusion matrix:
       0    1
0  17948  119
1    509  164
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96777314, 'precision': 0.9757408, 'recall': 0.6172236, 'specificity': 0.6172236, 'f1': 0.6811696, 'auroc': 0.89214337, 'binary_precision': 0.983871, 'binary_recall': 0.23461539, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.378882}
confusion matrix:
      0   1
0  5945   1
1   199  61
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324357_10.png
early stop counter: 2
val acc:0.966488778591156, best validation acc: 0.9665955305099487, corresponding to test acc:                         0.9689010381698608 / 0.9692233204841614
after epoch: 10,now: 2024-06-15 02:29:23.005551,epoch time: 0:18:33.190514,used: 3:05:45.143680,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_23_23_37_seed_1_21324357
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96803176, 'precision': 0.7492609, 'recall': 0.6739767, 'specificity': 0.6739767, 'f1': 0.70424867, 'auroc': 0.9302335, 'binary_precision': 0.5200803, 'binary_recall': 0.3592233, 'binary_specificity': 0.98873013, 'binary_f1_score': 0.4249385}
confusion matrix:
       0    1
0  41936  478
1    924  518
---- Validation: 
scalar performance:
{'acc': 0.9678762, 'precision': 0.78992814, 'recall': 0.6478794, 'specificity': 0.6478794, 'f1': 0.69372684, 'auroc': 0.92650115, 'binary_precision': 0.60534126, 'binary_recall': 0.30312034, 'binary_specificity': 0.9926385, 'binary_f1_score': 0.40396038}
confusion matrix:
       0    1
0  17934  133
1    469  204
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9693845, 'precision': 0.9650103, 'recall': 0.6401323, 'specificity': 0.6401323, 'f1': 0.70939505, 'auroc': 0.88781536, 'binary_precision': 0.9605263, 'binary_recall': 0.28076923, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.4345238}
confusion matrix:
      0   1
0  5943   3
1   187  73
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324357_11.png
new oracle model saved
better model found
persisted
after epoch: 11,now: 2024-06-15 02:48:06.832965,epoch time: 0:18:43.827414,used: 3:24:28.971094,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_23_23_37_seed_1_21324357
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.96782655, 'precision': 0.74694276, 'recall': 0.67286575, 'specificity': 0.67286575, 'f1': 0.7027055, 'auroc': 0.9324963, 'binary_precision': 0.5155155, 'binary_recall': 0.35714287, 'binary_specificity': 0.9885887, 'binary_f1_score': 0.4219582}
confusion matrix:
       0    1
0  41930  484
1    927  515
---- Validation: 
scalar performance:
{'acc': 0.96766275, 'precision': 0.78173494, 'recall': 0.6620741, 'specificity': 0.6620741, 'f1': 0.7042055, 'auroc': 0.9287693, 'binary_precision': 0.5879265, 'binary_recall': 0.33283803, 'binary_specificity': 0.9913101, 'binary_f1_score': 0.42504743}
confusion matrix:
       0    1
0  17910  157
1    449  224
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9709958, 'precision': 0.96288896, 'recall': 0.66120213, 'specificity': 0.66120213, 'f1': 0.7339191, 'auroc': 0.88998455, 'binary_precision': 0.95454544, 'binary_recall': 0.32307693, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.4827586}
confusion matrix:
      0   1
0  5942   4
1   176  84
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324357_12.png
new oracle model saved
early stop counter: 1
val acc:0.9676627516746521, best validation acc: 0.9678761959075928, corresponding to test acc:                         0.969384491443634 / 0.9709957838058472
after epoch: 12,now: 2024-06-15 03:06:49.576759,epoch time: 0:18:42.743794,used: 3:43:11.714888,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_23_23_37_seed_1_21324357
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.96830535, 'precision': 0.75313807, 'recall': 0.6610551, 'specificity': 0.6610551, 'f1': 0.6958618, 'auroc': 0.9279829, 'binary_precision': 0.52869755, 'binary_recall': 0.33217752, 'binary_specificity': 0.9899326, 'binary_f1_score': 0.4080068}
confusion matrix:
       0    1
0  41987  427
1    963  479
---- Validation: 
scalar performance:
{'acc': 0.9669691, 'precision': 0.77116984, 'recall': 0.6660059, 'specificity': 0.6660059, 'f1': 0.7046578, 'auroc': 0.93221575, 'binary_precision': 0.56650245, 'binary_recall': 0.34175333, 'binary_specificity': 0.99025846, 'binary_f1_score': 0.42632064}
confusion matrix:
       0    1
0  17891  176
1    443  230
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9732517, 'precision': 0.96276915, 'recall': 0.6899642, 'specificity': 0.6899642, 'f1': 0.7650889, 'auroc': 0.89418566, 'binary_precision': 0.9519231, 'binary_recall': 0.38076922, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.54395604}
confusion matrix:
      0   1
0  5941   5
1   161  99
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324357_13.png
new oracle model saved
early stop counter: 2
val acc:0.9669690728187561, best validation acc: 0.9678761959075928, corresponding to test acc:                         0.969384491443634 / 0.9732517004013062
after epoch: 13,now: 2024-06-15 03:25:16.170461,epoch time: 0:18:26.593702,used: 4:01:38.308590,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_23_23_37_seed_1_21324357
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.968237, 'precision': 0.75270593, 'recall': 0.65365076, 'specificity': 0.65365076, 'f1': 0.6899375, 'auroc': 0.9295566, 'binary_precision': 0.5283237, 'binary_recall': 0.31692094, 'binary_specificity': 0.9903805, 'binary_f1_score': 0.39618552}
confusion matrix:
       0    1
0  42006  408
1    985  457
---- Validation: 
scalar performance:
{'acc': 0.9676094, 'precision': 0.7996628, 'recall': 0.6184151, 'specificity': 0.6184151, 'f1': 0.6664009, 'auroc': 0.92958766, 'binary_precision': 0.6269231, 'binary_recall': 0.24219911, 'binary_specificity': 0.9946311, 'binary_f1_score': 0.3494105}
confusion matrix:
       0    1
0  17970   97
1    510  163
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96745086, 'precision': 0.9753146, 'recall': 0.61337745, 'specificity': 0.61337745, 'f1': 0.67602235, 'auroc': 0.8944683, 'binary_precision': 0.98333335, 'binary_recall': 0.22692308, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.36875}
confusion matrix:
      0   1
0  5945   1
1   201  59
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324357_14.png
early stop counter: 3
val acc:0.9676094055175781, best validation acc: 0.9678761959075928, corresponding to test acc:                         0.969384491443634 / 0.9732517004013062
after epoch: 14,now: 2024-06-15 03:43:39.899554,epoch time: 0:18:23.729093,used: 4:20:02.037683,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_23_23_37_seed_1_21324357
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9684194, 'precision': 0.7547036, 'recall': 0.6597742, 'specificity': 0.6597742, 'f1': 0.695315, 'auroc': 0.93391705, 'binary_precision': 0.5319149, 'binary_recall': 0.3294036, 'binary_specificity': 0.9901448, 'binary_f1_score': 0.40685225}
confusion matrix:
       0    1
0  41996  418
1    967  475
---- Validation: 
scalar performance:
{'acc': 0.96734256, 'precision': 0.79374474, 'recall': 0.6182767, 'specificity': 0.6182767, 'f1': 0.6654001, 'auroc': 0.9323232, 'binary_precision': 0.61509436, 'binary_recall': 0.24219911, 'binary_specificity': 0.99435437, 'binary_f1_score': 0.34754798}
confusion matrix:
       0    1
0  17965  102
1    510  163
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9693845, 'precision': 0.9845176, 'recall': 0.6346154, 'specificity': 0.6346154, 'f1': 0.70425826, 'auroc': 0.8929547, 'binary_precision': 1.0, 'binary_recall': 0.26923078, 'binary_specificity': 1.0, 'binary_f1_score': 0.4242424}
confusion matrix:
      0   1
0  5946   0
1   190  70
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324357_15.png
early stop counter: 4
val acc:0.9673425555229187, best validation acc: 0.9678761959075928, corresponding to test acc:                         0.969384491443634 / 0.9732517004013062
after epoch: 15,now: 2024-06-15 04:02:02.043594,epoch time: 0:18:22.144040,used: 4:38:24.181723,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_23_23_37_seed_1_21324357
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.968807, 'precision': 0.7601346, 'recall': 0.6576299, 'specificity': 0.6576299, 'f1': 0.6951164, 'auroc': 0.93168724, 'binary_precision': 0.54292345, 'binary_recall': 0.32454923, 'binary_specificity': 0.9907106, 'binary_f1_score': 0.40625}
confusion matrix:
       0    1
0  42020  394
1    974  468
---- Validation: 
scalar performance:
{'acc': 0.9677695, 'precision': 0.799595, 'recall': 0.62422025, 'specificity': 0.62422025, 'f1': 0.6724948, 'auroc': 0.92661774, 'binary_precision': 0.62637365, 'binary_recall': 0.25408617, 'binary_specificity': 0.99435437, 'binary_f1_score': 0.3615222}
confusion matrix:
       0    1
0  17965  102
1    502  171
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96471155, 'precision': 0.9822384, 'recall': 0.57884616, 'specificity': 0.57884616, 'f1': 0.6271713, 'auroc': 0.88791347, 'binary_precision': 1.0, 'binary_recall': 0.15769231, 'binary_specificity': 1.0, 'binary_f1_score': 0.27242526}
confusion matrix:
      0   1
0  5946   0
1   219  41
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324357_16.png
early stop counter: 5
val acc:0.9677695035934448, best validation acc: 0.9678761959075928, corresponding to test acc:                         0.969384491443634 / 0.9732517004013062
after epoch: 16,now: 2024-06-15 04:20:28.011913,epoch time: 0:18:25.968319,used: 4:56:50.150042,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_23_23_37_seed_1_21324357
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.96928585, 'precision': 0.76611245, 'recall': 0.66290176, 'specificity': 0.66290176, 'f1': 0.7009332, 'auroc': 0.9323542, 'binary_precision': 0.55453503, 'binary_recall': 0.33495146, 'binary_specificity': 0.99085206, 'binary_f1_score': 0.41763943}
confusion matrix:
       0    1
0  42026  388
1    959  483
---- Validation: 
scalar performance:
{'acc': 0.9669691, 'precision': 0.8002805, 'recall': 0.59519446, 'specificity': 0.59519446, 'f1': 0.64023817, 'auroc': 0.92913496, 'binary_precision': 0.6298077, 'binary_recall': 0.19465081, 'binary_specificity': 0.9957381, 'binary_f1_score': 0.29738933}
confusion matrix:
       0    1
0  17990   77
1    542  131
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9648727, 'precision': 0.97102845, 'recall': 0.5826082, 'specificity': 0.5826082, 'f1': 0.63244504, 'auroc': 0.8852551, 'binary_precision': 0.97727275, 'binary_recall': 0.16538462, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.28289473}
confusion matrix:
      0   1
0  5945   1
1   217  43
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324357_17.png
early stop counter: 6
val acc:0.9669690728187561, best validation acc: 0.9678761959075928, corresponding to test acc:                         0.969384491443634 / 0.9732517004013062
after epoch: 17,now: 2024-06-15 04:38:58.132889,epoch time: 0:18:30.120976,used: 5:15:20.271018,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_23_23_37_seed_1_21324357
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.96889824, 'precision': 0.758539, 'recall': 0.68681794, 'specificity': 0.68681794, 'f1': 0.71633196, 'auroc': 0.934658, 'binary_precision': 0.5377907, 'binary_recall': 0.38488212, 'binary_specificity': 0.98875374, 'binary_f1_score': 0.44866613}
confusion matrix:
       0    1
0  41937  477
1    887  555
---- Validation: 
scalar performance:
{'acc': 0.9688901, 'precision': 0.80231285, 'recall': 0.65913427, 'specificity': 0.65913427, 'f1': 0.7065003, 'auroc': 0.92880595, 'binary_precision': 0.62931037, 'binary_recall': 0.3254086, 'binary_specificity': 0.9928599, 'binary_f1_score': 0.4289912}
confusion matrix:
       0    1
0  17938  129
1    454  219
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9693845, 'precision': 0.9650103, 'recall': 0.6401323, 'specificity': 0.6401323, 'f1': 0.70939505, 'auroc': 0.8907928, 'binary_precision': 0.9605263, 'binary_recall': 0.28076923, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.4345238}
confusion matrix:
      0   1
0  5943   3
1   187  73
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324357_18.png
better model found
persisted
after epoch: 18,now: 2024-06-15 04:57:21.104531,epoch time: 0:18:22.971642,used: 5:33:43.242660,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_23_23_37_seed_1_21324357
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.96919465, 'precision': 0.7654958, 'recall': 0.6585002, 'specificity': 0.6585002, 'f1': 0.6972427, 'auroc': 0.93773925, 'binary_precision': 0.55359244, 'binary_recall': 0.3259362, 'binary_specificity': 0.99106425, 'binary_f1_score': 0.41030118}
confusion matrix:
       0    1
0  42035  379
1    972  470
---- Validation: 
scalar performance:
{'acc': 0.9681964, 'precision': 0.80958235, 'recall': 0.62372637, 'specificity': 0.62372637, 'f1': 0.67346936, 'auroc': 0.93162024, 'binary_precision': 0.6463878, 'binary_recall': 0.25260028, 'binary_specificity': 0.9948525, 'binary_f1_score': 0.36324784}
confusion matrix:
       0    1
0  17974   93
1    503  170
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9655172, 'precision': 0.9826299, 'recall': 0.5884615, 'specificity': 0.5884615, 'f1': 0.6414882, 'auroc': 0.8908206, 'binary_precision': 1.0, 'binary_recall': 0.17692308, 'binary_specificity': 1.0, 'binary_f1_score': 0.3006536}
confusion matrix:
      0   1
0  5946   0
1   214  46
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324357_19.png
early stop counter: 1
val acc:0.9681963920593262, best validation acc: 0.9688900709152222, corresponding to test acc:                         0.969384491443634 / 0.9732517004013062
after epoch: 19,now: 2024-06-15 05:15:47.836072,epoch time: 0:18:26.731541,used: 5:52:09.974201,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_23_23_37_seed_1_21324357
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.97017515, 'precision': 0.77212596, 'recall': 0.6988664, 'specificity': 0.6988664, 'f1': 0.72925305, 'auroc': 0.93449664, 'binary_precision': 0.56417626, 'binary_recall': 0.40846047, 'binary_specificity': 0.9892724, 'binary_f1_score': 0.4738536}
confusion matrix:
       0    1
0  41959  455
1    853  589
---- Validation: 
scalar performance:
{'acc': 0.96840984, 'precision': 0.7971537, 'recall': 0.65244776, 'specificity': 0.65244776, 'f1': 0.69939315, 'auroc': 0.9329547, 'binary_precision': 0.61946905, 'binary_recall': 0.31203565, 'binary_specificity': 0.9928599, 'binary_f1_score': 0.41501975}
confusion matrix:
       0    1
0  17938  129
1    463  210
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96890104, 'precision': 0.9639621, 'recall': 0.6343631, 'specificity': 0.6343631, 'f1': 0.70222116, 'auroc': 0.89251983, 'binary_precision': 0.9589041, 'binary_recall': 0.26923078, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.42042044}
confusion matrix:
      0   1
0  5943   3
1   190  70
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324357_20.png
early stop counter: 2
val acc:0.9684098362922668, best validation acc: 0.9688900709152222, corresponding to test acc:                         0.969384491443634 / 0.9732517004013062
after epoch: 20,now: 2024-06-15 05:34:13.057189,epoch time: 0:18:25.221117,used: 6:10:35.195318,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_23_23_37_seed_1_21324357
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.969263, 'precision': 0.76295143, 'recall': 0.68533176, 'specificity': 0.68533176, 'f1': 0.7167683, 'auroc': 0.9396428, 'binary_precision': 0.5467197, 'binary_recall': 0.3814147, 'binary_specificity': 0.9892488, 'binary_f1_score': 0.4493464}
confusion matrix:
       0    1
0  41958  456
1    892  550
---- Validation: 
scalar performance:
{'acc': 0.9684632, 'precision': 0.80200976, 'recall': 0.64460754, 'specificity': 0.64460754, 'f1': 0.6931155, 'auroc': 0.93528736, 'binary_precision': 0.62974685, 'binary_recall': 0.29569092, 'binary_specificity': 0.99352413, 'binary_f1_score': 0.40242666}
confusion matrix:
       0    1
0  17950  117
1    474  199
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.970029, 'precision': 0.98483366, 'recall': 0.6423077, 'specificity': 0.6423077, 'f1': 0.71385694, 'auroc': 0.8935857, 'binary_precision': 1.0, 'binary_recall': 0.2846154, 'binary_specificity': 1.0, 'binary_f1_score': 0.44311377}
confusion matrix:
      0   1
0  5946   0
1   186  74
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324357_21.png
early stop counter: 3
val acc:0.9684631824493408, best validation acc: 0.9688900709152222, corresponding to test acc:                         0.969384491443634 / 0.9732517004013062
after epoch: 21,now: 2024-06-15 05:52:38.204061,epoch time: 0:18:25.146872,used: 6:29:00.342190,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_23_23_37_seed_1_21324357
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.96937704, 'precision': 0.76293635, 'recall': 0.69878876, 'specificity': 0.69878876, 'f1': 0.7259661, 'auroc': 0.9428035, 'binary_precision': 0.5457909, 'binary_recall': 0.40915394, 'binary_specificity': 0.98842365, 'binary_f1_score': 0.46769717}
confusion matrix:
       0    1
0  41923  491
1    852  590
---- Validation: 
scalar performance:
{'acc': 0.9681964, 'precision': 0.78772724, 'recall': 0.66807294, 'specificity': 0.66807294, 'f1': 0.7106856, 'auroc': 0.9353644, 'binary_precision': 0.5994832, 'binary_recall': 0.3447251, 'binary_specificity': 0.9914208, 'binary_f1_score': 0.43773586}
confusion matrix:
       0    1
0  17912  155
1    441  232
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9703513, 'precision': 0.97865826, 'recall': 0.64799285, 'specificity': 0.64799285, 'f1': 0.720191, 'auroc': 0.8942008, 'binary_precision': 0.98717946, 'binary_recall': 0.29615384, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.4556213}
confusion matrix:
      0   1
0  5945   1
1   183  77
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324357_22.png
early stop counter: 4
val acc:0.9681963920593262, best validation acc: 0.9688900709152222, corresponding to test acc:                         0.969384491443634 / 0.9732517004013062
after epoch: 22,now: 2024-06-15 06:10:57.698890,epoch time: 0:18:19.494829,used: 6:47:19.837019,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_23_23_37_seed_1_21324357
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9702891, 'precision': 0.77322185, 'recall': 0.70060015, 'specificity': 0.70060015, 'f1': 0.7308136, 'auroc': 0.9343699, 'binary_precision': 0.5662536, 'binary_recall': 0.41192788, 'binary_specificity': 0.9892724, 'binary_f1_score': 0.4769169}
confusion matrix:
       0    1
0  41959  455
1    848  594
---- Validation: 
scalar performance:
{'acc': 0.9680363, 'precision': 0.7977288, 'recall': 0.63723344, 'specificity': 0.63723344, 'f1': 0.68524456, 'auroc': 0.93593323, 'binary_precision': 0.62171054, 'binary_recall': 0.28083208, 'binary_specificity': 0.9936348, 'binary_f1_score': 0.38689867}
confusion matrix:
       0    1
0  17952  115
1    484  189
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9663229, 'precision': 0.983022, 'recall': 0.59807694, 'specificity': 0.59807694, 'f1': 0.65535146, 'auroc': 0.8941311, 'binary_precision': 1.0, 'binary_recall': 0.19615385, 'binary_specificity': 1.0, 'binary_f1_score': 0.32797426}
confusion matrix:
      0   1
0  5946   0
1   209  51
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324357_23.png
early stop counter: 5
val acc:0.9680362939834595, best validation acc: 0.9688900709152222, corresponding to test acc:                         0.969384491443634 / 0.9732517004013062
after epoch: 23,now: 2024-06-15 06:29:19.473635,epoch time: 0:18:21.774745,used: 7:05:41.611764,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_23_23_37_seed_1_21324357
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.96958226, 'precision': 0.7667692, 'recall': 0.6858318, 'specificity': 0.6858318, 'f1': 0.7183689, 'auroc': 0.9399754, 'binary_precision': 0.55432594, 'binary_recall': 0.38210818, 'binary_specificity': 0.98955536, 'binary_f1_score': 0.45238096}
confusion matrix:
       0    1
0  41971  443
1    891  551
---- Validation: 
scalar performance:
{'acc': 0.96824974, 'precision': 0.80312586, 'recall': 0.63519835, 'specificity': 0.63519835, 'f1': 0.6841997, 'auroc': 0.93646157, 'binary_precision': 0.63265306, 'binary_recall': 0.27637443, 'binary_specificity': 0.99402225, 'binary_f1_score': 0.38469493}
confusion matrix:
       0    1
0  17959  108
1    487  186
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9668063, 'precision': 0.97440475, 'recall': 0.6056851, 'specificity': 0.6056851, 'f1': 0.66553545, 'auroc': 0.8928789, 'binary_precision': 0.98214287, 'binary_recall': 0.21153846, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.34810126}
confusion matrix:
      0   1
0  5945   1
1   205  55
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324357_24.png
early stop counter: 6
val acc:0.9682497382164001, best validation acc: 0.9688900709152222, corresponding to test acc:                         0.969384491443634 / 0.9732517004013062
after epoch: 24,now: 2024-06-15 06:47:46.908314,epoch time: 0:18:27.434679,used: 7:24:09.046443,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_23_23_37_seed_1_21324357
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.969263, 'precision': 0.76035583, 'recall': 0.71327347, 'specificity': 0.71327347, 'f1': 0.7342373, 'auroc': 0.9414079, 'binary_precision': 0.5396419, 'binary_recall': 0.43927827, 'binary_specificity': 0.9872686, 'binary_f1_score': 0.48431522}
confusion matrix:
       0    1
0  41875  540
1    808  633
---- Validation: 
scalar performance:
{'acc': 0.9681964, 'precision': 0.78216773, 'recall': 0.68810046, 'specificity': 0.68810046, 'f1': 0.72478, 'auroc': 0.93531203, 'binary_precision': 0.58690745, 'binary_recall': 0.38632986, 'binary_specificity': 0.989871, 'binary_f1_score': 0.46594983}
confusion matrix:
       0    1
0  17884  183
1    413  260
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97196263, 'precision': 0.93938756, 'recall': 0.6837745, 'specificity': 0.6837745, 'f1': 0.75507283, 'auroc': 0.89848703, 'binary_precision': 0.9056604, 'binary_recall': 0.36923078, 'binary_specificity': 0.9983182, 'binary_f1_score': 0.5245902}
confusion matrix:
      0   1
0  5936  10
1   164  96
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324357_25.png
early stop counter: 7
val acc:0.9681963920593262, best validation acc: 0.9688900709152222, corresponding to test acc:                         0.969384491443634 / 0.9732517004013062
after epoch: 25,now: 2024-06-15 07:06:13.548718,epoch time: 0:18:26.640404,used: 7:42:35.686847,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_23_23_37_seed_1_21324357
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9699699, 'precision': 0.77341735, 'recall': 0.6756486, 'specificity': 0.6756486, 'f1': 0.7129046, 'auroc': 0.9392958, 'binary_precision': 0.568306, 'binary_recall': 0.36061028, 'binary_specificity': 0.990687, 'binary_f1_score': 0.44123888}
confusion matrix:
       0    1
0  42019  395
1    922  520
---- Validation: 
scalar performance:
{'acc': 0.968143, 'precision': 0.80139804, 'recall': 0.6344277, 'specificity': 0.6344277, 'f1': 0.6831382, 'auroc': 0.9360152, 'binary_precision': 0.6292517, 'binary_recall': 0.27488855, 'binary_specificity': 0.9939669, 'binary_f1_score': 0.38262668}
confusion matrix:
       0    1
0  17958  109
1    488  185
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9666452, 'precision': 0.983179, 'recall': 0.6019231, 'specificity': 0.6019231, 'f1': 0.66077465, 'auroc': 0.8906801, 'binary_precision': 1.0, 'binary_recall': 0.20384616, 'binary_specificity': 1.0, 'binary_f1_score': 0.33865812}
confusion matrix:
      0   1
0  5946   0
1   207  53
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324357_26.png
early stop counter: 8
val acc:0.9681429862976074, best validation acc: 0.9688900709152222, corresponding to test acc:                         0.969384491443634 / 0.9732517004013062
after epoch: 26,now: 2024-06-15 07:24:36.964707,epoch time: 0:18:23.415989,used: 8:00:59.102836,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_23_23_37_seed_1_21324357
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.96910346, 'precision': 0.7598132, 'recall': 0.7003221, 'specificity': 0.7003221, 'f1': 0.72583675, 'auroc': 0.9409008, 'binary_precision': 0.5394379, 'binary_recall': 0.41262135, 'binary_specificity': 0.9880228, 'binary_f1_score': 0.46758348}
confusion matrix:
       0    1
0  41906  508
1    847  595
---- Validation: 
scalar performance:
{'acc': 0.9685699, 'precision': 0.8040167, 'recall': 0.64466286, 'specificity': 0.64466286, 'f1': 0.693551, 'auroc': 0.93559647, 'binary_precision': 0.63375795, 'binary_recall': 0.29569092, 'binary_specificity': 0.9936348, 'binary_f1_score': 0.40324214}
confusion matrix:
       0    1
0  17952  115
1    474  199
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96696746, 'precision': 0.98333603, 'recall': 0.6057692, 'specificity': 0.6057692, 'f1': 0.66613, 'auroc': 0.88623315, 'binary_precision': 1.0, 'binary_recall': 0.21153846, 'binary_specificity': 1.0, 'binary_f1_score': 0.34920636}
confusion matrix:
      0   1
0  5946   0
1   205  55
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324357_27.png
early stop counter: 9
val acc:0.9685698747634888, best validation acc: 0.9688900709152222, corresponding to test acc:                         0.969384491443634 / 0.9732517004013062
after epoch: 27,now: 2024-06-15 07:42:58.019521,epoch time: 0:18:21.054814,used: 8:19:20.157650,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_23_23_37_seed_1_21324357
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9690578, 'precision': 0.75949275, 'recall': 0.6979538, 'specificity': 0.6979538, 'f1': 0.7241702, 'auroc': 0.9372679, 'binary_precision': 0.5389551, 'binary_recall': 0.407767, 'binary_specificity': 0.9881407, 'binary_f1_score': 0.46427163}
confusion matrix:
       0    1
0  41911  503
1    854  588
---- Validation: 
scalar performance:
{'acc': 0.9686766, 'precision': 0.7948698, 'recall': 0.668322, 'specificity': 0.668322, 'f1': 0.7126854, 'auroc': 0.9379457, 'binary_precision': 0.6137566, 'binary_recall': 0.3447251, 'binary_specificity': 0.991919, 'binary_f1_score': 0.4414843}
confusion matrix:
       0    1
0  17921  146
1    441  232
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97019017, 'precision': 0.98491275, 'recall': 0.6442308, 'specificity': 0.6442308, 'f1': 0.71622145, 'auroc': 0.89798236, 'binary_precision': 1.0, 'binary_recall': 0.28846154, 'binary_specificity': 1.0, 'binary_f1_score': 0.44776118}
confusion matrix:
      0   1
0  5946   0
1   185  75
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324357_28.png
early stop counter: 10
val acc:0.9686766266822815, best validation acc: 0.9688900709152222, corresponding to test acc:                         0.969384491443634 / 0.9732517004013062
after epoch: 28,now: 2024-06-15 08:01:18.114565,epoch time: 0:18:20.095044,used: 8:37:40.252694,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_23_23_37_seed_1_21324357
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9690806, 'precision': 0.76018465, 'recall': 0.6922715, 'specificity': 0.6922715, 'f1': 0.7206264, 'auroc': 0.9413371, 'binary_precision': 0.5407197, 'binary_recall': 0.3959778, 'binary_specificity': 0.9885651, 'binary_f1_score': 0.45716575}
confusion matrix:
       0    1
0  41929  485
1    871  571
---- Validation: 
scalar performance:
{'acc': 0.9677161, 'precision': 0.7898186, 'recall': 0.641359, 'specificity': 0.641359, 'f1': 0.6876888, 'auroc': 0.9362911, 'binary_precision': 0.60559005, 'binary_recall': 0.2897474, 'binary_specificity': 0.9929706, 'binary_f1_score': 0.39195976}
confusion matrix:
       0    1
0  17940  127
1    478  195
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96890104, 'precision': 0.9771108, 'recall': 0.63068515, 'specificity': 0.63068515, 'f1': 0.6987005, 'auroc': 0.8968597, 'binary_precision': 0.98550725, 'binary_recall': 0.26153848, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.4133739}
confusion matrix:
      0   1
0  5945   1
1   192  68
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324357_29.png
early stop counter: 11
val acc:0.9677160978317261, best validation acc: 0.9688900709152222, corresponding to test acc:                         0.969384491443634 / 0.9732517004013062
after epoch: 29,now: 2024-06-15 08:19:37.227663,epoch time: 0:18:19.113098,used: 8:55:59.365792,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_23_23_37_seed_1_21324357
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9699699, 'precision': 0.7687289, 'recall': 0.70646423, 'specificity': 0.70646423, 'f1': 0.73311853, 'auroc': 0.93768674, 'binary_precision': 0.55686986, 'binary_recall': 0.42441055, 'binary_specificity': 0.98851794, 'binary_f1_score': 0.4817001}
confusion matrix:
       0    1
0  41927  487
1    830  612
---- Validation: 
scalar performance:
{'acc': 0.968143, 'precision': 0.78935635, 'recall': 0.6608926, 'specificity': 0.6608926, 'f1': 0.7050647, 'auroc': 0.9359833, 'binary_precision': 0.6032609, 'binary_recall': 0.32986626, 'binary_specificity': 0.991919, 'binary_f1_score': 0.42651296}
confusion matrix:
       0    1
0  17921  146
1    451  222
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9687399, 'precision': 0.97006893, 'recall': 0.63060105, 'specificity': 0.63060105, 'f1': 0.6980322, 'auroc': 0.9021147, 'binary_precision': 0.9714286, 'binary_recall': 0.26153848, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.41212127}
confusion matrix:
      0   1
0  5944   2
1   192  68
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324357_30.png
early stop counter: 12
val acc:0.9681429862976074, best validation acc: 0.9688900709152222, corresponding to test acc:                         0.969384491443634 / 0.9732517004013062
after epoch: 30,now: 2024-06-15 08:38:07.381993,epoch time: 0:18:30.154330,used: 9:14:29.520122,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_23_23_37_seed_1_21324357
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 9:14:29.520122 at 2024-06-15 08:38:07.381993
persisted model performance metric: 

scalar performance:
{'acc': 0.9693845, 'precision': 0.9650103, 'recall': 0.6401323, 'specificity': 0.6401323, 'f1': 0.70939505, 'auroc': 0.8907928, 'binary_precision': 0.9605263, 'binary_recall': 0.28076923, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.4345238}
confusion matrix:
      0   1
0  5943   3
1   187  73
oracle model performance metric: 

scalar performance:
{'acc': 0.9732517, 'precision': 0.96276915, 'recall': 0.6899642, 'specificity': 0.6899642, 'f1': 0.7650889, 'auroc': 0.89418566, 'binary_precision': 0.9519231, 'binary_recall': 0.38076922, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.54395604}
confusion matrix:
      0   1
0  5941   5
1   161  99
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_bs16_different_learningrates/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_resnet_bs16_different_learningrates/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204071 KiB | 640729 KiB |   1888 TiB |   1888 TiB |
|       from large pool | 167040 KiB | 568000 KiB |   1888 TiB |   1888 TiB |
|       from small pool |  37031 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 204071 KiB | 640729 KiB |   1888 TiB |   1888 TiB |
|       from large pool | 167040 KiB | 568000 KiB |   1888 TiB |   1888 TiB |
|       from small pool |  37031 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201086 KiB | 632296 KiB |   1880 TiB |   1880 TiB |
|       from large pool | 165120 KiB | 560704 KiB |   1880 TiB |   1880 TiB |
|       from small pool |  35966 KiB |  73944 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 675840 KiB | 755712 KiB |   1120 MiB | 471040 KiB |
|       from large pool | 600064 KiB | 679936 KiB |   1020 MiB | 444416 KiB |
|       from small pool |  75776 KiB |  75776 KiB |    100 MiB |  26624 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  80600 KiB | 218089 KiB | 709644 GiB | 709644 GiB |
|       from large pool |  68480 KiB | 217080 KiB | 709036 GiB | 709036 GiB |
|       from small pool |  12120 KiB |  19703 KiB |    608 GiB |    608 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3228    |    6231    |  167412 K  |  167409 K  |
|       from large pool |      36    |      76    |   67679 K  |   67679 K  |
|       from small pool |    3192    |    6194    |   99733 K  |   99730 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3228    |    6231    |  167412 K  |  167409 K  |
|       from large pool |      36    |      76    |   67679 K  |   67679 K  |
|       from small pool |    3192    |    6194    |   99733 K  |   99730 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      51    |      51    |      68    |      17    |
|       from large pool |      14    |      14    |      18    |       4    |
|       from small pool |      37    |      37    |      50    |      13    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      37    |    2756    |   76250 K  |   76250 K  |
|       from large pool |       5    |      13    |   25322 K  |   25322 K  |
|       from small pool |      32    |    2751    |   50927 K  |   50927 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 640729 KiB |   1888 TiB |   1888 TiB |
|       from large pool |  16640 KiB | 568000 KiB |   1888 TiB |   1888 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 640729 KiB |   1888 TiB |   1888 TiB |
|       from large pool |  16640 KiB | 568000 KiB |   1888 TiB |   1888 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 632296 KiB |   1880 TiB |   1880 TiB |
|       from large pool |  16640 KiB | 560704 KiB |   1880 TiB |   1880 TiB |
|       from small pool |      0 KiB |  73944 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 284672 KiB | 755712 KiB |   1120 MiB |    842 MiB |
|       from large pool | 235520 KiB | 679936 KiB |   1020 MiB |    790 MiB |
|       from small pool |  49152 KiB |  75776 KiB |    100 MiB |     52 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  55040 KiB | 218089 KiB | 709645 GiB | 709645 GiB |
|       from large pool |  55040 KiB | 217080 KiB | 709036 GiB | 709036 GiB |
|       from small pool |      0 KiB |  19715 KiB |    608 GiB |    608 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6231    |  167412 K  |  167412 K  |
|       from large pool |       2    |      76    |   67679 K  |   67679 K  |
|       from small pool |       0    |    6194    |   99733 K  |   99733 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6231    |  167412 K  |  167412 K  |
|       from large pool |       2    |      76    |   67679 K  |   67679 K  |
|       from small pool |       0    |    6194    |   99733 K  |   99733 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      34    |      51    |      68    |      34    |
|       from large pool |      10    |      14    |      18    |       8    |
|       from small pool |      24    |      37    |      50    |      26    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2756    |   76251 K  |   76251 K  |
|       from large pool |       3    |      13    |   25322 K  |   25322 K  |
|       from small pool |       0    |    2751    |   50929 K  |   50929 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 640729 KiB |   1888 TiB |   1888 TiB |
|       from large pool |  16640 KiB | 568000 KiB |   1888 TiB |   1888 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 640729 KiB |   1888 TiB |   1888 TiB |
|       from large pool |  16640 KiB | 568000 KiB |   1888 TiB |   1888 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 632296 KiB |   1880 TiB |   1880 TiB |
|       from large pool |  16640 KiB | 560704 KiB |   1880 TiB |   1880 TiB |
|       from small pool |      0 KiB |  73944 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 284672 KiB | 755712 KiB |   1120 MiB |    842 MiB |
|       from large pool | 235520 KiB | 679936 KiB |   1020 MiB |    790 MiB |
|       from small pool |  49152 KiB |  75776 KiB |    100 MiB |     52 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  55040 KiB | 218089 KiB | 709645 GiB | 709645 GiB |
|       from large pool |  55040 KiB | 217080 KiB | 709036 GiB | 709036 GiB |
|       from small pool |      0 KiB |  19715 KiB |    608 GiB |    608 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6231    |  167412 K  |  167412 K  |
|       from large pool |       2    |      76    |   67679 K  |   67679 K  |
|       from small pool |       0    |    6194    |   99733 K  |   99733 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6231    |  167412 K  |  167412 K  |
|       from large pool |       2    |      76    |   67679 K  |   67679 K  |
|       from small pool |       0    |    6194    |   99733 K  |   99733 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      34    |      51    |      68    |      34    |
|       from large pool |      10    |      14    |      18    |       8    |
|       from small pool |      24    |      37    |      50    |      26    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2756    |   76251 K  |   76251 K  |
|       from large pool |       3    |      13    |   25322 K  |   25322 K  |
|       from small pool |       0    |    2751    |   50929 K  |   50929 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0




!!!: not committed yet



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_08_45_30_seed_2_21324357

 Experiment start at: 2024-06-15 08:45:30.114812
before training, model accuracy: 0.0544959120452404
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9654983, 'precision': 0.78277004, 'recall': 0.5009678, 'specificity': 0.5009678, 'f1': 0.49319884, 'auroc': 0.8386203, 'binary_precision': 0.6, 'binary_recall': 0.0019828156, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.0039525693}
confusion matrix:
       0  1
0  42309  2
1   1510  3
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.8391725, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.8263026, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324357_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-15 09:04:22.778392,epoch time: 0:18:52.663580,used: 0:18:52.663580,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_08_45_30_seed_2_21324357
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96501917, 'precision': 0.7196389, 'recall': 0.55042934, 'specificity': 0.55042934, 'f1': 0.57696563, 'auroc': 0.8959172, 'binary_precision': 0.4704142, 'binary_recall': 0.105089225, 'binary_specificity': 0.99576944, 'binary_f1_score': 0.17179903}
confusion matrix:
       0    1
0  42132  179
1   1354  159
---- Validation: 
scalar performance:
{'acc': 0.9677196, 'precision': 0.7239288, 'recall': 0.534421, 'specificity': 0.534421, 'f1': 0.55391705, 'auroc': 0.90701723, 'binary_precision': 0.47777778, 'binary_recall': 0.071428575, 'binary_specificity': 0.99741346, 'binary_f1_score': 0.12427746}
confusion matrix:
       0   1
0  18124  47
1    559  43
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97002727, 'precision': 0.9680832, 'recall': 0.6176019, 'specificity': 0.6176019, 'f1': 0.68169034, 'auroc': 0.87269926, 'binary_precision': 0.9661017, 'binary_recall': 0.23553719, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.3787375}
confusion matrix:
      0   1
0  5995   2
1   185  57
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324357_2.png
new oracle model saved
early stop counter: 1
val acc:0.9677196145057678, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9700272679328918
after epoch: 2,now: 2024-06-15 09:22:48.255975,epoch time: 0:18:25.477583,used: 0:37:18.141163,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_08_45_30_seed_2_21324357
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96527016, 'precision': 0.7325643, 'recall': 0.5996317, 'specificity': 0.5996317, 'f1': 0.6368164, 'auroc': 0.9029208, 'binary_precision': 0.4929134, 'binary_recall': 0.20687376, 'binary_specificity': 0.9923897, 'binary_f1_score': 0.2914339}
confusion matrix:
       0    1
0  41989  322
1   1200  313
---- Validation: 
scalar performance:
{'acc': 0.9688382, 'precision': 0.76119936, 'recall': 0.5759543, 'specificity': 0.5759543, 'f1': 0.6136499, 'auroc': 0.90867454, 'binary_precision': 0.5497076, 'binary_recall': 0.15614618, 'binary_specificity': 0.99576247, 'binary_f1_score': 0.24320829}
confusion matrix:
       0   1
0  18094  77
1    508  94
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9722712, 'precision': 0.96621025, 'recall': 0.6485102, 'specificity': 0.6485102, 'f1': 0.7200164, 'auroc': 0.8794051, 'binary_precision': 0.96, 'binary_recall': 0.29752067, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.45425865}
confusion matrix:
      0   1
0  5994   3
1   170  72
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324357_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-15 09:41:29.816136,epoch time: 0:18:41.560161,used: 0:55:59.701324,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_08_45_30_seed_2_21324357
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9663883, 'precision': 0.75333196, 'recall': 0.5992548, 'specificity': 0.5992548, 'f1': 0.63950425, 'auroc': 0.91440296, 'binary_precision': 0.5344828, 'binary_recall': 0.20489095, 'binary_specificity': 0.99361867, 'binary_f1_score': 0.29622552}
confusion matrix:
       0    1
0  42041  270
1   1203  310
---- Validation: 
scalar performance:
{'acc': 0.9680392, 'precision': 0.739211, 'recall': 0.5610867, 'specificity': 0.5610867, 'f1': 0.59291035, 'auroc': 0.91035336, 'binary_precision': 0.50666666, 'binary_recall': 0.12624584, 'binary_specificity': 0.9959276, 'binary_f1_score': 0.20212765}
confusion matrix:
       0   1
0  18097  74
1    526  76
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9722712, 'precision': 0.972435, 'recall': 0.64652747, 'specificity': 0.64652747, 'f1': 0.7182851, 'auroc': 0.87840307, 'binary_precision': 0.9726027, 'binary_recall': 0.29338843, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.45079362}
confusion matrix:
      0   1
0  5995   2
1   171  71
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324357_4.png
early stop counter: 1
val acc:0.9680392146110535, best validation acc: 0.9688382148742676, corresponding to test acc:                         0.972271203994751 / 0.972271203994751
after epoch: 4,now: 2024-06-15 10:00:01.486601,epoch time: 0:18:31.670465,used: 1:14:31.371789,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_08_45_30_seed_2_21324357
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9658178, 'precision': 0.74183846, 'recall': 0.63082457, 'specificity': 0.63082457, 'f1': 0.6680989, 'auroc': 0.9110515, 'binary_precision': 0.50931674, 'binary_recall': 0.2709848, 'binary_specificity': 0.99066436, 'binary_f1_score': 0.3537532}
confusion matrix:
       0    1
0  41916  395
1   1103  410
---- Validation: 
scalar performance:
{'acc': 0.9688915, 'precision': 0.7605114, 'recall': 0.5832093, 'specificity': 0.5832093, 'f1': 0.62243545, 'auroc': 0.9162716, 'binary_precision': 0.54787236, 'binary_recall': 0.17109634, 'binary_specificity': 0.9953222, 'binary_f1_score': 0.2607595}
confusion matrix:
       0    1
0  18086   85
1    499  103
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97323287, 'precision': 0.9739489, 'recall': 0.65892416, 'specificity': 0.65892416, 'f1': 0.7330069, 'auroc': 0.8798497, 'binary_precision': 0.9746835, 'binary_recall': 0.3181818, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.47975078}
confusion matrix:
      0   1
0  5995   2
1   165  77
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324357_5.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-06-15 10:18:33.191749,epoch time: 0:18:31.705148,used: 1:33:03.076937,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_08_45_30_seed_2_21324357
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9667762, 'precision': 0.7561408, 'recall': 0.62909037, 'specificity': 0.62909037, 'f1': 0.66963494, 'auroc': 0.91716945, 'binary_precision': 0.5380507, 'binary_recall': 0.26635823, 'binary_specificity': 0.9918225, 'binary_f1_score': 0.35632184}
confusion matrix:
       0    1
0  41965  346
1   1110  403
---- Validation: 
scalar performance:
{'acc': 0.968998, 'precision': 0.7657849, 'recall': 0.5768399, 'specificity': 0.5768399, 'f1': 0.6151438, 'auroc': 0.9231739, 'binary_precision': 0.5588235, 'binary_recall': 0.1578073, 'binary_specificity': 0.99587256, 'binary_f1_score': 0.24611399}
confusion matrix:
       0   1
0  18096  75
1    507  95
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9722712, 'precision': 0.972435, 'recall': 0.64652747, 'specificity': 0.64652747, 'f1': 0.7182851, 'auroc': 0.8832724, 'binary_precision': 0.9726027, 'binary_recall': 0.29338843, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.45079362}
confusion matrix:
      0   1
0  5995   2
1   171  71
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324357_6.png
better model found
persisted
after epoch: 6,now: 2024-06-15 10:37:55.660753,epoch time: 0:19:22.469004,used: 1:52:25.545941,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_08_45_30_seed_2_21324357
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96657085, 'precision': 0.7507452, 'recall': 0.6608492, 'specificity': 0.6608492, 'f1': 0.69496155, 'auroc': 0.922402, 'binary_precision': 0.5250522, 'binary_recall': 0.3324521, 'binary_specificity': 0.9892463, 'binary_f1_score': 0.4071226}
confusion matrix:
       0    1
0  41856  455
1   1010  503
---- Validation: 
scalar performance:
{'acc': 0.9694242, 'precision': 0.7638525, 'recall': 0.61962163, 'specificity': 0.61962163, 'f1': 0.6622897, 'auroc': 0.92172027, 'binary_precision': 0.5522388, 'binary_recall': 0.24584718, 'binary_specificity': 0.99339604, 'binary_f1_score': 0.3402299}
confusion matrix:
       0    1
0  18051  120
1    454  148
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9746754, 'precision': 0.9759555, 'recall': 0.6775192, 'specificity': 0.6775192, 'f1': 0.75410295, 'auroc': 0.88467497, 'binary_precision': 0.97727275, 'binary_recall': 0.3553719, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.5212121}
confusion matrix:
      0   1
0  5995   2
1   156  86
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324357_7.png
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-06-15 10:57:03.648569,epoch time: 0:19:07.987816,used: 2:11:33.533757,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_08_45_30_seed_2_21324357
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9671641, 'precision': 0.76057374, 'recall': 0.64044404, 'specificity': 0.64044404, 'f1': 0.6807692, 'auroc': 0.91866916, 'binary_precision': 0.54613465, 'binary_recall': 0.2894911, 'binary_specificity': 0.991397, 'binary_f1_score': 0.37840173}
confusion matrix:
       0    1
0  41947  364
1   1075  438
---- Validation: 
scalar performance:
{'acc': 0.9693176, 'precision': 0.7650479, 'recall': 0.6051117, 'specificity': 0.6051117, 'f1': 0.64765716, 'auroc': 0.92574656, 'binary_precision': 0.5555556, 'binary_recall': 0.21594684, 'binary_specificity': 0.9942766, 'binary_f1_score': 0.3110048}
confusion matrix:
       0    1
0  18067  104
1    472  130
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97275203, 'precision': 0.98621696, 'recall': 0.6487603, 'specificity': 0.6487603, 'f1': 0.7223115, 'auroc': 0.8891084, 'binary_precision': 1.0, 'binary_recall': 0.29752067, 'binary_specificity': 1.0, 'binary_f1_score': 0.45859873}
confusion matrix:
      0   1
0  5997   0
1   170  72
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324357_8.png
early stop counter: 1
val acc:0.969317615032196, best validation acc: 0.9694241881370544, corresponding to test acc:                         0.9746754169464111 / 0.9746754169464111
after epoch: 8,now: 2024-06-15 11:16:18.083344,epoch time: 0:19:14.434775,used: 2:30:47.968532,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_08_45_30_seed_2_21324357
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.96693593, 'precision': 0.7565371, 'recall': 0.6463803, 'specificity': 0.6463803, 'f1': 0.6849032, 'auroc': 0.93064517, 'binary_precision': 0.53764707, 'binary_recall': 0.30204892, 'binary_specificity': 0.9907116, 'binary_f1_score': 0.38679644}
confusion matrix:
       0    1
0  41918  393
1   1056  457
---- Validation: 
scalar performance:
{'acc': 0.9691578, 'precision': 0.7651587, 'recall': 0.5913773, 'specificity': 0.5913773, 'f1': 0.63249314, 'auroc': 0.924931, 'binary_precision': 0.5566502, 'binary_recall': 0.18770765, 'binary_specificity': 0.99504703, 'binary_f1_score': 0.28074533}
confusion matrix:
       0    1
0  18081   90
1    489  113
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97195065, 'precision': 0.9718915, 'recall': 0.64239526, 'specificity': 0.64239526, 'f1': 0.7132545, 'auroc': 0.883066, 'binary_precision': 0.97183096, 'binary_recall': 0.28512397, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.44089457}
confusion matrix:
      0   1
0  5995   2
1   173  69
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324357_9.png
early stop counter: 2
val acc:0.9691578149795532, best validation acc: 0.9694241881370544, corresponding to test acc:                         0.9746754169464111 / 0.9746754169464111
after epoch: 9,now: 2024-06-15 11:35:05.667148,epoch time: 0:18:47.583804,used: 2:49:35.552336,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_08_45_30_seed_2_21324357
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.96700436, 'precision': 0.7650817, 'recall': 0.604035, 'specificity': 0.604035, 'f1': 0.64627695, 'auroc': 0.9250959, 'binary_precision': 0.5576592, 'binary_recall': 0.21414408, 'binary_specificity': 0.9939259, 'binary_f1_score': 0.3094556}
confusion matrix:
       0    1
0  42054  257
1   1189  324
---- Validation: 
scalar performance:
{'acc': 0.9682523, 'precision': 0.7460412, 'recall': 0.5619998, 'specificity': 0.5619998, 'f1': 0.59456795, 'auroc': 0.923483, 'binary_precision': 0.5202703, 'binary_recall': 0.12790698, 'binary_specificity': 0.9960927, 'binary_f1_score': 0.20533334}
confusion matrix:
       0   1
0  18100  71
1    525  77
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9695464, 'precision': 0.98464525, 'recall': 0.607438, 'specificity': 0.607438, 'f1': 0.6690736, 'auroc': 0.88561034, 'binary_precision': 1.0, 'binary_recall': 0.21487603, 'binary_specificity': 1.0, 'binary_f1_score': 0.35374147}
confusion matrix:
      0   1
0  5997   0
1   190  52
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324357_10.png
early stop counter: 3
val acc:0.9682523012161255, best validation acc: 0.9694241881370544, corresponding to test acc:                         0.9746754169464111 / 0.9746754169464111
after epoch: 10,now: 2024-06-15 11:53:54.394950,epoch time: 0:18:48.727802,used: 3:08:24.280138,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_08_45_30_seed_2_21324357
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9671641, 'precision': 0.7602553, 'recall': 0.6426746, 'specificity': 0.6426746, 'f1': 0.6826361, 'auroc': 0.92691064, 'binary_precision': 0.54534316, 'binary_recall': 0.29411766, 'binary_specificity': 0.9912316, 'binary_f1_score': 0.38213825}
confusion matrix:
       0    1
0  41940  371
1   1068  445
---- Validation: 
scalar performance:
{'acc': 0.9685719, 'precision': 0.75274795, 'recall': 0.57902896, 'specificity': 0.57902896, 'f1': 0.6166569, 'auroc': 0.9273135, 'binary_precision': 0.5326087, 'binary_recall': 0.1627907, 'binary_specificity': 0.9952672, 'binary_f1_score': 0.24936385}
confusion matrix:
       0   1
0  18085  86
1    504  98
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9709889, 'precision': 0.9701191, 'recall': 0.62999856, 'specificity': 0.62999856, 'f1': 0.697776, 'auroc': 0.8887703, 'binary_precision': 0.9692308, 'binary_recall': 0.2603306, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.41042346}
confusion matrix:
      0   1
0  5995   2
1   179  63
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324357_11.png
early stop counter: 4
val acc:0.9685719013214111, best validation acc: 0.9694241881370544, corresponding to test acc:                         0.9746754169464111 / 0.9746754169464111
after epoch: 11,now: 2024-06-15 12:12:30.618530,epoch time: 0:18:36.223580,used: 3:27:00.503718,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_08_45_30_seed_2_21324357
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9674151, 'precision': 0.7592825, 'recall': 0.6807242, 'specificity': 0.6807242, 'f1': 0.7122663, 'auroc': 0.9355367, 'binary_precision': 0.5407478, 'binary_recall': 0.37276933, 'binary_specificity': 0.98867905, 'binary_f1_score': 0.44131458}
confusion matrix:
       0    1
0  41832  479
1    949  564
---- Validation: 
scalar performance:
{'acc': 0.9696373, 'precision': 0.7672503, 'recall': 0.6229439, 'specificity': 0.6229439, 'f1': 0.66614145, 'auroc': 0.92513776, 'binary_precision': 0.5588235, 'binary_recall': 0.25249168, 'binary_specificity': 0.99339604, 'binary_f1_score': 0.3478261}
confusion matrix:
       0    1
0  18051  120
1    450  152
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97387403, 'precision': 0.98067355, 'recall': 0.66520584, 'specificity': 0.66520584, 'f1': 0.740973, 'auroc': 0.88411903, 'binary_precision': 0.9876543, 'binary_recall': 0.3305785, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.49535605}
confusion matrix:
      0   1
0  5996   1
1   162  80
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324357_12.png
better model found
persisted
after epoch: 12,now: 2024-06-15 12:31:13.076042,epoch time: 0:18:42.457512,used: 3:45:42.961230,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_08_45_30_seed_2_21324357
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9682594, 'precision': 0.7698957, 'recall': 0.67701894, 'specificity': 0.67701894, 'f1': 0.7128514, 'auroc': 0.93752307, 'binary_precision': 0.5622449, 'binary_recall': 0.36417714, 'binary_specificity': 0.9898608, 'binary_f1_score': 0.44203773}
confusion matrix:
       0    1
0  41882  429
1    962  551
---- Validation: 
scalar performance:
{'acc': 0.9699036, 'precision': 0.77370554, 'recall': 0.61906624, 'specificity': 0.61906624, 'f1': 0.66342896, 'auroc': 0.9307327, 'binary_precision': 0.5719844, 'binary_recall': 0.24418604, 'binary_specificity': 0.9939464, 'binary_f1_score': 0.34225842}
confusion matrix:
       0    1
0  18061  110
1    455  147
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97082865, 'precision': 0.9852727, 'recall': 0.62396693, 'specificity': 0.62396693, 'f1': 0.6912018, 'auroc': 0.88465226, 'binary_precision': 1.0, 'binary_recall': 0.24793388, 'binary_specificity': 1.0, 'binary_f1_score': 0.397351}
confusion matrix:
      0   1
0  5997   0
1   182  60
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324357_13.png
better model found
persisted
after epoch: 13,now: 2024-06-15 12:49:44.504630,epoch time: 0:18:31.428588,used: 4:04:14.389818,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_08_45_30_seed_2_21324357
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9679399, 'precision': 0.76610833, 'recall': 0.6755789, 'specificity': 0.6755789, 'f1': 0.71063733, 'auroc': 0.9345547, 'binary_precision': 0.5547667, 'binary_recall': 0.36153337, 'binary_specificity': 0.98962444, 'binary_f1_score': 0.4377751}
confusion matrix:
       0    1
0  41872  439
1    966  547
---- Validation: 
scalar performance:
{'acc': 0.9699036, 'precision': 0.77202606, 'recall': 0.62468755, 'specificity': 0.62468755, 'f1': 0.66870004, 'auroc': 0.93238735, 'binary_precision': 0.5682657, 'binary_recall': 0.25581396, 'binary_specificity': 0.99356115, 'binary_f1_score': 0.35280642}
confusion matrix:
       0    1
0  18054  117
1    448  154
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97002727, 'precision': 0.97618437, 'recall': 0.61561906, 'specificity': 0.61561906, 'f1': 0.6796138, 'auroc': 0.8903427, 'binary_precision': 0.98245615, 'binary_recall': 0.23140496, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.37458193}
confusion matrix:
      0   1
0  5996   1
1   186  56
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324357_14.png
early stop counter: 1
val acc:0.9699035882949829, best validation acc: 0.9699035882949829, corresponding to test acc:                         0.970828652381897 / 0.9746754169464111
after epoch: 14,now: 2024-06-15 13:08:39.978086,epoch time: 0:18:55.473456,used: 4:23:09.863274,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_08_45_30_seed_2_21324357
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.96734667, 'precision': 0.75880456, 'recall': 0.67718357, 'specificity': 0.67718357, 'f1': 0.7095673, 'auroc': 0.93046975, 'binary_precision': 0.54003906, 'binary_recall': 0.36549902, 'binary_specificity': 0.9888681, 'binary_f1_score': 0.43594798}
confusion matrix:
       0    1
0  41840  471
1    960  553
---- Validation: 
scalar performance:
{'acc': 0.9685719, 'precision': 0.7481905, 'recall': 0.62078744, 'specificity': 0.62078744, 'f1': 0.6604915, 'auroc': 0.9318211, 'binary_precision': 0.5208333, 'binary_recall': 0.24916944, 'binary_specificity': 0.9924055, 'binary_f1_score': 0.33707866}
confusion matrix:
       0    1
0  18033  138
1    452  150
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9735535, 'precision': 0.9744195, 'recall': 0.6630564, 'specificity': 0.6630564, 'f1': 0.73779476, 'auroc': 0.8884068, 'binary_precision': 0.97530866, 'binary_recall': 0.3264463, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.4891641}
confusion matrix:
      0   1
0  5995   2
1   163  79
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324357_15.png
early stop counter: 2
val acc:0.9685719013214111, best validation acc: 0.9699035882949829, corresponding to test acc:                         0.970828652381897 / 0.9746754169464111
after epoch: 15,now: 2024-06-15 13:27:25.735870,epoch time: 0:18:45.757784,used: 4:41:55.621058,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_08_45_30_seed_2_21324357
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9685332, 'precision': 0.77628005, 'recall': 0.6634587, 'specificity': 0.6634587, 'f1': 0.70402086, 'auroc': 0.9377325, 'binary_precision': 0.57596374, 'binary_recall': 0.33575678, 'binary_specificity': 0.9911607, 'binary_f1_score': 0.4242171}
confusion matrix:
       0    1
0  41937  374
1   1005  508
---- Validation: 
scalar performance:
{'acc': 0.9702232, 'precision': 0.7828964, 'recall': 0.61360997, 'specificity': 0.61360997, 'f1': 0.659251, 'auroc': 0.9290776, 'binary_precision': 0.5907173, 'binary_recall': 0.23255815, 'binary_specificity': 0.9946618, 'binary_f1_score': 0.33373067}
confusion matrix:
       0    1
0  18074   97
1    462  140
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9679436, 'precision': 0.9622751, 'recall': 0.59074235, 'specificity': 0.59074235, 'f1': 0.64457434, 'auroc': 0.8888149, 'binary_precision': 0.95652175, 'binary_recall': 0.18181819, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.30555555}
confusion matrix:
      0   1
0  5995   2
1   198  44
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324357_16.png
better model found
persisted
after epoch: 16,now: 2024-06-15 13:46:19.503250,epoch time: 0:18:53.767380,used: 5:00:49.388438,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_08_45_30_seed_2_21324357
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9686701, 'precision': 0.7749684, 'recall': 0.6781876, 'specificity': 0.6781876, 'f1': 0.7152364, 'auroc': 0.9359835, 'binary_precision': 0.572314, 'binary_recall': 0.36615995, 'binary_specificity': 0.9902153, 'binary_f1_score': 0.44659412}
confusion matrix:
       0    1
0  41897  414
1    959  554
---- Validation: 
scalar performance:
{'acc': 0.969584, 'precision': 0.770329, 'recall': 0.60765845, 'specificity': 0.60765845, 'f1': 0.65112346, 'auroc': 0.9293351, 'binary_precision': 0.5659574, 'binary_recall': 0.22093023, 'binary_specificity': 0.9943867, 'binary_f1_score': 0.31780168}
confusion matrix:
       0    1
0  18069  102
1    469  133
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97146976, 'precision': 0.97808766, 'recall': 0.63421416, 'specificity': 0.63421416, 'f1': 0.70372593, 'auroc': 0.88299173, 'binary_precision': 0.9848485, 'binary_recall': 0.26859504, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.42207792}
confusion matrix:
      0   1
0  5996   1
1   177  65
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324357_17.png
early stop counter: 1
val acc:0.9695839881896973, best validation acc: 0.9702231884002686, corresponding to test acc:                         0.9679436087608337 / 0.9746754169464111
after epoch: 17,now: 2024-06-15 14:04:54.628540,epoch time: 0:18:35.125290,used: 5:19:24.513728,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_08_45_30_seed_2_21324357
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9685332, 'precision': 0.7721789, 'recall': 0.6838525, 'specificity': 0.6838525, 'f1': 0.71861434, 'auroc': 0.93377703, 'binary_precision': 0.56633663, 'binary_recall': 0.37805685, 'binary_specificity': 0.9896481, 'binary_f1_score': 0.45342845}
confusion matrix:
       0    1
0  41873  438
1    941  572
---- Validation: 
scalar performance:
{'acc': 0.9709157, 'precision': 0.78893894, 'recall': 0.6348469, 'specificity': 0.6348469, 'f1': 0.68162084, 'auroc': 0.9358878, 'binary_precision': 0.60144925, 'binary_recall': 0.2757475, 'binary_specificity': 0.9939464, 'binary_f1_score': 0.3781321}
confusion matrix:
       0    1
0  18061  110
1    436  166
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9709889, 'precision': 0.97749096, 'recall': 0.62801576, 'specificity': 0.62801576, 'f1': 0.69584423, 'auroc': 0.890182, 'binary_precision': 0.984127, 'binary_recall': 0.25619835, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.40655738}
confusion matrix:
      0   1
0  5996   1
1   180  62
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324357_18.png
better model found
persisted
after epoch: 18,now: 2024-06-15 14:23:19.298307,epoch time: 0:18:24.669767,used: 5:37:49.183495,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_08_45_30_seed_2_21324357
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9689896, 'precision': 0.786865, 'recall': 0.6515863, 'specificity': 0.6515863, 'f1': 0.69647527, 'auroc': 0.9317378, 'binary_precision': 0.5979644, 'binary_recall': 0.3106411, 'binary_specificity': 0.9925315, 'binary_f1_score': 0.40887344}
confusion matrix:
       0    1
0  41995  316
1   1043  470
---- Validation: 
scalar performance:
{'acc': 0.9693176, 'precision': 0.77091885, 'recall': 0.58744466, 'specificity': 0.58744466, 'f1': 0.62852776, 'auroc': 0.93294454, 'binary_precision': 0.56842107, 'binary_recall': 0.179402, 'binary_specificity': 0.99548733, 'binary_f1_score': 0.27272728}
confusion matrix:
       0    1
0  18089   82
1    494  108
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9692258, 'precision': 0.9844886, 'recall': 0.6033058, 'specificity': 0.6033058, 'f1': 0.663355, 'auroc': 0.8878742, 'binary_precision': 1.0, 'binary_recall': 0.20661157, 'binary_specificity': 1.0, 'binary_f1_score': 0.34246573}
confusion matrix:
      0   1
0  5997   0
1   192  50
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324357_19.png
early stop counter: 1
val acc:0.969317615032196, best validation acc: 0.970915675163269, corresponding to test acc:                         0.970988929271698 / 0.9746754169464111
after epoch: 19,now: 2024-06-15 14:41:42.882285,epoch time: 0:18:23.583978,used: 5:56:12.767473,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_08_45_30_seed_2_21324357
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9688299, 'precision': 0.78156817, 'recall': 0.6601072, 'specificity': 0.6601072, 'f1': 0.70258504, 'auroc': 0.9350214, 'binary_precision': 0.58677685, 'binary_recall': 0.32848644, 'binary_specificity': 0.99172795, 'binary_f1_score': 0.42118642}
confusion matrix:
       0    1
0  41961  350
1   1016  497
---- Validation: 
scalar performance:
{'acc': 0.9699036, 'precision': 0.7707331, 'recall': 0.6295059, 'specificity': 0.6295059, 'f1': 0.6730852, 'auroc': 0.9364453, 'binary_precision': 0.56537104, 'binary_recall': 0.26578072, 'binary_specificity': 0.993231, 'binary_f1_score': 0.36158195}
confusion matrix:
       0    1
0  18048  123
1    442  160
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9724315, 'precision': 0.9791914, 'recall': 0.64661086, 'specificity': 0.64661086, 'f1': 0.71904457, 'auroc': 0.8939533, 'binary_precision': 0.9861111, 'binary_recall': 0.29338843, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.4522293}
confusion matrix:
      0   1
0  5996   1
1   171  71
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324357_20.png
early stop counter: 2
val acc:0.9699035882949829, best validation acc: 0.970915675163269, corresponding to test acc:                         0.970988929271698 / 0.9746754169464111
after epoch: 20,now: 2024-06-15 15:00:08.221695,epoch time: 0:18:25.339410,used: 6:14:38.106883,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_08_45_30_seed_2_21324357
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9696285, 'precision': 0.784735, 'recall': 0.6904741, 'specificity': 0.6904741, 'f1': 0.7273601, 'auroc': 0.9389907, 'binary_precision': 0.591, 'binary_recall': 0.39061466, 'binary_specificity': 0.9903335, 'binary_f1_score': 0.47035414}
confusion matrix:
       0    1
0  41902  409
1    922  591
---- Validation: 
scalar performance:
{'acc': 0.9701699, 'precision': 0.7739712, 'recall': 0.63606787, 'specificity': 0.63606787, 'f1': 0.6798602, 'auroc': 0.9365219, 'binary_precision': 0.5714286, 'binary_recall': 0.27906978, 'binary_specificity': 0.9930659, 'binary_f1_score': 0.37500003}
confusion matrix:
       0    1
0  18045  126
1    434  168
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9716301, 'precision': 0.97827935, 'recall': 0.63628024, 'specificity': 0.63628024, 'f1': 0.7063197, 'auroc': 0.89601016, 'binary_precision': 0.98507464, 'binary_recall': 0.27272728, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.4271845}
confusion matrix:
      0   1
0  5996   1
1   176  66
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324357_21.png
early stop counter: 3
val acc:0.9701699018478394, best validation acc: 0.970915675163269, corresponding to test acc:                         0.970988929271698 / 0.9746754169464111
after epoch: 21,now: 2024-06-15 15:18:34.608640,epoch time: 0:18:26.386945,used: 6:33:04.493828,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_08_45_30_seed_2_21324357
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9680312, 'precision': 0.7690383, 'recall': 0.66447335, 'specificity': 0.66447335, 'f1': 0.7029144, 'auroc': 0.93521595, 'binary_precision': 0.5614035, 'binary_recall': 0.33840054, 'binary_specificity': 0.99054617, 'binary_f1_score': 0.42226806}
confusion matrix:
       0    1
0  41911  400
1   1001  512
---- Validation: 
scalar performance:
{'acc': 0.9702765, 'precision': 0.7823821, 'recall': 0.6176527, 'specificity': 0.6176527, 'f1': 0.66338795, 'auroc': 0.9348485, 'binary_precision': 0.58943087, 'binary_recall': 0.24086379, 'binary_specificity': 0.9944417, 'binary_f1_score': 0.34198114}
confusion matrix:
       0    1
0  18070  101
1    457  145
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.969867, 'precision': 0.9759493, 'recall': 0.613553, 'specificity': 0.613553, 'f1': 0.6768462, 'auroc': 0.8910103, 'binary_precision': 0.98214287, 'binary_recall': 0.22727273, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.36912754}
confusion matrix:
      0   1
0  5996   1
1   187  55
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324357_22.png
early stop counter: 4
val acc:0.9702764749526978, best validation acc: 0.970915675163269, corresponding to test acc:                         0.970988929271698 / 0.9746754169464111
after epoch: 22,now: 2024-06-15 15:37:02.985788,epoch time: 0:18:28.377148,used: 6:51:32.870976,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_08_45_30_seed_2_21324357
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.96844196, 'precision': 0.7674118, 'recall': 0.7108906, 'specificity': 0.7108906, 'f1': 0.735464, 'auroc': 0.93837357, 'binary_precision': 0.5548986, 'binary_recall': 0.43423662, 'binary_specificity': 0.9875446, 'binary_f1_score': 0.487208}
confusion matrix:
       0    1
0  41784  527
1    856  657
---- Validation: 
scalar performance:
{'acc': 0.9701167, 'precision': 0.7661588, 'recall': 0.67137444, 'specificity': 0.67137444, 'f1': 0.7075563, 'auroc': 0.9338149, 'binary_precision': 0.5535248, 'binary_recall': 0.35215947, 'binary_specificity': 0.9905894, 'binary_f1_score': 0.43045688}
confusion matrix:
       0    1
0  18000  171
1    390  212
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9716301, 'precision': 0.97132576, 'recall': 0.638263, 'specificity': 0.638263, 'f1': 0.7081603, 'auroc': 0.8936047, 'binary_precision': 0.9710145, 'binary_recall': 0.2768595, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.43086815}
confusion matrix:
      0   1
0  5995   2
1   175  67
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324357_23.png
early stop counter: 5
val acc:0.9701166749000549, best validation acc: 0.970915675163269, corresponding to test acc:                         0.970988929271698 / 0.9746754169464111
after epoch: 23,now: 2024-06-15 15:55:55.605797,epoch time: 0:18:52.620009,used: 7:10:25.490985,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_08_45_30_seed_2_21324357
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.96841913, 'precision': 0.7654593, 'recall': 0.7287233, 'specificity': 0.7287233, 'f1': 0.74557996, 'auroc': 0.94537103, 'binary_precision': 0.5497301, 'binary_recall': 0.47124916, 'binary_specificity': 0.9861975, 'binary_f1_score': 0.5074733}
confusion matrix:
       0    1
0  41727  584
1    800  713
---- Validation: 
scalar performance:
{'acc': 0.9705961, 'precision': 0.77035874, 'recall': 0.686077, 'specificity': 0.686077, 'f1': 0.71971816, 'auroc': 0.93700707, 'binary_precision': 0.5609756, 'binary_recall': 0.3820598, 'binary_specificity': 0.9900941, 'binary_f1_score': 0.45454547}
confusion matrix:
       0    1
0  17991  180
1    372  230
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97371376, 'precision': 0.97464913, 'recall': 0.6651225, 'specificity': 0.6651225, 'f1': 0.7401668, 'auroc': 0.89365226, 'binary_precision': 0.9756098, 'binary_recall': 0.3305785, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.49382716}
confusion matrix:
      0   1
0  5995   2
1   162  80
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324357_24.png
early stop counter: 6
val acc:0.9705960750579834, best validation acc: 0.970915675163269, corresponding to test acc:                         0.970988929271698 / 0.9746754169464111
after epoch: 24,now: 2024-06-15 16:15:25.967963,epoch time: 0:19:30.362166,used: 7:29:55.853151,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_08_45_30_seed_2_21324357
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9683735, 'precision': 0.76453197, 'recall': 0.73507273, 'specificity': 0.73507273, 'f1': 0.7488401, 'auroc': 0.9337281, 'binary_precision': 0.5474234, 'binary_recall': 0.48446795, 'binary_specificity': 0.9856775, 'binary_f1_score': 0.5140253}
confusion matrix:
       0    1
0  41705  606
1    780  733
---- Validation: 
scalar performance:
{'acc': 0.9705961, 'precision': 0.7693119, 'recall': 0.6933044, 'specificity': 0.6933044, 'f1': 0.7244805, 'auroc': 0.9390393, 'binary_precision': 0.55841124, 'binary_recall': 0.39700997, 'binary_specificity': 0.9895988, 'binary_f1_score': 0.46407768}
confusion matrix:
       0    1
0  17982  189
1    363  239
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97387403, 'precision': 0.97487515, 'recall': 0.66718864, 'specificity': 0.66718864, 'f1': 0.7425246, 'auroc': 0.8927103, 'binary_precision': 0.97590363, 'binary_recall': 0.33471075, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.49846154}
confusion matrix:
      0   1
0  5995   2
1   161  81
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324357_25.png
early stop counter: 7
val acc:0.9705960750579834, best validation acc: 0.970915675163269, corresponding to test acc:                         0.970988929271698 / 0.9746754169464111
after epoch: 25,now: 2024-06-15 16:34:16.290795,epoch time: 0:18:50.322832,used: 7:48:46.175983,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_08_45_30_seed_2_21324357
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.96821374, 'precision': 0.7651477, 'recall': 0.7101351, 'specificity': 0.7101351, 'f1': 0.7341239, 'auroc': 0.93823326, 'binary_precision': 0.55042017, 'binary_recall': 0.43291473, 'binary_specificity': 0.98735553, 'binary_f1_score': 0.4846467}
confusion matrix:
       0    1
0  41776  535
1    858  655
---- Validation: 
scalar performance:
{'acc': 0.9700101, 'precision': 0.7665998, 'recall': 0.65847063, 'specificity': 0.65847063, 'f1': 0.6975424, 'auroc': 0.9342617, 'binary_precision': 0.5552408, 'binary_recall': 0.3255814, 'binary_specificity': 0.99135983, 'binary_f1_score': 0.4104712}
confusion matrix:
       0    1
0  18014  157
1    406  196
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96890527, 'precision': 0.9744078, 'recall': 0.6011563, 'specificity': 0.6011563, 'f1': 0.6598482, 'auroc': 0.8869509, 'binary_precision': 0.98, 'binary_recall': 0.20247933, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.3356164}
confusion matrix:
      0   1
0  5996   1
1   193  49
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324357_26.png
early stop counter: 8
val acc:0.9700101017951965, best validation acc: 0.970915675163269, corresponding to test acc:                         0.970988929271698 / 0.9746754169464111
after epoch: 26,now: 2024-06-15 16:53:11.471504,epoch time: 0:18:55.180709,used: 8:07:41.356692,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_08_45_30_seed_2_21324357
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9680768, 'precision': 0.76327217, 'recall': 0.7158, 'specificity': 0.7158, 'f1': 0.73693424, 'auroc': 0.9433175, 'binary_precision': 0.54626626, 'binary_recall': 0.44481164, 'binary_specificity': 0.98678833, 'binary_f1_score': 0.4903461}
confusion matrix:
       0    1
0  41752  559
1    840  673
---- Validation: 
scalar performance:
{'acc': 0.9707559, 'precision': 0.77562666, 'recall': 0.6692955, 'specificity': 0.6692955, 'f1': 0.70862806, 'auroc': 0.9334352, 'binary_precision': 0.57260275, 'binary_recall': 0.34717607, 'binary_specificity': 0.9914149, 'binary_f1_score': 0.43226475}
confusion matrix:
       0    1
0  18015  156
1    393  209
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96906555, 'precision': 0.94962597, 'recall': 0.6091707, 'specificity': 0.6091707, 'f1': 0.66933405, 'auroc': 0.89020765, 'binary_precision': 0.9298246, 'binary_recall': 0.21900827, 'binary_specificity': 0.999333, 'binary_f1_score': 0.35451508}
confusion matrix:
      0   1
0  5993   4
1   189  53
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324357_27.png
early stop counter: 9
val acc:0.9707558751106262, best validation acc: 0.970915675163269, corresponding to test acc:                         0.970988929271698 / 0.9746754169464111
after epoch: 27,now: 2024-06-15 17:12:56.994731,epoch time: 0:19:45.523227,used: 8:27:26.879919,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_08_45_30_seed_2_21324357
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.96990234, 'precision': 0.7860851, 'recall': 0.69921947, 'specificity': 0.69921947, 'f1': 0.73412836, 'auroc': 0.9472408, 'binary_precision': 0.59309024, 'binary_recall': 0.40846002, 'binary_specificity': 0.98997897, 'binary_f1_score': 0.48375738}
confusion matrix:
       0    1
0  41887  424
1    895  618
---- Validation: 
scalar performance:
{'acc': 0.9705428, 'precision': 0.776038, 'recall': 0.65312445, 'specificity': 0.65312445, 'f1': 0.69545597, 'auroc': 0.9367955, 'binary_precision': 0.5744681, 'binary_recall': 0.3139535, 'binary_specificity': 0.99229544, 'binary_f1_score': 0.40601507}
confusion matrix:
       0    1
0  18031  140
1    413  189
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96970665, 'precision': 0.9757086, 'recall': 0.61148685, 'specificity': 0.61148685, 'f1': 0.6740602, 'auroc': 0.89333564, 'binary_precision': 0.9818182, 'binary_recall': 0.2231405, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.36363637}
confusion matrix:
      0   1
0  5996   1
1   188  54
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324357_28.png
early stop counter: 10
val acc:0.9705427885055542, best validation acc: 0.970915675163269, corresponding to test acc:                         0.970988929271698 / 0.9746754169464111
after epoch: 28,now: 2024-06-15 17:32:02.029529,epoch time: 0:19:05.034798,used: 8:46:31.914717,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_08_45_30_seed_2_21324357
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9688755, 'precision': 0.7712666, 'recall': 0.7162136, 'specificity': 0.7162136, 'f1': 0.7403101, 'auroc': 0.9439094, 'binary_precision': 0.56223893, 'binary_recall': 0.44481164, 'binary_specificity': 0.9876155, 'binary_f1_score': 0.496679}
confusion matrix:
       0    1
0  41787  524
1    840  673
---- Validation: 
scalar performance:
{'acc': 0.9701167, 'precision': 0.7738675, 'recall': 0.6328281, 'specificity': 0.6328281, 'f1': 0.6768249, 'auroc': 0.9361057, 'binary_precision': 0.5714286, 'binary_recall': 0.27242523, 'binary_specificity': 0.993231, 'binary_f1_score': 0.36895385}
confusion matrix:
       0    1
0  18048  123
1    438  164
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9692258, 'precision': 0.974949, 'recall': 0.6052885, 'specificity': 0.6052885, 'f1': 0.66559017, 'auroc': 0.88431907, 'binary_precision': 0.9807692, 'binary_recall': 0.2107438, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.34693876}
confusion matrix:
      0   1
0  5996   1
1   191  51
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324357_29.png
early stop counter: 11
val acc:0.9701166749000549, best validation acc: 0.970915675163269, corresponding to test acc:                         0.970988929271698 / 0.9746754169464111
after epoch: 29,now: 2024-06-15 17:50:28.134581,epoch time: 0:18:26.105052,used: 9:04:58.019769,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_08_45_30_seed_2_21324357
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.96908087, 'precision': 0.77339834, 'recall': 0.7163199, 'specificity': 0.7163199, 'f1': 0.7411914, 'auroc': 0.9438386, 'binary_precision': 0.56649834, 'binary_recall': 0.44481164, 'binary_specificity': 0.9878282, 'binary_f1_score': 0.49833393}
confusion matrix:
       0    1
0  41796  515
1    840  673
---- Validation: 
scalar performance:
{'acc': 0.9704363, 'precision': 0.77084917, 'recall': 0.66993344, 'specificity': 0.66993344, 'f1': 0.70779663, 'auroc': 0.93672496, 'binary_precision': 0.5630027, 'binary_recall': 0.3488372, 'binary_specificity': 0.9910297, 'binary_f1_score': 0.43076923}
confusion matrix:
       0    1
0  18008  163
1    392  210
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9730726, 'precision': 0.97987247, 'recall': 0.6548753, 'specificity': 0.6548753, 'f1': 0.72894114, 'auroc': 0.8879345, 'binary_precision': 0.9868421, 'binary_recall': 0.30991736, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.47169814}
confusion matrix:
      0   1
0  5996   1
1   167  75
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324357_30.png
early stop counter: 12
val acc:0.9704362750053406, best validation acc: 0.970915675163269, corresponding to test acc:                         0.970988929271698 / 0.9746754169464111
after epoch: 30,now: 2024-06-15 18:08:49.532894,epoch time: 0:18:21.398313,used: 9:23:19.418082,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_08_45_30_seed_2_21324357
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 9:23:19.418082 at 2024-06-15 18:08:49.532894
persisted model performance metric: 

scalar performance:
{'acc': 0.9709889, 'precision': 0.97749096, 'recall': 0.62801576, 'specificity': 0.62801576, 'f1': 0.69584423, 'auroc': 0.890182, 'binary_precision': 0.984127, 'binary_recall': 0.25619835, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.40655738}
confusion matrix:
      0   1
0  5996   1
1   180  62
oracle model performance metric: 

scalar performance:
{'acc': 0.9746754, 'precision': 0.9759555, 'recall': 0.6775192, 'specificity': 0.6775192, 'f1': 0.75410295, 'auroc': 0.88467497, 'binary_precision': 0.97727275, 'binary_recall': 0.3553719, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.5212121}
confusion matrix:
      0   1
0  5995   2
1   156  86
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_bs16_different_learningrates/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_resnet_bs16_different_learningrates/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204077 KiB | 640729 KiB |   2834 TiB |   2834 TiB |
|       from large pool | 167040 KiB | 568000 KiB |   2833 TiB |   2833 TiB |
|       from small pool |  37037 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 204077 KiB | 640729 KiB |   2834 TiB |   2834 TiB |
|       from large pool | 167040 KiB | 568000 KiB |   2833 TiB |   2833 TiB |
|       from small pool |  37037 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201087 KiB | 632296 KiB |   2820 TiB |   2820 TiB |
|       from large pool | 165120 KiB | 560704 KiB |   2820 TiB |   2820 TiB |
|       from small pool |  35967 KiB |  73944 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 675840 KiB | 755712 KiB |   1502 MiB |    842 MiB |
|       from large pool | 600064 KiB | 679936 KiB |   1376 MiB |    790 MiB |
|       from small pool |  75776 KiB |  75776 KiB |    126 MiB |     52 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  80594 KiB | 218089 KiB |   1014 TiB |   1014 TiB |
|       from large pool |  68480 KiB | 217080 KiB |   1013 TiB |   1013 TiB |
|       from small pool |  12114 KiB |  19715 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3240    |    6231    |  251121 K  |  251118 K  |
|       from large pool |      36    |      76    |  101521 K  |  101521 K  |
|       from small pool |    3204    |    6194    |  149600 K  |  149596 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3240    |    6231    |  251121 K  |  251118 K  |
|       from large pool |      36    |      76    |  101521 K  |  101521 K  |
|       from small pool |    3204    |    6194    |  149600 K  |  149596 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      51    |      51    |      85    |      34    |
|       from large pool |      14    |      14    |      22    |       8    |
|       from small pool |      37    |      37    |      63    |      26    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      38    |    2756    |  114981 K  |  114981 K  |
|       from large pool |       5    |      13    |   38544 K  |   38544 K  |
|       from small pool |      33    |    2751    |   76436 K  |   76436 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 640729 KiB |   2834 TiB |   2834 TiB |
|       from large pool |  16640 KiB | 568000 KiB |   2833 TiB |   2833 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 640729 KiB |   2834 TiB |   2834 TiB |
|       from large pool |  16640 KiB | 568000 KiB |   2833 TiB |   2833 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 632296 KiB |   2820 TiB |   2820 TiB |
|       from large pool |  16640 KiB | 560704 KiB |   2820 TiB |   2820 TiB |
|       from small pool |      0 KiB |  73944 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 284672 KiB | 755712 KiB |   1502 MiB |   1224 MiB |
|       from large pool | 235520 KiB | 679936 KiB |   1376 MiB |   1146 MiB |
|       from small pool |  49152 KiB |  75776 KiB |    126 MiB |     78 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  55040 KiB | 218089 KiB |   1014 TiB |   1014 TiB |
|       from large pool |  55040 KiB | 217080 KiB |   1013 TiB |   1013 TiB |
|       from small pool |      0 KiB |  19715 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6231    |  251121 K  |  251121 K  |
|       from large pool |       2    |      76    |  101521 K  |  101521 K  |
|       from small pool |       0    |    6194    |  149600 K  |  149600 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6231    |  251121 K  |  251121 K  |
|       from large pool |       2    |      76    |  101521 K  |  101521 K  |
|       from small pool |       0    |    6194    |  149600 K  |  149600 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      34    |      51    |      85    |      51    |
|       from large pool |      10    |      14    |      22    |      12    |
|       from small pool |      24    |      37    |      63    |      39    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2756    |  114982 K  |  114982 K  |
|       from large pool |       3    |      13    |   38544 K  |   38544 K  |
|       from small pool |       0    |    2751    |   76437 K  |   76437 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

