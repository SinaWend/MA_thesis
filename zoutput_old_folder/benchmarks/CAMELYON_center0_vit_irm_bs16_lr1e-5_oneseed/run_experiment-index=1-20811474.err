Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Fri May 24 12:30:37 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_vit_irm/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_vit_irm/rule_results/1.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=1
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_39_47_seed_0_20811474

 Experiment start at: 2024-05-24 12:39:47.339968
before training, model accuracy: 0.955097496509552
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.97065675, 'precision': 0.8736627, 'recall': 0.5881572, 'specificity': 0.5881572, 'f1': 0.63734084, 'auroc': 0.96763897, 'binary_precision': 0.7751479, 'binary_recall': 0.17811012, 'binary_specificity': 0.9982042, 'binary_f1_score': 0.28966278}
confusion matrix:
       0    1
0  42245   76
1   1209  262
---- Validation: 
scalar performance:
{'acc': 0.96871006, 'precision': 0.82541037, 'recall': 0.579521, 'specificity': 0.579521, 'f1': 0.62266153, 'auroc': 0.9672365, 'binary_precision': 0.6797386, 'binary_recall': 0.16174184, 'binary_specificity': 0.99730015, 'binary_f1_score': 0.26130652}
confusion matrix:
       0    1
0  18100   49
1    539  104
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.808851, 'recall': 0.5393127, 'specificity': 0.5393127, 'f1': 0.5614048, 'auroc': 0.94471586, 'binary_precision': 0.65625, 'binary_recall': 0.08045977, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.14334472}
confusion matrix:
      0   1
0  5986  11
1   240  21
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811474.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-24 13:21:01.346713,epoch time: 0:41:14.006745,used: 0:41:14.006745,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_39_47_seed_0_20811474
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9788546, 'precision': 0.85890275, 'recall': 0.7887376, 'specificity': 0.7887376, 'f1': 0.8196999, 'auroc': 0.9756184, 'binary_precision': 0.73214287, 'binary_recall': 0.5849185, 'binary_specificity': 0.9925567, 'binary_f1_score': 0.6503021}
confusion matrix:
       0    1
0  42005  315
1    611  861
---- Validation: 
scalar performance:
{'acc': 0.97828865, 'precision': 0.9008009, 'recall': 0.7322408, 'specificity': 0.7322408, 'f1': 0.7924421, 'auroc': 0.97611165, 'binary_precision': 0.8201635, 'binary_recall': 0.4681182, 'binary_specificity': 0.99636346, 'binary_f1_score': 0.5960396}
confusion matrix:
       0    1
0  18083   66
1    342  301
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.971876, 'precision': 0.9156214, 'recall': 0.6939849, 'specificity': 0.6939849, 'f1': 0.7611699, 'auroc': 0.955879, 'binary_precision': 0.85714287, 'binary_recall': 0.3908046, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.5368421}
confusion matrix:
      0    1
0  5980   17
1   159  102
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811474.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-05-24 14:00:57.124297,epoch time: 0:39:55.777584,used: 1:21:09.784329,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_39_47_seed_0_20811474
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9804531, 'precision': 0.93168014, 'recall': 0.7405381, 'specificity': 0.7405381, 'f1': 0.8070986, 'auroc': 0.9798441, 'binary_precision': 0.8810409, 'binary_recall': 0.48334467, 'binary_specificity': 0.9977316, 'binary_f1_score': 0.62423176}
confusion matrix:
       0    1
0  42225   96
1    760  711
---- Validation: 
scalar performance:
{'acc': 0.9789804, 'precision': 0.9414253, 'recall': 0.7153477, 'specificity': 0.7153477, 'f1': 0.7869326, 'auroc': 0.9784627, 'binary_precision': 0.9025974, 'binary_recall': 0.43234837, 'binary_specificity': 0.99834704, 'binary_f1_score': 0.5846478}
confusion matrix:
       0    1
0  18119   30
1    365  278
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.8129301, 'recall': 0.5112441, 'specificity': 0.5112441, 'f1': 0.5116882, 'auroc': 0.9501635, 'binary_precision': 0.6666667, 'binary_recall': 0.022988506, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.044444446}
confusion matrix:
      0  1
0  5994  3
1   255  6
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811474.png
better model found
persisted
after epoch: 3,now: 2024-05-24 14:42:59.871683,epoch time: 0:42:02.747386,used: 2:03:12.531715,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_39_47_seed_0_20811474
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97663957, 'precision': 0.94031984, 'recall': 0.670218, 'specificity': 0.670218, 'f1': 0.7419268, 'auroc': 0.9839692, 'binary_precision': 0.9030521, 'binary_recall': 0.34171197, 'binary_specificity': 0.998724, 'binary_f1_score': 0.49581075}
confusion matrix:
       0    1
0  42266   54
1    969  503
---- Validation: 
scalar performance:
{'acc': 0.9733929, 'precision': 0.92246366, 'recall': 0.6299489, 'specificity': 0.6299489, 'f1': 0.6941539, 'auroc': 0.9767429, 'binary_precision': 0.8704663, 'binary_recall': 0.26127526, 'binary_specificity': 0.99862254, 'binary_f1_score': 0.40191388}
confusion matrix:
       0    1
0  18124   25
1    475  168
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.8183303, 'recall': 0.56563246, 'specificity': 0.56563246, 'f1': 0.6018645, 'auroc': 0.9594184, 'binary_precision': 0.6730769, 'binary_recall': 0.13409962, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.22364217}
confusion matrix:
      0   1
0  5980  17
1   226  35
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811474.png
early stop counter: 1
val acc:0.973392903804779, best validation acc: 0.9789804220199585, corresponding to test acc:                         0.9587727785110474 / 0.9718760251998901
after epoch: 4,now: 2024-05-24 15:24:56.950051,epoch time: 0:41:57.078368,used: 2:45:09.610083,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_39_47_seed_0_20811474
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98175466, 'precision': 0.87305754, 'recall': 0.831981, 'specificity': 0.831981, 'f1': 0.85122174, 'auroc': 0.9858719, 'binary_precision': 0.7574827, 'binary_recall': 0.67142856, 'binary_specificity': 0.99253345, 'binary_f1_score': 0.7118644}
confusion matrix:
       0    1
0  42006  316
1    483  987
---- Validation: 
scalar performance:
{'acc': 0.98275864, 'precision': 0.90785086, 'recall': 0.8103106, 'specificity': 0.8103106, 'f1': 0.8519393, 'auroc': 0.9799704, 'binary_precision': 0.828866, 'binary_recall': 0.62519443, 'binary_specificity': 0.9954268, 'binary_f1_score': 0.712766}
confusion matrix:
       0    1
0  18066   83
1    241  402
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96340686, 'precision': 0.85409325, 'recall': 0.59245235, 'specificity': 0.59245235, 'f1': 0.64045334, 'auroc': 0.9607594, 'binary_precision': 0.74242425, 'binary_recall': 0.18773946, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.29969418}
confusion matrix:
      0   1
0  5980  17
1   212  49
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811474.png
better model found
persisted
after epoch: 5,now: 2024-05-24 16:04:13.329472,epoch time: 0:39:16.379421,used: 3:24:25.989504,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_39_47_seed_0_20811474
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9831933, 'precision': 0.87845266, 'recall': 0.8555707, 'specificity': 0.8555707, 'f1': 0.8666246, 'auroc': 0.98797655, 'binary_precision': 0.76666665, 'binary_recall': 0.71875, 'binary_specificity': 0.9923913, 'binary_f1_score': 0.7419355}
confusion matrix:
       0     1
0  41998   322
1    414  1058
---- Validation: 
scalar performance:
{'acc': 0.9790868, 'precision': 0.862268, 'recall': 0.79715884, 'specificity': 0.79715884, 'f1': 0.82622373, 'auroc': 0.98105276, 'binary_precision': 0.7385496, 'binary_recall': 0.60186625, 'binary_specificity': 0.99245137, 'binary_f1_score': 0.66323906}
confusion matrix:
       0    1
0  18012  137
1    256  387
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96772134, 'precision': 0.8400643, 'recall': 0.68998486, 'specificity': 0.68998486, 'f1': 0.7416612, 'auroc': 0.9598081, 'binary_precision': 0.7062937, 'binary_recall': 0.38697317, 'binary_specificity': 0.9929965, 'binary_f1_score': 0.5}
confusion matrix:
      0    1
0  5955   42
1   160  101
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811474.png
early stop counter: 1
val acc:0.9790868163108826, best validation acc: 0.982758641242981, corresponding to test acc:                         0.9634068608283997 / 0.9718760251998901
after epoch: 6,now: 2024-05-24 16:46:08.820958,epoch time: 0:41:55.491486,used: 4:06:21.480990,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_39_47_seed_0_20811474
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9859792, 'precision': 0.91828144, 'recall': 0.8537334, 'specificity': 0.8537334, 'f1': 0.8830987, 'auroc': 0.99014246, 'binary_precision': 0.8465267, 'binary_recall': 0.7119565, 'binary_specificity': 0.9955104, 'binary_f1_score': 0.7734317}
confusion matrix:
       0     1
0  42130   190
1    424  1048
---- Validation: 
scalar performance:
{'acc': 0.98259896, 'precision': 0.9065867, 'recall': 0.8087278, 'specificity': 0.8087278, 'f1': 0.85043985, 'auroc': 0.9751278, 'binary_precision': 0.8264463, 'binary_recall': 0.62208396, 'binary_specificity': 0.99537164, 'binary_f1_score': 0.7098492}
confusion matrix:
       0    1
0  18065   84
1    243  400
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9683605, 'precision': 0.8753041, 'recall': 0.666498, 'specificity': 0.666498, 'f1': 0.72714067, 'auroc': 0.9478645, 'binary_precision': 0.7787611, 'binary_recall': 0.33716476, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.47058827}
confusion matrix:
      0   1
0  5972  25
1   173  88
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811474.png
early stop counter: 2
val acc:0.9825989603996277, best validation acc: 0.982758641242981, corresponding to test acc:                         0.9634068608283997 / 0.9718760251998901
after epoch: 7,now: 2024-05-24 17:27:57.368348,epoch time: 0:41:48.547390,used: 4:48:10.028380,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_39_47_seed_0_20811474
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9830334, 'precision': 0.8404392, 'recall': 0.9531634, 'specificity': 0.9531634, 'f1': 0.8879967, 'auroc': 0.99186444, 'binary_precision': 0.6836529, 'binary_recall': 0.9211421, 'binary_specificity': 0.98518467, 'binary_f1_score': 0.7848248}
confusion matrix:
       0     1
0  41694   627
1    116  1355
---- Validation: 
scalar performance:
{'acc': 0.98334396, 'precision': 0.8563547, 'recall': 0.91637146, 'specificity': 0.91637146, 'f1': 0.8838094, 'auroc': 0.98316234, 'binary_precision': 0.71825397, 'binary_recall': 0.844479, 'binary_specificity': 0.98826385, 'binary_f1_score': 0.7762688}
confusion matrix:
       0    1
0  17936  213
1    100  543
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9678811, 'precision': 0.8425534, 'recall': 0.6900682, 'specificity': 0.6900682, 'f1': 0.74232346, 'auroc': 0.9504288, 'binary_precision': 0.7112676, 'binary_recall': 0.38697317, 'binary_specificity': 0.9931632, 'binary_f1_score': 0.5012407}
confusion matrix:
      0    1
0  5956   41
1   160  101
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811474.png
better model found
persisted
after epoch: 8,now: 2024-05-24 18:07:43.022395,epoch time: 0:39:45.654047,used: 5:27:55.682427,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_39_47_seed_0_20811474
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9877603, 'precision': 0.9365721, 'recall': 0.8651465, 'specificity': 0.8651465, 'f1': 0.8974364, 'auroc': 0.9928282, 'binary_precision': 0.88235295, 'binary_recall': 0.7336956, 'binary_specificity': 0.99659735, 'binary_f1_score': 0.8011869}
confusion matrix:
       0     1
0  42176   144
1    392  1080
---- Validation: 
scalar performance:
{'acc': 0.98398256, 'precision': 0.9292691, 'recall': 0.81019413, 'specificity': 0.81019413, 'f1': 0.8594285, 'auroc': 0.9785888, 'binary_precision': 0.87173915, 'binary_recall': 0.62363917, 'binary_specificity': 0.9967491, 'binary_f1_score': 0.72710794}
confusion matrix:
       0    1
0  18090   59
1    242  401
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96244806, 'precision': 0.83732736, 'recall': 0.58279043, 'specificity': 0.58279043, 'f1': 0.62658626, 'auroc': 0.950022, 'binary_precision': 0.7096774, 'binary_recall': 0.16858238, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.27244583}
confusion matrix:
      0   1
0  5979  18
1   217  44
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811474.png
better model found
persisted
after epoch: 9,now: 2024-05-24 18:49:59.219583,epoch time: 0:42:16.197188,used: 6:10:11.879615,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_39_47_seed_0_20811474
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98901623, 'precision': 0.9225725, 'recall': 0.9050767, 'specificity': 0.9050767, 'f1': 0.91362476, 'auroc': 0.993565, 'binary_precision': 0.8515625, 'binary_recall': 0.8150918, 'binary_specificity': 0.9950616, 'binary_f1_score': 0.83292806}
confusion matrix:
       0     1
0  42112   209
1    272  1199
---- Validation: 
scalar performance:
{'acc': 0.98403573, 'precision': 0.89072394, 'recall': 0.8589753, 'specificity': 0.8589753, 'f1': 0.8741205, 'auroc': 0.9819867, 'binary_precision': 0.7911715, 'binary_recall': 0.7247278, 'binary_specificity': 0.9932228, 'binary_f1_score': 0.7564935}
confusion matrix:
       0    1
0  18026  123
1    177  466
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96244806, 'precision': 0.82077765, 'recall': 0.59378445, 'specificity': 0.59378445, 'f1': 0.63960755, 'auroc': 0.9529623, 'binary_precision': 0.6756757, 'binary_recall': 0.19157088, 'binary_specificity': 0.995998, 'binary_f1_score': 0.29850745}
confusion matrix:
      0   1
0  5973  24
1   211  50
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811474.png
better model found
persisted
after epoch: 10,now: 2024-05-24 19:32:18.735612,epoch time: 0:42:19.516029,used: 6:52:31.395644,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_39_47_seed_0_20811474
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9886281, 'precision': 0.9594606, 'recall': 0.857399, 'specificity': 0.857399, 'f1': 0.9015943, 'auroc': 0.99421203, 'binary_precision': 0.92869717, 'binary_recall': 0.71671194, 'binary_specificity': 0.99808604, 'binary_f1_score': 0.80904907}
confusion matrix:
       0     1
0  42239    81
1    417  1055
---- Validation: 
scalar performance:
{'acc': 0.98424864, 'precision': 0.9416752, 'recall': 0.8035814, 'specificity': 0.8035814, 'f1': 0.85890865, 'auroc': 0.98207223, 'binary_precision': 0.89702517, 'binary_recall': 0.6096423, 'binary_specificity': 0.9975205, 'binary_f1_score': 0.7259259}
confusion matrix:
       0    1
0  18104   45
1    251  392
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96260786, 'precision': 0.8093895, 'recall': 0.60852647, 'specificity': 0.60852647, 'f1': 0.6560973, 'auroc': 0.9517883, 'binary_precision': 0.6516854, 'binary_recall': 0.22222222, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.33142856}
confusion matrix:
      0   1
0  5966  31
1   203  58
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811474.png
better model found
persisted
after epoch: 11,now: 2024-05-24 20:11:03.046064,epoch time: 0:38:44.310452,used: 7:31:15.706096,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_39_47_seed_0_20811474
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.989747, 'precision': 0.9435148, 'recall': 0.8924031, 'specificity': 0.8924031, 'f1': 0.91627693, 'auroc': 0.9938217, 'binary_precision': 0.8943716, 'binary_recall': 0.7880435, 'binary_specificity': 0.99676275, 'binary_f1_score': 0.83784765}
confusion matrix:
       0     1
0  42183   137
1    312  1160
---- Validation: 
scalar performance:
{'acc': 0.9865368, 'precision': 0.9403442, 'recall': 0.84376895, 'specificity': 0.84376895, 'f1': 0.8856611, 'auroc': 0.97795117, 'binary_precision': 0.8915663, 'binary_recall': 0.6905132, 'binary_specificity': 0.99702466, 'binary_f1_score': 0.77826464}
confusion matrix:
       0    1
0  18095   54
1    199  444
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9603707, 'precision': 0.7929485, 'recall': 0.5615509, 'specificity': 0.5615509, 'f1': 0.59493333, 'auroc': 0.9357525, 'binary_precision': 0.6226415, 'binary_recall': 0.12643678, 'binary_specificity': 0.996665, 'binary_f1_score': 0.21019109}
confusion matrix:
      0   1
0  5977  20
1   228  33
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811474.png
better model found
persisted
after epoch: 12,now: 2024-05-24 20:51:32.114106,epoch time: 0:40:29.068042,used: 8:11:44.774138,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_39_47_seed_0_20811474
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9909801, 'precision': 0.9292425, 'recall': 0.9323399, 'specificity': 0.9323399, 'f1': 0.9307852, 'auroc': 0.9958364, 'binary_precision': 0.8630229, 'binary_recall': 0.86947656, 'binary_specificity': 0.9952033, 'binary_f1_score': 0.8662377}
confusion matrix:
       0     1
0  42118   203
1    192  1279
---- Validation: 
scalar performance:
{'acc': 0.985845, 'precision': 0.9030857, 'recall': 0.8764132, 'specificity': 0.8764132, 'f1': 0.8892549, 'auroc': 0.98415613, 'binary_precision': 0.8146911, 'binary_recall': 0.7589425, 'binary_specificity': 0.99388397, 'binary_f1_score': 0.7858293}
confusion matrix:
       0    1
0  18038  111
1    155  488
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9592522, 'precision': 0.75660694, 'recall': 0.56096727, 'specificity': 0.56096727, 'f1': 0.5923487, 'auroc': 0.95221746, 'binary_precision': 0.55, 'binary_recall': 0.12643678, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.20560749}
confusion matrix:
      0   1
0  5970  27
1   228  33
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811474.png
early stop counter: 1
val acc:0.9858450293540955, best validation acc: 0.9865368008613586, corresponding to test acc:                         0.9603707194328308 / 0.9718760251998901
after epoch: 13,now: 2024-05-24 21:33:03.631693,epoch time: 0:41:31.517587,used: 8:53:16.291725,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_39_47_seed_0_20811474
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99018085, 'precision': 0.9668901, 'recall': 0.87623465, 'specificity': 0.87623465, 'f1': 0.91633654, 'auroc': 0.99728733, 'binary_precision': 0.94227505, 'binary_recall': 0.75407606, 'binary_specificity': 0.9983932, 'binary_f1_score': 0.83773583}
confusion matrix:
       0     1
0  42252    68
1    362  1110
---- Validation: 
scalar performance:
{'acc': 0.9845679, 'precision': 0.9460914, 'recall': 0.80524683, 'specificity': 0.80524683, 'f1': 0.8615197, 'auroc': 0.98053414, 'binary_precision': 0.9057471, 'binary_recall': 0.61275274, 'binary_specificity': 0.9977409, 'binary_f1_score': 0.73098326}
confusion matrix:
       0    1
0  18108   41
1    249  394
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.8345965, 'recall': 0.53198344, 'specificity': 0.53198344, 'f1': 0.5493883, 'auroc': 0.94004935, 'binary_precision': 0.7083333, 'binary_recall': 0.0651341, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.11929825}
confusion matrix:
      0   1
0  5990   7
1   244  17
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811474.png
early stop counter: 2
val acc:0.9845678806304932, best validation acc: 0.9865368008613586, corresponding to test acc:                         0.9603707194328308 / 0.9718760251998901
after epoch: 14,now: 2024-05-24 22:16:59.273296,epoch time: 0:43:55.641603,used: 9:37:11.933328,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_39_47_seed_0_20811474
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9913911, 'precision': 0.9210516, 'recall': 0.95220757, 'specificity': 0.95220757, 'f1': 0.9360275, 'auroc': 0.9972898, 'binary_precision': 0.8452306, 'binary_recall': 0.91020405, 'binary_specificity': 0.9942111, 'binary_f1_score': 0.8765149}
confusion matrix:
       0     1
0  42077   245
1    132  1338
---- Validation: 
scalar performance:
{'acc': 0.98632395, 'precision': 0.8900566, 'recall': 0.9081634, 'specificity': 0.9081634, 'f1': 0.89888656, 'auroc': 0.9785967, 'binary_precision': 0.78635013, 'binary_recall': 0.82426125, 'binary_specificity': 0.99206567, 'binary_f1_score': 0.8048595}
confusion matrix:
       0    1
0  18005  144
1    113  530
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96612334, 'precision': 0.8141731, 'recall': 0.6946481, 'specificity': 0.6946481, 'f1': 0.73885584, 'auroc': 0.9518412, 'binary_precision': 0.6540881, 'binary_recall': 0.39846742, 'binary_specificity': 0.99082875, 'binary_f1_score': 0.49523807}
confusion matrix:
      0    1
0  5942   55
1   157  104
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811474.png
early stop counter: 3
val acc:0.9863239526748657, best validation acc: 0.9865368008613586, corresponding to test acc:                         0.9603707194328308 / 0.9718760251998901
after epoch: 15,now: 2024-05-24 23:01:57.259723,epoch time: 0:44:57.986427,used: 10:22:09.919755,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_39_47_seed_0_20811474
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99008954, 'precision': 0.9161341, 'recall': 0.935202, 'specificity': 0.935202, 'f1': 0.92543674, 'auroc': 0.9962858, 'binary_precision': 0.83657587, 'binary_recall': 0.8763587, 'binary_specificity': 0.9940454, 'binary_f1_score': 0.8560053}
confusion matrix:
       0     1
0  42068   252
1    182  1290
---- Validation: 
scalar performance:
{'acc': 0.9857918, 'precision': 0.9029035, 'recall': 0.8756356, 'specificity': 0.8756356, 'f1': 0.8887521, 'auroc': 0.9802915, 'binary_precision': 0.81438124, 'binary_recall': 0.7573872, 'binary_specificity': 0.99388397, 'binary_f1_score': 0.78485084}
confusion matrix:
       0    1
0  18038  111
1    156  487
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9613295, 'precision': 0.8153524, 'recall': 0.5712128, 'specificity': 0.5712128, 'f1': 0.60957724, 'auroc': 0.9452036, 'binary_precision': 0.6666667, 'binary_recall': 0.14559387, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.2389937}
confusion matrix:
      0   1
0  5978  19
1   223  38
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811474.png
early stop counter: 4
val acc:0.985791802406311, best validation acc: 0.9865368008613586, corresponding to test acc:                         0.9603707194328308 / 0.9718760251998901
after epoch: 16,now: 2024-05-24 23:45:48.549160,epoch time: 0:43:51.289437,used: 11:06:01.209192,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_39_47_seed_0_20811474
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99036354, 'precision': 0.9080064, 'recall': 0.95435965, 'specificity': 0.95435965, 'f1': 0.92983043, 'auroc': 0.9966991, 'binary_precision': 0.81895506, 'binary_recall': 0.9157609, 'binary_specificity': 0.9929584, 'binary_f1_score': 0.8646568}
confusion matrix:
       0     1
0  42022   298
1    124  1348
---- Validation: 
scalar performance:
{'acc': 0.9852597, 'precision': 0.8870486, 'recall': 0.89111125, 'specificity': 0.89111125, 'f1': 0.8890684, 'auroc': 0.9779339, 'binary_precision': 0.7815385, 'binary_recall': 0.79004663, 'binary_specificity': 0.9921759, 'binary_f1_score': 0.7857695}
confusion matrix:
       0    1
0  18007  142
1    135  508
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.79428005, 'recall': 0.5652989, 'specificity': 0.5652989, 'f1': 0.6002863, 'auroc': 0.9400078, 'binary_precision': 0.625, 'binary_recall': 0.13409962, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.22082019}
confusion matrix:
      0   1
0  5976  21
1   226  35
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811474.png
early stop counter: 5
val acc:0.9852597117424011, best validation acc: 0.9865368008613586, corresponding to test acc:                         0.9603707194328308 / 0.9718760251998901
after epoch: 17,now: 2024-05-25 00:29:31.694118,epoch time: 0:43:43.144958,used: 11:49:44.354150,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_39_47_seed_0_20811474
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99349195, 'precision': 0.9474554, 'recall': 0.95302755, 'specificity': 0.95302755, 'f1': 0.95022285, 'auroc': 0.9980043, 'binary_precision': 0.898055, 'binary_recall': 0.90964675, 'binary_specificity': 0.99640834, 'binary_f1_score': 0.9038137}
confusion matrix:
       0     1
0  42168   152
1    133  1339
---- Validation: 
scalar performance:
{'acc': 0.9867497, 'precision': 0.90321356, 'recall': 0.89413285, 'specificity': 0.89413285, 'f1': 0.89861715, 'auroc': 0.9821453, 'binary_precision': 0.81369424, 'binary_recall': 0.7947123, 'binary_specificity': 0.99355334, 'binary_f1_score': 0.8040913}
confusion matrix:
       0    1
0  18032  117
1    132  511
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9646852, 'precision': 0.86516035, 'recall': 0.6096104, 'specificity': 0.6096104, 'f1': 0.66303384, 'auroc': 0.95098376, 'binary_precision': 0.7631579, 'binary_recall': 0.22222222, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.34421366}
confusion matrix:
      0   1
0  5979  18
1   203  58
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811474.png
better model found
persisted
after epoch: 18,now: 2024-05-25 01:13:11.431710,epoch time: 0:43:39.737592,used: 12:33:24.091742,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_39_47_seed_0_20811474
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9925329, 'precision': 0.9619974, 'recall': 0.9197454, 'specificity': 0.9197454, 'f1': 0.93978274, 'auroc': 0.9979832, 'binary_precision': 0.92948234, 'binary_recall': 0.84171194, 'binary_specificity': 0.99777883, 'binary_f1_score': 0.8834225}
confusion matrix:
       0     1
0  42226    94
1    233  1239
---- Validation: 
scalar performance:
{'acc': 0.98408896, 'precision': 0.89477587, 'recall': 0.8537525, 'specificity': 0.8537525, 'f1': 0.87304604, 'auroc': 0.9753194, 'binary_precision': 0.79965156, 'binary_recall': 0.7138414, 'binary_specificity': 0.99366355, 'binary_f1_score': 0.7543139}
confusion matrix:
       0    1
0  18034  115
1    184  459
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590924, 'precision': 0.8259777, 'recall': 0.5169079, 'specificity': 0.5169079, 'f1': 0.5223909, 'auroc': 0.93328667, 'binary_precision': 0.6923077, 'binary_recall': 0.03448276, 'binary_specificity': 0.999333, 'binary_f1_score': 0.06569343}
confusion matrix:
      0  1
0  5993  4
1   252  9
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811474.png
early stop counter: 1
val acc:0.9840889573097229, best validation acc: 0.9867497086524963, corresponding to test acc:                         0.9646852016448975 / 0.9718760251998901
after epoch: 19,now: 2024-05-25 01:52:17.171994,epoch time: 0:39:05.740284,used: 13:12:29.832026,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_39_47_seed_0_20811474
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9922132, 'precision': 0.983369, 'recall': 0.8943348, 'specificity': 0.8943348, 'f1': 0.9340147, 'auroc': 0.99773204, 'binary_precision': 0.9740151, 'binary_recall': 0.7894022, 'binary_specificity': 0.99926746, 'binary_f1_score': 0.8720451}
confusion matrix:
       0     1
0  42289    31
1    310  1162
---- Validation: 
scalar performance:
{'acc': 0.98398256, 'precision': 0.9436531, 'recall': 0.7974433, 'specificity': 0.7974433, 'f1': 0.85509264, 'auroc': 0.9809578, 'binary_precision': 0.90140843, 'binary_recall': 0.59720063, 'binary_specificity': 0.99768585, 'binary_f1_score': 0.71842843}
confusion matrix:
       0    1
0  18107   42
1    259  384
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.808851, 'recall': 0.5393127, 'specificity': 0.5393127, 'f1': 0.5614048, 'auroc': 0.942355, 'binary_precision': 0.65625, 'binary_recall': 0.08045977, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.14334472}
confusion matrix:
      0   1
0  5986  11
1   240  21
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811474.png
early stop counter: 2
val acc:0.9839825630187988, best validation acc: 0.9867497086524963, corresponding to test acc:                         0.9646852016448975 / 0.9718760251998901
after epoch: 20,now: 2024-05-25 02:30:13.974379,epoch time: 0:37:56.802385,used: 13:50:26.634411,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_39_47_seed_0_20811474
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9926242, 'precision': 0.9708782, 'recall': 0.9122519, 'specificity': 0.9122519, 'f1': 0.9394755, 'auroc': 0.9981114, 'binary_precision': 0.94777864, 'binary_recall': 0.82608694, 'binary_specificity': 0.99841684, 'binary_f1_score': 0.8827586}
confusion matrix:
       0     1
0  42253    67
1    256  1216
---- Validation: 
scalar performance:
{'acc': 0.98547256, 'precision': 0.93753564, 'recall': 0.82821685, 'specificity': 0.82821685, 'f1': 0.8744902, 'auroc': 0.98509395, 'binary_precision': 0.8870293, 'binary_recall': 0.65940905, 'binary_specificity': 0.99702466, 'binary_f1_score': 0.75646746}
confusion matrix:
       0    1
0  18095   54
1    219  424
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.814288, 'recall': 0.54497653, 'specificity': 0.54497653, 'f1': 0.57061905, 'auroc': 0.9495113, 'binary_precision': 0.6666667, 'binary_recall': 0.09195402, 'binary_specificity': 0.997999, 'binary_f1_score': 0.16161616}
confusion matrix:
      0   1
0  5985  12
1   237  24
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811474.png
early stop counter: 3
val acc:0.985472559928894, best validation acc: 0.9867497086524963, corresponding to test acc:                         0.9646852016448975 / 0.9718760251998901
after epoch: 21,now: 2024-05-25 03:08:20.808905,epoch time: 0:38:06.834526,used: 14:28:33.468937,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_39_47_seed_0_20811474
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99454236, 'precision': 0.9734667, 'recall': 0.9407845, 'specificity': 0.9407845, 'f1': 0.95649767, 'auroc': 0.9987335, 'binary_precision': 0.9509876, 'binary_recall': 0.8831522, 'binary_specificity': 0.99841684, 'binary_f1_score': 0.9158154}
confusion matrix:
       0     1
0  42253    67
1    172  1300
---- Validation: 
scalar performance:
{'acc': 0.9865368, 'precision': 0.94744563, 'recall': 0.83701843, 'specificity': 0.83701843, 'f1': 0.88388586, 'auroc': 0.9849857, 'binary_precision': 0.90625, 'binary_recall': 0.67651635, 'binary_specificity': 0.9975205, 'binary_f1_score': 0.77471066}
confusion matrix:
       0    1
0  18104   45
1    208  435
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9637264, 'precision': 0.8899187, 'recall': 0.58345747, 'specificity': 0.58345747, 'f1': 0.63038003, 'auroc': 0.9532172, 'binary_precision': 0.8148148, 'binary_recall': 0.16858238, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.2793651}
confusion matrix:
      0   1
0  5987  10
1   217  44
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811474.png
early stop counter: 4
val acc:0.9865368008613586, best validation acc: 0.9867497086524963, corresponding to test acc:                         0.9646852016448975 / 0.9718760251998901
after epoch: 22,now: 2024-05-25 03:46:29.106013,epoch time: 0:38:08.297108,used: 15:06:41.766045,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_39_47_seed_0_20811474
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9948849, 'precision': 0.957374, 'recall': 0.96456754, 'specificity': 0.96456754, 'f1': 0.9609405, 'auroc': 0.99848294, 'binary_precision': 0.9171123, 'binary_recall': 0.9320652, 'binary_specificity': 0.99706995, 'binary_f1_score': 0.9245283}
confusion matrix:
       0     1
0  42196   124
1    100  1372
---- Validation: 
scalar performance:
{'acc': 0.98706895, 'precision': 0.91821325, 'recall': 0.87854695, 'specificity': 0.87854695, 'f1': 0.89731264, 'auroc': 0.98423755, 'binary_precision': 0.8448276, 'binary_recall': 0.7620529, 'binary_specificity': 0.9950411, 'binary_f1_score': 0.8013083}
confusion matrix:
       0    1
0  18059   90
1    153  490
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9638862, 'precision': 0.8636369, 'recall': 0.5963671, 'specificity': 0.5963671, 'f1': 0.6462164, 'auroc': 0.95259464, 'binary_precision': 0.76119405, 'binary_recall': 0.1954023, 'binary_specificity': 0.997332, 'binary_f1_score': 0.3109756}
confusion matrix:
      0   1
0  5981  16
1   210  51
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811474.png
better model found
persisted
after epoch: 23,now: 2024-05-25 04:24:32.567146,epoch time: 0:38:03.461133,used: 15:44:45.227178,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_39_47_seed_0_20811474
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9951361, 'precision': 0.958579, 'recall': 0.9672992, 'specificity': 0.9672992, 'f1': 0.9628948, 'auroc': 0.9986292, 'binary_precision': 0.91933334, 'binary_recall': 0.9374575, 'binary_specificity': 0.9971409, 'binary_f1_score': 0.928307}
confusion matrix:
       0     1
0  42200   121
1     92  1379
---- Validation: 
scalar performance:
{'acc': 0.9874947, 'precision': 0.9156419, 'recall': 0.8900182, 'specificity': 0.8900182, 'f1': 0.90238905, 'auroc': 0.9841074, 'binary_precision': 0.8388704, 'binary_recall': 0.785381, 'binary_specificity': 0.9946554, 'binary_f1_score': 0.811245}
confusion matrix:
       0    1
0  18052   97
1    138  505
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9654842, 'precision': 0.8171258, 'recall': 0.67232656, 'specificity': 0.67232656, 'f1': 0.7210862, 'auroc': 0.9439237, 'binary_precision': 0.6618705, 'binary_recall': 0.35249043, 'binary_specificity': 0.99216276, 'binary_f1_score': 0.46}
confusion matrix:
      0   1
0  5950  47
1   169  92
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811474.png
better model found
persisted
after epoch: 24,now: 2024-05-25 05:02:43.988554,epoch time: 0:38:11.421408,used: 16:22:56.648586,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_39_47_seed_0_20811474
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99132264, 'precision': 0.9045664, 'recall': 0.9804289, 'specificity': 0.9804289, 'f1': 0.93896043, 'auroc': 0.99851155, 'binary_precision': 0.8102273, 'binary_recall': 0.96875, 'binary_specificity': 0.99210775, 'binary_f1_score': 0.8824258}
confusion matrix:
       0     1
0  41986   334
1     46  1426
---- Validation: 
scalar performance:
{'acc': 0.98286504, 'precision': 0.85287535, 'recall': 0.9138733, 'specificity': 0.9138733, 'f1': 0.88071436, 'auroc': 0.983629, 'binary_precision': 0.71146244, 'binary_recall': 0.83981335, 'binary_specificity': 0.9879332, 'binary_f1_score': 0.77032816}
confusion matrix:
       0    1
0  17930  219
1    103  540
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.75913703, 'recall': 0.5868701, 'specificity': 0.5868701, 'f1': 0.6254848, 'auroc': 0.94962424, 'binary_precision': 0.5529412, 'binary_recall': 0.18007663, 'binary_specificity': 0.9936635, 'binary_f1_score': 0.2716763}
confusion matrix:
      0   1
0  5959  38
1   214  47
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811474.png
early stop counter: 1
val acc:0.982865035533905, best validation acc: 0.987494707107544, corresponding to test acc:                         0.9654842019081116 / 0.9718760251998901
after epoch: 25,now: 2024-05-25 05:40:59.714118,epoch time: 0:38:15.725564,used: 17:01:12.374150,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_39_47_seed_0_20811474
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99588966, 'precision': 0.98017293, 'recall': 0.9555497, 'specificity': 0.9555497, 'f1': 0.9675131, 'auroc': 0.99926794, 'binary_precision': 0.9633884, 'binary_recall': 0.9123046, 'binary_specificity': 0.9987949, 'binary_f1_score': 0.93715084}
confusion matrix:
       0     1
0  42270    51
1    129  1342
---- Validation: 
scalar performance:
{'acc': 0.987335, 'precision': 0.93658036, 'recall': 0.86143345, 'specificity': 0.86143345, 'f1': 0.89519596, 'auroc': 0.9790909, 'binary_precision': 0.8827977, 'binary_recall': 0.7262831, 'binary_specificity': 0.9965838, 'binary_f1_score': 0.79692835}
confusion matrix:
       0    1
0  18087   62
1    176  467
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608501, 'precision': 0.8486882, 'recall': 0.5471424, 'specificity': 0.5471424, 'f1': 0.57472205, 'auroc': 0.94129777, 'binary_precision': 0.7352941, 'binary_recall': 0.09578544, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.16949151}
confusion matrix:
      0   1
0  5988   9
1   236  25
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811474.png
early stop counter: 2
val acc:0.9873350262641907, best validation acc: 0.987494707107544, corresponding to test acc:                         0.9654842019081116 / 0.9718760251998901
after epoch: 26,now: 2024-05-25 06:19:05.535399,epoch time: 0:38:05.821281,used: 17:39:18.195431,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_39_47_seed_0_20811474
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99502194, 'precision': 0.9709929, 'recall': 0.9511962, 'specificity': 0.9511962, 'f1': 0.960866, 'auroc': 0.9989829, 'binary_precision': 0.9453125, 'binary_recall': 0.90421194, 'binary_specificity': 0.9981805, 'binary_f1_score': 0.9243055}
confusion matrix:
       0     1
0  42243    77
1    141  1331
---- Validation: 
scalar performance:
{'acc': 0.9867497, 'precision': 0.91723895, 'recall': 0.87388134, 'specificity': 0.87388134, 'f1': 0.8942758, 'auroc': 0.9808907, 'binary_precision': 0.8432056, 'binary_recall': 0.7527216, 'binary_specificity': 0.9950411, 'binary_f1_score': 0.7953985}
confusion matrix:
       0    1
0  18059   90
1    159  484
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.790263, 'recall': 0.5689636, 'specificity': 0.5689636, 'f1': 0.6051377, 'auroc': 0.9360372, 'binary_precision': 0.6166667, 'binary_recall': 0.14176245, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.2305296}
confusion matrix:
      0   1
0  5974  23
1   224  37
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811474.png
early stop counter: 3
val acc:0.9867497086524963, best validation acc: 0.987494707107544, corresponding to test acc:                         0.9654842019081116 / 0.9718760251998901
after epoch: 27,now: 2024-05-25 06:57:20.750396,epoch time: 0:38:15.214997,used: 18:17:33.410428,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_39_47_seed_0_20811474
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9941999, 'precision': 0.9418206, 'recall': 0.97304857, 'specificity': 0.97304857, 'f1': 0.9568583, 'auroc': 0.99910843, 'binary_precision': 0.8853705, 'binary_recall': 0.9503739, 'binary_specificity': 0.9957232, 'binary_f1_score': 0.9167213}
confusion matrix:
       0     1
0  42140   181
1     73  1398
---- Validation: 
scalar performance:
{'acc': 0.987335, 'precision': 0.9028124, 'recall': 0.90643674, 'specificity': 0.90643674, 'f1': 0.90461576, 'auroc': 0.98163617, 'binary_precision': 0.8120185, 'binary_recall': 0.81959563, 'binary_specificity': 0.99327785, 'binary_f1_score': 0.8157894}
confusion matrix:
       0    1
0  18027  122
1    116  527
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96340686, 'precision': 0.8112422, 'recall': 0.6272667, 'specificity': 0.6272667, 'f1': 0.6768783, 'auroc': 0.9343412, 'binary_precision': 0.65384614, 'binary_recall': 0.2605364, 'binary_specificity': 0.993997, 'binary_f1_score': 0.3726027}
confusion matrix:
      0   1
0  5961  36
1   193  68
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811474.png
early stop counter: 4
val acc:0.9873350262641907, best validation acc: 0.987494707107544, corresponding to test acc:                         0.9654842019081116 / 0.9718760251998901
after epoch: 28,now: 2024-05-25 07:35:32.039006,epoch time: 0:38:11.288610,used: 18:55:44.699038,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_39_47_seed_0_20811474
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.996118, 'precision': 0.97305167, 'recall': 0.96684486, 'specificity': 0.96684486, 'f1': 0.9699262, 'auroc': 0.99918365, 'binary_precision': 0.9483471, 'binary_recall': 0.93546194, 'binary_specificity': 0.9982278, 'binary_f1_score': 0.94186044}
confusion matrix:
       0     1
0  42245    75
1     95  1377
---- Validation: 
scalar performance:
{'acc': 0.9871222, 'precision': 0.91613847, 'recall': 0.8823248, 'specificity': 0.8823248, 'f1': 0.89845717, 'auroc': 0.984824, 'binary_precision': 0.8404075, 'binary_recall': 0.7698289, 'binary_specificity': 0.99482065, 'binary_f1_score': 0.8035714}
confusion matrix:
       0    1
0  18055   94
1    148  495
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96292746, 'precision': 0.8020685, 'recall': 0.6270166, 'specificity': 0.6270166, 'f1': 0.67523366, 'auroc': 0.94714344, 'binary_precision': 0.635514, 'binary_recall': 0.2605364, 'binary_specificity': 0.9934968, 'binary_f1_score': 0.36956522}
confusion matrix:
      0   1
0  5958  39
1   193  68
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811474.png
early stop counter: 5
val acc:0.9871221780776978, best validation acc: 0.987494707107544, corresponding to test acc:                         0.9654842019081116 / 0.9718760251998901
after epoch: 29,now: 2024-05-25 08:13:47.978770,epoch time: 0:38:15.939764,used: 19:34:00.638802,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_39_47_seed_0_20811474
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99522746, 'precision': 0.97719014, 'recall': 0.94802403, 'specificity': 0.94802403, 'f1': 0.9621129, 'auroc': 0.99913216, 'binary_precision': 0.9579405, 'binary_recall': 0.8974185, 'binary_specificity': 0.9986295, 'binary_f1_score': 0.92669237}
confusion matrix:
       0     1
0  42262    58
1    151  1321
---- Validation: 
scalar performance:
{'acc': 0.9868029, 'precision': 0.93104136, 'recall': 0.85815775, 'specificity': 0.85815775, 'f1': 0.89097255, 'auroc': 0.978403, 'binary_precision': 0.8719397, 'binary_recall': 0.7200622, 'binary_specificity': 0.99625325, 'binary_f1_score': 0.7887564}
confusion matrix:
       0    1
0  18081   68
1    180  463
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9637264, 'precision': 0.86174977, 'recall': 0.5944514, 'specificity': 0.5944514, 'f1': 0.64359355, 'auroc': 0.9018922, 'binary_precision': 0.75757575, 'binary_recall': 0.19157088, 'binary_specificity': 0.997332, 'binary_f1_score': 0.3058104}
confusion matrix:
      0   1
0  5981  16
1   211  50
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811474.png
early stop counter: 6
val acc:0.986802875995636, best validation acc: 0.987494707107544, corresponding to test acc:                         0.9654842019081116 / 0.9718760251998901
after epoch: 30,now: 2024-05-25 08:51:55.242231,epoch time: 0:38:07.263461,used: 20:12:07.902263,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_39_47_seed_0_20811474
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 20:12:07.902263 at 2024-05-25 08:51:55.242231
persisted model performance metric: 

scalar performance:
{'acc': 0.9645254, 'precision': 0.8042816, 'recall': 0.669994, 'specificity': 0.669994, 'f1': 0.71608305, 'auroc': 0.94946563, 'binary_precision': 0.6363636, 'binary_recall': 0.348659, 'binary_specificity': 0.991329, 'binary_f1_score': 0.45049503}
confusion matrix:
      0   1
0  5945  52
1   170  91
oracle model performance metric: 

scalar performance:
{'acc': 0.9697987, 'precision': 0.9027642, 'recall': 0.67091304, 'specificity': 0.67091304, 'f1': 0.7361227, 'auroc': 0.9601236, 'binary_precision': 0.8333333, 'binary_recall': 0.3448276, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.4878049}
confusion matrix:
      0   1
0  5979  18
1   171  90
results aggregation path: zoutput/benchmarks/CAMELYON_center0_vit_irm/rule_results/1.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_vit_irm/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_vit_irm/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1661 MiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |   1655 MiB |  15779 MiB |    977 TiB |    977 TiB |
|       from small pool |      6 MiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1661 MiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |   1655 MiB |  15779 MiB |    977 TiB |    977 TiB |
|       from small pool |      6 MiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1653 MiB |  15770 MiB |    987 TiB |    987 TiB |
|       from large pool |   1647 MiB |  15745 MiB |    974 TiB |    974 TiB |
|       from small pool |      5 MiB |     25 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  16730 MiB |  16730 MiB |  16730 MiB |      0 B   |
|       from large pool |  16702 MiB |  16702 MiB |  16702 MiB |      0 B   |
|       from small pool |     28 MiB |     28 MiB |     28 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 430238 KiB |    863 MiB | 413551 GiB | 413551 GiB |
|       from large pool | 410304 KiB |    862 MiB | 400661 GiB | 400661 GiB |
|       from small pool |  19934 KiB |     21 MiB |  12889 GiB |  12889 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3366    |    6357    |  152170 K  |  152167 K  |
|       from large pool |     247    |     989    |   62327 K  |   62326 K  |
|       from small pool |    3119    |    6108    |   89843 K  |   89840 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3366    |    6357    |  152170 K  |  152167 K  |
|       from large pool |     247    |     989    |   62327 K  |   62326 K  |
|       from small pool |    3119    |    6108    |   89843 K  |   89840 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     621    |     621    |     621    |       0    |
|       from large pool |     607    |     607    |     607    |       0    |
|       from small pool |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     148    |    2872    |   90023 K  |   90023 K  |
|       from large pool |     112    |     516    |   47275 K  |   47275 K  |
|       from small pool |      36    |    2760    |   42748 K  |   42748 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |  16640 KiB |  15779 MiB |    977 TiB |    977 TiB |
|       from small pool |      0 KiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |  16640 KiB |  15779 MiB |    977 TiB |    977 TiB |
|       from small pool |      0 KiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15770 MiB |    987 TiB |    987 TiB |
|       from large pool |  16640 KiB |  15745 MiB |    974 TiB |    974 TiB |
|       from small pool |      0 KiB |     25 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2082 MiB |  16730 MiB |  16730 MiB |  14648 MiB |
|       from large pool |   2056 MiB |  16702 MiB |  16702 MiB |  14646 MiB |
|       from small pool |     26 MiB |     28 MiB |     28 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    863 MiB | 413552 GiB | 413552 GiB |
|       from large pool |  24320 KiB |    862 MiB | 400662 GiB | 400662 GiB |
|       from small pool |      0 KiB |     24 MiB |  12889 GiB |  12889 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6357    |  152170 K  |  152170 K  |
|       from large pool |       2    |     989    |   62327 K  |   62327 K  |
|       from small pool |       0    |    6108    |   89843 K  |   89843 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6357    |  152170 K  |  152170 K  |
|       from large pool |       2    |     989    |   62327 K  |   62327 K  |
|       from small pool |       0    |    6108    |   89843 K  |   89843 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     115    |     621    |     621    |     506    |
|       from large pool |     102    |     607    |     607    |     505    |
|       from small pool |      13    |      14    |      14    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    2872    |   90025 K  |   90025 K  |
|       from large pool |       2    |     516    |   47275 K  |   47275 K  |
|       from small pool |       0    |    2760    |   42749 K  |   42749 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat May 25 08:54:52 2024]
Finished job 0.
1 of 1 steps (100%) done
