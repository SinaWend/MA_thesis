Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Fri May 24 12:30:39 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_vit_irm/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_vit_irm/rule_results/2.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=2
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_18_seed_0_20811470

 Experiment start at: 2024-05-24 12:40:18.265550
before training, model accuracy: 0.955097496509552
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.97223234, 'precision': 0.8213479, 'recall': 0.6716511, 'specificity': 0.6716511, 'f1': 0.72193074, 'auroc': 0.96742326, 'binary_precision': 0.6649418, 'binary_recall': 0.34942216, 'binary_specificity': 0.9938801, 'binary_f1_score': 0.45811048}
confusion matrix:
       0    1
0  42062  259
1    957  514
---- Validation: 
scalar performance:
{'acc': 0.97078544, 'precision': 0.8014227, 'recall': 0.6788527, 'specificity': 0.6788527, 'f1': 0.7231111, 'auroc': 0.96796894, 'binary_precision': 0.625, 'binary_recall': 0.36547434, 'binary_specificity': 0.99223095, 'binary_f1_score': 0.4612365}
confusion matrix:
       0    1
0  18008  141
1    408  235
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.78559375, 'recall': 0.5521391, 'specificity': 0.5521391, 'f1': 0.58092594, 'auroc': 0.948668, 'binary_precision': 0.6086956, 'binary_recall': 0.107279696, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.18241042}
confusion matrix:
      0   1
0  5979  18
1   233  28
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811470.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-24 13:22:15.192509,epoch time: 0:41:56.926959,used: 0:41:56.926959,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_18_seed_0_20811470
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9766624, 'precision': 0.81779623, 'recall': 0.829458, 'specificity': 0.829458, 'f1': 0.82351184, 'auroc': 0.9782627, 'binary_precision': 0.6470203, 'binary_recall': 0.67165196, 'binary_specificity': 0.987264, 'binary_f1_score': 0.6591061}
confusion matrix:
       0    1
0  41782  539
1    483  988
---- Validation: 
scalar performance:
{'acc': 0.9769583, 'precision': 0.82275724, 'recall': 0.8358097, 'specificity': 0.8358097, 'f1': 0.8291415, 'auroc': 0.9773375, 'binary_precision': 0.6567164, 'binary_recall': 0.6842924, 'binary_specificity': 0.9873271, 'binary_f1_score': 0.67022085}
confusion matrix:
       0    1
0  17919  230
1    203  440
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.98114413, 'precision': 0.92051387, 'recall': 0.82708406, 'specificity': 0.82708406, 'f1': 0.86739975, 'auroc': 0.9622079, 'binary_precision': 0.8557214, 'binary_recall': 0.65900385, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.7445888}
confusion matrix:
      0    1
0  5968   29
1    89  172
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811470.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-05-24 14:01:43.292408,epoch time: 0:39:28.099899,used: 1:21:25.026858,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_18_seed_0_20811470
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97922, 'precision': 0.9376402, 'recall': 0.71548617, 'specificity': 0.71548617, 'f1': 0.7863388, 'auroc': 0.9852017, 'binary_precision': 0.8946629, 'binary_recall': 0.43274456, 'binary_specificity': 0.9982278, 'binary_f1_score': 0.5833333}
confusion matrix:
       0    1
0  42245   75
1    835  637
---- Validation: 
scalar performance:
{'acc': 0.9769583, 'precision': 0.94886315, 'recall': 0.6782982, 'specificity': 0.6782982, 'f1': 0.7516582, 'auroc': 0.97941244, 'binary_precision': 0.92, 'binary_recall': 0.3576983, 'binary_specificity': 0.998898, 'binary_f1_score': 0.5151176}
confusion matrix:
       0    1
0  18129   20
1    413  230
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9592522, 'precision': 0.9796065, 'recall': 0.5114943, 'specificity': 0.5114943, 'f1': 0.5120629, 'auroc': 0.9551115, 'binary_precision': 1.0, 'binary_recall': 0.022988506, 'binary_specificity': 1.0, 'binary_f1_score': 0.044943817}
confusion matrix:
      0  1
0  5997  0
1   255  6
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811470.png
early stop counter: 1
val acc:0.9769582748413086, best validation acc: 0.9769582748413086, corresponding to test acc:                         0.98114413022995 / 0.98114413022995
after epoch: 3,now: 2024-05-24 14:42:58.631515,epoch time: 0:41:15.339107,used: 2:02:40.365965,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_18_seed_0_20811470
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9812066, 'precision': 0.83732474, 'recall': 0.90863955, 'specificity': 0.90863955, 'f1': 0.86924005, 'auroc': 0.9863386, 'binary_precision': 0.68057877, 'binary_recall': 0.8308424, 'binary_specificity': 0.98643667, 'binary_f1_score': 0.74824107}
confusion matrix:
       0     1
0  41746   574
1    249  1223
---- Validation: 
scalar performance:
{'acc': 0.98094934, 'precision': 0.8420913, 'recall': 0.8941301, 'specificity': 0.8941301, 'f1': 0.86609215, 'auroc': 0.98099625, 'binary_precision': 0.6912752, 'binary_recall': 0.8009331, 'binary_specificity': 0.9873271, 'binary_f1_score': 0.7420749}
confusion matrix:
       0    1
0  17919  230
1    128  515
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96644294, 'precision': 0.837896, 'recall': 0.66549754, 'specificity': 0.66549754, 'f1': 0.71932304, 'auroc': 0.96183777, 'binary_precision': 0.704, 'binary_recall': 0.33716476, 'binary_specificity': 0.99383026, 'binary_f1_score': 0.45595858}
confusion matrix:
      0   1
0  5960  37
1   173  88
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811470.png
better model found
persisted
after epoch: 4,now: 2024-05-24 15:24:57.291715,epoch time: 0:41:58.660200,used: 2:44:39.026165,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_18_seed_0_20811470
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9820972, 'precision': 0.86242115, 'recall': 0.86146986, 'specificity': 0.86146986, 'f1': 0.8619448, 'auroc': 0.9876567, 'binary_precision': 0.7341513, 'binary_recall': 0.732155, 'binary_specificity': 0.9907847, 'binary_f1_score': 0.7331518}
confusion matrix:
       0     1
0  41931   390
1    394  1077
---- Validation: 
scalar performance:
{'acc': 0.9815879, 'precision': 0.8652234, 'recall': 0.8509575, 'specificity': 0.8509575, 'f1': 0.8579357, 'auroc': 0.9794598, 'binary_precision': 0.7406807, 'binary_recall': 0.71073097, 'binary_specificity': 0.9911841, 'binary_f1_score': 0.7253968}
confusion matrix:
       0    1
0  17989  160
1    186  457
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.8136451, 'recall': 0.616106, 'specificity': 0.616106, 'f1': 0.6651503, 'auroc': 0.9610367, 'binary_precision': 0.65957445, 'binary_recall': 0.23754789, 'binary_specificity': 0.994664, 'binary_f1_score': 0.3492958}
confusion matrix:
      0   1
0  5965  32
1   199  62
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811470.png
better model found
persisted
after epoch: 5,now: 2024-05-24 16:04:01.666140,epoch time: 0:39:04.374425,used: 3:23:43.400590,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_18_seed_0_20811470
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9839697, 'precision': 0.85933936, 'recall': 0.91695416, 'specificity': 0.91695416, 'f1': 0.8858096, 'auroc': 0.98840785, 'binary_precision': 0.7240978, 'binary_recall': 0.8451087, 'binary_specificity': 0.98879963, 'binary_f1_score': 0.7799373}
confusion matrix:
       0     1
0  41846   474
1    228  1244
---- Validation: 
scalar performance:
{'acc': 0.9835568, 'precision': 0.8664346, 'recall': 0.89548004, 'specificity': 0.89548004, 'f1': 0.88035274, 'auroc': 0.984155, 'binary_precision': 0.73994255, 'binary_recall': 0.8009331, 'binary_specificity': 0.990027, 'binary_f1_score': 0.7692308}
confusion matrix:
       0    1
0  17968  181
1    128  515
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96340686, 'precision': 0.7951685, 'recall': 0.65475166, 'specificity': 0.65475166, 'f1': 0.70068014, 'auroc': 0.9477811, 'binary_precision': 0.619403, 'binary_recall': 0.31800765, 'binary_specificity': 0.9914957, 'binary_f1_score': 0.42025316}
confusion matrix:
      0   1
0  5946  51
1   178  83
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811470.png
better model found
persisted
after epoch: 6,now: 2024-05-24 16:46:09.436779,epoch time: 0:42:07.770639,used: 4:05:51.171229,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_18_seed_0_20811470
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9854083, 'precision': 0.92965204, 'recall': 0.83048797, 'specificity': 0.83048797, 'f1': 0.8731193, 'auroc': 0.99038434, 'binary_precision': 0.87088156, 'binary_recall': 0.6644022, 'binary_specificity': 0.99657375, 'binary_f1_score': 0.7537572}
confusion matrix:
       0    1
0  42175  145
1    494  978
---- Validation: 
scalar performance:
{'acc': 0.9833972, 'precision': 0.92505133, 'recall': 0.8038907, 'specificity': 0.8038907, 'f1': 0.8536478, 'auroc': 0.9803972, 'binary_precision': 0.8637363, 'binary_recall': 0.61119753, 'binary_specificity': 0.9965838, 'binary_f1_score': 0.71584696}
confusion matrix:
       0    1
0  18087   62
1    250  393
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608501, 'precision': 0.83645284, 'recall': 0.550807, 'specificity': 0.550807, 'f1': 0.580274, 'auroc': 0.94687176, 'binary_precision': 0.7105263, 'binary_recall': 0.10344828, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.18060201}
confusion matrix:
      0   1
0  5986  11
1   234  27
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811470.png
early stop counter: 1
val acc:0.9833971858024597, best validation acc: 0.9835568070411682, corresponding to test acc:                         0.9634068608283997 / 0.98114413022995
after epoch: 7,now: 2024-05-24 17:27:57.192436,epoch time: 0:41:47.755657,used: 4:47:38.926886,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_18_seed_0_20811470
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9808413, 'precision': 0.82499254, 'recall': 0.9497043, 'specificity': 0.9497043, 'f1': 0.87627137, 'auroc': 0.9914948, 'binary_precision': 0.65293264, 'binary_recall': 0.9163265, 'binary_specificity': 0.98308206, 'binary_f1_score': 0.7625248}
confusion matrix:
       0     1
0  41606   716
1    123  1347
---- Validation: 
scalar performance:
{'acc': 0.9792997, 'precision': 0.82143927, 'recall': 0.9247784, 'specificity': 0.9247784, 'f1': 0.8652015, 'auroc': 0.9828553, 'binary_precision': 0.64767444, 'binary_recall': 0.86625195, 'binary_specificity': 0.98330486, 'binary_f1_score': 0.7411843}
confusion matrix:
       0    1
0  17846  303
1     86  557
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9688399, 'precision': 0.8312657, 'recall': 0.7290475, 'specificity': 0.7290475, 'f1': 0.7698312, 'auroc': 0.9563428, 'binary_precision': 0.6853933, 'binary_recall': 0.46743295, 'binary_specificity': 0.990662, 'binary_f1_score': 0.55580866}
confusion matrix:
      0    1
0  5941   56
1   139  122
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811470.png
early stop counter: 2
val acc:0.9792997241020203, best validation acc: 0.9835568070411682, corresponding to test acc:                         0.9634068608283997 / 0.98114413022995
after epoch: 8,now: 2024-05-24 18:07:17.589818,epoch time: 0:39:20.397382,used: 5:26:59.324268,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_18_seed_0_20811470
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.989884, 'precision': 0.9572818, 'recall': 0.8803432, 'specificity': 0.8803432, 'f1': 0.91501826, 'auroc': 0.9942055, 'binary_precision': 0.9227609, 'binary_recall': 0.7629076, 'binary_specificity': 0.99777883, 'binary_f1_score': 0.8352548}
confusion matrix:
       0     1
0  42226    94
1    349  1123
---- Validation: 
scalar performance:
{'acc': 0.9844615, 'precision': 0.94491476, 'recall': 0.8044417, 'specificity': 0.8044417, 'f1': 0.8605647, 'auroc': 0.98057544, 'binary_precision': 0.9034483, 'binary_recall': 0.61119753, 'binary_specificity': 0.99768585, 'binary_f1_score': 0.729128}
confusion matrix:
       0    1
0  18107   42
1    250  393
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614893, 'precision': 0.8317977, 'recall': 0.5657992, 'specificity': 0.5657992, 'f1': 0.6026672, 'auroc': 0.94111884, 'binary_precision': 0.7, 'binary_recall': 0.13409962, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.22508039}
confusion matrix:
      0   1
0  5982  15
1   226  35
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811470.png
better model found
persisted
after epoch: 9,now: 2024-05-24 18:49:59.483511,epoch time: 0:42:41.893693,used: 6:09:41.217961,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_18_seed_0_20811470
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98997533, 'precision': 0.93148327, 'recall': 0.91076314, 'specificity': 0.91076314, 'f1': 0.92084813, 'auroc': 0.9956206, 'binary_precision': 0.869005, 'binary_recall': 0.82585037, 'binary_specificity': 0.995676, 'binary_f1_score': 0.84687823}
confusion matrix:
       0     1
0  42139   183
1    256  1214
---- Validation: 
scalar performance:
{'acc': 0.9860579, 'precision': 0.9168237, 'recall': 0.8615223, 'specificity': 0.8615223, 'f1': 0.88705087, 'auroc': 0.9840163, 'binary_precision': 0.84324324, 'binary_recall': 0.7278383, 'binary_specificity': 0.99520636, 'binary_f1_score': 0.7813022}
confusion matrix:
       0    1
0  18062   87
1    175  468
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96164906, 'precision': 0.8389435, 'recall': 0.56588256, 'specificity': 0.56588256, 'f1': 0.603072, 'auroc': 0.95355535, 'binary_precision': 0.71428573, 'binary_recall': 0.13409962, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.22580646}
confusion matrix:
      0   1
0  5983  14
1   226  35
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811470.png
better model found
persisted
after epoch: 10,now: 2024-05-24 19:32:18.942516,epoch time: 0:42:19.459005,used: 6:52:00.676966,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_18_seed_0_20811470
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9915738, 'precision': 0.9364964, 'recall': 0.9333471, 'specificity': 0.9333471, 'f1': 0.9349156, 'auroc': 0.99608874, 'binary_precision': 0.87748116, 'binary_recall': 0.87092394, 'binary_specificity': 0.99577034, 'binary_f1_score': 0.8741903}
confusion matrix:
       0     1
0  42141   179
1    190  1282
---- Validation: 
scalar performance:
{'acc': 0.98547256, 'precision': 0.91737086, 'recall': 0.84996843, 'specificity': 0.84996843, 'f1': 0.88047445, 'auroc': 0.97796416, 'binary_precision': 0.8451493, 'binary_recall': 0.7045101, 'binary_specificity': 0.9954268, 'binary_f1_score': 0.7684478}
confusion matrix:
       0    1
0  18066   83
1    190  453
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.970278, 'precision': 0.8916786, 'recall': 0.68582183, 'specificity': 0.68582183, 'f1': 0.74888015, 'auroc': 0.941231, 'binary_precision': 0.80991733, 'binary_recall': 0.37547892, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.513089}
confusion matrix:
      0   1
0  5974  23
1   163  98
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811470.png
early stop counter: 1
val acc:0.985472559928894, best validation acc: 0.9860578775405884, corresponding to test acc:                         0.9616490602493286 / 0.98114413022995
after epoch: 11,now: 2024-05-24 20:12:06.838622,epoch time: 0:39:47.896106,used: 7:31:48.573072,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_18_seed_0_20811470
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98855954, 'precision': 0.9669174, 'recall': 0.8497212, 'specificity': 0.8497212, 'f1': 0.8993166, 'auroc': 0.9950836, 'binary_precision': 0.9441392, 'binary_recall': 0.70088375, 'binary_specificity': 0.99855864, 'binary_f1_score': 0.8045259}
confusion matrix:
       0     1
0  42260    61
1    440  1031
---- Validation: 
scalar performance:
{'acc': 0.9841954, 'precision': 0.9488764, 'recall': 0.79680336, 'specificity': 0.79680336, 'f1': 0.85623485, 'auroc': 0.9787038, 'binary_precision': 0.91190475, 'binary_recall': 0.5956454, 'binary_specificity': 0.99796134, 'binary_f1_score': 0.72060204}
confusion matrix:
       0    1
0  18112   37
1    260  383
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606903, 'precision': 0.82272446, 'recall': 0.552556, 'specificity': 0.552556, 'f1': 0.5826448, 'auroc': 0.9440574, 'binary_precision': 0.68292683, 'binary_recall': 0.107279696, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.18543045}
confusion matrix:
      0   1
0  5984  13
1   233  28
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811470.png
early stop counter: 2
val acc:0.9841954112052917, best validation acc: 0.9860578775405884, corresponding to test acc:                         0.9616490602493286 / 0.98114413022995
after epoch: 12,now: 2024-05-24 20:51:57.494519,epoch time: 0:39:50.655897,used: 8:11:39.228969,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_18_seed_0_20811470
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9923045, 'precision': 0.9320947, 'recall': 0.952741, 'specificity': 0.952741, 'f1': 0.94215727, 'auroc': 0.9972558, 'binary_precision': 0.8673139, 'binary_recall': 0.91032606, 'binary_specificity': 0.99515593, 'binary_f1_score': 0.8882996}
confusion matrix:
       0     1
0  42115   205
1    132  1340
---- Validation: 
scalar performance:
{'acc': 0.9870157, 'precision': 0.91310084, 'recall': 0.8845198, 'specificity': 0.8845198, 'f1': 0.89825606, 'auroc': 0.9825058, 'binary_precision': 0.8341709, 'binary_recall': 0.7744945, 'binary_specificity': 0.99454516, 'binary_f1_score': 0.80322576}
confusion matrix:
       0    1
0  18050   99
1    145  498
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9646852, 'precision': 0.8364564, 'recall': 0.62976605, 'specificity': 0.62976605, 'f1': 0.68311113, 'auroc': 0.9575943, 'binary_precision': 0.70408165, 'binary_recall': 0.26436782, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.3844011}
confusion matrix:
      0   1
0  5968  29
1   192  69
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811470.png
better model found
persisted
after epoch: 13,now: 2024-05-24 21:33:01.179403,epoch time: 0:41:03.684884,used: 8:52:42.913853,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_18_seed_0_20811470
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99198484, 'precision': 0.94069207, 'recall': 0.935199, 'specificity': 0.935199, 'f1': 0.937927, 'auroc': 0.99694955, 'binary_precision': 0.88575363, 'binary_recall': 0.8743206, 'binary_specificity': 0.9960775, 'binary_f1_score': 0.88}
confusion matrix:
       0     1
0  42154   166
1    185  1287
---- Validation: 
scalar performance:
{'acc': 0.9856322, 'precision': 0.92495024, 'recall': 0.84405065, 'specificity': 0.84405065, 'f1': 0.8799144, 'auroc': 0.9839723, 'binary_precision': 0.860735, 'binary_recall': 0.69206846, 'binary_specificity': 0.99603283, 'binary_f1_score': 0.7672414}
confusion matrix:
       0    1
0  18077   72
1    198  445
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96180886, 'precision': 0.8377222, 'recall': 0.5696306, 'specificity': 0.5696306, 'f1': 0.6084182, 'auroc': 0.95204127, 'binary_precision': 0.71153843, 'binary_recall': 0.14176245, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.23642172}
confusion matrix:
      0   1
0  5982  15
1   224  37
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811470.png
early stop counter: 1
val acc:0.9856321811676025, best validation acc: 0.9870157241821289, corresponding to test acc:                         0.9646852016448975 / 0.98114413022995
after epoch: 14,now: 2024-05-24 22:16:58.784154,epoch time: 0:43:57.604751,used: 9:36:40.518604,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_18_seed_0_20811470
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99075174, 'precision': 0.9101744, 'recall': 0.95814097, 'specificity': 0.95814097, 'f1': 0.93271947, 'auroc': 0.99713326, 'binary_precision': 0.8230303, 'binary_recall': 0.92318153, 'binary_specificity': 0.99310035, 'binary_f1_score': 0.87023395}
confusion matrix:
       0     1
0  42029   292
1    113  1358
---- Validation: 
scalar performance:
{'acc': 0.98557895, 'precision': 0.8854399, 'recall': 0.9010273, 'specificity': 0.9010273, 'f1': 0.89306545, 'auroc': 0.9829421, 'binary_precision': 0.7776119, 'binary_recall': 0.8102644, 'binary_specificity': 0.9917902, 'binary_f1_score': 0.79360247}
confusion matrix:
       0    1
0  18000  149
1    122  521
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.85757506, 'recall': 0.5849563, 'specificity': 0.5849563, 'f1': 0.6307158, 'auroc': 0.94530165, 'binary_precision': 0.75, 'binary_recall': 0.1724138, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.2803738}
confusion matrix:
      0   1
0  5982  15
1   216  45
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811470.png
early stop counter: 2
val acc:0.9855789542198181, best validation acc: 0.9870157241821289, corresponding to test acc:                         0.9646852016448975 / 0.98114413022995
after epoch: 15,now: 2024-05-24 23:01:57.364400,epoch time: 0:44:58.580246,used: 10:21:39.098850,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_18_seed_0_20811470
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.991825, 'precision': 0.9787613, 'recall': 0.89216685, 'specificity': 0.89216685, 'f1': 0.93085086, 'auroc': 0.9971605, 'binary_precision': 0.96494156, 'binary_recall': 0.78532606, 'binary_specificity': 0.9990076, 'binary_f1_score': 0.8659176}
confusion matrix:
       0     1
0  42278    42
1    316  1156
---- Validation: 
scalar performance:
{'acc': 0.9860047, 'precision': 0.94617856, 'recall': 0.82924235, 'specificity': 0.82924235, 'f1': 0.87824523, 'auroc': 0.9801779, 'binary_precision': 0.90425533, 'binary_recall': 0.66096425, 'binary_specificity': 0.9975205, 'binary_f1_score': 0.7637017}
confusion matrix:
       0    1
0  18104   45
1    218  425
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9603707, 'precision': 0.8852012, 'recall': 0.53223354, 'specificity': 0.53223354, 'f1': 0.550148, 'auroc': 0.9478667, 'binary_precision': 0.8095238, 'binary_recall': 0.0651341, 'binary_specificity': 0.999333, 'binary_f1_score': 0.120567374}
confusion matrix:
      0   1
0  5993   4
1   244  17
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811470.png
early stop counter: 3
val acc:0.9860047101974487, best validation acc: 0.9870157241821289, corresponding to test acc:                         0.9646852016448975 / 0.98114413022995
after epoch: 16,now: 2024-05-24 23:45:48.125583,epoch time: 0:43:50.761183,used: 11:05:29.860033,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_18_seed_0_20811470
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9946794, 'precision': 0.9689958, 'recall': 0.94774044, 'specificity': 0.94774044, 'f1': 0.95810294, 'auroc': 0.9983292, 'binary_precision': 0.94155383, 'binary_recall': 0.8974185, 'binary_specificity': 0.9980624, 'binary_f1_score': 0.9189566}
confusion matrix:
       0     1
0  42238    82
1    151  1321
---- Validation: 
scalar performance:
{'acc': 0.98632395, 'precision': 0.93246365, 'recall': 0.8481591, 'specificity': 0.8481591, 'f1': 0.88540924, 'auroc': 0.97855353, 'binary_precision': 0.8754864, 'binary_recall': 0.6998445, 'binary_specificity': 0.9964736, 'binary_f1_score': 0.77787375}
confusion matrix:
       0    1
0  18085   64
1    193  450
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.7791153, 'recall': 0.5520557, 'specificity': 0.5520557, 'f1': 0.580588, 'auroc': 0.94680756, 'binary_precision': 0.59574467, 'binary_recall': 0.107279696, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.18181817}
confusion matrix:
      0   1
0  5978  19
1   233  28
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811470.png
early stop counter: 4
val acc:0.9863239526748657, best validation acc: 0.9870157241821289, corresponding to test acc:                         0.9646852016448975 / 0.98114413022995
after epoch: 17,now: 2024-05-25 00:29:31.481916,epoch time: 0:43:43.356333,used: 11:49:13.216366,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_18_seed_0_20811470
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99187064, 'precision': 0.9228181, 'recall': 0.95874584, 'specificity': 0.95874584, 'f1': 0.93998873, 'auroc': 0.9978951, 'binary_precision': 0.8483146, 'binary_recall': 0.9232337, 'binary_specificity': 0.99425805, 'binary_f1_score': 0.88418996}
confusion matrix:
       0     1
0  42077   243
1    113  1359
---- Validation: 
scalar performance:
{'acc': 0.98392934, 'precision': 0.873269, 'recall': 0.8889224, 'specificity': 0.8889224, 'f1': 0.88092047, 'auroc': 0.98260844, 'binary_precision': 0.75409836, 'binary_recall': 0.7869362, 'binary_specificity': 0.99090856, 'binary_f1_score': 0.7701674}
confusion matrix:
       0    1
0  17984  165
1    137  506
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96164906, 'precision': 0.77790856, 'recall': 0.63184655, 'specificity': 0.63184655, 'f1': 0.6759743, 'auroc': 0.9507092, 'binary_precision': 0.58677685, 'binary_recall': 0.27203065, 'binary_specificity': 0.9916625, 'binary_f1_score': 0.37172773}
confusion matrix:
      0   1
0  5947  50
1   190  71
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811470.png
early stop counter: 5
val acc:0.9839293360710144, best validation acc: 0.9870157241821289, corresponding to test acc:                         0.9646852016448975 / 0.98114413022995
after epoch: 18,now: 2024-05-25 01:13:07.355982,epoch time: 0:43:35.874066,used: 12:32:49.090432,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_18_seed_0_20811470
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9943597, 'precision': 0.9832873, 'recall': 0.92823136, 'specificity': 0.92823136, 'f1': 0.9539751, 'auroc': 0.99861026, 'binary_precision': 0.97151655, 'binary_recall': 0.85733694, 'binary_specificity': 0.9991257, 'binary_f1_score': 0.9108625}
confusion matrix:
       0     1
0  42283    37
1    210  1262
---- Validation: 
scalar performance:
{'acc': 0.9867497, 'precision': 0.952955, 'recall': 0.8356285, 'specificity': 0.8356285, 'f1': 0.8849269, 'auroc': 0.9785266, 'binary_precision': 0.9173729, 'binary_recall': 0.6734059, 'binary_specificity': 0.99785113, 'binary_f1_score': 0.77668154}
confusion matrix:
       0    1
0  18110   39
1    210  433
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.8043295, 'recall': 0.5411451, 'specificity': 0.5411451, 'f1': 0.56430703, 'auroc': 0.93774635, 'binary_precision': 0.64705884, 'binary_recall': 0.08429119, 'binary_specificity': 0.997999, 'binary_f1_score': 0.14915255}
confusion matrix:
      0   1
0  5985  12
1   239  22
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811470.png
early stop counter: 6
val acc:0.9867497086524963, best validation acc: 0.9870157241821289, corresponding to test acc:                         0.9646852016448975 / 0.98114413022995
after epoch: 19,now: 2024-05-25 01:52:17.644801,epoch time: 0:39:10.288819,used: 13:11:59.379251,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_18_seed_0_20811470
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9946109, 'precision': 0.9607372, 'recall': 0.9559015, 'specificity': 0.9559015, 'f1': 0.9583056, 'auroc': 0.998487, 'binary_precision': 0.9244506, 'binary_recall': 0.9144022, 'binary_specificity': 0.99740076, 'binary_f1_score': 0.9193989}
confusion matrix:
       0     1
0  42210   110
1    126  1346
---- Validation: 
scalar performance:
{'acc': 0.9867497, 'precision': 0.9244039, 'recall': 0.8648807, 'specificity': 0.8648807, 'f1': 0.89222, 'auroc': 0.9824994, 'binary_precision': 0.85818183, 'binary_recall': 0.7340591, 'binary_specificity': 0.99570227, 'binary_f1_score': 0.7912825}
confusion matrix:
       0    1
0  18071   78
1    171  472
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96180886, 'precision': 0.827005, 'recall': 0.5751276, 'specificity': 0.5751276, 'f1': 0.6155943, 'auroc': 0.9471128, 'binary_precision': 0.6896552, 'binary_recall': 0.1532567, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.25078368}
confusion matrix:
      0   1
0  5979  18
1   221  40
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811470.png
early stop counter: 7
val acc:0.9867497086524963, best validation acc: 0.9870157241821289, corresponding to test acc:                         0.9646852016448975 / 0.98114413022995
after epoch: 20,now: 2024-05-25 02:30:47.245576,epoch time: 0:38:29.600775,used: 13:50:28.980026,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_18_seed_0_20811470
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9947936, 'precision': 0.9773245, 'recall': 0.9409145, 'specificity': 0.9409145, 'f1': 0.9583438, 'auroc': 0.9988442, 'binary_precision': 0.9587021, 'binary_recall': 0.8831522, 'binary_specificity': 0.9986768, 'binary_f1_score': 0.9193777}
confusion matrix:
       0     1
0  42264    56
1    172  1300
---- Validation: 
scalar performance:
{'acc': 0.9864304, 'precision': 0.9378143, 'recall': 0.8444639, 'specificity': 0.8444639, 'f1': 0.8851473, 'auroc': 0.98255575, 'binary_precision': 0.88645416, 'binary_recall': 0.69206846, 'binary_specificity': 0.9968593, 'binary_f1_score': 0.77729255}
confusion matrix:
       0    1
0  18092   57
1    198  445
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9646852, 'precision': 0.8943439, 'recall': 0.596784, 'specificity': 0.596784, 'f1': 0.64883214, 'auroc': 0.94873905, 'binary_precision': 0.82258064, 'binary_recall': 0.1954023, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.31578946}
confusion matrix:
      0   1
0  5986  11
1   210  51
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811470.png
early stop counter: 8
val acc:0.9864304065704346, best validation acc: 0.9870157241821289, corresponding to test acc:                         0.9646852016448975 / 0.98114413022995
after epoch: 21,now: 2024-05-25 03:09:02.182541,epoch time: 0:38:14.936965,used: 14:28:43.916991,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_18_seed_0_20811470
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9948621, 'precision': 0.96115, 'recall': 0.9596379, 'specificity': 0.9596379, 'f1': 0.9603926, 'auroc': 0.99887085, 'binary_precision': 0.92501706, 'binary_recall': 0.921875, 'binary_specificity': 0.99740076, 'binary_f1_score': 0.9234434}
confusion matrix:
       0     1
0  42210   110
1    115  1357
---- Validation: 
scalar performance:
{'acc': 0.98616433, 'precision': 0.9142622, 'recall': 0.8668278, 'specificity': 0.8668278, 'f1': 0.88898796, 'auroc': 0.9826233, 'binary_precision': 0.8377425, 'binary_recall': 0.7387247, 'binary_specificity': 0.99493086, 'binary_f1_score': 0.7851239}
confusion matrix:
       0    1
0  18057   92
1    168  475
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9697987, 'precision': 0.87964773, 'recall': 0.68740404, 'specificity': 0.68740404, 'f1': 0.7480227, 'auroc': 0.9548588, 'binary_precision': 0.78571427, 'binary_recall': 0.37931034, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.51162785}
confusion matrix:
      0   1
0  5970  27
1   162  99
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811470.png
early stop counter: 9
val acc:0.9861643314361572, best validation acc: 0.9870157241821289, corresponding to test acc:                         0.9646852016448975 / 0.98114413022995
after epoch: 22,now: 2024-05-25 03:47:19.500148,epoch time: 0:38:17.317607,used: 15:07:01.234598,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_18_seed_0_20811470
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9918935, 'precision': 0.9128783, 'recall': 0.9761342, 'specificity': 0.9761342, 'f1': 0.9420619, 'auroc': 0.99864304, 'binary_precision': 0.8271822, 'binary_recall': 0.9592391, 'binary_specificity': 0.9930293, 'binary_f1_score': 0.8883296}
confusion matrix:
       0     1
0  42025   295
1     60  1412
---- Validation: 
scalar performance:
{'acc': 0.9843018, 'precision': 0.86875105, 'recall': 0.90786666, 'specificity': 0.90786666, 'f1': 0.8872328, 'auroc': 0.9851059, 'binary_precision': 0.74369746, 'binary_recall': 0.8258165, 'binary_specificity': 0.9899168, 'binary_f1_score': 0.7826086}
confusion matrix:
       0    1
0  17966  183
1    112  531
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96660274, 'precision': 0.8081994, 'recall': 0.72238326, 'specificity': 0.72238326, 'f1': 0.75756073, 'auroc': 0.9420994, 'binary_precision': 0.63978493, 'binary_recall': 0.4559387, 'binary_specificity': 0.98882776, 'binary_f1_score': 0.5324385}
confusion matrix:
      0    1
0  5930   67
1   142  119
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811470.png
early stop counter: 10
val acc:0.9843018054962158, best validation acc: 0.9870157241821289, corresponding to test acc:                         0.9646852016448975 / 0.98114413022995
after epoch: 23,now: 2024-05-25 04:25:26.845429,epoch time: 0:38:07.345281,used: 15:45:08.579879,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_18_seed_0_20811470
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99550146, 'precision': 0.9857458, 'recall': 0.9438278, 'specificity': 0.9438278, 'f1': 0.9637723, 'auroc': 0.9989375, 'binary_precision': 0.97535473, 'binary_recall': 0.88843536, 'binary_specificity': 0.99922025, 'binary_f1_score': 0.92986834}
confusion matrix:
       0     1
0  42289    33
1    164  1306
---- Validation: 
scalar performance:
{'acc': 0.9865368, 'precision': 0.94909924, 'recall': 0.8355183, 'specificity': 0.8355183, 'f1': 0.8834835, 'auroc': 0.983461, 'binary_precision': 0.90966386, 'binary_recall': 0.6734059, 'binary_specificity': 0.9976307, 'binary_f1_score': 0.7739052}
confusion matrix:
       0    1
0  18106   43
1    210  433
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96772134, 'precision': 0.85994077, 'recall': 0.6679968, 'specificity': 0.6679968, 'f1': 0.7258882, 'auroc': 0.9517747, 'binary_precision': 0.7478992, 'binary_recall': 0.34099618, 'binary_specificity': 0.9949975, 'binary_f1_score': 0.46842107}
confusion matrix:
      0   1
0  5967  30
1   172  89
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811470.png
early stop counter: 11
val acc:0.9865368008613586, best validation acc: 0.9870157241821289, corresponding to test acc:                         0.9646852016448975 / 0.98114413022995
after epoch: 24,now: 2024-05-25 05:03:40.983522,epoch time: 0:38:14.138093,used: 16:23:22.717972,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_18_seed_0_20811470
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9944739, 'precision': 0.9438267, 'recall': 0.9751743, 'specificity': 0.9751743, 'f1': 0.95892245, 'auroc': 0.9984586, 'binary_precision': 0.8892405, 'binary_recall': 0.9544837, 'binary_specificity': 0.99586487, 'binary_f1_score': 0.9207077}
confusion matrix:
       0     1
0  42145   175
1     67  1405
---- Validation: 
scalar performance:
{'acc': 0.9845147, 'precision': 0.87626034, 'recall': 0.89597595, 'specificity': 0.89597595, 'f1': 0.8858438, 'auroc': 0.98253053, 'binary_precision': 0.75958705, 'binary_recall': 0.8009331, 'binary_specificity': 0.9910188, 'binary_f1_score': 0.7797123}
confusion matrix:
       0    1
0  17986  163
1    128  515
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.965644, 'precision': 0.824346, 'recall': 0.66508067, 'specificity': 0.66508067, 'f1': 0.71619797, 'auroc': 0.94974256, 'binary_precision': 0.6769231, 'binary_recall': 0.33716476, 'binary_specificity': 0.9929965, 'binary_f1_score': 0.45012787}
confusion matrix:
      0   1
0  5955  42
1   173  88
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811470.png
early stop counter: 12
val acc:0.9845147132873535, best validation acc: 0.9870157241821289, corresponding to test acc:                         0.9646852016448975 / 0.98114413022995
after epoch: 25,now: 2024-05-25 05:41:55.276117,epoch time: 0:38:14.292595,used: 17:01:37.010567,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_18_seed_0_20811470
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9961865, 'precision': 0.98340726, 'recall': 0.95704454, 'specificity': 0.95704454, 'f1': 0.96982884, 'auroc': 0.99944794, 'binary_precision': 0.96976244, 'binary_recall': 0.9150815, 'binary_specificity': 0.9990076, 'binary_f1_score': 0.94162875}
confusion matrix:
       0     1
0  42278    42
1    125  1347
---- Validation: 
scalar performance:
{'acc': 0.9856854, 'precision': 0.9257846, 'recall': 0.8440782, 'specificity': 0.8440782, 'f1': 0.8802592, 'auroc': 0.97998834, 'binary_precision': 0.8624031, 'binary_recall': 0.69206846, 'binary_specificity': 0.99608797, 'binary_f1_score': 0.76790345}
confusion matrix:
       0    1
0  18078   71
1    198  445
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9696389, 'precision': 0.8933286, 'recall': 0.6744943, 'specificity': 0.6744943, 'f1': 0.7381652, 'auroc': 0.94267184, 'binary_precision': 0.8141593, 'binary_recall': 0.35249043, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.4919786}
confusion matrix:
      0   1
0  5976  21
1   169  92
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811470.png
early stop counter: 13
val acc:0.985685408115387, best validation acc: 0.9870157241821289, corresponding to test acc:                         0.9646852016448975 / 0.98114413022995
after epoch: 26,now: 2024-05-25 06:20:06.226315,epoch time: 0:38:10.950198,used: 17:39:47.960765,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_18_seed_0_20811470
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99399436, 'precision': 0.94645965, 'recall': 0.9631232, 'specificity': 0.9631232, 'f1': 0.95462656, 'auroc': 0.99880815, 'binary_precision': 0.8953564, 'binary_recall': 0.9300272, 'binary_specificity': 0.9962193, 'binary_f1_score': 0.9123625}
confusion matrix:
       0     1
0  42160   160
1    103  1369
---- Validation: 
scalar performance:
{'acc': 0.98483396, 'precision': 0.8980341, 'recall': 0.86388886, 'specificity': 0.86388886, 'f1': 0.88013244, 'auroc': 0.9811372, 'binary_precision': 0.80546075, 'binary_recall': 0.7340591, 'binary_specificity': 0.9937187, 'binary_f1_score': 0.7681042}
confusion matrix:
       0    1
0  18035  114
1    171  472
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96164906, 'precision': 0.81083274, 'recall': 0.58237356, 'specificity': 0.58237356, 'f1': 0.6243006, 'auroc': 0.93855006, 'binary_precision': 0.6567164, 'binary_recall': 0.16858238, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.2682927}
confusion matrix:
      0   1
0  5974  23
1   217  44
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811470.png
early stop counter: 14
val acc:0.9848339557647705, best validation acc: 0.9870157241821289, corresponding to test acc:                         0.9646852016448975 / 0.98114413022995
after epoch: 27,now: 2024-05-25 06:58:17.617538,epoch time: 0:38:11.391223,used: 18:17:59.351988,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_18_seed_0_20811470
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9961865, 'precision': 0.96933675, 'recall': 0.9721078, 'specificity': 0.9721078, 'f1': 0.9707179, 'auroc': 0.9994012, 'binary_precision': 0.94054055, 'binary_recall': 0.946295, 'binary_specificity': 0.99792063, 'binary_f1_score': 0.943409}
confusion matrix:
       0     1
0  42233    88
1     79  1392
---- Validation: 
scalar performance:
{'acc': 0.9862707, 'precision': 0.90602684, 'recall': 0.88038385, 'specificity': 0.88038385, 'f1': 0.89275247, 'auroc': 0.9833009, 'binary_precision': 0.8202995, 'binary_recall': 0.7667185, 'binary_specificity': 0.99404925, 'binary_f1_score': 0.7926045}
confusion matrix:
       0    1
0  18041  108
1    150  493
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608501, 'precision': 0.7852424, 'recall': 0.58562136, 'specificity': 0.58562136, 'f1': 0.6264402, 'auroc': 0.93939036, 'binary_precision': 0.6052632, 'binary_recall': 0.17624521, 'binary_specificity': 0.9949975, 'binary_f1_score': 0.27299705}
confusion matrix:
      0   1
0  5967  30
1   215  46
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811470.png
early stop counter: 15
val acc:0.9862707257270813, best validation acc: 0.9870157241821289, corresponding to test acc:                         0.9646852016448975 / 0.98114413022995
after epoch: 28,now: 2024-05-25 07:36:29.022594,epoch time: 0:38:11.405056,used: 18:56:10.757044,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_18_seed_0_20811470
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9939715, 'precision': 0.946167, 'recall': 0.9631114, 'specificity': 0.9631114, 'f1': 0.9544687, 'auroc': 0.99900126, 'binary_precision': 0.8947712, 'binary_recall': 0.9300272, 'binary_specificity': 0.9961957, 'binary_f1_score': 0.91205865}
confusion matrix:
       0     1
0  42159   161
1    103  1369
---- Validation: 
scalar performance:
{'acc': 0.98706895, 'precision': 0.91273636, 'recall': 0.8860475, 'specificity': 0.8860475, 'f1': 0.89890933, 'auroc': 0.9816948, 'binary_precision': 0.8333333, 'binary_recall': 0.777605, 'binary_specificity': 0.99449, 'binary_f1_score': 0.8045053}
confusion matrix:
       0    1
0  18049  100
1    143  500
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9707574, 'precision': 0.8616964, 'recall': 0.72271866, 'specificity': 0.72271866, 'f1': 0.77405906, 'auroc': 0.9433032, 'binary_precision': 0.7468355, 'binary_recall': 0.45210728, 'binary_specificity': 0.99333, 'binary_f1_score': 0.56324583}
confusion matrix:
      0    1
0  5957   40
1   143  118
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811470.png
better model found
persisted
after epoch: 29,now: 2024-05-25 08:14:47.872993,epoch time: 0:38:18.850399,used: 19:34:29.607443,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_18_seed_0_20811470
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99671173, 'precision': 0.98012227, 'recall': 0.9687706, 'specificity': 0.9687706, 'f1': 0.97437334, 'auroc': 0.99957573, 'binary_precision': 0.9623693, 'binary_recall': 0.93881714, 'binary_specificity': 0.99872404, 'binary_f1_score': 0.9504473}
confusion matrix:
       0     1
0  42267    54
1     90  1381
---- Validation: 
scalar performance:
{'acc': 0.98621756, 'precision': 0.92736334, 'recall': 0.8518542, 'specificity': 0.8518542, 'f1': 0.88566536, 'auroc': 0.98404837, 'binary_precision': 0.865019, 'binary_recall': 0.7076205, 'binary_specificity': 0.99608797, 'binary_f1_score': 0.7784431}
confusion matrix:
       0    1
0  18078   71
1    188  455
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9603707, 'precision': 0.79527855, 'recall': 0.55971855, 'specificity': 0.55971855, 'f1': 0.59240353, 'auroc': 0.943879, 'binary_precision': 0.627451, 'binary_recall': 0.12260536, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.2051282}
confusion matrix:
      0   1
0  5978  19
1   229  32
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811470.png
early stop counter: 1
val acc:0.9862175583839417, best validation acc: 0.9870689511299133, corresponding to test acc:                         0.9707574248313904 / 0.98114413022995
after epoch: 30,now: 2024-05-25 08:52:58.502517,epoch time: 0:38:10.629524,used: 20:12:40.236967,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_18_seed_0_20811470
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 20:12:40.236967 at 2024-05-25 08:52:58.502517
persisted model performance metric: 

scalar performance:
{'acc': 0.9689997, 'precision': 0.8457755, 'recall': 0.7089752, 'specificity': 0.7089752, 'f1': 0.7588104, 'auroc': 0.9380181, 'binary_precision': 0.716129, 'binary_recall': 0.42528737, 'binary_specificity': 0.992663, 'binary_f1_score': 0.5336539}
confusion matrix:
      0    1
0  5953   44
1   150  111
oracle model performance metric: 

scalar performance:
{'acc': 0.97762865, 'precision': 0.90132, 'recall': 0.79410017, 'specificity': 0.79410017, 'f1': 0.838643, 'auroc': 0.9613745, 'binary_precision': 0.8201058, 'binary_recall': 0.59386975, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.6888889}
confusion matrix:
      0    1
0  5963   34
1   106  155
results aggregation path: zoutput/benchmarks/CAMELYON_center0_vit_irm/rule_results/2.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_vit_irm/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_vit_irm/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1661 MiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |   1655 MiB |  15779 MiB |    977 TiB |    977 TiB |
|       from small pool |      6 MiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1661 MiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |   1655 MiB |  15779 MiB |    977 TiB |    977 TiB |
|       from small pool |      6 MiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1653 MiB |  15770 MiB |    987 TiB |    987 TiB |
|       from large pool |   1647 MiB |  15745 MiB |    974 TiB |    974 TiB |
|       from small pool |      5 MiB |     25 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  16730 MiB |  16730 MiB |  16730 MiB |      0 B   |
|       from large pool |  16702 MiB |  16702 MiB |  16702 MiB |      0 B   |
|       from small pool |     28 MiB |     28 MiB |     28 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 430238 KiB |    863 MiB | 413548 GiB | 413547 GiB |
|       from large pool | 410304 KiB |    862 MiB | 400660 GiB | 400660 GiB |
|       from small pool |  19934 KiB |     21 MiB |  12887 GiB |  12887 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3366    |    6357    |  152169 K  |  152166 K  |
|       from large pool |     247    |     989    |   62327 K  |   62326 K  |
|       from small pool |    3119    |    6108    |   89842 K  |   89839 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3366    |    6357    |  152169 K  |  152166 K  |
|       from large pool |     247    |     989    |   62327 K  |   62326 K  |
|       from small pool |    3119    |    6108    |   89842 K  |   89839 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     621    |     621    |     621    |       0    |
|       from large pool |     607    |     607    |     607    |       0    |
|       from small pool |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     144    |    2873    |   90170 K  |   90170 K  |
|       from large pool |     112    |     516    |   47275 K  |   47275 K  |
|       from small pool |      32    |    2761    |   42895 K  |   42895 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |  16640 KiB |  15779 MiB |    977 TiB |    977 TiB |
|       from small pool |      0 KiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |  16640 KiB |  15779 MiB |    977 TiB |    977 TiB |
|       from small pool |      0 KiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15770 MiB |    987 TiB |    987 TiB |
|       from large pool |  16640 KiB |  15745 MiB |    974 TiB |    974 TiB |
|       from small pool |      0 KiB |     25 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2082 MiB |  16730 MiB |  16730 MiB |  14648 MiB |
|       from large pool |   2056 MiB |  16702 MiB |  16702 MiB |  14646 MiB |
|       from small pool |     26 MiB |     28 MiB |     28 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    863 MiB | 413549 GiB | 413549 GiB |
|       from large pool |  24320 KiB |    862 MiB | 400661 GiB | 400661 GiB |
|       from small pool |      0 KiB |     24 MiB |  12887 GiB |  12887 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6357    |  152169 K  |  152169 K  |
|       from large pool |       2    |     989    |   62327 K  |   62327 K  |
|       from small pool |       0    |    6108    |   89842 K  |   89842 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6357    |  152169 K  |  152169 K  |
|       from large pool |       2    |     989    |   62327 K  |   62327 K  |
|       from small pool |       0    |    6108    |   89842 K  |   89842 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     115    |     621    |     621    |     506    |
|       from large pool |     102    |     607    |     607    |     505    |
|       from small pool |      13    |      14    |      14    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    2873    |   90172 K  |   90172 K  |
|       from large pool |       2    |     516    |   47275 K  |   47275 K  |
|       from small pool |       0    |    2761    |   42896 K  |   42896 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat May 25 08:55:56 2024]
Finished job 0.
1 of 1 steps (100%) done
