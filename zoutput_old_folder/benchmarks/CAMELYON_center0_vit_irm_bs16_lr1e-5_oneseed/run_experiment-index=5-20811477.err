Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Fri May 24 12:36:19 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_vit_irm/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_vit_irm/rule_results/5.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=5
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_44_38_seed_0_20811477

 Experiment start at: 2024-05-24 12:44:38.483705
before training, model accuracy: 0.955097496509552
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.97330564, 'precision': 0.8204013, 'recall': 0.7073121, 'specificity': 0.7073121, 'f1': 0.750707, 'auroc': 0.9671744, 'binary_precision': 0.6606383, 'binary_recall': 0.4221618, 'binary_specificity': 0.9924624, 'binary_f1_score': 0.515139}
confusion matrix:
       0    1
0  42002  319
1    850  621
---- Validation: 
scalar performance:
{'acc': 0.9716369, 'precision': 0.8088443, 'recall': 0.69279444, 'specificity': 0.69279444, 'f1': 0.736211, 'auroc': 0.96840054, 'binary_precision': 0.6388889, 'binary_recall': 0.3934681, 'binary_specificity': 0.9921208, 'binary_f1_score': 0.48700675}
confusion matrix:
       0    1
0  18006  143
1    390  253
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96260786, 'precision': 0.83970946, 'recall': 0.5847061, 'specificity': 0.5847061, 'f1': 0.6292924, 'auroc': 0.9391613, 'binary_precision': 0.71428573, 'binary_recall': 0.1724138, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.2777778}
confusion matrix:
      0   1
0  5979  18
1   216  45
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811477.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-24 13:26:33.763209,epoch time: 0:41:55.279504,used: 0:41:55.279504,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_44_38_seed_0_20811477
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97481275, 'precision': 0.8051964, 'recall': 0.80979985, 'specificity': 0.80979985, 'f1': 0.80747914, 'auroc': 0.9754868, 'binary_precision': 0.6231593, 'binary_recall': 0.6329028, 'binary_specificity': 0.9866969, 'binary_f1_score': 0.6279933}
confusion matrix:
       0    1
0  41758  563
1    540  931
---- Validation: 
scalar performance:
{'acc': 0.97482973, 'precision': 0.82081413, 'recall': 0.77095306, 'specificity': 0.77095306, 'f1': 0.79358745, 'auroc': 0.9742462, 'binary_precision': 0.6574074, 'binary_recall': 0.5520995, 'binary_specificity': 0.9898066, 'binary_f1_score': 0.600169}
confusion matrix:
       0    1
0  17964  185
1    288  355
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9787472, 'precision': 0.9152696, 'recall': 0.79651606, 'specificity': 0.79651606, 'f1': 0.8450527, 'auroc': 0.95468295, 'binary_precision': 0.84782606, 'binary_recall': 0.59770113, 'binary_specificity': 0.995331, 'binary_f1_score': 0.70112354}
confusion matrix:
      0    1
0  5969   28
1   105  156
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811477.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-05-24 14:07:52.167586,epoch time: 0:41:18.404377,used: 1:23:13.683881,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_44_38_seed_0_20811477
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.98001915, 'precision': 0.9374148, 'recall': 0.7293419, 'specificity': 0.7293419, 'f1': 0.7987738, 'auroc': 0.9841916, 'binary_precision': 0.8932806, 'binary_recall': 0.4605978, 'binary_specificity': 0.99808604, 'binary_f1_score': 0.6077992}
confusion matrix:
       0    1
0  42239   81
1    794  678
---- Validation: 
scalar performance:
{'acc': 0.9773308, 'precision': 0.9438679, 'recall': 0.6867416, 'specificity': 0.6867416, 'f1': 0.7596109, 'auroc': 0.9810288, 'binary_precision': 0.90943396, 'binary_recall': 0.3748056, 'binary_specificity': 0.9986776, 'binary_f1_score': 0.530837}
confusion matrix:
       0    1
0  18125   24
1    402  241
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96228826, 'precision': 0.932904, 'recall': 0.5533897, 'specificity': 0.5533897, 'f1': 0.58623725, 'auroc': 0.9517807, 'binary_precision': 0.9032258, 'binary_recall': 0.107279696, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.19178084}
confusion matrix:
      0   1
0  5994   3
1   233  28
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811477.png
better model found
persisted
after epoch: 3,now: 2024-05-24 14:49:22.538652,epoch time: 0:41:30.371066,used: 2:04:44.054947,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_44_38_seed_0_20811477
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98129797, 'precision': 0.83992666, 'recall': 0.90212965, 'specificity': 0.90212965, 'f1': 0.86816895, 'auroc': 0.98618984, 'binary_precision': 0.6862521, 'binary_recall': 0.81725544, 'binary_specificity': 0.9870038, 'binary_f1_score': 0.7460465}
confusion matrix:
       0     1
0  41770   550
1    269  1203
---- Validation: 
scalar performance:
{'acc': 0.9828118, 'precision': 0.86061, 'recall': 0.8913441, 'specificity': 0.8913441, 'f1': 0.8752906, 'auroc': 0.9816019, 'binary_precision': 0.7285714, 'binary_recall': 0.7931571, 'binary_specificity': 0.9895311, 'binary_f1_score': 0.7594937}
confusion matrix:
       0    1
0  17959  190
1    133  510
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645254, 'precision': 0.8310238, 'recall': 0.63151497, 'specificity': 0.63151497, 'f1': 0.68423736, 'auroc': 0.9599013, 'binary_precision': 0.6930693, 'binary_recall': 0.26819924, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.3867403}
confusion matrix:
      0   1
0  5966  31
1   191  70
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811477.png
better model found
persisted
after epoch: 4,now: 2024-05-24 15:31:25.215953,epoch time: 0:42:02.677301,used: 2:46:46.732248,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_44_38_seed_0_20811477
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98193735, 'precision': 0.8679894, 'recall': 0.84596694, 'specificity': 0.84596694, 'f1': 0.8566091, 'auroc': 0.9873985, 'binary_precision': 0.7463768, 'binary_recall': 0.70020396, 'binary_specificity': 0.99172986, 'binary_f1_score': 0.72255343}
confusion matrix:
       0     1
0  41971   350
1    441  1030
---- Validation: 
scalar performance:
{'acc': 0.98174757, 'precision': 0.8724936, 'recall': 0.8405394, 'specificity': 0.8405394, 'f1': 0.8557383, 'auroc': 0.97953486, 'binary_precision': 0.7559727, 'binary_recall': 0.688958, 'binary_specificity': 0.9921208, 'binary_f1_score': 0.7209113}
confusion matrix:
       0    1
0  18006  143
1    200  443
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.78124356, 'recall': 0.60411143, 'specificity': 0.60411143, 'f1': 0.64775556, 'auroc': 0.95707226, 'binary_precision': 0.59574467, 'binary_recall': 0.21455939, 'binary_specificity': 0.9936635, 'binary_f1_score': 0.31549296}
confusion matrix:
      0   1
0  5959  38
1   205  56
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811477.png
early stop counter: 1
val acc:0.981747567653656, best validation acc: 0.9828118085861206, corresponding to test acc:                         0.9645254015922546 / 0.9787471890449524
after epoch: 5,now: 2024-05-24 16:12:53.444618,epoch time: 0:41:28.228665,used: 3:28:14.960913,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_44_38_seed_0_20811477
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98344445, 'precision': 0.85755193, 'recall': 0.90815806, 'specificity': 0.90815806, 'f1': 0.8810272, 'auroc': 0.98758876, 'binary_precision': 0.72113675, 'binary_recall': 0.8274456, 'binary_specificity': 0.9888705, 'binary_f1_score': 0.7706422}
confusion matrix:
       0     1
0  41849   471
1    254  1218
---- Validation: 
scalar performance:
{'acc': 0.9825458, 'precision': 0.85716456, 'recall': 0.8934565, 'specificity': 0.8934565, 'f1': 0.8743508, 'auroc': 0.98160136, 'binary_precision': 0.721519, 'binary_recall': 0.7978227, 'binary_specificity': 0.9890903, 'binary_f1_score': 0.7577548}
confusion matrix:
       0    1
0  17951  198
1    130  513
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650048, 'precision': 0.80482996, 'recall': 0.6830704, 'specificity': 0.6830704, 'f1': 0.7270957, 'auroc': 0.9544178, 'binary_precision': 0.6363636, 'binary_recall': 0.37547892, 'binary_specificity': 0.990662, 'binary_f1_score': 0.47228917}
confusion matrix:
      0   1
0  5941  56
1   163  98
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811477.png
early stop counter: 2
val acc:0.982545793056488, best validation acc: 0.9828118085861206, corresponding to test acc:                         0.9645254015922546 / 0.9787471890449524
after epoch: 6,now: 2024-05-24 16:55:07.079382,epoch time: 0:42:13.634764,used: 4:10:28.595677,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_44_38_seed_0_20811477
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9858878, 'precision': 0.9588082, 'recall': 0.81270385, 'specificity': 0.81270385, 'f1': 0.870964, 'auroc': 0.99168473, 'binary_precision': 0.9304435, 'binary_recall': 0.62703806, 'binary_specificity': 0.9983696, 'binary_f1_score': 0.74918836}
confusion matrix:
       0    1
0  42251   69
1    549  923
---- Validation: 
scalar performance:
{'acc': 0.9828118, 'precision': 0.9616133, 'recall': 0.76533484, 'specificity': 0.76533484, 'f1': 0.8352073, 'auroc': 0.97932065, 'binary_precision': 0.9395604, 'binary_recall': 0.5318818, 'binary_specificity': 0.9987878, 'binary_f1_score': 0.6792453}
confusion matrix:
       0    1
0  18127   22
1    301  342
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.876506, 'recall': 0.57762694, 'specificity': 0.57762694, 'f1': 0.6215255, 'auroc': 0.9584931, 'binary_precision': 0.78846157, 'binary_recall': 0.15708812, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.26198083}
confusion matrix:
      0   1
0  5986  11
1   220  41
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811477.png
early stop counter: 3
val acc:0.9828118085861206, best validation acc: 0.9828118085861206, corresponding to test acc:                         0.9645254015922546 / 0.9787471890449524
after epoch: 7,now: 2024-05-24 17:37:07.525198,epoch time: 0:42:00.445816,used: 4:52:29.041493,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_44_38_seed_0_20811477
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9833075, 'precision': 0.8468698, 'recall': 0.9368624, 'specificity': 0.9368624, 'f1': 0.88619757, 'auroc': 0.9922712, 'binary_precision': 0.6976993, 'binary_recall': 0.8870748, 'binary_specificity': 0.98665, 'binary_f1_score': 0.7810722}
confusion matrix:
       0     1
0  41757   565
1    166  1304
---- Validation: 
scalar performance:
{'acc': 0.9800447, 'precision': 0.83000153, 'recall': 0.91091305, 'specificity': 0.91091305, 'f1': 0.8655896, 'auroc': 0.9806666, 'binary_precision': 0.6658416, 'binary_recall': 0.83670294, 'binary_specificity': 0.98512316, 'binary_f1_score': 0.74155754}
confusion matrix:
       0    1
0  17879  270
1    105  538
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96628314, 'precision': 0.8081359, 'recall': 0.71305484, 'specificity': 0.71305484, 'f1': 0.7509455, 'auroc': 0.9567774, 'binary_precision': 0.64044946, 'binary_recall': 0.43678162, 'binary_specificity': 0.989328, 'binary_f1_score': 0.5193622}
confusion matrix:
      0    1
0  5933   64
1   147  114
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811477.png
early stop counter: 4
val acc:0.9800447225570679, best validation acc: 0.9828118085861206, corresponding to test acc:                         0.9645254015922546 / 0.9787471890449524
after epoch: 8,now: 2024-05-24 18:20:59.674893,epoch time: 0:43:52.149695,used: 5:36:21.191188,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_44_38_seed_0_20811477
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9884682, 'precision': 0.9383861, 'recall': 0.8756764, 'specificity': 0.8756764, 'f1': 0.9044318, 'auroc': 0.9918184, 'binary_precision': 0.885259, 'binary_recall': 0.75475544, 'binary_specificity': 0.99659735, 'binary_f1_score': 0.8148148}
confusion matrix:
       0     1
0  42176   144
1    361  1111
---- Validation: 
scalar performance:
{'acc': 0.9831311, 'precision': 0.9105615, 'recall': 0.8142537, 'specificity': 0.8142537, 'f1': 0.8555104, 'auroc': 0.97322416, 'binary_precision': 0.8340164, 'binary_recall': 0.63297045, 'binary_specificity': 0.9955369, 'binary_f1_score': 0.719717}
confusion matrix:
       0    1
0  18068   81
1    236  407
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9637264, 'precision': 0.8146653, 'recall': 0.6310981, 'specificity': 0.6310981, 'f1': 0.6813934, 'auroc': 0.93055403, 'binary_precision': 0.6603774, 'binary_recall': 0.26819924, 'binary_specificity': 0.993997, 'binary_f1_score': 0.38147143}
confusion matrix:
      0   1
0  5961  36
1   191  70
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811477.png
better model found
persisted
after epoch: 9,now: 2024-05-24 19:04:01.876418,epoch time: 0:43:02.201525,used: 6:19:23.392713,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_44_38_seed_0_20811477
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98924464, 'precision': 0.91635144, 'recall': 0.91826487, 'specificity': 0.91826487, 'f1': 0.9173057, 'auroc': 0.9952948, 'binary_precision': 0.8381855, 'binary_recall': 0.84217685, 'binary_specificity': 0.9943528, 'binary_f1_score': 0.84017646}
confusion matrix:
       0     1
0  42083   239
1    232  1238
---- Validation: 
scalar performance:
{'acc': 0.9852597, 'precision': 0.899072, 'recall': 0.87085974, 'specificity': 0.87085974, 'f1': 0.8844056, 'auroc': 0.98214805, 'binary_precision': 0.807047, 'binary_recall': 0.748056, 'binary_specificity': 0.99366355, 'binary_f1_score': 0.77643263}
confusion matrix:
       0    1
0  18034  115
1    162  481
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9600511, 'precision': 0.80944884, 'recall': 0.5430608, 'specificity': 0.5430608, 'f1': 0.5674736, 'auroc': 0.9376714, 'binary_precision': 0.6571429, 'binary_recall': 0.08812261, 'binary_specificity': 0.997999, 'binary_f1_score': 0.1554054}
confusion matrix:
      0   1
0  5985  12
1   238  23
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811477.png
better model found
persisted
after epoch: 10,now: 2024-05-24 19:53:00.353760,epoch time: 0:48:58.477342,used: 7:08:21.870055,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_44_38_seed_0_20811477
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9910029, 'precision': 0.9205267, 'recall': 0.9458383, 'specificity': 0.9458383, 'f1': 0.93278193, 'auroc': 0.9964411, 'binary_precision': 0.84462917, 'binary_recall': 0.8974185, 'binary_specificity': 0.99425805, 'binary_f1_score': 0.870224}
confusion matrix:
       0     1
0  42077   243
1    151  1321
---- Validation: 
scalar performance:
{'acc': 0.9864304, 'precision': 0.9035888, 'recall': 0.88721704, 'specificity': 0.88721704, 'f1': 0.8952192, 'auroc': 0.98186064, 'binary_precision': 0.8149351, 'binary_recall': 0.7807154, 'binary_specificity': 0.9937187, 'binary_f1_score': 0.79745835}
confusion matrix:
       0    1
0  18035  114
1    141  502
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9689997, 'precision': 0.8726499, 'recall': 0.6796578, 'specificity': 0.6796578, 'f1': 0.73940045, 'auroc': 0.95486665, 'binary_precision': 0.7723577, 'binary_recall': 0.36398467, 'binary_specificity': 0.995331, 'binary_f1_score': 0.4947917}
confusion matrix:
      0   1
0  5969  28
1   166  95
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811477.png
better model found
persisted
after epoch: 11,now: 2024-05-24 20:44:18.310841,epoch time: 0:51:17.957081,used: 7:59:39.827136,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_44_38_seed_0_20811477
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9855453, 'precision': 0.98093736, 'recall': 0.79173017, 'specificity': 0.79173017, 'f1': 0.8616631, 'auroc': 0.9954023, 'binary_precision': 0.9761364, 'binary_recall': 0.5839565, 'binary_specificity': 0.9995038, 'binary_f1_score': 0.7307528}
confusion matrix:
       0    1
0  42300   21
1    612  859
---- Validation: 
scalar performance:
{'acc': 0.9804172, 'precision': 0.9548355, 'recall': 0.73109263, 'specificity': 0.73109263, 'f1': 0.8041041, 'auroc': 0.97738564, 'binary_precision': 0.9283489, 'binary_recall': 0.46345258, 'binary_specificity': 0.9987327, 'binary_f1_score': 0.6182573}
confusion matrix:
       0    1
0  18126   23
1    345  298
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.8716722, 'recall': 0.5473091, 'specificity': 0.5473091, 'f1': 0.5753839, 'auroc': 0.9525778, 'binary_precision': 0.78125, 'binary_recall': 0.09578544, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.17064846}
confusion matrix:
      0   1
0  5990   7
1   236  25
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811477.png
early stop counter: 1
val acc:0.9804171919822693, best validation acc: 0.9864304065704346, corresponding to test acc:                         0.9689996838569641 / 0.9787471890449524
after epoch: 12,now: 2024-05-24 21:33:05.885903,epoch time: 0:48:47.575062,used: 8:48:27.402198,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_44_38_seed_0_20811477
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9904092, 'precision': 0.91911775, 'recall': 0.9366789, 'specificity': 0.9366789, 'f1': 0.92770314, 'auroc': 0.99672824, 'binary_precision': 0.84244794, 'binary_recall': 0.87907606, 'binary_specificity': 0.99428165, 'binary_f1_score': 0.8603723}
confusion matrix:
       0     1
0  42078   242
1    178  1294
---- Validation: 
scalar performance:
{'acc': 0.9861111, 'precision': 0.9112971, 'recall': 0.86980045, 'specificity': 0.86980045, 'f1': 0.8893564, 'auroc': 0.97807586, 'binary_precision': 0.8315972, 'binary_recall': 0.7449456, 'binary_specificity': 0.9946554, 'binary_f1_score': 0.78589004}
confusion matrix:
       0    1
0  18052   97
1    164  479
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96244806, 'precision': 0.8673812, 'recall': 0.5699641, 'specificity': 0.5699641, 'f1': 0.61011547, 'auroc': 0.9516063, 'binary_precision': 0.7708333, 'binary_recall': 0.14176245, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.23948221}
confusion matrix:
      0   1
0  5986  11
1   224  37
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811477.png
early stop counter: 2
val acc:0.9861111044883728, best validation acc: 0.9864304065704346, corresponding to test acc:                         0.9689996838569641 / 0.9787471890449524
after epoch: 13,now: 2024-05-24 22:16:59.652313,epoch time: 0:43:53.766410,used: 9:32:21.168608,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_44_38_seed_0_20811477
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9921447, 'precision': 0.9446611, 'recall': 0.93298674, 'specificity': 0.93298674, 'f1': 0.93874013, 'auroc': 0.9967613, 'binary_precision': 0.89385474, 'binary_recall': 0.8695652, 'binary_specificity': 0.99640834, 'binary_f1_score': 0.8815427}
confusion matrix:
       0     1
0  42168   152
1    192  1280
---- Validation: 
scalar performance:
{'acc': 0.98659, 'precision': 0.92330945, 'recall': 0.86329794, 'specificity': 0.86329794, 'f1': 0.890833, 'auroc': 0.9827275, 'binary_precision': 0.856102, 'binary_recall': 0.7309487, 'binary_specificity': 0.99564713, 'binary_f1_score': 0.7885906}
confusion matrix:
       0    1
0  18070   79
1    173  470
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642058, 'precision': 0.84262395, 'recall': 0.61485726, 'specificity': 0.61485726, 'f1': 0.6670976, 'auroc': 0.9625605, 'binary_precision': 0.7176471, 'binary_recall': 0.23371647, 'binary_specificity': 0.995998, 'binary_f1_score': 0.35260117}
confusion matrix:
      0   1
0  5973  24
1   200  61
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811477.png
better model found
persisted
after epoch: 14,now: 2024-05-24 23:01:59.709995,epoch time: 0:45:00.057682,used: 10:17:21.226290,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_44_38_seed_0_20811477
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9891989, 'precision': 0.89156914, 'recall': 0.96225893, 'specificity': 0.96225893, 'f1': 0.9237267, 'auroc': 0.99746203, 'binary_precision': 0.7854691, 'binary_recall': 0.93337864, 'binary_specificity': 0.9911392, 'binary_f1_score': 0.85305995}
confusion matrix:
       0     1
0  41946   375
1     98  1373
---- Validation: 
scalar performance:
{'acc': 0.98366326, 'precision': 0.8617364, 'recall': 0.9097862, 'specificity': 0.9097862, 'f1': 0.8841244, 'auroc': 0.98094434, 'binary_precision': 0.7295082, 'binary_recall': 0.8304821, 'binary_specificity': 0.9890903, 'binary_f1_score': 0.77672726}
confusion matrix:
       0    1
0  17951  198
1    109  534
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9653244, 'precision': 0.82041824, 'recall': 0.6630815, 'specificity': 0.6630815, 'f1': 0.71355796, 'auroc': 0.94557047, 'binary_precision': 0.66923076, 'binary_recall': 0.33333334, 'binary_specificity': 0.99282974, 'binary_f1_score': 0.4450128}
confusion matrix:
      0   1
0  5954  43
1   174  87
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811477.png
early stop counter: 1
val acc:0.9836632609367371, best validation acc: 0.9865900278091431, corresponding to test acc:                         0.964205801486969 / 0.9787471890449524
after epoch: 15,now: 2024-05-24 23:45:53.270558,epoch time: 0:43:53.560563,used: 11:01:14.786853,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_44_38_seed_0_20811477
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9895871, 'precision': 0.9781214, 'recall': 0.8572395, 'specificity': 0.8572395, 'f1': 0.9083253, 'auroc': 0.99722946, 'binary_precision': 0.96605504, 'binary_recall': 0.71535325, 'binary_specificity': 0.9991257, 'binary_f1_score': 0.82201403}
confusion matrix:
       0     1
0  42283    37
1    419  1053
---- Validation: 
scalar performance:
{'acc': 0.9826522, 'precision': 0.95327014, 'recall': 0.7682524, 'specificity': 0.7682524, 'f1': 0.8354244, 'auroc': 0.9820803, 'binary_precision': 0.92266667, 'binary_recall': 0.5381026, 'binary_specificity': 0.9984021, 'binary_f1_score': 0.6797642}
confusion matrix:
       0    1
0  18120   29
1    297  346
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9610099, 'precision': 0.8460576, 'recall': 0.5508904, 'specificity': 0.5508904, 'f1': 0.58061874, 'auroc': 0.94183475, 'binary_precision': 0.7297297, 'binary_recall': 0.10344828, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.18120806}
confusion matrix:
      0   1
0  5987  10
1   234  27
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811477.png
early stop counter: 2
val acc:0.9826521873474121, best validation acc: 0.9865900278091431, corresponding to test acc:                         0.964205801486969 / 0.9787471890449524
after epoch: 16,now: 2024-05-25 00:29:32.484337,epoch time: 0:43:39.213779,used: 11:44:54.000632,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_44_38_seed_0_20811477
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99369746, 'precision': 0.9580601, 'recall': 0.9436259, 'specificity': 0.9436259, 'f1': 0.9507185, 'auroc': 0.9984136, 'binary_precision': 0.9199438, 'binary_recall': 0.8899456, 'binary_specificity': 0.9973062, 'binary_f1_score': 0.9046961}
confusion matrix:
       0     1
0  42206   114
1    162  1310
---- Validation: 
scalar performance:
{'acc': 0.9861111, 'precision': 0.91939175, 'recall': 0.85929966, 'specificity': 0.85929966, 'f1': 0.88684237, 'auroc': 0.98102295, 'binary_precision': 0.8485401, 'binary_recall': 0.7231726, 'binary_specificity': 0.9954268, 'binary_f1_score': 0.7808564}
confusion matrix:
       0    1
0  18066   83
1    178  465
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96212846, 'precision': 0.81611705, 'recall': 0.58995306, 'specificity': 0.58995306, 'f1': 0.6344175, 'auroc': 0.94615567, 'binary_precision': 0.6666667, 'binary_recall': 0.18390805, 'binary_specificity': 0.995998, 'binary_f1_score': 0.2882883}
confusion matrix:
      0   1
0  5973  24
1   213  48
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811477.png
early stop counter: 3
val acc:0.9861111044883728, best validation acc: 0.9865900278091431, corresponding to test acc:                         0.964205801486969 / 0.9787471890449524
after epoch: 17,now: 2024-05-25 01:13:08.804586,epoch time: 0:43:36.320249,used: 12:28:30.320881,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_44_38_seed_0_20811477
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99011236, 'precision': 0.90855694, 'recall': 0.94832826, 'specificity': 0.94832826, 'f1': 0.9274408, 'auroc': 0.99735403, 'binary_precision': 0.8204812, 'binary_recall': 0.9035326, 'binary_specificity': 0.9931238, 'binary_f1_score': 0.86000645}
confusion matrix:
       0     1
0  42029   291
1    142  1330
---- Validation: 
scalar performance:
{'acc': 0.9831311, 'precision': 0.86969674, 'recall': 0.87800837, 'specificity': 0.87800837, 'f1': 0.8738022, 'auroc': 0.98191774, 'binary_precision': 0.74772036, 'binary_recall': 0.7651633, 'binary_specificity': 0.9908535, 'binary_f1_score': 0.7563413}
confusion matrix:
       0    1
0  17983  166
1    151  492
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9638862, 'precision': 0.816331, 'recall': 0.63301384, 'specificity': 0.63301384, 'f1': 0.68363285, 'auroc': 0.9457919, 'binary_precision': 0.6635514, 'binary_recall': 0.27203065, 'binary_specificity': 0.993997, 'binary_f1_score': 0.38586956}
confusion matrix:
      0   1
0  5961  36
1   190  71
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811477.png
early stop counter: 4
val acc:0.9831311106681824, best validation acc: 0.9865900278091431, corresponding to test acc:                         0.964205801486969 / 0.9787471890449524
after epoch: 18,now: 2024-05-25 01:53:39.847932,epoch time: 0:40:31.043346,used: 13:09:01.364227,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_44_38_seed_0_20811477
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9942912, 'precision': 0.984994, 'recall': 0.925573, 'specificity': 0.925573, 'f1': 0.95320374, 'auroc': 0.9988016, 'binary_precision': 0.97511667, 'binary_recall': 0.8519022, 'binary_specificity': 0.99924386, 'binary_f1_score': 0.9093546}
confusion matrix:
       0     1
0  42288    32
1    218  1254
---- Validation: 
scalar performance:
{'acc': 0.98659, 'precision': 0.95523083, 'recall': 0.8310455, 'specificity': 0.8310455, 'f1': 0.88262177, 'auroc': 0.9826391, 'binary_precision': 0.9222462, 'binary_recall': 0.66407466, 'binary_specificity': 0.9980164, 'binary_f1_score': 0.7721519}
confusion matrix:
       0    1
0  18113   36
1    216  427
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96356666, 'precision': 0.84930694, 'recall': 0.5980327, 'specificity': 0.5980327, 'f1': 0.64726996, 'auroc': 0.94248545, 'binary_precision': 0.73239434, 'binary_recall': 0.19923371, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.313253}
confusion matrix:
      0   1
0  5978  19
1   209  52
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811477.png
early stop counter: 5
val acc:0.9865900278091431, best validation acc: 0.9865900278091431, corresponding to test acc:                         0.964205801486969 / 0.9787471890449524
after epoch: 19,now: 2024-05-25 02:33:50.501431,epoch time: 0:40:10.653499,used: 13:49:12.017726,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_44_38_seed_0_20811477
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99342346, 'precision': 0.9564446, 'recall': 0.9408613, 'specificity': 0.9408613, 'f1': 0.9485072, 'auroc': 0.9980416, 'binary_precision': 0.9169014, 'binary_recall': 0.8845109, 'binary_specificity': 0.9972117, 'binary_f1_score': 0.90041494}
confusion matrix:
       0     1
0  42202   118
1    170  1302
---- Validation: 
scalar performance:
{'acc': 0.9855257, 'precision': 0.9316351, 'recall': 0.83499485, 'specificity': 0.83499485, 'f1': 0.87676054, 'auroc': 0.980689, 'binary_precision': 0.87474746, 'binary_recall': 0.6734059, 'binary_specificity': 0.9965838, 'binary_f1_score': 0.7609841}
confusion matrix:
       0    1
0  18087   62
1    210  433
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9603707, 'precision': 0.8035517, 'recall': 0.5542216, 'specificity': 0.5542216, 'f1': 0.5846156, 'auroc': 0.9459129, 'binary_precision': 0.64444447, 'binary_recall': 0.11111111, 'binary_specificity': 0.997332, 'binary_f1_score': 0.1895425}
confusion matrix:
      0   1
0  5981  16
1   232  29
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811477.png
early stop counter: 6
val acc:0.9855257272720337, best validation acc: 0.9865900278091431, corresponding to test acc:                         0.964205801486969 / 0.9787471890449524
after epoch: 20,now: 2024-05-25 03:13:23.199596,epoch time: 0:39:32.698165,used: 14:28:44.715891,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_44_38_seed_0_20811477
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9942227, 'precision': 0.9665129, 'recall': 0.9429141, 'specificity': 0.9429141, 'f1': 0.9543841, 'auroc': 0.99845016, 'binary_precision': 0.93691754, 'binary_recall': 0.8879076, 'binary_specificity': 0.99792063, 'binary_f1_score': 0.9117545}
confusion matrix:
       0     1
0  42232    88
1    165  1307
---- Validation: 
scalar performance:
{'acc': 0.98659, 'precision': 0.927127, 'recall': 0.85879755, 'specificity': 0.85879755, 'f1': 0.8897592, 'auroc': 0.9800557, 'binary_precision': 0.86405957, 'binary_recall': 0.7216174, 'binary_specificity': 0.99597776, 'binary_f1_score': 0.78644073}
confusion matrix:
       0    1
0  18076   73
1    179  464
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96164906, 'precision': 0.8242049, 'recall': 0.5732119, 'specificity': 0.5732119, 'f1': 0.6128038, 'auroc': 0.9475667, 'binary_precision': 0.68421054, 'binary_recall': 0.14942528, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.24528302}
confusion matrix:
      0   1
0  5979  18
1   222  39
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811477.png
early stop counter: 7
val acc:0.9865900278091431, best validation acc: 0.9865900278091431, corresponding to test acc:                         0.964205801486969 / 0.9787471890449524
after epoch: 21,now: 2024-05-25 03:52:51.156072,epoch time: 0:39:27.956476,used: 15:08:12.672367,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_44_38_seed_0_20811477
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99388015, 'precision': 0.9452447, 'recall': 0.96273625, 'specificity': 0.96273625, 'f1': 0.95380855, 'auroc': 0.9988283, 'binary_precision': 0.8929504, 'binary_recall': 0.9293478, 'binary_specificity': 0.99612474, 'binary_f1_score': 0.9107856}
confusion matrix:
       0     1
0  42156   164
1    104  1368
---- Validation: 
scalar performance:
{'acc': 0.9850468, 'precision': 0.89090395, 'recall': 0.87975025, 'specificity': 0.87975025, 'f1': 0.8852395, 'auroc': 0.97965217, 'binary_precision': 0.7900641, 'binary_recall': 0.7667185, 'binary_specificity': 0.992782, 'binary_f1_score': 0.77821624}
confusion matrix:
       0    1
0  18018  131
1    150  493
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.965644, 'precision': 0.87103176, 'recall': 0.62293696, 'specificity': 0.62293696, 'f1': 0.6795733, 'auroc': 0.9541211, 'binary_precision': 0.77380955, 'binary_recall': 0.24904214, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.3768116}
confusion matrix:
      0   1
0  5978  19
1   196  65
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811477.png
early stop counter: 8
val acc:0.9850468039512634, best validation acc: 0.9865900278091431, corresponding to test acc:                         0.964205801486969 / 0.9787471890449524
after epoch: 22,now: 2024-05-25 04:32:18.742566,epoch time: 0:39:27.586494,used: 15:47:40.258861,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_44_38_seed_0_20811477
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9927841, 'precision': 0.9237337, 'recall': 0.97462785, 'specificity': 0.97462785, 'f1': 0.9476177, 'auroc': 0.9986774, 'binary_precision': 0.84903383, 'binary_recall': 0.95516306, 'binary_specificity': 0.99409264, 'binary_f1_score': 0.89897704}
confusion matrix:
       0     1
0  42070   250
1     66  1406
---- Validation: 
scalar performance:
{'acc': 0.9838229, 'precision': 0.86718255, 'recall': 0.9001181, 'specificity': 0.9001181, 'f1': 0.8828783, 'auroc': 0.9756111, 'binary_precision': 0.74110955, 'binary_recall': 0.8102644, 'binary_specificity': 0.9899719, 'binary_f1_score': 0.7741456}
confusion matrix:
       0    1
0  17967  182
1    122  521
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.7529878, 'recall': 0.67873687, 'specificity': 0.67873687, 'f1': 0.70864934, 'auroc': 0.9338335, 'binary_precision': 0.53296703, 'binary_recall': 0.3716475, 'binary_specificity': 0.98582625, 'binary_f1_score': 0.43792325}
confusion matrix:
      0   1
0  5912  85
1   164  97
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811477.png
early stop counter: 9
val acc:0.9838228821754456, best validation acc: 0.9865900278091431, corresponding to test acc:                         0.964205801486969 / 0.9787471890449524
after epoch: 23,now: 2024-05-25 05:11:45.044923,epoch time: 0:39:26.302357,used: 16:27:06.561218,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_44_38_seed_0_20811477
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9947022, 'precision': 0.96167815, 'recall': 0.95621884, 'specificity': 0.95621884, 'f1': 0.95893097, 'auroc': 0.9985914, 'binary_precision': 0.9263085, 'binary_recall': 0.914966, 'binary_specificity': 0.99747175, 'binary_f1_score': 0.9206023}
confusion matrix:
       0     1
0  42215   107
1    125  1345
---- Validation: 
scalar performance:
{'acc': 0.9868029, 'precision': 0.9270927, 'recall': 0.862658, 'specificity': 0.862658, 'f1': 0.8920401, 'auroc': 0.97621214, 'binary_precision': 0.86372006, 'binary_recall': 0.7293935, 'binary_specificity': 0.9959226, 'binary_f1_score': 0.79089373}
confusion matrix:
       0    1
0  18075   74
1    174  469
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964046, 'precision': 0.8735924, 'recall': 0.5946182, 'specificity': 0.5946182, 'f1': 0.64461803, 'auroc': 0.94264305, 'binary_precision': 0.78125, 'binary_recall': 0.19157088, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.3076923}
confusion matrix:
      0   1
0  5983  14
1   211  50
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811477.png
better model found
persisted
after epoch: 24,now: 2024-05-25 05:51:14.796704,epoch time: 0:39:29.751781,used: 17:06:36.312999,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_44_38_seed_0_20811477
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99547863, 'precision': 0.95971394, 'recall': 0.9717598, 'specificity': 0.9717598, 'f1': 0.9656528, 'auroc': 0.9991138, 'binary_precision': 0.9212963, 'binary_recall': 0.9463315, 'binary_specificity': 0.9971881, 'binary_f1_score': 0.933646}
confusion matrix:
       0     1
0  42201   119
1     79  1393
---- Validation: 
scalar performance:
{'acc': 0.9876011, 'precision': 0.90882456, 'recall': 0.9020742, 'specificity': 0.9020742, 'f1': 0.9054189, 'auroc': 0.98268336, 'binary_precision': 0.8243671, 'binary_recall': 0.8102644, 'binary_specificity': 0.99388397, 'binary_f1_score': 0.81725496}
confusion matrix:
       0    1
0  18038  111
1    122  521
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9654842, 'precision': 0.8606807, 'recall': 0.62651825, 'specificity': 0.62651825, 'f1': 0.6825514, 'auroc': 0.95139974, 'binary_precision': 0.752809, 'binary_recall': 0.256705, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.38285714}
confusion matrix:
      0   1
0  5975  22
1   194  67
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811477.png
better model found
persisted
after epoch: 25,now: 2024-05-25 06:30:57.782979,epoch time: 0:39:42.986275,used: 17:46:19.299274,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_44_38_seed_0_20811477
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9960267, 'precision': 0.980335, 'recall': 0.9576175, 'specificity': 0.9576175, 'f1': 0.9686805, 'auroc': 0.9994471, 'binary_precision': 0.9635714, 'binary_recall': 0.9164402, 'binary_specificity': 0.9987949, 'binary_f1_score': 0.93941504}
confusion matrix:
       0     1
0  42269    51
1    123  1349
---- Validation: 
scalar performance:
{'acc': 0.9849404, 'precision': 0.92145, 'recall': 0.8354418, 'specificity': 0.8354418, 'f1': 0.87317955, 'auroc': 0.9752301, 'binary_precision': 0.8543307, 'binary_recall': 0.6749611, 'binary_specificity': 0.9959226, 'binary_f1_score': 0.75412685}
confusion matrix:
       0    1
0  18075   74
1    209  434
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96196866, 'precision': 0.8653782, 'recall': 0.56238467, 'specificity': 0.56238467, 'f1': 0.5988081, 'auroc': 0.94068235, 'binary_precision': 0.76744187, 'binary_recall': 0.12643678, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.21710527}
confusion matrix:
      0   1
0  5987  10
1   228  33
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811477.png
early stop counter: 1
val acc:0.9849404096603394, best validation acc: 0.987601101398468, corresponding to test acc:                         0.9654842019081116 / 0.9787471890449524
after epoch: 26,now: 2024-05-25 07:10:42.446942,epoch time: 0:39:44.663963,used: 18:26:03.963237,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_44_38_seed_0_20811477
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9955243, 'precision': 0.9540986, 'recall': 0.97965205, 'specificity': 0.97965205, 'f1': 0.9664978, 'auroc': 0.99929655, 'binary_precision': 0.90949935, 'binary_recall': 0.9626359, 'binary_specificity': 0.9966682, 'binary_f1_score': 0.9353136}
confusion matrix:
       0     1
0  42179   141
1     55  1417
---- Validation: 
scalar performance:
{'acc': 0.98722863, 'precision': 0.89764583, 'recall': 0.9131322, 'specificity': 0.9131322, 'f1': 0.90522826, 'auroc': 0.984056, 'binary_precision': 0.8011958, 'binary_recall': 0.83359253, 'binary_specificity': 0.9926718, 'binary_f1_score': 0.81707317}
confusion matrix:
       0    1
0  18016  133
1    107  536
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9694791, 'precision': 0.8402424, 'recall': 0.7275486, 'specificity': 0.7275486, 'f1': 0.7715421, 'auroc': 0.9553498, 'binary_precision': 0.70348835, 'binary_recall': 0.46360153, 'binary_specificity': 0.9914957, 'binary_f1_score': 0.5588914}
confusion matrix:
      0    1
0  5946   51
1   140  121
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811477.png
early stop counter: 2
val acc:0.9872286319732666, best validation acc: 0.987601101398468, corresponding to test acc:                         0.9654842019081116 / 0.9787471890449524
after epoch: 27,now: 2024-05-25 07:50:34.229508,epoch time: 0:39:51.782566,used: 19:05:55.745803,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_44_38_seed_0_20811477
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9938345, 'precision': 0.9468484, 'recall': 0.9597359, 'specificity': 0.9597359, 'f1': 0.9531932, 'auroc': 0.99868184, 'binary_precision': 0.89636964, 'binary_recall': 0.92318153, 'binary_specificity': 0.99629027, 'binary_f1_score': 0.909578}
confusion matrix:
       0     1
0  42164   157
1    113  1358
---- Validation: 
scalar performance:
{'acc': 0.9860579, 'precision': 0.899009, 'recall': 0.88702416, 'specificity': 0.88702416, 'f1': 0.89291745, 'auroc': 0.9816239, 'binary_precision': 0.8057785, 'binary_recall': 0.7807154, 'binary_specificity': 0.993333, 'binary_f1_score': 0.793049}
confusion matrix:
       0    1
0  18028  121
1    141  502
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96164906, 'precision': 0.82747936, 'recall': 0.57137954, 'specificity': 0.57137954, 'f1': 0.6104171, 'auroc': 0.94892454, 'binary_precision': 0.6909091, 'binary_recall': 0.14559387, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.24050632}
confusion matrix:
      0   1
0  5980  17
1   223  38
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811477.png
early stop counter: 3
val acc:0.9860578775405884, best validation acc: 0.987601101398468, corresponding to test acc:                         0.9654842019081116 / 0.9787471890449524
after epoch: 28,now: 2024-05-25 08:30:25.690899,epoch time: 0:39:51.461391,used: 19:45:47.207194,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_44_38_seed_0_20811477
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9964377, 'precision': 0.96364844, 'recall': 0.9830754, 'specificity': 0.9830754, 'f1': 0.9731469, 'auroc': 0.99958575, 'binary_precision': 0.92838544, 'binary_recall': 0.96875, 'binary_specificity': 0.99740076, 'binary_f1_score': 0.9481383}
confusion matrix:
       0     1
0  42210   110
1     46  1426
---- Validation: 
scalar performance:
{'acc': 0.9868561, 'precision': 0.9017021, 'recall': 0.89868826, 'specificity': 0.89868826, 'f1': 0.90018904, 'auroc': 0.9838582, 'binary_precision': 0.8103448, 'binary_recall': 0.80404353, 'binary_specificity': 0.993333, 'binary_f1_score': 0.8071819}
confusion matrix:
       0    1
0  18028  121
1    126  517
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96644294, 'precision': 0.8411141, 'recall': 0.6618328, 'specificity': 0.6618328, 'f1': 0.7164775, 'auroc': 0.9630847, 'binary_precision': 0.7107438, 'binary_recall': 0.32950193, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.45026177}
confusion matrix:
      0   1
0  5962  35
1   175  86
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811477.png
early stop counter: 4
val acc:0.9868561029434204, best validation acc: 0.987601101398468, corresponding to test acc:                         0.9654842019081116 / 0.9787471890449524
after epoch: 29,now: 2024-05-25 09:10:36.059159,epoch time: 0:40:10.368260,used: 20:25:57.575454,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_44_38_seed_0_20811477
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9964149, 'precision': 0.9882606, 'recall': 0.9558215, 'specificity': 0.9558215, 'f1': 0.9714425, 'auroc': 0.9994973, 'binary_precision': 0.97956204, 'binary_recall': 0.9123046, 'binary_specificity': 0.9993384, 'binary_f1_score': 0.94473773}
confusion matrix:
       0     1
0  42293    28
1    129  1342
---- Validation: 
scalar performance:
{'acc': 0.9863772, 'precision': 0.9333172, 'recall': 0.8481866, 'specificity': 0.8481866, 'f1': 0.8857596, 'auroc': 0.97859097, 'binary_precision': 0.877193, 'binary_recall': 0.6998445, 'binary_specificity': 0.99652874, 'binary_f1_score': 0.7785467}
confusion matrix:
       0    1
0  18086   63
1    193  450
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964046, 'precision': 0.8694062, 'recall': 0.5964505, 'specificity': 0.5964505, 'f1': 0.64673364, 'auroc': 0.945609, 'binary_precision': 0.77272725, 'binary_recall': 0.1954023, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.3119266}
confusion matrix:
      0   1
0  5982  15
1   210  51
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811477.png
early stop counter: 5
val acc:0.9863771796226501, best validation acc: 0.987601101398468, corresponding to test acc:                         0.9654842019081116 / 0.9787471890449524
after epoch: 30,now: 2024-05-25 10:20:02.177261,epoch time: 1:09:26.118102,used: 21:35:23.693556,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_44_38_seed_0_20811477
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 21:35:23.693556 at 2024-05-25 10:20:02.177261
persisted model performance metric: 

scalar performance:
{'acc': 0.9642058, 'precision': 0.84019804, 'recall': 0.61668956, 'specificity': 0.61668956, 'f1': 0.6689564, 'auroc': 0.9475418, 'binary_precision': 0.7126437, 'binary_recall': 0.23754789, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.35632184}
confusion matrix:
      0   1
0  5972  25
1   199  62
oracle model performance metric: 

scalar performance:
{'acc': 0.97619045, 'precision': 0.89446497, 'recall': 0.77869105, 'specificity': 0.77869105, 'f1': 0.82565767, 'auroc': 0.95951235, 'binary_precision': 0.8076923, 'binary_recall': 0.5632184, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.66365695}
confusion matrix:
      0    1
0  5962   35
1   114  147
results aggregation path: zoutput/benchmarks/CAMELYON_center0_vit_irm/rule_results/5.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_vit_irm/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_vit_irm/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1661 MiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |   1655 MiB |  15779 MiB |    977 TiB |    977 TiB |
|       from small pool |      6 MiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1661 MiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |   1655 MiB |  15779 MiB |    977 TiB |    977 TiB |
|       from small pool |      6 MiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1653 MiB |  15770 MiB |    987 TiB |    987 TiB |
|       from large pool |   1647 MiB |  15745 MiB |    974 TiB |    974 TiB |
|       from small pool |      5 MiB |     25 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  16730 MiB |  16730 MiB |  16730 MiB |      0 B   |
|       from large pool |  16702 MiB |  16702 MiB |  16702 MiB |      0 B   |
|       from small pool |     28 MiB |     28 MiB |     28 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 430238 KiB |    863 MiB | 413550 GiB | 413550 GiB |
|       from large pool | 410304 KiB |    862 MiB | 400661 GiB | 400660 GiB |
|       from small pool |  19934 KiB |     21 MiB |  12889 GiB |  12889 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3366    |    6357    |  152169 K  |  152166 K  |
|       from large pool |     247    |     989    |   62327 K  |   62326 K  |
|       from small pool |    3119    |    6108    |   89842 K  |   89839 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3366    |    6357    |  152169 K  |  152166 K  |
|       from large pool |     247    |     989    |   62327 K  |   62326 K  |
|       from small pool |    3119    |    6108    |   89842 K  |   89839 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     621    |     621    |     621    |       0    |
|       from large pool |     607    |     607    |     607    |       0    |
|       from small pool |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     143    |    2872    |   90266 K  |   90266 K  |
|       from large pool |     112    |     516    |   47275 K  |   47275 K  |
|       from small pool |      31    |    2760    |   42991 K  |   42991 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |  16640 KiB |  15779 MiB |    977 TiB |    977 TiB |
|       from small pool |      0 KiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |  16640 KiB |  15779 MiB |    977 TiB |    977 TiB |
|       from small pool |      0 KiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15770 MiB |    987 TiB |    987 TiB |
|       from large pool |  16640 KiB |  15745 MiB |    974 TiB |    974 TiB |
|       from small pool |      0 KiB |     25 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2082 MiB |  16730 MiB |  16730 MiB |  14648 MiB |
|       from large pool |   2056 MiB |  16702 MiB |  16702 MiB |  14646 MiB |
|       from small pool |     26 MiB |     28 MiB |     28 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    863 MiB | 413551 GiB | 413551 GiB |
|       from large pool |  24320 KiB |    862 MiB | 400662 GiB | 400662 GiB |
|       from small pool |      0 KiB |     24 MiB |  12889 GiB |  12889 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6357    |  152169 K  |  152169 K  |
|       from large pool |       2    |     989    |   62327 K  |   62327 K  |
|       from small pool |       0    |    6108    |   89842 K  |   89842 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6357    |  152169 K  |  152169 K  |
|       from large pool |       2    |     989    |   62327 K  |   62327 K  |
|       from small pool |       0    |    6108    |   89842 K  |   89842 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     115    |     621    |     621    |     506    |
|       from large pool |     102    |     607    |     607    |     505    |
|       from small pool |      13    |      14    |      14    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    2872    |   90268 K  |   90268 K  |
|       from large pool |       2    |     516    |   47275 K  |   47275 K  |
|       from small pool |       0    |    2760    |   42992 K  |   42992 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat May 25 10:23:07 2024]
Finished job 0.
1 of 1 steps (100%) done
