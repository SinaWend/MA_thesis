Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Fri May 24 12:30:37 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_vit_irm/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_vit_irm/rule_results/3.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=3
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_46_seed_0_20811476

 Experiment start at: 2024-05-24 12:40:46.977371
before training, model accuracy: 0.955097496509552
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9696748, 'precision': 0.79079276, 'recall': 0.6364514, 'specificity': 0.6364514, 'f1': 0.68339074, 'auroc': 0.9614948, 'binary_precision': 0.6061947, 'binary_recall': 0.27921197, 'binary_specificity': 0.9936909, 'binary_f1_score': 0.3823256}
confusion matrix:
       0    1
0  42053  267
1   1061  411
---- Validation: 
scalar performance:
{'acc': 0.9692422, 'precision': 0.77501196, 'recall': 0.6983052, 'specificity': 0.6983052, 'f1': 0.7298278, 'auroc': 0.9648074, 'binary_precision': 0.5708061, 'binary_recall': 0.407465, 'binary_specificity': 0.9891454, 'binary_f1_score': 0.47549906}
confusion matrix:
       0    1
0  17952  197
1    381  262
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9651646, 'precision': 0.87335086, 'recall': 0.61352515, 'specificity': 0.61352515, 'f1': 0.6685642, 'auroc': 0.94384277, 'binary_precision': 0.77922076, 'binary_recall': 0.22988506, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.35502958}
confusion matrix:
      0   1
0  5980  17
1   201  60
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811476.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-24 13:21:01.511569,epoch time: 0:40:14.534198,used: 0:40:14.534198,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_46_seed_0_20811476
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9788774, 'precision': 0.8605381, 'recall': 0.78645444, 'specificity': 0.78645444, 'f1': 0.8189005, 'auroc': 0.97878885, 'binary_precision': 0.73557276, 'binary_recall': 0.58016306, 'binary_specificity': 0.99274576, 'binary_f1_score': 0.64868975}
confusion matrix:
       0    1
0  42013  307
1    618  854
---- Validation: 
scalar performance:
{'acc': 0.9782354, 'precision': 0.8806857, 'recall': 0.7517147, 'specificity': 0.7517147, 'f1': 0.80202043, 'auroc': 0.9732305, 'binary_precision': 0.7785714, 'binary_recall': 0.5085537, 'binary_specificity': 0.9948757, 'binary_f1_score': 0.6152399}
confusion matrix:
       0    1
0  18056   93
1    316  327
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9613295, 'precision': 0.8947692, 'recall': 0.5455601, 'specificity': 0.5455601, 'f1': 0.5728617, 'auroc': 0.95962363, 'binary_precision': 0.82758623, 'binary_recall': 0.09195402, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.16551723}
confusion matrix:
      0   1
0  5992   5
1   237  24
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811476.png
better model found
persisted
after epoch: 2,now: 2024-05-24 14:01:04.962321,epoch time: 0:40:03.450752,used: 1:20:17.984950,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_46_seed_0_20811476
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97981364, 'precision': 0.9256028, 'recall': 0.7338256, 'specificity': 0.7338256, 'f1': 0.7999339, 'auroc': 0.98479724, 'binary_precision': 0.86934674, 'binary_recall': 0.4701087, 'binary_specificity': 0.99754256, 'binary_f1_score': 0.61022925}
confusion matrix:
       0    1
0  42216  104
1    780  692
---- Validation: 
scalar performance:
{'acc': 0.9777565, 'precision': 0.9439336, 'recall': 0.69371253, 'specificity': 0.69371253, 'f1': 0.76663107, 'auroc': 0.9793519, 'binary_precision': 0.90909094, 'binary_recall': 0.3888025, 'binary_specificity': 0.99862254, 'binary_f1_score': 0.54466236}
confusion matrix:
       0    1
0  18124   25
1    393  250
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959412, 'precision': 0.8466443, 'recall': 0.5207393, 'specificity': 0.5207393, 'f1': 0.52947927, 'auroc': 0.9489991, 'binary_precision': 0.73333335, 'binary_recall': 0.042145595, 'binary_specificity': 0.999333, 'binary_f1_score': 0.07971015}
confusion matrix:
      0   1
0  5993   4
1   250  11
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811476.png
early stop counter: 1
val acc:0.9777565002441406, best validation acc: 0.9782354235649109, corresponding to test acc:                         0.9613295197486877 / 0.9651646018028259
after epoch: 3,now: 2024-05-24 14:42:58.510862,epoch time: 0:41:53.548541,used: 2:02:11.533491,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_46_seed_0_20811476
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9832161, 'precision': 0.8870384, 'recall': 0.84137905, 'specificity': 0.84137905, 'f1': 0.86265975, 'auroc': 0.9858992, 'binary_precision': 0.78482974, 'binary_recall': 0.689327, 'binary_specificity': 0.99343115, 'binary_f1_score': 0.73398477}
confusion matrix:
       0     1
0  42043   278
1    457  1014
---- Validation: 
scalar performance:
{'acc': 0.9831311, 'precision': 0.8973357, 'recall': 0.8307549, 'specificity': 0.8307549, 'f1': 0.86075306, 'auroc': 0.9826711, 'binary_precision': 0.806391, 'binary_recall': 0.66718507, 'binary_specificity': 0.99432474, 'binary_f1_score': 0.73021275}
confusion matrix:
       0    1
0  18046  103
1    214  429
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650048, 'precision': 0.9204087, 'recall': 0.5932861, 'specificity': 0.5932861, 'f1': 0.64559793, 'auroc': 0.9573643, 'binary_precision': 0.875, 'binary_recall': 0.18773946, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.30914825}
confusion matrix:
      0   1
0  5990   7
1   212  49
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811476.png
better model found
persisted
after epoch: 4,now: 2024-05-24 15:24:57.898288,epoch time: 0:41:59.387426,used: 2:44:10.920917,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_46_seed_0_20811476
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9832161, 'precision': 0.87702876, 'recall': 0.8584398, 'specificity': 0.8584398, 'f1': 0.8674792, 'auroc': 0.98729324, 'binary_precision': 0.7636103, 'binary_recall': 0.7246771, 'binary_specificity': 0.99220246, 'binary_f1_score': 0.7436344}
confusion matrix:
       0     1
0  41991   330
1    405  1066
---- Validation: 
scalar performance:
{'acc': 0.9837165, 'precision': 0.889019, 'recall': 0.85505974, 'specificity': 0.85505974, 'f1': 0.8711988, 'auroc': 0.9812067, 'binary_precision': 0.7880342, 'binary_recall': 0.7169518, 'binary_specificity': 0.99316764, 'binary_f1_score': 0.7508143}
confusion matrix:
       0    1
0  18025  124
1    182  461
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96356666, 'precision': 0.8144188, 'recall': 0.6273501, 'specificity': 0.6273501, 'f1': 0.67743194, 'auroc': 0.95248234, 'binary_precision': 0.66019416, 'binary_recall': 0.2605364, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.37362635}
confusion matrix:
      0   1
0  5962  35
1   193  68
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811476.png
better model found
persisted
after epoch: 5,now: 2024-05-24 16:04:26.851717,epoch time: 0:39:28.953429,used: 3:23:39.874346,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_46_seed_0_20811476
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9849287, 'precision': 0.9228598, 'recall': 0.8289284, 'specificity': 0.8289284, 'f1': 0.8695828, 'auroc': 0.98982656, 'binary_precision': 0.85739434, 'binary_recall': 0.6616848, 'binary_specificity': 0.996172, 'binary_f1_score': 0.7469325}
confusion matrix:
       0    1
0  42158  162
1    498  974
---- Validation: 
scalar performance:
{'acc': 0.9830779, 'precision': 0.92796916, 'recall': 0.79547477, 'specificity': 0.79547477, 'f1': 0.84869397, 'auroc': 0.9798074, 'binary_precision': 0.87015945, 'binary_recall': 0.5940902, 'binary_specificity': 0.9968593, 'binary_f1_score': 0.70609987}
confusion matrix:
       0    1
0  18092   57
1    261  382
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964046, 'precision': 0.8549657, 'recall': 0.60377985, 'specificity': 0.60377985, 'f1': 0.6549434, 'auroc': 0.9508547, 'binary_precision': 0.7432432, 'binary_recall': 0.21072797, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.3283582}
confusion matrix:
      0   1
0  5978  19
1   206  55
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811476.png
early stop counter: 1
val acc:0.983077883720398, best validation acc: 0.9837164878845215, corresponding to test acc:                         0.9635666608810425 / 0.9651646018028259
after epoch: 6,now: 2024-05-24 16:46:08.820883,epoch time: 0:41:41.969166,used: 4:05:21.843512,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_46_seed_0_20811476
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98609334, 'precision': 0.87961245, 'recall': 0.9190365, 'specificity': 0.9190365, 'f1': 0.89826477, 'auroc': 0.9912143, 'binary_precision': 0.7645616, 'binary_recall': 0.84714675, 'binary_specificity': 0.99092627, 'binary_f1_score': 0.80373824}
confusion matrix:
       0     1
0  41936   384
1    225  1247
---- Validation: 
scalar performance:
{'acc': 0.9853661, 'precision': 0.8809074, 'recall': 0.90541744, 'specificity': 0.90541744, 'f1': 0.89274615, 'auroc': 0.9837074, 'binary_precision': 0.76822156, 'binary_recall': 0.81959563, 'binary_specificity': 0.9912392, 'binary_f1_score': 0.79307747}
confusion matrix:
       0    1
0  17990  159
1    116  527
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96724194, 'precision': 0.8394652, 'recall': 0.68057305, 'specificity': 0.68057305, 'f1': 0.7333558, 'auroc': 0.9591386, 'binary_precision': 0.7058824, 'binary_recall': 0.3678161, 'binary_specificity': 0.99333, 'binary_f1_score': 0.48362717}
confusion matrix:
      0   1
0  5957  40
1   165  96
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811476.png
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-05-24 17:27:58.923430,epoch time: 0:41:50.102547,used: 4:47:11.946059,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_46_seed_0_20811476
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9871209, 'precision': 0.9046815, 'recall': 0.89458144, 'specificity': 0.89458144, 'f1': 0.8995624, 'auroc': 0.99105763, 'binary_precision': 0.81646895, 'binary_recall': 0.7953773, 'binary_specificity': 0.9937856, 'binary_f1_score': 0.8057852}
confusion matrix:
       0     1
0  42058   263
1    301  1170
---- Validation: 
scalar performance:
{'acc': 0.9848872, 'precision': 0.9135993, 'recall': 0.84366494, 'specificity': 0.84366494, 'f1': 0.8751459, 'auroc': 0.98218846, 'binary_precision': 0.8380414, 'binary_recall': 0.69206846, 'binary_specificity': 0.99526143, 'binary_f1_score': 0.758092}
confusion matrix:
       0    1
0  18063   86
1    198  445
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9713966, 'precision': 0.8697747, 'recall': 0.7248845, 'specificity': 0.7248845, 'f1': 0.77797437, 'auroc': 0.96332633, 'binary_precision': 0.76282054, 'binary_recall': 0.4559387, 'binary_specificity': 0.99383026, 'binary_f1_score': 0.5707434}
confusion matrix:
      0    1
0  5960   37
1   142  119
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811476.png
new oracle model saved
early stop counter: 1
val acc:0.9848871827125549, best validation acc: 0.9853661060333252, corresponding to test acc:                         0.9672419428825378 / 0.9713966250419617
after epoch: 8,now: 2024-05-24 18:07:48.743620,epoch time: 0:39:49.820190,used: 5:27:01.766249,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_46_seed_0_20811476
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98707527, 'precision': 0.93877053, 'recall': 0.8505937, 'specificity': 0.8505937, 'f1': 0.88939023, 'auroc': 0.99223745, 'binary_precision': 0.88774633, 'binary_recall': 0.7042828, 'binary_specificity': 0.9969046, 'binary_f1_score': 0.78544354}
confusion matrix:
       0     1
0  42190   131
1    435  1036
---- Validation: 
scalar performance:
{'acc': 0.9838229, 'precision': 0.9249291, 'recall': 0.81161165, 'specificity': 0.81161165, 'f1': 0.8588958, 'auroc': 0.9775268, 'binary_precision': 0.86295503, 'binary_recall': 0.62674963, 'binary_specificity': 0.9964736, 'binary_f1_score': 0.7261262}
confusion matrix:
       0    1
0  18085   64
1    240  403
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96356666, 'precision': 0.8941233, 'recall': 0.5797094, 'specificity': 0.5797094, 'f1': 0.6252742, 'auroc': 0.94496244, 'binary_precision': 0.8235294, 'binary_recall': 0.16091955, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.26923078}
confusion matrix:
      0   1
0  5988   9
1   219  42
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811476.png
early stop counter: 2
val acc:0.9838228821754456, best validation acc: 0.9853661060333252, corresponding to test acc:                         0.9672419428825378 / 0.9713966250419617
after epoch: 9,now: 2024-05-24 18:49:58.563880,epoch time: 0:42:09.820260,used: 6:09:11.586509,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_46_seed_0_20811476
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9876918, 'precision': 0.92972237, 'recall': 0.8716682, 'specificity': 0.8716682, 'f1': 0.89843005, 'auroc': 0.9936892, 'binary_precision': 0.86819255, 'binary_recall': 0.7472826, 'binary_specificity': 0.9960539, 'binary_f1_score': 0.8032129}
confusion matrix:
       0     1
0  42153   167
1    372  1100
---- Validation: 
scalar performance:
{'acc': 0.9853661, 'precision': 0.9420831, 'recall': 0.8221613, 'specificity': 0.8221613, 'f1': 0.87202096, 'auroc': 0.98289883, 'binary_precision': 0.8965517, 'binary_recall': 0.64696735, 'binary_specificity': 0.9973552, 'binary_f1_score': 0.7515809}
confusion matrix:
       0    1
0  18101   48
1    227  416
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.7488945, 'recall': 0.5129097, 'specificity': 0.5129097, 'f1': 0.5149283, 'auroc': 0.94545424, 'binary_precision': 0.53846157, 'binary_recall': 0.026819924, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.05109489}
confusion matrix:
      0  1
0  5991  6
1   254  7
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811476.png
early stop counter: 3
val acc:0.9853661060333252, best validation acc: 0.9853661060333252, corresponding to test acc:                         0.9672419428825378 / 0.9713966250419617
after epoch: 10,now: 2024-05-24 19:32:18.286378,epoch time: 0:42:19.722498,used: 6:51:31.309007,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_46_seed_0_20811476
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9887194, 'precision': 0.94230115, 'recall': 0.87580633, 'specificity': 0.87580633, 'f1': 0.906147, 'auroc': 0.99462163, 'binary_precision': 0.8930868, 'binary_recall': 0.75475544, 'binary_specificity': 0.9968573, 'binary_f1_score': 0.81811494}
confusion matrix:
       0     1
0  42187   133
1    361  1111
---- Validation: 
scalar performance:
{'acc': 0.9838229, 'precision': 0.9249291, 'recall': 0.81161165, 'specificity': 0.81161165, 'f1': 0.8588958, 'auroc': 0.97815883, 'binary_precision': 0.86295503, 'binary_recall': 0.62674963, 'binary_specificity': 0.9964736, 'binary_f1_score': 0.7261262}
confusion matrix:
       0    1
0  18085   64
1    240  403
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.77108955, 'recall': 0.5612174, 'specificity': 0.5612174, 'f1': 0.59344405, 'auroc': 0.9416289, 'binary_precision': 0.57894737, 'binary_recall': 0.12643678, 'binary_specificity': 0.995998, 'binary_f1_score': 0.20754717}
confusion matrix:
      0   1
0  5973  24
1   228  33
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811476.png
early stop counter: 4
val acc:0.9838228821754456, best validation acc: 0.9853661060333252, corresponding to test acc:                         0.9672419428825378 / 0.9713966250419617
after epoch: 11,now: 2024-05-24 20:11:12.575031,epoch time: 0:38:54.288653,used: 7:30:25.597660,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_46_seed_0_20811476
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.989747, 'precision': 0.9520533, 'recall': 0.88314456, 'specificity': 0.88314456, 'f1': 0.9145441, 'auroc': 0.99553204, 'binary_precision': 0.9120968, 'binary_recall': 0.7688647, 'binary_specificity': 0.9974244, 'binary_f1_score': 0.8343785}
confusion matrix:
       0     1
0  42212   109
1    340  1131
---- Validation: 
scalar performance:
{'acc': 0.9826522, 'precision': 0.9225122, 'recall': 0.79300416, 'specificity': 0.79300416, 'f1': 0.84516525, 'auroc': 0.9817463, 'binary_precision': 0.8594104, 'binary_recall': 0.58942455, 'binary_specificity': 0.9965838, 'binary_f1_score': 0.69926196}
confusion matrix:
       0    1
0  18087   62
1    264  379
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.8073467, 'recall': 0.53181666, 'specificity': 0.53181666, 'f1': 0.5488892, 'auroc': 0.9479828, 'binary_precision': 0.65384614, 'binary_recall': 0.0651341, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.11846689}
confusion matrix:
      0   1
0  5988   9
1   244  17
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811476.png
early stop counter: 5
val acc:0.9826521873474121, best validation acc: 0.9853661060333252, corresponding to test acc:                         0.9672419428825378 / 0.9713966250419617
after epoch: 12,now: 2024-05-24 20:51:30.521858,epoch time: 0:40:17.946827,used: 8:10:43.544487,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_46_seed_0_20811476
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99024934, 'precision': 0.96169144, 'recall': 0.8821716, 'specificity': 0.8821716, 'f1': 0.9179102, 'auroc': 0.9961835, 'binary_precision': 0.9314616, 'binary_recall': 0.7663044, 'binary_specificity': 0.99803877, 'binary_f1_score': 0.8408498}
confusion matrix:
       0     1
0  42237    83
1    344  1128
---- Validation: 
scalar performance:
{'acc': 0.98318434, 'precision': 0.9368592, 'recall': 0.78952944, 'specificity': 0.78952944, 'f1': 0.8471774, 'auroc': 0.97946596, 'binary_precision': 0.88836104, 'binary_recall': 0.5816485, 'binary_specificity': 0.9974103, 'binary_f1_score': 0.7030076}
confusion matrix:
       0    1
0  18102   47
1    269  374
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9603707, 'precision': 0.83564806, 'recall': 0.54139525, 'specificity': 0.54139525, 'f1': 0.5651985, 'auroc': 0.90497947, 'binary_precision': 0.7096774, 'binary_recall': 0.08429119, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.15068494}
confusion matrix:
      0   1
0  5988   9
1   239  22
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811476.png
early stop counter: 6
val acc:0.9831843376159668, best validation acc: 0.9853661060333252, corresponding to test acc:                         0.9672419428825378 / 0.9713966250419617
after epoch: 13,now: 2024-05-24 21:33:00.163124,epoch time: 0:41:29.641266,used: 8:52:13.185753,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_46_seed_0_20811476
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9916651, 'precision': 0.9359753, 'recall': 0.9356894, 'specificity': 0.9356894, 'f1': 0.93583226, 'auroc': 0.99733615, 'binary_precision': 0.87627465, 'binary_recall': 0.8756794, 'binary_specificity': 0.9956994, 'binary_f1_score': 0.8759769}
confusion matrix:
       0     1
0  42138   182
1    183  1289
---- Validation: 
scalar performance:
{'acc': 0.98738825, 'precision': 0.92322147, 'recall': 0.87796223, 'specificity': 0.87796223, 'f1': 0.89921093, 'auroc': 0.9832168, 'binary_precision': 0.8548951, 'binary_recall': 0.7604977, 'binary_specificity': 0.9954268, 'binary_f1_score': 0.8049383}
confusion matrix:
       0    1
0  18066   83
1    154  489
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606903, 'precision': 0.7999648, 'recall': 0.5653823, 'specificity': 0.5653823, 'f1': 0.6006775, 'auroc': 0.9369354, 'binary_precision': 0.6363636, 'binary_recall': 0.13409962, 'binary_specificity': 0.996665, 'binary_f1_score': 0.221519}
confusion matrix:
      0   1
0  5977  20
1   226  35
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811476.png
better model found
persisted
after epoch: 14,now: 2024-05-24 22:16:59.186570,epoch time: 0:43:59.023446,used: 9:36:12.209199,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_46_seed_0_20811476
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.991551, 'precision': 0.9152106, 'recall': 0.96511626, 'specificity': 0.96511626, 'f1': 0.9386285, 'auroc': 0.9983124, 'binary_precision': 0.83262837, 'binary_recall': 0.9367777, 'binary_specificity': 0.9934548, 'binary_f1_score': 0.8816379}
confusion matrix:
       0     1
0  42044   277
1     93  1378
---- Validation: 
scalar performance:
{'acc': 0.9856854, 'precision': 0.88354814, 'recall': 0.9070828, 'specificity': 0.9070828, 'f1': 0.89493394, 'auroc': 0.98529446, 'binary_precision': 0.7733918, 'binary_recall': 0.82270604, 'binary_specificity': 0.9914596, 'binary_f1_score': 0.7972871}
confusion matrix:
       0    1
0  17994  155
1    114  529
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9646852, 'precision': 0.8227453, 'recall': 0.6444247, 'specificity': 0.6444247, 'f1': 0.69623196, 'auroc': 0.9420245, 'binary_precision': 0.6754386, 'binary_recall': 0.29501915, 'binary_specificity': 0.99383026, 'binary_f1_score': 0.41066664}
confusion matrix:
      0   1
0  5960  37
1   184  77
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811476.png
early stop counter: 1
val acc:0.985685408115387, best validation acc: 0.9873882532119751, corresponding to test acc:                         0.9606903195381165 / 0.9713966250419617
after epoch: 15,now: 2024-05-24 23:01:57.259677,epoch time: 0:44:58.073107,used: 10:21:10.282306,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_46_seed_0_20811476
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99159664, 'precision': 0.96940356, 'recall': 0.8969666, 'specificity': 0.8969666, 'f1': 0.92993546, 'auroc': 0.9968617, 'binary_precision': 0.9458805, 'binary_recall': 0.7955163, 'binary_specificity': 0.99841684, 'binary_f1_score': 0.8642067}
confusion matrix:
       0     1
0  42253    67
1    301  1171
---- Validation: 
scalar performance:
{'acc': 0.98424864, 'precision': 0.9373667, 'recall': 0.8073317, 'specificity': 0.8073317, 'f1': 0.86016464, 'auroc': 0.9861456, 'binary_precision': 0.8881432, 'binary_recall': 0.61741835, 'binary_specificity': 0.997245, 'binary_f1_score': 0.7284403}
confusion matrix:
       0    1
0  18099   50
1    246  397
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.8474791, 'recall': 0.5414786, 'specificity': 0.5414786, 'f1': 0.5654991, 'auroc': 0.9422275, 'binary_precision': 0.73333335, 'binary_recall': 0.08429119, 'binary_specificity': 0.998666, 'binary_f1_score': 0.15120275}
confusion matrix:
      0   1
0  5989   8
1   239  22
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811476.png
early stop counter: 2
val acc:0.9842486381530762, best validation acc: 0.9873882532119751, corresponding to test acc:                         0.9606903195381165 / 0.9713966250419617
after epoch: 16,now: 2024-05-24 23:45:47.686412,epoch time: 0:43:50.426735,used: 11:05:00.709041,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_46_seed_0_20811476
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98924464, 'precision': 0.9707689, 'recall': 0.857718, 'specificity': 0.857718, 'f1': 0.90598583, 'auroc': 0.99709374, 'binary_precision': 0.9513075, 'binary_recall': 0.71671194, 'binary_specificity': 0.998724, 'binary_f1_score': 0.8175126}
confusion matrix:
       0     1
0  42266    54
1    417  1055
---- Validation: 
scalar performance:
{'acc': 0.98275864, 'precision': 0.93287754, 'recall': 0.7855587, 'specificity': 0.7855587, 'f1': 0.8430219, 'auroc': 0.98032784, 'binary_precision': 0.8806683, 'binary_recall': 0.57387245, 'binary_specificity': 0.997245, 'binary_f1_score': 0.69491524}
confusion matrix:
       0    1
0  18099   50
1    274  369
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645254, 'precision': 0.87067616, 'recall': 0.60402995, 'specificity': 0.60402995, 'f1': 0.6565523, 'auroc': 0.95019716, 'binary_precision': 0.7746479, 'binary_recall': 0.21072797, 'binary_specificity': 0.997332, 'binary_f1_score': 0.33132532}
confusion matrix:
      0   1
0  5981  16
1   206  55
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811476.png
early stop counter: 3
val acc:0.982758641242981, best validation acc: 0.9873882532119751, corresponding to test acc:                         0.9606903195381165 / 0.9713966250419617
after epoch: 17,now: 2024-05-25 00:29:31.694113,epoch time: 0:43:44.007701,used: 11:48:44.716742,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_46_seed_0_20811476
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99340063, 'precision': 0.9530465, 'recall': 0.94441926, 'specificity': 0.94441926, 'f1': 0.94868815, 'auroc': 0.99846756, 'binary_precision': 0.90984744, 'binary_recall': 0.89191025, 'binary_specificity': 0.9969282, 'binary_f1_score': 0.90078956}
confusion matrix:
       0     1
0  42191   130
1    159  1312
---- Validation: 
scalar performance:
{'acc': 0.9860579, 'precision': 0.91922617, 'recall': 0.85852206, 'specificity': 0.85852206, 'f1': 0.8863164, 'auroc': 0.98176163, 'binary_precision': 0.84826326, 'binary_recall': 0.7216174, 'binary_specificity': 0.9954268, 'binary_f1_score': 0.7798319}
confusion matrix:
       0    1
0  18066   83
1    179  464
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9592522, 'precision': 0.76510155, 'recall': 0.54630864, 'specificity': 0.54630864, 'f1': 0.5715258, 'auroc': 0.9442643, 'binary_precision': 0.5681818, 'binary_recall': 0.09578544, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.16393442}
confusion matrix:
      0   1
0  5978  19
1   236  25
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811476.png
early stop counter: 4
val acc:0.9860578775405884, best validation acc: 0.9873882532119751, corresponding to test acc:                         0.9606903195381165 / 0.9713966250419617
after epoch: 18,now: 2024-05-25 01:13:06.574097,epoch time: 0:43:34.879984,used: 12:32:19.596726,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_46_seed_0_20811476
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9918478, 'precision': 0.9458978, 'recall': 0.92627597, 'specificity': 0.92627597, 'f1': 0.93584895, 'auroc': 0.9975208, 'binary_precision': 0.8967972, 'binary_recall': 0.85597825, 'binary_specificity': 0.99657375, 'binary_f1_score': 0.87591237}
confusion matrix:
       0     1
0  42175   145
1    212  1260
---- Validation: 
scalar performance:
{'acc': 0.9861111, 'precision': 0.9332939, 'recall': 0.84354854, 'specificity': 0.84354854, 'f1': 0.8828412, 'auroc': 0.9794053, 'binary_precision': 0.8774704, 'binary_recall': 0.6905132, 'binary_specificity': 0.9965838, 'binary_f1_score': 0.7728459}
confusion matrix:
       0    1
0  18087   62
1    199  444
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96276766, 'precision': 0.8573444, 'recall': 0.57929254, 'specificity': 0.57929254, 'f1': 0.62294215, 'auroc': 0.93498856, 'binary_precision': 0.75, 'binary_recall': 0.16091955, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.26498425}
confusion matrix:
      0   1
0  5983  14
1   219  42
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811476.png
early stop counter: 5
val acc:0.9861111044883728, best validation acc: 0.9873882532119751, corresponding to test acc:                         0.9606903195381165 / 0.9713966250419617
after epoch: 19,now: 2024-05-25 01:52:14.813909,epoch time: 0:39:08.239812,used: 13:11:27.836538,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_46_seed_0_20811476
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99257857, 'precision': 0.9493041, 'recall': 0.9348506, 'specificity': 0.9348506, 'f1': 0.94194996, 'auroc': 0.9977838, 'binary_precision': 0.9030218, 'binary_recall': 0.87296194, 'binary_specificity': 0.99673915, 'binary_f1_score': 0.88773745}
confusion matrix:
       0     1
0  42182   138
1    187  1285
---- Validation: 
scalar performance:
{'acc': 0.9853661, 'precision': 0.90937674, 'recall': 0.85816395, 'specificity': 0.85816395, 'f1': 0.88192296, 'auroc': 0.9822909, 'binary_precision': 0.82857144, 'binary_recall': 0.7216174, 'binary_specificity': 0.99471045, 'binary_f1_score': 0.77140486}
confusion matrix:
       0    1
0  18053   96
1    179  464
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650048, 'precision': 0.82016814, 'recall': 0.6555854, 'specificity': 0.6555854, 'f1': 0.7065579, 'auroc': 0.9493853, 'binary_precision': 0.66935486, 'binary_recall': 0.31800765, 'binary_specificity': 0.9931632, 'binary_f1_score': 0.43116882}
confusion matrix:
      0   1
0  5956  41
1   178  83
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811476.png
early stop counter: 6
val acc:0.9853661060333252, best validation acc: 0.9873882532119751, corresponding to test acc:                         0.9606903195381165 / 0.9713966250419617
after epoch: 20,now: 2024-05-25 02:30:23.443571,epoch time: 0:38:08.629662,used: 13:49:36.466200,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_46_seed_0_20811476
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99340063, 'precision': 0.9808787, 'recall': 0.91527647, 'specificity': 0.91527647, 'f1': 0.9455019, 'auroc': 0.99878514, 'binary_precision': 0.96758896, 'binary_recall': 0.83152175, 'binary_specificity': 0.9990312, 'binary_f1_score': 0.89441}
confusion matrix:
       0     1
0  42279    41
1    248  1224
---- Validation: 
scalar performance:
{'acc': 0.9829715, 'precision': 0.9417958, 'recall': 0.78191864, 'specificity': 0.78191864, 'f1': 0.84294903, 'auroc': 0.9817863, 'binary_precision': 0.89876544, 'binary_recall': 0.5660964, 'binary_specificity': 0.9977409, 'binary_f1_score': 0.69465655}
confusion matrix:
       0    1
0  18108   41
1    279  364
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.965644, 'precision': 0.9026395, 'recall': 0.6082783, 'specificity': 0.6082783, 'f1': 0.6644314, 'auroc': 0.9444847, 'binary_precision': 0.8382353, 'binary_recall': 0.21839081, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.34650457}
confusion matrix:
      0   1
0  5986  11
1   204  57
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811476.png
early stop counter: 7
val acc:0.9829714894294739, best validation acc: 0.9873882532119751, corresponding to test acc:                         0.9606903195381165 / 0.9713966250419617
after epoch: 21,now: 2024-05-25 03:08:36.752218,epoch time: 0:38:13.308647,used: 14:27:49.774847,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_46_seed_0_20811476
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99556994, 'precision': 0.96422106, 'recall': 0.96787274, 'specificity': 0.96787274, 'f1': 0.9660392, 'auroc': 0.9991363, 'binary_precision': 0.930593, 'binary_recall': 0.9381794, 'binary_specificity': 0.99756616, 'binary_f1_score': 0.93437076}
confusion matrix:
       0     1
0  42217   103
1     91  1381
---- Validation: 
scalar performance:
{'acc': 0.98855895, 'precision': 0.934402, 'recall': 0.88531876, 'specificity': 0.88531876, 'f1': 0.9082749, 'auroc': 0.9829064, 'binary_precision': 0.87676054, 'binary_recall': 0.7744945, 'binary_specificity': 0.99614304, 'binary_f1_score': 0.8224607}
confusion matrix:
       0    1
0  18079   70
1    145  498
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96292746, 'precision': 0.8930844, 'recall': 0.5702142, 'specificity': 0.5702142, 'f1': 0.6114146, 'auroc': 0.95257676, 'binary_precision': 0.82222223, 'binary_recall': 0.14176245, 'binary_specificity': 0.998666, 'binary_f1_score': 0.24183007}
confusion matrix:
      0   1
0  5989   8
1   224  37
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811476.png
better model found
persisted
after epoch: 22,now: 2024-05-25 03:46:48.002464,epoch time: 0:38:11.250246,used: 15:06:01.025093,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_46_seed_0_20811476
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9929896, 'precision': 0.948787, 'recall': 0.94260395, 'specificity': 0.94260395, 'f1': 0.94567233, 'auroc': 0.99801016, 'binary_precision': 0.9014473, 'binary_recall': 0.88858694, 'binary_specificity': 0.996621, 'binary_f1_score': 0.8949709}
confusion matrix:
       0     1
0  42177   143
1    164  1308
---- Validation: 
scalar performance:
{'acc': 0.98403573, 'precision': 0.8926208, 'recall': 0.8559751, 'specificity': 0.8559751, 'f1': 0.8733256, 'auroc': 0.9809152, 'binary_precision': 0.79518074, 'binary_recall': 0.718507, 'binary_specificity': 0.9934432, 'binary_f1_score': 0.754902}
confusion matrix:
       0    1
0  18030  119
1    181  462
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964845, 'precision': 0.8492826, 'recall': 0.6225201, 'specificity': 0.6225201, 'f1': 0.6766727, 'auroc': 0.9513759, 'binary_precision': 0.7303371, 'binary_recall': 0.24904214, 'binary_specificity': 0.995998, 'binary_f1_score': 0.37142855}
confusion matrix:
      0   1
0  5973  24
1   196  65
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811476.png
early stop counter: 1
val acc:0.9840357303619385, best validation acc: 0.9885589480400085, corresponding to test acc:                         0.9629274606704712 / 0.9713966250419617
after epoch: 23,now: 2024-05-25 04:24:56.460248,epoch time: 0:38:08.457784,used: 15:44:09.482877,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_46_seed_0_20811476
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9951361, 'precision': 0.97968346, 'recall': 0.94404244, 'specificity': 0.94404244, 'f1': 0.9611242, 'auroc': 0.99875253, 'binary_precision': 0.96320826, 'binary_recall': 0.8892663, 'binary_specificity': 0.9988185, 'binary_f1_score': 0.9247616}
confusion matrix:
       0     1
0  42270    50
1    163  1309
---- Validation: 
scalar performance:
{'acc': 0.9871222, 'precision': 0.95041645, 'recall': 0.844072, 'specificity': 0.844072, 'f1': 0.8896011, 'auroc': 0.98319197, 'binary_precision': 0.9117043, 'binary_recall': 0.6905132, 'binary_specificity': 0.9976307, 'binary_f1_score': 0.7858407}
confusion matrix:
       0    1
0  18106   43
1    199  444
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606903, 'precision': 0.8936369, 'recall': 0.536065, 'specificity': 0.536065, 'f1': 0.55684584, 'auroc': 0.94213796, 'binary_precision': 0.82608694, 'binary_recall': 0.07279693, 'binary_specificity': 0.999333, 'binary_f1_score': 0.13380282}
confusion matrix:
      0   1
0  5993   4
1   242  19
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811476.png
early stop counter: 2
val acc:0.9871221780776978, best validation acc: 0.9885589480400085, corresponding to test acc:                         0.9629274606704712 / 0.9713966250419617
after epoch: 24,now: 2024-05-25 05:03:09.895844,epoch time: 0:38:13.435596,used: 16:22:22.918473,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_46_seed_0_20811476
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9964149, 'precision': 0.97491753, 'recall': 0.9696213, 'specificity': 0.9696213, 'f1': 0.97225344, 'auroc': 0.99917054, 'binary_precision': 0.95189005, 'binary_recall': 0.94089675, 'binary_specificity': 0.9983459, 'binary_f1_score': 0.9463615}
confusion matrix:
       0     1
0  42250    70
1     87  1385
---- Validation: 
scalar performance:
{'acc': 0.98845255, 'precision': 0.94425714, 'recall': 0.87251276, 'specificity': 0.87251276, 'f1': 0.90499246, 'auroc': 0.98038375, 'binary_precision': 0.89738804, 'binary_recall': 0.748056, 'binary_specificity': 0.9969695, 'binary_f1_score': 0.8159457}
confusion matrix:
       0    1
0  18094   55
1    162  481
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642058, 'precision': 0.850662, 'recall': 0.6093602, 'specificity': 0.6093602, 'f1': 0.6613898, 'auroc': 0.9306867, 'binary_precision': 0.73417723, 'binary_recall': 0.22222222, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.34117648}
confusion matrix:
      0   1
0  5976  21
1   203  58
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811476.png
early stop counter: 3
val acc:0.9884525537490845, best validation acc: 0.9885589480400085, corresponding to test acc:                         0.9629274606704712 / 0.9713966250419617
after epoch: 25,now: 2024-05-25 05:41:24.107319,epoch time: 0:38:14.211475,used: 17:00:37.129948,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_46_seed_0_20811476
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9964149, 'precision': 0.98592615, 'recall': 0.9581463, 'specificity': 0.9581463, 'f1': 0.9715971, 'auroc': 0.9992192, 'binary_precision': 0.97472924, 'binary_recall': 0.91711956, 'binary_specificity': 0.999173, 'binary_f1_score': 0.94504726}
confusion matrix:
       0     1
0  42285    35
1    122  1350
---- Validation: 
scalar performance:
{'acc': 0.9861111, 'precision': 0.94478834, 'recall': 0.8322977, 'specificity': 0.8322977, 'f1': 0.87979925, 'auroc': 0.97831786, 'binary_precision': 0.9012605, 'binary_recall': 0.66718507, 'binary_specificity': 0.9974103, 'binary_f1_score': 0.76675606}
confusion matrix:
       0    1
0  18102   47
1    214  429
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96196866, 'precision': 0.83665085, 'recall': 0.5733786, 'specificity': 0.5733786, 'f1': 0.6136636, 'auroc': 0.9217615, 'binary_precision': 0.7090909, 'binary_recall': 0.14942528, 'binary_specificity': 0.997332, 'binary_f1_score': 0.24683544}
confusion matrix:
      0   1
0  5981  16
1   222  39
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811476.png
early stop counter: 4
val acc:0.9861111044883728, best validation acc: 0.9885589480400085, corresponding to test acc:                         0.9629274606704712 / 0.9713966250419617
after epoch: 26,now: 2024-05-25 06:19:32.221810,epoch time: 0:38:08.114491,used: 17:38:45.244439,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_46_seed_0_20811476
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9967802, 'precision': 0.9889016, 'recall': 0.96093184, 'specificity': 0.96093184, 'f1': 0.97447443, 'auroc': 0.99960864, 'binary_precision': 0.98049134, 'binary_recall': 0.9225017, 'binary_specificity': 0.999362, 'binary_f1_score': 0.95061296}
confusion matrix:
       0     1
0  42294    27
1    114  1357
---- Validation: 
scalar performance:
{'acc': 0.9874947, 'precision': 0.9570664, 'recall': 0.8442648, 'specificity': 0.8442648, 'f1': 0.89214694, 'auroc': 0.98221505, 'binary_precision': 0.925, 'binary_recall': 0.6905132, 'binary_specificity': 0.9980164, 'binary_f1_score': 0.79073906}
confusion matrix:
       0    1
0  18113   36
1    199  444
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96196866, 'precision': 0.8956452, 'recall': 0.5550553, 'specificity': 0.5550553, 'f1': 0.58823484, 'auroc': 0.9465605, 'binary_precision': 0.82857144, 'binary_recall': 0.11111111, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.19594595}
confusion matrix:
      0   1
0  5991   6
1   232  29
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811476.png
early stop counter: 5
val acc:0.987494707107544, best validation acc: 0.9885589480400085, corresponding to test acc:                         0.9629274606704712 / 0.9713966250419617
after epoch: 27,now: 2024-05-25 06:57:43.814903,epoch time: 0:38:11.593093,used: 18:16:56.837532,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_46_seed_0_20811476
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99454236, 'precision': 0.94828606, 'recall': 0.97029185, 'specificity': 0.97029185, 'f1': 0.9590043, 'auroc': 0.99902344, 'binary_precision': 0.89851326, 'binary_recall': 0.9442935, 'binary_specificity': 0.99629015, 'binary_f1_score': 0.9208347}
confusion matrix:
       0     1
0  42163   157
1     82  1390
---- Validation: 
scalar performance:
{'acc': 0.9867497, 'precision': 0.91723895, 'recall': 0.87388134, 'specificity': 0.87388134, 'f1': 0.8942758, 'auroc': 0.98036224, 'binary_precision': 0.8432056, 'binary_recall': 0.7527216, 'binary_specificity': 0.9950411, 'binary_f1_score': 0.7953985}
confusion matrix:
       0    1
0  18059   90
1    159  484
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96612334, 'precision': 0.8402081, 'recall': 0.65616906, 'specificity': 0.65616906, 'f1': 0.71084386, 'auroc': 0.9356904, 'binary_precision': 0.7094017, 'binary_recall': 0.31800765, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.43915346}
confusion matrix:
      0   1
0  5963  34
1   178  83
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811476.png
early stop counter: 6
val acc:0.9867497086524963, best validation acc: 0.9885589480400085, corresponding to test acc:                         0.9629274606704712 / 0.9713966250419617
after epoch: 28,now: 2024-05-25 07:35:53.858823,epoch time: 0:38:10.043920,used: 18:55:06.881452,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_46_seed_0_20811476
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9964377, 'precision': 0.9836447, 'recall': 0.96075463, 'specificity': 0.96075463, 'f1': 0.97190154, 'auroc': 0.9994707, 'binary_precision': 0.9699786, 'binary_recall': 0.9225017, 'binary_specificity': 0.9990076, 'binary_f1_score': 0.9456446}
confusion matrix:
       0     1
0  42279    42
1    114  1357
---- Validation: 
scalar performance:
{'acc': 0.9864304, 'precision': 0.9439619, 'recall': 0.8384634, 'specificity': 0.8384634, 'f1': 0.88357073, 'auroc': 0.98342085, 'binary_precision': 0.89917696, 'binary_recall': 0.67962676, 'binary_specificity': 0.99730015, 'binary_f1_score': 0.77413636}
confusion matrix:
       0    1
0  18100   49
1    206  437
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96612334, 'precision': 0.878404, 'recall': 0.62685174, 'specificity': 0.62685174, 'f1': 0.6849317, 'auroc': 0.95758706, 'binary_precision': 0.7882353, 'binary_recall': 0.256705, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.3872833}
confusion matrix:
      0   1
0  5979  18
1   194  67
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811476.png
early stop counter: 7
val acc:0.9864304065704346, best validation acc: 0.9885589480400085, corresponding to test acc:                         0.9629274606704712 / 0.9713966250419617
after epoch: 29,now: 2024-05-25 08:14:09.316567,epoch time: 0:38:15.457744,used: 19:33:22.339196,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_46_seed_0_20811476
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9958212, 'precision': 0.97851634, 'recall': 0.95619977, 'specificity': 0.95619977, 'f1': 0.96707165, 'auroc': 0.9988292, 'binary_precision': 0.9600285, 'binary_recall': 0.9137228, 'binary_specificity': 0.9986768, 'binary_f1_score': 0.93630344}
confusion matrix:
       0     1
0  42264    56
1    127  1345
---- Validation: 
scalar performance:
{'acc': 0.98738825, 'precision': 0.9447167, 'recall': 0.85396045, 'specificity': 0.85396045, 'f1': 0.8937935, 'auroc': 0.9851095, 'binary_precision': 0.8996063, 'binary_recall': 0.71073097, 'binary_specificity': 0.99718994, 'binary_f1_score': 0.7940921}
confusion matrix:
       0    1
0  18098   51
1    186  457
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.7295134, 'recall': 0.50916165, 'specificity': 0.50916165, 'f1': 0.5077928, 'auroc': 0.93471897, 'binary_precision': 0.5, 'binary_recall': 0.019157087, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.036900368}
confusion matrix:
      0  1
0  5992  5
1   256  5
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811476.png
early stop counter: 8
val acc:0.9873882532119751, best validation acc: 0.9885589480400085, corresponding to test acc:                         0.9629274606704712 / 0.9713966250419617
after epoch: 30,now: 2024-05-25 08:52:22.148697,epoch time: 0:38:12.832130,used: 20:11:35.171326,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_46_seed_0_20811476
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 20:11:35.171326 at 2024-05-25 08:52:22.148697
persisted model performance metric: 

scalar performance:
{'acc': 0.96276766, 'precision': 0.8909866, 'recall': 0.5682985, 'specificity': 0.5682985, 'f1': 0.6084922, 'auroc': 0.9554894, 'binary_precision': 0.8181818, 'binary_recall': 0.13793103, 'binary_specificity': 0.998666, 'binary_f1_score': 0.23606557}
confusion matrix:
      0   1
0  5989   8
1   225  36
oracle model performance metric: 

scalar performance:
{'acc': 0.9701182, 'precision': 0.8643596, 'recall': 0.7077265, 'specificity': 0.7077265, 'f1': 0.7625488, 'auroc': 0.9673338, 'binary_precision': 0.75342464, 'binary_recall': 0.42145595, 'binary_specificity': 0.993997, 'binary_f1_score': 0.5405406}
confusion matrix:
      0    1
0  5961   36
1   151  110
results aggregation path: zoutput/benchmarks/CAMELYON_center0_vit_irm/rule_results/3.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_vit_irm/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_vit_irm/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1661 MiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |   1655 MiB |  15779 MiB |    977 TiB |    977 TiB |
|       from small pool |      6 MiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1661 MiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |   1655 MiB |  15779 MiB |    977 TiB |    977 TiB |
|       from small pool |      6 MiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1653 MiB |  15770 MiB |    987 TiB |    987 TiB |
|       from large pool |   1647 MiB |  15745 MiB |    974 TiB |    974 TiB |
|       from small pool |      5 MiB |     25 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  16730 MiB |  16730 MiB |  16730 MiB |      0 B   |
|       from large pool |  16702 MiB |  16702 MiB |  16702 MiB |      0 B   |
|       from small pool |     28 MiB |     28 MiB |     28 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 430238 KiB |    863 MiB | 413550 GiB | 413549 GiB |
|       from large pool | 410304 KiB |    862 MiB | 400660 GiB | 400660 GiB |
|       from small pool |  19934 KiB |     21 MiB |  12889 GiB |  12889 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3366    |    6357    |  152169 K  |  152165 K  |
|       from large pool |     247    |     989    |   62327 K  |   62326 K  |
|       from small pool |    3119    |    6108    |   89842 K  |   89839 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3366    |    6357    |  152169 K  |  152165 K  |
|       from large pool |     247    |     989    |   62327 K  |   62326 K  |
|       from small pool |    3119    |    6108    |   89842 K  |   89839 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     621    |     621    |     621    |       0    |
|       from large pool |     607    |     607    |     607    |       0    |
|       from small pool |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     147    |    2871    |   90186 K  |   90186 K  |
|       from large pool |     112    |     516    |   47275 K  |   47275 K  |
|       from small pool |      35    |    2759    |   42910 K  |   42910 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |  16640 KiB |  15779 MiB |    977 TiB |    977 TiB |
|       from small pool |      0 KiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |  16640 KiB |  15779 MiB |    977 TiB |    977 TiB |
|       from small pool |      0 KiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15770 MiB |    987 TiB |    987 TiB |
|       from large pool |  16640 KiB |  15745 MiB |    974 TiB |    974 TiB |
|       from small pool |      0 KiB |     25 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2082 MiB |  16730 MiB |  16730 MiB |  14648 MiB |
|       from large pool |   2056 MiB |  16702 MiB |  16702 MiB |  14646 MiB |
|       from small pool |     26 MiB |     28 MiB |     28 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    863 MiB | 413551 GiB | 413551 GiB |
|       from large pool |  24320 KiB |    862 MiB | 400661 GiB | 400661 GiB |
|       from small pool |      0 KiB |     25 MiB |  12889 GiB |  12889 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6357    |  152169 K  |  152169 K  |
|       from large pool |       2    |     989    |   62327 K  |   62327 K  |
|       from small pool |       0    |    6108    |   89842 K  |   89842 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6357    |  152169 K  |  152169 K  |
|       from large pool |       2    |     989    |   62327 K  |   62327 K  |
|       from small pool |       0    |    6108    |   89842 K  |   89842 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     115    |     621    |     621    |     506    |
|       from large pool |     102    |     607    |     607    |     505    |
|       from small pool |      13    |      14    |      14    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    2871    |   90187 K  |   90187 K  |
|       from large pool |       2    |     516    |   47275 K  |   47275 K  |
|       from small pool |       0    |    2759    |   42912 K  |   42912 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat May 25 08:55:18 2024]
Finished job 0.
1 of 1 steps (100%) done
