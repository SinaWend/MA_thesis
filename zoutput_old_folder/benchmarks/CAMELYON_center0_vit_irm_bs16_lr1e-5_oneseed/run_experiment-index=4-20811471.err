Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Fri May 24 12:30:37 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_vit_irm/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_vit_irm/rule_results/4.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=4
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_26_seed_0_20811471

 Experiment start at: 2024-05-24 12:40:26.734345
before training, model accuracy: 0.955097496509552
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9664094, 'precision': 0.74706745, 'recall': 0.90032786, 'specificity': 0.90032786, 'f1': 0.80324644, 'auroc': 0.9707562, 'binary_precision': 0.50020486, 'binary_recall': 0.8294837, 'binary_specificity': 0.97117203, 'binary_f1_score': 0.6240736}
confusion matrix:
       0     1
0  41100  1220
1    251  1221
---- Validation: 
scalar performance:
{'acc': 0.965198, 'precision': 0.7440806, 'recall': 0.89347595, 'specificity': 0.89347595, 'f1': 0.7989849, 'auroc': 0.9703881, 'binary_precision': 0.4948162, 'binary_recall': 0.8164852, 'binary_specificity': 0.9704667, 'binary_f1_score': 0.61619717}
confusion matrix:
       0    1
0  17613  536
1    118  525
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97810805, 'precision': 0.8594708, 'recall': 0.87130827, 'specificity': 0.87130827, 'f1': 0.86528265, 'auroc': 0.9476551, 'binary_precision': 0.72962964, 'binary_recall': 0.7547893, 'binary_specificity': 0.98782724, 'binary_f1_score': 0.7419963}
confusion matrix:
      0    1
0  5924   73
1    64  197
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811471.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-24 13:22:08.627306,epoch time: 0:41:41.892961,used: 0:41:41.892961,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_26_seed_0_20811471
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9756805, 'precision': 0.91560686, 'recall': 0.66578746, 'specificity': 0.66578746, 'f1': 0.7336378, 'auroc': 0.974088, 'binary_precision': 0.85391307, 'binary_recall': 0.33355978, 'binary_specificity': 0.9980151, 'binary_f1_score': 0.47972643}
confusion matrix:
       0    1
0  42236   84
1    981  491
---- Validation: 
scalar performance:
{'acc': 0.97307366, 'precision': 0.9110587, 'recall': 0.62903357, 'specificity': 0.62903357, 'f1': 0.69192404, 'auroc': 0.96589315, 'binary_precision': 0.84771574, 'binary_recall': 0.25972006, 'binary_specificity': 0.99834704, 'binary_f1_score': 0.39761904}
confusion matrix:
       0    1
0  18119   30
1    476  167
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.81262994, 'recall': 0.50374806, 'specificity': 0.50374806, 'f1': 0.49696523, 'auroc': 0.93616956, 'binary_precision': 0.6666667, 'binary_recall': 0.007662835, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.015151515}
confusion matrix:
      0  1
0  5996  1
1   259  2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811471.png
better model found
persisted
after epoch: 2,now: 2024-05-24 14:02:53.819088,epoch time: 0:40:45.191782,used: 1:22:27.084743,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_26_seed_0_20811471
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9812066, 'precision': 0.91156304, 'recall': 0.77062964, 'specificity': 0.77062964, 'f1': 0.8254771, 'auroc': 0.98059464, 'binary_precision': 0.83874345, 'binary_recall': 0.544898, 'binary_specificity': 0.99636126, 'binary_f1_score': 0.66061854}
confusion matrix:
       0    1
0  42168  154
1    669  801
---- Validation: 
scalar performance:
{'acc': 0.9785015, 'precision': 0.9089266, 'recall': 0.7293508, 'specificity': 0.7293508, 'f1': 0.79207397, 'auroc': 0.97316945, 'binary_precision': 0.83661973, 'binary_recall': 0.46189734, 'binary_specificity': 0.99680424, 'binary_f1_score': 0.59519035}
confusion matrix:
       0    1
0  18091   58
1    346  297
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.7798174, 'recall': 0.5167411, 'specificity': 0.5167411, 'f1': 0.5220695, 'auroc': 0.9473355, 'binary_precision': 0.6, 'binary_recall': 0.03448276, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.06521738}
confusion matrix:
      0  1
0  5991  6
1   252  9
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811471.png
better model found
persisted
after epoch: 3,now: 2024-05-24 14:43:27.281986,epoch time: 0:40:33.462898,used: 2:03:00.547641,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_26_seed_0_20811471
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9807499, 'precision': 0.91442704, 'recall': 0.75988305, 'specificity': 0.75988305, 'f1': 0.81817496, 'auroc': 0.98437333, 'binary_precision': 0.84522504, 'binary_recall': 0.5230978, 'binary_specificity': 0.9966682, 'binary_f1_score': 0.6462442}
confusion matrix:
       0    1
0  42179  141
1    702  770
---- Validation: 
scalar performance:
{'acc': 0.9781822, 'precision': 0.9398751, 'recall': 0.70293355, 'specificity': 0.70293355, 'f1': 0.77492046, 'auroc': 0.97978616, 'binary_precision': 0.90034366, 'binary_recall': 0.407465, 'binary_specificity': 0.9984021, 'binary_f1_score': 0.5610279}
confusion matrix:
       0    1
0  18120   29
1    381  262
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589326, 'precision': 0.97945315, 'recall': 0.50766283, 'specificity': 0.50766283, 'f1': 0.5046054, 'auroc': 0.9561832, 'binary_precision': 1.0, 'binary_recall': 0.01532567, 'binary_specificity': 1.0, 'binary_f1_score': 0.030188678}
confusion matrix:
      0  1
0  5997  0
1   257  4
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811471.png
early stop counter: 1
val acc:0.9781821966171265, best validation acc: 0.9785014986991882, corresponding to test acc:                         0.9587727785110474 / 0.9781080484390259
after epoch: 4,now: 2024-05-24 15:24:56.436342,epoch time: 0:41:29.154356,used: 2:44:29.701997,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_26_seed_0_20811471
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9824625, 'precision': 0.870504, 'recall': 0.8534566, 'specificity': 0.8534566, 'f1': 0.8617623, 'auroc': 0.985533, 'binary_precision': 0.7508922, 'binary_recall': 0.7151598, 'binary_specificity': 0.9917535, 'binary_f1_score': 0.73259056}
confusion matrix:
       0     1
0  41972   349
1    419  1052
---- Validation: 
scalar performance:
{'acc': 0.98100257, 'precision': 0.88245773, 'recall': 0.8079013, 'specificity': 0.8079013, 'f1': 0.8408215, 'auroc': 0.97884226, 'binary_precision': 0.7782101, 'binary_recall': 0.62208396, 'binary_specificity': 0.9937187, 'binary_f1_score': 0.6914434}
confusion matrix:
       0    1
0  18035  114
1    243  400
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.78845614, 'recall': 0.57079595, 'specificity': 0.57079595, 'f1': 0.6075183, 'auroc': 0.9572068, 'binary_precision': 0.61290324, 'binary_recall': 0.14559387, 'binary_specificity': 0.995998, 'binary_f1_score': 0.23529412}
confusion matrix:
      0   1
0  5973  24
1   223  38
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811471.png
better model found
persisted
after epoch: 5,now: 2024-05-24 16:05:27.727056,epoch time: 0:40:31.290714,used: 3:25:00.992711,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_26_seed_0_20811471
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98266804, 'precision': 0.9449109, 'recall': 0.7693998, 'specificity': 0.7693998, 'f1': 0.83412683, 'auroc': 0.9886168, 'binary_precision': 0.9055745, 'binary_recall': 0.5407609, 'binary_specificity': 0.99803877, 'binary_f1_score': 0.67715865}
confusion matrix:
       0    1
0  42237   83
1    676  796
---- Validation: 
scalar performance:
{'acc': 0.97961897, 'precision': 0.96119547, 'recall': 0.71492827, 'specificity': 0.71492827, 'f1': 0.79039884, 'auroc': 0.9808618, 'binary_precision': 0.9421769, 'binary_recall': 0.43079317, 'binary_specificity': 0.9990633, 'binary_f1_score': 0.5912487}
confusion matrix:
       0    1
0  18132   17
1    366  277
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.8543732, 'recall': 0.50566375, 'specificity': 0.50566375, 'f1': 0.5007502, 'auroc': 0.95170975, 'binary_precision': 0.75, 'binary_recall': 0.011494253, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.022641508}
confusion matrix:
      0  1
0  5996  1
1   258  3
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811471.png
early stop counter: 1
val acc:0.9796189665794373, best validation acc: 0.9810025691986084, corresponding to test acc:                         0.9605305194854736 / 0.9781080484390259
after epoch: 6,now: 2024-05-24 16:46:10.251113,epoch time: 0:40:42.524057,used: 4:05:43.516768,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_26_seed_0_20811471
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9868241, 'precision': 0.938481, 'recall': 0.84662986, 'specificity': 0.84662986, 'f1': 0.88678306, 'auroc': 0.9919569, 'binary_precision': 0.88744587, 'binary_recall': 0.6963315, 'binary_specificity': 0.99692816, 'binary_f1_score': 0.7803578}
confusion matrix:
       0     1
0  42190   130
1    447  1025
---- Validation: 
scalar performance:
{'acc': 0.98440826, 'precision': 0.9260662, 'recall': 0.82091534, 'specificity': 0.82091534, 'f1': 0.86552787, 'auroc': 0.9845869, 'binary_precision': 0.8645833, 'binary_recall': 0.64541215, 'binary_specificity': 0.99641854, 'binary_f1_score': 0.7390917}
confusion matrix:
       0    1
0  18084   65
1    228  415
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.89509434, 'recall': 0.5721299, 'specificity': 0.5721299, 'f1': 0.61431825, 'auroc': 0.9534552, 'binary_precision': 0.82608694, 'binary_recall': 0.14559387, 'binary_specificity': 0.998666, 'binary_f1_score': 0.247557}
confusion matrix:
      0   1
0  5989   8
1   223  38
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811471.png
better model found
persisted
after epoch: 7,now: 2024-05-24 17:27:57.646043,epoch time: 0:41:47.394930,used: 4:47:30.911698,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_26_seed_0_20811471
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98762333, 'precision': 0.93591106, 'recall': 0.86343634, 'specificity': 0.86343634, 'f1': 0.896139, 'auroc': 0.99345994, 'binary_precision': 0.88114756, 'binary_recall': 0.73029894, 'binary_specificity': 0.99657375, 'binary_f1_score': 0.7986627}
confusion matrix:
       0     1
0  42175   145
1    397  1075
---- Validation: 
scalar performance:
{'acc': 0.98435503, 'precision': 0.926635, 'recall': 0.8193877, 'specificity': 0.8193877, 'f1': 0.8647187, 'auroc': 0.98370254, 'binary_precision': 0.8658281, 'binary_recall': 0.64230174, 'binary_specificity': 0.9964736, 'binary_f1_score': 0.7375}
confusion matrix:
       0    1
0  18085   64
1    230  413
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590924, 'precision': 0.9081747, 'recall': 0.5114109, 'specificity': 0.5114109, 'f1': 0.5119374, 'auroc': 0.9552525, 'binary_precision': 0.85714287, 'binary_recall': 0.022988506, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.04477612}
confusion matrix:
      0  1
0  5996  1
1   255  6
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811471.png
early stop counter: 1
val acc:0.9843550324440002, best validation acc: 0.9844082593917847, corresponding to test acc:                         0.963087260723114 / 0.9781080484390259
after epoch: 8,now: 2024-05-24 18:08:20.137121,epoch time: 0:40:22.491078,used: 5:27:53.402776,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_26_seed_0_20811471
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9869154, 'precision': 0.94647235, 'recall': 0.8404478, 'specificity': 0.8404478, 'f1': 0.8857976, 'auroc': 0.9927113, 'binary_precision': 0.90386343, 'binary_recall': 0.68342394, 'binary_specificity': 0.99747163, 'binary_f1_score': 0.7783366}
confusion matrix:
       0     1
0  42213   107
1    466  1006
---- Validation: 
scalar performance:
{'acc': 0.98510003, 'precision': 0.9465333, 'recall': 0.8137729, 'specificity': 0.8137729, 'f1': 0.86772335, 'auroc': 0.98007095, 'binary_precision': 0.90604025, 'binary_recall': 0.62986004, 'binary_specificity': 0.99768585, 'binary_f1_score': 0.74311924}
confusion matrix:
       0    1
0  18107   42
1    238  405
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579738, 'precision': 0.6459533, 'recall': 0.50349796, 'specificity': 0.50349796, 'f1': 0.4967551, 'auroc': 0.9473351, 'binary_precision': 0.33333334, 'binary_recall': 0.007662835, 'binary_specificity': 0.999333, 'binary_f1_score': 0.014981273}
confusion matrix:
      0  1
0  5993  4
1   259  2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811471.png
better model found
persisted
after epoch: 9,now: 2024-05-24 18:49:59.515001,epoch time: 0:41:39.377880,used: 6:09:32.780656,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_26_seed_0_20811471
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9873036, 'precision': 0.890422, 'recall': 0.923597, 'specificity': 0.923597, 'f1': 0.90627456, 'auroc': 0.9935032, 'binary_precision': 0.7858926, 'binary_recall': 0.85529894, 'binary_specificity': 0.9918951, 'binary_f1_score': 0.81912816}
confusion matrix:
       0     1
0  41977   343
1    213  1259
---- Validation: 
scalar performance:
{'acc': 0.98408896, 'precision': 0.87828386, 'recall': 0.88225454, 'specificity': 0.88225454, 'f1': 0.88025784, 'auroc': 0.98050034, 'binary_precision': 0.76461536, 'binary_recall': 0.7729393, 'binary_specificity': 0.99156976, 'binary_f1_score': 0.7687548}
confusion matrix:
       0    1
0  17996  153
1    146  497
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9638862, 'precision': 0.9040078, 'recall': 0.5817085, 'specificity': 0.5817085, 'f1': 0.62856126, 'auroc': 0.9557328, 'binary_precision': 0.84313726, 'binary_recall': 0.16475096, 'binary_specificity': 0.998666, 'binary_f1_score': 0.27564102}
confusion matrix:
      0   1
0  5989   8
1   218  43
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811471.png
early stop counter: 1
val acc:0.9840889573097229, best validation acc: 0.9851000308990479, corresponding to test acc:                         0.9579737782478333 / 0.9781080484390259
after epoch: 10,now: 2024-05-24 19:32:17.907435,epoch time: 0:42:18.392434,used: 6:51:51.173090,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_26_seed_0_20811471
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9871666, 'precision': 0.8812601, 'recall': 0.9399191, 'specificity': 0.9399191, 'f1': 0.908306, 'auroc': 0.99468994, 'binary_precision': 0.7663934, 'binary_recall': 0.8892663, 'binary_specificity': 0.99057186, 'binary_f1_score': 0.82327044}
confusion matrix:
       0     1
0  41921   399
1    163  1309
---- Validation: 
scalar performance:
{'acc': 0.9834504, 'precision': 0.8617487, 'recall': 0.9044256, 'specificity': 0.9044256, 'f1': 0.88178724, 'auroc': 0.9851481, 'binary_precision': 0.7299169, 'binary_recall': 0.81959563, 'binary_specificity': 0.9892556, 'binary_f1_score': 0.7721611}
confusion matrix:
       0    1
0  17954  195
1    116  527
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9592522, 'precision': 0.77238023, 'recall': 0.5389793, 'specificity': 0.5389793, 'f1': 0.5602725, 'auroc': 0.95039654, 'binary_precision': 0.5833333, 'binary_recall': 0.08045977, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.14141415}
confusion matrix:
      0   1
0  5982  15
1   240  21
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811471.png
early stop counter: 2
val acc:0.9834504127502441, best validation acc: 0.9851000308990479, corresponding to test acc:                         0.9579737782478333 / 0.9781080484390259
after epoch: 11,now: 2024-05-24 20:12:45.402263,epoch time: 0:40:27.494828,used: 7:32:18.667918,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_26_seed_0_20811471
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9915053, 'precision': 0.95137596, 'recall': 0.91396797, 'specificity': 0.91396797, 'f1': 0.93180144, 'auroc': 0.9955995, 'binary_precision': 0.90861815, 'binary_recall': 0.8308424, 'binary_specificity': 0.99709356, 'binary_f1_score': 0.8679915}
confusion matrix:
       0     1
0  42197   123
1    249  1223
---- Validation: 
scalar performance:
{'acc': 0.9862707, 'precision': 0.9281875, 'recall': 0.85188174, 'specificity': 0.85188174, 'f1': 0.88601243, 'auroc': 0.97855544, 'binary_precision': 0.8666667, 'binary_recall': 0.7076205, 'binary_specificity': 0.99614304, 'binary_f1_score': 0.7791096}
confusion matrix:
       0    1
0  18079   70
1    188  455
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590924, 'precision': 0.8035006, 'recall': 0.52057254, 'specificity': 0.52057254, 'f1': 0.5291091, 'auroc': 0.9330927, 'binary_precision': 0.64705884, 'binary_recall': 0.042145595, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.07913669}
confusion matrix:
      0   1
0  5991   6
1   250  11
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811471.png
better model found
persisted
after epoch: 12,now: 2024-05-24 20:53:12.667202,epoch time: 0:40:27.264939,used: 8:12:45.932857,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_26_seed_0_20811471
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9898155, 'precision': 0.9445518, 'recall': 0.89243853, 'specificity': 0.89243853, 'f1': 0.916749, 'auroc': 0.9963783, 'binary_precision': 0.89644516, 'binary_recall': 0.7880435, 'binary_specificity': 0.9968336, 'binary_f1_score': 0.8387563}
confusion matrix:
       0     1
0  42186   134
1    312  1160
---- Validation: 
scalar performance:
{'acc': 0.9859515, 'precision': 0.9477341, 'recall': 0.8269646, 'specificity': 0.8269646, 'f1': 0.8772476, 'auroc': 0.9804357, 'binary_precision': 0.9075269, 'binary_recall': 0.6562986, 'binary_specificity': 0.9976307, 'binary_f1_score': 0.7617328}
confusion matrix:
       0    1
0  18106   43
1    221  422
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.8550545, 'recall': 0.522655, 'specificity': 0.522655, 'f1': 0.5329855, 'auroc': 0.9422039, 'binary_precision': 0.75, 'binary_recall': 0.04597701, 'binary_specificity': 0.999333, 'binary_f1_score': 0.0866426}
confusion matrix:
      0   1
0  5993   4
1   249  12
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811471.png
early stop counter: 1
val acc:0.9859514832496643, best validation acc: 0.9862707257270813, corresponding to test acc:                         0.959092378616333 / 0.9781080484390259
after epoch: 13,now: 2024-05-24 21:33:54.063934,epoch time: 0:40:41.396732,used: 8:53:27.329589,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_26_seed_0_20811471
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9915738, 'precision': 0.9436918, 'recall': 0.92416704, 'specificity': 0.92416704, 'f1': 0.9336926, 'auroc': 0.996704, 'binary_precision': 0.8925267, 'binary_recall': 0.8519022, 'binary_specificity': 0.99643195, 'binary_f1_score': 0.8717414}
confusion matrix:
       0     1
0  42169   151
1    218  1254
---- Validation: 
scalar performance:
{'acc': 0.9874947, 'precision': 0.92654455, 'recall': 0.8757671, 'specificity': 0.8757671, 'f1': 0.8994211, 'auroc': 0.9816252, 'binary_precision': 0.86170214, 'binary_recall': 0.755832, 'binary_specificity': 0.99570227, 'binary_f1_score': 0.8053024}
confusion matrix:
       0    1
0  18071   78
1    157  486
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96196866, 'precision': 0.8868393, 'recall': 0.5568876, 'specificity': 0.5568876, 'f1': 0.5909314, 'auroc': 0.9573423, 'binary_precision': 0.8108108, 'binary_recall': 0.11494253, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.20134228}
confusion matrix:
      0   1
0  5990   7
1   231  30
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811471.png
better model found
persisted
after epoch: 14,now: 2024-05-24 22:16:59.023160,epoch time: 0:43:04.959226,used: 9:36:32.288815,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_26_seed_0_20811471
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9907746, 'precision': 0.9138222, 'recall': 0.95224714, 'specificity': 0.95224714, 'f1': 0.9321101, 'auroc': 0.99773335, 'binary_precision': 0.83075017, 'binary_recall': 0.91094494, 'binary_specificity': 0.9935493, 'binary_f1_score': 0.86900127}
confusion matrix:
       0     1
0  42048   273
1    131  1340
---- Validation: 
scalar performance:
{'acc': 0.9852597, 'precision': 0.88273907, 'recall': 0.89936185, 'specificity': 0.89936185, 'f1': 0.89085805, 'auroc': 0.9754103, 'binary_precision': 0.7723214, 'binary_recall': 0.80715394, 'binary_specificity': 0.99156976, 'binary_f1_score': 0.78935355}
confusion matrix:
       0    1
0  17996  153
1    124  519
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96244806, 'precision': 0.8125099, 'recall': 0.6011138, 'specificity': 0.6011138, 'f1': 0.6477819, 'auroc': 0.9595444, 'binary_precision': 0.6585366, 'binary_recall': 0.20689656, 'binary_specificity': 0.995331, 'binary_f1_score': 0.31486884}
confusion matrix:
      0   1
0  5969  28
1   207  54
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811471.png
early stop counter: 1
val acc:0.9852597117424011, best validation acc: 0.987494707107544, corresponding to test acc:                         0.9619686603546143 / 0.9781080484390259
after epoch: 15,now: 2024-05-24 23:01:57.818465,epoch time: 0:44:58.795305,used: 10:21:31.084120,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_26_seed_0_20811471
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99180216, 'precision': 0.9217255, 'recall': 0.95898664, 'specificity': 0.95898664, 'f1': 0.939502, 'auroc': 0.99750686, 'binary_precision': 0.84610593, 'binary_recall': 0.9238095, 'binary_specificity': 0.9941638, 'binary_f1_score': 0.883252}
confusion matrix:
       0     1
0  42075   247
1    112  1358
---- Validation: 
scalar performance:
{'acc': 0.98589826, 'precision': 0.89396524, 'recall': 0.8921919, 'specificity': 0.8921919, 'f1': 0.8930764, 'auroc': 0.979735, 'binary_precision': 0.7953125, 'binary_recall': 0.79160184, 'binary_specificity': 0.992782, 'binary_f1_score': 0.79345286}
confusion matrix:
       0    1
0  18018  131
1    134  509
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96580374, 'precision': 0.8827122, 'recall': 0.6193556, 'specificity': 0.6193556, 'f1': 0.67650634, 'auroc': 0.9490128, 'binary_precision': 0.79746836, 'binary_recall': 0.2413793, 'binary_specificity': 0.997332, 'binary_f1_score': 0.37058824}
confusion matrix:
      0   1
0  5981  16
1   198  63
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811471.png
early stop counter: 2
val acc:0.9858982563018799, best validation acc: 0.987494707107544, corresponding to test acc:                         0.9619686603546143 / 0.9781080484390259
after epoch: 16,now: 2024-05-24 23:45:49.240519,epoch time: 0:43:51.422054,used: 11:05:22.506174,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_26_seed_0_20811471
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9917565, 'precision': 0.9314529, 'recall': 0.9436053, 'specificity': 0.9436053, 'f1': 0.93743783, 'auroc': 0.9974953, 'binary_precision': 0.8666667, 'binary_recall': 0.8919837, 'binary_specificity': 0.99522686, 'binary_f1_score': 0.87914294}
confusion matrix:
       0     1
0  42118   202
1    159  1313
---- Validation: 
scalar performance:
{'acc': 0.9861111, 'precision': 0.9158187, 'recall': 0.86380005, 'specificity': 0.86380005, 'f1': 0.88793415, 'auroc': 0.98120946, 'binary_precision': 0.8410714, 'binary_recall': 0.7325039, 'binary_specificity': 0.99509615, 'binary_f1_score': 0.78304243}
confusion matrix:
       0    1
0  18060   89
1    172  471
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9592522, 'precision': 0.77026147, 'recall': 0.5408116, 'specificity': 0.5408116, 'f1': 0.5631423, 'auroc': 0.94212145, 'binary_precision': 0.57894737, 'binary_recall': 0.08429119, 'binary_specificity': 0.997332, 'binary_f1_score': 0.1471572}
confusion matrix:
      0   1
0  5981  16
1   239  22
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811471.png
early stop counter: 3
val acc:0.9861111044883728, best validation acc: 0.987494707107544, corresponding to test acc:                         0.9619686603546143 / 0.9781080484390259
after epoch: 17,now: 2024-05-25 00:29:31.471819,epoch time: 0:43:42.231300,used: 11:49:04.737474,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_26_seed_0_20811471
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.993629, 'precision': 0.9582244, 'recall': 0.9422791, 'specificity': 0.9422791, 'f1': 0.95009965, 'auroc': 0.99768984, 'binary_precision': 0.92036647, 'binary_recall': 0.88722825, 'binary_specificity': 0.9973299, 'binary_f1_score': 0.9034935}
confusion matrix:
       0     1
0  42207   113
1    166  1306
---- Validation: 
scalar performance:
{'acc': 0.9856854, 'precision': 0.9087963, 'recall': 0.86507976, 'specificity': 0.86507976, 'f1': 0.88560224, 'auroc': 0.981689, 'binary_precision': 0.8269231, 'binary_recall': 0.7356143, 'binary_specificity': 0.99454516, 'binary_f1_score': 0.7786008}
confusion matrix:
       0    1
0  18050   99
1    170  473
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589326, 'precision': 0.7923943, 'recall': 0.51865685, 'specificity': 0.51865685, 'f1': 0.52560186, 'auroc': 0.9549037, 'binary_precision': 0.625, 'binary_recall': 0.038314175, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.07220217}
confusion matrix:
      0   1
0  5991   6
1   251  10
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811471.png
early stop counter: 4
val acc:0.985685408115387, best validation acc: 0.987494707107544, corresponding to test acc:                         0.9619686603546143 / 0.9781080484390259
after epoch: 18,now: 2024-05-25 01:13:06.741148,epoch time: 0:43:35.269329,used: 12:32:40.006803,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_26_seed_0_20811471
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99303526, 'precision': 0.9586036, 'recall': 0.9317628, 'specificity': 0.9317628, 'f1': 0.9447477, 'auroc': 0.9977652, 'binary_precision': 0.9218524, 'binary_recall': 0.8660775, 'binary_specificity': 0.9974481, 'binary_f1_score': 0.893095}
confusion matrix:
       0     1
0  42213   108
1    197  1274
---- Validation: 
scalar performance:
{'acc': 0.98589826, 'precision': 0.9277773, 'recall': 0.84568846, 'specificity': 0.84568846, 'f1': 0.8820397, 'auroc': 0.98172665, 'binary_precision': 0.86627907, 'binary_recall': 0.69517887, 'binary_specificity': 0.9961981, 'binary_f1_score': 0.7713547}
confusion matrix:
       0    1
0  18080   69
1    196  447
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95701504, 'precision': 0.6387253, 'recall': 0.51215935, 'specificity': 0.51215935, 'f1': 0.5137401, 'auroc': 0.9339424, 'binary_precision': 0.3181818, 'binary_recall': 0.026819924, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.049469966}
confusion matrix:
      0   1
0  5982  15
1   254   7
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811471.png
early stop counter: 5
val acc:0.9858982563018799, best validation acc: 0.987494707107544, corresponding to test acc:                         0.9619686603546143 / 0.9781080484390259
after epoch: 19,now: 2024-05-25 01:52:56.585659,epoch time: 0:39:49.844511,used: 13:12:29.851314,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_26_seed_0_20811471
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99399436, 'precision': 0.96924835, 'recall': 0.93623877, 'specificity': 0.93623877, 'f1': 0.9520966, 'auroc': 0.9979551, 'binary_precision': 0.94285715, 'binary_recall': 0.8743206, 'binary_specificity': 0.9981569, 'binary_f1_score': 0.9072965}
confusion matrix:
       0     1
0  42242    78
1    185  1287
---- Validation: 
scalar performance:
{'acc': 0.98781395, 'precision': 0.94876313, 'recall': 0.8571811, 'specificity': 0.8571811, 'f1': 0.8973785, 'auroc': 0.97957706, 'binary_precision': 0.9074803, 'binary_recall': 0.7169518, 'binary_specificity': 0.9974103, 'binary_f1_score': 0.80104256}
confusion matrix:
       0    1
0  18102   47
1    182  461
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964046, 'precision': 0.88281703, 'recall': 0.5909535, 'specificity': 0.5909535, 'f1': 0.6403076, 'auroc': 0.94222045, 'binary_precision': 0.8, 'binary_recall': 0.18390805, 'binary_specificity': 0.997999, 'binary_f1_score': 0.2990654}
confusion matrix:
      0   1
0  5985  12
1   213  48
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811471.png
better model found
persisted
after epoch: 20,now: 2024-05-25 02:32:34.574266,epoch time: 0:39:37.988607,used: 13:52:07.839921,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_26_seed_0_20811471
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99529594, 'precision': 0.9788817, 'recall': 0.9474037, 'specificity': 0.9474037, 'f1': 0.962568, 'auroc': 0.99851, 'binary_precision': 0.9613703, 'binary_recall': 0.8960598, 'binary_specificity': 0.99874765, 'binary_f1_score': 0.9275669}
confusion matrix:
       0     1
0  42267    53
1    153  1319
---- Validation: 
scalar performance:
{'acc': 0.9875479, 'precision': 0.93782437, 'recall': 0.86379385, 'specificity': 0.86379385, 'f1': 0.89712733, 'auroc': 0.9859748, 'binary_precision': 0.8851224, 'binary_recall': 0.7309487, 'binary_specificity': 0.99663895, 'binary_f1_score': 0.8006815}
confusion matrix:
       0    1
0  18088   61
1    173  470
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.82171714, 'recall': 0.5638001, 'specificity': 0.5638001, 'f1': 0.59936976, 'auroc': 0.9536853, 'binary_precision': 0.68, 'binary_recall': 0.1302682, 'binary_specificity': 0.997332, 'binary_f1_score': 0.2186495}
confusion matrix:
      0   1
0  5981  16
1   227  34
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811471.png
early stop counter: 1
val acc:0.9875478744506836, best validation acc: 0.9878139495849609, corresponding to test acc:                         0.9640460014343262 / 0.9781080484390259
after epoch: 21,now: 2024-05-25 03:12:14.646740,epoch time: 0:39:40.072474,used: 14:31:47.912395,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_26_seed_0_20811471
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9963692, 'precision': 0.98006094, 'recall': 0.9633439, 'specificity': 0.9633439, 'f1': 0.9715432, 'auroc': 0.99930274, 'binary_precision': 0.9626234, 'binary_recall': 0.9279402, 'binary_specificity': 0.99874765, 'binary_f1_score': 0.9449637}
confusion matrix:
       0     1
0  42268    53
1    106  1365
---- Validation: 
scalar performance:
{'acc': 0.9886122, 'precision': 0.93581796, 'recall': 0.8845963, 'specificity': 0.8845963, 'f1': 0.9084824, 'auroc': 0.98405516, 'binary_precision': 0.879646, 'binary_recall': 0.7729393, 'binary_specificity': 0.99625325, 'binary_f1_score': 0.82284766}
confusion matrix:
       0    1
0  18081   68
1    146  497
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.8282572, 'recall': 0.5469756, 'specificity': 0.5469756, 'f1': 0.57406783, 'auroc': 0.9397443, 'binary_precision': 0.6944444, 'binary_recall': 0.09578544, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.16835018}
confusion matrix:
      0   1
0  5986  11
1   236  25
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811471.png
better model found
persisted
after epoch: 22,now: 2024-05-25 03:51:55.448805,epoch time: 0:39:40.802065,used: 15:11:28.714460,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_26_seed_0_20811471
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9947479, 'precision': 0.9762938, 'recall': 0.9412187, 'specificity': 0.9412187, 'f1': 0.9580357, 'auroc': 0.9989195, 'binary_precision': 0.95661765, 'binary_recall': 0.8838315, 'binary_specificity': 0.99860585, 'binary_f1_score': 0.9187853}
confusion matrix:
       0     1
0  42261    59
1    171  1301
---- Validation: 
scalar performance:
{'acc': 0.9866965, 'precision': 0.93999696, 'recall': 0.8468518, 'specificity': 0.8468518, 'f1': 0.88749444, 'auroc': 0.9817202, 'binary_precision': 0.89065605, 'binary_recall': 0.6967341, 'binary_specificity': 0.9969695, 'binary_f1_score': 0.78184986}
confusion matrix:
       0    1
0  18094   55
1    195  448
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96772134, 'precision': 0.89700764, 'recall': 0.6423441, 'specificity': 0.6423441, 'f1': 0.70476496, 'auroc': 0.947629, 'binary_precision': 0.82417583, 'binary_recall': 0.28735632, 'binary_specificity': 0.997332, 'binary_f1_score': 0.4261363}
confusion matrix:
      0   1
0  5981  16
1   186  75
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811471.png
early stop counter: 1
val acc:0.9866964817047119, best validation acc: 0.988612174987793, corresponding to test acc:                         0.9605305194854736 / 0.9781080484390259
after epoch: 23,now: 2024-05-25 04:31:33.556135,epoch time: 0:39:38.107330,used: 15:51:06.821790,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_26_seed_0_20811471
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9944739, 'precision': 0.97793883, 'recall': 0.9351754, 'specificity': 0.9351754, 'f1': 0.9554815, 'auroc': 0.9980701, 'binary_precision': 0.96032935, 'binary_recall': 0.87160325, 'binary_specificity': 0.99874765, 'binary_f1_score': 0.9138177}
confusion matrix:
       0     1
0  42267    53
1    189  1283
---- Validation: 
scalar performance:
{'acc': 0.9856854, 'precision': 0.9199178, 'recall': 0.85082865, 'specificity': 0.85082865, 'f1': 0.88203216, 'auroc': 0.98330486, 'binary_precision': 0.85018724, 'binary_recall': 0.7060653, 'binary_specificity': 0.99559206, 'binary_f1_score': 0.7714529}
confusion matrix:
       0    1
0  18069   80
1    189  454
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.88097304, 'recall': 0.54547673, 'specificity': 0.54547673, 'f1': 0.5725356, 'auroc': 0.9400302, 'binary_precision': 0.8, 'binary_recall': 0.09195402, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.16494845}
confusion matrix:
      0   1
0  5991   6
1   237  24
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811471.png
early stop counter: 2
val acc:0.985685408115387, best validation acc: 0.988612174987793, corresponding to test acc:                         0.9605305194854736 / 0.9781080484390259
after epoch: 24,now: 2024-05-25 05:11:05.844322,epoch time: 0:39:32.288187,used: 16:30:39.109977,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_26_seed_0_20811471
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9947936, 'precision': 0.94731945, 'recall': 0.9759954, 'specificity': 0.9759954, 'f1': 0.9611762, 'auroc': 0.99898195, 'binary_precision': 0.89617836, 'binary_recall': 0.9558424, 'binary_specificity': 0.9961484, 'binary_f1_score': 0.9250493}
confusion matrix:
       0     1
0  42157   163
1     65  1407
---- Validation: 
scalar performance:
{'acc': 0.985845, 'precision': 0.8860154, 'recall': 0.9056654, 'specificity': 0.9056654, 'f1': 0.8955749, 'auroc': 0.979284, 'binary_precision': 0.7784343, 'binary_recall': 0.81959563, 'binary_specificity': 0.9917351, 'binary_f1_score': 0.79848486}
confusion matrix:
       0    1
0  17999  150
1    116  527
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.74518466, 'recall': 0.53314877, 'specificity': 0.53314877, 'f1': 0.55042046, 'auroc': 0.9265398, 'binary_precision': 0.5294118, 'binary_recall': 0.06896552, 'binary_specificity': 0.997332, 'binary_f1_score': 0.1220339}
confusion matrix:
      0   1
0  5981  16
1   243  18
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811471.png
early stop counter: 3
val acc:0.9858450293540955, best validation acc: 0.988612174987793, corresponding to test acc:                         0.9605305194854736 / 0.9781080484390259
after epoch: 25,now: 2024-05-25 05:50:46.463612,epoch time: 0:39:40.619290,used: 17:10:19.729267,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_26_seed_0_20811471
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99349195, 'precision': 0.98950493, 'recall': 0.9090944, 'specificity': 0.9090944, 'f1': 0.94544566, 'auroc': 0.9991548, 'binary_precision': 0.98528206, 'binary_recall': 0.8186141, 'binary_specificity': 0.99957466, 'binary_f1_score': 0.8942486}
confusion matrix:
       0     1
0  42302    18
1    267  1205
---- Validation: 
scalar performance:
{'acc': 0.98275864, 'precision': 0.9441257, 'recall': 0.77655804, 'specificity': 0.77655804, 'f1': 0.83949786, 'auroc': 0.98036873, 'binary_precision': 0.90379745, 'binary_recall': 0.55520993, 'binary_specificity': 0.9979062, 'binary_f1_score': 0.68786126}
confusion matrix:
       0    1
0  18111   38
1    286  357
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590924, 'precision': 0.8685657, 'recall': 0.5132432, 'specificity': 0.5132432, 'f1': 0.51547354, 'auroc': 0.93791866, 'binary_precision': 0.7777778, 'binary_recall': 0.026819924, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.051851854}
confusion matrix:
      0  1
0  5995  2
1   254  7
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811471.png
early stop counter: 4
val acc:0.982758641242981, best validation acc: 0.988612174987793, corresponding to test acc:                         0.9605305194854736 / 0.9781080484390259
after epoch: 26,now: 2024-05-25 06:30:18.930129,epoch time: 0:39:32.466517,used: 17:49:52.195784,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_26_seed_0_20811471
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99607235, 'precision': 0.97880137, 'recall': 0.9599362, 'specificity': 0.9599362, 'f1': 0.96916497, 'auroc': 0.9993197, 'binary_precision': 0.96033996, 'binary_recall': 0.9211956, 'binary_specificity': 0.9986768, 'binary_f1_score': 0.9403606}
confusion matrix:
       0     1
0  42264    56
1    116  1356
---- Validation: 
scalar performance:
{'acc': 0.9876011, 'precision': 0.9422445, 'recall': 0.86007106, 'specificity': 0.86007106, 'f1': 0.89662933, 'auroc': 0.98300207, 'binary_precision': 0.8942308, 'binary_recall': 0.7231726, 'binary_specificity': 0.9969695, 'binary_f1_score': 0.7996561}
confusion matrix:
       0    1
0  18094   55
1    178  465
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9643656, 'precision': 0.8729046, 'recall': 0.60028195, 'specificity': 0.60028195, 'f1': 0.6519451, 'auroc': 0.95539176, 'binary_precision': 0.7794118, 'binary_recall': 0.20306513, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.32218844}
confusion matrix:
      0   1
0  5982  15
1   208  53
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811471.png
early stop counter: 5
val acc:0.987601101398468, best validation acc: 0.988612174987793, corresponding to test acc:                         0.9605305194854736 / 0.9781080484390259
after epoch: 27,now: 2024-05-25 07:09:58.780249,epoch time: 0:39:39.850120,used: 18:29:32.045904,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_26_seed_0_20811471
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99538726, 'precision': 0.9702896, 'recall': 0.9579425, 'specificity': 0.9579425, 'f1': 0.9640277, 'auroc': 0.9991025, 'binary_precision': 0.9434357, 'binary_recall': 0.91779894, 'binary_specificity': 0.99808604, 'binary_f1_score': 0.9304408}
confusion matrix:
       0     1
0  42239    81
1    121  1351
---- Validation: 
scalar performance:
{'acc': 0.9859515, 'precision': 0.91530925, 'recall': 0.86146724, 'specificity': 0.86146724, 'f1': 0.8863721, 'auroc': 0.9814999, 'binary_precision': 0.84021544, 'binary_recall': 0.7278383, 'binary_specificity': 0.99509615, 'binary_f1_score': 0.78000003}
confusion matrix:
       0    1
0  18060   89
1    175  468
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9603707, 'precision': 0.83564806, 'recall': 0.54139525, 'specificity': 0.54139525, 'f1': 0.5651985, 'auroc': 0.93893015, 'binary_precision': 0.7096774, 'binary_recall': 0.08429119, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.15068494}
confusion matrix:
      0   1
0  5988   9
1   239  22
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811471.png
early stop counter: 6
val acc:0.9859514832496643, best validation acc: 0.988612174987793, corresponding to test acc:                         0.9605305194854736 / 0.9781080484390259
after epoch: 28,now: 2024-05-25 07:49:39.746032,epoch time: 0:39:40.965783,used: 19:09:13.011687,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_26_seed_0_20811471
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99700856, 'precision': 0.9832507, 'recall': 0.97023654, 'specificity': 0.97023654, 'f1': 0.9766481, 'auroc': 0.99946177, 'binary_precision': 0.9685315, 'binary_recall': 0.94153637, 'binary_specificity': 0.9989367, 'binary_f1_score': 0.95484316}
confusion matrix:
       0     1
0  42276    45
1     86  1385
---- Validation: 
scalar performance:
{'acc': 0.9874415, 'precision': 0.92639446, 'recall': 0.8749895, 'specificity': 0.8749895, 'f1': 0.89891213, 'auroc': 0.97961473, 'binary_precision': 0.86145645, 'binary_recall': 0.7542768, 'binary_specificity': 0.99570227, 'binary_f1_score': 0.80431175}
confusion matrix:
       0    1
0  18071   78
1    158  485
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.78634953, 'recall': 0.5409784, 'specificity': 0.5409784, 'f1': 0.56372136, 'auroc': 0.939003, 'binary_precision': 0.6111111, 'binary_recall': 0.08429119, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.14814816}
confusion matrix:
      0   1
0  5983  14
1   239  22
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811471.png
early stop counter: 7
val acc:0.9874414801597595, best validation acc: 0.988612174987793, corresponding to test acc:                         0.9605305194854736 / 0.9781080484390259
after epoch: 29,now: 2024-05-25 08:29:25.028838,epoch time: 0:39:45.282806,used: 19:48:58.294493,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_26_seed_0_20811471
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.996118, 'precision': 0.96981543, 'recall': 0.9704319, 'specificity': 0.9704319, 'f1': 0.9701235, 'auroc': 0.99944365, 'binary_precision': 0.94161576, 'binary_recall': 0.942896, 'binary_specificity': 0.9979679, 'binary_f1_score': 0.9422555}
confusion matrix:
       0     1
0  42235    86
1     84  1387
---- Validation: 
scalar performance:
{'acc': 0.9882397, 'precision': 0.9316789, 'recall': 0.88290334, 'specificity': 0.88290334, 'f1': 0.9057151, 'auroc': 0.9806732, 'binary_precision': 0.87147886, 'binary_recall': 0.7698289, 'binary_specificity': 0.99597776, 'binary_f1_score': 0.81750613}
confusion matrix:
       0    1
0  18076   73
1    148  495
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.957814, 'precision': 0.69025064, 'recall': 0.5144085, 'specificity': 0.5144085, 'f1': 0.5177836, 'auroc': 0.92153335, 'binary_precision': 0.42105263, 'binary_recall': 0.03065134, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.057142857}
confusion matrix:
      0   1
0  5986  11
1   253   8
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811471.png
early stop counter: 8
val acc:0.9882397055625916, best validation acc: 0.988612174987793, corresponding to test acc:                         0.9605305194854736 / 0.9781080484390259
after epoch: 30,now: 2024-05-25 09:09:40.535299,epoch time: 0:40:15.506461,used: 20:29:13.800954,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_40_26_seed_0_20811471
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 20:29:13.800954 at 2024-05-25 09:09:40.535299
persisted model performance metric: 

scalar performance:
{'acc': 0.959412, 'precision': 0.7757369, 'recall': 0.5427273, 'specificity': 0.5427273, 'f1': 0.5662705, 'auroc': 0.93901247, 'binary_precision': 0.5897436, 'binary_recall': 0.08812261, 'binary_specificity': 0.997332, 'binary_f1_score': 0.15333334}
confusion matrix:
      0   1
0  5981  16
1   238  23
oracle model performance metric: 

scalar performance:
{'acc': 0.9782678, 'precision': 0.8556542, 'recall': 0.884218, 'specificity': 0.884218, 'f1': 0.86932003, 'auroc': 0.94632584, 'binary_precision': 0.7208481, 'binary_recall': 0.7816092, 'binary_specificity': 0.9868267, 'binary_f1_score': 0.75}
confusion matrix:
      0    1
0  5918   79
1    57  204
results aggregation path: zoutput/benchmarks/CAMELYON_center0_vit_irm/rule_results/4.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_vit_irm/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_vit_irm/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1661 MiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |   1655 MiB |  15779 MiB |    977 TiB |    977 TiB |
|       from small pool |      6 MiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1661 MiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |   1655 MiB |  15779 MiB |    977 TiB |    977 TiB |
|       from small pool |      6 MiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1653 MiB |  15770 MiB |    987 TiB |    987 TiB |
|       from large pool |   1647 MiB |  15745 MiB |    974 TiB |    974 TiB |
|       from small pool |      5 MiB |     25 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  16730 MiB |  16730 MiB |  16730 MiB |      0 B   |
|       from large pool |  16702 MiB |  16702 MiB |  16702 MiB |      0 B   |
|       from small pool |     28 MiB |     28 MiB |     28 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 430238 KiB |    863 MiB | 413550 GiB | 413550 GiB |
|       from large pool | 410304 KiB |    862 MiB | 400660 GiB | 400660 GiB |
|       from small pool |  19934 KiB |     21 MiB |  12889 GiB |  12889 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3366    |    6357    |  152169 K  |  152166 K  |
|       from large pool |     247    |     989    |   62327 K  |   62326 K  |
|       from small pool |    3119    |    6108    |   89842 K  |   89839 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3366    |    6357    |  152169 K  |  152166 K  |
|       from large pool |     247    |     989    |   62327 K  |   62326 K  |
|       from small pool |    3119    |    6108    |   89842 K  |   89839 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     621    |     621    |     621    |       0    |
|       from large pool |     607    |     607    |     607    |       0    |
|       from small pool |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     147    |    2872    |   90210 K  |   90210 K  |
|       from large pool |     112    |     516    |   47275 K  |   47275 K  |
|       from small pool |      35    |    2760    |   42935 K  |   42935 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |  16640 KiB |  15779 MiB |    977 TiB |    977 TiB |
|       from small pool |      0 KiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |  16640 KiB |  15779 MiB |    977 TiB |    977 TiB |
|       from small pool |      0 KiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15770 MiB |    987 TiB |    987 TiB |
|       from large pool |  16640 KiB |  15745 MiB |    974 TiB |    974 TiB |
|       from small pool |      0 KiB |     25 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2082 MiB |  16730 MiB |  16730 MiB |  14648 MiB |
|       from large pool |   2056 MiB |  16702 MiB |  16702 MiB |  14646 MiB |
|       from small pool |     26 MiB |     28 MiB |     28 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    863 MiB | 413551 GiB | 413551 GiB |
|       from large pool |  24320 KiB |    862 MiB | 400661 GiB | 400661 GiB |
|       from small pool |      0 KiB |     24 MiB |  12889 GiB |  12889 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6357    |  152169 K  |  152169 K  |
|       from large pool |       2    |     989    |   62327 K  |   62327 K  |
|       from small pool |       0    |    6108    |   89842 K  |   89842 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6357    |  152169 K  |  152169 K  |
|       from large pool |       2    |     989    |   62327 K  |   62327 K  |
|       from small pool |       0    |    6108    |   89842 K  |   89842 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     115    |     621    |     621    |     506    |
|       from large pool |     102    |     607    |     607    |     505    |
|       from small pool |      13    |      14    |      14    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    2872    |   90211 K  |   90211 K  |
|       from large pool |       2    |     516    |   47275 K  |   47275 K  |
|       from small pool |       0    |    2760    |   42936 K  |   42936 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat May 25 09:12:41 2024]
Finished job 0.
1 of 1 steps (100%) done
