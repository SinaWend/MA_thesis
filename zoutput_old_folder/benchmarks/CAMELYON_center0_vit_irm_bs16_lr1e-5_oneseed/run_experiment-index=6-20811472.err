Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Fri May 24 12:30:37 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_vit_irm/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_vit_irm/rule_results/6.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=6
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_41_15_seed_0_20811472

 Experiment start at: 2024-05-24 12:41:16.010229
before training, model accuracy: 0.955097496509552
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.969789, 'precision': 0.7644753, 'recall': 0.82622993, 'specificity': 0.82622993, 'f1': 0.79175764, 'auroc': 0.965729, 'binary_precision': 0.54043716, 'binary_recall': 0.67233175, 'binary_specificity': 0.98012805, 'binary_f1_score': 0.5992124}
confusion matrix:
       0    1
0  41480  841
1    482  989
---- Validation: 
scalar performance:
{'acc': 0.969668, 'precision': 0.7688649, 'recall': 0.7937826, 'specificity': 0.7937826, 'f1': 0.7807106, 'auroc': 0.9662179, 'binary_precision': 0.5517731, 'binary_recall': 0.60497665, 'binary_specificity': 0.9825886, 'binary_f1_score': 0.57715136}
confusion matrix:
       0    1
0  17833  316
1    254  389
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9753915, 'precision': 0.8913454, 'recall': 0.7691125, 'specificity': 0.7691125, 'f1': 0.8178257, 'auroc': 0.9511434, 'binary_precision': 0.80225986, 'binary_recall': 0.5440613, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.64840186}
confusion matrix:
      0    1
0  5962   35
1   119  142
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811472.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-24 13:21:15.894892,epoch time: 0:39:59.884663,used: 0:39:59.884663,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_41_15_seed_0_20811472
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9773246, 'precision': 0.8357301, 'recall': 0.7956792, 'specificity': 0.7956792, 'f1': 0.8143205, 'auroc': 0.9768114, 'binary_precision': 0.6852713, 'binary_recall': 0.60095173, 'binary_specificity': 0.99040663, 'binary_f1_score': 0.6403477}
confusion matrix:
       0    1
0  41915  406
1    587  884
---- Validation: 
scalar performance:
{'acc': 0.97631973, 'precision': 0.8499357, 'recall': 0.7507229, 'specificity': 0.7507229, 'f1': 0.7914448, 'auroc': 0.97355473, 'binary_precision': 0.71710527, 'binary_recall': 0.5085537, 'binary_specificity': 0.99289215, 'binary_f1_score': 0.59508646}
confusion matrix:
       0    1
0  18020  129
1    316  327
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96628314, 'precision': 0.9417151, 'recall': 0.6049471, 'specificity': 0.6049471, 'f1': 0.6626885, 'auroc': 0.9586078, 'binary_precision': 0.9166667, 'binary_recall': 0.21072797, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.34267914}
confusion matrix:
      0   1
0  5992   5
1   206  55
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811472.png
better model found
persisted
after epoch: 2,now: 2024-05-24 14:01:48.569512,epoch time: 0:40:32.674620,used: 1:20:32.559283,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_41_15_seed_0_20811472
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9756348, 'precision': 0.88690877, 'recall': 0.6832542, 'specificity': 0.6832542, 'f1': 0.74619126, 'auroc': 0.98107266, 'binary_precision': 0.79532164, 'binary_recall': 0.36981645, 'binary_specificity': 0.99669194, 'binary_f1_score': 0.5048724}
confusion matrix:
       0    1
0  42181  140
1    927  544
---- Validation: 
scalar performance:
{'acc': 0.97349936, 'precision': 0.85830593, 'recall': 0.6720071, 'specificity': 0.6720071, 'f1': 0.72999024, 'auroc': 0.97527343, 'binary_precision': 0.7392739, 'binary_recall': 0.34836704, 'binary_specificity': 0.99564713, 'binary_f1_score': 0.47357288}
confusion matrix:
       0    1
0  18070   79
1    419  224
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96356666, 'precision': 0.8941233, 'recall': 0.5797094, 'specificity': 0.5797094, 'f1': 0.6252742, 'auroc': 0.95708907, 'binary_precision': 0.8235294, 'binary_recall': 0.16091955, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.26923078}
confusion matrix:
      0   1
0  5988   9
1   219  42
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811472.png
early stop counter: 1
val acc:0.9734993577003479, best validation acc: 0.9763197302818298, corresponding to test acc:                         0.9662831425666809 / 0.9753915071487427
after epoch: 3,now: 2024-05-24 14:42:58.536580,epoch time: 0:41:09.967068,used: 2:01:42.526351,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_41_15_seed_0_20811472
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9819602, 'precision': 0.89149547, 'recall': 0.8087045, 'specificity': 0.8087045, 'f1': 0.8448172, 'auroc': 0.98436, 'binary_precision': 0.7960069, 'binary_recall': 0.62296194, 'binary_specificity': 0.99444705, 'binary_f1_score': 0.6989329}
confusion matrix:
       0    1
0  42085  235
1    555  917
---- Validation: 
scalar performance:
{'acc': 0.9819604, 'precision': 0.9284688, 'recall': 0.7753948, 'specificity': 0.7753948, 'f1': 0.83408535, 'auroc': 0.97869444, 'binary_precision': 0.872549, 'binary_recall': 0.55365473, 'binary_specificity': 0.9971348, 'binary_f1_score': 0.67745}
confusion matrix:
       0    1
0  18097   52
1    287  356
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96164906, 'precision': 0.8812791, 'recall': 0.55305624, 'specificity': 0.55305624, 'f1': 0.5847746, 'auroc': 0.9453579, 'binary_precision': 0.8, 'binary_recall': 0.107279696, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.1891892}
confusion matrix:
      0   1
0  5990   7
1   233  28
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811472.png
better model found
persisted
after epoch: 4,now: 2024-05-24 15:24:57.136493,epoch time: 0:41:58.599913,used: 2:43:41.126264,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_41_15_seed_0_20811472
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98408383, 'precision': 0.9074644, 'recall': 0.8307862, 'specificity': 0.8307862, 'f1': 0.86483204, 'auroc': 0.98713577, 'binary_precision': 0.82645327, 'binary_recall': 0.6664402, 'binary_specificity': 0.9951323, 'binary_f1_score': 0.73787135}
confusion matrix:
       0    1
0  42114  206
1    491  981
---- Validation: 
scalar performance:
{'acc': 0.9815347, 'precision': 0.8965908, 'recall': 0.79992616, 'specificity': 0.79992616, 'f1': 0.84101903, 'auroc': 0.98070633, 'binary_precision': 0.8070539, 'binary_recall': 0.60497665, 'binary_specificity': 0.9948757, 'binary_f1_score': 0.69155556}
confusion matrix:
       0    1
0  18056   93
1    254  389
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645254, 'precision': 0.8212303, 'recall': 0.642509, 'specificity': 0.642509, 'f1': 0.6940667, 'auroc': 0.9539764, 'binary_precision': 0.67256635, 'binary_recall': 0.29118773, 'binary_specificity': 0.99383026, 'binary_f1_score': 0.4064171}
confusion matrix:
      0   1
0  5960  37
1   185  76
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811472.png
early stop counter: 1
val acc:0.9815347194671631, best validation acc: 0.9819604158401489, corresponding to test acc:                         0.9616490602493286 / 0.9753915071487427
after epoch: 5,now: 2024-05-24 16:05:05.725419,epoch time: 0:40:08.588926,used: 3:23:49.715190,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_41_15_seed_0_20811472
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9797908, 'precision': 0.82266176, 'recall': 0.92364424, 'specificity': 0.92364424, 'f1': 0.8656203, 'auroc': 0.9895412, 'binary_precision': 0.6501279, 'binary_recall': 0.86345106, 'binary_specificity': 0.9838374, 'binary_f1_score': 0.7417567}
confusion matrix:
       0     1
0  41636   684
1    201  1271
---- Validation: 
scalar performance:
{'acc': 0.98094934, 'precision': 0.8348367, 'recall': 0.920382, 'specificity': 0.920382, 'f1': 0.8722742, 'auroc': 0.9813143, 'binary_precision': 0.67484665, 'binary_recall': 0.85536546, 'binary_specificity': 0.98539865, 'binary_f1_score': 0.7544582}
confusion matrix:
       0    1
0  17884  265
1     93  550
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.965644, 'precision': 0.83614737, 'recall': 0.650422, 'specificity': 0.650422, 'f1': 0.70447904, 'auroc': 0.9527122, 'binary_precision': 0.7017544, 'binary_recall': 0.3065134, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.42666668}
confusion matrix:
      0   1
0  5963  34
1   181  80
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811472.png
early stop counter: 2
val acc:0.980949342250824, best validation acc: 0.9819604158401489, corresponding to test acc:                         0.9616490602493286 / 0.9753915071487427
after epoch: 6,now: 2024-05-24 16:46:08.577159,epoch time: 0:41:02.851740,used: 4:04:52.566930,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_41_15_seed_0_20811472
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9857737, 'precision': 0.8745032, 'recall': 0.92313325, 'specificity': 0.92313325, 'f1': 0.8972019, 'auroc': 0.9908385, 'binary_precision': 0.7540395, 'binary_recall': 0.85597825, 'binary_specificity': 0.99028826, 'binary_f1_score': 0.8017817}
confusion matrix:
       0     1
0  41909   411
1    212  1260
---- Validation: 
scalar performance:
{'acc': 0.9837697, 'precision': 0.86697066, 'recall': 0.8993405, 'specificity': 0.8993405, 'f1': 0.8824089, 'auroc': 0.9791609, 'binary_precision': 0.7407407, 'binary_recall': 0.8087092, 'binary_specificity': 0.9899719, 'binary_f1_score': 0.7732342}
confusion matrix:
       0    1
0  17967  182
1    123  520
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96196866, 'precision': 0.8330575, 'recall': 0.575211, 'specificity': 0.575211, 'f1': 0.61603045, 'auroc': 0.9469548, 'binary_precision': 0.7017544, 'binary_recall': 0.1532567, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.2515723}
confusion matrix:
      0   1
0  5980  17
1   221  40
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811472.png
better model found
persisted
after epoch: 7,now: 2024-05-24 17:27:57.859376,epoch time: 0:41:49.282217,used: 4:46:41.849147,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_41_15_seed_0_20811472
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98686975, 'precision': 0.9034892, 'recall': 0.8915702, 'specificity': 0.8915702, 'f1': 0.8974329, 'auroc': 0.9927447, 'binary_precision': 0.8142957, 'binary_recall': 0.7894022, 'binary_specificity': 0.9937382, 'binary_f1_score': 0.80165577}
confusion matrix:
       0     1
0  42055   265
1    310  1162
---- Validation: 
scalar performance:
{'acc': 0.985845, 'precision': 0.90987456, 'recall': 0.8666625, 'specificity': 0.8666625, 'f1': 0.8869679, 'auroc': 0.9831687, 'binary_precision': 0.8289703, 'binary_recall': 0.7387247, 'binary_specificity': 0.99460024, 'binary_f1_score': 0.78125}
confusion matrix:
       0    1
0  18051   98
1    168  475
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.7886378, 'recall': 0.5447264, 'specificity': 0.5447264, 'f1': 0.5696857, 'auroc': 0.945233, 'binary_precision': 0.61538464, 'binary_recall': 0.09195402, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.16}
confusion matrix:
      0   1
0  5982  15
1   237  24
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811472.png
better model found
persisted
after epoch: 8,now: 2024-05-24 18:08:01.587171,epoch time: 0:40:03.727795,used: 5:26:45.576942,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_41_15_seed_0_20811472
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98143494, 'precision': 0.83710074, 'recall': 0.91662633, 'specificity': 0.91662633, 'f1': 0.87225556, 'auroc': 0.99090403, 'binary_precision': 0.67956406, 'binary_recall': 0.84714675, 'binary_specificity': 0.98610586, 'binary_f1_score': 0.7541579}
confusion matrix:
       0     1
0  41732   588
1    225  1247
---- Validation: 
scalar performance:
{'acc': 0.98217326, 'precision': 0.85204685, 'recall': 0.89776397, 'specificity': 0.89776397, 'f1': 0.87337863, 'auroc': 0.98030376, 'binary_precision': 0.7109589, 'binary_recall': 0.80715394, 'binary_specificity': 0.988374, 'binary_f1_score': 0.7560087}
confusion matrix:
       0    1
0  17938  211
1    124  519
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96276766, 'precision': 0.8573444, 'recall': 0.57929254, 'specificity': 0.57929254, 'f1': 0.62294215, 'auroc': 0.9437014, 'binary_precision': 0.75, 'binary_recall': 0.16091955, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.26498425}
confusion matrix:
      0   1
0  5983  14
1   219  42
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811472.png
early stop counter: 1
val acc:0.9821732640266418, best validation acc: 0.9858450293540955, corresponding to test acc:                         0.9597315192222595 / 0.9753915071487427
after epoch: 9,now: 2024-05-24 18:49:56.996932,epoch time: 0:41:55.409761,used: 6:08:40.986703,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_41_15_seed_0_20811472
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98913044, 'precision': 0.93886566, 'recall': 0.8868384, 'specificity': 0.8868384, 'f1': 0.911087, 'auroc': 0.99445844, 'binary_precision': 0.88544893, 'binary_recall': 0.77717394, 'binary_specificity': 0.9965028, 'binary_f1_score': 0.82778585}
confusion matrix:
       0     1
0  42172   148
1    328  1144
---- Validation: 
scalar performance:
{'acc': 0.9866965, 'precision': 0.9327953, 'recall': 0.85435236, 'specificity': 0.85435236, 'f1': 0.8893635, 'auroc': 0.98325634, 'binary_precision': 0.87571704, 'binary_recall': 0.7122862, 'binary_specificity': 0.99641854, 'binary_f1_score': 0.7855918}
confusion matrix:
       0    1
0  18084   65
1    185  458
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9592522, 'precision': 0.77238023, 'recall': 0.5389793, 'specificity': 0.5389793, 'f1': 0.5602725, 'auroc': 0.9507768, 'binary_precision': 0.5833333, 'binary_recall': 0.08045977, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.14141415}
confusion matrix:
      0   1
0  5982  15
1   240  21
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811472.png
better model found
persisted
after epoch: 10,now: 2024-05-24 19:32:18.649479,epoch time: 0:42:21.652547,used: 6:51:02.639250,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_41_15_seed_0_20811472
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99008954, 'precision': 0.9267448, 'recall': 0.9194648, 'specificity': 0.9194648, 'f1': 0.92307097, 'auroc': 0.99440664, 'binary_precision': 0.8589212, 'binary_recall': 0.84375, 'binary_specificity': 0.9951796, 'binary_f1_score': 0.851268}
confusion matrix:
       0     1
0  42116   204
1    230  1242
---- Validation: 
scalar performance:
{'acc': 0.9865368, 'precision': 0.9132149, 'recall': 0.8752712, 'specificity': 0.8752712, 'f1': 0.89325553, 'auroc': 0.9824416, 'binary_precision': 0.83505154, 'binary_recall': 0.755832, 'binary_specificity': 0.99471045, 'binary_f1_score': 0.7934694}
confusion matrix:
       0    1
0  18053   96
1    157  486
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96244806, 'precision': 0.8483352, 'recall': 0.57729346, 'specificity': 0.57729346, 'f1': 0.6197056, 'auroc': 0.9522215, 'binary_precision': 0.73214287, 'binary_recall': 0.15708812, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.25867507}
confusion matrix:
      0   1
0  5982  15
1   220  41
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811472.png
early stop counter: 1
val acc:0.9865368008613586, best validation acc: 0.9866964817047119, corresponding to test acc:                         0.9592521786689758 / 0.9753915071487427
after epoch: 11,now: 2024-05-24 20:11:35.732118,epoch time: 0:39:17.082639,used: 7:30:19.721889,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_41_15_seed_0_20811472
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9905462, 'precision': 0.9562411, 'recall': 0.8924888, 'specificity': 0.8924888, 'f1': 0.9217918, 'auroc': 0.99618053, 'binary_precision': 0.9198413, 'binary_recall': 0.7873641, 'binary_specificity': 0.99761343, 'binary_f1_score': 0.84846264}
confusion matrix:
       0     1
0  42219   101
1    313  1159
---- Validation: 
scalar performance:
{'acc': 0.9852065, 'precision': 0.91650635, 'recall': 0.8460804, 'specificity': 0.8460804, 'f1': 0.8777837, 'auroc': 0.985593, 'binary_precision': 0.8436912, 'binary_recall': 0.6967341, 'binary_specificity': 0.9954268, 'binary_f1_score': 0.7632027}
confusion matrix:
       0    1
0  18066   83
1    195  448
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.7729066, 'recall': 0.5519723, 'specificity': 0.5519723, 'f1': 0.580252, 'auroc': 0.9410428, 'binary_precision': 0.5833333, 'binary_recall': 0.107279696, 'binary_specificity': 0.996665, 'binary_f1_score': 0.18122977}
confusion matrix:
      0   1
0  5977  20
1   233  28
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811472.png
early stop counter: 2
val acc:0.9852064847946167, best validation acc: 0.9866964817047119, corresponding to test acc:                         0.9592521786689758 / 0.9753915071487427
after epoch: 12,now: 2024-05-24 20:51:51.748228,epoch time: 0:40:16.016110,used: 8:10:35.737999,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_41_15_seed_0_20811472
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9906147, 'precision': 0.931221, 'recall': 0.9230151, 'specificity': 0.9230151, 'f1': 0.9270755, 'auroc': 0.9956639, 'binary_precision': 0.86763686, 'binary_recall': 0.8505435, 'binary_specificity': 0.9954868, 'binary_f1_score': 0.85900515}
confusion matrix:
       0     1
0  42129   191
1    220  1252
---- Validation: 
scalar performance:
{'acc': 0.9872818, 'precision': 0.90979886, 'recall': 0.89440835, 'specificity': 0.89440835, 'f1': 0.90194404, 'auroc': 0.9842971, 'binary_precision': 0.82686085, 'binary_recall': 0.7947123, 'binary_specificity': 0.9941044, 'binary_f1_score': 0.81046784}
confusion matrix:
       0    1
0  18042  107
1    132  511
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.80155605, 'recall': 0.55980194, 'specificity': 0.55980194, 'f1': 0.59277505, 'auroc': 0.94531524, 'binary_precision': 0.64, 'binary_recall': 0.12260536, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.20578776}
confusion matrix:
      0   1
0  5979  18
1   229  32
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811472.png
better model found
persisted
after epoch: 13,now: 2024-05-24 21:33:04.119248,epoch time: 0:41:12.371020,used: 8:51:48.109019,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_41_15_seed_0_20811472
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9926699, 'precision': 0.9459952, 'recall': 0.9404322, 'specificity': 0.9404322, 'f1': 0.94319487, 'auroc': 0.997815, 'binary_precision': 0.8960055, 'binary_recall': 0.8844324, 'binary_specificity': 0.996432, 'binary_f1_score': 0.8901813}
confusion matrix:
       0     1
0  42170   151
1    170  1301
---- Validation: 
scalar performance:
{'acc': 0.9875479, 'precision': 0.92020833, 'recall': 0.8847953, 'specificity': 0.8847953, 'f1': 0.9016596, 'auroc': 0.98385185, 'binary_precision': 0.8483816, 'binary_recall': 0.7744945, 'binary_specificity': 0.99509615, 'binary_f1_score': 0.80975604}
confusion matrix:
       0    1
0  18060   89
1    145  498
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96356666, 'precision': 0.84930694, 'recall': 0.5980327, 'specificity': 0.5980327, 'f1': 0.64726996, 'auroc': 0.9471284, 'binary_precision': 0.73239434, 'binary_recall': 0.19923371, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.313253}
confusion matrix:
      0   1
0  5978  19
1   209  52
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811472.png
better model found
persisted
after epoch: 14,now: 2024-05-24 22:17:00.229637,epoch time: 0:43:56.110389,used: 9:35:44.219408,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_41_15_seed_0_20811472
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99011236, 'precision': 0.9011532, 'recall': 0.9617007, 'specificity': 0.9617007, 'f1': 0.9291172, 'auroc': 0.99706995, 'binary_precision': 0.80470586, 'binary_recall': 0.93124574, 'binary_specificity': 0.99215555, 'binary_f1_score': 0.8633638}
confusion matrix:
       0     1
0  41991   332
1    101  1368
---- Validation: 
scalar performance:
{'acc': 0.98541933, 'precision': 0.8844713, 'recall': 0.8994445, 'specificity': 0.8994445, 'f1': 0.8918023, 'auroc': 0.9802929, 'binary_precision': 0.77578473, 'binary_recall': 0.80715394, 'binary_specificity': 0.9917351, 'binary_f1_score': 0.79115856}
confusion matrix:
       0    1
0  17999  150
1    124  519
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.957814, 'precision': 0.72898686, 'recall': 0.6261809, 'specificity': 0.6261809, 'f1': 0.66074526, 'auroc': 0.9329884, 'binary_precision': 0.4893617, 'binary_recall': 0.26436782, 'binary_specificity': 0.987994, 'binary_f1_score': 0.34328356}
confusion matrix:
      0   1
0  5925  72
1   192  69
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811472.png
early stop counter: 1
val acc:0.9854193329811096, best validation acc: 0.9875478744506836, corresponding to test acc:                         0.9635666608810425 / 0.9753915071487427
after epoch: 15,now: 2024-05-24 23:01:57.150777,epoch time: 0:44:56.921140,used: 10:20:41.140548,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_41_15_seed_0_20811472
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.98924464, 'precision': 0.89600515, 'recall': 0.9541086, 'specificity': 0.9541086, 'f1': 0.92289656, 'auroc': 0.9970856, 'binary_precision': 0.79493225, 'binary_recall': 0.9164402, 'binary_specificity': 0.99177694, 'binary_f1_score': 0.8513727}
confusion matrix:
       0     1
0  41972   348
1    123  1349
---- Validation: 
scalar performance:
{'acc': 0.9852597, 'precision': 0.8819878, 'recall': 0.900862, 'specificity': 0.900862, 'f1': 0.8911771, 'auroc': 0.9795395, 'binary_precision': 0.77071005, 'binary_recall': 0.8102644, 'binary_specificity': 0.9914596, 'binary_f1_score': 0.78999245}
confusion matrix:
       0    1
0  17994  155
1    122  521
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614893, 'precision': 0.80397546, 'recall': 0.58412254, 'specificity': 0.58412254, 'f1': 0.62606245, 'auroc': 0.9237298, 'binary_precision': 0.64285713, 'binary_recall': 0.1724138, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.27190334}
confusion matrix:
      0   1
0  5972  25
1   216  45
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811472.png
early stop counter: 2
val acc:0.9852597117424011, best validation acc: 0.9875478744506836, corresponding to test acc:                         0.9635666608810425 / 0.9753915071487427
after epoch: 16,now: 2024-05-24 23:45:47.519307,epoch time: 0:43:50.368530,used: 11:04:31.509078,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_41_15_seed_0_20811472
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9893816, 'precision': 0.9065594, 'recall': 0.9371308, 'specificity': 0.9371308, 'f1': 0.9212441, 'auroc': 0.99684274, 'binary_precision': 0.8172653, 'binary_recall': 0.8811141, 'binary_specificity': 0.99314743, 'binary_f1_score': 0.84798956}
confusion matrix:
       0     1
0  42030   290
1    175  1297
---- Validation: 
scalar performance:
{'acc': 0.9849404, 'precision': 0.8905118, 'recall': 0.87819505, 'specificity': 0.87819505, 'f1': 0.8842463, 'auroc': 0.9812163, 'binary_precision': 0.7893891, 'binary_recall': 0.7636081, 'binary_specificity': 0.992782, 'binary_f1_score': 0.77628464}
confusion matrix:
       0    1
0  18018  131
1    152  491
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96228826, 'precision': 0.8545854, 'recall': 0.57171303, 'specificity': 0.57171303, 'f1': 0.61212593, 'auroc': 0.93321913, 'binary_precision': 0.74509805, 'binary_recall': 0.14559387, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.24358973}
confusion matrix:
      0   1
0  5984  13
1   223  38
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811472.png
early stop counter: 3
val acc:0.9849404096603394, best validation acc: 0.9875478744506836, corresponding to test acc:                         0.9635666608810425 / 0.9753915071487427
after epoch: 17,now: 2024-05-25 00:29:31.484056,epoch time: 0:43:43.964749,used: 11:48:15.473827,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_41_15_seed_0_20811472
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99123126, 'precision': 0.9603745, 'recall': 0.8996608, 'specificity': 0.8996608, 'f1': 0.92771506, 'auroc': 0.99754727, 'binary_precision': 0.92761606, 'binary_recall': 0.80149555, 'binary_specificity': 0.99782616, 'binary_f1_score': 0.8599562}
confusion matrix:
       0     1
0  42229    92
1    292  1179
---- Validation: 
scalar performance:
{'acc': 0.9833972, 'precision': 0.9227638, 'recall': 0.80614084, 'specificity': 0.80614084, 'f1': 0.85441935, 'auroc': 0.9795686, 'binary_precision': 0.8590022, 'binary_recall': 0.61586314, 'binary_specificity': 0.99641854, 'binary_f1_score': 0.71739125}
confusion matrix:
       0    1
0  18084   65
1    247  396
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9603707, 'precision': 0.7929485, 'recall': 0.5615509, 'specificity': 0.5615509, 'f1': 0.59493333, 'auroc': 0.93183184, 'binary_precision': 0.6226415, 'binary_recall': 0.12643678, 'binary_specificity': 0.996665, 'binary_f1_score': 0.21019109}
confusion matrix:
      0   1
0  5977  20
1   228  33
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811472.png
early stop counter: 4
val acc:0.9833971858024597, best validation acc: 0.9875478744506836, corresponding to test acc:                         0.9635666608810425 / 0.9753915071487427
after epoch: 18,now: 2024-05-25 01:13:07.094977,epoch time: 0:43:35.610921,used: 12:31:51.084748,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_41_15_seed_0_20811472
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99404, 'precision': 0.9550724, 'recall': 0.9529832, 'specificity': 0.9529832, 'f1': 0.95402515, 'auroc': 0.9984065, 'binary_precision': 0.9133106, 'binary_recall': 0.9089674, 'binary_specificity': 0.996999, 'binary_f1_score': 0.91113377}
confusion matrix:
       0     1
0  42193   127
1    134  1338
---- Validation: 
scalar performance:
{'acc': 0.9878672, 'precision': 0.9136297, 'recall': 0.8999617, 'specificity': 0.8999617, 'f1': 0.9066714, 'auroc': 0.98388076, 'binary_precision': 0.8341385, 'binary_recall': 0.80559874, 'binary_specificity': 0.99432474, 'binary_f1_score': 0.81962025}
confusion matrix:
       0    1
0  18046  103
1    125  518
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964046, 'precision': 0.83185136, 'recall': 0.62027085, 'specificity': 0.62027085, 'f1': 0.6720538, 'auroc': 0.93539333, 'binary_precision': 0.6956522, 'binary_recall': 0.24521072, 'binary_specificity': 0.995331, 'binary_f1_score': 0.36260623}
confusion matrix:
      0   1
0  5969  28
1   197  64
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811472.png
better model found
persisted
after epoch: 19,now: 2024-05-25 01:52:17.563179,epoch time: 0:39:10.468202,used: 13:11:01.552950,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_41_15_seed_0_20811472
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99303526, 'precision': 0.9407448, 'recall': 0.9537448, 'specificity': 0.9537448, 'f1': 0.9471427, 'auroc': 0.99780726, 'binary_precision': 0.88456464, 'binary_recall': 0.9116247, 'binary_specificity': 0.9958649, 'binary_f1_score': 0.89789087}
confusion matrix:
       0     1
0  42146   175
1    130  1341
---- Validation: 
scalar performance:
{'acc': 0.988825, 'precision': 0.9249542, 'recall': 0.90195775, 'specificity': 0.90195775, 'f1': 0.91311014, 'auroc': 0.98377556, 'binary_precision': 0.85667217, 'binary_recall': 0.8087092, 'binary_specificity': 0.99520636, 'binary_f1_score': 0.832}
confusion matrix:
       0    1
0  18062   87
1    123  520
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9643656, 'precision': 0.85537094, 'recall': 0.6094436, 'specificity': 0.6094436, 'f1': 0.66193485, 'auroc': 0.93927747, 'binary_precision': 0.74358976, 'binary_recall': 0.22222222, 'binary_specificity': 0.996665, 'binary_f1_score': 0.3421829}
confusion matrix:
      0   1
0  5977  20
1   203  58
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811472.png
better model found
persisted
after epoch: 20,now: 2024-05-25 02:30:33.698271,epoch time: 0:38:16.135092,used: 13:49:17.688042,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_41_15_seed_0_20811472
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9920305, 'precision': 0.91369236, 'recall': 0.9771625, 'specificity': 0.9771625, 'f1': 0.94297206, 'auroc': 0.99864525, 'binary_precision': 0.828739, 'binary_recall': 0.9612245, 'binary_specificity': 0.9931005, 'binary_f1_score': 0.8900787}
confusion matrix:
       0     1
0  42030   292
1     57  1413
---- Validation: 
scalar performance:
{'acc': 0.9860579, 'precision': 0.8875477, 'recall': 0.9072757, 'specificity': 0.9072757, 'f1': 0.89714515, 'auroc': 0.9817172, 'binary_precision': 0.78138846, 'binary_recall': 0.82270604, 'binary_specificity': 0.9918453, 'binary_f1_score': 0.80151516}
confusion matrix:
       0    1
0  18001  148
1    114  529
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9613295, 'precision': 0.8183079, 'recall': 0.56938046, 'specificity': 0.56938046, 'f1': 0.6071706, 'auroc': 0.909805, 'binary_precision': 0.6727273, 'binary_recall': 0.14176245, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.23417722}
confusion matrix:
      0   1
0  5979  18
1   224  37
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811472.png
early stop counter: 1
val acc:0.9860578775405884, best validation acc: 0.9888250231742859, corresponding to test acc:                         0.9643656015396118 / 0.9753915071487427
after epoch: 21,now: 2024-05-25 03:09:03.001147,epoch time: 0:38:29.302876,used: 14:27:46.990918,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_41_15_seed_0_20811472
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.994314, 'precision': 0.9418653, 'recall': 0.9750916, 'specificity': 0.9750916, 'f1': 0.95782745, 'auroc': 0.9989362, 'binary_precision': 0.8853182, 'binary_recall': 0.9544837, 'binary_specificity': 0.9956994, 'binary_f1_score': 0.91860086}
confusion matrix:
       0     1
0  42138   182
1     67  1405
---- Validation: 
scalar performance:
{'acc': 0.9871754, 'precision': 0.89579827, 'recall': 0.9153547, 'specificity': 0.9153547, 'f1': 0.90532017, 'auroc': 0.9851823, 'binary_precision': 0.7973373, 'binary_recall': 0.83825815, 'binary_specificity': 0.99245137, 'binary_f1_score': 0.81728584}
confusion matrix:
       0    1
0  18012  137
1    104  539
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614893, 'precision': 0.7827753, 'recall': 0.61343986, 'specificity': 0.61343986, 'f1': 0.65812886, 'auroc': 0.93275326, 'binary_precision': 0.5980392, 'binary_recall': 0.23371647, 'binary_specificity': 0.9931632, 'binary_f1_score': 0.33608812}
confusion matrix:
      0   1
0  5956  41
1   200  61
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811472.png
early stop counter: 2
val acc:0.9871754050254822, best validation acc: 0.9888250231742859, corresponding to test acc:                         0.9643656015396118 / 0.9753915071487427
after epoch: 22,now: 2024-05-25 03:47:30.978778,epoch time: 0:38:27.977631,used: 15:06:14.968549,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_41_15_seed_0_20811472
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99454236, 'precision': 0.98451084, 'recall': 0.9299178, 'specificity': 0.9299178, 'f1': 0.9554658, 'auroc': 0.9986728, 'binary_precision': 0.97384614, 'binary_recall': 0.86063904, 'binary_specificity': 0.9991966, 'binary_f1_score': 0.9137496}
confusion matrix:
       0     1
0  42287    34
1    205  1266
---- Validation: 
scalar performance:
{'acc': 0.98573864, 'precision': 0.95250064, 'recall': 0.81935394, 'specificity': 0.81935394, 'f1': 0.8736173, 'auroc': 0.9814662, 'binary_precision': 0.9175947, 'binary_recall': 0.6407465, 'binary_specificity': 0.99796134, 'binary_f1_score': 0.7545787}
confusion matrix:
       0    1
0  18112   37
1    231  412
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9610099, 'precision': 0.8680667, 'recall': 0.5453934, 'specificity': 0.5453934, 'f1': 0.5722114, 'auroc': 0.9276326, 'binary_precision': 0.7741935, 'binary_recall': 0.09195402, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.16438356}
confusion matrix:
      0   1
0  5990   7
1   237  24
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811472.png
early stop counter: 3
val acc:0.9857386350631714, best validation acc: 0.9888250231742859, corresponding to test acc:                         0.9643656015396118 / 0.9753915071487427
after epoch: 23,now: 2024-05-25 04:25:46.217338,epoch time: 0:38:15.238560,used: 15:44:30.207109,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_41_15_seed_0_20811472
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9957298, 'precision': 0.96666586, 'recall': 0.9675851, 'specificity': 0.9675851, 'f1': 0.967125, 'auroc': 0.99916565, 'binary_precision': 0.93550575, 'binary_recall': 0.93741494, 'binary_specificity': 0.9977553, 'binary_f1_score': 0.93645936}
confusion matrix:
       0     1
0  42227    95
1     92  1378
---- Validation: 
scalar performance:
{'acc': 0.98781395, 'precision': 0.9215505, 'recall': 0.8879333, 'specificity': 0.8879333, 'f1': 0.90398717, 'auroc': 0.98350525, 'binary_precision': 0.8508475, 'binary_recall': 0.7807154, 'binary_specificity': 0.9951512, 'binary_f1_score': 0.81427413}
confusion matrix:
       0    1
0  18061   88
1    141  502
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9600511, 'precision': 0.8015387, 'recall': 0.5467255, 'specificity': 0.5467255, 'f1': 0.57310086, 'auroc': 0.9406731, 'binary_precision': 0.64102566, 'binary_recall': 0.09578544, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.16666666}
confusion matrix:
      0   1
0  5983  14
1   236  25
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811472.png
early stop counter: 4
val acc:0.9878139495849609, best validation acc: 0.9888250231742859, corresponding to test acc:                         0.9643656015396118 / 0.9753915071487427
after epoch: 24,now: 2024-05-25 05:03:54.108880,epoch time: 0:38:07.891542,used: 16:22:38.098651,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_41_15_seed_0_20811472
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9952046, 'precision': 0.9525167, 'recall': 0.9762081, 'specificity': 0.9762081, 'f1': 0.96403605, 'auroc': 0.9991776, 'binary_precision': 0.90657216, 'binary_recall': 0.9558424, 'binary_specificity': 0.99657375, 'binary_f1_score': 0.9305555}
confusion matrix:
       0     1
0  42175   145
1     65  1407
---- Validation: 
scalar performance:
{'acc': 0.985845, 'precision': 0.89080554, 'recall': 0.89666474, 'specificity': 0.89666474, 'f1': 0.89371145, 'auroc': 0.9781394, 'binary_precision': 0.7886677, 'binary_recall': 0.8009331, 'binary_specificity': 0.9923963, 'binary_f1_score': 0.7947531}
confusion matrix:
       0    1
0  18011  138
1    128  515
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.79352283, 'recall': 0.54664207, 'specificity': 0.54664207, 'f1': 0.5727823, 'auroc': 0.9152894, 'binary_precision': 0.625, 'binary_recall': 0.09578544, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.16611296}
confusion matrix:
      0   1
0  5982  15
1   236  25
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811472.png
early stop counter: 5
val acc:0.9858450293540955, best validation acc: 0.9888250231742859, corresponding to test acc:                         0.9643656015396118 / 0.9753915071487427
after epoch: 25,now: 2024-05-25 05:42:02.729637,epoch time: 0:38:08.620757,used: 17:00:46.719408,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_41_15_seed_0_20811472
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99472505, 'precision': 0.9539327, 'recall': 0.9661242, 'specificity': 0.9661242, 'f1': 0.95994127, 'auroc': 0.99916863, 'binary_precision': 0.9101124, 'binary_recall': 0.93546194, 'binary_specificity': 0.9967864, 'binary_f1_score': 0.9226131}
confusion matrix:
       0     1
0  42184   136
1     95  1377
---- Validation: 
scalar performance:
{'acc': 0.987335, 'precision': 0.91148573, 'recall': 0.89293575, 'specificity': 0.89293575, 'f1': 0.9019791, 'auroc': 0.9853694, 'binary_precision': 0.8303426, 'binary_recall': 0.79160184, 'binary_specificity': 0.99426967, 'binary_f1_score': 0.81050956}
confusion matrix:
       0    1
0  18045  104
1    134  509
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96580374, 'precision': 0.8756958, 'recall': 0.6230203, 'specificity': 0.6230203, 'f1': 0.6801628, 'auroc': 0.9468794, 'binary_precision': 0.78313255, 'binary_recall': 0.24904214, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.37790695}
confusion matrix:
      0   1
0  5979  18
1   196  65
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811472.png
early stop counter: 6
val acc:0.9873350262641907, best validation acc: 0.9888250231742859, corresponding to test acc:                         0.9643656015396118 / 0.9753915071487427
after epoch: 26,now: 2024-05-25 06:20:08.854188,epoch time: 0:38:06.124551,used: 17:38:52.843959,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_41_15_seed_0_20811472
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9956385, 'precision': 0.9640489, 'recall': 0.9692197, 'specificity': 0.9692197, 'f1': 0.9666189, 'auroc': 0.99912846, 'binary_precision': 0.93015444, 'binary_recall': 0.94089675, 'binary_specificity': 0.99754256, 'binary_f1_score': 0.9354948}
confusion matrix:
       0     1
0  42216   104
1     87  1385
---- Validation: 
scalar performance:
{'acc': 0.98690933, 'precision': 0.91438574, 'recall': 0.8807145, 'specificity': 0.8807145, 'f1': 0.8967787, 'auroc': 0.9769738, 'binary_precision': 0.8370119, 'binary_recall': 0.7667185, 'binary_specificity': 0.99471045, 'binary_f1_score': 0.8003246}
confusion matrix:
       0    1
0  18053   96
1    150  493
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606903, 'precision': 0.8518574, 'recall': 0.5433943, 'specificity': 0.5433943, 'f1': 0.56870496, 'auroc': 0.9270853, 'binary_precision': 0.7419355, 'binary_recall': 0.08812261, 'binary_specificity': 0.998666, 'binary_f1_score': 0.15753424}
confusion matrix:
      0   1
0  5989   8
1   238  23
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811472.png
early stop counter: 7
val acc:0.9869093298912048, best validation acc: 0.9888250231742859, corresponding to test acc:                         0.9643656015396118 / 0.9753915071487427
after epoch: 27,now: 2024-05-25 06:58:22.557369,epoch time: 0:38:13.703181,used: 18:17:06.547140,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_41_15_seed_0_20811472
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99522746, 'precision': 0.9617181, 'recall': 0.96504986, 'specificity': 0.96504986, 'f1': 0.9633775, 'auroc': 0.99909806, 'binary_precision': 0.925776, 'binary_recall': 0.93269885, 'binary_specificity': 0.9974008, 'binary_f1_score': 0.9292245}
confusion matrix:
       0     1
0  42211   110
1     99  1372
---- Validation: 
scalar performance:
{'acc': 0.9860047, 'precision': 0.9196729, 'recall': 0.8569944, 'specificity': 0.8569944, 'f1': 0.88560355, 'auroc': 0.9782184, 'binary_precision': 0.8492647, 'binary_recall': 0.718507, 'binary_specificity': 0.99548185, 'binary_f1_score': 0.778433}
confusion matrix:
       0    1
0  18067   82
1    181  462
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608501, 'precision': 0.7928412, 'recall': 0.5764597, 'specificity': 0.5764597, 'f1': 0.6153322, 'auroc': 0.93710494, 'binary_precision': 0.6212121, 'binary_recall': 0.15708812, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.25076452}
confusion matrix:
      0   1
0  5972  25
1   220  41
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811472.png
early stop counter: 8
val acc:0.9860047101974487, best validation acc: 0.9888250231742859, corresponding to test acc:                         0.9643656015396118 / 0.9753915071487427
after epoch: 28,now: 2024-05-25 07:36:31.658133,epoch time: 0:38:09.100764,used: 18:55:15.647904,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_41_15_seed_0_20811472
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9941313, 'precision': 0.941676, 'recall': 0.97202885, 'specificity': 0.97202885, 'f1': 0.9563073, 'auroc': 0.99889004, 'binary_precision': 0.8851523, 'binary_recall': 0.94833446, 'binary_specificity': 0.9957232, 'binary_f1_score': 0.91565466}
confusion matrix:
       0     1
0  42140   181
1     76  1395
---- Validation: 
scalar performance:
{'acc': 0.9867497, 'precision': 0.9133421, 'recall': 0.87913173, 'specificity': 0.87913173, 'f1': 0.89543796, 'auroc': 0.9797725, 'binary_precision': 0.835034, 'binary_recall': 0.7636081, 'binary_specificity': 0.9946554, 'binary_f1_score': 0.79772544}
confusion matrix:
       0    1
0  18052   97
1    152  491
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9715564, 'precision': 0.88498396, 'recall': 0.7121415, 'specificity': 0.7121415, 'f1': 0.77126014, 'auroc': 0.94944614, 'binary_precision': 0.79432625, 'binary_recall': 0.42911878, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.5572139}
confusion matrix:
      0    1
0  5968   29
1   149  112
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811472.png
early stop counter: 9
val acc:0.9867497086524963, best validation acc: 0.9888250231742859, corresponding to test acc:                         0.9643656015396118 / 0.9753915071487427
after epoch: 29,now: 2024-05-25 08:14:46.003837,epoch time: 0:38:14.345704,used: 19:33:29.993608,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_41_15_seed_0_20811472
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9959353, 'precision': 0.95863426, 'recall': 0.9808483, 'specificity': 0.9808483, 'f1': 0.96945786, 'auroc': 0.9994972, 'binary_precision': 0.91849935, 'binary_recall': 0.96467394, 'binary_specificity': 0.9970227, 'binary_f1_score': 0.94102055}
confusion matrix:
       0     1
0  42194   126
1     52  1420
---- Validation: 
scalar performance:
{'acc': 0.987335, 'precision': 0.9184499, 'recall': 0.883185, 'specificity': 0.883185, 'f1': 0.89997864, 'auroc': 0.9788934, 'binary_precision': 0.84497446, 'binary_recall': 0.7713841, 'binary_specificity': 0.99498594, 'binary_f1_score': 0.8065041}
confusion matrix:
       0    1
0  18058   91
1    147  496
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96228826, 'precision': 0.8841022, 'recall': 0.5625514, 'specificity': 0.5625514, 'f1': 0.5996105, 'auroc': 0.9331297, 'binary_precision': 0.80487806, 'binary_recall': 0.12643678, 'binary_specificity': 0.998666, 'binary_f1_score': 0.21854305}
confusion matrix:
      0   1
0  5989   8
1   228  33
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811472.png
early stop counter: 10
val acc:0.9873350262641907, best validation acc: 0.9888250231742859, corresponding to test acc:                         0.9643656015396118 / 0.9753915071487427
after epoch: 30,now: 2024-05-25 08:52:58.166628,epoch time: 0:38:12.162791,used: 20:11:42.156399,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_41_15_seed_0_20811472
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 20:11:42.156399 at 2024-05-25 08:52:58.166628
persisted model performance metric: 

scalar performance:
{'acc': 0.9653244, 'precision': 0.87847996, 'recall': 0.61360854, 'specificity': 0.61360854, 'f1': 0.66913277, 'auroc': 0.94261944, 'binary_precision': 0.7894737, 'binary_recall': 0.22988506, 'binary_specificity': 0.997332, 'binary_f1_score': 0.3560831}
confusion matrix:
      0   1
0  5981  16
1   201  60
oracle model performance metric: 

scalar performance:
{'acc': 0.97619045, 'precision': 0.89776385, 'recall': 0.77502644, 'specificity': 0.77502644, 'f1': 0.8241274, 'auroc': 0.950588, 'binary_precision': 0.8146067, 'binary_recall': 0.5555556, 'binary_specificity': 0.99449724, 'binary_f1_score': 0.6605923}
confusion matrix:
      0    1
0  5964   33
1   116  145
results aggregation path: zoutput/benchmarks/CAMELYON_center0_vit_irm/rule_results/6.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_vit_irm/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_vit_irm/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1661 MiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |   1655 MiB |  15779 MiB |    977 TiB |    977 TiB |
|       from small pool |      6 MiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1661 MiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |   1655 MiB |  15779 MiB |    977 TiB |    977 TiB |
|       from small pool |      6 MiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1653 MiB |  15770 MiB |    987 TiB |    987 TiB |
|       from large pool |   1647 MiB |  15745 MiB |    974 TiB |    974 TiB |
|       from small pool |      5 MiB |     25 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  16730 MiB |  16730 MiB |  16730 MiB |      0 B   |
|       from large pool |  16702 MiB |  16702 MiB |  16702 MiB |      0 B   |
|       from small pool |     28 MiB |     28 MiB |     28 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 430238 KiB |    863 MiB | 413550 GiB | 413550 GiB |
|       from large pool | 410304 KiB |    862 MiB | 400660 GiB | 400660 GiB |
|       from small pool |  19934 KiB |     21 MiB |  12889 GiB |  12889 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3366    |    6357    |  152169 K  |  152166 K  |
|       from large pool |     247    |     989    |   62327 K  |   62326 K  |
|       from small pool |    3119    |    6108    |   89842 K  |   89839 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3366    |    6357    |  152169 K  |  152166 K  |
|       from large pool |     247    |     989    |   62327 K  |   62326 K  |
|       from small pool |    3119    |    6108    |   89842 K  |   89839 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     621    |     621    |     621    |       0    |
|       from large pool |     607    |     607    |     607    |       0    |
|       from small pool |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     144    |    2870    |   90165 K  |   90164 K  |
|       from large pool |     112    |     516    |   47275 K  |   47275 K  |
|       from small pool |      32    |    2758    |   42889 K  |   42889 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |  16640 KiB |  15779 MiB |    977 TiB |    977 TiB |
|       from small pool |      0 KiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |  16640 KiB |  15779 MiB |    977 TiB |    977 TiB |
|       from small pool |      0 KiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15770 MiB |    987 TiB |    987 TiB |
|       from large pool |  16640 KiB |  15745 MiB |    974 TiB |    974 TiB |
|       from small pool |      0 KiB |     25 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2082 MiB |  16730 MiB |  16730 MiB |  14648 MiB |
|       from large pool |   2056 MiB |  16702 MiB |  16702 MiB |  14646 MiB |
|       from small pool |     26 MiB |     28 MiB |     28 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    863 MiB | 413551 GiB | 413551 GiB |
|       from large pool |  24320 KiB |    862 MiB | 400661 GiB | 400661 GiB |
|       from small pool |      0 KiB |     24 MiB |  12889 GiB |  12889 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6357    |  152169 K  |  152169 K  |
|       from large pool |       2    |     989    |   62327 K  |   62327 K  |
|       from small pool |       0    |    6108    |   89842 K  |   89842 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6357    |  152169 K  |  152169 K  |
|       from large pool |       2    |     989    |   62327 K  |   62327 K  |
|       from small pool |       0    |    6108    |   89842 K  |   89842 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     115    |     621    |     621    |     506    |
|       from large pool |     102    |     607    |     607    |     505    |
|       from small pool |      13    |      14    |      14    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    2870    |   90166 K  |   90166 K  |
|       from large pool |       2    |     516    |   47275 K  |   47275 K  |
|       from small pool |       0    |    2758    |   42890 K  |   42890 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat May 25 08:55:52 2024]
Finished job 0.
1 of 1 steps (100%) done
