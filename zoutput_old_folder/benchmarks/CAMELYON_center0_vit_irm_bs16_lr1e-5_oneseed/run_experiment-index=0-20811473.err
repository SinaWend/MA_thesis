Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Fri May 24 12:30:37 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_vit_irm/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_vit_irm/rule_results/0.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=0
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_39_06_seed_0_20811473

 Experiment start at: 2024-05-24 12:39:06.399650
before training, model accuracy: 0.955097496509552
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9723922, 'precision': 0.81963384, 'recall': 0.6801512, 'specificity': 0.6801512, 'f1': 0.7288237, 'auroc': 0.9642813, 'binary_precision': 0.6609547, 'binary_recall': 0.3668478, 'binary_specificity': 0.99345464, 'binary_f1_score': 0.47182176}
confusion matrix:
       0    1
0  42043  277
1    932  540
---- Validation: 
scalar performance:
{'acc': 0.97184974, 'precision': 0.8207276, 'recall': 0.6764034, 'specificity': 0.6764034, 'f1': 0.72586966, 'auroc': 0.9635329, 'binary_precision': 0.6637931, 'binary_recall': 0.3592535, 'binary_specificity': 0.99355334, 'binary_f1_score': 0.46619573}
confusion matrix:
       0    1
0  18032  117
1    412  231
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9653244, 'precision': 0.85919774, 'recall': 0.62460256, 'specificity': 0.62460256, 'f1': 0.68019426, 'auroc': 0.9459083, 'binary_precision': 0.75, 'binary_recall': 0.25287357, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.37822354}
confusion matrix:
      0   1
0  5975  22
1   195  66
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811473.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-24 13:21:01.461875,epoch time: 0:41:55.062225,used: 0:41:55.062225,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_39_06_seed_0_20811473
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9791286, 'precision': 0.8731394, 'recall': 0.7728143, 'specificity': 0.7728143, 'f1': 0.8145634, 'auroc': 0.9796808, 'binary_precision': 0.7617261, 'binary_recall': 0.55163044, 'binary_specificity': 0.9939981, 'binary_f1_score': 0.6398739}
confusion matrix:
       0    1
0  42066  254
1    660  812
---- Validation: 
scalar performance:
{'acc': 0.97754365, 'precision': 0.86413634, 'recall': 0.75810707, 'specificity': 0.75810707, 'f1': 0.8013474, 'auroc': 0.977821, 'binary_precision': 0.7450111, 'binary_recall': 0.5225505, 'binary_specificity': 0.99366355, 'binary_f1_score': 0.6142596}
confusion matrix:
       0    1
0  18034  115
1    307  336
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614893, 'precision': 0.85054696, 'recall': 0.55846983, 'specificity': 0.55846983, 'f1': 0.59244365, 'auroc': 0.95562136, 'binary_precision': 0.7380952, 'binary_recall': 0.118773945, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.20462047}
confusion matrix:
      0   1
0  5986  11
1   230  31
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811473.png
better model found
persisted
after epoch: 2,now: 2024-05-24 14:00:55.137772,epoch time: 0:39:53.675897,used: 1:21:48.738122,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_39_06_seed_0_20811473
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.98241687, 'precision': 0.8878509, 'recall': 0.82336664, 'specificity': 0.82336664, 'f1': 0.85244846, 'auroc': 0.9843745, 'binary_precision': 0.78770494, 'binary_recall': 0.65285325, 'binary_specificity': 0.99388, 'binary_f1_score': 0.7139674}
confusion matrix:
       0    1
0  42061  259
1    511  961
---- Validation: 
scalar performance:
{'acc': 0.9812154, 'precision': 0.8928019, 'recall': 0.7982608, 'specificity': 0.7982608, 'f1': 0.83854824, 'auroc': 0.9805438, 'binary_precision': 0.7995868, 'binary_recall': 0.60186625, 'binary_specificity': 0.9946554, 'binary_f1_score': 0.6867791}
confusion matrix:
       0    1
0  18052   97
1    256  387
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964046, 'precision': 0.8992585, 'recall': 0.58545655, 'specificity': 0.58545655, 'f1': 0.6336366, 'auroc': 0.9586265, 'binary_precision': 0.8333333, 'binary_recall': 0.1724138, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.2857143}
confusion matrix:
      0   1
0  5988   9
1   216  45
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811473.png
better model found
persisted
after epoch: 3,now: 2024-05-24 14:43:00.656898,epoch time: 0:42:05.519126,used: 2:03:54.257248,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_39_06_seed_0_20811473
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98460907, 'precision': 0.90467966, 'recall': 0.8442924, 'specificity': 0.8442924, 'f1': 0.87185824, 'auroc': 0.98761475, 'binary_precision': 0.8199357, 'binary_recall': 0.6938776, 'binary_specificity': 0.9947072, 'binary_f1_score': 0.7516581}
confusion matrix:
       0     1
0  42098   224
1    450  1020
---- Validation: 
scalar performance:
{'acc': 0.9838761, 'precision': 0.9070334, 'recall': 0.8326407, 'specificity': 0.8326407, 'f1': 0.86579716, 'auroc': 0.9838451, 'binary_precision': 0.8256705, 'binary_recall': 0.6702955, 'binary_specificity': 0.99498594, 'binary_f1_score': 0.7399142}
confusion matrix:
       0    1
0  18058   91
1    212  431
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590924, 'precision': 0.78964245, 'recall': 0.5242372, 'specificity': 0.5242372, 'f1': 0.5356366, 'auroc': 0.95113474, 'binary_precision': 0.61904764, 'binary_recall': 0.049808428, 'binary_specificity': 0.998666, 'binary_f1_score': 0.09219858}
confusion matrix:
      0   1
0  5989   8
1   248  13
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811473.png
better model found
persisted
after epoch: 4,now: 2024-05-24 15:24:58.233208,epoch time: 0:41:57.576310,used: 2:45:51.833558,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_39_06_seed_0_20811473
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9827594, 'precision': 0.8611593, 'recall': 0.88124704, 'specificity': 0.88124704, 'f1': 0.87090683, 'auroc': 0.9872904, 'binary_precision': 0.7302505, 'binary_recall': 0.7724185, 'binary_specificity': 0.9900756, 'binary_f1_score': 0.7507428}
confusion matrix:
       0     1
0  41900   420
1    335  1137
---- Validation: 
scalar performance:
{'acc': 0.9819604, 'precision': 0.86871743, 'recall': 0.8526505, 'specificity': 0.8526505, 'f1': 0.86048913, 'auroc': 0.9828515, 'binary_precision': 0.747557, 'binary_recall': 0.7138414, 'binary_specificity': 0.9914596, 'binary_f1_score': 0.73031026}
confusion matrix:
       0    1
0  17994  155
1    184  459
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9691595, 'precision': 0.90562844, 'recall': 0.65958554, 'specificity': 0.65958554, 'f1': 0.7247479, 'auroc': 0.9584775, 'binary_precision': 0.84, 'binary_recall': 0.3218391, 'binary_specificity': 0.997332, 'binary_f1_score': 0.465374}
confusion matrix:
      0   1
0  5981  16
1   177  84
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811473.png
new oracle model saved
early stop counter: 1
val acc:0.9819604158401489, best validation acc: 0.98387610912323, corresponding to test acc:                         0.959092378616333 / 0.9691594839096069
after epoch: 5,now: 2024-05-24 16:04:26.619102,epoch time: 0:39:28.385894,used: 3:25:20.219452,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_39_06_seed_0_20811473
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9848146, 'precision': 0.86475635, 'recall': 0.92394847, 'specificity': 0.92394847, 'f1': 0.891926, 'auroc': 0.9917384, 'binary_precision': 0.7344567, 'binary_recall': 0.8586956, 'binary_specificity': 0.9892013, 'binary_f1_score': 0.79173195}
confusion matrix:
       0     1
0  41863   457
1    208  1264
---- Validation: 
scalar performance:
{'acc': 0.9829715, 'precision': 0.8569797, 'recall': 0.90492773, 'specificity': 0.90492773, 'f1': 0.879302, 'auroc': 0.9841533, 'binary_precision': 0.72032744, 'binary_recall': 0.82115084, 'binary_specificity': 0.9887046, 'binary_f1_score': 0.76744187}
confusion matrix:
       0    1
0  17944  205
1    115  528
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964845, 'precision': 0.8492826, 'recall': 0.6225201, 'specificity': 0.6225201, 'f1': 0.6766727, 'auroc': 0.96123016, 'binary_precision': 0.7303371, 'binary_recall': 0.24904214, 'binary_specificity': 0.995998, 'binary_f1_score': 0.37142855}
confusion matrix:
      0   1
0  5973  24
1   196  65
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811473.png
early stop counter: 2
val acc:0.9829714894294739, best validation acc: 0.98387610912323, corresponding to test acc:                         0.959092378616333 / 0.9691594839096069
after epoch: 6,now: 2024-05-24 16:46:10.223560,epoch time: 0:41:43.604458,used: 4:07:03.823910,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_39_06_seed_0_20811473
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98214287, 'precision': 0.9530319, 'recall': 0.75503016, 'specificity': 0.75503016, 'f1': 0.8245244, 'auroc': 0.990577, 'binary_precision': 0.9227941, 'binary_recall': 0.51154894, 'binary_specificity': 0.9985113, 'binary_f1_score': 0.6582168}
confusion matrix:
       0    1
0  42257   63
1    719  753
---- Validation: 
scalar performance:
{'acc': 0.97914004, 'precision': 0.9334652, 'recall': 0.7229309, 'specificity': 0.7229309, 'f1': 0.79216784, 'auroc': 0.98464894, 'binary_precision': 0.8861538, 'binary_recall': 0.44790047, 'binary_specificity': 0.99796134, 'binary_f1_score': 0.59504133}
confusion matrix:
       0    1
0  18112   37
1    355  288
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9592522, 'precision': 0.8370436, 'recall': 0.5188236, 'specificity': 0.5188236, 'f1': 0.52594787, 'auroc': 0.95393467, 'binary_precision': 0.71428573, 'binary_recall': 0.038314175, 'binary_specificity': 0.999333, 'binary_f1_score': 0.07272727}
confusion matrix:
      0   1
0  5993   4
1   251  10
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811473.png
early stop counter: 3
val acc:0.979140043258667, best validation acc: 0.98387610912323, corresponding to test acc:                         0.959092378616333 / 0.9691594839096069
after epoch: 7,now: 2024-05-24 17:27:57.368355,epoch time: 0:41:47.144795,used: 4:48:50.968705,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_39_06_seed_0_20811473
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9860705, 'precision': 0.9046463, 'recall': 0.87378013, 'specificity': 0.87378013, 'f1': 0.88855135, 'auroc': 0.9923344, 'binary_precision': 0.8178466, 'binary_recall': 0.75339675, 'binary_specificity': 0.9941635, 'binary_f1_score': 0.78429985}
confusion matrix:
       0     1
0  42073   247
1    363  1109
---- Validation: 
scalar performance:
{'acc': 0.98435503, 'precision': 0.9081645, 'recall': 0.84038925, 'specificity': 0.84038925, 'f1': 0.87096244, 'auroc': 0.9843663, 'binary_precision': 0.8273921, 'binary_recall': 0.6858476, 'binary_specificity': 0.99493086, 'binary_f1_score': 0.75000006}
confusion matrix:
       0    1
0  18057   92
1    202  441
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9600511, 'precision': 0.8750222, 'recall': 0.52840215, 'specificity': 0.52840215, 'f1': 0.54335564, 'auroc': 0.94994354, 'binary_precision': 0.7894737, 'binary_recall': 0.057471264, 'binary_specificity': 0.999333, 'binary_f1_score': 0.10714286}
confusion matrix:
      0   1
0  5993   4
1   246  15
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811473.png
better model found
persisted
after epoch: 8,now: 2024-05-24 18:07:17.860276,epoch time: 0:39:20.491921,used: 5:28:11.460626,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_39_06_seed_0_20811473
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98486024, 'precision': 0.86868227, 'recall': 0.9151199, 'specificity': 0.9151199, 'f1': 0.8904003, 'auroc': 0.99179435, 'binary_precision': 0.7429429, 'binary_recall': 0.84035325, 'binary_specificity': 0.9898866, 'binary_f1_score': 0.7886516}
confusion matrix:
       0     1
0  41892   428
1    235  1237
---- Validation: 
scalar performance:
{'acc': 0.9838761, 'precision': 0.8683499, 'recall': 0.8986456, 'specificity': 0.8986456, 'f1': 0.8828445, 'auroc': 0.9849222, 'binary_precision': 0.743553, 'binary_recall': 0.80715394, 'binary_specificity': 0.9901372, 'binary_f1_score': 0.7740492}
confusion matrix:
       0    1
0  17970  179
1    124  519
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9592522, 'precision': 0.87975353, 'recall': 0.51515895, 'specificity': 0.51515895, 'f1': 0.5191079, 'auroc': 0.948599, 'binary_precision': 0.8, 'binary_recall': 0.03065134, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.05904059}
confusion matrix:
      0  1
0  5995  2
1   253  8
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811473.png
early stop counter: 1
val acc:0.98387610912323, best validation acc: 0.9843550324440002, corresponding to test acc:                         0.9600511193275452 / 0.9691594839096069
after epoch: 9,now: 2024-05-24 18:49:58.563875,epoch time: 0:42:40.703599,used: 6:10:52.164225,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_39_06_seed_0_20811473
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9893588, 'precision': 0.95255077, 'recall': 0.8760538, 'specificity': 0.8760538, 'f1': 0.91050947, 'auroc': 0.9949206, 'binary_precision': 0.91358024, 'binary_recall': 0.7545887, 'binary_specificity': 0.99751896, 'binary_f1_score': 0.8265078}
confusion matrix:
       0     1
0  42216   105
1    361  1110
---- Validation: 
scalar performance:
{'acc': 0.9849404, 'precision': 0.91500664, 'recall': 0.8429424, 'specificity': 0.8429424, 'f1': 0.87527716, 'auroc': 0.9766941, 'binary_precision': 0.84090906, 'binary_recall': 0.6905132, 'binary_specificity': 0.99537164, 'binary_f1_score': 0.7583262}
confusion matrix:
       0    1
0  18065   84
1    199  444
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.8459687, 'recall': 0.5358148, 'specificity': 0.5358148, 'f1': 0.55602133, 'auroc': 0.95088303, 'binary_precision': 0.7307692, 'binary_recall': 0.07279693, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.13240418}
confusion matrix:
      0   1
0  5990   7
1   242  19
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811473.png
better model found
persisted
after epoch: 10,now: 2024-05-24 19:32:19.612365,epoch time: 0:42:21.048490,used: 6:53:13.212715,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_39_06_seed_0_20811473
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9912769, 'precision': 0.9446697, 'recall': 0.91778415, 'specificity': 0.91778415, 'f1': 0.9307753, 'auroc': 0.9961413, 'binary_precision': 0.89492756, 'binary_recall': 0.83899456, 'binary_specificity': 0.99657375, 'binary_f1_score': 0.8660589}
confusion matrix:
       0     1
0  42175   145
1    237  1235
---- Validation: 
scalar performance:
{'acc': 0.98621756, 'precision': 0.91557705, 'recall': 0.8661053, 'specificity': 0.8661053, 'f1': 0.8891493, 'auroc': 0.97954065, 'binary_precision': 0.84042555, 'binary_recall': 0.7371695, 'binary_specificity': 0.9950411, 'binary_f1_score': 0.78541845}
confusion matrix:
       0    1
0  18059   90
1    169  474
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589326, 'precision': 0.75365746, 'recall': 0.5443095, 'specificity': 0.5443095, 'f1': 0.56816524, 'auroc': 0.94609964, 'binary_precision': 0.54545456, 'binary_recall': 0.09195402, 'binary_specificity': 0.996665, 'binary_f1_score': 0.15737705}
confusion matrix:
      0   1
0  5977  20
1   237  24
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811473.png
better model found
persisted
after epoch: 11,now: 2024-05-24 20:11:36.343893,epoch time: 0:39:16.731528,used: 7:32:29.944243,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_39_06_seed_0_20811473
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9871666, 'precision': 0.9719037, 'recall': 0.82352906, 'specificity': 0.82352906, 'f1': 0.8829334, 'auroc': 0.9963857, 'binary_precision': 0.9559118, 'binary_recall': 0.6480978, 'binary_specificity': 0.9989603, 'binary_f1_score': 0.77246964}
confusion matrix:
       0    1
0  42276   44
1    518  954
---- Validation: 
scalar performance:
{'acc': 0.9833972, 'precision': 0.95188373, 'recall': 0.781389, 'specificity': 0.781389, 'f1': 0.8454424, 'auroc': 0.98025227, 'binary_precision': 0.91898733, 'binary_recall': 0.5645412, 'binary_specificity': 0.99823684, 'binary_f1_score': 0.69942194}
confusion matrix:
       0    1
0  18117   32
1    280  363
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959412, 'precision': 0.9796833, 'recall': 0.51341, 'specificity': 0.51341, 'f1': 0.51575035, 'auroc': 0.94770634, 'binary_precision': 1.0, 'binary_recall': 0.026819924, 'binary_specificity': 1.0, 'binary_f1_score': 0.052238807}
confusion matrix:
      0  1
0  5997  0
1   254  7
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811473.png
early stop counter: 1
val acc:0.9833971858024597, best validation acc: 0.9862175583839417, corresponding to test acc:                         0.9589325785636902 / 0.9691594839096069
after epoch: 12,now: 2024-05-24 20:51:34.392011,epoch time: 0:39:58.048118,used: 8:12:27.992361,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_39_06_seed_0_20811473
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9921447, 'precision': 0.9266561, 'recall': 0.95790404, 'specificity': 0.95790404, 'f1': 0.9416824, 'auroc': 0.9965338, 'binary_precision': 0.8560606, 'binary_recall': 0.9211956, 'binary_specificity': 0.99461246, 'binary_f1_score': 0.88743454}
confusion matrix:
       0     1
0  42092   228
1    116  1356
---- Validation: 
scalar performance:
{'acc': 0.9876543, 'precision': 0.90996855, 'recall': 0.9013517, 'specificity': 0.9013517, 'f1': 0.9056105, 'auroc': 0.9838368, 'binary_precision': 0.8267091, 'binary_recall': 0.8087092, 'binary_specificity': 0.9939942, 'binary_f1_score': 0.8176101}
confusion matrix:
       0    1
0  18040  109
1    123  520
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96644294, 'precision': 0.8717683, 'recall': 0.63618016, 'specificity': 0.63618016, 'f1': 0.6947564, 'auroc': 0.9467849, 'binary_precision': 0.7741935, 'binary_recall': 0.27586207, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.40677965}
confusion matrix:
      0   1
0  5976  21
1   189  72
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811473.png
better model found
persisted
after epoch: 13,now: 2024-05-24 21:33:04.550675,epoch time: 0:41:30.158664,used: 8:53:58.151025,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_39_06_seed_0_20811473
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99198484, 'precision': 0.960441, 'recall': 0.91224897, 'specificity': 0.91224897, 'f1': 0.93491423, 'auroc': 0.9970198, 'binary_precision': 0.926885, 'binary_recall': 0.8267663, 'binary_specificity': 0.99773157, 'binary_f1_score': 0.87396765}
confusion matrix:
       0     1
0  42224    96
1    255  1217
---- Validation: 
scalar performance:
{'acc': 0.9848872, 'precision': 0.9106091, 'recall': 0.8474152, 'specificity': 0.8474152, 'f1': 0.87616646, 'auroc': 0.9834497, 'binary_precision': 0.83179295, 'binary_recall': 0.6998445, 'binary_specificity': 0.99498594, 'binary_f1_score': 0.7601352}
confusion matrix:
       0    1
0  18058   91
1    193  450
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.8139852, 'recall': 0.5374804, 'specificity': 0.5374804, 'f1': 0.5584627, 'auroc': 0.9437239, 'binary_precision': 0.6666667, 'binary_recall': 0.07662835, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.13745704}
confusion matrix:
      0   1
0  5987  10
1   241  20
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811473.png
early stop counter: 1
val acc:0.9848871827125549, best validation acc: 0.9876543283462524, corresponding to test acc:                         0.9664429426193237 / 0.9691594839096069
after epoch: 14,now: 2024-05-24 22:16:58.757519,epoch time: 0:43:54.206844,used: 9:37:52.357869,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_39_06_seed_0_20811473
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9917793, 'precision': 0.9319266, 'recall': 0.9432523, 'specificity': 0.9432523, 'f1': 0.93751025, 'auroc': 0.996814, 'binary_precision': 0.86763734, 'binary_recall': 0.89123046, 'binary_specificity': 0.9952742, 'binary_f1_score': 0.8792757}
confusion matrix:
       0     1
0  42121   200
1    160  1311
---- Validation: 
scalar performance:
{'acc': 0.9868029, 'precision': 0.90929174, 'recall': 0.8859098, 'specificity': 0.8859098, 'f1': 0.8972285, 'auroc': 0.9804975, 'binary_precision': 0.8264463, 'binary_recall': 0.777605, 'binary_specificity': 0.99421453, 'binary_f1_score': 0.80128205}
confusion matrix:
       0    1
0  18044  105
1    143  500
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.8073467, 'recall': 0.53181666, 'specificity': 0.53181666, 'f1': 0.5488892, 'auroc': 0.9417664, 'binary_precision': 0.65384614, 'binary_recall': 0.0651341, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.11846689}
confusion matrix:
      0   1
0  5988   9
1   244  17
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811473.png
early stop counter: 2
val acc:0.986802875995636, best validation acc: 0.9876543283462524, corresponding to test acc:                         0.9664429426193237 / 0.9691594839096069
after epoch: 15,now: 2024-05-24 23:01:57.259720,epoch time: 0:44:58.502201,used: 10:22:50.860070,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_39_06_seed_0_20811473
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9907974, 'precision': 0.9763881, 'recall': 0.8778651, 'specificity': 0.8778651, 'f1': 0.92104125, 'auroc': 0.9976995, 'binary_precision': 0.9611734, 'binary_recall': 0.7567935, 'binary_specificity': 0.99893665, 'binary_f1_score': 0.8468263}
confusion matrix:
       0     1
0  42275    45
1    358  1114
---- Validation: 
scalar performance:
{'acc': 0.9837697, 'precision': 0.9440056, 'recall': 0.79358274, 'specificity': 0.79358274, 'f1': 0.8523624, 'auroc': 0.9825245, 'binary_precision': 0.90238094, 'binary_recall': 0.58942455, 'binary_specificity': 0.9977409, 'binary_f1_score': 0.7130762}
confusion matrix:
       0    1
0  18108   41
1    264  379
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.8965738, 'recall': 0.51899034, 'specificity': 0.51899034, 'f1': 0.5262976, 'auroc': 0.9470831, 'binary_precision': 0.8333333, 'binary_recall': 0.038314175, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.07326008}
confusion matrix:
      0   1
0  5995   2
1   251  10
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811473.png
early stop counter: 3
val acc:0.9837697148323059, best validation acc: 0.9876543283462524, corresponding to test acc:                         0.9664429426193237 / 0.9691594839096069
after epoch: 16,now: 2024-05-24 23:45:47.679129,epoch time: 0:43:50.419409,used: 11:06:41.279479,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_39_06_seed_0_20811473
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9920077, 'precision': 0.97601813, 'recall': 0.8975071, 'specificity': 0.8975071, 'f1': 0.93297935, 'auroc': 0.99785435, 'binary_precision': 0.9590835, 'binary_recall': 0.7961956, 'binary_specificity': 0.9988185, 'binary_f1_score': 0.8700817}
confusion matrix:
       0     1
0  42270    50
1    300  1172
---- Validation: 
scalar performance:
{'acc': 0.9831311, 'precision': 0.94814336, 'recall': 0.7797512, 'specificity': 0.7797512, 'f1': 0.84311235, 'auroc': 0.98193324, 'binary_precision': 0.91161615, 'binary_recall': 0.5614308, 'binary_specificity': 0.9980715, 'binary_f1_score': 0.69489896}
confusion matrix:
       0    1
0  18114   35
1    282  361
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.92481303, 'recall': 0.5304846, 'specificity': 0.5304846, 'f1': 0.54725534, 'auroc': 0.93095875, 'binary_precision': 0.8888889, 'binary_recall': 0.06130268, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.11469534}
confusion matrix:
      0   1
0  5995   2
1   245  16
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811473.png
early stop counter: 4
val acc:0.9831311106681824, best validation acc: 0.9876543283462524, corresponding to test acc:                         0.9664429426193237 / 0.9691594839096069
after epoch: 17,now: 2024-05-25 00:29:31.694116,epoch time: 0:43:44.014987,used: 11:50:25.294466,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_39_06_seed_0_20811473
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9940172, 'precision': 0.95177644, 'recall': 0.9565211, 'specificity': 0.9565211, 'f1': 0.9541354, 'auroc': 0.9987143, 'binary_precision': 0.9064603, 'binary_recall': 0.9163265, 'binary_specificity': 0.99671566, 'binary_f1_score': 0.9113667}
confusion matrix:
       0     1
0  42183   139
1    123  1347
---- Validation: 
scalar performance:
{'acc': 0.98706895, 'precision': 0.9193566, 'recall': 0.8770468, 'specificity': 0.8770468, 'f1': 0.89698696, 'auroc': 0.9851265, 'binary_precision': 0.8472222, 'binary_recall': 0.7589425, 'binary_specificity': 0.9951512, 'binary_f1_score': 0.80065626}
confusion matrix:
       0    1
0  18061   88
1    155  488
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96212846, 'precision': 0.83570635, 'recall': 0.5771267, 'specificity': 0.5771267, 'f1': 0.61881113, 'auroc': 0.9475355, 'binary_precision': 0.70689654, 'binary_recall': 0.15708812, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.2570533}
confusion matrix:
      0   1
0  5980  17
1   220  41
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811473.png
early stop counter: 5
val acc:0.9870689511299133, best validation acc: 0.9876543283462524, corresponding to test acc:                         0.9664429426193237 / 0.9691594839096069
after epoch: 18,now: 2024-05-25 01:13:06.574086,epoch time: 0:43:34.879970,used: 12:34:00.174436,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_39_06_seed_0_20811473
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99360615, 'precision': 0.95565575, 'recall': 0.94489014, 'specificity': 0.94489014, 'f1': 0.95020354, 'auroc': 0.9980469, 'binary_precision': 0.9150418, 'binary_recall': 0.89266306, 'binary_specificity': 0.9971172, 'binary_f1_score': 0.9037139}
confusion matrix:
       0     1
0  42198   122
1    158  1314
---- Validation: 
scalar performance:
{'acc': 0.9878672, 'precision': 0.9436126, 'recall': 0.86320907, 'specificity': 0.86320907, 'f1': 0.8990995, 'auroc': 0.9847722, 'binary_precision': 0.8967495, 'binary_recall': 0.7293935, 'binary_specificity': 0.99702466, 'binary_f1_score': 0.8044597}
confusion matrix:
       0    1
0  18095   54
1    174  469
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.87642366, 'recall': 0.5359816, 'specificity': 0.5359816, 'f1': 0.55656934, 'auroc': 0.934513, 'binary_precision': 0.7916667, 'binary_recall': 0.07279693, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.13333333}
confusion matrix:
      0   1
0  5992   5
1   242  19
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811473.png
better model found
persisted
after epoch: 19,now: 2024-05-25 01:52:18.670466,epoch time: 0:39:12.096380,used: 13:13:12.270816,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_39_06_seed_0_20811473
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9942455, 'precision': 0.9491669, 'recall': 0.9638856, 'specificity': 0.9638856, 'f1': 0.9563982, 'auroc': 0.99867797, 'binary_precision': 0.9007232, 'binary_recall': 0.9313392, 'binary_specificity': 0.996432, 'binary_f1_score': 0.9157754}
confusion matrix:
       0     1
0  42170   151
1    101  1370
---- Validation: 
scalar performance:
{'acc': 0.98797363, 'precision': 0.91707426, 'recall': 0.89701664, 'specificity': 0.89701664, 'f1': 0.906778, 'auroc': 0.98311573, 'binary_precision': 0.84124386, 'binary_recall': 0.7993779, 'binary_specificity': 0.9946554, 'binary_f1_score': 0.8197767}
confusion matrix:
       0    1
0  18052   97
1    129  514
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.7379774, 'recall': 0.531233, 'specificity': 0.531233, 'f1': 0.5471866, 'auroc': 0.9297398, 'binary_precision': 0.5151515, 'binary_recall': 0.0651341, 'binary_specificity': 0.997332, 'binary_f1_score': 0.11564625}
confusion matrix:
      0   1
0  5981  16
1   244  17
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811473.png
better model found
persisted
after epoch: 20,now: 2024-05-25 02:30:57.806193,epoch time: 0:38:39.135727,used: 13:51:51.406543,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_39_06_seed_0_20811473
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9946794, 'precision': 0.94827557, 'recall': 0.9726404, 'specificity': 0.9726404, 'f1': 0.96010983, 'auroc': 0.99897504, 'binary_precision': 0.8983269, 'binary_recall': 0.94901425, 'binary_specificity': 0.9962666, 'binary_f1_score': 0.9229752}
confusion matrix:
       0     1
0  42163   158
1     75  1396
---- Validation: 
scalar performance:
{'acc': 0.9868029, 'precision': 0.9072699, 'recall': 0.88891, 'specificity': 0.88891, 'f1': 0.8978605, 'auroc': 0.9813896, 'binary_precision': 0.822186, 'binary_recall': 0.7838258, 'binary_specificity': 0.9939942, 'binary_f1_score': 0.80254775}
confusion matrix:
       0    1
0  18040  109
1    139  504
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.7919022, 'recall': 0.58762044, 'specificity': 0.58762044, 'f1': 0.62948966, 'auroc': 0.92892504, 'binary_precision': 0.6184211, 'binary_recall': 0.18007663, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.27893177}
confusion matrix:
      0   1
0  5968  29
1   214  47
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811473.png
early stop counter: 1
val acc:0.986802875995636, best validation acc: 0.9879736304283142, corresponding to test acc:                         0.9584531784057617 / 0.9691594839096069
after epoch: 21,now: 2024-05-25 03:09:34.319911,epoch time: 0:38:36.513718,used: 14:30:27.920261,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_39_06_seed_0_20811473
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9954558, 'precision': 0.96890795, 'recall': 0.96060073, 'specificity': 0.96060073, 'f1': 0.9647144, 'auroc': 0.9985462, 'binary_precision': 0.9404844, 'binary_recall': 0.9232337, 'binary_specificity': 0.99796784, 'binary_f1_score': 0.93177927}
confusion matrix:
       0     1
0  42234    86
1    113  1359
---- Validation: 
scalar performance:
{'acc': 0.98706895, 'precision': 0.9193566, 'recall': 0.8770468, 'specificity': 0.8770468, 'f1': 0.89698696, 'auroc': 0.9805774, 'binary_precision': 0.8472222, 'binary_recall': 0.7589425, 'binary_specificity': 0.9951512, 'binary_f1_score': 0.80065626}
confusion matrix:
       0    1
0  18061   88
1    155  488
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608501, 'precision': 0.79867697, 'recall': 0.57096267, 'specificity': 0.57096267, 'f1': 0.60833496, 'auroc': 0.93564665, 'binary_precision': 0.6333333, 'binary_recall': 0.14559387, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.23676012}
confusion matrix:
      0   1
0  5975  22
1   223  38
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811473.png
early stop counter: 2
val acc:0.9870689511299133, best validation acc: 0.9879736304283142, corresponding to test acc:                         0.9584531784057617 / 0.9691594839096069
after epoch: 22,now: 2024-05-25 03:48:14.659756,epoch time: 0:38:40.339845,used: 15:09:08.260106,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_39_06_seed_0_20811473
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.995844, 'precision': 0.96461797, 'recall': 0.9719306, 'specificity': 0.9719306, 'f1': 0.9682435, 'auroc': 0.9991888, 'binary_precision': 0.9311037, 'binary_recall': 0.946295, 'binary_specificity': 0.9975662, 'binary_f1_score': 0.9386379}
confusion matrix:
       0     1
0  42218   103
1     79  1392
---- Validation: 
scalar performance:
{'acc': 0.98664325, 'precision': 0.91923285, 'recall': 0.8693259, 'specificity': 0.8693259, 'f1': 0.89257324, 'auroc': 0.9796049, 'binary_precision': 0.8475177, 'binary_recall': 0.7433904, 'binary_specificity': 0.99526143, 'binary_f1_score': 0.7920464}
confusion matrix:
       0    1
0  18063   86
1    165  478
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96228826, 'precision': 0.8068439, 'recall': 0.6028627, 'specificity': 0.6028627, 'f1': 0.6492636, 'auroc': 0.9173237, 'binary_precision': 0.64705884, 'binary_recall': 0.21072797, 'binary_specificity': 0.9949975, 'binary_f1_score': 0.31791908}
confusion matrix:
      0   1
0  5967  30
1   206  55
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811473.png
early stop counter: 3
val acc:0.9866432547569275, best validation acc: 0.9879736304283142, corresponding to test acc:                         0.9584531784057617 / 0.9691594839096069
after epoch: 23,now: 2024-05-25 04:26:52.244299,epoch time: 0:38:37.584543,used: 15:47:45.844649,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_39_06_seed_0_20811473
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9947022, 'precision': 0.9825767, 'recall': 0.93426573, 'specificity': 0.93426573, 'f1': 0.957055, 'auroc': 0.9991487, 'binary_precision': 0.969674, 'binary_recall': 0.86947656, 'binary_specificity': 0.99905485, 'binary_f1_score': 0.9168459}
confusion matrix:
       0     1
0  42281    40
1    192  1279
---- Validation: 
scalar performance:
{'acc': 0.98547256, 'precision': 0.9465791, 'recall': 0.8199662, 'specificity': 0.8199662, 'f1': 0.87205493, 'auroc': 0.982571, 'binary_precision': 0.90570176, 'binary_recall': 0.64230174, 'binary_specificity': 0.9976307, 'binary_f1_score': 0.7515924}
confusion matrix:
       0    1
0  18106   43
1    230  413
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9637264, 'precision': 0.8512434, 'recall': 0.59994847, 'specificity': 0.59994847, 'f1': 0.64984286, 'auroc': 0.9474035, 'binary_precision': 0.7361111, 'binary_recall': 0.20306513, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.3183183}
confusion matrix:
      0   1
0  5978  19
1   208  53
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811473.png
early stop counter: 4
val acc:0.985472559928894, best validation acc: 0.9879736304283142, corresponding to test acc:                         0.9584531784057617 / 0.9691594839096069
after epoch: 24,now: 2024-05-25 05:05:27.741401,epoch time: 0:38:35.497102,used: 16:26:21.341751,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_39_06_seed_0_20811473
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99378884, 'precision': 0.94477725, 'recall': 0.96168077, 'specificity': 0.96168077, 'f1': 0.95305884, 'auroc': 0.998706, 'binary_precision': 0.8920863, 'binary_recall': 0.92726034, 'binary_specificity': 0.9961012, 'binary_f1_score': 0.90933335}
confusion matrix:
       0     1
0  42156   165
1    107  1364
---- Validation: 
scalar performance:
{'acc': 0.9847807, 'precision': 0.89260787, 'recall': 0.87136185, 'specificity': 0.87136185, 'f1': 0.8816643, 'auroc': 0.9831474, 'binary_precision': 0.7940692, 'binary_recall': 0.7496112, 'binary_specificity': 0.99311256, 'binary_f1_score': 0.7712}
confusion matrix:
       0    1
0  18024  125
1    161  482
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.8188578, 'recall': 0.61060894, 'specificity': 0.61060894, 'f1': 0.6595616, 'auroc': 0.95588267, 'binary_precision': 0.67045456, 'binary_recall': 0.22605364, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.3381089}
confusion matrix:
      0   1
0  5968  29
1   202  59
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811473.png
early stop counter: 5
val acc:0.9847807288169861, best validation acc: 0.9879736304283142, corresponding to test acc:                         0.9584531784057617 / 0.9691594839096069
after epoch: 25,now: 2024-05-25 05:44:00.825692,epoch time: 0:38:33.084291,used: 17:04:54.426042,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_39_06_seed_0_20811473
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99394864, 'precision': 0.96762896, 'recall': 0.93719876, 'specificity': 0.93719876, 'f1': 0.9518634, 'auroc': 0.99876505, 'binary_precision': 0.93954843, 'binary_recall': 0.8763587, 'binary_specificity': 0.99803877, 'binary_f1_score': 0.9068541}
confusion matrix:
       0     1
0  42237    83
1    182  1290
---- Validation: 
scalar performance:
{'acc': 0.9856854, 'precision': 0.9445595, 'recall': 0.8253268, 'specificity': 0.8253268, 'f1': 0.87503207, 'auroc': 0.97500896, 'binary_precision': 0.90128756, 'binary_recall': 0.65318817, 'binary_specificity': 0.99746543, 'binary_f1_score': 0.7574391}
confusion matrix:
       0    1
0  18103   46
1    223  420
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614893, 'precision': 0.8782606, 'recall': 0.55114055, 'specificity': 0.55114055, 'f1': 0.58166534, 'auroc': 0.941152, 'binary_precision': 0.7941176, 'binary_recall': 0.10344828, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.18305086}
confusion matrix:
      0   1
0  5990   7
1   234  27
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811473.png
early stop counter: 6
val acc:0.985685408115387, best validation acc: 0.9879736304283142, corresponding to test acc:                         0.9584531784057617 / 0.9691594839096069
after epoch: 26,now: 2024-05-25 06:22:37.021727,epoch time: 0:38:36.196035,used: 17:43:30.622077,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_39_06_seed_0_20811473
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99607235, 'precision': 0.97755164, 'recall': 0.9612477, 'specificity': 0.9612477, 'f1': 0.9692474, 'auroc': 0.9990132, 'binary_precision': 0.9577465, 'binary_recall': 0.92391306, 'binary_specificity': 0.99858224, 'binary_f1_score': 0.94052565}
confusion matrix:
       0     1
0  42260    60
1    112  1360
---- Validation: 
scalar performance:
{'acc': 0.9871754, 'precision': 0.9375752, 'recall': 0.8576005, 'specificity': 0.8576005, 'f1': 0.8932578, 'auroc': 0.9743434, 'binary_precision': 0.88505745, 'binary_recall': 0.718507, 'binary_specificity': 0.996694, 'binary_f1_score': 0.793133}
confusion matrix:
       0    1
0  18089   60
1    181  462
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9643656, 'precision': 0.9303643, 'recall': 0.5819586, 'specificity': 0.5819586, 'f1': 0.6300245, 'auroc': 0.93540096, 'binary_precision': 0.8958333, 'binary_recall': 0.16475096, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.27831715}
confusion matrix:
      0   1
0  5992   5
1   218  43
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811473.png
early stop counter: 7
val acc:0.9871754050254822, best validation acc: 0.9879736304283142, corresponding to test acc:                         0.9584531784057617 / 0.9691594839096069
after epoch: 27,now: 2024-05-25 07:01:14.310039,epoch time: 0:38:37.288312,used: 18:22:07.910389,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_39_06_seed_0_20811473
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99575263, 'precision': 0.96928596, 'recall': 0.96497035, 'specificity': 0.96497035, 'f1': 0.9671174, 'auroc': 0.9993722, 'binary_precision': 0.94093406, 'binary_recall': 0.9319728, 'binary_specificity': 0.99796796, 'binary_f1_score': 0.93643194}
confusion matrix:
       0     1
0  42236    86
1    100  1370
---- Validation: 
scalar performance:
{'acc': 0.9875479, 'precision': 0.9406624, 'recall': 0.8607936, 'specificity': 0.8607936, 'f1': 0.89644426, 'auroc': 0.9779399, 'binary_precision': 0.8910134, 'binary_recall': 0.7247278, 'binary_specificity': 0.9968593, 'binary_f1_score': 0.79931384}
confusion matrix:
       0    1
0  18092   57
1    177  466
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606903, 'precision': 0.86963034, 'recall': 0.5397296, 'specificity': 0.5397296, 'f1': 0.5628578, 'auroc': 0.9435024, 'binary_precision': 0.7777778, 'binary_recall': 0.08045977, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.14583334}
confusion matrix:
      0   1
0  5991   6
1   240  21
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811473.png
early stop counter: 8
val acc:0.9875478744506836, best validation acc: 0.9879736304283142, corresponding to test acc:                         0.9584531784057617 / 0.9691594839096069
after epoch: 28,now: 2024-05-25 07:39:57.847060,epoch time: 0:38:43.537021,used: 19:00:51.447410,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_39_06_seed_0_20811473
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9953188, 'precision': 0.96044886, 'recall': 0.9680083, 'specificity': 0.9680083, 'f1': 0.9641954, 'auroc': 0.9992049, 'binary_precision': 0.9230254, 'binary_recall': 0.9387338, 'binary_specificity': 0.9972828, 'binary_f1_score': 0.9308134}
confusion matrix:
       0     1
0  42208   115
1     90  1379
---- Validation: 
scalar performance:
{'acc': 0.98589826, 'precision': 0.91059947, 'recall': 0.86669004, 'specificity': 0.86669004, 'f1': 0.8873033, 'auroc': 0.979637, 'binary_precision': 0.8304196, 'binary_recall': 0.7387247, 'binary_specificity': 0.9946554, 'binary_f1_score': 0.781893}
confusion matrix:
       0    1
0  18052   97
1    168  475
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96628314, 'precision': 0.86764777, 'recall': 0.6360968, 'specificity': 0.6360968, 'f1': 0.6941416, 'auroc': 0.94711006, 'binary_precision': 0.7659575, 'binary_recall': 0.27586207, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.4056338}
confusion matrix:
      0   1
0  5975  22
1   189  72
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811473.png
early stop counter: 9
val acc:0.9858982563018799, best validation acc: 0.9879736304283142, corresponding to test acc:                         0.9584531784057617 / 0.9691594839096069
after epoch: 29,now: 2024-05-25 08:18:48.532541,epoch time: 0:38:50.685481,used: 19:39:42.132891,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_39_06_seed_0_20811473
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9966204, 'precision': 0.9647294, 'recall': 0.98480916, 'specificity': 0.98480916, 'f1': 0.9745403, 'auroc': 0.99961114, 'binary_precision': 0.9304291, 'binary_recall': 0.97214675, 'binary_specificity': 0.99747163, 'binary_f1_score': 0.9508305}
confusion matrix:
       0     1
0  42213   107
1     41  1431
---- Validation: 
scalar performance:
{'acc': 0.98738825, 'precision': 0.91917104, 'recall': 0.88321257, 'specificity': 0.88321257, 'f1': 0.9003206, 'auroc': 0.98013407, 'binary_precision': 0.84641635, 'binary_recall': 0.7713841, 'binary_specificity': 0.9950411, 'binary_f1_score': 0.80716026}
confusion matrix:
       0    1
0  18059   90
1    147  496
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9638862, 'precision': 0.8343699, 'recall': 0.6146905, 'specificity': 0.6146905, 'f1': 0.66600066, 'auroc': 0.93915254, 'binary_precision': 0.7011494, 'binary_recall': 0.23371647, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.3505747}
confusion matrix:
      0   1
0  5971  26
1   200  61
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20811473.png
early stop counter: 10
val acc:0.9873882532119751, best validation acc: 0.9879736304283142, corresponding to test acc:                         0.9584531784057617 / 0.9691594839096069
after epoch: 30,now: 2024-05-25 08:57:34.259319,epoch time: 0:38:45.726778,used: 20:18:27.859669,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_12_39_06_seed_0_20811473
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 20:18:27.859669 at 2024-05-25 08:57:34.259319
persisted model performance metric: 

scalar performance:
{'acc': 0.958613, 'precision': 0.74602973, 'recall': 0.5313164, 'specificity': 0.5313164, 'f1': 0.54742575, 'auroc': 0.93249196, 'binary_precision': 0.53125, 'binary_recall': 0.0651341, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.11604095}
confusion matrix:
      0   1
0  5982  15
1   244  17
oracle model performance metric: 

scalar performance:
{'acc': 0.96628314, 'precision': 0.87340575, 'recall': 0.6324321, 'specificity': 0.6324321, 'f1': 0.69075775, 'auroc': 0.95667934, 'binary_precision': 0.7777778, 'binary_recall': 0.26819924, 'binary_specificity': 0.996665, 'binary_f1_score': 0.3988604}
confusion matrix:
      0   1
0  5977  20
1   191  70
results aggregation path: zoutput/benchmarks/CAMELYON_center0_vit_irm/rule_results/0.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_vit_irm/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_vit_irm/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1661 MiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |   1655 MiB |  15779 MiB |    977 TiB |    977 TiB |
|       from small pool |      6 MiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1661 MiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |   1655 MiB |  15779 MiB |    977 TiB |    977 TiB |
|       from small pool |      6 MiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1653 MiB |  15770 MiB |    987 TiB |    987 TiB |
|       from large pool |   1647 MiB |  15745 MiB |    974 TiB |    974 TiB |
|       from small pool |      5 MiB |     25 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  16730 MiB |  16730 MiB |  16730 MiB |      0 B   |
|       from large pool |  16702 MiB |  16702 MiB |  16702 MiB |      0 B   |
|       from small pool |     28 MiB |     28 MiB |     28 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 430238 KiB |    863 MiB | 413556 GiB | 413555 GiB |
|       from large pool | 410304 KiB |    862 MiB | 400661 GiB | 400660 GiB |
|       from small pool |  19934 KiB |     21 MiB |  12895 GiB |  12894 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3366    |    6357    |  152169 K  |  152166 K  |
|       from large pool |     247    |     989    |   62327 K  |   62326 K  |
|       from small pool |    3119    |    6108    |   89842 K  |   89839 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3366    |    6357    |  152169 K  |  152166 K  |
|       from large pool |     247    |     989    |   62327 K  |   62326 K  |
|       from small pool |    3119    |    6108    |   89842 K  |   89839 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     621    |     621    |     621    |       0    |
|       from large pool |     607    |     607    |     607    |       0    |
|       from small pool |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     144    |    2871    |   89993 K  |   89993 K  |
|       from large pool |     112    |     516    |   47275 K  |   47275 K  |
|       from small pool |      32    |    2759    |   42718 K  |   42718 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |  16640 KiB |  15779 MiB |    977 TiB |    977 TiB |
|       from small pool |      0 KiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |  16640 KiB |  15779 MiB |    977 TiB |    977 TiB |
|       from small pool |      0 KiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15770 MiB |    987 TiB |    987 TiB |
|       from large pool |  16640 KiB |  15745 MiB |    974 TiB |    974 TiB |
|       from small pool |      0 KiB |     25 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2082 MiB |  16730 MiB |  16730 MiB |  14648 MiB |
|       from large pool |   2056 MiB |  16702 MiB |  16702 MiB |  14646 MiB |
|       from small pool |     26 MiB |     28 MiB |     28 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    863 MiB | 413557 GiB | 413557 GiB |
|       from large pool |  24320 KiB |    862 MiB | 400662 GiB | 400662 GiB |
|       from small pool |      0 KiB |     24 MiB |  12895 GiB |  12895 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6357    |  152169 K  |  152169 K  |
|       from large pool |       2    |     989    |   62327 K  |   62327 K  |
|       from small pool |       0    |    6108    |   89842 K  |   89842 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6357    |  152169 K  |  152169 K  |
|       from large pool |       2    |     989    |   62327 K  |   62327 K  |
|       from small pool |       0    |    6108    |   89842 K  |   89842 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     115    |     621    |     621    |     506    |
|       from large pool |     102    |     607    |     607    |     505    |
|       from small pool |      13    |      14    |      14    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    2871    |   89995 K  |   89995 K  |
|       from large pool |       2    |     516    |   47275 K  |   47275 K  |
|       from small pool |       0    |    2759    |   42719 K  |   42719 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat May 25 09:00:32 2024]
Finished job 0.
1 of 1 steps (100%) done
