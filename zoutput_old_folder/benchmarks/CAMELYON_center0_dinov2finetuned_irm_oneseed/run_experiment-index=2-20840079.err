Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat May 25 10:15:37 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_dinov2finetuned_irm/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_dinov2finetuned_irm/rule_results/2.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=2
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_29_seed_0_20840079

 Experiment start at: 2024-05-25 10:22:29.572701
before training, model accuracy: 0.6481304168701172
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9726434, 'precision': 0.78288114, 'recall': 0.8418146, 'specificity': 0.8418146, 'f1': 0.8092666, 'auroc': 0.96889377, 'binary_precision': 0.57621443, 'binary_recall': 0.70156354, 'binary_specificity': 0.9820656, 'binary_f1_score': 0.6327407}
confusion matrix:
       0     1
0  41562   759
1    439  1032
---- Validation: 
scalar performance:
{'acc': 0.971424, 'precision': 0.80887437, 'recall': 0.6851837, 'specificity': 0.6851837, 'f1': 0.7301928, 'auroc': 0.96506965, 'binary_precision': 0.6394737, 'binary_recall': 0.377916, 'binary_specificity': 0.99245137, 'binary_f1_score': 0.47507334}
confusion matrix:
       0    1
0  18012  137
1    400  243
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9715564, 'precision': 0.83262175, 'recall': 0.7909319, 'specificity': 0.7909319, 'f1': 0.8102236, 'auroc': 0.9486103, 'binary_precision': 0.68281937, 'binary_recall': 0.59386975, 'binary_specificity': 0.987994, 'binary_f1_score': 0.635246}
confusion matrix:
      0    1
0  5925   72
1   106  155
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20840079.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-25 10:50:36.934839,epoch time: 0:28:07.362138,used: 0:28:07.362138,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_29_seed_0_20840079
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9784892, 'precision': 0.87941766, 'recall': 0.75034904, 'specificity': 0.75034904, 'f1': 0.80064166, 'auroc': 0.98085856, 'binary_precision': 0.77580816, 'binary_recall': 0.5057784, 'binary_specificity': 0.9949198, 'binary_f1_score': 0.61234564}
confusion matrix:
       0    1
0  42106  215
1    727  744
---- Validation: 
scalar performance:
{'acc': 0.9787676, 'precision': 0.86459243, 'recall': 0.7857427, 'specificity': 0.7857427, 'f1': 0.81998473, 'auroc': 0.972697, 'binary_precision': 0.744, 'binary_recall': 0.5785381, 'binary_specificity': 0.9929473, 'binary_f1_score': 0.65091866}
confusion matrix:
       0    1
0  18021  128
1    271  372
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96692234, 'precision': 0.86036587, 'recall': 0.6529213, 'specificity': 0.6529213, 'f1': 0.7109916, 'auroc': 0.9601896, 'binary_precision': 0.75, 'binary_recall': 0.31034482, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.4390244}
confusion matrix:
      0   1
0  5970  27
1   180  81
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20840079.png
better model found
persisted
after epoch: 2,now: 2024-05-25 11:17:27.404506,epoch time: 0:26:50.469667,used: 0:54:57.831805,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_29_seed_0_20840079
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.977416, 'precision': 0.9349396, 'recall': 0.68581617, 'specificity': 0.68581617, 'f1': 0.75727314, 'auroc': 0.98486495, 'binary_precision': 0.89123374, 'binary_recall': 0.3732155, 'binary_specificity': 0.99841684, 'binary_f1_score': 0.526114}
confusion matrix:
       0    1
0  42254   67
1    922  549
---- Validation: 
scalar performance:
{'acc': 0.9771711, 'precision': 0.92644477, 'recall': 0.69340944, 'specificity': 0.69340944, 'f1': 0.76325476, 'auroc': 0.9781874, 'binary_precision': 0.8741259, 'binary_recall': 0.3888025, 'binary_specificity': 0.9980164, 'binary_f1_score': 0.5382132}
confusion matrix:
       0    1
0  18113   36
1    393  250
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9651646, 'precision': 0.88492227, 'recall': 0.6080282, 'specificity': 0.6080282, 'f1': 0.6627406, 'auroc': 0.95431066, 'binary_precision': 0.8028169, 'binary_recall': 0.21839081, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.3433735}
confusion matrix:
      0   1
0  5983  14
1   204  57
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20840079.png
early stop counter: 1
val acc:0.9771711230278015, best validation acc: 0.9787675738334656, corresponding to test acc:                         0.9669223427772522 / 0.9715564250946045
after epoch: 3,now: 2024-05-25 11:44:14.002807,epoch time: 0:26:46.598301,used: 1:21:44.430106,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_29_seed_0_20840079
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9848374, 'precision': 0.8937509, 'recall': 0.8652735, 'specificity': 0.8652735, 'f1': 0.87893367, 'auroc': 0.984632, 'binary_precision': 0.79662263, 'binary_recall': 0.7370924, 'binary_specificity': 0.99345464, 'binary_f1_score': 0.7657022}
confusion matrix:
       0     1
0  42043   277
1    387  1085
---- Validation: 
scalar performance:
{'acc': 0.9835568, 'precision': 0.9006435, 'recall': 0.83472556, 'specificity': 0.83472556, 'f1': 0.8644904, 'auroc': 0.9777794, 'binary_precision': 0.81273407, 'binary_recall': 0.6749611, 'binary_specificity': 0.99449, 'binary_f1_score': 0.7374681}
confusion matrix:
       0    1
0  18049  100
1    209  434
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.965644, 'precision': 0.8475567, 'recall': 0.63942796, 'specificity': 0.63942796, 'f1': 0.6950112, 'auroc': 0.95763034, 'binary_precision': 0.7254902, 'binary_recall': 0.2835249, 'binary_specificity': 0.995331, 'binary_f1_score': 0.4077135}
confusion matrix:
      0   1
0  5969  28
1   187  74
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20840079.png
better model found
persisted
after epoch: 4,now: 2024-05-25 12:11:15.175869,epoch time: 0:27:01.173062,used: 1:48:45.603168,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_29_seed_0_20840079
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98323894, 'precision': 0.85483384, 'recall': 0.91034675, 'specificity': 0.91034675, 'f1': 0.88038784, 'auroc': 0.9865011, 'binary_precision': 0.71553737, 'binary_recall': 0.83220106, 'binary_specificity': 0.9884924, 'binary_f1_score': 0.76947236}
confusion matrix:
       0     1
0  41833   487
1    247  1225
---- Validation: 
scalar performance:
{'acc': 0.98361003, 'precision': 0.8669671, 'recall': 0.8955076, 'specificity': 0.8955076, 'f1': 0.8806541, 'auroc': 0.97979665, 'binary_precision': 0.7410072, 'binary_recall': 0.8009331, 'binary_specificity': 0.9900821, 'binary_f1_score': 0.76980567}
confusion matrix:
       0    1
0  17969  180
1    128  515
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9682007, 'precision': 0.86531854, 'recall': 0.67191166, 'specificity': 0.67191166, 'f1': 0.7306457, 'auroc': 0.9617039, 'binary_precision': 0.7583333, 'binary_recall': 0.348659, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.47769025}
confusion matrix:
      0   1
0  5968  29
1   170  91
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20840079.png
better model found
persisted
after epoch: 5,now: 2024-05-25 12:38:11.221515,epoch time: 0:26:56.045646,used: 2:15:41.648814,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_29_seed_0_20840079
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9848374, 'precision': 0.94855684, 'recall': 0.8033081, 'specificity': 0.8033081, 'f1': 0.86092085, 'auroc': 0.986692, 'binary_precision': 0.91056913, 'binary_recall': 0.6086956, 'binary_specificity': 0.99792063, 'binary_f1_score': 0.7296417}
confusion matrix:
       0    1
0  42232   88
1    576  896
---- Validation: 
scalar performance:
{'acc': 0.9786079, 'precision': 0.94546866, 'recall': 0.70690423, 'specificity': 0.70690423, 'f1': 0.7797718, 'auroc': 0.9793192, 'binary_precision': 0.9112628, 'binary_recall': 0.41524106, 'binary_specificity': 0.9985674, 'binary_f1_score': 0.57051283}
confusion matrix:
       0    1
0  18123   26
1    376  267
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96276766, 'precision': 0.8420195, 'recall': 0.5866219, 'specificity': 0.5866219, 'f1': 0.63198227, 'auroc': 0.95987236, 'binary_precision': 0.71875, 'binary_recall': 0.17624521, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.2830769}
confusion matrix:
      0   1
0  5979  18
1   215  46
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20840079.png
early stop counter: 1
val acc:0.9786078929901123, best validation acc: 0.9836100339889526, corresponding to test acc:                         0.96820068359375 / 0.9715564250946045
after epoch: 6,now: 2024-05-25 13:05:03.656328,epoch time: 0:26:52.434813,used: 2:42:34.083627,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_29_seed_0_20840079
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.980179, 'precision': 0.96243274, 'recall': 0.7176217, 'specificity': 0.7176217, 'f1': 0.7932471, 'auroc': 0.9884553, 'binary_precision': 0.94411767, 'binary_recall': 0.4361413, 'binary_specificity': 0.99910206, 'binary_f1_score': 0.59665424}
confusion matrix:
       0    1
0  42282   38
1    830  642
---- Validation: 
scalar performance:
{'acc': 0.9765858, 'precision': 0.9680339, 'recall': 0.6646043, 'specificity': 0.6646043, 'f1': 0.7393791, 'auroc': 0.9809848, 'binary_precision': 0.959276, 'binary_recall': 0.32970452, 'binary_specificity': 0.9995041, 'binary_f1_score': 0.4907408}
confusion matrix:
       0    1
0  18140    9
1    431  212
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.8136451, 'recall': 0.616106, 'specificity': 0.616106, 'f1': 0.6651503, 'auroc': 0.95282125, 'binary_precision': 0.65957445, 'binary_recall': 0.23754789, 'binary_specificity': 0.994664, 'binary_f1_score': 0.3492958}
confusion matrix:
      0   1
0  5965  32
1   199  62
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20840079.png
early stop counter: 2
val acc:0.9765858054161072, best validation acc: 0.9836100339889526, corresponding to test acc:                         0.96820068359375 / 0.9715564250946045
after epoch: 7,now: 2024-05-25 13:32:09.679094,epoch time: 0:27:06.022766,used: 3:09:40.106393,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_29_seed_0_20840079
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9867327, 'precision': 0.88192976, 'recall': 0.9285474, 'specificity': 0.9285474, 'f1': 0.9037783, 'auroc': 0.9919474, 'binary_precision': 0.76853526, 'binary_recall': 0.8661685, 'binary_specificity': 0.99092627, 'binary_f1_score': 0.81443626}
confusion matrix:
       0     1
0  41936   384
1    197  1275
---- Validation: 
scalar performance:
{'acc': 0.98632395, 'precision': 0.8976459, 'recall': 0.8946625, 'specificity': 0.8946625, 'f1': 0.8961481, 'auroc': 0.9819796, 'binary_precision': 0.8025078, 'binary_recall': 0.7962675, 'binary_specificity': 0.9930575, 'binary_f1_score': 0.7993755}
confusion matrix:
       0    1
0  18023  126
1    131  512
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96692234, 'precision': 0.83174473, 'recall': 0.68407094, 'specificity': 0.68407094, 'f1': 0.73463166, 'auroc': 0.959635, 'binary_precision': 0.69014084, 'binary_recall': 0.37547892, 'binary_specificity': 0.992663, 'binary_f1_score': 0.48635238}
confusion matrix:
      0   1
0  5953  44
1   163  98
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20840079.png
better model found
persisted
after epoch: 8,now: 2024-05-25 13:59:05.802531,epoch time: 0:26:56.123437,used: 3:36:36.229830,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_29_seed_0_20840079
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9858878, 'precision': 0.8666452, 'recall': 0.9458146, 'specificity': 0.9458146, 'f1': 0.90201247, 'auroc': 0.9921479, 'binary_precision': 0.73669624, 'binary_recall': 0.90285325, 'binary_specificity': 0.98877597, 'binary_f1_score': 0.8113553}
confusion matrix:
       0     1
0  41845   475
1    143  1329
---- Validation: 
scalar performance:
{'acc': 0.9848872, 'precision': 0.87875676, 'recall': 0.899169, 'specificity': 0.899169, 'f1': 0.88867104, 'auroc': 0.983284, 'binary_precision': 0.76435935, 'binary_recall': 0.80715394, 'binary_specificity': 0.9911841, 'binary_f1_score': 0.78517395}
confusion matrix:
       0    1
0  17989  160
1    124  519
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96644294, 'precision': 0.8223932, 'recall': 0.6874855, 'specificity': 0.6874855, 'f1': 0.7352291, 'auroc': 0.9589658, 'binary_precision': 0.67114097, 'binary_recall': 0.38314176, 'binary_specificity': 0.9918293, 'binary_f1_score': 0.4878049}
confusion matrix:
      0    1
0  5948   49
1   161  100
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20840079.png
early stop counter: 1
val acc:0.9848871827125549, best validation acc: 0.9863239526748657, corresponding to test acc:                         0.9669223427772522 / 0.9715564250946045
after epoch: 9,now: 2024-05-25 14:25:57.300767,epoch time: 0:26:51.498236,used: 4:03:27.728066,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_29_seed_0_20840079
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98725796, 'precision': 0.9349353, 'recall': 0.8580016, 'specificity': 0.8580016, 'f1': 0.892454, 'auroc': 0.991464, 'binary_precision': 0.8795681, 'binary_recall': 0.7194294, 'binary_specificity': 0.99657375, 'binary_f1_score': 0.7914798}
confusion matrix:
       0     1
0  42175   145
1    413  1059
---- Validation: 
scalar performance:
{'acc': 0.98403573, 'precision': 0.93933237, 'recall': 0.8019711, 'specificity': 0.8019711, 'f1': 0.857002, 'auroc': 0.9797693, 'binary_precision': 0.8924485, 'binary_recall': 0.60653186, 'binary_specificity': 0.9974103, 'binary_f1_score': 0.72222227}
confusion matrix:
       0    1
0  18102   47
1    253  390
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964046, 'precision': 0.8654709, 'recall': 0.5982828, 'specificity': 0.5982828, 'f1': 0.64882356, 'auroc': 0.95789593, 'binary_precision': 0.7647059, 'binary_recall': 0.19923371, 'binary_specificity': 0.997332, 'binary_f1_score': 0.31610942}
confusion matrix:
      0   1
0  5981  16
1   209  52
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20840079.png
early stop counter: 2
val acc:0.9840357303619385, best validation acc: 0.9863239526748657, corresponding to test acc:                         0.9669223427772522 / 0.9715564250946045
after epoch: 10,now: 2024-05-25 14:52:50.483501,epoch time: 0:26:53.182734,used: 4:30:20.910800,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_29_seed_0_20840079
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9867784, 'precision': 0.89750004, 'recall': 0.8993256, 'specificity': 0.8993256, 'f1': 0.89841056, 'auroc': 0.99129987, 'binary_precision': 0.8017591, 'binary_recall': 0.8055744, 'binary_specificity': 0.99307674, 'binary_f1_score': 0.80366224}
confusion matrix:
       0     1
0  42028   293
1    286  1185
---- Validation: 
scalar performance:
{'acc': 0.98403573, 'precision': 0.8804017, 'recall': 0.8769766, 'specificity': 0.8769766, 'f1': 0.8786807, 'auroc': 0.981359, 'binary_precision': 0.7692308, 'binary_recall': 0.7620529, 'binary_specificity': 0.9919004, 'binary_f1_score': 0.765625}
confusion matrix:
       0    1
0  18002  147
1    153  490
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96724194, 'precision': 0.82495487, 'recall': 0.7025611, 'specificity': 0.7025611, 'f1': 0.7480575, 'auroc': 0.95515335, 'binary_precision': 0.675, 'binary_recall': 0.41379312, 'binary_specificity': 0.991329, 'binary_f1_score': 0.5130641}
confusion matrix:
      0    1
0  5945   52
1   153  108
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20840079.png
early stop counter: 3
val acc:0.9840357303619385, best validation acc: 0.9863239526748657, corresponding to test acc:                         0.9669223427772522 / 0.9715564250946045
after epoch: 11,now: 2024-05-25 15:19:44.864911,epoch time: 0:26:54.381410,used: 4:57:15.292210,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_29_seed_0_20840079
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99066037, 'precision': 0.95483553, 'recall': 0.8957565, 'specificity': 0.8957565, 'f1': 0.92309046, 'auroc': 0.99421865, 'binary_precision': 0.91679746, 'binary_recall': 0.7940177, 'binary_specificity': 0.99749535, 'binary_f1_score': 0.85100174}
confusion matrix:
       0     1
0  42215   106
1    303  1168
---- Validation: 
scalar performance:
{'acc': 0.98781395, 'precision': 0.93711925, 'recall': 0.869182, 'specificity': 0.869182, 'f1': 0.9000666, 'auroc': 0.9834463, 'binary_precision': 0.8833333, 'binary_recall': 0.7418352, 'binary_specificity': 0.99652874, 'binary_f1_score': 0.8064243}
confusion matrix:
       0    1
0  18086   63
1    166  477
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650048, 'precision': 0.84839904, 'recall': 0.62626815, 'specificity': 0.62626815, 'f1': 0.680799, 'auroc': 0.9621062, 'binary_precision': 0.7282609, 'binary_recall': 0.256705, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.3796034}
confusion matrix:
      0   1
0  5972  25
1   194  67
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20840079.png
better model found
persisted
after epoch: 12,now: 2024-05-25 15:46:22.760978,epoch time: 0:26:37.896067,used: 5:23:53.188277,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_29_seed_0_20840079
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.988354, 'precision': 0.8976977, 'recall': 0.9320091, 'specificity': 0.9320091, 'f1': 0.91408265, 'auroc': 0.99366903, 'binary_precision': 0.7998753, 'binary_recall': 0.87160325, 'binary_specificity': 0.99241495, 'binary_f1_score': 0.8342003}
confusion matrix:
       0     1
0  41999   321
1    189  1283
---- Validation: 
scalar performance:
{'acc': 0.98318434, 'precision': 0.85839933, 'recall': 0.906538, 'specificity': 0.906538, 'f1': 0.88081074, 'auroc': 0.9816555, 'binary_precision': 0.72305596, 'binary_recall': 0.82426125, 'binary_specificity': 0.98881483, 'binary_f1_score': 0.77034885}
confusion matrix:
       0    1
0  17946  203
1    113  530
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96212846, 'precision': 0.7861755, 'recall': 0.63026434, 'specificity': 0.63026434, 'f1': 0.67591447, 'auroc': 0.9525145, 'binary_precision': 0.6034483, 'binary_recall': 0.26819924, 'binary_specificity': 0.9923295, 'binary_f1_score': 0.3713528}
confusion matrix:
      0   1
0  5951  46
1   191  70
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20840079.png
early stop counter: 1
val acc:0.9831843376159668, best validation acc: 0.9878139495849609, corresponding to test acc:                         0.9650048017501831 / 0.9715564250946045
after epoch: 13,now: 2024-05-25 16:13:02.094011,epoch time: 0:26:39.333033,used: 5:50:32.521310,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_29_seed_0_20840079
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9895415, 'precision': 0.97848463, 'recall': 0.8562323, 'specificity': 0.8562323, 'f1': 0.9077836, 'auroc': 0.99677825, 'binary_precision': 0.9668508, 'binary_recall': 0.7133152, 'binary_specificity': 0.9991493, 'binary_f1_score': 0.82095385}
confusion matrix:
       0     1
0  42284    36
1    422  1050
---- Validation: 
scalar performance:
{'acc': 0.98499364, 'precision': 0.9701541, 'recall': 0.7942164, 'specificity': 0.7942164, 'f1': 0.8605647, 'auroc': 0.98309624, 'binary_precision': 0.95465994, 'binary_recall': 0.58942455, 'binary_specificity': 0.99900824, 'binary_f1_score': 0.72884613}
confusion matrix:
       0    1
0  18131   18
1    264  379
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96260786, 'precision': 0.85499394, 'recall': 0.57737684, 'specificity': 0.57737684, 'f1': 0.62015665, 'auroc': 0.96198845, 'binary_precision': 0.74545455, 'binary_recall': 0.15708812, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.25949365}
confusion matrix:
      0   1
0  5983  14
1   220  41
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20840079.png
early stop counter: 2
val acc:0.9849936366081238, best validation acc: 0.9878139495849609, corresponding to test acc:                         0.9650048017501831 / 0.9715564250946045
after epoch: 14,now: 2024-05-25 16:39:51.729316,epoch time: 0:26:49.635305,used: 6:17:22.156615,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_29_seed_0_20840079
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9927384, 'precision': 0.9723723, 'recall': 0.91257995, 'specificity': 0.91257995, 'f1': 0.94030756, 'auroc': 0.99741435, 'binary_precision': 0.9507428, 'binary_recall': 0.82664853, 'binary_specificity': 0.9985114, 'binary_f1_score': 0.8843636}
confusion matrix:
       0     1
0  42258    63
1    255  1216
---- Validation: 
scalar performance:
{'acc': 0.9889315, 'precision': 0.95421785, 'recall': 0.8705106, 'specificity': 0.8705106, 'f1': 0.90779734, 'auroc': 0.9848902, 'binary_precision': 0.9174664, 'binary_recall': 0.7433904, 'binary_specificity': 0.9976307, 'binary_f1_score': 0.8213059}
confusion matrix:
       0    1
0  18106   43
1    165  478
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9654842, 'precision': 0.8763021, 'recall': 0.6173566, 'specificity': 0.6173566, 'f1': 0.673483, 'auroc': 0.96087074, 'binary_precision': 0.7848101, 'binary_recall': 0.23754789, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.36470586}
confusion matrix:
      0   1
0  5980  17
1   199  62
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20840079.png
better model found
persisted
after epoch: 15,now: 2024-05-25 17:06:26.373285,epoch time: 0:26:34.643969,used: 6:43:56.800584,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_29_seed_0_20840079
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9914596, 'precision': 0.9492605, 'recall': 0.9155836, 'specificity': 0.9155836, 'f1': 0.93171585, 'auroc': 0.99642444, 'binary_precision': 0.904271, 'binary_recall': 0.8342391, 'binary_specificity': 0.99692816, 'binary_f1_score': 0.8678445}
confusion matrix:
       0     1
0  42190   130
1    244  1228
---- Validation: 
scalar performance:
{'acc': 0.9875479, 'precision': 0.9291855, 'recall': 0.8735445, 'specificity': 0.8735445, 'f1': 0.8992843, 'auroc': 0.9824311, 'binary_precision': 0.8671454, 'binary_recall': 0.7511664, 'binary_specificity': 0.9959226, 'binary_f1_score': 0.805}
confusion matrix:
       0    1
0  18075   74
1    160  483
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642058, 'precision': 0.83567625, 'recall': 0.62035424, 'specificity': 0.62035424, 'f1': 0.6726107, 'auroc': 0.9526695, 'binary_precision': 0.7032967, 'binary_recall': 0.24521072, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.36363634}
confusion matrix:
      0   1
0  5970  27
1   197  64
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20840079.png
early stop counter: 1
val acc:0.9875478744506836, best validation acc: 0.9889314770698547, corresponding to test acc:                         0.9654842019081116 / 0.9715564250946045
after epoch: 16,now: 2024-05-25 17:33:04.658069,epoch time: 0:26:38.284784,used: 7:10:35.085368,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_29_seed_0_20840079
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9927384, 'precision': 0.96708024, 'recall': 0.9178846, 'specificity': 0.9178846, 'f1': 0.9410129, 'auroc': 0.9967581, 'binary_precision': 0.9397866, 'binary_recall': 0.8376359, 'binary_specificity': 0.99813324, 'binary_f1_score': 0.88577586}
confusion matrix:
       0     1
0  42241    79
1    239  1233
---- Validation: 
scalar performance:
{'acc': 0.9863772, 'precision': 0.950423, 'recall': 0.8316854, 'specificity': 0.8316854, 'f1': 0.8813826, 'auroc': 0.98327637, 'binary_precision': 0.91257995, 'binary_recall': 0.66562986, 'binary_specificity': 0.9977409, 'binary_f1_score': 0.76978415}
confusion matrix:
       0    1
0  18108   41
1    215  428
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.7698262, 'recall': 0.56304973, 'specificity': 0.56304973, 'f1': 0.5959187, 'auroc': 0.94670165, 'binary_precision': 0.5762712, 'binary_recall': 0.1302682, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.21249999}
confusion matrix:
      0   1
0  5972  25
1   227  34
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20840079.png
early stop counter: 2
val acc:0.9863771796226501, best validation acc: 0.9889314770698547, corresponding to test acc:                         0.9654842019081116 / 0.9715564250946045
after epoch: 17,now: 2024-05-25 17:59:51.424132,epoch time: 0:26:46.766063,used: 7:37:21.851431,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_29_seed_0_20840079
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9932636, 'precision': 0.94446355, 'recall': 0.95290935, 'specificity': 0.95290935, 'f1': 0.94864357, 'auroc': 0.9971769, 'binary_precision': 0.89207196, 'binary_recall': 0.90964675, 'binary_specificity': 0.996172, 'binary_f1_score': 0.90077364}
confusion matrix:
       0     1
0  42158   162
1    133  1339
---- Validation: 
scalar performance:
{'acc': 0.9866965, 'precision': 0.90071344, 'recall': 0.89710546, 'specificity': 0.89710546, 'f1': 0.89890057, 'auroc': 0.98309606, 'binary_precision': 0.8084772, 'binary_recall': 0.8009331, 'binary_specificity': 0.99327785, 'binary_f1_score': 0.8046875}
confusion matrix:
       0    1
0  18027  122
1    128  515
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96180886, 'precision': 0.7932403, 'recall': 0.6062773, 'specificity': 0.6062773, 'f1': 0.6516482, 'auroc': 0.9597645, 'binary_precision': 0.6195652, 'binary_recall': 0.21839081, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.32294616}
confusion matrix:
      0   1
0  5962  35
1   204  57
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20840079.png
early stop counter: 3
val acc:0.9866964817047119, best validation acc: 0.9889314770698547, corresponding to test acc:                         0.9654842019081116 / 0.9715564250946045
after epoch: 18,now: 2024-05-25 18:26:37.016108,epoch time: 0:26:45.591976,used: 8:04:07.443407,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_29_seed_0_20840079
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.992099, 'precision': 0.9525465, 'recall': 0.92279947, 'specificity': 0.92279947, 'f1': 0.93712866, 'auroc': 0.9966322, 'binary_precision': 0.91034985, 'binary_recall': 0.84850544, 'binary_specificity': 0.99709356, 'binary_f1_score': 0.87834036}
confusion matrix:
       0     1
0  42197   123
1    223  1249
---- Validation: 
scalar performance:
{'acc': 0.9861111, 'precision': 0.94643533, 'recall': 0.83079755, 'specificity': 0.83079755, 'f1': 0.8793812, 'auroc': 0.98296106, 'binary_precision': 0.904661, 'binary_recall': 0.66407466, 'binary_specificity': 0.9975205, 'binary_f1_score': 0.76591927}
confusion matrix:
       0    1
0  18104   45
1    216  427
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96324706, 'precision': 0.8339045, 'recall': 0.6015307, 'specificity': 0.6015307, 'f1': 0.65032005, 'auroc': 0.95212114, 'binary_precision': 0.7012987, 'binary_recall': 0.20689656, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.31952664}
confusion matrix:
      0   1
0  5974  23
1   207  54
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20840079.png
early stop counter: 4
val acc:0.9861111044883728, best validation acc: 0.9889314770698547, corresponding to test acc:                         0.9654842019081116 / 0.9715564250946045
after epoch: 19,now: 2024-05-25 18:53:24.977702,epoch time: 0:26:47.961594,used: 8:30:55.405001,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_29_seed_0_20840079
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.98901623, 'precision': 0.89043933, 'recall': 0.96087545, 'specificity': 0.96087545, 'f1': 0.92248297, 'auroc': 0.99675995, 'binary_precision': 0.78330475, 'binary_recall': 0.9307065, 'binary_specificity': 0.9910444, 'binary_f1_score': 0.8506675}
confusion matrix:
       0     1
0  41941   379
1    102  1370
---- Validation: 
scalar performance:
{'acc': 0.98547256, 'precision': 0.8878261, 'recall': 0.89422166, 'specificity': 0.89422166, 'f1': 0.8909955, 'auroc': 0.9771457, 'binary_precision': 0.78287464, 'binary_recall': 0.7962675, 'binary_specificity': 0.9921759, 'binary_f1_score': 0.7895143}
confusion matrix:
       0    1
0  18007  142
1    131  512
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614893, 'precision': 0.7939743, 'recall': 0.5951165, 'specificity': 0.5951165, 'f1': 0.63878906, 'auroc': 0.93979144, 'binary_precision': 0.6219512, 'binary_recall': 0.1954023, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.2973761}
confusion matrix:
      0   1
0  5966  31
1   210  51
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20840079.png
early stop counter: 5
val acc:0.985472559928894, best validation acc: 0.9889314770698547, corresponding to test acc:                         0.9654842019081116 / 0.9715564250946045
after epoch: 20,now: 2024-05-25 19:20:18.300871,epoch time: 0:26:53.323169,used: 8:57:48.728170,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_29_seed_0_20840079
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9926242, 'precision': 0.93939155, 'recall': 0.9483164, 'specificity': 0.9483164, 'f1': 0.9438055, 'auroc': 0.9971102, 'binary_precision': 0.8822355, 'binary_recall': 0.9008152, 'binary_specificity': 0.9958176, 'binary_f1_score': 0.89142853}
confusion matrix:
       0     1
0  42143   177
1    146  1326
---- Validation: 
scalar performance:
{'acc': 0.9863772, 'precision': 0.9132582, 'recall': 0.8721884, 'specificity': 0.8721884, 'f1': 0.89156204, 'auroc': 0.98585665, 'binary_precision': 0.8353553, 'binary_recall': 0.7496112, 'binary_specificity': 0.9947656, 'binary_f1_score': 0.790164}
confusion matrix:
       0    1
0  18054   95
1    161  482
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650048, 'precision': 0.830409, 'recall': 0.64275914, 'specificity': 0.64275914, 'f1': 0.6958357, 'auroc': 0.96153986, 'binary_precision': 0.6909091, 'binary_recall': 0.29118773, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.40970352}
confusion matrix:
      0   1
0  5963  34
1   185  76
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20840079.png
early stop counter: 6
val acc:0.9863771796226501, best validation acc: 0.9889314770698547, corresponding to test acc:                         0.9654842019081116 / 0.9715564250946045
after epoch: 21,now: 2024-05-25 19:47:16.014810,epoch time: 0:26:57.713939,used: 9:24:46.442109,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_29_seed_0_20840079
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9930124, 'precision': 0.94644475, 'recall': 0.94585884, 'specificity': 0.94585884, 'f1': 0.9461516, 'auroc': 0.9975022, 'binary_precision': 0.89652824, 'binary_recall': 0.8953093, 'binary_specificity': 0.9964084, 'binary_f1_score': 0.89591837}
confusion matrix:
       0     1
0  42169   152
1    154  1317
---- Validation: 
scalar performance:
{'acc': 0.9853129, 'precision': 0.91873324, 'recall': 0.84538543, 'specificity': 0.84538543, 'f1': 0.8782615, 'auroc': 0.9847708, 'binary_precision': 0.84819734, 'binary_recall': 0.69517887, 'binary_specificity': 0.99559206, 'binary_f1_score': 0.7641025}
confusion matrix:
       0    1
0  18069   80
1    196  447
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964046, 'precision': 0.83185136, 'recall': 0.62027085, 'specificity': 0.62027085, 'f1': 0.6720538, 'auroc': 0.9508702, 'binary_precision': 0.6956522, 'binary_recall': 0.24521072, 'binary_specificity': 0.995331, 'binary_f1_score': 0.36260623}
confusion matrix:
      0   1
0  5969  28
1   197  64
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20840079.png
early stop counter: 7
val acc:0.9853128790855408, best validation acc: 0.9889314770698547, corresponding to test acc:                         0.9654842019081116 / 0.9715564250946045
after epoch: 22,now: 2024-05-25 20:14:07.689077,epoch time: 0:26:51.674267,used: 9:51:38.116376,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_29_seed_0_20840079
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99394864, 'precision': 0.9810975, 'recall': 0.923705, 'specificity': 0.923705, 'f1': 0.95044804, 'auroc': 0.9981638, 'binary_precision': 0.96744186, 'binary_recall': 0.84840244, 'binary_specificity': 0.9990076, 'binary_f1_score': 0.9040203}
confusion matrix:
       0     1
0  42279    42
1    223  1248
---- Validation: 
scalar performance:
{'acc': 0.9880268, 'precision': 0.9547831, 'recall': 0.8550411, 'specificity': 0.8550411, 'f1': 0.89831525, 'auroc': 0.9849465, 'binary_precision': 0.9196787, 'binary_recall': 0.7122862, 'binary_specificity': 0.997796, 'binary_f1_score': 0.8028045}
confusion matrix:
       0    1
0  18109   40
1    185  458
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9592522, 'precision': 0.7507247, 'recall': 0.58112293, 'specificity': 0.58112293, 'f1': 0.61780584, 'auroc': 0.9457479, 'binary_precision': 0.5365854, 'binary_recall': 0.16858238, 'binary_specificity': 0.9936635, 'binary_f1_score': 0.25655976}
confusion matrix:
      0   1
0  5959  38
1   217  44
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20840079.png
early stop counter: 8
val acc:0.9880267977714539, best validation acc: 0.9889314770698547, corresponding to test acc:                         0.9654842019081116 / 0.9715564250946045
after epoch: 23,now: 2024-05-25 20:41:01.449802,epoch time: 0:26:53.760725,used: 10:18:31.877101,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_29_seed_0_20840079
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9943597, 'precision': 0.96762353, 'recall': 0.94396853, 'specificity': 0.94396853, 'f1': 0.9554658, 'auroc': 0.9985005, 'binary_precision': 0.9390681, 'binary_recall': 0.8899456, 'binary_specificity': 0.9979915, 'binary_f1_score': 0.9138472}
confusion matrix:
       0     1
0  42235    85
1    162  1310
---- Validation: 
scalar performance:
{'acc': 0.9871222, 'precision': 0.9305929, 'recall': 0.8643235, 'specificity': 0.8643235, 'f1': 0.8944799, 'auroc': 0.98231447, 'binary_precision': 0.87061, 'binary_recall': 0.7325039, 'binary_specificity': 0.99614304, 'binary_f1_score': 0.79560816}
confusion matrix:
       0    1
0  18079   70
1    172  471
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96276766, 'precision': 0.8053571, 'recall': 0.6177715, 'specificity': 0.6177715, 'f1': 0.6659045, 'auroc': 0.9419674, 'binary_precision': 0.64285713, 'binary_recall': 0.2413793, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.35097492}
confusion matrix:
      0   1
0  5962  35
1   198  63
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20840079.png
early stop counter: 9
val acc:0.9871221780776978, best validation acc: 0.9889314770698547, corresponding to test acc:                         0.9654842019081116 / 0.9715564250946045
after epoch: 24,now: 2024-05-25 21:08:21.444122,epoch time: 0:27:19.994320,used: 10:45:51.871421,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_29_seed_0_20840079
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9952046, 'precision': 0.9611567, 'recall': 0.9653887, 'specificity': 0.9653887, 'f1': 0.96326226, 'auroc': 0.9990053, 'binary_precision': 0.92462987, 'binary_recall': 0.93342394, 'binary_specificity': 0.9973535, 'binary_f1_score': 0.92900604}
confusion matrix:
       0     1
0  42208   112
1     98  1374
---- Validation: 
scalar performance:
{'acc': 0.9874415, 'precision': 0.92278457, 'recall': 0.8794899, 'specificity': 0.8794899, 'f1': 0.89987504, 'auroc': 0.98390186, 'binary_precision': 0.85391307, 'binary_recall': 0.7636081, 'binary_specificity': 0.99537164, 'binary_f1_score': 0.8062397}
confusion matrix:
       0    1
0  18065   84
1    152  491
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96756154, 'precision': 0.8389505, 'recall': 0.6880691, 'specificity': 0.6880691, 'f1': 0.7397595, 'auroc': 0.95255375, 'binary_precision': 0.70422536, 'binary_recall': 0.38314176, 'binary_specificity': 0.9929965, 'binary_f1_score': 0.4962779}
confusion matrix:
      0    1
0  5955   42
1   161  100
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20840079.png
early stop counter: 10
val acc:0.9874414801597595, best validation acc: 0.9889314770698547, corresponding to test acc:                         0.9654842019081116 / 0.9715564250946045
after epoch: 25,now: 2024-05-25 21:35:24.535373,epoch time: 0:27:03.091251,used: 11:12:54.962672,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_29_seed_0_20840079
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9910029, 'precision': 0.9574187, 'recall': 0.8989544, 'specificity': 0.8989544, 'f1': 0.9260415, 'auroc': 0.9971317, 'binary_precision': 0.92175275, 'binary_recall': 0.80027175, 'binary_specificity': 0.99763703, 'binary_f1_score': 0.8567273}
confusion matrix:
       0     1
0  42220   100
1    294  1178
---- Validation: 
scalar performance:
{'acc': 0.9848872, 'precision': 0.90944517, 'recall': 0.84891534, 'specificity': 0.84891534, 'f1': 0.87656987, 'auroc': 0.97970176, 'binary_precision': 0.8293578, 'binary_recall': 0.7029549, 'binary_specificity': 0.9948757, 'binary_f1_score': 0.7609428}
confusion matrix:
       0    1
0  18056   93
1    191  452
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96212846, 'precision': 0.83233297, 'recall': 0.578959, 'specificity': 0.578959, 'f1': 0.621124, 'auroc': 0.9331607, 'binary_precision': 0.7, 'binary_recall': 0.16091955, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.26168224}
confusion matrix:
      0   1
0  5979  18
1   219  42
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20840079.png
early stop counter: 11
val acc:0.9848871827125549, best validation acc: 0.9889314770698547, corresponding to test acc:                         0.9654842019081116 / 0.9715564250946045
after epoch: 26,now: 2024-05-25 22:03:33.343959,epoch time: 0:28:08.808586,used: 11:41:03.771258,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_29_seed_0_20840079
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9939715, 'precision': 0.9546478, 'recall': 0.9522607, 'specificity': 0.9522607, 'f1': 0.95345086, 'auroc': 0.998242, 'binary_precision': 0.91250855, 'binary_recall': 0.90754586, 'binary_specificity': 0.9969755, 'binary_f1_score': 0.9100204}
confusion matrix:
       0     1
0  42193   128
1    136  1335
---- Validation: 
scalar performance:
{'acc': 0.98632395, 'precision': 0.9331702, 'recall': 0.847409, 'specificity': 0.847409, 'f1': 0.8852172, 'auroc': 0.9754102, 'binary_precision': 0.8769531, 'binary_recall': 0.6982893, 'binary_specificity': 0.99652874, 'binary_f1_score': 0.7774892}
confusion matrix:
       0    1
0  18086   63
1    194  449
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9643656, 'precision': 0.839586, 'recall': 0.6204376, 'specificity': 0.6204376, 'f1': 0.67317057, 'auroc': 0.95119226, 'binary_precision': 0.7111111, 'binary_recall': 0.24521072, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.36467236}
confusion matrix:
      0   1
0  5971  26
1   197  64
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20840079.png
early stop counter: 12
val acc:0.9863239526748657, best validation acc: 0.9889314770698547, corresponding to test acc:                         0.9654842019081116 / 0.9715564250946045
after epoch: 27,now: 2024-05-25 22:30:56.589961,epoch time: 0:27:23.246002,used: 12:08:27.017260,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_29_seed_0_20840079
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99607235, 'precision': 0.96662855, 'recall': 0.97336113, 'specificity': 0.97336113, 'f1': 0.9699688, 'auroc': 0.99881065, 'binary_precision': 0.93503016, 'binary_recall': 0.94901425, 'binary_specificity': 0.997708, 'binary_f1_score': 0.9419703}
confusion matrix:
       0     1
0  42224    97
1     75  1396
---- Validation: 
scalar performance:
{'acc': 0.9880268, 'precision': 0.92159843, 'recall': 0.8917938, 'specificity': 0.8917938, 'f1': 0.9061056, 'auroc': 0.98199743, 'binary_precision': 0.8506711, 'binary_recall': 0.7884914, 'binary_specificity': 0.99509615, 'binary_f1_score': 0.8184019}
confusion matrix:
       0    1
0  18060   89
1    136  507
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.76014507, 'recall': 0.59428275, 'specificity': 0.59428275, 'f1': 0.6341577, 'auroc': 0.93151397, 'binary_precision': 0.5543478, 'binary_recall': 0.1954023, 'binary_specificity': 0.9931632, 'binary_f1_score': 0.2889518}
confusion matrix:
      0   1
0  5956  41
1   210  51
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20840079.png
early stop counter: 13
val acc:0.9880267977714539, best validation acc: 0.9889314770698547, corresponding to test acc:                         0.9654842019081116 / 0.9715564250946045
after epoch: 28,now: 2024-05-25 22:58:10.336975,epoch time: 0:27:13.747014,used: 12:35:40.764274,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_29_seed_0_20840079
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99522746, 'precision': 0.9505797, 'recall': 0.97917056, 'specificity': 0.97917056, 'f1': 0.9644003, 'auroc': 0.999156, 'binary_precision': 0.90248567, 'binary_recall': 0.9619565, 'binary_specificity': 0.9963847, 'binary_f1_score': 0.9312726}
confusion matrix:
       0     1
0  42167   153
1     56  1416
---- Validation: 
scalar performance:
{'acc': 0.9876011, 'precision': 0.9159633, 'recall': 0.8915734, 'specificity': 0.8915734, 'f1': 0.90336967, 'auroc': 0.98388875, 'binary_precision': 0.839404, 'binary_recall': 0.7884914, 'binary_specificity': 0.9946554, 'binary_f1_score': 0.8131516}
confusion matrix:
       0    1
0  18052   97
1    136  507
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964845, 'precision': 0.8380296, 'recall': 0.63168174, 'specificity': 0.63168174, 'f1': 0.6853954, 'auroc': 0.95576274, 'binary_precision': 0.7070707, 'binary_recall': 0.26819924, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.38888893}
confusion matrix:
      0   1
0  5968  29
1   191  70
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20840079.png
early stop counter: 14
val acc:0.987601101398468, best validation acc: 0.9889314770698547, corresponding to test acc:                         0.9654842019081116 / 0.9715564250946045
after epoch: 29,now: 2024-05-25 23:25:30.595442,epoch time: 0:27:20.258467,used: 13:03:01.022741,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_29_seed_0_20840079
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99493057, 'precision': 0.9571866, 'recall': 0.96557474, 'specificity': 0.96557474, 'f1': 0.9613396, 'auroc': 0.9988267, 'binary_precision': 0.9166667, 'binary_recall': 0.93410325, 'binary_specificity': 0.9970463, 'binary_f1_score': 0.9253028}
confusion matrix:
       0     1
0  42195   125
1     97  1375
---- Validation: 
scalar performance:
{'acc': 0.9881865, 'precision': 0.9226158, 'recall': 0.8933765, 'specificity': 0.8933765, 'f1': 0.9074297, 'auroc': 0.9832436, 'binary_precision': 0.85259634, 'binary_recall': 0.79160184, 'binary_specificity': 0.9951512, 'binary_f1_score': 0.82096773}
confusion matrix:
       0    1
0  18061   88
1    134  509
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96212846, 'precision': 0.80156916, 'recall': 0.6046117, 'specificity': 0.6046117, 'f1': 0.650719, 'auroc': 0.9499365, 'binary_precision': 0.6363636, 'binary_recall': 0.21455939, 'binary_specificity': 0.994664, 'binary_f1_score': 0.32091692}
confusion matrix:
      0   1
0  5965  32
1   205  56
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20840079.png
early stop counter: 15
val acc:0.9881864786148071, best validation acc: 0.9889314770698547, corresponding to test acc:                         0.9654842019081116 / 0.9715564250946045
after epoch: 30,now: 2024-05-25 23:52:58.794738,epoch time: 0:27:28.199296,used: 13:30:29.222037,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_29_seed_0_20840079
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 13:30:29.222037 at 2024-05-25 23:52:58.794738
persisted model performance metric: 

scalar performance:
{'acc': 0.96164906, 'precision': 0.7978163, 'recall': 0.5951999, 'specificity': 0.5951999, 'f1': 0.6392657, 'auroc': 0.95256567, 'binary_precision': 0.6296296, 'binary_recall': 0.1954023, 'binary_specificity': 0.9949975, 'binary_f1_score': 0.2982456}
confusion matrix:
      0   1
0  5967  30
1   210  51
oracle model performance metric: 

scalar performance:
{'acc': 0.9697987, 'precision': 0.8236511, 'recall': 0.7698591, 'specificity': 0.7698591, 'f1': 0.79403734, 'auroc': 0.9579496, 'binary_precision': 0.6666667, 'binary_recall': 0.55172414, 'binary_specificity': 0.987994, 'binary_f1_score': 0.6037736}
confusion matrix:
      0    1
0  5925   72
1   117  144
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2finetuned_irm/rule_results/2.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2finetuned_irm/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2finetuned_irm/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 447825 KiB |  13211 MiB |   1116 TiB |   1116 TiB |
|       from large pool | 404210 KiB |  13171 MiB |   1103 TiB |   1103 TiB |
|       from small pool |  43615 KiB |     63 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 447825 KiB |  13211 MiB |   1116 TiB |   1116 TiB |
|       from large pool | 404210 KiB |  13171 MiB |   1103 TiB |   1103 TiB |
|       from small pool |  43615 KiB |     63 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 439406 KiB |  13206 MiB |   1112 TiB |   1112 TiB |
|       from large pool | 396800 KiB |  13167 MiB |   1099 TiB |   1099 TiB |
|       from small pool |  42606 KiB |     62 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14472 MiB |  14472 MiB |  14472 MiB |      0 B   |
|       from large pool |  14398 MiB |  14398 MiB |  14398 MiB |      0 B   |
|       from small pool |     74 MiB |     74 MiB |     74 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 461487 KiB |   1233 MiB | 784669 GiB | 784669 GiB |
|       from large pool | 451854 KiB |   1224 MiB | 771278 GiB | 771278 GiB |
|       from small pool |   9633 KiB |     17 MiB |  13391 GiB |  13391 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3488    |    6479    |  196390 K  |  196386 K  |
|       from large pool |     182    |    1409    |  102072 K  |  102072 K  |
|       from small pool |    3306    |    6295    |   94317 K  |   94314 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3488    |    6479    |  196390 K  |  196386 K  |
|       from large pool |     182    |    1409    |  102072 K  |  102072 K  |
|       from small pool |    3306    |    6295    |   94317 K  |   94314 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     638    |     638    |     638    |       0    |
|       from large pool |     601    |     601    |     601    |       0    |
|       from small pool |      37    |      37    |      37    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      80    |    2803    |  130077 K  |  130077 K  |
|       from large pool |      37    |     602    |   79819 K  |   79819 K  |
|       from small pool |      43    |    2766    |   50257 K  |   50257 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13211 MiB |   1116 TiB |   1116 TiB |
|       from large pool |  16640 KiB |  13171 MiB |   1103 TiB |   1103 TiB |
|       from small pool |      0 KiB |     63 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13211 MiB |   1116 TiB |   1116 TiB |
|       from large pool |  16640 KiB |  13171 MiB |   1103 TiB |   1103 TiB |
|       from small pool |      0 KiB |     63 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13206 MiB |   1112 TiB |   1112 TiB |
|       from large pool |  16640 KiB |  13167 MiB |   1099 TiB |   1099 TiB |
|       from small pool |      0 KiB |     62 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    888 MiB |  14472 MiB |  14472 MiB |  13584 MiB |
|       from large pool |    836 MiB |  14398 MiB |  14398 MiB |  13562 MiB |
|       from small pool |     52 MiB |     74 MiB |     74 MiB |     22 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1233 MiB | 784670 GiB | 784670 GiB |
|       from large pool |  24320 KiB |   1224 MiB | 771279 GiB | 771278 GiB |
|       from small pool |      0 KiB |     41 MiB |  13391 GiB |  13391 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6479    |  196390 K  |  196390 K  |
|       from large pool |       2    |    1409    |  102072 K  |  102072 K  |
|       from small pool |       0    |    6295    |   94317 K  |   94317 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6479    |  196390 K  |  196390 K  |
|       from large pool |       2    |    1409    |  102072 K  |  102072 K  |
|       from small pool |       0    |    6295    |   94317 K  |   94317 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     638    |     638    |     575    |
|       from large pool |      37    |     601    |     601    |     564    |
|       from small pool |      26    |      37    |      37    |      11    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2803    |  130078 K  |  130078 K  |
|       from large pool |       4    |     602    |   79819 K  |   79819 K  |
|       from small pool |       0    |    2766    |   50258 K  |   50258 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat May 25 23:55:25 2024]
Finished job 0.
1 of 1 steps (100%) done
