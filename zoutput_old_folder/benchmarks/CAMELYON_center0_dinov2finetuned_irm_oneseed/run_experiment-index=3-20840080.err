Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat May 25 10:23:44 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_dinov2finetuned_irm/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_dinov2finetuned_irm/rule_results/3.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=3
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_30_56_seed_0_20840080

 Experiment start at: 2024-05-25 10:30:56.368919
before training, model accuracy: 0.6481304168701172
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.97424185, 'precision': 0.82796085, 'recall': 0.7217628, 'specificity': 0.7217628, 'f1': 0.7637329, 'auroc': 0.9685583, 'binary_precision': 0.67479676, 'binary_recall': 0.45108697, 'binary_specificity': 0.99243855, 'binary_f1_score': 0.5407166}
confusion matrix:
       0    1
0  42000  320
1    808  664
---- Validation: 
scalar performance:
{'acc': 0.973659, 'precision': 0.839066, 'recall': 0.69909173, 'specificity': 0.69909173, 'f1': 0.7493896, 'auroc': 0.963689, 'binary_precision': 0.6989247, 'binary_recall': 0.4043546, 'binary_specificity': 0.99382883, 'binary_f1_score': 0.5123153}
confusion matrix:
       0    1
0  18037  112
1    383  260
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.7811685, 'recall': 0.5502234, 'specificity': 0.5502234, 'f1': 0.5779159, 'auroc': 0.9568659, 'binary_precision': 0.6, 'binary_recall': 0.10344828, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.1764706}
confusion matrix:
      0   1
0  5979  18
1   234  27
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20840080.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-25 11:00:05.586215,epoch time: 0:29:09.217296,used: 0:29:09.217296,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_30_56_seed_0_20840080
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97611433, 'precision': 0.9440442, 'recall': 0.65978265, 'specificity': 0.65978265, 'f1': 0.73107564, 'auroc': 0.97771305, 'binary_precision': 0.9111969, 'binary_recall': 0.3206522, 'binary_specificity': 0.99891305, 'binary_f1_score': 0.47437185}
confusion matrix:
       0    1
0  42274   46
1   1000  472
---- Validation: 
scalar performance:
{'acc': 0.97115797, 'precision': 0.9286277, 'recall': 0.5897889, 'specificity': 0.5897889, 'f1': 0.6425087, 'auroc': 0.9675342, 'binary_precision': 0.8854962, 'binary_recall': 0.18040435, 'binary_specificity': 0.9991735, 'binary_f1_score': 0.2997416}
confusion matrix:
       0    1
0  18134   15
1    527  116
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9603707, 'precision': 0.92146814, 'recall': 0.52856886, 'specificity': 0.52856886, 'f1': 0.5438245, 'auroc': 0.9534633, 'binary_precision': 0.88235295, 'binary_recall': 0.057471264, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.10791367}
confusion matrix:
      0   1
0  5995   2
1   246  15
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20840080.png
new oracle model saved
early stop counter: 1
val acc:0.971157968044281, best validation acc: 0.9736589789390564, corresponding to test acc:                         0.9597315192222595 / 0.9603707194328308
after epoch: 2,now: 2024-05-25 11:27:55.800025,epoch time: 0:27:50.213810,used: 0:56:59.431106,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_30_56_seed_0_20840080
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97926563, 'precision': 0.8331114, 'recall': 0.8627186, 'specificity': 0.8627186, 'f1': 0.8472249, 'auroc': 0.9796784, 'binary_precision': 0.67537314, 'binary_recall': 0.73777175, 'binary_specificity': 0.9876654, 'binary_f1_score': 0.70519483}
confusion matrix:
       0     1
0  41798   522
1    386  1086
---- Validation: 
scalar performance:
{'acc': 0.9756811, 'precision': 0.80756867, 'recall': 0.85389996, 'specificity': 0.85389996, 'f1': 0.82894325, 'auroc': 0.9762599, 'binary_precision': 0.625, 'binary_recall': 0.7231726, 'binary_specificity': 0.98462725, 'binary_f1_score': 0.67051184}
confusion matrix:
       0    1
0  17870  279
1    178  465
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96660274, 'precision': 0.8856087, 'recall': 0.6307665, 'specificity': 0.6307665, 'f1': 0.6902598, 'auroc': 0.9647948, 'binary_precision': 0.8023256, 'binary_recall': 0.26436782, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.39769453}
confusion matrix:
      0   1
0  5980  17
1   192  69
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20840080.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-05-25 11:55:46.964945,epoch time: 0:27:51.164920,used: 1:24:50.596026,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_30_56_seed_0_20840080
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98655003, 'precision': 0.9152056, 'recall': 0.86845464, 'specificity': 0.86845464, 'f1': 0.8903249, 'auroc': 0.98663276, 'binary_precision': 0.83935434, 'binary_recall': 0.7418478, 'binary_specificity': 0.99506146, 'binary_f1_score': 0.7875946}
confusion matrix:
       0     1
0  42111   209
1    380  1092
---- Validation: 
scalar performance:
{'acc': 0.9852597, 'precision': 0.92048866, 'recall': 0.84235764, 'specificity': 0.84235764, 'f1': 0.8771087, 'auroc': 0.98262393, 'binary_precision': 0.85192305, 'binary_recall': 0.688958, 'binary_specificity': 0.99575734, 'binary_f1_score': 0.7618229}
confusion matrix:
       0    1
0  18072   77
1    200  443
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96324706, 'precision': 0.8392687, 'recall': 0.59786594, 'specificity': 0.59786594, 'f1': 0.64624846, 'auroc': 0.9604804, 'binary_precision': 0.7123288, 'binary_recall': 0.19923371, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.31137726}
confusion matrix:
      0   1
0  5976  21
1   209  52
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20840080.png
better model found
persisted
after epoch: 4,now: 2024-05-25 12:26:03.435571,epoch time: 0:30:16.470626,used: 1:55:07.066652,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_30_56_seed_0_20840080
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98422086, 'precision': 0.9186709, 'recall': 0.82036567, 'specificity': 0.82036567, 'f1': 0.86248577, 'auroc': 0.9863999, 'binary_precision': 0.84959716, 'binary_recall': 0.64470106, 'binary_specificity': 0.9960303, 'binary_f1_score': 0.73310155}
confusion matrix:
       0    1
0  42152  168
1    523  949
---- Validation: 
scalar performance:
{'acc': 0.9829715, 'precision': 0.90486306, 'recall': 0.8179213, 'specificity': 0.8179213, 'f1': 0.855749, 'auroc': 0.9819547, 'binary_precision': 0.8223553, 'binary_recall': 0.6407465, 'binary_specificity': 0.99509615, 'binary_f1_score': 0.72027963}
confusion matrix:
       0    1
0  18060   89
1    231  412
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959412, 'precision': 0.769977, 'recall': 0.54822433, 'specificity': 0.54822433, 'f1': 0.574566, 'auroc': 0.9576992, 'binary_precision': 0.5777778, 'binary_recall': 0.099616855, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.16993465}
confusion matrix:
      0   1
0  5978  19
1   235  26
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20840080.png
early stop counter: 1
val acc:0.9829714894294739, best validation acc: 0.9852597117424011, corresponding to test acc:                         0.9632470607757568 / 0.9666027426719666
after epoch: 5,now: 2024-05-25 12:53:45.816965,epoch time: 0:27:42.381394,used: 2:22:49.448046,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_30_56_seed_0_20840080
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98764616, 'precision': 0.92360955, 'recall': 0.87812054, 'specificity': 0.87812054, 'f1': 0.89947313, 'auroc': 0.99089694, 'binary_precision': 0.8555046, 'binary_recall': 0.760707, 'binary_specificity': 0.9955341, 'binary_f1_score': 0.80532557}
confusion matrix:
       0     1
0  42132   189
1    352  1119
---- Validation: 
scalar performance:
{'acc': 0.9852065, 'precision': 0.9082744, 'recall': 0.8565812, 'specificity': 0.8565812, 'f1': 0.8805388, 'auroc': 0.98073244, 'binary_precision': 0.82647586, 'binary_recall': 0.718507, 'binary_specificity': 0.9946554, 'binary_f1_score': 0.7687188}
confusion matrix:
       0    1
0  18052   97
1    181  462
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96260786, 'precision': 0.8644699, 'recall': 0.57371217, 'specificity': 0.57371217, 'f1': 0.61541295, 'auroc': 0.95892936, 'binary_precision': 0.7647059, 'binary_recall': 0.14942528, 'binary_specificity': 0.997999, 'binary_f1_score': 0.25}
confusion matrix:
      0   1
0  5985  12
1   222  39
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20840080.png
early stop counter: 2
val acc:0.9852064847946167, best validation acc: 0.9852597117424011, corresponding to test acc:                         0.9632470607757568 / 0.9666027426719666
after epoch: 6,now: 2024-05-25 13:21:52.493162,epoch time: 0:28:06.676197,used: 2:50:56.124243,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_30_56_seed_0_20840080
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98753196, 'precision': 0.9105979, 'recall': 0.89387995, 'specificity': 0.89387995, 'f1': 0.90205103, 'auroc': 0.9895526, 'binary_precision': 0.8283688, 'binary_recall': 0.79347825, 'binary_specificity': 0.99428165, 'binary_f1_score': 0.8105482}
confusion matrix:
       0     1
0  42078   242
1    304  1168
---- Validation: 
scalar performance:
{'acc': 0.9868029, 'precision': 0.9366045, 'recall': 0.85215724, 'specificity': 0.85215724, 'f1': 0.8895147, 'auroc': 0.9827575, 'binary_precision': 0.88349515, 'binary_recall': 0.7076205, 'binary_specificity': 0.996694, 'binary_f1_score': 0.7858376}
confusion matrix:
       0    1
0  18089   60
1    188  455
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96292746, 'precision': 0.81173635, 'recall': 0.6141902, 'specificity': 0.6141902, 'f1': 0.6627785, 'auroc': 0.96726096, 'binary_precision': 0.65591395, 'binary_recall': 0.23371647, 'binary_specificity': 0.994664, 'binary_f1_score': 0.34463277}
confusion matrix:
      0   1
0  5965  32
1   200  61
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20840080.png
better model found
persisted
after epoch: 7,now: 2024-05-25 13:49:36.050788,epoch time: 0:27:43.557626,used: 3:18:39.681869,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_30_56_seed_0_20840080
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9871209, 'precision': 0.9657365, 'recall': 0.8273229, 'specificity': 0.8273229, 'f1': 0.8836145, 'auroc': 0.9920919, 'binary_precision': 0.943304, 'binary_recall': 0.6560163, 'binary_specificity': 0.9986295, 'binary_f1_score': 0.77385724}
confusion matrix:
       0    1
0  42263   58
1    506  965
---- Validation: 
scalar performance:
{'acc': 0.9831311, 'precision': 0.96948934, 'recall': 0.76550007, 'specificity': 0.76550007, 'f1': 0.8373257, 'auroc': 0.9828526, 'binary_precision': 0.95530725, 'binary_recall': 0.5318818, 'binary_specificity': 0.9991184, 'binary_f1_score': 0.68331665}
confusion matrix:
       0    1
0  18133   16
1    301  342
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96164906, 'precision': 0.8434281, 'recall': 0.5640502, 'specificity': 0.5640502, 'f1': 0.60055995, 'auroc': 0.95935005, 'binary_precision': 0.7234042, 'binary_recall': 0.1302682, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.22077923}
confusion matrix:
      0   1
0  5984  13
1   227  34
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20840080.png
early stop counter: 1
val acc:0.9831311106681824, best validation acc: 0.986802875995636, corresponding to test acc:                         0.9629274606704712 / 0.9666027426719666
after epoch: 8,now: 2024-05-25 14:17:10.850322,epoch time: 0:27:34.799534,used: 3:46:14.481403,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_30_56_seed_0_20840080
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9886509, 'precision': 0.9187067, 'recall': 0.9035753, 'specificity': 0.9035753, 'f1': 0.9109905, 'auroc': 0.990585, 'binary_precision': 0.84392655, 'binary_recall': 0.81237257, 'binary_specificity': 0.994778, 'binary_f1_score': 0.827849}
confusion matrix:
       0     1
0  42100   221
1    276  1195
---- Validation: 
scalar performance:
{'acc': 0.985845, 'precision': 0.9296974, 'recall': 0.8426607, 'specificity': 0.8426607, 'f1': 0.880898, 'auroc': 0.98433626, 'binary_precision': 0.87033397, 'binary_recall': 0.688958, 'binary_specificity': 0.99636346, 'binary_f1_score': 0.7690972}
confusion matrix:
       0    1
0  18083   66
1    200  443
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.8096023, 'recall': 0.57112944, 'specificity': 0.57112944, 'f1': 0.6091608, 'auroc': 0.953206, 'binary_precision': 0.6551724, 'binary_recall': 0.14559387, 'binary_specificity': 0.996665, 'binary_f1_score': 0.2382445}
confusion matrix:
      0   1
0  5977  20
1   223  38
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20840080.png
early stop counter: 2
val acc:0.9858450293540955, best validation acc: 0.986802875995636, corresponding to test acc:                         0.9629274606704712 / 0.9666027426719666
after epoch: 9,now: 2024-05-25 14:44:57.356753,epoch time: 0:27:46.506431,used: 4:14:00.987834,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_30_56_seed_0_20840080
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9884454, 'precision': 0.905193, 'recall': 0.9205813, 'specificity': 0.9205813, 'f1': 0.9127317, 'auroc': 0.99409163, 'binary_precision': 0.8156863, 'binary_recall': 0.84782606, 'binary_specificity': 0.9933365, 'binary_f1_score': 0.8314457}
confusion matrix:
       0     1
0  42038   282
1    224  1248
---- Validation: 
scalar performance:
{'acc': 0.9865368, 'precision': 0.89881796, 'recall': 0.89702284, 'specificity': 0.89702284, 'f1': 0.8979182, 'auroc': 0.98094225, 'binary_precision': 0.8046875, 'binary_recall': 0.8009331, 'binary_specificity': 0.99311256, 'binary_f1_score': 0.8028059}
confusion matrix:
       0    1
0  18024  125
1    128  515
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614893, 'precision': 0.8081542, 'recall': 0.58045787, 'specificity': 0.58045787, 'f1': 0.6216125, 'auroc': 0.96724284, 'binary_precision': 0.6515151, 'binary_recall': 0.16475096, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.26299694}
confusion matrix:
      0   1
0  5974  23
1   218  43
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20840080.png
early stop counter: 3
val acc:0.9865368008613586, best validation acc: 0.986802875995636, corresponding to test acc:                         0.9629274606704712 / 0.9666027426719666
after epoch: 10,now: 2024-05-25 15:12:40.314830,epoch time: 0:27:42.958077,used: 4:41:43.945911,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_30_56_seed_0_20840080
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9888336, 'precision': 0.96094143, 'recall': 0.8594725, 'specificity': 0.8594725, 'f1': 0.9034803, 'auroc': 0.99384576, 'binary_precision': 0.93151885, 'binary_recall': 0.72078806, 'binary_specificity': 0.9981569, 'binary_f1_score': 0.8127154}
confusion matrix:
       0     1
0  42242    78
1    411  1061
---- Validation: 
scalar performance:
{'acc': 0.9843018, 'precision': 0.9435973, 'recall': 0.8028589, 'specificity': 0.8028589, 'f1': 0.8590052, 'auroc': 0.9848064, 'binary_precision': 0.90092164, 'binary_recall': 0.60808706, 'binary_specificity': 0.9976307, 'binary_f1_score': 0.726091}
confusion matrix:
       0    1
0  18106   43
1    252  391
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959412, 'precision': 0.7580286, 'recall': 0.56838, 'specificity': 0.56838, 'f1': 0.6023848, 'auroc': 0.95528686, 'binary_precision': 0.5522388, 'binary_recall': 0.14176245, 'binary_specificity': 0.9949975, 'binary_f1_score': 0.22560976}
confusion matrix:
      0   1
0  5967  30
1   224  37
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20840080.png
early stop counter: 4
val acc:0.9843018054962158, best validation acc: 0.986802875995636, corresponding to test acc:                         0.9629274606704712 / 0.9666027426719666
after epoch: 11,now: 2024-05-25 15:40:20.602838,epoch time: 0:27:40.288008,used: 5:09:24.233919,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_30_56_seed_0_20840080
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99036354, 'precision': 0.9178901, 'recall': 0.93759847, 'specificity': 0.93759847, 'f1': 0.9274984, 'auroc': 0.9954075, 'binary_precision': 0.83992225, 'binary_recall': 0.8810333, 'binary_specificity': 0.99416363, 'binary_f1_score': 0.8599867}
confusion matrix:
       0     1
0  42074   247
1    175  1296
---- Validation: 
scalar performance:
{'acc': 0.9871754, 'precision': 0.91575253, 'recall': 0.8838525, 'specificity': 0.8838525, 'f1': 0.899114, 'auroc': 0.9841885, 'binary_precision': 0.839527, 'binary_recall': 0.7729393, 'binary_specificity': 0.9947656, 'binary_f1_score': 0.80485827}
confusion matrix:
       0    1
0  18054   95
1    146  497
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9651646, 'precision': 0.83358073, 'recall': 0.6428425, 'specificity': 0.6428425, 'f1': 0.6964313, 'auroc': 0.96435875, 'binary_precision': 0.6972477, 'binary_recall': 0.29118773, 'binary_specificity': 0.99449724, 'binary_f1_score': 0.41081083}
confusion matrix:
      0   1
0  5964  33
1   185  76
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20840080.png
better model found
persisted
after epoch: 12,now: 2024-05-25 16:07:59.112998,epoch time: 0:27:38.510160,used: 5:37:02.744079,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_30_56_seed_0_20840080
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99063754, 'precision': 0.9690484, 'recall': 0.88171667, 'specificity': 0.88171667, 'f1': 0.9205763, 'auroc': 0.99431276, 'binary_precision': 0.9462185, 'binary_recall': 0.7649456, 'binary_specificity': 0.9984877, 'binary_f1_score': 0.84598047}
confusion matrix:
       0     1
0  42256    64
1    346  1126
---- Validation: 
scalar performance:
{'acc': 0.9853661, 'precision': 0.9489518, 'recall': 0.8161608, 'specificity': 0.8161608, 'f1': 0.870201, 'auroc': 0.98162645, 'binary_precision': 0.91071427, 'binary_recall': 0.63452566, 'binary_specificity': 0.997796, 'binary_f1_score': 0.7479377}
confusion matrix:
       0    1
0  18109   40
1    235  408
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.759164, 'recall': 0.5979474, 'specificity': 0.5979474, 'f1': 0.6381378, 'auroc': 0.9534699, 'binary_precision': 0.5520833, 'binary_recall': 0.20306513, 'binary_specificity': 0.99282974, 'binary_f1_score': 0.29691878}
confusion matrix:
      0   1
0  5954  43
1   208  53
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20840080.png
early stop counter: 1
val acc:0.9853661060333252, best validation acc: 0.9871754050254822, corresponding to test acc:                         0.9651646018028259 / 0.9666027426719666
after epoch: 13,now: 2024-05-25 16:35:43.227197,epoch time: 0:27:44.114199,used: 6:04:46.858278,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_30_56_seed_0_20840080
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9910714, 'precision': 0.9353013, 'recall': 0.9258743, 'specificity': 0.9258743, 'f1': 0.93053204, 'auroc': 0.9954549, 'binary_precision': 0.8756081, 'binary_recall': 0.85597825, 'binary_specificity': 0.99577034, 'binary_f1_score': 0.8656819}
confusion matrix:
       0     1
0  42141   179
1    212  1260
---- Validation: 
scalar performance:
{'acc': 0.9863772, 'precision': 0.93402857, 'recall': 0.84743655, 'specificity': 0.84743655, 'f1': 0.88556784, 'auroc': 0.98183644, 'binary_precision': 0.87866926, 'binary_recall': 0.6982893, 'binary_specificity': 0.9965838, 'binary_f1_score': 0.7781629}
confusion matrix:
       0    1
0  18087   62
1    194  449
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589326, 'precision': 0.75578165, 'recall': 0.5406448, 'specificity': 0.5406448, 'f1': 0.56256986, 'auroc': 0.94932055, 'binary_precision': 0.55, 'binary_recall': 0.08429119, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.14617941}
confusion matrix:
      0   1
0  5979  18
1   239  22
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20840080.png
early stop counter: 2
val acc:0.9863771796226501, best validation acc: 0.9871754050254822, corresponding to test acc:                         0.9651646018028259 / 0.9666027426719666
after epoch: 14,now: 2024-05-25 17:03:22.298092,epoch time: 0:27:39.070895,used: 6:32:25.929173,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_30_56_seed_0_20840080
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9896328, 'precision': 0.94562936, 'recall': 0.8880819, 'specificity': 0.8880819, 'f1': 0.91471875, 'auroc': 0.99502385, 'binary_precision': 0.89890283, 'binary_recall': 0.77921194, 'binary_specificity': 0.9969518, 'binary_f1_score': 0.8347889}
confusion matrix:
       0     1
0  42191   129
1    325  1147
---- Validation: 
scalar performance:
{'acc': 0.98424864, 'precision': 0.919186, 'recall': 0.825333, 'specificity': 0.825333, 'f1': 0.86588645, 'auroc': 0.981477, 'binary_precision': 0.85050505, 'binary_recall': 0.6547434, 'binary_specificity': 0.9959226, 'binary_f1_score': 0.7398945}
confusion matrix:
       0    1
0  18075   74
1    222  421
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.7365863, 'recall': 0.5403947, 'specificity': 0.5403947, 'f1': 0.5617232, 'auroc': 0.95296884, 'binary_precision': 0.5116279, 'binary_recall': 0.08429119, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.14473684}
confusion matrix:
      0   1
0  5976  21
1   239  22
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20840080.png
early stop counter: 3
val acc:0.9842486381530762, best validation acc: 0.9871754050254822, corresponding to test acc:                         0.9651646018028259 / 0.9666027426719666
after epoch: 15,now: 2024-05-25 17:31:00.766074,epoch time: 0:27:38.467982,used: 7:00:04.397155,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_30_56_seed_0_20840080
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9917565, 'precision': 0.9248214, 'recall': 0.953441, 'specificity': 0.953441, 'f1': 0.9386262, 'auroc': 0.9972656, 'binary_precision': 0.8526984, 'binary_recall': 0.9123641, 'binary_specificity': 0.994518, 'binary_f1_score': 0.8815228}
confusion matrix:
       0     1
0  42088   232
1    129  1343
---- Validation: 
scalar performance:
{'acc': 0.985845, 'precision': 0.8973488, 'recall': 0.8854139, 'specificity': 0.8854139, 'f1': 0.89128256, 'auroc': 0.98038137, 'binary_precision': 0.8025682, 'binary_recall': 0.777605, 'binary_specificity': 0.9932228, 'binary_f1_score': 0.78988934}
confusion matrix:
       0    1
0  18026  123
1    143  500
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9637264, 'precision': 0.7879908, 'recall': 0.6860681, 'specificity': 0.6860681, 'f1': 0.7248033, 'auroc': 0.95308256, 'binary_precision': 0.60240966, 'binary_recall': 0.38314176, 'binary_specificity': 0.9889945, 'binary_f1_score': 0.4683841}
confusion matrix:
      0    1
0  5931   66
1   161  100
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20840080.png
early stop counter: 4
val acc:0.9858450293540955, best validation acc: 0.9871754050254822, corresponding to test acc:                         0.9651646018028259 / 0.9666027426719666
after epoch: 16,now: 2024-05-25 17:58:41.276591,epoch time: 0:27:40.510517,used: 7:27:44.907672,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_30_56_seed_0_20840080
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.991551, 'precision': 0.9757981, 'recall': 0.8903116, 'specificity': 0.8903116, 'f1': 0.92853296, 'auroc': 0.99722576, 'binary_precision': 0.9591326, 'binary_recall': 0.7817811, 'binary_specificity': 0.9988422, 'binary_f1_score': 0.86142325}
confusion matrix:
       0     1
0  42272    49
1    321  1150
---- Validation: 
scalar performance:
{'acc': 0.9857918, 'precision': 0.9439963, 'recall': 0.82763207, 'specificity': 0.82763207, 'f1': 0.8763935, 'auroc': 0.98082083, 'binary_precision': 0.9, 'binary_recall': 0.6578538, 'binary_specificity': 0.9974103, 'binary_f1_score': 0.7601078}
confusion matrix:
       0    1
0  18102   47
1    220  423
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608501, 'precision': 0.818444, 'recall': 0.55813634, 'specificity': 0.55813634, 'f1': 0.59094363, 'auroc': 0.9563117, 'binary_precision': 0.67391306, 'binary_recall': 0.118773945, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.20195441}
confusion matrix:
      0   1
0  5982  15
1   230  31
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20840080.png
early stop counter: 5
val acc:0.985791802406311, best validation acc: 0.9871754050254822, corresponding to test acc:                         0.9651646018028259 / 0.9666027426719666
after epoch: 17,now: 2024-05-25 18:26:11.452805,epoch time: 0:27:30.176214,used: 7:55:15.083886,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_30_56_seed_0_20840080
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9880115, 'precision': 0.91875505, 'recall': 0.89150524, 'specificity': 0.89150524, 'f1': 0.9046351, 'auroc': 0.9952079, 'binary_precision': 0.84486526, 'binary_recall': 0.7880435, 'binary_specificity': 0.9949669, 'binary_f1_score': 0.8154657}
confusion matrix:
       0     1
0  42107   213
1    312  1160
---- Validation: 
scalar performance:
{'acc': 0.98440826, 'precision': 0.89797753, 'recall': 0.85541785, 'specificity': 0.85541785, 'f1': 0.8753958, 'auroc': 0.98205984, 'binary_precision': 0.8059441, 'binary_recall': 0.7169518, 'binary_specificity': 0.99388397, 'binary_f1_score': 0.7588478}
confusion matrix:
       0    1
0  18038  111
1    182  461
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95733464, 'precision': 0.646234, 'recall': 0.51049376, 'specificity': 0.51049376, 'f1': 0.51059586, 'auroc': 0.9503008, 'binary_precision': 0.33333334, 'binary_recall': 0.022988506, 'binary_specificity': 0.997999, 'binary_f1_score': 0.043010753}
confusion matrix:
      0   1
0  5985  12
1   255   6
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20840080.png
early stop counter: 6
val acc:0.9844082593917847, best validation acc: 0.9871754050254822, corresponding to test acc:                         0.9651646018028259 / 0.9666027426719666
after epoch: 18,now: 2024-05-25 18:53:26.756524,epoch time: 0:27:15.303719,used: 8:22:30.387605,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_30_56_seed_0_20840080
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.993629, 'precision': 0.956253, 'recall': 0.9445741, 'specificity': 0.9445741, 'f1': 0.950332, 'auroc': 0.9967871, 'binary_precision': 0.9162596, 'binary_recall': 0.8919837, 'binary_specificity': 0.9971645, 'binary_f1_score': 0.9039587}
confusion matrix:
       0     1
0  42200   120
1    159  1313
---- Validation: 
scalar performance:
{'acc': 0.9881865, 'precision': 0.9249021, 'recall': 0.8903763, 'specificity': 0.8903763, 'f1': 0.90684915, 'auroc': 0.9841559, 'binary_precision': 0.8573854, 'binary_recall': 0.785381, 'binary_specificity': 0.99537164, 'binary_f1_score': 0.8198052}
confusion matrix:
       0    1
0  18065   84
1    138  505
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9613295, 'precision': 0.7976877, 'recall': 0.58587146, 'specificity': 0.58587146, 'f1': 0.6277919, 'auroc': 0.95714843, 'binary_precision': 0.63013697, 'binary_recall': 0.17624521, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.2754491}
confusion matrix:
      0   1
0  5970  27
1   215  46
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20840080.png
better model found
persisted
after epoch: 19,now: 2024-05-25 19:20:37.428242,epoch time: 0:27:10.671718,used: 8:49:41.059323,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_30_56_seed_0_20840080
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9944967, 'precision': 0.976299, 'recall': 0.9371122, 'specificity': 0.9371122, 'f1': 0.95580244, 'auroc': 0.99827147, 'binary_precision': 0.95690936, 'binary_recall': 0.87559485, 'binary_specificity': 0.9986295, 'binary_f1_score': 0.914448}
confusion matrix:
       0     1
0  42263    58
1    183  1288
---- Validation: 
scalar performance:
{'acc': 0.9874415, 'precision': 0.9433373, 'recall': 0.8562381, 'specificity': 0.8562381, 'f1': 0.8946847, 'auroc': 0.98139775, 'binary_precision': 0.89668614, 'binary_recall': 0.7153966, 'binary_specificity': 0.99707973, 'binary_f1_score': 0.7958478}
confusion matrix:
       0    1
0  18096   53
1    183  460
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9613295, 'precision': 0.7960278, 'recall': 0.5877038, 'specificity': 0.5877038, 'f1': 0.6299466, 'auroc': 0.9250893, 'binary_precision': 0.62666667, 'binary_recall': 0.18007663, 'binary_specificity': 0.995331, 'binary_f1_score': 0.2797619}
confusion matrix:
      0   1
0  5969  28
1   214  47
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20840080.png
early stop counter: 1
val acc:0.9874414801597595, best validation acc: 0.9881864786148071, corresponding to test acc:                         0.9613295197486877 / 0.9666027426719666
after epoch: 20,now: 2024-05-25 19:47:52.198089,epoch time: 0:27:14.769847,used: 9:16:55.829170,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_30_56_seed_0_20840080
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99502194, 'precision': 0.9674019, 'recall': 0.9551306, 'specificity': 0.9551306, 'f1': 0.9611784, 'auroc': 0.9986867, 'binary_precision': 0.93784916, 'binary_recall': 0.9123641, 'binary_specificity': 0.99789697, 'binary_f1_score': 0.92493117}
confusion matrix:
       0     1
0  42231    89
1    129  1343
---- Validation: 
scalar performance:
{'acc': 0.98813325, 'precision': 0.93014956, 'recall': 0.88284826, 'specificity': 0.88284826, 'f1': 0.90501356, 'auroc': 0.9805212, 'binary_precision': 0.8684211, 'binary_recall': 0.7698289, 'binary_specificity': 0.99586755, 'binary_f1_score': 0.8161583}
confusion matrix:
       0    1
0  18074   75
1    148  495
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.7574377, 'recall': 0.58128965, 'specificity': 0.58128965, 'f1': 0.6186421, 'auroc': 0.94656074, 'binary_precision': 0.55, 'binary_recall': 0.16858238, 'binary_specificity': 0.993997, 'binary_f1_score': 0.2580645}
confusion matrix:
      0   1
0  5961  36
1   217  44
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20840080.png
early stop counter: 2
val acc:0.9881332516670227, best validation acc: 0.9881864786148071, corresponding to test acc:                         0.9613295197486877 / 0.9666027426719666
after epoch: 21,now: 2024-05-25 20:15:03.041084,epoch time: 0:27:10.842995,used: 9:44:06.672165,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_30_56_seed_0_20840080
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9943597, 'precision': 0.97614825, 'recall': 0.9351164, 'specificity': 0.9351164, 'f1': 0.9546398, 'auroc': 0.99867535, 'binary_precision': 0.9567487, 'binary_recall': 0.87160325, 'binary_specificity': 0.9986295, 'binary_f1_score': 0.91219336}
confusion matrix:
       0     1
0  42262    58
1    189  1283
---- Validation: 
scalar performance:
{'acc': 0.9879204, 'precision': 0.94301045, 'recall': 0.8647367, 'specificity': 0.8647367, 'f1': 0.8997916, 'auroc': 0.98386323, 'binary_precision': 0.89543724, 'binary_recall': 0.7325039, 'binary_specificity': 0.9969695, 'binary_f1_score': 0.80581695}
confusion matrix:
       0    1
0  18094   55
1    172  471
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96260786, 'precision': 0.82301795, 'recall': 0.59570014, 'specificity': 0.59570014, 'f1': 0.6421798, 'auroc': 0.94708705, 'binary_precision': 0.68, 'binary_recall': 0.1954023, 'binary_specificity': 0.995998, 'binary_f1_score': 0.30357143}
confusion matrix:
      0   1
0  5973  24
1   210  51
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20840080.png
early stop counter: 3
val acc:0.9879204034805298, best validation acc: 0.9881864786148071, corresponding to test acc:                         0.9613295197486877 / 0.9666027426719666
after epoch: 22,now: 2024-05-25 20:42:13.864782,epoch time: 0:27:10.823698,used: 10:11:17.495863,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_30_56_seed_0_20840080
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99246436, 'precision': 0.9529666, 'recall': 0.92856216, 'specificity': 0.92856216, 'f1': 0.9404005, 'auroc': 0.99771124, 'binary_precision': 0.91079134, 'binary_recall': 0.8600544, 'binary_specificity': 0.99706995, 'binary_f1_score': 0.88469607}
confusion matrix:
       0     1
0  42196   124
1    206  1266
---- Validation: 
scalar performance:
{'acc': 0.98557895, 'precision': 0.919582, 'recall': 0.84927344, 'specificity': 0.84927344, 'f1': 0.8809593, 'auroc': 0.9826834, 'binary_precision': 0.84962404, 'binary_recall': 0.7029549, 'binary_specificity': 0.99559206, 'binary_f1_score': 0.7693617}
confusion matrix:
       0    1
0  18069   80
1    191  452
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97235537, 'precision': 0.8617747, 'recall': 0.7528697, 'specificity': 0.7528697, 'f1': 0.7966913, 'auroc': 0.9567696, 'binary_precision': 0.74444443, 'binary_recall': 0.51341, 'binary_specificity': 0.9923295, 'binary_f1_score': 0.6077097}
confusion matrix:
      0    1
0  5951   46
1   127  134
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20840080.png
new oracle model saved
early stop counter: 4
val acc:0.9855789542198181, best validation acc: 0.9881864786148071, corresponding to test acc:                         0.9613295197486877 / 0.9723553657531738
after epoch: 23,now: 2024-05-25 21:09:23.766040,epoch time: 0:27:09.901258,used: 10:38:27.397121,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_30_56_seed_0_20840080
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99454236, 'precision': 0.9554402, 'recall': 0.9611118, 'specificity': 0.9611118, 'f1': 0.9582571, 'auroc': 0.99849164, 'binary_precision': 0.9134809, 'binary_recall': 0.92527175, 'binary_specificity': 0.9969518, 'binary_f1_score': 0.9193385}
confusion matrix:
       0     1
0  42191   129
1    110  1362
---- Validation: 
scalar performance:
{'acc': 0.9877607, 'precision': 0.91697717, 'recall': 0.8931562, 'specificity': 0.8931562, 'f1': 0.90468764, 'auroc': 0.9803443, 'binary_precision': 0.8413223, 'binary_recall': 0.79160184, 'binary_specificity': 0.99471045, 'binary_f1_score': 0.8157051}
confusion matrix:
       0    1
0  18053   96
1    134  509
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590924, 'precision': 0.75574064, 'recall': 0.5517222, 'specificity': 0.5517222, 'f1': 0.5792552, 'auroc': 0.94377345, 'binary_precision': 0.54901963, 'binary_recall': 0.107279696, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.17948717}
confusion matrix:
      0   1
0  5974  23
1   233  28
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20840080.png
early stop counter: 5
val acc:0.9877607226371765, best validation acc: 0.9881864786148071, corresponding to test acc:                         0.9613295197486877 / 0.9723553657531738
after epoch: 24,now: 2024-05-25 21:36:39.194452,epoch time: 0:27:15.428412,used: 11:05:42.825533,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_30_56_seed_0_20840080
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99595815, 'precision': 0.9755645, 'recall': 0.9615164, 'specificity': 0.9615164, 'f1': 0.9684272, 'auroc': 0.9991727, 'binary_precision': 0.9537491, 'binary_recall': 0.9245924, 'binary_specificity': 0.99844044, 'binary_f1_score': 0.93894446}
confusion matrix:
       0     1
0  42254    66
1    111  1361
---- Validation: 
scalar performance:
{'acc': 0.9861111, 'precision': 0.92186606, 'recall': 0.85629946, 'specificity': 0.85629946, 'f1': 0.88610214, 'auroc': 0.9825532, 'binary_precision': 0.8537037, 'binary_recall': 0.7169518, 'binary_specificity': 0.99564713, 'binary_f1_score': 0.7793744}
confusion matrix:
       0    1
0  18070   79
1    182  461
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96612334, 'precision': 0.843761, 'recall': 0.65250444, 'specificity': 0.65250444, 'f1': 0.7078475, 'auroc': 0.9578242, 'binary_precision': 0.71681416, 'binary_recall': 0.31034482, 'binary_specificity': 0.994664, 'binary_f1_score': 0.43315506}
confusion matrix:
      0   1
0  5965  32
1   180  81
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20840080.png
early stop counter: 6
val acc:0.9861111044883728, best validation acc: 0.9881864786148071, corresponding to test acc:                         0.9613295197486877 / 0.9723553657531738
after epoch: 25,now: 2024-05-25 22:03:50.932743,epoch time: 0:27:11.738291,used: 11:32:54.563824,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_30_56_seed_0_20840080
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9940172, 'precision': 0.9484678, 'recall': 0.9608147, 'specificity': 0.9608147, 'f1': 0.95455074, 'auroc': 0.9986739, 'binary_precision': 0.8995373, 'binary_recall': 0.92522097, 'binary_specificity': 0.9964084, 'binary_f1_score': 0.9121984}
confusion matrix:
       0     1
0  42169   152
1    110  1361
---- Validation: 
scalar performance:
{'acc': 0.98621756, 'precision': 0.9079039, 'recall': 0.8766061, 'specificity': 0.8766061, 'f1': 0.89157903, 'auroc': 0.9812619, 'binary_precision': 0.8243243, 'binary_recall': 0.7589425, 'binary_specificity': 0.99426967, 'binary_f1_score': 0.79028344}
confusion matrix:
       0    1
0  18045  104
1    155  488
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9638862, 'precision': 0.8343699, 'recall': 0.6146905, 'specificity': 0.6146905, 'f1': 0.66600066, 'auroc': 0.9531886, 'binary_precision': 0.7011494, 'binary_recall': 0.23371647, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.3505747}
confusion matrix:
      0   1
0  5971  26
1   200  61
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20840080.png
early stop counter: 7
val acc:0.9862175583839417, best validation acc: 0.9881864786148071, corresponding to test acc:                         0.9613295197486877 / 0.9723553657531738
after epoch: 26,now: 2024-05-25 22:31:14.041003,epoch time: 0:27:23.108260,used: 12:00:17.672084,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_30_56_seed_0_20840080
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99161947, 'precision': 0.94089746, 'recall': 0.92845285, 'specificity': 0.92845285, 'f1': 0.9345791, 'auroc': 0.9965309, 'binary_precision': 0.886634, 'binary_recall': 0.8607337, 'binary_specificity': 0.996172, 'binary_f1_score': 0.87349194}
confusion matrix:
       0     1
0  42158   162
1    205  1267
---- Validation: 
scalar performance:
{'acc': 0.98249257, 'precision': 0.88596696, 'recall': 0.8341746, 'specificity': 0.8341746, 'f1': 0.85805225, 'auroc': 0.9793601, 'binary_precision': 0.7833935, 'binary_recall': 0.6749611, 'binary_specificity': 0.99338806, 'binary_f1_score': 0.7251462}
confusion matrix:
       0    1
0  18029  120
1    209  434
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96324706, 'precision': 0.7980122, 'recall': 0.6436743, 'specificity': 0.6436743, 'f1': 0.69104177, 'auroc': 0.9501724, 'binary_precision': 0.62601626, 'binary_recall': 0.29501915, 'binary_specificity': 0.9923295, 'binary_f1_score': 0.40104166}
confusion matrix:
      0   1
0  5951  46
1   184  77
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20840080.png
early stop counter: 8
val acc:0.9824925661087036, best validation acc: 0.9881864786148071, corresponding to test acc:                         0.9613295197486877 / 0.9723553657531738
after epoch: 27,now: 2024-05-25 22:58:30.685172,epoch time: 0:27:16.644169,used: 12:27:34.316253,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_30_56_seed_0_20840080
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9966204, 'precision': 0.97251344, 'recall': 0.97561324, 'specificity': 0.97561324, 'f1': 0.9740579, 'auroc': 0.9994545, 'binary_precision': 0.94665766, 'binary_recall': 0.9530931, 'binary_specificity': 0.9981333, 'binary_f1_score': 0.9498645}
confusion matrix:
       0     1
0  42242    79
1     69  1402
---- Validation: 
scalar performance:
{'acc': 0.9890911, 'precision': 0.93265384, 'recall': 0.8968451, 'specificity': 0.8968451, 'f1': 0.9139148, 'auroc': 0.9840443, 'binary_precision': 0.872449, 'binary_recall': 0.7978227, 'binary_specificity': 0.99586755, 'binary_f1_score': 0.83346874}
confusion matrix:
       0    1
0  18074   75
1    130  513
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9610099, 'precision': 0.8219905, 'recall': 0.56005204, 'specificity': 0.56005204, 'f1': 0.59390265, 'auroc': 0.92626834, 'binary_precision': 0.68085104, 'binary_recall': 0.12260536, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.2077922}
confusion matrix:
      0   1
0  5982  15
1   229  32
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20840080.png
better model found
persisted
after epoch: 28,now: 2024-05-25 23:25:56.703891,epoch time: 0:27:26.018719,used: 12:55:00.334972,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_30_56_seed_0_20840080
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9948849, 'precision': 0.95167434, 'recall': 0.9717805, 'specificity': 0.9717805, 'f1': 0.9614911, 'auroc': 0.9987642, 'binary_precision': 0.9051948, 'binary_recall': 0.9470109, 'binary_specificity': 0.9965501, 'binary_f1_score': 0.9256308}
confusion matrix:
       0     1
0  42174   146
1     78  1394
---- Validation: 
scalar performance:
{'acc': 0.9879204, 'precision': 0.91177577, 'recall': 0.9037396, 'specificity': 0.9037396, 'f1': 0.90771484, 'auroc': 0.9826285, 'binary_precision': 0.8301587, 'binary_recall': 0.8133748, 'binary_specificity': 0.9941044, 'binary_f1_score': 0.82168114}
confusion matrix:
       0    1
0  18042  107
1    120  523
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.7560507, 'recall': 0.6126061, 'specificity': 0.6126061, 'f1': 0.6532037, 'auroc': 0.943596, 'binary_precision': 0.54464287, 'binary_recall': 0.23371647, 'binary_specificity': 0.9914957, 'binary_f1_score': 0.32707775}
confusion matrix:
      0   1
0  5946  51
1   200  61
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20840080.png
early stop counter: 1
val acc:0.9879204034805298, best validation acc: 0.9890910983085632, corresponding to test acc:                         0.9610099196434021 / 0.9723553657531738
after epoch: 29,now: 2024-05-25 23:53:23.591647,epoch time: 0:27:26.887756,used: 13:22:27.222728,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_30_56_seed_0_20840080
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99550146, 'precision': 0.98507094, 'recall': 0.9445219, 'specificity': 0.9445219, 'f1': 0.96384686, 'auroc': 0.99921584, 'binary_precision': 0.9739583, 'binary_recall': 0.8898708, 'binary_specificity': 0.999173, 'binary_f1_score': 0.9300177}
confusion matrix:
       0     1
0  42286    35
1    162  1309
---- Validation: 
scalar performance:
{'acc': 0.98659, 'precision': 0.9374959, 'recall': 0.84754676, 'specificity': 0.84754676, 'f1': 0.8869765, 'auroc': 0.97956204, 'binary_precision': 0.8856016, 'binary_recall': 0.6982893, 'binary_specificity': 0.99680424, 'binary_f1_score': 0.7808695}
confusion matrix:
       0    1
0  18091   58
1    194  449
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96292746, 'precision': 0.9005033, 'recall': 0.5683819, 'specificity': 0.5683819, 'f1': 0.60892224, 'auroc': 0.94373846, 'binary_precision': 0.8372093, 'binary_recall': 0.13793103, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.23684211}
confusion matrix:
      0   1
0  5990   7
1   225  36
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20840080.png
early stop counter: 2
val acc:0.9865900278091431, best validation acc: 0.9890910983085632, corresponding to test acc:                         0.9610099196434021 / 0.9723553657531738
after epoch: 30,now: 2024-05-26 00:28:03.187078,epoch time: 0:34:39.595431,used: 13:57:06.818159,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_30_56_seed_0_20840080
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 13:57:06.818159 at 2024-05-26 00:28:03.187078
persisted model performance metric: 

scalar performance:
{'acc': 0.959412, 'precision': 0.7757369, 'recall': 0.5427273, 'specificity': 0.5427273, 'f1': 0.5662705, 'auroc': 0.9278611, 'binary_precision': 0.5897436, 'binary_recall': 0.08812261, 'binary_specificity': 0.997332, 'binary_f1_score': 0.15333334}
confusion matrix:
      0   1
0  5981  16
1   238  23
oracle model performance metric: 

scalar performance:
{'acc': 0.97299457, 'precision': 0.86885166, 'recall': 0.7550355, 'specificity': 0.7550355, 'f1': 0.8005203, 'auroc': 0.957405, 'binary_precision': 0.75842696, 'binary_recall': 0.51724136, 'binary_specificity': 0.99282974, 'binary_f1_score': 0.6150341}
confusion matrix:
      0    1
0  5954   43
1   126  135
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2finetuned_irm/rule_results/3.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2finetuned_irm/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2finetuned_irm/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 447825 KiB |  13211 MiB |   1116 TiB |   1116 TiB |
|       from large pool | 404210 KiB |  13171 MiB |   1103 TiB |   1103 TiB |
|       from small pool |  43615 KiB |     63 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 447825 KiB |  13211 MiB |   1116 TiB |   1116 TiB |
|       from large pool | 404210 KiB |  13171 MiB |   1103 TiB |   1103 TiB |
|       from small pool |  43615 KiB |     63 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 439406 KiB |  13206 MiB |   1112 TiB |   1112 TiB |
|       from large pool | 396800 KiB |  13167 MiB |   1099 TiB |   1099 TiB |
|       from small pool |  42606 KiB |     62 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14472 MiB |  14472 MiB |  14472 MiB |      0 B   |
|       from large pool |  14398 MiB |  14398 MiB |  14398 MiB |      0 B   |
|       from small pool |     74 MiB |     74 MiB |     74 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 463535 KiB |   1233 MiB | 784670 GiB | 784670 GiB |
|       from large pool | 451854 KiB |   1224 MiB | 771278 GiB | 771278 GiB |
|       from small pool |  11681 KiB |     17 MiB |  13391 GiB |  13391 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3488    |    6479    |  196391 K  |  196387 K  |
|       from large pool |     182    |    1409    |  102072 K  |  102072 K  |
|       from small pool |    3306    |    6295    |   94318 K  |   94315 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3488    |    6479    |  196391 K  |  196387 K  |
|       from large pool |     182    |    1409    |  102072 K  |  102072 K  |
|       from small pool |    3306    |    6295    |   94318 K  |   94315 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     638    |     638    |     638    |       0    |
|       from large pool |     601    |     601    |     601    |       0    |
|       from small pool |      37    |      37    |      37    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      83    |    2803    |  130850 K  |  130850 K  |
|       from large pool |      37    |     602    |   79819 K  |   79819 K  |
|       from small pool |      46    |    2766    |   51030 K  |   51030 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13211 MiB |   1116 TiB |   1116 TiB |
|       from large pool |  16640 KiB |  13171 MiB |   1103 TiB |   1103 TiB |
|       from small pool |      0 KiB |     63 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13211 MiB |   1116 TiB |   1116 TiB |
|       from large pool |  16640 KiB |  13171 MiB |   1103 TiB |   1103 TiB |
|       from small pool |      0 KiB |     63 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13206 MiB |   1112 TiB |   1112 TiB |
|       from large pool |  16640 KiB |  13167 MiB |   1099 TiB |   1099 TiB |
|       from small pool |      0 KiB |     62 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    890 MiB |  14472 MiB |  14472 MiB |  13582 MiB |
|       from large pool |    836 MiB |  14398 MiB |  14398 MiB |  13562 MiB |
|       from small pool |     54 MiB |     74 MiB |     74 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1233 MiB | 784671 GiB | 784671 GiB |
|       from large pool |  24320 KiB |   1224 MiB | 771279 GiB | 771279 GiB |
|       from small pool |      0 KiB |     38 MiB |  13392 GiB |  13392 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6479    |  196391 K  |  196391 K  |
|       from large pool |       2    |    1409    |  102072 K  |  102072 K  |
|       from small pool |       0    |    6295    |   94318 K  |   94318 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6479    |  196391 K  |  196391 K  |
|       from large pool |       2    |    1409    |  102072 K  |  102072 K  |
|       from small pool |       0    |    6295    |   94318 K  |   94318 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      64    |     638    |     638    |     574    |
|       from large pool |      37    |     601    |     601    |     564    |
|       from small pool |      27    |      37    |      37    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2803    |  130851 K  |  130851 K  |
|       from large pool |       4    |     602    |   79819 K  |   79819 K  |
|       from small pool |       0    |    2766    |   51031 K  |   51031 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sun May 26 00:30:57 2024]
Finished job 0.
1 of 1 steps (100%) done
