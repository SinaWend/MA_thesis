Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat May 25 10:15:37 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_dinov2finetuned_irm/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_dinov2finetuned_irm/rule_results/1.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=1
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_18_seed_0_20840078

 Experiment start at: 2024-05-25 10:22:18.133673
before training, model accuracy: 0.6481304168701172
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96981186, 'precision': 0.85368615, 'recall': 0.5784913, 'specificity': 0.5784913, 'f1': 0.6230218, 'auroc': 0.96322876, 'binary_precision': 0.7358491, 'binary_recall': 0.15896739, 'binary_specificity': 0.9980151, 'binary_f1_score': 0.26145253}
confusion matrix:
       0    1
0  42236   84
1   1238  234
---- Validation: 
scalar performance:
{'acc': 0.97041297, 'precision': 0.80878305, 'recall': 0.6501577, 'specificity': 0.6501577, 'f1': 0.69977987, 'auroc': 0.96019983, 'binary_precision': 0.64169383, 'binary_recall': 0.30637637, 'binary_specificity': 0.99393904, 'binary_f1_score': 0.41473687}
confusion matrix:
       0    1
0  18039  110
1    446  197
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9646852, 'precision': 0.9408615, 'recall': 0.5839577, 'specificity': 0.5839577, 'f1': 0.6333427, 'auroc': 0.96014357, 'binary_precision': 0.9166667, 'binary_recall': 0.16858238, 'binary_specificity': 0.999333, 'binary_f1_score': 0.28478965}
confusion matrix:
      0   1
0  5993   4
1   217  44
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20840078.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-25 10:50:21.290250,epoch time: 0:28:03.156577,used: 0:28:03.156577,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_18_seed_0_20840078
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9745616, 'precision': 0.96339375, 'recall': 0.6278326, 'specificity': 0.6278326, 'f1': 0.6953219, 'auroc': 0.97865, 'binary_precision': 0.9520202, 'binary_recall': 0.25611413, 'binary_specificity': 0.99955106, 'binary_f1_score': 0.4036402}
confusion matrix:
       0    1
0  42301   19
1   1095  377
---- Validation: 
scalar performance:
{'acc': 0.97349936, 'precision': 0.9489654, 'recall': 0.62250346, 'specificity': 0.62250346, 'f1': 0.6873314, 'auroc': 0.976244, 'binary_precision': 0.9239766, 'binary_recall': 0.24572317, 'binary_specificity': 0.99928373, 'binary_f1_score': 0.3882064}
confusion matrix:
       0    1
0  18136   13
1    485  158
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.7523175, 'recall': 0.5110774, 'specificity': 0.5110774, 'f1': 0.5114414, 'auroc': 0.96407175, 'binary_precision': 0.54545456, 'binary_recall': 0.022988506, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.04411765}
confusion matrix:
      0  1
0  5992  5
1   255  6
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20840078.png
better model found
persisted
after epoch: 2,now: 2024-05-25 11:17:18.412542,epoch time: 0:26:57.122292,used: 0:55:00.278869,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_18_seed_0_20840078
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97981364, 'precision': 0.8298948, 'recall': 0.8921816, 'specificity': 0.8921816, 'f1': 0.85808706, 'auroc': 0.97916436, 'binary_precision': 0.6668559, 'binary_recall': 0.7982337, 'binary_specificity': 0.98612946, 'binary_f1_score': 0.72665435}
confusion matrix:
       0     1
0  41733   587
1    297  1175
---- Validation: 
scalar performance:
{'acc': 0.9774372, 'precision': 0.8135364, 'recall': 0.894562, 'specificity': 0.894562, 'f1': 0.8489258, 'auroc': 0.97950184, 'binary_precision': 0.63402694, 'binary_recall': 0.80559874, 'binary_specificity': 0.9835253, 'binary_f1_score': 0.70958906}
confusion matrix:
       0    1
0  17850  299
1    125  518
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96324706, 'precision': 0.79708076, 'recall': 0.6455067, 'specificity': 0.6455067, 'f1': 0.6925919, 'auroc': 0.95626795, 'binary_precision': 0.624, 'binary_recall': 0.29885057, 'binary_specificity': 0.99216276, 'binary_f1_score': 0.40414506}
confusion matrix:
      0   1
0  5950  47
1   183  78
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20840078.png
better model found
persisted
after epoch: 3,now: 2024-05-25 11:44:14.356346,epoch time: 0:26:55.943804,used: 1:21:56.222673,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_18_seed_0_20840078
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9838555, 'precision': 0.9260441, 'recall': 0.8060787, 'specificity': 0.8060787, 'f1': 0.8555109, 'auroc': 0.9835006, 'binary_precision': 0.8653295, 'binary_recall': 0.6154891, 'binary_specificity': 0.9966682, 'binary_f1_score': 0.71933305}
confusion matrix:
       0    1
0  42179  141
1    566  906
---- Validation: 
scalar performance:
{'acc': 0.98185396, 'precision': 0.8888438, 'recall': 0.8165927, 'specificity': 0.8165927, 'f1': 0.848715, 'auroc': 0.97718406, 'binary_precision': 0.7903846, 'binary_recall': 0.63919127, 'binary_specificity': 0.9939942, 'binary_f1_score': 0.7067928}
confusion matrix:
       0    1
0  18040  109
1    232  411
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.9030609, 'recall': 0.52090603, 'specificity': 0.52090603, 'f1': 0.5298535, 'auroc': 0.95841855, 'binary_precision': 0.84615386, 'binary_recall': 0.042145595, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.08029197}
confusion matrix:
      0   1
0  5995   2
1   250  11
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20840078.png
better model found
persisted
after epoch: 4,now: 2024-05-25 12:11:14.625340,epoch time: 0:27:00.268994,used: 1:48:56.491667,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_18_seed_0_20840078
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9846547, 'precision': 0.89666486, 'recall': 0.85698247, 'specificity': 0.85698247, 'f1': 0.87569356, 'auroc': 0.98708296, 'binary_precision': 0.8030303, 'binary_recall': 0.7201087, 'binary_specificity': 0.9938563, 'binary_f1_score': 0.75931233}
confusion matrix:
       0     1
0  42060   260
1    412  1060
---- Validation: 
scalar performance:
{'acc': 0.9838229, 'precision': 0.89425826, 'recall': 0.8491144, 'specificity': 0.8491144, 'f1': 0.8702014, 'auroc': 0.98140585, 'binary_precision': 0.7989418, 'binary_recall': 0.7045101, 'binary_specificity': 0.9937187, 'binary_f1_score': 0.7487604}
confusion matrix:
       0    1
0  18035  114
1    190  453
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9610099, 'precision': 0.81197757, 'recall': 0.5655491, 'specificity': 0.5655491, 'f1': 0.6014666, 'auroc': 0.9584836, 'binary_precision': 0.6603774, 'binary_recall': 0.13409962, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.22292995}
confusion matrix:
      0   1
0  5979  18
1   226  35
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20840078.png
better model found
persisted
after epoch: 5,now: 2024-05-25 12:38:09.739092,epoch time: 0:26:55.113752,used: 2:15:51.605419,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_18_seed_0_20840078
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9850201, 'precision': 0.8905649, 'recall': 0.87413716, 'specificity': 0.87413716, 'f1': 0.8821597, 'auroc': 0.988094, 'binary_precision': 0.7896233, 'binary_recall': 0.7552685, 'binary_specificity': 0.9930058, 'binary_f1_score': 0.7720639}
confusion matrix:
       0     1
0  42025   296
1    360  1111
---- Validation: 
scalar performance:
{'acc': 0.9814815, 'precision': 0.8633152, 'recall': 0.85240257, 'specificity': 0.85240257, 'f1': 0.85776824, 'auroc': 0.978822, 'binary_precision': 0.73675764, 'binary_recall': 0.7138414, 'binary_specificity': 0.9909637, 'binary_f1_score': 0.7251185}
confusion matrix:
       0    1
0  17985  164
1    184  459
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96228826, 'precision': 0.8068439, 'recall': 0.6028627, 'specificity': 0.6028627, 'f1': 0.6492636, 'auroc': 0.96999216, 'binary_precision': 0.64705884, 'binary_recall': 0.21072797, 'binary_specificity': 0.9949975, 'binary_f1_score': 0.31791908}
confusion matrix:
      0   1
0  5967  30
1   206  55
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20840078.png
early stop counter: 1
val acc:0.9814814925193787, best validation acc: 0.9838228821754456, corresponding to test acc:                         0.9610099196434021 / 0.9646852016448975
after epoch: 6,now: 2024-05-25 13:05:03.897924,epoch time: 0:26:54.158832,used: 2:42:45.764251,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_18_seed_0_20840078
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9873036, 'precision': 0.9135083, 'recall': 0.88523746, 'specificity': 0.88523746, 'f1': 0.8988322, 'auroc': 0.9893241, 'binary_precision': 0.8347953, 'binary_recall': 0.7758152, 'binary_specificity': 0.9946597, 'binary_f1_score': 0.80422527}
confusion matrix:
       0     1
0  42094   226
1    330  1142
---- Validation: 
scalar performance:
{'acc': 0.9832908, 'precision': 0.90075433, 'recall': 0.8293375, 'specificity': 0.8293375, 'f1': 0.8612709, 'auroc': 0.9824171, 'binary_precision': 0.81333333, 'binary_recall': 0.66407466, 'binary_specificity': 0.99460024, 'binary_f1_score': 0.7311644}
confusion matrix:
       0    1
0  18051   98
1    216  427
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.79390097, 'recall': 0.5559705, 'specificity': 0.5559705, 'f1': 0.58688825, 'auroc': 0.9631895, 'binary_precision': 0.625, 'binary_recall': 0.11494253, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.19417475}
confusion matrix:
      0   1
0  5979  18
1   231  30
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20840078.png
early stop counter: 2
val acc:0.9832907915115356, best validation acc: 0.9838228821754456, corresponding to test acc:                         0.9610099196434021 / 0.9646852016448975
after epoch: 7,now: 2024-05-25 13:32:07.563148,epoch time: 0:27:03.665224,used: 3:09:49.429475,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_18_seed_0_20840078
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9870296, 'precision': 0.9121084, 'recall': 0.88173866, 'specificity': 0.88173866, 'f1': 0.8962957, 'auroc': 0.99083877, 'binary_precision': 0.83222955, 'binary_recall': 0.7688647, 'binary_specificity': 0.9946126, 'binary_f1_score': 0.7992932}
confusion matrix:
       0     1
0  42093   228
1    340  1131
---- Validation: 
scalar performance:
{'acc': 0.9845679, 'precision': 0.92584085, 'recall': 0.8239982, 'specificity': 0.8239982, 'f1': 0.8674765, 'auroc': 0.98088527, 'binary_precision': 0.8639175, 'binary_recall': 0.65163296, 'binary_specificity': 0.99636346, 'binary_f1_score': 0.7429078}
confusion matrix:
       0    1
0  18083   66
1    224  419
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.965644, 'precision': 0.8313335, 'recall': 0.65591896, 'specificity': 0.65591896, 'f1': 0.7089891, 'auroc': 0.96597147, 'binary_precision': 0.69166666, 'binary_recall': 0.31800765, 'binary_specificity': 0.99383026, 'binary_f1_score': 0.43569553}
confusion matrix:
      0   1
0  5960  37
1   178  83
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20840078.png
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-05-25 13:59:05.991238,epoch time: 0:26:58.428090,used: 3:36:47.857565,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_18_seed_0_20840078
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9871209, 'precision': 0.9014764, 'recall': 0.8998966, 'specificity': 0.8998966, 'f1': 0.90068483, 'auroc': 0.9902388, 'binary_precision': 0.80968624, 'binary_recall': 0.8063859, 'binary_specificity': 0.99340737, 'binary_f1_score': 0.80803263}
confusion matrix:
       0     1
0  42041   279
1    285  1187
---- Validation: 
scalar performance:
{'acc': 0.9850468, 'precision': 0.9008031, 'recall': 0.86399907, 'specificity': 0.86399907, 'f1': 0.8814419, 'auroc': 0.9822997, 'binary_precision': 0.8109966, 'binary_recall': 0.7340591, 'binary_specificity': 0.99393904, 'binary_f1_score': 0.7706123}
confusion matrix:
       0    1
0  18039  110
1    171  472
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9646852, 'precision': 0.82130945, 'recall': 0.64625704, 'specificity': 0.64625704, 'f1': 0.6977936, 'auroc': 0.96451885, 'binary_precision': 0.67241377, 'binary_recall': 0.29885057, 'binary_specificity': 0.9936635, 'binary_f1_score': 0.4137931}
confusion matrix:
      0   1
0  5959  38
1   183  78
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20840078.png
better model found
persisted
after epoch: 9,now: 2024-05-25 14:25:57.939997,epoch time: 0:26:51.948759,used: 4:03:39.806324,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_18_seed_0_20840078
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98686975, 'precision': 0.9112968, 'recall': 0.87960744, 'specificity': 0.87960744, 'f1': 0.8947661, 'auroc': 0.9896442, 'binary_precision': 0.8307465, 'binary_recall': 0.76462585, 'binary_specificity': 0.9945891, 'binary_f1_score': 0.79631597}
confusion matrix:
       0     1
0  42093   229
1    346  1124
---- Validation: 
scalar performance:
{'acc': 0.98392934, 'precision': 0.9037315, 'recall': 0.83791864, 'specificity': 0.83791864, 'f1': 0.867669, 'auroc': 0.98121715, 'binary_precision': 0.8186916, 'binary_recall': 0.68118197, 'binary_specificity': 0.9946554, 'binary_f1_score': 0.7436333}
confusion matrix:
       0    1
0  18052   97
1    205  438
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.8474791, 'recall': 0.5414786, 'specificity': 0.5414786, 'f1': 0.5654991, 'auroc': 0.944992, 'binary_precision': 0.73333335, 'binary_recall': 0.08429119, 'binary_specificity': 0.998666, 'binary_f1_score': 0.15120275}
confusion matrix:
      0   1
0  5989   8
1   239  22
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20840078.png
early stop counter: 1
val acc:0.9839293360710144, best validation acc: 0.9850468039512634, corresponding to test acc:                         0.9646852016448975 / 0.9656440019607544
after epoch: 10,now: 2024-05-25 14:52:50.821312,epoch time: 0:26:52.881315,used: 4:30:32.687639,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_18_seed_0_20840078
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9883312, 'precision': 0.9451304, 'recall': 0.86609757, 'specificity': 0.86609757, 'f1': 0.90147686, 'auroc': 0.99196345, 'binary_precision': 0.8994181, 'binary_recall': 0.7350544, 'binary_specificity': 0.9971408, 'binary_f1_score': 0.808972}
confusion matrix:
       0     1
0  42199   121
1    390  1082
---- Validation: 
scalar performance:
{'acc': 0.9845679, 'precision': 0.9382689, 'recall': 0.8119973, 'specificity': 0.8119973, 'f1': 0.86372685, 'auroc': 0.98068976, 'binary_precision': 0.8896247, 'binary_recall': 0.62674963, 'binary_specificity': 0.997245, 'binary_f1_score': 0.73540145}
confusion matrix:
       0    1
0  18099   50
1    240  403
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.98052883, 'recall': 0.5344828, 'specificity': 0.5344828, 'f1': 0.55458724, 'auroc': 0.9600391, 'binary_precision': 1.0, 'binary_recall': 0.06896552, 'binary_specificity': 1.0, 'binary_f1_score': 0.12903225}
confusion matrix:
      0   1
0  5997   0
1   243  18
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20840078.png
early stop counter: 2
val acc:0.9845678806304932, best validation acc: 0.9850468039512634, corresponding to test acc:                         0.9646852016448975 / 0.9656440019607544
after epoch: 11,now: 2024-05-25 15:19:45.106202,epoch time: 0:26:54.284890,used: 4:57:26.972529,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_18_seed_0_20840078
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98887926, 'precision': 0.9441687, 'recall': 0.87646186, 'specificity': 0.87646186, 'f1': 0.90731174, 'auroc': 0.99257505, 'binary_precision': 0.8967742, 'binary_recall': 0.7559483, 'binary_specificity': 0.9969755, 'binary_f1_score': 0.8203615}
confusion matrix:
       0     1
0  42193   128
1    359  1112
---- Validation: 
scalar performance:
{'acc': 0.98541933, 'precision': 0.92565876, 'recall': 0.8394401, 'specificity': 0.8394401, 'f1': 0.877316, 'auroc': 0.9795246, 'binary_precision': 0.86247545, 'binary_recall': 0.6827372, 'binary_specificity': 0.99614304, 'binary_f1_score': 0.7621528}
confusion matrix:
       0    1
0  18079   70
1    204  439
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96612334, 'precision': 0.878404, 'recall': 0.62685174, 'specificity': 0.62685174, 'f1': 0.6849317, 'auroc': 0.9604689, 'binary_precision': 0.7882353, 'binary_recall': 0.256705, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.3872833}
confusion matrix:
      0   1
0  5979  18
1   194  67
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20840078.png
new oracle model saved
better model found
persisted
after epoch: 12,now: 2024-05-25 15:46:31.918591,epoch time: 0:26:46.812389,used: 5:24:13.784918,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_18_seed_0_20840078
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98849106, 'precision': 0.90322936, 'recall': 0.9248671, 'specificity': 0.9248671, 'f1': 0.9137416, 'auroc': 0.9951037, 'binary_precision': 0.8114543, 'binary_recall': 0.8566576, 'binary_specificity': 0.99307656, 'binary_f1_score': 0.8334435}
confusion matrix:
       0     1
0  42027   293
1    211  1261
---- Validation: 
scalar performance:
{'acc': 0.98547256, 'precision': 0.8946687, 'recall': 0.8822208, 'specificity': 0.8822208, 'f1': 0.8883365, 'auroc': 0.98112375, 'binary_precision': 0.79742765, 'binary_recall': 0.7713841, 'binary_specificity': 0.9930575, 'binary_f1_score': 0.7841897}
confusion matrix:
       0    1
0  18023  126
1    147  496
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964845, 'precision': 0.82423544, 'recall': 0.6463404, 'specificity': 0.6463404, 'f1': 0.6983859, 'auroc': 0.95659137, 'binary_precision': 0.67826086, 'binary_recall': 0.29885057, 'binary_specificity': 0.99383026, 'binary_f1_score': 0.4148936}
confusion matrix:
      0   1
0  5960  37
1   183  78
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20840078.png
better model found
persisted
after epoch: 13,now: 2024-05-25 16:13:16.126768,epoch time: 0:26:44.208177,used: 5:50:57.993095,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_18_seed_0_20840078
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9923502, 'precision': 0.9448366, 'recall': 0.9363717, 'specificity': 0.9363717, 'f1': 0.9405603, 'auroc': 0.99545443, 'binary_precision': 0.8939709, 'binary_recall': 0.8763587, 'binary_specificity': 0.9963847, 'binary_f1_score': 0.8850772}
confusion matrix:
       0     1
0  42167   153
1    182  1290
---- Validation: 
scalar performance:
{'acc': 0.9867497, 'precision': 0.927586, 'recall': 0.8611304, 'specificity': 0.8611304, 'f1': 0.8913388, 'auroc': 0.9852686, 'binary_precision': 0.8648148, 'binary_recall': 0.7262831, 'binary_specificity': 0.99597776, 'binary_f1_score': 0.7895182}
confusion matrix:
       0    1
0  18076   73
1    176  467
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9610099, 'precision': 0.80176026, 'recall': 0.5728784, 'specificity': 0.5728784, 'f1': 0.6111131, 'auroc': 0.9590699, 'binary_precision': 0.6393443, 'binary_recall': 0.14942528, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.24223602}
confusion matrix:
      0   1
0  5975  22
1   222  39
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20840078.png
better model found
persisted
after epoch: 14,now: 2024-05-25 16:39:55.702991,epoch time: 0:26:39.576223,used: 6:17:37.569318,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_18_seed_0_20840078
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9870296, 'precision': 0.90292656, 'recall': 0.8955185, 'specificity': 0.8955185, 'f1': 0.8991853, 'auroc': 0.99302804, 'binary_precision': 0.8128898, 'binary_recall': 0.79741675, 'binary_specificity': 0.9936202, 'binary_f1_score': 0.805079}
confusion matrix:
       0     1
0  42051   270
1    298  1173
---- Validation: 
scalar performance:
{'acc': 0.98547256, 'precision': 0.9120053, 'recall': 0.8567189, 'specificity': 0.8567189, 'f1': 0.88221353, 'auroc': 0.9766245, 'binary_precision': 0.833935, 'binary_recall': 0.718507, 'binary_specificity': 0.99493086, 'binary_f1_score': 0.7719298}
confusion matrix:
       0    1
0  18057   92
1    181  462
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.7874361, 'recall': 0.5149088, 'specificity': 0.5149088, 'f1': 0.5186596, 'auroc': 0.9453033, 'binary_precision': 0.61538464, 'binary_recall': 0.03065134, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.058394164}
confusion matrix:
      0  1
0  5992  5
1   253  8
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20840078.png
early stop counter: 1
val acc:0.985472559928894, best validation acc: 0.9867497086524963, corresponding to test acc:                         0.9610099196434021 / 0.9661233425140381
after epoch: 15,now: 2024-05-25 17:06:31.309105,epoch time: 0:26:35.606114,used: 6:44:13.175432,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_18_seed_0_20840078
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9909116, 'precision': 0.9126796, 'recall': 0.95691127, 'specificity': 0.95691127, 'f1': 0.9335748, 'auroc': 0.9967555, 'binary_precision': 0.82813454, 'binary_recall': 0.92046225, 'binary_specificity': 0.9933603, 'binary_f1_score': 0.87186086}
confusion matrix:
       0     1
0  42040   281
1    117  1354
---- Validation: 
scalar performance:
{'acc': 0.9864304, 'precision': 0.889638, 'recall': 0.91121876, 'specificity': 0.91121876, 'f1': 0.9001119, 'auroc': 0.98496795, 'binary_precision': 0.7852941, 'binary_recall': 0.8304821, 'binary_specificity': 0.99195546, 'binary_f1_score': 0.8072562}
confusion matrix:
       0    1
0  18003  146
1    109  534
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.7623528, 'recall': 0.60727584, 'specificity': 0.60727584, 'f1': 0.64865804, 'auroc': 0.9634439, 'binary_precision': 0.5576923, 'binary_recall': 0.22222222, 'binary_specificity': 0.9923295, 'binary_f1_score': 0.31780824}
confusion matrix:
      0   1
0  5951  46
1   203  58
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20840078.png
early stop counter: 2
val acc:0.9864304065704346, best validation acc: 0.9867497086524963, corresponding to test acc:                         0.9610099196434021 / 0.9661233425140381
after epoch: 16,now: 2024-05-25 17:33:09.956022,epoch time: 0:26:38.646917,used: 7:10:51.822349,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_18_seed_0_20840078
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9918478, 'precision': 0.9400908, 'recall': 0.9334451, 'specificity': 0.9334451, 'f1': 0.93674064, 'auroc': 0.9962394, 'binary_precision': 0.8846685, 'binary_recall': 0.87083614, 'binary_specificity': 0.996054, 'binary_f1_score': 0.8776978}
confusion matrix:
       0     1
0  42154   167
1    190  1281
---- Validation: 
scalar performance:
{'acc': 0.9864304, 'precision': 0.9151073, 'recall': 0.87071586, 'specificity': 0.87071586, 'f1': 0.891556, 'auroc': 0.98346007, 'binary_precision': 0.83916086, 'binary_recall': 0.7465008, 'binary_specificity': 0.99493086, 'binary_f1_score': 0.7901235}
confusion matrix:
       0    1
0  18057   92
1    163  480
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96292746, 'precision': 0.7863902, 'recall': 0.6599986, 'specificity': 0.6599986, 'f1': 0.70329404, 'auroc': 0.94762194, 'binary_precision': 0.6013986, 'binary_recall': 0.32950193, 'binary_specificity': 0.99049526, 'binary_f1_score': 0.42574257}
confusion matrix:
      0   1
0  5940  57
1   175  86
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20840078.png
early stop counter: 3
val acc:0.9864304065704346, best validation acc: 0.9867497086524963, corresponding to test acc:                         0.9610099196434021 / 0.9661233425140381
after epoch: 17,now: 2024-05-25 17:59:54.371454,epoch time: 0:26:44.415432,used: 7:37:36.237781,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_18_seed_0_20840078
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9926242, 'precision': 0.92933834, 'recall': 0.9627422, 'specificity': 0.9627422, 'f1': 0.94536316, 'auroc': 0.9978651, 'binary_precision': 0.86109364, 'binary_recall': 0.9307065, 'binary_specificity': 0.99477786, 'binary_f1_score': 0.8945478}
confusion matrix:
       0     1
0  42099   221
1    102  1370
---- Validation: 
scalar performance:
{'acc': 0.9866965, 'precision': 0.8913467, 'recall': 0.9136067, 'specificity': 0.9136067, 'f1': 0.9021418, 'auroc': 0.98486507, 'binary_precision': 0.78854626, 'binary_recall': 0.83514774, 'binary_specificity': 0.99206567, 'binary_f1_score': 0.8111783}
confusion matrix:
       0    1
0  18005  144
1    106  537
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9682007, 'precision': 0.8575538, 'recall': 0.67924094, 'specificity': 0.67924094, 'f1': 0.73601115, 'auroc': 0.96233064, 'binary_precision': 0.7421875, 'binary_recall': 0.36398467, 'binary_specificity': 0.99449724, 'binary_f1_score': 0.48843187}
confusion matrix:
      0   1
0  5964  33
1   166  95
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20840078.png
new oracle model saved
early stop counter: 4
val acc:0.9866964817047119, best validation acc: 0.9867497086524963, corresponding to test acc:                         0.9610099196434021 / 0.96820068359375
after epoch: 18,now: 2024-05-25 18:26:33.543601,epoch time: 0:26:39.172147,used: 8:04:15.409928,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_18_seed_0_20840078
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99330926, 'precision': 0.9515504, 'recall': 0.94473654, 'specificity': 0.94473654, 'f1': 0.9481156, 'auroc': 0.9972269, 'binary_precision': 0.9068323, 'binary_recall': 0.89266306, 'binary_specificity': 0.99681, 'binary_f1_score': 0.8996919}
confusion matrix:
       0     1
0  42185   135
1    158  1314
---- Validation: 
scalar performance:
{'acc': 0.9860579, 'precision': 0.90430796, 'recall': 0.87877357, 'specificity': 0.87877357, 'f1': 0.8910897, 'auroc': 0.9843389, 'binary_precision': 0.8169717, 'binary_recall': 0.7636081, 'binary_specificity': 0.99393904, 'binary_f1_score': 0.78938913}
confusion matrix:
       0    1
0  18039  110
1    152  491
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.8188578, 'recall': 0.61060894, 'specificity': 0.61060894, 'f1': 0.6595616, 'auroc': 0.94796616, 'binary_precision': 0.67045456, 'binary_recall': 0.22605364, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.3381089}
confusion matrix:
      0   1
0  5968  29
1   202  59
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20840078.png
early stop counter: 5
val acc:0.9860578775405884, best validation acc: 0.9867497086524963, corresponding to test acc:                         0.9610099196434021 / 0.96820068359375
after epoch: 19,now: 2024-05-25 18:53:24.989542,epoch time: 0:26:51.445941,used: 8:31:06.855869,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_18_seed_0_20840078
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99321795, 'precision': 0.9532813, 'recall': 0.94108284, 'specificity': 0.94108284, 'f1': 0.9470924, 'auroc': 0.99749243, 'binary_precision': 0.9105521, 'binary_recall': 0.8851902, 'binary_specificity': 0.9969754, 'binary_f1_score': 0.8976921}
confusion matrix:
       0     1
0  42192   128
1    169  1303
---- Validation: 
scalar performance:
{'acc': 0.98573864, 'precision': 0.89561296, 'recall': 0.8861089, 'specificity': 0.8861089, 'f1': 0.8907982, 'auroc': 0.9866922, 'binary_precision': 0.79904306, 'binary_recall': 0.7791602, 'binary_specificity': 0.9930575, 'binary_f1_score': 0.78897643}
confusion matrix:
       0    1
0  18023  126
1    142  501
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96612334, 'precision': 0.82106876, 'recall': 0.68182176, 'specificity': 0.68182176, 'f1': 0.73016316, 'auroc': 0.95403594, 'binary_precision': 0.6689655, 'binary_recall': 0.3716475, 'binary_specificity': 0.991996, 'binary_f1_score': 0.4778325}
confusion matrix:
      0   1
0  5949  48
1   164  97
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20840078.png
early stop counter: 6
val acc:0.9857386350631714, best validation acc: 0.9867497086524963, corresponding to test acc:                         0.9610099196434021 / 0.96820068359375
after epoch: 20,now: 2024-05-25 19:20:16.890902,epoch time: 0:26:51.901360,used: 8:57:58.757229,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_18_seed_0_20840078
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99303526, 'precision': 0.94002205, 'recall': 0.9547291, 'specificity': 0.9547291, 'f1': 0.947245, 'auroc': 0.99787974, 'binary_precision': 0.8830486, 'binary_recall': 0.91366416, 'binary_specificity': 0.99579406, 'binary_f1_score': 0.89809555}
confusion matrix:
       0     1
0  42143   178
1    127  1344
---- Validation: 
scalar performance:
{'acc': 0.9868561, 'precision': 0.9040373, 'recall': 0.894938, 'specificity': 0.894938, 'f1': 0.89943147, 'auroc': 0.98462105, 'binary_precision': 0.81528664, 'binary_recall': 0.7962675, 'binary_specificity': 0.9936085, 'binary_f1_score': 0.80566484}
confusion matrix:
       0    1
0  18033  116
1    131  512
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.76883256, 'recall': 0.5722948, 'specificity': 0.5722948, 'f1': 0.60824317, 'auroc': 0.95725256, 'binary_precision': 0.5735294, 'binary_recall': 0.14942528, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.23708206}
confusion matrix:
      0   1
0  5968  29
1   222  39
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20840078.png
better model found
persisted
after epoch: 21,now: 2024-05-25 19:47:15.503138,epoch time: 0:26:58.612236,used: 9:24:57.369465,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_18_seed_0_20840078
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9907061, 'precision': 0.9822488, 'recall': 0.87158847, 'specificity': 0.87158847, 'f1': 0.91924584, 'auroc': 0.9978241, 'binary_precision': 0.97333336, 'binary_recall': 0.7438859, 'binary_specificity': 0.9992911, 'binary_f1_score': 0.8432807}
confusion matrix:
       0     1
0  42290    30
1    377  1095
---- Validation: 
scalar performance:
{'acc': 0.9845147, 'precision': 0.96712565, 'recall': 0.7887181, 'specificity': 0.7887181, 'f1': 0.85543936, 'auroc': 0.98121166, 'binary_precision': 0.9489796, 'binary_recall': 0.5785381, 'binary_specificity': 0.998898, 'binary_f1_score': 0.7188406}
confusion matrix:
       0    1
0  18129   20
1    271  372
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.8459687, 'recall': 0.5358148, 'specificity': 0.5358148, 'f1': 0.55602133, 'auroc': 0.9457438, 'binary_precision': 0.7307692, 'binary_recall': 0.07279693, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.13240418}
confusion matrix:
      0   1
0  5990   7
1   242  19
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20840078.png
early stop counter: 1
val acc:0.9845147132873535, best validation acc: 0.9868561029434204, corresponding to test acc:                         0.9598913192749023 / 0.96820068359375
after epoch: 22,now: 2024-05-25 20:14:08.065437,epoch time: 0:26:52.562299,used: 9:51:49.931764,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_18_seed_0_20840078
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9942227, 'precision': 0.94765735, 'recall': 0.96553636, 'specificity': 0.96553636, 'f1': 0.9564078, 'auroc': 0.99828076, 'binary_precision': 0.8975864, 'binary_recall': 0.9347826, 'binary_specificity': 0.99629015, 'binary_f1_score': 0.91580695}
confusion matrix:
       0     1
0  42163   157
1     96  1376
---- Validation: 
scalar performance:
{'acc': 0.98722863, 'precision': 0.9148308, 'recall': 0.8861302, 'specificity': 0.8861302, 'f1': 0.89992404, 'auroc': 0.9806073, 'binary_precision': 0.83752096, 'binary_recall': 0.777605, 'binary_specificity': 0.9946554, 'binary_f1_score': 0.8064517}
confusion matrix:
       0    1
0  18052   97
1    143  500
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9613295, 'precision': 0.78158104, 'recall': 0.6096918, 'specificity': 0.6096918, 'f1': 0.65393496, 'auroc': 0.9501732, 'binary_precision': 0.5959596, 'binary_recall': 0.22605364, 'binary_specificity': 0.99333, 'binary_f1_score': 0.32777777}
confusion matrix:
      0   1
0  5957  40
1   202  59
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20840078.png
better model found
persisted
after epoch: 23,now: 2024-05-25 20:41:02.952594,epoch time: 0:26:54.887157,used: 10:18:44.818921,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_18_seed_0_20840078
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99426836, 'precision': 0.9426991, 'recall': 0.9731008, 'specificity': 0.9731008, 'f1': 0.9573543, 'auroc': 0.9988608, 'binary_precision': 0.88712746, 'binary_recall': 0.9504076, 'binary_specificity': 0.99579394, 'binary_f1_score': 0.9176779}
confusion matrix:
       0     1
0  42142   178
1     73  1399
---- Validation: 
scalar performance:
{'acc': 0.9874947, 'precision': 0.91147196, 'recall': 0.8960186, 'specificity': 0.8960186, 'f1': 0.9035851, 'auroc': 0.9813432, 'binary_precision': 0.8300971, 'binary_recall': 0.7978227, 'binary_specificity': 0.99421453, 'binary_f1_score': 0.81364}
confusion matrix:
       0    1
0  18044  105
1    130  513
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96324706, 'precision': 0.7953117, 'recall': 0.64917135, 'specificity': 0.64917135, 'f1': 0.69564444, 'auroc': 0.95362926, 'binary_precision': 0.62015504, 'binary_recall': 0.3065134, 'binary_specificity': 0.9918293, 'binary_f1_score': 0.41025642}
confusion matrix:
      0   1
0  5948  49
1   181  80
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20840078.png
better model found
persisted
after epoch: 24,now: 2024-05-25 21:08:21.572807,epoch time: 0:27:18.620213,used: 10:46:03.439134,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_18_seed_0_20840078
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99463373, 'precision': 0.9630132, 'recall': 0.95358753, 'specificity': 0.95358753, 'f1': 0.95824814, 'auroc': 0.9982748, 'binary_precision': 0.9291667, 'binary_recall': 0.9095853, 'binary_specificity': 0.9975898, 'binary_f1_score': 0.9192717}
confusion matrix:
       0     1
0  42219   102
1    133  1338
---- Validation: 
scalar performance:
{'acc': 0.9865368, 'precision': 0.9148791, 'recall': 0.87302107, 'specificity': 0.87302107, 'f1': 0.89274776, 'auroc': 0.9816656, 'binary_precision': 0.8385417, 'binary_recall': 0.7511664, 'binary_specificity': 0.9948757, 'binary_f1_score': 0.7924529}
confusion matrix:
       0    1
0  18056   93
1    160  483
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96212846, 'precision': 0.7916865, 'recall': 0.6192704, 'specificity': 0.6192704, 'f1': 0.66559017, 'auroc': 0.9409213, 'binary_precision': 0.61538464, 'binary_recall': 0.24521072, 'binary_specificity': 0.99333, 'binary_f1_score': 0.35068494}
confusion matrix:
      0   1
0  5957  40
1   197  64
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20840078.png
early stop counter: 1
val acc:0.9865368008613586, best validation acc: 0.987494707107544, corresponding to test acc:                         0.9632470607757568 / 0.96820068359375
after epoch: 25,now: 2024-05-25 21:35:24.523300,epoch time: 0:27:02.950493,used: 11:13:06.389627,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_18_seed_0_20840078
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99445105, 'precision': 0.97113776, 'recall': 0.94172084, 'specificity': 0.94172084, 'f1': 0.9559195, 'auroc': 0.9987689, 'binary_precision': 0.94626, 'binary_recall': 0.8851902, 'binary_specificity': 0.99825144, 'binary_f1_score': 0.9147068}
confusion matrix:
       0     1
0  42246    74
1    169  1303
---- Validation: 
scalar performance:
{'acc': 0.98573864, 'precision': 0.92263776, 'recall': 0.84860605, 'specificity': 0.84860605, 'f1': 0.88179016, 'auroc': 0.985166, 'binary_precision': 0.85578746, 'binary_recall': 0.7013997, 'binary_specificity': 0.9958124, 'binary_f1_score': 0.7709402}
confusion matrix:
       0    1
0  18073   76
1    192  451
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9637264, 'precision': 0.8069688, 'recall': 0.6420921, 'specificity': 0.6420921, 'f1': 0.6911761, 'auroc': 0.9532694, 'binary_precision': 0.6440678, 'binary_recall': 0.29118773, 'binary_specificity': 0.9929965, 'binary_f1_score': 0.4010554}
confusion matrix:
      0   1
0  5955  42
1   185  76
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20840078.png
early stop counter: 2
val acc:0.9857386350631714, best validation acc: 0.987494707107544, corresponding to test acc:                         0.9632470607757568 / 0.96820068359375
after epoch: 26,now: 2024-05-25 22:03:34.718213,epoch time: 0:28:10.194913,used: 11:41:16.584540,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_18_seed_0_20840078
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.98960996, 'precision': 0.91210157, 'recall': 0.9323311, 'specificity': 0.9323311, 'f1': 0.9219537, 'auroc': 0.9953705, 'binary_precision': 0.8287007, 'binary_recall': 0.87092394, 'binary_specificity': 0.9937382, 'binary_f1_score': 0.84928787}
confusion matrix:
       0     1
0  42055   265
1    190  1282
---- Validation: 
scalar performance:
{'acc': 0.9819604, 'precision': 0.86201644, 'recall': 0.8669015, 'specificity': 0.8669015, 'f1': 0.86444116, 'auroc': 0.9794219, 'binary_precision': 0.73312885, 'binary_recall': 0.7433904, 'binary_specificity': 0.9904127, 'binary_f1_score': 0.7382239}
confusion matrix:
       0    1
0  17975  174
1    165  478
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614893, 'precision': 0.8060012, 'recall': 0.5822902, 'specificity': 0.5822902, 'f1': 0.62385106, 'auroc': 0.93793386, 'binary_precision': 0.64705884, 'binary_recall': 0.16858238, 'binary_specificity': 0.995998, 'binary_f1_score': 0.2674772}
confusion matrix:
      0   1
0  5973  24
1   217  44
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20840078.png
early stop counter: 3
val acc:0.9819604158401489, best validation acc: 0.987494707107544, corresponding to test acc:                         0.9632470607757568 / 0.96820068359375
after epoch: 27,now: 2024-05-25 22:30:54.383508,epoch time: 0:27:19.665295,used: 12:08:36.249835,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_18_seed_0_20840078
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9954558, 'precision': 0.9739809, 'recall': 0.95496714, 'specificity': 0.95496714, 'f1': 0.96426475, 'auroc': 0.99884164, 'binary_precision': 0.9510291, 'binary_recall': 0.91156465, 'binary_specificity': 0.99836963, 'binary_f1_score': 0.9308788}
confusion matrix:
       0     1
0  42253    69
1    130  1340
---- Validation: 
scalar performance:
{'acc': 0.98664325, 'precision': 0.9157746, 'recall': 0.87382627, 'specificity': 0.87382627, 'f1': 0.8935956, 'auroc': 0.9850023, 'binary_precision': 0.8402778, 'binary_recall': 0.7527216, 'binary_specificity': 0.99493086, 'binary_f1_score': 0.79409343}
confusion matrix:
       0    1
0  18057   92
1    159  484
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96580374, 'precision': 0.8109464, 'recall': 0.692649, 'specificity': 0.692649, 'f1': 0.7363922, 'auroc': 0.9477466, 'binary_precision': 0.6477987, 'binary_recall': 0.394636, 'binary_specificity': 0.990662, 'binary_f1_score': 0.49047622}
confusion matrix:
      0    1
0  5941   56
1   158  103
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20840078.png
early stop counter: 4
val acc:0.9866432547569275, best validation acc: 0.987494707107544, corresponding to test acc:                         0.9632470607757568 / 0.96820068359375
after epoch: 28,now: 2024-05-25 22:58:10.336990,epoch time: 0:27:15.953482,used: 12:35:52.203317,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_18_seed_0_20840078
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9939258, 'precision': 0.9894546, 'recall': 0.91581905, 'specificity': 0.91581905, 'f1': 0.9494277, 'auroc': 0.9990883, 'binary_precision': 0.9847144, 'binary_recall': 0.83208704, 'binary_specificity': 0.99955106, 'binary_f1_score': 0.9019897}
confusion matrix:
       0     1
0  42302    19
1    247  1224
---- Validation: 
scalar performance:
{'acc': 0.9871222, 'precision': 0.9607668, 'recall': 0.8350713, 'specificity': 0.8350713, 'f1': 0.8872796, 'auroc': 0.98127425, 'binary_precision': 0.9330453, 'binary_recall': 0.6718507, 'binary_specificity': 0.9982919, 'binary_f1_score': 0.78119344}
confusion matrix:
       0    1
0  18118   31
1    211  432
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.7499351, 'recall': 0.53872913, 'specificity': 0.53872913, 'f1': 0.5594401, 'auroc': 0.94909096, 'binary_precision': 0.53846157, 'binary_recall': 0.08045977, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.14000002}
confusion matrix:
      0   1
0  5979  18
1   240  21
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20840078.png
early stop counter: 5
val acc:0.9871221780776978, best validation acc: 0.987494707107544, corresponding to test acc:                         0.9632470607757568 / 0.96820068359375
after epoch: 29,now: 2024-05-25 23:25:29.145075,epoch time: 0:27:18.808085,used: 13:03:11.011402,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_18_seed_0_20840078
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9963692, 'precision': 0.98855424, 'recall': 0.9547831, 'specificity': 0.9547831, 'f1': 0.97101957, 'auroc': 0.9996347, 'binary_precision': 0.9802198, 'binary_recall': 0.91020405, 'binary_specificity': 0.99936205, 'binary_f1_score': 0.9439153}
confusion matrix:
       0     1
0  42295    27
1    132  1338
---- Validation: 
scalar performance:
{'acc': 0.9871754, 'precision': 0.93139935, 'recall': 0.86435103, 'specificity': 0.86435103, 'f1': 0.89483, 'auroc': 0.9831896, 'binary_precision': 0.87222224, 'binary_recall': 0.7325039, 'binary_specificity': 0.9961981, 'binary_f1_score': 0.7962807}
confusion matrix:
       0    1
0  18080   69
1    172  471
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650048, 'precision': 0.8272127, 'recall': 0.64642376, 'specificity': 0.64642376, 'f1': 0.698981, 'auroc': 0.9455853, 'binary_precision': 0.68421054, 'binary_recall': 0.29885057, 'binary_specificity': 0.993997, 'binary_f1_score': 0.416}
confusion matrix:
      0   1
0  5961  36
1   183  78
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20840078.png
early stop counter: 6
val acc:0.9871754050254822, best validation acc: 0.987494707107544, corresponding to test acc:                         0.9632470607757568 / 0.96820068359375
after epoch: 30,now: 2024-05-25 23:53:01.123141,epoch time: 0:27:31.978066,used: 13:30:42.989468,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_18_seed_0_20840078
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 13:30:42.989468 at 2024-05-25 23:53:01.123141
persisted model performance metric: 

scalar performance:
{'acc': 0.9643656, 'precision': 0.8131198, 'recall': 0.64975494, 'specificity': 0.64975494, 'f1': 0.6996875, 'auroc': 0.9438963, 'binary_precision': 0.6557377, 'binary_recall': 0.3065134, 'binary_specificity': 0.9929965, 'binary_f1_score': 0.41775456}
confusion matrix:
      0   1
0  5955  42
1   181  80
oracle model performance metric: 

scalar performance:
{'acc': 0.9653244, 'precision': 0.8285624, 'recall': 0.65208757, 'specificity': 0.65208757, 'f1': 0.70478076, 'auroc': 0.9531325, 'binary_precision': 0.6864407, 'binary_recall': 0.31034482, 'binary_specificity': 0.99383026, 'binary_f1_score': 0.42744064}
confusion matrix:
      0   1
0  5960  37
1   180  81
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2finetuned_irm/rule_results/1.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2finetuned_irm/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2finetuned_irm/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 447825 KiB |  13211 MiB |   1116 TiB |   1116 TiB |
|       from large pool | 404210 KiB |  13171 MiB |   1103 TiB |   1103 TiB |
|       from small pool |  43615 KiB |     63 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 447825 KiB |  13211 MiB |   1116 TiB |   1116 TiB |
|       from large pool | 404210 KiB |  13171 MiB |   1103 TiB |   1103 TiB |
|       from small pool |  43615 KiB |     63 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 439406 KiB |  13206 MiB |   1112 TiB |   1112 TiB |
|       from large pool | 396800 KiB |  13167 MiB |   1099 TiB |   1099 TiB |
|       from small pool |  42606 KiB |     62 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14472 MiB |  14472 MiB |  14472 MiB |      0 B   |
|       from large pool |  14398 MiB |  14398 MiB |  14398 MiB |      0 B   |
|       from small pool |     74 MiB |     74 MiB |     74 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 461487 KiB |   1233 MiB | 784668 GiB | 784668 GiB |
|       from large pool | 451854 KiB |   1224 MiB | 771279 GiB | 771279 GiB |
|       from small pool |   9633 KiB |     17 MiB |  13389 GiB |  13389 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3488    |    6479    |  196393 K  |  196389 K  |
|       from large pool |     182    |    1409    |  102073 K  |  102072 K  |
|       from small pool |    3306    |    6295    |   94320 K  |   94316 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3488    |    6479    |  196393 K  |  196389 K  |
|       from large pool |     182    |    1409    |  102073 K  |  102072 K  |
|       from small pool |    3306    |    6295    |   94320 K  |   94316 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     638    |     638    |     638    |       0    |
|       from large pool |     601    |     601    |     601    |       0    |
|       from small pool |      37    |      37    |      37    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      82    |    2802    |  131318 K  |  131318 K  |
|       from large pool |      37    |     602    |   79820 K  |   79819 K  |
|       from small pool |      45    |    2765    |   51498 K  |   51498 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13211 MiB |   1116 TiB |   1116 TiB |
|       from large pool |  16640 KiB |  13171 MiB |   1103 TiB |   1103 TiB |
|       from small pool |      0 KiB |     63 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13211 MiB |   1116 TiB |   1116 TiB |
|       from large pool |  16640 KiB |  13171 MiB |   1103 TiB |   1103 TiB |
|       from small pool |      0 KiB |     63 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13206 MiB |   1112 TiB |   1112 TiB |
|       from large pool |  16640 KiB |  13167 MiB |   1099 TiB |   1099 TiB |
|       from small pool |      0 KiB |     62 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    888 MiB |  14472 MiB |  14472 MiB |  13584 MiB |
|       from large pool |    836 MiB |  14398 MiB |  14398 MiB |  13562 MiB |
|       from small pool |     52 MiB |     74 MiB |     74 MiB |     22 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1233 MiB | 784669 GiB | 784668 GiB |
|       from large pool |  24320 KiB |   1224 MiB | 771279 GiB | 771279 GiB |
|       from small pool |      0 KiB |     44 MiB |  13389 GiB |  13389 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6479    |  196393 K  |  196393 K  |
|       from large pool |       2    |    1409    |  102073 K  |  102073 K  |
|       from small pool |       0    |    6295    |   94320 K  |   94320 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6479    |  196393 K  |  196393 K  |
|       from large pool |       2    |    1409    |  102073 K  |  102073 K  |
|       from small pool |       0    |    6295    |   94320 K  |   94320 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     638    |     638    |     575    |
|       from large pool |      37    |     601    |     601    |     564    |
|       from small pool |      26    |      37    |      37    |      11    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2802    |  131320 K  |  131320 K  |
|       from large pool |       4    |     602    |   79820 K  |   79820 K  |
|       from small pool |       0    |    2765    |   51499 K  |   51499 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat May 25 23:55:29 2024]
Finished job 0.
1 of 1 steps (100%) done
