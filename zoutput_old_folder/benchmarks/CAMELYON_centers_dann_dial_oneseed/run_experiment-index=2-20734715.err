Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Wed May 22 09:45:53 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_centers_dann_dial/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_centers_dann_dial/rule_results/2.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=2
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/lustre/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_22_10_07_39_seed_0_20734715

 Experiment start at: 2024-05-22 10:07:39.450220
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.955097496509552
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/autograd/graph.py:744: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96807635, 'precision': 0.9710459, 'recall': 0.52546924, 'specificity': 0.52546924, 'f1': 0.5403251, 'auroc': 0.97070646}
---- Validation: 
scalar performance:
{'acc': 0.96674114, 'precision': 0.9833546, 'recall': 0.5139969, 'specificity': 0.5139969, 'f1': 0.5187679, 'auroc': 0.9695805}
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.9468572}
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20734715.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-22 11:08:14.535962,epoch time: 1:00:35.085742,used: 1:00:35.085742,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_22_10_07_39_seed_0_20734715
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9731001, 'precision': 0.94072974, 'recall': 0.61015433, 'specificity': 0.61015433, 'f1': 0.67092156, 'auroc': 0.97714156}
---- Validation: 
scalar performance:
{'acc': 0.97121114, 'precision': 0.9262295, 'recall': 0.5913166, 'specificity': 0.5913166, 'f1': 0.644517, 'auroc': 0.972492}
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589326, 'precision': 0.8296735, 'recall': 0.5131598, 'specificity': 0.5131598, 'f1': 0.51533616, 'auroc': 0.9550787}
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20734715.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-05-22 12:12:14.012859,epoch time: 1:03:59.476897,used: 2:04:34.562639,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_22_10_07_39_seed_0_20734715
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9809554, 'precision': 0.9182656, 'recall': 0.7603172, 'specificity': 0.7603172, 'f1': 0.81960106, 'auroc': 0.98479533}
---- Validation: 
scalar performance:
{'acc': 0.97616005, 'precision': 0.896201, 'recall': 0.6951362, 'specificity': 0.6951362, 'f1': 0.7590839, 'auroc': 0.9762285}
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.781849, 'recall': 0.5669645, 'specificity': 0.5669645, 'f1': 0.6019404, 'auroc': 0.9568715}
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20734715.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-05-22 13:36:12.772768,epoch time: 1:23:58.759909,used: 3:28:33.322548,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_22_10_07_39_seed_0_20734715
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9805672, 'precision': 0.84076977, 'recall': 0.8774899, 'specificity': 0.8774899, 'f1': 0.8581023, 'auroc': 0.98593223}
---- Validation: 
scalar performance:
{'acc': 0.98212004, 'precision': 0.8705535, 'recall': 0.85273314, 'specificity': 0.85273314, 'f1': 0.8614044, 'auroc': 0.9828096}
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96596354, 'precision': 0.8325094, 'recall': 0.6615827, 'specificity': 0.6615827, 'f1': 0.71459746, 'auroc': 0.9604645}
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20734715.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-05-22 14:39:07.778308,epoch time: 1:02:55.005540,used: 4:31:28.328088,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_22_10_07_39_seed_0_20734715
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9825539, 'precision': 0.8739172, 'recall': 0.8488106, 'specificity': 0.8488106, 'f1': 0.8608906, 'auroc': 0.9889004}
---- Validation: 
scalar performance:
{'acc': 0.97988504, 'precision': 0.8606154, 'recall': 0.81932366, 'specificity': 0.81932366, 'f1': 0.83860564, 'auroc': 0.9814732}
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.84009373, 'recall': 0.59411794, 'specificity': 0.59411794, 'f1': 0.64157856, 'auroc': 0.9675046}
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20734715.png
early stop counter: 1
val acc:0.9798850417137146, best validation acc: 0.9821200370788574, corresponding to test acc:                         0.9659635424613953 / 0.9659635424613953
after epoch: 5,now: 2024-05-22 15:44:11.592169,epoch time: 1:05:03.813861,used: 5:36:32.141949,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_22_10_07_39_seed_0_20734715
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98686975, 'precision': 0.89904475, 'recall': 0.8987831, 'specificity': 0.8987831, 'f1': 0.89891386, 'auroc': 0.9911803}
---- Validation: 
scalar performance:
{'acc': 0.9856322, 'precision': 0.90038264, 'recall': 0.876303, 'specificity': 0.876303, 'f1': 0.88793814, 'auroc': 0.9839602}
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.7989384, 'recall': 0.5616343, 'specificity': 0.5616343, 'f1': 0.59531087, 'auroc': 0.957384}
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20734715.png
better model found
persisted
after epoch: 6,now: 2024-05-22 16:48:41.946141,epoch time: 1:04:30.353972,used: 6:41:02.495921,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_22_10_07_39_seed_0_20734715
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9870296, 'precision': 0.9145344, 'recall': 0.8785385, 'specificity': 0.8785385, 'f1': 0.8956541, 'auroc': 0.99080545}
---- Validation: 
scalar performance:
{'acc': 0.9837697, 'precision': 0.90785027, 'recall': 0.82958543, 'specificity': 0.82958543, 'f1': 0.8642343, 'auroc': 0.980655}
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959412, 'precision': 0.77171135, 'recall': 0.54639196, 'specificity': 0.54639196, 'f1': 0.57183725, 'auroc': 0.94979656}
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20734715.png
early stop counter: 1
val acc:0.9837697148323059, best validation acc: 0.9856321811676025, corresponding to test acc:                         0.9605305194854736 / 0.9659635424613953
after epoch: 7,now: 2024-05-22 17:55:33.768511,epoch time: 1:06:51.822370,used: 7:47:54.318291,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_22_10_07_39_seed_0_20734715
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98620754, 'precision': 0.93010086, 'recall': 0.8442391, 'specificity': 0.8442391, 'f1': 0.88205075, 'auroc': 0.9926375}
---- Validation: 
scalar performance:
{'acc': 0.9834504, 'precision': 0.92678535, 'recall': 0.8031682, 'specificity': 0.8031682, 'f1': 0.85372937, 'auroc': 0.97958565}
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.8366661, 'recall': 0.5094118, 'specificity': 0.5094118, 'f1': 0.50812435, 'auroc': 0.95149314}
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20734715.png
early stop counter: 2
val acc:0.9834504127502441, best validation acc: 0.9856321811676025, corresponding to test acc:                         0.9605305194854736 / 0.9659635424613953
after epoch: 8,now: 2024-05-22 19:00:15.772284,epoch time: 1:04:42.003773,used: 8:52:36.322064,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_22_10_07_39_seed_0_20734715
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9898155, 'precision': 0.9393952, 'recall': 0.89834005, 'specificity': 0.89834005, 'f1': 0.91778374, 'auroc': 0.9951849}
---- Validation: 
scalar performance:
{'acc': 0.9845679, 'precision': 0.91823864, 'recall': 0.8322488, 'specificity': 0.8322488, 'f1': 0.86993325, 'auroc': 0.97618675}
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614893, 'precision': 0.81830364, 'recall': 0.5731285, 'specificity': 0.5731285, 'f1': 0.6123776, 'auroc': 0.91956544}
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20734715.png
early stop counter: 3
val acc:0.9845678806304932, best validation acc: 0.9856321811676025, corresponding to test acc:                         0.9605305194854736 / 0.9659635424613953
after epoch: 9,now: 2024-05-22 19:55:35.190281,epoch time: 0:55:19.417997,used: 9:47:55.740061,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_22_10_07_39_seed_0_20734715
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.987943, 'precision': 0.9692053, 'recall': 0.8380287, 'specificity': 0.8380287, 'f1': 0.8922175, 'auroc': 0.99501336}
---- Validation: 
scalar performance:
{'acc': 0.9813218, 'precision': 0.9388292, 'recall': 0.75631285, 'specificity': 0.75631285, 'f1': 0.82195336, 'auroc': 0.9809104}
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581336, 'precision': 0.71502495, 'recall': 0.5145753, 'specificity': 0.5145753, 'f1': 0.51807266, 'auroc': 0.9555913}
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20734715.png
early stop counter: 4
val acc:0.9813218116760254, best validation acc: 0.9856321811676025, corresponding to test acc:                         0.9605305194854736 / 0.9659635424613953
after epoch: 10,now: 2024-05-22 20:52:34.252803,epoch time: 0:56:59.062522,used: 10:44:54.802583,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_22_10_07_39_seed_0_20734715
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98536265, 'precision': 0.85948694, 'recall': 0.95308363, 'specificity': 0.95308363, 'f1': 0.9003807, 'auroc': 0.9939916}
---- Validation: 
scalar performance:
{'acc': 0.98361003, 'precision': 0.8612386, 'recall': 0.9097587, 'specificity': 0.9097587, 'f1': 0.8838282, 'auroc': 0.9749378}
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.7383677, 'recall': 0.5771248, 'specificity': 0.5771248, 'f1': 0.6118107, 'auroc': 0.9256178}
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20734715.png
early stop counter: 5
val acc:0.9836100339889526, best validation acc: 0.9856321811676025, corresponding to test acc:                         0.9605305194854736 / 0.9659635424613953
after epoch: 11,now: 2024-05-22 21:52:01.979213,epoch time: 0:59:27.726410,used: 11:44:22.528993,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_22_10_07_39_seed_0_20734715
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99036354, 'precision': 0.9425927, 'recall': 0.90413326, 'specificity': 0.90413326, 'f1': 0.92242205, 'auroc': 0.9949256}
---- Validation: 
scalar performance:
{'acc': 0.98398256, 'precision': 0.92396533, 'recall': 0.8154446, 'specificity': 0.8154446, 'f1': 0.8611371, 'auroc': 0.97239494}
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96628314, 'precision': 0.8704625, 'recall': 0.63426447, 'specificity': 0.63426447, 'f1': 0.6924592, 'auroc': 0.9549798}
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20734715.png
new oracle model saved
early stop counter: 6
val acc:0.9839825630187988, best validation acc: 0.9856321811676025, corresponding to test acc:                         0.9605305194854736 / 0.9662831425666809
after epoch: 12,now: 2024-05-22 22:47:51.822004,epoch time: 0:55:49.842791,used: 12:40:12.371784,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_22_10_07_39_seed_0_20734715
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9914368, 'precision': 0.9845937, 'recall': 0.88114667, 'specificity': 0.88114667, 'f1': 0.9262556, 'auroc': 0.9980242}
---- Validation: 
scalar performance:
{'acc': 0.98243934, 'precision': 0.95845777, 'recall': 0.76139164, 'specificity': 0.76139164, 'f1': 0.8311467, 'auroc': 0.9775351}
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614893, 'precision': 0.85054696, 'recall': 0.55846983, 'specificity': 0.55846983, 'f1': 0.59244365, 'auroc': 0.94616723}
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20734715.png
early stop counter: 7
val acc:0.9824393391609192, best validation acc: 0.9856321811676025, corresponding to test acc:                         0.9605305194854736 / 0.9662831425666809
after epoch: 13,now: 2024-05-22 23:45:06.564164,epoch time: 0:57:14.742160,used: 13:37:27.113944,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_22_10_07_39_seed_0_20734715
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9908888, 'precision': 0.93456584, 'recall': 0.92343426, 'specificity': 0.92343426, 'f1': 0.9289221, 'auroc': 0.9968257}
---- Validation: 
scalar performance:
{'acc': 0.9849404, 'precision': 0.91752195, 'recall': 0.8399422, 'specificity': 0.8399422, 'f1': 0.87444675, 'auroc': 0.9805069}
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96596354, 'precision': 0.8622475, 'recall': 0.6340977, 'specificity': 0.6340977, 'f1': 0.6912425, 'auroc': 0.9456686}
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20734715.png
early stop counter: 8
val acc:0.9849404096603394, best validation acc: 0.9856321811676025, corresponding to test acc:                         0.9605305194854736 / 0.9662831425666809
after epoch: 14,now: 2024-05-23 00:44:08.334382,epoch time: 0:59:01.770218,used: 14:36:28.884162,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_22_10_07_39_seed_0_20734715
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9919392, 'precision': 0.96447814, 'recall': 0.9071827, 'specificity': 0.9071827, 'f1': 0.9338075, 'auroc': 0.996895}
---- Validation: 
scalar performance:
{'acc': 0.9852065, 'precision': 0.9344671, 'recall': 0.826579, 'specificity': 0.826579, 'f1': 0.8723019, 'auroc': 0.96803856}
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96196866, 'precision': 0.87182665, 'recall': 0.5605523, 'specificity': 0.5605523, 'f1': 0.59621733, 'auroc': 0.9309439}
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20734715.png
early stop counter: 9
val acc:0.9852064847946167, best validation acc: 0.9856321811676025, corresponding to test acc:                         0.9605305194854736 / 0.9662831425666809
after epoch: 15,now: 2024-05-23 01:38:05.010636,epoch time: 0:53:56.676254,used: 15:30:25.560416,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_22_10_07_39_seed_0_20734715
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9935833, 'precision': 0.93260384, 'recall': 0.9753393, 'specificity': 0.9753393, 'f1': 0.9528826, 'auroc': 0.9985516}
---- Validation: 
scalar performance:
{'acc': 0.9868029, 'precision': 0.89664966, 'recall': 0.90616125, 'specificity': 0.90616125, 'f1': 0.9013442, 'auroc': 0.9798814}
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96244806, 'precision': 0.79441285, 'recall': 0.6249341, 'specificity': 0.6249341, 'f1': 0.6718986, 'auroc': 0.93830246}
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20734715.png
better model found
persisted
after epoch: 16,now: 2024-05-23 02:39:40.515444,epoch time: 1:01:35.504808,used: 16:32:01.065224,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_22_10_07_39_seed_0_20734715
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9935605, 'precision': 0.9475931, 'recall': 0.9540466, 'specificity': 0.9540466, 'f1': 0.95079494, 'auroc': 0.9979999}
---- Validation: 
scalar performance:
{'acc': 0.9852597, 'precision': 0.9000553, 'recall': 0.8693597, 'specificity': 0.8693597, 'f1': 0.88404393, 'auroc': 0.9822376}
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97331417, 'precision': 0.87174284, 'recall': 0.75703466, 'specificity': 0.75703466, 'f1': 0.802881, 'auroc': 0.9546298}
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20734715.png
new oracle model saved
early stop counter: 1
val acc:0.9852597117424011, best validation acc: 0.986802875995636, corresponding to test acc:                         0.9624480605125427 / 0.9733141660690308
after epoch: 17,now: 2024-05-23 03:41:17.454929,epoch time: 1:01:36.939485,used: 17:33:38.004709,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_22_10_07_39_seed_0_20734715
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99394864, 'precision': 0.9403968, 'recall': 0.97064036, 'specificity': 0.97064036, 'f1': 0.9549757, 'auroc': 0.9983442}
---- Validation: 
scalar performance:
{'acc': 0.9868561, 'precision': 0.9126003, 'recall': 0.882187, 'specificity': 0.882187, 'f1': 0.8967638, 'auroc': 0.9807606}
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96756154, 'precision': 0.88611144, 'recall': 0.64592546, 'specificity': 0.64592546, 'f1': 0.7073385, 'auroc': 0.94707906}
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20734715.png
better model found
persisted
after epoch: 18,now: 2024-05-23 05:06:37.794661,epoch time: 1:25:20.339732,used: 18:58:58.344441,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_22_10_07_39_seed_0_20734715
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9951589, 'precision': 0.98338854, 'recall': 0.94077563, 'specificity': 0.94077563, 'f1': 0.96102715, 'auroc': 0.99920046}
---- Validation: 
scalar performance:
{'acc': 0.98621756, 'precision': 0.9466904, 'recall': 0.83235276, 'specificity': 0.83235276, 'f1': 0.8805133, 'auroc': 0.979774}
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96212846, 'precision': 0.80808514, 'recall': 0.59728235, 'specificity': 0.59728235, 'f1': 0.64275956, 'auroc': 0.9412259}
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20734715.png
early stop counter: 1
val acc:0.9862175583839417, best validation acc: 0.9868561029434204, corresponding to test acc:                         0.9675615429878235 / 0.9733141660690308
after epoch: 19,now: 2024-05-23 06:50:24.358258,epoch time: 1:43:46.563597,used: 20:42:44.908038,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_22_10_07_39_seed_0_20734715
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9938345, 'precision': 0.9924607, 'recall': 0.9118347, 'specificity': 0.9118347, 'f1': 0.9482984, 'auroc': 0.99902546}
---- Validation: 
scalar performance:
{'acc': 0.98398256, 'precision': 0.95127404, 'recall': 0.79144275, 'specificity': 0.79144275, 'f1': 0.8529553, 'auroc': 0.98203844}
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96196866, 'precision': 0.8330575, 'recall': 0.575211, 'specificity': 0.575211, 'f1': 0.61603045, 'auroc': 0.9330705}
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20734715.png
early stop counter: 2
val acc:0.9839825630187988, best validation acc: 0.9868561029434204, corresponding to test acc:                         0.9675615429878235 / 0.9733141660690308
after epoch: 20,now: 2024-05-23 08:13:17.983414,epoch time: 1:22:53.625156,used: 22:05:38.533194,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_22_10_07_39_seed_0_20734715
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99483925, 'precision': 0.98204386, 'recall': 0.9370038, 'specificity': 0.9370038, 'f1': 0.95833886, 'auroc': 0.99863183}
---- Validation: 
scalar performance:
{'acc': 0.9848872, 'precision': 0.95148325, 'recall': 0.8061622, 'specificity': 0.8061622, 'f1': 0.86389464, 'auroc': 0.97637784}
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9603707, 'precision': 0.92146814, 'recall': 0.52856886, 'specificity': 0.52856886, 'f1': 0.5438245, 'auroc': 0.9283781}
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20734715.png
early stop counter: 3
val acc:0.9848871827125549, best validation acc: 0.9868561029434204, corresponding to test acc:                         0.9675615429878235 / 0.9733141660690308
after epoch: 21,now: 2024-05-23 09:29:13.219536,epoch time: 1:15:55.236122,used: 23:21:33.769316,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_22_10_07_39_seed_0_20734715
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99502194, 'precision': 0.9614105, 'recall': 0.9620156, 'specificity': 0.9620156, 'f1': 0.96171284, 'auroc': 0.99878335}
---- Validation: 
scalar performance:
{'acc': 0.985845, 'precision': 0.92168117, 'recall': 0.8516614, 'specificity': 0.8516614, 'f1': 0.8832518, 'auroc': 0.97936326}
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9653244, 'precision': 0.85649586, 'recall': 0.62643486, 'specificity': 0.62643486, 'f1': 0.68196416, 'auroc': 0.94926584}
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20734715.png
early stop counter: 4
val acc:0.9858450293540955, best validation acc: 0.9868561029434204, corresponding to test acc:                         0.9675615429878235 / 0.9733141660690308
after epoch: 22,now: 2024-05-23 11:11:51.499973,epoch time: 1:42:38.280437,used: 1 day, 1:04:12.049753,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_22_10_07_39_seed_0_20734715
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9952046, 'precision': 0.95634675, 'recall': 0.9712902, 'specificity': 0.9712902, 'f1': 0.9636886, 'auroc': 0.99896884}
---- Validation: 
scalar performance:
{'acc': 0.9844615, 'precision': 0.903993, 'recall': 0.84794486, 'specificity': 0.84794486, 'f1': 0.8737098, 'auroc': 0.9731315}
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9603707, 'precision': 0.85103154, 'recall': 0.5377306, 'specificity': 0.5377306, 'f1': 0.55930376, 'auroc': 0.93727815}
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20734715.png
early stop counter: 5
val acc:0.9844614863395691, best validation acc: 0.9868561029434204, corresponding to test acc:                         0.9675615429878235 / 0.9733141660690308
after epoch: 23,now: 2024-05-23 12:50:26.752813,epoch time: 1:38:35.252840,used: 1 day, 2:42:47.302593,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_22_10_07_39_seed_0_20734715
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9961865, 'precision': 0.9795585, 'recall': 0.96097887, 'specificity': 0.96097887, 'f1': 0.9700714, 'auroc': 0.9993521}
---- Validation: 
scalar performance:
{'acc': 0.98541933, 'precision': 0.93430686, 'recall': 0.83043945, 'specificity': 0.83043945, 'f1': 0.87478817, 'auroc': 0.9789332}
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9613295, 'precision': 0.7944581, 'recall': 0.5895362, 'specificity': 0.5895362, 'f1': 0.6320759, 'auroc': 0.94069546}
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20734715.png
early stop counter: 6
val acc:0.9854193329811096, best validation acc: 0.9868561029434204, corresponding to test acc:                         0.9675615429878235 / 0.9733141660690308
after epoch: 24,now: 2024-05-23 14:17:37.173862,epoch time: 1:27:10.421049,used: 1 day, 4:09:57.723642,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_22_10_07_39_seed_0_20734715
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9969629, 'precision': 0.98707664, 'recall': 0.9656427, 'specificity': 0.9656427, 'f1': 0.97610056, 'auroc': 0.9993415}
---- Validation: 
scalar performance:
{'acc': 0.9870157, 'precision': 0.9543768, 'recall': 0.83876646, 'specificity': 0.83876646, 'f1': 0.88753104, 'auroc': 0.9789989}
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.965644, 'precision': 0.84345484, 'recall': 0.64309263, 'specificity': 0.64309263, 'f1': 0.698236, 'auroc': 0.94267106}
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20734715.png
better model found
persisted
after epoch: 25,now: 2024-05-23 15:24:01.901819,epoch time: 1:06:24.727957,used: 1 day, 5:16:22.451599,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_22_10_07_39_seed_0_20734715
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99627787, 'precision': 0.96180594, 'recall': 0.9826648, 'specificity': 0.9826648, 'f1': 0.9719869, 'auroc': 0.9992523}
---- Validation: 
scalar performance:
{'acc': 0.9870157, 'precision': 0.914716, 'recall': 0.8822697, 'specificity': 0.8822697, 'f1': 0.8977783, 'auroc': 0.9767025}
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96324706, 'precision': 0.8421838, 'recall': 0.59603363, 'specificity': 0.59603363, 'f1': 0.6441759, 'auroc': 0.92164874}
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20734715.png
early stop counter: 1
val acc:0.9870157241821289, best validation acc: 0.9870157241821289, corresponding to test acc:                         0.9656440019607544 / 0.9733141660690308
after epoch: 26,now: 2024-05-23 16:27:23.807186,epoch time: 1:03:21.905367,used: 1 day, 6:19:44.356966,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_22_10_07_39_seed_0_20734715
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99684876, 'precision': 0.9903109, 'recall': 0.96066576, 'specificity': 0.96066576, 'f1': 0.97499216, 'auroc': 0.9995562}
---- Validation: 
scalar performance:
{'acc': 0.9860047, 'precision': 0.9445261, 'recall': 0.8307425, 'specificity': 0.8307425, 'f1': 0.87866795, 'auroc': 0.9772371}
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9592522, 'precision': 0.7612339, 'recall': 0.5518056, 'specificity': 0.5518056, 'f1': 0.5795856, 'auroc': 0.9252518}
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20734715.png
early stop counter: 2
val acc:0.9860047101974487, best validation acc: 0.9870157241821289, corresponding to test acc:                         0.9656440019607544 / 0.9733141660690308
after epoch: 27,now: 2024-05-23 17:28:23.075282,epoch time: 1:00:59.268096,used: 1 day, 7:20:43.625062,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_22_10_07_39_seed_0_20734715
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9976251, 'precision': 0.98829925, 'recall': 0.97483754, 'specificity': 0.97483754, 'f1': 0.98146725, 'auroc': 0.99960434}
---- Validation: 
scalar performance:
{'acc': 0.98589826, 'precision': 0.9305544, 'recall': 0.84268826, 'specificity': 0.84268826, 'f1': 0.88124585, 'auroc': 0.9763503}
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9689997, 'precision': 0.8665475, 'recall': 0.6851548, 'specificity': 0.6851548, 'f1': 0.7432827, 'auroc': 0.9380835}
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20734715.png
early stop counter: 3
val acc:0.9858982563018799, best validation acc: 0.9870157241821289, corresponding to test acc:                         0.9656440019607544 / 0.9733141660690308
after epoch: 28,now: 2024-05-23 18:31:27.661080,epoch time: 1:03:04.585798,used: 1 day, 8:23:48.210860,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_22_10_07_39_seed_0_20734715
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9965519, 'precision': 0.96762455, 'recall': 0.9801837, 'specificity': 0.9801837, 'f1': 0.9738145, 'auroc': 0.9987344}
---- Validation: 
scalar performance:
{'acc': 0.98616433, 'precision': 0.9136956, 'recall': 0.8675778, 'specificity': 0.8675778, 'f1': 0.88916504, 'auroc': 0.97963196}
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9691595, 'precision': 0.8962356, 'recall': 0.6650826, 'specificity': 0.6650826, 'f1': 0.7291142, 'auroc': 0.93134725}
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20734715.png
early stop counter: 4
val acc:0.9861643314361572, best validation acc: 0.9870157241821289, corresponding to test acc:                         0.9656440019607544 / 0.9733141660690308
after epoch: 29,now: 2024-05-23 19:32:38.664596,epoch time: 1:01:11.003516,used: 1 day, 9:24:59.214376,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_22_10_07_39_seed_0_20734715
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99682593, 'precision': 0.9889462, 'recall': 0.9616375, 'specificity': 0.9616375, 'f1': 0.97487044, 'auroc': 0.99963903}
---- Validation: 
scalar performance:
{'acc': 0.98515326, 'precision': 0.948442, 'recall': 0.8130504, 'specificity': 0.8130504, 'f1': 0.8678429, 'auroc': 0.97833294}
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.8245563, 'recall': 0.54131186, 'specificity': 0.54131186, 'f1': 0.5648996, 'auroc': 0.9263846}
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20734715.png
early stop counter: 5
val acc:0.9851532578468323, best validation acc: 0.9870157241821289, corresponding to test acc:                         0.9656440019607544 / 0.9733141660690308
after epoch: 30,now: 2024-05-23 20:33:50.532202,epoch time: 1:01:11.867606,used: 1 day, 10:26:11.081982,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_22_10_07_39_seed_0_20734715
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 1 day, 10:26:11.081982 at 2024-05-23 20:33:50.532202
persisted model performance metric: 

scalar performance:
{'acc': 0.9651646, 'precision': 0.84532404, 'recall': 0.6318485, 'specificity': 0.6318485, 'f1': 0.6865654, 'auroc': 0.9529239}
oracle model performance metric: 

scalar performance:
{'acc': 0.9705976, 'precision': 0.84660256, 'recall': 0.7409586, 'specificity': 0.7409586, 'f1': 0.7832907, 'auroc': 0.9483315}
results aggregation path: zoutput/benchmarks/CAMELYON_centers_dann_dial/rule_results/2.csv
results aggregation path: zoutput/benchmarks/CAMELYON_centers_dann_dial/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_centers_dann_dial/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1659 MiB |   8564 MiB |   2394 TiB |   2394 TiB |
|       from large pool |   1652 MiB |   8549 MiB |   2365 TiB |   2365 TiB |
|       from small pool |      6 MiB |     15 MiB |     28 TiB |     28 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1659 MiB |   8564 MiB |   2394 TiB |   2394 TiB |
|       from large pool |   1652 MiB |   8549 MiB |   2365 TiB |   2365 TiB |
|       from small pool |      6 MiB |     15 MiB |     28 TiB |     28 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1653 MiB |   8547 MiB |   2387 TiB |   2387 TiB |
|       from large pool |   1647 MiB |   8533 MiB |   2358 TiB |   2358 TiB |
|       from small pool |      5 MiB |     15 MiB |     28 TiB |     28 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9038 MiB |   9038 MiB |   9038 MiB |      0 B   |
|       from large pool |   9020 MiB |   9020 MiB |   9020 MiB |      0 B   |
|       from small pool |     18 MiB |     18 MiB |     18 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 338724 KiB | 530233 KiB |   1089 TiB |   1089 TiB |
|       from large pool | 335120 KiB | 528704 KiB |   1059 TiB |   1059 TiB |
|       from small pool |   3604 KiB |   6641 KiB |     29 TiB |     29 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3258    |    6300    |  284700 K  |  284697 K  |
|       from large pool |     247    |     593    |  150367 K  |  150366 K  |
|       from small pool |    3011    |    6052    |  134333 K  |  134330 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3258    |    6300    |  284700 K  |  284697 K  |
|       from large pool |     247    |     593    |  150367 K  |  150366 K  |
|       from small pool |    3011    |    6052    |  134333 K  |  134330 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     341    |     341    |     341    |       0    |
|       from large pool |     332    |     332    |     332    |       0    |
|       from small pool |       9    |       9    |       9    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     122    |    2845    |  147539 K  |  147539 K  |
|       from large pool |     101    |     285    |   85149 K  |   85149 K  |
|       from small pool |      21    |    2744    |   62390 K  |   62390 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8564 MiB |   2394 TiB |   2394 TiB |
|       from large pool |  16640 KiB |   8549 MiB |   2365 TiB |   2365 TiB |
|       from small pool |      0 KiB |     15 MiB |     28 TiB |     28 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8564 MiB |   2394 TiB |   2394 TiB |
|       from large pool |  16640 KiB |   8549 MiB |   2365 TiB |   2365 TiB |
|       from small pool |      0 KiB |     15 MiB |     28 TiB |     28 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8547 MiB |   2387 TiB |   2387 TiB |
|       from large pool |  16640 KiB |   8533 MiB |   2358 TiB |   2358 TiB |
|       from small pool |      0 KiB |     15 MiB |     28 TiB |     28 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1990 MiB |   9038 MiB |   9038 MiB |   7048 MiB |
|       from large pool |   1980 MiB |   9020 MiB |   9020 MiB |   7040 MiB |
|       from small pool |     10 MiB |     18 MiB |     18 MiB |      8 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 530233 KiB |   1089 TiB |   1089 TiB |
|       from large pool |  24320 KiB | 528704 KiB |   1059 TiB |   1059 TiB |
|       from small pool |      0 KiB |   9385 KiB |     29 TiB |     29 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6300    |  284700 K  |  284700 K  |
|       from large pool |       2    |     593    |  150367 K  |  150367 K  |
|       from small pool |       0    |    6052    |  134333 K  |  134333 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6300    |  284700 K  |  284700 K  |
|       from large pool |       2    |     593    |  150367 K  |  150367 K  |
|       from small pool |       0    |    6052    |  134333 K  |  134333 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     104    |     341    |     341    |     237    |
|       from large pool |      99    |     332    |     332    |     233    |
|       from small pool |       5    |       9    |       9    |       4    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    2845    |  147541 K  |  147541 K  |
|       from large pool |       2    |     285    |   85149 K  |   85149 K  |
|       from small pool |       0    |    2744    |   62391 K  |   62391 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Thu May 23 20:37:27 2024]
Finished job 0.
1 of 1 steps (100%) done
