Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Fri May 31 02:01:11 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/rule_results/9.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=9
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_02_11_49_seed_0_21011734

 Experiment start at: 2024-05-31 02:11:49.464318
before training, model accuracy: 0.2401725947856903
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/autograd/graph.py:744: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9662495, 'precision': 0.7321427, 'recall': 0.57140243, 'specificity': 0.57140243, 'f1': 0.6052715, 'auroc': 0.90033185, 'binary_precision': 0.49321267, 'binary_recall': 0.14809783, 'binary_specificity': 0.994707, 'binary_f1_score': 0.2277952}
confusion matrix:
       0    1
0  42096  224
1   1254  218
---- Validation: 
scalar performance:
{'acc': 0.9649319, 'precision': 0.7170611, 'recall': 0.57531476, 'specificity': 0.57531476, 'f1': 0.6083329, 'auroc': 0.8913373, 'binary_precision': 0.46330276, 'binary_recall': 0.15707621, 'binary_specificity': 0.99355334, 'binary_f1_score': 0.23461093}
confusion matrix:
       0    1
0  18032  117
1    542  101
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9699584, 'precision': 0.90360785, 'recall': 0.67282873, 'specificity': 0.67282873, 'f1': 0.73820674, 'auroc': 0.88365066, 'binary_precision': 0.8348624, 'binary_recall': 0.348659, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.4918919}
confusion matrix:
      0   1
0  5979  18
1   170  91
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011734.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-31 02:40:28.586174,epoch time: 0:28:39.121856,used: 0:28:39.121856,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_02_11_49_seed_0_21011734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96677476, 'precision': 0.7429056, 'recall': 0.6438032, 'specificity': 0.6438032, 'f1': 0.6793688, 'auroc': 0.9249264, 'binary_precision': 0.5098952, 'binary_recall': 0.29755434, 'binary_specificity': 0.990052, 'binary_f1_score': 0.37580436}
confusion matrix:
       0    1
0  41899  421
1   1034  438
---- Validation: 
scalar performance:
{'acc': 0.9658365, 'precision': 0.7384708, 'recall': 0.6462883, 'specificity': 0.6462883, 'f1': 0.6801715, 'auroc': 0.9122619, 'binary_precision': 0.5012854, 'binary_recall': 0.30326593, 'binary_specificity': 0.9893107, 'binary_f1_score': 0.37790698}
confusion matrix:
       0    1
0  17955  194
1    448  195
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97651005, 'precision': 0.9060033, 'recall': 0.7715285, 'specificity': 0.7715285, 'f1': 0.8241712, 'auroc': 0.9187435, 'binary_precision': 0.8313953, 'binary_recall': 0.54789275, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.6605081}
confusion matrix:
      0    1
0  5968   29
1   118  143
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011734.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-05-31 03:07:59.005190,epoch time: 0:27:30.419016,used: 0:56:09.540872,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_02_11_49_seed_0_21011734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96750546, 'precision': 0.74975914, 'recall': 0.7387607, 'specificity': 0.7387607, 'f1': 0.7441224, 'auroc': 0.930827, 'binary_precision': 0.517094, 'binary_recall': 0.4935418, 'binary_specificity': 0.9839796, 'binary_f1_score': 0.50504345}
confusion matrix:
       0    1
0  41643  678
1    745  726
---- Validation: 
scalar performance:
{'acc': 0.96557045, 'precision': 0.7397673, 'recall': 0.74515784, 'specificity': 0.74515784, 'f1': 0.74242914, 'auroc': 0.92132413, 'binary_precision': 0.4969605, 'binary_recall': 0.5085537, 'binary_specificity': 0.98176205, 'binary_f1_score': 0.50269026}
confusion matrix:
       0    1
0  17818  331
1    316  327
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97730905, 'precision': 0.8882941, 'recall': 0.80492735, 'specificity': 0.80492735, 'f1': 0.84109163, 'auroc': 0.918435, 'binary_precision': 0.79310346, 'binary_recall': 0.61685824, 'binary_specificity': 0.9929965, 'binary_f1_score': 0.6939655}
confusion matrix:
      0    1
0  5955   42
1   100  161
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011734.png
new oracle model saved
early stop counter: 1
val acc:0.9655704498291016, best validation acc: 0.9658365249633789, corresponding to test acc:                         0.9765100479125977 / 0.9773090481758118
after epoch: 3,now: 2024-05-31 03:35:11.471179,epoch time: 0:27:12.465989,used: 1:23:22.006861,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_02_11_49_seed_0_21011734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96638656, 'precision': 0.74237084, 'recall': 0.77591217, 'specificity': 0.77591217, 'f1': 0.75792825, 'auroc': 0.93634295, 'binary_precision': 0.4997029, 'binary_recall': 0.57171994, 'binary_specificity': 0.98010445, 'binary_f1_score': 0.5332911}
confusion matrix:
       0    1
0  41479  842
1    630  841
---- Validation: 
scalar performance:
{'acc': 0.9641869, 'precision': 0.7327898, 'recall': 0.77819407, 'specificity': 0.77819407, 'f1': 0.75322235, 'auroc': 0.9305723, 'binary_precision': 0.48062015, 'binary_recall': 0.5785381, 'binary_specificity': 0.97785, 'binary_f1_score': 0.5250529}
confusion matrix:
       0    1
0  17747  402
1    271  372
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9760307, 'precision': 0.86077976, 'recall': 0.8262484, 'specificity': 0.8262484, 'f1': 0.84255075, 'auroc': 0.91856766, 'binary_precision': 0.73617023, 'binary_recall': 0.66283524, 'binary_specificity': 0.9896615, 'binary_f1_score': 0.6975807}
confusion matrix:
      0    1
0  5935   62
1    88  173
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011734.png
early stop counter: 2
val acc:0.9641869068145752, best validation acc: 0.9658365249633789, corresponding to test acc:                         0.9765100479125977 / 0.9773090481758118
after epoch: 4,now: 2024-05-31 04:01:56.105108,epoch time: 0:26:44.633929,used: 1:50:06.640790,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_02_11_49_seed_0_21011734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96800786, 'precision': 0.7534919, 'recall': 0.78542066, 'specificity': 0.78542066, 'f1': 0.76840234, 'auroc': 0.9415573, 'binary_precision': 0.5213213, 'binary_recall': 0.58967394, 'binary_specificity': 0.9811673, 'binary_f1_score': 0.5533949}
confusion matrix:
       0    1
0  41523  797
1    604  868
---- Validation: 
scalar performance:
{'acc': 0.9650383, 'precision': 0.73739576, 'recall': 0.76963425, 'specificity': 0.76963425, 'f1': 0.7523651, 'auroc': 0.93246907, 'binary_precision': 0.49046323, 'binary_recall': 0.5598756, 'binary_specificity': 0.9793928, 'binary_f1_score': 0.5228758}
confusion matrix:
       0    1
0  17775  374
1    283  360
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9782678, 'precision': 0.8865601, 'recall': 0.823751, 'specificity': 0.823751, 'f1': 0.8520918, 'auroc': 0.92724603, 'binary_precision': 0.7880184, 'binary_recall': 0.6551724, 'binary_specificity': 0.9923295, 'binary_f1_score': 0.71548116}
confusion matrix:
      0    1
0  5951   46
1    90  171
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011734.png
new oracle model saved
early stop counter: 3
val acc:0.9650382995605469, best validation acc: 0.9658365249633789, corresponding to test acc:                         0.9765100479125977 / 0.9782677888870239
after epoch: 5,now: 2024-05-31 04:28:22.975092,epoch time: 0:26:26.869984,used: 2:16:33.510774,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_02_11_49_seed_0_21011734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9682362, 'precision': 0.754959, 'recall': 0.79996455, 'specificity': 0.79996455, 'f1': 0.77542675, 'auroc': 0.94478464, 'binary_precision': 0.5232358, 'binary_recall': 0.6195652, 'binary_specificity': 0.9803639, 'binary_f1_score': 0.56734055}
confusion matrix:
       0    1
0  41489  831
1    560  912
---- Validation: 
scalar performance:
{'acc': 0.965198, 'precision': 0.7389183, 'recall': 0.78021765, 'specificity': 0.78021765, 'f1': 0.75772417, 'auroc': 0.9340721, 'binary_precision': 0.49275362, 'binary_recall': 0.5816485, 'binary_specificity': 0.9787867, 'binary_f1_score': 0.53352356}
confusion matrix:
       0    1
0  17764  385
1    269  374
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9782678, 'precision': 0.8865601, 'recall': 0.823751, 'specificity': 0.823751, 'f1': 0.8520918, 'auroc': 0.9320714, 'binary_precision': 0.7880184, 'binary_recall': 0.6551724, 'binary_specificity': 0.9923295, 'binary_f1_score': 0.71548116}
confusion matrix:
      0    1
0  5951   46
1    90  171
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011734.png
early stop counter: 4
val acc:0.9651979804039001, best validation acc: 0.9658365249633789, corresponding to test acc:                         0.9765100479125977 / 0.9782677888870239
after epoch: 6,now: 2024-05-31 04:55:31.216180,epoch time: 0:27:08.241088,used: 2:43:41.751862,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_02_11_49_seed_0_21011734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9675968, 'precision': 0.7507365, 'recall': 0.80475414, 'specificity': 0.80475414, 'f1': 0.77481115, 'auroc': 0.9459345, 'binary_precision': 0.51442844, 'binary_recall': 0.6301836, 'binary_specificity': 0.9793247, 'binary_f1_score': 0.5664528}
confusion matrix:
       0    1
0  41446  875
1    544  927
---- Validation: 
scalar performance:
{'acc': 0.96450615, 'precision': 0.7360903, 'recall': 0.80161107, 'specificity': 0.80161107, 'f1': 0.7643559, 'auroc': 0.93573594, 'binary_precision': 0.48554218, 'binary_recall': 0.62674963, 'binary_specificity': 0.97647256, 'binary_f1_score': 0.5471827}
confusion matrix:
       0    1
0  17722  427
1    240  403
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9755513, 'precision': 0.8597603, 'recall': 0.8186689, 'specificity': 0.8186689, 'f1': 0.83783376, 'auroc': 0.9264747, 'binary_precision': 0.73478264, 'binary_recall': 0.6475096, 'binary_specificity': 0.9898282, 'binary_f1_score': 0.68839103}
confusion matrix:
      0    1
0  5936   61
1    92  169
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011734.png
early stop counter: 5
val acc:0.9645061492919922, best validation acc: 0.9658365249633789, corresponding to test acc:                         0.9765100479125977 / 0.9782677888870239
after epoch: 7,now: 2024-05-31 05:22:15.612096,epoch time: 0:26:44.395916,used: 3:10:26.147778,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_02_11_49_seed_0_21011734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.96656924, 'precision': 0.74487007, 'recall': 0.8128722, 'specificity': 0.8128722, 'f1': 0.77422583, 'auroc': 0.9497279, 'binary_precision': 0.50210524, 'binary_recall': 0.6480978, 'binary_specificity': 0.9776465, 'binary_f1_score': 0.5658363}
confusion matrix:
       0    1
0  41374  946
1    518  954
---- Validation: 
scalar performance:
{'acc': 0.9640272, 'precision': 0.7338838, 'recall': 0.80736357, 'specificity': 0.80736357, 'f1': 0.76499933, 'auroc': 0.9405791, 'binary_precision': 0.48070174, 'binary_recall': 0.63919127, 'binary_specificity': 0.97553587, 'binary_f1_score': 0.5487316}
confusion matrix:
       0    1
0  17705  444
1    232  411
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97794825, 'precision': 0.8720155, 'recall': 0.8419075, 'specificity': 0.8419075, 'f1': 0.8562577, 'auroc': 0.93544555, 'binary_precision': 0.7573222, 'binary_recall': 0.6934866, 'binary_specificity': 0.9903285, 'binary_f1_score': 0.72400004}
confusion matrix:
      0    1
0  5939   58
1    80  181
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011734.png
early stop counter: 6
val acc:0.9640272259712219, best validation acc: 0.9658365249633789, corresponding to test acc:                         0.9765100479125977 / 0.9782677888870239
after epoch: 8,now: 2024-05-31 05:48:46.496226,epoch time: 0:26:30.884130,used: 3:36:57.031908,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_02_11_49_seed_0_21011734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9668661, 'precision': 0.7454143, 'recall': 0.7712389, 'specificity': 0.7712389, 'f1': 0.75760627, 'auroc': 0.9508132, 'binary_precision': 0.5061275, 'binary_recall': 0.5615228, 'binary_specificity': 0.98095506, 'binary_f1_score': 0.532388}
confusion matrix:
       0    1
0  41515  806
1    645  826
---- Validation: 
scalar performance:
{'acc': 0.9647722, 'precision': 0.7375224, 'recall': 0.8009988, 'specificity': 0.8009988, 'f1': 0.7650512, 'auroc': 0.94204366, 'binary_precision': 0.48845688, 'binary_recall': 0.62519443, 'binary_specificity': 0.9768031, 'binary_f1_score': 0.54843116}
confusion matrix:
       0    1
0  17728  421
1    241  402
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.978907, 'precision': 0.8840292, 'recall': 0.8387431, 'specificity': 0.8387431, 'f1': 0.859818, 'auroc': 0.9272312, 'binary_precision': 0.78165936, 'binary_recall': 0.68582374, 'binary_specificity': 0.9916625, 'binary_f1_score': 0.7306122}
confusion matrix:
      0    1
0  5947   50
1    82  179
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011734.png
new oracle model saved
early stop counter: 7
val acc:0.9647722244262695, best validation acc: 0.9658365249633789, corresponding to test acc:                         0.9765100479125977 / 0.9789069890975952
after epoch: 9,now: 2024-05-31 06:14:26.495796,epoch time: 0:25:39.999570,used: 4:02:37.031478,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_02_11_49_seed_0_21011734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9676425, 'precision': 0.751234, 'recall': 0.81244385, 'specificity': 0.81244385, 'f1': 0.7781241, 'auroc': 0.95574975, 'binary_precision': 0.514889, 'binary_recall': 0.6460598, 'binary_specificity': 0.97882795, 'binary_f1_score': 0.5730642}
confusion matrix:
       0    1
0  41424  896
1    521  951
---- Validation: 
scalar performance:
{'acc': 0.9665283, 'precision': 0.7480991, 'recall': 0.81840914, 'specificity': 0.81840914, 'f1': 0.7783582, 'auroc': 0.9457886, 'binary_precision': 0.5083933, 'binary_recall': 0.65940905, 'binary_specificity': 0.97740924, 'binary_f1_score': 0.5741368}
confusion matrix:
       0    1
0  17739  410
1    219  424
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97714925, 'precision': 0.86802554, 'recall': 0.83416134, 'specificity': 0.83416134, 'f1': 0.8501879, 'auroc': 0.9396924, 'binary_precision': 0.75, 'binary_recall': 0.6781609, 'binary_specificity': 0.9901618, 'binary_f1_score': 0.71227366}
confusion matrix:
      0    1
0  5938   59
1    84  177
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011734.png
better model found
persisted
after epoch: 10,now: 2024-05-31 06:40:47.431165,epoch time: 0:26:20.935369,used: 4:28:57.966847,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_02_11_49_seed_0_21011734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9675968, 'precision': 0.75068146, 'recall': 0.7995047, 'specificity': 0.7995047, 'f1': 0.772674, 'auroc': 0.9563228, 'binary_precision': 0.51468927, 'binary_recall': 0.6193066, 'binary_specificity': 0.9797028, 'binary_f1_score': 0.5621722}
confusion matrix:
       0    1
0  41462  859
1    560  911
---- Validation: 
scalar performance:
{'acc': 0.9662622, 'precision': 0.74611473, 'recall': 0.8010201, 'specificity': 0.8010201, 'f1': 0.77047837, 'auroc': 0.94365776, 'binary_precision': 0.50567466, 'binary_recall': 0.62363917, 'binary_specificity': 0.978401, 'binary_f1_score': 0.5584958}
confusion matrix:
       0    1
0  17757  392
1    242  401
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97714925, 'precision': 0.87001944, 'recall': 0.83049667, 'specificity': 0.83049667, 'f1': 0.8490226, 'auroc': 0.94123495, 'binary_precision': 0.75431037, 'binary_recall': 0.6704981, 'binary_specificity': 0.99049526, 'binary_f1_score': 0.7099391}
confusion matrix:
      0    1
0  5940   57
1    86  175
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011734.png
early stop counter: 1
val acc:0.9662622213363647, best validation acc: 0.9665282964706421, corresponding to test acc:                         0.977149248123169 / 0.9789069890975952
after epoch: 11,now: 2024-05-31 07:07:18.361234,epoch time: 0:26:30.930069,used: 4:55:28.896916,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_02_11_49_seed_0_21011734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.96487945, 'precision': 0.7362016, 'recall': 0.8244566, 'specificity': 0.8244566, 'f1': 0.7725102, 'auroc': 0.95722604, 'binary_precision': 0.48390242, 'binary_recall': 0.67391306, 'binary_specificity': 0.975, 'binary_f1_score': 0.5633163}
confusion matrix:
       0     1
0  41262  1058
1    480   992
---- Validation: 
scalar performance:
{'acc': 0.96471906, 'precision': 0.73873186, 'recall': 0.82872325, 'specificity': 0.82872325, 'f1': 0.77568257, 'auroc': 0.94583845, 'binary_precision': 0.48886415, 'binary_recall': 0.6827372, 'binary_specificity': 0.97470933, 'binary_f1_score': 0.5697599}
confusion matrix:
       0    1
0  17690  459
1    204  439
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9744327, 'precision': 0.838143, 'recall': 0.8455703, 'specificity': 0.8455703, 'f1': 0.8418115, 'auroc': 0.94391817, 'binary_precision': 0.6891386, 'binary_recall': 0.70498085, 'binary_specificity': 0.98615974, 'binary_f1_score': 0.6969697}
confusion matrix:
      0    1
0  5914   83
1    77  184
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011734.png
early stop counter: 2
val acc:0.9647190570831299, best validation acc: 0.9665282964706421, corresponding to test acc:                         0.977149248123169 / 0.9789069890975952
after epoch: 12,now: 2024-05-31 07:33:48.665232,epoch time: 0:26:30.303998,used: 5:21:59.200914,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_02_11_49_seed_0_21011734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9672543, 'precision': 0.7493793, 'recall': 0.83683246, 'specificity': 0.83683246, 'f1': 0.7857944, 'auroc': 0.95910203, 'binary_precision': 0.509434, 'binary_recall': 0.6970109, 'binary_specificity': 0.97665405, 'binary_f1_score': 0.5886403}
confusion matrix:
       0     1
0  41332   988
1    446  1026
---- Validation: 
scalar performance:
{'acc': 0.96466583, 'precision': 0.7384596, 'recall': 0.8286957, 'specificity': 0.8286957, 'f1': 0.7754837, 'auroc': 0.947848, 'binary_precision': 0.48832035, 'binary_recall': 0.6827372, 'binary_specificity': 0.97465426, 'binary_f1_score': 0.5693905}
confusion matrix:
       0    1
0  17689  460
1    204  439
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9750719, 'precision': 0.8550261, 'recall': 0.8184188, 'specificity': 0.8184188, 'f1': 0.8356172, 'auroc': 0.9511825, 'binary_precision': 0.7253219, 'binary_recall': 0.6475096, 'binary_specificity': 0.989328, 'binary_f1_score': 0.68421054}
confusion matrix:
      0    1
0  5933   64
1    92  169
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011734.png
early stop counter: 3
val acc:0.9646658301353455, best validation acc: 0.9665282964706421, corresponding to test acc:                         0.977149248123169 / 0.9789069890975952
after epoch: 13,now: 2024-05-31 08:00:06.428845,epoch time: 0:26:17.763613,used: 5:48:16.964527,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_02_11_49_seed_0_21011734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96590704, 'precision': 0.7408303, 'recall': 0.8066281, 'specificity': 0.8066281, 'f1': 0.7692937, 'auroc': 0.9586445, 'binary_precision': 0.49445325, 'binary_recall': 0.63586956, 'binary_specificity': 0.9773866, 'binary_f1_score': 0.556315}
confusion matrix:
       0    1
0  41363  957
1    536  936
---- Validation: 
scalar performance:
{'acc': 0.9646126, 'precision': 0.736935, 'recall': 0.8061665, 'specificity': 0.8061665, 'f1': 0.766582, 'auroc': 0.94970673, 'binary_precision': 0.48690477, 'binary_recall': 0.63608086, 'binary_specificity': 0.97625214, 'binary_f1_score': 0.55158466}
confusion matrix:
       0    1
0  17718  431
1    234  409
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97283477, 'precision': 0.8425747, 'recall': 0.7970959, 'specificity': 0.7970959, 'f1': 0.8180372, 'auroc': 0.9360312, 'binary_precision': 0.7022222, 'binary_recall': 0.60536397, 'binary_specificity': 0.98882776, 'binary_f1_score': 0.65020573}
confusion matrix:
      0    1
0  5930   67
1   103  158
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011734.png
early stop counter: 4
val acc:0.964612603187561, best validation acc: 0.9665282964706421, corresponding to test acc:                         0.977149248123169 / 0.9789069890975952
after epoch: 14,now: 2024-05-31 08:25:26.357869,epoch time: 0:25:19.929024,used: 6:13:36.893551,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_02_11_49_seed_0_21011734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.96675193, 'precision': 0.74624616, 'recall': 0.823786, 'specificity': 0.823786, 'f1': 0.7791043, 'auroc': 0.96022284, 'binary_precision': 0.5040858, 'binary_recall': 0.6705163, 'binary_specificity': 0.9770558, 'binary_f1_score': 0.5755102}
confusion matrix:
       0    1
0  41349  971
1    485  987
---- Validation: 
scalar performance:
{'acc': 0.96482545, 'precision': 0.7391623, 'recall': 0.8265282, 'specificity': 0.8265282, 'f1': 0.7752421, 'auroc': 0.9527454, 'binary_precision': 0.48988765, 'binary_recall': 0.67807156, 'binary_specificity': 0.9749848, 'binary_f1_score': 0.56881934}
confusion matrix:
       0    1
0  17695  454
1    207  436
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9696389, 'precision': 0.8171346, 'recall': 0.7844343, 'specificity': 0.7844343, 'f1': 0.79979014, 'auroc': 0.94164705, 'binary_precision': 0.6523605, 'binary_recall': 0.58237547, 'binary_specificity': 0.98649323, 'binary_f1_score': 0.6153846}
confusion matrix:
      0    1
0  5916   81
1   109  152
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011734.png
early stop counter: 5
val acc:0.964825451374054, best validation acc: 0.9665282964706421, corresponding to test acc:                         0.977149248123169 / 0.9789069890975952
after epoch: 15,now: 2024-05-31 08:51:52.674177,epoch time: 0:26:26.316308,used: 6:40:03.209859,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_02_11_49_seed_0_21011734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9673913, 'precision': 0.75011635, 'recall': 0.841722, 'specificity': 0.841722, 'f1': 0.7879729, 'auroc': 0.96252203, 'binary_precision': 0.51055473, 'binary_recall': 0.70700204, 'binary_specificity': 0.976442, 'binary_f1_score': 0.59293044}
confusion matrix:
       0     1
0  41324   997
1    431  1040
---- Validation: 
scalar performance:
{'acc': 0.9649851, 'precision': 0.74093723, 'recall': 0.84611225, 'specificity': 0.84611225, 'f1': 0.782897, 'auroc': 0.9520309, 'binary_precision': 0.49201277, 'binary_recall': 0.718507, 'binary_specificity': 0.9737176, 'binary_f1_score': 0.58407074}
confusion matrix:
       0    1
0  17672  477
1    181  462
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9709172, 'precision': 0.83917856, 'recall': 0.761281, 'specificity': 0.761281, 'f1': 0.79462576, 'auroc': 0.94248736, 'binary_precision': 0.69849247, 'binary_recall': 0.532567, 'binary_specificity': 0.989995, 'binary_f1_score': 0.60434777}
confusion matrix:
      0    1
0  5937   60
1   122  139
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011734.png
early stop counter: 6
val acc:0.9649850726127625, best validation acc: 0.9665282964706421, corresponding to test acc:                         0.977149248123169 / 0.9789069890975952
after epoch: 16,now: 2024-05-31 09:18:55.056716,epoch time: 0:27:02.382539,used: 7:07:05.592398,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_02_11_49_seed_0_21011734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.968122, 'precision': 0.75420463, 'recall': 0.81793773, 'specificity': 0.81793773, 'f1': 0.7821059, 'auroc': 0.961624, 'binary_precision': 0.5204521, 'binary_recall': 0.6569294, 'binary_specificity': 0.97894615, 'binary_f1_score': 0.58078074}
confusion matrix:
       0    1
0  41429  891
1    505  967
---- Validation: 
scalar performance:
{'acc': 0.96620905, 'precision': 0.74696296, 'recall': 0.8414955, 'specificity': 0.8414955, 'f1': 0.78568846, 'auroc': 0.95314825, 'binary_precision': 0.5044346, 'binary_recall': 0.7076205, 'binary_specificity': 0.9753705, 'binary_f1_score': 0.58899677}
confusion matrix:
       0    1
0  17702  447
1    188  455
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9693193, 'precision': 0.8490832, 'recall': 0.7109743, 'specificity': 0.7109743, 'f1': 0.76129687, 'auroc': 0.94482493, 'binary_precision': 0.7225807, 'binary_recall': 0.42911878, 'binary_specificity': 0.99282974, 'binary_f1_score': 0.53846157}
confusion matrix:
      0    1
0  5954   43
1   149  112
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011734.png
early stop counter: 7
val acc:0.9662090539932251, best validation acc: 0.9665282964706421, corresponding to test acc:                         0.977149248123169 / 0.9789069890975952
after epoch: 17,now: 2024-05-31 09:45:24.817222,epoch time: 0:26:29.760506,used: 7:33:35.352904,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_02_11_49_seed_0_21011734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9643314, 'precision': 0.73709285, 'recall': 0.88600457, 'specificity': 0.88600457, 'f1': 0.79143035, 'auroc': 0.9647919, 'binary_precision': 0.48122448, 'binary_recall': 0.8020408, 'binary_specificity': 0.9699683, 'binary_f1_score': 0.6015306}
confusion matrix:
       0     1
0  41051  1271
1    291  1179
---- Validation: 
scalar performance:
{'acc': 0.9640272, 'precision': 0.73798746, 'recall': 0.8741185, 'specificity': 0.8741185, 'f1': 0.78891647, 'auroc': 0.95651054, 'binary_precision': 0.48402712, 'binary_recall': 0.777605, 'binary_specificity': 0.970632, 'binary_f1_score': 0.59665877}
confusion matrix:
       0    1
0  17616  533
1    143  500
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97219557, 'precision': 0.8219156, 'recall': 0.8407384, 'specificity': 0.8407384, 'f1': 0.8310266, 'auroc': 0.9415099, 'binary_precision': 0.6570397, 'binary_recall': 0.697318, 'binary_specificity': 0.98415875, 'binary_f1_score': 0.6765799}
confusion matrix:
      0    1
0  5902   95
1    79  182
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011734.png
early stop counter: 8
val acc:0.9640272259712219, best validation acc: 0.9665282964706421, corresponding to test acc:                         0.977149248123169 / 0.9789069890975952
after epoch: 18,now: 2024-05-31 10:10:56.062572,epoch time: 0:25:31.245350,used: 7:59:06.598254,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_02_11_49_seed_0_21011734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9648566, 'precision': 0.7372957, 'recall': 0.8450998, 'specificity': 0.8450998, 'f1': 0.77995247, 'auroc': 0.9577619, 'binary_precision': 0.48461184, 'binary_recall': 0.71671194, 'binary_specificity': 0.97348773, 'binary_f1_score': 0.5782406}
confusion matrix:
       0     1
0  41198  1122
1    417  1055
---- Validation: 
scalar performance:
{'acc': 0.9626969, 'precision': 0.73133737, 'recall': 0.8606788, 'specificity': 0.8606788, 'f1': 0.77998346, 'auroc': 0.9550946, 'binary_precision': 0.4716797, 'binary_recall': 0.7511664, 'binary_specificity': 0.9701912, 'binary_f1_score': 0.57948416}
confusion matrix:
       0    1
0  17608  541
1    160  483
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96724194, 'precision': 0.80722094, 'recall': 0.7447047, 'specificity': 0.7447047, 'f1': 0.772007, 'auroc': 0.9331863, 'binary_precision': 0.6359223, 'binary_recall': 0.5019157, 'binary_specificity': 0.98749375, 'binary_f1_score': 0.5610278}
confusion matrix:
      0    1
0  5922   75
1   130  131
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011734.png
early stop counter: 9
val acc:0.96269690990448, best validation acc: 0.9665282964706421, corresponding to test acc:                         0.977149248123169 / 0.9789069890975952
after epoch: 19,now: 2024-05-31 10:36:50.274440,epoch time: 0:25:54.211868,used: 8:25:00.810122,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_02_11_49_seed_0_21011734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.96638656, 'precision': 0.745587, 'recall': 0.8622844, 'specificity': 0.8622844, 'f1': 0.7913365, 'auroc': 0.96836805, 'binary_precision': 0.5, 'binary_recall': 0.7506794, 'binary_specificity': 0.9738894, 'binary_f1_score': 0.6002173}
confusion matrix:
       0     1
0  41215  1105
1    367  1105
---- Validation: 
scalar performance:
{'acc': 0.96514475, 'precision': 0.74284637, 'recall': 0.87094676, 'specificity': 0.87094676, 'f1': 0.7917992, 'auroc': 0.956428, 'binary_precision': 0.49401197, 'binary_recall': 0.7698289, 'binary_specificity': 0.97206455, 'binary_f1_score': 0.6018237}
confusion matrix:
       0    1
0  17642  507
1    148  495
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97347397, 'precision': 0.8646208, 'recall': 0.76994437, 'specificity': 0.76994437, 'f1': 0.8094917, 'auroc': 0.9393763, 'binary_precision': 0.7486911, 'binary_recall': 0.54789275, 'binary_specificity': 0.991996, 'binary_f1_score': 0.63274336}
confusion matrix:
      0    1
0  5949   48
1   118  143
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011734.png
early stop counter: 10
val acc:0.9651447534561157, best validation acc: 0.9665282964706421, corresponding to test acc:                         0.977149248123169 / 0.9789069890975952
after epoch: 20,now: 2024-05-31 11:03:29.121856,epoch time: 0:26:38.847416,used: 8:51:39.657538,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_02_11_49_seed_0_21011734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.96752834, 'precision': 0.75109375, 'recall': 0.85393226, 'specificity': 0.85393226, 'f1': 0.792711, 'auroc': 0.9673537, 'binary_precision': 0.51163894, 'binary_recall': 0.732155, 'binary_specificity': 0.97570944, 'binary_f1_score': 0.602349}
confusion matrix:
       0     1
0  41293  1028
1    394  1077
---- Validation: 
scalar performance:
{'acc': 0.96408045, 'precision': 0.73722506, 'recall': 0.8568948, 'specificity': 0.8568948, 'f1': 0.78343093, 'auroc': 0.95763373, 'binary_precision': 0.4837728, 'binary_recall': 0.7418352, 'binary_specificity': 0.9719544, 'binary_f1_score': 0.58563536}
confusion matrix:
       0    1
0  17640  509
1    166  477
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9689997, 'precision': 0.827667, 'recall': 0.7401248, 'specificity': 0.7401248, 'f1': 0.7764053, 'auroc': 0.95057106, 'binary_precision': 0.67724866, 'binary_recall': 0.49042144, 'binary_specificity': 0.9898282, 'binary_f1_score': 0.56888884}
confusion matrix:
      0    1
0  5936   61
1   133  128
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011734.png
early stop counter: 11
val acc:0.9640804529190063, best validation acc: 0.9665282964706421, corresponding to test acc:                         0.977149248123169 / 0.9789069890975952
after epoch: 21,now: 2024-05-31 11:28:53.354844,epoch time: 0:25:24.232988,used: 9:17:03.890526,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_02_11_49_seed_0_21011734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.96542746, 'precision': 0.7405653, 'recall': 0.8567824, 'specificity': 0.8567824, 'f1': 0.7859386, 'auroc': 0.9647462, 'binary_precision': 0.49031967, 'binary_recall': 0.7403127, 'binary_specificity': 0.97325206, 'binary_f1_score': 0.58992416}
confusion matrix:
       0     1
0  41189  1132
1    382  1089
---- Validation: 
scalar performance:
{'acc': 0.9641869, 'precision': 0.7375446, 'recall': 0.85394967, 'specificity': 0.85394967, 'f1': 0.78279936, 'auroc': 0.95872784, 'binary_precision': 0.48463115, 'binary_recall': 0.7356143, 'binary_specificity': 0.972285, 'binary_f1_score': 0.5843113}
confusion matrix:
       0    1
0  17646  503
1    170  473
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9704378, 'precision': 0.8357286, 'recall': 0.7573662, 'specificity': 0.7573662, 'f1': 0.7908031, 'auroc': 0.9453079, 'binary_precision': 0.6919192, 'binary_recall': 0.5249042, 'binary_specificity': 0.9898282, 'binary_f1_score': 0.59694993}
confusion matrix:
      0    1
0  5936   61
1   124  137
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011734.png
early stop counter: 12
val acc:0.9641869068145752, best validation acc: 0.9665282964706421, corresponding to test acc:                         0.977149248123169 / 0.9789069890975952
after epoch: 22,now: 2024-05-31 11:52:31.867822,epoch time: 0:23:38.512978,used: 9:40:42.403504,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_02_11_49_seed_0_21011734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9607462, 'precision': 0.7223907, 'recall': 0.8809358, 'specificity': 0.8809358, 'f1': 0.777958, 'auroc': 0.9633987, 'binary_precision': 0.45208657, 'binary_recall': 0.7953773, 'binary_specificity': 0.9664942, 'binary_f1_score': 0.57649666}
confusion matrix:
       0     1
0  40903  1418
1    301  1170
---- Validation: 
scalar performance:
{'acc': 0.96078116, 'precision': 0.725405, 'recall': 0.88293874, 'specificity': 0.88293874, 'f1': 0.7809303, 'auroc': 0.9553251, 'binary_precision': 0.4581105, 'binary_recall': 0.7993779, 'binary_specificity': 0.9664995, 'binary_f1_score': 0.5824362}
confusion matrix:
       0    1
0  17541  608
1    129  514
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95701504, 'precision': 0.72961944, 'recall': 0.7118837, 'specificity': 0.7118837, 'f1': 0.7203425, 'auroc': 0.92635596, 'binary_precision': 0.48333332, 'binary_recall': 0.44444445, 'binary_specificity': 0.97932297, 'binary_f1_score': 0.46307385}
confusion matrix:
      0    1
0  5873  124
1   145  116
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011734.png
early stop counter: 13
val acc:0.9607811570167542, best validation acc: 0.9665282964706421, corresponding to test acc:                         0.977149248123169 / 0.9789069890975952
after epoch: 23,now: 2024-05-31 12:16:53.468599,epoch time: 0:24:21.600777,used: 10:05:04.004281,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_02_11_49_seed_0_21011734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9654732, 'precision': 0.7410594, 'recall': 0.8601725, 'specificity': 0.8601725, 'f1': 0.78732246, 'auroc': 0.9665443, 'binary_precision': 0.49107143, 'binary_recall': 0.7472826, 'binary_specificity': 0.9730624, 'binary_f1_score': 0.5926724}
confusion matrix:
       0     1
0  41180  1140
1    372  1100
---- Validation: 
scalar performance:
{'acc': 0.96168584, 'precision': 0.7282118, 'recall': 0.8744064, 'specificity': 0.8744064, 'f1': 0.78114426, 'auroc': 0.9568473, 'binary_precision': 0.46438482, 'binary_recall': 0.7807154, 'binary_specificity': 0.9680974, 'binary_f1_score': 0.5823665}
confusion matrix:
       0    1
0  17570  579
1    141  502
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96324706, 'precision': 0.780465, 'recall': 0.69497967, 'specificity': 0.69497967, 'f1': 0.72911334, 'auroc': 0.9438579, 'binary_precision': 0.5865922, 'binary_recall': 0.40229884, 'binary_specificity': 0.98766047, 'binary_f1_score': 0.47727272}
confusion matrix:
      0    1
0  5923   74
1   156  105
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011734.png
early stop counter: 14
val acc:0.961685836315155, best validation acc: 0.9665282964706421, corresponding to test acc:                         0.977149248123169 / 0.9789069890975952
after epoch: 24,now: 2024-05-31 12:41:45.619691,epoch time: 0:24:52.151092,used: 10:29:56.155373,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_02_11_49_seed_0_21011734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.96704876, 'precision': 0.74867785, 'recall': 0.8579493, 'specificity': 0.8579493, 'f1': 0.7922624, 'auroc': 0.96964294, 'binary_precision': 0.50650555, 'binary_recall': 0.74099255, 'binary_specificity': 0.9749061, 'binary_f1_score': 0.6017113}
confusion matrix:
       0     1
0  41259  1062
1    381  1090
---- Validation: 
scalar performance:
{'acc': 0.96466583, 'precision': 0.74072117, 'recall': 0.87219894, 'specificity': 0.87219894, 'f1': 0.79051757, 'auroc': 0.95773107, 'binary_precision': 0.48965517, 'binary_recall': 0.7729393, 'binary_specificity': 0.9714585, 'binary_f1_score': 0.59951746}
confusion matrix:
       0    1
0  17631  518
1    146  497
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9689997, 'precision': 0.8342068, 'recall': 0.7272985, 'specificity': 0.7272985, 'f1': 0.7694931, 'auroc': 0.9505348, 'binary_precision': 0.69142854, 'binary_recall': 0.46360153, 'binary_specificity': 0.9909955, 'binary_f1_score': 0.5550459}
confusion matrix:
      0    1
0  5943   54
1   140  121
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011734.png
early stop counter: 15
val acc:0.9646658301353455, best validation acc: 0.9665282964706421, corresponding to test acc:                         0.977149248123169 / 0.9789069890975952
after epoch: 25,now: 2024-05-31 13:06:09.987237,epoch time: 0:24:24.367546,used: 10:54:20.522919,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_02_11_49_seed_0_21011734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9663637, 'precision': 0.74545693, 'recall': 0.86481285, 'specificity': 0.86481285, 'f1': 0.79200476, 'auroc': 0.96665573, 'binary_precision': 0.49955076, 'binary_recall': 0.7559483, 'binary_specificity': 0.9736774, 'binary_f1_score': 0.6015688}
confusion matrix:
       0     1
0  41207  1114
1    359  1112
---- Validation: 
scalar performance:
{'acc': 0.9641869, 'precision': 0.7384411, 'recall': 0.8697008, 'specificity': 0.8697008, 'f1': 0.7880439, 'auroc': 0.95765996, 'binary_precision': 0.48526523, 'binary_recall': 0.7682737, 'binary_specificity': 0.97112787, 'binary_f1_score': 0.59482235}
confusion matrix:
       0    1
0  17625  524
1    149  494
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9678811, 'precision': 0.808162, 'recall': 0.7615292, 'specificity': 0.7615292, 'f1': 0.7827096, 'auroc': 0.94214284, 'binary_precision': 0.6363636, 'binary_recall': 0.5363985, 'binary_specificity': 0.98666, 'binary_f1_score': 0.58212054}
confusion matrix:
      0    1
0  5917   80
1   121  140
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011734.png
early stop counter: 16
val acc:0.9641869068145752, best validation acc: 0.9665282964706421, corresponding to test acc:                         0.977149248123169 / 0.9789069890975952
after epoch: 26,now: 2024-05-31 13:30:33.153527,epoch time: 0:24:23.166290,used: 11:18:43.689209,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_02_11_49_seed_0_21011734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.95898795, 'precision': 0.7186726, 'recall': 0.90665174, 'specificity': 0.90665174, 'f1': 0.7803804, 'auroc': 0.96661234, 'binary_precision': 0.4427157, 'binary_recall': 0.8505435, 'binary_specificity': 0.9627599, 'binary_f1_score': 0.58232564}
confusion matrix:
       0     1
0  40744  1576
1    220  1252
---- Validation: 
scalar performance:
{'acc': 0.9589187, 'precision': 0.72061217, 'recall': 0.9037261, 'specificity': 0.9037261, 'f1': 0.78144526, 'auroc': 0.9587102, 'binary_precision': 0.44691357, 'binary_recall': 0.844479, 'binary_specificity': 0.9629732, 'binary_f1_score': 0.5844995}
confusion matrix:
       0    1
0  17477  672
1    100  543
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.7448868, 'recall': 0.82090855, 'specificity': 0.82090855, 'f1': 0.7769959, 'auroc': 0.93499625, 'binary_precision': 0.50432277, 'binary_recall': 0.6704981, 'binary_specificity': 0.971319, 'binary_f1_score': 0.57565784}
confusion matrix:
      0    1
0  5825  172
1    86  175
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011734.png
early stop counter: 17
val acc:0.9589186906814575, best validation acc: 0.9665282964706421, corresponding to test acc:                         0.977149248123169 / 0.9789069890975952
after epoch: 27,now: 2024-05-31 13:54:26.417678,epoch time: 0:23:53.264151,used: 11:42:36.953360,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_02_11_49_seed_0_21011734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.96483374, 'precision': 0.74006534, 'recall': 0.89721763, 'specificity': 0.89721763, 'f1': 0.7967388, 'auroc': 0.96918607, 'binary_precision': 0.4863782, 'binary_recall': 0.82472825, 'binary_specificity': 0.969707, 'binary_f1_score': 0.61189514}
confusion matrix:
       0     1
0  41038  1282
1    258  1214
---- Validation: 
scalar performance:
{'acc': 0.96141976, 'precision': 0.728309, 'recall': 0.8885197, 'specificity': 0.8885197, 'f1': 0.7847291, 'auroc': 0.96014404, 'binary_precision': 0.46352312, 'binary_recall': 0.8102644, 'binary_specificity': 0.966775, 'binary_f1_score': 0.58970004}
confusion matrix:
       0    1
0  17546  603
1    122  521
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964845, 'precision': 0.78595746, 'recall': 0.74162173, 'specificity': 0.74162173, 'f1': 0.7616941, 'auroc': 0.9297749, 'binary_precision': 0.5936073, 'binary_recall': 0.49808428, 'binary_specificity': 0.9851592, 'binary_f1_score': 0.5416666}
confusion matrix:
      0    1
0  5908   89
1   131  130
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011734.png
early stop counter: 18
val acc:0.9614197611808777, best validation acc: 0.9665282964706421, corresponding to test acc:                         0.977149248123169 / 0.9789069890975952
after epoch: 28,now: 2024-05-31 14:18:53.187964,epoch time: 0:24:26.770286,used: 12:07:03.723646,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_02_11_49_seed_0_21011734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.96542746, 'precision': 0.7421404, 'recall': 0.8914965, 'specificity': 0.8914965, 'f1': 0.7969508, 'auroc': 0.9719467, 'binary_precision': 0.49095395, 'binary_recall': 0.8122449, 'binary_specificity': 0.97074807, 'binary_f1_score': 0.61199385}
confusion matrix:
       0     1
0  41084  1238
1    276  1194
---- Validation: 
scalar performance:
{'acc': 0.9611537, 'precision': 0.72752887, 'recall': 0.8913822, 'specificity': 0.8913822, 'f1': 0.7847494, 'auroc': 0.9607669, 'binary_precision': 0.46174142, 'binary_recall': 0.8164852, 'binary_specificity': 0.96627915, 'binary_f1_score': 0.5898876}
confusion matrix:
       0    1
0  17537  612
1    118  525
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9651646, 'precision': 0.79831874, 'recall': 0.70514184, 'specificity': 0.70514184, 'f1': 0.74211687, 'auroc': 0.93353176, 'binary_precision': 0.6214689, 'binary_recall': 0.42145595, 'binary_specificity': 0.98882776, 'binary_f1_score': 0.5022831}
confusion matrix:
      0    1
0  5930   67
1   151  110
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011734.png
early stop counter: 19
val acc:0.9611536860466003, best validation acc: 0.9665282964706421, corresponding to test acc:                         0.977149248123169 / 0.9789069890975952
after epoch: 29,now: 2024-05-31 14:43:44.014556,epoch time: 0:24:50.826592,used: 12:31:54.550238,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_02_11_49_seed_0_21011734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.96663773, 'precision': 0.7473227, 'recall': 0.8803749, 'specificity': 0.8803749, 'f1': 0.7979783, 'auroc': 0.9692797, 'binary_precision': 0.5021664, 'binary_recall': 0.7878994, 'binary_specificity': 0.9728504, 'binary_f1_score': 0.6133898}
confusion matrix:
       0     1
0  41172  1149
1    312  1159
---- Validation: 
scalar performance:
{'acc': 0.96365476, 'precision': 0.736218, 'recall': 0.8716755, 'specificity': 0.8716755, 'f1': 0.7868519, 'auroc': 0.9590322, 'binary_precision': 0.48065764, 'binary_recall': 0.7729393, 'binary_specificity': 0.9704116, 'binary_f1_score': 0.59272504}
confusion matrix:
       0    1
0  17612  537
1    146  497
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96676254, 'precision': 0.80603963, 'recall': 0.7334606, 'specificity': 0.7334606, 'f1': 0.7643008, 'auroc': 0.94569254, 'binary_precision': 0.6345178, 'binary_recall': 0.4789272, 'binary_specificity': 0.987994, 'binary_f1_score': 0.54585147}
confusion matrix:
      0    1
0  5925   72
1   136  125
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011734.png
early stop counter: 20
val acc:0.9636547565460205, best validation acc: 0.9665282964706421, corresponding to test acc:                         0.977149248123169 / 0.9789069890975952
after epoch: 30,now: 2024-05-31 15:08:15.418047,epoch time: 0:24:31.403491,used: 12:56:25.953729,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_02_11_49_seed_0_21011734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 12:56:25.953729 at 2024-05-31 15:08:15.418047
persisted model performance metric: 

scalar performance:
{'acc': 0.97682965, 'precision': 0.86582386, 'recall': 0.83216226, 'specificity': 0.83216226, 'f1': 0.8480926, 'auroc': 0.94336313, 'binary_precision': 0.7457627, 'binary_recall': 0.6743295, 'binary_specificity': 0.989995, 'binary_f1_score': 0.7082495}
confusion matrix:
      0    1
0  5937   60
1    85  176
oracle model performance metric: 

scalar performance:
{'acc': 0.97698945, 'precision': 0.8704312, 'recall': 0.8267486, 'specificity': 0.8267486, 'f1': 0.8470742, 'auroc': 0.93950355, 'binary_precision': 0.75545853, 'binary_recall': 0.66283524, 'binary_specificity': 0.990662, 'binary_f1_score': 0.70612246}
confusion matrix:
      0    1
0  5941   56
1    88  173
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/rule_results/9.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/rule_results/9.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/confusion_matrix/9.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 493147 KiB |  10997 MiB |    907 TiB |    907 TiB |
|       from large pool | 403328 KiB |  10925 MiB |    904 TiB |    904 TiB |
|       from small pool |  89819 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 493147 KiB |  10997 MiB |    907 TiB |    907 TiB |
|       from large pool | 403328 KiB |  10925 MiB |    904 TiB |    904 TiB |
|       from small pool |  89819 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476573 KiB |  10880 MiB |    898 TiB |    898 TiB |
|       from large pool | 387840 KiB |  10808 MiB |    895 TiB |    895 TiB |
|       from small pool |  88733 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11482 MiB |  11482 MiB |  11482 MiB |      0 B   |
|       from large pool |  11356 MiB |  11356 MiB |  11356 MiB |      0 B   |
|       from small pool |    126 MiB |    126 MiB |    126 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 752036 KiB |   1325 MiB | 384644 GiB | 384644 GiB |
|       from large pool | 741504 KiB |   1322 MiB | 381641 GiB | 381641 GiB |
|       from small pool |  10532 KiB |     11 MiB |   3002 GiB |   3002 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3729    |    6720    |  139730 K  |  139726 K  |
|       from large pool |      87    |     908    |   56777 K  |   56777 K  |
|       from small pool |    3642    |    6631    |   82952 K  |   82949 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3729    |    6720    |  139730 K  |  139726 K  |
|       from large pool |      87    |     908    |   56777 K  |   56777 K  |
|       from small pool |    3642    |    6631    |   82952 K  |   82949 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     404    |     404    |     404    |       0    |
|       from large pool |     341    |     341    |     341    |       0    |
|       from small pool |      63    |      63    |      63    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      70    |    2767    |   74912 K  |   74912 K  |
|       from large pool |      19    |     187    |   34810 K  |   34810 K  |
|       from small pool |      51    |    2747    |   40102 K  |   40102 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10997 MiB |    907 TiB |    907 TiB |
|       from large pool |  16640 KiB |  10925 MiB |    904 TiB |    904 TiB |
|       from small pool |      0 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10997 MiB |    907 TiB |    907 TiB |
|       from large pool |  16640 KiB |  10925 MiB |    904 TiB |    904 TiB |
|       from small pool |      0 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10880 MiB |    898 TiB |    898 TiB |
|       from large pool |  16640 KiB |  10808 MiB |    895 TiB |    895 TiB |
|       from small pool |      0 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1216 MiB |  11482 MiB |  11482 MiB |  10266 MiB |
|       from large pool |   1118 MiB |  11356 MiB |  11356 MiB |  10238 MiB |
|       from small pool |     98 MiB |    126 MiB |    126 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1325 MiB | 384645 GiB | 384645 GiB |
|       from large pool |  50944 KiB |   1322 MiB | 381642 GiB | 381642 GiB |
|       from small pool |      0 KiB |     24 MiB |   3002 GiB |   3002 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6720    |  139730 K  |  139730 K  |
|       from large pool |       2    |     908    |   56777 K  |   56777 K  |
|       from small pool |       0    |    6631    |   82952 K  |   82952 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6720    |  139730 K  |  139730 K  |
|       from large pool |       2    |     908    |   56777 K  |   56777 K  |
|       from small pool |       0    |    6631    |   82952 K  |   82952 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      79    |     404    |     404    |     325    |
|       from large pool |      30    |     341    |     341    |     311    |
|       from small pool |      49    |      63    |      63    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2767    |   74914 K  |   74914 K  |
|       from large pool |       4    |     187    |   34810 K  |   34810 K  |
|       from small pool |       0    |    2747    |   40103 K  |   40103 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10997 MiB |    907 TiB |    907 TiB |
|       from large pool |  16640 KiB |  10925 MiB |    904 TiB |    904 TiB |
|       from small pool |      0 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10997 MiB |    907 TiB |    907 TiB |
|       from large pool |  16640 KiB |  10925 MiB |    904 TiB |    904 TiB |
|       from small pool |      0 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10880 MiB |    898 TiB |    898 TiB |
|       from large pool |  16640 KiB |  10808 MiB |    895 TiB |    895 TiB |
|       from small pool |      0 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1216 MiB |  11482 MiB |  11482 MiB |  10266 MiB |
|       from large pool |   1118 MiB |  11356 MiB |  11356 MiB |  10238 MiB |
|       from small pool |     98 MiB |    126 MiB |    126 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1325 MiB | 384645 GiB | 384645 GiB |
|       from large pool |  50944 KiB |   1322 MiB | 381642 GiB | 381642 GiB |
|       from small pool |      0 KiB |     24 MiB |   3002 GiB |   3002 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6720    |  139730 K  |  139730 K  |
|       from large pool |       2    |     908    |   56777 K  |   56777 K  |
|       from small pool |       0    |    6631    |   82952 K  |   82952 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6720    |  139730 K  |  139730 K  |
|       from large pool |       2    |     908    |   56777 K  |   56777 K  |
|       from small pool |       0    |    6631    |   82952 K  |   82952 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      79    |     404    |     404    |     325    |
|       from large pool |      30    |     341    |     341    |     311    |
|       from small pool |      49    |      63    |      63    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2767    |   74914 K  |   74914 K  |
|       from large pool |       4    |     187    |   34810 K  |   34810 K  |
|       from small pool |       0    |    2747    |   40103 K  |   40103 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_15_19_57_seed_1_21011734

 Experiment start at: 2024-05-31 15:19:58.001641
before training, model accuracy: 0.09474702179431915
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96709687, 'precision': 0.7342383, 'recall': 0.5482213, 'specificity': 0.5482213, 'f1': 0.5747975, 'auroc': 0.8917995, 'binary_precision': 0.4982699, 'binary_recall': 0.0998613, 'binary_specificity': 0.9965813, 'binary_f1_score': 0.16637781}
confusion matrix:
       0    1
0  42269  145
1   1298  144
---- Validation: 
scalar performance:
{'acc': 0.9647812, 'precision': 0.751624, 'recall': 0.57331705, 'specificity': 0.57331705, 'f1': 0.6090431, 'auroc': 0.898426, 'binary_precision': 0.5340314, 'binary_recall': 0.15156017, 'binary_specificity': 0.9950739, 'binary_f1_score': 0.2361111}
confusion matrix:
       0    1
0  17978   89
1    571  102
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9653561, 'precision': 0.96229446, 'recall': 0.59021646, 'specificity': 0.59021646, 'f1': 0.6432215, 'auroc': 0.88270974, 'binary_precision': 0.9591837, 'binary_recall': 0.18076923, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.30420712}
confusion matrix:
      0   1
0  5944   2
1   213  47
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011734.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-31 15:45:55.365057,epoch time: 0:25:57.363416,used: 0:25:57.363416,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_15_19_57_seed_1_21011734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9664812, 'precision': 0.72511935, 'recall': 0.5964711, 'specificity': 0.5964711, 'f1': 0.6325333, 'auroc': 0.91505015, 'binary_precision': 0.4768977, 'binary_recall': 0.20041609, 'binary_specificity': 0.99252605, 'binary_f1_score': 0.28222656}
confusion matrix:
       0    1
0  42097  317
1   1153  289
---- Validation: 
scalar performance:
{'acc': 0.964301, 'precision': 0.7402816, 'recall': 0.6732054, 'specificity': 0.6732054, 'f1': 0.70067924, 'auroc': 0.9188729, 'binary_precision': 0.50416666, 'binary_recall': 0.35958394, 'binary_specificity': 0.98682684, 'binary_f1_score': 0.4197745}
confusion matrix:
       0    1
0  17829  238
1    431  242
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97180146, 'precision': 0.89970344, 'recall': 0.7057582, 'specificity': 0.7057582, 'f1': 0.7689359, 'auroc': 0.91705525, 'binary_precision': 0.8244275, 'binary_recall': 0.41538462, 'binary_specificity': 0.99613184, 'binary_f1_score': 0.5524297}
confusion matrix:
      0    1
0  5923   23
1   152  108
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011734.png
new oracle model saved
early stop counter: 1
val acc:0.9643009901046753, best validation acc: 0.9647812247276306, corresponding to test acc:                         0.9653561115264893 / 0.9718014597892761
after epoch: 2,now: 2024-05-31 16:10:39.585931,epoch time: 0:24:44.220874,used: 0:50:41.584290,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_15_19_57_seed_1_21011734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96707404, 'precision': 0.7374513, 'recall': 0.6386466, 'specificity': 0.6386466, 'f1': 0.6737679, 'auroc': 0.9290116, 'binary_precision': 0.49879518, 'binary_recall': 0.28710124, 'binary_specificity': 0.99019194, 'binary_f1_score': 0.36443663}
confusion matrix:
       0    1
0  41998  416
1   1028  414
---- Validation: 
scalar performance:
{'acc': 0.96611524, 'precision': 0.7559736, 'recall': 0.73208296, 'specificity': 0.73208296, 'f1': 0.74337584, 'auroc': 0.91770875, 'binary_precision': 0.53125, 'binary_recall': 0.47994056, 'binary_specificity': 0.9842254, 'binary_f1_score': 0.50429356}
confusion matrix:
       0    1
0  17782  285
1    350  323
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97437966, 'precision': 0.9253421, 'recall': 0.72549355, 'specificity': 0.72549355, 'f1': 0.79211855, 'auroc': 0.9223454, 'binary_precision': 0.8740741, 'binary_recall': 0.45384616, 'binary_specificity': 0.99714094, 'binary_f1_score': 0.5974684}
confusion matrix:
      0    1
0  5929   17
1   142  118
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011734.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-05-31 16:35:48.416389,epoch time: 0:25:08.830458,used: 1:15:50.414748,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_15_19_57_seed_1_21011734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9671653, 'precision': 0.7405693, 'recall': 0.70166475, 'specificity': 0.70166475, 'f1': 0.71922153, 'auroc': 0.93684185, 'binary_precision': 0.50083196, 'binary_recall': 0.41747573, 'binary_specificity': 0.98585373, 'binary_f1_score': 0.4553707}
confusion matrix:
       0    1
0  41814  600
1    840  602
---- Validation: 
scalar performance:
{'acc': 0.9638207, 'precision': 0.7407746, 'recall': 0.78453803, 'specificity': 0.78453803, 'f1': 0.7605984, 'auroc': 0.93101585, 'binary_precision': 0.4968789, 'binary_recall': 0.59138185, 'binary_specificity': 0.97769415, 'binary_f1_score': 0.5400271}
confusion matrix:
       0    1
0  17664  403
1    275  398
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97631323, 'precision': 0.89348495, 'recall': 0.7835112, 'specificity': 0.7835112, 'f1': 0.8286895, 'auroc': 0.91694415, 'binary_precision': 0.8054054, 'binary_recall': 0.5730769, 'binary_specificity': 0.99394554, 'binary_f1_score': 0.66966283}
confusion matrix:
      0    1
0  5910   36
1   111  149
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011734.png
new oracle model saved
early stop counter: 1
val acc:0.9638206958770752, best validation acc: 0.9661152362823486, corresponding to test acc:                         0.9743796586990356 / 0.9763132333755493
after epoch: 4,now: 2024-05-31 17:00:35.252169,epoch time: 0:24:46.835780,used: 1:40:37.250528,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_15_19_57_seed_1_21011734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96700567, 'precision': 0.73992705, 'recall': 0.7226842, 'specificity': 0.7226842, 'f1': 0.7309488, 'auroc': 0.94271255, 'binary_precision': 0.49812734, 'binary_recall': 0.46116504, 'binary_specificity': 0.98420334, 'binary_f1_score': 0.47893408}
confusion matrix:
       0    1
0  41744  670
1    777  665
---- Validation: 
scalar performance:
{'acc': 0.96350056, 'precision': 0.7391018, 'recall': 0.78794825, 'specificity': 0.78794825, 'f1': 0.76096714, 'auroc': 0.93512, 'binary_precision': 0.49326804, 'binary_recall': 0.59881127, 'binary_specificity': 0.9770853, 'binary_f1_score': 0.54093957}
confusion matrix:
       0    1
0  17653  414
1    270  403
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.973574, 'precision': 0.87321055, 'recall': 0.76185286, 'specificity': 0.76185286, 'f1': 0.806787, 'auroc': 0.91779935, 'binary_precision': 0.76666665, 'binary_recall': 0.5307692, 'binary_specificity': 0.99293643, 'binary_f1_score': 0.6272727}
confusion matrix:
      0    1
0  5904   42
1   122  138
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011734.png
early stop counter: 2
val acc:0.9635005593299866, best validation acc: 0.9661152362823486, corresponding to test acc:                         0.9743796586990356 / 0.9763132333755493
after epoch: 5,now: 2024-05-31 17:26:38.474128,epoch time: 0:26:03.221959,used: 2:06:40.472487,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_15_19_57_seed_1_21011734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96805453, 'precision': 0.7488736, 'recall': 0.75337213, 'specificity': 0.75337213, 'f1': 0.75110054, 'auroc': 0.9438493, 'binary_precision': 0.51395506, 'binary_recall': 0.52357835, 'binary_specificity': 0.9831659, 'binary_f1_score': 0.5187221}
confusion matrix:
       0    1
0  41700  714
1    687  755
---- Validation: 
scalar performance:
{'acc': 0.9646745, 'precision': 0.74612176, 'recall': 0.7957098, 'specificity': 0.7957098, 'f1': 0.7683573, 'auroc': 0.9435189, 'binary_precision': 0.50674844, 'binary_recall': 0.6136701, 'binary_specificity': 0.97774947, 'binary_f1_score': 0.5551075}
confusion matrix:
       0    1
0  17665  402
1    260  413
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97486305, 'precision': 0.87610507, 'recall': 0.78091544, 'specificity': 0.78091544, 'f1': 0.8209119, 'auroc': 0.92716146, 'binary_precision': 0.7708333, 'binary_recall': 0.5692308, 'binary_specificity': 0.9926001, 'binary_f1_score': 0.6548673}
confusion matrix:
      0    1
0  5902   44
1   112  148
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011734.png
early stop counter: 3
val acc:0.9646744728088379, best validation acc: 0.9661152362823486, corresponding to test acc:                         0.9743796586990356 / 0.9763132333755493
after epoch: 6,now: 2024-05-31 17:52:40.949431,epoch time: 0:26:02.475303,used: 2:32:42.947790,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_15_19_57_seed_1_21011734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96474826, 'precision': 0.73112345, 'recall': 0.8166435, 'specificity': 0.8166435, 'f1': 0.7663785, 'auroc': 0.94620717, 'binary_precision': 0.47402596, 'binary_recall': 0.6581137, 'binary_specificity': 0.9751733, 'binary_f1_score': 0.55110335}
confusion matrix:
       0     1
0  41361  1053
1    493   949
---- Validation: 
scalar performance:
{'acc': 0.9620064, 'precision': 0.7338436, 'recall': 0.8279436, 'specificity': 0.8279436, 'f1': 0.7719319, 'auroc': 0.94508624, 'binary_precision': 0.47966632, 'binary_recall': 0.68350667, 'binary_specificity': 0.9723806, 'binary_f1_score': 0.56372553}
confusion matrix:
       0    1
0  17568  499
1    213  460
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96793425, 'precision': 0.79802334, 'recall': 0.8122403, 'specificity': 0.8122403, 'f1': 0.80494475, 'auroc': 0.9204242, 'binary_precision': 0.61172163, 'binary_recall': 0.6423077, 'binary_specificity': 0.9821729, 'binary_f1_score': 0.6266417}
confusion matrix:
      0    1
0  5840  106
1    93  167
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011734.png
early stop counter: 4
val acc:0.9620063900947571, best validation acc: 0.9661152362823486, corresponding to test acc:                         0.9743796586990356 / 0.9763132333755493
after epoch: 7,now: 2024-05-31 18:18:23.917768,epoch time: 0:25:42.968337,used: 2:58:25.916127,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_15_19_57_seed_1_21011734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9681457, 'precision': 0.75003934, 'recall': 0.8070116, 'specificity': 0.8070116, 'f1': 0.7752774, 'auroc': 0.9523566, 'binary_precision': 0.5126051, 'binary_recall': 0.6345354, 'binary_specificity': 0.9794879, 'binary_f1_score': 0.5670902}
confusion matrix:
       0    1
0  41544  870
1    527  915
---- Validation: 
scalar performance:
{'acc': 0.9632337, 'precision': 0.73771596, 'recall': 0.78995574, 'specificity': 0.78995574, 'f1': 0.76091135, 'auroc': 0.9440459, 'binary_precision': 0.49033818, 'binary_recall': 0.6032689, 'binary_specificity': 0.9766425, 'binary_f1_score': 0.5409727}
confusion matrix:
       0    1
0  17645  422
1    267  406
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9740574, 'precision': 0.8475315, 'recall': 0.8154357, 'specificity': 0.8154357, 'f1': 0.8306186, 'auroc': 0.938763, 'binary_precision': 0.7106383, 'binary_recall': 0.6423077, 'binary_specificity': 0.9885637, 'binary_f1_score': 0.6747474}
confusion matrix:
      0    1
0  5878   68
1    93  167
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011734.png
early stop counter: 5
val acc:0.9632337093353271, best validation acc: 0.9661152362823486, corresponding to test acc:                         0.9743796586990356 / 0.9763132333755493
after epoch: 8,now: 2024-05-31 18:44:26.815249,epoch time: 0:26:02.897481,used: 3:24:28.813608,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_15_19_57_seed_1_21011734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9675985, 'precision': 0.7469684, 'recall': 0.81979185, 'specificity': 0.81979185, 'f1': 0.77815264, 'auroc': 0.9572995, 'binary_precision': 0.5055644, 'binary_recall': 0.66158116, 'binary_specificity': 0.97800255, 'binary_f1_score': 0.57314515}
confusion matrix:
       0    1
0  41481  933
1    488  954
---- Validation: 
scalar performance:
{'acc': 0.96344715, 'precision': 0.73979485, 'recall': 0.8079481, 'specificity': 0.8079481, 'f1': 0.7690722, 'auroc': 0.94566405, 'binary_precision': 0.493135, 'binary_recall': 0.640416, 'binary_specificity': 0.97548014, 'binary_f1_score': 0.5572075}
confusion matrix:
       0    1
0  17624  443
1    242  431
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9738962, 'precision': 0.8414892, 'recall': 0.8263855, 'specificity': 0.8263855, 'f1': 0.8337467, 'auroc': 0.94987583, 'binary_precision': 0.69758064, 'binary_recall': 0.6653846, 'binary_specificity': 0.98738647, 'binary_f1_score': 0.68110234}
confusion matrix:
      0    1
0  5871   75
1    87  173
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011734.png
early stop counter: 6
val acc:0.9634471535682678, best validation acc: 0.9661152362823486, corresponding to test acc:                         0.9743796586990356 / 0.9763132333755493
after epoch: 9,now: 2024-05-31 19:10:11.271500,epoch time: 0:25:44.456251,used: 3:50:13.269859,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_15_19_57_seed_1_21011734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.96709687, 'precision': 0.74355817, 'recall': 0.8054645, 'specificity': 0.8054645, 'f1': 0.77061117, 'auroc': 0.95544744, 'binary_precision': 0.49972603, 'binary_recall': 0.63245493, 'binary_specificity': 0.9784741, 'binary_f1_score': 0.5583104}
confusion matrix:
       0    1
0  41501  913
1    530  912
---- Validation: 
scalar performance:
{'acc': 0.9627535, 'precision': 0.7356976, 'recall': 0.7997204, 'specificity': 0.7997204, 'f1': 0.7633718, 'auroc': 0.9466554, 'binary_precision': 0.48554912, 'binary_recall': 0.6240713, 'binary_specificity': 0.97536945, 'binary_f1_score': 0.5461638}
confusion matrix:
       0    1
0  17622  445
1    253  420
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97196263, 'precision': 0.8328103, 'recall': 0.8033086, 'specificity': 0.8033086, 'f1': 0.8172957, 'auroc': 0.9406363, 'binary_precision': 0.6822034, 'binary_recall': 0.61923075, 'binary_specificity': 0.98738647, 'binary_f1_score': 0.6491935}
confusion matrix:
      0    1
0  5871   75
1    99  161
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011734.png
early stop counter: 7
val acc:0.9627534747123718, best validation acc: 0.9661152362823486, corresponding to test acc:                         0.9743796586990356 / 0.9763132333755493
after epoch: 10,now: 2024-05-31 19:35:58.709736,epoch time: 0:25:47.438236,used: 4:16:00.708095,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_15_19_57_seed_1_21011734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96654963, 'precision': 0.74234754, 'recall': 0.85107005, 'specificity': 0.85107005, 'f1': 0.7855328, 'auroc': 0.958017, 'binary_precision': 0.4941121, 'binary_recall': 0.7274619, 'binary_specificity': 0.97467816, 'binary_f1_score': 0.5884993}
confusion matrix:
       0     1
0  41340  1074
1    393  1049
---- Validation: 
scalar performance:
{'acc': 0.963127, 'precision': 0.7388037, 'recall': 0.8206569, 'specificity': 0.8206569, 'f1': 0.7729413, 'auroc': 0.94847435, 'binary_precision': 0.49017468, 'binary_recall': 0.66716194, 'binary_specificity': 0.9741518, 'binary_f1_score': 0.5651353}
confusion matrix:
       0    1
0  17600  467
1    224  449
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97260714, 'precision': 0.8271347, 'recall': 0.83674675, 'specificity': 0.83674675, 'f1': 0.8318627, 'auroc': 0.94735634, 'binary_precision': 0.66791046, 'binary_recall': 0.68846154, 'binary_specificity': 0.98503196, 'binary_f1_score': 0.6780303}
confusion matrix:
      0    1
0  5857   89
1    81  179
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011734.png
early stop counter: 8
val acc:0.9631270170211792, best validation acc: 0.9661152362823486, corresponding to test acc:                         0.9743796586990356 / 0.9763132333755493
after epoch: 11,now: 2024-05-31 20:01:46.554150,epoch time: 0:25:47.844414,used: 4:41:48.552509,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_15_19_57_seed_1_21011734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.96889824, 'precision': 0.75486964, 'recall': 0.80807054, 'specificity': 0.80807054, 'f1': 0.7786721, 'auroc': 0.96205926, 'binary_precision': 0.5222096, 'binary_recall': 0.6359223, 'binary_specificity': 0.98021877, 'binary_f1_score': 0.57348347}
confusion matrix:
       0    1
0  41575  839
1    525  917
---- Validation: 
scalar performance:
{'acc': 0.9639808, 'precision': 0.742681, 'recall': 0.8089401, 'specificity': 0.8089401, 'f1': 0.77131134, 'auroc': 0.9497254, 'binary_precision': 0.49884528, 'binary_recall': 0.6419019, 'binary_specificity': 0.9759783, 'binary_f1_score': 0.5614035}
confusion matrix:
       0    1
0  17633  434
1    241  432
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9708347, 'precision': 0.8332119, 'recall': 0.77513516, 'specificity': 0.77513516, 'f1': 0.80108786, 'auroc': 0.94927037, 'binary_precision': 0.685446, 'binary_recall': 0.56153846, 'binary_specificity': 0.9887319, 'binary_f1_score': 0.61733615}
confusion matrix:
      0    1
0  5879   67
1   114  146
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011734.png
early stop counter: 9
val acc:0.9639807939529419, best validation acc: 0.9661152362823486, corresponding to test acc:                         0.9743796586990356 / 0.9763132333755493
after epoch: 12,now: 2024-05-31 20:27:43.430699,epoch time: 0:25:56.876549,used: 5:07:45.429058,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_15_19_57_seed_1_21011734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9675301, 'precision': 0.7462517, 'recall': 0.80803317, 'specificity': 0.80803317, 'f1': 0.77329797, 'auroc': 0.96055114, 'binary_precision': 0.50494504, 'binary_recall': 0.6373093, 'binary_specificity': 0.978757, 'binary_f1_score': 0.56345797}
confusion matrix:
       0    1
0  41513  901
1    523  919
---- Validation: 
scalar performance:
{'acc': 0.96350056, 'precision': 0.7394531, 'recall': 0.7951009, 'specificity': 0.7951009, 'f1': 0.76400197, 'auroc': 0.95174634, 'binary_precision': 0.49342892, 'binary_recall': 0.6136701, 'binary_specificity': 0.9765318, 'binary_f1_score': 0.54701984}
confusion matrix:
       0    1
0  17643  424
1    260  413
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9705124, 'precision': 0.8384035, 'recall': 0.75657713, 'specificity': 0.75657713, 'f1': 0.7912487, 'auroc': 0.9520829, 'binary_precision': 0.6974359, 'binary_recall': 0.52307695, 'binary_specificity': 0.9900774, 'binary_f1_score': 0.5978022}
confusion matrix:
      0    1
0  5887   59
1   124  136
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011734.png
early stop counter: 10
val acc:0.9635005593299866, best validation acc: 0.9661152362823486, corresponding to test acc:                         0.9743796586990356 / 0.9763132333755493
after epoch: 13,now: 2024-05-31 20:53:39.992570,epoch time: 0:25:56.561871,used: 5:33:41.990929,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_15_19_57_seed_1_21011734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96650404, 'precision': 0.74174476, 'recall': 0.84267265, 'specificity': 0.84267265, 'f1': 0.78243345, 'auroc': 0.9636935, 'binary_precision': 0.49349397, 'binary_recall': 0.71012485, 'binary_specificity': 0.97522044, 'binary_f1_score': 0.5823145}
confusion matrix:
       0     1
0  41363  1051
1    418  1024
---- Validation: 
scalar performance:
{'acc': 0.96392745, 'precision': 0.74192506, 'recall': 0.7974682, 'specificity': 0.7974682, 'f1': 0.7664659, 'auroc': 0.9510564, 'binary_precision': 0.4982036, 'binary_recall': 0.61812776, 'binary_specificity': 0.97680855, 'binary_f1_score': 0.55172414}
confusion matrix:
       0    1
0  17648  419
1    257  416
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97212374, 'precision': 0.8412139, 'recall': 0.78684187, 'specificity': 0.78684187, 'f1': 0.81141067, 'auroc': 0.94130135, 'binary_precision': 0.70046085, 'binary_recall': 0.5846154, 'binary_specificity': 0.98906827, 'binary_f1_score': 0.6373166}
confusion matrix:
      0    1
0  5881   65
1   108  152
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011734.png
early stop counter: 11
val acc:0.9639274477958679, best validation acc: 0.9661152362823486, corresponding to test acc:                         0.9743796586990356 / 0.9763132333755493
after epoch: 14,now: 2024-05-31 21:19:34.697638,epoch time: 0:25:54.705068,used: 5:59:36.695997,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_15_19_57_seed_1_21011734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9671653, 'precision': 0.7453605, 'recall': 0.846364, 'specificity': 0.846364, 'f1': 0.7862042, 'auroc': 0.963358, 'binary_precision': 0.50048405, 'binary_recall': 0.7170596, 'binary_specificity': 0.97566843, 'binary_f1_score': 0.5895097}
confusion matrix:
       0     1
0  41382  1032
1    408  1034
---- Validation: 
scalar performance:
{'acc': 0.964301, 'precision': 0.7444234, 'recall': 0.8091061, 'specificity': 0.8091061, 'f1': 0.77249503, 'auroc': 0.94989663, 'binary_precision': 0.5023256, 'binary_recall': 0.6419019, 'binary_specificity': 0.9763104, 'binary_f1_score': 0.5636008}
confusion matrix:
       0    1
0  17639  428
1    241  432
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96696746, 'precision': 0.80404174, 'recall': 0.75104916, 'specificity': 0.75104916, 'f1': 0.7747128, 'auroc': 0.93037784, 'binary_precision': 0.62910795, 'binary_recall': 0.5153846, 'binary_specificity': 0.98671377, 'binary_f1_score': 0.56659615}
confusion matrix:
      0    1
0  5867   79
1   126  134
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011734.png
early stop counter: 12
val acc:0.9643009901046753, best validation acc: 0.9661152362823486, corresponding to test acc:                         0.9743796586990356 / 0.9763132333755493
after epoch: 15,now: 2024-05-31 21:45:34.426696,epoch time: 0:25:59.729058,used: 6:25:36.425055,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_15_19_57_seed_1_21011734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9662532, 'precision': 0.74138016, 'recall': 0.86230516, 'specificity': 0.86230516, 'f1': 0.7882353, 'auroc': 0.9645518, 'binary_precision': 0.49137932, 'binary_recall': 0.7510402, 'binary_specificity': 0.97357005, 'binary_f1_score': 0.59407574}
confusion matrix:
       0     1
0  41293  1121
1    359  1083
---- Validation: 
scalar performance:
{'acc': 0.9626467, 'precision': 0.7372668, 'recall': 0.8347131, 'specificity': 0.8347131, 'f1': 0.7765597, 'auroc': 0.95450133, 'binary_precision': 0.48601037, 'binary_recall': 0.6968796, 'binary_specificity': 0.97254664, 'binary_f1_score': 0.5726496}
confusion matrix:
       0    1
0  17571  496
1    204  469
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97164035, 'precision': 0.8280146, 'recall': 0.8086574, 'specificity': 0.8086574, 'f1': 0.8180069, 'auroc': 0.94165826, 'binary_precision': 0.6721311, 'binary_recall': 0.63076925, 'binary_specificity': 0.98654556, 'binary_f1_score': 0.6507937}
confusion matrix:
      0    1
0  5866   80
1    96  164
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011734.png
early stop counter: 13
val acc:0.9626467227935791, best validation acc: 0.9661152362823486, corresponding to test acc:                         0.9743796586990356 / 0.9763132333755493
after epoch: 16,now: 2024-05-31 22:12:22.230710,epoch time: 0:26:47.804014,used: 6:52:24.229069,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_15_19_57_seed_1_21011734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.96659523, 'precision': 0.7428377, 'recall': 0.8571227, 'specificity': 0.8571227, 'f1': 0.78776264, 'auroc': 0.9656646, 'binary_precision': 0.4946685, 'binary_recall': 0.7399445, 'binary_specificity': 0.9743009, 'binary_f1_score': 0.5929425}
confusion matrix:
       0     1
0  41324  1090
1    375  1067
---- Validation: 
scalar performance:
{'acc': 0.9632337, 'precision': 0.74032533, 'recall': 0.8400244, 'specificity': 0.8400244, 'f1': 0.78045464, 'auroc': 0.9570104, 'binary_precision': 0.49173555, 'binary_recall': 0.7072808, 'binary_specificity': 0.972768, 'binary_f1_score': 0.5801341}
confusion matrix:
       0    1
0  17575  492
1    197  476
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9668063, 'precision': 0.8041503, 'recall': 0.7454481, 'specificity': 0.7454481, 'f1': 0.77129096, 'auroc': 0.94626886, 'binary_precision': 0.6298077, 'binary_recall': 0.50384617, 'binary_specificity': 0.9870501, 'binary_f1_score': 0.55982906}
confusion matrix:
      0    1
0  5869   77
1   129  131
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011734.png
early stop counter: 14
val acc:0.9632337093353271, best validation acc: 0.9661152362823486, corresponding to test acc:                         0.9743796586990356 / 0.9763132333755493
after epoch: 17,now: 2024-05-31 22:38:21.561076,epoch time: 0:25:59.330366,used: 7:18:23.559435,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_15_19_57_seed_1_21011734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9692174, 'precision': 0.75678575, 'recall': 0.861158, 'specificity': 0.861158, 'f1': 0.7991274, 'auroc': 0.96834147, 'binary_precision': 0.5223518, 'binary_recall': 0.7454924, 'binary_specificity': 0.9768237, 'binary_f1_score': 0.6142857}
confusion matrix:
       0     1
0  41431   983
1    367  1075
---- Validation: 
scalar performance:
{'acc': 0.9652081, 'precision': 0.750139, 'recall': 0.84247893, 'specificity': 0.84247893, 'f1': 0.7881758, 'auroc': 0.9553944, 'binary_precision': 0.51122993, 'binary_recall': 0.7102526, 'binary_specificity': 0.9747053, 'binary_f1_score': 0.59452736}
confusion matrix:
       0    1
0  17610  457
1    195  478
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96890104, 'precision': 0.8192921, 'recall': 0.76125324, 'specificity': 0.76125324, 'f1': 0.78703535, 'auroc': 0.9460062, 'binary_precision': 0.65876776, 'binary_recall': 0.5346154, 'binary_specificity': 0.987891, 'binary_f1_score': 0.5902335}
confusion matrix:
      0    1
0  5874   72
1   121  139
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011734.png
early stop counter: 15
val acc:0.965208113193512, best validation acc: 0.9661152362823486, corresponding to test acc:                         0.9743796586990356 / 0.9763132333755493
after epoch: 18,now: 2024-05-31 23:04:07.578088,epoch time: 0:25:46.017012,used: 7:44:09.576447,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_15_19_57_seed_1_21011734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9699699, 'precision': 0.76124597, 'recall': 0.84580433, 'specificity': 0.84580433, 'f1': 0.7969654, 'auroc': 0.97004664, 'binary_precision': 0.53236663, 'binary_recall': 0.71289873, 'binary_specificity': 0.9787099, 'binary_f1_score': 0.60954636}
confusion matrix:
       0     1
0  41511   903
1    414  1028
---- Validation: 
scalar performance:
{'acc': 0.96568835, 'precision': 0.7525491, 'recall': 0.83700585, 'specificity': 0.83700585, 'f1': 0.7879485, 'auroc': 0.95744824, 'binary_precision': 0.51648355, 'binary_recall': 0.6983655, 'binary_specificity': 0.9756462, 'binary_f1_score': 0.59380925}
confusion matrix:
       0    1
0  17627  440
1    203  470
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96745086, 'precision': 0.8281374, 'recall': 0.7053268, 'specificity': 0.7053268, 'f1': 0.7511015, 'auroc': 0.9579939, 'binary_precision': 0.68125, 'binary_recall': 0.41923076, 'binary_specificity': 0.99142283, 'binary_f1_score': 0.51904756}
confusion matrix:
      0    1
0  5895   51
1   151  109
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011734.png
early stop counter: 16
val acc:0.9656883478164673, best validation acc: 0.9661152362823486, corresponding to test acc:                         0.9743796586990356 / 0.9763132333755493
after epoch: 19,now: 2024-05-31 23:30:29.037547,epoch time: 0:26:21.459459,used: 8:10:31.035906,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_15_19_57_seed_1_21011734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9683282, 'precision': 0.7521635, 'recall': 0.8740964, 'specificity': 0.8740964, 'f1': 0.79983747, 'auroc': 0.9681219, 'binary_precision': 0.5121727, 'binary_recall': 0.7732316, 'binary_specificity': 0.9749611, 'binary_f1_score': 0.61619234}
confusion matrix:
       0     1
0  41352  1062
1    327  1115
---- Validation: 
scalar performance:
{'acc': 0.9635539, 'precision': 0.7426786, 'recall': 0.85807216, 'specificity': 0.85807216, 'f1': 0.787789, 'auroc': 0.956176, 'binary_precision': 0.49505928, 'binary_recall': 0.7444279, 'binary_specificity': 0.9717164, 'binary_f1_score': 0.5946588}
confusion matrix:
       0    1
0  17556  511
1    172  501
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9655172, 'precision': 0.8065288, 'recall': 0.69880074, 'specificity': 0.69880074, 'f1': 0.7398992, 'auroc': 0.9382211, 'binary_precision': 0.6385542, 'binary_recall': 0.4076923, 'binary_specificity': 0.9899092, 'binary_f1_score': 0.49765262}
confusion matrix:
      0    1
0  5886   60
1   154  106
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011734.png
early stop counter: 17
val acc:0.9635539054870605, best validation acc: 0.9661152362823486, corresponding to test acc:                         0.9743796586990356 / 0.9763132333755493
after epoch: 20,now: 2024-05-31 23:56:45.904501,epoch time: 0:26:16.866954,used: 8:36:47.902860,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_15_19_57_seed_1_21011734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9676669, 'precision': 0.7483976, 'recall': 0.8593515, 'specificity': 0.8593515, 'f1': 0.7925291, 'auroc': 0.9681431, 'binary_precision': 0.50566036, 'binary_recall': 0.7434119, 'binary_specificity': 0.9752912, 'binary_f1_score': 0.601909}
confusion matrix:
       0     1
0  41366  1048
1    370  1072
---- Validation: 
scalar performance:
{'acc': 0.9633938, 'precision': 0.74160546, 'recall': 0.85083646, 'specificity': 0.85083646, 'f1': 0.7847867, 'auroc': 0.9537256, 'binary_precision': 0.49346733, 'binary_recall': 0.7295691, 'binary_specificity': 0.97210383, 'binary_f1_score': 0.58872896}
confusion matrix:
       0    1
0  17563  504
1    182  491
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9655172, 'precision': 0.8080823, 'recall': 0.6951228, 'specificity': 0.6951228, 'f1': 0.7375214, 'auroc': 0.939421, 'binary_precision': 0.6419753, 'binary_recall': 0.4, 'binary_specificity': 0.9902455, 'binary_f1_score': 0.49289104}
confusion matrix:
      0    1
0  5888   58
1   156  104
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011734.png
early stop counter: 18
val acc:0.9633938074111938, best validation acc: 0.9661152362823486, corresponding to test acc:                         0.9743796586990356 / 0.9763132333755493
after epoch: 21,now: 2024-06-01 00:22:51.315471,epoch time: 0:26:05.410970,used: 9:02:53.313830,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_15_19_57_seed_1_21011734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.96714246, 'precision': 0.7460321, 'recall': 0.86912894, 'specificity': 0.86912894, 'f1': 0.7937614, 'auroc': 0.9689561, 'binary_precision': 0.500227, 'binary_recall': 0.76421636, 'binary_specificity': 0.9740416, 'binary_f1_score': 0.6046639}
confusion matrix:
       0     1
0  41313  1101
1    340  1102
---- Validation: 
scalar performance:
{'acc': 0.9641409, 'precision': 0.74513066, 'recall': 0.85122395, 'specificity': 0.85122395, 'f1': 0.78747743, 'auroc': 0.95995015, 'binary_precision': 0.5005097, 'binary_recall': 0.7295691, 'binary_specificity': 0.97287875, 'binary_f1_score': 0.5937122}
confusion matrix:
       0    1
0  17577  490
1    182  491
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9658395, 'precision': 0.80522263, 'recall': 0.7118418, 'specificity': 0.7118418, 'f1': 0.74913836, 'auroc': 0.9491424, 'binary_precision': 0.6348315, 'binary_recall': 0.43461537, 'binary_specificity': 0.98906827, 'binary_f1_score': 0.51598173}
confusion matrix:
      0    1
0  5881   65
1   147  113
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011734.png
early stop counter: 19
val acc:0.9641408920288086, best validation acc: 0.9661152362823486, corresponding to test acc:                         0.9743796586990356 / 0.9763132333755493
after epoch: 22,now: 2024-06-01 00:48:39.726663,epoch time: 0:25:48.411192,used: 9:28:41.725022,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_15_19_57_seed_1_21011734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.968237, 'precision': 0.75128424, 'recall': 0.8522773, 'specificity': 0.8522773, 'f1': 0.7923311, 'auroc': 0.96930057, 'binary_precision': 0.51194537, 'binary_recall': 0.7281553, 'binary_specificity': 0.9763993, 'binary_f1_score': 0.60120237}
confusion matrix:
       0     1
0  41413  1001
1    392  1050
---- Validation: 
scalar performance:
{'acc': 0.96510136, 'precision': 0.7495431, 'recall': 0.8402778, 'specificity': 0.8402778, 'f1': 0.78701997, 'auroc': 0.96173686, 'binary_precision': 0.5102041, 'binary_recall': 0.70579493, 'binary_specificity': 0.9747606, 'binary_f1_score': 0.59226936}
confusion matrix:
       0    1
0  17611  456
1    198  475
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9653561, 'precision': 0.81112593, 'recall': 0.6840048, 'specificity': 0.6840048, 'f1': 0.7294853, 'auroc': 0.95212615, 'binary_precision': 0.6490066, 'binary_recall': 0.37692308, 'binary_specificity': 0.9910864, 'binary_f1_score': 0.47688565}
confusion matrix:
      0   1
0  5893  53
1   162  98
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011734.png
early stop counter: 20
val acc:0.9651013612747192, best validation acc: 0.9661152362823486, corresponding to test acc:                         0.9743796586990356 / 0.9763132333755493
after epoch: 23,now: 2024-06-01 01:14:14.620862,epoch time: 0:25:34.894199,used: 9:54:16.619221,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_15_19_57_seed_1_21011734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.96898943, 'precision': 0.7554991, 'recall': 0.8573557, 'specificity': 0.8573557, 'f1': 0.79697216, 'auroc': 0.9669516, 'binary_precision': 0.5200391, 'binary_recall': 0.7378641, 'binary_specificity': 0.9768473, 'binary_f1_score': 0.61009175}
confusion matrix:
       0     1
0  41432   982
1    378  1064
---- Validation: 
scalar performance:
{'acc': 0.96360725, 'precision': 0.7415986, 'recall': 0.82877386, 'specificity': 0.82877386, 'f1': 0.77763665, 'auroc': 0.95544255, 'binary_precision': 0.49515608, 'binary_recall': 0.68350667, 'binary_specificity': 0.97404104, 'binary_f1_score': 0.5742821}
confusion matrix:
       0    1
0  17598  469
1    213  460
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9687399, 'precision': 0.8322243, 'recall': 0.72806734, 'specificity': 0.72806734, 'f1': 0.7694234, 'auroc': 0.94080794, 'binary_precision': 0.6875, 'binary_recall': 0.4653846, 'binary_specificity': 0.9907501, 'binary_f1_score': 0.5550459}
confusion matrix:
      0    1
0  5891   55
1   139  121
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011734.png
early stop counter: 21
val acc:0.9636072516441345, best validation acc: 0.9661152362823486, corresponding to test acc:                         0.9743796586990356 / 0.9763132333755493
after epoch: 24,now: 2024-06-01 01:40:00.412122,epoch time: 0:25:45.791260,used: 10:20:02.410481,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_15_19_57_seed_1_21011734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.96937704, 'precision': 0.7577702, 'recall': 0.89205617, 'specificity': 0.89205617, 'f1': 0.80938756, 'auroc': 0.97385406, 'binary_precision': 0.52214766, 'binary_recall': 0.8092927, 'binary_specificity': 0.97481966, 'binary_f1_score': 0.63475657}
confusion matrix:
       0     1
0  41346  1068
1    275  1167
---- Validation: 
scalar performance:
{'acc': 0.9648879, 'precision': 0.74909544, 'recall': 0.8637709, 'specificity': 0.8637709, 'f1': 0.79427636, 'auroc': 0.9622147, 'binary_precision': 0.5074925, 'binary_recall': 0.7548291, 'binary_specificity': 0.9727127, 'binary_f1_score': 0.6069295}
confusion matrix:
       0    1
0  17574  493
1    165  508
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96793425, 'precision': 0.8187041, 'recall': 0.7368418, 'specificity': 0.7368418, 'f1': 0.77106047, 'auroc': 0.9452135, 'binary_precision': 0.65968585, 'binary_recall': 0.4846154, 'binary_specificity': 0.98906827, 'binary_f1_score': 0.5587584}
confusion matrix:
      0    1
0  5881   65
1   134  126
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011734.png
early stop counter: 22
val acc:0.9648879170417786, best validation acc: 0.9661152362823486, corresponding to test acc:                         0.9743796586990356 / 0.9763132333755493
after epoch: 25,now: 2024-06-01 02:06:03.009467,epoch time: 0:26:02.597345,used: 10:46:05.007826,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_15_19_57_seed_1_21011734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9647711, 'precision': 0.7362167, 'recall': 0.8913496, 'specificity': 0.8913496, 'f1': 0.792147, 'auroc': 0.97217196, 'binary_precision': 0.4789538, 'binary_recall': 0.81276006, 'binary_specificity': 0.9699392, 'binary_f1_score': 0.6027257}
confusion matrix:
       0     1
0  41139  1275
1    270  1172
---- Validation: 
scalar performance:
{'acc': 0.9615795, 'precision': 0.7353308, 'recall': 0.8777909, 'specificity': 0.8777909, 'f1': 0.78766876, 'auroc': 0.95961106, 'binary_precision': 0.47877145, 'binary_recall': 0.78751856, 'binary_specificity': 0.9680633, 'binary_f1_score': 0.59550565}
confusion matrix:
       0    1
0  17490  577
1    143  530
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9709958, 'precision': 0.84189105, 'recall': 0.76050735, 'specificity': 0.76050735, 'f1': 0.79510397, 'auroc': 0.9422171, 'binary_precision': 0.70408165, 'binary_recall': 0.5307692, 'binary_specificity': 0.9902455, 'binary_f1_score': 0.6052632}
confusion matrix:
      0    1
0  5888   58
1   122  138
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011734.png
early stop counter: 23
val acc:0.9615795016288757, best validation acc: 0.9661152362823486, corresponding to test acc:                         0.9743796586990356 / 0.9763132333755493
after epoch: 26,now: 2024-06-01 02:32:06.153327,epoch time: 0:26:03.143860,used: 11:12:08.151686,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_15_19_57_seed_1_21011734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9688298, 'precision': 0.75476146, 'recall': 0.87268096, 'specificity': 0.87268096, 'f1': 0.80132604, 'auroc': 0.9729173, 'binary_precision': 0.5174825, 'binary_recall': 0.76976424, 'binary_specificity': 0.9755977, 'binary_f1_score': 0.6189016}
confusion matrix:
       0     1
0  41379  1035
1    332  1110
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.7447102, 'recall': 0.84690464, 'specificity': 0.84690464, 'f1': 0.78580195, 'auroc': 0.95822585, 'binary_precision': 0.5, 'binary_recall': 0.7206538, 'binary_specificity': 0.9731555, 'binary_f1_score': 0.5903834}
confusion matrix:
       0    1
0  17582  485
1    188  485
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96728975, 'precision': 0.8203527, 'recall': 0.7162766, 'specificity': 0.7162766, 'f1': 0.7571157, 'auroc': 0.93779707, 'binary_precision': 0.6647399, 'binary_recall': 0.44230768, 'binary_specificity': 0.9902455, 'binary_f1_score': 0.5311779}
confusion matrix:
      0    1
0  5888   58
1   145  115
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011734.png
early stop counter: 24
val acc:0.9640874862670898, best validation acc: 0.9661152362823486, corresponding to test acc:                         0.9743796586990356 / 0.9763132333755493
after epoch: 27,now: 2024-06-01 02:58:00.793995,epoch time: 0:25:54.640668,used: 11:38:02.792354,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_15_19_57_seed_1_21011734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9724325, 'precision': 0.7756432, 'recall': 0.8670896, 'specificity': 0.8670896, 'f1': 0.81414413, 'auroc': 0.9734338, 'binary_precision': 0.55973226, 'binary_recall': 0.75433725, 'binary_specificity': 0.97984207, 'binary_f1_score': 0.6426249}
confusion matrix:
       0     1
0  41560   855
1    354  1087
---- Validation: 
scalar performance:
{'acc': 0.9669691, 'precision': 0.75940686, 'recall': 0.8598434, 'specificity': 0.8598434, 'f1': 0.80043745, 'auroc': 0.9611911, 'binary_precision': 0.528481, 'binary_recall': 0.7444279, 'binary_specificity': 0.97525877, 'binary_f1_score': 0.61813694}
confusion matrix:
       0    1
0  17620  447
1    172  501
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96696746, 'precision': 0.8427665, 'recall': 0.67381173, 'specificity': 0.67381173, 'f1': 0.7279785, 'auroc': 0.9454003, 'binary_precision': 0.7131783, 'binary_recall': 0.35384616, 'binary_specificity': 0.99377733, 'binary_f1_score': 0.4730077}
confusion matrix:
      0   1
0  5909  37
1   168  92
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011734.png
better model found
persisted
after epoch: 28,now: 2024-06-01 03:24:30.782976,epoch time: 0:26:29.988981,used: 12:04:32.781335,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_15_19_57_seed_1_21011734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9686702, 'precision': 0.7538711, 'recall': 0.86891395, 'specificity': 0.86891395, 'f1': 0.79950583, 'auroc': 0.9723255, 'binary_precision': 0.5159624, 'binary_recall': 0.7621359, 'binary_specificity': 0.975692, 'binary_f1_score': 0.61534154}
confusion matrix:
       0     1
0  41383  1031
1    343  1099
---- Validation: 
scalar performance:
{'acc': 0.96451443, 'precision': 0.7474266, 'recall': 0.86643827, 'specificity': 0.86643827, 'f1': 0.79384786, 'auroc': 0.9596816, 'binary_precision': 0.503937, 'binary_recall': 0.76077265, 'binary_specificity': 0.97210383, 'binary_f1_score': 0.60627586}
confusion matrix:
       0    1
0  17563  504
1    161  512
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96793425, 'precision': 0.8382766, 'recall': 0.7000621, 'specificity': 0.7000621, 'f1': 0.7496165, 'auroc': 0.9394344, 'binary_precision': 0.70198673, 'binary_recall': 0.4076923, 'binary_specificity': 0.9924319, 'binary_f1_score': 0.5158151}
confusion matrix:
      0    1
0  5901   45
1   154  106
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011734.png
early stop counter: 1
val acc:0.964514434337616, best validation acc: 0.9669690728187561, corresponding to test acc:                         0.9669674634933472 / 0.9763132333755493
after epoch: 29,now: 2024-06-01 03:50:39.321615,epoch time: 0:26:08.538639,used: 12:30:41.319974,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_15_19_57_seed_1_21011734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9714748, 'precision': 0.7693455, 'recall': 0.88074744, 'specificity': 0.88074744, 'f1': 0.814417, 'auroc': 0.9748282, 'binary_precision': 0.54615754, 'binary_recall': 0.7836338, 'binary_specificity': 0.9778611, 'binary_f1_score': 0.64369124}
confusion matrix:
       0     1
0  41475   939
1    312  1130
---- Validation: 
scalar performance:
{'acc': 0.96766275, 'precision': 0.76300347, 'recall': 0.86592525, 'specificity': 0.86592525, 'f1': 0.8049731, 'auroc': 0.9636475, 'binary_precision': 0.5352261, 'binary_recall': 0.756315, 'binary_specificity': 0.9755355, 'binary_f1_score': 0.62684727}
confusion matrix:
       0    1
0  17625  442
1    164  509
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9629391, 'precision': 0.7817701, 'recall': 0.68274343, 'specificity': 0.68274343, 'f1': 0.7204524, 'auroc': 0.94203925, 'binary_precision': 0.5903614, 'binary_recall': 0.37692308, 'binary_specificity': 0.9885637, 'binary_f1_score': 0.4600939}
confusion matrix:
      0   1
0  5878  68
1   162  98
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011734.png
better model found
persisted
after epoch: 30,now: 2024-06-01 04:16:43.155806,epoch time: 0:26:03.834191,used: 12:56:45.154165,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_15_19_57_seed_1_21011734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 12:56:45.154165 at 2024-06-01 04:16:43.155806
persisted model performance metric: 

scalar performance:
{'acc': 0.96310025, 'precision': 0.7821485, 'recall': 0.6883445, 'specificity': 0.6883445, 'f1': 0.72478193, 'auroc': 0.93996096, 'binary_precision': 0.5906433, 'binary_recall': 0.38846153, 'binary_specificity': 0.98822737, 'binary_f1_score': 0.4686775}
confusion matrix:
      0    1
0  5876   70
1   159  101
oracle model performance metric: 

scalar performance:
{'acc': 0.97454077, 'precision': 0.8760836, 'recall': 0.7752303, 'specificity': 0.7752303, 'f1': 0.8170576, 'auroc': 0.92968893, 'binary_precision': 0.7712766, 'binary_recall': 0.5576923, 'binary_specificity': 0.9927682, 'binary_f1_score': 0.6473214}
confusion matrix:
      0    1
0  5903   43
1   115  145
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/rule_results/9.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/confusion_matrix/9.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 493647 KiB |  10997 MiB |   1816 TiB |   1816 TiB |
|       from large pool | 403840 KiB |  10925 MiB |   1810 TiB |   1810 TiB |
|       from small pool |  89807 KiB |    125 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 493647 KiB |  10997 MiB |   1816 TiB |   1816 TiB |
|       from large pool | 403840 KiB |  10925 MiB |   1810 TiB |   1810 TiB |
|       from small pool |  89807 KiB |    125 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476570 KiB |  10880 MiB |   1799 TiB |   1799 TiB |
|       from large pool | 387840 KiB |  10808 MiB |   1794 TiB |   1794 TiB |
|       from small pool |  88730 KiB |    124 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11460 MiB |  11482 MiB |  21726 MiB |  10266 MiB |
|       from large pool |  11336 MiB |  11356 MiB |  21574 MiB |  10238 MiB |
|       from small pool |    124 MiB |    126 MiB |    152 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 522160 KiB |   1325 MiB |    861 TiB |    861 TiB |
|       from large pool | 511616 KiB |   1322 MiB |    856 TiB |    856 TiB |
|       from small pool |  10544 KiB |     24 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3705    |    6728    |  279923 K  |  279919 K  |
|       from large pool |      87    |     908    |  113787 K  |  113787 K  |
|       from small pool |    3618    |    6639    |  166135 K  |  166131 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3705    |    6728    |  279923 K  |  279919 K  |
|       from large pool |      87    |     908    |  113787 K  |  113787 K  |
|       from small pool |    3618    |    6639    |  166135 K  |  166131 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     399    |     404    |     724    |     325    |
|       from large pool |     337    |     341    |     648    |     311    |
|       from small pool |      62    |      63    |      76    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      71    |    2772    |  150137 K  |  150137 K  |
|       from large pool |      20    |     187    |   69937 K  |   69937 K  |
|       from small pool |      51    |    2751    |   80199 K  |   80199 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10997 MiB |   1816 TiB |   1816 TiB |
|       from large pool |  16640 KiB |  10925 MiB |   1810 TiB |   1810 TiB |
|       from small pool |      0 KiB |    125 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10997 MiB |   1816 TiB |   1816 TiB |
|       from large pool |  16640 KiB |  10925 MiB |   1810 TiB |   1810 TiB |
|       from small pool |      0 KiB |    125 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10880 MiB |   1799 TiB |   1799 TiB |
|       from large pool |  16640 KiB |  10808 MiB |   1794 TiB |   1794 TiB |
|       from small pool |      0 KiB |    124 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    992 MiB |  11482 MiB |  21726 MiB |  20734 MiB |
|       from large pool |    894 MiB |  11356 MiB |  21574 MiB |  20680 MiB |
|       from small pool |     98 MiB |    126 MiB |    152 MiB |     54 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1325 MiB |    861 TiB |    861 TiB |
|       from large pool |  50944 KiB |   1322 MiB |    856 TiB |    856 TiB |
|       from small pool |      0 KiB |     24 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6728    |  279923 K  |  279923 K  |
|       from large pool |       2    |     908    |  113787 K  |  113787 K  |
|       from small pool |       0    |    6639    |  166135 K  |  166135 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6728    |  279923 K  |  279923 K  |
|       from large pool |       2    |     908    |  113787 K  |  113787 K  |
|       from small pool |       0    |    6639    |  166135 K  |  166135 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      82    |     404    |     724    |     642    |
|       from large pool |      33    |     341    |     648    |     615    |
|       from small pool |      49    |      63    |      76    |      27    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2772    |  150138 K  |  150138 K  |
|       from large pool |       4    |     187    |   69937 K  |   69937 K  |
|       from small pool |       0    |    2751    |   80201 K  |   80201 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10997 MiB |   1816 TiB |   1816 TiB |
|       from large pool |  16640 KiB |  10925 MiB |   1810 TiB |   1810 TiB |
|       from small pool |      0 KiB |    125 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10997 MiB |   1816 TiB |   1816 TiB |
|       from large pool |  16640 KiB |  10925 MiB |   1810 TiB |   1810 TiB |
|       from small pool |      0 KiB |    125 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10880 MiB |   1799 TiB |   1799 TiB |
|       from large pool |  16640 KiB |  10808 MiB |   1794 TiB |   1794 TiB |
|       from small pool |      0 KiB |    124 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    992 MiB |  11482 MiB |  21726 MiB |  20734 MiB |
|       from large pool |    894 MiB |  11356 MiB |  21574 MiB |  20680 MiB |
|       from small pool |     98 MiB |    126 MiB |    152 MiB |     54 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1325 MiB |    861 TiB |    861 TiB |
|       from large pool |  50944 KiB |   1322 MiB |    856 TiB |    856 TiB |
|       from small pool |      0 KiB |     24 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6728    |  279923 K  |  279923 K  |
|       from large pool |       2    |     908    |  113787 K  |  113787 K  |
|       from small pool |       0    |    6639    |  166135 K  |  166135 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6728    |  279923 K  |  279923 K  |
|       from large pool |       2    |     908    |  113787 K  |  113787 K  |
|       from small pool |       0    |    6639    |  166135 K  |  166135 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      82    |     404    |     724    |     642    |
|       from large pool |      33    |     341    |     648    |     615    |
|       from small pool |      49    |      63    |      76    |      27    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2772    |  150138 K  |  150138 K  |
|       from large pool |       4    |     187    |   69937 K  |   69937 K  |
|       from small pool |       0    |    2751    |   80201 K  |   80201 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_04_29_16_seed_2_21011734

 Experiment start at: 2024-06-01 04:29:16.617415
before training, model accuracy: 0.04888604208827019
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9654071, 'precision': 0.7002342, 'recall': 0.50315106, 'specificity': 0.50315106, 'f1': 0.4977079, 'auroc': 0.896752, 'binary_precision': 0.4347826, 'binary_recall': 0.0066093854, 'binary_specificity': 0.99969274, 'binary_f1_score': 0.013020833}
confusion matrix:
       0   1
0  42298  13
1   1503  10
---- Validation: 
scalar performance:
{'acc': 0.96777284, 'precision': 0.71293473, 'recall': 0.51276624, 'specificity': 0.51276624, 'f1': 0.51692194, 'auroc': 0.9026644, 'binary_precision': 0.45714286, 'binary_recall': 0.026578072, 'binary_specificity': 0.99895436, 'binary_f1_score': 0.050235476}
confusion matrix:
       0   1
0  18152  19
1    586  16
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96297485, 'precision': 0.94306755, 'recall': 0.52471, 'specificity': 0.52471, 'f1': 0.5376094, 'auroc': 0.8830062, 'binary_precision': 0.9230769, 'binary_recall': 0.049586777, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.09411765}
confusion matrix:
      0   1
0  5996   1
1   230  12
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011734.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-01 04:56:43.521863,epoch time: 0:27:26.904448,used: 0:27:26.904448,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_04_29_16_seed_2_21011734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.965293, 'precision': 0.7310741, 'recall': 0.5747887, 'specificity': 0.5747887, 'f1': 0.6091527, 'auroc': 0.92332673, 'binary_precision': 0.4916318, 'binary_recall': 0.15532055, 'binary_specificity': 0.9942568, 'binary_f1_score': 0.23606227}
confusion matrix:
       0    1
0  42068  243
1   1278  235
---- Validation: 
scalar performance:
{'acc': 0.9671869, 'precision': 0.7254873, 'recall': 0.6112385, 'specificity': 0.6112385, 'f1': 0.6470776, 'auroc': 0.91833895, 'binary_precision': 0.4760274, 'binary_recall': 0.23089701, 'binary_specificity': 0.99158, 'binary_f1_score': 0.31096196}
confusion matrix:
       0    1
0  18018  153
1    463  139
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97323287, 'precision': 0.91618145, 'recall': 0.6846998, 'specificity': 0.6846998, 'f1': 0.7524828, 'auroc': 0.90567803, 'binary_precision': 0.85714287, 'binary_recall': 0.37190083, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.51873195}
confusion matrix:
      0   1
0  5982  15
1   152  90
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011734.png
new oracle model saved
early stop counter: 1
val acc:0.9671869277954102, best validation acc: 0.9677728414535522, corresponding to test acc:                         0.9629748463630676 / 0.9732328653335571
after epoch: 2,now: 2024-06-01 05:22:39.597198,epoch time: 0:25:56.075335,used: 0:53:22.979783,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_04_29_16_seed_2_21011734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96547556, 'precision': 0.7365924, 'recall': 0.6137588, 'specificity': 0.6137588, 'f1': 0.6514492, 'auroc': 0.93532515, 'binary_precision': 0.5, 'binary_recall': 0.23595506, 'binary_specificity': 0.9915625, 'binary_f1_score': 0.3206107}
confusion matrix:
       0    1
0  41954  357
1   1156  357
---- Validation: 
scalar performance:
{'acc': 0.9685719, 'precision': 0.74703693, 'recall': 0.6496972, 'specificity': 0.6496972, 'f1': 0.68528354, 'auroc': 0.92403066, 'binary_precision': 0.51666665, 'binary_recall': 0.3089701, 'binary_specificity': 0.9904243, 'binary_f1_score': 0.38669437}
confusion matrix:
       0    1
0  17997  174
1    416  186
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97804135, 'precision': 0.9144784, 'recall': 0.76254517, 'specificity': 0.76254517, 'f1': 0.8200316, 'auroc': 0.9112745, 'binary_precision': 0.8476821, 'binary_recall': 0.5289256, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.6513995}
confusion matrix:
      0    1
0  5974   23
1   114  128
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011734.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-01 05:48:29.615673,epoch time: 0:25:50.018475,used: 1:19:12.998258,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_04_29_16_seed_2_21011734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9659547, 'precision': 0.7442949, 'recall': 0.72680974, 'specificity': 0.72680974, 'f1': 0.7351905, 'auroc': 0.9410581, 'binary_precision': 0.5074946, 'binary_recall': 0.4699273, 'binary_specificity': 0.98369217, 'binary_f1_score': 0.48798904}
confusion matrix:
       0    1
0  41621  690
1    802  711
---- Validation: 
scalar performance:
{'acc': 0.96713364, 'precision': 0.7355865, 'recall': 0.74050176, 'specificity': 0.74050176, 'f1': 0.73801595, 'auroc': 0.93771905, 'binary_precision': 0.4878049, 'binary_recall': 0.49833888, 'binary_specificity': 0.9826647, 'binary_f1_score': 0.49301562}
confusion matrix:
       0    1
0  17856  315
1    302  300
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97884274, 'precision': 0.87901586, 'recall': 0.8184788, 'specificity': 0.8184788, 'f1': 0.84586686, 'auroc': 0.9307519, 'binary_precision': 0.77227724, 'binary_recall': 0.6446281, 'binary_specificity': 0.9923295, 'binary_f1_score': 0.7027027}
confusion matrix:
      0    1
0  5951   46
1    86  156
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011734.png
new oracle model saved
early stop counter: 1
val acc:0.967133641242981, best validation acc: 0.9685719013214111, corresponding to test acc:                         0.9780413508415222 / 0.9788427352905273
after epoch: 4,now: 2024-06-01 06:14:26.521083,epoch time: 0:25:56.905410,used: 1:45:09.903668,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_04_29_16_seed_2_21011734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9661829, 'precision': 0.74686396, 'recall': 0.7756817, 'specificity': 0.7756817, 'f1': 0.76038325, 'auroc': 0.944294, 'binary_precision': 0.50913376, 'binary_recall': 0.5710509, 'binary_specificity': 0.98031247, 'binary_f1_score': 0.53831774}
confusion matrix:
       0    1
0  41478  833
1    649  864
---- Validation: 
scalar performance:
{'acc': 0.96622807, 'precision': 0.73424613, 'recall': 0.8123084, 'specificity': 0.8123084, 'f1': 0.7670399, 'auroc': 0.93952155, 'binary_precision': 0.48029557, 'binary_recall': 0.64784056, 'binary_specificity': 0.9767762, 'binary_f1_score': 0.5516266}
confusion matrix:
       0    1
0  17749  422
1    212  390
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9790031, 'precision': 0.88358057, 'recall': 0.81459665, 'specificity': 0.81459665, 'f1': 0.8453566, 'auroc': 0.9387443, 'binary_precision': 0.7817259, 'binary_recall': 0.6363636, 'binary_specificity': 0.99282974, 'binary_f1_score': 0.70159453}
confusion matrix:
      0    1
0  5954   43
1    88  154
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011734.png
new oracle model saved
early stop counter: 2
val acc:0.9662280678749084, best validation acc: 0.9685719013214111, corresponding to test acc:                         0.9780413508415222 / 0.9790030717849731
after epoch: 5,now: 2024-06-01 06:40:31.038482,epoch time: 0:26:04.517399,used: 2:11:14.421067,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_04_29_16_seed_2_21011734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9672326, 'precision': 0.7538688, 'recall': 0.7943884, 'specificity': 0.7943884, 'f1': 0.7724539, 'auroc': 0.9494669, 'binary_precision': 0.52181304, 'binary_recall': 0.6087244, 'binary_specificity': 0.9800525, 'binary_f1_score': 0.561928}
confusion matrix:
       0    1
0  41467  844
1    592  921
---- Validation: 
scalar performance:
{'acc': 0.9678794, 'precision': 0.74353683, 'recall': 0.80593395, 'specificity': 0.80593395, 'f1': 0.7707878, 'auroc': 0.94467413, 'binary_precision': 0.4993447, 'binary_recall': 0.63289034, 'binary_specificity': 0.9789775, 'binary_f1_score': 0.5582418}
confusion matrix:
       0    1
0  17789  382
1    221  381
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9807662, 'precision': 0.88638234, 'recall': 0.8432722, 'specificity': 0.8432722, 'f1': 0.8634302, 'auroc': 0.9457642, 'binary_precision': 0.78504676, 'binary_recall': 0.6942149, 'binary_specificity': 0.9923295, 'binary_f1_score': 0.7368421}
confusion matrix:
      0    1
0  5951   46
1    74  168
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011734.png
new oracle model saved
early stop counter: 3
val acc:0.9678794145584106, best validation acc: 0.9685719013214111, corresponding to test acc:                         0.9780413508415222 / 0.9807661771774292
after epoch: 6,now: 2024-06-01 07:06:44.431064,epoch time: 0:26:13.392582,used: 2:37:27.813649,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_04_29_16_seed_2_21011734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96670777, 'precision': 0.75061095, 'recall': 0.8036762, 'specificity': 0.8036762, 'f1': 0.7742966, 'auroc': 0.9509576, 'binary_precision': 0.5146104, 'binary_recall': 0.62855256, 'binary_specificity': 0.9787998, 'binary_f1_score': 0.565903}
confusion matrix:
       0    1
0  41414  897
1    562  951
---- Validation: 
scalar performance:
{'acc': 0.96660095, 'precision': 0.7361969, 'recall': 0.81009185, 'specificity': 0.81009185, 'f1': 0.76755786, 'auroc': 0.9470867, 'binary_precision': 0.48435545, 'binary_recall': 0.64285713, 'binary_specificity': 0.9773265, 'binary_f1_score': 0.5524626}
confusion matrix:
       0    1
0  17759  412
1    215  387
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97884274, 'precision': 0.8729972, 'recall': 0.8283925, 'specificity': 0.8283925, 'f1': 0.8491366, 'auroc': 0.9348154, 'binary_precision': 0.759434, 'binary_recall': 0.6652893, 'binary_specificity': 0.9914957, 'binary_f1_score': 0.70925117}
confusion matrix:
      0    1
0  5946   51
1    81  161
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011734.png
early stop counter: 4
val acc:0.9666009545326233, best validation acc: 0.9685719013214111, corresponding to test acc:                         0.9780413508415222 / 0.9807661771774292
after epoch: 7,now: 2024-06-01 07:32:49.013635,epoch time: 0:26:04.582571,used: 3:03:32.396220,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_04_29_16_seed_2_21011734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9660232, 'precision': 0.74774384, 'recall': 0.8488889, 'specificity': 0.8488889, 'f1': 0.788659, 'auroc': 0.952253, 'binary_precision': 0.50554526, 'binary_recall': 0.72306675, 'binary_specificity': 0.97471106, 'binary_f1_score': 0.59505033}
confusion matrix:
       0     1
0  41241  1070
1    419  1094
---- Validation: 
scalar performance:
{'acc': 0.96564215, 'precision': 0.7320142, 'recall': 0.8256575, 'specificity': 0.8256575, 'f1': 0.77002144, 'auroc': 0.9471824, 'binary_precision': 0.4749125, 'binary_recall': 0.67607975, 'binary_specificity': 0.9752353, 'binary_f1_score': 0.5579164}
confusion matrix:
       0    1
0  17721  450
1    195  407
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97884274, 'precision': 0.8607783, 'recall': 0.85218537, 'specificity': 0.85218537, 'f1': 0.8564247, 'auroc': 0.9338591, 'binary_precision': 0.7330508, 'binary_recall': 0.71487606, 'binary_specificity': 0.98949474, 'binary_f1_score': 0.72384936}
confusion matrix:
      0    1
0  5934   63
1    69  173
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011734.png
early stop counter: 5
val acc:0.9656421542167664, best validation acc: 0.9685719013214111, corresponding to test acc:                         0.9780413508415222 / 0.9807661771774292
after epoch: 8,now: 2024-06-01 07:58:52.289629,epoch time: 0:26:03.275994,used: 3:29:35.672214,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_04_29_16_seed_2_21011734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.96547556, 'precision': 0.7446979, 'recall': 0.8412763, 'specificity': 0.8412763, 'f1': 0.7840165, 'auroc': 0.9554783, 'binary_precision': 0.5, 'binary_recall': 0.7078652, 'binary_specificity': 0.97468746, 'binary_f1_score': 0.58604646}
confusion matrix:
       0     1
0  41240  1071
1    442  1071
---- Validation: 
scalar performance:
{'acc': 0.9650562, 'precision': 0.72956365, 'recall': 0.83258224, 'specificity': 0.83258224, 'f1': 0.7704734, 'auroc': 0.9498925, 'binary_precision': 0.46952596, 'binary_recall': 0.6910299, 'binary_specificity': 0.9741346, 'binary_f1_score': 0.5591398}
confusion matrix:
       0    1
0  17701  470
1    186  416
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97547686, 'precision': 0.83522624, 'recall': 0.83655536, 'specificity': 0.83655536, 'f1': 0.83588934, 'auroc': 0.93888545, 'binary_precision': 0.6831276, 'binary_recall': 0.6859504, 'binary_specificity': 0.98716027, 'binary_f1_score': 0.6845361}
confusion matrix:
      0    1
0  5920   77
1    76  166
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011734.png
early stop counter: 6
val acc:0.9650561809539795, best validation acc: 0.9685719013214111, corresponding to test acc:                         0.9780413508415222 / 0.9807661771774292
after epoch: 9,now: 2024-06-01 08:24:57.284730,epoch time: 0:26:04.995101,used: 3:55:40.667315,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_04_29_16_seed_2_21011734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9689211, 'precision': 0.7643479, 'recall': 0.8191618, 'specificity': 0.8191618, 'f1': 0.78888, 'auroc': 0.9587921, 'binary_precision': 0.5410103, 'binary_recall': 0.6582948, 'binary_specificity': 0.9800288, 'binary_f1_score': 0.5939177}
confusion matrix:
       0    1
0  41466  845
1    517  996
---- Validation: 
scalar performance:
{'acc': 0.96660095, 'precision': 0.73684245, 'recall': 0.8213345, 'specificity': 0.8213345, 'f1': 0.7719357, 'auroc': 0.9530737, 'binary_precision': 0.48488513, 'binary_recall': 0.66611296, 'binary_specificity': 0.97655606, 'binary_f1_score': 0.5612316}
confusion matrix:
       0    1
0  17745  426
1    201  401
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97611797, 'precision': 0.85999316, 'recall': 0.79525125, 'specificity': 0.79525125, 'f1': 0.8241079, 'auroc': 0.9317014, 'binary_precision': 0.7360406, 'binary_recall': 0.59917355, 'binary_specificity': 0.991329, 'binary_f1_score': 0.66059226}
confusion matrix:
      0    1
0  5945   52
1    97  145
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011734.png
early stop counter: 7
val acc:0.9666009545326233, best validation acc: 0.9685719013214111, corresponding to test acc:                         0.9780413508415222 / 0.9807661771774292
after epoch: 10,now: 2024-06-01 08:50:50.288353,epoch time: 0:25:53.003623,used: 4:21:33.670938,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_04_29_16_seed_2_21011734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96353596, 'precision': 0.7366715, 'recall': 0.864808, 'specificity': 0.864808, 'f1': 0.78527266, 'auroc': 0.95867985, 'binary_precision': 0.48215035, 'binary_recall': 0.7587574, 'binary_specificity': 0.97085863, 'binary_f1_score': 0.58962506}
confusion matrix:
       0     1
0  41078  1233
1    365  1148
---- Validation: 
scalar performance:
{'acc': 0.9627657, 'precision': 0.7203123, 'recall': 0.84746003, 'specificity': 0.84746003, 'f1': 0.7678151, 'auroc': 0.9504629, 'binary_precision': 0.4499484, 'binary_recall': 0.72425246, 'binary_specificity': 0.97066754, 'binary_f1_score': 0.55506045}
confusion matrix:
       0    1
0  17638  533
1    166  436
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9735535, 'precision': 0.81913996, 'recall': 0.83555484, 'specificity': 0.83555484, 'f1': 0.82711816, 'auroc': 0.93750334, 'binary_precision': 0.6509804, 'binary_recall': 0.6859504, 'binary_specificity': 0.9851592, 'binary_f1_score': 0.6680081}
confusion matrix:
      0    1
0  5908   89
1    76  166
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011734.png
early stop counter: 8
val acc:0.9627656936645508, best validation acc: 0.9685719013214111, corresponding to test acc:                         0.9780413508415222 / 0.9807661771774292
after epoch: 11,now: 2024-06-01 09:16:35.475576,epoch time: 0:25:45.187223,used: 4:47:18.858161,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_04_29_16_seed_2_21011734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.96791714, 'precision': 0.75793886, 'recall': 0.8282014, 'specificity': 0.8282014, 'f1': 0.78835315, 'auroc': 0.9613373, 'binary_precision': 0.5275064, 'binary_recall': 0.67812294, 'binary_specificity': 0.9782799, 'binary_f1_score': 0.5934066}
confusion matrix:
       0     1
0  41392   919
1    487  1026
---- Validation: 
scalar performance:
{'acc': 0.96478987, 'precision': 0.7280505, 'recall': 0.83003557, 'specificity': 0.83003557, 'f1': 0.7685749, 'auroc': 0.95212024, 'binary_precision': 0.46666667, 'binary_recall': 0.68604654, 'binary_specificity': 0.97402453, 'binary_f1_score': 0.55548084}
confusion matrix:
       0    1
0  17699  472
1    189  413
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9746754, 'precision': 0.8448219, 'recall': 0.79251814, 'specificity': 0.79251814, 'f1': 0.81630415, 'auroc': 0.9381647, 'binary_precision': 0.7058824, 'binary_recall': 0.59504133, 'binary_specificity': 0.989995, 'binary_f1_score': 0.6457399}
confusion matrix:
      0    1
0  5937   60
1    98  144
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011734.png
early stop counter: 9
val acc:0.964789867401123, best validation acc: 0.9685719013214111, corresponding to test acc:                         0.9780413508415222 / 0.9807661771774292
after epoch: 12,now: 2024-06-01 09:42:20.942615,epoch time: 0:25:45.467039,used: 5:13:04.325200,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_04_29_16_seed_2_21011734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9654983, 'precision': 0.7457731, 'recall': 0.8674176, 'specificity': 0.8674176, 'f1': 0.7929723, 'auroc': 0.9634241, 'binary_precision': 0.5002169, 'binary_recall': 0.76206213, 'binary_specificity': 0.972773, 'binary_f1_score': 0.60398114}
confusion matrix:
       0     1
0  41159  1152
1    360  1153
---- Validation: 
scalar performance:
{'acc': 0.9634049, 'precision': 0.72335744, 'recall': 0.85019934, 'specificity': 0.85019934, 'f1': 0.7709645, 'auroc': 0.9548311, 'binary_precision': 0.45586708, 'binary_recall': 0.7292359, 'binary_specificity': 0.97116286, 'binary_f1_score': 0.56102234}
confusion matrix:
       0    1
0  17647  524
1    163  439
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97275203, 'precision': 0.81676465, 'recall': 0.81927603, 'specificity': 0.81927603, 'f1': 0.8180148, 'auroc': 0.9361024, 'binary_precision': 0.647541, 'binary_recall': 0.6528926, 'binary_specificity': 0.9856595, 'binary_f1_score': 0.65020573}
confusion matrix:
      0    1
0  5911   86
1    84  158
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011734.png
early stop counter: 10
val acc:0.9634048938751221, best validation acc: 0.9685719013214111, corresponding to test acc:                         0.9780413508415222 / 0.9807661771774292
after epoch: 13,now: 2024-06-01 10:08:15.449116,epoch time: 0:25:54.506501,used: 5:38:58.831701,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_04_29_16_seed_2_21011734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96668494, 'precision': 0.75133294, 'recall': 0.8571979, 'specificity': 0.8571979, 'f1': 0.7939004, 'auroc': 0.96447086, 'binary_precision': 0.5121282, 'binary_recall': 0.7395902, 'binary_specificity': 0.9748056, 'binary_f1_score': 0.605192}
confusion matrix:
       0     1
0  41245  1066
1    394  1119
---- Validation: 
scalar performance:
{'acc': 0.9650562, 'precision': 0.7321507, 'recall': 0.8679164, 'specificity': 0.8679164, 'f1': 0.7827594, 'auroc': 0.9559792, 'binary_precision': 0.47227925, 'binary_recall': 0.7641196, 'binary_specificity': 0.9717132, 'binary_f1_score': 0.5837563}
confusion matrix:
       0    1
0  17657  514
1    142  460
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9765988, 'precision': 0.8423556, 'recall': 0.8450699, 'specificity': 0.8450699, 'f1': 0.84370685, 'auroc': 0.949205, 'binary_precision': 0.6967213, 'binary_recall': 0.70247936, 'binary_specificity': 0.98766047, 'binary_f1_score': 0.6995885}
confusion matrix:
      0    1
0  5923   74
1    72  170
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011734.png
early stop counter: 11
val acc:0.9650561809539795, best validation acc: 0.9685719013214111, corresponding to test acc:                         0.9780413508415222 / 0.9807661771774292
after epoch: 14,now: 2024-06-01 10:34:17.243695,epoch time: 0:26:01.794579,used: 6:05:00.626280,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_04_29_16_seed_2_21011734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9679399, 'precision': 0.7579761, 'recall': 0.8451018, 'specificity': 0.8451018, 'f1': 0.7944801, 'auroc': 0.964259, 'binary_precision': 0.52634144, 'binary_recall': 0.71315265, 'binary_specificity': 0.9770509, 'binary_f1_score': 0.6056694}
confusion matrix:
       0     1
0  41340   971
1    434  1079
---- Validation: 
scalar performance:
{'acc': 0.96580195, 'precision': 0.73499936, 'recall': 0.858665, 'specificity': 0.858665, 'f1': 0.7823727, 'auroc': 0.9584519, 'binary_precision': 0.47863248, 'binary_recall': 0.74418604, 'binary_specificity': 0.973144, 'binary_f1_score': 0.5825748}
confusion matrix:
       0    1
0  17683  488
1    154  448
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97804135, 'precision': 0.87966335, 'recall': 0.80219996, 'specificity': 0.80219996, 'f1': 0.8361144, 'auroc': 0.9438822, 'binary_precision': 0.7748691, 'binary_recall': 0.61157024, 'binary_specificity': 0.99282974, 'binary_f1_score': 0.68360275}
confusion matrix:
      0    1
0  5954   43
1    94  148
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011734.png
early stop counter: 12
val acc:0.9658019542694092, best validation acc: 0.9685719013214111, corresponding to test acc:                         0.9780413508415222 / 0.9807661771774292
after epoch: 15,now: 2024-06-01 11:00:12.824061,epoch time: 0:25:55.580366,used: 6:30:56.206646,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_04_29_16_seed_2_21011734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.96905804, 'precision': 0.7646016, 'recall': 0.83898914, 'specificity': 0.83898914, 'f1': 0.796669, 'auroc': 0.9669319, 'binary_precision': 0.5400715, 'binary_recall': 0.699273, 'binary_specificity': 0.9787053, 'binary_f1_score': 0.60944706}
confusion matrix:
       0     1
0  41410   901
1    455  1058
---- Validation: 
scalar performance:
{'acc': 0.96660095, 'precision': 0.73729354, 'recall': 0.829365, 'specificity': 0.829365, 'f1': 0.77495897, 'auroc': 0.9587036, 'binary_precision': 0.48524204, 'binary_recall': 0.68272424, 'binary_specificity': 0.97600573, 'binary_f1_score': 0.5672878}
confusion matrix:
       0    1
0  17735  436
1    191  411
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9722712, 'precision': 0.831931, 'recall': 0.76152647, 'specificity': 0.76152647, 'f1': 0.79212373, 'auroc': 0.9465091, 'binary_precision': 0.6825397, 'binary_recall': 0.53305787, 'binary_specificity': 0.989995, 'binary_f1_score': 0.5986079}
confusion matrix:
      0    1
0  5937   60
1   113  129
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011734.png
early stop counter: 13
val acc:0.9666009545326233, best validation acc: 0.9685719013214111, corresponding to test acc:                         0.9780413508415222 / 0.9807661771774292
after epoch: 16,now: 2024-06-01 11:26:03.745553,epoch time: 0:25:50.921492,used: 6:56:47.128138,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_04_29_16_seed_2_21011734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9675064, 'precision': 0.75580025, 'recall': 0.87801707, 'specificity': 0.87801707, 'f1': 0.8036467, 'auroc': 0.9673524, 'binary_precision': 0.51954323, 'binary_recall': 0.7818903, 'binary_specificity': 0.97414386, 'binary_f1_score': 0.6242744}
confusion matrix:
       0     1
0  41217  1094
1    330  1183
---- Validation: 
scalar performance:
{'acc': 0.9639376, 'precision': 0.72774625, 'recall': 0.87456596, 'specificity': 0.87456596, 'f1': 0.78098166, 'auroc': 0.9569975, 'binary_precision': 0.46298125, 'binary_recall': 0.7790698, 'binary_specificity': 0.9700622, 'binary_f1_score': 0.580805}
confusion matrix:
       0    1
0  17627  544
1    133  469
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9729123, 'precision': 0.8186405, 'recall': 0.8173766, 'specificity': 0.8173766, 'f1': 0.8180072, 'auroc': 0.9460746, 'binary_precision': 0.6514523, 'binary_recall': 0.6487603, 'binary_specificity': 0.98599297, 'binary_f1_score': 0.6501035}
confusion matrix:
      0    1
0  5913   84
1    85  157
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011734.png
early stop counter: 14
val acc:0.9639375805854797, best validation acc: 0.9685719013214111, corresponding to test acc:                         0.9780413508415222 / 0.9807661771774292
after epoch: 17,now: 2024-06-01 11:52:09.192872,epoch time: 0:26:05.447319,used: 7:22:52.575457,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_04_29_16_seed_2_21011734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9647682, 'precision': 0.74350864, 'recall': 0.89253163, 'specificity': 0.89253163, 'f1': 0.79825103, 'auroc': 0.96529, 'binary_precision': 0.49379256, 'binary_recall': 0.81493723, 'binary_specificity': 0.970126, 'binary_f1_score': 0.61496264}
confusion matrix:
       0     1
0  41047  1264
1    280  1233
---- Validation: 
scalar performance:
{'acc': 0.9620732, 'precision': 0.7213056, 'recall': 0.8872547, 'specificity': 0.8872547, 'f1': 0.7786716, 'auroc': 0.9571974, 'binary_precision': 0.4491682, 'binary_recall': 0.807309, 'binary_specificity': 0.96720046, 'binary_f1_score': 0.5771972}
confusion matrix:
       0    1
0  17575  596
1    116  486
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97146976, 'precision': 0.8086953, 'recall': 0.8086953, 'specificity': 0.8086953, 'f1': 0.8086953, 'auroc': 0.94145006, 'binary_precision': 0.6322314, 'binary_recall': 0.6322314, 'binary_specificity': 0.9851592, 'binary_f1_score': 0.6322314}
confusion matrix:
      0    1
0  5908   89
1    89  153
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011734.png
early stop counter: 15
val acc:0.9620732069015503, best validation acc: 0.9685719013214111, corresponding to test acc:                         0.9780413508415222 / 0.9807661771774292
after epoch: 18,now: 2024-06-01 12:17:56.556406,epoch time: 0:25:47.363534,used: 7:48:39.938991,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_04_29_16_seed_2_21011734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9668903, 'precision': 0.7526529, 'recall': 0.8722809, 'specificity': 0.8722809, 'f1': 0.7995702, 'auroc': 0.96801114, 'binary_precision': 0.5136564, 'binary_recall': 0.7706543, 'binary_specificity': 0.9739075, 'binary_f1_score': 0.61644197}
confusion matrix:
       0     1
0  41207  1104
1    347  1166
---- Validation: 
scalar performance:
{'acc': 0.9634049, 'precision': 0.724999, 'recall': 0.8686695, 'specificity': 0.8686695, 'f1': 0.7772194, 'auroc': 0.95909274, 'binary_precision': 0.4578791, 'binary_recall': 0.76744187, 'binary_specificity': 0.9698971, 'binary_f1_score': 0.5735568}
confusion matrix:
       0    1
0  17624  547
1    140  462
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9717904, 'precision': 0.81994647, 'recall': 0.779121, 'specificity': 0.779121, 'f1': 0.7979922, 'auroc': 0.9385819, 'binary_precision': 0.6571429, 'binary_recall': 0.57024795, 'binary_specificity': 0.987994, 'binary_f1_score': 0.6106195}
confusion matrix:
      0    1
0  5925   72
1   104  138
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011734.png
early stop counter: 16
val acc:0.9634048938751221, best validation acc: 0.9685719013214111, corresponding to test acc:                         0.9780413508415222 / 0.9807661771774292
after epoch: 19,now: 2024-06-01 12:43:54.952941,epoch time: 0:25:58.396535,used: 8:14:38.335526,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_04_29_16_seed_2_21011734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9650648, 'precision': 0.7442115, 'recall': 0.8786645, 'specificity': 0.8786645, 'f1': 0.7950284, 'auroc': 0.9673554, 'binary_precision': 0.49624375, 'binary_recall': 0.7858559, 'binary_specificity': 0.97147316, 'binary_f1_score': 0.6083398}
confusion matrix:
       0     1
0  41104  1207
1    324  1189
---- Validation: 
scalar performance:
{'acc': 0.9620199, 'precision': 0.7200281, 'recall': 0.87598455, 'specificity': 0.87598455, 'f1': 0.7749187, 'auroc': 0.9590107, 'binary_precision': 0.44739336, 'binary_recall': 0.78405315, 'binary_specificity': 0.9679159, 'binary_f1_score': 0.56970423}
confusion matrix:
       0    1
0  17588  583
1    130  472
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97146976, 'precision': 0.8194836, 'recall': 0.7710233, 'specificity': 0.7710233, 'f1': 0.7930515, 'auroc': 0.9371407, 'binary_precision': 0.65686274, 'binary_recall': 0.553719, 'binary_specificity': 0.9883275, 'binary_f1_score': 0.60089684}
confusion matrix:
      0    1
0  5927   70
1   108  134
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011734.png
early stop counter: 17
val acc:0.9620199203491211, best validation acc: 0.9685719013214111, corresponding to test acc:                         0.9780413508415222 / 0.9807661771774292
after epoch: 20,now: 2024-06-01 13:09:46.499427,epoch time: 0:25:51.546486,used: 8:40:29.882012,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_04_29_16_seed_2_21011734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.966046, 'precision': 0.74896246, 'recall': 0.886183, 'specificity': 0.886183, 'f1': 0.8008338, 'auroc': 0.97102964, 'binary_precision': 0.50521487, 'binary_recall': 0.80039656, 'binary_specificity': 0.9719695, 'binary_f1_score': 0.6194374}
confusion matrix:
       0     1
0  41125  1186
1    302  1211
---- Validation: 
scalar performance:
{'acc': 0.9632984, 'precision': 0.7239066, 'recall': 0.861387, 'specificity': 0.861387, 'f1': 0.77443004, 'auroc': 0.95956534, 'binary_precision': 0.45619336, 'binary_recall': 0.7524917, 'binary_specificity': 0.9702823, 'binary_f1_score': 0.5680251}
confusion matrix:
       0    1
0  17631  540
1    149  453
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96970665, 'precision': 0.8007734, 'recall': 0.7780371, 'specificity': 0.7780371, 'f1': 0.7889077, 'auroc': 0.94275033, 'binary_precision': 0.6188341, 'binary_recall': 0.57024795, 'binary_specificity': 0.98582625, 'binary_f1_score': 0.59354836}
confusion matrix:
      0    1
0  5912   85
1   104  138
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011734.png
early stop counter: 18
val acc:0.9632983803749084, best validation acc: 0.9685719013214111, corresponding to test acc:                         0.9780413508415222 / 0.9807661771774292
after epoch: 21,now: 2024-06-01 13:35:41.383309,epoch time: 0:25:54.883882,used: 9:06:24.765894,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_04_29_16_seed_2_21011734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.96650237, 'precision': 0.75109756, 'recall': 0.88673806, 'specificity': 0.88673806, 'f1': 0.8026445, 'auroc': 0.9688206, 'binary_precision': 0.50945777, 'binary_recall': 0.8010575, 'binary_specificity': 0.97241855, 'binary_f1_score': 0.6228161}
confusion matrix:
       0     1
0  41144  1167
1    301  1212
---- Validation: 
scalar performance:
{'acc': 0.9646833, 'precision': 0.730818, 'recall': 0.872542, 'specificity': 0.872542, 'f1': 0.7829421, 'auroc': 0.96174, 'binary_precision': 0.46928498, 'binary_recall': 0.77408636, 'binary_specificity': 0.97099775, 'binary_f1_score': 0.58432597}
confusion matrix:
       0    1
0  17644  527
1    136  466
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97002727, 'precision': 0.80957556, 'recall': 0.7563937, 'specificity': 0.7563937, 'f1': 0.7802141, 'auroc': 0.9436791, 'binary_precision': 0.6381909, 'binary_recall': 0.5247934, 'binary_specificity': 0.987994, 'binary_f1_score': 0.5759637}
confusion matrix:
      0    1
0  5925   72
1   115  127
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011734.png
early stop counter: 19
val acc:0.9646832942962646, best validation acc: 0.9685719013214111, corresponding to test acc:                         0.9780413508415222 / 0.9807661771774292
after epoch: 22,now: 2024-06-01 14:01:14.007700,epoch time: 0:25:32.624391,used: 9:31:57.390285,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_04_29_16_seed_2_21011734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9655668, 'precision': 0.7464208, 'recall': 0.8763753, 'specificity': 0.8763753, 'f1': 0.7960831, 'auroc': 0.96999085, 'binary_precision': 0.5008482, 'binary_recall': 0.7805684, 'binary_specificity': 0.97218215, 'binary_f1_score': 0.61017823}
confusion matrix:
       0     1
0  41134  1177
1    332  1181
---- Validation: 
scalar performance:
{'acc': 0.96148723, 'precision': 0.7173526, 'recall': 0.870088, 'specificity': 0.870088, 'f1': 0.7712351, 'auroc': 0.9588923, 'binary_precision': 0.44243577, 'binary_recall': 0.77242523, 'binary_specificity': 0.9677508, 'binary_f1_score': 0.5626134}
confusion matrix:
       0    1
0  17585  586
1    137  465
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9716301, 'precision': 0.8211029, 'recall': 0.7711066, 'specificity': 0.7711066, 'f1': 0.79376876, 'auroc': 0.9467926, 'binary_precision': 0.6600985, 'binary_recall': 0.553719, 'binary_specificity': 0.9884942, 'binary_f1_score': 0.6022472}
confusion matrix:
      0    1
0  5928   69
1   108  134
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011734.png
early stop counter: 20
val acc:0.9614872336387634, best validation acc: 0.9685719013214111, corresponding to test acc:                         0.9780413508415222 / 0.9807661771774292
after epoch: 23,now: 2024-06-01 14:26:51.119502,epoch time: 0:25:37.111802,used: 9:57:34.502087,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_04_29_16_seed_2_21011734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9697426, 'precision': 0.7675899, 'recall': 0.8753513, 'specificity': 0.8753513, 'f1': 0.8113528, 'auroc': 0.9727458, 'binary_precision': 0.5433875, 'binary_recall': 0.77395904, 'binary_specificity': 0.97674364, 'binary_f1_score': 0.6384951}
confusion matrix:
       0     1
0  41327   984
1    342  1171
---- Validation: 
scalar performance:
{'acc': 0.96590847, 'precision': 0.7357578, 'recall': 0.86273533, 'specificity': 0.86273533, 'f1': 0.7841253, 'auroc': 0.9632963, 'binary_precision': 0.47987288, 'binary_recall': 0.7524917, 'binary_specificity': 0.97297895, 'binary_f1_score': 0.58602846}
confusion matrix:
       0    1
0  17680  491
1    149  453
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97195065, 'precision': 0.83676475, 'recall': 0.743515, 'specificity': 0.743515, 'f1': 0.781903, 'auroc': 0.9385427, 'binary_precision': 0.6936416, 'binary_recall': 0.49586776, 'binary_specificity': 0.99116224, 'binary_f1_score': 0.57831323}
confusion matrix:
      0    1
0  5944   53
1   122  120
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011734.png
early stop counter: 21
val acc:0.9659084677696228, best validation acc: 0.9685719013214111, corresponding to test acc:                         0.9780413508415222 / 0.9807661771774292
after epoch: 24,now: 2024-06-01 14:52:21.172170,epoch time: 0:25:30.052668,used: 10:23:04.554755,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_04_29_16_seed_2_21011734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.96668494, 'precision': 0.7523885, 'recall': 0.9053143, 'specificity': 0.9053143, 'f1': 0.8087729, 'auroc': 0.9711583, 'binary_precision': 0.5106554, 'binary_recall': 0.83939195, 'binary_specificity': 0.97123677, 'binary_f1_score': 0.635}
confusion matrix:
       0     1
0  41094  1217
1    243  1270
---- Validation: 
scalar performance:
{'acc': 0.9627657, 'precision': 0.72500896, 'recall': 0.8988551, 'specificity': 0.8988551, 'f1': 0.784541, 'auroc': 0.9625773, 'binary_precision': 0.45578852, 'binary_recall': 0.8305648, 'binary_specificity': 0.96714544, 'binary_f1_score': 0.58858156}
confusion matrix:
       0    1
0  17574  597
1    102  500
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9692258, 'precision': 0.7958605, 'recall': 0.78175247, 'specificity': 0.78175247, 'f1': 0.78861415, 'auroc': 0.9382473, 'binary_precision': 0.6086956, 'binary_recall': 0.5785124, 'binary_specificity': 0.9849925, 'binary_f1_score': 0.59322035}
confusion matrix:
      0    1
0  5907   90
1   102  140
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011734.png
early stop counter: 22
val acc:0.9627656936645508, best validation acc: 0.9685719013214111, corresponding to test acc:                         0.9780413508415222 / 0.9807661771774292
after epoch: 25,now: 2024-06-01 15:17:48.138145,epoch time: 0:25:26.965975,used: 10:48:31.520730,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_04_29_16_seed_2_21011734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.96424335, 'precision': 0.7419127, 'recall': 0.9053246, 'specificity': 0.9053246, 'f1': 0.80021954, 'auroc': 0.9718385, 'binary_precision': 0.48962337, 'binary_recall': 0.8420357, 'binary_specificity': 0.9686134, 'binary_f1_score': 0.619198}
confusion matrix:
       0     1
0  40983  1328
1    239  1274
---- Validation: 
scalar performance:
{'acc': 0.96132743, 'precision': 0.7197607, 'recall': 0.9005213, 'specificity': 0.9005213, 'f1': 0.78027993, 'auroc': 0.9631566, 'binary_precision': 0.44513273, 'binary_recall': 0.83554816, 'binary_specificity': 0.96549445, 'binary_f1_score': 0.58083135}
confusion matrix:
       0    1
0  17544  627
1     99  503
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9640968, 'precision': 0.7594092, 'recall': 0.7552916, 'specificity': 0.7552916, 'f1': 0.7573318, 'auroc': 0.9356257, 'binary_precision': 0.53781515, 'binary_recall': 0.5289256, 'binary_specificity': 0.9816575, 'binary_f1_score': 0.53333336}
confusion matrix:
      0    1
0  5887  110
1   114  128
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011734.png
early stop counter: 23
val acc:0.9613274335861206, best validation acc: 0.9685719013214111, corresponding to test acc:                         0.9780413508415222 / 0.9807661771774292
after epoch: 26,now: 2024-06-01 15:42:53.804910,epoch time: 0:25:05.666765,used: 11:13:37.187495,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_04_29_16_seed_2_21011734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.96435744, 'precision': 0.74129534, 'recall': 0.8833966, 'specificity': 0.8833966, 'f1': 0.79403996, 'auroc': 0.96949816, 'binary_precision': 0.4900366, 'binary_recall': 0.79643095, 'binary_specificity': 0.9703623, 'binary_f1_score': 0.6067472}
confusion matrix:
       0     1
0  41057  1254
1    308  1205
---- Validation: 
scalar performance:
{'acc': 0.96004903, 'precision': 0.71436787, 'recall': 0.8926335, 'specificity': 0.8926335, 'f1': 0.7737622, 'auroc': 0.9622952, 'binary_precision': 0.43485916, 'binary_recall': 0.820598, 'binary_specificity': 0.964669, 'binary_f1_score': 0.56846946}
confusion matrix:
       0    1
0  17529  642
1    108  494
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97002727, 'precision': 0.80957556, 'recall': 0.7563937, 'specificity': 0.7563937, 'f1': 0.7802141, 'auroc': 0.94356096, 'binary_precision': 0.6381909, 'binary_recall': 0.5247934, 'binary_specificity': 0.987994, 'binary_f1_score': 0.5759637}
confusion matrix:
      0    1
0  5925   72
1   115  127
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011734.png
early stop counter: 24
val acc:0.960049033164978, best validation acc: 0.9685719013214111, corresponding to test acc:                         0.9780413508415222 / 0.9807661771774292
after epoch: 27,now: 2024-06-01 16:08:16.265708,epoch time: 0:25:22.460798,used: 11:38:59.648293,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_04_29_16_seed_2_21011734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.96622854, 'precision': 0.74971044, 'recall': 0.8827724, 'specificity': 0.8827724, 'f1': 0.8004445, 'auroc': 0.9720864, 'binary_precision': 0.5069708, 'binary_recall': 0.7931262, 'binary_specificity': 0.97241855, 'binary_f1_score': 0.61855674}
confusion matrix:
       0     1
0  41144  1167
1    313  1200
---- Validation: 
scalar performance:
{'acc': 0.9638843, 'precision': 0.7273881, 'recall': 0.8729324, 'specificity': 0.8729324, 'f1': 0.78026825, 'auroc': 0.96189374, 'binary_precision': 0.46237624, 'binary_recall': 0.77574754, 'binary_specificity': 0.9701172, 'binary_f1_score': 0.5794045}
confusion matrix:
       0    1
0  17628  543
1    135  467
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96666133, 'precision': 0.7930337, 'recall': 0.6892124, 'specificity': 0.6892124, 'f1': 0.7287659, 'auroc': 0.94191533, 'binary_precision': 0.6103896, 'binary_recall': 0.38842976, 'binary_specificity': 0.989995, 'binary_f1_score': 0.47474748}
confusion matrix:
      0   1
0  5937  60
1   148  94
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011734.png
early stop counter: 25
val acc:0.9638842940330505, best validation acc: 0.9685719013214111, corresponding to test acc:                         0.9780413508415222 / 0.9807661771774292
after epoch: 28,now: 2024-06-01 16:33:52.940797,epoch time: 0:25:36.675089,used: 12:04:36.323382,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_04_29_16_seed_2_21011734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9674379, 'precision': 0.75552106, 'recall': 0.88339865, 'specificity': 0.88339865, 'f1': 0.8050494, 'auroc': 0.97327214, 'binary_precision': 0.5185825, 'binary_recall': 0.7931262, 'binary_specificity': 0.97367114, 'binary_f1_score': 0.6271231}
confusion matrix:
       0     1
0  41197  1114
1    313  1200
---- Validation: 
scalar performance:
{'acc': 0.96558887, 'precision': 0.7350605, 'recall': 0.875419, 'specificity': 0.875419, 'f1': 0.7871041, 'auroc': 0.9641941, 'binary_precision': 0.47759673, 'binary_recall': 0.7790698, 'binary_specificity': 0.9717682, 'binary_f1_score': 0.5921717}
confusion matrix:
       0    1
0  17658  513
1    133  469
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9668216, 'precision': 0.7971305, 'recall': 0.6833475, 'specificity': 0.6833475, 'f1': 0.72537166, 'auroc': 0.9366798, 'binary_precision': 0.61904764, 'binary_recall': 0.37603307, 'binary_specificity': 0.990662, 'binary_f1_score': 0.46786633}
confusion matrix:
      0   1
0  5941  56
1   151  91
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011734.png
early stop counter: 26
val acc:0.9655888676643372, best validation acc: 0.9685719013214111, corresponding to test acc:                         0.9780413508415222 / 0.9807661771774292
after epoch: 29,now: 2024-06-01 16:59:33.043435,epoch time: 0:25:40.102638,used: 12:30:16.426020,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_04_29_16_seed_2_21011734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.96673054, 'precision': 0.75259495, 'recall': 0.9094305, 'specificity': 0.9094305, 'f1': 0.8100295, 'auroc': 0.9724175, 'binary_precision': 0.51075697, 'binary_recall': 0.8478836, 'binary_specificity': 0.9709775, 'binary_f1_score': 0.6374937}
confusion matrix:
       0     1
0  41084  1228
1    230  1282
---- Validation: 
scalar performance:
{'acc': 0.96127415, 'precision': 0.72024906, 'recall': 0.9077212, 'specificity': 0.9077212, 'f1': 0.7822492, 'auroc': 0.96342283, 'binary_precision': 0.44560486, 'binary_recall': 0.8504983, 'binary_specificity': 0.9649441, 'binary_f1_score': 0.58480865}
confusion matrix:
       0    1
0  17534  637
1     90  512
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9716301, 'precision': 0.8177448, 'recall': 0.7810203, 'specificity': 0.7810203, 'f1': 0.7981336, 'auroc': 0.94587326, 'binary_precision': 0.65258217, 'binary_recall': 0.57438016, 'binary_specificity': 0.98766047, 'binary_f1_score': 0.61098903}
confusion matrix:
      0    1
0  5923   74
1   103  139
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011734.png
early stop counter: 27
val acc:0.9612741470336914, best validation acc: 0.9685719013214111, corresponding to test acc:                         0.9780413508415222 / 0.9807661771774292
after epoch: 30,now: 2024-06-01 17:25:08.123876,epoch time: 0:25:35.080441,used: 12:55:51.506461,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_04_29_16_seed_2_21011734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 12:55:51.506461 at 2024-06-01 17:25:08.123876
persisted model performance metric: 

scalar performance:
{'acc': 0.9770797, 'precision': 0.91084385, 'recall': 0.7501485, 'specificity': 0.7501485, 'f1': 0.809332, 'auroc': 0.9079163, 'binary_precision': 0.8413793, 'binary_recall': 0.5041322, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.63049096}
confusion matrix:
      0    1
0  5974   23
1   120  122
oracle model performance metric: 

scalar performance:
{'acc': 0.97868246, 'precision': 0.8669057, 'recall': 0.83624005, 'specificity': 0.83624005, 'f1': 0.85083675, 'auroc': 0.937983, 'binary_precision': 0.74660635, 'binary_recall': 0.6818182, 'binary_specificity': 0.990662, 'binary_f1_score': 0.7127429}
confusion matrix:
      0    1
0  5941   56
1    77  165
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/rule_results/9.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/confusion_matrix/9.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 491221 KiB |  10997 MiB |   2723 TiB |   2723 TiB |
|       from large pool | 401408 KiB |  10925 MiB |   2714 TiB |   2714 TiB |
|       from small pool |  89813 KiB |    125 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 491221 KiB |  10997 MiB |   2723 TiB |   2723 TiB |
|       from large pool | 401408 KiB |  10925 MiB |   2714 TiB |   2714 TiB |
|       from small pool |  89813 KiB |    125 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476572 KiB |  10880 MiB |   2696 TiB |   2696 TiB |
|       from large pool | 387840 KiB |  10808 MiB |   2688 TiB |   2688 TiB |
|       from small pool |  88732 KiB |    124 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11504 MiB |  11504 MiB |  32238 MiB |  20734 MiB |
|       from large pool |  11380 MiB |  11380 MiB |  32060 MiB |  20680 MiB |
|       from small pool |    124 MiB |    126 MiB |    178 MiB |     54 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 633130 KiB |   1325 MiB |   1285 TiB |   1285 TiB |
|       from large pool | 626688 KiB |   1322 MiB |   1276 TiB |   1276 TiB |
|       from small pool |   6442 KiB |     24 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3717    |    6728    |  419453 K  |  419450 K  |
|       from large pool |      87    |     908    |  170470 K  |  170470 K  |
|       from small pool |    3630    |    6639    |  248983 K  |  248979 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3717    |    6728    |  419453 K  |  419450 K  |
|       from large pool |      87    |     908    |  170470 K  |  170470 K  |
|       from small pool |    3630    |    6639    |  248983 K  |  248979 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     410    |     410    |    1052    |     642    |
|       from large pool |     348    |     348    |     963    |     615    |
|       from small pool |      62    |      63    |      89    |      27    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      74    |    2775    |  222959 K  |  222959 K  |
|       from large pool |      24    |     203    |  102914 K  |  102914 K  |
|       from small pool |      50    |    2751    |  120044 K  |  120044 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10997 MiB |   2723 TiB |   2723 TiB |
|       from large pool |  16640 KiB |  10925 MiB |   2714 TiB |   2714 TiB |
|       from small pool |      0 KiB |    125 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10997 MiB |   2723 TiB |   2723 TiB |
|       from large pool |  16640 KiB |  10925 MiB |   2714 TiB |   2714 TiB |
|       from small pool |      0 KiB |    125 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10880 MiB |   2696 TiB |   2696 TiB |
|       from large pool |  16640 KiB |  10808 MiB |   2688 TiB |   2688 TiB |
|       from small pool |      0 KiB |    124 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1098 MiB |  11504 MiB |  32238 MiB |  31140 MiB |
|       from large pool |   1004 MiB |  11380 MiB |  32060 MiB |  31056 MiB |
|       from small pool |     94 MiB |    126 MiB |    178 MiB |     84 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1325 MiB |   1285 TiB |   1285 TiB |
|       from large pool |  50944 KiB |   1322 MiB |   1276 TiB |   1276 TiB |
|       from small pool |      0 KiB |     24 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6728    |  419453 K  |  419453 K  |
|       from large pool |       2    |     908    |  170470 K  |  170470 K  |
|       from small pool |       0    |    6639    |  248983 K  |  248983 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6728    |  419453 K  |  419453 K  |
|       from large pool |       2    |     908    |  170470 K  |  170470 K  |
|       from small pool |       0    |    6639    |  248983 K  |  248983 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      81    |     410    |    1052    |     971    |
|       from large pool |      34    |     348    |     963    |     929    |
|       from small pool |      47    |      63    |      89    |      42    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2775    |  222960 K  |  222960 K  |
|       from large pool |       4    |     203    |  102914 K  |  102914 K  |
|       from small pool |       0    |    2751    |  120046 K  |  120046 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat Jun  1 17:27:56 2024]
Finished job 0.
1 of 1 steps (100%) done
