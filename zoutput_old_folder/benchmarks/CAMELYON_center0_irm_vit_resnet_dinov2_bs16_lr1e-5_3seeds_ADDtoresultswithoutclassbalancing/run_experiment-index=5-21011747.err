Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jun  1 20:38:44 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/rule_results/5.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=5
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_20_46_28_seed_0_21011747

 Experiment start at: 2024-06-01 20:46:28.899238
before training, model accuracy: 0.955097496509552
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9592391, 'precision': 0.72075456, 'recall': 0.9205111, 'specificity': 0.9205111, 'f1': 0.7850878, 'auroc': 0.966148, 'binary_precision': 0.44586205, 'binary_recall': 0.87899387, 'binary_specificity': 0.9620283, 'binary_f1_score': 0.59162664}
confusion matrix:
       0     1
0  40714  1607
1    178  1293
---- Validation: 
scalar performance:
{'acc': 0.9571626, 'precision': 0.7162707, 'recall': 0.91781807, 'specificity': 0.91781807, 'f1': 0.78026944, 'auroc': 0.9665326, 'binary_precision': 0.4371118, 'binary_recall': 0.87558323, 'binary_specificity': 0.9600529, 'binary_f1_score': 0.5831176}
confusion matrix:
       0    1
0  17424  725
1     80  563
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97363377, 'precision': 0.8190392, 'recall': 0.89645875, 'specificity': 0.89645875, 'f1': 0.853015, 'auroc': 0.9490198, 'binary_precision': 0.64634144, 'binary_recall': 0.8122605, 'binary_specificity': 0.980657, 'binary_f1_score': 0.7198642}
confusion matrix:
      0    1
0  5881  116
1    49  212
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011747_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-01 21:25:50.338815,epoch time: 0:39:21.439577,used: 0:39:21.439577,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_20_46_28_seed_0_21011747
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9806586, 'precision': 0.90424716, 'recall': 0.7675479, 'specificity': 0.7675479, 'f1': 0.8209616, 'auroc': 0.9816021, 'binary_precision': 0.8243243, 'binary_recall': 0.5390891, 'binary_specificity': 0.9960067, 'binary_f1_score': 0.6518702}
confusion matrix:
       0    1
0  42152  169
1    678  793
---- Validation: 
scalar performance:
{'acc': 0.97765005, 'precision': 0.8841601, 'recall': 0.7356605, 'specificity': 0.7356605, 'f1': 0.79076636, 'auroc': 0.97969806, 'binary_precision': 0.7866324, 'binary_recall': 0.47589424, 'binary_specificity': 0.9954268, 'binary_f1_score': 0.59302324}
confusion matrix:
       0    1
0  18066   83
1    337  306
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96244806, 'precision': 0.8865026, 'recall': 0.5644671, 'specificity': 0.5644671, 'f1': 0.6025903, 'auroc': 0.95641005, 'binary_precision': 0.8095238, 'binary_recall': 0.1302682, 'binary_specificity': 0.998666, 'binary_f1_score': 0.22442244}
confusion matrix:
      0   1
0  5989   8
1   227  34
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011747_2.png
better model found
persisted
after epoch: 2,now: 2024-06-01 22:04:06.648441,epoch time: 0:38:16.309626,used: 1:17:37.749203,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_20_46_28_seed_0_21011747
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.980179, 'precision': 0.84075284, 'recall': 0.8657269, 'specificity': 0.8657269, 'f1': 0.852757, 'auroc': 0.9815199, 'binary_precision': 0.69046116, 'binary_recall': 0.743032, 'binary_specificity': 0.9884218, 'binary_f1_score': 0.7157826}
confusion matrix:
       0     1
0  41831   490
1    378  1093
---- Validation: 
scalar performance:
{'acc': 0.9808429, 'precision': 0.8590147, 'recall': 0.8460715, 'specificity': 0.8460715, 'f1': 0.8524136, 'auroc': 0.9779271, 'binary_precision': 0.7285945, 'binary_recall': 0.7013997, 'binary_specificity': 0.9907433, 'binary_f1_score': 0.7147385}
confusion matrix:
       0    1
0  17981  168
1    192  451
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96708214, 'precision': 0.81497157, 'recall': 0.7189687, 'specificity': 0.7189687, 'f1': 0.75737983, 'auroc': 0.95629907, 'binary_precision': 0.65363127, 'binary_recall': 0.44827586, 'binary_specificity': 0.9896615, 'binary_f1_score': 0.5318182}
confusion matrix:
      0    1
0  5935   62
1   144  117
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011747_3.png
better model found
persisted
after epoch: 3,now: 2024-06-01 22:42:12.341875,epoch time: 0:38:05.693434,used: 1:55:43.442637,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_20_46_28_seed_0_21011747
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97830653, 'precision': 0.8118877, 'recall': 0.92484343, 'specificity': 0.92484343, 'f1': 0.85879123, 'auroc': 0.9847883, 'binary_precision': 0.6284449, 'binary_recall': 0.8675272, 'binary_specificity': 0.98215973, 'binary_f1_score': 0.72888124}
confusion matrix:
       0     1
0  41565   755
1    195  1277
---- Validation: 
scalar performance:
{'acc': 0.9780758, 'precision': 0.81436837, 'recall': 0.91589415, 'specificity': 0.91589415, 'f1': 0.85732234, 'auroc': 0.9792089, 'binary_precision': 0.63414633, 'binary_recall': 0.84914464, 'binary_specificity': 0.98264366, 'binary_f1_score': 0.72606385}
confusion matrix:
       0    1
0  17834  315
1     97  546
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9741131, 'precision': 0.84215844, 'recall': 0.82708025, 'specificity': 0.82708025, 'f1': 0.83442986, 'auroc': 0.95319337, 'binary_precision': 0.6987952, 'binary_recall': 0.6666667, 'binary_specificity': 0.98749375, 'binary_f1_score': 0.68235296}
confusion matrix:
      0    1
0  5922   75
1    87  174
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011747_4.png
new oracle model saved
early stop counter: 1
val acc:0.9780758023262024, best validation acc: 0.9808428883552551, corresponding to test acc:                         0.967082142829895 / 0.9741131067276001
after epoch: 4,now: 2024-06-01 23:20:15.974244,epoch time: 0:38:03.632369,used: 2:33:47.075006,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_20_46_28_seed_0_21011747
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9826224, 'precision': 0.872478, 'recall': 0.853636, 'specificity': 0.853636, 'f1': 0.8627914, 'auroc': 0.98755574, 'binary_precision': 0.7548387, 'binary_recall': 0.71535325, 'binary_specificity': 0.99191874, 'binary_f1_score': 0.73456573}
confusion matrix:
       0     1
0  41978   342
1    419  1053
---- Validation: 
scalar performance:
{'acc': 0.98020434, 'precision': 0.8617878, 'recall': 0.82473934, 'specificity': 0.82473934, 'f1': 0.84217596, 'auroc': 0.9819498, 'binary_precision': 0.73565215, 'binary_recall': 0.6578538, 'binary_specificity': 0.9916249, 'binary_f1_score': 0.6945812}
confusion matrix:
       0    1
0  17997  152
1    220  423
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96596354, 'precision': 0.8482531, 'recall': 0.6450917, 'specificity': 0.6450917, 'f1': 0.7010431, 'auroc': 0.9653628, 'binary_precision': 0.7264151, 'binary_recall': 0.29501915, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.41961852}
confusion matrix:
      0   1
0  5968  29
1   184  77
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011747_5.png
early stop counter: 2
val acc:0.9802043437957764, best validation acc: 0.9808428883552551, corresponding to test acc:                         0.967082142829895 / 0.9741131067276001
after epoch: 5,now: 2024-06-01 23:58:28.762598,epoch time: 0:38:12.788354,used: 3:11:59.863360,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_20_46_28_seed_0_21011747
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98515713, 'precision': 0.94735956, 'recall': 0.8097029, 'specificity': 0.8097029, 'f1': 0.86513275, 'auroc': 0.99092627, 'binary_precision': 0.9077381, 'binary_recall': 0.62160325, 'binary_specificity': 0.99780244, 'binary_f1_score': 0.73790324}
confusion matrix:
       0    1
0  42227   93
1    557  915
---- Validation: 
scalar performance:
{'acc': 0.9832908, 'precision': 0.9436477, 'recall': 0.7858342, 'specificity': 0.7858342, 'f1': 0.84646285, 'auroc': 0.9840266, 'binary_precision': 0.90220046, 'binary_recall': 0.57387245, 'binary_specificity': 0.997796, 'binary_f1_score': 0.7015209}
confusion matrix:
       0    1
0  18109   40
1    274  369
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9610099, 'precision': 0.9329806, 'recall': 0.5362317, 'specificity': 0.5362317, 'f1': 0.5574037, 'auroc': 0.95682025, 'binary_precision': 0.9047619, 'binary_recall': 0.07279693, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.13475177}
confusion matrix:
      0   1
0  5995   2
1   242  19
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011747_6.png
better model found
persisted
after epoch: 6,now: 2024-06-02 00:36:44.860354,epoch time: 0:38:16.097756,used: 3:50:15.961116,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_20_46_28_seed_0_21011747
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98591065, 'precision': 0.93435156, 'recall': 0.8346822, 'specificity': 0.8346822, 'f1': 0.8775791, 'auroc': 0.98809075, 'binary_precision': 0.88, 'binary_recall': 0.6725544, 'binary_specificity': 0.99681, 'binary_f1_score': 0.76241815}
confusion matrix:
       0    1
0  42185  135
1    482  990
---- Validation: 
scalar performance:
{'acc': 0.98366326, 'precision': 0.9427879, 'recall': 0.7927776, 'specificity': 0.7927776, 'f1': 0.8513943, 'auroc': 0.98273456, 'binary_precision': 0.9, 'binary_recall': 0.58786935, 'binary_specificity': 0.99768585, 'binary_f1_score': 0.71119475}
confusion matrix:
       0    1
0  18107   42
1    265  378
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614893, 'precision': 0.8403441, 'recall': 0.5621345, 'specificity': 0.5621345, 'f1': 0.5976221, 'auroc': 0.93974113, 'binary_precision': 0.7173913, 'binary_recall': 0.12643678, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.21498372}
confusion matrix:
      0   1
0  5984  13
1   228  33
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011747_7.png
better model found
persisted
after epoch: 7,now: 2024-06-02 01:15:07.907007,epoch time: 0:38:23.046653,used: 4:28:39.007769,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_20_46_28_seed_0_21011747
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98422086, 'precision': 0.8874725, 'recall': 0.8622405, 'specificity': 0.8622405, 'f1': 0.8743963, 'auroc': 0.9905057, 'binary_precision': 0.7842566, 'binary_recall': 0.7314752, 'binary_specificity': 0.9930058, 'binary_f1_score': 0.7569468}
confusion matrix:
       0     1
0  42025   296
1    395  1076
---- Validation: 
scalar performance:
{'acc': 0.97988504, 'precision': 0.8598503, 'recall': 0.8208238, 'specificity': 0.8208238, 'f1': 0.83911973, 'auroc': 0.9827657, 'binary_precision': 0.73204905, 'binary_recall': 0.65007776, 'binary_specificity': 0.99156976, 'binary_f1_score': 0.68863267}
confusion matrix:
       0    1
0  17996  153
1    225  418
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96356666, 'precision': 0.88809395, 'recall': 0.5815417, 'specificity': 0.5815417, 'f1': 0.62759995, 'auroc': 0.946817, 'binary_precision': 0.8113208, 'binary_recall': 0.16475096, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.27388537}
confusion matrix:
      0   1
0  5987  10
1   218  43
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011747_8.png
early stop counter: 1
val acc:0.9798850417137146, best validation acc: 0.9836632609367371, corresponding to test acc:                         0.9614893198013306 / 0.9741131067276001
after epoch: 8,now: 2024-06-02 01:53:26.554962,epoch time: 0:38:18.647955,used: 5:06:57.655724,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_20_46_28_seed_0_21011747
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.988354, 'precision': 0.959682, 'recall': 0.85266715, 'specificity': 0.85266715, 'f1': 0.89862007, 'auroc': 0.99414074, 'binary_precision': 0.9294643, 'binary_recall': 0.70720106, 'binary_specificity': 0.99813324, 'binary_f1_score': 0.8032407}
confusion matrix:
       0     1
0  42241    79
1    431  1041
---- Validation: 
scalar performance:
{'acc': 0.98403573, 'precision': 0.95647264, 'recall': 0.78847015, 'specificity': 0.78847015, 'f1': 0.8522167, 'auroc': 0.9841677, 'binary_precision': 0.9276808, 'binary_recall': 0.5785381, 'binary_specificity': 0.9984021, 'binary_f1_score': 0.7126437}
confusion matrix:
       0    1
0  18120   29
1    271  372
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96196866, 'precision': 0.83665085, 'recall': 0.5733786, 'specificity': 0.5733786, 'f1': 0.6136636, 'auroc': 0.9429166, 'binary_precision': 0.7090909, 'binary_recall': 0.14942528, 'binary_specificity': 0.997332, 'binary_f1_score': 0.24683544}
confusion matrix:
      0   1
0  5981  16
1   222  39
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011747_9.png
better model found
persisted
after epoch: 9,now: 2024-06-02 02:31:48.841513,epoch time: 0:38:22.286551,used: 5:45:19.942275,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_20_46_28_seed_0_21011747
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9895643, 'precision': 0.9234454, 'recall': 0.91427517, 'specificity': 0.91427517, 'f1': 0.918806, 'auroc': 0.9933789, 'binary_precision': 0.8526755, 'binary_recall': 0.8335598, 'binary_specificity': 0.9949905, 'binary_f1_score': 0.8430093}
confusion matrix:
       0     1
0  42108   212
1    245  1227
---- Validation: 
scalar performance:
{'acc': 0.9860047, 'precision': 0.9007073, 'recall': 0.8832463, 'specificity': 0.8832463, 'f1': 0.89176595, 'auroc': 0.98048985, 'binary_precision': 0.8094463, 'binary_recall': 0.7729393, 'binary_specificity': 0.99355334, 'binary_f1_score': 0.7907717}
confusion matrix:
       0    1
0  18032  117
1    146  497
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.7967518, 'recall': 0.5821234, 'specificity': 0.5821234, 'f1': 0.62295926, 'auroc': 0.9485016, 'binary_precision': 0.62857145, 'binary_recall': 0.16858238, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.26586103}
confusion matrix:
      0   1
0  5971  26
1   217  44
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011747_10.png
better model found
persisted
after epoch: 10,now: 2024-06-02 03:09:58.746998,epoch time: 0:38:09.905485,used: 6:23:29.847760,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_20_46_28_seed_0_21011747
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98837686, 'precision': 0.939604, 'recall': 0.87259305, 'specificity': 0.87259305, 'f1': 0.9031246, 'auroc': 0.9950128, 'binary_precision': 0.8879032, 'binary_recall': 0.7484704, 'binary_specificity': 0.9967156, 'binary_f1_score': 0.81224644}
confusion matrix:
       0     1
0  42182   139
1    370  1101
---- Validation: 
scalar performance:
{'acc': 0.9831311, 'precision': 0.91256064, 'recall': 0.81200355, 'specificity': 0.81200355, 'f1': 0.85476375, 'auroc': 0.9773685, 'binary_precision': 0.8381743, 'binary_recall': 0.62830484, 'binary_specificity': 0.99570227, 'binary_f1_score': 0.71822226}
confusion matrix:
       0    1
0  18071   78
1    239  404
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.8402616, 'recall': 0.54331094, 'specificity': 0.54331094, 'f1': 0.56839436, 'auroc': 0.9278284, 'binary_precision': 0.71875, 'binary_recall': 0.08812261, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.1569966}
confusion matrix:
      0   1
0  5988   9
1   238  23
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011747_11.png
early stop counter: 1
val acc:0.9831311106681824, best validation acc: 0.9860047101974487, corresponding to test acc:                         0.9611697196960449 / 0.9741131067276001
after epoch: 11,now: 2024-06-02 03:48:07.047729,epoch time: 0:38:08.300731,used: 7:01:38.148491,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_20_46_28_seed_0_21011747
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9917337, 'precision': 0.9346865, 'recall': 0.9386756, 'specificity': 0.9386756, 'f1': 0.9366712, 'auroc': 0.9968818, 'binary_precision': 0.87348586, 'binary_recall': 0.8817935, 'binary_specificity': 0.99555767, 'binary_f1_score': 0.87762004}
confusion matrix:
       0     1
0  42132   188
1    174  1298
---- Validation: 
scalar performance:
{'acc': 0.98770756, 'precision': 0.9396304, 'recall': 0.8646265, 'specificity': 0.8646265, 'f1': 0.8983624, 'auroc': 0.98610437, 'binary_precision': 0.88867927, 'binary_recall': 0.7325039, 'binary_specificity': 0.9967491, 'binary_f1_score': 0.8030691}
confusion matrix:
       0    1
0  18090   59
1    172  471
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96356666, 'precision': 0.8306973, 'recall': 0.61085904, 'specificity': 0.61085904, 'f1': 0.6611529, 'auroc': 0.9462302, 'binary_precision': 0.69411767, 'binary_recall': 0.22605364, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.34104046}
confusion matrix:
      0   1
0  5971  26
1   202  59
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011747_12.png
better model found
persisted
after epoch: 12,now: 2024-06-02 04:26:20.162957,epoch time: 0:38:13.115228,used: 7:39:51.263719,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_20_46_28_seed_0_21011747
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.992099, 'precision': 0.9557618, 'recall': 0.919193, 'specificity': 0.919193, 'f1': 0.9366549, 'auroc': 0.9969177, 'binary_precision': 0.917037, 'binary_recall': 0.8410326, 'binary_specificity': 0.9973535, 'binary_f1_score': 0.87739193}
confusion matrix:
       0     1
0  42208   112
1    234  1238
---- Validation: 
scalar performance:
{'acc': 0.98770756, 'precision': 0.951689, 'recall': 0.8526256, 'specificity': 0.8526256, 'f1': 0.89560366, 'auroc': 0.9807462, 'binary_precision': 0.9136546, 'binary_recall': 0.7076205, 'binary_specificity': 0.9976307, 'binary_f1_score': 0.79754597}
confusion matrix:
       0    1
0  18106   43
1    188  455
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96164906, 'precision': 0.87324536, 'recall': 0.55488855, 'specificity': 0.55488855, 'f1': 0.5874939, 'auroc': 0.94726706, 'binary_precision': 0.7837838, 'binary_recall': 0.11111111, 'binary_specificity': 0.998666, 'binary_f1_score': 0.19463088}
confusion matrix:
      0   1
0  5989   8
1   232  29
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011747_13.png
early stop counter: 1
val acc:0.9877075552940369, best validation acc: 0.9877075552940369, corresponding to test acc:                         0.9635666608810425 / 0.9741131067276001
after epoch: 13,now: 2024-06-02 05:04:28.336713,epoch time: 0:38:08.173756,used: 8:17:59.437475,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_20_46_28_seed_0_21011747
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9913683, 'precision': 0.9434706, 'recall': 0.9207295, 'specificity': 0.9207295, 'f1': 0.9317776, 'auroc': 0.9969673, 'binary_precision': 0.8923187, 'binary_recall': 0.8450034, 'binary_specificity': 0.99645567, 'binary_f1_score': 0.86801684}
confusion matrix:
       0     1
0  42171   150
1    228  1243
---- Validation: 
scalar performance:
{'acc': 0.9856854, 'precision': 0.9251118, 'recall': 0.84482825, 'specificity': 0.84482825, 'f1': 0.8804589, 'auroc': 0.9842731, 'binary_precision': 0.8610039, 'binary_recall': 0.69362366, 'binary_specificity': 0.99603283, 'binary_f1_score': 0.7683032}
confusion matrix:
       0    1
0  18077   72
1    197  446
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96740174, 'precision': 0.8881407, 'recall': 0.6421774, 'specificity': 0.6421774, 'f1': 0.7034776, 'auroc': 0.951682, 'binary_precision': 0.8064516, 'binary_recall': 0.28735632, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.42372882}
confusion matrix:
      0   1
0  5979  18
1   186  75
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011747_14.png
early stop counter: 2
val acc:0.985685408115387, best validation acc: 0.9877075552940369, corresponding to test acc:                         0.9635666608810425 / 0.9741131067276001
after epoch: 14,now: 2024-06-02 05:42:21.007109,epoch time: 0:37:52.670396,used: 8:55:52.107871,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_20_46_28_seed_0_21011747
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9920305, 'precision': 0.94020957, 'recall': 0.9364506, 'specificity': 0.9364506, 'f1': 0.93832135, 'auroc': 0.99775934, 'binary_precision': 0.8846946, 'binary_recall': 0.87687075, 'binary_specificity': 0.99603045, 'binary_f1_score': 0.88076526}
confusion matrix:
       0     1
0  42154   168
1    181  1289
---- Validation: 
scalar performance:
{'acc': 0.9868561, 'precision': 0.9175656, 'recall': 0.87543654, 'specificity': 0.87543654, 'f1': 0.8952913, 'auroc': 0.9827008, 'binary_precision': 0.84375, 'binary_recall': 0.755832, 'binary_specificity': 0.9950411, 'binary_f1_score': 0.79737496}
confusion matrix:
       0    1
0  18059   90
1    157  486
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645254, 'precision': 0.8328979, 'recall': 0.62968266, 'specificity': 0.62968266, 'f1': 0.6825354, 'auroc': 0.9402007, 'binary_precision': 0.6969697, 'binary_recall': 0.26436782, 'binary_specificity': 0.9949975, 'binary_f1_score': 0.38333336}
confusion matrix:
      0   1
0  5967  30
1   192  69
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011747_15.png
early stop counter: 3
val acc:0.9868561029434204, best validation acc: 0.9877075552940369, corresponding to test acc:                         0.9635666608810425 / 0.9741131067276001
after epoch: 15,now: 2024-06-02 06:20:11.343703,epoch time: 0:37:50.336594,used: 9:33:42.444465,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_20_46_28_seed_0_21011747
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9913911, 'precision': 0.9245198, 'recall': 0.9470227, 'specificity': 0.9470227, 'f1': 0.93545675, 'auroc': 0.9977071, 'binary_precision': 0.8525435, 'binary_recall': 0.8994565, 'binary_specificity': 0.99458885, 'binary_f1_score': 0.87537193}
confusion matrix:
       0     1
0  42091   229
1    148  1324
---- Validation: 
scalar performance:
{'acc': 0.98472756, 'precision': 0.8830646, 'recall': 0.8870855, 'specificity': 0.8870855, 'f1': 0.88506365, 'auroc': 0.9813808, 'binary_precision': 0.77384615, 'binary_recall': 0.7822706, 'binary_specificity': 0.9919004, 'binary_f1_score': 0.7780356}
confusion matrix:
       0    1
0  18002  147
1    140  503
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.8061032, 'recall': 0.5486412, 'specificity': 0.5486412, 'f1': 0.57618636, 'auroc': 0.93819416, 'binary_precision': 0.65, 'binary_recall': 0.099616855, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.17275746}
confusion matrix:
      0   1
0  5983  14
1   235  26
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011747_16.png
early stop counter: 4
val acc:0.9847275614738464, best validation acc: 0.9877075552940369, corresponding to test acc:                         0.9635666608810425 / 0.9741131067276001
after epoch: 16,now: 2024-06-02 06:58:04.133769,epoch time: 0:37:52.790066,used: 10:11:35.234531,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_20_46_28_seed_0_21011747
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9938573, 'precision': 0.9806489, 'recall': 0.92267346, 'specificity': 0.92267346, 'f1': 0.94966483, 'auroc': 0.9988204, 'binary_precision': 0.9666149, 'binary_recall': 0.846363, 'binary_specificity': 0.998984, 'binary_f1_score': 0.90250087}
confusion matrix:
       0     1
0  42278    43
1    226  1245
---- Validation: 
scalar performance:
{'acc': 0.9860047, 'precision': 0.9429022, 'recall': 0.8322426, 'specificity': 0.8322426, 'f1': 0.8790876, 'auroc': 0.9805503, 'binary_precision': 0.89748955, 'binary_recall': 0.66718507, 'binary_specificity': 0.99730015, 'binary_f1_score': 0.765388}
confusion matrix:
       0    1
0  18100   49
1    214  429
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642058, 'precision': 0.9291785, 'recall': 0.5800429, 'specificity': 0.5800429, 'f1': 0.6271893, 'auroc': 0.94311666, 'binary_precision': 0.89361703, 'binary_recall': 0.16091955, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.27272728}
confusion matrix:
      0   1
0  5992   5
1   219  42
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011747_17.png
early stop counter: 5
val acc:0.9860047101974487, best validation acc: 0.9877075552940369, corresponding to test acc:                         0.9635666608810425 / 0.9741131067276001
after epoch: 17,now: 2024-06-02 07:35:56.351895,epoch time: 0:37:52.218126,used: 10:49:27.452657,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_20_46_28_seed_0_21011747
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99084306, 'precision': 0.9558502, 'recall': 0.8978881, 'specificity': 0.8978881, 'f1': 0.92475396, 'auroc': 0.9979737, 'binary_precision': 0.91868645, 'binary_recall': 0.7982337, 'binary_specificity': 0.99754256, 'binary_f1_score': 0.8542348}
confusion matrix:
       0     1
0  42216   104
1    297  1175
---- Validation: 
scalar performance:
{'acc': 0.98137504, 'precision': 0.8971406, 'recall': 0.7960933, 'specificity': 0.7960933, 'f1': 0.83867145, 'auroc': 0.9826392, 'binary_precision': 0.8084211, 'binary_recall': 0.59720063, 'binary_specificity': 0.99498594, 'binary_f1_score': 0.68694097}
confusion matrix:
       0    1
0  18058   91
1    259  384
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9613295, 'precision': 0.79944545, 'recall': 0.58403915, 'specificity': 0.58403915, 'f1': 0.6256111, 'auroc': 0.9574455, 'binary_precision': 0.63380283, 'binary_recall': 0.1724138, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.27108437}
confusion matrix:
      0   1
0  5971  26
1   216  45
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011747_18.png
early stop counter: 6
val acc:0.9813750386238098, best validation acc: 0.9877075552940369, corresponding to test acc:                         0.9635666608810425 / 0.9741131067276001
after epoch: 18,now: 2024-06-02 08:13:47.413176,epoch time: 0:37:51.061281,used: 11:27:18.513938,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_20_46_28_seed_0_21011747
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9924187, 'precision': 0.9254538, 'recall': 0.9649309, 'specificity': 0.9649309, 'f1': 0.94424415, 'auroc': 0.9980212, 'binary_precision': 0.85315984, 'binary_recall': 0.93546194, 'binary_specificity': 0.9943998, 'binary_f1_score': 0.8924174}
confusion matrix:
       0     1
0  42083   237
1     95  1377
---- Validation: 
scalar performance:
{'acc': 0.9849404, 'precision': 0.8858668, 'recall': 0.88644564, 'specificity': 0.88644564, 'f1': 0.88615596, 'auroc': 0.97667897, 'binary_precision': 0.7795031, 'binary_recall': 0.7807154, 'binary_specificity': 0.9921759, 'binary_f1_score': 0.78010875}
confusion matrix:
       0    1
0  18007  142
1    141  502
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9613295, 'precision': 0.8750639, 'recall': 0.5492248, 'specificity': 0.5492248, 'f1': 0.5785352, 'auroc': 0.9287934, 'binary_precision': 0.7878788, 'binary_recall': 0.099616855, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.17687075}
confusion matrix:
      0   1
0  5990   7
1   235  26
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011747_19.png
early stop counter: 7
val acc:0.9849404096603394, best validation acc: 0.9877075552940369, corresponding to test acc:                         0.9635666608810425 / 0.9741131067276001
after epoch: 19,now: 2024-06-02 08:51:33.043830,epoch time: 0:37:45.630654,used: 12:05:04.144592,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_20_46_28_seed_0_21011747
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9949534, 'precision': 0.95986986, 'recall': 0.96258694, 'specificity': 0.96258694, 'f1': 0.9612241, 'auroc': 0.99880606, 'binary_precision': 0.9222448, 'binary_recall': 0.92789114, 'binary_specificity': 0.99728274, 'binary_f1_score': 0.9250593}
confusion matrix:
       0     1
0  42207   115
1    106  1364
---- Validation: 
scalar performance:
{'acc': 0.98797363, 'precision': 0.9297198, 'recall': 0.88051546, 'specificity': 0.88051546, 'f1': 0.90350497, 'auroc': 0.98621494, 'binary_precision': 0.8677249, 'binary_recall': 0.7651633, 'binary_specificity': 0.99586755, 'binary_f1_score': 0.8132231}
confusion matrix:
       0    1
0  18074   75
1    151  492
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96612334, 'precision': 0.90164006, 'recall': 0.6158577, 'specificity': 0.6158577, 'f1': 0.6739334, 'auroc': 0.95127964, 'binary_precision': 0.8356164, 'binary_recall': 0.23371647, 'binary_specificity': 0.997999, 'binary_f1_score': 0.36526945}
confusion matrix:
      0   1
0  5985  12
1   200  61
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011747_20.png
better model found
persisted
after epoch: 20,now: 2024-06-02 09:29:17.179010,epoch time: 0:37:44.135180,used: 12:42:48.279772,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_20_46_28_seed_0_21011747
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9900667, 'precision': 0.9836791, 'recall': 0.86024886, 'specificity': 0.86024886, 'f1': 0.91231483, 'auroc': 0.9970803, 'binary_precision': 0.9769585, 'binary_recall': 0.7210884, 'binary_specificity': 0.9994093, 'binary_f1_score': 0.82974553}
confusion matrix:
       0     1
0  42297    25
1    410  1060
---- Validation: 
scalar performance:
{'acc': 0.9813218, 'precision': 0.9377946, 'recall': 0.75706285, 'specificity': 0.75706285, 'f1': 0.8222944, 'auroc': 0.97956634, 'binary_precision': 0.8924731, 'binary_recall': 0.5163297, 'binary_specificity': 0.997796, 'binary_f1_score': 0.6541872}
confusion matrix:
       0    1
0  18109   40
1    311  332
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9646852, 'precision': 0.91793823, 'recall': 0.5894547, 'specificity': 0.5894547, 'f1': 0.6401497, 'auroc': 0.9509319, 'binary_precision': 0.8703704, 'binary_recall': 0.18007663, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.2984127}
confusion matrix:
      0   1
0  5990   7
1   214  47
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011747_21.png
early stop counter: 1
val acc:0.9813218116760254, best validation acc: 0.9879736304283142, corresponding to test acc:                         0.9661233425140381 / 0.9741131067276001
after epoch: 21,now: 2024-06-02 10:06:58.722330,epoch time: 0:37:41.543320,used: 13:20:29.823092,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_20_46_28_seed_0_21011747
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9920077, 'precision': 0.9517609, 'recall': 0.92204463, 'specificity': 0.92204463, 'f1': 0.9363586, 'auroc': 0.9981637, 'binary_precision': 0.9088257, 'binary_recall': 0.8470428, 'binary_specificity': 0.9970464, 'binary_f1_score': 0.8768473}
confusion matrix:
       0     1
0  42196   125
1    225  1246
---- Validation: 
scalar performance:
{'acc': 0.9841954, 'precision': 0.9124613, 'recall': 0.8320559, 'specificity': 0.8320559, 'f1': 0.8675742, 'auroc': 0.97882795, 'binary_precision': 0.83657587, 'binary_recall': 0.6687403, 'binary_specificity': 0.99537164, 'binary_f1_score': 0.7433017}
confusion matrix:
       0    1
0  18065   84
1    213  430
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.7698505, 'recall': 0.555637, 'specificity': 0.555637, 'f1': 0.58548033, 'auroc': 0.947237, 'binary_precision': 0.5769231, 'binary_recall': 0.11494253, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.19169329}
confusion matrix:
      0   1
0  5975  22
1   231  30
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011747_22.png
early stop counter: 2
val acc:0.9841954112052917, best validation acc: 0.9879736304283142, corresponding to test acc:                         0.9661233425140381 / 0.9741131067276001
after epoch: 22,now: 2024-06-02 10:44:36.142329,epoch time: 0:37:37.419999,used: 13:58:07.243091,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_20_46_28_seed_0_21011747
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9909116, 'precision': 0.98163766, 'recall': 0.8752167, 'specificity': 0.8752167, 'f1': 0.92135453, 'auroc': 0.9985953, 'binary_precision': 0.97185576, 'binary_recall': 0.75118965, 'binary_specificity': 0.99924386, 'binary_f1_score': 0.8473927}
confusion matrix:
       0     1
0  42289    32
1    366  1105
---- Validation: 
scalar performance:
{'acc': 0.98185396, 'precision': 0.9547347, 'recall': 0.75433815, 'specificity': 0.75433815, 'f1': 0.8243269, 'auroc': 0.9822482, 'binary_precision': 0.92655367, 'binary_recall': 0.5101089, 'binary_specificity': 0.9985674, 'binary_f1_score': 0.65797395}
confusion matrix:
       0    1
0  18123   26
1    315  328
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96324706, 'precision': 0.8970221, 'recall': 0.57404566, 'specificity': 0.57404566, 'f1': 0.6172033, 'auroc': 0.9584079, 'binary_precision': 0.82978725, 'binary_recall': 0.14942528, 'binary_specificity': 0.998666, 'binary_f1_score': 0.25324675}
confusion matrix:
      0   1
0  5989   8
1   222  39
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011747_23.png
early stop counter: 3
val acc:0.9818539619445801, best validation acc: 0.9879736304283142, corresponding to test acc:                         0.9661233425140381 / 0.9741131067276001
after epoch: 23,now: 2024-06-02 11:22:08.001929,epoch time: 0:37:31.859600,used: 14:35:39.102691,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_20_46_28_seed_0_21011747
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99547863, 'precision': 0.9640566, 'recall': 0.9664922, 'specificity': 0.9664922, 'f1': 0.96527094, 'auroc': 0.99921155, 'binary_precision': 0.93035835, 'binary_recall': 0.93541807, 'binary_specificity': 0.9975662, 'binary_f1_score': 0.93288136}
confusion matrix:
       0     1
0  42218   103
1     95  1376
---- Validation: 
scalar performance:
{'acc': 0.9861111, 'precision': 0.9015491, 'recall': 0.8840515, 'specificity': 0.8840515, 'f1': 0.892589, 'auroc': 0.9807482, 'binary_precision': 0.8110749, 'binary_recall': 0.7744945, 'binary_specificity': 0.9936085, 'binary_f1_score': 0.79236275}
confusion matrix:
       0    1
0  18033  116
1    145  498
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96612334, 'precision': 0.84758615, 'recall': 0.6488397, 'specificity': 0.6488397, 'f1': 0.70478636, 'auroc': 0.95670056, 'binary_precision': 0.72477067, 'binary_recall': 0.30268198, 'binary_specificity': 0.9949975, 'binary_f1_score': 0.42702702}
confusion matrix:
      0   1
0  5967  30
1   182  79
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011747_24.png
early stop counter: 4
val acc:0.9861111044883728, best validation acc: 0.9879736304283142, corresponding to test acc:                         0.9661233425140381 / 0.9741131067276001
after epoch: 24,now: 2024-06-02 11:59:42.325763,epoch time: 0:37:34.323834,used: 15:13:13.426525,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_20_46_28_seed_0_21011747
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99561566, 'precision': 0.9615493, 'recall': 0.9718307, 'specificity': 0.9718307, 'f1': 0.9666289, 'auroc': 0.999321, 'binary_precision': 0.9249668, 'binary_recall': 0.9463315, 'binary_specificity': 0.9973299, 'binary_f1_score': 0.93552715}
confusion matrix:
       0     1
0  42207   113
1     79  1393
---- Validation: 
scalar performance:
{'acc': 0.9871754, 'precision': 0.9115015, 'recall': 0.8898529, 'specificity': 0.8898529, 'f1': 0.9003606, 'auroc': 0.98238707, 'binary_precision': 0.8305921, 'binary_recall': 0.785381, 'binary_specificity': 0.99432474, 'binary_f1_score': 0.80735415}
confusion matrix:
       0    1
0  18046  103
1    138  505
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608501, 'precision': 0.7852424, 'recall': 0.58562136, 'specificity': 0.58562136, 'f1': 0.6264402, 'auroc': 0.948779, 'binary_precision': 0.6052632, 'binary_recall': 0.17624521, 'binary_specificity': 0.9949975, 'binary_f1_score': 0.27299705}
confusion matrix:
      0   1
0  5967  30
1   215  46
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011747_25.png
early stop counter: 5
val acc:0.9871754050254822, best validation acc: 0.9879736304283142, corresponding to test acc:                         0.9661233425140381 / 0.9741131067276001
after epoch: 25,now: 2024-06-02 12:37:15.912521,epoch time: 0:37:33.586758,used: 15:50:47.013283,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_20_46_28_seed_0_21011747
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99568415, 'precision': 0.98093385, 'recall': 0.95153886, 'specificity': 0.95153886, 'f1': 0.9657384, 'auroc': 0.99949133, 'binary_precision': 0.96519214, 'binary_recall': 0.90421194, 'binary_specificity': 0.9988658, 'binary_f1_score': 0.9337074}
confusion matrix:
       0     1
0  42272    48
1    141  1331
---- Validation: 
scalar performance:
{'acc': 0.98648363, 'precision': 0.9394505, 'recall': 0.84374136, 'specificity': 0.84374136, 'f1': 0.8853066, 'auroc': 0.9840007, 'binary_precision': 0.88977957, 'binary_recall': 0.6905132, 'binary_specificity': 0.9969695, 'binary_f1_score': 0.77758324}
confusion matrix:
       0    1
0  18094   55
1    199  444
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96212846, 'precision': 0.8815857, 'recall': 0.5606357, 'specificity': 0.5606357, 'f1': 0.5966111, 'auroc': 0.9395694, 'binary_precision': 0.8, 'binary_recall': 0.12260536, 'binary_specificity': 0.998666, 'binary_f1_score': 0.21262458}
confusion matrix:
      0   1
0  5989   8
1   229  32
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011747_26.png
early stop counter: 6
val acc:0.986483633518219, best validation acc: 0.9879736304283142, corresponding to test acc:                         0.9661233425140381 / 0.9741131067276001
after epoch: 26,now: 2024-06-02 13:14:39.924836,epoch time: 0:37:24.012315,used: 16:28:11.025598,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_20_46_28_seed_0_21011747
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9955243, 'precision': 0.9728804, 'recall': 0.95735765, 'specificity': 0.95735765, 'f1': 0.96497965, 'auroc': 0.99911195, 'binary_precision': 0.94866383, 'binary_recall': 0.9164402, 'binary_specificity': 0.99827504, 'binary_f1_score': 0.9322737}
confusion matrix:
       0     1
0  42247    73
1    123  1349
---- Validation: 
scalar performance:
{'acc': 0.9874947, 'precision': 0.93292415, 'recall': 0.8682666, 'specificity': 0.8682666, 'f1': 0.8977826, 'auroc': 0.98237026, 'binary_precision': 0.875, 'binary_recall': 0.7402799, 'binary_specificity': 0.99625325, 'binary_f1_score': 0.80202186}
confusion matrix:
       0    1
0  18081   68
1    167  476
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9638862, 'precision': 0.85643, 'recall': 0.6000318, 'specificity': 0.6000318, 'f1': 0.6503641, 'auroc': 0.94447064, 'binary_precision': 0.74647886, 'binary_recall': 0.20306513, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.3192771}
confusion matrix:
      0   1
0  5979  18
1   208  53
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011747_27.png
early stop counter: 7
val acc:0.987494707107544, best validation acc: 0.9879736304283142, corresponding to test acc:                         0.9661233425140381 / 0.9741131067276001
after epoch: 27,now: 2024-06-02 13:52:04.252181,epoch time: 0:37:24.327345,used: 17:05:35.352943,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_20_46_28_seed_0_21011747
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99723697, 'precision': 0.9797768, 'recall': 0.9775727, 'specificity': 0.9775727, 'f1': 0.978672, 'auroc': 0.9996576, 'binary_precision': 0.9610656, 'binary_recall': 0.9564922, 'binary_specificity': 0.9986532, 'binary_f1_score': 0.9587735}
confusion matrix:
       0     1
0  42264    57
1     64  1407
---- Validation: 
scalar performance:
{'acc': 0.9883461, 'precision': 0.92768985, 'recall': 0.88970894, 'specificity': 0.88970894, 'f1': 0.9077462, 'auroc': 0.9836176, 'binary_precision': 0.8630137, 'binary_recall': 0.7838258, 'binary_specificity': 0.99559206, 'binary_f1_score': 0.82151586}
confusion matrix:
       0    1
0  18069   80
1    139  504
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581336, 'precision': 0.72274554, 'recall': 0.529234, 'specificity': 0.529234, 'f1': 0.54370344, 'auroc': 0.9288069, 'binary_precision': 0.4848485, 'binary_recall': 0.06130268, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.108843535}
confusion matrix:
      0   1
0  5980  17
1   245  16
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011747_28.png
better model found
persisted
after epoch: 28,now: 2024-06-02 14:29:24.360604,epoch time: 0:37:20.108423,used: 17:42:55.461366,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_20_46_28_seed_0_21011747
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99616367, 'precision': 0.9779683, 'recall': 0.9622785, 'specificity': 0.9622785, 'f1': 0.9699826, 'auroc': 0.99953675, 'binary_precision': 0.95850915, 'binary_recall': 0.92595106, 'binary_specificity': 0.99860585, 'binary_f1_score': 0.9419489}
confusion matrix:
       0     1
0  42261    59
1    109  1363
---- Validation: 
scalar performance:
{'acc': 0.9870157, 'precision': 0.9316285, 'recall': 0.86126816, 'specificity': 0.86126816, 'f1': 0.8930836, 'auroc': 0.98088825, 'binary_precision': 0.8728972, 'binary_recall': 0.7262831, 'binary_specificity': 0.99625325, 'binary_f1_score': 0.79286927}
confusion matrix:
       0    1
0  18081   68
1    176  467
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.8486262, 'recall': 0.52640307, 'specificity': 0.52640307, 'f1': 0.5397025, 'auroc': 0.9302819, 'binary_precision': 0.7368421, 'binary_recall': 0.053639848, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.1}
confusion matrix:
      0   1
0  5992   5
1   247  14
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011747_29.png
early stop counter: 1
val acc:0.9870157241821289, best validation acc: 0.9883460998535156, corresponding to test acc:                         0.9581335783004761 / 0.9741131067276001
after epoch: 29,now: 2024-06-02 15:06:42.309453,epoch time: 0:37:17.948849,used: 18:20:13.410215,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_20_46_28_seed_0_21011747
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99748814, 'precision': 0.9824872, 'recall': 0.9786869, 'specificity': 0.9786869, 'f1': 0.980579, 'auroc': 0.99976176, 'binary_precision': 0.96641535, 'binary_recall': 0.9585316, 'binary_specificity': 0.9988422, 'binary_f1_score': 0.96245736}
confusion matrix:
       0     1
0  42272    49
1     61  1410
---- Validation: 
scalar performance:
{'acc': 0.98808, 'precision': 0.9412482, 'recall': 0.8693197, 'specificity': 0.8693197, 'f1': 0.9018471, 'auroc': 0.98155135, 'binary_precision': 0.8915888, 'binary_recall': 0.7418352, 'binary_specificity': 0.99680424, 'binary_f1_score': 0.8098472}
confusion matrix:
       0    1
0  18091   58
1    166  477
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9610099, 'precision': 0.8219905, 'recall': 0.56005204, 'specificity': 0.56005204, 'f1': 0.59390265, 'auroc': 0.93454486, 'binary_precision': 0.68085104, 'binary_recall': 0.12260536, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.2077922}
confusion matrix:
      0   1
0  5982  15
1   229  32
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011747_30.png
early stop counter: 2
val acc:0.9880800247192383, best validation acc: 0.9883460998535156, corresponding to test acc:                         0.9581335783004761 / 0.9741131067276001
after epoch: 30,now: 2024-06-02 15:44:01.855844,epoch time: 0:37:19.546391,used: 18:57:32.956606,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_20_46_28_seed_0_21011747
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 18:57:32.956606 at 2024-06-02 15:44:01.855844
persisted model performance metric: 

scalar performance:
{'acc': 0.9590924, 'precision': 0.7708108, 'recall': 0.53339887, 'specificity': 0.53339887, 'f1': 0.5511726, 'auroc': 0.9221431, 'binary_precision': 0.58064514, 'binary_recall': 0.06896552, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.12328768}
confusion matrix:
      0   1
0  5984  13
1   243  18
oracle model performance metric: 

scalar performance:
{'acc': 0.9758709, 'precision': 0.847292, 'recall': 0.85365, 'specificity': 0.85365, 'f1': 0.85043883, 'auroc': 0.95404506, 'binary_precision': 0.7067669, 'binary_recall': 0.7203065, 'binary_specificity': 0.9869935, 'binary_f1_score': 0.7134725}
confusion matrix:
      0    1
0  5919   78
1    73  188
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/rule_results/5.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1661 MiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |   1655 MiB |  15779 MiB |    977 TiB |    977 TiB |
|       from small pool |      6 MiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1661 MiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |   1655 MiB |  15779 MiB |    977 TiB |    977 TiB |
|       from small pool |      6 MiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1653 MiB |  15770 MiB |    987 TiB |    987 TiB |
|       from large pool |   1647 MiB |  15745 MiB |    974 TiB |    974 TiB |
|       from small pool |      5 MiB |     25 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  16730 MiB |  16730 MiB |  16730 MiB |      0 B   |
|       from large pool |  16702 MiB |  16702 MiB |  16702 MiB |      0 B   |
|       from small pool |     28 MiB |     28 MiB |     28 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 430238 KiB |    863 MiB | 413551 GiB | 413551 GiB |
|       from large pool | 410304 KiB |    862 MiB | 400661 GiB | 400660 GiB |
|       from small pool |  19934 KiB |     21 MiB |  12890 GiB |  12890 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3366    |    6357    |  152224 K  |  152220 K  |
|       from large pool |     247    |     989    |   62327 K  |   62326 K  |
|       from small pool |    3119    |    6108    |   89897 K  |   89893 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3366    |    6357    |  152224 K  |  152220 K  |
|       from large pool |     247    |     989    |   62327 K  |   62326 K  |
|       from small pool |    3119    |    6108    |   89897 K  |   89893 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     621    |     621    |     621    |       0    |
|       from large pool |     607    |     607    |     607    |       0    |
|       from small pool |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     147    |    2873    |   89965 K  |   89964 K  |
|       from large pool |     112    |     516    |   47275 K  |   47275 K  |
|       from small pool |      35    |    2761    |   42689 K  |   42689 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |  16640 KiB |  15779 MiB |    977 TiB |    977 TiB |
|       from small pool |      0 KiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |  16640 KiB |  15779 MiB |    977 TiB |    977 TiB |
|       from small pool |      0 KiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15770 MiB |    987 TiB |    987 TiB |
|       from large pool |  16640 KiB |  15745 MiB |    974 TiB |    974 TiB |
|       from small pool |      0 KiB |     25 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2082 MiB |  16730 MiB |  16730 MiB |  14648 MiB |
|       from large pool |   2056 MiB |  16702 MiB |  16702 MiB |  14646 MiB |
|       from small pool |     26 MiB |     28 MiB |     28 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    863 MiB | 413552 GiB | 413552 GiB |
|       from large pool |  24320 KiB |    862 MiB | 400662 GiB | 400662 GiB |
|       from small pool |      0 KiB |     25 MiB |  12890 GiB |  12890 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6357    |  152224 K  |  152224 K  |
|       from large pool |       2    |     989    |   62327 K  |   62327 K  |
|       from small pool |       0    |    6108    |   89897 K  |   89897 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6357    |  152224 K  |  152224 K  |
|       from large pool |       2    |     989    |   62327 K  |   62327 K  |
|       from small pool |       0    |    6108    |   89897 K  |   89897 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     115    |     621    |     621    |     506    |
|       from large pool |     102    |     607    |     607    |     505    |
|       from small pool |      13    |      14    |      14    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    2873    |   89966 K  |   89966 K  |
|       from large pool |       2    |     516    |   47275 K  |   47275 K  |
|       from small pool |       0    |    2761    |   42690 K  |   42690 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |  16640 KiB |  15779 MiB |    977 TiB |    977 TiB |
|       from small pool |      0 KiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |  16640 KiB |  15779 MiB |    977 TiB |    977 TiB |
|       from small pool |      0 KiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15770 MiB |    987 TiB |    987 TiB |
|       from large pool |  16640 KiB |  15745 MiB |    974 TiB |    974 TiB |
|       from small pool |      0 KiB |     25 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2082 MiB |  16730 MiB |  16730 MiB |  14648 MiB |
|       from large pool |   2056 MiB |  16702 MiB |  16702 MiB |  14646 MiB |
|       from small pool |     26 MiB |     28 MiB |     28 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    863 MiB | 413552 GiB | 413552 GiB |
|       from large pool |  24320 KiB |    862 MiB | 400662 GiB | 400662 GiB |
|       from small pool |      0 KiB |     25 MiB |  12890 GiB |  12890 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6357    |  152224 K  |  152224 K  |
|       from large pool |       2    |     989    |   62327 K  |   62327 K  |
|       from small pool |       0    |    6108    |   89897 K  |   89897 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6357    |  152224 K  |  152224 K  |
|       from large pool |       2    |     989    |   62327 K  |   62327 K  |
|       from small pool |       0    |    6108    |   89897 K  |   89897 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     115    |     621    |     621    |     506    |
|       from large pool |     102    |     607    |     607    |     505    |
|       from small pool |      13    |      14    |      14    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    2873    |   89966 K  |   89966 K  |
|       from large pool |       2    |     516    |   47275 K  |   47275 K  |
|       from small pool |       0    |    2761    |   42690 K  |   42690 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_15_53_44_seed_1_21011747

 Experiment start at: 2024-06-02 15:53:44.088667
before training, model accuracy: 0.06445375829935074
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9714748, 'precision': 0.7729403, 'recall': 0.8080629, 'specificity': 0.8080629, 'f1': 0.789327, 'auroc': 0.9661946, 'binary_precision': 0.5584098, 'binary_recall': 0.63314843, 'binary_specificity': 0.98297733, 'binary_f1_score': 0.5934352}
confusion matrix:
       0    1
0  41692  722
1    529  913
---- Validation: 
scalar performance:
{'acc': 0.9686766, 'precision': 0.7711508, 'recall': 0.80779916, 'specificity': 0.80779916, 'f1': 0.78817797, 'auroc': 0.9630151, 'binary_precision': 0.55598956, 'binary_recall': 0.6344725, 'binary_specificity': 0.98112583, 'binary_f1_score': 0.5926439}
confusion matrix:
       0    1
0  17726  341
1    246  427
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9653561, 'precision': 0.8364211, 'recall': 0.647225, 'specificity': 0.647225, 'f1': 0.70131475, 'auroc': 0.9456414, 'binary_precision': 0.7027027, 'binary_recall': 0.3, 'binary_specificity': 0.99445003, 'binary_f1_score': 0.4204852}
confusion matrix:
      0   1
0  5913  33
1   182  78
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011747_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-02 16:32:47.282839,epoch time: 0:39:03.194172,used: 0:39:03.194172,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_15_53_44_seed_1_21011747
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97637725, 'precision': 0.808108, 'recall': 0.841413, 'specificity': 0.841413, 'f1': 0.82382274, 'auroc': 0.9766588, 'binary_precision': 0.6265586, 'binary_recall': 0.6969487, 'binary_specificity': 0.9858773, 'binary_f1_score': 0.65988183}
confusion matrix:
       0     1
0  41815   599
1    437  1005
---- Validation: 
scalar performance:
{'acc': 0.9768943, 'precision': 0.84720826, 'recall': 0.7977557, 'specificity': 0.7977557, 'f1': 0.8204081, 'auroc': 0.9744597, 'binary_precision': 0.70905924, 'binary_recall': 0.6047548, 'binary_specificity': 0.99075663, 'binary_f1_score': 0.65276664}
confusion matrix:
       0    1
0  17900  167
1    266  407
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96455044, 'precision': 0.8501843, 'recall': 0.6192198, 'specificity': 0.6192198, 'f1': 0.6729644, 'auroc': 0.95321107, 'binary_precision': 0.73255813, 'binary_recall': 0.2423077, 'binary_specificity': 0.99613184, 'binary_f1_score': 0.36416185}
confusion matrix:
      0   1
0  5923  23
1   197  63
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011747_2.png
better model found
persisted
after epoch: 2,now: 2024-06-02 17:10:27.898310,epoch time: 0:37:40.615471,used: 1:16:43.809643,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_15_53_44_seed_1_21011747
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97877145, 'precision': 0.8219733, 'recall': 0.8727965, 'specificity': 0.8727965, 'f1': 0.84534615, 'auroc': 0.9797492, 'binary_precision': 0.65217394, 'binary_recall': 0.759362, 'binary_specificity': 0.98623097, 'binary_f1_score': 0.7016982}
confusion matrix:
       0     1
0  41830   584
1    347  1095
---- Validation: 
scalar performance:
{'acc': 0.9772145, 'precision': 0.83709776, 'recall': 0.8308241, 'specificity': 0.8308241, 'f1': 0.83392847, 'auroc': 0.9760684, 'binary_precision': 0.68636364, 'binary_recall': 0.6731055, 'binary_specificity': 0.9885427, 'binary_f1_score': 0.67966986}
confusion matrix:
       0    1
0  17860  207
1    220  453
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96793425, 'precision': 0.88633, 'recall': 0.6540874, 'specificity': 0.6540874, 'f1': 0.7161202, 'auroc': 0.9535707, 'binary_precision': 0.8019802, 'binary_recall': 0.31153846, 'binary_specificity': 0.9966364, 'binary_f1_score': 0.44875345}
confusion matrix:
      0   1
0  5926  20
1   179  81
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011747_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-02 17:47:52.687904,epoch time: 0:37:24.789594,used: 1:54:08.599237,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_15_53_44_seed_1_21011747
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9833318, 'precision': 0.8653393, 'recall': 0.87682897, 'specificity': 0.87682897, 'f1': 0.8709874, 'auroc': 0.9835721, 'binary_precision': 0.7387508, 'binary_recall': 0.7628294, 'binary_specificity': 0.9908285, 'binary_f1_score': 0.75059706}
confusion matrix:
       0     1
0  42025   389
1    342  1100
---- Validation: 
scalar performance:
{'acc': 0.98127, 'precision': 0.8804627, 'recall': 0.8350731, 'specificity': 0.8350731, 'f1': 0.8561993, 'auroc': 0.9759754, 'binary_precision': 0.7728813, 'binary_recall': 0.67756313, 'binary_specificity': 0.99258316, 'binary_f1_score': 0.72209024}
confusion matrix:
       0    1
0  17933  134
1    217  456
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9658395, 'precision': 0.9100157, 'recall': 0.61069757, 'specificity': 0.61069757, 'f1': 0.6680573, 'auroc': 0.95955974, 'binary_precision': 0.85294116, 'binary_recall': 0.22307692, 'binary_specificity': 0.9983182, 'binary_f1_score': 0.35365856}
confusion matrix:
      0   1
0  5936  10
1   202  58
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011747_4.png
better model found
persisted
after epoch: 4,now: 2024-06-02 18:25:20.563564,epoch time: 0:37:27.875660,used: 2:31:36.474897,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_15_53_44_seed_1_21011747
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9840159, 'precision': 0.8718868, 'recall': 0.8791116, 'specificity': 0.8791116, 'f1': 0.87546146, 'auroc': 0.985322, 'binary_precision': 0.7517007, 'binary_recall': 0.7668286, 'binary_specificity': 0.9913946, 'binary_f1_score': 0.7591893}
confusion matrix:
       0     1
0  42050   365
1    336  1105
---- Validation: 
scalar performance:
{'acc': 0.98223054, 'precision': 0.88302994, 'recall': 0.8505919, 'specificity': 0.8505919, 'f1': 0.866029, 'auroc': 0.9792409, 'binary_precision': 0.776873, 'binary_recall': 0.7087667, 'binary_specificity': 0.9924171, 'binary_f1_score': 0.74125874}
confusion matrix:
       0    1
0  17930  137
1    196  477
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597164, 'precision': 0.97982574, 'recall': 0.5192308, 'specificity': 0.5192308, 'f1': 0.52674216, 'auroc': 0.95995533, 'binary_precision': 1.0, 'binary_recall': 0.03846154, 'binary_specificity': 1.0, 'binary_f1_score': 0.074074075}
confusion matrix:
      0   1
0  5946   0
1   250  10
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011747_5.png
better model found
persisted
after epoch: 5,now: 2024-06-02 19:02:50.602441,epoch time: 0:37:30.038877,used: 3:09:06.513774,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_15_53_44_seed_1_21011747
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98027635, 'precision': 0.9747705, 'recall': 0.7064334, 'specificity': 0.7064334, 'f1': 0.784693, 'auroc': 0.9883808, 'binary_precision': 0.9691057, 'binary_recall': 0.41331485, 'binary_specificity': 0.999552, 'binary_f1_score': 0.5794847}
confusion matrix:
       0    1
0  42395   19
1    846  596
---- Validation: 
scalar performance:
{'acc': 0.976841, 'precision': 0.9657667, 'recall': 0.6861464, 'specificity': 0.6861464, 'f1': 0.7622243, 'auroc': 0.97943366, 'binary_precision': 0.95437264, 'binary_recall': 0.3729569, 'binary_specificity': 0.9993358, 'binary_f1_score': 0.5363248}
confusion matrix:
       0    1
0  18055   12
1    422  251
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614889, 'precision': 0.98067904, 'recall': 0.5403846, 'specificity': 0.5403846, 'f1': 0.56488234, 'auroc': 0.9603028, 'binary_precision': 1.0, 'binary_recall': 0.08076923, 'binary_specificity': 1.0, 'binary_f1_score': 0.1494662}
confusion matrix:
      0   1
0  5946   0
1   239  21
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011747_6.png
early stop counter: 1
val acc:0.9768409729003906, best validation acc: 0.982230544090271, corresponding to test acc:                         0.9597163796424866 / 0.967934250831604
after epoch: 6,now: 2024-06-02 19:40:20.309104,epoch time: 0:37:29.706663,used: 3:46:36.220437,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_15_53_44_seed_1_21011747
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98121125, 'precision': 0.8253362, 'recall': 0.9474124, 'specificity': 0.9474124, 'f1': 0.87575924, 'auroc': 0.99017453, 'binary_precision': 0.65373135, 'binary_recall': 0.9112344, 'binary_specificity': 0.9835903, 'binary_f1_score': 0.76129776}
confusion matrix:
       0     1
0  41718   696
1    128  1314
---- Validation: 
scalar performance:
{'acc': 0.9779082, 'precision': 0.81939006, 'recall': 0.9213075, 'specificity': 0.9213075, 'f1': 0.86255586, 'auroc': 0.9807526, 'binary_precision': 0.6440489, 'binary_recall': 0.8603269, 'binary_specificity': 0.9822881, 'binary_f1_score': 0.73664117}
confusion matrix:
       0    1
0  17747  320
1     94  579
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96165, 'precision': 0.7858212, 'recall': 0.61954516, 'specificity': 0.61954516, 'f1': 0.6649846, 'auroc': 0.96523166, 'binary_precision': 0.6037736, 'binary_recall': 0.24615385, 'binary_specificity': 0.99293643, 'binary_f1_score': 0.34972677}
confusion matrix:
      0   1
0  5904  42
1   196  64
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011747_7.png
early stop counter: 2
val acc:0.977908194065094, best validation acc: 0.982230544090271, corresponding to test acc:                         0.9597163796424866 / 0.967934250831604
after epoch: 7,now: 2024-06-02 20:17:49.990322,epoch time: 0:37:29.681218,used: 4:24:05.901655,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_15_53_44_seed_1_21011747
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98606807, 'precision': 0.93719316, 'recall': 0.8293406, 'specificity': 0.8293406, 'f1': 0.8751358, 'auroc': 0.9919394, 'binary_precision': 0.88579386, 'binary_recall': 0.66158116, 'binary_specificity': 0.9971, 'binary_f1_score': 0.7574435}
confusion matrix:
       0    1
0  42291  123
1    488  954
---- Validation: 
scalar performance:
{'acc': 0.98191035, 'precision': 0.9239725, 'recall': 0.7932045, 'specificity': 0.7932045, 'f1': 0.84573376, 'auroc': 0.97871596, 'binary_precision': 0.8630435, 'binary_recall': 0.58989596, 'binary_specificity': 0.996513, 'binary_f1_score': 0.7007943}
confusion matrix:
       0    1
0  18004   63
1    276  397
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590719, 'precision': 0.81329453, 'recall': 0.5225724, 'specificity': 0.5225724, 'f1': 0.532699, 'auroc': 0.95644844, 'binary_precision': 0.6666667, 'binary_recall': 0.046153847, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.086330935}
confusion matrix:
      0   1
0  5940   6
1   248  12
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011747_8.png
early stop counter: 3
val acc:0.9819103479385376, best validation acc: 0.982230544090271, corresponding to test acc:                         0.9597163796424866 / 0.967934250831604
after epoch: 8,now: 2024-06-02 20:55:20.910054,epoch time: 0:37:30.919732,used: 5:01:36.821387,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_15_53_44_seed_1_21011747
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98853064, 'precision': 0.91101724, 'recall': 0.9079877, 'specificity': 0.9079877, 'f1': 0.9094964, 'auroc': 0.993442, 'binary_precision': 0.8280922, 'binary_recall': 0.8217753, 'binary_specificity': 0.99420005, 'binary_f1_score': 0.82492167}
confusion matrix:
       0     1
0  42168   246
1    257  1185
---- Validation: 
scalar performance:
{'acc': 0.98372465, 'precision': 0.9047189, 'recall': 0.8470752, 'specificity': 0.8470752, 'f1': 0.8734976, 'auroc': 0.9758321, 'binary_precision': 0.8205575, 'binary_recall': 0.6998514, 'binary_specificity': 0.994299, 'binary_f1_score': 0.75541294}
confusion matrix:
       0    1
0  17964  103
1    202  471
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96100545, 'precision': 0.84376824, 'recall': 0.5548442, 'specificity': 0.5548442, 'f1': 0.5866766, 'auroc': 0.94610226, 'binary_precision': 0.725, 'binary_recall': 0.11153846, 'binary_specificity': 0.99815, 'binary_f1_score': 0.19333334}
confusion matrix:
      0   1
0  5935  11
1   231  29
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011747_9.png
better model found
persisted
after epoch: 9,now: 2024-06-02 21:32:57.495308,epoch time: 0:37:36.585254,used: 5:39:13.406641,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_15_53_44_seed_1_21011747
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9819637, 'precision': 0.83137023, 'recall': 0.94512177, 'specificity': 0.94512177, 'f1': 0.8790879, 'auroc': 0.9916961, 'binary_precision': 0.6659867, 'binary_recall': 0.90568656, 'binary_specificity': 0.984557, 'binary_f1_score': 0.76755804}
confusion matrix:
       0     1
0  41759   655
1    136  1306
---- Validation: 
scalar performance:
{'acc': 0.97950906, 'precision': 0.83452356, 'recall': 0.9056866, 'specificity': 0.9056866, 'f1': 0.86632204, 'auroc': 0.9799636, 'binary_precision': 0.67557716, 'binary_recall': 0.82615155, 'binary_specificity': 0.9852217, 'binary_f1_score': 0.7433155}
confusion matrix:
       0    1
0  17800  267
1    117  556
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9639059, 'precision': 0.8179184, 'recall': 0.6354343, 'specificity': 0.6354343, 'f1': 0.68635297, 'auroc': 0.95742214, 'binary_precision': 0.6666667, 'binary_recall': 0.2769231, 'binary_specificity': 0.99394554, 'binary_f1_score': 0.39130437}
confusion matrix:
      0   1
0  5910  36
1   188  72
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011747_10.png
early stop counter: 1
val acc:0.9795090556144714, best validation acc: 0.9837246537208557, corresponding to test acc:                         0.961005449295044 / 0.967934250831604
after epoch: 10,now: 2024-06-02 22:10:33.600499,epoch time: 0:37:36.105191,used: 6:16:49.511832,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_15_53_44_seed_1_21011747
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9907196, 'precision': 0.92981356, 'recall': 0.9231874, 'specificity': 0.9231874, 'f1': 0.92647266, 'auroc': 0.99506396, 'binary_precision': 0.86469346, 'binary_recall': 0.85090154, 'binary_specificity': 0.9954732, 'binary_f1_score': 0.857742}
confusion matrix:
       0     1
0  42222   192
1    215  1227
---- Validation: 
scalar performance:
{'acc': 0.9838314, 'precision': 0.91059256, 'recall': 0.8414084, 'specificity': 0.8414084, 'f1': 0.8725499, 'auroc': 0.9758247, 'binary_precision': 0.8327338, 'binary_recall': 0.6879643, 'binary_specificity': 0.9948525, 'binary_f1_score': 0.75345814}
confusion matrix:
       0    1
0  17974   93
1    210  463
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.962778, 'precision': 0.8930134, 'recall': 0.5704811, 'specificity': 0.5704811, 'f1': 0.6117715, 'auroc': 0.9474223, 'binary_precision': 0.82222223, 'binary_recall': 0.1423077, 'binary_specificity': 0.99865454, 'binary_f1_score': 0.24262296}
confusion matrix:
      0   1
0  5938   8
1   223  37
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011747_11.png
better model found
persisted
after epoch: 11,now: 2024-06-02 22:48:11.512224,epoch time: 0:37:37.911725,used: 6:54:27.423557,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_15_53_44_seed_1_21011747
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9900356, 'precision': 0.9468453, 'recall': 0.89000845, 'specificity': 0.89000845, 'f1': 0.9163538, 'auroc': 0.9944024, 'binary_precision': 0.9010375, 'binary_recall': 0.7829404, 'binary_specificity': 0.99707645, 'binary_f1_score': 0.8378479}
confusion matrix:
       0     1
0  42290   124
1    313  1129
---- Validation: 
scalar performance:
{'acc': 0.9832444, 'precision': 0.92248017, 'recall': 0.8175002, 'specificity': 0.8175002, 'f1': 0.8619448, 'auroc': 0.97736186, 'binary_precision': 0.85828346, 'binary_recall': 0.63893014, 'binary_specificity': 0.9960702, 'binary_f1_score': 0.73253834}
confusion matrix:
       0    1
0  17996   71
1    243  430
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96084434, 'precision': 0.8773676, 'recall': 0.5437262, 'specificity': 0.5437262, 'f1': 0.5695625, 'auroc': 0.9502799, 'binary_precision': 0.79310346, 'binary_recall': 0.08846154, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.15916955}
confusion matrix:
      0   1
0  5940   6
1   237  23
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011747_12.png
early stop counter: 1
val acc:0.9832444190979004, best validation acc: 0.9838314056396484, corresponding to test acc:                         0.9627779722213745 / 0.967934250831604
after epoch: 12,now: 2024-06-02 23:25:48.301863,epoch time: 0:37:36.789639,used: 7:32:04.213196,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_15_53_44_seed_1_21011747
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9912441, 'precision': 0.93824685, 'recall': 0.9217837, 'specificity': 0.9217837, 'f1': 0.9298456, 'auroc': 0.994818, 'binary_precision': 0.8816739, 'binary_recall': 0.8474341, 'binary_specificity': 0.9961333, 'binary_f1_score': 0.86421496}
confusion matrix:
       0     1
0  42250   164
1    220  1222
---- Validation: 
scalar performance:
{'acc': 0.9847385, 'precision': 0.92246157, 'recall': 0.8433094, 'specificity': 0.8433094, 'f1': 0.878458, 'auroc': 0.97471845, 'binary_precision': 0.8563536, 'binary_recall': 0.6909361, 'binary_specificity': 0.9956827, 'binary_f1_score': 0.76480263}
confusion matrix:
       0    1
0  17989   78
1    208  465
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96132773, 'precision': 0.8976414, 'recall': 0.5476565, 'specificity': 0.5476565, 'f1': 0.57630754, 'auroc': 0.9181498, 'binary_precision': 0.8333333, 'binary_recall': 0.09615385, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.1724138}
confusion matrix:
      0   1
0  5941   5
1   235  25
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011747_13.png
better model found
persisted
after epoch: 13,now: 2024-06-03 00:03:39.843242,epoch time: 0:37:51.541379,used: 8:09:55.754575,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_15_53_44_seed_1_21011747
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.990332, 'precision': 0.9336301, 'recall': 0.91092867, 'specificity': 0.91092867, 'f1': 0.92195076, 'auroc': 0.99593556, 'binary_precision': 0.87316716, 'binary_recall': 0.8259362, 'binary_specificity': 0.99592113, 'binary_f1_score': 0.84889525}
confusion matrix:
       0     1
0  42241   173
1    251  1191
---- Validation: 
scalar performance:
{'acc': 0.9848986, 'precision': 0.9174806, 'recall': 0.8519757, 'specificity': 0.8519757, 'f1': 0.8817061, 'auroc': 0.9738391, 'binary_precision': 0.84574467, 'binary_recall': 0.7087667, 'binary_specificity': 0.9951846, 'binary_f1_score': 0.77122074}
confusion matrix:
       0    1
0  17980   87
1    196  477
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96019983, 'precision': 0.81879103, 'recall': 0.5470678, 'specificity': 0.5470678, 'f1': 0.5739811, 'auroc': 0.91710246, 'binary_precision': 0.6756757, 'binary_recall': 0.09615385, 'binary_specificity': 0.99798185, 'binary_f1_score': 0.16835018}
confusion matrix:
      0   1
0  5934  12
1   235  25
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011747_14.png
better model found
persisted
after epoch: 14,now: 2024-06-03 00:42:05.315998,epoch time: 0:38:25.472756,used: 8:48:21.227331,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_15_53_44_seed_1_21011747
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98864466, 'precision': 0.93446124, 'recall': 0.8789058, 'specificity': 0.8789058, 'f1': 0.90464365, 'auroc': 0.9961027, 'binary_precision': 0.8769968, 'binary_recall': 0.7614424, 'binary_specificity': 0.9963691, 'binary_f1_score': 0.81514484}
confusion matrix:
       0     1
0  42260   154
1    344  1098
---- Validation: 
scalar performance:
{'acc': 0.98297757, 'precision': 0.9130906, 'recall': 0.82308394, 'specificity': 0.82308394, 'f1': 0.8621314, 'auroc': 0.98148054, 'binary_precision': 0.83908045, 'binary_recall': 0.6508172, 'binary_specificity': 0.99535066, 'binary_f1_score': 0.73305434}
confusion matrix:
       0    1
0  17983   84
1    235  438
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597164, 'precision': 0.93823326, 'recall': 0.52106977, 'specificity': 0.52106977, 'f1': 0.5301446, 'auroc': 0.9415691, 'binary_precision': 0.9166667, 'binary_recall': 0.042307694, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.080882356}
confusion matrix:
      0   1
0  5945   1
1   249  11
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011747_15.png
early stop counter: 1
val acc:0.982977569103241, best validation acc: 0.9848986268043518, corresponding to test acc:                         0.9601998329162598 / 0.967934250831604
after epoch: 15,now: 2024-06-03 01:20:40.371726,epoch time: 0:38:35.055728,used: 9:26:56.283059,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_15_53_44_seed_1_21011747
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9939803, 'precision': 0.9651241, 'recall': 0.93827116, 'specificity': 0.93827116, 'f1': 0.9512689, 'auroc': 0.99787456, 'binary_precision': 0.9343658, 'binary_recall': 0.8786408, 'binary_specificity': 0.9979016, 'binary_f1_score': 0.90564686}
confusion matrix:
       0     1
0  42325    89
1    175  1267
---- Validation: 
scalar performance:
{'acc': 0.9861793, 'precision': 0.93835497, 'recall': 0.850494, 'specificity': 0.850494, 'f1': 0.88913906, 'auroc': 0.9764606, 'binary_precision': 0.8876405, 'binary_recall': 0.70430905, 'binary_specificity': 0.996679, 'binary_f1_score': 0.7854184}
confusion matrix:
       0    1
0  18007   60
1    199  474
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96003866, 'precision': 0.89687026, 'recall': 0.5285939, 'specificity': 0.5285939, 'f1': 0.5437376, 'auroc': 0.9302406, 'binary_precision': 0.8333333, 'binary_recall': 0.057692308, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.10791367}
confusion matrix:
      0   1
0  5943   3
1   245  15
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011747_16.png
better model found
persisted
after epoch: 16,now: 2024-06-03 01:59:11.630361,epoch time: 0:38:31.258635,used: 10:05:27.541694,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_15_53_44_seed_1_21011747
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9865697, 'precision': 0.8629139, 'recall': 0.9665953, 'specificity': 0.9665953, 'f1': 0.9076719, 'auroc': 0.9966279, 'binary_precision': 0.72770953, 'binary_recall': 0.945215, 'binary_specificity': 0.98797566, 'binary_f1_score': 0.8223228}
confusion matrix:
       0     1
0  41904   510
1     79  1363
---- Validation: 
scalar performance:
{'acc': 0.9823906, 'precision': 0.85213405, 'recall': 0.9250628, 'specificity': 0.9250628, 'f1': 0.88482535, 'auroc': 0.9761239, 'binary_precision': 0.7094017, 'binary_recall': 0.86329865, 'binary_specificity': 0.98682684, 'binary_f1_score': 0.7788204}
confusion matrix:
       0    1
0  17829  238
1     92  581
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96165, 'precision': 0.7824873, 'recall': 0.6269011, 'specificity': 0.6269011, 'f1': 0.6719328, 'auroc': 0.92838734, 'binary_precision': 0.5964912, 'binary_recall': 0.26153848, 'binary_specificity': 0.99226373, 'binary_f1_score': 0.36363634}
confusion matrix:
      0   1
0  5900  46
1   192  68
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011747_17.png
early stop counter: 1
val acc:0.9823905825614929, best validation acc: 0.9861792922019958, corresponding to test acc:                         0.9600386619567871 / 0.967934250831604
after epoch: 17,now: 2024-06-03 02:37:35.739781,epoch time: 0:38:24.109420,used: 10:43:51.651114,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_15_53_44_seed_1_21011747
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9950064, 'precision': 0.9713059, 'recall': 0.9488503, 'specificity': 0.9488503, 'f1': 0.95978385, 'auroc': 0.9986805, 'binary_precision': 0.9460248, 'binary_recall': 0.89944524, 'binary_specificity': 0.9982553, 'binary_f1_score': 0.9221472}
confusion matrix:
       0     1
0  42340    74
1    145  1297
---- Validation: 
scalar performance:
{'acc': 0.98628604, 'precision': 0.93453145, 'recall': 0.8562715, 'specificity': 0.8562715, 'f1': 0.89121443, 'auroc': 0.9773443, 'binary_precision': 0.879562, 'binary_recall': 0.7161961, 'binary_specificity': 0.99634695, 'binary_f1_score': 0.78951675}
confusion matrix:
       0    1
0  18001   66
1    191  482
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96003866, 'precision': 0.79382515, 'recall': 0.5561787, 'specificity': 0.5561787, 'f1': 0.587158, 'auroc': 0.9360101, 'binary_precision': 0.625, 'binary_recall': 0.115384616, 'binary_specificity': 0.99697274, 'binary_f1_score': 0.19480519}
confusion matrix:
      0   1
0  5928  18
1   230  30
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011747_18.png
better model found
persisted
after epoch: 18,now: 2024-06-03 03:16:30.456558,epoch time: 0:38:54.716777,used: 11:22:46.367891,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_15_53_44_seed_1_21011747
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99338746, 'precision': 0.97166824, 'recall': 0.92155206, 'specificity': 0.92155206, 'f1': 0.94510233, 'auroc': 0.9974791, 'binary_precision': 0.94859815, 'binary_recall': 0.8446602, 'binary_specificity': 0.9984439, 'binary_f1_score': 0.89361703}
confusion matrix:
       0     1
0  42348    66
1    224  1218
---- Validation: 
scalar performance:
{'acc': 0.98345786, 'precision': 0.92179084, 'recall': 0.82190245, 'specificity': 0.82190245, 'f1': 0.86459607, 'auroc': 0.9723829, 'binary_precision': 0.8565815, 'binary_recall': 0.64784545, 'binary_specificity': 0.99595946, 'binary_f1_score': 0.7377326}
confusion matrix:
       0    1
0  17994   73
1    237  436
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95987755, 'precision': 0.89189076, 'recall': 0.5266708, 'specificity': 0.5266708, 'f1': 0.5402819, 'auroc': 0.93957925, 'binary_precision': 0.8235294, 'binary_recall': 0.053846154, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.10108303}
confusion matrix:
      0   1
0  5943   3
1   246  14
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011747_19.png
early stop counter: 1
val acc:0.9834578633308411, best validation acc: 0.9862860441207886, corresponding to test acc:                         0.9600386619567871 / 0.967934250831604
after epoch: 19,now: 2024-06-03 03:55:27.605741,epoch time: 0:38:57.149183,used: 12:01:43.517074,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_15_53_44_seed_1_21011747
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9939119, 'precision': 0.9659482, 'recall': 0.9362261, 'specificity': 0.9362261, 'f1': 0.95056134, 'auroc': 0.9982077, 'binary_precision': 0.9361544, 'binary_recall': 0.8744799, 'binary_specificity': 0.99797237, 'binary_f1_score': 0.9042667}
confusion matrix:
       0     1
0  42328    86
1    181  1261
---- Validation: 
scalar performance:
{'acc': 0.9854856, 'precision': 0.9110154, 'recall': 0.870877, 'specificity': 0.870877, 'f1': 0.889827, 'auroc': 0.9778141, 'binary_precision': 0.831405, 'binary_recall': 0.7473997, 'binary_specificity': 0.99435437, 'binary_f1_score': 0.78716743}
confusion matrix:
       0    1
0  17965  102
1    170  503
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9585885, 'precision': 0.7448589, 'recall': 0.55358285, 'specificity': 0.55358285, 'f1': 0.58144104, 'auroc': 0.9382955, 'binary_precision': 0.5272727, 'binary_recall': 0.11153846, 'binary_specificity': 0.9956273, 'binary_f1_score': 0.18412699}
confusion matrix:
      0   1
0  5920  26
1   231  29
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011747_20.png
early stop counter: 2
val acc:0.9854856133460999, best validation acc: 0.9862860441207886, corresponding to test acc:                         0.9600386619567871 / 0.967934250831604
after epoch: 20,now: 2024-06-03 04:34:14.379896,epoch time: 0:38:46.774155,used: 12:40:30.291229,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_15_53_44_seed_1_21011747
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9913353, 'precision': 0.90861905, 'recall': 0.9690591, 'specificity': 0.9690591, 'f1': 0.9365823, 'auroc': 0.99753845, 'binary_precision': 0.8191106, 'binary_recall': 0.945215, 'binary_specificity': 0.9929033, 'binary_f1_score': 0.87765616}
confusion matrix:
       0     1
0  42113   301
1     79  1363
---- Validation: 
scalar performance:
{'acc': 0.98175025, 'precision': 0.8573228, 'recall': 0.8939742, 'specificity': 0.8939742, 'f1': 0.87466574, 'auroc': 0.9748495, 'binary_precision': 0.72214764, 'binary_recall': 0.79940563, 'binary_specificity': 0.9885427, 'binary_f1_score': 0.75881517}
confusion matrix:
       0    1
0  17860  207
1    135  538
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95939416, 'precision': 0.75346315, 'recall': 0.59813905, 'specificity': 0.59813905, 'f1': 0.6375917, 'auroc': 0.92665136, 'binary_precision': 0.5408163, 'binary_recall': 0.20384616, 'binary_specificity': 0.9924319, 'binary_f1_score': 0.29608938}
confusion matrix:
      0   1
0  5901  45
1   207  53
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011747_21.png
early stop counter: 3
val acc:0.9817502498626709, best validation acc: 0.9862860441207886, corresponding to test acc:                         0.9600386619567871 / 0.967934250831604
after epoch: 21,now: 2024-06-03 05:12:59.944420,epoch time: 0:38:45.564524,used: 13:19:15.855753,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_15_53_44_seed_1_21011747
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99498355, 'precision': 0.9521923, 'recall': 0.9709453, 'specificity': 0.9709453, 'f1': 0.96136355, 'auroc': 0.9988029, 'binary_precision': 0.90625, 'binary_recall': 0.945215, 'binary_specificity': 0.9966756, 'binary_f1_score': 0.9253225}
confusion matrix:
       0     1
0  42273   141
1     79  1363
---- Validation: 
scalar performance:
{'acc': 0.98671293, 'precision': 0.92744946, 'recall': 0.87151355, 'specificity': 0.87151355, 'f1': 0.89735997, 'auroc': 0.9771025, 'binary_precision': 0.86426115, 'binary_recall': 0.7473997, 'binary_specificity': 0.9956274, 'binary_f1_score': 0.8015936}
confusion matrix:
       0    1
0  17988   79
1    170  503
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606832, 'precision': 0.8421484, 'recall': 0.5491591, 'specificity': 0.5491591, 'f1': 0.5777685, 'auroc': 0.9391134, 'binary_precision': 0.7222222, 'binary_recall': 0.1, 'binary_specificity': 0.9983182, 'binary_f1_score': 0.17567568}
confusion matrix:
      0   1
0  5936  10
1   234  26
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011747_22.png
better model found
persisted
after epoch: 22,now: 2024-06-03 05:51:28.531529,epoch time: 0:38:28.587109,used: 13:57:44.442862,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_15_53_44_seed_1_21011747
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9935471, 'precision': 0.9472873, 'recall': 0.95178026, 'specificity': 0.95178026, 'f1': 0.94952166, 'auroc': 0.9983888, 'binary_precision': 0.89773506, 'binary_recall': 0.9070735, 'binary_specificity': 0.996487, 'binary_f1_score': 0.9023801}
confusion matrix:
       0     1
0  42265   149
1    134  1308
---- Validation: 
scalar performance:
{'acc': 0.98521876, 'precision': 0.9112297, 'recall': 0.8657318, 'specificity': 0.8657318, 'f1': 0.8870342, 'auroc': 0.974736, 'binary_precision': 0.8322148, 'binary_recall': 0.7369985, 'binary_specificity': 0.99446505, 'binary_f1_score': 0.7817179}
confusion matrix:
       0    1
0  17967  100
1    177  496
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95939416, 'precision': 0.7971556, 'recall': 0.5356135, 'specificity': 0.5356135, 'f1': 0.5551229, 'auroc': 0.9218474, 'binary_precision': 0.6333333, 'binary_recall': 0.073076926, 'binary_specificity': 0.99815, 'binary_f1_score': 0.1310345}
confusion matrix:
      0   1
0  5935  11
1   241  19
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011747_23.png
early stop counter: 1
val acc:0.9852187633514404, best validation acc: 0.9867129325866699, corresponding to test acc:                         0.9606832265853882 / 0.967934250831604
after epoch: 23,now: 2024-06-03 06:29:50.870870,epoch time: 0:38:22.339341,used: 14:36:06.782203,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_15_53_44_seed_1_21011747
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99493796, 'precision': 0.9539346, 'recall': 0.9679072, 'specificity': 0.9679072, 'f1': 0.96080685, 'auroc': 0.99835503, 'binary_precision': 0.90994626, 'binary_recall': 0.93897367, 'binary_specificity': 0.99684066, 'binary_f1_score': 0.9242321}
confusion matrix:
       0     1
0  42280   134
1     88  1354
---- Validation: 
scalar performance:
{'acc': 0.98612595, 'precision': 0.8993925, 'recall': 0.9005351, 'specificity': 0.9005351, 'f1': 0.8999629, 'auroc': 0.97941226, 'binary_precision': 0.8059259, 'binary_recall': 0.80832094, 'binary_specificity': 0.9927492, 'binary_f1_score': 0.80712163}
confusion matrix:
       0    1
0  17936  131
1    129  544
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621334, 'precision': 0.8545149, 'recall': 0.57198375, 'specificity': 0.57198375, 'f1': 0.6124765, 'auroc': 0.93081874, 'binary_precision': 0.74509805, 'binary_recall': 0.14615385, 'binary_specificity': 0.99781364, 'binary_f1_score': 0.244373}
confusion matrix:
      0   1
0  5933  13
1   222  38
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011747_24.png
early stop counter: 2
val acc:0.9861259460449219, best validation acc: 0.9867129325866699, corresponding to test acc:                         0.9606832265853882 / 0.967934250831604
after epoch: 24,now: 2024-06-03 07:08:16.333361,epoch time: 0:38:25.462491,used: 15:14:32.244694,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_15_53_44_seed_1_21011747
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99343306, 'precision': 0.92869353, 'recall': 0.9761728, 'specificity': 0.9761728, 'f1': 0.951086, 'auroc': 0.9990037, 'binary_precision': 0.85883087, 'binary_recall': 0.95769763, 'binary_specificity': 0.994648, 'binary_f1_score': 0.9055737}
confusion matrix:
       0     1
0  42187   227
1     61  1381
---- Validation: 
scalar performance:
{'acc': 0.98404485, 'precision': 0.88160145, 'recall': 0.89087254, 'specificity': 0.89087254, 'f1': 0.8861761, 'auroc': 0.9769662, 'binary_precision': 0.7710145, 'binary_recall': 0.7904903, 'binary_specificity': 0.99125475, 'binary_f1_score': 0.78063095}
confusion matrix:
       0    1
0  17909  158
1    141  532
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589107, 'precision': 0.7477178, 'recall': 0.57949686, 'specificity': 0.57949686, 'f1': 0.61553717, 'auroc': 0.93380845, 'binary_precision': 0.5308642, 'binary_recall': 0.16538462, 'binary_specificity': 0.99360913, 'binary_f1_score': 0.2521994}
confusion matrix:
      0   1
0  5908  38
1   217  43
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011747_25.png
early stop counter: 3
val acc:0.9840448498725891, best validation acc: 0.9867129325866699, corresponding to test acc:                         0.9606832265853882 / 0.967934250831604
after epoch: 25,now: 2024-06-03 07:46:36.484609,epoch time: 0:38:20.151248,used: 15:52:52.395942,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_15_53_44_seed_1_21011747
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9950292, 'precision': 0.9676433, 'recall': 0.95321643, 'specificity': 0.95321643, 'f1': 0.96030843, 'auroc': 0.998685, 'binary_precision': 0.93839544, 'binary_recall': 0.9084605, 'binary_specificity': 0.99797237, 'binary_f1_score': 0.9231854}
confusion matrix:
       0     1
0  42328    86
1    132  1310
---- Validation: 
scalar performance:
{'acc': 0.9864995, 'precision': 0.94560546, 'recall': 0.8485143, 'specificity': 0.8485143, 'f1': 0.89065593, 'auroc': 0.9758923, 'binary_precision': 0.90229887, 'binary_recall': 0.6998514, 'binary_specificity': 0.9971772, 'binary_f1_score': 0.7882845}
confusion matrix:
       0    1
0  18016   51
1    202  471
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959233, 'precision': 0.8134465, 'recall': 0.52633446, 'specificity': 0.52633446, 'f1': 0.53939426, 'auroc': 0.92876613, 'binary_precision': 0.6666667, 'binary_recall': 0.053846154, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.099644125}
confusion matrix:
      0   1
0  5939   7
1   246  14
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011747_26.png
early stop counter: 4
val acc:0.9864994883537292, best validation acc: 0.9867129325866699, corresponding to test acc:                         0.9606832265853882 / 0.967934250831604
after epoch: 26,now: 2024-06-03 08:25:03.936506,epoch time: 0:38:27.451897,used: 16:31:19.847839,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_15_53_44_seed_1_21011747
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9954624, 'precision': 0.9763542, 'recall': 0.9510957, 'specificity': 0.9510957, 'f1': 0.9633558, 'auroc': 0.999205, 'binary_precision': 0.95597947, 'binary_recall': 0.9036061, 'binary_specificity': 0.99858534, 'binary_f1_score': 0.92905533}
confusion matrix:
       0     1
0  42354    60
1    139  1303
---- Validation: 
scalar performance:
{'acc': 0.98404485, 'precision': 0.9256244, 'recall': 0.827929, 'specificity': 0.827929, 'f1': 0.869933, 'auroc': 0.974476, 'binary_precision': 0.8638132, 'binary_recall': 0.6597325, 'binary_specificity': 0.9961255, 'binary_f1_score': 0.74810445}
confusion matrix:
       0    1
0  17997   70
1    229  444
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9624557, 'precision': 0.8549253, 'recall': 0.5776689, 'specificity': 0.5776689, 'f1': 0.6205282, 'auroc': 0.93258524, 'binary_precision': 0.74545455, 'binary_recall': 0.15769231, 'binary_specificity': 0.9976455, 'binary_f1_score': 0.26031747}
confusion matrix:
      0   1
0  5932  14
1   219  41
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011747_27.png
early stop counter: 5
val acc:0.9840448498725891, best validation acc: 0.9867129325866699, corresponding to test acc:                         0.9606832265853882 / 0.967934250831604
after epoch: 27,now: 2024-06-03 09:03:28.009452,epoch time: 0:38:24.072946,used: 17:09:43.920785,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_15_53_44_seed_1_21011747
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99562204, 'precision': 0.9549189, 'recall': 0.9786444, 'specificity': 0.9786444, 'f1': 0.9664568, 'auroc': 0.999329, 'binary_precision': 0.9111842, 'binary_recall': 0.9604716, 'binary_specificity': 0.9968171, 'binary_f1_score': 0.935179}
confusion matrix:
       0     1
0  42279   135
1     57  1385
---- Validation: 
scalar performance:
{'acc': 0.98804694, 'precision': 0.9338896, 'recall': 0.8865107, 'specificity': 0.8865107, 'f1': 0.90871793, 'auroc': 0.975111, 'binary_precision': 0.8760469, 'binary_recall': 0.7771174, 'binary_specificity': 0.99590415, 'binary_f1_score': 0.82362205}
confusion matrix:
       0    1
0  17993   74
1    150  523
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96003866, 'precision': 0.8025285, 'recall': 0.55066174, 'specificity': 0.55066174, 'f1': 0.5791645, 'auroc': 0.9444575, 'binary_precision': 0.64285713, 'binary_recall': 0.103846155, 'binary_specificity': 0.9974773, 'binary_f1_score': 0.17880796}
confusion matrix:
      0   1
0  5931  15
1   233  27
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011747_28.png
better model found
persisted
after epoch: 28,now: 2024-06-03 09:41:56.415214,epoch time: 0:38:28.405762,used: 17:48:12.326547,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_15_53_44_seed_1_21011747
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9966253, 'precision': 0.9705174, 'recall': 0.9768183, 'specificity': 0.9768183, 'f1': 0.9736453, 'auroc': 0.9995025, 'binary_precision': 0.94254446, 'binary_recall': 0.9556172, 'binary_specificity': 0.9980195, 'binary_f1_score': 0.9490358}
confusion matrix:
       0     1
0  42330    84
1     64  1378
---- Validation: 
scalar performance:
{'acc': 0.98639274, 'precision': 0.927184, 'recall': 0.86634064, 'specificity': 0.86634064, 'f1': 0.89423573, 'auroc': 0.9747725, 'binary_precision': 0.8641115, 'binary_recall': 0.7369985, 'binary_specificity': 0.9956827, 'binary_f1_score': 0.7955092}
confusion matrix:
       0    1
0  17989   78
1    177  496
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96326137, 'precision': 0.8704457, 'recall': 0.5854453, 'specificity': 0.5854453, 'f1': 0.6320833, 'auroc': 0.9457134, 'binary_precision': 0.7758621, 'binary_recall': 0.17307693, 'binary_specificity': 0.99781364, 'binary_f1_score': 0.28301886}
confusion matrix:
      0   1
0  5933  13
1   215  45
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011747_29.png
early stop counter: 1
val acc:0.9863927364349365, best validation acc: 0.9880469441413879, corresponding to test acc:                         0.9600386619567871 / 0.967934250831604
after epoch: 29,now: 2024-06-03 10:20:26.646586,epoch time: 0:38:30.231372,used: 18:26:42.557919,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_15_53_44_seed_1_21011747
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9965341, 'precision': 0.9715648, 'recall': 0.9740916, 'specificity': 0.9740916, 'f1': 0.9728246, 'auroc': 0.99944484, 'binary_precision': 0.94482756, 'binary_recall': 0.95006937, 'binary_specificity': 0.9981138, 'binary_f1_score': 0.9474412}
confusion matrix:
       0     1
0  42334    80
1     72  1370
---- Validation: 
scalar performance:
{'acc': 0.98639274, 'precision': 0.92246294, 'recall': 0.87206274, 'specificity': 0.87206274, 'f1': 0.89552945, 'auroc': 0.9800358, 'binary_precision': 0.85423726, 'binary_recall': 0.7488856, 'binary_specificity': 0.9952399, 'binary_f1_score': 0.79809976}
confusion matrix:
       0    1
0  17981   86
1    169  504
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9634225, 'precision': 0.8880267, 'recall': 0.5818514, 'specificity': 0.5818514, 'f1': 0.62799925, 'auroc': 0.94501317, 'binary_precision': 0.8113208, 'binary_recall': 0.16538462, 'binary_specificity': 0.9983182, 'binary_f1_score': 0.2747604}
confusion matrix:
      0   1
0  5936  10
1   217  43
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011747_30.png
early stop counter: 2
val acc:0.9863927364349365, best validation acc: 0.9880469441413879, corresponding to test acc:                         0.9600386619567871 / 0.967934250831604
after epoch: 30,now: 2024-06-03 10:58:56.057396,epoch time: 0:38:29.410810,used: 19:05:11.968729,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_15_53_44_seed_1_21011747
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 19:05:11.968729 at 2024-06-03 10:58:56.057396
persisted model performance metric: 

scalar performance:
{'acc': 0.96084434, 'precision': 0.8459801, 'recall': 0.5510822, 'specificity': 0.5510822, 'f1': 0.5808802, 'auroc': 0.9380293, 'binary_precision': 0.7297297, 'binary_recall': 0.103846155, 'binary_specificity': 0.9983182, 'binary_f1_score': 0.18181819}
confusion matrix:
      0   1
0  5936  10
1   233  27
oracle model performance metric: 

scalar performance:
{'acc': 0.96890104, 'precision': 0.89828414, 'recall': 0.6619479, 'specificity': 0.6619479, 'f1': 0.7261508, 'auroc': 0.95918167, 'binary_precision': 0.8252427, 'binary_recall': 0.32692307, 'binary_specificity': 0.99697274, 'binary_f1_score': 0.46831957}
confusion matrix:
      0   1
0  5928  18
1   175  85
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1664 MiB |  15807 MiB |   1984 TiB |   1984 TiB |
|       from large pool |   1657 MiB |  15782 MiB |   1958 TiB |   1958 TiB |
|       from small pool |      6 MiB |     26 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1664 MiB |  15807 MiB |   1984 TiB |   1984 TiB |
|       from large pool |   1657 MiB |  15782 MiB |   1958 TiB |   1958 TiB |
|       from small pool |      6 MiB |     26 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1653 MiB |  15770 MiB |   1979 TiB |   1979 TiB |
|       from large pool |   1647 MiB |  15745 MiB |   1953 TiB |   1953 TiB |
|       from small pool |      5 MiB |     25 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  16758 MiB |  16758 MiB |  31406 MiB |  14648 MiB |
|       from large pool |  16730 MiB |  16730 MiB |  31376 MiB |  14646 MiB |
|       from small pool |     28 MiB |     28 MiB |     30 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 397178 KiB |    905 MiB |    809 TiB |    809 TiB |
|       from large pool | 377232 KiB |    904 MiB |    784 TiB |    784 TiB |
|       from small pool |  19946 KiB |     25 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3342    |    6365    |  304913 K  |  304909 K  |
|       from large pool |     247    |     989    |  124920 K  |  124920 K  |
|       from small pool |    3095    |    6116    |  179992 K  |  179989 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3342    |    6365    |  304913 K  |  304909 K  |
|       from large pool |     247    |     989    |  124920 K  |  124920 K  |
|       from small pool |    3095    |    6116    |  179992 K  |  179989 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     621    |     621    |    1127    |     506    |
|       from large pool |     607    |     607    |    1112    |     505    |
|       from small pool |      14    |      14    |      15    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     142    |    2873    |  179457 K  |  179457 K  |
|       from large pool |     107    |     516    |   93731 K  |   93731 K  |
|       from small pool |      35    |    2764    |   85725 K  |   85725 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15807 MiB |   1984 TiB |   1984 TiB |
|       from large pool |  16640 KiB |  15782 MiB |   1958 TiB |   1958 TiB |
|       from small pool |      0 KiB |     26 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15807 MiB |   1984 TiB |   1984 TiB |
|       from large pool |  16640 KiB |  15782 MiB |   1958 TiB |   1958 TiB |
|       from small pool |      0 KiB |     26 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15770 MiB |   1979 TiB |   1979 TiB |
|       from large pool |  16640 KiB |  15745 MiB |   1953 TiB |   1953 TiB |
|       from small pool |      0 KiB |     25 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2052 MiB |  16758 MiB |  31406 MiB |  29354 MiB |
|       from large pool |   2026 MiB |  16730 MiB |  31376 MiB |  29350 MiB |
|       from small pool |     26 MiB |     28 MiB |     30 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    905 MiB |    809 TiB |    809 TiB |
|       from large pool |  24320 KiB |    904 MiB |    784 TiB |    784 TiB |
|       from small pool |      0 KiB |     25 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6365    |  304913 K  |  304913 K  |
|       from large pool |       2    |     989    |  124920 K  |  124920 K  |
|       from small pool |       0    |    6116    |  179992 K  |  179992 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6365    |  304913 K  |  304913 K  |
|       from large pool |       2    |     989    |  124920 K  |  124920 K  |
|       from small pool |       0    |    6116    |  179992 K  |  179992 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     113    |     621    |    1127    |    1014    |
|       from large pool |     100    |     607    |    1112    |    1012    |
|       from small pool |      13    |      14    |      15    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    2873    |  179459 K  |  179459 K  |
|       from large pool |       2    |     516    |   93732 K  |   93732 K  |
|       from small pool |       0    |    2764    |   85727 K  |   85727 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15807 MiB |   1984 TiB |   1984 TiB |
|       from large pool |  16640 KiB |  15782 MiB |   1958 TiB |   1958 TiB |
|       from small pool |      0 KiB |     26 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15807 MiB |   1984 TiB |   1984 TiB |
|       from large pool |  16640 KiB |  15782 MiB |   1958 TiB |   1958 TiB |
|       from small pool |      0 KiB |     26 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15770 MiB |   1979 TiB |   1979 TiB |
|       from large pool |  16640 KiB |  15745 MiB |   1953 TiB |   1953 TiB |
|       from small pool |      0 KiB |     25 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2052 MiB |  16758 MiB |  31406 MiB |  29354 MiB |
|       from large pool |   2026 MiB |  16730 MiB |  31376 MiB |  29350 MiB |
|       from small pool |     26 MiB |     28 MiB |     30 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    905 MiB |    809 TiB |    809 TiB |
|       from large pool |  24320 KiB |    904 MiB |    784 TiB |    784 TiB |
|       from small pool |      0 KiB |     25 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6365    |  304913 K  |  304913 K  |
|       from large pool |       2    |     989    |  124920 K  |  124920 K  |
|       from small pool |       0    |    6116    |  179992 K  |  179992 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6365    |  304913 K  |  304913 K  |
|       from large pool |       2    |     989    |  124920 K  |  124920 K  |
|       from small pool |       0    |    6116    |  179992 K  |  179992 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     113    |     621    |    1127    |    1014    |
|       from large pool |     100    |     607    |    1112    |    1012    |
|       from small pool |      13    |      14    |      15    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    2873    |  179459 K  |  179459 K  |
|       from large pool |       2    |     516    |   93732 K  |   93732 K  |
|       from small pool |       0    |    2764    |   85727 K  |   85727 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_11_05_21_seed_2_21011747

 Experiment start at: 2024-06-03 11:05:21.406520
before training, model accuracy: 0.1783429980278015
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9979935, 'precision': 0.99562186, 'recall': 0.9928905, 'specificity': 0.9928905, 'f1': 0.9942514, 'auroc': 0.9996442, 'binary_precision': 0.99268454, 'binary_recall': 0.98656094, 'binary_specificity': 0.99922, 'binary_f1_score': 0.9896133}
confusion matrix:
       0     1
0  42276    33
1     61  4478
---- Validation: 
scalar performance:
{'acc': 0.96431047, 'precision': 0.627444, 'recall': 0.53426605, 'specificity': 0.53426605, 'f1': 0.5501038, 'auroc': 0.91103613, 'binary_precision': 0.28481013, 'binary_recall': 0.07475083, 'binary_specificity': 0.9937813, 'binary_f1_score': 0.11842105}
confusion matrix:
       0    1
0  18058  113
1    557   45
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99866134, 'precision': 0.9986384, 'recall': 0.99440694, 'specificity': 0.99440694, 'f1': 0.99651086, 'auroc': 0.99995744, 'binary_precision': 0.9986092, 'binary_recall': 0.9889807, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.9937717}
confusion matrix:
      0    1
0  5996    1
1     8  718
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011747_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-03 11:41:21.447811,epoch time: 0:36:00.041291,used: 0:36:00.041291,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_11_05_21_seed_2_21011747
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9982923, 'precision': 0.99815685, 'recall': 0.9920708, 'specificity': 0.9920708, 'f1': 0.99509007, 'auroc': 0.9994728, 'binary_precision': 0.9979893, 'binary_recall': 0.9843543, 'binary_specificity': 0.9997873, 'binary_f1_score': 0.99112487}
confusion matrix:
       0     1
0  42301     9
1     71  4467
---- Validation: 
scalar performance:
{'acc': 0.96622807, 'precision': 0.7073184, 'recall': 0.5946822, 'specificity': 0.5946822, 'f1': 0.6278241, 'auroc': 0.93553674, 'binary_precision': 0.44074073, 'binary_recall': 0.19767442, 'binary_specificity': 0.99169004, 'binary_f1_score': 0.27293578}
confusion matrix:
       0    1
0  18020  151
1    483  119
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99672765, 'precision': 0.99692506, 'recall': 0.9860592, 'specificity': 0.9860592, 'f1': 0.9914135, 'auroc': 0.9990015, 'binary_precision': 0.99717516, 'binary_recall': 0.9724518, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.98465836}
confusion matrix:
      0    1
0  5995    2
1    20  706
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011747_2.png
better model found
persisted
after epoch: 2,now: 2024-06-03 12:16:59.213279,epoch time: 0:35:37.765468,used: 1:11:37.806759,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_11_05_21_seed_2_21011747
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9977587, 'precision': 0.9986612, 'recall': 0.9885268, 'specificity': 0.9885268, 'f1': 0.9935281, 'auroc': 0.9997612, 'binary_precision': 0.99977446, 'binary_recall': 0.97707736, 'binary_specificity': 0.99997634, 'binary_f1_score': 0.9882956}
confusion matrix:
       0     1
0  42310     1
1    104  4433
---- Validation: 
scalar performance:
{'acc': 0.9671869, 'precision': 0.48395437, 'recall': 0.49961478, 'specificity': 0.49961478, 'f1': 0.4916599, 'auroc': 0.92674464, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99922955, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18157  14
1    602   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99628145, 'precision': 0.99792427, 'recall': 0.98278236, 'specificity': 0.98278236, 'f1': 0.99020034, 'auroc': 0.9999472, 'binary_precision': 1.0, 'binary_recall': 0.9655647, 'binary_specificity': 1.0, 'binary_f1_score': 0.9824807}
confusion matrix:
      0    1
0  5997    0
1    25  701
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011747_3.png
better model found
persisted
after epoch: 3,now: 2024-06-03 12:51:52.706673,epoch time: 0:34:53.493394,used: 1:46:31.300153,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_11_05_21_seed_2_21011747
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9988687, 'precision': 0.99769425, 'recall': 0.99583346, 'specificity': 0.99583346, 'f1': 0.99676156, 'auroc': 0.9998226, 'binary_precision': 0.99623895, 'binary_recall': 0.9920687, 'binary_specificity': 0.9995982, 'binary_f1_score': 0.9941494}
confusion matrix:
       0     1
0  42292    17
1     36  4503
---- Validation: 
scalar performance:
{'acc': 0.96596175, 'precision': 0.7146349, 'recall': 0.6403184, 'specificity': 0.6403184, 'f1': 0.6688581, 'auroc': 0.9297354, 'binary_precision': 0.45244217, 'binary_recall': 0.29235882, 'binary_specificity': 0.98827803, 'binary_f1_score': 0.3551968}
confusion matrix:
       0    1
0  17958  213
1    426  176
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9992563, 'precision': 0.9995835, 'recall': 0.99655646, 'specificity': 0.99655646, 'f1': 0.9980639, 'auroc': 0.9998852, 'binary_precision': 1.0, 'binary_recall': 0.9931129, 'binary_specificity': 1.0, 'binary_f1_score': 0.99654454}
confusion matrix:
      0    1
0  5997    0
1     5  721
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011747_4.png
new oracle model saved
early stop counter: 1
val acc:0.965961754322052, best validation acc: 0.9671869277954102, corresponding to test acc:                         0.9962814450263977 / 0.9992563128471375
after epoch: 4,now: 2024-06-03 13:27:02.143589,epoch time: 0:35:09.436916,used: 2:21:40.737069,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_11_05_21_seed_2_21011747
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9989754, 'precision': 0.99923444, 'recall': 0.99490917, 'specificity': 0.99490917, 'f1': 0.99705994, 'auroc': 0.99993354, 'binary_precision': 0.99955505, 'binary_recall': 0.9898656, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.9946867}
confusion matrix:
       0     1
0  42307     2
1     46  4493
---- Validation: 
scalar performance:
{'acc': 0.9695307, 'precision': 0.81704175, 'recall': 0.5498114, 'specificity': 0.5498114, 'f1': 0.58013546, 'auroc': 0.94967043, 'binary_precision': 0.6630435, 'binary_recall': 0.1013289, 'binary_specificity': 0.998294, 'binary_f1_score': 0.1757925}
confusion matrix:
       0   1
0  18140  31
1    541  61
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99851257, 'precision': 0.9991677, 'recall': 0.9931129, 'specificity': 0.9931129, 'f1': 0.99611604, 'auroc': 0.99960625, 'binary_precision': 1.0, 'binary_recall': 0.9862259, 'binary_specificity': 1.0, 'binary_f1_score': 0.99306524}
confusion matrix:
      0    1
0  5997    0
1    10  716
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011747_5.png
better model found
persisted
after epoch: 5,now: 2024-06-03 14:01:55.924462,epoch time: 0:34:53.780873,used: 2:56:34.517942,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_11_05_21_seed_2_21011747
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9983137, 'precision': 0.99906814, 'recall': 0.9912976, 'specificity': 0.9912976, 'f1': 0.99514425, 'auroc': 0.9996424, 'binary_precision': 1.0, 'binary_recall': 0.98259526, 'binary_specificity': 1.0, 'binary_f1_score': 0.99122125}
confusion matrix:
       0     1
0  42309     0
1     79  4460
---- Validation: 
scalar performance:
{'acc': 0.9680392, 'precision': 0.8174011, 'recall': 0.5032672, 'specificity': 0.5032672, 'f1': 0.49845722, 'auroc': 0.92842555, 'binary_precision': 0.6666667, 'binary_recall': 0.006644518, 'binary_specificity': 0.9998899, 'binary_f1_score': 0.013157894}
confusion matrix:
       0  1
0  18169  2
1    598  4
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99628145, 'precision': 0.99792427, 'recall': 0.98278236, 'specificity': 0.98278236, 'f1': 0.99020034, 'auroc': 0.99914753, 'binary_precision': 1.0, 'binary_recall': 0.9655647, 'binary_specificity': 1.0, 'binary_f1_score': 0.9824807}
confusion matrix:
      0    1
0  5997    0
1    25  701
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011747_6.png
early stop counter: 1
val acc:0.9680392146110535, best validation acc: 0.9695307016372681, corresponding to test acc:                         0.9985125660896301 / 0.9992563128471375
after epoch: 6,now: 2024-06-03 14:36:43.429426,epoch time: 0:34:47.504964,used: 3:31:22.022906,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_11_05_21_seed_2_21011747
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9985912, 'precision': 0.99922127, 'recall': 0.9927281, 'specificity': 0.9927281, 'f1': 0.9959477, 'auroc': 0.9996922, 'binary_precision': 1.0, 'binary_recall': 0.98545617, 'binary_specificity': 1.0, 'binary_f1_score': 0.99267477}
confusion matrix:
       0     1
0  42310     0
1     66  4472
---- Validation: 
scalar performance:
{'acc': 0.971182, 'precision': 0.84624225, 'recall': 0.5819833, 'specificity': 0.5819833, 'f1': 0.62760323, 'auroc': 0.9380441, 'binary_precision': 0.7194245, 'binary_recall': 0.16611296, 'binary_specificity': 0.9978537, 'binary_f1_score': 0.26990554}
confusion matrix:
       0    1
0  18132   39
1    502  100
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99866134, 'precision': 0.99925077, 'recall': 0.99380165, 'specificity': 0.99380165, 'f1': 0.9965066, 'auroc': 0.9999254, 'binary_precision': 1.0, 'binary_recall': 0.9876033, 'binary_specificity': 1.0, 'binary_f1_score': 0.99376297}
confusion matrix:
      0    1
0  5997    0
1     9  717
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011747_7.png
better model found
persisted
after epoch: 7,now: 2024-06-03 15:11:29.540651,epoch time: 0:34:46.111225,used: 4:06:08.134131,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_11_05_21_seed_2_21011747
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9971397, 'precision': 0.9961072, 'recall': 0.98750085, 'specificity': 0.98750085, 'f1': 0.9917563, 'auroc': 0.9989902, 'binary_precision': 0.99483263, 'binary_recall': 0.9755453, 'binary_specificity': 0.9994564, 'binary_f1_score': 0.98509455}
confusion matrix:
       0     1
0  42286    23
1    111  4428
---- Validation: 
scalar performance:
{'acc': 0.97240716, 'precision': 0.8751618, 'recall': 0.5970711, 'specificity': 0.5970711, 'f1': 0.6494591, 'auroc': 0.95102096, 'binary_precision': 0.7763158, 'binary_recall': 0.19601329, 'binary_specificity': 0.9981289, 'binary_f1_score': 0.31299734}
confusion matrix:
       0    1
0  18137   34
1    484  118
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99464524, 'precision': 0.99701643, 'recall': 0.9752066, 'specificity': 0.9752066, 'f1': 0.98579186, 'auroc': 0.998145, 'binary_precision': 1.0, 'binary_recall': 0.9504132, 'binary_specificity': 1.0, 'binary_f1_score': 0.9745763}
confusion matrix:
      0    1
0  5997    0
1    36  690
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011747_8.png
better model found
persisted
after epoch: 8,now: 2024-06-03 15:46:09.249809,epoch time: 0:34:39.709158,used: 4:40:47.843289,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_11_05_21_seed_2_21011747
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9980362, 'precision': 0.9989151, 'recall': 0.9898656, 'specificity': 0.9898656, 'f1': 0.9943379, 'auroc': 0.9998399, 'binary_precision': 1.0, 'binary_recall': 0.9797312, 'binary_specificity': 1.0, 'binary_f1_score': 0.9897618}
confusion matrix:
       0     1
0  42309     0
1     92  4447
---- Validation: 
scalar performance:
{'acc': 0.9677196, 'precision': 0.66265905, 'recall': 0.5039052, 'specificity': 0.5039052, 'f1': 0.49991214, 'auroc': 0.9244551, 'binary_precision': 0.35714287, 'binary_recall': 0.008305647, 'binary_specificity': 0.9995047, 'binary_f1_score': 0.016233766}
confusion matrix:
       0  1
0  18162  9
1    597  5
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9971739, 'precision': 0.99842083, 'recall': 0.98691463, 'specificity': 0.98691463, 'f1': 0.9925797, 'auroc': 0.9999304, 'binary_precision': 1.0, 'binary_recall': 0.9738292, 'binary_specificity': 1.0, 'binary_f1_score': 0.98674107}
confusion matrix:
      0    1
0  5997    0
1    19  707
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011747_9.png
early stop counter: 1
val acc:0.9677196145057678, best validation acc: 0.9724071621894836, corresponding to test acc:                         0.9946452379226685 / 0.9992563128471375
after epoch: 9,now: 2024-06-03 16:21:05.926138,epoch time: 0:34:56.676329,used: 5:15:44.519618,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_11_05_21_seed_2_21011747
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9908, 'precision': 0.95814204, 'recall': 0.992841, 'specificity': 0.992841, 'f1': 0.97467345, 'auroc': 0.9997941, 'binary_precision': 0.91678506, 'binary_recall': 0.9953724, 'binary_specificity': 0.9903096, 'binary_f1_score': 0.9544638}
confusion matrix:
       0     1
0  41900   410
1     21  4517
---- Validation: 
scalar performance:
{'acc': 0.9360784, 'precision': 0.64628434, 'recall': 0.84732616, 'specificity': 0.84732616, 'f1': 0.6981697, 'auroc': 0.93856764, 'binary_precision': 0.3011968, 'binary_recall': 0.7524917, 'binary_specificity': 0.9421606, 'binary_f1_score': 0.43019944}
confusion matrix:
       0     1
0  17120  1051
1    149   453
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97977096, 'precision': 0.9230186, 'recall': 0.985029, 'specificity': 0.985029, 'f1': 0.9511241, 'auroc': 0.9991876, 'binary_precision': 0.84705883, 'binary_recall': 0.9917355, 'binary_specificity': 0.9783225, 'binary_f1_score': 0.9137056}
confusion matrix:
      0    1
0  5867  130
1     6  720
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011747_10.png
early stop counter: 2
val acc:0.9360784292221069, best validation acc: 0.9724071621894836, corresponding to test acc:                         0.9946452379226685 / 0.9992563128471375
after epoch: 10,now: 2024-06-03 16:55:45.600141,epoch time: 0:34:39.674003,used: 5:50:24.193621,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_11_05_21_seed_2_21011747
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9984631, 'precision': 0.99915063, 'recall': 0.99206525, 'specificity': 0.99206525, 'f1': 0.9955758, 'auroc': 0.99983203, 'binary_precision': 1.0, 'binary_recall': 0.9841305, 'binary_specificity': 1.0, 'binary_f1_score': 0.9920018}
confusion matrix:
       0     1
0  42311     0
1     72  4465
---- Validation: 
scalar performance:
{'acc': 0.968199, 'precision': 0.9840953, 'recall': 0.50415283, 'specificity': 0.50415283, 'f1': 0.50015634, 'auroc': 0.95058846, 'binary_precision': 1.0, 'binary_recall': 0.008305647, 'binary_specificity': 1.0, 'binary_f1_score': 0.016474463}
confusion matrix:
       0  1
0  18171  0
1    597  5
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9979176, 'precision': 0.99883544, 'recall': 0.9903581, 'specificity': 0.9903581, 'f1': 0.99454916, 'auroc': 0.9999759, 'binary_precision': 1.0, 'binary_recall': 0.9807162, 'binary_specificity': 1.0, 'binary_f1_score': 0.99026424}
confusion matrix:
      0    1
0  5997    0
1    14  712
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011747_11.png
early stop counter: 3
val acc:0.9681990146636963, best validation acc: 0.9724071621894836, corresponding to test acc:                         0.9946452379226685 / 0.9992563128471375
after epoch: 11,now: 2024-06-03 18:31:52.003085,epoch time: 1:36:06.402944,used: 7:26:30.596565,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_11_05_21_seed_2_21011747
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9986125, 'precision': 0.9987343, 'recall': 0.99333155, 'specificity': 0.99333155, 'f1': 0.99601424, 'auroc': 0.9997382, 'binary_precision': 0.9988849, 'binary_recall': 0.98678124, 'binary_specificity': 0.9998818, 'binary_f1_score': 0.9927962}
confusion matrix:
       0     1
0  42304     5
1     60  4479
---- Validation: 
scalar performance:
{'acc': 0.9699569, 'precision': 0.90481675, 'recall': 0.5387889, 'specificity': 0.5387889, 'f1': 0.56378376, 'auroc': 0.9550577, 'binary_precision': 0.83928573, 'binary_recall': 0.07807309, 'binary_specificity': 0.9995047, 'binary_f1_score': 0.14285713}
confusion matrix:
       0   1
0  18162   9
1    555  47
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99836385, 'precision': 0.9978597, 'recall': 0.99363494, 'specificity': 0.99363494, 'f1': 0.9957355, 'auroc': 0.9999801, 'binary_precision': 0.9972184, 'binary_recall': 0.9876033, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.9923876}
confusion matrix:
      0    1
0  5995    2
1     9  717
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011747_12.png
early stop counter: 4
val acc:0.9699568748474121, best validation acc: 0.9724071621894836, corresponding to test acc:                         0.9946452379226685 / 0.9992563128471375
after epoch: 12,now: 2024-06-03 19:08:58.633806,epoch time: 0:37:06.630721,used: 8:03:37.227286,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_11_05_21_seed_2_21011747
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9987833, 'precision': 0.9973515, 'recall': 0.99568784, 'specificity': 0.99568784, 'f1': 0.9965179, 'auroc': 0.99982864, 'binary_precision': 0.99557716, 'binary_recall': 0.9918484, 'binary_specificity': 0.9995273, 'binary_f1_score': 0.99370927}
confusion matrix:
       0     1
0  42289    20
1     37  4502
---- Validation: 
scalar performance:
{'acc': 0.97325945, 'precision': 0.82519674, 'recall': 0.6593461, 'specificity': 0.6593461, 'f1': 0.7117621, 'auroc': 0.95829874, 'binary_precision': 0.67241377, 'binary_recall': 0.32392028, 'binary_specificity': 0.9947719, 'binary_f1_score': 0.43721974}
confusion matrix:
       0    1
0  18076   95
1    407  195
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9989588, 'precision': 0.99941707, 'recall': 0.99517906, 'specificity': 0.99517906, 'f1': 0.9972862, 'auroc': 0.9998392, 'binary_precision': 1.0, 'binary_recall': 0.9903581, 'binary_specificity': 1.0, 'binary_f1_score': 0.9951557}
confusion matrix:
      0    1
0  5997    0
1     7  719
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011747_13.png
better model found
persisted
after epoch: 13,now: 2024-06-03 19:46:47.132195,epoch time: 0:37:48.498389,used: 8:41:25.725675,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_11_05_21_seed_2_21011747
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99824965, 'precision': 0.99903286, 'recall': 0.9909652, 'specificity': 0.9909652, 'f1': 0.9949573, 'auroc': 0.99987984, 'binary_precision': 1.0, 'binary_recall': 0.9819304, 'binary_specificity': 1.0, 'binary_f1_score': 0.9908828}
confusion matrix:
       0     1
0  42310     0
1     82  4456
---- Validation: 
scalar performance:
{'acc': 0.9675065, 'precision': 0.4839595, 'recall': 0.49977988, 'specificity': 0.49977988, 'f1': 0.4917425, 'auroc': 0.9537456, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99955976, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18163  8
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99702513, 'precision': 0.99833804, 'recall': 0.9862259, 'specificity': 0.9862259, 'f1': 0.9921844, 'auroc': 0.9999178, 'binary_precision': 1.0, 'binary_recall': 0.9724518, 'binary_specificity': 1.0, 'binary_f1_score': 0.9860335}
confusion matrix:
      0    1
0  5997    0
1    20  706
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011747_14.png
early stop counter: 1
val acc:0.9675065279006958, best validation acc: 0.973259449005127, corresponding to test acc:                         0.9989588260650635 / 0.9992563128471375
after epoch: 14,now: 2024-06-03 20:21:49.538581,epoch time: 0:35:02.406386,used: 9:16:28.132061,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_11_05_21_seed_2_21011747
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
slurmstepd: error: *** JOB 21011747 ON gpusrv27 CANCELLED AT 2024-06-03T20:38:45 DUE TO TIME LIMIT ***
