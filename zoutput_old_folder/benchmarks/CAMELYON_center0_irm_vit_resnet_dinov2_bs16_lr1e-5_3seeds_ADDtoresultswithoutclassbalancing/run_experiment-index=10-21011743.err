Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Fri May 31 13:26:34 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/rule_results/10.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=10
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_34_43_seed_0_21011743

 Experiment start at: 2024-05-31 13:34:44.007886
before training, model accuracy: 0.2401725947856903
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9661582, 'precision': 0.723906, 'recall': 0.5372578, 'specificity': 0.5372578, 'f1': 0.55803776, 'auroc': 0.9009739, 'binary_precision': 0.4789916, 'binary_recall': 0.07744565, 'binary_specificity': 0.99706995, 'binary_f1_score': 0.13333333}
confusion matrix:
       0    1
0  42196  124
1   1358  114
---- Validation: 
scalar performance:
{'acc': 0.96546406, 'precision': 0.7218081, 'recall': 0.5425879, 'specificity': 0.5425879, 'f1': 0.5658922, 'auroc': 0.8897041, 'binary_precision': 0.475, 'binary_recall': 0.08864697, 'binary_specificity': 0.99652874, 'binary_f1_score': 0.14941022}
confusion matrix:
       0   1
0  18086  63
1    586  57
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642058, 'precision': 0.90712297, 'recall': 0.5855399, 'specificity': 0.5855399, 'f1': 0.6341333, 'auroc': 0.8841578, 'binary_precision': 0.8490566, 'binary_recall': 0.1724138, 'binary_specificity': 0.998666, 'binary_f1_score': 0.2866242}
confusion matrix:
      0   1
0  5989   8
1   216  45
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011743_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-31 13:56:05.423914,epoch time: 0:21:21.416028,used: 0:21:21.416028,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_34_43_seed_0_21011743
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9666149, 'precision': 0.74097836, 'recall': 0.6529005, 'specificity': 0.6529005, 'f1': 0.68607247, 'auroc': 0.9228888, 'binary_precision': 0.505423, 'binary_recall': 0.3165761, 'binary_specificity': 0.989225, 'binary_f1_score': 0.3893066}
confusion matrix:
       0    1
0  41864  456
1   1006  466
---- Validation: 
scalar performance:
{'acc': 0.96514475, 'precision': 0.7313216, 'recall': 0.657931, 'specificity': 0.657931, 'f1': 0.6869437, 'auroc': 0.9088361, 'binary_precision': 0.48617512, 'binary_recall': 0.3281493, 'binary_specificity': 0.9877128, 'binary_f1_score': 0.39182916}
confusion matrix:
       0    1
0  17926  223
1    432  211
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9757111, 'precision': 0.90692365, 'recall': 0.7582853, 'specificity': 0.7582853, 'f1': 0.8144696, 'auroc': 0.91617393, 'binary_precision': 0.83435583, 'binary_recall': 0.5210728, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.6415094}
confusion matrix:
      0    1
0  5970   27
1   125  136
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011743_2.png
new oracle model saved
early stop counter: 1
val acc:0.9651447534561157, best validation acc: 0.9654640555381775, corresponding to test acc:                         0.964205801486969 / 0.9757111072540283
after epoch: 2,now: 2024-05-31 14:16:48.924968,epoch time: 0:20:43.501054,used: 0:42:04.917082,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_34_43_seed_0_21011743
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96629524, 'precision': 0.74057966, 'recall': 0.74846876, 'specificity': 0.74846876, 'f1': 0.74445325, 'auroc': 0.9374416, 'binary_precision': 0.4980263, 'binary_recall': 0.514966, 'binary_specificity': 0.98197156, 'binary_f1_score': 0.5063545}
confusion matrix:
       0    1
0  41559  763
1    713  757
---- Validation: 
scalar performance:
{'acc': 0.9642401, 'precision': 0.7319444, 'recall': 0.7617204, 'specificity': 0.7617204, 'f1': 0.7458234, 'auroc': 0.92730117, 'binary_precision': 0.48010975, 'binary_recall': 0.5443235, 'binary_specificity': 0.97911733, 'binary_f1_score': 0.5102041}
confusion matrix:
       0    1
0  17770  379
1    293  350
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97746885, 'precision': 0.88365304, 'recall': 0.8141724, 'specificity': 0.8141724, 'f1': 0.8450973, 'auroc': 0.9206021, 'binary_precision': 0.7830189, 'binary_recall': 0.6360153, 'binary_specificity': 0.9923295, 'binary_f1_score': 0.7019027}
confusion matrix:
      0    1
0  5951   46
1    95  166
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011743_3.png
new oracle model saved
early stop counter: 2
val acc:0.9642400741577148, best validation acc: 0.9654640555381775, corresponding to test acc:                         0.964205801486969 / 0.9774688482284546
after epoch: 3,now: 2024-05-31 14:37:50.116350,epoch time: 0:21:01.191382,used: 1:03:06.108464,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_34_43_seed_0_21011743
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96761966, 'precision': 0.75080824, 'recall': 0.7253681, 'specificity': 0.7253681, 'f1': 0.7373346, 'auroc': 0.9404363, 'binary_precision': 0.5201215, 'binary_recall': 0.4656696, 'binary_specificity': 0.98506653, 'binary_f1_score': 0.49139172}
confusion matrix:
       0    1
0  41689  632
1    786  685
---- Validation: 
scalar performance:
{'acc': 0.9656237, 'precision': 0.7398141, 'recall': 0.7369348, 'specificity': 0.7369348, 'f1': 0.73836476, 'auroc': 0.92837465, 'binary_precision': 0.4976378, 'binary_recall': 0.49144635, 'binary_specificity': 0.98242325, 'binary_f1_score': 0.49452272}
confusion matrix:
       0    1
0  17830  319
1    327  316
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9785874, 'precision': 0.8956143, 'recall': 0.8165884, 'specificity': 0.8165884, 'f1': 0.8512765, 'auroc': 0.9208824, 'binary_precision': 0.8067633, 'binary_recall': 0.63984674, 'binary_specificity': 0.99333, 'binary_f1_score': 0.7136752}
confusion matrix:
      0    1
0  5957   40
1    94  167
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011743_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-05-31 14:59:30.470720,epoch time: 0:21:40.354370,used: 1:24:46.462834,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_34_43_seed_0_21011743
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9682362, 'precision': 0.7552858, 'recall': 0.7688179, 'specificity': 0.7688179, 'f1': 0.7618576, 'auroc': 0.94758785, 'binary_precision': 0.5260786, 'binary_recall': 0.5550272, 'binary_specificity': 0.9826087, 'binary_f1_score': 0.54016536}
confusion matrix:
       0    1
0  41584  736
1    655  817
---- Validation: 
scalar performance:
{'acc': 0.9649319, 'precision': 0.7366034, 'recall': 0.7673289, 'specificity': 0.7673289, 'f1': 0.75091517, 'auroc': 0.9306662, 'binary_precision': 0.4890411, 'binary_recall': 0.55520993, 'binary_specificity': 0.9794479, 'binary_f1_score': 0.5200291}
confusion matrix:
       0    1
0  17776  373
1    286  357
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97794825, 'precision': 0.8866739, 'recall': 0.8180872, 'specificity': 0.8180872, 'f1': 0.84870046, 'auroc': 0.9297336, 'binary_precision': 0.7887324, 'binary_recall': 0.6436782, 'binary_specificity': 0.99249625, 'binary_f1_score': 0.70886075}
confusion matrix:
      0    1
0  5952   45
1    93  168
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011743_5.png
early stop counter: 1
val acc:0.9649319052696228, best validation acc: 0.965623676776886, corresponding to test acc:                         0.9785873889923096 / 0.9785873889923096
after epoch: 5,now: 2024-05-31 15:20:14.033886,epoch time: 0:20:43.563166,used: 1:45:30.026000,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_34_43_seed_0_21011743
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96867007, 'precision': 0.75852776, 'recall': 0.76969814, 'specificity': 0.76969814, 'f1': 0.7639818, 'auroc': 0.9482, 'binary_precision': 0.53250974, 'binary_recall': 0.5563859, 'binary_specificity': 0.9830104, 'binary_f1_score': 0.54418606}
confusion matrix:
       0    1
0  41601  719
1    653  819
---- Validation: 
scalar performance:
{'acc': 0.96546406, 'precision': 0.7403607, 'recall': 0.77585506, 'specificity': 0.77585506, 'f1': 0.7567396, 'auroc': 0.93627495, 'binary_precision': 0.49595687, 'binary_recall': 0.57231724, 'binary_specificity': 0.9793928, 'binary_f1_score': 0.53140795}
confusion matrix:
       0    1
0  17775  374
1    275  368
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.978907, 'precision': 0.8981124, 'recall': 0.8185875, 'specificity': 0.8185875, 'f1': 0.8534963, 'auroc': 0.93469155, 'binary_precision': 0.8115942, 'binary_recall': 0.6436782, 'binary_specificity': 0.9934968, 'binary_f1_score': 0.71794873}
confusion matrix:
      0    1
0  5958   39
1    93  168
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011743_6.png
new oracle model saved
early stop counter: 2
val acc:0.9654640555381775, best validation acc: 0.965623676776886, corresponding to test acc:                         0.9785873889923096 / 0.9789069890975952
after epoch: 6,now: 2024-05-31 15:41:04.811343,epoch time: 0:20:50.777457,used: 2:06:20.803457,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_34_43_seed_0_21011743
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96750546, 'precision': 0.7501384, 'recall': 0.79040647, 'specificity': 0.79040647, 'f1': 0.7685983, 'auroc': 0.94562364, 'binary_precision': 0.5142525, 'binary_recall': 0.6005435, 'binary_specificity': 0.9802694, 'binary_f1_score': 0.5540583}
confusion matrix:
       0    1
0  41485  835
1    588  884
---- Validation: 
scalar performance:
{'acc': 0.9653576, 'precision': 0.7403017, 'recall': 0.7893009, 'specificity': 0.7893009, 'f1': 0.7622565, 'auroc': 0.93350625, 'binary_precision': 0.4948718, 'binary_recall': 0.60031104, 'binary_specificity': 0.9782908, 'binary_f1_score': 0.54251575}
confusion matrix:
       0    1
0  17755  394
1    257  386
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9790668, 'precision': 0.89585894, 'recall': 0.82416785, 'specificity': 0.82416785, 'f1': 0.85608333, 'auroc': 0.9288423, 'binary_precision': 0.8066038, 'binary_recall': 0.6551724, 'binary_specificity': 0.9931632, 'binary_f1_score': 0.7230444}
confusion matrix:
      0    1
0  5956   41
1    90  171
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011743_7.png
new oracle model saved
early stop counter: 3
val acc:0.9653576016426086, best validation acc: 0.965623676776886, corresponding to test acc:                         0.9785873889923096 / 0.979066789150238
after epoch: 7,now: 2024-05-31 16:01:54.773013,epoch time: 0:20:49.961670,used: 2:27:10.765127,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_34_43_seed_0_21011743
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.96650076, 'precision': 0.7443754, 'recall': 0.809886, 'specificity': 0.809886, 'f1': 0.7727927, 'auroc': 0.95275784, 'binary_precision': 0.50132626, 'binary_recall': 0.6419837, 'binary_specificity': 0.97778827, 'binary_f1_score': 0.5630027}
confusion matrix:
       0    1
0  41380  940
1    527  945
---- Validation: 
scalar performance:
{'acc': 0.9649851, 'precision': 0.73860174, 'recall': 0.79885876, 'specificity': 0.79885876, 'f1': 0.7649319, 'auroc': 0.9385225, 'binary_precision': 0.4907749, 'binary_recall': 0.62052876, 'binary_specificity': 0.9771888, 'binary_f1_score': 0.5480769}
confusion matrix:
       0    1
0  17735  414
1    244  399
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9784276, 'precision': 0.87683225, 'recall': 0.84215766, 'specificity': 0.84215766, 'f1': 0.858569, 'auroc': 0.9385241, 'binary_precision': 0.7669492, 'binary_recall': 0.6934866, 'binary_specificity': 0.99082875, 'binary_f1_score': 0.7283702}
confusion matrix:
      0    1
0  5942   55
1    80  181
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011743_8.png
early stop counter: 4
val acc:0.9649850726127625, best validation acc: 0.965623676776886, corresponding to test acc:                         0.9785873889923096 / 0.979066789150238
after epoch: 8,now: 2024-05-31 16:22:45.839356,epoch time: 0:20:51.066343,used: 2:48:01.831470,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_34_43_seed_0_21011743
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9661354, 'precision': 0.7431275, 'recall': 0.83133566, 'specificity': 0.83133566, 'f1': 0.77962595, 'auroc': 0.95335245, 'binary_precision': 0.49729463, 'binary_recall': 0.6868206, 'binary_specificity': 0.97585064, 'binary_f1_score': 0.5768901}
confusion matrix:
       0     1
0  41298  1022
1    461  1011
---- Validation: 
scalar performance:
{'acc': 0.9648787, 'precision': 0.7396657, 'recall': 0.83105606, 'specificity': 0.83105606, 'f1': 0.77711296, 'auroc': 0.9407866, 'binary_precision': 0.49056605, 'binary_recall': 0.6874028, 'binary_specificity': 0.97470933, 'binary_f1_score': 0.57253885}
confusion matrix:
       0    1
0  17690  459
1    201  442
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97682965, 'precision': 0.8578441, 'recall': 0.8486532, 'specificity': 0.8486532, 'f1': 0.8531821, 'auroc': 0.9374732, 'binary_precision': 0.72834647, 'binary_recall': 0.70881224, 'binary_specificity': 0.9884942, 'binary_f1_score': 0.71844655}
confusion matrix:
      0    1
0  5928   69
1    76  185
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011743_9.png
early stop counter: 5
val acc:0.9648786783218384, best validation acc: 0.965623676776886, corresponding to test acc:                         0.9785873889923096 / 0.979066789150238
after epoch: 9,now: 2024-05-31 16:43:26.121952,epoch time: 0:20:40.282596,used: 3:08:42.114066,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_34_43_seed_0_21011743
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.96716297, 'precision': 0.74826086, 'recall': 0.8147004, 'specificity': 0.8147004, 'f1': 0.77709293, 'auroc': 0.9539305, 'binary_precision': 0.5087626, 'binary_recall': 0.65125763, 'binary_specificity': 0.9781432, 'binary_f1_score': 0.5712582}
confusion matrix:
       0    1
0  41396  925
1    513  958
---- Validation: 
scalar performance:
{'acc': 0.9655172, 'precision': 0.7421237, 'recall': 0.8103851, 'specificity': 0.8103851, 'f1': 0.77151465, 'auroc': 0.9467555, 'binary_precision': 0.4969988, 'binary_recall': 0.64385694, 'binary_specificity': 0.97691333, 'binary_f1_score': 0.56097555}
confusion matrix:
       0    1
0  17730  419
1    229  414
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9785874, 'precision': 0.8763657, 'recall': 0.84590566, 'specificity': 0.84590566, 'f1': 0.8604241, 'auroc': 0.94178253, 'binary_precision': 0.7656904, 'binary_recall': 0.7011494, 'binary_specificity': 0.990662, 'binary_f1_score': 0.73200005}
confusion matrix:
      0    1
0  5941   56
1    78  183
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011743_10.png
early stop counter: 6
val acc:0.9655172228813171, best validation acc: 0.965623676776886, corresponding to test acc:                         0.9785873889923096 / 0.979066789150238
after epoch: 10,now: 2024-05-31 17:04:15.999119,epoch time: 0:20:49.877167,used: 3:29:31.991233,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_34_43_seed_0_21011743
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9664322, 'precision': 0.74432933, 'recall': 0.8200142, 'specificity': 0.8200142, 'f1': 0.7764802, 'auroc': 0.95654964, 'binary_precision': 0.50051284, 'binary_recall': 0.6630435, 'binary_specificity': 0.97698486, 'binary_f1_score': 0.5704267}
confusion matrix:
       0    1
0  41346  974
1    496  976
---- Validation: 
scalar performance:
{'acc': 0.965198, 'precision': 0.74044925, 'recall': 0.81246996, 'specificity': 0.81246996, 'f1': 0.7711828, 'auroc': 0.9462608, 'binary_precision': 0.4934911, 'binary_recall': 0.64852256, 'binary_specificity': 0.9764174, 'binary_f1_score': 0.5604839}
confusion matrix:
       0    1
0  17721  428
1    226  417
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9755513, 'precision': 0.8527701, 'recall': 0.83332753, 'specificity': 0.83332753, 'f1': 0.8427422, 'auroc': 0.94802636, 'binary_precision': 0.7195122, 'binary_recall': 0.6781609, 'binary_specificity': 0.9884942, 'binary_f1_score': 0.69822484}
confusion matrix:
      0    1
0  5928   69
1    84  177
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011743_11.png
early stop counter: 7
val acc:0.9651979804039001, best validation acc: 0.965623676776886, corresponding to test acc:                         0.9785873889923096 / 0.979066789150238
after epoch: 11,now: 2024-05-31 17:25:03.304005,epoch time: 0:20:47.304886,used: 3:50:19.296119,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_34_43_seed_0_21011743
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9666149, 'precision': 0.7454339, 'recall': 0.8224037, 'specificity': 0.8224037, 'f1': 0.7780699, 'auroc': 0.95586616, 'binary_precision': 0.50255626, 'binary_recall': 0.66779894, 'binary_specificity': 0.9770085, 'binary_f1_score': 0.5735123}
confusion matrix:
       0    1
0  41347  973
1    489  983
---- Validation: 
scalar performance:
{'acc': 0.96450615, 'precision': 0.73752016, 'recall': 0.8263629, 'specificity': 0.8263629, 'f1': 0.77404857, 'auroc': 0.9474853, 'binary_precision': 0.48660713, 'binary_recall': 0.67807156, 'binary_specificity': 0.97465426, 'binary_f1_score': 0.5666017}
confusion matrix:
       0    1
0  17689  460
1    207  436
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97331417, 'precision': 0.8401067, 'recall': 0.813837, 'specificity': 0.813837, 'f1': 0.8263837, 'auroc': 0.9392974, 'binary_precision': 0.6958333, 'binary_recall': 0.63984674, 'binary_specificity': 0.98782724, 'binary_f1_score': 0.6666667}
confusion matrix:
      0    1
0  5924   73
1    94  167
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011743_12.png
early stop counter: 8
val acc:0.9645061492919922, best validation acc: 0.965623676776886, corresponding to test acc:                         0.9785873889923096 / 0.979066789150238
after epoch: 12,now: 2024-05-31 17:45:40.906657,epoch time: 0:20:37.602652,used: 4:10:56.898771,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_34_43_seed_0_21011743
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.96522194, 'precision': 0.7394554, 'recall': 0.8543794, 'specificity': 0.8543794, 'f1': 0.78438693, 'auroc': 0.95789504, 'binary_precision': 0.48826715, 'binary_recall': 0.73555404, 'binary_specificity': 0.9732048, 'binary_f1_score': 0.58692706}
confusion matrix:
       0     1
0  41187  1134
1    389  1082
---- Validation: 
scalar performance:
{'acc': 0.963708, 'precision': 0.73499274, 'recall': 0.84845126, 'specificity': 0.84845126, 'f1': 0.7792436, 'auroc': 0.9484538, 'binary_precision': 0.47991762, 'binary_recall': 0.7247278, 'binary_specificity': 0.97217476, 'binary_f1_score': 0.57744735}
confusion matrix:
       0    1
0  17644  505
1    177  466
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97379357, 'precision': 0.8302759, 'recall': 0.8543985, 'specificity': 0.8543985, 'f1': 0.8418603, 'auroc': 0.9523651, 'binary_precision': 0.6725979, 'binary_recall': 0.7241379, 'binary_specificity': 0.984659, 'binary_f1_score': 0.69741696}
confusion matrix:
      0    1
0  5905   92
1    72  189
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011743_13.png
early stop counter: 9
val acc:0.9637079834938049, best validation acc: 0.965623676776886, corresponding to test acc:                         0.9785873889923096 / 0.979066789150238
after epoch: 13,now: 2024-05-31 18:06:26.090098,epoch time: 0:20:45.183441,used: 4:31:42.082212,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_34_43_seed_0_21011743
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9653818, 'precision': 0.73976743, 'recall': 0.8452756, 'specificity': 0.8452756, 'f1': 0.78181076, 'auroc': 0.96092516, 'binary_precision': 0.48954946, 'binary_recall': 0.71651936, 'binary_specificity': 0.9740318, 'binary_f1_score': 0.58167773}
confusion matrix:
       0     1
0  41222  1099
1    417  1054
---- Validation: 
scalar performance:
{'acc': 0.96376115, 'precision': 0.7344181, 'recall': 0.83572793, 'specificity': 0.83572793, 'f1': 0.7749002, 'auroc': 0.9505228, 'binary_precision': 0.47970086, 'binary_recall': 0.6982893, 'binary_specificity': 0.9731666, 'binary_f1_score': 0.5687144}
confusion matrix:
       0    1
0  17662  487
1    194  449
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9712368, 'precision': 0.8200824, 'recall': 0.8200824, 'specificity': 0.8200824, 'f1': 0.8200824, 'auroc': 0.9345362, 'binary_precision': 0.6551724, 'binary_recall': 0.6551724, 'binary_specificity': 0.9849925, 'binary_f1_score': 0.6551724}
confusion matrix:
      0    1
0  5907   90
1    90  171
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011743_14.png
early stop counter: 10
val acc:0.9637611508369446, best validation acc: 0.965623676776886, corresponding to test acc:                         0.9785873889923096 / 0.979066789150238
after epoch: 14,now: 2024-05-31 18:27:11.158088,epoch time: 0:20:45.067990,used: 4:52:27.150202,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_34_43_seed_0_21011743
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9647881, 'precision': 0.73694277, 'recall': 0.8447366, 'specificity': 0.8447366, 'f1': 0.7795813, 'auroc': 0.96081823, 'binary_precision': 0.4839302, 'binary_recall': 0.7160326, 'binary_specificity': 0.97344047, 'binary_f1_score': 0.57753426}
confusion matrix:
       0     1
0  41196  1124
1    418  1054
---- Validation: 
scalar performance:
{'acc': 0.96397406, 'precision': 0.7365997, 'recall': 0.85458946, 'specificity': 0.85458946, 'f1': 0.7822788, 'auroc': 0.95271665, 'binary_precision': 0.4826884, 'binary_recall': 0.7371695, 'binary_specificity': 0.9720095, 'binary_f1_score': 0.5833846}
confusion matrix:
       0    1
0  17641  508
1    169  474
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96772134, 'precision': 0.7995577, 'recall': 0.7907632, 'specificity': 0.7907632, 'f1': 0.7950867, 'auroc': 0.94279194, 'binary_precision': 0.6166008, 'binary_recall': 0.59770113, 'binary_specificity': 0.98382527, 'binary_f1_score': 0.60700387}
confusion matrix:
      0    1
0  5900   97
1   105  156
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011743_15.png
early stop counter: 11
val acc:0.9639740586280823, best validation acc: 0.965623676776886, corresponding to test acc:                         0.9785873889923096 / 0.979066789150238
after epoch: 15,now: 2024-05-31 18:48:12.510238,epoch time: 0:21:01.352150,used: 5:13:28.502352,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_34_43_seed_0_21011743
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9672771, 'precision': 0.74970317, 'recall': 0.84602433, 'specificity': 0.84602433, 'f1': 0.7891306, 'auroc': 0.96515125, 'binary_precision': 0.50942487, 'binary_recall': 0.7160326, 'binary_specificity': 0.97601604, 'binary_f1_score': 0.59531206}
confusion matrix:
       0     1
0  41305  1015
1    418  1054
---- Validation: 
scalar performance:
{'acc': 0.9648787, 'precision': 0.7404878, 'recall': 0.8475573, 'specificity': 0.8475573, 'f1': 0.7830238, 'auroc': 0.9521845, 'binary_precision': 0.4910053, 'binary_recall': 0.7216174, 'binary_specificity': 0.97349715, 'binary_f1_score': 0.5843829}
confusion matrix:
       0    1
0  17668  481
1    179  464
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97283477, 'precision': 0.8409688, 'recall': 0.8007605, 'specificity': 0.8007605, 'f1': 0.81946254, 'auroc': 0.94707906, 'binary_precision': 0.69868994, 'binary_recall': 0.6130268, 'binary_specificity': 0.9884942, 'binary_f1_score': 0.6530612}
confusion matrix:
      0    1
0  5928   69
1   101  160
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011743_16.png
early stop counter: 12
val acc:0.9648786783218384, best validation acc: 0.965623676776886, corresponding to test acc:                         0.9785873889923096 / 0.979066789150238
after epoch: 16,now: 2024-05-31 19:08:59.352077,epoch time: 0:20:46.841839,used: 5:34:15.344191,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_34_43_seed_0_21011743
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9664779, 'precision': 0.7456542, 'recall': 0.8511844, 'specificity': 0.8511844, 'f1': 0.78793514, 'auroc': 0.9642103, 'binary_precision': 0.50093544, 'binary_recall': 0.7275815, 'binary_specificity': 0.97478735, 'binary_f1_score': 0.5933518}
confusion matrix:
       0     1
0  41253  1067
1    401  1071
---- Validation: 
scalar performance:
{'acc': 0.9650383, 'precision': 0.7414116, 'recall': 0.8506402, 'specificity': 0.8506402, 'f1': 0.7846581, 'auroc': 0.9513974, 'binary_precision': 0.49263158, 'binary_recall': 0.7278383, 'binary_specificity': 0.9734421, 'binary_f1_score': 0.58757067}
confusion matrix:
       0    1
0  17667  482
1    175  468
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9693193, 'precision': 0.8138162, 'recall': 0.7860999, 'specificity': 0.7860999, 'f1': 0.7992409, 'auroc': 0.94942176, 'binary_precision': 0.6455696, 'binary_recall': 0.5862069, 'binary_specificity': 0.98599297, 'binary_f1_score': 0.61445785}
confusion matrix:
      0    1
0  5913   84
1   108  153
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011743_17.png
early stop counter: 13
val acc:0.9650382995605469, best validation acc: 0.965623676776886, corresponding to test acc:                         0.9785873889923096 / 0.979066789150238
after epoch: 17,now: 2024-05-31 19:29:59.412121,epoch time: 0:21:00.060044,used: 5:55:15.404235,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_34_43_seed_0_21011743
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9669118, 'precision': 0.74844146, 'recall': 0.87395483, 'specificity': 0.87395483, 'f1': 0.79696804, 'auroc': 0.96625674, 'binary_precision': 0.5048759, 'binary_recall': 0.7743032, 'binary_specificity': 0.97360647, 'binary_f1_score': 0.6112155}
confusion matrix:
       0     1
0  41204  1117
1    332  1139
---- Validation: 
scalar performance:
{'acc': 0.9654108, 'precision': 0.74352413, 'recall': 0.8575835, 'specificity': 0.8575835, 'f1': 0.7883488, 'auroc': 0.9551109, 'binary_precision': 0.49635795, 'binary_recall': 0.7418352, 'binary_specificity': 0.97333187, 'binary_f1_score': 0.5947631}
confusion matrix:
       0    1
0  17665  484
1    166  477
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9683605, 'precision': 0.8040924, 'recall': 0.79292905, 'specificity': 0.79292905, 'f1': 0.79839337, 'auroc': 0.93950105, 'binary_precision': 0.625498, 'binary_recall': 0.6015326, 'binary_specificity': 0.98432547, 'binary_f1_score': 0.61328125}
confusion matrix:
      0    1
0  5903   94
1   104  157
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011743_18.png
early stop counter: 14
val acc:0.9654108285903931, best validation acc: 0.965623676776886, corresponding to test acc:                         0.9785873889923096 / 0.979066789150238
after epoch: 18,now: 2024-05-31 19:50:41.188323,epoch time: 0:20:41.776202,used: 6:15:57.180437,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_34_43_seed_0_21011743
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.96392035, 'precision': 0.7345129, 'recall': 0.8698606, 'specificity': 0.8698606, 'f1': 0.785051, 'auroc': 0.9644581, 'binary_precision': 0.4772344, 'binary_recall': 0.76902175, 'binary_specificity': 0.9706994, 'binary_f1_score': 0.5889698}
confusion matrix:
       0     1
0  41080  1240
1    340  1132
---- Validation: 
scalar performance:
{'acc': 0.9642933, 'precision': 0.7390015, 'recall': 0.871256, 'specificity': 0.871256, 'f1': 0.78891623, 'auroc': 0.95526147, 'binary_precision': 0.4862745, 'binary_recall': 0.7713841, 'binary_specificity': 0.97112787, 'binary_f1_score': 0.5965123}
confusion matrix:
       0    1
0  17625  524
1    147  496
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96740174, 'precision': 0.8048847, 'recall': 0.75761443, 'specificity': 0.75761443, 'f1': 0.77902544, 'auroc': 0.94244826, 'binary_precision': 0.63013697, 'binary_recall': 0.52873564, 'binary_specificity': 0.98649323, 'binary_f1_score': 0.575}
confusion matrix:
      0    1
0  5916   81
1   123  138
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011743_19.png
early stop counter: 15
val acc:0.9642933011054993, best validation acc: 0.965623676776886, corresponding to test acc:                         0.9785873889923096 / 0.979066789150238
after epoch: 19,now: 2024-05-31 20:10:56.440866,epoch time: 0:20:15.252543,used: 6:36:12.432980,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_34_43_seed_0_21011743
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.96506214, 'precision': 0.73948324, 'recall': 0.8671727, 'specificity': 0.8671727, 'f1': 0.7881695, 'auroc': 0.9669428, 'binary_precision': 0.48740226, 'binary_recall': 0.76222825, 'binary_specificity': 0.9721172, 'binary_f1_score': 0.5945946}
confusion matrix:
       0     1
0  41140  1180
1    350  1122
---- Validation: 
scalar performance:
{'acc': 0.9641337, 'precision': 0.73811746, 'recall': 0.8681731, 'specificity': 0.8681731, 'f1': 0.7873627, 'auroc': 0.9545987, 'binary_precision': 0.48472905, 'binary_recall': 0.7651633, 'binary_specificity': 0.971183, 'binary_f1_score': 0.59348613}
confusion matrix:
       0    1
0  17626  523
1    151  492
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97267497, 'precision': 0.8479663, 'recall': 0.7823538, 'specificity': 0.7823538, 'f1': 0.811373, 'auroc': 0.93706065, 'binary_precision': 0.71428573, 'binary_recall': 0.57471263, 'binary_specificity': 0.989995, 'binary_f1_score': 0.6369426}
confusion matrix:
      0    1
0  5937   60
1   111  150
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011743_20.png
early stop counter: 16
val acc:0.9641336798667908, best validation acc: 0.965623676776886, corresponding to test acc:                         0.9785873889923096 / 0.979066789150238
after epoch: 20,now: 2024-05-31 20:31:32.824873,epoch time: 0:20:36.384007,used: 6:56:48.816987,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_34_43_seed_0_21011743
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9668889, 'precision': 0.74818885, 'recall': 0.8654951, 'specificity': 0.8654951, 'f1': 0.7942414, 'auroc': 0.9675894, 'binary_precision': 0.5049864, 'binary_recall': 0.7567935, 'binary_specificity': 0.9741966, 'binary_f1_score': 0.60576403}
confusion matrix:
       0     1
0  41228  1092
1    358  1114
---- Validation: 
scalar performance:
{'acc': 0.9638144, 'precision': 0.7358172, 'recall': 0.8537568, 'specificity': 0.8537568, 'f1': 0.7814424, 'auroc': 0.95544326, 'binary_precision': 0.48118007, 'binary_recall': 0.7356143, 'binary_specificity': 0.9718993, 'binary_f1_score': 0.5817958}
confusion matrix:
       0    1
0  17639  510
1    170  473
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9696389, 'precision': 0.8195237, 'recall': 0.77710503, 'specificity': 0.77710503, 'f1': 0.7966298, 'auroc': 0.9526543, 'binary_precision': 0.6577778, 'binary_recall': 0.5670498, 'binary_specificity': 0.98716027, 'binary_f1_score': 0.6090535}
confusion matrix:
      0    1
0  5920   77
1   113  148
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011743_21.png
early stop counter: 17
val acc:0.963814377784729, best validation acc: 0.965623676776886, corresponding to test acc:                         0.9785873889923096 / 0.979066789150238
after epoch: 21,now: 2024-05-31 20:51:42.897778,epoch time: 0:20:10.072905,used: 7:16:58.889892,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_34_43_seed_0_21011743
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9667976, 'precision': 0.74775064, 'recall': 0.8696306, 'specificity': 0.8696306, 'f1': 0.7951643, 'auroc': 0.9681953, 'binary_precision': 0.50380313, 'binary_recall': 0.7654657, 'binary_specificity': 0.97379553, 'binary_f1_score': 0.6076633}
confusion matrix:
       0     1
0  41212  1109
1    345  1126
---- Validation: 
scalar performance:
{'acc': 0.9654108, 'precision': 0.74346155, 'recall': 0.8560834, 'specificity': 0.8560834, 'f1': 0.7878432, 'auroc': 0.9557855, 'binary_precision': 0.49634275, 'binary_recall': 0.7387247, 'binary_specificity': 0.9734421, 'binary_f1_score': 0.59375}
confusion matrix:
       0    1
0  17667  482
1    168  475
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96724194, 'precision': 0.8084086, 'recall': 0.74104005, 'specificity': 0.74104005, 'f1': 0.7701136, 'auroc': 0.9461041, 'binary_precision': 0.6386139, 'binary_recall': 0.49425286, 'binary_specificity': 0.98782724, 'binary_f1_score': 0.5572354}
confusion matrix:
      0    1
0  5924   73
1   132  129
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011743_22.png
early stop counter: 18
val acc:0.9654108285903931, best validation acc: 0.965623676776886, corresponding to test acc:                         0.9785873889923096 / 0.979066789150238
after epoch: 22,now: 2024-05-31 21:12:01.865322,epoch time: 0:20:18.967544,used: 7:37:17.857436,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_34_43_seed_0_21011743
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.96487945, 'precision': 0.73847574, 'recall': 0.8641275, 'specificity': 0.8641275, 'f1': 0.7865217, 'auroc': 0.966719, 'binary_precision': 0.48560208, 'binary_recall': 0.7561141, 'binary_specificity': 0.97214085, 'binary_f1_score': 0.59139216}
confusion matrix:
       0     1
0  41141  1179
1    359  1113
---- Validation: 
scalar performance:
{'acc': 0.96301615, 'precision': 0.7333033, 'recall': 0.8690947, 'specificity': 0.8690947, 'f1': 0.783844, 'auroc': 0.95471585, 'binary_precision': 0.475, 'binary_recall': 0.7682737, 'binary_specificity': 0.9699157, 'binary_f1_score': 0.5870469}
confusion matrix:
       0    1
0  17603  546
1    149  494
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96228826, 'precision': 0.77038133, 'recall': 0.6981441, 'specificity': 0.6981441, 'f1': 0.72799826, 'auroc': 0.93240106, 'binary_precision': 0.56613755, 'binary_recall': 0.4099617, 'binary_specificity': 0.9863265, 'binary_f1_score': 0.47555557}
confusion matrix:
      0    1
0  5915   82
1   154  107
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011743_23.png
early stop counter: 19
val acc:0.963016152381897, best validation acc: 0.965623676776886, corresponding to test acc:                         0.9785873889923096 / 0.979066789150238
after epoch: 23,now: 2024-05-31 21:32:18.372788,epoch time: 0:20:16.507466,used: 7:57:34.364902,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_34_43_seed_0_21011743
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9685559, 'precision': 0.756806, 'recall': 0.8561939, 'specificity': 0.8561939, 'f1': 0.7974807, 'auroc': 0.97269607, 'binary_precision': 0.5229358, 'binary_recall': 0.7357337, 'binary_specificity': 0.97665405, 'binary_f1_score': 0.6113463}
confusion matrix:
       0     1
0  41332   988
1    389  1083
---- Validation: 
scalar performance:
{'acc': 0.96631545, 'precision': 0.7483965, 'recall': 0.8715528, 'specificity': 0.8715528, 'f1': 0.79618955, 'auroc': 0.95839643, 'binary_precision': 0.50510204, 'binary_recall': 0.7698289, 'binary_specificity': 0.9732768, 'binary_f1_score': 0.60998154}
confusion matrix:
       0    1
0  17664  485
1    148  495
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96612334, 'precision': 0.803116, 'recall': 0.7221331, 'specificity': 0.7221331, 'f1': 0.75565946, 'auroc': 0.9436487, 'binary_precision': 0.6296296, 'binary_recall': 0.4559387, 'binary_specificity': 0.9883275, 'binary_f1_score': 0.5288889}
confusion matrix:
      0    1
0  5927   70
1   142  119
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011743_24.png
better model found
persisted
after epoch: 24,now: 2024-05-31 21:52:36.124169,epoch time: 0:20:17.751381,used: 8:17:52.116283,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_34_43_seed_0_21011743
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9663181, 'precision': 0.7463347, 'recall': 0.8943174, 'specificity': 0.8943174, 'f1': 0.80106294, 'auroc': 0.9713533, 'binary_precision': 0.49916944, 'binary_recall': 0.8171312, 'binary_specificity': 0.9715035, 'binary_f1_score': 0.61974734}
confusion matrix:
       0     1
0  41115  1206
1    269  1202
---- Validation: 
scalar performance:
{'acc': 0.96243083, 'precision': 0.7320823, 'recall': 0.88604295, 'specificity': 0.88604295, 'f1': 0.7872782, 'auroc': 0.95815575, 'binary_precision': 0.4712853, 'binary_recall': 0.80404353, 'binary_specificity': 0.9680423, 'binary_f1_score': 0.5942528}
confusion matrix:
       0    1
0  17569  580
1    126  517
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96596354, 'precision': 0.79243255, 'recall': 0.7568641, 'specificity': 0.7568641, 'f1': 0.7733535, 'auroc': 0.94767565, 'binary_precision': 0.6052632, 'binary_recall': 0.52873564, 'binary_specificity': 0.9849925, 'binary_f1_score': 0.5644172}
confusion matrix:
      0    1
0  5907   90
1   123  138
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011743_25.png
early stop counter: 1
val acc:0.9624308347702026, best validation acc: 0.9663154482841492, corresponding to test acc:                         0.9661233425140381 / 0.979066789150238
after epoch: 25,now: 2024-05-31 22:13:01.834877,epoch time: 0:20:25.710708,used: 8:38:17.826991,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_34_43_seed_0_21011743
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.96620387, 'precision': 0.74600756, 'recall': 0.89917964, 'specificity': 0.89917964, 'f1': 0.8020909, 'auroc': 0.9717792, 'binary_precision': 0.498158, 'binary_recall': 0.8273283, 'binary_specificity': 0.97103095, 'binary_f1_score': 0.6218702}
confusion matrix:
       0     1
0  41095  1226
1    254  1217
---- Validation: 
scalar performance:
{'acc': 0.96285653, 'precision': 0.7339678, 'recall': 0.8885135, 'specificity': 0.8885135, 'f1': 0.7894584, 'auroc': 0.955985, 'binary_precision': 0.47488585, 'binary_recall': 0.8087092, 'binary_specificity': 0.9683178, 'binary_f1_score': 0.59838897}
confusion matrix:
       0    1
0  17574  575
1    123  520
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96676254, 'precision': 0.79090786, 'recall': 0.79942465, 'specificity': 0.79942465, 'f1': 0.7950968, 'auroc': 0.9443419, 'binary_precision': 0.598513, 'binary_recall': 0.61685824, 'binary_specificity': 0.981991, 'binary_f1_score': 0.60754716}
confusion matrix:
      0    1
0  5889  108
1   100  161
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011743_26.png
early stop counter: 2
val acc:0.9628565311431885, best validation acc: 0.9663154482841492, corresponding to test acc:                         0.9661233425140381 / 0.979066789150238
after epoch: 26,now: 2024-05-31 22:33:17.318277,epoch time: 0:20:15.483400,used: 8:58:33.310391,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_34_43_seed_0_21011743
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9649023, 'precision': 0.7399436, 'recall': 0.8893845, 'specificity': 0.8893845, 'f1': 0.7946187, 'auroc': 0.97154033, 'binary_precision': 0.48670757, 'binary_recall': 0.80842394, 'binary_specificity': 0.970345, 'binary_f1_score': 0.6076079}
confusion matrix:
       0     1
0  41065  1255
1    282  1190
---- Validation: 
scalar performance:
{'acc': 0.9638676, 'precision': 0.7379467, 'recall': 0.8852867, 'specificity': 0.8852867, 'f1': 0.7918824, 'auroc': 0.9583602, 'binary_precision': 0.48311445, 'binary_recall': 0.8009331, 'binary_specificity': 0.9696402, 'binary_f1_score': 0.6026916}
confusion matrix:
       0    1
0  17598  551
1    128  515
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96724194, 'precision': 0.79460526, 'recall': 0.7978424, 'specificity': 0.7978424, 'f1': 0.79621387, 'auroc': 0.93908864, 'binary_precision': 0.6060606, 'binary_recall': 0.6130268, 'binary_specificity': 0.98265797, 'binary_f1_score': 0.60952383}
confusion matrix:
      0    1
0  5893  104
1   101  160
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011743_27.png
early stop counter: 3
val acc:0.9638676047325134, best validation acc: 0.9663154482841492, corresponding to test acc:                         0.9661233425140381 / 0.979066789150238
after epoch: 27,now: 2024-05-31 22:53:36.754272,epoch time: 0:20:19.435995,used: 9:18:52.746386,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_34_43_seed_0_21011743
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.96800786, 'precision': 0.7542316, 'recall': 0.8873848, 'specificity': 0.8873848, 'f1': 0.8052906, 'auroc': 0.9716929, 'binary_precision': 0.51552254, 'binary_recall': 0.80095106, 'binary_specificity': 0.97381854, 'binary_f1_score': 0.6272945}
confusion matrix:
       0     1
0  41212  1108
1    293  1179
---- Validation: 
scalar performance:
{'acc': 0.9645594, 'precision': 0.7411219, 'recall': 0.8893951, 'specificity': 0.8893951, 'f1': 0.7955251, 'auroc': 0.9607273, 'binary_precision': 0.48918155, 'binary_recall': 0.8087092, 'binary_specificity': 0.970081, 'binary_f1_score': 0.6096131}
confusion matrix:
       0    1
0  17606  543
1    123  520
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96628314, 'precision': 0.8054289, 'recall': 0.7203841, 'specificity': 0.7203841, 'f1': 0.7552407, 'auroc': 0.943508, 'binary_precision': 0.6344086, 'binary_recall': 0.45210728, 'binary_specificity': 0.988661, 'binary_f1_score': 0.5279642}
confusion matrix:
      0    1
0  5929   68
1   143  118
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011743_28.png
early stop counter: 4
val acc:0.9645593762397766, best validation acc: 0.9663154482841492, corresponding to test acc:                         0.9661233425140381 / 0.979066789150238
after epoch: 28,now: 2024-05-31 23:13:51.124404,epoch time: 0:20:14.370132,used: 9:39:07.116518,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_34_43_seed_0_21011743
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.96410304, 'precision': 0.7375293, 'recall': 0.9091973, 'specificity': 0.9091973, 'f1': 0.79756266, 'auroc': 0.97362757, 'binary_precision': 0.4803997, 'binary_recall': 0.8503401, 'binary_specificity': 0.9680544, 'binary_f1_score': 0.61394894}
confusion matrix:
       0     1
0  40970  1352
1    220  1250
---- Validation: 
scalar performance:
{'acc': 0.95992976, 'precision': 0.7239649, 'recall': 0.90199935, 'specificity': 0.90199935, 'f1': 0.78406787, 'auroc': 0.96202075, 'binary_precision': 0.45378152, 'binary_recall': 0.83981335, 'binary_specificity': 0.96418536, 'binary_f1_score': 0.58919805}
confusion matrix:
       0    1
0  17499  650
1    103  540
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645254, 'precision': 0.7814721, 'recall': 0.75244904, 'specificity': 0.75244904, 'f1': 0.7660706, 'auroc': 0.9409464, 'binary_precision': 0.583691, 'binary_recall': 0.5210728, 'binary_specificity': 0.98382527, 'binary_f1_score': 0.5506073}
confusion matrix:
      0    1
0  5900   97
1   125  136
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011743_29.png
early stop counter: 5
val acc:0.9599297642707825, best validation acc: 0.9663154482841492, corresponding to test acc:                         0.9661233425140381 / 0.979066789150238
after epoch: 29,now: 2024-05-31 23:34:03.529907,epoch time: 0:20:12.405503,used: 9:59:19.522021,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_34_43_seed_0_21011743
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.96650076, 'precision': 0.74747825, 'recall': 0.9003751, 'specificity': 0.9003751, 'f1': 0.80359006, 'auroc': 0.97502387, 'binary_precision': 0.50102586, 'binary_recall': 0.8294837, 'binary_specificity': 0.97126657, 'binary_f1_score': 0.62471217}
confusion matrix:
       0     1
0  41104  1216
1    251  1221
---- Validation: 
scalar performance:
{'acc': 0.96397406, 'precision': 0.7386997, 'recall': 0.89059216, 'specificity': 0.89059216, 'f1': 0.7938733, 'auroc': 0.9625686, 'binary_precision': 0.48423004, 'binary_recall': 0.8118196, 'binary_specificity': 0.9693647, 'binary_f1_score': 0.60662407}
confusion matrix:
       0    1
0  17593  556
1    121  522
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9693193, 'precision': 0.8143556, 'recall': 0.7842676, 'specificity': 0.7842676, 'f1': 0.79846495, 'auroc': 0.94545424, 'binary_precision': 0.6468085, 'binary_recall': 0.58237547, 'binary_specificity': 0.98615974, 'binary_f1_score': 0.61290324}
confusion matrix:
      0    1
0  5914   83
1   109  152
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011743_30.png
early stop counter: 6
val acc:0.9639740586280823, best validation acc: 0.9663154482841492, corresponding to test acc:                         0.9661233425140381 / 0.979066789150238
after epoch: 30,now: 2024-05-31 23:55:05.401338,epoch time: 0:21:01.871431,used: 10:20:21.393452,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_34_43_seed_0_21011743
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 10:20:21.393452 at 2024-05-31 23:55:05.401338
persisted model performance metric: 

scalar performance:
{'acc': 0.9678811, 'precision': 0.8148665, 'recall': 0.74137354, 'specificity': 0.74137354, 'f1': 0.7727104, 'auroc': 0.95128757, 'binary_precision': 0.6515151, 'binary_recall': 0.49425286, 'binary_specificity': 0.9884942, 'binary_f1_score': 0.5620915}
confusion matrix:
      0    1
0  5928   69
1   132  129
oracle model performance metric: 

scalar performance:
{'acc': 0.9787472, 'precision': 0.8834686, 'recall': 0.8368274, 'specificity': 0.8368274, 'f1': 0.8584789, 'auroc': 0.9380897, 'binary_precision': 0.78070176, 'binary_recall': 0.68199235, 'binary_specificity': 0.9916625, 'binary_f1_score': 0.7280163}
confusion matrix:
      0    1
0  5947   50
1    83  178
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/rule_results/10.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/rule_results/10.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/confusion_matrix/10.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 494363 KiB |  11071 MiB |   1660 TiB |   1660 TiB |
|       from large pool | 404544 KiB |  10998 MiB |   1657 TiB |   1657 TiB |
|       from small pool |  89819 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 494363 KiB |  11071 MiB |   1660 TiB |   1660 TiB |
|       from large pool | 404544 KiB |  10998 MiB |   1657 TiB |   1657 TiB |
|       from small pool |  89819 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476573 KiB |  10961 MiB |   1653 TiB |   1653 TiB |
|       from large pool | 387840 KiB |  10889 MiB |   1651 TiB |   1651 TiB |
|       from small pool |  88733 KiB |    123 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11226 MiB |  11226 MiB |  11226 MiB |      0 B   |
|       from large pool |  11100 MiB |  11100 MiB |  11100 MiB |      0 B   |
|       from small pool |    126 MiB |    126 MiB |    126 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1343 MiB |   1726 MiB | 593340 GiB | 593339 GiB |
|       from large pool |   1332 MiB |   1724 MiB | 590409 GiB | 590407 GiB |
|       from small pool |     10 MiB |     11 MiB |   2931 GiB |   2931 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3729    |    6720    |  137816 K  |  137812 K  |
|       from large pool |      87    |     909    |   64894 K  |   64894 K  |
|       from small pool |    3642    |    6631    |   72921 K  |   72918 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3729    |    6720    |  137816 K  |  137812 K  |
|       from large pool |      87    |     909    |   64894 K  |   64894 K  |
|       from small pool |    3642    |    6631    |   72921 K  |   72918 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     232    |     232    |     232    |       0    |
|       from large pool |     169    |     169    |     169    |       0    |
|       from small pool |      63    |      63    |      63    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      72    |    2768    |   70644 K  |   70644 K  |
|       from large pool |      20    |      59    |   32177 K  |   32177 K  |
|       from small pool |      52    |    2747    |   38467 K  |   38467 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  11071 MiB |   1660 TiB |   1660 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   1657 TiB |   1657 TiB |
|       from small pool |      0 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  11071 MiB |   1660 TiB |   1660 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   1657 TiB |   1657 TiB |
|       from small pool |      0 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10961 MiB |   1653 TiB |   1653 TiB |
|       from large pool |  16640 KiB |  10889 MiB |   1651 TiB |   1651 TiB |
|       from small pool |      0 KiB |    123 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1826 MiB |  11226 MiB |  11226 MiB |   9400 MiB |
|       from large pool |   1728 MiB |  11100 MiB |  11100 MiB |   9372 MiB |
|       from small pool |     98 MiB |    126 MiB |    126 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   1726 MiB | 593340 GiB | 593340 GiB |
|       from large pool | 134912 KiB |   1724 MiB | 590409 GiB | 590409 GiB |
|       from small pool |      0 KiB |     24 MiB |   2931 GiB |   2931 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6720    |  137816 K  |  137816 K  |
|       from large pool |       2    |     909    |   64894 K  |   64894 K  |
|       from small pool |       0    |    6631    |   72921 K  |   72921 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6720    |  137816 K  |  137816 K  |
|       from large pool |       2    |     909    |   64894 K  |   64894 K  |
|       from small pool |       0    |    6631    |   72921 K  |   72921 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      79    |     232    |     232    |     153    |
|       from large pool |      30    |     169    |     169    |     139    |
|       from small pool |      49    |      63    |      63    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2768    |   70646 K  |   70646 K  |
|       from large pool |       4    |      59    |   32177 K  |   32177 K  |
|       from small pool |       0    |    2747    |   38468 K  |   38468 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  11071 MiB |   1660 TiB |   1660 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   1657 TiB |   1657 TiB |
|       from small pool |      0 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  11071 MiB |   1660 TiB |   1660 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   1657 TiB |   1657 TiB |
|       from small pool |      0 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10961 MiB |   1653 TiB |   1653 TiB |
|       from large pool |  16640 KiB |  10889 MiB |   1651 TiB |   1651 TiB |
|       from small pool |      0 KiB |    123 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1826 MiB |  11226 MiB |  11226 MiB |   9400 MiB |
|       from large pool |   1728 MiB |  11100 MiB |  11100 MiB |   9372 MiB |
|       from small pool |     98 MiB |    126 MiB |    126 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   1726 MiB | 593340 GiB | 593340 GiB |
|       from large pool | 134912 KiB |   1724 MiB | 590409 GiB | 590409 GiB |
|       from small pool |      0 KiB |     24 MiB |   2931 GiB |   2931 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6720    |  137816 K  |  137816 K  |
|       from large pool |       2    |     909    |   64894 K  |   64894 K  |
|       from small pool |       0    |    6631    |   72921 K  |   72921 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6720    |  137816 K  |  137816 K  |
|       from large pool |       2    |     909    |   64894 K  |   64894 K  |
|       from small pool |       0    |    6631    |   72921 K  |   72921 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      79    |     232    |     232    |     153    |
|       from large pool |      30    |     169    |     169    |     139    |
|       from small pool |      49    |      63    |      63    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2768    |   70646 K  |   70646 K  |
|       from large pool |       4    |      59    |   32177 K  |   32177 K  |
|       from small pool |       0    |    2747    |   38468 K  |   38468 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_00_04_38_seed_1_21011743

 Experiment start at: 2024-06-01 00:04:38.259512
before training, model accuracy: 0.09458588808774948
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96723366, 'precision': 0.74078286, 'recall': 0.5352289, 'specificity': 0.5352289, 'f1': 0.55540395, 'auroc': 0.8939614, 'binary_precision': 0.5121951, 'binary_recall': 0.07281554, 'binary_specificity': 0.9976423, 'binary_f1_score': 0.12750456}
confusion matrix:
       0    1
0  42314  100
1   1337  105
---- Validation: 
scalar performance:
{'acc': 0.9646745, 'precision': 0.74758345, 'recall': 0.58184487, 'specificity': 0.58184487, 'f1': 0.6190437, 'auroc': 0.9020796, 'binary_precision': 0.5253456, 'binary_recall': 0.16939078, 'binary_specificity': 0.994299, 'binary_f1_score': 0.25617975}
confusion matrix:
       0    1
0  17964  103
1    559  114
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96358365, 'precision': 0.955526, 'recall': 0.5690626, 'specificity': 0.5690626, 'f1': 0.6114774, 'auroc': 0.88518584, 'binary_precision': 0.94736844, 'binary_recall': 0.13846155, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.24161077}
confusion matrix:
      0   1
0  5944   2
1   224  36
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011743_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-01 00:25:53.809668,epoch time: 0:21:15.550156,used: 0:21:15.550156,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_00_04_38_seed_1_21011743
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9671197, 'precision': 0.7361662, 'recall': 0.5810584, 'specificity': 0.5810584, 'f1': 0.61724436, 'auroc': 0.92140293, 'binary_precision': 0.5, 'binary_recall': 0.16782247, 'binary_specificity': 0.99429435, 'binary_f1_score': 0.251298}
confusion matrix:
       0    1
0  42172  242
1   1200  242
---- Validation: 
scalar performance:
{'acc': 0.963714, 'precision': 0.7342983, 'recall': 0.6671788, 'specificity': 0.6671788, 'f1': 0.69447464, 'auroc': 0.92485356, 'binary_precision': 0.49263158, 'binary_recall': 0.34769687, 'binary_specificity': 0.9866608, 'binary_f1_score': 0.40766552}
confusion matrix:
       0    1
0  17826  241
1    439  234
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9698679, 'precision': 0.9200975, 'recall': 0.66429144, 'specificity': 0.66429144, 'f1': 0.73179686, 'auroc': 0.91887045, 'binary_precision': 0.86868685, 'binary_recall': 0.33076924, 'binary_specificity': 0.99781364, 'binary_f1_score': 0.47910863}
confusion matrix:
      0   1
0  5933  13
1   174  86
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011743_2.png
new oracle model saved
early stop counter: 1
val acc:0.9637140035629272, best validation acc: 0.9646744728088379, corresponding to test acc:                         0.9635836482048035 / 0.9698678851127625
after epoch: 2,now: 2024-06-01 00:46:14.156580,epoch time: 0:20:20.346912,used: 0:41:35.897068,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_00_04_38_seed_1_21011743
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9662532, 'precision': 0.7293781, 'recall': 0.66166884, 'specificity': 0.66166884, 'f1': 0.6890335, 'auroc': 0.9296987, 'binary_precision': 0.4811133, 'binary_recall': 0.33564493, 'binary_specificity': 0.9876927, 'binary_f1_score': 0.3954248}
confusion matrix:
       0    1
0  41892  522
1    958  484
---- Validation: 
scalar performance:
{'acc': 0.9646211, 'precision': 0.74447095, 'recall': 0.7413218, 'specificity': 0.7413218, 'f1': 0.74288493, 'auroc': 0.92114294, 'binary_precision': 0.5075301, 'binary_recall': 0.5007429, 'binary_specificity': 0.9819007, 'binary_f1_score': 0.5041137}
confusion matrix:
       0    1
0  17740  327
1    336  337
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97454077, 'precision': 0.9026351, 'recall': 0.74580646, 'specificity': 0.74580646, 'f1': 0.80351067, 'auroc': 0.9256021, 'binary_precision': 0.8269231, 'binary_recall': 0.49615383, 'binary_specificity': 0.99545914, 'binary_f1_score': 0.6201923}
confusion matrix:
      0    1
0  5919   27
1   131  129
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011743_3.png
new oracle model saved
early stop counter: 2
val acc:0.9646211266517639, best validation acc: 0.9646744728088379, corresponding to test acc:                         0.9635836482048035 / 0.9745407700538635
after epoch: 3,now: 2024-06-01 01:06:37.313252,epoch time: 0:20:23.156672,used: 1:01:59.053740,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_00_04_38_seed_1_21011743
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9666636, 'precision': 0.7362417, 'recall': 0.7047549, 'specificity': 0.7047549, 'f1': 0.7192507, 'auroc': 0.93645, 'binary_precision': 0.49196142, 'binary_recall': 0.42441055, 'binary_specificity': 0.98509926, 'binary_f1_score': 0.4556962}
confusion matrix:
       0    1
0  41782  632
1    830  612
---- Validation: 
scalar performance:
{'acc': 0.9647279, 'precision': 0.7463262, 'recall': 0.79144585, 'specificity': 0.79144585, 'f1': 0.76675296, 'auroc': 0.9338736, 'binary_precision': 0.5074813, 'binary_recall': 0.6047548, 'binary_specificity': 0.97813696, 'binary_f1_score': 0.55186445}
confusion matrix:
       0    1
0  17672  395
1    266  407
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9738962, 'precision': 0.87900555, 'recall': 0.760182, 'specificity': 0.760182, 'f1': 0.8074566, 'auroc': 0.9252665, 'binary_precision': 0.77840906, 'binary_recall': 0.52692306, 'binary_specificity': 0.993441, 'binary_f1_score': 0.6284403}
confusion matrix:
      0    1
0  5907   39
1   123  137
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011743_4.png
better model found
persisted
after epoch: 4,now: 2024-06-01 01:27:21.642959,epoch time: 0:20:44.329707,used: 1:22:43.383447,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_00_04_38_seed_1_21011743
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96839654, 'precision': 0.75342196, 'recall': 0.6758401, 'specificity': 0.6758401, 'f1': 0.7069232, 'auroc': 0.9403385, 'binary_precision': 0.5282828, 'binary_recall': 0.36269072, 'binary_specificity': 0.9889895, 'binary_f1_score': 0.43009868}
confusion matrix:
       0    1
0  41947  467
1    919  523
---- Validation: 
scalar performance:
{'acc': 0.9648346, 'precision': 0.7460323, 'recall': 0.74286306, 'specificity': 0.74286306, 'f1': 0.74443614, 'auroc': 0.9326486, 'binary_precision': 0.51054215, 'binary_recall': 0.5037147, 'binary_specificity': 0.9820114, 'binary_f1_score': 0.5071054}
confusion matrix:
       0    1
0  17742  325
1    334  339
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97534645, 'precision': 0.889735, 'recall': 0.7719728, 'specificity': 0.7719728, 'f1': 0.81935096, 'auroc': 0.9260253, 'binary_precision': 0.79888266, 'binary_recall': 0.55, 'binary_specificity': 0.99394554, 'binary_f1_score': 0.6514806}
confusion matrix:
      0    1
0  5910   36
1   117  143
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011743_5.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-06-01 01:47:39.672877,epoch time: 0:20:18.029918,used: 1:43:01.413365,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_00_04_38_seed_1_21011743
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96830535, 'precision': 0.75088143, 'recall': 0.7863271, 'specificity': 0.7863271, 'f1': 0.7673032, 'auroc': 0.9448434, 'binary_precision': 0.5157195, 'binary_recall': 0.5915395, 'binary_specificity': 0.98111475, 'binary_f1_score': 0.55103356}
confusion matrix:
       0    1
0  41613  801
1    589  853
---- Validation: 
scalar performance:
{'acc': 0.9652081, 'precision': 0.74967575, 'recall': 0.81959033, 'specificity': 0.81959033, 'f1': 0.7797884, 'auroc': 0.9402113, 'binary_precision': 0.5120551, 'binary_recall': 0.6627043, 'binary_specificity': 0.97647643, 'binary_f1_score': 0.57772017}
confusion matrix:
       0    1
0  17642  425
1    227  446
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97502416, 'precision': 0.86481297, 'recall': 0.8012284, 'specificity': 0.8012284, 'f1': 0.8296609, 'auroc': 0.9276748, 'binary_precision': 0.74647886, 'binary_recall': 0.61153847, 'binary_specificity': 0.9909183, 'binary_f1_score': 0.67230445}
confusion matrix:
      0    1
0  5892   54
1   101  159
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011743_6.png
better model found
persisted
after epoch: 6,now: 2024-06-01 02:07:52.371496,epoch time: 0:20:12.698619,used: 2:03:14.111984,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_00_04_38_seed_1_21011743
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.966276, 'precision': 0.7367829, 'recall': 0.7681954, 'specificity': 0.7681954, 'f1': 0.751398, 'auroc': 0.94664043, 'binary_precision': 0.48872638, 'binary_recall': 0.55617195, 'binary_specificity': 0.98021877, 'binary_f1_score': 0.52027243}
confusion matrix:
       0    1
0  41575  839
1    640  802
---- Validation: 
scalar performance:
{'acc': 0.96451443, 'precision': 0.745664, 'recall': 0.8113626, 'specificity': 0.8113626, 'f1': 0.7741374, 'auroc': 0.94249797, 'binary_precision': 0.5046404, 'binary_recall': 0.64635956, 'binary_specificity': 0.97636575, 'binary_f1_score': 0.5667752}
confusion matrix:
       0    1
0  17640  427
1    238  435
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9705124, 'precision': 0.8278309, 'recall': 0.78048396, 'specificity': 0.78048396, 'f1': 0.8021022, 'auroc': 0.9216635, 'binary_precision': 0.67420816, 'binary_recall': 0.5730769, 'binary_specificity': 0.987891, 'binary_f1_score': 0.6195426}
confusion matrix:
      0    1
0  5874   72
1   111  149
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011743_7.png
early stop counter: 1
val acc:0.964514434337616, best validation acc: 0.965208113193512, corresponding to test acc:                         0.9750241637229919 / 0.9753464460372925
after epoch: 7,now: 2024-06-01 02:27:40.015884,epoch time: 0:19:47.644388,used: 2:23:01.756372,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_00_04_38_seed_1_21011743
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9660936, 'precision': 0.7398056, 'recall': 0.8461449, 'specificity': 0.8461449, 'f1': 0.7821406, 'auroc': 0.9488986, 'binary_precision': 0.4893617, 'binary_recall': 0.7177531, 'binary_specificity': 0.9745367, 'binary_f1_score': 0.5819511}
confusion matrix:
       0     1
0  41334  1080
1    407  1035
---- Validation: 
scalar performance:
{'acc': 0.9639808, 'precision': 0.7439664, 'recall': 0.84112716, 'specificity': 0.84112716, 'f1': 0.7834037, 'auroc': 0.9409397, 'binary_precision': 0.49895397, 'binary_recall': 0.7087667, 'binary_specificity': 0.97348756, 'binary_f1_score': 0.58563536}
confusion matrix:
       0    1
0  17588  479
1    196  477
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9709958, 'precision': 0.8173854, 'recall': 0.82671094, 'specificity': 0.82671094, 'f1': 0.82197225, 'auroc': 0.93543303, 'binary_precision': 0.6492537, 'binary_recall': 0.66923076, 'binary_specificity': 0.98419106, 'binary_f1_score': 0.6590909}
confusion matrix:
      0    1
0  5852   94
1    86  174
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011743_8.png
early stop counter: 2
val acc:0.9639807939529419, best validation acc: 0.965208113193512, corresponding to test acc:                         0.9750241637229919 / 0.9753464460372925
after epoch: 8,now: 2024-06-01 02:47:28.992350,epoch time: 0:19:48.976466,used: 2:42:50.732838,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_00_04_38_seed_1_21011743
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.96572876, 'precision': 0.73807716, 'recall': 0.847966, 'specificity': 0.847966, 'f1': 0.7814436, 'auroc': 0.9510857, 'binary_precision': 0.4857676, 'binary_recall': 0.721914, 'binary_specificity': 0.97401804, 'binary_f1_score': 0.5807531}
confusion matrix:
       0     1
0  41312  1102
1    401  1041
---- Validation: 
scalar performance:
{'acc': 0.96318036, 'precision': 0.7402901, 'recall': 0.84428835, 'specificity': 0.84428835, 'f1': 0.7817849, 'auroc': 0.9397569, 'binary_precision': 0.49133536, 'binary_recall': 0.7161961, 'binary_specificity': 0.9723806, 'binary_f1_score': 0.5828295}
confusion matrix:
       0    1
0  17568  499
1    191  482
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97115695, 'precision': 0.8133323, 'recall': 0.8488628, 'specificity': 0.8488628, 'f1': 0.8300223, 'auroc': 0.94275385, 'binary_precision': 0.63917524, 'binary_recall': 0.7153846, 'binary_specificity': 0.98234105, 'binary_f1_score': 0.675136}
confusion matrix:
      0    1
0  5841  105
1    74  186
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011743_9.png
early stop counter: 3
val acc:0.9631803631782532, best validation acc: 0.965208113193512, corresponding to test acc:                         0.9750241637229919 / 0.9753464460372925
after epoch: 9,now: 2024-06-01 03:07:24.882748,epoch time: 0:19:55.890398,used: 3:02:46.623236,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_00_04_38_seed_1_21011743
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9649535, 'precision': 0.7343669, 'recall': 0.84890497, 'specificity': 0.84890497, 'f1': 0.77897733, 'auroc': 0.9563606, 'binary_precision': 0.47826087, 'binary_recall': 0.72468793, 'binary_specificity': 0.97312206, 'binary_f1_score': 0.5762338}
confusion matrix:
       0     1
0  41274  1140
1    397  1045
---- Validation: 
scalar performance:
{'acc': 0.9624333, 'precision': 0.73656887, 'recall': 0.83960927, 'specificity': 0.83960927, 'f1': 0.77761376, 'auroc': 0.93908143, 'binary_precision': 0.48423195, 'binary_recall': 0.7072808, 'binary_specificity': 0.9719378, 'binary_f1_score': 0.57487917}
confusion matrix:
       0    1
0  17560  507
1    197  476
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9708347, 'precision': 0.8123108, 'recall': 0.8431777, 'specificity': 0.8431777, 'f1': 0.8269246, 'auroc': 0.9413556, 'binary_precision': 0.63763064, 'binary_recall': 0.70384616, 'binary_specificity': 0.98250926, 'binary_f1_score': 0.6691042}
confusion matrix:
      0    1
0  5842  104
1    77  183
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011743_10.png
early stop counter: 4
val acc:0.9624332785606384, best validation acc: 0.965208113193512, corresponding to test acc:                         0.9750241637229919 / 0.9753464460372925
after epoch: 10,now: 2024-06-01 03:27:20.130649,epoch time: 0:19:55.247901,used: 3:22:41.871137,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_00_04_38_seed_1_21011743
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9629241, 'precision': 0.7256992, 'recall': 0.8558947, 'specificity': 0.8558947, 'f1': 0.7743218, 'auroc': 0.95723665, 'binary_precision': 0.46037897, 'binary_recall': 0.74133146, 'binary_specificity': 0.97045785, 'binary_f1_score': 0.5680127}
confusion matrix:
       0     1
0  41161  1253
1    373  1069
---- Validation: 
scalar performance:
{'acc': 0.96211314, 'precision': 0.7349584, 'recall': 0.83729744, 'specificity': 0.83729744, 'f1': 0.77571845, 'auroc': 0.94595957, 'binary_precision': 0.48118007, 'binary_recall': 0.70282316, 'binary_specificity': 0.9717717, 'binary_f1_score': 0.57125604}
confusion matrix:
       0    1
0  17557  510
1    200  473
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9626168, 'precision': 0.76418936, 'recall': 0.8370501, 'specificity': 0.8370501, 'f1': 0.7955519, 'auroc': 0.9381491, 'binary_precision': 0.5416667, 'binary_recall': 0.7, 'binary_specificity': 0.97410023, 'binary_f1_score': 0.6107382}
confusion matrix:
      0    1
0  5792  154
1    78  182
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011743_11.png
early stop counter: 5
val acc:0.9621131420135498, best validation acc: 0.965208113193512, corresponding to test acc:                         0.9750241637229919 / 0.9753464460372925
after epoch: 11,now: 2024-06-01 03:47:12.065072,epoch time: 0:19:51.934423,used: 3:42:33.805560,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_00_04_38_seed_1_21011743
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.96680045, 'precision': 0.7436755, 'recall': 0.85220456, 'specificity': 0.85220456, 'f1': 0.7868546, 'auroc': 0.95997167, 'binary_precision': 0.49669498, 'binary_recall': 0.7295423, 'binary_specificity': 0.9748668, 'binary_f1_score': 0.5910112}
confusion matrix:
       0     1
0  41348  1066
1    390  1052
---- Validation: 
scalar performance:
{'acc': 0.96360725, 'precision': 0.7412716, 'recall': 0.8216212, 'specificity': 0.8216212, 'f1': 0.7749509, 'auroc': 0.94479144, 'binary_precision': 0.4950495, 'binary_recall': 0.6686478, 'binary_specificity': 0.9745946, 'binary_f1_score': 0.5689001}
confusion matrix:
       0    1
0  17608  459
1    223  450
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9705124, 'precision': 0.81010234, 'recall': 0.84300953, 'specificity': 0.84300953, 'f1': 0.82562023, 'auroc': 0.94026756, 'binary_precision': 0.633218, 'binary_recall': 0.70384616, 'binary_specificity': 0.9821729, 'binary_f1_score': 0.6666666}
confusion matrix:
      0    1
0  5840  106
1    77  183
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011743_12.png
early stop counter: 6
val acc:0.9636072516441345, best validation acc: 0.965208113193512, corresponding to test acc:                         0.9750241637229919 / 0.9753464460372925
after epoch: 12,now: 2024-06-01 04:06:57.293379,epoch time: 0:19:45.228307,used: 4:02:19.033867,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_00_04_38_seed_1_21011743
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.96839654, 'precision': 0.75150967, 'recall': 0.78704417, 'specificity': 0.78704417, 'f1': 0.7679728, 'auroc': 0.95552146, 'binary_precision': 0.5169287, 'binary_recall': 0.5929265, 'binary_specificity': 0.9811619, 'binary_f1_score': 0.5523256}
confusion matrix:
       0    1
0  41615  799
1    587  855
---- Validation: 
scalar performance:
{'acc': 0.96499467, 'precision': 0.74755704, 'recall': 0.7708415, 'specificity': 0.7708415, 'f1': 0.75861144, 'auroc': 0.94747007, 'binary_precision': 0.511502, 'binary_recall': 0.56166416, 'binary_specificity': 0.9800188, 'binary_f1_score': 0.53541076}
confusion matrix:
       0    1
0  17706  361
1    295  378
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96793425, 'precision': 0.82629883, 'recall': 0.72029096, 'specificity': 0.72029096, 'f1': 0.7619016, 'auroc': 0.9457449, 'binary_precision': 0.6763006, 'binary_recall': 0.45, 'binary_specificity': 0.9905819, 'binary_f1_score': 0.5404157}
confusion matrix:
      0    1
0  5890   56
1   143  117
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011743_13.png
early stop counter: 7
val acc:0.9649946689605713, best validation acc: 0.965208113193512, corresponding to test acc:                         0.9750241637229919 / 0.9753464460372925
after epoch: 13,now: 2024-06-01 04:26:52.315294,epoch time: 0:19:55.021915,used: 4:22:14.055782,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_00_04_38_seed_1_21011743
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96914905, 'precision': 0.756454, 'recall': 0.8162391, 'specificity': 0.8162391, 'f1': 0.7828729, 'auroc': 0.9599689, 'binary_precision': 0.5248187, 'binary_recall': 0.6525659, 'binary_specificity': 0.9799123, 'binary_f1_score': 0.581762}
confusion matrix:
       0    1
0  41562  852
1    501  941
---- Validation: 
scalar performance:
{'acc': 0.96584845, 'precision': 0.75321066, 'recall': 0.7734301, 'specificity': 0.7734301, 'f1': 0.762885, 'auroc': 0.9484797, 'binary_precision': 0.52263373, 'binary_recall': 0.5661218, 'binary_specificity': 0.98073834, 'binary_f1_score': 0.54350924}
confusion matrix:
       0    1
0  17719  348
1    292  381
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9690622, 'precision': 0.8237487, 'recall': 0.75398135, 'specificity': 0.75398135, 'f1': 0.7841743, 'auroc': 0.94118214, 'binary_precision': 0.66831684, 'binary_recall': 0.5192308, 'binary_specificity': 0.9887319, 'binary_f1_score': 0.58441556}
confusion matrix:
      0    1
0  5879   67
1   125  135
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011743_14.png
better model found
persisted
after epoch: 14,now: 2024-06-01 04:46:53.255822,epoch time: 0:20:00.940528,used: 4:42:14.996310,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_00_04_38_seed_1_21011743
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9661392, 'precision': 0.73977137, 'recall': 0.8408092, 'specificity': 0.8408092, 'f1': 0.7804227, 'auroc': 0.9593601, 'binary_precision': 0.48966843, 'binary_recall': 0.7066574, 'binary_specificity': 0.9749611, 'binary_f1_score': 0.5784843}
confusion matrix:
       0     1
0  41352  1062
1    423  1019
---- Validation: 
scalar performance:
{'acc': 0.96350056, 'precision': 0.73955786, 'recall': 0.79724675, 'specificity': 0.79724675, 'f1': 0.76489675, 'auroc': 0.94469404, 'binary_precision': 0.49347568, 'binary_recall': 0.61812776, 'binary_specificity': 0.97636575, 'binary_f1_score': 0.54881257}
confusion matrix:
       0    1
0  17640  427
1    257  416
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9660006, 'precision': 0.7929885, 'recall': 0.76157856, 'specificity': 0.76157856, 'f1': 0.7762824, 'auroc': 0.9243679, 'binary_precision': 0.6060606, 'binary_recall': 0.53846157, 'binary_specificity': 0.9846956, 'binary_f1_score': 0.57026476}
confusion matrix:
      0    1
0  5855   91
1   120  140
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011743_15.png
early stop counter: 1
val acc:0.9635005593299866, best validation acc: 0.965848445892334, corresponding to test acc:                         0.9690622091293335 / 0.9753464460372925
after epoch: 15,now: 2024-06-01 05:06:37.771195,epoch time: 0:19:44.515373,used: 5:01:59.511683,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_00_04_38_seed_1_21011743
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9687386, 'precision': 0.75386393, 'recall': 0.8227259, 'specificity': 0.8227259, 'f1': 0.78371096, 'auroc': 0.9615147, 'binary_precision': 0.5191788, 'binary_recall': 0.6664355, 'binary_specificity': 0.97901636, 'binary_f1_score': 0.5836623}
confusion matrix:
       0    1
0  41524  890
1    481  961
---- Validation: 
scalar performance:
{'acc': 0.9646211, 'precision': 0.74662566, 'recall': 0.8242928, 'specificity': 0.8242928, 'f1': 0.7794877, 'auroc': 0.95010996, 'binary_precision': 0.50558037, 'binary_recall': 0.6731055, 'binary_specificity': 0.97548014, 'binary_f1_score': 0.5774378}
confusion matrix:
       0    1
0  17624  443
1    220  453
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96648407, 'precision': 0.80442154, 'recall': 0.734246, 'specificity': 0.734246, 'f1': 0.7642257, 'auroc': 0.9374931, 'binary_precision': 0.63131315, 'binary_recall': 0.48076922, 'binary_specificity': 0.9877228, 'binary_f1_score': 0.5458515}
confusion matrix:
      0    1
0  5873   73
1   135  125
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011743_16.png
early stop counter: 2
val acc:0.9646211266517639, best validation acc: 0.965848445892334, corresponding to test acc:                         0.9690622091293335 / 0.9753464460372925
after epoch: 16,now: 2024-06-01 05:26:22.025707,epoch time: 0:19:44.254512,used: 5:21:43.766195,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_00_04_38_seed_1_21011743
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9688298, 'precision': 0.7546061, 'recall': 0.85660326, 'specificity': 0.85660326, 'f1': 0.7960953, 'auroc': 0.9675408, 'binary_precision': 0.5183016, 'binary_recall': 0.73647714, 'binary_specificity': 0.9767294, 'binary_f1_score': 0.6084217}
confusion matrix:
       0     1
0  41427   987
1    380  1062
---- Validation: 
scalar performance:
{'acc': 0.965635, 'precision': 0.7527112, 'recall': 0.86487365, 'specificity': 0.86487365, 'f1': 0.79726756, 'auroc': 0.9565027, 'binary_precision': 0.51466125, 'binary_recall': 0.756315, 'binary_specificity': 0.97343224, 'binary_f1_score': 0.612515}
confusion matrix:
       0    1
0  17587  480
1    164  509
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9658395, 'precision': 0.7992046, 'recall': 0.7302317, 'specificity': 0.7302317, 'f1': 0.7596916, 'auroc': 0.94429547, 'binary_precision': 0.6212121, 'binary_recall': 0.4730769, 'binary_specificity': 0.98738647, 'binary_f1_score': 0.5371179}
confusion matrix:
      0    1
0  5871   75
1   137  123
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011743_17.png
early stop counter: 3
val acc:0.9656350016593933, best validation acc: 0.965848445892334, corresponding to test acc:                         0.9690622091293335 / 0.9753464460372925
after epoch: 17,now: 2024-06-01 05:46:12.715652,epoch time: 0:19:50.689945,used: 5:41:34.456140,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_00_04_38_seed_1_21011743
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9669601, 'precision': 0.7452642, 'recall': 0.87271917, 'specificity': 0.87271917, 'f1': 0.79423594, 'auroc': 0.96518016, 'binary_precision': 0.4984326, 'binary_recall': 0.7718447, 'binary_specificity': 0.97359365, 'binary_f1_score': 0.6057143}
confusion matrix:
       0     1
0  41294  1120
1    329  1113
---- Validation: 
scalar performance:
{'acc': 0.96403414, 'precision': 0.74459285, 'recall': 0.85045326, 'specificity': 0.85045326, 'f1': 0.78684497, 'auroc': 0.95071006, 'binary_precision': 0.49949032, 'binary_recall': 0.7280832, 'binary_specificity': 0.9728234, 'binary_f1_score': 0.592503}
confusion matrix:
       0    1
0  17576  491
1    183  490
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96728975, 'precision': 0.8002385, 'recall': 0.77696323, 'specificity': 0.77696323, 'f1': 0.78807306, 'auroc': 0.9395398, 'binary_precision': 0.61924684, 'binary_recall': 0.5692308, 'binary_specificity': 0.9846956, 'binary_f1_score': 0.5931864}
confusion matrix:
      0    1
0  5855   91
1   112  148
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011743_18.png
early stop counter: 4
val acc:0.9640341401100159, best validation acc: 0.965848445892334, corresponding to test acc:                         0.9690622091293335 / 0.9753464460372925
after epoch: 18,now: 2024-06-01 06:05:56.502885,epoch time: 0:19:43.787233,used: 6:01:18.243373,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_00_04_38_seed_1_21011743
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9684422, 'precision': 0.7523757, 'recall': 0.8497038, 'specificity': 0.8497038, 'f1': 0.7922471, 'auroc': 0.96885306, 'binary_precision': 0.51431394, 'binary_recall': 0.7226075, 'binary_specificity': 0.9768001, 'binary_f1_score': 0.6009227}
confusion matrix:
       0     1
0  41430   984
1    400  1042
---- Validation: 
scalar performance:
{'acc': 0.96510136, 'precision': 0.74951017, 'recall': 0.8388473, 'specificity': 0.8388473, 'f1': 0.7865113, 'auroc': 0.9566953, 'binary_precision': 0.5102481, 'binary_recall': 0.70282316, 'binary_specificity': 0.97487134, 'binary_f1_score': 0.59125}
confusion matrix:
       0    1
0  17613  454
1    200  473
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96825653, 'precision': 0.82737255, 'recall': 0.7259761, 'specificity': 0.7259761, 'f1': 0.7663741, 'auroc': 0.9486693, 'binary_precision': 0.6779661, 'binary_recall': 0.46153846, 'binary_specificity': 0.9904137, 'binary_f1_score': 0.5491991}
confusion matrix:
      0    1
0  5889   57
1   140  120
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011743_19.png
early stop counter: 5
val acc:0.9651013612747192, best validation acc: 0.965848445892334, corresponding to test acc:                         0.9690622091293335 / 0.9753464460372925
after epoch: 19,now: 2024-06-01 06:25:45.494782,epoch time: 0:19:48.991897,used: 6:21:07.235270,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_00_04_38_seed_1_21011743
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.96803176, 'precision': 0.75042427, 'recall': 0.8642295, 'specificity': 0.8642295, 'f1': 0.79552966, 'auroc': 0.9685888, 'binary_precision': 0.5093809, 'binary_recall': 0.75312066, 'binary_specificity': 0.97533834, 'binary_f1_score': 0.60772246}
confusion matrix:
       0     1
0  41368  1046
1    356  1086
---- Validation: 
scalar performance:
{'acc': 0.9638207, 'precision': 0.7437282, 'recall': 0.8539189, 'specificity': 0.8539189, 'f1': 0.7872965, 'auroc': 0.95366424, 'binary_precision': 0.49748743, 'binary_recall': 0.7355126, 'binary_specificity': 0.9723252, 'binary_f1_score': 0.5935252}
confusion matrix:
       0    1
0  17567  500
1    178  495
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9668063, 'precision': 0.8041503, 'recall': 0.7454481, 'specificity': 0.7454481, 'f1': 0.77129096, 'auroc': 0.9435302, 'binary_precision': 0.6298077, 'binary_recall': 0.50384617, 'binary_specificity': 0.9870501, 'binary_f1_score': 0.55982906}
confusion matrix:
      0    1
0  5869   77
1   129  131
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011743_20.png
early stop counter: 6
val acc:0.9638206958770752, best validation acc: 0.965848445892334, corresponding to test acc:                         0.9690622091293335 / 0.9753464460372925
after epoch: 20,now: 2024-06-01 06:45:46.718185,epoch time: 0:20:01.223403,used: 6:41:08.458673,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_00_04_38_seed_1_21011743
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9681457, 'precision': 0.7509829, 'recall': 0.8622787, 'specificity': 0.8622787, 'f1': 0.7953265, 'auroc': 0.9660961, 'binary_precision': 0.5106383, 'binary_recall': 0.7489598, 'binary_specificity': 0.9755977, 'binary_f1_score': 0.6072533}
confusion matrix:
       0     1
0  41379  1035
1    362  1080
---- Validation: 
scalar performance:
{'acc': 0.9647812, 'precision': 0.74802864, 'recall': 0.8444033, 'specificity': 0.8444033, 'f1': 0.78734446, 'auroc': 0.9520526, 'binary_precision': 0.5068493, 'binary_recall': 0.71471024, 'binary_specificity': 0.9740964, 'binary_f1_score': 0.59309494}
confusion matrix:
       0    1
0  17599  468
1    192  481
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96809536, 'precision': 0.8167607, 'recall': 0.74612087, 'specificity': 0.74612087, 'f1': 0.7764995, 'auroc': 0.93429244, 'binary_precision': 0.655, 'binary_recall': 0.50384617, 'binary_specificity': 0.9883956, 'binary_f1_score': 0.56956524}
confusion matrix:
      0    1
0  5877   69
1   129  131
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011743_21.png
early stop counter: 7
val acc:0.9647812247276306, best validation acc: 0.965848445892334, corresponding to test acc:                         0.9690622091293335 / 0.9753464460372925
after epoch: 21,now: 2024-06-01 07:05:45.326447,epoch time: 0:19:58.608262,used: 7:01:07.066935,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_00_04_38_seed_1_21011743
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9668688, 'precision': 0.744663, 'recall': 0.8686526, 'specificity': 0.8686526, 'f1': 0.79258823, 'auroc': 0.9673363, 'binary_precision': 0.4975147, 'binary_recall': 0.76352286, 'binary_specificity': 0.97378224, 'binary_f1_score': 0.6024624}
confusion matrix:
       0     1
0  41302  1112
1    341  1101
---- Validation: 
scalar performance:
{'acc': 0.96360725, 'precision': 0.7426025, 'recall': 0.85094714, 'specificity': 0.85094714, 'f1': 0.7855512, 'auroc': 0.9548768, 'binary_precision': 0.49545914, 'binary_recall': 0.7295691, 'binary_specificity': 0.9723252, 'binary_f1_score': 0.59014416}
confusion matrix:
       0    1
0  17567  500
1    182  491
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9693845, 'precision': 0.81464875, 'recall': 0.7890903, 'specificity': 0.7890903, 'f1': 0.8012631, 'auroc': 0.94934505, 'binary_precision': 0.64705884, 'binary_recall': 0.5923077, 'binary_specificity': 0.98587286, 'binary_f1_score': 0.6184739}
confusion matrix:
      0    1
0  5862   84
1   106  154
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011743_22.png
early stop counter: 8
val acc:0.9636072516441345, best validation acc: 0.965848445892334, corresponding to test acc:                         0.9690622091293335 / 0.9753464460372925
after epoch: 22,now: 2024-06-01 07:25:43.155906,epoch time: 0:19:57.829459,used: 7:21:04.896394,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_00_04_38_seed_1_21011743
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9701523, 'precision': 0.7620337, 'recall': 0.86666566, 'specificity': 0.86666566, 'f1': 0.80463946, 'auroc': 0.9699922, 'binary_precision': 0.53248656, 'binary_recall': 0.7558946, 'binary_specificity': 0.9774367, 'binary_f1_score': 0.6248209}
confusion matrix:
       0     1
0  41457   957
1    352  1090
---- Validation: 
scalar performance:
{'acc': 0.9660619, 'precision': 0.75467455, 'recall': 0.8522202, 'specificity': 0.8522202, 'f1': 0.79459375, 'auroc': 0.9603639, 'binary_precision': 0.5195767, 'binary_recall': 0.7295691, 'binary_specificity': 0.97487134, 'binary_f1_score': 0.60692215}
confusion matrix:
       0    1
0  17613  454
1    182  491
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96793425, 'precision': 0.82105553, 'recall': 0.73132485, 'specificity': 0.73132485, 'f1': 0.76808995, 'auroc': 0.94881773, 'binary_precision': 0.66486484, 'binary_recall': 0.4730769, 'binary_specificity': 0.9895728, 'binary_f1_score': 0.55280894}
confusion matrix:
      0    1
0  5884   62
1   137  123
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011743_23.png
better model found
persisted
after epoch: 23,now: 2024-06-01 07:46:03.483813,epoch time: 0:20:20.327907,used: 7:41:25.224301,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_00_04_38_seed_1_21011743
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.96805453, 'precision': 0.7504933, 'recall': 0.86189663, 'specificity': 0.86189663, 'f1': 0.79485095, 'auroc': 0.9667661, 'binary_precision': 0.5096835, 'binary_recall': 0.7482663, 'binary_specificity': 0.9755269, 'binary_f1_score': 0.60635006}
confusion matrix:
       0     1
0  41376  1038
1    363  1079
---- Validation: 
scalar performance:
{'acc': 0.964301, 'precision': 0.7452418, 'recall': 0.83270997, 'specificity': 0.83270997, 'f1': 0.78148425, 'auroc': 0.9467538, 'binary_precision': 0.50215983, 'binary_recall': 0.6909361, 'binary_specificity': 0.97448385, 'binary_f1_score': 0.58161354}
confusion matrix:
       0    1
0  17606  461
1    208  465
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96745086, 'precision': 0.798722, 'recall': 0.7899202, 'specificity': 0.7899202, 'f1': 0.79424703, 'auroc': 0.93636703, 'binary_precision': 0.61507934, 'binary_recall': 0.59615386, 'binary_specificity': 0.9836865, 'binary_f1_score': 0.6054688}
confusion matrix:
      0    1
0  5849   97
1   105  155
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011743_24.png
early stop counter: 1
val acc:0.9643009901046753, best validation acc: 0.9660618901252747, corresponding to test acc:                         0.967934250831604 / 0.9753464460372925
after epoch: 24,now: 2024-06-01 08:06:32.530392,epoch time: 0:20:29.046579,used: 8:01:54.270880,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_00_04_38_seed_1_21011743
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.968693, 'precision': 0.7541059, 'recall': 0.8776345, 'specificity': 0.8776345, 'f1': 0.8023522, 'auroc': 0.9725441, 'binary_precision': 0.5158184, 'binary_recall': 0.78016645, 'binary_specificity': 0.97510254, 'binary_f1_score': 0.6210323}
confusion matrix:
       0     1
0  41358  1056
1    317  1125
---- Validation: 
scalar performance:
{'acc': 0.96611524, 'precision': 0.7549563, 'recall': 0.85296315, 'specificity': 0.85296315, 'f1': 0.7950376, 'auroc': 0.9579161, 'binary_precision': 0.52008456, 'binary_recall': 0.73105496, 'binary_specificity': 0.97487134, 'binary_f1_score': 0.6077826}
confusion matrix:
       0    1
0  17613  454
1    181  492
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9622946, 'precision': 0.7713001, 'recall': 0.7026359, 'specificity': 0.7026359, 'f1': 0.73136777, 'auroc': 0.9354459, 'binary_precision': 0.5677083, 'binary_recall': 0.41923076, 'binary_specificity': 0.986041, 'binary_f1_score': 0.48230085}
confusion matrix:
      0    1
0  5863   83
1   151  109
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011743_25.png
better model found
persisted
after epoch: 25,now: 2024-06-01 08:26:51.352109,epoch time: 0:20:18.821717,used: 8:22:13.092597,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_00_04_38_seed_1_21011743
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.96723366, 'precision': 0.7477069, 'recall': 0.905016, 'specificity': 0.905016, 'f1': 0.8050505, 'auroc': 0.9722719, 'binary_precision': 0.50103605, 'binary_recall': 0.83841884, 'binary_specificity': 0.97161317, 'binary_f1_score': 0.6272374}
confusion matrix:
       0     1
0  41210  1204
1    233  1209
---- Validation: 
scalar performance:
{'acc': 0.96376735, 'precision': 0.7449432, 'recall': 0.8882241, 'specificity': 0.8882241, 'f1': 0.7981429, 'auroc': 0.961524, 'binary_precision': 0.49725273, 'binary_recall': 0.80683506, 'binary_specificity': 0.96961313, 'binary_f1_score': 0.6152975}
confusion matrix:
       0    1
0  17518  549
1    130  543
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9730905, 'precision': 0.8359033, 'recall': 0.8222871, 'specificity': 0.8222871, 'f1': 0.8289379, 'auroc': 0.9511663, 'binary_precision': 0.686747, 'binary_recall': 0.6576923, 'binary_specificity': 0.9868819, 'binary_f1_score': 0.67190576}
confusion matrix:
      0    1
0  5868   78
1    89  171
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011743_26.png
early stop counter: 1
val acc:0.9637673497200012, best validation acc: 0.9661152362823486, corresponding to test acc:                         0.9622945785522461 / 0.9753464460372925
after epoch: 26,now: 2024-06-01 08:46:56.771699,epoch time: 0:20:05.419590,used: 8:42:18.512187,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_00_04_38_seed_1_21011743
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.968807, 'precision': 0.7547071, 'recall': 0.8783634, 'specificity': 0.8783634, 'f1': 0.8030199, 'auroc': 0.9740999, 'binary_precision': 0.5169725, 'binary_recall': 0.7815534, 'binary_specificity': 0.9751733, 'binary_f1_score': 0.62230814}
confusion matrix:
       0     1
0  41361  1053
1    315  1127
---- Validation: 
scalar performance:
{'acc': 0.96526146, 'precision': 0.7508843, 'recall': 0.8639646, 'specificity': 0.8639646, 'f1': 0.7956501, 'auroc': 0.96071595, 'binary_precision': 0.5110664, 'binary_recall': 0.7548291, 'binary_specificity': 0.9731001, 'binary_f1_score': 0.6094781}
confusion matrix:
       0    1
0  17581  486
1    165  508
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9658395, 'precision': 0.8002955, 'recall': 0.7265537, 'specificity': 0.7265537, 'f1': 0.75765544, 'auroc': 0.9389726, 'binary_precision': 0.62371135, 'binary_recall': 0.4653846, 'binary_specificity': 0.9877228, 'binary_f1_score': 0.5330396}
confusion matrix:
      0    1
0  5873   73
1   139  121
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011743_27.png
early stop counter: 2
val acc:0.9652614593505859, best validation acc: 0.9661152362823486, corresponding to test acc:                         0.9622945785522461 / 0.9753464460372925
after epoch: 27,now: 2024-06-01 09:07:05.913638,epoch time: 0:20:09.141939,used: 9:02:27.654126,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_00_04_38_seed_1_21011743
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.97056276, 'precision': 0.7640785, 'recall': 0.87852514, 'specificity': 0.87852514, 'f1': 0.8099351, 'auroc': 0.9724877, 'binary_precision': 0.5357483, 'binary_recall': 0.78001386, 'binary_specificity': 0.9770364, 'binary_f1_score': 0.63520765}
confusion matrix:
       0     1
0  41441   974
1    317  1124
---- Validation: 
scalar performance:
{'acc': 0.9663287, 'precision': 0.75614774, 'recall': 0.8659487, 'specificity': 0.8659487, 'f1': 0.80009794, 'auroc': 0.9607407, 'binary_precision': 0.5214724, 'binary_recall': 0.7578009, 'binary_specificity': 0.9740964, 'binary_f1_score': 0.6178074}
confusion matrix:
       0    1
0  17599  468
1    163  510
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9668063, 'precision': 0.8207589, 'recall': 0.70315146, 'specificity': 0.70315146, 'f1': 0.74733377, 'auroc': 0.94818413, 'binary_precision': 0.6666667, 'binary_recall': 0.41538462, 'binary_specificity': 0.9909183, 'binary_f1_score': 0.5118484}
confusion matrix:
      0    1
0  5892   54
1   152  108
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011743_28.png
better model found
persisted
after epoch: 28,now: 2024-06-01 09:27:13.057510,epoch time: 0:20:07.143872,used: 9:22:34.797998,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_00_04_38_seed_1_21011743
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.96732485, 'precision': 0.7471734, 'recall': 0.8762573, 'specificity': 0.8762573, 'f1': 0.79671955, 'auroc': 0.9729216, 'binary_precision': 0.5020116, 'binary_recall': 0.77877945, 'binary_specificity': 0.9737351, 'binary_f1_score': 0.61049193}
confusion matrix:
       0     1
0  41300  1114
1    319  1123
---- Validation: 
scalar performance:
{'acc': 0.9632871, 'precision': 0.741843, 'recall': 0.8658017, 'specificity': 0.8658017, 'f1': 0.7894479, 'auroc': 0.96047336, 'binary_precision': 0.49278152, 'binary_recall': 0.76077265, 'binary_specificity': 0.9708308, 'binary_f1_score': 0.5981309}
confusion matrix:
       0    1
0  17540  527
1    161  512
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96793425, 'precision': 0.8138087, 'recall': 0.74971473, 'specificity': 0.74971473, 'f1': 0.77769303, 'auroc': 0.94561386, 'binary_precision': 0.64878047, 'binary_recall': 0.51153845, 'binary_specificity': 0.987891, 'binary_f1_score': 0.57204306}
confusion matrix:
      0    1
0  5874   72
1   127  133
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011743_29.png
early stop counter: 1
val acc:0.9632871150970459, best validation acc: 0.9663286805152893, corresponding to test acc:                         0.9668062925338745 / 0.9753464460372925
after epoch: 29,now: 2024-06-01 09:47:15.967980,epoch time: 0:20:02.910470,used: 9:42:37.708468,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_00_04_38_seed_1_21011743
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9709276, 'precision': 0.76630974, 'recall': 0.87611014, 'specificity': 0.87611014, 'f1': 0.8107533, 'auroc': 0.9750241, 'binary_precision': 0.5403967, 'binary_recall': 0.77461857, 'binary_specificity': 0.9776017, 'binary_f1_score': 0.63664854}
confusion matrix:
       0     1
0  41464   950
1    325  1117
---- Validation: 
scalar performance:
{'acc': 0.9667022, 'precision': 0.7580303, 'recall': 0.8461149, 'specificity': 0.8461149, 'f1': 0.79483366, 'auroc': 0.9609518, 'binary_precision': 0.52677596, 'binary_recall': 0.7161961, 'binary_specificity': 0.9760336, 'binary_f1_score': 0.60705286}
confusion matrix:
       0    1
0  17634  433
1    191  482
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96761197, 'precision': 0.84003454, 'recall': 0.690699, 'specificity': 0.690699, 'f1': 0.74225163, 'auroc': 0.9370327, 'binary_precision': 0.7062937, 'binary_recall': 0.38846153, 'binary_specificity': 0.99293643, 'binary_f1_score': 0.50124073}
confusion matrix:
      0    1
0  5904   42
1   159  101
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011743_30.png
better model found
persisted
after epoch: 30,now: 2024-06-01 10:07:26.099493,epoch time: 0:20:10.131513,used: 10:02:47.839981,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_00_04_38_seed_1_21011743
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 10:02:47.839981 at 2024-06-01 10:07:26.099493
persisted model performance metric: 

scalar performance:
{'acc': 0.96310025, 'precision': 0.7856418, 'recall': 0.67547154, 'specificity': 0.67547154, 'f1': 0.715874, 'auroc': 0.93466127, 'binary_precision': 0.5987261, 'binary_recall': 0.36153847, 'binary_specificity': 0.9894046, 'binary_f1_score': 0.45083934}
confusion matrix:
      0   1
0  5883  63
1   166  94
oracle model performance metric: 

scalar performance:
{'acc': 0.97502416, 'precision': 0.88685876, 'recall': 0.7699656, 'specificity': 0.7699656, 'f1': 0.81698954, 'auroc': 0.9366523, 'binary_precision': 0.7932961, 'binary_recall': 0.54615384, 'binary_specificity': 0.99377733, 'binary_f1_score': 0.64692485}
confusion matrix:
      0    1
0  5909   37
1   118  142
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/rule_results/10.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/confusion_matrix/10.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 496847 KiB |  11071 MiB |   3328 TiB |   3328 TiB |
|       from large pool | 407040 KiB |  10998 MiB |   3323 TiB |   3323 TiB |
|       from small pool |  89807 KiB |    124 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 496847 KiB |  11071 MiB |   3328 TiB |   3328 TiB |
|       from large pool | 407040 KiB |  10998 MiB |   3323 TiB |   3323 TiB |
|       from small pool |  89807 KiB |    124 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476570 KiB |  10961 MiB |   3313 TiB |   3313 TiB |
|       from large pool | 387840 KiB |  10889 MiB |   3308 TiB |   3308 TiB |
|       from small pool |  88730 KiB |    123 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11390 MiB |  11390 MiB |  20790 MiB |   9400 MiB |
|       from large pool |  11266 MiB |  11266 MiB |  20638 MiB |   9372 MiB |
|       from small pool |    124 MiB |    126 MiB |    152 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1480 MiB |   2595 MiB |   1137 TiB |   1137 TiB |
|       from large pool |   1472 MiB |   2593 MiB |   1132 TiB |   1132 TiB |
|       from small pool |      8 MiB |     24 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3705    |    6728    |  276085 K  |  276082 K  |
|       from large pool |      87    |     909    |  130045 K  |  130045 K  |
|       from small pool |    3618    |    6639    |  146040 K  |  146036 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3705    |    6728    |  276085 K  |  276082 K  |
|       from large pool |      87    |     909    |  130045 K  |  130045 K  |
|       from small pool |    3618    |    6639    |  146040 K  |  146036 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     234    |     234    |     387    |     153    |
|       from large pool |     172    |     172    |     311    |     139    |
|       from small pool |      62    |      63    |      76    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      77    |    2775    |  144578 K  |  144578 K  |
|       from large pool |      24    |      65    |   67365 K  |   67365 K  |
|       from small pool |      53    |    2751    |   77213 K  |   77213 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  11071 MiB |   3328 TiB |   3328 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   3323 TiB |   3323 TiB |
|       from small pool |      0 KiB |    124 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  11071 MiB |   3328 TiB |   3328 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   3323 TiB |   3323 TiB |
|       from small pool |      0 KiB |    124 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10961 MiB |   3313 TiB |   3313 TiB |
|       from large pool |  16640 KiB |  10889 MiB |   3308 TiB |   3308 TiB |
|       from small pool |      0 KiB |    123 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1966 MiB |  11390 MiB |  20790 MiB |  18824 MiB |
|       from large pool |   1870 MiB |  11266 MiB |  20638 MiB |  18768 MiB |
|       from small pool |     96 MiB |    126 MiB |    152 MiB |     56 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   2595 MiB |   1137 TiB |   1137 TiB |
|       from large pool | 134912 KiB |   2593 MiB |   1132 TiB |   1132 TiB |
|       from small pool |      0 KiB |     24 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6728    |  276085 K  |  276085 K  |
|       from large pool |       2    |     909    |  130045 K  |  130045 K  |
|       from small pool |       0    |    6639    |  146040 K  |  146040 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6728    |  276085 K  |  276085 K  |
|       from large pool |       2    |     909    |  130045 K  |  130045 K  |
|       from small pool |       0    |    6639    |  146040 K  |  146040 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      83    |     234    |     387    |     304    |
|       from large pool |      35    |     172    |     311    |     276    |
|       from small pool |      48    |      63    |      76    |      28    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2775    |  144579 K  |  144579 K  |
|       from large pool |       4    |      65    |   67365 K  |   67365 K  |
|       from small pool |       0    |    2751    |   77214 K  |   77214 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  11071 MiB |   3328 TiB |   3328 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   3323 TiB |   3323 TiB |
|       from small pool |      0 KiB |    124 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  11071 MiB |   3328 TiB |   3328 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   3323 TiB |   3323 TiB |
|       from small pool |      0 KiB |    124 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10961 MiB |   3313 TiB |   3313 TiB |
|       from large pool |  16640 KiB |  10889 MiB |   3308 TiB |   3308 TiB |
|       from small pool |      0 KiB |    123 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1966 MiB |  11390 MiB |  20790 MiB |  18824 MiB |
|       from large pool |   1870 MiB |  11266 MiB |  20638 MiB |  18768 MiB |
|       from small pool |     96 MiB |    126 MiB |    152 MiB |     56 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   2595 MiB |   1137 TiB |   1137 TiB |
|       from large pool | 134912 KiB |   2593 MiB |   1132 TiB |   1132 TiB |
|       from small pool |      0 KiB |     24 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6728    |  276085 K  |  276085 K  |
|       from large pool |       2    |     909    |  130045 K  |  130045 K  |
|       from small pool |       0    |    6639    |  146040 K  |  146040 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6728    |  276085 K  |  276085 K  |
|       from large pool |       2    |     909    |  130045 K  |  130045 K  |
|       from small pool |       0    |    6639    |  146040 K  |  146040 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      83    |     234    |     387    |     304    |
|       from large pool |      35    |     172    |     311    |     276    |
|       from small pool |      48    |      63    |      76    |      28    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2775    |  144579 K  |  144579 K  |
|       from large pool |       4    |      65    |   67365 K  |   67365 K  |
|       from small pool |       0    |    2751    |   77214 K  |   77214 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_10_16_53_seed_2_21011743

 Experiment start at: 2024-06-01 10:16:53.115079
before training, model accuracy: 0.04888604208827019
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9648366, 'precision': 0.6942007, 'recall': 0.52356803, 'specificity': 0.52356803, 'f1': 0.5353887, 'auroc': 0.8991995, 'binary_precision': 0.4213483, 'binary_recall': 0.04957039, 'binary_specificity': 0.9975656, 'binary_f1_score': 0.08870491}
confusion matrix:
       0    1
0  42208  103
1   1438   75
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.96708035, 'precision': 0.7081882, 'recall': 0.5517579, 'specificity': 0.5517579, 'f1': 0.5785012, 'auroc': 0.90121824, 'binary_precision': 0.44520548, 'binary_recall': 0.10797342, 'binary_specificity': 0.99554235, 'binary_f1_score': 0.17379677}
confusion matrix:
       0   1
0  18090  81
1    537  65
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.967623, 'precision': 0.9423424, 'recall': 0.5905756, 'specificity': 0.5905756, 'f1': 0.6434373, 'auroc': 0.8871598, 'binary_precision': 0.9166667, 'binary_recall': 0.18181819, 'binary_specificity': 0.999333, 'binary_f1_score': 0.3034483}
confusion matrix:
      0   1
0  5993   4
1   198  44
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011743_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-01 10:38:24.903934,epoch time: 0:21:31.788855,used: 0:21:31.788855,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_10_16_53_seed_2_21011743
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.965795, 'precision': 0.74152774, 'recall': 0.62475836, 'specificity': 0.62475836, 'f1': 0.66263634, 'auroc': 0.928166, 'binary_precision': 0.50911456, 'binary_recall': 0.25842696, 'binary_specificity': 0.99108976, 'binary_f1_score': 0.34283212}
confusion matrix:
       0    1
0  41934  377
1   1122  391
---- Validation: 
scalar performance:
{'acc': 0.9673467, 'precision': 0.7341001, 'recall': 0.6860045, 'specificity': 0.6860045, 'f1': 0.7070088, 'auroc': 0.9195217, 'binary_precision': 0.48842105, 'binary_recall': 0.38538206, 'binary_specificity': 0.98662704, 'binary_f1_score': 0.43082637}
confusion matrix:
       0    1
0  17928  243
1    370  232
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9748357, 'precision': 0.91148233, 'recall': 0.7132919, 'specificity': 0.7132919, 'f1': 0.77845085, 'auroc': 0.9071168, 'binary_precision': 0.8455285, 'binary_recall': 0.42975205, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.569863}
confusion matrix:
      0    1
0  5978   19
1   138  104
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011743_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-01 10:58:43.156760,epoch time: 0:20:18.252826,used: 0:41:50.041681,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_10_16_53_seed_2_21011743
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96609163, 'precision': 0.74504143, 'recall': 0.6707979, 'specificity': 0.6707979, 'f1': 0.7005797, 'auroc': 0.9359877, 'binary_precision': 0.51294345, 'binary_recall': 0.3536021, 'binary_specificity': 0.98799366, 'binary_f1_score': 0.41862285}
confusion matrix:
       0    1
0  41803  508
1    978  535
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.74052626, 'recall': 0.70558035, 'specificity': 0.70558035, 'f1': 0.7215406, 'auroc': 0.9231978, 'binary_precision': 0.5, 'binary_recall': 0.42524916, 'binary_specificity': 0.9859116, 'binary_f1_score': 0.459605}
confusion matrix:
       0    1
0  17915  256
1    346  256
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97723997, 'precision': 0.88991475, 'recall': 0.7740247, 'specificity': 0.7740247, 'f1': 0.8209459, 'auroc': 0.90952635, 'binary_precision': 0.79761904, 'binary_recall': 0.553719, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.6536585}
confusion matrix:
      0    1
0  5963   34
1   108  134
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011743_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-01 11:19:09.300650,epoch time: 0:20:26.143890,used: 1:02:16.185571,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_10_16_53_seed_2_21011743
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9657494, 'precision': 0.7434757, 'recall': 0.75601935, 'specificity': 0.75601935, 'f1': 0.7495713, 'auroc': 0.9394711, 'binary_precision': 0.5037641, 'binary_recall': 0.53073364, 'binary_specificity': 0.9813051, 'binary_f1_score': 0.5168973}
confusion matrix:
       0    1
0  41520  791
1    710  803
---- Validation: 
scalar performance:
{'acc': 0.9667075, 'precision': 0.73574054, 'recall': 0.79167676, 'specificity': 0.79167676, 'f1': 0.76039755, 'auroc': 0.93039644, 'binary_precision': 0.4846871, 'binary_recall': 0.60465115, 'binary_specificity': 0.9787023, 'binary_f1_score': 0.5380636}
confusion matrix:
       0    1
0  17784  387
1    238  364
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97916335, 'precision': 0.8842133, 'recall': 0.8166628, 'specificity': 0.8166628, 'f1': 0.84687316, 'auroc': 0.9212279, 'binary_precision': 0.7828283, 'binary_recall': 0.6404959, 'binary_specificity': 0.99282974, 'binary_f1_score': 0.70454556}
confusion matrix:
      0    1
0  5954   43
1    87  155
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011743_4.png
new oracle model saved
early stop counter: 1
val acc:0.9667075276374817, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9772399663925171 / 0.9791633486747742
after epoch: 4,now: 2024-06-01 11:39:28.546207,epoch time: 0:20:19.245557,used: 1:22:35.431128,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_10_16_53_seed_2_21011743
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96686745, 'precision': 0.7514485, 'recall': 0.7744429, 'specificity': 0.7744429, 'f1': 0.76238394, 'auroc': 0.94273925, 'binary_precision': 0.51840675, 'binary_recall': 0.5677462, 'binary_specificity': 0.98113966, 'binary_f1_score': 0.5419558}
confusion matrix:
       0    1
0  41513  798
1    654  859
---- Validation: 
scalar performance:
{'acc': 0.96644115, 'precision': 0.73479545, 'recall': 0.8019788, 'specificity': 0.8019788, 'f1': 0.7636881, 'auroc': 0.9383379, 'binary_precision': 0.48209718, 'binary_recall': 0.62624586, 'binary_specificity': 0.97771174, 'binary_f1_score': 0.5447977}
confusion matrix:
       0    1
0  17766  405
1    225  377
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97691935, 'precision': 0.8604099, 'recall': 0.8115301, 'specificity': 0.8115301, 'f1': 0.834014, 'auroc': 0.92919123, 'binary_precision': 0.7355769, 'binary_recall': 0.6322314, 'binary_specificity': 0.99082875, 'binary_f1_score': 0.68}
confusion matrix:
      0    1
0  5942   55
1    89  153
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011743_5.png
early stop counter: 2
val acc:0.9664411544799805, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9772399663925171 / 0.9791633486747742
after epoch: 5,now: 2024-06-01 12:00:42.141600,epoch time: 0:21:13.595393,used: 1:43:49.026521,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_10_16_53_seed_2_21011743
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9677574, 'precision': 0.75790954, 'recall': 0.7669375, 'specificity': 0.7669375, 'f1': 0.762337, 'auroc': 0.9501177, 'binary_precision': 0.53188777, 'binary_recall': 0.55122274, 'binary_specificity': 0.98265225, 'binary_f1_score': 0.5413827}
confusion matrix:
       0    1
0  41577  734
1    679  834
---- Validation: 
scalar performance:
{'acc': 0.9672402, 'precision': 0.7394384, 'recall': 0.8007854, 'specificity': 0.8007854, 'f1': 0.7662263, 'auroc': 0.94225484, 'binary_precision': 0.491481, 'binary_recall': 0.6229236, 'binary_specificity': 0.9786473, 'binary_f1_score': 0.5494505}
confusion matrix:
       0    1
0  17783  388
1    227  375
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97980446, 'precision': 0.8866901, 'recall': 0.8249273, 'specificity': 0.8249273, 'f1': 0.85287297, 'auroc': 0.92748255, 'binary_precision': 0.7871287, 'binary_recall': 0.6570248, 'binary_specificity': 0.99282974, 'binary_f1_score': 0.7162162}
confusion matrix:
      0    1
0  5954   43
1    83  159
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011743_6.png
new oracle model saved
early stop counter: 3
val acc:0.9672402143478394, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9772399663925171 / 0.9798044562339783
after epoch: 6,now: 2024-06-01 12:21:10.531474,epoch time: 0:20:28.389874,used: 2:04:17.416395,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_10_16_53_seed_2_21011743
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96693593, 'precision': 0.7519229, 'recall': 0.78244466, 'specificity': 0.78244466, 'f1': 0.76620924, 'auroc': 0.95044965, 'binary_precision': 0.51877934, 'binary_recall': 0.58426964, 'binary_specificity': 0.98061967, 'binary_f1_score': 0.54958034}
confusion matrix:
       0    1
0  41491  820
1    629  884
---- Validation: 
scalar performance:
{'acc': 0.96777284, 'precision': 0.74147975, 'recall': 0.7681356, 'specificity': 0.7681356, 'f1': 0.75403285, 'auroc': 0.94343686, 'binary_precision': 0.49776453, 'binary_recall': 0.55481726, 'binary_specificity': 0.98145396, 'binary_f1_score': 0.5247447}
confusion matrix:
       0    1
0  17834  337
1    268  334
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9790031, 'precision': 0.8809382, 'recall': 0.81856215, 'specificity': 0.81856215, 'f1': 0.846702, 'auroc': 0.92964166, 'binary_precision': 0.7761194, 'binary_recall': 0.6446281, 'binary_specificity': 0.99249625, 'binary_f1_score': 0.70428896}
confusion matrix:
      0    1
0  5952   45
1    86  156
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011743_7.png
early stop counter: 4
val acc:0.9677728414535522, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9772399663925171 / 0.9798044562339783
after epoch: 7,now: 2024-06-01 12:41:33.023370,epoch time: 0:20:22.491896,used: 2:24:39.908291,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_10_16_53_seed_2_21011743
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.96661645, 'precision': 0.75057316, 'recall': 0.83613145, 'specificity': 0.83613145, 'f1': 0.7863405, 'auroc': 0.9551801, 'binary_precision': 0.5121595, 'binary_recall': 0.6959683, 'binary_specificity': 0.9762946, 'binary_f1_score': 0.5900813}
confusion matrix:
       0     1
0  41308  1003
1    460  1053
---- Validation: 
scalar performance:
{'acc': 0.96526927, 'precision': 0.7298438, 'recall': 0.8222527, 'specificity': 0.8222527, 'f1': 0.7673725, 'auroc': 0.9489481, 'binary_precision': 0.47079438, 'binary_recall': 0.6694352, 'binary_specificity': 0.9750702, 'binary_f1_score': 0.55281204}
confusion matrix:
       0    1
0  17718  453
1    199  403
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97723997, 'precision': 0.853161, 'recall': 0.833507, 'specificity': 0.833507, 'f1': 0.8430234, 'auroc': 0.92883164, 'binary_precision': 0.71929824, 'binary_recall': 0.677686, 'binary_specificity': 0.989328, 'binary_f1_score': 0.69787234}
confusion matrix:
      0    1
0  5933   64
1    78  164
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011743_8.png
early stop counter: 5
val acc:0.9652692675590515, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9772399663925171 / 0.9798044562339783
after epoch: 8,now: 2024-06-01 13:01:55.577314,epoch time: 0:20:22.553944,used: 2:45:02.462235,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_10_16_53_seed_2_21011743
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9669816, 'precision': 0.75230193, 'recall': 0.8050926, 'specificity': 0.8050926, 'f1': 0.7758969, 'auroc': 0.9532875, 'binary_precision': 0.5178959, 'binary_recall': 0.6311963, 'binary_specificity': 0.9789889, 'binary_f1_score': 0.5689604}
confusion matrix:
       0    1
0  41422  889
1    558  955
---- Validation: 
scalar performance:
{'acc': 0.96542907, 'precision': 0.7293247, 'recall': 0.8046682, 'specificity': 0.8046682, 'f1': 0.76104105, 'auroc': 0.9478669, 'binary_precision': 0.4709518, 'binary_recall': 0.63289034, 'binary_specificity': 0.976446, 'binary_f1_score': 0.5400425}
confusion matrix:
       0    1
0  17743  428
1    221  381
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9785222, 'precision': 0.8728436, 'recall': 0.82227755, 'specificity': 0.82227755, 'f1': 0.84554076, 'auroc': 0.9371972, 'binary_precision': 0.75961536, 'binary_recall': 0.6528926, 'binary_specificity': 0.9916625, 'binary_f1_score': 0.7022222}
confusion matrix:
      0    1
0  5947   50
1    84  158
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011743_9.png
early stop counter: 6
val acc:0.9654290676116943, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9772399663925171 / 0.9798044562339783
after epoch: 9,now: 2024-06-01 13:22:14.345388,epoch time: 0:20:18.768074,used: 3:05:21.230309,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_10_16_53_seed_2_21011743
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.967803, 'precision': 0.7578057, 'recall': 0.78480566, 'specificity': 0.78480566, 'f1': 0.7705561, 'auroc': 0.9570842, 'binary_precision': 0.5303933, 'binary_recall': 0.5882353, 'binary_specificity': 0.981376, 'binary_f1_score': 0.5578189}
confusion matrix:
       0    1
0  41523  788
1    623  890
---- Validation: 
scalar performance:
{'acc': 0.96660095, 'precision': 0.7351451, 'recall': 0.79242474, 'specificity': 0.79242474, 'f1': 0.7603128, 'auroc': 0.951909, 'binary_precision': 0.4834437, 'binary_recall': 0.6063123, 'binary_specificity': 0.9785372, 'binary_f1_score': 0.53795135}
confusion matrix:
       0    1
0  17781  390
1    237  365
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9775605, 'precision': 0.8762753, 'recall': 0.79798436, 'specificity': 0.79798436, 'f1': 0.83215195, 'auroc': 0.9385893, 'binary_precision': 0.76842105, 'binary_recall': 0.60330576, 'binary_specificity': 0.992663, 'binary_f1_score': 0.67592597}
confusion matrix:
      0    1
0  5953   44
1    96  146
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011743_10.png
early stop counter: 7
val acc:0.9666009545326233, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9772399663925171 / 0.9798044562339783
after epoch: 10,now: 2024-06-01 13:42:21.850783,epoch time: 0:20:07.505395,used: 3:25:28.735704,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_10_16_53_seed_2_21011743
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96449435, 'precision': 0.7397888, 'recall': 0.84108686, 'specificity': 0.84108686, 'f1': 0.78046215, 'auroc': 0.9548928, 'binary_precision': 0.49016917, 'binary_recall': 0.70852613, 'binary_specificity': 0.97364753, 'binary_f1_score': 0.5794595}
confusion matrix:
       0     1
0  41196  1115
1    441  1072
---- Validation: 
scalar performance:
{'acc': 0.96463007, 'precision': 0.7272613, 'recall': 0.82995296, 'specificity': 0.82995296, 'f1': 0.7679733, 'auroc': 0.9508006, 'binary_precision': 0.4650901, 'binary_recall': 0.68604654, 'binary_specificity': 0.9738594, 'binary_f1_score': 0.5543624}
confusion matrix:
       0    1
0  17696  475
1    189  413
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9740343, 'precision': 0.8283926, 'recall': 0.81796026, 'specificity': 0.81796026, 'f1': 0.82308304, 'auroc': 0.9381197, 'binary_precision': 0.67094016, 'binary_recall': 0.6487603, 'binary_specificity': 0.98716027, 'binary_f1_score': 0.65966386}
confusion matrix:
      0    1
0  5920   77
1    85  157
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011743_11.png
early stop counter: 8
val acc:0.9646300673484802, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9772399663925171 / 0.9798044562339783
after epoch: 11,now: 2024-06-01 14:02:20.969735,epoch time: 0:19:59.118952,used: 3:45:27.854656,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_10_16_53_seed_2_21011743
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9660004, 'precision': 0.7476456, 'recall': 0.8495144, 'specificity': 0.8495144, 'f1': 0.78879166, 'auroc': 0.9601028, 'binary_precision': 0.505302, 'binary_recall': 0.72438866, 'binary_specificity': 0.9746402, 'binary_f1_score': 0.5953286}
confusion matrix:
       0     1
0  41238  1073
1    417  1096
---- Validation: 
scalar performance:
{'acc': 0.96606827, 'precision': 0.733838, 'recall': 0.81945324, 'specificity': 0.81945324, 'f1': 0.7692287, 'auroc': 0.9545544, 'binary_precision': 0.4789916, 'binary_recall': 0.6627907, 'binary_specificity': 0.97611576, 'binary_f1_score': 0.55609757}
confusion matrix:
       0    1
0  17737  434
1    203  399
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.974996, 'precision': 0.8357638, 'recall': 0.822426, 'specificity': 0.822426, 'f1': 0.8289453, 'auroc': 0.9233825, 'binary_precision': 0.6853448, 'binary_recall': 0.6570248, 'binary_specificity': 0.98782724, 'binary_f1_score': 0.6708861}
confusion matrix:
      0    1
0  5924   73
1    83  159
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011743_12.png
early stop counter: 9
val acc:0.9660682678222656, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9772399663925171 / 0.9798044562339783
after epoch: 12,now: 2024-06-01 14:22:32.682579,epoch time: 0:20:11.712844,used: 4:05:39.567500,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_10_16_53_seed_2_21011743
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.96686745, 'precision': 0.7521454, 'recall': 0.84932613, 'specificity': 0.84932613, 'f1': 0.7919074, 'auroc': 0.958545, 'binary_precision': 0.51433945, 'binary_recall': 0.72306675, 'binary_specificity': 0.9755855, 'binary_f1_score': 0.6010989}
confusion matrix:
       0     1
0  41278  1033
1    419  1094
---- Validation: 
scalar performance:
{'acc': 0.9645768, 'precision': 0.7269994, 'recall': 0.8299255, 'specificity': 0.8299255, 'f1': 0.7677733, 'auroc': 0.95078504, 'binary_precision': 0.46456692, 'binary_recall': 0.68604654, 'binary_specificity': 0.9738044, 'binary_f1_score': 0.5539906}
confusion matrix:
       0    1
0  17695  476
1    189  413
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97804135, 'precision': 0.86854994, 'recall': 0.82004464, 'specificity': 0.82004464, 'f1': 0.84241974, 'auroc': 0.9442903, 'binary_precision': 0.75119615, 'binary_recall': 0.6487603, 'binary_specificity': 0.991329, 'binary_f1_score': 0.6962306}
confusion matrix:
      0    1
0  5945   52
1    85  157
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011743_13.png
early stop counter: 10
val acc:0.964576780796051, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9772399663925171 / 0.9798044562339783
after epoch: 13,now: 2024-06-01 14:42:32.828921,epoch time: 0:20:00.146342,used: 4:25:39.713842,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_10_16_53_seed_2_21011743
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9666393, 'precision': 0.7511965, 'recall': 0.86195403, 'specificity': 0.86195403, 'f1': 0.79531056, 'auroc': 0.9644036, 'binary_precision': 0.511502, 'binary_recall': 0.74950427, 'binary_specificity': 0.9744038, 'binary_f1_score': 0.6080429}
confusion matrix:
       0     1
0  41228  1083
1    379  1134
---- Validation: 
scalar performance:
{'acc': 0.963831, 'precision': 0.726364, 'recall': 0.86326826, 'specificity': 0.86326826, 'f1': 0.7769018, 'auroc': 0.9537028, 'binary_precision': 0.4609929, 'binary_recall': 0.75581396, 'binary_specificity': 0.97072256, 'binary_f1_score': 0.5726872}
confusion matrix:
       0    1
0  17639  532
1    147  455
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9778811, 'precision': 0.85958767, 'recall': 0.8338405, 'specificity': 0.8338405, 'f1': 0.8461871, 'auroc': 0.94038, 'binary_precision': 0.73214287, 'binary_recall': 0.677686, 'binary_specificity': 0.989995, 'binary_f1_score': 0.70386267}
confusion matrix:
      0    1
0  5937   60
1    78  164
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011743_14.png
early stop counter: 11
val acc:0.9638310074806213, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9772399663925171 / 0.9798044562339783
after epoch: 14,now: 2024-06-01 15:02:39.440289,epoch time: 0:20:06.611368,used: 4:45:46.325210,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_10_16_53_seed_2_21011743
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9663883, 'precision': 0.7498553, 'recall': 0.8586376, 'specificity': 0.8586376, 'f1': 0.7932939, 'auroc': 0.959537, 'binary_precision': 0.509058, 'binary_recall': 0.7428949, 'binary_specificity': 0.9743802, 'binary_f1_score': 0.60413873}
confusion matrix:
       0     1
0  41227  1084
1    389  1124
---- Validation: 
scalar performance:
{'acc': 0.9638843, 'precision': 0.7260592, 'recall': 0.85687137, 'specificity': 0.85687137, 'f1': 0.7749276, 'auroc': 0.95379925, 'binary_precision': 0.46082473, 'binary_recall': 0.7425249, 'binary_specificity': 0.9712179, 'binary_f1_score': 0.5687023}
confusion matrix:
       0    1
0  17648  523
1    155  447
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.974996, 'precision': 0.84641266, 'recall': 0.7966504, 'specificity': 0.7966504, 'f1': 0.8194091, 'auroc': 0.9426297, 'binary_precision': 0.70873785, 'binary_recall': 0.60330576, 'binary_specificity': 0.989995, 'binary_f1_score': 0.6517857}
confusion matrix:
      0    1
0  5937   60
1    96  146
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011743_15.png
early stop counter: 12
val acc:0.9638842940330505, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9772399663925171 / 0.9798044562339783
after epoch: 15,now: 2024-06-01 15:22:37.040417,epoch time: 0:19:57.600128,used: 5:05:43.925338,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_10_16_53_seed_2_21011743
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.965293, 'precision': 0.7452992, 'recall': 0.8825387, 'specificity': 0.8825387, 'f1': 0.7969613, 'auroc': 0.9617859, 'binary_precision': 0.498132, 'binary_recall': 0.7936508, 'binary_specificity': 0.97142655, 'binary_f1_score': 0.61208874}
confusion matrix:
       0     1
0  41103  1209
1    312  1200
---- Validation: 
scalar performance:
{'acc': 0.9628189, 'precision': 0.7234016, 'recall': 0.87800336, 'specificity': 0.87800336, 'f1': 0.7782494, 'auroc': 0.9536061, 'binary_precision': 0.45402297, 'binary_recall': 0.7873754, 'binary_specificity': 0.9686313, 'binary_f1_score': 0.5759417}
confusion matrix:
       0    1
0  17601  570
1    128  474
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97691935, 'precision': 0.84375334, 'recall': 0.84920216, 'specificity': 0.84920216, 'f1': 0.846454, 'auroc': 0.94209206, 'binary_precision': 0.699187, 'binary_recall': 0.7107438, 'binary_specificity': 0.98766047, 'binary_f1_score': 0.704918}
confusion matrix:
      0    1
0  5923   74
1    70  172
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011743_16.png
early stop counter: 13
val acc:0.9628189206123352, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9772399663925171 / 0.9798044562339783
after epoch: 16,now: 2024-06-01 15:42:38.503969,epoch time: 0:20:01.463552,used: 5:25:45.388890,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_10_16_53_seed_2_21011743
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.964791, 'precision': 0.74288696, 'recall': 0.8766108, 'specificity': 0.8766108, 'f1': 0.79342175, 'auroc': 0.96296966, 'binary_precision': 0.49373958, 'binary_recall': 0.7818903, 'binary_specificity': 0.97133136, 'binary_f1_score': 0.60526985}
confusion matrix:
       0     1
0  41098  1213
1    330  1183
---- Validation: 
scalar performance:
{'acc': 0.9639376, 'precision': 0.7259575, 'recall': 0.8528837, 'specificity': 0.8528837, 'f1': 0.77374506, 'auroc': 0.95247304, 'binary_precision': 0.46089676, 'binary_recall': 0.73421925, 'binary_specificity': 0.9715481, 'binary_f1_score': 0.5663036}
confusion matrix:
       0    1
0  17654  517
1    160  442
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9722712, 'precision': 0.81701887, 'recall': 0.803164, 'specificity': 0.803164, 'f1': 0.8099194, 'auroc': 0.93733215, 'binary_precision': 0.64935064, 'binary_recall': 0.6198347, 'binary_specificity': 0.98649323, 'binary_f1_score': 0.6342495}
confusion matrix:
      0    1
0  5916   81
1    92  150
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011743_17.png
early stop counter: 14
val acc:0.9639375805854797, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9772399663925171 / 0.9798044562339783
after epoch: 17,now: 2024-06-01 16:02:50.407749,epoch time: 0:20:11.903780,used: 5:45:57.292670,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_10_16_53_seed_2_21011743
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9668447, 'precision': 0.75243264, 'recall': 0.87257594, 'specificity': 0.87257594, 'f1': 0.7994963, 'auroc': 0.9655191, 'binary_precision': 0.5131926, 'binary_recall': 0.7713153, 'binary_specificity': 0.9738366, 'binary_f1_score': 0.61631894}
confusion matrix:
       0     1
0  41204  1107
1    346  1167
---- Validation: 
scalar performance:
{'acc': 0.9640441, 'precision': 0.7268413, 'recall': 0.857757, 'specificity': 0.857757, 'f1': 0.7757872, 'auroc': 0.95353067, 'binary_precision': 0.4623323, 'binary_recall': 0.74418604, 'binary_specificity': 0.97132796, 'binary_f1_score': 0.57033736}
confusion matrix:
       0    1
0  17650  521
1    154  448
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9759577, 'precision': 0.8448682, 'recall': 0.8229263, 'specificity': 0.8229263, 'f1': 0.8334988, 'auroc': 0.9385025, 'binary_precision': 0.70353985, 'binary_recall': 0.6570248, 'binary_specificity': 0.98882776, 'binary_f1_score': 0.67948717}
confusion matrix:
      0    1
0  5930   67
1    83  159
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011743_18.png
early stop counter: 15
val acc:0.9640440940856934, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9772399663925171 / 0.9798044562339783
after epoch: 18,now: 2024-06-01 16:22:56.129217,epoch time: 0:20:05.721468,used: 6:06:03.014138,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_10_16_53_seed_2_21011743
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9661829, 'precision': 0.7494054, 'recall': 0.87956226, 'specificity': 0.87956226, 'f1': 0.79928654, 'auroc': 0.9645419, 'binary_precision': 0.50659853, 'binary_recall': 0.78651685, 'binary_specificity': 0.9726076, 'binary_f1_score': 0.616261}
confusion matrix:
       0     1
0  41152  1159
1    323  1190
---- Validation: 
scalar performance:
{'acc': 0.9640441, 'precision': 0.7268413, 'recall': 0.857757, 'specificity': 0.857757, 'f1': 0.7757872, 'auroc': 0.9544139, 'binary_precision': 0.4623323, 'binary_recall': 0.74418604, 'binary_specificity': 0.97132796, 'binary_f1_score': 0.57033736}
confusion matrix:
       0    1
0  17650  521
1    154  448
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97371376, 'precision': 0.8331547, 'recall': 0.7959834, 'specificity': 0.7959834, 'f1': 0.8133546, 'auroc': 0.9435556, 'binary_precision': 0.682243, 'binary_recall': 0.60330576, 'binary_specificity': 0.988661, 'binary_f1_score': 0.6403509}
confusion matrix:
      0    1
0  5929   68
1    96  146
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011743_19.png
early stop counter: 16
val acc:0.9640440940856934, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9772399663925171 / 0.9798044562339783
after epoch: 19,now: 2024-06-01 16:42:55.826256,epoch time: 0:19:59.697039,used: 6:26:02.711177,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_10_16_53_seed_2_21011743
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.96590906, 'precision': 0.7470925, 'recall': 0.8465992, 'specificity': 0.8465992, 'f1': 0.78745174, 'auroc': 0.9623877, 'binary_precision': 0.50440836, 'binary_recall': 0.7184402, 'binary_specificity': 0.9747583, 'binary_f1_score': 0.59269357}
confusion matrix:
       0     1
0  41243  1068
1    426  1087
---- Validation: 
scalar performance:
{'acc': 0.9632984, 'precision': 0.7219794, 'recall': 0.84050775, 'specificity': 0.84050775, 'f1': 0.76716495, 'auroc': 0.9498424, 'binary_precision': 0.45377257, 'binary_recall': 0.7093023, 'binary_specificity': 0.9717132, 'binary_f1_score': 0.5534673}
confusion matrix:
       0    1
0  17657  514
1    175  427
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9685847, 'precision': 0.81678617, 'recall': 0.69417834, 'specificity': 0.69417834, 'f1': 0.7393168, 'auroc': 0.9315248, 'binary_precision': 0.65753424, 'binary_recall': 0.3966942, 'binary_specificity': 0.9916625, 'binary_f1_score': 0.49484536}
confusion matrix:
      0   1
0  5947  50
1   146  96
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011743_20.png
early stop counter: 17
val acc:0.9632983803749084, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9772399663925171 / 0.9798044562339783
after epoch: 20,now: 2024-06-01 17:02:57.933529,epoch time: 0:20:02.107273,used: 6:46:04.818450,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_10_16_53_seed_2_21011743
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.964791, 'precision': 0.74367934, 'recall': 0.89413667, 'specificity': 0.89413667, 'f1': 0.79881155, 'auroc': 0.9661985, 'binary_precision': 0.49401435, 'binary_recall': 0.8182419, 'binary_specificity': 0.97003144, 'binary_f1_score': 0.61607367}
confusion matrix:
       0     1
0  41043  1268
1    275  1238
---- Validation: 
scalar performance:
{'acc': 0.9628722, 'precision': 0.7225289, 'recall': 0.86598516, 'specificity': 0.86598516, 'f1': 0.77451134, 'auroc': 0.95448554, 'binary_precision': 0.45310956, 'binary_recall': 0.76245844, 'binary_specificity': 0.96951187, 'binary_f1_score': 0.568421}
confusion matrix:
       0    1
0  17617  554
1    143  459
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96890527, 'precision': 0.78879476, 'recall': 0.80934405, 'specificity': 0.80934405, 'f1': 0.7986734, 'auroc': 0.94606125, 'binary_precision': 0.5923077, 'binary_recall': 0.6363636, 'binary_specificity': 0.9823245, 'binary_f1_score': 0.6135458}
confusion matrix:
      0    1
0  5891  106
1    88  154
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011743_21.png
early stop counter: 18
val acc:0.9628722071647644, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9772399663925171 / 0.9798044562339783
after epoch: 21,now: 2024-06-01 17:22:56.603405,epoch time: 0:19:58.669876,used: 7:06:03.488326,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_10_16_53_seed_2_21011743
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9629883, 'precision': 0.7365442, 'recall': 0.89989483, 'specificity': 0.89989483, 'f1': 0.7943946, 'auroc': 0.96609384, 'binary_precision': 0.4792539, 'binary_recall': 0.8321216, 'binary_specificity': 0.967668, 'binary_f1_score': 0.60821253}
confusion matrix:
       0     1
0  40943  1368
1    254  1259
---- Validation: 
scalar performance:
{'acc': 0.96111435, 'precision': 0.7176273, 'recall': 0.8867594, 'specificity': 0.8867594, 'f1': 0.77536345, 'auroc': 0.9565434, 'binary_precision': 0.44181818, 'binary_recall': 0.807309, 'binary_specificity': 0.9662099, 'binary_f1_score': 0.57109284}
confusion matrix:
       0    1
0  17557  614
1    116  486
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.969867, 'precision': 0.7975714, 'recall': 0.7999306, 'specificity': 0.7999306, 'f1': 0.7987458, 'auroc': 0.9443701, 'binary_precision': 0.6106557, 'binary_recall': 0.61570245, 'binary_specificity': 0.98415875, 'binary_f1_score': 0.6131687}
confusion matrix:
      0    1
0  5902   95
1    93  149
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011743_22.png
early stop counter: 19
val acc:0.9611143469810486, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9772399663925171 / 0.9798044562339783
after epoch: 22,now: 2024-06-01 17:42:55.614395,epoch time: 0:19:59.010990,used: 7:26:02.499316,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_10_16_53_seed_2_21011743
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.96558964, 'precision': 0.7462083, 'recall': 0.86746484, 'specificity': 0.86746484, 'f1': 0.7933134, 'auroc': 0.96766543, 'binary_precision': 0.5010865, 'binary_recall': 0.76206213, 'binary_specificity': 0.97286755, 'binary_f1_score': 0.6046146}
confusion matrix:
       0     1
0  41163  1148
1    360  1153
---- Validation: 
scalar performance:
{'acc': 0.9621797, 'precision': 0.71925783, 'recall': 0.8616122, 'specificity': 0.8616122, 'f1': 0.7707125, 'auroc': 0.9568149, 'binary_precision': 0.4468504, 'binary_recall': 0.75415283, 'binary_specificity': 0.9690716, 'binary_f1_score': 0.5611867}
confusion matrix:
       0    1
0  17609  562
1    148  454
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9668216, 'precision': 0.7822407, 'recall': 0.74282974, 'specificity': 0.74282974, 'f1': 0.76088357, 'auroc': 0.9321119, 'binary_precision': 0.5845411, 'binary_recall': 0.5, 'binary_specificity': 0.9856595, 'binary_f1_score': 0.53897554}
confusion matrix:
      0    1
0  5911   86
1   121  121
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011743_23.png
early stop counter: 20
val acc:0.9621797204017639, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9772399663925171 / 0.9798044562339783
after epoch: 23,now: 2024-06-01 18:02:58.208665,epoch time: 0:20:02.594270,used: 7:46:05.093586,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_10_16_53_seed_2_21011743
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9654983, 'precision': 0.7468586, 'recall': 0.8967335, 'specificity': 0.8967335, 'f1': 0.8020563, 'auroc': 0.9681675, 'binary_precision': 0.50020087, 'binary_recall': 0.82286847, 'binary_specificity': 0.97059864, 'binary_f1_score': 0.62218887}
confusion matrix:
       0     1
0  41067  1244
1    268  1245
---- Validation: 
scalar performance:
{'acc': 0.9634049, 'precision': 0.7262242, 'recall': 0.88312435, 'specificity': 0.88312435, 'f1': 0.7818705, 'auroc': 0.9581191, 'binary_precision': 0.45933014, 'binary_recall': 0.7973422, 'binary_specificity': 0.9689065, 'binary_f1_score': 0.58287793}
confusion matrix:
       0    1
0  17606  565
1    122  480
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97195065, 'precision': 0.81025743, 'recall': 0.81885916, 'specificity': 0.81885916, 'f1': 0.8144927, 'auroc': 0.9344443, 'binary_precision': 0.6345382, 'binary_recall': 0.6528926, 'binary_specificity': 0.98482573, 'binary_f1_score': 0.64358455}
confusion matrix:
      0    1
0  5906   91
1    84  158
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011743_24.png
early stop counter: 21
val acc:0.9634048938751221, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9772399663925171 / 0.9798044562339783
after epoch: 24,now: 2024-06-01 18:23:13.777960,epoch time: 0:20:15.569295,used: 8:06:20.662881,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_10_16_53_seed_2_21011743
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.96522456, 'precision': 0.74637544, 'recall': 0.9144363, 'specificity': 0.9144363, 'f1': 0.8061942, 'auroc': 0.9698207, 'binary_precision': 0.49789515, 'binary_recall': 0.85988104, 'binary_specificity': 0.9689915, 'binary_f1_score': 0.630635}
confusion matrix:
       0     1
0  40999  1312
1    212  1301
---- Validation: 
scalar performance:
{'acc': 0.9610611, 'precision': 0.719322, 'recall': 0.9060051, 'specificity': 0.9060051, 'f1': 0.7810512, 'auroc': 0.95756495, 'binary_precision': 0.44386423, 'binary_recall': 0.8471761, 'binary_specificity': 0.9648341, 'binary_f1_score': 0.5825243}
confusion matrix:
       0    1
0  17532  639
1     92  510
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97259176, 'precision': 0.80915177, 'recall': 0.846951, 'specificity': 0.846951, 'f1': 0.82683355, 'auroc': 0.9381609, 'binary_precision': 0.63003665, 'binary_recall': 0.7107438, 'binary_specificity': 0.98315823, 'binary_f1_score': 0.6679612}
confusion matrix:
      0    1
0  5896  101
1    70  172
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011743_25.png
early stop counter: 22
val acc:0.9610611200332642, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9772399663925171 / 0.9798044562339783
after epoch: 25,now: 2024-06-01 18:43:11.065652,epoch time: 0:19:57.287692,used: 8:26:17.950573,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_10_16_53_seed_2_21011743
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9574206, 'precision': 0.71702117, 'recall': 0.9052963, 'specificity': 0.9052963, 'f1': 0.77846307, 'auroc': 0.9627692, 'binary_precision': 0.43961683, 'binary_recall': 0.849306, 'binary_specificity': 0.96128666, 'binary_f1_score': 0.57935077}
confusion matrix:
       0     1
0  40673  1638
1    228  1285
---- Validation: 
scalar performance:
{'acc': 0.9577052, 'precision': 0.7065427, 'recall': 0.8938319, 'specificity': 0.8938319, 'f1': 0.7668618, 'auroc': 0.95568776, 'binary_precision': 0.41905564, 'binary_recall': 0.8255814, 'binary_specificity': 0.96208245, 'binary_f1_score': 0.5559284}
confusion matrix:
       0    1
0  17482  689
1    105  497
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.74274504, 'recall': 0.8093076, 'specificity': 0.8093076, 'f1': 0.77144086, 'auroc': 0.92765343, 'binary_precision': 0.5, 'binary_recall': 0.6446281, 'binary_specificity': 0.973987, 'binary_f1_score': 0.56317693}
confusion matrix:
      0    1
0  5841  156
1    86  156
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011743_26.png
early stop counter: 23
val acc:0.9577051997184753, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9772399663925171 / 0.9798044562339783
after epoch: 26,now: 2024-06-01 19:03:21.199347,epoch time: 0:20:10.133695,used: 8:46:28.084268,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_10_16_53_seed_2_21011743
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.96563524, 'precision': 0.74677384, 'recall': 0.87736666, 'specificity': 0.87736666, 'f1': 0.7966387, 'auroc': 0.96869457, 'binary_precision': 0.5014824, 'binary_recall': 0.7825512, 'binary_specificity': 0.97218215, 'binary_f1_score': 0.6112545}
confusion matrix:
       0     1
0  41134  1177
1    329  1184
---- Validation: 
scalar performance:
{'acc': 0.963032, 'precision': 0.72413456, 'recall': 0.87650734, 'specificity': 0.87650734, 'f1': 0.77849275, 'auroc': 0.95854294, 'binary_precision': 0.45559844, 'binary_recall': 0.78405315, 'binary_specificity': 0.96896154, 'binary_f1_score': 0.5763126}
confusion matrix:
       0    1
0  17607  564
1    130  472
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96602017, 'precision': 0.78428376, 'recall': 0.69284433, 'specificity': 0.69284433, 'f1': 0.7288446, 'auroc': 0.93838656, 'binary_precision': 0.5925926, 'binary_recall': 0.3966942, 'binary_specificity': 0.9889945, 'binary_f1_score': 0.47524753}
confusion matrix:
      0   1
0  5931  66
1   146  96
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011743_27.png
early stop counter: 24
val acc:0.9630320072174072, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9772399663925171 / 0.9798044562339783
after epoch: 27,now: 2024-06-01 19:23:30.603461,epoch time: 0:20:09.404114,used: 9:06:37.488382,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_10_16_53_seed_2_21011743
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.96093464, 'precision': 0.7285744, 'recall': 0.8985126, 'specificity': 0.8985126, 'f1': 0.7872789, 'auroc': 0.9690497, 'binary_precision': 0.46335176, 'binary_recall': 0.83146065, 'binary_specificity': 0.9655645, 'binary_f1_score': 0.59508044}
confusion matrix:
       0     1
0  40854  1457
1    255  1258
---- Validation: 
scalar performance:
{'acc': 0.96212643, 'precision': 0.7222507, 'recall': 0.8953127, 'specificity': 0.8953127, 'f1': 0.7813325, 'auroc': 0.95942307, 'binary_precision': 0.45049953, 'binary_recall': 0.82392025, 'binary_specificity': 0.9667052, 'binary_f1_score': 0.5825014}
confusion matrix:
       0    1
0  17566  605
1    106  496
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96281457, 'precision': 0.75115705, 'recall': 0.7090215, 'specificity': 0.7090215, 'f1': 0.7279188, 'auroc': 0.9404229, 'binary_precision': 0.525, 'binary_recall': 0.4338843, 'binary_specificity': 0.98415875, 'binary_f1_score': 0.47511312}
confusion matrix:
      0    1
0  5902   95
1   137  105
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011743_28.png
early stop counter: 25
val acc:0.9621264338493347, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9772399663925171 / 0.9798044562339783
after epoch: 28,now: 2024-06-01 19:43:32.065538,epoch time: 0:20:01.462077,used: 9:26:38.950459,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_10_16_53_seed_2_21011743
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.96643394, 'precision': 0.751017, 'recall': 0.89594346, 'specificity': 0.89594346, 'f1': 0.805151, 'auroc': 0.97279716, 'binary_precision': 0.50860655, 'binary_recall': 0.8202247, 'binary_specificity': 0.9716622, 'binary_f1_score': 0.6278776}
confusion matrix:
       0     1
0  41112  1199
1    272  1241
---- Validation: 
scalar performance:
{'acc': 0.9647366, 'precision': 0.73225176, 'recall': 0.8894336, 'specificity': 0.8894336, 'f1': 0.7884598, 'auroc': 0.96187854, 'binary_precision': 0.47098646, 'binary_recall': 0.8089701, 'binary_specificity': 0.9698971, 'binary_f1_score': 0.5953545}
confusion matrix:
       0    1
0  17624  547
1    115  487
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9681039, 'precision': 0.79223406, 'recall': 0.7514277, 'specificity': 0.7514277, 'f1': 0.7701248, 'auroc': 0.930842, 'binary_precision': 0.6038647, 'binary_recall': 0.5165289, 'binary_specificity': 0.9863265, 'binary_f1_score': 0.55679286}
confusion matrix:
      0    1
0  5915   82
1   117  125
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011743_29.png
early stop counter: 26
val acc:0.9647365808486938, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9772399663925171 / 0.9798044562339783
after epoch: 29,now: 2024-06-01 20:03:44.856887,epoch time: 0:20:12.791349,used: 9:46:51.741808,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_10_16_53_seed_2_21011743
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9654983, 'precision': 0.7472367, 'recall': 0.90943015, 'specificity': 0.90943015, 'f1': 0.80565935, 'auroc': 0.973609, 'binary_precision': 0.5, 'binary_recall': 0.8492063, 'binary_specificity': 0.969654, 'binary_f1_score': 0.62941176}
confusion matrix:
       0     1
0  41028  1284
1    228  1284
---- Validation: 
scalar performance:
{'acc': 0.9626591, 'precision': 0.72438645, 'recall': 0.8963909, 'specificity': 0.8963909, 'f1': 0.78343874, 'auroc': 0.9636954, 'binary_precision': 0.4547118, 'binary_recall': 0.8255814, 'binary_specificity': 0.96720046, 'binary_f1_score': 0.5864306}
confusion matrix:
       0    1
0  17575  596
1    105  497
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9722712, 'precision': 0.8187684, 'recall': 0.79721576, 'specificity': 0.79721576, 'f1': 0.80757344, 'auroc': 0.9505166, 'binary_precision': 0.6533333, 'binary_recall': 0.607438, 'binary_specificity': 0.9869935, 'binary_f1_score': 0.62955034}
confusion matrix:
      0    1
0  5919   78
1    95  147
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011743_30.png
early stop counter: 27
val acc:0.9626591205596924, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9772399663925171 / 0.9798044562339783
after epoch: 30,now: 2024-06-01 20:23:45.111359,epoch time: 0:20:00.254472,used: 10:06:51.996280,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_10_16_53_seed_2_21011743
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 10:06:51.996280 at 2024-06-01 20:23:45.111359
persisted model performance metric: 

scalar performance:
{'acc': 0.9767591, 'precision': 0.8950045, 'recall': 0.75989544, 'specificity': 0.75989544, 'f1': 0.8122935, 'auroc': 0.91153204, 'binary_precision': 0.8089172, 'binary_recall': 0.5247934, 'binary_specificity': 0.9949975, 'binary_f1_score': 0.63659143}
confusion matrix:
      0    1
0  5967   30
1   115  127
oracle model performance metric: 

scalar performance:
{'acc': 0.9794839, 'precision': 0.8854624, 'recall': 0.82079506, 'specificity': 0.82079506, 'f1': 0.84988624, 'auroc': 0.9329684, 'binary_precision': 0.785, 'binary_recall': 0.6487603, 'binary_specificity': 0.99282974, 'binary_f1_score': 0.7104072}
confusion matrix:
      0    1
0  5954   43
1    85  157
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/rule_results/10.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/confusion_matrix/10.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 495893 KiB |  11071 MiB |   4986 TiB |   4986 TiB |
|       from large pool | 406080 KiB |  10998 MiB |   4978 TiB |   4978 TiB |
|       from small pool |  89813 KiB |    124 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 495893 KiB |  11071 MiB |   4986 TiB |   4986 TiB |
|       from large pool | 406080 KiB |  10998 MiB |   4978 TiB |   4978 TiB |
|       from small pool |  89813 KiB |    124 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476572 KiB |  10961 MiB |   4965 TiB |   4965 TiB |
|       from large pool | 387840 KiB |  10889 MiB |   4956 TiB |   4956 TiB |
|       from small pool |  88732 KiB |    123 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11236 MiB |  11390 MiB |  30060 MiB |  18824 MiB |
|       from large pool |  11112 MiB |  11266 MiB |  29880 MiB |  18768 MiB |
|       from small pool |    124 MiB |    126 MiB |    180 MiB |     56 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1347 MiB |   2595 MiB |   1676 TiB |   1676 TiB |
|       from large pool |   1339 MiB |   2593 MiB |   1668 TiB |   1668 TiB |
|       from small pool |      8 MiB |     24 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3717    |    6728    |  413704 K  |  413700 K  |
|       from large pool |      87    |     909    |  194831 K  |  194831 K  |
|       from small pool |    3630    |    6639    |  218872 K  |  218868 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3717    |    6728    |  413704 K  |  413700 K  |
|       from large pool |      87    |     909    |  194831 K  |  194831 K  |
|       from small pool |    3630    |    6639    |  218872 K  |  218868 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     234    |     234    |     538    |     304    |
|       from large pool |     172    |     172    |     448    |     276    |
|       from small pool |      62    |      63    |      90    |      28    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      74    |    2775    |  217325 K  |  217325 K  |
|       from large pool |      24    |      65    |  101676 K  |  101676 K  |
|       from small pool |      50    |    2751    |  115649 K  |  115649 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  11071 MiB |   4986 TiB |   4986 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   4978 TiB |   4978 TiB |
|       from small pool |      0 KiB |    124 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  11071 MiB |   4986 TiB |   4986 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   4978 TiB |   4978 TiB |
|       from small pool |      0 KiB |    124 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10961 MiB |   4965 TiB |   4965 TiB |
|       from large pool |  16640 KiB |  10889 MiB |   4956 TiB |   4956 TiB |
|       from small pool |      0 KiB |    123 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1832 MiB |  11390 MiB |  30060 MiB |  28228 MiB |
|       from large pool |   1736 MiB |  11266 MiB |  29880 MiB |  28144 MiB |
|       from small pool |     96 MiB |    126 MiB |    180 MiB |     84 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   2595 MiB |   1676 TiB |   1676 TiB |
|       from large pool | 134912 KiB |   2593 MiB |   1668 TiB |   1668 TiB |
|       from small pool |      0 KiB |     24 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6728    |  413704 K  |  413704 K  |
|       from large pool |       2    |     909    |  194831 K  |  194831 K  |
|       from small pool |       0    |    6639    |  218872 K  |  218872 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6728    |  413704 K  |  413704 K  |
|       from large pool |       2    |     909    |  194831 K  |  194831 K  |
|       from small pool |       0    |    6639    |  218872 K  |  218872 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      82    |     234    |     538    |     456    |
|       from large pool |      34    |     172    |     448    |     414    |
|       from small pool |      48    |      63    |      90    |      42    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2775    |  217327 K  |  217327 K  |
|       from large pool |       4    |      65    |  101676 K  |  101676 K  |
|       from small pool |       0    |    2751    |  115651 K  |  115651 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat Jun  1 20:25:49 2024]
Finished job 0.
1 of 1 steps (100%) done
