Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jun  8 23:34:22 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_new_new/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_new_new/rule_results/5.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=5
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_39_seed_0_21261153

 Experiment start at: 2024-06-08 23:41:39.643579
before training, model accuracy: 0.955097496509552
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.97173, 'precision': 0.78238606, 'recall': 0.7827564, 'specificity': 0.7827564, 'f1': 0.7825711, 'auroc': 0.96705186, 'binary_precision': 0.57937586, 'binary_recall': 0.58016306, 'binary_specificity': 0.9853497, 'binary_f1_score': 0.57976913}
confusion matrix:
       0    1
0  41700  620
1    618  854
---- Validation: 
scalar performance:
{'acc': 0.97020006, 'precision': 0.7764306, 'recall': 0.7573054, 'specificity': 0.7573054, 'f1': 0.7664894, 'auroc': 0.96983397, 'binary_precision': 0.5695142, 'binary_recall': 0.5287714, 'binary_specificity': 0.9858394, 'binary_f1_score': 0.5483871}
confusion matrix:
       0    1
0  17892  257
1    303  340
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.979706, 'precision': 0.88563895, 'recall': 0.850154, 'specificity': 0.850154, 'f1': 0.8669501, 'auroc': 0.9448854, 'binary_precision': 0.7838983, 'binary_recall': 0.70881224, 'binary_specificity': 0.9914957, 'binary_f1_score': 0.7444668}
confusion matrix:
      0    1
0  5946   51
1    76  185
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261153_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-09 00:23:07.399805,epoch time: 0:41:27.756226,used: 0:41:27.756226,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_39_seed_0_21261153
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97746164, 'precision': 0.9241071, 'recall': 0.69293773, 'specificity': 0.69293773, 'f1': 0.762426, 'auroc': 0.9793246, 'binary_precision': 0.869102, 'binary_recall': 0.3879076, 'binary_specificity': 0.99796784, 'binary_f1_score': 0.53640205}
confusion matrix:
       0    1
0  42234   86
1    901  571
---- Validation: 
scalar performance:
{'acc': 0.9752022, 'precision': 0.95163465, 'recall': 0.6488869, 'specificity': 0.6488869, 'f1': 0.7195394, 'auroc': 0.97454846, 'binary_precision': 0.92753625, 'binary_recall': 0.29860032, 'binary_specificity': 0.9991735, 'binary_f1_score': 0.4517647}
confusion matrix:
       0    1
0  18134   15
1    451  192
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96164906, 'precision': 0.9590949, 'recall': 0.5420622, 'specificity': 0.5420622, 'f1': 0.56765443, 'auroc': 0.94487125, 'binary_precision': 0.95652175, 'binary_recall': 0.08429119, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.15492958}
confusion matrix:
      0   1
0  5996   1
1   239  22
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261153_2.png
better model found
persisted
after epoch: 2,now: 2024-06-09 01:03:14.122194,epoch time: 0:40:06.722389,used: 1:21:34.478615,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_39_seed_0_21261153
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.98212004, 'precision': 0.8706825, 'recall': 0.84507716, 'specificity': 0.84507716, 'f1': 0.85738254, 'auroc': 0.9825258, 'binary_precision': 0.75183016, 'binary_recall': 0.6981645, 'binary_specificity': 0.9919898, 'binary_f1_score': 0.72400427}
confusion matrix:
       0     1
0  41982   339
1    444  1027
---- Validation: 
scalar performance:
{'acc': 0.98110896, 'precision': 0.9104645, 'recall': 0.7764541, 'specificity': 0.7764541, 'f1': 0.8294058, 'auroc': 0.9766031, 'binary_precision': 0.8364486, 'binary_recall': 0.55676514, 'binary_specificity': 0.99614304, 'binary_f1_score': 0.66853404}
confusion matrix:
       0    1
0  18079   70
1    285  358
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9613295, 'precision': 0.8596515, 'recall': 0.55288947, 'specificity': 0.55288947, 'f1': 0.5840563, 'auroc': 0.95113134, 'binary_precision': 0.7567568, 'binary_recall': 0.107279696, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.18791947}
confusion matrix:
      0   1
0  5988   9
1   233  28
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261153_3.png
better model found
persisted
after epoch: 3,now: 2024-06-09 01:43:09.992934,epoch time: 0:39:55.870740,used: 2:01:30.349355,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_39_seed_0_21261153
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98392403, 'precision': 0.90739894, 'recall': 0.8277528, 'specificity': 0.8277528, 'f1': 0.8629252, 'auroc': 0.98591065, 'binary_precision': 0.82653064, 'binary_recall': 0.66032606, 'binary_specificity': 0.9951796, 'binary_f1_score': 0.73413897}
confusion matrix:
       0    1
0  42116  204
1    500  972
---- Validation: 
scalar performance:
{'acc': 0.9822265, 'precision': 0.90914476, 'recall': 0.79878426, 'specificity': 0.79878426, 'f1': 0.8446996, 'auroc': 0.9826477, 'binary_precision': 0.83225805, 'binary_recall': 0.60186625, 'binary_specificity': 0.99570227, 'binary_f1_score': 0.69855595}
confusion matrix:
       0    1
0  18071   78
1    256  387
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645254, 'precision': 0.91002303, 'recall': 0.5893713, 'specificity': 0.5893713, 'f1': 0.6396358, 'auroc': 0.96196055, 'binary_precision': 0.8545455, 'binary_recall': 0.18007663, 'binary_specificity': 0.998666, 'binary_f1_score': 0.29746836}
confusion matrix:
      0   1
0  5989   8
1   214  47
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261153_4.png
better model found
persisted
after epoch: 4,now: 2024-06-09 02:23:21.949614,epoch time: 0:40:11.956680,used: 2:41:42.306035,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_39_seed_0_21261153
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9846547, 'precision': 0.91404414, 'recall': 0.833593, 'specificity': 0.833593, 'f1': 0.8691559, 'auroc': 0.9875487, 'binary_precision': 0.8394223, 'binary_recall': 0.67165196, 'binary_specificity': 0.9955341, 'binary_f1_score': 0.74622357}
confusion matrix:
       0    1
0  42132  189
1    483  988
---- Validation: 
scalar performance:
{'acc': 0.9841422, 'precision': 0.93213147, 'recall': 0.8102768, 'specificity': 0.8102768, 'f1': 0.8604615, 'auroc': 0.9815935, 'binary_precision': 0.87746173, 'binary_recall': 0.62363917, 'binary_specificity': 0.99691445, 'binary_f1_score': 0.7290909}
confusion matrix:
       0    1
0  18093   56
1    242  401
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96628314, 'precision': 0.857523, 'recall': 0.6434261, 'specificity': 0.6434261, 'f1': 0.70068544, 'auroc': 0.9502784, 'binary_precision': 0.74509805, 'binary_recall': 0.29118773, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.4187328}
confusion matrix:
      0   1
0  5971  26
1   185  76
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261153_5.png
better model found
persisted
after epoch: 5,now: 2024-06-09 03:03:48.638028,epoch time: 0:40:26.688414,used: 3:22:08.994449,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_39_seed_0_21261153
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9856595, 'precision': 0.90007055, 'recall': 0.87217134, 'specificity': 0.87217134, 'f1': 0.88557553, 'auroc': 0.9898594, 'binary_precision': 0.8087912, 'binary_recall': 0.75050986, 'binary_specificity': 0.9938328, 'binary_f1_score': 0.7785613}
confusion matrix:
       0     1
0  42060   261
1    367  1104
---- Validation: 
scalar performance:
{'acc': 0.9832908, 'precision': 0.89633495, 'recall': 0.8353379, 'specificity': 0.8353379, 'f1': 0.86308545, 'auroc': 0.9823874, 'binary_precision': 0.80406654, 'binary_recall': 0.67651635, 'binary_specificity': 0.99415946, 'binary_f1_score': 0.73479724}
confusion matrix:
       0    1
0  18043  106
1    208  435
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9688399, 'precision': 0.8549444, 'recall': 0.6942331, 'specificity': 0.6942331, 'f1': 0.74880993, 'auroc': 0.95461154, 'binary_precision': 0.73571426, 'binary_recall': 0.394636, 'binary_specificity': 0.99383026, 'binary_f1_score': 0.5137157}
confusion matrix:
      0    1
0  5960   37
1   158  103
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261153_6.png
early stop counter: 1
val acc:0.9832907915115356, best validation acc: 0.9841421842575073, corresponding to test acc:                         0.9662831425666809 / 0.9797059893608093
after epoch: 6,now: 2024-06-09 03:44:15.403693,epoch time: 0:40:26.765665,used: 4:02:35.760114,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_39_seed_0_21261153
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98675555, 'precision': 0.92308354, 'recall': 0.8622396, 'specificity': 0.8622396, 'f1': 0.89012146, 'auroc': 0.99232316, 'binary_precision': 0.8555467, 'binary_recall': 0.72875595, 'binary_specificity': 0.9957232, 'binary_f1_score': 0.7870778}
confusion matrix:
       0     1
0  42140   181
1    399  1072
---- Validation: 
scalar performance:
{'acc': 0.9841954, 'precision': 0.9150151, 'recall': 0.8290558, 'specificity': 0.8290558, 'f1': 0.86668146, 'auroc': 0.98179924, 'binary_precision': 0.84189725, 'binary_recall': 0.66251945, 'binary_specificity': 0.99559206, 'binary_f1_score': 0.7415144}
confusion matrix:
       0    1
0  18069   80
1    217  426
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9592522, 'precision': 0.7927695, 'recall': 0.5279853, 'specificity': 0.5279853, 'f1': 0.54220724, 'auroc': 0.9491994, 'binary_precision': 0.625, 'binary_recall': 0.057471264, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.10526315}
confusion matrix:
      0   1
0  5988   9
1   246  15
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261153_7.png
better model found
persisted
after epoch: 7,now: 2024-06-09 04:24:53.222967,epoch time: 0:40:37.819274,used: 4:43:13.579388,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_39_seed_0_21261153
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9856138, 'precision': 0.9131357, 'recall': 0.8532165, 'specificity': 0.8532165, 'f1': 0.8806492, 'auroc': 0.99195325, 'binary_precision': 0.836262, 'binary_recall': 0.7112772, 'binary_specificity': 0.99515593, 'binary_f1_score': 0.7687224}
confusion matrix:
       0     1
0  42115   205
1    425  1047
---- Validation: 
scalar performance:
{'acc': 0.9828118, 'precision': 0.89774394, 'recall': 0.82383907, 'specificity': 0.82383907, 'f1': 0.8567008, 'auroc': 0.9793518, 'binary_precision': 0.8076923, 'binary_recall': 0.65318817, 'binary_specificity': 0.99449, 'binary_f1_score': 0.72227}
confusion matrix:
       0    1
0  18049  100
1    223  420
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642058, 'precision': 0.8315482, 'recall': 0.6240189, 'specificity': 0.6240189, 'f1': 0.67618275, 'auroc': 0.93703985, 'binary_precision': 0.69473684, 'binary_recall': 0.25287357, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.37078652}
confusion matrix:
      0   1
0  5968  29
1   195  66
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261153_8.png
early stop counter: 1
val acc:0.9828118085861206, best validation acc: 0.9841954112052917, corresponding to test acc:                         0.9592521786689758 / 0.9797059893608093
after epoch: 8,now: 2024-06-09 05:04:59.743902,epoch time: 0:40:06.520935,used: 5:23:20.100323,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_39_seed_0_21261153
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9886052, 'precision': 0.9492934, 'recall': 0.86647743, 'specificity': 0.86647743, 'f1': 0.9033707, 'auroc': 0.99479604, 'binary_precision': 0.9077181, 'binary_recall': 0.73555404, 'binary_specificity': 0.9974008, 'binary_f1_score': 0.81261736}
confusion matrix:
       0     1
0  42211   110
1    389  1082
---- Validation: 
scalar performance:
{'acc': 0.98510003, 'precision': 0.9483134, 'recall': 0.8122728, 'specificity': 0.8122728, 'f1': 0.86725074, 'auroc': 0.98318654, 'binary_precision': 0.90970653, 'binary_recall': 0.62674963, 'binary_specificity': 0.997796, 'binary_f1_score': 0.74217314}
confusion matrix:
       0    1
0  18109   40
1    240  403
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9637264, 'precision': 0.884372, 'recall': 0.5852898, 'specificity': 0.5852898, 'f1': 0.6326518, 'auroc': 0.94411284, 'binary_precision': 0.8035714, 'binary_recall': 0.1724138, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.28391168}
confusion matrix:
      0   1
0  5986  11
1   216  45
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261153_9.png
better model found
persisted
after epoch: 9,now: 2024-06-09 05:45:06.121656,epoch time: 0:40:06.377754,used: 6:03:26.478077,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_39_seed_0_21261153
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98780596, 'precision': 0.9023653, 'recall': 0.9123819, 'specificity': 0.9123819, 'f1': 0.90730685, 'auroc': 0.9941205, 'binary_precision': 0.81059605, 'binary_recall': 0.83152175, 'binary_specificity': 0.99324197, 'binary_f1_score': 0.8209256}
confusion matrix:
       0     1
0  42034   286
1    248  1224
---- Validation: 
scalar performance:
{'acc': 0.98573864, 'precision': 0.8997886, 'recall': 0.8793583, 'specificity': 0.8793583, 'f1': 0.88928306, 'auroc': 0.9786822, 'binary_precision': 0.8078818, 'binary_recall': 0.7651633, 'binary_specificity': 0.99355334, 'binary_f1_score': 0.78594255}
confusion matrix:
       0    1
0  18032  117
1    151  492
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9688399, 'precision': 0.85336196, 'recall': 0.6960654, 'specificity': 0.6960654, 'f1': 0.7500153, 'auroc': 0.958458, 'binary_precision': 0.73239434, 'binary_recall': 0.39846742, 'binary_specificity': 0.9936635, 'binary_f1_score': 0.516129}
confusion matrix:
      0    1
0  5959   38
1   157  104
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261153_10.png
better model found
persisted
after epoch: 10,now: 2024-06-09 06:25:18.655468,epoch time: 0:40:12.533812,used: 6:43:39.011889,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_39_seed_0_21261153
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98458624, 'precision': 0.85285604, 'recall': 0.95333767, 'specificity': 0.95333767, 'f1': 0.8962282, 'auroc': 0.99424875, 'binary_precision': 0.7085296, 'binary_recall': 0.91983694, 'binary_specificity': 0.9868384, 'binary_f1_score': 0.800473}
confusion matrix:
       0     1
0  41763   557
1    118  1354
---- Validation: 
scalar performance:
{'acc': 0.98126864, 'precision': 0.8361909, 'recall': 0.9250477, 'specificity': 0.9250477, 'f1': 0.8749088, 'auroc': 0.98257285, 'binary_precision': 0.6772229, 'binary_recall': 0.86469674, 'binary_specificity': 0.98539865, 'binary_f1_score': 0.75956285}
confusion matrix:
       0    1
0  17884  265
1     87  556
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96756154, 'precision': 0.8363079, 'recall': 0.69173384, 'specificity': 0.69173384, 'f1': 0.7422321, 'auroc': 0.9551468, 'binary_precision': 0.69863015, 'binary_recall': 0.3908046, 'binary_specificity': 0.992663, 'binary_f1_score': 0.5012285}
confusion matrix:
      0    1
0  5953   44
1   159  102
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261153_11.png
early stop counter: 1
val acc:0.9812686443328857, best validation acc: 0.9857386350631714, corresponding to test acc:                         0.9688398838043213 / 0.9797059893608093
after epoch: 11,now: 2024-06-09 07:05:40.186818,epoch time: 0:40:21.531350,used: 7:24:00.543239,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_39_seed_0_21261153
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9912541, 'precision': 0.9301661, 'recall': 0.9360907, 'specificity': 0.9360907, 'f1': 0.93310654, 'auroc': 0.99589354, 'binary_precision': 0.86461127, 'binary_recall': 0.87695444, 'binary_specificity': 0.995227, 'binary_f1_score': 0.8707391}
confusion matrix:
       0     1
0  42119   202
1    181  1290
---- Validation: 
scalar performance:
{'acc': 0.98659, 'precision': 0.9167454, 'recall': 0.87154853, 'specificity': 0.87154853, 'f1': 0.89274645, 'auroc': 0.980616, 'binary_precision': 0.8423818, 'binary_recall': 0.748056, 'binary_specificity': 0.9950411, 'binary_f1_score': 0.7924217}
confusion matrix:
       0    1
0  18059   90
1    162  481
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9613295, 'precision': 0.80764055, 'recall': 0.5767098, 'specificity': 0.5767098, 'f1': 0.6166187, 'auroc': 0.9432769, 'binary_precision': 0.6507937, 'binary_recall': 0.15708812, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.25308642}
confusion matrix:
      0   1
0  5975  22
1   220  41
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261153_12.png
better model found
persisted
after epoch: 12,now: 2024-06-09 07:45:40.199227,epoch time: 0:40:00.012409,used: 8:04:00.555648,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_39_seed_0_21261153
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9914596, 'precision': 0.9617737, 'recall': 0.90214145, 'specificity': 0.90214145, 'f1': 0.92974627, 'auroc': 0.99701226, 'binary_precision': 0.93025076, 'binary_recall': 0.8063859, 'binary_specificity': 0.99789697, 'binary_f1_score': 0.863901}
confusion matrix:
       0     1
0  42231    89
1    285  1187
---- Validation: 
scalar performance:
{'acc': 0.9865368, 'precision': 0.9403442, 'recall': 0.84376895, 'specificity': 0.84376895, 'f1': 0.8856611, 'auroc': 0.9840934, 'binary_precision': 0.8915663, 'binary_recall': 0.6905132, 'binary_specificity': 0.99702466, 'binary_f1_score': 0.77826464}
confusion matrix:
       0    1
0  18095   54
1    199  444
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96612334, 'precision': 0.92199135, 'recall': 0.6085284, 'specificity': 0.6085284, 'f1': 0.666151, 'auroc': 0.95162, 'binary_precision': 0.8769231, 'binary_recall': 0.21839081, 'binary_specificity': 0.998666, 'binary_f1_score': 0.34969327}
confusion matrix:
      0   1
0  5989   8
1   204  57
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261153_13.png
early stop counter: 1
val acc:0.9865368008613586, best validation acc: 0.9865900278091431, corresponding to test acc:                         0.9613295197486877 / 0.9797059893608093
after epoch: 13,now: 2024-06-09 08:26:08.865593,epoch time: 0:40:28.666366,used: 8:44:29.222014,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_39_seed_0_21261153
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9899525, 'precision': 0.9077133, 'recall': 0.9466062, 'specificity': 0.9466062, 'f1': 0.92619884, 'auroc': 0.9961766, 'binary_precision': 0.8189122, 'binary_recall': 0.9001359, 'binary_specificity': 0.99307656, 'binary_f1_score': 0.85760516}
confusion matrix:
       0     1
0  42027   293
1    147  1325
---- Validation: 
scalar performance:
{'acc': 0.9862707, 'precision': 0.8956981, 'recall': 0.8968851, 'specificity': 0.8968851, 'f1': 0.8962906, 'auroc': 0.9841107, 'binary_precision': 0.79844964, 'binary_recall': 0.8009331, 'binary_specificity': 0.9928371, 'binary_f1_score': 0.7996894}
confusion matrix:
       0    1
0  18019  130
1    128  515
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9682007, 'precision': 0.8540387, 'recall': 0.6829056, 'specificity': 0.6829056, 'f1': 0.7386118, 'auroc': 0.9484707, 'binary_precision': 0.7348485, 'binary_recall': 0.3716475, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.4936387}
confusion matrix:
      0   1
0  5962  35
1   164  97
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261153_14.png
early stop counter: 2
val acc:0.9862707257270813, best validation acc: 0.9865900278091431, corresponding to test acc:                         0.9613295197486877 / 0.9797059893608093
after epoch: 14,now: 2024-06-09 09:06:40.288655,epoch time: 0:40:31.423062,used: 9:25:00.645076,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_39_seed_0_21261153
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9914368, 'precision': 0.94228387, 'recall': 0.9233897, 'specificity': 0.9233897, 'f1': 0.93261445, 'auroc': 0.9974662, 'binary_precision': 0.88975817, 'binary_recall': 0.8504419, 'binary_specificity': 0.99633753, 'binary_f1_score': 0.86965585}
confusion matrix:
       0     1
0  42166   155
1    220  1251
---- Validation: 
scalar performance:
{'acc': 0.98440826, 'precision': 0.9107383, 'recall': 0.8381666, 'specificity': 0.8381666, 'f1': 0.87065613, 'auroc': 0.97948074, 'binary_precision': 0.8326996, 'binary_recall': 0.68118197, 'binary_specificity': 0.9951512, 'binary_f1_score': 0.7493585}
confusion matrix:
       0    1
0  18061   88
1    205  438
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650048, 'precision': 0.87182015, 'recall': 0.61160946, 'specificity': 0.61160946, 'f1': 0.66608334, 'auroc': 0.9482142, 'binary_precision': 0.7763158, 'binary_recall': 0.22605364, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.35014838}
confusion matrix:
      0   1
0  5980  17
1   202  59
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261153_15.png
early stop counter: 3
val acc:0.9844082593917847, best validation acc: 0.9865900278091431, corresponding to test acc:                         0.9613295197486877 / 0.9797059893608093
after epoch: 15,now: 2024-06-09 09:46:55.483839,epoch time: 0:40:15.195184,used: 10:05:15.840260,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_39_seed_0_21261153
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99132264, 'precision': 0.94716144, 'recall': 0.91534364, 'specificity': 0.91534364, 'f1': 0.93062043, 'auroc': 0.99711144, 'binary_precision': 0.90007347, 'binary_recall': 0.83390063, 'binary_specificity': 0.9967866, 'binary_f1_score': 0.8657244}
confusion matrix:
       0     1
0  42187   136
1    244  1225
---- Validation: 
scalar performance:
{'acc': 0.98659, 'precision': 0.9264785, 'recall': 0.8595476, 'specificity': 0.8595476, 'f1': 0.88993967, 'auroc': 0.9810559, 'binary_precision': 0.86270875, 'binary_recall': 0.7231726, 'binary_specificity': 0.9959226, 'binary_f1_score': 0.78680205}
confusion matrix:
       0    1
0  18075   74
1    178  465
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9678811, 'precision': 0.9317586, 'recall': 0.6296012, 'specificity': 0.6296012, 'f1': 0.69352853, 'auroc': 0.9411167, 'binary_precision': 0.8947368, 'binary_recall': 0.2605364, 'binary_specificity': 0.998666, 'binary_f1_score': 0.40356085}
confusion matrix:
      0   1
0  5989   8
1   193  68
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261153_16.png
early stop counter: 4
val acc:0.9865900278091431, best validation acc: 0.9865900278091431, corresponding to test acc:                         0.9613295197486877 / 0.9797059893608093
after epoch: 16,now: 2024-06-09 10:26:47.036253,epoch time: 0:39:51.552414,used: 10:45:07.392674,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_39_seed_0_21261153
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.989884, 'precision': 0.89578503, 'recall': 0.9682095, 'specificity': 0.9682095, 'f1': 0.92869216, 'auroc': 0.9973869, 'binary_precision': 0.79349685, 'binary_recall': 0.9449728, 'binary_specificity': 0.99144614, 'binary_f1_score': 0.8626357}
confusion matrix:
       0     1
0  41958   362
1     81  1391
---- Validation: 
scalar performance:
{'acc': 0.9838229, 'precision': 0.8587878, 'recall': 0.92186975, 'specificity': 0.92186975, 'f1': 0.88753664, 'auroc': 0.98307323, 'binary_precision': 0.72273326, 'binary_recall': 0.85536546, 'binary_specificity': 0.988374, 'binary_f1_score': 0.78347576}
confusion matrix:
       0    1
0  17938  211
1     93  550
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9712368, 'precision': 0.8896842, 'recall': 0.7028131, 'specificity': 0.7028131, 'f1': 0.76414907, 'auroc': 0.95444787, 'binary_precision': 0.80451125, 'binary_recall': 0.4099617, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.54314715}
confusion matrix:
      0    1
0  5971   26
1   154  107
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261153_17.png
early stop counter: 5
val acc:0.9838228821754456, best validation acc: 0.9865900278091431, corresponding to test acc:                         0.9613295197486877 / 0.9797059893608093
after epoch: 17,now: 2024-06-09 11:06:34.879098,epoch time: 0:39:47.842845,used: 11:24:55.235519,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_39_seed_0_21261153
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9949762, 'precision': 0.97308743, 'recall': 0.94822186, 'specificity': 0.94822186, 'f1': 0.96029377, 'auroc': 0.9985218, 'binary_precision': 0.94971263, 'binary_recall': 0.8980978, 'binary_specificity': 0.9983459, 'binary_f1_score': 0.92318434}
confusion matrix:
       0     1
0  42250    70
1    150  1322
---- Validation: 
scalar performance:
{'acc': 0.98813325, 'precision': 0.92831165, 'recall': 0.8850984, 'specificity': 0.8850984, 'f1': 0.9054654, 'auroc': 0.985505, 'binary_precision': 0.8645833, 'binary_recall': 0.7744945, 'binary_specificity': 0.99570227, 'binary_f1_score': 0.8170631}
confusion matrix:
       0    1
0  18071   78
1    145  498
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96676254, 'precision': 0.8419775, 'recall': 0.66749656, 'specificity': 0.66749656, 'f1': 0.7219962, 'auroc': 0.9540955, 'binary_precision': 0.712, 'binary_recall': 0.34099618, 'binary_specificity': 0.993997, 'binary_f1_score': 0.46113992}
confusion matrix:
      0   1
0  5961  36
1   172  89
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261153_18.png
better model found
persisted
after epoch: 18,now: 2024-06-09 11:46:22.264055,epoch time: 0:39:47.384957,used: 12:04:42.620476,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_39_seed_0_21261153
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99113995, 'precision': 0.98679084, 'recall': 0.8747637, 'specificity': 0.8747637, 'f1': 0.922987, 'auroc': 0.99824154, 'binary_precision': 0.9822064, 'binary_recall': 0.75, 'binary_specificity': 0.9995274, 'binary_f1_score': 0.8505393}
confusion matrix:
       0     1
0  42300    20
1    368  1104
---- Validation: 
scalar performance:
{'acc': 0.98440826, 'precision': 0.9583107, 'recall': 0.7931633, 'specificity': 0.7931633, 'f1': 0.8563333, 'auroc': 0.9784913, 'binary_precision': 0.9310345, 'binary_recall': 0.58786935, 'binary_specificity': 0.9984572, 'binary_f1_score': 0.7206863}
confusion matrix:
       0    1
0  18121   28
1    265  378
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96772134, 'precision': 0.9478528, 'recall': 0.6221885, 'specificity': 0.6221885, 'f1': 0.6856512, 'auroc': 0.9422036, 'binary_precision': 0.92753625, 'binary_recall': 0.24521072, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.38787878}
confusion matrix:
      0   1
0  5992   5
1   197  64
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261153_19.png
early stop counter: 1
val acc:0.9844082593917847, best validation acc: 0.9881332516670227, corresponding to test acc:                         0.9667625427246094 / 0.9797059893608093
after epoch: 19,now: 2024-06-09 12:26:10.127594,epoch time: 0:39:47.863539,used: 12:44:30.484015,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_39_seed_0_21261153
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99406284, 'precision': 0.9656677, 'recall': 0.94119215, 'specificity': 0.94119215, 'f1': 0.95307446, 'auroc': 0.9983507, 'binary_precision': 0.9353448, 'binary_recall': 0.8845109, 'binary_specificity': 0.99787337, 'binary_f1_score': 0.9092179}
confusion matrix:
       0     1
0  42230    90
1    170  1302
---- Validation: 
scalar performance:
{'acc': 0.9868561, 'precision': 0.9298538, 'recall': 0.8604354, 'specificity': 0.8604354, 'f1': 0.8918578, 'auroc': 0.98030937, 'binary_precision': 0.869403, 'binary_recall': 0.7247278, 'binary_specificity': 0.99614304, 'binary_f1_score': 0.7905004}
confusion matrix:
       0    1
0  18079   70
1    177  466
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9686801, 'precision': 0.8773861, 'recall': 0.67032945, 'specificity': 0.67032945, 'f1': 0.7312892, 'auroc': 0.9484549, 'binary_precision': 0.7826087, 'binary_recall': 0.3448276, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.4787234}
confusion matrix:
      0   1
0  5972  25
1   171  90
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261153_20.png
early stop counter: 2
val acc:0.9868561029434204, best validation acc: 0.9881332516670227, corresponding to test acc:                         0.9667625427246094 / 0.9797059893608093
after epoch: 20,now: 2024-06-09 13:06:02.814544,epoch time: 0:39:52.686950,used: 13:24:23.170965,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_39_seed_0_21261153
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.993903, 'precision': 0.9793205, 'recall': 0.9247165, 'specificity': 0.9247165, 'f1': 0.95024836, 'auroc': 0.9985013, 'binary_precision': 0.9638183, 'binary_recall': 0.8505435, 'binary_specificity': 0.9988894, 'binary_f1_score': 0.90364486}
confusion matrix:
       0     1
0  42273    47
1    220  1252
---- Validation: 
scalar performance:
{'acc': 0.98659, 'precision': 0.94356465, 'recall': 0.8415463, 'specificity': 0.8415463, 'f1': 0.88543206, 'auroc': 0.9769647, 'binary_precision': 0.898167, 'binary_recall': 0.6858476, 'binary_specificity': 0.997245, 'binary_f1_score': 0.77777773}
confusion matrix:
       0    1
0  18099   50
1    202  441
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96324706, 'precision': 0.8970221, 'recall': 0.57404566, 'specificity': 0.57404566, 'f1': 0.6172033, 'auroc': 0.9278681, 'binary_precision': 0.82978725, 'binary_recall': 0.14942528, 'binary_specificity': 0.998666, 'binary_f1_score': 0.25324675}
confusion matrix:
      0   1
0  5989   8
1   222  39
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261153_21.png
early stop counter: 3
val acc:0.9865900278091431, best validation acc: 0.9881332516670227, corresponding to test acc:                         0.9667625427246094 / 0.9797059893608093
after epoch: 21,now: 2024-06-09 13:45:52.199848,epoch time: 0:39:49.385304,used: 14:04:12.556269,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_39_seed_0_21261153
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9940172, 'precision': 0.9495152, 'recall': 0.95952857, 'specificity': 0.95952857, 'f1': 0.9544624, 'auroc': 0.9981111, 'binary_precision': 0.9017264, 'binary_recall': 0.9225544, 'binary_specificity': 0.9965028, 'binary_f1_score': 0.9120215}
confusion matrix:
       0     1
0  42172   148
1    114  1358
---- Validation: 
scalar performance:
{'acc': 0.98781395, 'precision': 0.92622423, 'recall': 0.88193285, 'specificity': 0.88193285, 'f1': 0.9027677, 'auroc': 0.9805654, 'binary_precision': 0.8606272, 'binary_recall': 0.7682737, 'binary_specificity': 0.99559206, 'binary_f1_score': 0.81183237}
confusion matrix:
       0    1
0  18069   80
1    149  494
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9707574, 'precision': 0.88719, 'recall': 0.69706595, 'specificity': 0.69706595, 'f1': 0.7584382, 'auroc': 0.9515693, 'binary_precision': 0.8, 'binary_recall': 0.39846742, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.5319693}
confusion matrix:
      0    1
0  5971   26
1   157  104
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261153_22.png
early stop counter: 4
val acc:0.9878139495849609, best validation acc: 0.9881332516670227, corresponding to test acc:                         0.9667625427246094 / 0.9797059893608093
after epoch: 22,now: 2024-06-09 14:25:40.946502,epoch time: 0:39:48.746654,used: 14:44:01.302923,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_39_seed_0_21261153
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9956385, 'precision': 0.9786264, 'recall': 0.95315456, 'specificity': 0.95315456, 'f1': 0.9655162, 'auroc': 0.99901664, 'binary_precision': 0.9604601, 'binary_recall': 0.9076087, 'binary_specificity': 0.9987004, 'binary_f1_score': 0.9332868}
confusion matrix:
       0     1
0  42265    55
1    136  1336
---- Validation: 
scalar performance:
{'acc': 0.9872818, 'precision': 0.9297297, 'recall': 0.8681564, 'specificity': 0.8681564, 'f1': 0.89638054, 'auroc': 0.9814757, 'binary_precision': 0.8686131, 'binary_recall': 0.7402799, 'binary_specificity': 0.99603283, 'binary_f1_score': 0.7993283}
confusion matrix:
       0    1
0  18077   72
1    167  476
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9653244, 'precision': 0.85391486, 'recall': 0.6282672, 'specificity': 0.6282672, 'f1': 0.6837141, 'auroc': 0.9486721, 'binary_precision': 0.73913044, 'binary_recall': 0.2605364, 'binary_specificity': 0.995998, 'binary_f1_score': 0.38526914}
confusion matrix:
      0   1
0  5973  24
1   193  68
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261153_23.png
early stop counter: 5
val acc:0.9872817993164062, best validation acc: 0.9881332516670227, corresponding to test acc:                         0.9667625427246094 / 0.9797059893608093
after epoch: 23,now: 2024-06-09 15:05:28.855037,epoch time: 0:39:47.908535,used: 15:23:49.211458,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_39_seed_0_21261153
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99634635, 'precision': 0.97634023, 'recall': 0.96696305, 'specificity': 0.96696305, 'f1': 0.9716015, 'auroc': 0.9990728, 'binary_precision': 0.9549237, 'binary_recall': 0.93546194, 'binary_specificity': 0.9984641, 'binary_f1_score': 0.9450926}
confusion matrix:
       0     1
0  42255    65
1     95  1377
---- Validation: 
scalar performance:
{'acc': 0.987335, 'precision': 0.9351977, 'recall': 0.8629335, 'specificity': 0.8629335, 'f1': 0.895541, 'auroc': 0.9802034, 'binary_precision': 0.87992495, 'binary_recall': 0.7293935, 'binary_specificity': 0.9964736, 'binary_f1_score': 0.79761904}
confusion matrix:
       0    1
0  18085   64
1    174  469
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96596354, 'precision': 0.87381876, 'recall': 0.62676835, 'specificity': 0.62676835, 'f1': 0.6843319, 'auroc': 0.9417603, 'binary_precision': 0.7790698, 'binary_recall': 0.256705, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.38616717}
confusion matrix:
      0   1
0  5978  19
1   194  67
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261153_24.png
early stop counter: 6
val acc:0.9873350262641907, best validation acc: 0.9881332516670227, corresponding to test acc:                         0.9667625427246094 / 0.9797059893608093
after epoch: 24,now: 2024-06-09 15:45:14.850087,epoch time: 0:39:45.995050,used: 16:03:35.206508,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_39_seed_0_21261153
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9910486, 'precision': 0.906121, 'recall': 0.9717628, 'specificity': 0.9717628, 'f1': 0.93627393, 'auroc': 0.9985002, 'binary_precision': 0.81395346, 'binary_recall': 0.95108694, 'binary_specificity': 0.99243855, 'binary_f1_score': 0.8771929}
confusion matrix:
       0     1
0  42000   320
1     72  1400
---- Validation: 
scalar performance:
{'acc': 0.9833972, 'precision': 0.8587096, 'recall': 0.91114855, 'specificity': 0.91114855, 'f1': 0.88297385, 'auroc': 0.9819544, 'binary_precision': 0.7233468, 'binary_recall': 0.83359253, 'binary_specificity': 0.9887046, 'binary_f1_score': 0.7745665}
confusion matrix:
       0    1
0  17944  205
1    107  536
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96580374, 'precision': 0.848968, 'recall': 0.64134365, 'specificity': 0.64134365, 'f1': 0.6972388, 'auroc': 0.9482442, 'binary_precision': 0.7281553, 'binary_recall': 0.28735632, 'binary_specificity': 0.995331, 'binary_f1_score': 0.41208792}
confusion matrix:
      0   1
0  5969  28
1   186  75
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261153_25.png
early stop counter: 7
val acc:0.9833971858024597, best validation acc: 0.9881332516670227, corresponding to test acc:                         0.9667625427246094 / 0.9797059893608093
after epoch: 25,now: 2024-06-09 16:24:59.748971,epoch time: 0:39:44.898884,used: 16:43:20.105392,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_39_seed_0_21261153
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99404, 'precision': 0.987305, 'recall': 0.9194871, 'specificity': 0.9194871, 'f1': 0.9506774, 'auroc': 0.9983093, 'binary_precision': 0.98015875, 'binary_recall': 0.8395649, 'binary_specificity': 0.99940926, 'binary_f1_score': 0.9044307}
confusion matrix:
       0     1
0  42296    25
1    236  1235
---- Validation: 
scalar performance:
{'acc': 0.9838761, 'precision': 0.94429064, 'recall': 0.795138, 'specificity': 0.795138, 'f1': 0.853598, 'auroc': 0.96593654, 'binary_precision': 0.9028436, 'binary_recall': 0.592535, 'binary_specificity': 0.9977409, 'binary_f1_score': 0.715493}
confusion matrix:
       0    1
0  18108   41
1    262  381
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964845, 'precision': 0.86677647, 'recall': 0.6115261, 'specificity': 0.6115261, 'f1': 0.6655235, 'auroc': 0.9247039, 'binary_precision': 0.76623374, 'binary_recall': 0.22605364, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.3491124}
confusion matrix:
      0   1
0  5979  18
1   202  59
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261153_26.png
early stop counter: 8
val acc:0.98387610912323, best validation acc: 0.9881332516670227, corresponding to test acc:                         0.9667625427246094 / 0.9797059893608093
after epoch: 26,now: 2024-06-09 17:04:50.134934,epoch time: 0:39:50.385963,used: 17:23:10.491355,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_39_seed_0_21261153
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9949534, 'precision': 0.9452672, 'recall': 0.98165166, 'specificity': 0.98165166, 'f1': 0.9626873, 'auroc': 0.9993055, 'binary_precision': 0.8916719, 'binary_recall': 0.9673913, 'binary_specificity': 0.9959121, 'binary_f1_score': 0.9279896}
confusion matrix:
       0     1
0  42147   173
1     48  1424
---- Validation: 
scalar performance:
{'acc': 0.98632395, 'precision': 0.88848627, 'recall': 0.9111637, 'specificity': 0.9111637, 'f1': 0.8994749, 'auroc': 0.9844354, 'binary_precision': 0.78299123, 'binary_recall': 0.8304821, 'binary_specificity': 0.9918453, 'binary_f1_score': 0.8060377}
confusion matrix:
       0    1
0  18001  148
1    109  534
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9713966, 'precision': 0.8841697, 'recall': 0.7102258, 'specificity': 0.7102258, 'f1': 0.7694205, 'auroc': 0.96224934, 'binary_precision': 0.79285717, 'binary_recall': 0.42528737, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.553616}
confusion matrix:
      0    1
0  5968   29
1   150  111
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261153_27.png
early stop counter: 9
val acc:0.9863239526748657, best validation acc: 0.9881332516670227, corresponding to test acc:                         0.9667625427246094 / 0.9797059893608093
after epoch: 27,now: 2024-06-09 17:44:37.747786,epoch time: 0:39:47.612852,used: 18:02:58.104207,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_39_seed_0_21261153
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99511325, 'precision': 0.97451377, 'recall': 0.9489485, 'specificity': 0.9489485, 'f1': 0.96135056, 'auroc': 0.99885964, 'binary_precision': 0.952518, 'binary_recall': 0.8994565, 'binary_specificity': 0.99844044, 'binary_f1_score': 0.9252271}
confusion matrix:
       0     1
0  42254    66
1    148  1324
---- Validation: 
scalar performance:
{'acc': 0.98589826, 'precision': 0.9418289, 'recall': 0.83143747, 'specificity': 0.83143747, 'f1': 0.8781681, 'auroc': 0.9759711, 'binary_precision': 0.8953975, 'binary_recall': 0.66562986, 'binary_specificity': 0.997245, 'binary_f1_score': 0.7636039}
confusion matrix:
       0    1
0  18099   50
1    215  428
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96276766, 'precision': 0.83573604, 'recall': 0.5902865, 'specificity': 0.5902865, 'f1': 0.6363373, 'auroc': 0.9252912, 'binary_precision': 0.7058824, 'binary_recall': 0.18390805, 'binary_specificity': 0.996665, 'binary_f1_score': 0.2917933}
confusion matrix:
      0   1
0  5977  20
1   213  48
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261153_28.png
early stop counter: 10
val acc:0.9858982563018799, best validation acc: 0.9881332516670227, corresponding to test acc:                         0.9667625427246094 / 0.9797059893608093
after epoch: 28,now: 2024-06-09 18:24:11.979801,epoch time: 0:39:34.232015,used: 18:42:32.336222,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_39_seed_0_21261153
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99709994, 'precision': 0.9805429, 'recall': 0.97454894, 'specificity': 0.97454894, 'f1': 0.9775257, 'auroc': 0.9995401, 'binary_precision': 0.9628099, 'binary_recall': 0.9503739, 'binary_specificity': 0.99872404, 'binary_f1_score': 0.9565515}
confusion matrix:
       0     1
0  42267    54
1     73  1398
---- Validation: 
scalar performance:
{'acc': 0.98808, 'precision': 0.9344617, 'recall': 0.8768202, 'specificity': 0.8768202, 'f1': 0.9034327, 'auroc': 0.9802019, 'binary_precision': 0.87747747, 'binary_recall': 0.7573872, 'binary_specificity': 0.99625325, 'binary_f1_score': 0.8130217}
confusion matrix:
       0    1
0  18081   68
1    156  487
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96212846, 'precision': 0.8030792, 'recall': 0.6027793, 'specificity': 0.6027793, 'f1': 0.64876366, 'auroc': 0.92791796, 'binary_precision': 0.6395349, 'binary_recall': 0.21072797, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.3170029}
confusion matrix:
      0   1
0  5966  31
1   206  55
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261153_29.png
early stop counter: 11
val acc:0.9880800247192383, best validation acc: 0.9881332516670227, corresponding to test acc:                         0.9667625427246094 / 0.9797059893608093
after epoch: 29,now: 2024-06-09 19:04:04.347768,epoch time: 0:39:52.367967,used: 19:22:24.704189,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_39_seed_0_21261153
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9971684, 'precision': 0.97154135, 'recall': 0.98574847, 'specificity': 0.98574847, 'f1': 0.9785313, 'auroc': 0.99967575, 'binary_precision': 0.94400525, 'binary_recall': 0.97350544, 'binary_specificity': 0.9979915, 'binary_f1_score': 0.9585284}
confusion matrix:
       0     1
0  42235    85
1     39  1433
---- Validation: 
scalar performance:
{'acc': 0.98797363, 'precision': 0.9104631, 'recall': 0.90676737, 'specificity': 0.90676737, 'f1': 0.9086062, 'auroc': 0.9807341, 'binary_precision': 0.82731557, 'binary_recall': 0.81959563, 'binary_specificity': 0.99393904, 'binary_f1_score': 0.8234375}
confusion matrix:
       0    1
0  18039  110
1    116  527
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96612334, 'precision': 0.8385252, 'recall': 0.6580014, 'specificity': 0.6580014, 'f1': 0.7123183, 'auroc': 0.93929815, 'binary_precision': 0.7058824, 'binary_recall': 0.3218391, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.4421053}
confusion matrix:
      0   1
0  5962  35
1   177  84
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261153_30.png
early stop counter: 12
val acc:0.9879736304283142, best validation acc: 0.9881332516670227, corresponding to test acc:                         0.9667625427246094 / 0.9797059893608093
after epoch: 30,now: 2024-06-09 19:43:44.971054,epoch time: 0:39:40.623286,used: 20:02:05.327475,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_39_seed_0_21261153
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 20:02:05.327475 at 2024-06-09 19:43:44.971054
persisted model performance metric: 

scalar performance:
{'acc': 0.96628314, 'precision': 0.84696347, 'recall': 0.6525878, 'specificity': 0.6525878, 'f1': 0.70847005, 'auroc': 0.94877756, 'binary_precision': 0.72321427, 'binary_recall': 0.31034482, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.43431634}
confusion matrix:
      0   1
0  5966  31
1   180  81
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_new_new/rule_results/5.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_new_new/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_new_new/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1661 MiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |   1655 MiB |  15779 MiB |    976 TiB |    976 TiB |
|       from small pool |      6 MiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1661 MiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |   1655 MiB |  15779 MiB |    976 TiB |    976 TiB |
|       from small pool |      6 MiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1652 MiB |  15770 MiB |    986 TiB |    986 TiB |
|       from large pool |   1647 MiB |  15745 MiB |    974 TiB |    974 TiB |
|       from small pool |      5 MiB |     25 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  16730 MiB |  16730 MiB |  16730 MiB |      0 B   |
|       from large pool |  16702 MiB |  16702 MiB |  16702 MiB |      0 B   |
|       from small pool |     28 MiB |     28 MiB |     28 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 430672 KiB |    863 MiB | 413194 GiB | 413194 GiB |
|       from large pool | 410304 KiB |    862 MiB | 400318 GiB | 400318 GiB |
|       from small pool |  20368 KiB |     21 MiB |  12876 GiB |  12876 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2498    |    6357    |  152019 K  |  152017 K  |
|       from large pool |     247    |     989    |   62277 K  |   62277 K  |
|       from small pool |    2251    |    6108    |   89742 K  |   89739 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2498    |    6357    |  152019 K  |  152017 K  |
|       from large pool |     247    |     989    |   62277 K  |   62277 K  |
|       from small pool |    2251    |    6108    |   89742 K  |   89739 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     621    |     621    |     621    |       0    |
|       from large pool |     607    |     607    |     607    |       0    |
|       from small pool |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     145    |    2874    |   90068 K  |   90068 K  |
|       from large pool |     112    |     516    |   47247 K  |   47247 K  |
|       from small pool |      33    |    2762    |   42820 K  |   42820 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |  16640 KiB |  15779 MiB |    976 TiB |    976 TiB |
|       from small pool |      0 KiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |  16640 KiB |  15779 MiB |    976 TiB |    976 TiB |
|       from small pool |      0 KiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15770 MiB |    986 TiB |    986 TiB |
|       from large pool |  16640 KiB |  15745 MiB |    974 TiB |    974 TiB |
|       from small pool |      0 KiB |     25 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2082 MiB |  16730 MiB |  16730 MiB |  14648 MiB |
|       from large pool |   2056 MiB |  16702 MiB |  16702 MiB |  14646 MiB |
|       from small pool |     26 MiB |     28 MiB |     28 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    863 MiB | 413195 GiB | 413195 GiB |
|       from large pool |  24320 KiB |    862 MiB | 400319 GiB | 400319 GiB |
|       from small pool |      0 KiB |     25 MiB |  12876 GiB |  12876 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6357    |  152019 K  |  152019 K  |
|       from large pool |       2    |     989    |   62277 K  |   62277 K  |
|       from small pool |       0    |    6108    |   89742 K  |   89742 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6357    |  152019 K  |  152019 K  |
|       from large pool |       2    |     989    |   62277 K  |   62277 K  |
|       from small pool |       0    |    6108    |   89742 K  |   89742 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     115    |     621    |     621    |     506    |
|       from large pool |     102    |     607    |     607    |     505    |
|       from small pool |      13    |      14    |      14    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    2874    |   90069 K  |   90069 K  |
|       from large pool |       2    |     516    |   47247 K  |   47247 K  |
|       from small pool |       0    |    2762    |   42821 K  |   42821 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sun Jun  9 19:45:16 2024]
Finished job 0.
1 of 1 steps (100%) done
