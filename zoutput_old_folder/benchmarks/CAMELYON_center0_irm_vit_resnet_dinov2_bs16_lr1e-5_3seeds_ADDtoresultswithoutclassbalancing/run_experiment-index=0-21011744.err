Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jun  1 11:55:31 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/rule_results/0.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=0
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_12_07_04_seed_0_21011744

 Experiment start at: 2024-06-01 12:07:04.285587
before training, model accuracy: 0.6388623118400574
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96704876, 'precision': 0.747253, 'recall': 0.79377663, 'specificity': 0.79377663, 'f1': 0.76827914, 'auroc': 0.9529112, 'binary_precision': 0.50823396, 'binary_recall': 0.6080163, 'binary_specificity': 0.9795369, 'binary_f1_score': 0.55366534}
confusion matrix:
       0    1
0  41454  866
1    577  895
---- Validation: 
scalar performance:
{'acc': 0.965198, 'precision': 0.7385515, 'recall': 0.77271706, 'specificity': 0.77271706, 'f1': 0.75435376, 'auroc': 0.9559144, 'binary_precision': 0.4925575, 'binary_recall': 0.5660964, 'binary_specificity': 0.9793377, 'binary_f1_score': 0.52677274}
confusion matrix:
       0    1
0  17774  375
1    279  364
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9752317, 'precision': 0.90316355, 'recall': 0.75437045, 'specificity': 0.75437045, 'f1': 0.81037617, 'auroc': 0.9345343, 'binary_precision': 0.8271605, 'binary_recall': 0.51341, 'binary_specificity': 0.995331, 'binary_f1_score': 0.6335697}
confusion matrix:
      0    1
0  5969   28
1   127  134
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011744_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-01 12:38:30.558810,epoch time: 0:31:26.273223,used: 0:31:26.273223,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_12_07_04_seed_0_21011744
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96789366, 'precision': 0.8090845, 'recall': 0.5479915, 'specificity': 0.5479915, 'f1': 0.57682097, 'auroc': 0.9582113, 'binary_precision': 0.6486486, 'binary_recall': 0.097826086, 'binary_specificity': 0.9981569, 'binary_f1_score': 0.1700118}
confusion matrix:
       0    1
0  42242   78
1   1328  144
---- Validation: 
scalar performance:
{'acc': 0.9664219, 'precision': 0.8999414, 'recall': 0.5115814, 'specificity': 0.5115814, 'f1': 0.5141481, 'auroc': 0.95560575, 'binary_precision': 0.8333333, 'binary_recall': 0.02332815, 'binary_specificity': 0.9998347, 'binary_f1_score': 0.04538578}
confusion matrix:
       0   1
0  18146   3
1    628  15
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.98006725, 'recall': 0.5229885, 'specificity': 0.5229885, 'f1': 0.533787, 'auroc': 0.9453098, 'binary_precision': 1.0, 'binary_recall': 0.04597701, 'binary_specificity': 1.0, 'binary_f1_score': 0.08791209}
confusion matrix:
      0   1
0  5997   0
1   249  12
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011744_2.png
better model found
persisted
after epoch: 2,now: 2024-06-01 13:07:58.987573,epoch time: 0:29:28.428763,used: 1:00:54.701986,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_12_07_04_seed_0_21011744
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96999454, 'precision': 0.8024607, 'recall': 0.6265292, 'specificity': 0.6265292, 'f1': 0.6755375, 'auroc': 0.9575248, 'binary_precision': 0.63018245, 'binary_recall': 0.25832766, 'binary_specificity': 0.9947308, 'binary_f1_score': 0.36644167}
confusion matrix:
       0    1
0  42098  223
1   1091  380
---- Validation: 
scalar performance:
{'acc': 0.96588975, 'precision': 0.98294306, 'recall': 0.5015552, 'specificity': 0.5015552, 'f1': 0.4944243, 'auroc': 0.95221174, 'binary_precision': 1.0, 'binary_recall': 0.00311042, 'binary_specificity': 1.0, 'binary_f1_score': 0.0062015504}
confusion matrix:
       0  1
0  18149  0
1    641  2
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9613295, 'precision': 0.98060584, 'recall': 0.5363985, 'specificity': 0.5363985, 'f1': 0.5579683, 'auroc': 0.926672, 'binary_precision': 1.0, 'binary_recall': 0.07279693, 'binary_specificity': 1.0, 'binary_f1_score': 0.13571428}
confusion matrix:
      0   1
0  5997   0
1   242  19
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011744_3.png
early stop counter: 1
val acc:0.9658897519111633, best validation acc: 0.966421902179718, corresponding to test acc:                         0.960210919380188 / 0.9752317070960999
after epoch: 3,now: 2024-06-01 13:37:44.451608,epoch time: 0:29:45.464035,used: 1:30:40.166021,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_12_07_04_seed_0_21011744
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96684325, 'precision': 0.9120282, 'recall': 0.5081049, 'specificity': 0.5081049, 'f1': 0.50756633, 'auroc': 0.9606972, 'binary_precision': 0.85714287, 'binary_recall': 0.016304348, 'binary_specificity': 0.99990547, 'binary_f1_score': 0.031999998}
confusion matrix:
       0   1
0  42316   4
1   1448  24
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.9601676, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.94001997, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011744_4.png
early stop counter: 2
val acc:0.9657832980155945, best validation acc: 0.966421902179718, corresponding to test acc:                         0.960210919380188 / 0.9752317070960999
after epoch: 4,now: 2024-06-01 14:06:06.832611,epoch time: 0:28:22.381003,used: 1:59:02.547024,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_12_07_04_seed_0_21011744
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9755207, 'precision': 0.84575164, 'recall': 0.72635865, 'specificity': 0.72635865, 'f1': 0.77258384, 'auroc': 0.9677795, 'binary_precision': 0.710084, 'binary_recall': 0.45923913, 'binary_specificity': 0.99347824, 'binary_f1_score': 0.5577557}
confusion matrix:
       0    1
0  42044  276
1    796  676
---- Validation: 
scalar performance:
{'acc': 0.9738719, 'precision': 0.85359657, 'recall': 0.68570095, 'specificity': 0.68570095, 'f1': 0.7414991, 'auroc': 0.97080004, 'binary_precision': 0.7289157, 'binary_recall': 0.3763608, 'binary_specificity': 0.9950411, 'binary_f1_score': 0.49641028}
confusion matrix:
       0    1
0  18059   90
1    401  242
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.8965738, 'recall': 0.51899034, 'specificity': 0.51899034, 'f1': 0.5262976, 'auroc': 0.9513012, 'binary_precision': 0.8333333, 'binary_recall': 0.038314175, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.07326008}
confusion matrix:
      0   1
0  5995   2
1   251  10
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011744_5.png
better model found
persisted
after epoch: 5,now: 2024-06-01 14:34:29.518668,epoch time: 0:28:22.686057,used: 2:27:25.233081,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_12_07_04_seed_0_21011744
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9721867, 'precision': 0.77827394, 'recall': 0.8623346, 'specificity': 0.8623346, 'f1': 0.8141726, 'auroc': 0.96572816, 'binary_precision': 0.5655315, 'binary_recall': 0.7445652, 'binary_specificity': 0.98010397, 'binary_f1_score': 0.64281523}
confusion matrix:
       0     1
0  41478   842
1    376  1096
---- Validation: 
scalar performance:
{'acc': 0.97381866, 'precision': 0.79772794, 'recall': 0.82443357, 'specificity': 0.82443357, 'f1': 0.8104478, 'auroc': 0.96310353, 'binary_precision': 0.60739684, 'binary_recall': 0.66407466, 'binary_specificity': 0.98479253, 'binary_f1_score': 0.6344725}
confusion matrix:
       0    1
0  17873  276
1    216  427
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606903, 'precision': 0.7801516, 'recall': 0.58737034, 'specificity': 0.58737034, 'f1': 0.6281334, 'auroc': 0.9360215, 'binary_precision': 0.5949367, 'binary_recall': 0.18007663, 'binary_specificity': 0.994664, 'binary_f1_score': 0.2764706}
confusion matrix:
      0   1
0  5965  32
1   214  47
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011744_6.png
early stop counter: 1
val acc:0.9738186597824097, best validation acc: 0.9738718867301941, corresponding to test acc:                         0.9595717191696167 / 0.9752317070960999
after epoch: 6,now: 2024-06-01 15:03:05.834498,epoch time: 0:28:36.315830,used: 2:56:01.548911,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_12_07_04_seed_0_21011744
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97291744, 'precision': 0.8352766, 'recall': 0.6713494, 'specificity': 0.6713494, 'f1': 0.7247283, 'auroc': 0.96411306, 'binary_precision': 0.6928281, 'binary_recall': 0.34806255, 'binary_specificity': 0.99463624, 'binary_f1_score': 0.4633484}
confusion matrix:
       0    1
0  42094  227
1    959  512
---- Validation: 
scalar performance:
{'acc': 0.97333974, 'precision': 0.8833611, 'recall': 0.6486727, 'specificity': 0.6486727, 'f1': 0.71076125, 'auroc': 0.9663767, 'binary_precision': 0.7909836, 'binary_recall': 0.30015552, 'binary_specificity': 0.99718994, 'binary_f1_score': 0.43517476}
confusion matrix:
       0    1
0  18098   51
1    450  193
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.81262994, 'recall': 0.50374806, 'specificity': 0.50374806, 'f1': 0.49696523, 'auroc': 0.93888736, 'binary_precision': 0.6666667, 'binary_recall': 0.007662835, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.015151515}
confusion matrix:
      0  1
0  5996  1
1   259  2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011744_7.png
early stop counter: 2
val acc:0.9733397364616394, best validation acc: 0.9738718867301941, corresponding to test acc:                         0.9595717191696167 / 0.9752317070960999
after epoch: 7,now: 2024-06-01 15:31:33.420451,epoch time: 0:28:27.585953,used: 3:24:29.134864,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_12_07_04_seed_0_21011744
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9763884, 'precision': 0.8143617, 'recall': 0.8324879, 'specificity': 0.8324879, 'f1': 0.8231459, 'auroc': 0.97293496, 'binary_precision': 0.639923, 'binary_recall': 0.6782313, 'binary_specificity': 0.98674446, 'binary_f1_score': 0.65852046}
confusion matrix:
       0    1
0  41761  561
1    473  997
---- Validation: 
scalar performance:
{'acc': 0.9756279, 'precision': 0.8239845, 'recall': 0.78786755, 'specificity': 0.78786755, 'f1': 0.8047601, 'auroc': 0.9695382, 'binary_precision': 0.6625659, 'binary_recall': 0.58631414, 'binary_specificity': 0.9894209, 'binary_f1_score': 0.6221122}
confusion matrix:
       0    1
0  17957  192
1    266  377
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9705976, 'precision': 0.8654481, 'recall': 0.7153059, 'specificity': 0.7153059, 'f1': 0.7690983, 'auroc': 0.95509636, 'binary_precision': 0.7549669, 'binary_recall': 0.43678162, 'binary_specificity': 0.99383026, 'binary_f1_score': 0.5533981}
confusion matrix:
      0    1
0  5960   37
1   147  114
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011744_8.png
better model found
persisted
after epoch: 8,now: 2024-06-01 15:59:38.661261,epoch time: 0:28:05.240810,used: 3:52:34.375674,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_12_07_04_seed_0_21011744
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9744017, 'precision': 0.7929232, 'recall': 0.8636356, 'specificity': 0.8636356, 'f1': 0.82406485, 'auroc': 0.9715086, 'binary_precision': 0.59478545, 'binary_recall': 0.74489796, 'binary_specificity': 0.98237324, 'binary_f1_score': 0.6614316}
confusion matrix:
       0     1
0  41576   746
1    375  1095
---- Validation: 
scalar performance:
{'acc': 0.976639, 'precision': 0.82124776, 'recall': 0.830394, 'specificity': 0.830394, 'f1': 0.82575047, 'auroc': 0.9716192, 'binary_precision': 0.65407854, 'binary_recall': 0.6734059, 'binary_specificity': 0.98738223, 'binary_f1_score': 0.6636016}
confusion matrix:
       0    1
0  17920  229
1    210  433
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95733464, 'precision': 0.6860398, 'recall': 0.52515244, 'specificity': 0.52515244, 'f1': 0.5365338, 'auroc': 0.94317514, 'binary_precision': 0.4117647, 'binary_recall': 0.053639848, 'binary_specificity': 0.996665, 'binary_f1_score': 0.094915256}
confusion matrix:
      0   1
0  5977  20
1   247  14
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011744_9.png
better model found
persisted
after epoch: 9,now: 2024-06-01 16:27:48.184932,epoch time: 0:28:09.523671,used: 4:20:43.899345,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_12_07_04_seed_0_21011744
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9771419, 'precision': 0.89719635, 'recall': 0.70555884, 'specificity': 0.70555884, 'f1': 0.76878786, 'auroc': 0.9755875, 'binary_precision': 0.8144192, 'binary_recall': 0.4144022, 'binary_specificity': 0.9967155, 'binary_f1_score': 0.54930216}
confusion matrix:
       0    1
0  42181  139
1    862  610
---- Validation: 
scalar performance:
{'acc': 0.97318006, 'precision': 0.93551886, 'recall': 0.6215881, 'specificity': 0.6215881, 'f1': 0.68507737, 'auroc': 0.9731984, 'binary_precision': 0.8971428, 'binary_recall': 0.24416797, 'binary_specificity': 0.99900824, 'binary_f1_score': 0.38386306}
confusion matrix:
       0    1
0  18131   18
1    486  157
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581336, 'precision': 0.7103529, 'recall': 0.51091063, 'specificity': 0.51091063, 'f1': 0.511197, 'auroc': 0.9573729, 'binary_precision': 0.46153846, 'binary_recall': 0.022988506, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.04379562}
confusion matrix:
      0  1
0  5990  7
1   255  6
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011744_10.png
early stop counter: 1
val acc:0.9731800556182861, best validation acc: 0.9766389727592468, corresponding to test acc:                         0.9573346376419067 / 0.9752317070960999
after epoch: 10,now: 2024-06-01 16:55:58.260414,epoch time: 0:28:10.075482,used: 4:48:53.974827,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_12_07_04_seed_0_21011744
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9753608, 'precision': 0.9483601, 'recall': 0.6456226, 'specificity': 0.6456226, 'f1': 0.7154646, 'auroc': 0.9787706, 'binary_precision': 0.9207709, 'binary_recall': 0.29211956, 'binary_specificity': 0.9991257, 'binary_f1_score': 0.44352764}
confusion matrix:
       0    1
0  42283   37
1   1042  430
---- Validation: 
scalar performance:
{'acc': 0.9713176, 'precision': 0.9598683, 'recall': 0.58537126, 'specificity': 0.58537126, 'f1': 0.6376091, 'auroc': 0.97534645, 'binary_precision': 0.94827586, 'binary_recall': 0.1710731, 'binary_specificity': 0.99966943, 'binary_f1_score': 0.28985506}
confusion matrix:
       0    1
0  18143    6
1    533  110
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581336, 'precision': 0.47914335, 'recall': 0.4999166, 'specificity': 0.4999166, 'f1': 0.48930964, 'auroc': 0.9567966, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5996  1
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011744_11.png
early stop counter: 2
val acc:0.9713175892829895, best validation acc: 0.9766389727592468, corresponding to test acc:                         0.9573346376419067 / 0.9752317070960999
after epoch: 11,now: 2024-06-01 17:24:22.976553,epoch time: 0:28:24.716139,used: 5:17:18.690966,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_12_07_04_seed_0_21011744
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.97755295, 'precision': 0.82408786, 'recall': 0.8374648, 'specificity': 0.8374648, 'f1': 0.83062816, 'auroc': 0.9740252, 'binary_precision': 0.65906125, 'binary_recall': 0.68728757, 'binary_specificity': 0.98764205, 'binary_f1_score': 0.67287856}
confusion matrix:
       0     1
0  41798   523
1    460  1011
---- Validation: 
scalar performance:
{'acc': 0.9801511, 'precision': 0.8667621, 'recall': 0.814211, 'specificity': 0.814211, 'f1': 0.83828425, 'auroc': 0.9748106, 'binary_precision': 0.74635035, 'binary_recall': 0.63608086, 'binary_specificity': 0.99234116, 'binary_f1_score': 0.68681777}
confusion matrix:
       0    1
0  18010  139
1    234  409
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590924, 'precision': 0.7472104, 'recall': 0.5828719, 'specificity': 0.5828719, 'f1': 0.61954015, 'auroc': 0.94773567, 'binary_precision': 0.5294118, 'binary_recall': 0.1724138, 'binary_specificity': 0.99333, 'binary_f1_score': 0.2601156}
confusion matrix:
      0   1
0  5957  40
1   216  45
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011744_12.png
better model found
persisted
after epoch: 12,now: 2024-06-01 17:52:35.564499,epoch time: 0:28:12.587946,used: 5:45:31.278912,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_12_07_04_seed_0_21011744
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9794255, 'precision': 0.8555608, 'recall': 0.8089055, 'specificity': 0.8089055, 'f1': 0.8304539, 'auroc': 0.9760736, 'binary_precision': 0.7240566, 'binary_recall': 0.6261047, 'binary_specificity': 0.99170625, 'binary_f1_score': 0.67152756}
confusion matrix:
       0    1
0  41970  351
1    550  921
---- Validation: 
scalar performance:
{'acc': 0.9777033, 'precision': 0.89687705, 'recall': 0.72443724, 'specificity': 0.72443724, 'f1': 0.7849827, 'auroc': 0.97333014, 'binary_precision': 0.81284916, 'binary_recall': 0.4525661, 'binary_specificity': 0.9963083, 'binary_f1_score': 0.58141863}
confusion matrix:
       0    1
0  18082   67
1    352  291
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.79723823, 'recall': 0.53548133, 'specificity': 0.53548133, 'f1': 0.55494446, 'auroc': 0.9574716, 'binary_precision': 0.6333333, 'binary_recall': 0.07279693, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.1305842}
confusion matrix:
      0   1
0  5986  11
1   242  19
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011744_13.png
early stop counter: 1
val acc:0.9777032732963562, best validation acc: 0.9801511168479919, corresponding to test acc:                         0.959092378616333 / 0.9752317070960999
after epoch: 13,now: 2024-06-01 18:20:39.604443,epoch time: 0:28:04.039944,used: 6:13:35.318856,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_12_07_04_seed_0_21011744
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.979631, 'precision': 0.8816807, 'recall': 0.7724185, 'specificity': 0.7724185, 'f1': 0.8172096, 'auroc': 0.9802442, 'binary_precision': 0.77884614, 'binary_recall': 0.55027175, 'binary_specificity': 0.9945652, 'binary_f1_score': 0.6449045}
confusion matrix:
       0    1
0  42090  230
1    662  810
---- Validation: 
scalar performance:
{'acc': 0.97530866, 'precision': 0.8731253, 'recall': 0.6976956, 'specificity': 0.6976956, 'f1': 0.7564434, 'auroc': 0.97629386, 'binary_precision': 0.7671642, 'binary_recall': 0.39968896, 'binary_specificity': 0.99570227, 'binary_f1_score': 0.52556235}
confusion matrix:
       0    1
0  18071   78
1    386  257
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9651646, 'precision': 0.8986722, 'recall': 0.60253114, 'specificity': 0.60253114, 'f1': 0.6567024, 'auroc': 0.96407336, 'binary_precision': 0.83076924, 'binary_recall': 0.20689656, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.33128834}
confusion matrix:
      0   1
0  5986  11
1   207  54
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011744_14.png
early stop counter: 2
val acc:0.9753086566925049, best validation acc: 0.9801511168479919, corresponding to test acc:                         0.959092378616333 / 0.9752317070960999
after epoch: 14,now: 2024-06-01 18:48:49.903160,epoch time: 0:28:10.298717,used: 6:41:45.617573,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_12_07_04_seed_0_21011744
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9755435, 'precision': 0.92906696, 'recall': 0.65607023, 'specificity': 0.65607023, 'f1': 0.7250531, 'auroc': 0.97804403, 'binary_precision': 0.88145316, 'binary_recall': 0.31360543, 'binary_specificity': 0.99853504, 'binary_f1_score': 0.46261916}
confusion matrix:
       0    1
0  42260   62
1   1009  461
---- Validation: 
scalar performance:
{'acc': 0.97381866, 'precision': 0.95041084, 'recall': 0.6271691, 'specificity': 0.6271691, 'f1': 0.6933087, 'auroc': 0.97326934, 'binary_precision': 0.92655367, 'binary_recall': 0.25505444, 'binary_specificity': 0.99928373, 'binary_f1_score': 0.4}
confusion matrix:
       0    1
0  18136   13
1    479  164
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589326, 'precision': 0.8296735, 'recall': 0.5131598, 'specificity': 0.5131598, 'f1': 0.51533616, 'auroc': 0.94995403, 'binary_precision': 0.7, 'binary_recall': 0.026819924, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.05166052}
confusion matrix:
      0  1
0  5994  3
1   254  7
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011744_15.png
early stop counter: 3
val acc:0.9738186597824097, best validation acc: 0.9801511168479919, corresponding to test acc:                         0.959092378616333 / 0.9752317070960999
after epoch: 15,now: 2024-06-01 19:17:11.941785,epoch time: 0:28:22.038625,used: 7:10:07.656198,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_12_07_04_seed_0_21011744
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9826452, 'precision': 0.88555646, 'recall': 0.83168125, 'specificity': 0.83168125, 'f1': 0.85642934, 'auroc': 0.9819189, 'binary_precision': 0.78253967, 'binary_recall': 0.66983694, 'binary_specificity': 0.9935255, 'binary_f1_score': 0.7218155}
confusion matrix:
       0    1
0  42046  274
1    486  986
---- Validation: 
scalar performance:
{'acc': 0.9819604, 'precision': 0.9161061, 'recall': 0.78664565, 'specificity': 0.78664565, 'f1': 0.83855724, 'auroc': 0.97713524, 'binary_precision': 0.84703195, 'binary_recall': 0.5769829, 'binary_specificity': 0.9963083, 'binary_f1_score': 0.6864015}
confusion matrix:
       0    1
0  18082   67
1    272  371
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589326, 'precision': 0.7504586, 'recall': 0.55163884, 'specificity': 0.55163884, 'f1': 0.5789267, 'auroc': 0.9528985, 'binary_precision': 0.53846157, 'binary_recall': 0.107279696, 'binary_specificity': 0.995998, 'binary_f1_score': 0.17891374}
confusion matrix:
      0   1
0  5973  24
1   233  28
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011744_16.png
better model found
persisted
after epoch: 16,now: 2024-06-01 19:45:42.150594,epoch time: 0:28:30.208809,used: 7:38:37.865007,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_12_07_04_seed_0_21011744
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9795168, 'precision': 0.835541, 'recall': 0.86210334, 'specificity': 0.86210334, 'f1': 0.8482685, 'auroc': 0.9796884, 'binary_precision': 0.6802764, 'binary_recall': 0.73623383, 'binary_specificity': 0.98797286, 'binary_f1_score': 0.70714986}
confusion matrix:
       0     1
0  41812   509
1    388  1083
---- Validation: 
scalar performance:
{'acc': 0.9819604, 'precision': 0.89037037, 'recall': 0.8166478, 'specificity': 0.8166478, 'f1': 0.8493515, 'auroc': 0.97837996, 'binary_precision': 0.7934363, 'binary_recall': 0.63919127, 'binary_specificity': 0.9941044, 'binary_f1_score': 0.7080103}
confusion matrix:
       0    1
0  18042  107
1    232  411
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614893, 'precision': 0.8564249, 'recall': 0.5566375, 'specificity': 0.5566375, 'f1': 0.5898028, 'auroc': 0.95078766, 'binary_precision': 0.75, 'binary_recall': 0.11494253, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.19933555}
confusion matrix:
      0   1
0  5987  10
1   231  30
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011744_17.png
early stop counter: 1
val acc:0.9819604158401489, best validation acc: 0.9819604158401489, corresponding to test acc:                         0.9589325785636902 / 0.9752317070960999
after epoch: 17,now: 2024-06-01 20:14:05.824519,epoch time: 0:28:23.673925,used: 8:07:01.538932,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_12_07_04_seed_0_21011744
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9782152, 'precision': 0.8186994, 'recall': 0.8838138, 'specificity': 0.8838138, 'f1': 0.84793454, 'auroc': 0.98226523, 'binary_precision': 0.6450168, 'binary_recall': 0.7826087, 'binary_specificity': 0.9850189, 'binary_f1_score': 0.70718235}
confusion matrix:
       0     1
0  41686   634
1    320  1152
---- Validation: 
scalar performance:
{'acc': 0.9799915, 'precision': 0.84952784, 'recall': 0.8463807, 'specificity': 0.8463807, 'f1': 0.8479465, 'auroc': 0.9801903, 'binary_precision': 0.70957613, 'binary_recall': 0.7029549, 'binary_specificity': 0.9898066, 'binary_f1_score': 0.70625}
confusion matrix:
       0    1
0  17964  185
1    191  452
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96212846, 'precision': 0.90783304, 'recall': 0.5551387, 'specificity': 0.5551387, 'f1': 0.5886086, 'auroc': 0.95765364, 'binary_precision': 0.85294116, 'binary_recall': 0.11111111, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.19661018}
confusion matrix:
      0   1
0  5992   5
1   232  29
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011744_18.png
early stop counter: 2
val acc:0.9799914956092834, best validation acc: 0.9819604158401489, corresponding to test acc:                         0.9589325785636902 / 0.9752317070960999
after epoch: 18,now: 2024-06-01 20:42:18.608134,epoch time: 0:28:12.783615,used: 8:35:14.322547,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_12_07_04_seed_0_21011744
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9803389, 'precision': 0.91046035, 'recall': 0.75573605, 'specificity': 0.75573605, 'f1': 0.81383693, 'auroc': 0.98279285, 'binary_precision': 0.83756906, 'binary_recall': 0.5149456, 'binary_specificity': 0.9965265, 'binary_f1_score': 0.63777864}
confusion matrix:
       0    1
0  42173  147
1    714  758
---- Validation: 
scalar performance:
{'acc': 0.9804172, 'precision': 0.9391271, 'recall': 0.74084336, 'specificity': 0.74084336, 'f1': 0.80911326, 'auroc': 0.97697437, 'binary_precision': 0.8962536, 'binary_recall': 0.4836703, 'binary_specificity': 0.9980164, 'binary_f1_score': 0.62828285}
confusion matrix:
       0    1
0  18113   36
1    332  311
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.8047465, 'recall': 0.5747941, 'specificity': 0.5747941, 'f1': 0.61387426, 'auroc': 0.9527837, 'binary_precision': 0.6451613, 'binary_recall': 0.1532567, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.247678}
confusion matrix:
      0   1
0  5975  22
1   221  40
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011744_19.png
early stop counter: 3
val acc:0.9804171919822693, best validation acc: 0.9819604158401489, corresponding to test acc:                         0.9589325785636902 / 0.9752317070960999
after epoch: 19,now: 2024-06-01 21:10:29.176866,epoch time: 0:28:10.568732,used: 9:03:24.891279,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_12_07_04_seed_0_21011744
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.977964, 'precision': 0.8979622, 'recall': 0.7210657, 'specificity': 0.7210657, 'f1': 0.78244233, 'auroc': 0.9844678, 'binary_precision': 0.81490684, 'binary_recall': 0.4456522, 'binary_specificity': 0.9964792, 'binary_f1_score': 0.57619673}
confusion matrix:
       0    1
0  42171  149
1    816  656
---- Validation: 
scalar performance:
{'acc': 0.9742976, 'precision': 0.90892375, 'recall': 0.65216887, 'specificity': 0.65216887, 'f1': 0.7180503, 'auroc': 0.9735657, 'binary_precision': 0.8418803, 'binary_recall': 0.30637637, 'binary_specificity': 0.99796134, 'binary_f1_score': 0.44925886}
confusion matrix:
       0    1
0  18112   37
1    446  197
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.74451685, 'recall': 0.5165744, 'specificity': 0.5165744, 'f1': 0.52175146, 'auroc': 0.95672596, 'binary_precision': 0.5294118, 'binary_recall': 0.03448276, 'binary_specificity': 0.998666, 'binary_f1_score': 0.0647482}
confusion matrix:
      0  1
0  5989  8
1   252  9
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011744_20.png
early stop counter: 4
val acc:0.9742975831031799, best validation acc: 0.9819604158401489, corresponding to test acc:                         0.9589325785636902 / 0.9752317070960999
after epoch: 20,now: 2024-06-01 21:38:49.681890,epoch time: 0:28:20.505024,used: 9:31:45.396303,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_12_07_04_seed_0_21011744
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9769593, 'precision': 0.8424415, 'recall': 0.7707083, 'specificity': 0.7707083, 'f1': 0.80201757, 'auroc': 0.98126435, 'binary_precision': 0.7004329, 'binary_recall': 0.5495924, 'binary_specificity': 0.9918242, 'binary_f1_score': 0.61591166}
confusion matrix:
       0    1
0  41974  346
1    663  809
---- Validation: 
scalar performance:
{'acc': 0.97557473, 'precision': 0.84552735, 'recall': 0.7390864, 'specificity': 0.7390864, 'f1': 0.7818011, 'auroc': 0.9736556, 'binary_precision': 0.7090909, 'binary_recall': 0.4852255, 'binary_specificity': 0.9929473, 'binary_f1_score': 0.57617724}
confusion matrix:
       0    1
0  18021  128
1    331  312
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96244806, 'precision': 0.81642395, 'recall': 0.59744906, 'specificity': 0.59744906, 'f1': 0.643743, 'auroc': 0.95874137, 'binary_precision': 0.6666667, 'binary_recall': 0.19923371, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.30678466}
confusion matrix:
      0   1
0  5971  26
1   209  52
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011744_21.png
early stop counter: 5
val acc:0.9755747318267822, best validation acc: 0.9819604158401489, corresponding to test acc:                         0.9589325785636902 / 0.9752317070960999
after epoch: 21,now: 2024-06-01 22:07:31.229326,epoch time: 0:28:41.547436,used: 10:00:26.943739,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_12_07_04_seed_0_21011744
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9838783, 'precision': 0.8819332, 'recall': 0.8643599, 'specificity': 0.8643599, 'f1': 0.87292206, 'auroc': 0.98440975, 'binary_precision': 0.77301925, 'binary_recall': 0.73623383, 'binary_specificity': 0.992486, 'binary_f1_score': 0.7541783}
confusion matrix:
       0     1
0  42003   318
1    388  1083
---- Validation: 
scalar performance:
{'acc': 0.9822265, 'precision': 0.90845984, 'recall': 0.7995343, 'specificity': 0.7995343, 'f1': 0.84497094, 'auroc': 0.97732, 'binary_precision': 0.8308351, 'binary_recall': 0.60342145, 'binary_specificity': 0.99564713, 'binary_f1_score': 0.69909906}
confusion matrix:
       0    1
0  18070   79
1    255  388
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.7494137, 'recall': 0.5258194, 'specificity': 0.5258194, 'f1': 0.5381909, 'auroc': 0.93954927, 'binary_precision': 0.53846157, 'binary_recall': 0.053639848, 'binary_specificity': 0.997999, 'binary_f1_score': 0.09756098}
confusion matrix:
      0   1
0  5985  12
1   247  14
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011744_22.png
better model found
persisted
after epoch: 22,now: 2024-06-01 22:36:02.563165,epoch time: 0:28:31.333839,used: 10:28:58.277578,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_12_07_04_seed_0_21011744
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.98090976, 'precision': 0.8636228, 'recall': 0.8301276, 'specificity': 0.8301276, 'f1': 0.84599686, 'auroc': 0.9822284, 'binary_precision': 0.7387387, 'binary_recall': 0.66847825, 'binary_specificity': 0.99177694, 'binary_f1_score': 0.70185447}
confusion matrix:
       0    1
0  41972  348
1    488  984
---- Validation: 
scalar performance:
{'acc': 0.97988504, 'precision': 0.8751282, 'recall': 0.7945719, 'specificity': 0.7945719, 'f1': 0.8296036, 'auroc': 0.98038733, 'binary_precision': 0.76447105, 'binary_recall': 0.5956454, 'binary_specificity': 0.99349827, 'binary_f1_score': 0.6695804}
confusion matrix:
       0    1
0  18031  118
1    260  383
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9576542, 'precision': 0.6882018, 'recall': 0.5179899, 'specificity': 0.5179899, 'f1': 0.5242546, 'auroc': 0.91797686, 'binary_precision': 0.41666666, 'binary_recall': 0.038314175, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.07017544}
confusion matrix:
      0   1
0  5983  14
1   251  10
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011744_23.png
early stop counter: 1
val acc:0.9798850417137146, best validation acc: 0.9822264909744263, corresponding to test acc:                         0.9586129784584045 / 0.9752317070960999
after epoch: 23,now: 2024-06-01 23:04:51.462732,epoch time: 0:28:48.899567,used: 10:57:47.177145,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_12_07_04_seed_0_21011744
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9826224, 'precision': 0.8561877, 'recall': 0.8899573, 'specificity': 0.8899573, 'f1': 0.87223804, 'auroc': 0.98728704, 'binary_precision': 0.7196782, 'binary_recall': 0.7906186, 'binary_specificity': 0.9892961, 'binary_f1_score': 0.75348234}
confusion matrix:
       0     1
0  41868   453
1    308  1163
---- Validation: 
scalar performance:
{'acc': 0.9841954, 'precision': 0.89227474, 'recall': 0.859808, 'specificity': 0.859808, 'f1': 0.8752814, 'auroc': 0.9789108, 'binary_precision': 0.7942177, 'binary_recall': 0.7262831, 'binary_specificity': 0.993333, 'binary_f1_score': 0.75873274}
confusion matrix:
       0    1
0  18028  121
1    176  467
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.7469975, 'recall': 0.5294841, 'specificity': 0.5294841, 'f1': 0.5443898, 'auroc': 0.94439, 'binary_precision': 0.53333336, 'binary_recall': 0.06130268, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.10996564}
confusion matrix:
      0   1
0  5983  14
1   245  16
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011744_24.png
better model found
persisted
after epoch: 24,now: 2024-06-01 23:33:29.109941,epoch time: 0:28:37.647209,used: 11:26:24.824354,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_12_07_04_seed_0_21011744
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.98070425, 'precision': 0.89595073, 'recall': 0.7775638, 'specificity': 0.7775638, 'f1': 0.8255602, 'auroc': 0.98556036, 'binary_precision': 0.8070519, 'binary_recall': 0.5597826, 'binary_specificity': 0.995345, 'binary_f1_score': 0.661051}
confusion matrix:
       0    1
0  42123  197
1    648  824
---- Validation: 
scalar performance:
{'acc': 0.9769583, 'precision': 0.90283775, 'recall': 0.70530015, 'specificity': 0.70530015, 'f1': 0.76973546, 'auroc': 0.9788792, 'binary_precision': 0.82608694, 'binary_recall': 0.41368586, 'binary_specificity': 0.99691445, 'binary_f1_score': 0.55129534}
confusion matrix:
       0    1
0  18093   56
1    377  266
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.971876, 'precision': 0.8907025, 'recall': 0.7123083, 'specificity': 0.7123083, 'f1': 0.7727369, 'auroc': 0.9524649, 'binary_precision': 0.8057554, 'binary_recall': 0.42911878, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.56}
confusion matrix:
      0    1
0  5970   27
1   149  112
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011744_25.png
early stop counter: 1
val acc:0.9769582748413086, best validation acc: 0.9841954112052917, corresponding to test acc:                         0.9586129784584045 / 0.9752317070960999
after epoch: 25,now: 2024-06-02 00:02:05.565566,epoch time: 0:28:36.455625,used: 11:55:01.279979,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_12_07_04_seed_0_21011744
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.98232555, 'precision': 0.8748884, 'recall': 0.8423352, 'specificity': 0.8423352, 'f1': 0.8578104, 'auroc': 0.9857185, 'binary_precision': 0.76044774, 'binary_recall': 0.69225544, 'binary_specificity': 0.99241495, 'binary_f1_score': 0.72475106}
confusion matrix:
       0     1
0  41999   321
1    453  1019
---- Validation: 
scalar performance:
{'acc': 0.98169434, 'precision': 0.9249023, 'recall': 0.7737569, 'specificity': 0.7737569, 'f1': 0.83179367, 'auroc': 0.9773624, 'binary_precision': 0.86552566, 'binary_recall': 0.5505443, 'binary_specificity': 0.9969695, 'binary_f1_score': 0.6730038}
confusion matrix:
       0    1
0  18094   55
1    289  354
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9651646, 'precision': 0.86051404, 'recall': 0.6208545, 'specificity': 0.6208545, 'f1': 0.67601466, 'auroc': 0.9457585, 'binary_precision': 0.7529412, 'binary_recall': 0.24521072, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.3699422}
confusion matrix:
      0   1
0  5976  21
1   197  64
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011744_26.png
early stop counter: 2
val acc:0.9816943407058716, best validation acc: 0.9841954112052917, corresponding to test acc:                         0.9586129784584045 / 0.9752317070960999
after epoch: 26,now: 2024-06-02 00:30:40.757801,epoch time: 0:28:35.192235,used: 12:23:36.472214,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_12_07_04_seed_0_21011744
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9849516, 'precision': 0.9140459, 'recall': 0.83943176, 'specificity': 0.83943176, 'f1': 0.87275755, 'auroc': 0.989259, 'binary_precision': 0.83903253, 'binary_recall': 0.68342394, 'binary_specificity': 0.9954395, 'binary_f1_score': 0.753276}
confusion matrix:
       0     1
0  42127   193
1    466  1006
---- Validation: 
scalar performance:
{'acc': 0.98142827, 'precision': 0.9478363, 'recall': 0.75186753, 'specificity': 0.75186753, 'f1': 0.82055557, 'auroc': 0.9759048, 'binary_precision': 0.91292137, 'binary_recall': 0.5054432, 'binary_specificity': 0.9982919, 'binary_f1_score': 0.6506507}
confusion matrix:
       0    1
0  18118   31
1    318  325
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.78634953, 'recall': 0.5409784, 'specificity': 0.5409784, 'f1': 0.56372136, 'auroc': 0.9556809, 'binary_precision': 0.6111111, 'binary_recall': 0.08429119, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.14814816}
confusion matrix:
      0   1
0  5983  14
1   239  22
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011744_27.png
early stop counter: 3
val acc:0.9814282655715942, best validation acc: 0.9841954112052917, corresponding to test acc:                         0.9586129784584045 / 0.9752317070960999
after epoch: 27,now: 2024-06-02 00:58:55.654878,epoch time: 0:28:14.897077,used: 12:51:51.369291,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_12_07_04_seed_0_21011744
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.98552245, 'precision': 0.9218207, 'recall': 0.8410385, 'specificity': 0.8410385, 'f1': 0.87682515, 'auroc': 0.9891148, 'binary_precision': 0.8544839, 'binary_recall': 0.6861413, 'binary_specificity': 0.99593574, 'binary_f1_score': 0.76111525}
confusion matrix:
       0     1
0  42148   172
1    462  1010
---- Validation: 
scalar performance:
{'acc': 0.9830779, 'precision': 0.9365392, 'recall': 0.78797424, 'specificity': 0.78797424, 'f1': 0.84592897, 'auroc': 0.97815955, 'binary_precision': 0.8878282, 'binary_recall': 0.5785381, 'binary_specificity': 0.9974103, 'binary_f1_score': 0.700565}
confusion matrix:
       0    1
0  18102   47
1    271  372
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.77098584, 'recall': 0.5834555, 'specificity': 0.5834555, 'f1': 0.6225192, 'auroc': 0.94267344, 'binary_precision': 0.5769231, 'binary_recall': 0.1724138, 'binary_specificity': 0.99449724, 'binary_f1_score': 0.26548675}
confusion matrix:
      0   1
0  5964  33
1   216  45
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011744_28.png
early stop counter: 4
val acc:0.983077883720398, best validation acc: 0.9841954112052917, corresponding to test acc:                         0.9586129784584045 / 0.9752317070960999
after epoch: 28,now: 2024-06-02 01:27:11.985764,epoch time: 0:28:16.330886,used: 13:20:07.700177,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_12_07_04_seed_0_21011744
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.98401535, 'precision': 0.88405037, 'recall': 0.86386466, 'specificity': 0.86386466, 'f1': 0.8736621, 'auroc': 0.9855982, 'binary_precision': 0.77729887, 'binary_recall': 0.7350544, 'binary_specificity': 0.9926749, 'binary_f1_score': 0.7555867}
confusion matrix:
       0     1
0  42010   310
1    390  1082
---- Validation: 
scalar performance:
{'acc': 0.9834504, 'precision': 0.9123877, 'recall': 0.81816924, 'specificity': 0.81816924, 'f1': 0.85872936, 'auroc': 0.97797894, 'binary_precision': 0.83739835, 'binary_recall': 0.6407465, 'binary_specificity': 0.99559206, 'binary_f1_score': 0.72599113}
confusion matrix:
       0    1
0  18069   80
1    231  412
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959412, 'precision': 0.7757369, 'recall': 0.5427273, 'specificity': 0.5427273, 'f1': 0.5662705, 'auroc': 0.9337927, 'binary_precision': 0.5897436, 'binary_recall': 0.08812261, 'binary_specificity': 0.997332, 'binary_f1_score': 0.15333334}
confusion matrix:
      0   1
0  5981  16
1   238  23
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011744_29.png
early stop counter: 5
val acc:0.9834504127502441, best validation acc: 0.9841954112052917, corresponding to test acc:                         0.9586129784584045 / 0.9752317070960999
after epoch: 29,now: 2024-06-02 01:55:30.748348,epoch time: 0:28:18.762584,used: 13:48:26.462761,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_12_07_04_seed_0_21011744
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9801105, 'precision': 0.9434, 'recall': 0.7269092, 'specificity': 0.7269092, 'f1': 0.7979291, 'auroc': 0.9872905, 'binary_precision': 0.9054054, 'binary_recall': 0.45547247, 'binary_specificity': 0.998346, 'binary_f1_score': 0.60606056}
confusion matrix:
       0    1
0  42251   70
1    801  670
---- Validation: 
scalar performance:
{'acc': 0.9760004, 'precision': 0.9384918, 'recall': 0.6673015, 'specificity': 0.6673015, 'f1': 0.73847634, 'auroc': 0.9812764, 'binary_precision': 0.9, 'binary_recall': 0.33592534, 'binary_specificity': 0.9986776, 'binary_f1_score': 0.48924118}
confusion matrix:
       0    1
0  18125   24
1    427  216
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96196866, 'precision': 0.8330575, 'recall': 0.575211, 'specificity': 0.575211, 'f1': 0.61603045, 'auroc': 0.94680846, 'binary_precision': 0.7017544, 'binary_recall': 0.1532567, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.2515723}
confusion matrix:
      0   1
0  5980  17
1   221  40
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011744_30.png
early stop counter: 6
val acc:0.9760004281997681, best validation acc: 0.9841954112052917, corresponding to test acc:                         0.9586129784584045 / 0.9752317070960999
after epoch: 30,now: 2024-06-02 02:23:49.237996,epoch time: 0:28:18.489648,used: 14:16:44.952409,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_12_07_04_seed_0_21011744
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 14:16:44.952409 at 2024-06-02 02:23:49.237996
persisted model performance metric: 

scalar performance:
{'acc': 0.9592522, 'precision': 0.77238023, 'recall': 0.5389793, 'specificity': 0.5389793, 'f1': 0.5602725, 'auroc': 0.9440126, 'binary_precision': 0.5833333, 'binary_recall': 0.08045977, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.14141415}
confusion matrix:
      0   1
0  5982  15
1   240  21
oracle model performance metric: 

scalar performance:
{'acc': 0.97730905, 'precision': 0.91062963, 'recall': 0.7792747, 'specificity': 0.7792747, 'f1': 0.8312785, 'auroc': 0.9302423, 'binary_precision': 0.84, 'binary_recall': 0.5632184, 'binary_specificity': 0.995331, 'binary_f1_score': 0.67431194}
confusion matrix:
      0    1
0  5969   28
1   114  147
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/rule_results/0.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 457596 KiB |   2003 MiB |    928 TiB |    928 TiB |
|       from large pool | 415909 KiB |   1971 MiB |    916 TiB |    916 TiB |
|       from small pool |  41687 KiB |     61 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 457596 KiB |   2003 MiB |    928 TiB |    928 TiB |
|       from large pool | 415909 KiB |   1971 MiB |    916 TiB |    916 TiB |
|       from small pool |  41687 KiB |     61 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447754 KiB |   1998 MiB |    928 TiB |    928 TiB |
|       from large pool | 407075 KiB |   1966 MiB |    916 TiB |    916 TiB |
|       from small pool |  40679 KiB |     60 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2272 MiB |   2272 MiB |   2272 MiB |      0 B   |
|       from large pool |   2202 MiB |   2202 MiB |   2202 MiB |      0 B   |
|       from small pool |     70 MiB |     70 MiB |     70 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 296067 KiB | 361588 KiB | 756239 GiB | 756239 GiB |
|       from large pool | 286555 KiB | 357150 KiB | 743248 GiB | 743247 GiB |
|       from small pool |   9512 KiB |  14571 KiB |  12991 GiB |  12991 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3488    |    6459    |  180478 K  |  180474 K  |
|       from large pool |     187    |     311    |   87939 K  |   87939 K  |
|       from small pool |    3301    |    6271    |   92538 K  |   92535 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3488    |    6459    |  180478 K  |  180474 K  |
|       from large pool |     187    |     311    |   87939 K  |   87939 K  |
|       from small pool |    3301    |    6271    |   92538 K  |   92535 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     127    |     127    |     127    |       0    |
|       from large pool |      92    |      92    |      92    |       0    |
|       from small pool |      35    |      35    |      35    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      56    |    2782    |   96017 K  |   96017 K  |
|       from large pool |      26    |      89    |   59622 K  |   59622 K  |
|       from small pool |      30    |    2756    |   36395 K  |   36395 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2003 MiB |    928 TiB |    928 TiB |
|       from large pool |  16640 KiB |   1971 MiB |    916 TiB |    916 TiB |
|       from small pool |      0 KiB |     61 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2003 MiB |    928 TiB |    928 TiB |
|       from large pool |  16640 KiB |   1971 MiB |    916 TiB |    916 TiB |
|       from small pool |      0 KiB |     61 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB |    928 TiB |    928 TiB |
|       from large pool |  16640 KiB |   1966 MiB |    916 TiB |    916 TiB |
|       from small pool |      0 KiB |     60 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 753664 KiB |   2272 MiB |   2272 MiB |   1536 MiB |
|       from large pool | 702464 KiB |   2202 MiB |   2202 MiB |   1516 MiB |
|       from small pool |  51200 KiB |     70 MiB |     70 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 412779 KiB | 756239 GiB | 756239 GiB |
|       from large pool |  24320 KiB | 392029 KiB | 743248 GiB | 743248 GiB |
|       from small pool |      0 KiB |  21494 KiB |  12991 GiB |  12991 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6459    |  180478 K  |  180478 K  |
|       from large pool |       2    |     311    |   87939 K  |   87939 K  |
|       from small pool |       0    |    6271    |   92538 K  |   92538 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6459    |  180478 K  |  180478 K  |
|       from large pool |       2    |     311    |   87939 K  |   87939 K  |
|       from small pool |       0    |    6271    |   92538 K  |   92538 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      56    |     127    |     127    |      71    |
|       from large pool |      31    |      92    |      92    |      61    |
|       from small pool |      25    |      35    |      35    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2782    |   96019 K  |   96019 K  |
|       from large pool |       3    |      89    |   59622 K  |   59622 K  |
|       from small pool |       0    |    2756    |   36396 K  |   36396 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2003 MiB |    928 TiB |    928 TiB |
|       from large pool |  16640 KiB |   1971 MiB |    916 TiB |    916 TiB |
|       from small pool |      0 KiB |     61 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2003 MiB |    928 TiB |    928 TiB |
|       from large pool |  16640 KiB |   1971 MiB |    916 TiB |    916 TiB |
|       from small pool |      0 KiB |     61 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB |    928 TiB |    928 TiB |
|       from large pool |  16640 KiB |   1966 MiB |    916 TiB |    916 TiB |
|       from small pool |      0 KiB |     60 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 753664 KiB |   2272 MiB |   2272 MiB |   1536 MiB |
|       from large pool | 702464 KiB |   2202 MiB |   2202 MiB |   1516 MiB |
|       from small pool |  51200 KiB |     70 MiB |     70 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 412779 KiB | 756239 GiB | 756239 GiB |
|       from large pool |  24320 KiB | 392029 KiB | 743248 GiB | 743248 GiB |
|       from small pool |      0 KiB |  21494 KiB |  12991 GiB |  12991 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6459    |  180478 K  |  180478 K  |
|       from large pool |       2    |     311    |   87939 K  |   87939 K  |
|       from small pool |       0    |    6271    |   92538 K  |   92538 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6459    |  180478 K  |  180478 K  |
|       from large pool |       2    |     311    |   87939 K  |   87939 K  |
|       from small pool |       0    |    6271    |   92538 K  |   92538 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      56    |     127    |     127    |      71    |
|       from large pool |      31    |      92    |      92    |      61    |
|       from small pool |      25    |      35    |      35    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2782    |   96019 K  |   96019 K  |
|       from large pool |       3    |      89    |   59622 K  |   59622 K  |
|       from small pool |       0    |    2756    |   36396 K  |   36396 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_02_34_18_seed_1_21011744

 Experiment start at: 2024-06-02 02:34:18.651543
before training, model accuracy: 0.181115061044693
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9671197, 'precision': 0.48355985, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49164253, 'auroc': 0.9161469, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42414  0
1   1442  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.924659, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.8921057, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011744_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-02 03:03:38.080606,epoch time: 0:29:19.429063,used: 0:29:19.429063,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_02_34_18_seed_1_21011744
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.968465, 'precision': 0.7524752, 'recall': 0.7237736, 'specificity': 0.7237736, 'f1': 0.7371683, 'auroc': 0.94882596, 'binary_precision': 0.52317363, 'binary_recall': 0.46185854, 'binary_specificity': 0.9856887, 'binary_f1_score': 0.49060774}
confusion matrix:
       0    1
0  41807  607
1    776  666
---- Validation: 
scalar performance:
{'acc': 0.96600854, 'precision': 0.7581825, 'recall': 0.6755215, 'specificity': 0.6755215, 'f1': 0.7081281, 'auroc': 0.94823754, 'binary_precision': 0.539823, 'binary_recall': 0.3625557, 'binary_specificity': 0.9884873, 'binary_f1_score': 0.43377778}
confusion matrix:
       0    1
0  17859  208
1    429  244
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97260714, 'precision': 0.97561824, 'recall': 0.6767549, 'specificity': 0.6767549, 'f1': 0.7528377, 'auroc': 0.9316875, 'binary_precision': 0.9787234, 'binary_recall': 0.35384616, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.519774}
confusion matrix:
      0   1
0  5944   2
1   168  92
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011744_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-02 03:31:32.384457,epoch time: 0:27:54.303851,used: 0:57:13.732914,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_02_34_18_seed_1_21011744
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9662532, 'precision': 0.73601323, 'recall': 0.75713015, 'specificity': 0.75713015, 'f1': 0.74606717, 'auroc': 0.9509763, 'binary_precision': 0.48794416, 'binary_recall': 0.5332871, 'binary_specificity': 0.98097324, 'binary_f1_score': 0.509609}
confusion matrix:
       0    1
0  41607  807
1    673  769
---- Validation: 
scalar performance:
{'acc': 0.9648879, 'precision': 0.74611217, 'recall': 0.6842388, 'specificity': 0.6842388, 'f1': 0.7102219, 'auroc': 0.95089555, 'binary_precision': 0.5150301, 'binary_recall': 0.3818722, 'binary_specificity': 0.9866054, 'binary_f1_score': 0.43856654}
confusion matrix:
       0    1
0  17825  242
1    416  257
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97180146, 'precision': 0.9185676, 'recall': 0.6928853, 'specificity': 0.6928853, 'f1': 0.76063406, 'auroc': 0.9376153, 'binary_precision': 0.8632479, 'binary_recall': 0.38846153, 'binary_specificity': 0.9973091, 'binary_f1_score': 0.535809}
confusion matrix:
      0    1
0  5930   16
1   159  101
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011744_3.png
early stop counter: 1
val acc:0.9648879170417786, best validation acc: 0.9660085439682007, corresponding to test acc:                         0.9726071357727051 / 0.9726071357727051
after epoch: 3,now: 2024-06-02 03:59:14.245145,epoch time: 0:27:41.860688,used: 1:24:55.593602,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_02_34_18_seed_1_21011744
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96914905, 'precision': 0.76122224, 'recall': 0.68929225, 'specificity': 0.68929225, 'f1': 0.7189505, 'auroc': 0.9510616, 'binary_precision': 0.54299515, 'binary_recall': 0.38973647, 'binary_specificity': 0.98884803, 'binary_f1_score': 0.4537747}
confusion matrix:
       0    1
0  41941  473
1    880  562
---- Validation: 
scalar performance:
{'acc': 0.96766275, 'precision': 0.77697885, 'recall': 0.6813863, 'specificity': 0.6813863, 'f1': 0.7182037, 'auroc': 0.94924057, 'binary_precision': 0.57701147, 'binary_recall': 0.3729569, 'binary_specificity': 0.9898157, 'binary_f1_score': 0.45306858}
confusion matrix:
       0    1
0  17883  184
1    422  251
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96745086, 'precision': 0.9675949, 'recall': 0.61521643, 'specificity': 0.61521643, 'f1': 0.6779814, 'auroc': 0.9238055, 'binary_precision': 0.9677419, 'binary_recall': 0.23076923, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.37267083}
confusion matrix:
      0   1
0  5944   2
1   200  60
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011744_4.png
better model found
persisted
after epoch: 4,now: 2024-06-02 04:26:59.097668,epoch time: 0:27:44.852523,used: 1:52:40.446125,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_02_34_18_seed_1_21011744
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9671197, 'precision': 0.48355985, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49164253, 'auroc': 0.9603785, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42414  0
1   1442  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.95805085, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.93474233, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011744_5.png
early stop counter: 1
val acc:0.9640874862670898, best validation acc: 0.9676627516746521, corresponding to test acc:                         0.9674508571624756 / 0.9726071357727051
after epoch: 5,now: 2024-06-02 04:54:49.295953,epoch time: 0:27:50.198285,used: 2:20:30.644410,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_02_34_18_seed_1_21011744
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9696963, 'precision': 0.76629317, 'recall': 0.70096356, 'specificity': 0.70096356, 'f1': 0.728614, 'auroc': 0.9601171, 'binary_precision': 0.5523633, 'binary_recall': 0.41331485, 'binary_specificity': 0.98861223, 'binary_f1_score': 0.47282827}
confusion matrix:
       0    1
0  41931  483
1    846  596
---- Validation: 
scalar performance:
{'acc': 0.96627533, 'precision': 0.76742125, 'recall': 0.6356049, 'specificity': 0.6356049, 'f1': 0.6778438, 'auroc': 0.95880294, 'binary_precision': 0.561194, 'binary_recall': 0.2793462, 'binary_specificity': 0.9918636, 'binary_f1_score': 0.37301588}
confusion matrix:
       0    1
0  17920  147
1    485  188
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96471155, 'precision': 0.960167, 'recall': 0.5825241, 'specificity': 0.5825241, 'f1': 0.6319393, 'auroc': 0.93450785, 'binary_precision': 0.95555556, 'binary_recall': 0.16538462, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.28196722}
confusion matrix:
      0   1
0  5944   2
1   217  43
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011744_6.png
early stop counter: 2
val acc:0.9662753343582153, best validation acc: 0.9676627516746521, corresponding to test acc:                         0.9674508571624756 / 0.9726071357727051
after epoch: 6,now: 2024-06-02 05:22:37.527767,epoch time: 0:27:48.231814,used: 2:48:18.876224,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_02_34_18_seed_1_21011744
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9690578, 'precision': 0.7557543, 'recall': 0.8123845, 'specificity': 0.8123845, 'f1': 0.78092813, 'auroc': 0.96072793, 'binary_precision': 0.5236753, 'binary_recall': 0.64469117, 'binary_specificity': 0.9800778, 'binary_f1_score': 0.577916}
confusion matrix:
       0    1
0  41570  845
1    512  929
---- Validation: 
scalar performance:
{'acc': 0.9681964, 'precision': 0.7688653, 'recall': 0.79109895, 'specificity': 0.79109895, 'f1': 0.7794889, 'auroc': 0.95771885, 'binary_precision': 0.55266756, 'binary_recall': 0.60029715, 'binary_specificity': 0.9819007, 'binary_f1_score': 0.5754985}
confusion matrix:
       0    1
0  17740  327
1    269  404
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97824687, 'precision': 0.9523523, 'recall': 0.76061344, 'specificity': 0.76061344, 'f1': 0.8285297, 'auroc': 0.94340575, 'binary_precision': 0.92517006, 'binary_recall': 0.52307695, 'binary_specificity': 0.99815, 'binary_f1_score': 0.66830474}
confusion matrix:
      0    1
0  5935   11
1   124  136
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011744_7.png
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-06-02 05:50:25.049671,epoch time: 0:27:47.521904,used: 3:16:06.398128,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_02_34_18_seed_1_21011744
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97042596, 'precision': 0.7697368, 'recall': 0.7405302, 'specificity': 0.7405302, 'f1': 0.75421315, 'auroc': 0.96274847, 'binary_precision': 0.5565964, 'binary_recall': 0.49445215, 'binary_specificity': 0.9866082, 'binary_f1_score': 0.5236871}
confusion matrix:
       0    1
0  41846  568
1    729  713
---- Validation: 
scalar performance:
{'acc': 0.9681964, 'precision': 0.78575015, 'recall': 0.67451036, 'specificity': 0.67451036, 'f1': 0.7153758, 'auroc': 0.9602071, 'binary_precision': 0.5950617, 'binary_recall': 0.35809806, 'binary_specificity': 0.9909227, 'binary_f1_score': 0.44712427}
confusion matrix:
       0    1
0  17903  164
1    432  241
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9695456, 'precision': 0.97782373, 'recall': 0.6383774, 'specificity': 0.6383774, 'f1': 0.70839274, 'auroc': 0.94993937, 'binary_precision': 0.98630136, 'binary_recall': 0.2769231, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.4324324}
confusion matrix:
      0   1
0  5945   1
1   188  72
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011744_8.png
early stop counter: 1
val acc:0.9681963920593262, best validation acc: 0.9681963920593262, corresponding to test acc:                         0.9782468676567078 / 0.9782468676567078
after epoch: 8,now: 2024-06-02 06:18:14.675372,epoch time: 0:27:49.625701,used: 3:43:56.023829,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_02_34_18_seed_1_21011744
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.97040313, 'precision': 0.7680298, 'recall': 0.7576009, 'specificity': 0.7576009, 'f1': 0.7627012, 'auroc': 0.9593514, 'binary_precision': 0.5520231, 'binary_recall': 0.52981967, 'binary_specificity': 0.9853822, 'binary_f1_score': 0.5406935}
confusion matrix:
       0    1
0  41794  620
1    678  764
---- Validation: 
scalar performance:
{'acc': 0.96905017, 'precision': 0.7853229, 'recall': 0.7185845, 'specificity': 0.7185845, 'f1': 0.7470777, 'auroc': 0.96250457, 'binary_precision': 0.59099805, 'binary_recall': 0.448737, 'binary_specificity': 0.98843193, 'binary_f1_score': 0.5101351}
confusion matrix:
       0    1
0  17858  209
1    371  302
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97534645, 'precision': 0.9367003, 'recall': 0.73151505, 'specificity': 0.73151505, 'f1': 0.7999631, 'auroc': 0.9408806, 'binary_precision': 0.8962963, 'binary_recall': 0.4653846, 'binary_specificity': 0.9976455, 'binary_f1_score': 0.6126582}
confusion matrix:
      0    1
0  5932   14
1   139  121
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011744_9.png
better model found
persisted
after epoch: 9,now: 2024-06-02 06:45:58.287825,epoch time: 0:27:43.612453,used: 4:11:39.636282,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_02_34_18_seed_1_21011744
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.96933144, 'precision': 0.8320739, 'recall': 0.5594252, 'specificity': 0.5594252, 'f1': 0.5949581, 'auroc': 0.9629762, 'binary_precision': 0.6932271, 'binary_recall': 0.120665744, 'binary_specificity': 0.99818456, 'binary_f1_score': 0.20555228}
confusion matrix:
       0    1
0  42337   77
1   1268  174
---- Validation: 
scalar performance:
{'acc': 0.96526146, 'precision': 0.82788616, 'recall': 0.5292195, 'specificity': 0.5292195, 'f1': 0.5458622, 'auroc': 0.9594598, 'binary_precision': 0.6896552, 'binary_recall': 0.059435364, 'binary_specificity': 0.9990037, 'binary_f1_score': 0.10943912}
confusion matrix:
       0   1
0  18049  18
1    633  40
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587496, 'precision': 0.89610213, 'recall': 0.50953126, 'specificity': 0.50953126, 'f1': 0.5082585, 'auroc': 0.93790317, 'binary_precision': 0.8333333, 'binary_recall': 0.01923077, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.037593987}
confusion matrix:
      0  1
0  5945  1
1   255  5
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011744_10.png
early stop counter: 1
val acc:0.9652614593505859, best validation acc: 0.9690501689910889, corresponding to test acc:                         0.9753464460372925 / 0.9782468676567078
after epoch: 10,now: 2024-06-02 07:13:55.056677,epoch time: 0:27:56.768852,used: 4:39:36.405134,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_02_34_18_seed_1_21011744
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.97056276, 'precision': 0.84632677, 'recall': 0.58451325, 'specificity': 0.58451325, 'f1': 0.63086313, 'auroc': 0.96920645, 'binary_precision': 0.7201166, 'binary_recall': 0.17128988, 'binary_specificity': 0.9977366, 'binary_f1_score': 0.2767507}
confusion matrix:
       0    1
0  42318   96
1   1195  247
---- Validation: 
scalar performance:
{'acc': 0.96739596, 'precision': 0.85746306, 'recall': 0.56895095, 'specificity': 0.56895095, 'f1': 0.6093185, 'auroc': 0.9644467, 'binary_precision': 0.74603176, 'binary_recall': 0.1396731, 'binary_specificity': 0.9982288, 'binary_f1_score': 0.2352941}
confusion matrix:
       0   1
0  18035  32
1    579  94
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.9520339, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011744_11.png
early stop counter: 2
val acc:0.9673959612846375, best validation acc: 0.9690501689910889, corresponding to test acc:                         0.9753464460372925 / 0.9782468676567078
after epoch: 11,now: 2024-06-02 07:41:45.639527,epoch time: 0:27:50.582850,used: 5:07:26.987984,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_02_34_18_seed_1_21011744
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.96919465, 'precision': 0.8835909, 'recall': 0.54193693, 'specificity': 0.54193693, 'f1': 0.56864506, 'auroc': 0.9636768, 'binary_precision': 0.79738563, 'binary_recall': 0.08460472, 'binary_specificity': 0.9992691, 'binary_f1_score': 0.15297805}
confusion matrix:
       0    1
0  42383   31
1   1320  122
---- Validation: 
scalar performance:
{'acc': 0.966222, 'precision': 0.9331995, 'recall': 0.533294, 'specificity': 0.533294, 'f1': 0.55363005, 'auroc': 0.96003115, 'binary_precision': 0.9, 'binary_recall': 0.06686478, 'binary_specificity': 0.99972326, 'binary_f1_score': 0.12448132}
confusion matrix:
       0   1
0  18062   5
1    628  45
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.9367285, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011744_12.png
early stop counter: 3
val acc:0.9662219882011414, best validation acc: 0.9690501689910889, corresponding to test acc:                         0.9753464460372925 / 0.9782468676567078
after epoch: 12,now: 2024-06-02 08:09:43.076991,epoch time: 0:27:57.437464,used: 5:35:24.425448,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_02_34_18_seed_1_21011744
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9709276, 'precision': 0.8721585, 'recall': 0.58135235, 'specificity': 0.58135235, 'f1': 0.62809, 'auroc': 0.9707083, 'binary_precision': 0.77198696, 'binary_recall': 0.16435507, 'binary_specificity': 0.9983496, 'binary_f1_score': 0.27101204}
confusion matrix:
       0    1
0  42344   70
1   1205  237
---- Validation: 
scalar performance:
{'acc': 0.9657951, 'precision': 0.81069106, 'recall': 0.5495238, 'specificity': 0.5495238, 'f1': 0.5787838, 'auroc': 0.9629835, 'binary_precision': 0.65384614, 'binary_recall': 0.10104012, 'binary_specificity': 0.9980074, 'binary_f1_score': 0.17503217}
confusion matrix:
       0   1
0  18031  36
1    605  68
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96019983, 'precision': 0.98005813, 'recall': 0.525, 'specificity': 0.525, 'f1': 0.53744525, 'auroc': 0.949501, 'binary_precision': 1.0, 'binary_recall': 0.05, 'binary_specificity': 1.0, 'binary_f1_score': 0.095238104}
confusion matrix:
      0   1
0  5946   0
1   247  13
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011744_13.png
early stop counter: 4
val acc:0.96579509973526, best validation acc: 0.9690501689910889, corresponding to test acc:                         0.9753464460372925 / 0.9782468676567078
after epoch: 13,now: 2024-06-02 08:37:38.452125,epoch time: 0:27:55.375134,used: 6:03:19.800582,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_02_34_18_seed_1_21011744
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9751231, 'precision': 0.83809894, 'recall': 0.71348286, 'specificity': 0.71348286, 'f1': 0.7605902, 'auroc': 0.965753, 'binary_precision': 0.6952169, 'binary_recall': 0.43342578, 'binary_specificity': 0.99353987, 'binary_f1_score': 0.53395987}
confusion matrix:
       0    1
0  42140  274
1    817  625
---- Validation: 
scalar performance:
{'acc': 0.9699573, 'precision': 0.8539852, 'recall': 0.6260702, 'specificity': 0.6260702, 'f1': 0.68193924, 'auroc': 0.96413887, 'binary_precision': 0.73504275, 'binary_recall': 0.25557205, 'binary_specificity': 0.9965683, 'binary_f1_score': 0.3792723}
confusion matrix:
       0    1
0  18005   62
1    501  172
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9634225, 'precision': 0.9816135, 'recall': 0.56346154, 'specificity': 0.56346154, 'f1': 0.60326254, 'auroc': 0.94303864, 'binary_precision': 1.0, 'binary_recall': 0.12692308, 'binary_specificity': 1.0, 'binary_f1_score': 0.22525598}
confusion matrix:
      0   1
0  5946   0
1   227  33
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011744_14.png
better model found
persisted
after epoch: 14,now: 2024-06-02 09:05:33.884132,epoch time: 0:27:55.432007,used: 6:31:15.232589,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_02_34_18_seed_1_21011744
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9754196, 'precision': 0.8641093, 'recall': 0.68729454, 'specificity': 0.68729454, 'f1': 0.74531186, 'auroc': 0.96863675, 'binary_precision': 0.74897116, 'binary_recall': 0.37890354, 'binary_specificity': 0.9956855, 'binary_f1_score': 0.50322574}
confusion matrix:
       0    1
0  42232  183
1    895  546
---- Validation: 
scalar performance:
{'acc': 0.9699573, 'precision': 0.87353015, 'recall': 0.6139107, 'specificity': 0.6139107, 'f1': 0.66985893, 'auroc': 0.9653793, 'binary_precision': 0.775, 'binary_recall': 0.23031203, 'binary_specificity': 0.9975093, 'binary_f1_score': 0.35509735}
confusion matrix:
       0    1
0  18022   45
1    518  155
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95939416, 'precision': 0.9796709, 'recall': 0.5153846, 'specificity': 0.5153846, 'f1': 0.5194752, 'auroc': 0.9474396, 'binary_precision': 1.0, 'binary_recall': 0.03076923, 'binary_specificity': 1.0, 'binary_f1_score': 0.05970149}
confusion matrix:
      0  1
0  5946  0
1   252  8
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011744_15.png
early stop counter: 1
val acc:0.9699572920799255, best validation acc: 0.9699572920799255, corresponding to test acc:                         0.9634224772453308 / 0.9782468676567078
after epoch: 15,now: 2024-06-02 09:33:36.212167,epoch time: 0:28:02.328035,used: 6:59:17.560624,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_02_34_18_seed_1_21011744
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9723869, 'precision': 0.94635874, 'recall': 0.58746606, 'specificity': 0.58746606, 'f1': 0.6403089, 'auroc': 0.9701242, 'binary_precision': 0.92, 'binary_recall': 0.17545076, 'binary_specificity': 0.9994813, 'binary_f1_score': 0.29470006}
confusion matrix:
       0    1
0  42392   22
1   1189  253
---- Validation: 
scalar performance:
{'acc': 0.968143, 'precision': 0.9657892, 'recall': 0.55860937, 'specificity': 0.55860937, 'f1': 0.5965078, 'auroc': 0.96710575, 'binary_precision': 0.9634146, 'binary_recall': 0.11738484, 'binary_specificity': 0.99983394, 'binary_f1_score': 0.20927152}
confusion matrix:
       0   1
0  18064   3
1    594  79
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.9334011, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011744_16.png
early stop counter: 2
val acc:0.9681429862976074, best validation acc: 0.9699572920799255, corresponding to test acc:                         0.9634224772453308 / 0.9782468676567078
after epoch: 16,now: 2024-06-02 10:02:54.980342,epoch time: 0:29:18.768175,used: 7:28:36.328799,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_02_34_18_seed_1_21011744
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9763088, 'precision': 0.8433644, 'recall': 0.7375425, 'specificity': 0.7375425, 'f1': 0.78003454, 'auroc': 0.97146237, 'binary_precision': 0.704154, 'binary_recall': 0.48196948, 'binary_specificity': 0.9931155, 'binary_f1_score': 0.572252}
confusion matrix:
       0    1
0  42122  292
1    747  695
---- Validation: 
scalar performance:
{'acc': 0.9747599, 'precision': 0.8613472, 'recall': 0.7244067, 'specificity': 0.7244067, 'f1': 0.7755295, 'auroc': 0.9672755, 'binary_precision': 0.74271846, 'binary_recall': 0.45468053, 'binary_specificity': 0.99413294, 'binary_f1_score': 0.56405526}
confusion matrix:
       0    1
0  17961  106
1    367  306
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9624557, 'precision': 0.96397924, 'recall': 0.5537621, 'specificity': 0.5537621, 'f1': 0.587276, 'auroc': 0.95209706, 'binary_precision': 0.9655172, 'binary_recall': 0.10769231, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.19377162}
confusion matrix:
      0   1
0  5945   1
1   232  28
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011744_17.png
better model found
persisted
after epoch: 17,now: 2024-06-02 10:32:14.557867,epoch time: 0:29:19.577525,used: 7:57:55.906324,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_02_34_18_seed_1_21011744
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.97710687, 'precision': 0.8929075, 'recall': 0.6984307, 'specificity': 0.6984307, 'f1': 0.76150954, 'auroc': 0.9725988, 'binary_precision': 0.80586594, 'binary_recall': 0.4001387, 'binary_specificity': 0.99672276, 'binary_f1_score': 0.5347544}
confusion matrix:
       0    1
0  42275  139
1    865  577
---- Validation: 
scalar performance:
{'acc': 0.97171825, 'precision': 0.8956834, 'recall': 0.63556665, 'specificity': 0.63556665, 'f1': 0.6976558, 'auroc': 0.96543264, 'binary_precision': 0.81777775, 'binary_recall': 0.27340266, 'binary_specificity': 0.9977307, 'binary_f1_score': 0.40979952}
confusion matrix:
       0    1
0  18026   41
1    489  184
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587496, 'precision': 0.85450953, 'recall': 0.5113703, 'specificity': 0.5113703, 'f1': 0.51184785, 'auroc': 0.9437332, 'binary_precision': 0.75, 'binary_recall': 0.023076924, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.04477612}
confusion matrix:
      0  1
0  5944  2
1   254  6
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011744_18.png
early stop counter: 1
val acc:0.9717182517051697, best validation acc: 0.9747598767280579, corresponding to test acc:                         0.962455689907074 / 0.9782468676567078
after epoch: 18,now: 2024-06-02 11:01:16.861365,epoch time: 0:29:02.303498,used: 8:26:58.209822,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_02_34_18_seed_1_21011744
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.97902226, 'precision': 0.8874307, 'recall': 0.7432997, 'specificity': 0.7432997, 'f1': 0.7976942, 'auroc': 0.97762287, 'binary_precision': 0.7919463, 'binary_recall': 0.49098474, 'binary_specificity': 0.99561465, 'binary_f1_score': 0.60616434}
confusion matrix:
       0    1
0  42228  186
1    734  708
---- Validation: 
scalar performance:
{'acc': 0.974333, 'precision': 0.88777506, 'recall': 0.6891372, 'specificity': 0.6891372, 'f1': 0.7516997, 'auroc': 0.97118926, 'binary_precision': 0.79813665, 'binary_recall': 0.3818722, 'binary_specificity': 0.99640226, 'binary_f1_score': 0.5165829}
confusion matrix:
       0    1
0  18002   65
1    416  257
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96003866, 'precision': 0.9443406, 'recall': 0.5249159, 'specificity': 0.5249159, 'f1': 0.5372294, 'auroc': 0.9542928, 'binary_precision': 0.9285714, 'binary_recall': 0.05, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.09489051}
confusion matrix:
      0   1
0  5945   1
1   247  13
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011744_19.png
early stop counter: 2
val acc:0.9743329882621765, best validation acc: 0.9747598767280579, corresponding to test acc:                         0.962455689907074 / 0.9782468676567078
after epoch: 19,now: 2024-06-02 11:30:20.750087,epoch time: 0:29:03.888722,used: 8:56:02.098544,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_02_34_18_seed_1_21011744
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9772209, 'precision': 0.8876684, 'recall': 0.70518875, 'specificity': 0.70518875, 'f1': 0.766389, 'auroc': 0.9759028, 'binary_precision': 0.79494005, 'binary_recall': 0.41400832, 'binary_specificity': 0.9963691, 'binary_f1_score': 0.54445964}
confusion matrix:
       0    1
0  42260  154
1    845  597
---- Validation: 
scalar performance:
{'acc': 0.9715048, 'precision': 0.87034345, 'recall': 0.64690024, 'specificity': 0.64690024, 'f1': 0.7068269, 'auroc': 0.970534, 'binary_precision': 0.7662835, 'binary_recall': 0.2971768, 'binary_specificity': 0.9966237, 'binary_f1_score': 0.4282655}
confusion matrix:
       0    1
0  18006   61
1    473  200
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582662, 'precision': 0.7488045, 'recall': 0.512957, 'specificity': 0.512957, 'f1': 0.514973, 'auroc': 0.9512234, 'binary_precision': 0.53846157, 'binary_recall': 0.026923077, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.051282056}
confusion matrix:
      0  1
0  5940  6
1   253  7
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011744_20.png
early stop counter: 3
val acc:0.971504807472229, best validation acc: 0.9747598767280579, corresponding to test acc:                         0.962455689907074 / 0.9782468676567078
after epoch: 20,now: 2024-06-02 11:59:22.259193,epoch time: 0:29:01.509106,used: 9:25:03.607650,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_02_34_18_seed_1_21011744
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.97309375, 'precision': 0.7846945, 'recall': 0.8166038, 'specificity': 0.8166038, 'f1': 0.7997151, 'auroc': 0.9729915, 'binary_precision': 0.5813665, 'binary_recall': 0.64909846, 'binary_specificity': 0.98410904, 'binary_f1_score': 0.6133683}
confusion matrix:
       0    1
0  41740  674
1    506  936
---- Validation: 
scalar performance:
{'acc': 0.9726788, 'precision': 0.80971956, 'recall': 0.7741114, 'specificity': 0.7741114, 'f1': 0.7907192, 'auroc': 0.9654625, 'binary_precision': 0.6357504, 'binary_recall': 0.5601783, 'binary_specificity': 0.9880445, 'binary_f1_score': 0.5955766}
confusion matrix:
       0    1
0  17851  216
1    296  377
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9685788, 'precision': 0.9456204, 'recall': 0.6360339, 'specificity': 0.6360339, 'f1': 0.7026079, 'auroc': 0.94162834, 'binary_precision': 0.9220779, 'binary_recall': 0.27307692, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.42136496}
confusion matrix:
      0   1
0  5940   6
1   189  71
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011744_21.png
early stop counter: 4
val acc:0.9726787805557251, best validation acc: 0.9747598767280579, corresponding to test acc:                         0.962455689907074 / 0.9782468676567078
after epoch: 21,now: 2024-06-02 12:28:22.976639,epoch time: 0:29:00.717446,used: 9:54:04.325096,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_02_34_18_seed_1_21011744
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9787486, 'precision': 0.84920394, 'recall': 0.79273117, 'specificity': 0.79273117, 'f1': 0.8182739, 'auroc': 0.9755904, 'binary_precision': 0.7121464, 'binary_recall': 0.59361994, 'binary_specificity': 0.9918423, 'binary_f1_score': 0.64750373}
confusion matrix:
       0    1
0  42068  346
1    586  856
---- Validation: 
scalar performance:
{'acc': 0.9761473, 'precision': 0.8807589, 'recall': 0.73084843, 'specificity': 0.73084843, 'f1': 0.78595376, 'auroc': 0.96791494, 'binary_precision': 0.78109455, 'binary_recall': 0.4665676, 'binary_specificity': 0.9951292, 'binary_f1_score': 0.584186}
confusion matrix:
       0    1
0  17979   88
1    359  314
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96374476, 'precision': 0.88610756, 'recall': 0.5875365, 'specificity': 0.5875365, 'f1': 0.635809, 'auroc': 0.9498566, 'binary_precision': 0.80701756, 'binary_recall': 0.17692308, 'binary_specificity': 0.99815, 'binary_f1_score': 0.29022083}
confusion matrix:
      0   1
0  5935  11
1   214  46
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011744_22.png
better model found
persisted
after epoch: 22,now: 2024-06-02 12:57:27.476298,epoch time: 0:29:04.499659,used: 10:23:08.824755,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_02_34_18_seed_1_21011744
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9795923, 'precision': 0.8507072, 'recall': 0.8122596, 'specificity': 0.8122596, 'f1': 0.83027315, 'auroc': 0.9770832, 'binary_precision': 0.71383893, 'binary_recall': 0.63314843, 'binary_specificity': 0.9913708, 'binary_f1_score': 0.6710768}
confusion matrix:
       0    1
0  42048  366
1    529  913
---- Validation: 
scalar performance:
{'acc': 0.976841, 'precision': 0.8724043, 'recall': 0.754812, 'specificity': 0.754812, 'f1': 0.8016547, 'auroc': 0.97170436, 'binary_precision': 0.7626374, 'binary_recall': 0.51560175, 'binary_specificity': 0.99402225, 'binary_f1_score': 0.6152482}
confusion matrix:
       0    1
0  17959  108
1    326  347
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96374476, 'precision': 0.856369, 'recall': 0.60040945, 'specificity': 0.60040945, 'f1': 0.6508087, 'auroc': 0.94798136, 'binary_precision': 0.74647886, 'binary_recall': 0.20384616, 'binary_specificity': 0.99697274, 'binary_f1_score': 0.3202417}
confusion matrix:
      0   1
0  5928  18
1   207  53
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011744_23.png
better model found
persisted
after epoch: 23,now: 2024-06-02 13:26:29.267613,epoch time: 0:29:01.791315,used: 10:52:10.616070,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_02_34_18_seed_1_21011744
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.98091483, 'precision': 0.8601779, 'recall': 0.82701135, 'specificity': 0.82701135, 'f1': 0.84272647, 'auroc': 0.97922194, 'binary_precision': 0.7318008, 'binary_recall': 0.6622746, 'binary_specificity': 0.99174803, 'binary_f1_score': 0.695304}
confusion matrix:
       0    1
0  42064  350
1    487  955
---- Validation: 
scalar performance:
{'acc': 0.97769475, 'precision': 0.88381624, 'recall': 0.7581159, 'specificity': 0.7581159, 'f1': 0.8076447, 'auroc': 0.9722025, 'binary_precision': 0.7852349, 'binary_recall': 0.5215453, 'binary_specificity': 0.9946864, 'binary_f1_score': 0.6267857}
confusion matrix:
       0    1
0  17971   96
1    322  351
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9663229, 'precision': 0.8746561, 'recall': 0.63485664, 'specificity': 0.63485664, 'f1': 0.6936149, 'auroc': 0.9442214, 'binary_precision': 0.7802198, 'binary_recall': 0.27307692, 'binary_specificity': 0.9966364, 'binary_f1_score': 0.40455842}
confusion matrix:
      0   1
0  5926  20
1   189  71
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011744_24.png
better model found
persisted
after epoch: 24,now: 2024-06-02 13:55:35.075218,epoch time: 0:29:05.807605,used: 11:21:16.423675,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_02_34_18_seed_1_21011744
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.98000276, 'precision': 0.87320054, 'recall': 0.7826611, 'specificity': 0.7826611, 'f1': 0.82118917, 'auroc': 0.97816634, 'binary_precision': 0.7608495, 'binary_recall': 0.5714286, 'binary_specificity': 0.9938935, 'binary_f1_score': 0.6526733}
confusion matrix:
       0    1
0  42155  259
1    618  824
---- Validation: 
scalar performance:
{'acc': 0.9760939, 'precision': 0.8825114, 'recall': 0.7279597, 'specificity': 0.7279597, 'f1': 0.78411037, 'auroc': 0.9722444, 'binary_precision': 0.7848101, 'binary_recall': 0.46062407, 'binary_specificity': 0.9952953, 'binary_f1_score': 0.5805244}
confusion matrix:
       0    1
0  17982   85
1    363  310
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9555269, 'precision': 0.59618413, 'recall': 0.5115275, 'specificity': 0.5115275, 'f1': 0.51275367, 'auroc': 0.9354031, 'binary_precision': 0.23333333, 'binary_recall': 0.026923077, 'binary_specificity': 0.99613184, 'binary_f1_score': 0.048275866}
confusion matrix:
      0   1
0  5923  23
1   253   7
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011744_25.png
early stop counter: 1
val acc:0.9760938882827759, best validation acc: 0.9776947498321533, corresponding to test acc:                         0.9663228988647461 / 0.9782468676567078
after epoch: 25,now: 2024-06-02 14:24:33.806952,epoch time: 0:28:58.731734,used: 11:50:15.155409,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_02_34_18_seed_1_21011744
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.98018515, 'precision': 0.86064136, 'recall': 0.807411, 'specificity': 0.807411, 'f1': 0.83172935, 'auroc': 0.97912514, 'binary_precision': 0.7340425, 'binary_recall': 0.6224844, 'binary_specificity': 0.99233764, 'binary_f1_score': 0.6736763}
confusion matrix:
       0    1
0  42090  325
1    544  897
---- Validation: 
scalar performance:
{'acc': 0.97769475, 'precision': 0.8856776, 'recall': 0.75597006, 'specificity': 0.75597006, 'f1': 0.8066406, 'auroc': 0.9720794, 'binary_precision': 0.78911567, 'binary_recall': 0.51708764, 'binary_specificity': 0.9948525, 'binary_f1_score': 0.6247755}
confusion matrix:
       0    1
0  17974   93
1    325  348
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614889, 'precision': 0.8812024, 'recall': 0.5532575, 'specificity': 0.5532575, 'f1': 0.5850531, 'auroc': 0.9464761, 'binary_precision': 0.8, 'binary_recall': 0.10769231, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.18983051}
confusion matrix:
      0   1
0  5939   7
1   232  28
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011744_26.png
early stop counter: 2
val acc:0.9776947498321533, best validation acc: 0.9776947498321533, corresponding to test acc:                         0.9663228988647461 / 0.9782468676567078
after epoch: 26,now: 2024-06-02 14:53:34.348370,epoch time: 0:29:00.541418,used: 12:19:15.696827,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_02_34_18_seed_1_21011744
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9793415, 'precision': 0.8520558, 'recall': 0.80275124, 'specificity': 0.80275124, 'f1': 0.82539034, 'auroc': 0.9800881, 'binary_precision': 0.7171799, 'binary_recall': 0.6137309, 'binary_specificity': 0.9917716, 'binary_f1_score': 0.66143495}
confusion matrix:
       0    1
0  42065  349
1    557  885
---- Validation: 
scalar performance:
{'acc': 0.97828174, 'precision': 0.88256925, 'recall': 0.7712951, 'specificity': 0.7712951, 'f1': 0.81667006, 'auroc': 0.973239, 'binary_precision': 0.78177965, 'binary_recall': 0.5482912, 'binary_specificity': 0.994299, 'binary_f1_score': 0.64454144}
confusion matrix:
       0    1
0  17964  103
1    304  369
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95955527, 'precision': 0.79882336, 'recall': 0.53937554, 'specificity': 0.53937554, 'f1': 0.5613167, 'auroc': 0.9505421, 'binary_precision': 0.6363636, 'binary_recall': 0.08076923, 'binary_specificity': 0.99798185, 'binary_f1_score': 0.14334472}
confusion matrix:
      0   1
0  5934  12
1   239  21
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011744_27.png
better model found
persisted
after epoch: 27,now: 2024-06-02 15:22:33.755316,epoch time: 0:28:59.406946,used: 12:48:15.103773,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_02_34_18_seed_1_21011744
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.97897667, 'precision': 0.9255569, 'recall': 0.71078575, 'specificity': 0.71078575, 'f1': 0.7795938, 'auroc': 0.98256576, 'binary_precision': 0.8703704, 'binary_recall': 0.42371705, 'binary_specificity': 0.9978545, 'binary_f1_score': 0.5699627}
confusion matrix:
       0    1
0  42323   91
1    831  611
---- Validation: 
scalar performance:
{'acc': 0.9757204, 'precision': 0.94322217, 'recall': 0.67912775, 'specificity': 0.67912775, 'f1': 0.75149506, 'auroc': 0.97330034, 'binary_precision': 0.9097744, 'binary_recall': 0.35958394, 'binary_specificity': 0.9986716, 'binary_f1_score': 0.51544195}
confusion matrix:
       0    1
0  18043   24
1    431  242
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9585885, 'precision': 0.76566577, 'recall': 0.52232015, 'specificity': 0.52232015, 'f1': 0.53211194, 'auroc': 0.9493481, 'binary_precision': 0.5714286, 'binary_recall': 0.046153847, 'binary_specificity': 0.9984864, 'binary_f1_score': 0.085409254}
confusion matrix:
      0   1
0  5937   9
1   248  12
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011744_28.png
early stop counter: 1
val acc:0.9757204055786133, best validation acc: 0.9782817363739014, corresponding to test acc:                         0.9595552682876587 / 0.9782468676567078
after epoch: 28,now: 2024-06-02 15:51:34.576749,epoch time: 0:29:00.821433,used: 13:17:15.925206,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_02_34_18_seed_1_21011744
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9797747, 'precision': 0.84475714, 'recall': 0.8311112, 'specificity': 0.8311112, 'f1': 0.83778423, 'auroc': 0.98109233, 'binary_precision': 0.70065075, 'binary_recall': 0.67198336, 'binary_specificity': 0.9902391, 'binary_f1_score': 0.68601763}
confusion matrix:
       0    1
0  42000  414
1    473  969
---- Validation: 
scalar performance:
{'acc': 0.97908217, 'precision': 0.8674587, 'recall': 0.8103347, 'specificity': 0.8103347, 'f1': 0.836272, 'auroc': 0.97358346, 'binary_precision': 0.74867254, 'binary_recall': 0.62852895, 'binary_specificity': 0.99214035, 'binary_f1_score': 0.6833602}
confusion matrix:
       0    1
0  17925  142
1    250  423
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9574605, 'precision': 0.56244624, 'recall': 0.50150263, 'specificity': 0.50150263, 'f1': 0.4928916, 'auroc': 0.9497888, 'binary_precision': 0.16666667, 'binary_recall': 0.0038461538, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.007518797}
confusion matrix:
      0  1
0  5941  5
1   259  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011744_29.png
better model found
persisted
after epoch: 29,now: 2024-06-02 16:20:37.714138,epoch time: 0:29:03.137389,used: 13:46:19.062595,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_02_34_18_seed_1_21011744
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9819865, 'precision': 0.9093552, 'recall': 0.7806721, 'specificity': 0.7806721, 'f1': 0.83214575, 'auroc': 0.9813509, 'binary_precision': 0.8333333, 'binary_recall': 0.5651872, 'binary_specificity': 0.99615693, 'binary_f1_score': 0.67355376}
confusion matrix:
       0    1
0  42251  163
1    627  815
---- Validation: 
scalar performance:
{'acc': 0.9770544, 'precision': 0.93216515, 'recall': 0.7062845, 'specificity': 0.7062845, 'f1': 0.77649695, 'auroc': 0.9747634, 'binary_precision': 0.8857143, 'binary_recall': 0.41456166, 'binary_specificity': 0.9980074, 'binary_f1_score': 0.5647773}
confusion matrix:
       0    1
0  18031   36
1    394  279
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95987755, 'precision': 0.8749373, 'recall': 0.5285098, 'specificity': 0.5285098, 'f1': 0.54350215, 'auroc': 0.94715095, 'binary_precision': 0.7894737, 'binary_recall': 0.057692308, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.10752688}
confusion matrix:
      0   1
0  5942   4
1   245  15
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011744_30.png
early stop counter: 1
val acc:0.9770544171333313, best validation acc: 0.9790821671485901, corresponding to test acc:                         0.9574605226516724 / 0.9782468676567078
after epoch: 30,now: 2024-06-02 16:49:35.618159,epoch time: 0:28:57.904021,used: 14:15:16.966616,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_02_34_18_seed_1_21011744
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 14:15:16.966616 at 2024-06-02 16:49:35.618159
persisted model performance metric: 

scalar performance:
{'acc': 0.95762163, 'precision': 0.5791163, 'recall': 0.50158674, 'specificity': 0.50158674, 'f1': 0.49294788, 'auroc': 0.94217277, 'binary_precision': 0.2, 'binary_recall': 0.0038461538, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.00754717}
confusion matrix:
      0  1
0  5942  4
1   259  1
oracle model performance metric: 

scalar performance:
{'acc': 0.9766355, 'precision': 0.9488143, 'recall': 0.7413827, 'specificity': 0.7413827, 'f1': 0.8113462, 'auroc': 0.94961226, 'binary_precision': 0.919708, 'binary_recall': 0.4846154, 'binary_specificity': 0.99815, 'binary_f1_score': 0.63476074}
confusion matrix:
      0    1
0  5935   11
1   134  126
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456850 KiB |   2004 MiB |   1860 TiB |   1860 TiB |
|       from large pool | 415174 KiB |   1971 MiB |   1836 TiB |   1836 TiB |
|       from small pool |  41675 KiB |     61 MiB |     24 TiB |     24 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 456850 KiB |   2004 MiB |   1860 TiB |   1860 TiB |
|       from large pool | 415174 KiB |   1971 MiB |   1836 TiB |   1836 TiB |
|       from small pool |  41675 KiB |     61 MiB |     24 TiB |     24 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447751 KiB |   1998 MiB |   1856 TiB |   1856 TiB |
|       from large pool | 407075 KiB |   1966 MiB |   1832 TiB |   1832 TiB |
|       from small pool |  40676 KiB |     60 MiB |     24 TiB |     24 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2260 MiB |   2272 MiB |   3796 MiB |   1536 MiB |
|       from large pool |   2196 MiB |   2202 MiB |   3712 MiB |   1516 MiB |
|       from small pool |     64 MiB |     70 MiB |     84 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 368494 KiB | 412779 KiB |   1447 TiB |   1447 TiB |
|       from large pool | 361017 KiB | 402413 KiB |   1421 TiB |   1421 TiB |
|       from small pool |   7476 KiB |  21494 KiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3464    |    6467    |  360992 K  |  360988 K  |
|       from large pool |     187    |     311    |  175918 K  |  175918 K  |
|       from small pool |    3277    |    6279    |  185074 K  |  185070 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3464    |    6467    |  360992 K  |  360988 K  |
|       from large pool |     187    |     311    |  175918 K  |  175918 K  |
|       from small pool |    3277    |    6279    |  185074 K  |  185070 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     124    |     127    |     195    |      71    |
|       from large pool |      92    |      92    |     153    |      61    |
|       from small pool |      32    |      35    |      42    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      65    |    2793    |  190442 K  |  190442 K  |
|       from large pool |      34    |      89    |  118163 K  |  118163 K  |
|       from small pool |      31    |    2759    |   72279 K  |   72278 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2004 MiB |   1860 TiB |   1860 TiB |
|       from large pool |  16640 KiB |   1971 MiB |   1836 TiB |   1836 TiB |
|       from small pool |      0 KiB |     61 MiB |     24 TiB |     24 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2004 MiB |   1860 TiB |   1860 TiB |
|       from large pool |  16640 KiB |   1971 MiB |   1836 TiB |   1836 TiB |
|       from small pool |      0 KiB |     61 MiB |     24 TiB |     24 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB |   1856 TiB |   1856 TiB |
|       from large pool |  16640 KiB |   1966 MiB |   1832 TiB |   1832 TiB |
|       from small pool |      0 KiB |     60 MiB |     24 TiB |     24 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    806 MiB |   2272 MiB |   3796 MiB |   2990 MiB |
|       from large pool |    758 MiB |   2202 MiB |   3712 MiB |   2954 MiB |
|       from small pool |     48 MiB |     70 MiB |     84 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 412779 KiB |   1447 TiB |   1447 TiB |
|       from large pool |  24320 KiB | 402413 KiB |   1421 TiB |   1421 TiB |
|       from small pool |      0 KiB |  22399 KiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6467    |  360992 K  |  360992 K  |
|       from large pool |       2    |     311    |  175918 K  |  175918 K  |
|       from small pool |       0    |    6279    |  185074 K  |  185074 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6467    |  360992 K  |  360992 K  |
|       from large pool |       2    |     311    |  175918 K  |  175918 K  |
|       from small pool |       0    |    6279    |  185074 K  |  185074 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      58    |     127    |     195    |     137    |
|       from large pool |      34    |      92    |     153    |     119    |
|       from small pool |      24    |      35    |      42    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2793    |  190444 K  |  190444 K  |
|       from large pool |       3    |      89    |  118163 K  |  118163 K  |
|       from small pool |       0    |    2759    |   72280 K  |   72280 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2004 MiB |   1860 TiB |   1860 TiB |
|       from large pool |  16640 KiB |   1971 MiB |   1836 TiB |   1836 TiB |
|       from small pool |      0 KiB |     61 MiB |     24 TiB |     24 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2004 MiB |   1860 TiB |   1860 TiB |
|       from large pool |  16640 KiB |   1971 MiB |   1836 TiB |   1836 TiB |
|       from small pool |      0 KiB |     61 MiB |     24 TiB |     24 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB |   1856 TiB |   1856 TiB |
|       from large pool |  16640 KiB |   1966 MiB |   1832 TiB |   1832 TiB |
|       from small pool |      0 KiB |     60 MiB |     24 TiB |     24 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    806 MiB |   2272 MiB |   3796 MiB |   2990 MiB |
|       from large pool |    758 MiB |   2202 MiB |   3712 MiB |   2954 MiB |
|       from small pool |     48 MiB |     70 MiB |     84 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 412779 KiB |   1447 TiB |   1447 TiB |
|       from large pool |  24320 KiB | 402413 KiB |   1421 TiB |   1421 TiB |
|       from small pool |      0 KiB |  22399 KiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6467    |  360992 K  |  360992 K  |
|       from large pool |       2    |     311    |  175918 K  |  175918 K  |
|       from small pool |       0    |    6279    |  185074 K  |  185074 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6467    |  360992 K  |  360992 K  |
|       from large pool |       2    |     311    |  175918 K  |  175918 K  |
|       from small pool |       0    |    6279    |  185074 K  |  185074 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      58    |     127    |     195    |     137    |
|       from large pool |      34    |      92    |     153    |     119    |
|       from small pool |      24    |      35    |      42    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2793    |  190444 K  |  190444 K  |
|       from large pool |       3    |      89    |  118163 K  |  118163 K  |
|       from small pool |       0    |    2759    |   72280 K  |   72280 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_16_59_39_seed_2_21011744

 Experiment start at: 2024-06-02 16:59:39.340755
before training, model accuracy: 0.7679115533828735
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96547556, 'precision': 0.48273778, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4912173, 'auroc': 0.9549768, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42311  0
1   1513  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.95134556, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.93944836, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011744_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-02 17:30:05.091001,epoch time: 0:30:25.750246,used: 0:30:25.750246,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_16_59_39_seed_2_21011744
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9698111, 'precision': 0.78399444, 'recall': 0.70331466, 'specificity': 0.70331466, 'f1': 0.73632395, 'auroc': 0.9579736, 'binary_precision': 0.5886194, 'binary_recall': 0.4170522, 'binary_specificity': 0.9895772, 'binary_f1_score': 0.48820114}
confusion matrix:
       0    1
0  41870  441
1    882  631
---- Validation: 
scalar performance:
{'acc': 0.97278005, 'precision': 0.8055231, 'recall': 0.67756855, 'specificity': 0.67756855, 'f1': 0.7232195, 'auroc': 0.9569637, 'binary_precision': 0.63188404, 'binary_recall': 0.36212623, 'binary_specificity': 0.9930108, 'binary_f1_score': 0.46040124}
confusion matrix:
       0    1
0  18044  127
1    384  218
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96906555, 'precision': 0.9746822, 'recall': 0.60322237, 'specificity': 0.60322237, 'f1': 0.6627289, 'auroc': 0.9490095, 'binary_precision': 0.98039216, 'binary_recall': 0.20661157, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.34129694}
confusion matrix:
      0   1
0  5996   1
1   192  50
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011744_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-02 17:59:06.457279,epoch time: 0:29:01.366278,used: 0:59:27.116524,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_16_59_39_seed_2_21011744
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96643394, 'precision': 0.74993134, 'recall': 0.8519695, 'specificity': 0.8519695, 'f1': 0.79121387, 'auroc': 0.9565537, 'binary_precision': 0.50970423, 'binary_recall': 0.72901523, 'binary_specificity': 0.9749238, 'binary_f1_score': 0.5999456}
confusion matrix:
       0     1
0  41250  1061
1    410  1103
---- Validation: 
scalar performance:
{'acc': 0.96649444, 'precision': 0.738068, 'recall': 0.8534014, 'specificity': 0.8534014, 'f1': 0.7831321, 'auroc': 0.9560871, 'binary_precision': 0.48514852, 'binary_recall': 0.73255813, 'binary_specificity': 0.97424465, 'binary_f1_score': 0.5837194}
confusion matrix:
       0    1
0  17703  468
1    161  441
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9764385, 'precision': 0.8740182, 'recall': 0.7795561, 'specificity': 0.7795561, 'f1': 0.8193196, 'auroc': 0.936188, 'binary_precision': 0.76536316, 'binary_recall': 0.5661157, 'binary_specificity': 0.9929965, 'binary_f1_score': 0.65083134}
confusion matrix:
      0    1
0  5955   42
1   105  137
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011744_3.png
new oracle model saved
early stop counter: 1
val acc:0.9664944410324097, best validation acc: 0.9727800488471985, corresponding to test acc:                         0.9690655469894409 / 0.9764385223388672
after epoch: 3,now: 2024-06-02 18:28:12.655051,epoch time: 0:29:06.197772,used: 1:28:33.314296,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_16_59_39_seed_2_21011744
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9686245, 'precision': 0.7622813, 'recall': 0.8256999, 'specificity': 0.8256999, 'f1': 0.7901666, 'auroc': 0.9648653, 'binary_precision': 0.5363924, 'binary_recall': 0.6721745, 'binary_specificity': 0.9792253, 'binary_f1_score': 0.5966559}
confusion matrix:
       0     1
0  41432   879
1    496  1017
---- Validation: 
scalar performance:
{'acc': 0.9702232, 'precision': 0.759296, 'recall': 0.7862654, 'specificity': 0.7862654, 'f1': 0.7720432, 'auroc': 0.9614657, 'binary_precision': 0.5322339, 'binary_recall': 0.589701, 'binary_specificity': 0.9828298, 'binary_f1_score': 0.5594957}
confusion matrix:
       0    1
0  17859  312
1    247  355
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9765988, 'precision': 0.9568423, 'recall': 0.7122263, 'specificity': 0.7122263, 'f1': 0.7865935, 'auroc': 0.9541975, 'binary_precision': 0.93636364, 'binary_recall': 0.42561984, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.58522725}
confusion matrix:
      0    1
0  5990    7
1   139  103
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011744_4.png
new oracle model saved
early stop counter: 2
val acc:0.9702231884002686, best validation acc: 0.9727800488471985, corresponding to test acc:                         0.9690655469894409 / 0.9765987992286682
after epoch: 4,now: 2024-06-02 18:57:21.733964,epoch time: 0:29:09.078913,used: 1:57:42.393209,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_16_59_39_seed_2_21011744
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96647954, 'precision': 0.7493932, 'recall': 0.81343627, 'specificity': 0.81343627, 'f1': 0.77732545, 'auroc': 0.961998, 'binary_precision': 0.51145834, 'binary_recall': 0.64904165, 'binary_specificity': 0.9778308, 'binary_f1_score': 0.5720943}
confusion matrix:
       0    1
0  41373  938
1    531  982
---- Validation: 
scalar performance:
{'acc': 0.9665477, 'precision': 0.73650306, 'recall': 0.82050395, 'specificity': 0.82050395, 'f1': 0.77141833, 'auroc': 0.9544163, 'binary_precision': 0.4842615, 'binary_recall': 0.66445184, 'binary_specificity': 0.97655606, 'binary_f1_score': 0.5602241}
confusion matrix:
       0    1
0  17745  426
1    202  400
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9623337, 'precision': 0.75883067, 'recall': 0.57592773, 'specificity': 0.57592773, 'f1': 0.6125292, 'auroc': 0.93877256, 'binary_precision': 0.5507246, 'binary_recall': 0.1570248, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.244373}
confusion matrix:
      0   1
0  5966  31
1   204  38
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011744_5.png
early stop counter: 3
val acc:0.9665477275848389, best validation acc: 0.9727800488471985, corresponding to test acc:                         0.9690655469894409 / 0.9765987992286682
after epoch: 5,now: 2024-06-02 19:26:29.559393,epoch time: 0:29:07.825429,used: 2:26:50.218638,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_16_59_39_seed_2_21011744
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9740553, 'precision': 0.9191594, 'recall': 0.64688075, 'specificity': 0.64688075, 'f1': 0.7134486, 'auroc': 0.97431654, 'binary_precision': 0.86293435, 'binary_recall': 0.2954395, 'binary_specificity': 0.99832195, 'binary_f1_score': 0.44017723}
confusion matrix:
       0    1
0  42240   71
1   1066  447
---- Validation: 
scalar performance:
{'acc': 0.9713951, 'precision': 0.8518573, 'recall': 0.5845026, 'specificity': 0.5845026, 'f1': 0.6313316, 'auroc': 0.9662627, 'binary_precision': 0.73049647, 'binary_recall': 0.17109634, 'binary_specificity': 0.9979088, 'binary_f1_score': 0.27725437}
confusion matrix:
       0    1
0  18133   38
1    499  103
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9620131, 'precision': 0.8049663, 'recall': 0.522227, 'specificity': 0.522227, 'f1': 0.532773, 'auroc': 0.9499645, 'binary_precision': 0.64705884, 'binary_recall': 0.045454547, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.08494209}
confusion matrix:
      0   1
0  5991   6
1   231  11
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011744_6.png
early stop counter: 4
val acc:0.9713950753211975, best validation acc: 0.9727800488471985, corresponding to test acc:                         0.9690655469894409 / 0.9765987992286682
after epoch: 6,now: 2024-06-02 19:55:30.497865,epoch time: 0:29:00.938472,used: 2:55:51.157110,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_16_59_39_seed_2_21011744
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9742835, 'precision': 0.7959649, 'recall': 0.8719672, 'specificity': 0.8719672, 'f1': 0.82916665, 'auroc': 0.97439396, 'binary_precision': 0.60052085, 'binary_recall': 0.76206213, 'binary_specificity': 0.9818723, 'binary_f1_score': 0.67171574}
confusion matrix:
       0     1
0  41544   767
1    360  1153
---- Validation: 
scalar performance:
{'acc': 0.9750706, 'precision': 0.7919905, 'recall': 0.84417975, 'specificity': 0.84417975, 'f1': 0.81572974, 'auroc': 0.9691786, 'binary_precision': 0.59383756, 'binary_recall': 0.70431894, 'binary_specificity': 0.9840405, 'binary_f1_score': 0.64437693}
confusion matrix:
       0    1
0  17881  290
1    178  424
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97387403, 'precision': 0.90704256, 'recall': 0.7008952, 'specificity': 0.7008952, 'f1': 0.7662555, 'auroc': 0.9516225, 'binary_precision': 0.83760685, 'binary_recall': 0.40495867, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.54596096}
confusion matrix:
      0   1
0  5978  19
1   144  98
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011744_7.png
better model found
persisted
after epoch: 7,now: 2024-06-02 20:24:30.862678,epoch time: 0:29:00.364813,used: 3:24:51.521923,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_16_59_39_seed_2_21011744
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9804673, 'precision': 0.88846874, 'recall': 0.7920015, 'specificity': 0.7920015, 'f1': 0.8328439, 'auroc': 0.9804565, 'binary_precision': 0.7914818, 'binary_recall': 0.5895572, 'binary_specificity': 0.99444586, 'binary_f1_score': 0.6757576}
confusion matrix:
       0    1
0  42076  235
1    621  892
---- Validation: 
scalar performance:
{'acc': 0.9790124, 'precision': 0.9053464, 'recall': 0.7161221, 'specificity': 0.7161221, 'f1': 0.78002465, 'auroc': 0.9726596, 'binary_precision': 0.8291139, 'binary_recall': 0.43521595, 'binary_specificity': 0.99702823, 'binary_f1_score': 0.5708061}
confusion matrix:
       0    1
0  18117   54
1    340  262
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9639365, 'precision': 0.8540205, 'recall': 0.5529686, 'specificity': 0.5529686, 'f1': 0.5846423, 'auroc': 0.9521117, 'binary_precision': 0.74285716, 'binary_recall': 0.10743801, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.18772562}
confusion matrix:
      0   1
0  5988   9
1   216  26
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011744_8.png
better model found
persisted
after epoch: 8,now: 2024-06-02 20:53:34.597006,epoch time: 0:29:03.734328,used: 3:53:55.256251,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_16_59_39_seed_2_21011744
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9779801, 'precision': 0.9039465, 'recall': 0.7273017, 'specificity': 0.7273017, 'f1': 0.7891115, 'auroc': 0.97657335, 'binary_precision': 0.82696897, 'binary_recall': 0.4580304, 'binary_specificity': 0.996573, 'binary_f1_score': 0.58953637}
confusion matrix:
       0    1
0  42166  145
1    820  693
---- Validation: 
scalar performance:
{'acc': 0.97709477, 'precision': 0.9101063, 'recall': 0.6749791, 'specificity': 0.6749791, 'f1': 0.74238396, 'auroc': 0.9720061, 'binary_precision': 0.84126985, 'binary_recall': 0.35215947, 'binary_specificity': 0.9977987, 'binary_f1_score': 0.49648708}
confusion matrix:
       0    1
0  18131   40
1    390  212
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.7306798, 'recall': 0.50198275, 'specificity': 0.50198275, 'f1': 0.4942079, 'auroc': 0.9458667, 'binary_precision': 0.5, 'binary_recall': 0.004132231, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.008196721}
confusion matrix:
      0  1
0  5996  1
1   241  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011744_9.png
early stop counter: 1
val acc:0.9770947694778442, best validation acc: 0.9790124297142029, corresponding to test acc:                         0.9639365077018738 / 0.9765987992286682
after epoch: 9,now: 2024-06-02 21:22:36.231691,epoch time: 0:29:01.634685,used: 4:22:56.890936,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_16_59_39_seed_2_21011744
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9741466, 'precision': 0.9322229, 'recall': 0.64278555, 'specificity': 0.64278555, 'f1': 0.7102772, 'auroc': 0.97546625, 'binary_precision': 0.8893443, 'binary_recall': 0.28684732, 'binary_specificity': 0.99872375, 'binary_f1_score': 0.43378314}
confusion matrix:
       0    1
0  42257   54
1   1079  434
---- Validation: 
scalar performance:
{'acc': 0.97267354, 'precision': 0.9524683, 'recall': 0.5795416, 'specificity': 0.5795416, 'f1': 0.62920785, 'auroc': 0.96605873, 'binary_precision': 0.93203884, 'binary_recall': 0.15946844, 'binary_specificity': 0.9996148, 'binary_f1_score': 0.27234042}
confusion matrix:
       0   1
0  18164   7
1    506  96
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.94428533, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011744_10.png
early stop counter: 2
val acc:0.9726735353469849, best validation acc: 0.9790124297142029, corresponding to test acc:                         0.9639365077018738 / 0.9765987992286682
after epoch: 10,now: 2024-06-02 21:51:37.052201,epoch time: 0:29:00.820510,used: 4:51:57.711446,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_16_59_39_seed_2_21011744
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.97829956, 'precision': 0.8357707, 'recall': 0.84154457, 'specificity': 0.84154457, 'f1': 0.8386307, 'auroc': 0.9765261, 'binary_precision': 0.6824675, 'binary_recall': 0.6946464, 'binary_specificity': 0.9884427, 'binary_f1_score': 0.6885031}
confusion matrix:
       0     1
0  41822   489
1    462  1051
---- Validation: 
scalar performance:
{'acc': 0.97965163, 'precision': 0.84682816, 'recall': 0.80880284, 'specificity': 0.80880284, 'f1': 0.82662034, 'auroc': 0.97553116, 'binary_precision': 0.7059925, 'binary_recall': 0.62624586, 'binary_specificity': 0.99135983, 'binary_f1_score': 0.6637324}
confusion matrix:
       0    1
0  18014  157
1    225  377
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9677833, 'precision': 0.818997, 'recall': 0.66798586, 'specificity': 0.66798586, 'f1': 0.71785975, 'auroc': 0.9603795, 'binary_precision': 0.664, 'binary_recall': 0.3429752, 'binary_specificity': 0.9929965, 'binary_f1_score': 0.45231605}
confusion matrix:
      0   1
0  5955  42
1   159  83
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011744_11.png
better model found
persisted
after epoch: 11,now: 2024-06-02 22:20:40.137793,epoch time: 0:29:03.085592,used: 5:21:00.797038,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_16_59_39_seed_2_21011744
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.97423786, 'precision': 0.90193486, 'recall': 0.659084, 'specificity': 0.659084, 'f1': 0.7244638, 'auroc': 0.97535205, 'binary_precision': 0.82764506, 'binary_recall': 0.32055518, 'binary_specificity': 0.9976129, 'binary_f1_score': 0.4621248}
confusion matrix:
       0    1
0  42210  101
1   1028  485
---- Validation: 
scalar performance:
{'acc': 0.97315294, 'precision': 0.8615166, 'recall': 0.62154776, 'specificity': 0.62154776, 'f1': 0.6781421, 'auroc': 0.9688314, 'binary_precision': 0.74747473, 'binary_recall': 0.24584718, 'binary_specificity': 0.99724835, 'binary_f1_score': 0.37000003}
confusion matrix:
       0    1
0  18121   50
1    454  148
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621734, 'precision': 0.83850837, 'recall': 0.5203277, 'specificity': 0.5203277, 'f1': 0.52940774, 'auroc': 0.94749546, 'binary_precision': 0.71428573, 'binary_recall': 0.041322313, 'binary_specificity': 0.999333, 'binary_f1_score': 0.078125}
confusion matrix:
      0   1
0  5993   4
1   232  10
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011744_12.png
early stop counter: 1
val acc:0.9731529355049133, best validation acc: 0.9796516299247742, corresponding to test acc:                         0.9677832722663879 / 0.9765987992286682
after epoch: 12,now: 2024-06-02 22:49:47.608895,epoch time: 0:29:07.471102,used: 5:50:08.268140,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_16_59_39_seed_2_21011744
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9803304, 'precision': 0.8574331, 'recall': 0.84100306, 'specificity': 0.84100306, 'f1': 0.84900725, 'auroc': 0.98181874, 'binary_precision': 0.7258848, 'binary_recall': 0.6913417, 'binary_specificity': 0.99066436, 'binary_f1_score': 0.7081923}
confusion matrix:
       0     1
0  41916   395
1    467  1046
---- Validation: 
scalar performance:
{'acc': 0.9810899, 'precision': 0.8689078, 'recall': 0.80392444, 'specificity': 0.80392444, 'f1': 0.83303, 'auroc': 0.96903914, 'binary_precision': 0.7505071, 'binary_recall': 0.61461794, 'binary_specificity': 0.993231, 'binary_f1_score': 0.6757991}
confusion matrix:
       0    1
0  18048  123
1    232  370
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.7312731, 'recall': 0.5178447, 'specificity': 0.5178447, 'f1': 0.52471197, 'auroc': 0.96061146, 'binary_precision': 0.5, 'binary_recall': 0.037190083, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.06923077}
confusion matrix:
      0  1
0  5988  9
1   233  9
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011744_13.png
better model found
persisted
after epoch: 13,now: 2024-06-02 23:19:07.572170,epoch time: 0:29:19.963275,used: 6:19:28.231415,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_16_59_39_seed_2_21011744
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.97925794, 'precision': 0.85313594, 'recall': 0.82355905, 'specificity': 0.82355905, 'f1': 0.83764255, 'auroc': 0.9799608, 'binary_precision': 0.71852386, 'binary_recall': 0.656312, 'binary_specificity': 0.99080616, 'binary_f1_score': 0.68601036}
confusion matrix:
       0    1
0  41922  389
1    520  993
---- Validation: 
scalar performance:
{'acc': 0.9791722, 'precision': 0.8526698, 'recall': 0.7836607, 'specificity': 0.7836607, 'f1': 0.8141213, 'auroc': 0.9727687, 'binary_precision': 0.7193347, 'binary_recall': 0.57475084, 'binary_specificity': 0.9925706, 'binary_f1_score': 0.63896585}
confusion matrix:
       0    1
0  18036  135
1    256  346
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650585, 'precision': 0.8176044, 'recall': 0.59717256, 'specificity': 0.59717256, 'f1': 0.6439054, 'auroc': 0.9446014, 'binary_precision': 0.6666667, 'binary_recall': 0.1983471, 'binary_specificity': 0.995998, 'binary_f1_score': 0.30573252}
confusion matrix:
      0   1
0  5973  24
1   194  48
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011744_14.png
early stop counter: 1
val acc:0.9791722297668457, best validation acc: 0.9810898900032043, corresponding to test acc:                         0.9612117409706116 / 0.9765987992286682
after epoch: 14,now: 2024-06-02 23:48:25.057598,epoch time: 0:29:17.485428,used: 6:48:45.716843,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_16_59_39_seed_2_21011744
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.980764, 'precision': 0.8538122, 'recall': 0.8603467, 'specificity': 0.8603467, 'f1': 0.85704684, 'auroc': 0.9819859, 'binary_precision': 0.71725035, 'binary_recall': 0.73099804, 'binary_specificity': 0.98969537, 'binary_f1_score': 0.724059}
confusion matrix:
       0     1
0  41875   436
1    407  1106
---- Validation: 
scalar performance:
{'acc': 0.97965163, 'precision': 0.83957726, 'recall': 0.8264699, 'specificity': 0.8264699, 'f1': 0.8328835, 'auroc': 0.9746816, 'binary_precision': 0.69031143, 'binary_recall': 0.6627907, 'binary_specificity': 0.99014914, 'binary_f1_score': 0.6762712}
confusion matrix:
       0    1
0  17992  179
1    203  399
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9615323, 'precision': 0.76252913, 'recall': 0.51801145, 'specificity': 0.51801145, 'f1': 0.52506375, 'auroc': 0.95192015, 'binary_precision': 0.5625, 'binary_recall': 0.037190083, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.069767445}
confusion matrix:
      0  1
0  5990  7
1   233  9
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011744_15.png
early stop counter: 2
val acc:0.9796516299247742, best validation acc: 0.9810898900032043, corresponding to test acc:                         0.9612117409706116 / 0.9765987992286682
after epoch: 15,now: 2024-06-03 00:17:27.382086,epoch time: 0:29:02.324488,used: 7:17:48.041331,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_16_59_39_seed_2_21011744
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9776378, 'precision': 0.94157827, 'recall': 0.6962152, 'specificity': 0.6962152, 'f1': 0.7686689, 'auroc': 0.9862317, 'binary_precision': 0.9044006, 'binary_recall': 0.39391938, 'binary_specificity': 0.998511, 'binary_f1_score': 0.548803}
confusion matrix:
       0    1
0  42248   63
1    917  596
---- Validation: 
scalar performance:
{'acc': 0.9759229, 'precision': 0.9357449, 'recall': 0.6406457, 'specificity': 0.6406457, 'f1': 0.70849746, 'auroc': 0.97394323, 'binary_precision': 0.8947368, 'binary_recall': 0.28239202, 'binary_specificity': 0.99889934, 'binary_f1_score': 0.42929292}
confusion matrix:
       0    1
0  18151   20
1    432  170
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9616926, 'precision': 0.8809111, 'recall': 0.5081811, 'specificity': 0.5081811, 'f1': 0.50642407, 'auroc': 0.94678247, 'binary_precision': 0.8, 'binary_recall': 0.016528925, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.032388665}
confusion matrix:
      0  1
0  5996  1
1   238  4
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011744_16.png
early stop counter: 3
val acc:0.9759228825569153, best validation acc: 0.9810898900032043, corresponding to test acc:                         0.9612117409706116 / 0.9765987992286682
after epoch: 16,now: 2024-06-03 00:46:29.820782,epoch time: 0:29:02.438696,used: 7:46:50.480027,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_16_59_39_seed_2_21011744
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.982521, 'precision': 0.9027243, 'recall': 0.8147334, 'specificity': 0.8147334, 'f1': 0.85290086, 'auroc': 0.9837704, 'binary_precision': 0.81841433, 'binary_recall': 0.634501, 'binary_specificity': 0.99496585, 'binary_f1_score': 0.7148175}
confusion matrix:
       0    1
0  42098  213
1    553  960
---- Validation: 
scalar performance:
{'acc': 0.9812497, 'precision': 0.8987118, 'recall': 0.76786983, 'specificity': 0.76786983, 'f1': 0.81953514, 'auroc': 0.9734728, 'binary_precision': 0.8125, 'binary_recall': 0.5398671, 'binary_specificity': 0.99587256, 'binary_f1_score': 0.64870256}
confusion matrix:
       0    1
0  18096   75
1    277  325
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.962494, 'precision': 0.758926, 'recall': 0.58790755, 'specificity': 0.58790755, 'f1': 0.6270211, 'auroc': 0.9519155, 'binary_precision': 0.55, 'binary_recall': 0.18181819, 'binary_specificity': 0.993997, 'binary_f1_score': 0.27329192}
confusion matrix:
      0   1
0  5961  36
1   198  44
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011744_17.png
better model found
persisted
after epoch: 17,now: 2024-06-03 01:16:06.036724,epoch time: 0:29:36.215942,used: 8:16:26.695969,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_16_59_39_seed_2_21011744
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9806955, 'precision': 0.88497454, 'recall': 0.8013606, 'specificity': 0.8013606, 'f1': 0.8376551, 'auroc': 0.9838299, 'binary_precision': 0.7838298, 'binary_recall': 0.6087244, 'binary_specificity': 0.99399686, 'binary_f1_score': 0.68526787}
confusion matrix:
       0    1
0  42057  254
1    592  921
---- Validation: 
scalar performance:
{'acc': 0.97816014, 'precision': 0.85129076, 'recall': 0.75904644, 'specificity': 0.75904644, 'f1': 0.7976471, 'auroc': 0.9754002, 'binary_precision': 0.7181818, 'binary_recall': 0.52491695, 'binary_specificity': 0.9931759, 'binary_f1_score': 0.6065259}
confusion matrix:
       0    1
0  18047  124
1    286  316
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96377623, 'precision': 0.8437002, 'recall': 0.55288523, 'specificity': 0.55288523, 'f1': 0.58426285, 'auroc': 0.94890726, 'binary_precision': 0.7222222, 'binary_recall': 0.10743801, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.18705034}
confusion matrix:
      0   1
0  5987  10
1   216  26
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011744_18.png
early stop counter: 1
val acc:0.9781601428985596, best validation acc: 0.9812496900558472, corresponding to test acc:                         0.9624940156936646 / 0.9765987992286682
after epoch: 18,now: 2024-06-03 01:45:52.972383,epoch time: 0:29:46.935659,used: 8:46:13.631628,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_16_59_39_seed_2_21011744
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9837532, 'precision': 0.9209517, 'recall': 0.8169648, 'specificity': 0.8169648, 'f1': 0.8610656, 'auroc': 0.9859103, 'binary_precision': 0.8547387, 'binary_recall': 0.6378057, 'binary_specificity': 0.9961239, 'binary_f1_score': 0.7305072}
confusion matrix:
       0    1
0  42147  164
1    548  965
---- Validation: 
scalar performance:
{'acc': 0.97975814, 'precision': 0.8828647, 'recall': 0.75344753, 'specificity': 0.75344753, 'f1': 0.8040386, 'auroc': 0.97262895, 'binary_precision': 0.7817259, 'binary_recall': 0.5116279, 'binary_specificity': 0.9952672, 'binary_f1_score': 0.6184739}
confusion matrix:
       0    1
0  18085   86
1    294  308
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.7328451, 'recall': 0.5594822, 'specificity': 0.5594822, 'f1': 0.5894002, 'auroc': 0.9457461, 'binary_precision': 0.5, 'binary_recall': 0.12396694, 'binary_specificity': 0.9949975, 'binary_f1_score': 0.1986755}
confusion matrix:
      0   1
0  5967  30
1   212  30
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011744_19.png
early stop counter: 2
val acc:0.9797581434249878, best validation acc: 0.9812496900558472, corresponding to test acc:                         0.9624940156936646 / 0.9765987992286682
after epoch: 19,now: 2024-06-03 02:15:20.601307,epoch time: 0:29:27.628924,used: 9:15:41.260552,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_16_59_39_seed_2_21011744
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9807868, 'precision': 0.924168, 'recall': 0.7612577, 'specificity': 0.7612577, 'f1': 0.82195103, 'auroc': 0.9855262, 'binary_precision': 0.8650707, 'binary_recall': 0.5254461, 'binary_specificity': 0.9970693, 'binary_f1_score': 0.6537829}
confusion matrix:
       0    1
0  42187  124
1    718  795
---- Validation: 
scalar performance:
{'acc': 0.97853297, 'precision': 0.9136349, 'recall': 0.70061654, 'specificity': 0.70061654, 'f1': 0.76784396, 'auroc': 0.9792043, 'binary_precision': 0.8466899, 'binary_recall': 0.4036545, 'binary_specificity': 0.99757856, 'binary_f1_score': 0.54668164}
confusion matrix:
       0    1
0  18127   44
1    359  243
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9631351, 'precision': 0.82058823, 'recall': 0.5466035, 'specificity': 0.5466035, 'f1': 0.5739086, 'auroc': 0.9542869, 'binary_precision': 0.6764706, 'binary_recall': 0.09504132, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.16666666}
confusion matrix:
      0   1
0  5986  11
1   219  23
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011744_20.png
early stop counter: 3
val acc:0.9785329699516296, best validation acc: 0.9812496900558472, corresponding to test acc:                         0.9624940156936646 / 0.9765987992286682
after epoch: 20,now: 2024-06-03 02:44:42.890202,epoch time: 0:29:22.288895,used: 9:45:03.549447,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_16_59_39_seed_2_21011744
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.98293173, 'precision': 0.92161286, 'recall': 0.8015627, 'specificity': 0.8015627, 'f1': 0.85086644, 'auroc': 0.988352, 'binary_precision': 0.85714287, 'binary_recall': 0.60674155, 'binary_specificity': 0.9963839, 'binary_f1_score': 0.7105263}
confusion matrix:
       0    1
0  42158  153
1    595  918
---- Validation: 
scalar performance:
{'acc': 0.97762746, 'precision': 0.8889998, 'recall': 0.7009518, 'specificity': 0.7009518, 'f1': 0.7629907, 'auroc': 0.9776491, 'binary_precision': 0.79738563, 'binary_recall': 0.4053156, 'binary_specificity': 0.996588, 'binary_f1_score': 0.53744495}
confusion matrix:
       0    1
0  18109   62
1    358  244
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9623337, 'precision': 0.8481095, 'recall': 0.52239376, 'specificity': 0.52239376, 'f1': 0.533187, 'auroc': 0.9590039, 'binary_precision': 0.73333335, 'binary_recall': 0.045454547, 'binary_specificity': 0.999333, 'binary_f1_score': 0.08560311}
confusion matrix:
      0   1
0  5993   4
1   231  11
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011744_21.png
early stop counter: 4
val acc:0.9776274561882019, best validation acc: 0.9812496900558472, corresponding to test acc:                         0.9624940156936646 / 0.9765987992286682
after epoch: 21,now: 2024-06-03 03:14:07.618911,epoch time: 0:29:24.728709,used: 10:14:28.278156,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_16_59_39_seed_2_21011744
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9832512, 'precision': 0.922696, 'recall': 0.8061893, 'specificity': 0.8061893, 'f1': 0.8544224, 'auroc': 0.98526716, 'binary_precision': 0.8589862, 'binary_recall': 0.6159947, 'binary_specificity': 0.9963839, 'binary_f1_score': 0.717475}
confusion matrix:
       0    1
0  42158  153
1    581  932
---- Validation: 
scalar performance:
{'acc': 0.9814095, 'precision': 0.90024644, 'recall': 0.7695584, 'specificity': 0.7695584, 'f1': 0.82124674, 'auroc': 0.9758113, 'binary_precision': 0.81546134, 'binary_recall': 0.54318935, 'binary_specificity': 0.9959276, 'binary_f1_score': 0.6520439}
confusion matrix:
       0    1
0  18097   74
1    275  327
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9623337, 'precision': 0.92566437, 'recall': 0.5164455, 'specificity': 0.5164455, 'f1': 0.5222626, 'auroc': 0.94360936, 'binary_precision': 0.8888889, 'binary_recall': 0.03305785, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.063745014}
confusion matrix:
      0  1
0  5996  1
1   234  8
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011744_22.png
better model found
persisted
after epoch: 22,now: 2024-06-03 03:43:21.997751,epoch time: 0:29:14.378840,used: 10:43:42.656996,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_16_59_39_seed_2_21011744
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9844606, 'precision': 0.9262829, 'recall': 0.8240229, 'specificity': 0.8240229, 'f1': 0.8676486, 'auroc': 0.98916173, 'binary_precision': 0.8649123, 'binary_recall': 0.6516854, 'binary_specificity': 0.9963603, 'binary_f1_score': 0.74330944}
confusion matrix:
       0    1
0  42157  154
1    527  986
---- Validation: 
scalar performance:
{'acc': 0.97981143, 'precision': 0.89198244, 'recall': 0.74464154, 'specificity': 0.74464154, 'f1': 0.8000601, 'auroc': 0.978608, 'binary_precision': 0.8005391, 'binary_recall': 0.49335548, 'binary_specificity': 0.9959276, 'binary_f1_score': 0.61048305}
confusion matrix:
       0    1
0  18097   74
1    305  297
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9669819, 'precision': 0.8313427, 'recall': 0.6318797, 'specificity': 0.6318797, 'f1': 0.6849694, 'auroc': 0.9569217, 'binary_precision': 0.69148934, 'binary_recall': 0.26859504, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.38690475}
confusion matrix:
      0   1
0  5968  29
1   177  65
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011744_23.png
early stop counter: 1
val acc:0.979811429977417, best validation acc: 0.98140949010849, corresponding to test acc:                         0.9623336791992188 / 0.9765987992286682
after epoch: 23,now: 2024-06-03 04:12:19.741408,epoch time: 0:28:57.743657,used: 11:12:40.400653,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_16_59_39_seed_2_21011744
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9836391, 'precision': 0.87180793, 'recall': 0.88860244, 'specificity': 0.88860244, 'f1': 0.88000274, 'auroc': 0.9836845, 'binary_precision': 0.7512626, 'binary_recall': 0.78651685, 'binary_specificity': 0.990688, 'binary_f1_score': 0.7684856}
confusion matrix:
       0     1
0  41917   394
1    323  1190
---- Validation: 
scalar performance:
{'acc': 0.9802376, 'precision': 0.8386961, 'recall': 0.84684885, 'specificity': 0.84684885, 'f1': 0.8427197, 'auroc': 0.9709126, 'binary_precision': 0.68719614, 'binary_recall': 0.70431894, 'binary_specificity': 0.9893787, 'binary_f1_score': 0.6956522}
confusion matrix:
       0    1
0  17978  193
1    178  424
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96281457, 'precision': 0.76163787, 'recall': 0.6019535, 'specificity': 0.6019535, 'f1': 0.6431426, 'auroc': 0.9465137, 'binary_precision': 0.5543478, 'binary_recall': 0.2107438, 'binary_specificity': 0.9931632, 'binary_f1_score': 0.30538923}
confusion matrix:
      0   1
0  5956  41
1   191  51
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011744_24.png
early stop counter: 2
val acc:0.980237603187561, best validation acc: 0.98140949010849, corresponding to test acc:                         0.9623336791992188 / 0.9765987992286682
after epoch: 24,now: 2024-06-03 04:41:20.104423,epoch time: 0:29:00.363015,used: 11:41:40.763668,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_16_59_39_seed_2_21011744
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.98564714, 'precision': 0.93668574, 'recall': 0.8341969, 'specificity': 0.8341969, 'f1': 0.87811077, 'auroc': 0.98848635, 'binary_precision': 0.8850174, 'binary_recall': 0.67151356, 'binary_specificity': 0.99688023, 'binary_f1_score': 0.7636227}
confusion matrix:
       0     1
0  42179   132
1    497  1016
---- Validation: 
scalar performance:
{'acc': 0.9812497, 'precision': 0.91840994, 'recall': 0.7493997, 'specificity': 0.7493997, 'f1': 0.8110895, 'auroc': 0.97591305, 'binary_precision': 0.85310733, 'binary_recall': 0.5016611, 'binary_specificity': 0.9971383, 'binary_f1_score': 0.6317991}
confusion matrix:
       0    1
0  18119   52
1    300  302
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96185285, 'precision': 0.7701934, 'recall': 0.5300746, 'specificity': 0.5300746, 'f1': 0.54622406, 'auroc': 0.9494158, 'binary_precision': 0.5769231, 'binary_recall': 0.06198347, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.1119403}
confusion matrix:
      0   1
0  5986  11
1   227  15
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011744_25.png
early stop counter: 3
val acc:0.9812496900558472, best validation acc: 0.98140949010849, corresponding to test acc:                         0.9623336791992188 / 0.9765987992286682
after epoch: 25,now: 2024-06-03 05:10:20.127197,epoch time: 0:29:00.022774,used: 12:10:40.786442,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_16_59_39_seed_2_21011744
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.98532766, 'precision': 0.9247755, 'recall': 0.8410418, 'specificity': 0.8410418, 'f1': 0.8779725, 'auroc': 0.9891858, 'binary_precision': 0.8606965, 'binary_recall': 0.68605417, 'binary_specificity': 0.9960294, 'binary_f1_score': 0.763516}
confusion matrix:
       0     1
0  42143   168
1    475  1038
---- Validation: 
scalar performance:
{'acc': 0.9820487, 'precision': 0.8883882, 'recall': 0.79719234, 'specificity': 0.79719234, 'f1': 0.8362695, 'auroc': 0.9789791, 'binary_precision': 0.78993434, 'binary_recall': 0.5996678, 'binary_specificity': 0.9947169, 'binary_f1_score': 0.6817752}
confusion matrix:
       0    1
0  18075   96
1    241  361
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96281457, 'precision': 0.9813774, 'recall': 0.5206612, 'specificity': 0.5206612, 'f1': 0.5301945, 'auroc': 0.94211674, 'binary_precision': 1.0, 'binary_recall': 0.041322313, 'binary_specificity': 1.0, 'binary_f1_score': 0.079365075}
confusion matrix:
      0   1
0  5997   0
1   232  10
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011744_26.png
better model found
persisted
after epoch: 26,now: 2024-06-03 05:39:22.790808,epoch time: 0:29:02.663611,used: 12:39:43.450053,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_16_59_39_seed_2_21011744
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.98726726, 'precision': 0.9162343, 'recall': 0.8869762, 'specificity': 0.8869762, 'f1': 0.9010283, 'auroc': 0.990183, 'binary_precision': 0.8403421, 'binary_recall': 0.7792465, 'binary_specificity': 0.99470586, 'binary_f1_score': 0.80864197}
confusion matrix:
       0     1
0  42087   224
1    334  1179
---- Validation: 
scalar performance:
{'acc': 0.98412615, 'precision': 0.9038706, 'recall': 0.8215539, 'specificity': 0.8215539, 'f1': 0.8576953, 'auroc': 0.9761603, 'binary_precision': 0.8193277, 'binary_recall': 0.64784056, 'binary_specificity': 0.9952672, 'binary_f1_score': 0.7235621}
confusion matrix:
       0    1
0  18085   86
1    212  390
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9620131, 'precision': 0.786008, 'recall': 0.52817523, 'specificity': 0.52817523, 'f1': 0.5431274, 'auroc': 0.94431514, 'binary_precision': 0.6086956, 'binary_recall': 0.05785124, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.10566038}
confusion matrix:
      0   1
0  5988   9
1   228  14
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011744_27.png
better model found
persisted
after epoch: 27,now: 2024-06-03 06:08:29.502645,epoch time: 0:29:06.711837,used: 13:08:50.161890,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_16_59_39_seed_2_21011744
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9815626, 'precision': 0.84594953, 'recall': 0.9037783, 'specificity': 0.9037783, 'f1': 0.8724145, 'auroc': 0.98771536, 'binary_precision': 0.698368, 'binary_recall': 0.8202247, 'binary_specificity': 0.9873319, 'binary_f1_score': 0.7544073}
confusion matrix:
       0     1
0  41775   536
1    272  1241
---- Validation: 
scalar performance:
{'acc': 0.97975814, 'precision': 0.83033675, 'recall': 0.8578439, 'specificity': 0.8578439, 'f1': 0.8434905, 'auroc': 0.97198796, 'binary_precision': 0.66972476, 'binary_recall': 0.72757477, 'binary_specificity': 0.9881129, 'binary_f1_score': 0.6974522}
confusion matrix:
       0    1
0  17955  216
1    164  438
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645777, 'precision': 0.7964089, 'recall': 0.60683614, 'specificity': 0.60683614, 'f1': 0.6529856, 'auroc': 0.9425998, 'binary_precision': 0.62352943, 'binary_recall': 0.21900827, 'binary_specificity': 0.994664, 'binary_f1_score': 0.32415903}
confusion matrix:
      0   1
0  5965  32
1   189  53
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011744_28.png
early stop counter: 1
val acc:0.9797581434249878, best validation acc: 0.9841261506080627, corresponding to test acc:                         0.9620131254196167 / 0.9765987992286682
after epoch: 28,now: 2024-06-03 06:37:30.543372,epoch time: 0:29:01.040727,used: 13:37:51.202617,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_16_59_39_seed_2_21011744
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.985419, 'precision': 0.9153242, 'recall': 0.85383517, 'specificity': 0.85383517, 'f1': 0.8819234, 'auroc': 0.98863673, 'binary_precision': 0.84087366, 'binary_recall': 0.71249175, 'binary_specificity': 0.9951786, 'binary_f1_score': 0.77137744}
confusion matrix:
       0     1
0  42107   204
1    435  1078
---- Validation: 
scalar performance:
{'acc': 0.9820487, 'precision': 0.8831342, 'recall': 0.80441976, 'specificity': 0.80441976, 'f1': 0.83892655, 'auroc': 0.97952724, 'binary_precision': 0.77894735, 'binary_recall': 0.61461794, 'binary_specificity': 0.99422157, 'binary_f1_score': 0.6870938}
confusion matrix:
       0    1
0  18066  105
1    232  370
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9620131, 'precision': 0.77810574, 'recall': 0.53214073, 'specificity': 0.53214073, 'f1': 0.5497736, 'auroc': 0.9317771, 'binary_precision': 0.5925926, 'binary_recall': 0.0661157, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.118959114}
confusion matrix:
      0   1
0  5986  11
1   226  16
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011744_29.png
early stop counter: 2
val acc:0.9820486903190613, best validation acc: 0.9841261506080627, corresponding to test acc:                         0.9620131254196167 / 0.9765987992286682
after epoch: 29,now: 2024-06-03 07:06:33.985464,epoch time: 0:29:03.442092,used: 14:06:54.644709,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_16_59_39_seed_2_21011744
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9860579, 'precision': 0.9108478, 'recall': 0.87169194, 'specificity': 0.87169194, 'f1': 0.8902092, 'auroc': 0.98969114, 'binary_precision': 0.83064514, 'binary_recall': 0.7488434, 'binary_specificity': 0.99454045, 'binary_f1_score': 0.78762597}
confusion matrix:
       0     1
0  42080   231
1    380  1133
---- Validation: 
scalar performance:
{'acc': 0.98455226, 'precision': 0.9075226, 'recall': 0.8257892, 'specificity': 0.8257892, 'f1': 0.86176443, 'auroc': 0.9737504, 'binary_precision': 0.8263598, 'binary_recall': 0.65614617, 'binary_specificity': 0.99543226, 'binary_f1_score': 0.7314815}
confusion matrix:
       0    1
0  18088   83
1    207  395
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95944864, 'precision': 0.6480557, 'recall': 0.52089304, 'specificity': 0.52089304, 'f1': 0.5296337, 'auroc': 0.9269178, 'binary_precision': 0.33333334, 'binary_recall': 0.045454547, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.080000006}
confusion matrix:
      0   1
0  5975  22
1   231  11
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011744_30.png
better model found
persisted
after epoch: 30,now: 2024-06-03 07:35:35.465543,epoch time: 0:29:01.480079,used: 14:35:56.124788,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_16_59_39_seed_2_21011744
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 14:35:56.124788 at 2024-06-03 07:35:35.465543
persisted model performance metric: 

scalar performance:
{'acc': 0.9597692, 'precision': 0.6479126, 'recall': 0.5170943, 'specificity': 0.5170943, 'f1': 0.523178, 'auroc': 0.92995036, 'binary_precision': 0.33333334, 'binary_recall': 0.037190083, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.0669145}
confusion matrix:
      0   1
0  5979  18
1   233   9
oracle model performance metric: 

scalar performance:
{'acc': 0.9759577, 'precision': 0.95138246, 'recall': 0.70594454, 'specificity': 0.70594454, 'f1': 0.7795303, 'auroc': 0.9514618, 'binary_precision': 0.9259259, 'binary_recall': 0.41322315, 'binary_specificity': 0.998666, 'binary_f1_score': 0.5714286}
confusion matrix:
      0    1
0  5989    8
1   142  100
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 459792 KiB |   2005 MiB |   2789 TiB |   2789 TiB |
|       from large pool | 418110 KiB |   1972 MiB |   2753 TiB |   2753 TiB |
|       from small pool |  41681 KiB |     61 MiB |     36 TiB |     36 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 459792 KiB |   2005 MiB |   2789 TiB |   2789 TiB |
|       from large pool | 418110 KiB |   1972 MiB |   2753 TiB |   2753 TiB |
|       from small pool |  41681 KiB |     61 MiB |     36 TiB |     36 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447753 KiB |   1998 MiB |   2785 TiB |   2785 TiB |
|       from large pool | 407075 KiB |   1966 MiB |   2749 TiB |   2749 TiB |
|       from small pool |  40678 KiB |     60 MiB |     36 TiB |     36 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2254 MiB |   2272 MiB |   5244 MiB |   2990 MiB |
|       from large pool |   2190 MiB |   2202 MiB |   5144 MiB |   2954 MiB |
|       from small pool |     64 MiB |     70 MiB |    100 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 320496 KiB | 412779 KiB |   2132 TiB |   2132 TiB |
|       from large pool | 310977 KiB | 402413 KiB |   2094 TiB |   2094 TiB |
|       from small pool |   9518 KiB |  22399 KiB |     37 TiB |     37 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3476    |    6467    |  541499 K  |  541495 K  |
|       from large pool |     187    |     311    |  263886 K  |  263886 K  |
|       from small pool |    3289    |    6279    |  277612 K  |  277609 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3476    |    6467    |  541499 K  |  541495 K  |
|       from large pool |     187    |     311    |  263886 K  |  263886 K  |
|       from small pool |    3289    |    6279    |  277612 K  |  277609 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     124    |     127    |     261    |     137    |
|       from large pool |      92    |      92    |     211    |     119    |
|       from small pool |      32    |      35    |      50    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      59    |    2793    |  288880 K  |  288879 K  |
|       from large pool |      28    |      89    |  180782 K  |  180782 K  |
|       from small pool |      31    |    2759    |  108097 K  |  108097 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2005 MiB |   2789 TiB |   2789 TiB |
|       from large pool |  16640 KiB |   1972 MiB |   2753 TiB |   2753 TiB |
|       from small pool |      0 KiB |     61 MiB |     36 TiB |     36 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2005 MiB |   2789 TiB |   2789 TiB |
|       from large pool |  16640 KiB |   1972 MiB |   2753 TiB |   2753 TiB |
|       from small pool |      0 KiB |     61 MiB |     36 TiB |     36 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB |   2785 TiB |   2785 TiB |
|       from large pool |  16640 KiB |   1966 MiB |   2749 TiB |   2749 TiB |
|       from small pool |      0 KiB |     60 MiB |     36 TiB |     36 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 780288 KiB |   2272 MiB |   5244 MiB |   4482 MiB |
|       from large pool | 729088 KiB |   2202 MiB |   5144 MiB |   4432 MiB |
|       from small pool |  51200 KiB |     70 MiB |    100 MiB |     50 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 412779 KiB |   2132 TiB |   2132 TiB |
|       from large pool |  24320 KiB | 402413 KiB |   2094 TiB |   2094 TiB |
|       from small pool |      0 KiB |  22399 KiB |     37 TiB |     37 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6467    |  541499 K  |  541499 K  |
|       from large pool |       2    |     311    |  263886 K  |  263886 K  |
|       from small pool |       0    |    6279    |  277612 K  |  277612 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6467    |  541499 K  |  541499 K  |
|       from large pool |       2    |     311    |  263886 K  |  263886 K  |
|       from small pool |       0    |    6279    |  277612 K  |  277612 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      57    |     127    |     261    |     204    |
|       from large pool |      32    |      92    |     211    |     179    |
|       from small pool |      25    |      35    |      50    |      25    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2793    |  288881 K  |  288881 K  |
|       from large pool |       3    |      89    |  180782 K  |  180782 K  |
|       from small pool |       0    |    2759    |  108098 K  |  108098 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Mon Jun  3 07:38:18 2024]
Finished job 0.
1 of 1 steps (100%) done
