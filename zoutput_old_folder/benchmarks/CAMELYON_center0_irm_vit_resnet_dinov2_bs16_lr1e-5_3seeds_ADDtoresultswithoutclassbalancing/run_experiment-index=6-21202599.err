Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Fri Jun  7 18:55:28 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_new/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_new/rule_results/6.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=6
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_19_05_23_seed_0_21202599

 Experiment start at: 2024-06-07 19:05:23.880943
before training, model accuracy: 0.955097496509552
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.97351116, 'precision': 0.8091929, 'recall': 0.7425241, 'specificity': 0.7425241, 'f1': 0.77146137, 'auroc': 0.96903753, 'binary_precision': 0.6358079, 'binary_recall': 0.49490142, 'binary_specificity': 0.99014676, 'binary_f1_score': 0.55657494}
confusion matrix:
       0    1
0  41904  417
1    743  728
---- Validation: 
scalar performance:
{'acc': 0.97121114, 'precision': 0.78554976, 'recall': 0.75932896, 'specificity': 0.75932896, 'f1': 0.7717439, 'auroc': 0.9695811, 'binary_precision': 0.58762884, 'binary_recall': 0.5318818, 'binary_specificity': 0.9867761, 'binary_f1_score': 0.5583673}
confusion matrix:
       0    1
0  17909  240
1    301  342
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.7729144, 'recall': 0.57979083, 'specificity': 0.57979083, 'f1': 0.61813736, 'auroc': 0.9488041, 'binary_precision': 0.5810811, 'binary_recall': 0.16475096, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.25671643}
confusion matrix:
      0   1
0  5966  31
1   218  43
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202599_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-07 19:46:46.322763,epoch time: 0:41:22.441820,used: 0:41:22.441820,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_19_05_23_seed_0_21202599
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97611433, 'precision': 0.8189682, 'recall': 0.8055519, 'specificity': 0.8055519, 'f1': 0.8121023, 'auroc': 0.9765725, 'binary_precision': 0.65103054, 'binary_recall': 0.62270564, 'binary_specificity': 0.9883982, 'binary_f1_score': 0.6365531}
confusion matrix:
       0    1
0  41830  491
1    555  916
---- Validation: 
scalar performance:
{'acc': 0.975894, 'precision': 0.8214158, 'recall': 0.8045065, 'specificity': 0.8045065, 'f1': 0.8127109, 'auroc': 0.9752623, 'binary_precision': 0.65625, 'binary_recall': 0.62052876, 'binary_specificity': 0.9884842, 'binary_f1_score': 0.63788974}
confusion matrix:
       0    1
0  17940  209
1    244  399
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9742729, 'precision': 0.90553373, 'recall': 0.7373792, 'specificity': 0.7373792, 'f1': 0.7974861, 'auroc': 0.95156693, 'binary_precision': 0.8333333, 'binary_recall': 0.4789272, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.6082725}
confusion matrix:
      0    1
0  5972   25
1   136  125
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202599_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-07 20:26:14.235328,epoch time: 0:39:27.912565,used: 1:20:50.354385,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_19_05_23_seed_0_21202599
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97965384, 'precision': 0.9447031, 'recall': 0.7186614, 'specificity': 0.7186614, 'f1': 0.7907065, 'auroc': 0.98409355, 'binary_precision': 0.90857947, 'binary_recall': 0.4388587, 'binary_specificity': 0.9984641, 'binary_f1_score': 0.5918461}
confusion matrix:
       0    1
0  42255   65
1    826  646
---- Validation: 
scalar performance:
{'acc': 0.97722435, 'precision': 0.95141983, 'recall': 0.6814361, 'specificity': 0.6814361, 'f1': 0.75532776, 'auroc': 0.9803904, 'binary_precision': 0.9249012, 'binary_recall': 0.36391914, 'binary_specificity': 0.9989531, 'binary_f1_score': 0.52232146}
confusion matrix:
       0    1
0  18130   19
1    409  234
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.9383205, 'recall': 0.5209894, 'specificity': 0.5209894, 'f1': 0.5300423, 'auroc': 0.9570615, 'binary_precision': 0.9166667, 'binary_recall': 0.042145595, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.08058608}
confusion matrix:
      0   1
0  5996   1
1   250  11
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202599_3.png
better model found
persisted
after epoch: 3,now: 2024-06-07 21:05:41.709022,epoch time: 0:39:27.473694,used: 2:00:17.828079,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_19_05_23_seed_0_21202599
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98164046, 'precision': 0.8457601, 'recall': 0.8931267, 'specificity': 0.8931267, 'f1': 0.86778146, 'auroc': 0.9863615, 'binary_precision': 0.6985731, 'binary_recall': 0.7982337, 'binary_specificity': 0.9880198, 'binary_f1_score': 0.74508554}
confusion matrix:
       0     1
0  41813   507
1    297  1175
---- Validation: 
scalar performance:
{'acc': 0.98217326, 'precision': 0.8609934, 'recall': 0.8745123, 'specificity': 0.8745123, 'f1': 0.86761713, 'auroc': 0.9804113, 'binary_precision': 0.7305389, 'binary_recall': 0.7589425, 'binary_specificity': 0.9900821, 'binary_f1_score': 0.7444699}
confusion matrix:
       0    1
0  17969  180
1    155  488
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96692234, 'precision': 0.848326, 'recall': 0.6639153, 'specificity': 0.6639153, 'f1': 0.7198174, 'auroc': 0.962152, 'binary_precision': 0.725, 'binary_recall': 0.33333334, 'binary_specificity': 0.99449724, 'binary_f1_score': 0.4566929}
confusion matrix:
      0   1
0  5964  33
1   174  87
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202599_4.png
better model found
persisted
after epoch: 4,now: 2024-06-07 21:44:54.261670,epoch time: 0:39:12.552648,used: 2:39:30.380727,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_19_05_23_seed_0_21202599
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9823712, 'precision': 0.8834363, 'recall': 0.8288026, 'specificity': 0.8288026, 'f1': 0.8538518, 'auroc': 0.9869505, 'binary_precision': 0.7784861, 'binary_recall': 0.664174, 'binary_specificity': 0.99343115, 'binary_f1_score': 0.71680117}
confusion matrix:
       0    1
0  42043  278
1    494  977
---- Validation: 
scalar performance:
{'acc': 0.9805768, 'precision': 0.8755323, 'recall': 0.80918103, 'specificity': 0.80918103, 'f1': 0.83887196, 'auroc': 0.97824746, 'binary_precision': 0.76425856, 'binary_recall': 0.62519443, 'binary_specificity': 0.99316764, 'binary_f1_score': 0.6877674}
confusion matrix:
       0    1
0  18025  124
1    241  402
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96212846, 'precision': 0.81188166, 'recall': 0.5936177, 'specificity': 0.5936177, 'f1': 0.63863814, 'auroc': 0.9506711, 'binary_precision': 0.65789473, 'binary_recall': 0.19157088, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.2967359}
confusion matrix:
      0   1
0  5971  26
1   211  50
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202599_5.png
early stop counter: 1
val acc:0.9805768132209778, best validation acc: 0.9821732640266418, corresponding to test acc:                         0.9669223427772522 / 0.9742729067802429
after epoch: 5,now: 2024-06-07 22:24:27.397024,epoch time: 0:39:33.135354,used: 3:19:03.516081,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_19_05_23_seed_0_21202599
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9837642, 'precision': 0.8660718, 'recall': 0.8945534, 'specificity': 0.8945534, 'f1': 0.87973124, 'auroc': 0.98599064, 'binary_precision': 0.73915774, 'binary_recall': 0.79891306, 'binary_specificity': 0.9901938, 'binary_f1_score': 0.7678746}
confusion matrix:
       0     1
0  41905   415
1    296  1176
---- Validation: 
scalar performance:
{'acc': 0.9830779, 'precision': 0.8734641, 'recall': 0.86898017, 'specificity': 0.86898017, 'f1': 0.8712074, 'auroc': 0.9817474, 'binary_precision': 0.7559055, 'binary_recall': 0.7465008, 'binary_specificity': 0.9914596, 'binary_f1_score': 0.75117373}
confusion matrix:
       0    1
0  17994  155
1    163  480
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96180886, 'precision': 0.7784029, 'recall': 0.637427, 'specificity': 0.637427, 'f1': 0.68136203, 'auroc': 0.94139326, 'binary_precision': 0.5873016, 'binary_recall': 0.2835249, 'binary_specificity': 0.991329, 'binary_f1_score': 0.38242897}
confusion matrix:
      0   1
0  5945  52
1   187  74
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202599_6.png
better model found
persisted
after epoch: 6,now: 2024-06-07 23:04:00.021258,epoch time: 0:39:32.624234,used: 3:58:36.140315,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_19_05_23_seed_0_21202599
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98629886, 'precision': 0.9486165, 'recall': 0.82799804, 'specificity': 0.82799804, 'f1': 0.8782692, 'auroc': 0.9922973, 'binary_precision': 0.90900564, 'binary_recall': 0.65828806, 'binary_specificity': 0.99770796, 'binary_f1_score': 0.7635934}
confusion matrix:
       0    1
0  42223   97
1    503  969
---- Validation: 
scalar performance:
{'acc': 0.9844615, 'precision': 0.9431297, 'recall': 0.8059418, 'specificity': 0.8059418, 'f1': 0.8610649, 'auroc': 0.98374474, 'binary_precision': 0.8997722, 'binary_recall': 0.61430794, 'binary_specificity': 0.99757564, 'binary_f1_score': 0.7301294}
confusion matrix:
       0    1
0  18105   44
1    248  395
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.8245563, 'recall': 0.54131186, 'specificity': 0.54131186, 'f1': 0.5648996, 'auroc': 0.95906305, 'binary_precision': 0.6875, 'binary_recall': 0.08429119, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.15017064}
confusion matrix:
      0   1
0  5987  10
1   239  22
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202599_7.png
better model found
persisted
after epoch: 7,now: 2024-06-07 23:43:25.329753,epoch time: 0:39:25.308495,used: 4:38:01.448810,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_19_05_23_seed_0_21202599
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9849516, 'precision': 0.8608505, 'recall': 0.937713, 'specificity': 0.937713, 'f1': 0.89523506, 'auroc': 0.9919989, 'binary_precision': 0.7256539, 'binary_recall': 0.8870748, 'binary_specificity': 0.9883512, 'binary_f1_score': 0.7982859}
confusion matrix:
       0     1
0  41829   493
1    166  1304
---- Validation: 
scalar performance:
{'acc': 0.98403573, 'precision': 0.86407787, 'recall': 0.91297925, 'specificity': 0.91297925, 'f1': 0.8868456, 'auroc': 0.9837423, 'binary_precision': 0.73397, 'binary_recall': 0.83670294, 'binary_specificity': 0.9892556, 'binary_f1_score': 0.7819767}
confusion matrix:
       0    1
0  17954  195
1    105  538
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9643656, 'precision': 0.8076047, 'recall': 0.65891665, 'specificity': 0.65891665, 'f1': 0.70708764, 'auroc': 0.9485924, 'binary_precision': 0.6439394, 'binary_recall': 0.3256705, 'binary_specificity': 0.99216276, 'binary_f1_score': 0.43256998}
confusion matrix:
      0   1
0  5950  47
1   176  85
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202599_8.png
early stop counter: 1
val acc:0.9840357303619385, best validation acc: 0.9844614863395691, corresponding to test acc:                         0.960210919380188 / 0.9742729067802429
after epoch: 8,now: 2024-06-08 00:22:22.069700,epoch time: 0:38:56.739947,used: 5:16:58.188757,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_19_05_23_seed_0_21202599
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9878745, 'precision': 0.9347944, 'recall': 0.8691399, 'specificity': 0.8691399, 'f1': 0.8990816, 'auroc': 0.9930415, 'binary_precision': 0.8785197, 'binary_recall': 0.7418478, 'binary_specificity': 0.99643195, 'binary_f1_score': 0.8044199}
confusion matrix:
       0     1
0  42169   151
1    380  1092
---- Validation: 
scalar performance:
{'acc': 0.98169434, 'precision': 0.911324, 'recall': 0.78650784, 'specificity': 0.78650784, 'f1': 0.83690804, 'auroc': 0.98197615, 'binary_precision': 0.8374718, 'binary_recall': 0.5769829, 'binary_specificity': 0.99603283, 'binary_f1_score': 0.68324125}
confusion matrix:
       0    1
0  18077   72
1    272  371
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964046, 'precision': 0.8582687, 'recall': 0.60194755, 'specificity': 0.60194755, 'f1': 0.652928, 'auroc': 0.9528518, 'binary_precision': 0.75, 'binary_recall': 0.20689656, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.32432434}
confusion matrix:
      0   1
0  5979  18
1   207  54
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202599_9.png
early stop counter: 2
val acc:0.9816943407058716, best validation acc: 0.9844614863395691, corresponding to test acc:                         0.960210919380188 / 0.9742729067802429
after epoch: 9,now: 2024-06-08 01:00:45.793441,epoch time: 0:38:23.723741,used: 5:55:21.912498,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_19_05_23_seed_0_21202599
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9895871, 'precision': 0.9125288, 'recall': 0.9309183, 'specificity': 0.9309183, 'f1': 0.9215063, 'auroc': 0.9949763, 'binary_precision': 0.8296489, 'binary_recall': 0.8680272, 'binary_specificity': 0.99380934, 'binary_f1_score': 0.8484042}
confusion matrix:
       0     1
0  42060   262
1    194  1276
---- Validation: 
scalar performance:
{'acc': 0.9859515, 'precision': 0.9034485, 'recall': 0.87796843, 'specificity': 0.87796843, 'f1': 0.8902583, 'auroc': 0.98610836, 'binary_precision': 0.8153078, 'binary_recall': 0.7620529, 'binary_specificity': 0.99388397, 'binary_f1_score': 0.78778136}
confusion matrix:
       0    1
0  18038  111
1    153  490
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606903, 'precision': 0.7999648, 'recall': 0.5653823, 'specificity': 0.5653823, 'f1': 0.6006775, 'auroc': 0.9467274, 'binary_precision': 0.6363636, 'binary_recall': 0.13409962, 'binary_specificity': 0.996665, 'binary_f1_score': 0.221519}
confusion matrix:
      0   1
0  5977  20
1   226  35
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202599_10.png
better model found
persisted
after epoch: 10,now: 2024-06-08 01:39:07.410913,epoch time: 0:38:21.617472,used: 6:33:43.529970,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_19_05_23_seed_0_21202599
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9893816, 'precision': 0.90866023, 'recall': 0.93352437, 'specificity': 0.93352437, 'f1': 0.92069423, 'auroc': 0.99588525, 'binary_precision': 0.82172525, 'binary_recall': 0.8736413, 'binary_specificity': 0.99340737, 'binary_f1_score': 0.84688836}
confusion matrix:
       0     1
0  42041   279
1    186  1286
---- Validation: 
scalar performance:
{'acc': 0.9853661, 'precision': 0.9024376, 'recall': 0.8679147, 'specificity': 0.8679147, 'f1': 0.88433826, 'auroc': 0.9820838, 'binary_precision': 0.81399316, 'binary_recall': 0.7418352, 'binary_specificity': 0.9939942, 'binary_f1_score': 0.7762408}
confusion matrix:
       0    1
0  18040  109
1    166  477
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96772134, 'precision': 0.88421476, 'recall': 0.64967346, 'specificity': 0.64967346, 'f1': 0.7111358, 'auroc': 0.9385165, 'binary_precision': 0.7979798, 'binary_recall': 0.30268198, 'binary_specificity': 0.996665, 'binary_f1_score': 0.43888888}
confusion matrix:
      0   1
0  5977  20
1   182  79
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202599_11.png
early stop counter: 1
val acc:0.9853661060333252, best validation acc: 0.9859514832496643, corresponding to test acc:                         0.9606903195381165 / 0.9742729067802429
after epoch: 11,now: 2024-06-08 02:17:20.745311,epoch time: 0:38:13.334398,used: 7:11:56.864368,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_19_05_23_seed_0_21202599
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9908659, 'precision': 0.9610486, 'recall': 0.89291, 'specificity': 0.89291, 'f1': 0.9240598, 'auroc': 0.9960508, 'binary_precision': 0.9294306, 'binary_recall': 0.7878994, 'binary_specificity': 0.99792063, 'binary_f1_score': 0.8528329}
confusion matrix:
       0     1
0  42233    88
1    312  1159
---- Validation: 
scalar performance:
{'acc': 0.9860047, 'precision': 0.9453487, 'recall': 0.8299924, 'specificity': 0.8299924, 'f1': 0.87845695, 'auroc': 0.986326, 'binary_precision': 0.90254235, 'binary_recall': 0.66251945, 'binary_specificity': 0.99746543, 'binary_f1_score': 0.7641256}
confusion matrix:
       0    1
0  18103   46
1    217  426
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96340686, 'precision': 0.838521, 'recall': 0.60161406, 'specificity': 0.60161406, 'f1': 0.650836, 'auroc': 0.9426999, 'binary_precision': 0.7105263, 'binary_recall': 0.20689656, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.32047477}
confusion matrix:
      0   1
0  5975  22
1   207  54
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202599_12.png
better model found
persisted
after epoch: 12,now: 2024-06-08 02:55:33.520832,epoch time: 0:38:12.775521,used: 7:50:09.639889,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_19_05_23_seed_0_21202599
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9914596, 'precision': 0.95246094, 'recall': 0.9119772, 'specificity': 0.9119772, 'f1': 0.9311987, 'auroc': 0.996946, 'binary_precision': 0.91092813, 'binary_recall': 0.8267663, 'binary_specificity': 0.9971881, 'binary_f1_score': 0.8668091}
confusion matrix:
       0     1
0  42201   119
1    255  1217
---- Validation: 
scalar performance:
{'acc': 0.9849404, 'precision': 0.92628396, 'recall': 0.8301915, 'specificity': 0.8301915, 'f1': 0.8716674, 'auroc': 0.9867103, 'binary_precision': 0.8643725, 'binary_recall': 0.66407466, 'binary_specificity': 0.9963083, 'binary_f1_score': 0.7510994}
confusion matrix:
       0    1
0  18082   67
1    216  427
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.8120588, 'recall': 0.6179383, 'specificity': 0.6179383, 'f1': 0.66697145, 'auroc': 0.95318717, 'binary_precision': 0.65625, 'binary_recall': 0.2413793, 'binary_specificity': 0.99449724, 'binary_f1_score': 0.35294116}
confusion matrix:
      0   1
0  5964  33
1   198  63
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202599_13.png
early stop counter: 1
val acc:0.9849404096603394, best validation acc: 0.9860047101974487, corresponding to test acc:                         0.9634068608283997 / 0.9742729067802429
after epoch: 13,now: 2024-06-08 03:33:46.388939,epoch time: 0:38:12.868107,used: 8:28:22.507996,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_19_05_23_seed_0_21202599
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99148244, 'precision': 0.941896, 'recall': 0.9247755, 'specificity': 0.9247755, 'f1': 0.9331534, 'auroc': 0.9966103, 'binary_precision': 0.8888889, 'binary_recall': 0.8532609, 'binary_specificity': 0.99629015, 'binary_f1_score': 0.87071055}
confusion matrix:
       0     1
0  42163   157
1    216  1256
---- Validation: 
scalar performance:
{'acc': 0.9864304, 'precision': 0.9306787, 'recall': 0.8519644, 'specificity': 0.8519644, 'f1': 0.88705707, 'auroc': 0.9814122, 'binary_precision': 0.87164754, 'binary_recall': 0.7076205, 'binary_specificity': 0.9963083, 'binary_f1_score': 0.7811159}
confusion matrix:
       0    1
0  18082   67
1    188  455
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96180886, 'precision': 0.8338796, 'recall': 0.5714629, 'specificity': 0.5714629, 'f1': 0.6108406, 'auroc': 0.9508683, 'binary_precision': 0.7037037, 'binary_recall': 0.14559387, 'binary_specificity': 0.997332, 'binary_f1_score': 0.24126984}
confusion matrix:
      0   1
0  5981  16
1   223  38
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202599_14.png
better model found
persisted
after epoch: 14,now: 2024-06-08 04:11:58.707765,epoch time: 0:38:12.318826,used: 9:06:34.826822,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_19_05_23_seed_0_21202599
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9914368, 'precision': 0.9175993, 'recall': 0.95882344, 'specificity': 0.95882344, 'f1': 0.93716013, 'auroc': 0.9975531, 'binary_precision': 0.8378545, 'binary_recall': 0.9238613, 'binary_specificity': 0.9937856, 'binary_f1_score': 0.8787585}
confusion matrix:
       0     1
0  42058   263
1    112  1359
---- Validation: 
scalar performance:
{'acc': 0.9864304, 'precision': 0.8980092, 'recall': 0.8962177, 'specificity': 0.8962177, 'f1': 0.8971113, 'auroc': 0.9797524, 'binary_precision': 0.803125, 'binary_recall': 0.7993779, 'binary_specificity': 0.9930575, 'binary_f1_score': 0.8012471}
confusion matrix:
       0    1
0  18023  126
1    129  514
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96740174, 'precision': 0.8686271, 'recall': 0.6550037, 'specificity': 0.6550037, 'f1': 0.7144296, 'auroc': 0.9529567, 'binary_precision': 0.76635516, 'binary_recall': 0.31417623, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.4456522}
confusion matrix:
      0   1
0  5972  25
1   179  82
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202599_15.png
early stop counter: 1
val acc:0.9864304065704346, best validation acc: 0.9864304065704346, corresponding to test acc:                         0.9618088603019714 / 0.9742729067802429
after epoch: 15,now: 2024-06-08 04:50:15.267066,epoch time: 0:38:16.559301,used: 9:44:51.386123,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_19_05_23_seed_0_21202599
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9910714, 'precision': 0.9802257, 'recall': 0.8789904, 'specificity': 0.8789904, 'f1': 0.92322266, 'auroc': 0.99719906, 'binary_precision': 0.9687771, 'binary_recall': 0.7588315, 'binary_specificity': 0.9991493, 'binary_f1_score': 0.8510476}
confusion matrix:
       0     1
0  42284    36
1    355  1117
---- Validation: 
scalar performance:
{'acc': 0.9856854, 'precision': 0.9659241, 'recall': 0.80807555, 'specificity': 0.80807555, 'f1': 0.8697885, 'auroc': 0.9837711, 'binary_precision': 0.9452381, 'binary_recall': 0.61741835, 'binary_specificity': 0.9987327, 'binary_f1_score': 0.7469427}
confusion matrix:
       0    1
0  18126   23
1    246  397
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579738, 'precision': 0.7107917, 'recall': 0.52182126, 'specificity': 0.52182126, 'f1': 0.5310587, 'auroc': 0.9461121, 'binary_precision': 0.46153846, 'binary_recall': 0.04597701, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.08362369}
confusion matrix:
      0   1
0  5983  14
1   249  12
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202599_16.png
early stop counter: 2
val acc:0.985685408115387, best validation acc: 0.9864304065704346, corresponding to test acc:                         0.9618088603019714 / 0.9742729067802429
after epoch: 16,now: 2024-06-08 05:28:39.510163,epoch time: 0:38:24.243097,used: 10:23:15.629220,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_19_05_23_seed_0_21202599
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9944967, 'precision': 0.96484995, 'recall': 0.94928515, 'specificity': 0.94928515, 'f1': 0.9569249, 'auroc': 0.9986559, 'binary_precision': 0.93314564, 'binary_recall': 0.9008152, 'binary_specificity': 0.99775517, 'binary_f1_score': 0.9166955}
confusion matrix:
       0     1
0  42225    95
1    146  1326
---- Validation: 
scalar performance:
{'acc': 0.9865368, 'precision': 0.93305266, 'recall': 0.8512695, 'specificity': 0.8512695, 'f1': 0.8875691, 'auroc': 0.985706, 'binary_precision': 0.87644786, 'binary_recall': 0.7060653, 'binary_specificity': 0.9964736, 'binary_f1_score': 0.7820844}
confusion matrix:
       0    1
0  18085   64
1    189  454
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96276766, 'precision': 0.82761526, 'recall': 0.59578353, 'specificity': 0.59578353, 'f1': 0.64267474, 'auroc': 0.95672464, 'binary_precision': 0.6891892, 'binary_recall': 0.1954023, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.30447763}
confusion matrix:
      0   1
0  5974  23
1   210  51
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202599_17.png
better model found
persisted
after epoch: 17,now: 2024-06-08 06:07:03.480427,epoch time: 0:38:23.970264,used: 11:01:39.599484,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_19_05_23_seed_0_21202599
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99246436, 'precision': 0.9356917, 'recall': 0.95052874, 'specificity': 0.95052874, 'f1': 0.94297594, 'auroc': 0.9979214, 'binary_precision': 0.87467194, 'binary_recall': 0.9055706, 'binary_specificity': 0.9954868, 'binary_f1_score': 0.8898531}
confusion matrix:
       0     1
0  42129   191
1    139  1333
---- Validation: 
scalar performance:
{'acc': 0.98472756, 'precision': 0.89287, 'recall': 0.8698342, 'specificity': 0.8698342, 'f1': 0.88097465, 'auroc': 0.9840752, 'binary_precision': 0.794702, 'binary_recall': 0.7465008, 'binary_specificity': 0.99316764, 'binary_f1_score': 0.7698477}
confusion matrix:
       0    1
0  18025  124
1    163  480
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96212846, 'precision': 0.7897019, 'recall': 0.62293506, 'specificity': 0.62293506, 'f1': 0.6691063, 'auroc': 0.9553578, 'binary_precision': 0.6111111, 'binary_recall': 0.25287357, 'binary_specificity': 0.9929965, 'binary_f1_score': 0.35772356}
confusion matrix:
      0   1
0  5955  42
1   195  66
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202599_18.png
early stop counter: 1
val acc:0.9847275614738464, best validation acc: 0.9865368008613586, corresponding to test acc:                         0.9627676606178284 / 0.9742729067802429
after epoch: 18,now: 2024-06-08 06:45:16.913823,epoch time: 0:38:13.433396,used: 11:39:53.032880,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_19_05_23_seed_0_21202599
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9924187, 'precision': 0.98318887, 'recall': 0.89771974, 'specificity': 0.89771974, 'f1': 0.936012, 'auroc': 0.9982074, 'binary_precision': 0.97342193, 'binary_recall': 0.7961956, 'binary_specificity': 0.99924386, 'binary_f1_score': 0.87593424}
confusion matrix:
       0     1
0  42288    32
1    300  1172
---- Validation: 
scalar performance:
{'acc': 0.98472756, 'precision': 0.9686049, 'recall': 0.79107845, 'specificity': 0.79107845, 'f1': 0.8576936, 'auroc': 0.98298526, 'binary_precision': 0.9517766, 'binary_recall': 0.58320373, 'binary_specificity': 0.9989531, 'binary_f1_score': 0.72324014}
confusion matrix:
       0    1
0  18130   19
1    268  375
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96260786, 'precision': 0.85499394, 'recall': 0.57737684, 'specificity': 0.57737684, 'f1': 0.62015665, 'auroc': 0.949523, 'binary_precision': 0.74545455, 'binary_recall': 0.15708812, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.25949365}
confusion matrix:
      0   1
0  5983  14
1   220  41
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202599_19.png
early stop counter: 2
val acc:0.9847275614738464, best validation acc: 0.9865368008613586, corresponding to test acc:                         0.9627676606178284 / 0.9742729067802429
after epoch: 19,now: 2024-06-08 07:23:32.694854,epoch time: 0:38:15.781031,used: 12:18:08.813911,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_19_05_23_seed_0_21202599
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9948164, 'precision': 0.9591464, 'recall': 0.9612535, 'specificity': 0.9612535, 'f1': 0.9601974, 'auroc': 0.99854076, 'binary_precision': 0.9208925, 'binary_recall': 0.92527175, 'binary_specificity': 0.99723536, 'binary_f1_score': 0.9230769}
confusion matrix:
       0     1
0  42203   117
1    110  1362
---- Validation: 
scalar performance:
{'acc': 0.9877607, 'precision': 0.92976797, 'recall': 0.8766549, 'specificity': 0.8766549, 'f1': 0.901324, 'auroc': 0.98352325, 'binary_precision': 0.8680927, 'binary_recall': 0.7573872, 'binary_specificity': 0.9959226, 'binary_f1_score': 0.8089701}
confusion matrix:
       0    1
0  18075   74
1    156  487
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.8253925, 'recall': 0.5619678, 'specificity': 0.5619678, 'f1': 0.5968428, 'auroc': 0.9437971, 'binary_precision': 0.6875, 'binary_recall': 0.12643678, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.21359225}
confusion matrix:
      0   1
0  5982  15
1   228  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202599_20.png
better model found
persisted
after epoch: 20,now: 2024-06-08 08:01:49.708252,epoch time: 0:38:17.013398,used: 12:56:25.827309,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_19_05_23_seed_0_21202599
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.994314, 'precision': 0.9654542, 'recall': 0.94558424, 'specificity': 0.94558424, 'f1': 0.95528597, 'auroc': 0.9988191, 'binary_precision': 0.93461263, 'binary_recall': 0.8933424, 'binary_specificity': 0.9978261, 'binary_f1_score': 0.9135116}
confusion matrix:
       0     1
0  42228    92
1    157  1315
---- Validation: 
scalar performance:
{'acc': 0.98573864, 'precision': 0.9207157, 'recall': 0.8508562, 'specificity': 0.8508562, 'f1': 0.8823739, 'auroc': 0.98387593, 'binary_precision': 0.8517824, 'binary_recall': 0.7060653, 'binary_specificity': 0.99564713, 'binary_f1_score': 0.7721088}
confusion matrix:
       0    1
0  18070   79
1    189  454
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9680409, 'precision': 0.85645944, 'recall': 0.67732525, 'specificity': 0.67732525, 'f1': 0.7340226, 'auroc': 0.9570689, 'binary_precision': 0.7401575, 'binary_recall': 0.36015326, 'binary_specificity': 0.99449724, 'binary_f1_score': 0.48453605}
confusion matrix:
      0   1
0  5964  33
1   167  94
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202599_21.png
early stop counter: 1
val acc:0.9857386350631714, best validation acc: 0.9877607226371765, corresponding to test acc:                         0.9611697196960449 / 0.9742729067802429
after epoch: 21,now: 2024-06-08 08:40:07.116829,epoch time: 0:38:17.408577,used: 13:34:43.235886,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_19_05_23_seed_0_21202599
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9923959, 'precision': 0.95369184, 'recall': 0.92655957, 'specificity': 0.92655957, 'f1': 0.93967533, 'auroc': 0.99796045, 'binary_precision': 0.9123823, 'binary_recall': 0.85597825, 'binary_specificity': 0.9971408, 'binary_f1_score': 0.8832807}
confusion matrix:
       0     1
0  42199   121
1    212  1260
---- Validation: 
scalar performance:
{'acc': 0.98467433, 'precision': 0.91046524, 'recall': 0.84355474, 'specificity': 0.84355474, 'f1': 0.8738035, 'auroc': 0.9769186, 'binary_precision': 0.8317757, 'binary_recall': 0.69206846, 'binary_specificity': 0.9950411, 'binary_f1_score': 0.75551784}
confusion matrix:
       0    1
0  18059   90
1    198  445
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96212846, 'precision': 0.8745173, 'recall': 0.56246805, 'specificity': 0.56246805, 'f1': 0.5992082, 'auroc': 0.9351063, 'binary_precision': 0.78571427, 'binary_recall': 0.12643678, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.21782179}
confusion matrix:
      0   1
0  5988   9
1   228  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202599_22.png
early stop counter: 2
val acc:0.984674334526062, best validation acc: 0.9877607226371765, corresponding to test acc:                         0.9611697196960449 / 0.9742729067802429
after epoch: 22,now: 2024-06-08 09:18:38.295591,epoch time: 0:38:31.178762,used: 14:13:14.414648,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_19_05_23_seed_0_21202599
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99360615, 'precision': 0.9408266, 'recall': 0.96390593, 'specificity': 0.96390593, 'f1': 0.95204806, 'auroc': 0.9984585, 'binary_precision': 0.8840206, 'binary_recall': 0.9320652, 'binary_specificity': 0.9957467, 'binary_f1_score': 0.9074074}
confusion matrix:
       0     1
0  42140   180
1    100  1372
---- Validation: 
scalar performance:
{'acc': 0.9863772, 'precision': 0.89827603, 'recall': 0.89469004, 'specificity': 0.89469004, 'f1': 0.89647424, 'auroc': 0.9842114, 'binary_precision': 0.8037677, 'binary_recall': 0.7962675, 'binary_specificity': 0.99311256, 'binary_f1_score': 0.8000001}
confusion matrix:
       0    1
0  18024  125
1    131  512
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650048, 'precision': 0.82283723, 'recall': 0.6519208, 'specificity': 0.6519208, 'f1': 0.70357496, 'auroc': 0.9397243, 'binary_precision': 0.675, 'binary_recall': 0.31034482, 'binary_specificity': 0.9934968, 'binary_f1_score': 0.42519686}
confusion matrix:
      0   1
0  5958  39
1   180  81
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202599_23.png
early stop counter: 3
val acc:0.9863771796226501, best validation acc: 0.9877607226371765, corresponding to test acc:                         0.9611697196960449 / 0.9742729067802429
after epoch: 23,now: 2024-06-08 09:57:18.037715,epoch time: 0:38:39.742124,used: 14:51:54.156772,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_19_05_23_seed_0_21202599
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99588966, 'precision': 0.9680382, 'recall': 0.96865284, 'specificity': 0.96865284, 'f1': 0.9683453, 'auroc': 0.9990748, 'binary_precision': 0.9381794, 'binary_recall': 0.9394558, 'binary_specificity': 0.9978498, 'binary_f1_score': 0.93881714}
confusion matrix:
       0     1
0  42231    91
1     89  1381
---- Validation: 
scalar performance:
{'acc': 0.9876011, 'precision': 0.92745847, 'recall': 0.87657225, 'specificity': 0.87657225, 'f1': 0.90027714, 'auroc': 0.98168075, 'binary_precision': 0.8634752, 'binary_recall': 0.7573872, 'binary_specificity': 0.99575734, 'binary_f1_score': 0.8069594}
confusion matrix:
       0    1
0  18072   77
1    156  487
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9691595, 'precision': 0.8569649, 'recall': 0.69806457, 'specificity': 0.69806457, 'f1': 0.7525792, 'auroc': 0.9557105, 'binary_precision': 0.7394366, 'binary_recall': 0.40229884, 'binary_specificity': 0.99383026, 'binary_f1_score': 0.5210918}
confusion matrix:
      0    1
0  5960   37
1   156  105
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202599_24.png
early stop counter: 4
val acc:0.987601101398468, best validation acc: 0.9877607226371765, corresponding to test acc:                         0.9611697196960449 / 0.9742729067802429
after epoch: 24,now: 2024-06-08 10:37:10.117603,epoch time: 0:39:52.079888,used: 15:31:46.236660,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_19_05_23_seed_0_21202599
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9933321, 'precision': 0.9679697, 'recall': 0.9267161, 'specificity': 0.9267161, 'f1': 0.9463204, 'auroc': 0.9981461, 'binary_precision': 0.94095665, 'binary_recall': 0.85529894, 'binary_specificity': 0.99813324, 'binary_f1_score': 0.8960854}
confusion matrix:
       0     1
0  42241    79
1    213  1259
---- Validation: 
scalar performance:
{'acc': 0.9845679, 'precision': 0.9295384, 'recall': 0.82024795, 'specificity': 0.82024795, 'f1': 0.86632776, 'auroc': 0.9813355, 'binary_precision': 0.87157893, 'binary_recall': 0.64385694, 'binary_specificity': 0.99663895, 'binary_f1_score': 0.74060816}
confusion matrix:
       0    1
0  18088   61
1    229  414
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96628314, 'precision': 0.902829, 'recall': 0.6177735, 'specificity': 0.6177735, 'f1': 0.6764136, 'auroc': 0.94707334, 'binary_precision': 0.8378378, 'binary_recall': 0.23754789, 'binary_specificity': 0.997999, 'binary_f1_score': 0.37014925}
confusion matrix:
      0   1
0  5985  12
1   199  62
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202599_25.png
early stop counter: 5
val acc:0.9845678806304932, best validation acc: 0.9877607226371765, corresponding to test acc:                         0.9611697196960449 / 0.9742729067802429
after epoch: 25,now: 2024-06-08 11:16:01.241091,epoch time: 0:38:51.123488,used: 16:10:37.360148,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_19_05_23_seed_0_21202599
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99588966, 'precision': 0.9818016, 'recall': 0.9539402, 'specificity': 0.9539402, 'f1': 0.96742517, 'auroc': 0.9992848, 'binary_precision': 0.966763, 'binary_recall': 0.9089674, 'binary_specificity': 0.99891305, 'binary_f1_score': 0.93697476}
confusion matrix:
       0     1
0  42274    46
1    134  1338
---- Validation: 
scalar performance:
{'acc': 0.98557895, 'precision': 0.9393998, 'recall': 0.8282719, 'specificity': 0.8282719, 'f1': 0.87519383, 'auroc': 0.9815525, 'binary_precision': 0.8907563, 'binary_recall': 0.65940905, 'binary_specificity': 0.9971348, 'binary_f1_score': 0.7578195}
confusion matrix:
       0    1
0  18097   52
1    219  424
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97347397, 'precision': 0.89208376, 'recall': 0.7369623, 'specificity': 0.7369623, 'f1': 0.79362124, 'auroc': 0.95496804, 'binary_precision': 0.8064516, 'binary_recall': 0.4789272, 'binary_specificity': 0.9949975, 'binary_f1_score': 0.6009615}
confusion matrix:
      0    1
0  5967   30
1   136  125
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202599_26.png
early stop counter: 6
val acc:0.9855789542198181, best validation acc: 0.9877607226371765, corresponding to test acc:                         0.9611697196960449 / 0.9742729067802429
after epoch: 26,now: 2024-06-08 11:58:26.975493,epoch time: 0:42:25.734402,used: 16:53:03.094550,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_19_05_23_seed_0_21202599
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9948164, 'precision': 0.9498011, 'recall': 0.97305644, 'specificity': 0.97305644, 'f1': 0.96111226, 'auroc': 0.99919677, 'binary_precision': 0.90135396, 'binary_recall': 0.94972825, 'binary_specificity': 0.9963847, 'binary_f1_score': 0.924909}
confusion matrix:
       0     1
0  42167   153
1     74  1398
---- Validation: 
scalar performance:
{'acc': 0.98557895, 'precision': 0.8923985, 'recall': 0.88827634, 'specificity': 0.88827634, 'f1': 0.89032555, 'auroc': 0.98268926, 'binary_precision': 0.7924528, 'binary_recall': 0.7838258, 'binary_specificity': 0.99272686, 'binary_f1_score': 0.7881156}
confusion matrix:
       0    1
0  18017  132
1    139  504
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96692234, 'precision': 0.840057, 'recall': 0.673077, 'specificity': 0.673077, 'f1': 0.726758, 'auroc': 0.94444287, 'binary_precision': 0.7076923, 'binary_recall': 0.35249043, 'binary_specificity': 0.9936635, 'binary_f1_score': 0.4705882}
confusion matrix:
      0   1
0  5959  38
1   169  92
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202599_27.png
early stop counter: 7
val acc:0.9855789542198181, best validation acc: 0.9877607226371765, corresponding to test acc:                         0.9611697196960449 / 0.9742729067802429
after epoch: 27,now: 2024-06-08 12:36:47.670254,epoch time: 0:38:20.694761,used: 17:31:23.789311,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_19_05_23_seed_0_21202599
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9950904, 'precision': 0.9535396, 'recall': 0.97285306, 'specificity': 0.97285306, 'f1': 0.9629791, 'auroc': 0.99917305, 'binary_precision': 0.9088542, 'binary_recall': 0.94901425, 'binary_specificity': 0.99669194, 'binary_f1_score': 0.9285002}
confusion matrix:
       0     1
0  42181   140
1     75  1396
---- Validation: 
scalar performance:
{'acc': 0.9877607, 'precision': 0.92311966, 'recall': 0.8849056, 'specificity': 0.8849056, 'f1': 0.903036, 'auroc': 0.9851916, 'binary_precision': 0.8542024, 'binary_recall': 0.7744945, 'binary_specificity': 0.99531657, 'binary_f1_score': 0.812398}
confusion matrix:
       0    1
0  18064   85
1    145  498
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9704378, 'precision': 0.85563695, 'recall': 0.7243842, 'specificity': 0.7243842, 'f1': 0.77367485, 'auroc': 0.947284, 'binary_precision': 0.7345679, 'binary_recall': 0.4559387, 'binary_specificity': 0.99282974, 'binary_f1_score': 0.56264776}
confusion matrix:
      0    1
0  5954   43
1   142  119
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202599_28.png
early stop counter: 8
val acc:0.9877607226371765, best validation acc: 0.9877607226371765, corresponding to test acc:                         0.9611697196960449 / 0.9742729067802429
after epoch: 28,now: 2024-06-08 13:15:00.047568,epoch time: 0:38:12.377314,used: 18:09:36.166625,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_19_05_23_seed_0_21202599
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9948164, 'precision': 0.9713257, 'recall': 0.9474834, 'specificity': 0.9474834, 'f1': 0.9590719, 'auroc': 0.99857557, 'binary_precision': 0.94623655, 'binary_recall': 0.8967391, 'binary_specificity': 0.9982278, 'binary_f1_score': 0.92082316}
confusion matrix:
       0     1
0  42245    75
1    152  1320
---- Validation: 
scalar performance:
{'acc': 0.98797363, 'precision': 0.9468288, 'recall': 0.8617641, 'specificity': 0.8617641, 'f1': 0.89948386, 'auroc': 0.980245, 'binary_precision': 0.9032882, 'binary_recall': 0.7262831, 'binary_specificity': 0.997245, 'binary_f1_score': 0.80517244}
confusion matrix:
       0    1
0  18099   50
1    176  467
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9715564, 'precision': 0.8577215, 'recall': 0.74329114, 'specificity': 0.74329114, 'f1': 0.788504, 'auroc': 0.95311916, 'binary_precision': 0.73714286, 'binary_recall': 0.49425286, 'binary_specificity': 0.9923295, 'binary_f1_score': 0.5917431}
confusion matrix:
      0    1
0  5951   46
1   132  129
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202599_29.png
better model found
persisted
after epoch: 29,now: 2024-06-08 13:53:15.581026,epoch time: 0:38:15.533458,used: 18:47:51.700083,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_19_05_23_seed_0_21202599
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99595815, 'precision': 0.9647918, 'recall': 0.9736302, 'specificity': 0.9736302, 'f1': 0.9691661, 'auroc': 0.999498, 'binary_precision': 0.93133336, 'binary_recall': 0.9496941, 'binary_specificity': 0.9975662, 'binary_f1_score': 0.9404241}
confusion matrix:
       0     1
0  42218   103
1     74  1397
---- Validation: 
scalar performance:
{'acc': 0.98589826, 'precision': 0.9027711, 'recall': 0.8779409, 'specificity': 0.8779409, 'f1': 0.8899281, 'auroc': 0.9850445, 'binary_precision': 0.81395346, 'binary_recall': 0.7620529, 'binary_specificity': 0.99382883, 'binary_f1_score': 0.7871486}
confusion matrix:
       0    1
0  18037  112
1    153  490
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9683605, 'precision': 0.89447814, 'recall': 0.6536716, 'specificity': 0.6536716, 'f1': 0.7168559, 'auroc': 0.95296806, 'binary_precision': 0.8181818, 'binary_recall': 0.31034482, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.44999993}
confusion matrix:
      0   1
0  5979  18
1   180  81
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202599_30.png
early stop counter: 1
val acc:0.9858982563018799, best validation acc: 0.9879736304283142, corresponding to test acc:                         0.9715564250946045 / 0.9742729067802429
after epoch: 30,now: 2024-06-08 14:31:28.068175,epoch time: 0:38:12.487149,used: 19:26:04.187232,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_19_05_23_seed_0_21202599
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 19:26:04.187232 at 2024-06-08 14:31:28.068175
persisted model performance metric: 

scalar performance:
{'acc': 0.9717162, 'precision': 0.8639163, 'recall': 0.73787755, 'specificity': 0.73787755, 'f1': 0.78638434, 'auroc': 0.95050156, 'binary_precision': 0.75, 'binary_recall': 0.4827586, 'binary_specificity': 0.9929965, 'binary_f1_score': 0.58741254}
confusion matrix:
      0    1
0  5955   42
1   135  126
oracle model performance metric: 

scalar performance:
{'acc': 0.9741131, 'precision': 0.8894141, 'recall': 0.7501222, 'specificity': 0.7501222, 'f1': 0.8031594, 'auroc': 0.9579344, 'binary_precision': 0.8, 'binary_recall': 0.50574714, 'binary_specificity': 0.99449724, 'binary_f1_score': 0.6197183}
confusion matrix:
      0    1
0  5964   33
1   129  132
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_new/rule_results/6.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_new/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_new/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1661 MiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |   1655 MiB |  15779 MiB |    977 TiB |    977 TiB |
|       from small pool |      6 MiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1661 MiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |   1655 MiB |  15779 MiB |    977 TiB |    977 TiB |
|       from small pool |      6 MiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1653 MiB |  15770 MiB |    987 TiB |    987 TiB |
|       from large pool |   1647 MiB |  15745 MiB |    974 TiB |    974 TiB |
|       from small pool |      5 MiB |     25 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  16730 MiB |  16730 MiB |  16730 MiB |      0 B   |
|       from large pool |  16702 MiB |  16702 MiB |  16702 MiB |      0 B   |
|       from small pool |     28 MiB |     28 MiB |     28 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 430238 KiB |    863 MiB | 413552 GiB | 413551 GiB |
|       from large pool | 410304 KiB |    862 MiB | 400661 GiB | 400661 GiB |
|       from small pool |  19934 KiB |     21 MiB |  12890 GiB |  12890 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3366    |    6357    |  152224 K  |  152221 K  |
|       from large pool |     247    |     989    |   62327 K  |   62326 K  |
|       from small pool |    3119    |    6108    |   89897 K  |   89894 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3366    |    6357    |  152224 K  |  152221 K  |
|       from large pool |     247    |     989    |   62327 K  |   62326 K  |
|       from small pool |    3119    |    6108    |   89897 K  |   89894 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     621    |     621    |     621    |       0    |
|       from large pool |     607    |     607    |     607    |       0    |
|       from small pool |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     144    |    2873    |   90205 K  |   90205 K  |
|       from large pool |     112    |     516    |   47275 K  |   47275 K  |
|       from small pool |      32    |    2761    |   42929 K  |   42929 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |  16640 KiB |  15779 MiB |    977 TiB |    977 TiB |
|       from small pool |      0 KiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |  16640 KiB |  15779 MiB |    977 TiB |    977 TiB |
|       from small pool |      0 KiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15770 MiB |    987 TiB |    987 TiB |
|       from large pool |  16640 KiB |  15745 MiB |    974 TiB |    974 TiB |
|       from small pool |      0 KiB |     25 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2082 MiB |  16730 MiB |  16730 MiB |  14648 MiB |
|       from large pool |   2056 MiB |  16702 MiB |  16702 MiB |  14646 MiB |
|       from small pool |     26 MiB |     28 MiB |     28 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    863 MiB | 413553 GiB | 413553 GiB |
|       from large pool |  24320 KiB |    862 MiB | 400662 GiB | 400662 GiB |
|       from small pool |      0 KiB |     24 MiB |  12890 GiB |  12890 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6357    |  152224 K  |  152224 K  |
|       from large pool |       2    |     989    |   62327 K  |   62327 K  |
|       from small pool |       0    |    6108    |   89897 K  |   89897 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6357    |  152224 K  |  152224 K  |
|       from large pool |       2    |     989    |   62327 K  |   62327 K  |
|       from small pool |       0    |    6108    |   89897 K  |   89897 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     115    |     621    |     621    |     506    |
|       from large pool |     102    |     607    |     607    |     505    |
|       from small pool |      13    |      14    |      14    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    2873    |   90206 K  |   90206 K  |
|       from large pool |       2    |     516    |   47275 K  |   47275 K  |
|       from small pool |       0    |    2761    |   42931 K  |   42931 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat Jun  8 14:34:24 2024]
Finished job 0.
1 of 1 steps (100%) done
