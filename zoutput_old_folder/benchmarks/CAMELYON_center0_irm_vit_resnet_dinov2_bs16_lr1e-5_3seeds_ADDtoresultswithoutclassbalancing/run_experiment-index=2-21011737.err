Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Fri May 31 12:21:51 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/rule_results/2.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=2
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_12_32_06_seed_0_21011737

 Experiment start at: 2024-05-31 12:32:06.735697
before training, model accuracy: 0.6388623118400574
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96638656, 'precision': 0.48319328, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.491453, 'auroc': 0.95534825, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42320  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.9553542, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.93620807, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011737.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-31 13:02:41.667330,epoch time: 0:30:34.931633,used: 0:30:34.931633,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_12_32_06_seed_0_21011737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9701315, 'precision': 0.82077795, 'recall': 0.608227, 'specificity': 0.608227, 'f1': 0.6580065, 'auroc': 0.9580388, 'binary_precision': 0.6680412, 'binary_recall': 0.22025833, 'binary_specificity': 0.99619573, 'binary_f1_score': 0.3312883}
confusion matrix:
       0    1
0  42160  161
1   1147  324
---- Validation: 
scalar performance:
{'acc': 0.9687633, 'precision': 0.84461397, 'recall': 0.5705479, 'specificity': 0.5705479, 'f1': 0.6113528, 'auroc': 0.96177375, 'binary_precision': 0.71875, 'binary_recall': 0.14307931, 'binary_specificity': 0.9980164, 'binary_f1_score': 0.23865111}
confusion matrix:
       0   1
0  18113  36
1    551  92
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.97976, 'recall': 0.51532567, 'specificity': 0.51532567, 'f1': 0.5194107, 'auroc': 0.94909465, 'binary_precision': 1.0, 'binary_recall': 0.03065134, 'binary_specificity': 1.0, 'binary_f1_score': 0.059479553}
confusion matrix:
      0  1
0  5997  0
1   253  8
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011737.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-05-31 13:31:16.287346,epoch time: 0:28:34.620016,used: 0:59:09.551649,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_12_32_06_seed_0_21011737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97282606, 'precision': 0.8204223, 'recall': 0.6925065, 'specificity': 0.6925065, 'f1': 0.73918015, 'auroc': 0.96451575, 'binary_precision': 0.66169727, 'binary_recall': 0.3919837, 'binary_specificity': 0.9930293, 'binary_f1_score': 0.49232084}
confusion matrix:
       0    1
0  42025  295
1    895  577
---- Validation: 
scalar performance:
{'acc': 0.97200936, 'precision': 0.8030568, 'recall': 0.72223943, 'specificity': 0.72223943, 'f1': 0.75585246, 'auroc': 0.96542704, 'binary_precision': 0.6252677, 'binary_recall': 0.4541213, 'binary_specificity': 0.9903576, 'binary_f1_score': 0.52612615}
confusion matrix:
       0    1
0  17974  175
1    351  292
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97363377, 'precision': 0.9198202, 'recall': 0.71689004, 'specificity': 0.71689004, 'f1': 0.7832711, 'auroc': 0.9437016, 'binary_precision': 0.8636364, 'binary_recall': 0.43678162, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.58015263}
confusion matrix:
      0    1
0  5979   18
1   147  114
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011737.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-05-31 13:59:45.417522,epoch time: 0:28:29.130176,used: 1:27:38.681825,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_12_32_06_seed_0_21011737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96896696, 'precision': 0.75913465, 'recall': 0.8505051, 'specificity': 0.8505051, 'f1': 0.7971649, 'auroc': 0.9674711, 'binary_precision': 0.5280119, 'binary_recall': 0.72350544, 'binary_specificity': 0.97750473, 'binary_f1_score': 0.61049014}
confusion matrix:
       0     1
0  41368   952
1    407  1065
---- Validation: 
scalar performance:
{'acc': 0.96796507, 'precision': 0.7565653, 'recall': 0.8304038, 'specificity': 0.8304038, 'f1': 0.78828466, 'auroc': 0.968113, 'binary_precision': 0.52449226, 'binary_recall': 0.6827372, 'binary_specificity': 0.97807044, 'binary_f1_score': 0.5932433}
confusion matrix:
       0    1
0  17751  398
1    204  439
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97635025, 'precision': 0.88892275, 'recall': 0.7879361, 'specificity': 0.7879361, 'f1': 0.83014923, 'auroc': 0.9510223, 'binary_precision': 0.79581153, 'binary_recall': 0.58237547, 'binary_specificity': 0.9934968, 'binary_f1_score': 0.67256635}
confusion matrix:
      0    1
0  5958   39
1   109  152
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011737.png
new oracle model saved
early stop counter: 1
val acc:0.9679650664329529, best validation acc: 0.9720093607902527, corresponding to test acc:                         0.9736337661743164 / 0.9763502478599548
after epoch: 4,now: 2024-05-31 14:28:28.179272,epoch time: 0:28:42.761750,used: 1:56:21.443575,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_12_32_06_seed_0_21011737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97246075, 'precision': 0.89384615, 'recall': 0.6162541, 'specificity': 0.6162541, 'f1': 0.67492485, 'auroc': 0.971755, 'binary_precision': 0.8136792, 'binary_recall': 0.234375, 'binary_specificity': 0.99813324, 'binary_f1_score': 0.36392406}
confusion matrix:
       0    1
0  42241   79
1   1127  345
---- Validation: 
scalar performance:
{'acc': 0.9701469, 'precision': 0.9035443, 'recall': 0.57876474, 'specificity': 0.57876474, 'f1': 0.62571496, 'auroc': 0.97175753, 'binary_precision': 0.8360656, 'binary_recall': 0.15863141, 'binary_specificity': 0.998898, 'binary_f1_score': 0.26666668}
confusion matrix:
       0    1
0  18129   20
1    541  102
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9643656, 'precision': 0.9303643, 'recall': 0.5819586, 'specificity': 0.5819586, 'f1': 0.6300245, 'auroc': 0.94659114, 'binary_precision': 0.8958333, 'binary_recall': 0.16475096, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.27831715}
confusion matrix:
      0   1
0  5992   5
1   218  43
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011737.png
early stop counter: 2
val acc:0.970146894454956, best validation acc: 0.9720093607902527, corresponding to test acc:                         0.9736337661743164 / 0.9763502478599548
after epoch: 5,now: 2024-05-31 14:59:42.190653,epoch time: 0:31:14.011381,used: 2:27:35.454956,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_12_32_06_seed_0_21011737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9642172, 'precision': 0.73834354, 'recall': 0.91198015, 'specificity': 0.91198015, 'f1': 0.79891104, 'auroc': 0.97090924, 'binary_precision': 0.48183557, 'binary_recall': 0.85597825, 'binary_specificity': 0.96798205, 'binary_f1_score': 0.6165892}
confusion matrix:
       0     1
0  40965  1355
1    212  1260
---- Validation: 
scalar performance:
{'acc': 0.9650383, 'precision': 0.7441605, 'recall': 0.9106446, 'specificity': 0.9106446, 'f1': 0.8034389, 'auroc': 0.97107494, 'binary_precision': 0.49369368, 'binary_recall': 0.85225505, 'binary_specificity': 0.96903414, 'binary_f1_score': 0.6252139}
confusion matrix:
       0    1
0  17587  562
1     95  548
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96692234, 'precision': 0.7823255, 'recall': 0.892957, 'specificity': 0.892957, 'f1': 0.82726616, 'auroc': 0.9470746, 'binary_precision': 0.57297295, 'binary_recall': 0.8122605, 'binary_specificity': 0.9736535, 'binary_f1_score': 0.67194927}
confusion matrix:
      0    1
0  5839  158
1    49  212
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011737.png
early stop counter: 3
val acc:0.9650382995605469, best validation acc: 0.9720093607902527, corresponding to test acc:                         0.9736337661743164 / 0.9763502478599548
after epoch: 6,now: 2024-05-31 15:28:28.768449,epoch time: 0:28:46.577796,used: 2:56:22.032752,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_12_32_06_seed_0_21011737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97727895, 'precision': 0.8431107, 'recall': 0.7780866, 'specificity': 0.7780866, 'f1': 0.8069008, 'auroc': 0.97522104, 'binary_precision': 0.7012658, 'binary_recall': 0.56453806, 'binary_specificity': 0.99163514, 'binary_f1_score': 0.62551755}
confusion matrix:
       0    1
0  41966  354
1    641  831
---- Validation: 
scalar performance:
{'acc': 0.9754683, 'precision': 0.834119, 'recall': 0.7577827, 'specificity': 0.7577827, 'f1': 0.7905924, 'auroc': 0.9728709, 'binary_precision': 0.68495935, 'binary_recall': 0.5241057, 'binary_specificity': 0.9914596, 'binary_f1_score': 0.59383255}
confusion matrix:
       0    1
0  17994  155
1    306  337
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.965644, 'precision': 0.8851398, 'recall': 0.6156076, 'specificity': 0.6156076, 'f1': 0.67218226, 'auroc': 0.95661414, 'binary_precision': 0.80263156, 'binary_recall': 0.23371647, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.3620178}
confusion matrix:
      0   1
0  5982  15
1   200  61
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011737.png
better model found
persisted
after epoch: 7,now: 2024-05-31 15:57:15.589970,epoch time: 0:28:46.821521,used: 3:25:08.854273,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_12_32_06_seed_0_21011737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9770278, 'precision': 0.8585346, 'recall': 0.7448429, 'specificity': 0.7448429, 'f1': 0.79011655, 'auroc': 0.97743213, 'binary_precision': 0.7344064, 'binary_recall': 0.4959239, 'binary_specificity': 0.99376184, 'binary_f1_score': 0.5920519}
confusion matrix:
       0    1
0  42056  264
1    742  730
---- Validation: 
scalar performance:
{'acc': 0.976639, 'precision': 0.86642396, 'recall': 0.734387, 'specificity': 0.734387, 'f1': 0.78474516, 'auroc': 0.9745702, 'binary_precision': 0.75123155, 'binary_recall': 0.47433904, 'binary_specificity': 0.99443495, 'binary_f1_score': 0.5815062}
confusion matrix:
       0    1
0  18048  101
1    338  305
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97251517, 'precision': 0.88216054, 'recall': 0.7309651, 'specificity': 0.7309651, 'f1': 0.7861618, 'auroc': 0.96332014, 'binary_precision': 0.7870968, 'binary_recall': 0.46743295, 'binary_specificity': 0.99449724, 'binary_f1_score': 0.5865385}
confusion matrix:
      0    1
0  5964   33
1   139  122
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011737.png
better model found
persisted
after epoch: 8,now: 2024-05-31 16:26:03.027473,epoch time: 0:28:47.437503,used: 3:53:56.291776,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_12_32_06_seed_0_21011737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.97622854, 'precision': 0.8106954, 'recall': 0.8437707, 'specificity': 0.8437707, 'f1': 0.8263136, 'auroc': 0.97951865, 'binary_precision': 0.6318043, 'binary_recall': 0.7017663, 'binary_specificity': 0.98577505, 'binary_f1_score': 0.66495013}
confusion matrix:
       0     1
0  41718   602
1    439  1033
---- Validation: 
scalar performance:
{'acc': 0.9773308, 'precision': 0.82410014, 'recall': 0.8435031, 'specificity': 0.8435031, 'f1': 0.833492, 'auroc': 0.9750133, 'binary_precision': 0.658858, 'binary_recall': 0.6998445, 'binary_specificity': 0.9871618, 'binary_f1_score': 0.67873305}
confusion matrix:
       0    1
0  17916  233
1    193  450
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96356666, 'precision': 0.91546756, 'recall': 0.5742124, 'specificity': 0.5742124, 'f1': 0.61811435, 'auroc': 0.9587971, 'binary_precision': 0.8666667, 'binary_recall': 0.14942528, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.25490195}
confusion matrix:
      0   1
0  5991   6
1   222  39
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011737.png
better model found
persisted
after epoch: 9,now: 2024-05-31 16:54:40.361797,epoch time: 0:28:37.334324,used: 4:22:33.626100,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_12_32_06_seed_0_21011737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9781924, 'precision': 0.93816996, 'recall': 0.6973729, 'specificity': 0.6973729, 'f1': 0.7692831, 'auroc': 0.9790539, 'binary_precision': 0.89692307, 'binary_recall': 0.39632902, 'binary_specificity': 0.99841684, 'binary_f1_score': 0.5497407}
confusion matrix:
       0    1
0  42254   67
1    888  583
---- Validation: 
scalar performance:
{'acc': 0.9757876, 'precision': 0.94442415, 'recall': 0.66119087, 'specificity': 0.66119087, 'f1': 0.7326093, 'auroc': 0.9809458, 'binary_precision': 0.9122807, 'binary_recall': 0.32348368, 'binary_specificity': 0.998898, 'binary_f1_score': 0.47761193}
confusion matrix:
       0    1
0  18129   20
1    435  208
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.81262994, 'recall': 0.50374806, 'specificity': 0.50374806, 'f1': 0.49696523, 'auroc': 0.94433826, 'binary_precision': 0.6666667, 'binary_recall': 0.007662835, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.015151515}
confusion matrix:
      0  1
0  5996  1
1   259  2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011737.png
early stop counter: 1
val acc:0.9757875800132751, best validation acc: 0.9773308038711548, corresponding to test acc:                         0.9635666608810425 / 0.9763502478599548
after epoch: 10,now: 2024-05-31 17:23:26.440851,epoch time: 0:28:46.079054,used: 4:51:19.705154,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_12_32_06_seed_0_21011737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.97830653, 'precision': 0.8949679, 'recall': 0.73024106, 'specificity': 0.73024106, 'f1': 0.7893343, 'auroc': 0.980702, 'binary_precision': 0.80828404, 'binary_recall': 0.46431, 'binary_specificity': 0.99617213, 'binary_f1_score': 0.5898101}
confusion matrix:
       0    1
0  42159  162
1    788  683
---- Validation: 
scalar performance:
{'acc': 0.9769583, 'precision': 0.89443994, 'recall': 0.7120506, 'specificity': 0.7120506, 'f1': 0.77384067, 'auroc': 0.9793637, 'binary_precision': 0.8088235, 'binary_recall': 0.42768273, 'binary_specificity': 0.99641854, 'binary_f1_score': 0.5595117}
confusion matrix:
       0    1
0  18084   65
1    368  275
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590924, 'precision': 0.7708108, 'recall': 0.53339887, 'specificity': 0.53339887, 'f1': 0.5511726, 'auroc': 0.9591156, 'binary_precision': 0.58064514, 'binary_recall': 0.06896552, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.12328768}
confusion matrix:
      0   1
0  5984  13
1   243  18
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011737.png
early stop counter: 2
val acc:0.9769582748413086, best validation acc: 0.9773308038711548, corresponding to test acc:                         0.9635666608810425 / 0.9763502478599548
after epoch: 11,now: 2024-05-31 17:52:03.600454,epoch time: 0:28:37.159603,used: 5:19:56.864757,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_12_32_06_seed_0_21011737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98355865, 'precision': 0.88192344, 'recall': 0.85730463, 'specificity': 0.85730463, 'f1': 0.8691695, 'auroc': 0.98055923, 'binary_precision': 0.7734887, 'binary_recall': 0.72195786, 'binary_specificity': 0.9926514, 'binary_f1_score': 0.7468355}
confusion matrix:
       0     1
0  42010   311
1    409  1062
---- Validation: 
scalar performance:
{'acc': 0.9823861, 'precision': 0.9090805, 'recall': 0.8018671, 'specificity': 0.8018671, 'f1': 0.84676486, 'auroc': 0.9794456, 'binary_precision': 0.8319149, 'binary_recall': 0.60808706, 'binary_specificity': 0.99564713, 'binary_f1_score': 0.7026055}
confusion matrix:
       0    1
0  18070   79
1    252  391
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.8153038, 'recall': 0.6142736, 'specificity': 0.6142736, 'f1': 0.6633085, 'auroc': 0.94567126, 'binary_precision': 0.6630435, 'binary_recall': 0.23371647, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.34560907}
confusion matrix:
      0   1
0  5966  31
1   200  61
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011737.png
better model found
persisted
after epoch: 12,now: 2024-05-31 18:20:50.208364,epoch time: 0:28:46.607910,used: 5:48:43.472667,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_12_32_06_seed_0_21011737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98337597, 'precision': 0.908612, 'recall': 0.8156663, 'specificity': 0.8156663, 'f1': 0.8557168, 'auroc': 0.9831791, 'binary_precision': 0.82978725, 'binary_recall': 0.63586956, 'binary_specificity': 0.99546313, 'binary_f1_score': 0.72}
confusion matrix:
       0    1
0  42128  192
1    536  936
---- Validation: 
scalar performance:
{'acc': 0.9826522, 'precision': 0.91498077, 'recall': 0.80050474, 'specificity': 0.80050474, 'f1': 0.8478869, 'auroc': 0.9807861, 'binary_precision': 0.8438178, 'binary_recall': 0.60497665, 'binary_specificity': 0.99603283, 'binary_f1_score': 0.7047102}
confusion matrix:
       0    1
0  18077   72
1    254  389
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614893, 'precision': 0.8782606, 'recall': 0.55114055, 'specificity': 0.55114055, 'f1': 0.58166534, 'auroc': 0.94422644, 'binary_precision': 0.7941176, 'binary_recall': 0.10344828, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.18305086}
confusion matrix:
      0   1
0  5990   7
1   234  27
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011737.png
better model found
persisted
after epoch: 13,now: 2024-05-31 18:49:38.153345,epoch time: 0:28:47.944981,used: 6:17:31.417648,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_12_32_06_seed_0_21011737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9836043, 'precision': 0.88871443, 'recall': 0.8472589, 'specificity': 0.8472589, 'f1': 0.8667227, 'auroc': 0.98374265, 'binary_precision': 0.78778625, 'binary_recall': 0.70108694, 'binary_specificity': 0.993431, 'binary_f1_score': 0.74191225}
confusion matrix:
       0     1
0  42042   278
1    440  1032
---- Validation: 
scalar performance:
{'acc': 0.9812154, 'precision': 0.88445795, 'recall': 0.80951166, 'specificity': 0.80951166, 'f1': 0.842605, 'auroc': 0.98247224, 'binary_precision': 0.78210115, 'binary_recall': 0.62519443, 'binary_specificity': 0.99382883, 'binary_f1_score': 0.6949006}
confusion matrix:
       0    1
0  18037  112
1    241  402
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96276766, 'precision': 0.820747, 'recall': 0.6012805, 'specificity': 0.6012805, 'f1': 0.648789, 'auroc': 0.94917524, 'binary_precision': 0.675, 'binary_recall': 0.20689656, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.31671554}
confusion matrix:
      0   1
0  5971  26
1   207  54
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011737.png
early stop counter: 1
val acc:0.9812154173851013, best validation acc: 0.9826521873474121, corresponding to test acc:                         0.9614893198013306 / 0.9763502478599548
after epoch: 14,now: 2024-05-31 19:18:24.324013,epoch time: 0:28:46.170668,used: 6:46:17.588316,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_12_32_06_seed_0_21011737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98392403, 'precision': 0.8934068, 'recall': 0.8467686, 'specificity': 0.8467686, 'f1': 0.8684984, 'auroc': 0.9846822, 'binary_precision': 0.7972136, 'binary_recall': 0.69972825, 'binary_specificity': 0.99380904, 'binary_f1_score': 0.7452967}
confusion matrix:
       0     1
0  42058   262
1    442  1030
---- Validation: 
scalar performance:
{'acc': 0.98185396, 'precision': 0.89613926, 'recall': 0.80684197, 'specificity': 0.80684197, 'f1': 0.8453659, 'auroc': 0.97737557, 'binary_precision': 0.805668, 'binary_recall': 0.61897355, 'binary_specificity': 0.99471045, 'binary_f1_score': 0.7000879}
confusion matrix:
       0    1
0  18053   96
1    245  398
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.7709805, 'recall': 0.5686301, 'specificity': 0.5686301, 'f1': 0.6035517, 'auroc': 0.95349175, 'binary_precision': 0.578125, 'binary_recall': 0.14176245, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.2276923}
confusion matrix:
      0   1
0  5970  27
1   224  37
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011737.png
early stop counter: 2
val acc:0.9818539619445801, best validation acc: 0.9826521873474121, corresponding to test acc:                         0.9614893198013306 / 0.9763502478599548
after epoch: 15,now: 2024-05-31 19:47:10.057196,epoch time: 0:28:45.733183,used: 7:15:03.321499,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_12_32_06_seed_0_21011737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9854083, 'precision': 0.8882611, 'recall': 0.88647735, 'specificity': 0.88647735, 'f1': 0.887367, 'auroc': 0.9870988, 'binary_precision': 0.784153, 'binary_recall': 0.7804215, 'binary_specificity': 0.99253327, 'binary_f1_score': 0.78228277}
confusion matrix:
       0     1
0  42005   316
1    323  1148
---- Validation: 
scalar performance:
{'acc': 0.9837697, 'precision': 0.88605106, 'recall': 0.86108774, 'specificity': 0.86108774, 'f1': 0.87311655, 'auroc': 0.9817382, 'binary_precision': 0.7816667, 'binary_recall': 0.7293935, 'binary_specificity': 0.992782, 'binary_f1_score': 0.75462586}
confusion matrix:
       0    1
0  18018  131
1    174  469
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.7610642, 'recall': 0.51665777, 'specificity': 0.51665777, 'f1': 0.5219101, 'auroc': 0.94715667, 'binary_precision': 0.5625, 'binary_recall': 0.03448276, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.064981945}
confusion matrix:
      0  1
0  5990  7
1   252  9
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011737.png
better model found
persisted
after epoch: 16,now: 2024-05-31 20:15:50.549437,epoch time: 0:28:40.492241,used: 7:43:43.813740,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_12_32_06_seed_0_21011737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9836956, 'precision': 0.8774549, 'recall': 0.8685306, 'specificity': 0.8685306, 'f1': 0.8729348, 'auroc': 0.98462427, 'binary_precision': 0.76376307, 'binary_recall': 0.74507135, 'binary_specificity': 0.9919898, 'binary_f1_score': 0.7543015}
confusion matrix:
       0     1
0  41982   339
1    375  1096
---- Validation: 
scalar performance:
{'acc': 0.9826522, 'precision': 0.89940745, 'recall': 0.8185061, 'specificity': 0.8185061, 'f1': 0.8540329, 'auroc': 0.9821199, 'binary_precision': 0.8113949, 'binary_recall': 0.64230174, 'binary_specificity': 0.99471045, 'binary_f1_score': 0.71701396}
confusion matrix:
       0    1
0  18053   96
1    230  413
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.74010587, 'recall': 0.5239037, 'specificity': 0.5239037, 'f1': 0.53482497, 'auroc': 0.95491564, 'binary_precision': 0.52, 'binary_recall': 0.049808428, 'binary_specificity': 0.997999, 'binary_f1_score': 0.090909086}
confusion matrix:
      0   1
0  5985  12
1   248  13
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011737.png
early stop counter: 1
val acc:0.9826521873474121, best validation acc: 0.9837697148323059, corresponding to test acc:                         0.9586129784584045 / 0.9763502478599548
after epoch: 17,now: 2024-05-31 20:44:27.161243,epoch time: 0:28:36.611806,used: 8:12:20.425546,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_12_32_06_seed_0_21011737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9851114, 'precision': 0.89560664, 'recall': 0.8680382, 'specificity': 0.8680382, 'f1': 0.8812836, 'auroc': 0.987535, 'binary_precision': 0.8001464, 'binary_recall': 0.7425272, 'binary_specificity': 0.99354917, 'binary_f1_score': 0.77026075}
confusion matrix:
       0     1
0  42047   273
1    379  1093
---- Validation: 
scalar performance:
{'acc': 0.9838761, 'precision': 0.9094609, 'recall': 0.8296405, 'specificity': 0.8296405, 'f1': 0.8648989, 'auroc': 0.98187935, 'binary_precision': 0.8307393, 'binary_recall': 0.66407466, 'binary_specificity': 0.99520636, 'binary_f1_score': 0.73811585}
confusion matrix:
       0    1
0  18062   87
1    216  427
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96244806, 'precision': 0.7888522, 'recall': 0.63592815, 'specificity': 0.63592815, 'f1': 0.68191826, 'auroc': 0.95540917, 'binary_precision': 0.60833335, 'binary_recall': 0.27969348, 'binary_specificity': 0.99216276, 'binary_f1_score': 0.38320208}
confusion matrix:
      0   1
0  5950  47
1   188  73
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011737.png
better model found
persisted
after epoch: 18,now: 2024-05-31 21:13:04.663739,epoch time: 0:28:37.502496,used: 8:40:57.928042,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_12_32_06_seed_0_21011737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.97595453, 'precision': 0.94897544, 'recall': 0.65487576, 'specificity': 0.65487576, 'f1': 0.726184, 'auroc': 0.985556, 'binary_precision': 0.921371, 'binary_recall': 0.310673, 'binary_specificity': 0.99907845, 'binary_f1_score': 0.464667}
confusion matrix:
       0    1
0  42282   39
1   1014  457
---- Validation: 
scalar performance:
{'acc': 0.9716369, 'precision': 0.950806, 'recall': 0.59228706, 'specificity': 0.59228706, 'f1': 0.6471057, 'auroc': 0.9725801, 'binary_precision': 0.9296875, 'binary_recall': 0.18506998, 'binary_specificity': 0.9995041, 'binary_f1_score': 0.30868998}
confusion matrix:
       0    1
0  18140    9
1    524  119
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9592522, 'precision': 0.91718, 'recall': 0.5133266, 'specificity': 0.5133266, 'f1': 0.5156116, 'auroc': 0.9516311, 'binary_precision': 0.875, 'binary_recall': 0.026819924, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.052044608}
confusion matrix:
      0  1
0  5996  1
1   254  7
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011737.png
early stop counter: 1
val acc:0.9716368913650513, best validation acc: 0.98387610912323, corresponding to test acc:                         0.9624480605125427 / 0.9763502478599548
after epoch: 19,now: 2024-05-31 21:41:46.911473,epoch time: 0:28:42.247734,used: 9:09:40.175776,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_12_32_06_seed_0_21011737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9827594, 'precision': 0.85082114, 'recall': 0.9091151, 'specificity': 0.9091151, 'f1': 0.87752086, 'auroc': 0.9873694, 'binary_precision': 0.7075854, 'binary_recall': 0.83016306, 'binary_specificity': 0.9880671, 'binary_f1_score': 0.7639888}
confusion matrix:
       0     1
0  41815   505
1    250  1222
---- Validation: 
scalar performance:
{'acc': 0.9845679, 'precision': 0.8828541, 'recall': 0.8840026, 'specificity': 0.8840026, 'f1': 0.8834275, 'auroc': 0.9780403, 'binary_precision': 0.77364343, 'binary_recall': 0.7760498, 'binary_specificity': 0.99195546, 'binary_f1_score': 0.77484477}
confusion matrix:
       0    1
0  18003  146
1    144  499
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.77449787, 'recall': 0.5909516, 'specificity': 0.5909516, 'f1': 0.63188195, 'auroc': 0.95028836, 'binary_precision': 0.5833333, 'binary_recall': 0.18773946, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.28405797}
confusion matrix:
      0   1
0  5962  35
1   212  49
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011737.png
better model found
persisted
after epoch: 20,now: 2024-05-31 22:11:31.487432,epoch time: 0:29:44.575959,used: 9:39:24.751735,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_12_32_06_seed_0_21011737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.98760045, 'precision': 0.9096575, 'recall': 0.89646995, 'specificity': 0.89646995, 'f1': 0.90294695, 'auroc': 0.9904328, 'binary_precision': 0.826301, 'binary_recall': 0.7987763, 'binary_specificity': 0.99416363, 'binary_f1_score': 0.81230557}
confusion matrix:
       0     1
0  42074   247
1    296  1175
---- Validation: 
scalar performance:
{'acc': 0.9847807, 'precision': 0.9013928, 'recall': 0.8578609, 'specificity': 0.8578609, 'f1': 0.87827575, 'auroc': 0.98131514, 'binary_precision': 0.81260943, 'binary_recall': 0.7216174, 'binary_specificity': 0.9941044, 'binary_f1_score': 0.76441514}
confusion matrix:
       0    1
0  18042  107
1    179  464
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96228826, 'precision': 0.79948246, 'recall': 0.6120244, 'specificity': 0.6120244, 'f1': 0.65883535, 'auroc': 0.95541, 'binary_precision': 0.6315789, 'binary_recall': 0.22988506, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.33707863}
confusion matrix:
      0   1
0  5962  35
1   201  60
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011737.png
better model found
persisted
after epoch: 21,now: 2024-05-31 22:40:06.910812,epoch time: 0:28:35.423380,used: 10:08:00.175115,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_12_32_06_seed_0_21011737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9833303, 'precision': 0.93023145, 'recall': 0.7925527, 'specificity': 0.7925527, 'f1': 0.8473382, 'auroc': 0.98769164, 'binary_precision': 0.87462085, 'binary_recall': 0.58803535, 'binary_specificity': 0.99707, 'binary_f1_score': 0.703252}
confusion matrix:
       0    1
0  42197  124
1    606  865
---- Validation: 
scalar performance:
{'acc': 0.9799915, 'precision': 0.91743183, 'recall': 0.74962366, 'specificity': 0.74962366, 'f1': 0.81090504, 'auroc': 0.97778124, 'binary_precision': 0.85224277, 'binary_recall': 0.5023328, 'binary_specificity': 0.99691445, 'binary_f1_score': 0.6320939}
confusion matrix:
       0    1
0  18093   56
1    320  323
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.7994338, 'recall': 0.5523058, 'specificity': 0.5523058, 'f1': 0.5816075, 'auroc': 0.9590798, 'binary_precision': 0.6363636, 'binary_recall': 0.107279696, 'binary_specificity': 0.997332, 'binary_f1_score': 0.18360655}
confusion matrix:
      0   1
0  5981  16
1   233  28
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011737.png
early stop counter: 1
val acc:0.9799914956092834, best validation acc: 0.9847807288169861, corresponding to test acc:                         0.9622882604598999 / 0.9763502478599548
after epoch: 22,now: 2024-05-31 23:08:41.546207,epoch time: 0:28:34.635395,used: 10:36:34.810510,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_12_32_06_seed_0_21011737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.98760045, 'precision': 0.9269872, 'recall': 0.87326026, 'specificity': 0.87326026, 'f1': 0.89817977, 'auroc': 0.98971653, 'binary_precision': 0.86260736, 'binary_recall': 0.7506794, 'binary_specificity': 0.9958412, 'binary_f1_score': 0.8027606}
confusion matrix:
       0     1
0  42144   176
1    367  1105
---- Validation: 
scalar performance:
{'acc': 0.98472756, 'precision': 0.9221231, 'recall': 0.83083135, 'specificity': 0.83083135, 'f1': 0.87051535, 'auroc': 0.9826569, 'binary_precision': 0.856, 'binary_recall': 0.66562986, 'binary_specificity': 0.99603283, 'binary_f1_score': 0.74890643}
confusion matrix:
       0    1
0  18077   72
1    215  428
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96340686, 'precision': 0.8126744, 'recall': 0.6254344, 'specificity': 0.6254344, 'f1': 0.67515147, 'auroc': 0.95876706, 'binary_precision': 0.65686274, 'binary_recall': 0.256705, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.36914602}
confusion matrix:
      0   1
0  5962  35
1   194  67
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011737.png
early stop counter: 2
val acc:0.9847275614738464, best validation acc: 0.9847807288169861, corresponding to test acc:                         0.9622882604598999 / 0.9763502478599548
after epoch: 23,now: 2024-05-31 23:37:17.813924,epoch time: 0:28:36.267717,used: 11:05:11.078227,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_12_32_06_seed_0_21011737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.98760045, 'precision': 0.9248431, 'recall': 0.87588316, 'specificity': 0.87588316, 'f1': 0.8987491, 'auroc': 0.99124515, 'binary_precision': 0.85813415, 'binary_recall': 0.7561141, 'binary_specificity': 0.9956522, 'binary_f1_score': 0.8039003}
confusion matrix:
       0     1
0  42136   184
1    359  1113
---- Validation: 
scalar performance:
{'acc': 0.9829715, 'precision': 0.8924382, 'recall': 0.8344225, 'specificity': 0.8344225, 'f1': 0.86092377, 'auroc': 0.98190784, 'binary_precision': 0.7963303, 'binary_recall': 0.6749611, 'binary_specificity': 0.99388397, 'binary_f1_score': 0.73063976}
confusion matrix:
       0    1
0  18038  111
1    209  434
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614893, 'precision': 0.82802624, 'recall': 0.5676315, 'specificity': 0.5676315, 'f1': 0.60514134, 'auroc': 0.95230186, 'binary_precision': 0.6923077, 'binary_recall': 0.13793103, 'binary_specificity': 0.997332, 'binary_f1_score': 0.23003194}
confusion matrix:
      0   1
0  5981  16
1   225  36
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011737.png
early stop counter: 3
val acc:0.9829714894294739, best validation acc: 0.9847807288169861, corresponding to test acc:                         0.9622882604598999 / 0.9763502478599548
after epoch: 24,now: 2024-06-01 00:05:51.424556,epoch time: 0:28:33.610632,used: 11:33:44.688859,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_12_32_06_seed_0_21011737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9860477, 'precision': 0.9296305, 'recall': 0.8418598, 'specificity': 0.8418598, 'f1': 0.88037646, 'auroc': 0.98992944, 'binary_precision': 0.8700516, 'binary_recall': 0.68728757, 'binary_specificity': 0.996432, 'binary_f1_score': 0.7679453}
confusion matrix:
       0     1
0  42170   151
1    460  1011
---- Validation: 
scalar performance:
{'acc': 0.9852597, 'precision': 0.9301286, 'recall': 0.8318569, 'specificity': 0.8318569, 'f1': 0.87417376, 'auroc': 0.9798007, 'binary_precision': 0.8719512, 'binary_recall': 0.66718507, 'binary_specificity': 0.99652874, 'binary_f1_score': 0.7559471}
confusion matrix:
       0    1
0  18086   63
1    214  429
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.739439, 'recall': 0.52573603, 'specificity': 0.52573603, 'f1': 0.5379798, 'auroc': 0.94491994, 'binary_precision': 0.5185185, 'binary_recall': 0.053639848, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.097222224}
confusion matrix:
      0   1
0  5984  13
1   247  14
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011737.png
better model found
persisted
after epoch: 25,now: 2024-06-01 00:34:35.231650,epoch time: 0:28:43.807094,used: 12:02:28.495953,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_12_32_06_seed_0_21011737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9856138, 'precision': 0.8659805, 'recall': 0.940755, 'specificity': 0.940755, 'f1': 0.8995794, 'auroc': 0.99144936, 'binary_precision': 0.7357223, 'binary_recall': 0.89266306, 'binary_specificity': 0.9888469, 'binary_f1_score': 0.80662984}
confusion matrix:
       0     1
0  41848   472
1    158  1314
---- Validation: 
scalar performance:
{'acc': 0.9848872, 'precision': 0.8773265, 'recall': 0.9021692, 'specificity': 0.9021692, 'f1': 0.8893163, 'auroc': 0.98145837, 'binary_precision': 0.76128095, 'binary_recall': 0.8133748, 'binary_specificity': 0.9909637, 'binary_f1_score': 0.78646624}
confusion matrix:
       0    1
0  17985  164
1    120  523
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96772134, 'precision': 0.83254457, 'recall': 0.7009789, 'specificity': 0.7009789, 'f1': 0.74886435, 'auroc': 0.95926124, 'binary_precision': 0.6903226, 'binary_recall': 0.4099617, 'binary_specificity': 0.991996, 'binary_f1_score': 0.514423}
confusion matrix:
      0    1
0  5949   48
1   154  107
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011737.png
early stop counter: 1
val acc:0.9848871827125549, best validation acc: 0.9852597117424011, corresponding to test acc:                         0.9584531784057617 / 0.9763502478599548
after epoch: 26,now: 2024-06-01 01:03:23.782875,epoch time: 0:28:48.551225,used: 12:31:17.047178,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_12_32_06_seed_0_21011737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.98629886, 'precision': 0.8739072, 'recall': 0.9368079, 'specificity': 0.9368079, 'f1': 0.9026948, 'auroc': 0.9929905, 'binary_precision': 0.7518797, 'binary_recall': 0.8837525, 'binary_specificity': 0.9898632, 'binary_f1_score': 0.81249994}
confusion matrix:
       0     1
0  41892   429
1    171  1300
---- Validation: 
scalar performance:
{'acc': 0.9838229, 'precision': 0.8644185, 'recall': 0.90686864, 'specificity': 0.90686864, 'f1': 0.8843664, 'auroc': 0.9790811, 'binary_precision': 0.73509014, 'binary_recall': 0.82426125, 'binary_specificity': 0.989476, 'binary_f1_score': 0.777126}
confusion matrix:
       0    1
0  17958  191
1    113  530
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96612334, 'precision': 0.82331073, 'recall': 0.6781571, 'specificity': 0.6781571, 'f1': 0.72756815, 'auroc': 0.95747507, 'binary_precision': 0.67375886, 'binary_recall': 0.36398467, 'binary_specificity': 0.9923295, 'binary_f1_score': 0.47263682}
confusion matrix:
      0   1
0  5951  46
1   166  95
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011737.png
early stop counter: 2
val acc:0.9838228821754456, best validation acc: 0.9852597117424011, corresponding to test acc:                         0.9584531784057617 / 0.9763502478599548
after epoch: 27,now: 2024-06-01 01:32:06.713385,epoch time: 0:28:42.930510,used: 12:59:59.977688,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_12_32_06_seed_0_21011737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.98707527, 'precision': 0.9444375, 'recall': 0.84512055, 'specificity': 0.84512055, 'f1': 0.88807416, 'auroc': 0.9930991, 'binary_precision': 0.8994709, 'binary_recall': 0.6929348, 'binary_specificity': 0.9973062, 'binary_f1_score': 0.78280896}
confusion matrix:
       0     1
0  42206   114
1    452  1020
---- Validation: 
scalar performance:
{'acc': 0.9832908, 'precision': 0.9201703, 'recall': 0.8068358, 'specificity': 0.8068358, 'f1': 0.853999, 'auroc': 0.9826798, 'binary_precision': 0.85376346, 'binary_recall': 0.61741835, 'binary_specificity': 0.99625325, 'binary_f1_score': 0.7166065}
confusion matrix:
       0    1
0  18081   68
1    246  397
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9638862, 'precision': 0.86758006, 'recall': 0.5945348, 'specificity': 0.5945348, 'f1': 0.64410436, 'auroc': 0.9539845, 'binary_precision': 0.7692308, 'binary_recall': 0.19157088, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.30674848}
confusion matrix:
      0   1
0  5982  15
1   211  50
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011737.png
early stop counter: 3
val acc:0.9832907915115356, best validation acc: 0.9852597117424011, corresponding to test acc:                         0.9584531784057617 / 0.9763502478599548
after epoch: 28,now: 2024-06-01 02:00:49.377594,epoch time: 0:28:42.664209,used: 13:28:42.641897,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_12_32_06_seed_0_21011737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9861847, 'precision': 0.9256222, 'recall': 0.8489219, 'specificity': 0.8489219, 'f1': 0.8831841, 'auroc': 0.9902481, 'binary_precision': 0.8615513, 'binary_recall': 0.7017663, 'binary_specificity': 0.9960775, 'binary_f1_score': 0.77349305}
confusion matrix:
       0     1
0  42154   166
1    439  1033
---- Validation: 
scalar performance:
{'acc': 0.98275864, 'precision': 0.9213252, 'recall': 0.7960595, 'specificity': 0.7960595, 'f1': 0.8469371, 'auroc': 0.9820561, 'binary_precision': 0.85682327, 'binary_recall': 0.5956454, 'binary_specificity': 0.9964736, 'binary_f1_score': 0.70275235}
confusion matrix:
       0    1
0  18085   64
1    260  383
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9610099, 'precision': 0.79398227, 'recall': 0.5802077, 'specificity': 0.5802077, 'f1': 0.62029153, 'auroc': 0.9554426, 'binary_precision': 0.6231884, 'binary_recall': 0.16475096, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.26060608}
confusion matrix:
      0   1
0  5971  26
1   218  43
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011737.png
early stop counter: 4
val acc:0.982758641242981, best validation acc: 0.9852597117424011, corresponding to test acc:                         0.9584531784057617 / 0.9763502478599548
after epoch: 29,now: 2024-06-01 02:29:24.534686,epoch time: 0:28:35.157092,used: 13:57:17.798989,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_12_32_06_seed_0_21011737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.98926747, 'precision': 0.9379755, 'recall': 0.890041, 'specificity': 0.890041, 'f1': 0.91251385, 'auroc': 0.9940945, 'binary_precision': 0.8834356, 'binary_recall': 0.78367347, 'binary_specificity': 0.99640846, 'binary_f1_score': 0.8305696}
confusion matrix:
       0     1
0  42170   152
1    318  1152
---- Validation: 
scalar performance:
{'acc': 0.9837165, 'precision': 0.92089903, 'recall': 0.81380665, 'specificity': 0.81380665, 'f1': 0.85895276, 'auroc': 0.974584, 'binary_precision': 0.85473686, 'binary_recall': 0.63141525, 'binary_specificity': 0.9961981, 'binary_f1_score': 0.72629696}
confusion matrix:
       0    1
0  18080   69
1    237  406
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.779752, 'recall': 0.58179, 'specificity': 0.58179, 'f1': 0.62120456, 'auroc': 0.92884135, 'binary_precision': 0.5945946, 'binary_recall': 0.16858238, 'binary_specificity': 0.9949975, 'binary_f1_score': 0.26268658}
confusion matrix:
      0   1
0  5967  30
1   217  44
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011737.png
early stop counter: 5
val acc:0.9837164878845215, best validation acc: 0.9852597117424011, corresponding to test acc:                         0.9584531784057617 / 0.9763502478599548
after epoch: 30,now: 2024-06-01 02:57:57.603361,epoch time: 0:28:33.068675,used: 14:25:50.867664,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_12_32_06_seed_0_21011737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 14:25:50.867664 at 2024-06-01 02:57:57.603361
persisted model performance metric: 

scalar performance:
{'acc': 0.958613, 'precision': 0.748114, 'recall': 0.5276517, 'specificity': 0.5276517, 'f1': 0.5413118, 'auroc': 0.9473073, 'binary_precision': 0.53571427, 'binary_recall': 0.057471264, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.10380623}
confusion matrix:
      0   1
0  5984  13
1   246  15
oracle model performance metric: 

scalar performance:
{'acc': 0.97746885, 'precision': 0.8930993, 'recall': 0.80134606, 'specificity': 0.80134606, 'f1': 0.84055805, 'auroc': 0.94951993, 'binary_precision': 0.8030303, 'binary_recall': 0.6091954, 'binary_specificity': 0.9934968, 'binary_f1_score': 0.6928105}
confusion matrix:
      0    1
0  5958   39
1   102  159
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/rule_results/2.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456549 KiB |  13219 MiB |   1121 TiB |   1121 TiB |
|       from large pool | 414861 KiB |  13181 MiB |   1107 TiB |   1107 TiB |
|       from small pool |  41687 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 456549 KiB |  13219 MiB |   1121 TiB |   1121 TiB |
|       from large pool | 414861 KiB |  13181 MiB |   1107 TiB |   1107 TiB |
|       from small pool |  41687 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447754 KiB |  13213 MiB |   1113 TiB |   1113 TiB |
|       from large pool | 407075 KiB |  13175 MiB |   1100 TiB |   1100 TiB |
|       from small pool |  40679 KiB |     60 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14476 MiB |  14476 MiB |  14476 MiB |      0 B   |
|       from large pool |  14404 MiB |  14404 MiB |  14404 MiB |      0 B   |
|       from small pool |     72 MiB |     72 MiB |     72 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 471195 KiB |   1229 MiB |    791 TiB |    791 TiB |
|       from large pool | 461682 KiB |   1224 MiB |    778 TiB |    778 TiB |
|       from small pool |   9512 KiB |     17 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3488    |    6479    |  197601 K  |  197598 K  |
|       from large pool |     187    |    1413    |  102630 K  |  102630 K  |
|       from small pool |    3301    |    6290    |   94971 K  |   94967 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3488    |    6479    |  197601 K  |  197598 K  |
|       from large pool |     187    |    1413    |  102630 K  |  102630 K  |
|       from small pool |    3301    |    6290    |   94971 K  |   94967 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     637    |     637    |     637    |       0    |
|       from large pool |     601    |     601    |     601    |       0    |
|       from small pool |      36    |      36    |      36    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      78    |    2805    |  133467 K  |  133467 K  |
|       from large pool |      39    |     600    |   83826 K  |   83826 K  |
|       from small pool |      39    |    2765    |   49640 K  |   49640 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   1121 TiB |   1121 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1107 TiB |   1107 TiB |
|       from small pool |      0 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   1121 TiB |   1121 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1107 TiB |   1107 TiB |
|       from small pool |      0 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   1113 TiB |   1113 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   1100 TiB |   1100 TiB |
|       from small pool |      0 KiB |     60 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    906 MiB |  14476 MiB |  14476 MiB |  13570 MiB |
|       from large pool |    856 MiB |  14404 MiB |  14404 MiB |  13548 MiB |
|       from small pool |     50 MiB |     72 MiB |     72 MiB |     22 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1229 MiB |    791 TiB |    791 TiB |
|       from large pool |  24320 KiB |   1224 MiB |    778 TiB |    778 TiB |
|       from small pool |      0 KiB |     37 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6479    |  197601 K  |  197601 K  |
|       from large pool |       2    |    1413    |  102630 K  |  102630 K  |
|       from small pool |       0    |    6290    |   94971 K  |   94971 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6479    |  197601 K  |  197601 K  |
|       from large pool |       2    |    1413    |  102630 K  |  102630 K  |
|       from small pool |       0    |    6290    |   94971 K  |   94971 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     637    |     637    |     574    |
|       from large pool |      38    |     601    |     601    |     563    |
|       from small pool |      25    |      36    |      36    |      11    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2805    |  133468 K  |  133468 K  |
|       from large pool |       4    |     600    |   83826 K  |   83826 K  |
|       from small pool |       0    |    2765    |   49641 K  |   49641 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   1121 TiB |   1121 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1107 TiB |   1107 TiB |
|       from small pool |      0 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   1121 TiB |   1121 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1107 TiB |   1107 TiB |
|       from small pool |      0 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   1113 TiB |   1113 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   1100 TiB |   1100 TiB |
|       from small pool |      0 KiB |     60 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    906 MiB |  14476 MiB |  14476 MiB |  13570 MiB |
|       from large pool |    856 MiB |  14404 MiB |  14404 MiB |  13548 MiB |
|       from small pool |     50 MiB |     72 MiB |     72 MiB |     22 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1229 MiB |    791 TiB |    791 TiB |
|       from large pool |  24320 KiB |   1224 MiB |    778 TiB |    778 TiB |
|       from small pool |      0 KiB |     37 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6479    |  197601 K  |  197601 K  |
|       from large pool |       2    |    1413    |  102630 K  |  102630 K  |
|       from small pool |       0    |    6290    |   94971 K  |   94971 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6479    |  197601 K  |  197601 K  |
|       from large pool |       2    |    1413    |  102630 K  |  102630 K  |
|       from small pool |       0    |    6290    |   94971 K  |   94971 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     637    |     637    |     574    |
|       from large pool |      38    |     601    |     601    |     563    |
|       from small pool |      25    |      36    |      36    |      11    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2805    |  133468 K  |  133468 K  |
|       from large pool |       4    |     600    |   83826 K  |   83826 K  |
|       from small pool |       0    |    2765    |   49641 K  |   49641 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_03_08_07_seed_1_21011737

 Experiment start at: 2024-06-01 03:08:07.946067
before training, model accuracy: 0.181115061044693
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96937704, 'precision': 0.789859, 'recall': 0.59562355, 'specificity': 0.59562355, 'f1': 0.64005035, 'auroc': 0.95114136, 'binary_precision': 0.60645163, 'binary_recall': 0.19556172, 'binary_specificity': 0.9956854, 'binary_f1_score': 0.2957525}
confusion matrix:
       0    1
0  42231  183
1   1160  282
---- Validation: 
scalar performance:
{'acc': 0.964301, 'precision': 0.7553706, 'recall': 0.5172771, 'specificity': 0.5172771, 'f1': 0.52437395, 'auroc': 0.9324024, 'binary_precision': 0.54545456, 'binary_recall': 0.035661217, 'binary_specificity': 0.998893, 'binary_f1_score': 0.066945605}
confusion matrix:
       0   1
0  18047  20
1    649  24
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96728975, 'precision': 0.9750947, 'recall': 0.61145437, 'specificity': 0.61145437, 'f1': 0.6734249, 'auroc': 0.9252188, 'binary_precision': 0.9830508, 'binary_recall': 0.22307692, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.36363634}
confusion matrix:
      0   1
0  5945   1
1   202  58
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011737.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-01 03:38:04.542799,epoch time: 0:29:56.596732,used: 0:29:56.596732,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_03_08_07_seed_1_21011737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97149765, 'precision': 0.77911484, 'recall': 0.7494581, 'specificity': 0.7494581, 'f1': 0.7633722, 'auroc': 0.9575314, 'binary_precision': 0.57476634, 'binary_recall': 0.5117892, 'binary_specificity': 0.9871269, 'binary_f1_score': 0.5414527}
confusion matrix:
       0    1
0  41868  546
1    704  738
---- Validation: 
scalar performance:
{'acc': 0.9685699, 'precision': 0.7900518, 'recall': 0.67756516, 'specificity': 0.67756516, 'f1': 0.7189717, 'auroc': 0.95415545, 'binary_precision': 0.6034483, 'binary_recall': 0.3640416, 'binary_specificity': 0.99108875, 'binary_f1_score': 0.4541242}
confusion matrix:
       0    1
0  17906  161
1    428  245
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9769578, 'precision': 0.96208906, 'recall': 0.7378729, 'specificity': 0.7378729, 'f1': 0.8111876, 'auroc': 0.9457694, 'binary_precision': 0.9465649, 'binary_recall': 0.47692308, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.6342711}
confusion matrix:
      0    1
0  5939    7
1   136  124
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011737.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-01 04:06:43.508984,epoch time: 0:28:38.966185,used: 0:58:35.562917,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_03_08_07_seed_1_21011737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97519153, 'precision': 0.8095757, 'recall': 0.7858678, 'specificity': 0.7858678, 'f1': 0.79720575, 'auroc': 0.96700597, 'binary_precision': 0.63328314, 'binary_recall': 0.58321774, 'binary_specificity': 0.98851794, 'binary_f1_score': 0.60722023}
confusion matrix:
       0    1
0  41927  487
1    601  841
---- Validation: 
scalar performance:
{'acc': 0.9734792, 'precision': 0.81773984, 'recall': 0.7752418, 'specificity': 0.7752418, 'f1': 0.7948165, 'auroc': 0.9658069, 'binary_precision': 0.65172416, 'binary_recall': 0.56166416, 'binary_specificity': 0.9888194, 'binary_f1_score': 0.60335195}
confusion matrix:
       0    1
0  17865  202
1    295  378
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9740574, 'precision': 0.8687589, 'recall': 0.77681696, 'specificity': 0.77681696, 'f1': 0.8155645, 'auroc': 0.9523965, 'binary_precision': 0.7564767, 'binary_recall': 0.56153846, 'binary_specificity': 0.99209553, 'binary_f1_score': 0.6445917}
confusion matrix:
      0    1
0  5899   47
1   114  146
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011737.png
better model found
persisted
after epoch: 3,now: 2024-06-01 04:35:22.797428,epoch time: 0:28:39.288444,used: 1:27:14.851361,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_03_08_07_seed_1_21011737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9770157, 'precision': 0.8848072, 'recall': 0.7034079, 'specificity': 0.7034079, 'f1': 0.7641796, 'auroc': 0.9714705, 'binary_precision': 0.78933334, 'binary_recall': 0.4105409, 'binary_specificity': 0.9962748, 'binary_f1_score': 0.54014593}
confusion matrix:
       0    1
0  42256  158
1    850  592
---- Validation: 
scalar performance:
{'acc': 0.97337246, 'precision': 0.9248028, 'recall': 0.65001464, 'specificity': 0.65001464, 'f1': 0.7174878, 'auroc': 0.9702046, 'binary_precision': 0.875, 'binary_recall': 0.30163446, 'binary_specificity': 0.99839485, 'binary_f1_score': 0.44861877}
confusion matrix:
       0    1
0  18038   29
1    470  203
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584273, 'precision': 0.7919289, 'recall': 0.5093631, 'specificity': 0.5093631, 'f1': 0.50803417, 'auroc': 0.94888175, 'binary_precision': 0.625, 'binary_recall': 0.01923077, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.03731343}
confusion matrix:
      0  1
0  5943  3
1   255  5
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011737.png
early stop counter: 1
val acc:0.9733724594116211, best validation acc: 0.9734792113304138, corresponding to test acc:                         0.9740573763847351 / 0.9769577980041504
after epoch: 4,now: 2024-06-01 05:04:04.030813,epoch time: 0:28:41.233385,used: 1:55:56.084746,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_03_08_07_seed_1_21011737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97505474, 'precision': 0.9216615, 'recall': 0.64176774, 'specificity': 0.64176774, 'f1': 0.7081338, 'auroc': 0.9728886, 'binary_precision': 0.8670886, 'binary_recall': 0.2850208, 'binary_specificity': 0.99851465, 'binary_f1_score': 0.4290188}
confusion matrix:
       0    1
0  42351   63
1   1031  411
---- Validation: 
scalar performance:
{'acc': 0.9726254, 'precision': 0.9636711, 'recall': 0.62459284, 'specificity': 0.62459284, 'f1': 0.6908776, 'auroc': 0.9721447, 'binary_precision': 0.95454544, 'binary_recall': 0.24962853, 'binary_specificity': 0.9995572, 'binary_f1_score': 0.39575973}
confusion matrix:
       0    1
0  18059    8
1    505  168
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.95906866, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011737.png
early stop counter: 2
val acc:0.9726253747940063, best validation acc: 0.9734792113304138, corresponding to test acc:                         0.9740573763847351 / 0.9769577980041504
after epoch: 5,now: 2024-06-01 05:32:43.728611,epoch time: 0:28:39.697798,used: 2:24:35.782544,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_03_08_07_seed_1_21011737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9743935, 'precision': 0.78955317, 'recall': 0.8604845, 'specificity': 0.8604845, 'f1': 0.8207419, 'auroc': 0.9710125, 'binary_precision': 0.5880729, 'binary_recall': 0.7385576, 'binary_specificity': 0.98241144, 'binary_f1_score': 0.6547802}
confusion matrix:
       0     1
0  41668   746
1    377  1065
---- Validation: 
scalar performance:
{'acc': 0.97545356, 'precision': 0.8211367, 'recall': 0.82848024, 'specificity': 0.82848024, 'f1': 0.8247627, 'auroc': 0.9703486, 'binary_precision': 0.65457183, 'binary_recall': 0.6701337, 'binary_specificity': 0.98682684, 'binary_f1_score': 0.6622613}
confusion matrix:
       0    1
0  17829  238
1    222  451
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95246536, 'precision': 0.646533, 'recall': 0.5595824, 'specificity': 0.5595824, 'f1': 0.58142227, 'auroc': 0.9286979, 'binary_precision': 0.33009708, 'binary_recall': 0.13076924, 'binary_specificity': 0.9883956, 'binary_f1_score': 0.18732783}
confusion matrix:
      0   1
0  5877  69
1   226  34
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011737.png
better model found
persisted
after epoch: 6,now: 2024-06-01 06:01:22.473262,epoch time: 0:28:38.744651,used: 2:53:14.527195,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_03_08_07_seed_1_21011737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9764456, 'precision': 0.9387702, 'recall': 0.6588995, 'specificity': 0.6588995, 'f1': 0.7295124, 'auroc': 0.9805722, 'binary_precision': 0.9001957, 'binary_recall': 0.31900138, 'binary_specificity': 0.9987976, 'binary_f1_score': 0.47107017}
confusion matrix:
       0    1
0  42363   51
1    982  460
---- Validation: 
scalar performance:
{'acc': 0.9726788, 'precision': 0.9717283, 'recall': 0.62319, 'specificity': 0.62319, 'f1': 0.68969476, 'auroc': 0.9723305, 'binary_precision': 0.9707602, 'binary_recall': 0.24665676, 'binary_specificity': 0.99972326, 'binary_f1_score': 0.3933649}
confusion matrix:
       0    1
0  18062    5
1    507  166
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9577828, 'precision': 0.60411966, 'recall': 0.5016708, 'specificity': 0.5016708, 'f1': 0.4930042, 'auroc': 0.9631362, 'binary_precision': 0.25, 'binary_recall': 0.0038461538, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.0075757573}
confusion matrix:
      0  1
0  5943  3
1   259  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011737.png
early stop counter: 1
val acc:0.9726787805557251, best validation acc: 0.9754535555839539, corresponding to test acc:                         0.9524653553962708 / 0.9769577980041504
after epoch: 7,now: 2024-06-01 06:30:11.787715,epoch time: 0:28:49.314453,used: 3:22:03.841648,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_03_08_07_seed_1_21011737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9807552, 'precision': 0.8782712, 'recall': 0.79242873, 'specificity': 0.79242873, 'f1': 0.82942474, 'auroc': 0.98057586, 'binary_precision': 0.7703436, 'binary_recall': 0.59084606, 'binary_specificity': 0.9940114, 'binary_f1_score': 0.6687598}
confusion matrix:
       0    1
0  42160  254
1    590  852
---- Validation: 
scalar performance:
{'acc': 0.98175025, 'precision': 0.92117524, 'recall': 0.79312146, 'specificity': 0.79312146, 'f1': 0.8447668, 'auroc': 0.9721739, 'binary_precision': 0.8574514, 'binary_recall': 0.58989596, 'binary_specificity': 0.99634695, 'binary_f1_score': 0.6989436}
confusion matrix:
       0    1
0  18001   66
1    276  397
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96052206, 'precision': 0.92773044, 'recall': 0.5325241, 'specificity': 0.5325241, 'f1': 0.5508355, 'auroc': 0.9661277, 'binary_precision': 0.8947368, 'binary_recall': 0.06538462, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.121863805}
confusion matrix:
      0   1
0  5944   2
1   243  17
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011737.png
better model found
persisted
after epoch: 8,now: 2024-06-01 06:59:26.801122,epoch time: 0:29:15.013407,used: 3:51:18.855055,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_03_08_07_seed_1_21011737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9793415, 'precision': 0.9232041, 'recall': 0.7190132, 'specificity': 0.7190132, 'f1': 0.7865238, 'auroc': 0.9783556, 'binary_precision': 0.8651226, 'binary_recall': 0.4403606, 'binary_specificity': 0.9976659, 'binary_f1_score': 0.5836397}
confusion matrix:
       0    1
0  42315   99
1    807  635
---- Validation: 
scalar performance:
{'acc': 0.9748132, 'precision': 0.9222611, 'recall': 0.67508096, 'specificity': 0.67508096, 'f1': 0.7440688, 'auroc': 0.9722923, 'binary_precision': 0.8681319, 'binary_recall': 0.35215452, 'binary_specificity': 0.9980074, 'binary_f1_score': 0.5010571}
confusion matrix:
       0    1
0  18031   36
1    436  237
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9585885, 'precision': 0.8793582, 'recall': 0.50760823, 'specificity': 0.50760823, 'f1': 0.50451565, 'auroc': 0.9477546, 'binary_precision': 0.8, 'binary_recall': 0.015384615, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.03018868}
confusion matrix:
      0  1
0  5945  1
1   256  4
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011737.png
early stop counter: 1
val acc:0.9748132228851318, best validation acc: 0.9817502498626709, corresponding to test acc:                         0.9605220556259155 / 0.9769577980041504
after epoch: 9,now: 2024-06-01 07:28:35.981770,epoch time: 0:29:09.180648,used: 4:20:28.035703,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_03_08_07_seed_1_21011737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98271614, 'precision': 0.91171825, 'recall': 0.7924377, 'specificity': 0.7924377, 'f1': 0.8412386, 'auroc': 0.98254013, 'binary_precision': 0.8372781, 'binary_recall': 0.5887656, 'binary_specificity': 0.9961098, 'binary_f1_score': 0.6913681}
confusion matrix:
       0    1
0  42249  165
1    593  849
---- Validation: 
scalar performance:
{'acc': 0.9787086, 'precision': 0.9305934, 'recall': 0.7343226, 'specificity': 0.7343226, 'f1': 0.80139947, 'auroc': 0.97554797, 'binary_precision': 0.88055557, 'binary_recall': 0.47102526, 'binary_specificity': 0.99762, 'binary_f1_score': 0.6137464}
confusion matrix:
       0    1
0  18024   43
1    356  317
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597164, 'precision': 0.7934439, 'recall': 0.5468156, 'specificity': 0.5468156, 'f1': 0.57301295, 'auroc': 0.9569884, 'binary_precision': 0.625, 'binary_recall': 0.09615385, 'binary_specificity': 0.9974773, 'binary_f1_score': 0.16666667}
confusion matrix:
      0   1
0  5931  15
1   235  25
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011737.png
early stop counter: 2
val acc:0.9787086248397827, best validation acc: 0.9817502498626709, corresponding to test acc:                         0.9605220556259155 / 0.9769577980041504
after epoch: 10,now: 2024-06-01 07:57:55.730401,epoch time: 0:29:19.748631,used: 4:49:47.784334,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_03_08_07_seed_1_21011737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98000276, 'precision': 0.93934643, 'recall': 0.7203599, 'specificity': 0.7203599, 'f1': 0.7912055, 'auroc': 0.98363703, 'binary_precision': 0.8973277, 'binary_recall': 0.44244105, 'binary_specificity': 0.99827886, 'binary_f1_score': 0.5926614}
confusion matrix:
       0    1
0  42341   73
1    804  638
---- Validation: 
scalar performance:
{'acc': 0.97550696, 'precision': 0.96086264, 'recall': 0.66828805, 'specificity': 0.66828805, 'f1': 0.74235475, 'auroc': 0.97582495, 'binary_precision': 0.9458333, 'binary_recall': 0.33729568, 'binary_specificity': 0.99928045, 'binary_f1_score': 0.49726176}
confusion matrix:
       0    1
0  18054   13
1    446  227
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582662, 'precision': 0.97912973, 'recall': 0.5019231, 'specificity': 0.5019231, 'f1': 0.49317387, 'auroc': 0.9524706, 'binary_precision': 1.0, 'binary_recall': 0.0038461538, 'binary_specificity': 1.0, 'binary_f1_score': 0.007662835}
confusion matrix:
      0  1
0  5946  0
1   259  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011737.png
early stop counter: 3
val acc:0.9755069613456726, best validation acc: 0.9817502498626709, corresponding to test acc:                         0.9605220556259155 / 0.9769577980041504
after epoch: 11,now: 2024-06-01 08:26:51.429833,epoch time: 0:28:55.699432,used: 5:18:43.483766,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_03_08_07_seed_1_21011737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9780646, 'precision': 0.87018204, 'recall': 0.7421347, 'specificity': 0.7421347, 'f1': 0.791752, 'auroc': 0.98125756, 'binary_precision': 0.7575107, 'binary_recall': 0.48959777, 'binary_specificity': 0.9946716, 'binary_f1_score': 0.59477675}
confusion matrix:
       0    1
0  42188  226
1    736  706
---- Validation: 
scalar performance:
{'acc': 0.9744931, 'precision': 0.8649404, 'recall': 0.7142546, 'specificity': 0.7142546, 'f1': 0.7683902, 'auroc': 0.9696723, 'binary_precision': 0.75064266, 'binary_recall': 0.43387815, 'binary_specificity': 0.9946311, 'binary_f1_score': 0.5499058}
confusion matrix:
       0    1
0  17970   97
1    381  292
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579439, 'precision': 0.7102622, 'recall': 0.51094985, 'specificity': 0.51094985, 'f1': 0.51122755, 'auroc': 0.9330304, 'binary_precision': 0.46153846, 'binary_recall': 0.023076924, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.043956045}
confusion matrix:
      0  1
0  5939  7
1   254  6
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011737.png
early stop counter: 4
val acc:0.9744930863380432, best validation acc: 0.9817502498626709, corresponding to test acc:                         0.9605220556259155 / 0.9769577980041504
after epoch: 12,now: 2024-06-01 08:55:34.487569,epoch time: 0:28:43.057736,used: 5:47:26.541502,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_03_08_07_seed_1_21011737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9805044, 'precision': 0.9400733, 'recall': 0.72865814, 'specificity': 0.72865814, 'f1': 0.7988111, 'auroc': 0.98448586, 'binary_precision': 0.8982361, 'binary_recall': 0.4590846, 'binary_specificity': 0.9982317, 'binary_f1_score': 0.6076182}
confusion matrix:
       0    1
0  42339   75
1    780  662
---- Validation: 
scalar performance:
{'acc': 0.9779082, 'precision': 0.95730484, 'recall': 0.70601207, 'specificity': 0.70601207, 'f1': 0.78092825, 'auroc': 0.97424865, 'binary_precision': 0.93602693, 'binary_recall': 0.41307577, 'binary_specificity': 0.99894834, 'binary_f1_score': 0.5731959}
confusion matrix:
       0    1
0  18048   19
1    395  278
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9622946, 'precision': 0.9478843, 'recall': 0.553678, 'specificity': 0.553678, 'f1': 0.5868999, 'auroc': 0.9538738, 'binary_precision': 0.93333334, 'binary_recall': 0.10769231, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.19310346}
confusion matrix:
      0   1
0  5944   2
1   232  28
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011737.png
early stop counter: 5
val acc:0.977908194065094, best validation acc: 0.9817502498626709, corresponding to test acc:                         0.9605220556259155 / 0.9769577980041504
after epoch: 13,now: 2024-06-01 09:24:13.988368,epoch time: 0:28:39.500799,used: 6:16:06.042301,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_03_08_07_seed_1_21011737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98276174, 'precision': 0.8478222, 'recall': 0.9080197, 'specificity': 0.9080197, 'f1': 0.87530124, 'auroc': 0.98736423, 'binary_precision': 0.7015276, 'binary_recall': 0.82801664, 'binary_specificity': 0.9880228, 'binary_f1_score': 0.759542}
confusion matrix:
       0     1
0  41906   508
1    248  1194
---- Validation: 
scalar performance:
{'acc': 0.982604, 'precision': 0.8699487, 'recall': 0.8836879, 'specificity': 0.8836879, 'f1': 0.8766811, 'auroc': 0.9794562, 'binary_precision': 0.74821174, 'binary_recall': 0.7771174, 'binary_specificity': 0.99025846, 'binary_f1_score': 0.7623906}
confusion matrix:
       0    1
0  17891  176
1    150  523
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587496, 'precision': 0.7510754, 'recall': 0.549989, 'specificity': 0.549989, 'f1': 0.57651997, 'auroc': 0.9574685, 'binary_precision': 0.54, 'binary_recall': 0.103846155, 'binary_specificity': 0.99613184, 'binary_f1_score': 0.17419356}
confusion matrix:
      0   1
0  5923  23
1   233  27
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011737.png
better model found
persisted
after epoch: 14,now: 2024-06-01 09:52:55.384313,epoch time: 0:28:41.395945,used: 6:44:47.438246,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_03_08_07_seed_1_21011737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98330903, 'precision': 0.8901254, 'recall': 0.83126366, 'specificity': 0.83126366, 'f1': 0.8581027, 'auroc': 0.98661953, 'binary_precision': 0.7914614, 'binary_recall': 0.6685159, 'binary_specificity': 0.9940114, 'binary_f1_score': 0.724812}
confusion matrix:
       0    1
0  42160  254
1    478  964
---- Validation: 
scalar performance:
{'acc': 0.9821238, 'precision': 0.9231672, 'recall': 0.79760677, 'specificity': 0.79760677, 'f1': 0.8485896, 'auroc': 0.9754309, 'binary_precision': 0.8611111, 'binary_recall': 0.59881127, 'binary_specificity': 0.99640226, 'binary_f1_score': 0.70639795}
confusion matrix:
       0    1
0  18002   65
1    270  403
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959233, 'precision': 0.924112, 'recall': 0.5153005, 'specificity': 0.5153005, 'f1': 0.5193222, 'auroc': 0.9685307, 'binary_precision': 0.8888889, 'binary_recall': 0.03076923, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.059479553}
confusion matrix:
      0  1
0  5945  1
1   252  8
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011737.png
early stop counter: 1
val acc:0.9821237921714783, best validation acc: 0.9826040267944336, corresponding to test acc:                         0.9587495923042297 / 0.9769577980041504
after epoch: 15,now: 2024-06-01 10:21:44.873269,epoch time: 0:28:49.488956,used: 7:13:36.927202,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_03_08_07_seed_1_21011737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9751231, 'precision': 0.9632472, 'recall': 0.62807006, 'specificity': 0.62807006, 'f1': 0.69572353, 'auroc': 0.9804376, 'binary_precision': 0.9511568, 'binary_recall': 0.25658807, 'binary_specificity': 0.999552, 'binary_f1_score': 0.40415075}
confusion matrix:
       0    1
0  42395   19
1   1072  370
---- Validation: 
scalar performance:
{'acc': 0.9715048, 'precision': 0.9659305, 'recall': 0.6075605, 'specificity': 0.6075605, 'f1': 0.6686869, 'auroc': 0.9668003, 'binary_precision': 0.9602649, 'binary_recall': 0.2154532, 'binary_specificity': 0.9996679, 'binary_f1_score': 0.35194176}
confusion matrix:
       0    1
0  18061    6
1    528  145
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589107, 'precision': 0.9794388, 'recall': 0.50961536, 'specificity': 0.50961536, 'f1': 0.50837153, 'auroc': 0.9579831, 'binary_precision': 1.0, 'binary_recall': 0.01923077, 'binary_specificity': 1.0, 'binary_f1_score': 0.037735853}
confusion matrix:
      0  1
0  5946  0
1   255  5
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011737.png
early stop counter: 2
val acc:0.971504807472229, best validation acc: 0.9826040267944336, corresponding to test acc:                         0.9587495923042297 / 0.9769577980041504
after epoch: 16,now: 2024-06-01 10:50:38.448952,epoch time: 0:28:53.575683,used: 7:42:30.502885,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_03_08_07_seed_1_21011737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98517877, 'precision': 0.92171043, 'recall': 0.82888085, 'specificity': 0.82888085, 'f1': 0.869131, 'auroc': 0.9885442, 'binary_precision': 0.8548387, 'binary_recall': 0.66158116, 'binary_specificity': 0.99618053, 'binary_f1_score': 0.74589527}
confusion matrix:
       0    1
0  42252  162
1    488  954
---- Validation: 
scalar performance:
{'acc': 0.98175025, 'precision': 0.9297998, 'recall': 0.7852535, 'specificity': 0.7852535, 'f1': 0.8417969, 'auroc': 0.9788239, 'binary_precision': 0.8752834, 'binary_recall': 0.57355124, 'binary_specificity': 0.99695575, 'binary_f1_score': 0.6929982}
confusion matrix:
       0    1
0  18012   55
1    287  386
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9553658, 'precision': 0.6148725, 'recall': 0.5169603, 'specificity': 0.5169603, 'f1': 0.5222379, 'auroc': 0.9469569, 'binary_precision': 0.27027026, 'binary_recall': 0.03846154, 'binary_specificity': 0.99545914, 'binary_f1_score': 0.06734007}
confusion matrix:
      0   1
0  5919  27
1   250  10
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011737.png
early stop counter: 3
val acc:0.9817502498626709, best validation acc: 0.9826040267944336, corresponding to test acc:                         0.9587495923042297 / 0.9769577980041504
after epoch: 17,now: 2024-06-01 11:19:39.611464,epoch time: 0:29:01.162512,used: 8:11:31.665397,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_03_08_07_seed_1_21011737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98609084, 'precision': 0.9005984, 'recall': 0.8742359, 'specificity': 0.8742359, 'f1': 0.88693273, 'auroc': 0.9895951, 'binary_precision': 0.8095238, 'binary_recall': 0.7545076, 'binary_specificity': 0.99396425, 'binary_f1_score': 0.7810481}
confusion matrix:
       0     1
0  42158   256
1    354  1088
---- Validation: 
scalar performance:
{'acc': 0.9806297, 'precision': 0.88520837, 'recall': 0.8147136, 'specificity': 0.8147136, 'f1': 0.8461021, 'auroc': 0.97555864, 'binary_precision': 0.7838828, 'binary_recall': 0.6359584, 'binary_specificity': 0.99346876, 'binary_f1_score': 0.7022149}
confusion matrix:
       0    1
0  17949  118
1    245  428
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9618111, 'precision': 0.8867638, 'recall': 0.5571037, 'specificity': 0.5571037, 'f1': 0.59122884, 'auroc': 0.95200884, 'binary_precision': 0.8108108, 'binary_recall': 0.115384616, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.2020202}
confusion matrix:
      0   1
0  5939   7
1   230  30
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011737.png
early stop counter: 4
val acc:0.9806296825408936, best validation acc: 0.9826040267944336, corresponding to test acc:                         0.9587495923042297 / 0.9769577980041504
after epoch: 18,now: 2024-06-01 11:48:43.780731,epoch time: 0:29:04.169267,used: 8:40:35.834664,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_03_08_07_seed_1_21011737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9834914, 'precision': 0.8973352, 'recall': 0.82499385, 'specificity': 0.82499385, 'f1': 0.85726106, 'auroc': 0.9872217, 'binary_precision': 0.806314, 'binary_recall': 0.6553398, 'binary_specificity': 0.994648, 'binary_f1_score': 0.7230299}
confusion matrix:
       0    1
0  42187  227
1    497  945
---- Validation: 
scalar performance:
{'acc': 0.9783885, 'precision': 0.8671186, 'recall': 0.79566956, 'specificity': 0.79566956, 'f1': 0.8271996, 'auroc': 0.9771447, 'binary_precision': 0.74907064, 'binary_recall': 0.59881127, 'binary_specificity': 0.99252784, 'binary_f1_score': 0.66556567}
confusion matrix:
       0    1
0  17932  135
1    270  403
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96003866, 'precision': 0.8142085, 'recall': 0.5451448, 'specificity': 0.5451448, 'f1': 0.5708467, 'auroc': 0.9464124, 'binary_precision': 0.6666667, 'binary_recall': 0.092307694, 'binary_specificity': 0.99798185, 'binary_f1_score': 0.16216217}
confusion matrix:
      0   1
0  5934  12
1   236  24
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011737.png
early stop counter: 5
val acc:0.9783884882926941, best validation acc: 0.9826040267944336, corresponding to test acc:                         0.9587495923042297 / 0.9769577980041504
after epoch: 19,now: 2024-06-01 12:17:41.899527,epoch time: 0:28:58.118796,used: 9:09:33.953460,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_03_08_07_seed_1_21011737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.98369664, 'precision': 0.85920346, 'recall': 0.90113413, 'specificity': 0.90113413, 'f1': 0.87890863, 'auroc': 0.9886006, 'binary_precision': 0.72479904, 'binary_recall': 0.81276006, 'binary_specificity': 0.98950815, 'binary_f1_score': 0.76626354}
confusion matrix:
       0     1
0  41969   445
1    270  1172
---- Validation: 
scalar performance:
{'acc': 0.983031, 'precision': 0.88321745, 'recall': 0.8667429, 'specificity': 0.8667429, 'f1': 0.87478274, 'auroc': 0.9774064, 'binary_precision': 0.7760498, 'binary_recall': 0.74145615, 'binary_specificity': 0.99202967, 'binary_f1_score': 0.7583587}
confusion matrix:
       0    1
0  17923  144
1    174  499
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96132773, 'precision': 0.7968865, 'recall': 0.59179217, 'specificity': 0.59179217, 'f1': 0.6350317, 'auroc': 0.95914173, 'binary_precision': 0.6282051, 'binary_recall': 0.18846154, 'binary_specificity': 0.9951228, 'binary_f1_score': 0.28994083}
confusion matrix:
      0   1
0  5917  29
1   211  49
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011737.png
better model found
persisted
after epoch: 20,now: 2024-06-01 12:46:42.514958,epoch time: 0:29:00.615431,used: 9:38:34.568891,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_03_08_07_seed_1_21011737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.98622763, 'precision': 0.89153457, 'recall': 0.89205915, 'specificity': 0.89205915, 'f1': 0.8917967, 'auroc': 0.98811567, 'binary_precision': 0.7901662, 'binary_recall': 0.79126215, 'binary_specificity': 0.99285614, 'binary_f1_score': 0.7907138}
confusion matrix:
       0     1
0  42111   303
1    301  1141
---- Validation: 
scalar performance:
{'acc': 0.9847919, 'precision': 0.9125894, 'recall': 0.8562119, 'specificity': 0.8562119, 'f1': 0.88215786, 'auroc': 0.97736704, 'binary_precision': 0.83564013, 'binary_recall': 0.717682, 'binary_specificity': 0.9947418, 'binary_f1_score': 0.7721823}
confusion matrix:
       0    1
0  17972   95
1    190  483
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597164, 'precision': 0.9085456, 'recall': 0.52290875, 'specificity': 0.52290875, 'f1': 0.5334974, 'auroc': 0.94602126, 'binary_precision': 0.85714287, 'binary_recall': 0.046153847, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.087591246}
confusion matrix:
      0   1
0  5944   2
1   248  12
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011737.png
better model found
persisted
after epoch: 21,now: 2024-06-01 13:15:44.342870,epoch time: 0:29:01.827912,used: 10:07:36.396803,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_03_08_07_seed_1_21011737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.98570323, 'precision': 0.87304217, 'recall': 0.9175793, 'specificity': 0.9175793, 'f1': 0.8939458, 'auroc': 0.9897001, 'binary_precision': 0.751388, 'binary_recall': 0.8446602, 'binary_specificity': 0.9904984, 'binary_f1_score': 0.79529876}
confusion matrix:
       0     1
0  42011   403
1    224  1218
---- Validation: 
scalar performance:
{'acc': 0.9842049, 'precision': 0.88291454, 'recall': 0.8916708, 'specificity': 0.8916708, 'f1': 0.8872386, 'auroc': 0.9813888, 'binary_precision': 0.7735849, 'binary_recall': 0.7919762, 'binary_specificity': 0.9913655, 'binary_f1_score': 0.7826725}
confusion matrix:
       0    1
0  17911  156
1    140  533
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9622946, 'precision': 0.92254394, 'recall': 0.55735594, 'specificity': 0.55735594, 'f1': 0.59238577, 'auroc': 0.9605535, 'binary_precision': 0.88235295, 'binary_recall': 0.115384616, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.20408162}
confusion matrix:
      0   1
0  5942   4
1   230  30
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011737.png
early stop counter: 1
val acc:0.984204888343811, best validation acc: 0.9847918748855591, corresponding to test acc:                         0.9597163796424866 / 0.9769577980041504
after epoch: 22,now: 2024-06-01 13:44:35.955059,epoch time: 0:28:51.612189,used: 10:36:28.008992,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_03_08_07_seed_1_21011737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9868889, 'precision': 0.93844664, 'recall': 0.8428281, 'specificity': 0.8428281, 'f1': 0.8843628, 'auroc': 0.99214923, 'binary_precision': 0.88739944, 'binary_recall': 0.6886269, 'binary_specificity': 0.9970293, 'binary_f1_score': 0.77547824}
confusion matrix:
       0    1
0  42288  126
1    449  993
---- Validation: 
scalar performance:
{'acc': 0.98041624, 'precision': 0.930685, 'recall': 0.76238835, 'specificity': 0.76238835, 'f1': 0.8245785, 'auroc': 0.9784163, 'binary_precision': 0.8787129, 'binary_recall': 0.5274888, 'binary_specificity': 0.99728787, 'binary_f1_score': 0.6592386}
confusion matrix:
       0    1
0  18018   49
1    318  355
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96310025, 'precision': 0.8841704, 'recall': 0.57800525, 'specificity': 0.57800525, 'f1': 0.62237084, 'auroc': 0.9527449, 'binary_precision': 0.8039216, 'binary_recall': 0.15769231, 'binary_specificity': 0.9983182, 'binary_f1_score': 0.26366562}
confusion matrix:
      0   1
0  5936  10
1   219  41
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011737.png
early stop counter: 2
val acc:0.9804162383079529, best validation acc: 0.9847918748855591, corresponding to test acc:                         0.9597163796424866 / 0.9769577980041504
after epoch: 23,now: 2024-06-01 14:13:23.425712,epoch time: 0:28:47.470653,used: 11:05:15.479645,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_03_08_07_seed_1_21011737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.98668367, 'precision': 0.8954343, 'recall': 0.89490414, 'specificity': 0.89490414, 'f1': 0.895169, 'auroc': 0.99107563, 'binary_precision': 0.7977762, 'binary_recall': 0.796669, 'binary_specificity': 0.9931392, 'binary_f1_score': 0.79722226}
confusion matrix:
       0     1
0  42124   291
1    293  1148
---- Validation: 
scalar performance:
{'acc': 0.9825507, 'precision': 0.888654, 'recall': 0.8478969, 'specificity': 0.8478969, 'f1': 0.8670475, 'auroc': 0.97900164, 'binary_precision': 0.78833336, 'binary_recall': 0.70282316, 'binary_specificity': 0.9929706, 'binary_f1_score': 0.74312645}
confusion matrix:
       0    1
0  17940  127
1    200  473
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9574605, 'precision': 0.69666994, 'recall': 0.5235705, 'specificity': 0.5235705, 'f1': 0.5339383, 'auroc': 0.9448998, 'binary_precision': 0.43333334, 'binary_recall': 0.05, 'binary_specificity': 0.99714094, 'binary_f1_score': 0.08965517}
confusion matrix:
      0   1
0  5929  17
1   247  13
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011737.png
early stop counter: 3
val acc:0.9825506806373596, best validation acc: 0.9847918748855591, corresponding to test acc:                         0.9597163796424866 / 0.9769577980041504
after epoch: 24,now: 2024-06-01 14:42:17.445451,epoch time: 0:28:54.019739,used: 11:34:09.499384,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_03_08_07_seed_1_21011737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9871397, 'precision': 0.9127383, 'recall': 0.87779284, 'specificity': 0.87779284, 'f1': 0.89443266, 'auroc': 0.99140286, 'binary_precision': 0.83358663, 'binary_recall': 0.760749, 'binary_specificity': 0.9948366, 'binary_f1_score': 0.7955041}
confusion matrix:
       0     1
0  42195   219
1    345  1097
---- Validation: 
scalar performance:
{'acc': 0.98356456, 'precision': 0.91322386, 'recall': 0.8334021, 'specificity': 0.8334021, 'f1': 0.8686911, 'auroc': 0.9693271, 'binary_precision': 0.83858997, 'binary_recall': 0.6716196, 'binary_specificity': 0.9951846, 'binary_f1_score': 0.7458746}
confusion matrix:
       0    1
0  17980   87
1    221  452
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95681596, 'precision': 0.6711668, 'recall': 0.52323407, 'specificity': 0.52323407, 'f1': 0.53315973, 'auroc': 0.94190145, 'binary_precision': 0.38235295, 'binary_recall': 0.05, 'binary_specificity': 0.9964682, 'binary_f1_score': 0.088435374}
confusion matrix:
      0   1
0  5925  21
1   247  13
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011737.png
early stop counter: 4
val acc:0.983564555644989, best validation acc: 0.9847918748855591, corresponding to test acc:                         0.9597163796424866 / 0.9769577980041504
after epoch: 25,now: 2024-06-01 15:10:57.389930,epoch time: 0:28:39.944479,used: 12:02:49.443863,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_03_08_07_seed_1_21011737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99001276, 'precision': 0.9440568, 'recall': 0.89267623, 'specificity': 0.89267623, 'f1': 0.9166714, 'auroc': 0.99333566, 'binary_precision': 0.8952756, 'binary_recall': 0.7884882, 'binary_specificity': 0.99686426, 'binary_f1_score': 0.8384956}
confusion matrix:
       0     1
0  42281   133
1    305  1137
---- Validation: 
scalar performance:
{'acc': 0.983191, 'precision': 0.92511535, 'recall': 0.8138962, 'specificity': 0.8138962, 'f1': 0.8604698, 'auroc': 0.97524714, 'binary_precision': 0.86382115, 'binary_recall': 0.6315007, 'binary_specificity': 0.9962916, 'binary_f1_score': 0.7296137}
confusion matrix:
       0    1
0  18000   67
1    248  425
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95987755, 'precision': 0.8323503, 'recall': 0.5358657, 'specificity': 0.5358657, 'f1': 0.555934, 'auroc': 0.9469373, 'binary_precision': 0.7037037, 'binary_recall': 0.073076926, 'binary_specificity': 0.99865454, 'binary_f1_score': 0.1324042}
confusion matrix:
      0   1
0  5938   8
1   241  19
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011737.png
early stop counter: 5
val acc:0.9831910133361816, best validation acc: 0.9847918748855591, corresponding to test acc:                         0.9597163796424866 / 0.9769577980041504
after epoch: 26,now: 2024-06-01 15:39:39.172532,epoch time: 0:28:41.782602,used: 12:31:31.226465,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_03_08_07_seed_1_21011737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.98825705, 'precision': 0.93489105, 'recall': 0.87133646, 'specificity': 0.87133646, 'f1': 0.9004218, 'auroc': 0.9927211, 'binary_precision': 0.87836736, 'binary_recall': 0.74618584, 'binary_specificity': 0.996487, 'binary_f1_score': 0.8068992}
confusion matrix:
       0     1
0  42265   149
1    366  1076
---- Validation: 
scalar performance:
{'acc': 0.9825507, 'precision': 0.93306386, 'recall': 0.7956824, 'specificity': 0.7956824, 'f1': 0.85042703, 'auroc': 0.9748985, 'binary_precision': 0.88105726, 'binary_recall': 0.5943536, 'binary_specificity': 0.9970111, 'binary_f1_score': 0.7098491}
confusion matrix:
       0    1
0  18013   54
1    273  400
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96019983, 'precision': 0.85094976, 'recall': 0.5378729, 'specificity': 0.5378729, 'f1': 0.5595008, 'auroc': 0.94070303, 'binary_precision': 0.7407407, 'binary_recall': 0.07692308, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.13937283}
confusion matrix:
      0   1
0  5939   7
1   240  20
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011737.png
early stop counter: 6
val acc:0.9825506806373596, best validation acc: 0.9847918748855591, corresponding to test acc:                         0.9597163796424866 / 0.9769577980041504
after epoch: 27,now: 2024-06-01 16:08:27.612413,epoch time: 0:28:48.439881,used: 13:00:19.666346,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_03_08_07_seed_1_21011737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9891007, 'precision': 0.91251266, 'recall': 0.9169356, 'specificity': 0.9169356, 'f1': 0.9147114, 'auroc': 0.994354, 'binary_precision': 0.8304736, 'binary_recall': 0.8396947, 'binary_specificity': 0.99417657, 'binary_f1_score': 0.8350587}
confusion matrix:
       0     1
0  42168   247
1    231  1210
---- Validation: 
scalar performance:
{'acc': 0.9847385, 'precision': 0.9060476, 'recall': 0.8640522, 'specificity': 0.8640522, 'f1': 0.8838055, 'auroc': 0.9771235, 'binary_precision': 0.82196337, 'binary_recall': 0.73402673, 'binary_specificity': 0.9940776, 'binary_f1_score': 0.7755102}
confusion matrix:
       0    1
0  17960  107
1    179  494
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959233, 'precision': 0.76119673, 'recall': 0.5612752, 'specificity': 0.5612752, 'f1': 0.59298766, 'auroc': 0.9497296, 'binary_precision': 0.55932206, 'binary_recall': 0.12692308, 'binary_specificity': 0.9956273, 'binary_f1_score': 0.20689657}
confusion matrix:
      0   1
0  5920  26
1   227  33
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011737.png
early stop counter: 7
val acc:0.9847385287284851, best validation acc: 0.9847918748855591, corresponding to test acc:                         0.9597163796424866 / 0.9769577980041504
after epoch: 28,now: 2024-06-01 16:37:11.365523,epoch time: 0:28:43.753110,used: 13:29:03.419456,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_03_08_07_seed_1_21011737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9888955, 'precision': 0.9119391, 'recall': 0.91387045, 'specificity': 0.91387045, 'f1': 0.91290236, 'auroc': 0.99256516, 'binary_precision': 0.82953763, 'binary_recall': 0.8335645, 'binary_specificity': 0.99417645, 'binary_f1_score': 0.8315462}
confusion matrix:
       0     1
0  42167   247
1    240  1202
---- Validation: 
scalar performance:
{'acc': 0.98404485, 'precision': 0.9012008, 'recall': 0.85797024, 'specificity': 0.85797024, 'f1': 0.8782473, 'auroc': 0.9781313, 'binary_precision': 0.81270903, 'binary_recall': 0.72213966, 'binary_specificity': 0.9938009, 'binary_f1_score': 0.7647522}
confusion matrix:
       0    1
0  17955  112
1    187  486
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95762163, 'precision': 0.72063607, 'recall': 0.56043434, 'specificity': 0.56043434, 'f1': 0.5894209, 'auroc': 0.9421748, 'binary_precision': 0.47826087, 'binary_recall': 0.12692308, 'binary_specificity': 0.99394554, 'binary_f1_score': 0.20060791}
confusion matrix:
      0   1
0  5910  36
1   227  33
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011737.png
early stop counter: 8
val acc:0.9840448498725891, best validation acc: 0.9847918748855591, corresponding to test acc:                         0.9597163796424866 / 0.9769577980041504
after epoch: 29,now: 2024-06-01 17:05:58.818520,epoch time: 0:28:47.452997,used: 13:57:50.872453,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_03_08_07_seed_1_21011737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.98980755, 'precision': 0.94540405, 'recall': 0.8875458, 'specificity': 0.8875458, 'f1': 0.9143166, 'auroc': 0.9943124, 'binary_precision': 0.89831865, 'binary_recall': 0.778086, 'binary_specificity': 0.9970057, 'binary_f1_score': 0.83389074}
confusion matrix:
       0     1
0  42287   127
1    320  1122
---- Validation: 
scalar performance:
{'acc': 0.98297757, 'precision': 0.92811, 'recall': 0.807348, 'specificity': 0.807348, 'f1': 0.8570344, 'auroc': 0.97686553, 'binary_precision': 0.8702929, 'binary_recall': 0.61812776, 'binary_specificity': 0.9965683, 'binary_f1_score': 0.7228496}
confusion matrix:
       0    1
0  18005   62
1    257  416
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614889, 'precision': 0.8594762, 'recall': 0.5587745, 'specificity': 0.5587745, 'f1': 0.59312296, 'auroc': 0.95421, 'binary_precision': 0.75609756, 'binary_recall': 0.11923077, 'binary_specificity': 0.9983182, 'binary_f1_score': 0.20598008}
confusion matrix:
      0   1
0  5936  10
1   229  31
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011737.png
early stop counter: 9
val acc:0.982977569103241, best validation acc: 0.9847918748855591, corresponding to test acc:                         0.9597163796424866 / 0.9769577980041504
after epoch: 30,now: 2024-06-01 17:34:48.536729,epoch time: 0:28:49.718209,used: 14:26:40.590662,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_03_08_07_seed_1_21011737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 14:26:40.590662 at 2024-06-01 17:34:48.536729
persisted model performance metric: 

scalar performance:
{'acc': 0.95939416, 'precision': 0.8727505, 'recall': 0.52090156, 'specificity': 0.52090156, 'f1': 0.52976537, 'auroc': 0.9463564, 'binary_precision': 0.78571427, 'binary_recall': 0.042307694, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.08029198}
confusion matrix:
      0   1
0  5943   3
1   249  11
oracle model performance metric: 

scalar performance:
{'acc': 0.9766355, 'precision': 0.9615139, 'recall': 0.7340268, 'specificity': 0.7340268, 'f1': 0.8075946, 'auroc': 0.94897, 'binary_precision': 0.9457364, 'binary_recall': 0.46923077, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.62724936}
confusion matrix:
      0    1
0  5939    7
1   138  122
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456479 KiB |  13219 MiB |   2240 TiB |   2240 TiB |
|       from large pool | 414803 KiB |  13181 MiB |   2213 TiB |   2213 TiB |
|       from small pool |  41675 KiB |     61 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 456479 KiB |  13219 MiB |   2240 TiB |   2240 TiB |
|       from large pool | 414803 KiB |  13181 MiB |   2213 TiB |   2213 TiB |
|       from small pool |  41675 KiB |     61 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447751 KiB |  13213 MiB |   2231 TiB |   2231 TiB |
|       from large pool | 407075 KiB |  13175 MiB |   2205 TiB |   2205 TiB |
|       from small pool |  40676 KiB |     60 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14478 MiB |  14478 MiB |  28048 MiB |  13570 MiB |
|       from large pool |  14412 MiB |  14412 MiB |  27960 MiB |  13548 MiB |
|       from small pool |     66 MiB |     72 MiB |     88 MiB |     22 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 446689 KiB |   1238 MiB |   1572 TiB |   1572 TiB |
|       from large pool | 435116 KiB |   1229 MiB |   1546 TiB |   1546 TiB |
|       from small pool |  11572 KiB |     37 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3464    |    6487    |  395835 K  |  395831 K  |
|       from large pool |     187    |    1413    |  205679 K  |  205679 K  |
|       from small pool |    3277    |    6298    |  190155 K  |  190151 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3464    |    6487    |  395835 K  |  395831 K  |
|       from large pool |     187    |    1413    |  205679 K  |  205679 K  |
|       from small pool |    3277    |    6298    |  190155 K  |  190151 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     635    |     637    |    1209    |     574    |
|       from large pool |     602    |     602    |    1165    |     563    |
|       from small pool |      33    |      36    |      44    |      11    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      83    |    2806    |  261641 K  |  261641 K  |
|       from large pool |      38    |     605    |  162402 K  |  162402 K  |
|       from small pool |      45    |    2768    |   99239 K  |   99238 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   2240 TiB |   2240 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   2213 TiB |   2213 TiB |
|       from small pool |      0 KiB |     61 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   2240 TiB |   2240 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   2213 TiB |   2213 TiB |
|       from small pool |      0 KiB |     61 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   2231 TiB |   2231 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   2205 TiB |   2205 TiB |
|       from small pool |      0 KiB |     60 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14478 MiB |  28048 MiB |  27166 MiB |
|       from large pool |    830 MiB |  14412 MiB |  27960 MiB |  27130 MiB |
|       from small pool |     52 MiB |     72 MiB |     88 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1238 MiB |   1572 TiB |   1572 TiB |
|       from large pool |  24320 KiB |   1229 MiB |   1546 TiB |   1546 TiB |
|       from small pool |      0 KiB |     42 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6487    |  395835 K  |  395835 K  |
|       from large pool |       2    |    1413    |  205679 K  |  205679 K  |
|       from small pool |       0    |    6298    |  190155 K  |  190155 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6487    |  395835 K  |  395835 K  |
|       from large pool |       2    |    1413    |  205679 K  |  205679 K  |
|       from small pool |       0    |    6298    |  190155 K  |  190155 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     637    |    1209    |    1146    |
|       from large pool |      37    |     602    |    1165    |    1128    |
|       from small pool |      26    |      36    |      44    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2806    |  261643 K  |  261643 K  |
|       from large pool |       4    |     605    |  162402 K  |  162402 K  |
|       from small pool |       0    |    2768    |   99240 K  |   99240 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   2240 TiB |   2240 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   2213 TiB |   2213 TiB |
|       from small pool |      0 KiB |     61 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   2240 TiB |   2240 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   2213 TiB |   2213 TiB |
|       from small pool |      0 KiB |     61 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   2231 TiB |   2231 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   2205 TiB |   2205 TiB |
|       from small pool |      0 KiB |     60 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14478 MiB |  28048 MiB |  27166 MiB |
|       from large pool |    830 MiB |  14412 MiB |  27960 MiB |  27130 MiB |
|       from small pool |     52 MiB |     72 MiB |     88 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1238 MiB |   1572 TiB |   1572 TiB |
|       from large pool |  24320 KiB |   1229 MiB |   1546 TiB |   1546 TiB |
|       from small pool |      0 KiB |     42 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6487    |  395835 K  |  395835 K  |
|       from large pool |       2    |    1413    |  205679 K  |  205679 K  |
|       from small pool |       0    |    6298    |  190155 K  |  190155 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6487    |  395835 K  |  395835 K  |
|       from large pool |       2    |    1413    |  205679 K  |  205679 K  |
|       from small pool |       0    |    6298    |  190155 K  |  190155 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     637    |    1209    |    1146    |
|       from large pool |      37    |     602    |    1165    |    1128    |
|       from small pool |      26    |      36    |      44    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2806    |  261643 K  |  261643 K  |
|       from large pool |       4    |     605    |  162402 K  |  162402 K  |
|       from small pool |       0    |    2768    |   99240 K  |   99240 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_17_44_39_seed_2_21011737

 Experiment start at: 2024-06-01 17:44:39.854714
before training, model accuracy: 0.7679115533828735
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.965544, 'precision': 0.7769629, 'recall': 0.503222, 'specificity': 0.503222, 'f1': 0.4977689, 'auroc': 0.95663095, 'binary_precision': 0.5882353, 'binary_recall': 0.0066093854, 'binary_specificity': 0.99983454, 'binary_f1_score': 0.013071896}
confusion matrix:
       0   1
0  42304   7
1   1503  10
---- Validation: 
scalar performance:
{'acc': 0.9686251, 'precision': 0.76251787, 'recall': 0.55416197, 'specificity': 0.55416197, 'f1': 0.58467174, 'auroc': 0.9585551, 'binary_precision': 0.553719, 'binary_recall': 0.11129568, 'binary_specificity': 0.99702823, 'binary_f1_score': 0.18533885}
confusion matrix:
       0   1
0  18117  54
1    535  67
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96185285, 'precision': 0.98091424, 'recall': 0.5082645, 'specificity': 0.5082645, 'f1': 0.5065316, 'auroc': 0.9475031, 'binary_precision': 1.0, 'binary_recall': 0.016528925, 'binary_specificity': 1.0, 'binary_f1_score': 0.032520324}
confusion matrix:
      0  1
0  5997  0
1   238  4
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011737.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-01 18:14:29.698482,epoch time: 0:29:49.843768,used: 0:29:49.843768,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_17_44_39_seed_2_21011737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96971977, 'precision': 0.7839707, 'recall': 0.69848764, 'specificity': 0.69848764, 'f1': 0.7329213, 'auroc': 0.9613683, 'binary_precision': 0.58891016, 'binary_recall': 0.40713814, 'binary_specificity': 0.98983717, 'binary_f1_score': 0.48143807}
confusion matrix:
       0    1
0  41881  430
1    897  616
---- Validation: 
scalar performance:
{'acc': 0.9686784, 'precision': 0.74760234, 'recall': 0.7308601, 'specificity': 0.7308601, 'f1': 0.73890746, 'auroc': 0.95648336, 'binary_precision': 0.5125, 'binary_recall': 0.47674417, 'binary_specificity': 0.98497605, 'binary_f1_score': 0.4939759}
confusion matrix:
       0    1
0  17898  273
1    315  287
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96361595, 'precision': 0.7866852, 'recall': 0.58650845, 'specificity': 0.58650845, 'f1': 0.62805015, 'auroc': 0.9341806, 'binary_precision': 0.6056338, 'binary_recall': 0.17768595, 'binary_specificity': 0.995331, 'binary_f1_score': 0.2747604}
confusion matrix:
      0   1
0  5969  28
1   199  43
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011737.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-01 18:43:12.001696,epoch time: 0:28:42.303214,used: 0:58:32.146982,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_17_44_39_seed_2_21011737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9727318, 'precision': 0.80097175, 'recall': 0.76919496, 'specificity': 0.76919496, 'f1': 0.78410983, 'auroc': 0.9700985, 'binary_precision': 0.6179525, 'binary_recall': 0.5505618, 'binary_specificity': 0.9878282, 'binary_f1_score': 0.5823139}
confusion matrix:
       0    1
0  41796  515
1    680  833
---- Validation: 
scalar performance:
{'acc': 0.9738454, 'precision': 0.7976822, 'recall': 0.74718106, 'specificity': 0.74718106, 'f1': 0.7698793, 'auroc': 0.9621649, 'binary_precision': 0.61167, 'binary_recall': 0.50498337, 'binary_specificity': 0.9893787, 'binary_f1_score': 0.55323017}
confusion matrix:
       0    1
0  17978  193
1    298  304
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97515625, 'precision': 0.96665895, 'recall': 0.68768305, 'specificity': 0.68768305, 'f1': 0.76364636, 'auroc': 0.95974654, 'binary_precision': 0.95789474, 'binary_recall': 0.37603307, 'binary_specificity': 0.999333, 'binary_f1_score': 0.5400593}
confusion matrix:
      0   1
0  5993   4
1   151  91
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011737.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-01 19:11:50.955345,epoch time: 0:28:38.953649,used: 1:27:11.100631,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_17_44_39_seed_2_21011737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9703587, 'precision': 0.8584666, 'recall': 0.60640943, 'specificity': 0.60640943, 'f1': 0.6595148, 'auroc': 0.9679383, 'binary_precision': 0.74429226, 'binary_recall': 0.21546596, 'binary_specificity': 0.99735296, 'binary_f1_score': 0.3341876}
confusion matrix:
       0    1
0  42199  112
1   1187  326
---- Validation: 
scalar performance:
{'acc': 0.97150165, 'precision': 0.8074149, 'recall': 0.6255131, 'specificity': 0.6255131, 'f1': 0.6753927, 'auroc': 0.9645107, 'binary_precision': 0.6390042, 'binary_recall': 0.25581396, 'binary_specificity': 0.99521214, 'binary_f1_score': 0.3653618}
confusion matrix:
       0    1
0  18084   87
1    448  154
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9623337, 'precision': 0.98114574, 'recall': 0.5144628, 'specificity': 0.5144628, 'f1': 0.51850414, 'auroc': 0.94249296, 'binary_precision': 1.0, 'binary_recall': 0.02892562, 'binary_specificity': 1.0, 'binary_f1_score': 0.056224898}
confusion matrix:
      0  1
0  5997  0
1   235  7
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011737.png
early stop counter: 1
val acc:0.9715016484260559, best validation acc: 0.9738454222679138, corresponding to test acc:                         0.9751562476158142 / 0.9751562476158142
after epoch: 4,now: 2024-06-01 19:40:29.297726,epoch time: 0:28:38.342381,used: 1:55:49.443012,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_17_44_39_seed_2_21011737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9781855, 'precision': 0.8320322, 'recall': 0.8497704, 'specificity': 0.8497704, 'f1': 0.84064806, 'auroc': 0.9773269, 'binary_precision': 0.6743895, 'binary_recall': 0.7118308, 'binary_specificity': 0.98771006, 'binary_f1_score': 0.69260454}
confusion matrix:
       0     1
0  41791   520
1    436  1077
---- Validation: 
scalar performance:
{'acc': 0.97709477, 'precision': 0.81387836, 'recall': 0.82193696, 'specificity': 0.82193696, 'f1': 0.81785184, 'auroc': 0.9743115, 'binary_precision': 0.63915855, 'binary_recall': 0.65614617, 'binary_specificity': 0.9877277, 'binary_f1_score': 0.6475409}
confusion matrix:
       0    1
0  17948  223
1    207  395
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9652188, 'precision': 0.79969835, 'recall': 0.62303156, 'specificity': 0.62303156, 'f1': 0.67100286, 'auroc': 0.9467757, 'binary_precision': 0.62886596, 'binary_recall': 0.2520661, 'binary_specificity': 0.993997, 'binary_f1_score': 0.359882}
confusion matrix:
      0   1
0  5961  36
1   181  61
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011737.png
better model found
persisted
after epoch: 5,now: 2024-06-01 20:09:20.166489,epoch time: 0:28:50.868763,used: 2:24:40.311775,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_17_44_39_seed_2_21011737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9807183, 'precision': 0.8698718, 'recall': 0.82558995, 'specificity': 0.82558995, 'f1': 0.8461982, 'auroc': 0.97882205, 'binary_precision': 0.75188535, 'binary_recall': 0.6589557, 'binary_specificity': 0.9922242, 'binary_f1_score': 0.70236}
confusion matrix:
       0    1
0  41982  329
1    516  997
---- Validation: 
scalar performance:
{'acc': 0.97997123, 'precision': 0.8657546, 'recall': 0.78166425, 'specificity': 0.78166425, 'f1': 0.8178226, 'auroc': 0.97277737, 'binary_precision': 0.7456522, 'binary_recall': 0.5697674, 'binary_specificity': 0.99356115, 'binary_f1_score': 0.645951}
confusion matrix:
       0    1
0  18054  117
1    259  343
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650585, 'precision': 0.8176044, 'recall': 0.59717256, 'specificity': 0.59717256, 'f1': 0.6439054, 'auroc': 0.95001286, 'binary_precision': 0.6666667, 'binary_recall': 0.1983471, 'binary_specificity': 0.995998, 'binary_f1_score': 0.30573252}
confusion matrix:
      0   1
0  5973  24
1   194  48
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011737.png
better model found
persisted
after epoch: 6,now: 2024-06-01 20:40:24.739720,epoch time: 0:31:04.573231,used: 2:55:44.885006,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_17_44_39_seed_2_21011737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98158544, 'precision': 0.8924105, 'recall': 0.8094691, 'specificity': 0.8094691, 'f1': 0.8456396, 'auroc': 0.9793059, 'binary_precision': 0.7981419, 'binary_recall': 0.62458694, 'binary_specificity': 0.9943513, 'binary_f1_score': 0.7007787}
confusion matrix:
       0    1
0  42072  239
1    568  945
---- Validation: 
scalar performance:
{'acc': 0.9802376, 'precision': 0.8912568, 'recall': 0.75449824, 'specificity': 0.75449824, 'f1': 0.80736256, 'auroc': 0.9764177, 'binary_precision': 0.79844964, 'binary_recall': 0.51328903, 'binary_specificity': 0.99570745, 'binary_f1_score': 0.6248736}
confusion matrix:
       0    1
0  18093   78
1    293  309
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9631351, 'precision': 0.8157612, 'recall': 0.5485863, 'specificity': 0.5485863, 'f1': 0.5769047, 'auroc': 0.9550137, 'binary_precision': 0.6666667, 'binary_recall': 0.09917355, 'binary_specificity': 0.997999, 'binary_f1_score': 0.17266189}
confusion matrix:
      0   1
0  5985  12
1   218  24
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011737.png
better model found
persisted
after epoch: 7,now: 2024-06-01 21:11:40.783038,epoch time: 0:31:16.043318,used: 3:27:00.928324,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_17_44_39_seed_2_21011737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97843647, 'precision': 0.90470743, 'recall': 0.7351857, 'specificity': 0.7351857, 'f1': 0.79584587, 'auroc': 0.97714996, 'binary_precision': 0.8279446, 'binary_recall': 0.47389293, 'binary_specificity': 0.99647844, 'binary_f1_score': 0.6027743}
confusion matrix:
       0    1
0  42162  149
1    796  717
---- Validation: 
scalar performance:
{'acc': 0.97816014, 'precision': 0.8812629, 'recall': 0.71969706, 'specificity': 0.71969706, 'f1': 0.7772382, 'auroc': 0.9734884, 'binary_precision': 0.78070176, 'binary_recall': 0.4435216, 'binary_specificity': 0.99587256, 'binary_f1_score': 0.56567794}
confusion matrix:
       0    1
0  18096   75
1    335  267
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96281457, 'precision': 0.77931976, 'recall': 0.56428146, 'specificity': 0.56428146, 'f1': 0.59858584, 'auroc': 0.9445749, 'binary_precision': 0.5925926, 'binary_recall': 0.1322314, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.2162162}
confusion matrix:
      0   1
0  5975  22
1   210  32
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011737.png
early stop counter: 1
val acc:0.9781601428985596, best validation acc: 0.980237603187561, corresponding to test acc:                         0.9631351232528687 / 0.9751562476158142
after epoch: 8,now: 2024-06-01 21:42:52.687843,epoch time: 0:31:11.904805,used: 3:58:12.833129,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_17_44_39_seed_2_21011737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9794633, 'precision': 0.9214082, 'recall': 0.7401786, 'specificity': 0.7401786, 'f1': 0.8042071, 'auroc': 0.98302263, 'binary_precision': 0.86101294, 'binary_recall': 0.48314607, 'binary_specificity': 0.9972111, 'binary_f1_score': 0.618967}
confusion matrix:
       0    1
0  42193  118
1    782  731
---- Validation: 
scalar performance:
{'acc': 0.98007774, 'precision': 0.92485297, 'recall': 0.72229373, 'specificity': 0.72229373, 'f1': 0.7898516, 'auroc': 0.9776144, 'binary_precision': 0.86774194, 'binary_recall': 0.44684386, 'binary_specificity': 0.99774367, 'binary_f1_score': 0.5899123}
confusion matrix:
       0    1
0  18130   41
1    333  269
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9616926, 'precision': 0.9808371, 'recall': 0.50619835, 'specificity': 0.50619835, 'f1': 0.5024762, 'auroc': 0.94775724, 'binary_precision': 1.0, 'binary_recall': 0.012396694, 'binary_specificity': 1.0, 'binary_f1_score': 0.024489796}
confusion matrix:
      0  1
0  5997  0
1   239  3
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011737.png
early stop counter: 2
val acc:0.9800777435302734, best validation acc: 0.980237603187561, corresponding to test acc:                         0.9631351232528687 / 0.9751562476158142
after epoch: 9,now: 2024-06-01 22:14:11.888377,epoch time: 0:31:19.200534,used: 4:29:32.033663,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_17_44_39_seed_2_21011737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.97868747, 'precision': 0.9440831, 'recall': 0.7120541, 'specificity': 0.7120541, 'f1': 0.78436226, 'auroc': 0.98292625, 'binary_precision': 0.90832156, 'binary_recall': 0.42564443, 'binary_specificity': 0.99846375, 'binary_f1_score': 0.579658}
confusion matrix:
       0    1
0  42246   65
1    869  644
---- Validation: 
scalar performance:
{'acc': 0.9768284, 'precision': 0.9198687, 'recall': 0.6644019, 'specificity': 0.6644019, 'f1': 0.73297125, 'auroc': 0.97330904, 'binary_precision': 0.86147183, 'binary_recall': 0.3305648, 'binary_specificity': 0.998239, 'binary_f1_score': 0.4777911}
confusion matrix:
       0    1
0  18139   32
1    403  199
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9620131, 'precision': 0.7749875, 'recall': 0.5341235, 'specificity': 0.5341235, 'f1': 0.55302304, 'auroc': 0.9573327, 'binary_precision': 0.5862069, 'binary_recall': 0.07024793, 'binary_specificity': 0.997999, 'binary_f1_score': 0.12546125}
confusion matrix:
      0   1
0  5985  12
1   225  17
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011737.png
early stop counter: 3
val acc:0.976828396320343, best validation acc: 0.980237603187561, corresponding to test acc:                         0.9631351232528687 / 0.9751562476158142
after epoch: 10,now: 2024-06-01 22:45:06.706768,epoch time: 0:30:54.818391,used: 5:00:26.852054,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_17_44_39_seed_2_21011737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.97998816, 'precision': 0.8660766, 'recall': 0.81565225, 'specificity': 0.81565225, 'f1': 0.83883697, 'auroc': 0.9819509, 'binary_precision': 0.7449923, 'binary_recall': 0.63912755, 'binary_specificity': 0.99217695, 'binary_f1_score': 0.6880114}
confusion matrix:
       0    1
0  41980  331
1    546  967
---- Validation: 
scalar performance:
{'acc': 0.97831994, 'precision': 0.8362263, 'recall': 0.79446316, 'specificity': 0.79446316, 'f1': 0.8138444, 'auroc': 0.9762491, 'binary_precision': 0.6857143, 'binary_recall': 0.59800667, 'binary_specificity': 0.9909196, 'binary_f1_score': 0.6388643}
confusion matrix:
       0    1
0  18006  165
1    242  360
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9615323, 'precision': 0.7402117, 'recall': 0.57551086, 'specificity': 0.57551086, 'f1': 0.6103864, 'auroc': 0.9469978, 'binary_precision': 0.5135135, 'binary_recall': 0.1570248, 'binary_specificity': 0.993997, 'binary_f1_score': 0.24050634}
confusion matrix:
      0   1
0  5961  36
1   204  38
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011737.png
early stop counter: 4
val acc:0.9783199429512024, best validation acc: 0.980237603187561, corresponding to test acc:                         0.9631351232528687 / 0.9751562476158142
after epoch: 11,now: 2024-06-01 23:15:55.165145,epoch time: 0:30:48.458377,used: 5:31:15.310431,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_17_44_39_seed_2_21011737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98357064, 'precision': 0.9331227, 'recall': 0.8018936, 'specificity': 0.8018936, 'f1': 0.8549242, 'auroc': 0.9872813, 'binary_precision': 0.8801534, 'binary_recall': 0.60674155, 'binary_specificity': 0.9970457, 'binary_f1_score': 0.7183099}
confusion matrix:
       0    1
0  42186  125
1    595  918
---- Validation: 
scalar performance:
{'acc': 0.9801843, 'precision': 0.90312785, 'recall': 0.741622, 'specificity': 0.741622, 'f1': 0.8007619, 'auroc': 0.98072433, 'binary_precision': 0.8230337, 'binary_recall': 0.48671097, 'binary_specificity': 0.9965329, 'binary_f1_score': 0.61169106}
confusion matrix:
       0    1
0  18108   63
1    309  293
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96553934, 'precision': 0.82689655, 'recall': 0.60138816, 'specificity': 0.60138816, 'f1': 0.6498919, 'auroc': 0.96230364, 'binary_precision': 0.6849315, 'binary_recall': 0.20661157, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.31746033}
confusion matrix:
      0   1
0  5974  23
1   192  50
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011737.png
early stop counter: 5
val acc:0.9801843166351318, best validation acc: 0.980237603187561, corresponding to test acc:                         0.9631351232528687 / 0.9751562476158142
after epoch: 12,now: 2024-06-01 23:46:47.621920,epoch time: 0:30:52.456775,used: 6:02:07.767206,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_17_44_39_seed_2_21011737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9821331, 'precision': 0.8735262, 'recall': 0.85085887, 'specificity': 0.85085887, 'f1': 0.86180663, 'auroc': 0.9846829, 'binary_precision': 0.7574048, 'binary_recall': 0.709848, 'binary_specificity': 0.99186975, 'binary_f1_score': 0.73285574}
confusion matrix:
       0     1
0  41967   344
1    439  1074
---- Validation: 
scalar performance:
{'acc': 0.98295426, 'precision': 0.88363475, 'recall': 0.8241607, 'specificity': 0.8241607, 'f1': 0.85120463, 'auroc': 0.98038787, 'binary_precision': 0.7786561, 'binary_recall': 0.65448505, 'binary_specificity': 0.99383634, 'binary_f1_score': 0.71119136}
confusion matrix:
       0    1
0  18059  112
1    208  394
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96297485, 'precision': 0.89344263, 'recall': 0.5286755, 'specificity': 0.5286755, 'f1': 0.54460156, 'auroc': 0.9550228, 'binary_precision': 0.8235294, 'binary_recall': 0.05785124, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.1081081}
confusion matrix:
      0   1
0  5994   3
1   228  14
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011737.png
better model found
persisted
after epoch: 13,now: 2024-06-02 00:17:55.547736,epoch time: 0:31:07.925816,used: 6:33:15.693022,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_17_44_39_seed_2_21011737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98151696, 'precision': 0.85716116, 'recall': 0.8712522, 'specificity': 0.8712522, 'f1': 0.86405766, 'auroc': 0.9856956, 'binary_precision': 0.72317463, 'binary_recall': 0.752809, 'binary_specificity': 0.98969537, 'binary_f1_score': 0.7376943}
confusion matrix:
       0     1
0  41875   436
1    374  1139
---- Validation: 
scalar performance:
{'acc': 0.9772013, 'precision': 0.82303184, 'recall': 0.7938853, 'specificity': 0.7938853, 'f1': 0.80770946, 'auroc': 0.97953343, 'binary_precision': 0.6593407, 'binary_recall': 0.59800667, 'binary_specificity': 0.9897639, 'binary_f1_score': 0.6271777}
confusion matrix:
       0    1
0  17985  186
1    242  360
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9685847, 'precision': 0.8359908, 'recall': 0.66443723, 'specificity': 0.66443723, 'f1': 0.7181712, 'auroc': 0.9540712, 'binary_precision': 0.69827586, 'binary_recall': 0.33471075, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.45251396}
confusion matrix:
      0   1
0  5962  35
1   161  81
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011737.png
early stop counter: 1
val acc:0.9772012829780579, best validation acc: 0.9829542636871338, corresponding to test acc:                         0.9629748463630676 / 0.9751562476158142
after epoch: 14,now: 2024-06-02 00:49:47.845750,epoch time: 0:31:52.298014,used: 7:05:07.991036,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_17_44_39_seed_2_21011737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98507667, 'precision': 0.8853188, 'recall': 0.8931707, 'specificity': 0.8931707, 'f1': 0.88920164, 'auroc': 0.9885171, 'binary_precision': 0.7779935, 'binary_recall': 0.79444814, 'binary_specificity': 0.99189335, 'binary_f1_score': 0.7861348}
confusion matrix:
       0     1
0  41968   343
1    311  1202
---- Validation: 
scalar performance:
{'acc': 0.9822618, 'precision': 0.8639463, 'recall': 0.8422731, 'specificity': 0.8422731, 'f1': 0.8527496, 'auroc': 0.9800024, 'binary_precision': 0.7380531, 'binary_recall': 0.692691, 'binary_specificity': 0.99185514, 'binary_f1_score': 0.7146529}
confusion matrix:
       0    1
0  18023  148
1    185  417
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96473795, 'precision': 0.8172958, 'recall': 0.58907485, 'specificity': 0.58907485, 'f1': 0.63381857, 'auroc': 0.95544326, 'binary_precision': 0.6666667, 'binary_recall': 0.18181819, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.2857143}
confusion matrix:
      0   1
0  5975  22
1   198  44
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011737.png
early stop counter: 2
val acc:0.9822617769241333, best validation acc: 0.9829542636871338, corresponding to test acc:                         0.9629748463630676 / 0.9751562476158142
after epoch: 15,now: 2024-06-02 01:21:44.686743,epoch time: 0:31:56.840993,used: 7:37:04.832029,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_17_44_39_seed_2_21011737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.98087806, 'precision': 0.9466473, 'recall': 0.74632835, 'specificity': 0.74632835, 'f1': 0.81556857, 'auroc': 0.9862622, 'binary_precision': 0.91108406, 'binary_recall': 0.49438202, 'binary_specificity': 0.9982747, 'binary_f1_score': 0.64095974}
confusion matrix:
       0    1
0  42238   73
1    765  748
---- Validation: 
scalar performance:
{'acc': 0.97810686, 'precision': 0.94269955, 'recall': 0.67630494, 'specificity': 0.67630494, 'f1': 0.7488822, 'auroc': 0.98189145, 'binary_precision': 0.906383, 'binary_recall': 0.3538206, 'binary_specificity': 0.99878925, 'binary_f1_score': 0.50896055}
confusion matrix:
       0    1
0  18149   22
1    389  213
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9626543, 'precision': 0.88152313, 'recall': 0.5245433, 'specificity': 0.5245433, 'f1': 0.5371598, 'auroc': 0.93604463, 'binary_precision': 0.8, 'binary_recall': 0.049586777, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.09338521}
confusion matrix:
      0   1
0  5994   3
1   230  12
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011737.png
early stop counter: 3
val acc:0.9781068563461304, best validation acc: 0.9829542636871338, corresponding to test acc:                         0.9629748463630676 / 0.9751562476158142
after epoch: 16,now: 2024-06-02 01:53:45.238632,epoch time: 0:32:00.551889,used: 8:09:05.383918,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_17_44_39_seed_2_21011737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98185927, 'precision': 0.8410933, 'recall': 0.92874455, 'specificity': 0.92874455, 'f1': 0.87942463, 'auroc': 0.98669064, 'binary_precision': 0.68681604, 'binary_recall': 0.87169313, 'binary_specificity': 0.985796, 'binary_f1_score': 0.76828915}
confusion matrix:
       0     1
0  41711   601
1    194  1318
---- Validation: 
scalar performance:
{'acc': 0.9797049, 'precision': 0.8237519, 'recall': 0.8811047, 'specificity': 0.8811047, 'f1': 0.8498752, 'auroc': 0.97504, 'binary_precision': 0.654979, 'binary_recall': 0.77574754, 'binary_specificity': 0.98646194, 'binary_f1_score': 0.71026623}
confusion matrix:
       0    1
0  17925  246
1    135  467
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96842444, 'precision': 0.82327145, 'recall': 0.678233, 'specificity': 0.678233, 'f1': 0.72778785, 'auroc': 0.9619324, 'binary_precision': 0.67175573, 'binary_recall': 0.36363637, 'binary_specificity': 0.99282974, 'binary_f1_score': 0.47184992}
confusion matrix:
      0   1
0  5954  43
1   154  88
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011737.png
early stop counter: 4
val acc:0.9797049164772034, best validation acc: 0.9829542636871338, corresponding to test acc:                         0.9629748463630676 / 0.9751562476158142
after epoch: 17,now: 2024-06-02 02:25:51.805857,epoch time: 0:32:06.567225,used: 8:41:11.951143,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_17_44_39_seed_2_21011737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98610353, 'precision': 0.95093375, 'recall': 0.8286975, 'specificity': 0.8286975, 'f1': 0.8795289, 'auroc': 0.9902185, 'binary_precision': 0.9139194, 'binary_recall': 0.65961665, 'binary_specificity': 0.99777836, 'binary_f1_score': 0.7662188}
confusion matrix:
       0    1
0  42217   94
1    515  998
---- Validation: 
scalar performance:
{'acc': 0.9823683, 'precision': 0.93620163, 'recall': 0.7564019, 'specificity': 0.7564019, 'f1': 0.8214502, 'auroc': 0.9824374, 'binary_precision': 0.88825214, 'binary_recall': 0.51495016, 'binary_specificity': 0.9978537, 'binary_f1_score': 0.6519453}
confusion matrix:
       0    1
0  18132   39
1    292  310
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9634557, 'precision': 0.8004174, 'recall': 0.5665977, 'specificity': 0.5665977, 'f1': 0.60288835, 'auroc': 0.9537258, 'binary_precision': 0.63461536, 'binary_recall': 0.13636364, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.22448981}
confusion matrix:
      0   1
0  5978  19
1   209  33
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011737.png
early stop counter: 5
val acc:0.9823682904243469, best validation acc: 0.9829542636871338, corresponding to test acc:                         0.9629748463630676 / 0.9751562476158142
after epoch: 18,now: 2024-06-02 02:57:38.683740,epoch time: 0:31:46.877883,used: 9:12:58.829026,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_17_44_39_seed_2_21011737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9825438, 'precision': 0.84571075, 'recall': 0.93232787, 'specificity': 0.93232787, 'f1': 0.88371444, 'auroc': 0.98944926, 'binary_precision': 0.6958115, 'binary_recall': 0.87838733, 'binary_specificity': 0.98626834, 'binary_f1_score': 0.7765118}
confusion matrix:
       0     1
0  41730   581
1    184  1329
---- Validation: 
scalar performance:
{'acc': 0.9805572, 'precision': 0.82937837, 'recall': 0.8887724, 'specificity': 0.8887724, 'f1': 0.8563901, 'auroc': 0.98081565, 'binary_precision': 0.6657343, 'binary_recall': 0.7906977, 'binary_specificity': 0.98684716, 'binary_f1_score': 0.722855}
confusion matrix:
       0    1
0  17932  239
1    126  476
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96826416, 'precision': 0.79202425, 'recall': 0.7594421, 'specificity': 0.7594421, 'f1': 0.7746599, 'auroc': 0.9522268, 'binary_precision': 0.60280377, 'binary_recall': 0.53305787, 'binary_specificity': 0.98582625, 'binary_f1_score': 0.5657895}
confusion matrix:
      0    1
0  5912   85
1   113  129
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011737.png
early stop counter: 6
val acc:0.9805572032928467, best validation acc: 0.9829542636871338, corresponding to test acc:                         0.9629748463630676 / 0.9751562476158142
after epoch: 19,now: 2024-06-02 03:29:21.887186,epoch time: 0:31:43.203446,used: 9:44:42.032472,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_17_44_39_seed_2_21011737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.98384446, 'precision': 0.94669896, 'recall': 0.7950251, 'specificity': 0.7950251, 'f1': 0.8542425, 'auroc': 0.989847, 'binary_precision': 0.9078014, 'binary_recall': 0.59220093, 'binary_specificity': 0.9978493, 'binary_f1_score': 0.7168}
confusion matrix:
       0    1
0  42220   91
1    617  896
---- Validation: 
scalar performance:
{'acc': 0.97997123, 'precision': 0.9267319, 'recall': 0.7190265, 'specificity': 0.7190265, 'f1': 0.78736347, 'auroc': 0.9742191, 'binary_precision': 0.87171054, 'binary_recall': 0.44019935, 'binary_specificity': 0.9978537, 'binary_f1_score': 0.58498895}
confusion matrix:
       0    1
0  18132   39
1    337  265
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9631351, 'precision': 0.83220327, 'recall': 0.54263806, 'specificity': 0.54263806, 'f1': 0.5677843, 'auroc': 0.95450866, 'binary_precision': 0.7, 'binary_recall': 0.08677686, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.15441176}
confusion matrix:
      0   1
0  5988   9
1   221  21
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011737.png
early stop counter: 7
val acc:0.9799712300300598, best validation acc: 0.9829542636871338, corresponding to test acc:                         0.9629748463630676 / 0.9751562476158142
after epoch: 20,now: 2024-06-02 04:01:07.666422,epoch time: 0:31:45.779236,used: 10:16:27.811708,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_17_44_39_seed_2_21011737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.98740417, 'precision': 0.9309949, 'recall': 0.87079585, 'specificity': 0.87079585, 'f1': 0.89845616, 'auroc': 0.991824, 'binary_precision': 0.8710425, 'binary_recall': 0.74553865, 'binary_specificity': 0.99605304, 'binary_f1_score': 0.80341876}
confusion matrix:
       0     1
0  42144   167
1    385  1128
---- Validation: 
scalar performance:
{'acc': 0.9820487, 'precision': 0.90400344, 'recall': 0.77872217, 'specificity': 0.77872217, 'f1': 0.8290501, 'auroc': 0.9783485, 'binary_precision': 0.8223844, 'binary_recall': 0.5614618, 'binary_specificity': 0.9959826, 'binary_f1_score': 0.6673248}
confusion matrix:
       0    1
0  18098   73
1    264  338
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642571, 'precision': 0.8115205, 'recall': 0.58089375, 'specificity': 0.58089375, 'f1': 0.62285507, 'auroc': 0.94795936, 'binary_precision': 0.6557377, 'binary_recall': 0.16528925, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.2640264}
confusion matrix:
      0   1
0  5976  21
1   202  40
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011737.png
early stop counter: 8
val acc:0.9820486903190613, best validation acc: 0.9829542636871338, corresponding to test acc:                         0.9629748463630676 / 0.9751562476158142
after epoch: 21,now: 2024-06-02 04:32:53.565910,epoch time: 0:31:45.899488,used: 10:48:13.711196,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_17_44_39_seed_2_21011737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.98776925, 'precision': 0.92928445, 'recall': 0.8792699, 'specificity': 0.8792699, 'f1': 0.9026063, 'auroc': 0.99247694, 'binary_precision': 0.86701727, 'binary_recall': 0.7627231, 'binary_specificity': 0.9958167, 'binary_f1_score': 0.8115331}
confusion matrix:
       0     1
0  42134   177
1    359  1154
---- Validation: 
scalar performance:
{'acc': 0.9824216, 'precision': 0.89583683, 'recall': 0.7957789, 'specificity': 0.7957789, 'f1': 0.8380365, 'auroc': 0.97435987, 'binary_precision': 0.8049327, 'binary_recall': 0.59634554, 'binary_specificity': 0.99521214, 'binary_f1_score': 0.68511456}
confusion matrix:
       0    1
0  18084   87
1    243  359
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9632954, 'precision': 0.78841805, 'recall': 0.57246256, 'specificity': 0.57246256, 'f1': 0.6101983, 'auroc': 0.9527334, 'binary_precision': 0.6101695, 'binary_recall': 0.14876033, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.23920266}
confusion matrix:
      0   1
0  5974  23
1   206  36
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011737.png
early stop counter: 9
val acc:0.9824215769767761, best validation acc: 0.9829542636871338, corresponding to test acc:                         0.9629748463630676 / 0.9751562476158142
after epoch: 22,now: 2024-06-02 05:04:31.365710,epoch time: 0:31:37.799800,used: 11:19:51.510996,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_17_44_39_seed_2_21011737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9875411, 'precision': 0.9100308, 'recall': 0.9011387, 'specificity': 0.9011387, 'f1': 0.9055319, 'auroc': 0.9918458, 'binary_precision': 0.8269101, 'binary_recall': 0.80832785, 'binary_specificity': 0.9939496, 'binary_f1_score': 0.8175134}
confusion matrix:
       0     1
0  42055   256
1    290  1223
---- Validation: 
scalar performance:
{'acc': 0.9818356, 'precision': 0.8690076, 'recall': 0.8219768, 'specificity': 0.8219768, 'f1': 0.84376305, 'auroc': 0.9759828, 'binary_precision': 0.749522, 'binary_recall': 0.6511628, 'binary_specificity': 0.9927907, 'binary_f1_score': 0.69688886}
confusion matrix:
       0    1
0  18040  131
1    210  392
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9685847, 'precision': 0.8210403, 'recall': 0.68624735, 'specificity': 0.68624735, 'f1': 0.73400474, 'auroc': 0.9615294, 'binary_precision': 0.6666667, 'binary_recall': 0.38016528, 'binary_specificity': 0.9923295, 'binary_f1_score': 0.48421055}
confusion matrix:
      0   1
0  5951  46
1   150  92
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011737.png
early stop counter: 10
val acc:0.9818356037139893, best validation acc: 0.9829542636871338, corresponding to test acc:                         0.9629748463630676 / 0.9751562476158142
after epoch: 23,now: 2024-06-02 05:35:39.917311,epoch time: 0:31:08.551601,used: 11:51:00.062597,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_17_44_39_seed_2_21011737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.98765516, 'precision': 0.9514859, 'recall': 0.85371864, 'specificity': 0.85371864, 'f1': 0.8962211, 'auroc': 0.9923452, 'binary_precision': 0.9132653, 'binary_recall': 0.709848, 'binary_specificity': 0.9975893, 'binary_f1_score': 0.79881}
confusion matrix:
       0     1
0  42209   102
1    439  1074
---- Validation: 
scalar performance:
{'acc': 0.98465884, 'precision': 0.9358406, 'recall': 0.7985406, 'specificity': 0.7985406, 'f1': 0.8534844, 'auroc': 0.9786042, 'binary_precision': 0.88480395, 'binary_recall': 0.5996678, 'binary_specificity': 0.99741346, 'binary_f1_score': 0.7148515}
confusion matrix:
       0    1
0  18124   47
1    241  361
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9626543, 'precision': 0.7713071, 'recall': 0.5681636, 'specificity': 0.5681636, 'f1': 0.6033896, 'auroc': 0.956892, 'binary_precision': 0.5762712, 'binary_recall': 0.14049587, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.2259136}
confusion matrix:
      0   1
0  5972  25
1   208  34
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011737.png
better model found
persisted
after epoch: 24,now: 2024-06-02 06:06:50.006580,epoch time: 0:31:10.089269,used: 12:22:10.151866,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_17_44_39_seed_2_21011737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9860579, 'precision': 0.8829405, 'recall': 0.91917104, 'specificity': 0.91917104, 'f1': 0.900163, 'auroc': 0.99151456, 'binary_precision': 0.7713598, 'binary_recall': 0.8473232, 'binary_specificity': 0.9910189, 'binary_f1_score': 0.807559}
confusion matrix:
       0     1
0  41931   380
1    231  1282
---- Validation: 
scalar performance:
{'acc': 0.9822085, 'precision': 0.8530741, 'recall': 0.86553395, 'specificity': 0.86553395, 'f1': 0.85918665, 'auroc': 0.97650295, 'binary_precision': 0.7147436, 'binary_recall': 0.7408638, 'binary_specificity': 0.99020416, 'binary_f1_score': 0.72756934}
confusion matrix:
       0    1
0  17993  178
1    156  446
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96185285, 'precision': 0.7526305, 'recall': 0.5538675, 'specificity': 0.5538675, 'f1': 0.58270043, 'auroc': 0.9396373, 'binary_precision': 0.54, 'binary_recall': 0.11157025, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.1849315}
confusion matrix:
      0   1
0  5974  23
1   215  27
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011737.png
early stop counter: 1
val acc:0.9822084903717041, best validation acc: 0.9846588373184204, corresponding to test acc:                         0.9626542925834656 / 0.9751562476158142
after epoch: 25,now: 2024-06-02 06:37:44.474329,epoch time: 0:30:54.467749,used: 12:53:04.619615,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_17_44_39_seed_2_21011737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.98786056, 'precision': 0.9095622, 'recall': 0.9079958, 'specificity': 0.9079958, 'f1': 0.90877736, 'auroc': 0.9915826, 'binary_precision': 0.8254811, 'binary_recall': 0.8222075, 'binary_specificity': 0.9937841, 'binary_f1_score': 0.8238411}
confusion matrix:
       0     1
0  42048   263
1    269  1244
---- Validation: 
scalar performance:
{'acc': 0.98412615, 'precision': 0.8853122, 'recall': 0.84805447, 'specificity': 0.84805447, 'f1': 0.8656621, 'auroc': 0.97267854, 'binary_precision': 0.78044283, 'binary_recall': 0.7026578, 'binary_specificity': 0.9934511, 'binary_f1_score': 0.7395105}
confusion matrix:
       0    1
0  18052  119
1    179  423
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650585, 'precision': 0.8338162, 'recall': 0.5852761, 'specificity': 0.5852761, 'f1': 0.6301208, 'auroc': 0.9535797, 'binary_precision': 0.7, 'binary_recall': 0.17355372, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.2781457}
confusion matrix:
      0   1
0  5979  18
1   200  42
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011737.png
early stop counter: 2
val acc:0.9841261506080627, best validation acc: 0.9846588373184204, corresponding to test acc:                         0.9626542925834656 / 0.9751562476158142
after epoch: 26,now: 2024-06-02 07:06:55.657730,epoch time: 0:29:11.183401,used: 13:22:15.803016,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_17_44_39_seed_2_21011737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.98790616, 'precision': 0.9582842, 'recall': 0.85161805, 'specificity': 0.85161805, 'f1': 0.8974073, 'auroc': 0.9934692, 'binary_precision': 0.92701995, 'binary_recall': 0.7052214, 'binary_specificity': 0.9980147, 'binary_f1_score': 0.801051}
confusion matrix:
       0     1
0  42227    84
1    446  1067
---- Validation: 
scalar performance:
{'acc': 0.982901, 'precision': 0.91893554, 'recall': 0.7807686, 'specificity': 0.7807686, 'f1': 0.8352685, 'auroc': 0.97021484, 'binary_precision': 0.85213035, 'binary_recall': 0.56478405, 'binary_specificity': 0.9967531, 'binary_f1_score': 0.67932063}
confusion matrix:
       0    1
0  18112   59
1    262  340
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9631351, 'precision': 0.8157612, 'recall': 0.5485863, 'specificity': 0.5485863, 'f1': 0.5769047, 'auroc': 0.9159272, 'binary_precision': 0.6666667, 'binary_recall': 0.09917355, 'binary_specificity': 0.997999, 'binary_f1_score': 0.17266189}
confusion matrix:
      0   1
0  5985  12
1   218  24
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011737.png
early stop counter: 3
val acc:0.9829009771347046, best validation acc: 0.9846588373184204, corresponding to test acc:                         0.9626542925834656 / 0.9751562476158142
after epoch: 27,now: 2024-06-02 07:35:30.386483,epoch time: 0:28:34.728753,used: 13:50:50.531769,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_17_44_39_seed_2_21011737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9904162, 'precision': 0.9347341, 'recall': 0.91919756, 'specificity': 0.91919756, 'f1': 0.9268129, 'auroc': 0.99434185, 'binary_precision': 0.8750858, 'binary_recall': 0.8426966, 'binary_specificity': 0.9956985, 'binary_f1_score': 0.85858583}
confusion matrix:
       0     1
0  42129   182
1    238  1275
---- Validation: 
scalar performance:
{'acc': 0.98609704, 'precision': 0.91138744, 'recall': 0.8522848, 'specificity': 0.8522848, 'f1': 0.8793775, 'auroc': 0.9781692, 'binary_precision': 0.83235866, 'binary_recall': 0.7093023, 'binary_specificity': 0.9952672, 'binary_f1_score': 0.7659192}
confusion matrix:
       0    1
0  18085   86
1    175  427
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96377623, 'precision': 0.8379272, 'recall': 0.554868, 'specificity': 0.554868, 'f1': 0.58716476, 'auroc': 0.9492409, 'binary_precision': 0.7105263, 'binary_recall': 0.11157025, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.19285715}
confusion matrix:
      0   1
0  5986  11
1   215  27
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011737.png
better model found
persisted
after epoch: 28,now: 2024-06-02 08:04:10.324667,epoch time: 0:28:39.938184,used: 14:19:30.469953,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_17_44_39_seed_2_21011737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.98849946, 'precision': 0.90113854, 'recall': 0.9347748, 'specificity': 0.9347748, 'f1': 0.91722006, 'auroc': 0.9933045, 'binary_precision': 0.80668694, 'binary_recall': 0.8770654, 'binary_specificity': 0.9924842, 'binary_f1_score': 0.84040534}
confusion matrix:
       0     1
0  41993   318
1    186  1327
---- Validation: 
scalar performance:
{'acc': 0.9840196, 'precision': 0.8701314, 'recall': 0.873697, 'specificity': 0.873697, 'f1': 0.8719049, 'auroc': 0.98179996, 'binary_precision': 0.74835527, 'binary_recall': 0.75581396, 'binary_specificity': 0.99158, 'binary_f1_score': 0.75206614}
confusion matrix:
       0    1
0  18018  153
1    147  455
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9652188, 'precision': 0.81775904, 'recall': 0.60122144, 'specificity': 0.60122144, 'f1': 0.6488068, 'auroc': 0.9463668, 'binary_precision': 0.6666667, 'binary_recall': 0.20661157, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.31545743}
confusion matrix:
      0   1
0  5972  25
1   192  50
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011737.png
early stop counter: 1
val acc:0.9840195775032043, best validation acc: 0.9860970377922058, corresponding to test acc:                         0.9637762308120728 / 0.9751562476158142
after epoch: 29,now: 2024-06-02 08:32:47.775086,epoch time: 0:28:37.450419,used: 14:48:07.920372,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_17_44_39_seed_2_21011737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.98886454, 'precision': 0.9443163, 'recall': 0.88111174, 'specificity': 0.88111174, 'f1': 0.9101056, 'auroc': 0.9936565, 'binary_precision': 0.8969791, 'binary_recall': 0.7653668, 'binary_specificity': 0.99685663, 'binary_f1_score': 0.8259629}
confusion matrix:
       0     1
0  42178   133
1    355  1158
---- Validation: 
scalar performance:
{'acc': 0.9835402, 'precision': 0.91975147, 'recall': 0.7923415, 'specificity': 0.7923415, 'f1': 0.84385306, 'auroc': 0.9784348, 'binary_precision': 0.853012, 'binary_recall': 0.5880399, 'binary_specificity': 0.996643, 'binary_f1_score': 0.69616514}
confusion matrix:
       0    1
0  18110   61
1    248  354
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96297485, 'precision': 0.78310156, 'recall': 0.5663476, 'specificity': 0.5663476, 'f1': 0.60162914, 'auroc': 0.9478067, 'binary_precision': 0.6, 'binary_recall': 0.13636364, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.22222222}
confusion matrix:
      0   1
0  5975  22
1   209  33
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011737.png
early stop counter: 2
val acc:0.9835401773452759, best validation acc: 0.9860970377922058, corresponding to test acc:                         0.9637762308120728 / 0.9751562476158142
after epoch: 30,now: 2024-06-02 09:01:21.732617,epoch time: 0:28:33.957531,used: 15:16:41.877903,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_17_44_39_seed_2_21011737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 15:16:41.877903 at 2024-06-02 09:01:21.732617
persisted model performance metric: 

scalar performance:
{'acc': 0.9642571, 'precision': 0.8386037, 'recall': 0.5650318, 'specificity': 0.5650318, 'f1': 0.60235214, 'auroc': 0.95050585, 'binary_precision': 0.7111111, 'binary_recall': 0.1322314, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.22299652}
confusion matrix:
      0   1
0  5984  13
1   210  32
oracle model performance metric: 

scalar performance:
{'acc': 0.9764385, 'precision': 0.96893, 'recall': 0.70421195, 'specificity': 0.70421195, 'f1': 0.7808987, 'auroc': 0.9579323, 'binary_precision': 0.9611651, 'binary_recall': 0.4090909, 'binary_specificity': 0.999333, 'binary_f1_score': 0.57391304}
confusion matrix:
      0   1
0  5993   4
1   143  99
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456485 KiB |  13219 MiB |   3352 TiB |   3352 TiB |
|       from large pool | 414803 KiB |  13181 MiB |   3313 TiB |   3313 TiB |
|       from small pool |  41681 KiB |     61 MiB |     39 TiB |     39 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 456485 KiB |  13219 MiB |   3352 TiB |   3352 TiB |
|       from large pool | 414803 KiB |  13181 MiB |   3313 TiB |   3313 TiB |
|       from small pool |  41681 KiB |     61 MiB |     39 TiB |     39 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447753 KiB |  13213 MiB |   3343 TiB |   3343 TiB |
|       from large pool | 407075 KiB |  13175 MiB |   3303 TiB |   3303 TiB |
|       from small pool |  40678 KiB |     60 MiB |     39 TiB |     39 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14478 MiB |  14478 MiB |  41644 MiB |  27166 MiB |
|       from large pool |  14412 MiB |  14412 MiB |  41542 MiB |  27130 MiB |
|       from small pool |     66 MiB |     72 MiB |    102 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 446683 KiB |   1238 MiB |   2350 TiB |   2350 TiB |
|       from large pool | 435116 KiB |   1229 MiB |   2310 TiB |   2310 TiB |
|       from small pool |  11566 KiB |     42 MiB |     39 TiB |     39 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3476    |    6487    |  593146 K  |  593142 K  |
|       from large pool |     187    |    1413    |  308144 K  |  308144 K  |
|       from small pool |    3289    |    6298    |  285001 K  |  284998 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3476    |    6487    |  593146 K  |  593142 K  |
|       from large pool |     187    |    1413    |  308144 K  |  308144 K  |
|       from small pool |    3289    |    6298    |  285001 K  |  284998 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     635    |     637    |    1781    |    1146    |
|       from large pool |     602    |     602    |    1730    |    1128    |
|       from small pool |      33    |      36    |      51    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      80    |    2806    |  389305 K  |  389305 K  |
|       from large pool |      38    |     605    |  240391 K  |  240391 K  |
|       from small pool |      42    |    2768    |  148914 K  |  148914 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   3352 TiB |   3352 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   3313 TiB |   3313 TiB |
|       from small pool |      0 KiB |     61 MiB |     39 TiB |     39 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   3352 TiB |   3352 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   3313 TiB |   3313 TiB |
|       from small pool |      0 KiB |     61 MiB |     39 TiB |     39 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   3343 TiB |   3343 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   3303 TiB |   3303 TiB |
|       from small pool |      0 KiB |     60 MiB |     39 TiB |     39 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14478 MiB |  41644 MiB |  40762 MiB |
|       from large pool |    830 MiB |  14412 MiB |  41542 MiB |  40712 MiB |
|       from small pool |     52 MiB |     72 MiB |    102 MiB |     50 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1238 MiB |   2350 TiB |   2350 TiB |
|       from large pool |  24320 KiB |   1229 MiB |   2310 TiB |   2310 TiB |
|       from small pool |      0 KiB |     42 MiB |     39 TiB |     39 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6487    |  593146 K  |  593146 K  |
|       from large pool |       2    |    1413    |  308144 K  |  308144 K  |
|       from small pool |       0    |    6298    |  285001 K  |  285001 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6487    |  593146 K  |  593146 K  |
|       from large pool |       2    |    1413    |  308144 K  |  308144 K  |
|       from small pool |       0    |    6298    |  285001 K  |  285001 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     637    |    1781    |    1718    |
|       from large pool |      37    |     602    |    1730    |    1693    |
|       from small pool |      26    |      36    |      51    |      25    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2806    |  389307 K  |  389307 K  |
|       from large pool |       4    |     605    |  240391 K  |  240391 K  |
|       from small pool |       0    |    2768    |  148916 K  |  148916 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sun Jun  2 09:04:06 2024]
Finished job 0.
1 of 1 steps (100%) done
