Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jun  1 21:23:27 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/rule_results/7.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=7
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_21_32_19_seed_0_21011748

 Experiment start at: 2024-06-01 21:32:19.092138
before training, model accuracy: 0.955097496509552
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9731686, 'precision': 0.80000854, 'recall': 0.761862, 'specificity': 0.761862, 'f1': 0.779516, 'auroc': 0.96912146, 'binary_precision': 0.61610633, 'binary_recall': 0.53532606, 'binary_specificity': 0.9883979, 'binary_f1_score': 0.5728826}
confusion matrix:
       0    1
0  41829  491
1    684  788
---- Validation: 
scalar performance:
{'acc': 0.9707322, 'precision': 0.7910373, 'recall': 0.70807725, 'specificity': 0.70807725, 'f1': 0.7420075, 'auroc': 0.9695478, 'binary_precision': 0.6021978, 'binary_recall': 0.42612752, 'binary_specificity': 0.990027, 'binary_f1_score': 0.4990893}
confusion matrix:
       0    1
0  17968  181
1    369  274
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9699584, 'precision': 0.8617949, 'recall': 0.7076431, 'specificity': 0.7076431, 'f1': 0.7618444, 'auroc': 0.95147604, 'binary_precision': 0.7482993, 'binary_recall': 0.42145595, 'binary_specificity': 0.99383026, 'binary_f1_score': 0.5392157}
confusion matrix:
      0    1
0  5960   37
1   151  110
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011748_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-01 22:13:38.599555,epoch time: 0:41:19.507417,used: 0:41:19.507417,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_21_32_19_seed_0_21011748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97721046, 'precision': 0.8784154, 'recall': 0.72428226, 'specificity': 0.72428226, 'f1': 0.7801674, 'auroc': 0.97795534, 'binary_precision': 0.7755814, 'binary_recall': 0.453125, 'binary_specificity': 0.9954395, 'binary_f1_score': 0.5720412}
confusion matrix:
       0    1
0  42127  193
1    805  667
---- Validation: 
scalar performance:
{'acc': 0.97616005, 'precision': 0.9255842, 'recall': 0.6763848, 'specificity': 0.6763848, 'f1': 0.74610555, 'auroc': 0.97679263, 'binary_precision': 0.87356323, 'binary_recall': 0.35458788, 'binary_specificity': 0.9981817, 'binary_f1_score': 0.5044248}
confusion matrix:
       0    1
0  18116   33
1    415  228
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581336, 'precision': 0.6458833, 'recall': 0.501749, 'specificity': 0.501749, 'f1': 0.49309576, 'auroc': 0.94654626, 'binary_precision': 0.33333334, 'binary_recall': 0.0038314175, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.0075757573}
confusion matrix:
      0  1
0  5995  2
1   260  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011748_2.png
better model found
persisted
after epoch: 2,now: 2024-06-01 22:53:14.663644,epoch time: 0:39:36.064089,used: 1:20:55.571506,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_21_32_19_seed_0_21011748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.979905, 'precision': 0.83692074, 'recall': 0.8695222, 'specificity': 0.8695222, 'f1': 0.8523977, 'auroc': 0.98217845, 'binary_precision': 0.6825201, 'binary_recall': 0.75118965, 'binary_specificity': 0.9878547, 'binary_f1_score': 0.7152104}
confusion matrix:
       0     1
0  41807   514
1    366  1105
---- Validation: 
scalar performance:
{'acc': 0.9785547, 'precision': 0.8268433, 'recall': 0.874139, 'specificity': 0.874139, 'f1': 0.8487361, 'auroc': 0.9788305, 'binary_precision': 0.6621622, 'binary_recall': 0.7620529, 'binary_specificity': 0.9862251, 'binary_f1_score': 0.7086045}
confusion matrix:
       0    1
0  17899  250
1    153  490
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9646852, 'precision': 0.83079803, 'recall': 0.635263, 'specificity': 0.635263, 'f1': 0.6881664, 'auroc': 0.9438071, 'binary_precision': 0.6923077, 'binary_recall': 0.27586207, 'binary_specificity': 0.994664, 'binary_f1_score': 0.39452052}
confusion matrix:
      0   1
0  5965  32
1   189  72
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011748_3.png
better model found
persisted
after epoch: 3,now: 2024-06-01 23:32:38.199321,epoch time: 0:39:23.535677,used: 2:00:19.107183,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_21_32_19_seed_0_21011748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98202866, 'precision': 0.90587425, 'recall': 0.7926749, 'specificity': 0.7926749, 'f1': 0.8394088, 'auroc': 0.9850204, 'binary_precision': 0.8258801, 'binary_recall': 0.58967394, 'binary_specificity': 0.9956758, 'binary_f1_score': 0.6880698}
confusion matrix:
       0    1
0  42137  183
1    604  868
---- Validation: 
scalar performance:
{'acc': 0.9799915, 'precision': 0.9004133, 'recall': 0.7653748, 'specificity': 0.7653748, 'f1': 0.8181604, 'auroc': 0.9811964, 'binary_precision': 0.81710213, 'binary_recall': 0.5349922, 'binary_specificity': 0.99575734, 'binary_f1_score': 0.6466165}
confusion matrix:
       0    1
0  18072   77
1    299  344
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.957814, 'precision': 0.697263, 'recall': 0.5180732, 'specificity': 0.5180732, 'f1': 0.5244199, 'auroc': 0.9527284, 'binary_precision': 0.4347826, 'binary_recall': 0.038314175, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.07042253}
confusion matrix:
      0   1
0  5984  13
1   251  10
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011748_4.png
better model found
persisted
after epoch: 4,now: 2024-06-02 00:12:20.076416,epoch time: 0:39:41.877095,used: 2:40:00.984278,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_21_32_19_seed_0_21011748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98166335, 'precision': 0.843915, 'recall': 0.8989114, 'specificity': 0.8989114, 'f1': 0.8691832, 'auroc': 0.98665255, 'binary_precision': 0.69446063, 'binary_recall': 0.8102041, 'binary_specificity': 0.98761874, 'binary_f1_score': 0.74788076}
confusion matrix:
       0     1
0  41798   524
1    279  1191
---- Validation: 
scalar performance:
{'acc': 0.98174757, 'precision': 0.8502257, 'recall': 0.89154315, 'specificity': 0.89154315, 'f1': 0.8696239, 'auroc': 0.982623, 'binary_precision': 0.7077562, 'binary_recall': 0.7947123, 'binary_specificity': 0.988374, 'binary_f1_score': 0.7487179}
confusion matrix:
       0    1
0  17938  211
1    132  511
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96196866, 'precision': 0.7887535, 'recall': 0.619187, 'specificity': 0.619187, 'f1': 0.66506916, 'auroc': 0.9448736, 'binary_precision': 0.60952383, 'binary_recall': 0.24521072, 'binary_specificity': 0.9931632, 'binary_f1_score': 0.34972677}
confusion matrix:
      0   1
0  5956  41
1   197  64
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011748_5.png
better model found
persisted
after epoch: 5,now: 2024-06-02 00:52:13.682211,epoch time: 0:39:53.605795,used: 3:19:54.590073,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_21_32_19_seed_0_21011748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98317045, 'precision': 0.87799406, 'recall': 0.8558867, 'specificity': 0.8558867, 'f1': 0.86657906, 'auroc': 0.9863531, 'binary_precision': 0.7657267, 'binary_recall': 0.7194294, 'binary_specificity': 0.992344, 'binary_f1_score': 0.7418564}
confusion matrix:
       0     1
0  41996   324
1    413  1059
---- Validation: 
scalar performance:
{'acc': 0.9803108, 'precision': 0.8747443, 'recall': 0.80454296, 'specificity': 0.80454296, 'f1': 0.83571243, 'auroc': 0.97917473, 'binary_precision': 0.7630058, 'binary_recall': 0.61586314, 'binary_specificity': 0.9932228, 'binary_f1_score': 0.68158346}
confusion matrix:
       0    1
0  18026  123
1    247  396
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614893, 'precision': 0.8403441, 'recall': 0.5621345, 'specificity': 0.5621345, 'f1': 0.5976221, 'auroc': 0.94926536, 'binary_precision': 0.7173913, 'binary_recall': 0.12643678, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.21498372}
confusion matrix:
      0   1
0  5984  13
1   228  33
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011748_6.png
early stop counter: 1
val acc:0.9803107976913452, best validation acc: 0.981747567653656, corresponding to test acc:                         0.9619686603546143 / 0.9699584245681763
after epoch: 6,now: 2024-06-02 01:32:01.632453,epoch time: 0:39:47.950242,used: 3:59:42.540315,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_21_32_19_seed_0_21011748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9866414, 'precision': 0.9539418, 'recall': 0.8291588, 'specificity': 0.8291588, 'f1': 0.88090265, 'auroc': 0.9931464, 'binary_precision': 0.91958374, 'binary_recall': 0.66032606, 'binary_specificity': 0.9979915, 'binary_f1_score': 0.76868325}
confusion matrix:
       0    1
0  42235   85
1    500  972
---- Validation: 
scalar performance:
{'acc': 0.9832908, 'precision': 0.94656265, 'recall': 0.7835841, 'specificity': 0.7835841, 'f1': 0.8456075, 'auroc': 0.9856156, 'binary_precision': 0.9081886, 'binary_recall': 0.56920683, 'binary_specificity': 0.99796134, 'binary_f1_score': 0.6998088}
confusion matrix:
       0    1
0  18112   37
1    277  366
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9592522, 'precision': 0.87975353, 'recall': 0.51515895, 'specificity': 0.51515895, 'f1': 0.5191079, 'auroc': 0.9479202, 'binary_precision': 0.8, 'binary_recall': 0.03065134, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.05904059}
confusion matrix:
      0  1
0  5995  2
1   253  8
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011748_7.png
better model found
persisted
after epoch: 7,now: 2024-06-02 02:11:53.714051,epoch time: 0:39:52.081598,used: 4:39:34.621913,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_21_32_19_seed_0_21011748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98408383, 'precision': 0.92952275, 'recall': 0.8068526, 'specificity': 0.8068526, 'f1': 0.8572246, 'auroc': 0.99175966, 'binary_precision': 0.8722382, 'binary_recall': 0.6168478, 'binary_specificity': 0.9968573, 'binary_f1_score': 0.72264224}
confusion matrix:
       0    1
0  42187  133
1    564  908
---- Validation: 
scalar performance:
{'acc': 0.98036397, 'precision': 0.9189585, 'recall': 0.7550669, 'specificity': 0.7550669, 'f1': 0.8156525, 'auroc': 0.9836483, 'binary_precision': 0.8549223, 'binary_recall': 0.5132193, 'binary_specificity': 0.99691445, 'binary_f1_score': 0.6413994}
confusion matrix:
       0    1
0  18093   56
1    313  330
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9603707, 'precision': 0.7907933, 'recall': 0.5633832, 'specificity': 0.5633832, 'f1': 0.597431, 'auroc': 0.95803106, 'binary_precision': 0.6181818, 'binary_recall': 0.1302682, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.21518987}
confusion matrix:
      0   1
0  5976  21
1   227  34
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011748_8.png
early stop counter: 1
val acc:0.9803639650344849, best validation acc: 0.9832907915115356, corresponding to test acc:                         0.9592521786689758 / 0.9699584245681763
after epoch: 8,now: 2024-06-02 02:51:33.755469,epoch time: 0:39:40.041418,used: 5:19:14.663331,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_21_32_19_seed_0_21011748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9874863, 'precision': 0.94273216, 'recall': 0.85375917, 'specificity': 0.85375917, 'f1': 0.89290786, 'auroc': 0.99369097, 'binary_precision': 0.89545846, 'binary_recall': 0.71040106, 'binary_specificity': 0.9971173, 'binary_f1_score': 0.79226685}
confusion matrix:
       0     1
0  42199   122
1    426  1045
---- Validation: 
scalar performance:
{'acc': 0.9845679, 'precision': 0.95864403, 'recall': 0.7954961, 'specificity': 0.7954961, 'f1': 0.85819817, 'auroc': 0.98348165, 'binary_precision': 0.93154037, 'binary_recall': 0.592535, 'binary_specificity': 0.9984572, 'binary_f1_score': 0.72433466}
confusion matrix:
       0    1
0  18121   28
1    262  381
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.77936995, 'recall': 0.50558037, 'specificity': 0.50558037, 'f1': 0.50066596, 'auroc': 0.9449803, 'binary_precision': 0.6, 'binary_recall': 0.011494253, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.02255639}
confusion matrix:
      0  1
0  5995  2
1   258  3
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011748_9.png
better model found
persisted
after epoch: 9,now: 2024-06-02 03:31:08.030621,epoch time: 0:39:34.275152,used: 5:58:48.938483,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_21_32_19_seed_0_21011748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98915327, 'precision': 0.91884947, 'recall': 0.9130789, 'specificity': 0.9130789, 'f1': 0.91594255, 'auroc': 0.994548, 'binary_precision': 0.84355617, 'binary_recall': 0.83152175, 'binary_specificity': 0.9946361, 'binary_f1_score': 0.83749574}
confusion matrix:
       0     1
0  42093   227
1    248  1224
---- Validation: 
scalar performance:
{'acc': 0.98621756, 'precision': 0.9228194, 'recall': 0.85710466, 'specificity': 0.85710466, 'f1': 0.88697493, 'auroc': 0.9833637, 'binary_precision': 0.85555553, 'binary_recall': 0.718507, 'binary_specificity': 0.99570227, 'binary_f1_score': 0.781065}
confusion matrix:
       0    1
0  18071   78
1    181  462
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590924, 'precision': 0.8132309, 'recall': 0.51874024, 'specificity': 0.51874024, 'f1': 0.52577436, 'auroc': 0.94890726, 'binary_precision': 0.6666667, 'binary_recall': 0.038314175, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.072463766}
confusion matrix:
      0   1
0  5992   5
1   251  10
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011748_10.png
better model found
persisted
after epoch: 10,now: 2024-06-02 04:10:39.620855,epoch time: 0:39:31.590234,used: 6:38:20.528717,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_21_32_19_seed_0_21011748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9868469, 'precision': 0.89553404, 'recall': 0.9043449, 'specificity': 0.9043449, 'f1': 0.8998868, 'auroc': 0.994214, 'binary_precision': 0.79747677, 'binary_recall': 0.81589675, 'binary_specificity': 0.992793, 'binary_f1_score': 0.8065816}
confusion matrix:
       0     1
0  42015   305
1    271  1201
---- Validation: 
scalar performance:
{'acc': 0.98361003, 'precision': 0.8872185, 'recall': 0.8557547, 'specificity': 0.8557547, 'f1': 0.87076366, 'auroc': 0.9797667, 'binary_precision': 0.7843803, 'binary_recall': 0.718507, 'binary_specificity': 0.99300236, 'binary_f1_score': 0.75}
confusion matrix:
       0    1
0  18022  127
1    181  462
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589326, 'precision': 0.8296735, 'recall': 0.5131598, 'specificity': 0.5131598, 'f1': 0.51533616, 'auroc': 0.9498438, 'binary_precision': 0.7, 'binary_recall': 0.026819924, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.05166052}
confusion matrix:
      0  1
0  5994  3
1   254  7
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011748_11.png
early stop counter: 1
val acc:0.9836100339889526, best validation acc: 0.9862175583839417, corresponding to test acc:                         0.959092378616333 / 0.9699584245681763
after epoch: 11,now: 2024-06-02 04:50:14.458880,epoch time: 0:39:34.838025,used: 7:17:55.366742,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_21_32_19_seed_0_21011748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99038637, 'precision': 0.9119467, 'recall': 0.9477811, 'specificity': 0.9477811, 'f1': 0.92905384, 'auroc': 0.9964777, 'binary_precision': 0.82730675, 'binary_recall': 0.9021074, 'binary_specificity': 0.9934548, 'binary_f1_score': 0.8630894}
confusion matrix:
       0     1
0  42044   277
1    144  1327
---- Validation: 
scalar performance:
{'acc': 0.98632395, 'precision': 0.89720035, 'recall': 0.89541256, 'specificity': 0.89541256, 'f1': 0.89630425, 'auroc': 0.9851036, 'binary_precision': 0.8015625, 'binary_recall': 0.7978227, 'binary_specificity': 0.99300236, 'binary_f1_score': 0.79968816}
confusion matrix:
       0    1
0  18022  127
1    130  513
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96340686, 'precision': 0.8862019, 'recall': 0.579626, 'specificity': 0.579626, 'f1': 0.62480235, 'auroc': 0.9513036, 'binary_precision': 0.8076923, 'binary_recall': 0.16091955, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.2683706}
confusion matrix:
      0   1
0  5987  10
1   219  42
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011748_12.png
better model found
persisted
after epoch: 12,now: 2024-06-02 05:29:39.409950,epoch time: 0:39:24.951070,used: 7:57:20.317812,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_21_32_19_seed_0_21011748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9902037, 'precision': 0.95525885, 'recall': 0.88772154, 'specificity': 0.88772154, 'f1': 0.91858315, 'auroc': 0.99636304, 'binary_precision': 0.9182037, 'binary_recall': 0.77785325, 'binary_specificity': 0.99758977, 'binary_f1_score': 0.8422214}
confusion matrix:
       0     1
0  42218   102
1    327  1145
---- Validation: 
scalar performance:
{'acc': 0.98547256, 'precision': 0.9391154, 'recall': 0.82671666, 'specificity': 0.82671666, 'f1': 0.87405455, 'auroc': 0.98434335, 'binary_precision': 0.8902954, 'binary_recall': 0.6562986, 'binary_specificity': 0.9971348, 'binary_f1_score': 0.7555954}
confusion matrix:
       0    1
0  18097   52
1    221  422
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96180886, 'precision': 0.8761677, 'recall': 0.55680424, 'specificity': 0.55680424, 'f1': 0.590553, 'auroc': 0.95335007, 'binary_precision': 0.7894737, 'binary_recall': 0.11494253, 'binary_specificity': 0.998666, 'binary_f1_score': 0.2006689}
confusion matrix:
      0   1
0  5989   8
1   231  30
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011748_13.png
early stop counter: 1
val acc:0.985472559928894, best validation acc: 0.9863239526748657, corresponding to test acc:                         0.9634068608283997 / 0.9699584245681763
after epoch: 13,now: 2024-06-02 06:08:51.956401,epoch time: 0:39:12.546451,used: 8:36:32.864263,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_21_32_19_seed_0_21011748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99292105, 'precision': 0.94891536, 'recall': 0.9412571, 'specificity': 0.9412571, 'f1': 0.9450507, 'auroc': 0.9971769, 'binary_precision': 0.90179807, 'binary_recall': 0.88586956, 'binary_specificity': 0.9966446, 'binary_f1_score': 0.8937628}
confusion matrix:
       0     1
0  42178   142
1    168  1304
---- Validation: 
scalar performance:
{'acc': 0.98696256, 'precision': 0.9237909, 'recall': 0.8694912, 'specificity': 0.8694912, 'f1': 0.8946347, 'auroc': 0.9820871, 'binary_precision': 0.8566308, 'binary_recall': 0.7433904, 'binary_specificity': 0.99559206, 'binary_f1_score': 0.79600334}
confusion matrix:
       0    1
0  18069   80
1    165  478
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.7834197, 'recall': 0.54839104, 'specificity': 0.54839104, 'f1': 0.5752086, 'auroc': 0.9466649, 'binary_precision': 0.60465115, 'binary_recall': 0.099616855, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.17105263}
confusion matrix:
      0   1
0  5980  17
1   235  26
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011748_14.png
better model found
persisted
after epoch: 14,now: 2024-06-02 06:48:06.519431,epoch time: 0:39:14.563030,used: 9:15:47.427293,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_21_32_19_seed_0_21011748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9935605, 'precision': 0.9547136, 'recall': 0.9451581, 'specificity': 0.9451581, 'f1': 0.9498812, 'auroc': 0.9977565, 'binary_precision': 0.9131341, 'binary_recall': 0.8932699, 'binary_specificity': 0.9970464, 'binary_f1_score': 0.9030928}
confusion matrix:
       0     1
0  42196   125
1    157  1314
---- Validation: 
scalar performance:
{'acc': 0.98797363, 'precision': 0.9438635, 'recall': 0.8647643, 'specificity': 0.8647643, 'f1': 0.9001504, 'auroc': 0.98347616, 'binary_precision': 0.8971428, 'binary_recall': 0.7325039, 'binary_specificity': 0.99702466, 'binary_f1_score': 0.8065069}
confusion matrix:
       0    1
0  18095   54
1    172  471
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608501, 'precision': 0.8642261, 'recall': 0.54347765, 'specificity': 0.54347765, 'f1': 0.56901735, 'auroc': 0.95323133, 'binary_precision': 0.76666665, 'binary_recall': 0.08812261, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.1580756}
confusion matrix:
      0   1
0  5990   7
1   238  23
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011748_15.png
better model found
persisted
after epoch: 15,now: 2024-06-02 07:26:53.749354,epoch time: 0:38:47.229923,used: 9:54:34.657216,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_21_32_19_seed_0_21011748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99225885, 'precision': 0.97102594, 'recall': 0.9060981, 'specificity': 0.9060981, 'f1': 0.93598264, 'auroc': 0.9976351, 'binary_precision': 0.94849443, 'binary_recall': 0.81373215, 'binary_specificity': 0.9984641, 'binary_f1_score': 0.87596047}
confusion matrix:
       0     1
0  42256    65
1    274  1197
---- Validation: 
scalar performance:
{'acc': 0.9857918, 'precision': 0.9490768, 'recall': 0.82313174, 'specificity': 0.82313174, 'f1': 0.8750874, 'auroc': 0.9816013, 'binary_precision': 0.9104803, 'binary_recall': 0.64852256, 'binary_specificity': 0.9977409, 'binary_f1_score': 0.7574932}
confusion matrix:
       0    1
0  18108   41
1    226  417
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9613295, 'precision': 0.9372755, 'recall': 0.54006314, 'specificity': 0.54006314, 'f1': 0.56405157, 'auroc': 0.9342018, 'binary_precision': 0.9130435, 'binary_recall': 0.08045977, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.14788733}
confusion matrix:
      0   1
0  5995   2
1   240  21
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011748_16.png
early stop counter: 1
val acc:0.985791802406311, best validation acc: 0.9879736304283142, corresponding to test acc:                         0.9608501195907593 / 0.9699584245681763
after epoch: 16,now: 2024-06-02 08:05:46.329585,epoch time: 0:38:52.580231,used: 10:33:27.237447,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_21_32_19_seed_0_21011748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9935833, 'precision': 0.9715443, 'recall': 0.9271739, 'specificity': 0.9271739, 'f1': 0.94818217, 'auroc': 0.9974838, 'binary_precision': 0.94808125, 'binary_recall': 0.85597825, 'binary_specificity': 0.9983696, 'binary_f1_score': 0.89967865}
confusion matrix:
       0     1
0  42251    69
1    212  1260
---- Validation: 
scalar performance:
{'acc': 0.9871222, 'precision': 0.95374763, 'recall': 0.8410717, 'specificity': 0.8410717, 'f1': 0.88883835, 'auroc': 0.9751822, 'binary_precision': 0.91858035, 'binary_recall': 0.6842924, 'binary_specificity': 0.99785113, 'binary_f1_score': 0.78431374}
confusion matrix:
       0    1
0  18110   39
1    203  440
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9603707, 'precision': 0.83564806, 'recall': 0.54139525, 'specificity': 0.54139525, 'f1': 0.5651985, 'auroc': 0.9465284, 'binary_precision': 0.7096774, 'binary_recall': 0.08429119, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.15068494}
confusion matrix:
      0   1
0  5988   9
1   239  22
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011748_17.png
early stop counter: 2
val acc:0.9871221780776978, best validation acc: 0.9879736304283142, corresponding to test acc:                         0.9608501195907593 / 0.9699584245681763
after epoch: 17,now: 2024-06-02 08:44:06.210274,epoch time: 0:38:19.880689,used: 11:11:47.118136,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_21_32_19_seed_0_21011748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99271554, 'precision': 0.9812393, 'recall': 0.9041027, 'specificity': 0.9041027, 'f1': 0.93906873, 'auroc': 0.99769664, 'binary_precision': 0.96908057, 'binary_recall': 0.80910325, 'binary_specificity': 0.99910206, 'binary_f1_score': 0.8818956}
confusion matrix:
       0     1
0  42282    38
1    281  1191
---- Validation: 
scalar performance:
{'acc': 0.98510003, 'precision': 0.94138503, 'recall': 0.81827325, 'specificity': 0.81827325, 'f1': 0.8691208, 'auroc': 0.9817802, 'binary_precision': 0.89542484, 'binary_recall': 0.63919127, 'binary_specificity': 0.9973552, 'binary_f1_score': 0.74591655}
confusion matrix:
       0    1
0  18101   48
1    232  411
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9600511, 'precision': 0.8324328, 'recall': 0.53573143, 'specificity': 0.53573143, 'f1': 0.5557498, 'auroc': 0.94682145, 'binary_precision': 0.7037037, 'binary_recall': 0.07279693, 'binary_specificity': 0.998666, 'binary_f1_score': 0.13194445}
confusion matrix:
      0   1
0  5989   8
1   242  19
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011748_18.png
early stop counter: 3
val acc:0.9851000308990479, best validation acc: 0.9879736304283142, corresponding to test acc:                         0.9608501195907593 / 0.9699584245681763
after epoch: 18,now: 2024-06-02 09:22:02.764500,epoch time: 0:37:56.554226,used: 11:49:43.672362,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_21_32_19_seed_0_21011748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.98945016, 'precision': 0.9787977, 'recall': 0.8545457, 'specificity': 0.8545457, 'f1': 0.9067662, 'auroc': 0.99707246, 'binary_precision': 0.9675926, 'binary_recall': 0.7099185, 'binary_specificity': 0.999173, 'binary_f1_score': 0.81896555}
confusion matrix:
       0     1
0  42285    35
1    427  1045
---- Validation: 
scalar performance:
{'acc': 0.98217326, 'precision': 0.95320874, 'recall': 0.7605039, 'specificity': 0.7605039, 'f1': 0.829085, 'auroc': 0.97364986, 'binary_precision': 0.9230769, 'binary_recall': 0.5225505, 'binary_specificity': 0.9984572, 'binary_f1_score': 0.6673287}
confusion matrix:
       0    1
0  18121   28
1    307  336
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.9793765, 'recall': 0.50574714, 'specificity': 0.50574714, 'f1': 0.50083476, 'auroc': 0.8877368, 'binary_precision': 1.0, 'binary_recall': 0.011494253, 'binary_specificity': 1.0, 'binary_f1_score': 0.022727272}
confusion matrix:
      0  1
0  5997  0
1   258  3
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011748_19.png
early stop counter: 4
val acc:0.9821732640266418, best validation acc: 0.9879736304283142, corresponding to test acc:                         0.9608501195907593 / 0.9699584245681763
after epoch: 19,now: 2024-06-02 10:00:01.243768,epoch time: 0:37:58.479268,used: 12:27:42.151630,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_21_32_19_seed_0_21011748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99152815, 'precision': 0.9896159, 'recall': 0.87857103, 'specificity': 0.87857103, 'f1': 0.9264985, 'auroc': 0.9989821, 'binary_precision': 0.9875997, 'binary_recall': 0.7574728, 'binary_specificity': 0.9996692, 'binary_f1_score': 0.85736257}
confusion matrix:
       0     1
0  42306    14
1    357  1115
---- Validation: 
scalar performance:
{'acc': 0.98408896, 'precision': 0.96191496, 'recall': 0.7854974, 'specificity': 0.7854974, 'f1': 0.85146517, 'auroc': 0.9846037, 'binary_precision': 0.93877554, 'binary_recall': 0.57231724, 'binary_specificity': 0.9986776, 'binary_f1_score': 0.71111107}
confusion matrix:
       0    1
0  18125   24
1    275  368
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96244806, 'precision': 0.8941661, 'recall': 0.56263477, 'specificity': 0.56263477, 'f1': 0.6000152, 'auroc': 0.93375695, 'binary_precision': 0.825, 'binary_recall': 0.12643678, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.21926911}
confusion matrix:
      0   1
0  5990   7
1   228  33
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011748_20.png
early stop counter: 5
val acc:0.9840889573097229, best validation acc: 0.9879736304283142, corresponding to test acc:                         0.9608501195907593 / 0.9699584245681763
after epoch: 20,now: 2024-06-02 10:37:54.930249,epoch time: 0:37:53.686481,used: 13:05:35.838111,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_21_32_19_seed_0_21011748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9942227, 'precision': 0.9600908, 'recall': 0.950127, 'specificity': 0.950127, 'f1': 0.9550501, 'auroc': 0.99836063, 'binary_precision': 0.923558, 'binary_recall': 0.90285325, 'binary_specificity': 0.99740076, 'binary_f1_score': 0.91308826}
confusion matrix:
       0     1
0  42210   110
1    143  1329
---- Validation: 
scalar performance:
{'acc': 0.9864304, 'precision': 0.9156754, 'recall': 0.8699658, 'specificity': 0.8699658, 'f1': 0.8913832, 'auroc': 0.98023474, 'binary_precision': 0.84035087, 'binary_recall': 0.7449456, 'binary_specificity': 0.99498594, 'binary_f1_score': 0.78977746}
confusion matrix:
       0    1
0  18058   91
1    164  479
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9651646, 'precision': 0.86051404, 'recall': 0.6208545, 'specificity': 0.6208545, 'f1': 0.67601466, 'auroc': 0.9524991, 'binary_precision': 0.7529412, 'binary_recall': 0.24521072, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.3699422}
confusion matrix:
      0   1
0  5976  21
1   197  64
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011748_21.png
early stop counter: 6
val acc:0.9864304065704346, best validation acc: 0.9879736304283142, corresponding to test acc:                         0.9608501195907593 / 0.9699584245681763
after epoch: 21,now: 2024-06-02 11:15:53.337934,epoch time: 0:37:58.407685,used: 13:43:34.245796,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_21_32_19_seed_0_21011748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9927841, 'precision': 0.94370294, 'recall': 0.9454484, 'specificity': 0.9454484, 'f1': 0.9445738, 'auroc': 0.9977292, 'binary_precision': 0.891069, 'binary_recall': 0.89470106, 'binary_specificity': 0.9961957, 'binary_f1_score': 0.89288133}
confusion matrix:
       0     1
0  42159   161
1    155  1317
---- Validation: 
scalar performance:
{'acc': 0.9855257, 'precision': 0.8990445, 'recall': 0.8762479, 'specificity': 0.8762479, 'f1': 0.88728285, 'auroc': 0.97635543, 'binary_precision': 0.8066116, 'binary_recall': 0.7589425, 'binary_specificity': 0.99355334, 'binary_f1_score': 0.7820513}
confusion matrix:
       0    1
0  18032  117
1    155  488
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96164906, 'precision': 0.8536699, 'recall': 0.5603855, 'specificity': 0.5603855, 'f1': 0.59543675, 'auroc': 0.9138533, 'binary_precision': 0.74418604, 'binary_recall': 0.12260536, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.2105263}
confusion matrix:
      0   1
0  5986  11
1   229  32
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011748_22.png
early stop counter: 7
val acc:0.9855257272720337, best validation acc: 0.9879736304283142, corresponding to test acc:                         0.9608501195907593 / 0.9699584245681763
after epoch: 22,now: 2024-06-02 11:53:55.220327,epoch time: 0:38:01.882393,used: 14:21:36.128189,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_21_32_19_seed_0_21011748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9950904, 'precision': 0.9629132, 'recall': 0.9613953, 'specificity': 0.9613953, 'f1': 0.96215296, 'auroc': 0.9989848, 'binary_precision': 0.9284254, 'binary_recall': 0.92527175, 'binary_specificity': 0.9975189, 'binary_f1_score': 0.9268459}
confusion matrix:
       0     1
0  42215   105
1    110  1362
---- Validation: 
scalar performance:
{'acc': 0.9878672, 'precision': 0.9240048, 'recall': 0.8857107, 'specificity': 0.8857107, 'f1': 0.9038792, 'auroc': 0.98476475, 'binary_precision': 0.8559177, 'binary_recall': 0.7760498, 'binary_specificity': 0.99537164, 'binary_f1_score': 0.8140294}
confusion matrix:
       0    1
0  18065   84
1    144  499
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96628314, 'precision': 0.85094404, 'recall': 0.64892316, 'specificity': 0.64892316, 'f1': 0.7054069, 'auroc': 0.9555493, 'binary_precision': 0.7314815, 'binary_recall': 0.30268198, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.42818427}
confusion matrix:
      0   1
0  5968  29
1   182  79
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011748_23.png
early stop counter: 8
val acc:0.9878671765327454, best validation acc: 0.9879736304283142, corresponding to test acc:                         0.9608501195907593 / 0.9699584245681763
after epoch: 23,now: 2024-06-02 12:31:59.043813,epoch time: 0:38:03.823486,used: 14:59:39.951675,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_21_32_19_seed_0_21011748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9948849, 'precision': 0.97874284, 'recall': 0.9409617, 'specificity': 0.9409617, 'f1': 0.9590186, 'auroc': 0.9990074, 'binary_precision': 0.96153843, 'binary_recall': 0.8831522, 'binary_specificity': 0.99877125, 'binary_f1_score': 0.92067987}
confusion matrix:
       0     1
0  42268    52
1    172  1300
---- Validation: 
scalar performance:
{'acc': 0.985845, 'precision': 0.93931776, 'recall': 0.83291, 'specificity': 0.83291, 'f1': 0.87823474, 'auroc': 0.98031694, 'binary_precision': 0.89026916, 'binary_recall': 0.6687403, 'binary_specificity': 0.99707973, 'binary_f1_score': 0.7637656}
confusion matrix:
       0    1
0  18096   53
1    213  430
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579738, 'precision': 0.71461916, 'recall': 0.52731824, 'specificity': 0.52731824, 'f1': 0.54043615, 'auroc': 0.9353479, 'binary_precision': 0.46875, 'binary_recall': 0.057471264, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.102389075}
confusion matrix:
      0   1
0  5980  17
1   246  15
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011748_24.png
early stop counter: 9
val acc:0.9858450293540955, best validation acc: 0.9879736304283142, corresponding to test acc:                         0.9608501195907593 / 0.9699584245681763
after epoch: 24,now: 2024-06-02 13:09:54.565127,epoch time: 0:37:55.521314,used: 15:37:35.472989,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_21_32_19_seed_0_21011748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9941999, 'precision': 0.9391149, 'recall': 0.97699964, 'specificity': 0.97699964, 'f1': 0.9572098, 'auroc': 0.99918747, 'binary_precision': 0.8796758, 'binary_recall': 0.9585598, 'binary_specificity': 0.9954395, 'binary_f1_score': 0.9174253}
confusion matrix:
       0     1
0  42127   193
1     61  1411
---- Validation: 
scalar performance:
{'acc': 0.98659, 'precision': 0.90315944, 'recall': 0.89105, 'specificity': 0.89105, 'f1': 0.8970046, 'auroc': 0.9782142, 'binary_precision': 0.81380415, 'binary_recall': 0.7884914, 'binary_specificity': 0.9936085, 'binary_f1_score': 0.80094784}
confusion matrix:
       0    1
0  18033  116
1    136  507
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9613295, 'precision': 0.824932, 'recall': 0.5657158, 'specificity': 0.5657158, 'f1': 0.6022647, 'auroc': 0.936208, 'binary_precision': 0.6862745, 'binary_recall': 0.13409962, 'binary_specificity': 0.997332, 'binary_f1_score': 0.22435899}
confusion matrix:
      0   1
0  5981  16
1   226  35
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011748_25.png
early stop counter: 10
val acc:0.9865900278091431, best validation acc: 0.9879736304283142, corresponding to test acc:                         0.9608501195907593 / 0.9699584245681763
after epoch: 25,now: 2024-06-02 13:47:48.160984,epoch time: 0:37:53.595857,used: 16:15:29.068846,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_21_32_19_seed_0_21011748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99616367, 'precision': 0.97671735, 'recall': 0.9635657, 'specificity': 0.9635657, 'f1': 0.9700426, 'auroc': 0.99944365, 'binary_precision': 0.95591325, 'binary_recall': 0.92862, 'binary_specificity': 0.9985114, 'binary_f1_score': 0.942069}
confusion matrix:
       0     1
0  42258    63
1    105  1366
---- Validation: 
scalar performance:
{'acc': 0.9882397, 'precision': 0.9361838, 'recall': 0.877653, 'specificity': 0.877653, 'f1': 0.90464914, 'auroc': 0.9766974, 'binary_precision': 0.8808664, 'binary_recall': 0.7589425, 'binary_specificity': 0.99636346, 'binary_f1_score': 0.81537175}
confusion matrix:
       0    1
0  18083   66
1    155  488
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9610099, 'precision': 0.81197757, 'recall': 0.5655491, 'specificity': 0.5655491, 'f1': 0.6014666, 'auroc': 0.9367168, 'binary_precision': 0.6603774, 'binary_recall': 0.13409962, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.22292995}
confusion matrix:
      0   1
0  5979  18
1   226  35
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011748_26.png
better model found
persisted
after epoch: 26,now: 2024-06-02 14:25:41.272769,epoch time: 0:37:53.111785,used: 16:53:22.180631,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_21_32_19_seed_0_21011748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9956613, 'precision': 0.98659444, 'recall': 0.94562554, 'specificity': 0.94562554, 'f1': 0.96514356, 'auroc': 0.99936557, 'binary_precision': 0.97693455, 'binary_recall': 0.8919837, 'binary_specificity': 0.99926746, 'binary_f1_score': 0.9325285}
confusion matrix:
       0     1
0  42289    31
1    159  1313
---- Validation: 
scalar performance:
{'acc': 0.9870157, 'precision': 0.9561069, 'recall': 0.8372664, 'specificity': 0.8372664, 'f1': 0.88713956, 'auroc': 0.98240554, 'binary_precision': 0.9235669, 'binary_recall': 0.67651635, 'binary_specificity': 0.9980164, 'binary_f1_score': 0.78096944}
confusion matrix:
       0    1
0  18113   36
1    208  435
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96244806, 'precision': 0.8731942, 'recall': 0.56813174, 'specificity': 0.56813174, 'f1': 0.6076398, 'auroc': 0.95865345, 'binary_precision': 0.7826087, 'binary_recall': 0.13793103, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.23452768}
confusion matrix:
      0   1
0  5987  10
1   225  36
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011748_27.png
early stop counter: 1
val acc:0.9870157241821289, best validation acc: 0.9882397055625916, corresponding to test acc:                         0.9610099196434021 / 0.9699584245681763
after epoch: 27,now: 2024-06-02 15:03:30.671632,epoch time: 0:37:49.398863,used: 17:31:11.579494,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_21_32_19_seed_0_21011748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9935148, 'precision': 0.9253038, 'recall': 0.98581773, 'specificity': 0.98581773, 'f1': 0.9533813, 'auroc': 0.99933124, 'binary_precision': 0.8513914, 'binary_recall': 0.9775663, 'binary_specificity': 0.99406916, 'binary_f1_score': 0.9101266}
confusion matrix:
       0     1
0  42070   251
1     33  1438
---- Validation: 
scalar performance:
{'acc': 0.98467433, 'precision': 0.8698746, 'recall': 0.91405994, 'specificity': 0.91405994, 'f1': 0.89060676, 'auroc': 0.97984505, 'binary_precision': 0.74550486, 'binary_recall': 0.83825815, 'binary_specificity': 0.9898617, 'binary_f1_score': 0.78916544}
confusion matrix:
       0    1
0  17965  184
1    104  539
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96340686, 'precision': 0.83589745, 'recall': 0.60344636, 'specificity': 0.60344636, 'f1': 0.6528389, 'auroc': 0.93676245, 'binary_precision': 0.7051282, 'binary_recall': 0.21072797, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.32448378}
confusion matrix:
      0   1
0  5974  23
1   206  55
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011748_28.png
early stop counter: 2
val acc:0.984674334526062, best validation acc: 0.9882397055625916, corresponding to test acc:                         0.9610099196434021 / 0.9699584245681763
after epoch: 28,now: 2024-06-02 15:41:20.919178,epoch time: 0:37:50.247546,used: 18:09:01.827040,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_21_32_19_seed_0_21011748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99588966, 'precision': 0.98782367, 'recall': 0.94803876, 'specificity': 0.94803876, 'f1': 0.9670234, 'auroc': 0.9996408, 'binary_precision': 0.9792285, 'binary_recall': 0.8967391, 'binary_specificity': 0.9993384, 'binary_f1_score': 0.9361702}
confusion matrix:
       0     1
0  42292    28
1    152  1320
---- Validation: 
scalar performance:
{'acc': 0.98621756, 'precision': 0.95355266, 'recall': 0.82635236, 'specificity': 0.82635236, 'f1': 0.8788301, 'auroc': 0.97827387, 'binary_precision': 0.91921395, 'binary_recall': 0.6547434, 'binary_specificity': 0.99796134, 'binary_f1_score': 0.7647593}
confusion matrix:
       0    1
0  18112   37
1    222  421
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9613295, 'precision': 0.8596515, 'recall': 0.55288947, 'specificity': 0.55288947, 'f1': 0.5840563, 'auroc': 0.9368546, 'binary_precision': 0.7567568, 'binary_recall': 0.107279696, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.18791947}
confusion matrix:
      0   1
0  5988   9
1   233  28
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011748_29.png
early stop counter: 3
val acc:0.9862175583839417, best validation acc: 0.9882397055625916, corresponding to test acc:                         0.9610099196434021 / 0.9699584245681763
after epoch: 29,now: 2024-06-02 16:19:13.249590,epoch time: 0:37:52.330412,used: 18:46:54.157452,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_21_32_19_seed_0_21011748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.993355, 'precision': 0.9513698, 'recall': 0.94574374, 'specificity': 0.94574374, 'f1': 0.94853777, 'auroc': 0.9962104, 'binary_precision': 0.90640056, 'binary_recall': 0.89470106, 'binary_specificity': 0.9967864, 'binary_f1_score': 0.9005128}
confusion matrix:
       0     1
0  42184   136
1    155  1317
---- Validation: 
scalar performance:
{'acc': 0.9849404, 'precision': 0.9194621, 'recall': 0.837692, 'specificity': 0.837692, 'f1': 0.8738165, 'auroc': 0.9621794, 'binary_precision': 0.8501946, 'binary_recall': 0.67962676, 'binary_specificity': 0.99575734, 'binary_f1_score': 0.7554019}
confusion matrix:
       0    1
0  18072   77
1    206  437
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.84123933, 'recall': 0.5244873, 'specificity': 0.5244873, 'f1': 0.5362575, 'auroc': 0.9036081, 'binary_precision': 0.7222222, 'binary_recall': 0.049808428, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.093189955}
confusion matrix:
      0   1
0  5992   5
1   248  13
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011748_30.png
early stop counter: 4
val acc:0.9849404096603394, best validation acc: 0.9882397055625916, corresponding to test acc:                         0.9610099196434021 / 0.9699584245681763
after epoch: 30,now: 2024-06-02 16:57:05.387036,epoch time: 0:37:52.137446,used: 19:24:46.294898,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_21_32_19_seed_0_21011748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 19:24:46.294898 at 2024-06-02 16:57:05.387036
persisted model performance metric: 

scalar performance:
{'acc': 0.9608501, 'precision': 0.81163657, 'recall': 0.561801, 'specificity': 0.561801, 'f1': 0.59607244, 'auroc': 0.94109297, 'binary_precision': 0.66, 'binary_recall': 0.12643678, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.21221867}
confusion matrix:
      0   1
0  5980  17
1   228  33
oracle model performance metric: 

scalar performance:
{'acc': 0.9694791, 'precision': 0.86225075, 'recall': 0.6982313, 'specificity': 0.6982313, 'f1': 0.75396264, 'auroc': 0.95365256, 'binary_precision': 0.75, 'binary_recall': 0.40229884, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.52369076}
confusion matrix:
      0    1
0  5962   35
1   156  105
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/rule_results/7.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/rule_results/7.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/confusion_matrix/7.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1661 MiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |   1655 MiB |  15779 MiB |    977 TiB |    977 TiB |
|       from small pool |      6 MiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1661 MiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |   1655 MiB |  15779 MiB |    977 TiB |    977 TiB |
|       from small pool |      6 MiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1653 MiB |  15770 MiB |    987 TiB |    987 TiB |
|       from large pool |   1647 MiB |  15745 MiB |    974 TiB |    974 TiB |
|       from small pool |      5 MiB |     25 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  16730 MiB |  16730 MiB |  16730 MiB |      0 B   |
|       from large pool |  16702 MiB |  16702 MiB |  16702 MiB |      0 B   |
|       from small pool |     28 MiB |     28 MiB |     28 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 430238 KiB |    863 MiB | 413551 GiB | 413551 GiB |
|       from large pool | 410304 KiB |    862 MiB | 400661 GiB | 400661 GiB |
|       from small pool |  19934 KiB |     21 MiB |  12890 GiB |  12890 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3366    |    6357    |  152224 K  |  152221 K  |
|       from large pool |     247    |     989    |   62327 K  |   62326 K  |
|       from small pool |    3119    |    6108    |   89897 K  |   89894 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3366    |    6357    |  152224 K  |  152221 K  |
|       from large pool |     247    |     989    |   62327 K  |   62326 K  |
|       from small pool |    3119    |    6108    |   89897 K  |   89894 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     621    |     621    |     621    |       0    |
|       from large pool |     607    |     607    |     607    |       0    |
|       from small pool |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     148    |    2873    |   89647 K  |   89646 K  |
|       from large pool |     112    |     516    |   47275 K  |   47275 K  |
|       from small pool |      36    |    2761    |   42371 K  |   42371 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |  16640 KiB |  15779 MiB |    977 TiB |    977 TiB |
|       from small pool |      0 KiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |  16640 KiB |  15779 MiB |    977 TiB |    977 TiB |
|       from small pool |      0 KiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15770 MiB |    987 TiB |    987 TiB |
|       from large pool |  16640 KiB |  15745 MiB |    974 TiB |    974 TiB |
|       from small pool |      0 KiB |     25 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2082 MiB |  16730 MiB |  16730 MiB |  14648 MiB |
|       from large pool |   2056 MiB |  16702 MiB |  16702 MiB |  14646 MiB |
|       from small pool |     26 MiB |     28 MiB |     28 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    863 MiB | 413552 GiB | 413552 GiB |
|       from large pool |  24320 KiB |    862 MiB | 400662 GiB | 400662 GiB |
|       from small pool |      0 KiB |     25 MiB |  12890 GiB |  12890 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6357    |  152224 K  |  152224 K  |
|       from large pool |       2    |     989    |   62327 K  |   62327 K  |
|       from small pool |       0    |    6108    |   89897 K  |   89897 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6357    |  152224 K  |  152224 K  |
|       from large pool |       2    |     989    |   62327 K  |   62327 K  |
|       from small pool |       0    |    6108    |   89897 K  |   89897 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     115    |     621    |     621    |     506    |
|       from large pool |     102    |     607    |     607    |     505    |
|       from small pool |      13    |      14    |      14    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    2873    |   89648 K  |   89648 K  |
|       from large pool |       2    |     516    |   47275 K  |   47275 K  |
|       from small pool |       0    |    2761    |   42372 K  |   42372 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |  16640 KiB |  15779 MiB |    977 TiB |    977 TiB |
|       from small pool |      0 KiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |  16640 KiB |  15779 MiB |    977 TiB |    977 TiB |
|       from small pool |      0 KiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15770 MiB |    987 TiB |    987 TiB |
|       from large pool |  16640 KiB |  15745 MiB |    974 TiB |    974 TiB |
|       from small pool |      0 KiB |     25 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2082 MiB |  16730 MiB |  16730 MiB |  14648 MiB |
|       from large pool |   2056 MiB |  16702 MiB |  16702 MiB |  14646 MiB |
|       from small pool |     26 MiB |     28 MiB |     28 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    863 MiB | 413552 GiB | 413552 GiB |
|       from large pool |  24320 KiB |    862 MiB | 400662 GiB | 400662 GiB |
|       from small pool |      0 KiB |     25 MiB |  12890 GiB |  12890 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6357    |  152224 K  |  152224 K  |
|       from large pool |       2    |     989    |   62327 K  |   62327 K  |
|       from small pool |       0    |    6108    |   89897 K  |   89897 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6357    |  152224 K  |  152224 K  |
|       from large pool |       2    |     989    |   62327 K  |   62327 K  |
|       from small pool |       0    |    6108    |   89897 K  |   89897 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     115    |     621    |     621    |     506    |
|       from large pool |     102    |     607    |     607    |     505    |
|       from small pool |      13    |      14    |      14    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    2873    |   89648 K  |   89648 K  |
|       from large pool |       2    |     516    |   47275 K  |   47275 K  |
|       from small pool |       0    |    2761    |   42372 K  |   42372 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_17_06_50_seed_1_21011748

 Experiment start at: 2024-06-02 17:06:51.015419
before training, model accuracy: 0.06445375829935074
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9688298, 'precision': 0.7546788, 'recall': 0.8646421, 'specificity': 0.8646421, 'f1': 0.7987461, 'auroc': 0.96854615, 'binary_precision': 0.5178827, 'binary_recall': 0.75312066, 'binary_specificity': 0.9761635, 'binary_f1_score': 0.6137327}
confusion matrix:
       0     1
0  41403  1011
1    356  1086
---- Validation: 
scalar performance:
{'acc': 0.966809, 'precision': 0.7585816, 'recall': 0.8540382, 'specificity': 0.8540382, 'f1': 0.7979223, 'auroc': 0.96803176, 'binary_precision': 0.5272727, 'binary_recall': 0.73254085, 'binary_specificity': 0.9755355, 'binary_f1_score': 0.6131841}
confusion matrix:
       0    1
0  17625  442
1    180  493
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9660006, 'precision': 0.8662616, 'recall': 0.6346885, 'specificity': 0.6346885, 'f1': 0.6923845, 'auroc': 0.94979477, 'binary_precision': 0.76344085, 'binary_recall': 0.27307692, 'binary_specificity': 0.99630004, 'binary_f1_score': 0.4022663}
confusion matrix:
      0   1
0  5924  22
1   189  71
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011748_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-02 17:46:09.878868,epoch time: 0:39:18.863449,used: 0:39:18.863449,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_17_06_50_seed_1_21011748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9773805, 'precision': 0.8138956, 'recall': 0.85532975, 'specificity': 0.85532975, 'f1': 0.83320475, 'auroc': 0.97766006, 'binary_precision': 0.6371951, 'binary_recall': 0.72468793, 'binary_specificity': 0.9859716, 'binary_f1_score': 0.6781311}
confusion matrix:
       0     1
0  41819   595
1    397  1045
---- Validation: 
scalar performance:
{'acc': 0.9767876, 'precision': 0.8297802, 'recall': 0.8406164, 'specificity': 0.8406164, 'f1': 0.83510184, 'auroc': 0.9746777, 'binary_precision': 0.670977, 'binary_recall': 0.69390786, 'binary_specificity': 0.98732495, 'binary_f1_score': 0.6822498}
confusion matrix:
       0    1
0  17838  229
1    206  467
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96132773, 'precision': 0.78102225, 'recall': 0.617538, 'specificity': 0.617538, 'f1': 0.66216934, 'auroc': 0.9558737, 'binary_precision': 0.5943396, 'binary_recall': 0.2423077, 'binary_specificity': 0.9927682, 'binary_f1_score': 0.3442623}
confusion matrix:
      0   1
0  5903  43
1   197  63
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011748_2.png
better model found
persisted
after epoch: 2,now: 2024-06-02 18:24:02.069743,epoch time: 0:37:52.190875,used: 1:17:11.054324,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_17_06_50_seed_1_21011748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97893107, 'precision': 0.9124007, 'recall': 0.719136, 'specificity': 0.719136, 'f1': 0.784215, 'auroc': 0.98081934, 'binary_precision': 0.8435013, 'binary_recall': 0.4410541, 'binary_specificity': 0.9972179, 'binary_f1_score': 0.57923496}
confusion matrix:
       0    1
0  42296  118
1    806  636
---- Validation: 
scalar performance:
{'acc': 0.97550696, 'precision': 0.9471363, 'recall': 0.6740102, 'specificity': 0.6740102, 'f1': 0.7466812, 'auroc': 0.97568905, 'binary_precision': 0.91796875, 'binary_recall': 0.34918275, 'binary_specificity': 0.99883765, 'binary_f1_score': 0.50592035}
confusion matrix:
       0    1
0  18046   21
1    438  235
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587496, 'precision': 0.85450953, 'recall': 0.5113703, 'specificity': 0.5113703, 'f1': 0.51184785, 'auroc': 0.9556538, 'binary_precision': 0.75, 'binary_recall': 0.023076924, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.04477612}
confusion matrix:
      0  1
0  5944  2
1   254  6
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011748_3.png
early stop counter: 1
val acc:0.9755069613456726, best validation acc: 0.9767876267433167, corresponding to test acc:                         0.9613277316093445 / 0.9660006165504456
after epoch: 3,now: 2024-06-02 19:01:50.565978,epoch time: 0:37:48.496235,used: 1:54:59.550559,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_17_06_50_seed_1_21011748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9811884, 'precision': 0.8449882, 'recall': 0.8710315, 'specificity': 0.8710315, 'f1': 0.8574931, 'auroc': 0.98317945, 'binary_precision': 0.6983923, 'binary_recall': 0.75312066, 'binary_specificity': 0.9889423, 'binary_f1_score': 0.72472477}
confusion matrix:
       0     1
0  41945   469
1    356  1086
---- Validation: 
scalar performance:
{'acc': 0.9784952, 'precision': 0.84623855, 'recall': 0.8407867, 'specificity': 0.8407867, 'f1': 0.8434889, 'auroc': 0.97457975, 'binary_precision': 0.7039275, 'binary_recall': 0.692422, 'binary_specificity': 0.9891515, 'binary_f1_score': 0.6981273}
confusion matrix:
       0    1
0  17871  196
1    207  466
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9629391, 'precision': 0.8764375, 'recall': 0.57792115, 'specificity': 0.57792115, 'f1': 0.62190616, 'auroc': 0.9606318, 'binary_precision': 0.78846157, 'binary_recall': 0.15769231, 'binary_specificity': 0.99815, 'binary_f1_score': 0.2628205}
confusion matrix:
      0   1
0  5935  11
1   219  41
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011748_4.png
better model found
persisted
after epoch: 4,now: 2024-06-02 19:39:41.110993,epoch time: 0:37:50.545015,used: 2:32:50.095574,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_17_06_50_seed_1_21011748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98091483, 'precision': 0.9389287, 'recall': 0.73657423, 'specificity': 0.73657423, 'f1': 0.8054817, 'auroc': 0.9874083, 'binary_precision': 0.89542484, 'binary_recall': 0.47503468, 'binary_specificity': 0.9981138, 'binary_f1_score': 0.62075216}
confusion matrix:
       0    1
0  42334   80
1    757  685
---- Validation: 
scalar performance:
{'acc': 0.97652084, 'precision': 0.95047235, 'recall': 0.6881261, 'specificity': 0.6881261, 'f1': 0.7619104, 'auroc': 0.9787849, 'binary_precision': 0.9236364, 'binary_recall': 0.37741455, 'binary_specificity': 0.99883765, 'binary_f1_score': 0.53586495}
confusion matrix:
       0    1
0  18046   21
1    419  254
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9585885, 'precision': 0.9792842, 'recall': 0.50576925, 'specificity': 0.50576925, 'f1': 0.5008299, 'auroc': 0.96018153, 'binary_precision': 1.0, 'binary_recall': 0.011538462, 'binary_specificity': 1.0, 'binary_f1_score': 0.022813687}
confusion matrix:
      0  1
0  5946  0
1   257  3
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011748_5.png
early stop counter: 1
val acc:0.976520836353302, best validation acc: 0.978495180606842, corresponding to test acc:                         0.9629390835762024 / 0.9660006165504456
after epoch: 5,now: 2024-06-02 20:17:32.996598,epoch time: 0:37:51.885605,used: 3:10:41.981179,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_17_06_50_seed_1_21011748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98707134, 'precision': 0.9027698, 'recall': 0.8911555, 'specificity': 0.8911555, 'f1': 0.89687085, 'auroc': 0.9908, 'binary_precision': 0.8127234, 'binary_recall': 0.7884882, 'binary_specificity': 0.9938228, 'binary_f1_score': 0.80042243}
confusion matrix:
       0     1
0  42152   262
1    305  1137
---- Validation: 
scalar performance:
{'acc': 0.98297757, 'precision': 0.91063845, 'recall': 0.825945, 'specificity': 0.825945, 'f1': 0.8630181, 'auroc': 0.98013544, 'binary_precision': 0.83396226, 'binary_recall': 0.65676075, 'binary_specificity': 0.9951292, 'binary_f1_score': 0.7348296}
confusion matrix:
       0    1
0  17979   88
1    231  442
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590719, 'precision': 0.8236369, 'recall': 0.5207334, 'specificity': 0.5207334, 'f1': 0.5293904, 'auroc': 0.94883406, 'binary_precision': 0.6875, 'binary_recall': 0.042307694, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.07971015}
confusion matrix:
      0   1
0  5941   5
1   249  11
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011748_6.png
better model found
persisted
after epoch: 6,now: 2024-06-02 20:55:20.968303,epoch time: 0:37:47.971705,used: 3:48:29.952884,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_17_06_50_seed_1_21011748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98467714, 'precision': 0.92745775, 'recall': 0.8135486, 'specificity': 0.8135486, 'f1': 0.8611176, 'auroc': 0.9896159, 'binary_precision': 0.86736643, 'binary_recall': 0.6303745, 'binary_specificity': 0.99672276, 'binary_f1_score': 0.7301205}
confusion matrix:
       0    1
0  42275  139
1    533  909
---- Validation: 
scalar performance:
{'acc': 0.9823906, 'precision': 0.94573915, 'recall': 0.7827245, 'specificity': 0.7827245, 'f1': 0.8446426, 'auroc': 0.9770738, 'binary_precision': 0.9073634, 'binary_recall': 0.5676077, 'binary_specificity': 0.99784136, 'binary_f1_score': 0.69835466}
confusion matrix:
       0    1
0  18028   39
1    291  382
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95939416, 'precision': 0.9796709, 'recall': 0.5153846, 'specificity': 0.5153846, 'f1': 0.5194752, 'auroc': 0.9421779, 'binary_precision': 1.0, 'binary_recall': 0.03076923, 'binary_specificity': 1.0, 'binary_f1_score': 0.05970149}
confusion matrix:
      0  1
0  5946  0
1   252  8
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011748_7.png
early stop counter: 1
val acc:0.9823905825614929, best validation acc: 0.982977569103241, corresponding to test acc:                         0.9590718746185303 / 0.9660006165504456
after epoch: 7,now: 2024-06-02 21:33:06.114124,epoch time: 0:37:45.145821,used: 4:26:15.098705,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_17_06_50_seed_1_21011748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9881886, 'precision': 0.91704106, 'recall': 0.892403, 'specificity': 0.892403, 'f1': 0.9043176, 'auroc': 0.9933083, 'binary_precision': 0.8412112, 'binary_recall': 0.78987515, 'binary_specificity': 0.9949309, 'binary_f1_score': 0.81473535}
confusion matrix:
       0     1
0  42199   215
1    303  1139
---- Validation: 
scalar performance:
{'acc': 0.98521876, 'precision': 0.9270518, 'recall': 0.8464196, 'specificity': 0.8464196, 'f1': 0.88218915, 'auroc': 0.9796741, 'binary_precision': 0.86531365, 'binary_recall': 0.6968796, 'binary_specificity': 0.99595946, 'binary_f1_score': 0.77201647}
confusion matrix:
       0    1
0  17994   73
1    204  469
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582662, 'precision': 0.81253695, 'recall': 0.50376207, 'specificity': 0.50376207, 'f1': 0.49694523, 'auroc': 0.9329648, 'binary_precision': 0.6666667, 'binary_recall': 0.0076923077, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.015209124}
confusion matrix:
      0  1
0  5945  1
1   258  2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011748_8.png
better model found
persisted
after epoch: 8,now: 2024-06-02 22:10:48.330594,epoch time: 0:37:42.216470,used: 5:03:57.315175,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_17_06_50_seed_1_21011748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9889639, 'precision': 0.9106568, 'recall': 0.91725534, 'specificity': 0.91725534, 'f1': 0.9139277, 'auroc': 0.9951955, 'binary_precision': 0.82673943, 'binary_recall': 0.8404993, 'binary_specificity': 0.9940114, 'binary_f1_score': 0.83356255}
confusion matrix:
       0     1
0  42160   254
1    230  1212
---- Validation: 
scalar performance:
{'acc': 0.9851654, 'precision': 0.9121307, 'recall': 0.8635583, 'specificity': 0.8635583, 'f1': 0.8861936, 'auroc': 0.9741645, 'binary_precision': 0.83417934, 'binary_recall': 0.73254085, 'binary_specificity': 0.99457574, 'binary_f1_score': 0.7800633}
confusion matrix:
       0    1
0  17969   98
1    180  493
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9619723, 'precision': 0.8208029, 'recall': 0.58661157, 'specificity': 0.58661157, 'f1': 0.6304789, 'auroc': 0.94448626, 'binary_precision': 0.6764706, 'binary_recall': 0.17692308, 'binary_specificity': 0.99630004, 'binary_f1_score': 0.2804878}
confusion matrix:
      0   1
0  5924  22
1   214  46
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011748_9.png
early stop counter: 1
val acc:0.9851654171943665, best validation acc: 0.9852187633514404, corresponding to test acc:                         0.9582661986351013 / 0.9660006165504456
after epoch: 9,now: 2024-06-02 22:48:33.694864,epoch time: 0:37:45.364270,used: 5:41:42.679445,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_17_06_50_seed_1_21011748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9894883, 'precision': 0.92378294, 'recall': 0.9081478, 'specificity': 0.9081478, 'f1': 0.91580695, 'auroc': 0.99506307, 'binary_precision': 0.853641, 'binary_recall': 0.8210818, 'binary_specificity': 0.99521387, 'binary_f1_score': 0.8370449}
confusion matrix:
       0     1
0  42211   203
1    258  1184
---- Validation: 
scalar performance:
{'acc': 0.9846852, 'precision': 0.9139322, 'recall': 0.8525802, 'specificity': 0.8525802, 'f1': 0.8805934, 'auroc': 0.97745967, 'binary_precision': 0.83859646, 'binary_recall': 0.7102526, 'binary_specificity': 0.99490786, 'binary_f1_score': 0.769107}
confusion matrix:
       0    1
0  17975   92
1    195  478
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959233, 'precision': 0.75727534, 'recall': 0.5704701, 'specificity': 0.5704701, 'f1': 0.6050322, 'auroc': 0.9488619, 'binary_precision': 0.5507246, 'binary_recall': 0.14615385, 'binary_specificity': 0.9947864, 'binary_f1_score': 0.23100303}
confusion matrix:
      0   1
0  5915  31
1   222  38
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011748_10.png
early stop counter: 2
val acc:0.9846851825714111, best validation acc: 0.9852187633514404, corresponding to test acc:                         0.9582661986351013 / 0.9660006165504456
after epoch: 10,now: 2024-06-02 23:26:19.596462,epoch time: 0:37:45.901598,used: 6:19:28.581043,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_17_06_50_seed_1_21011748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99113005, 'precision': 0.9348577, 'recall': 0.92406946, 'specificity': 0.92406946, 'f1': 0.9293906, 'auroc': 0.99560934, 'binary_precision': 0.8747331, 'binary_recall': 0.8522885, 'binary_specificity': 0.99585044, 'binary_f1_score': 0.86336493}
confusion matrix:
       0     1
0  42238   176
1    213  1229
---- Validation: 
scalar performance:
{'acc': 0.9846318, 'precision': 0.914907, 'recall': 0.85040677, 'specificity': 0.85040677, 'f1': 0.8797101, 'auroc': 0.977875, 'binary_precision': 0.84070796, 'binary_recall': 0.70579493, 'binary_specificity': 0.99501854, 'binary_f1_score': 0.7673667}
confusion matrix:
       0    1
0  17977   90
1    198  475
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611666, 'precision': 0.90674806, 'recall': 0.5438944, 'specificity': 0.5438944, 'f1': 0.5702013, 'auroc': 0.9462719, 'binary_precision': 0.8518519, 'binary_recall': 0.08846154, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.16027877}
confusion matrix:
      0   1
0  5942   4
1   237  23
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011748_11.png
early stop counter: 3
val acc:0.9846317768096924, best validation acc: 0.9852187633514404, corresponding to test acc:                         0.9582661986351013 / 0.9660006165504456
after epoch: 11,now: 2024-06-03 00:04:33.633848,epoch time: 0:38:14.037386,used: 6:57:42.618429,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_17_06_50_seed_1_21011748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99065125, 'precision': 0.95223236, 'recall': 0.895016, 'specificity': 0.895016, 'f1': 0.9215501, 'auroc': 0.9944267, 'binary_precision': 0.9114832, 'binary_recall': 0.7926491, 'binary_specificity': 0.99738294, 'binary_f1_score': 0.84792286}
confusion matrix:
       0     1
0  42303   111
1    299  1143
---- Validation: 
scalar performance:
{'acc': 0.98441833, 'precision': 0.9337598, 'recall': 0.82597697, 'specificity': 0.82597697, 'f1': 0.8716175, 'auroc': 0.9748455, 'binary_precision': 0.88023955, 'binary_recall': 0.65527487, 'binary_specificity': 0.996679, 'binary_f1_score': 0.7512777}
confusion matrix:
       0    1
0  18007   60
1    232  441
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597164, 'precision': 0.97982574, 'recall': 0.5192308, 'specificity': 0.5192308, 'f1': 0.52674216, 'auroc': 0.92619777, 'binary_precision': 1.0, 'binary_recall': 0.03846154, 'binary_specificity': 1.0, 'binary_f1_score': 0.074074075}
confusion matrix:
      0   1
0  5946   0
1   250  10
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011748_12.png
early stop counter: 4
val acc:0.9844183325767517, best validation acc: 0.9852187633514404, corresponding to test acc:                         0.9582661986351013 / 0.9660006165504456
after epoch: 12,now: 2024-06-03 00:44:00.746268,epoch time: 0:39:27.112420,used: 7:37:09.730849,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_17_06_50_seed_1_21011748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99185973, 'precision': 0.9298754, 'recall': 0.94454384, 'specificity': 0.94454384, 'f1': 0.9370768, 'auroc': 0.9967711, 'binary_precision': 0.8633624, 'binary_recall': 0.89389735, 'binary_specificity': 0.99519026, 'binary_f1_score': 0.8783646}
confusion matrix:
       0     1
0  42210   204
1    153  1289
---- Validation: 
scalar performance:
{'acc': 0.9857524, 'precision': 0.8999162, 'recall': 0.8924734, 'specificity': 0.8924734, 'f1': 0.8961567, 'auroc': 0.97672707, 'binary_precision': 0.80757576, 'binary_recall': 0.7919762, 'binary_specificity': 0.9929706, 'binary_f1_score': 0.79969996}
confusion matrix:
       0    1
0  17940  127
1    140  533
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9585885, 'precision': 0.7579526, 'recall': 0.5278371, 'specificity': 0.5278371, 'f1': 0.54166687, 'auroc': 0.9291191, 'binary_precision': 0.5555556, 'binary_recall': 0.057692308, 'binary_specificity': 0.99798185, 'binary_f1_score': 0.10452962}
confusion matrix:
      0   1
0  5934  12
1   245  15
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011748_13.png
better model found
persisted
after epoch: 13,now: 2024-06-03 01:23:19.482262,epoch time: 0:39:18.735994,used: 8:16:28.466843,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_17_06_50_seed_1_21011748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9912441, 'precision': 0.9553206, 'recall': 0.9020215, 'specificity': 0.9020215, 'f1': 0.9268925, 'auroc': 0.99728096, 'binary_precision': 0.9171924, 'binary_recall': 0.80651873, 'binary_specificity': 0.9975244, 'binary_f1_score': 0.8583026}
confusion matrix:
       0     1
0  42309   105
1    279  1163
---- Validation: 
scalar performance:
{'acc': 0.9842049, 'precision': 0.9392643, 'recall': 0.81728303, 'specificity': 0.81728303, 'f1': 0.8676762, 'auroc': 0.9731934, 'binary_precision': 0.8918919, 'binary_recall': 0.63744426, 'binary_specificity': 0.9971218, 'binary_f1_score': 0.7435008}
confusion matrix:
       0    1
0  18015   52
1    244  429
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597164, 'precision': 0.8862985, 'recall': 0.5247477, 'specificity': 0.5247477, 'f1': 0.5368015, 'auroc': 0.8793494, 'binary_precision': 0.8125, 'binary_recall': 0.05, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.094202906}
confusion matrix:
      0   1
0  5943   3
1   247  13
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011748_14.png
early stop counter: 1
val acc:0.984204888343811, best validation acc: 0.9857524037361145, corresponding to test acc:                         0.9585884809494019 / 0.9660006165504456
after epoch: 14,now: 2024-06-03 02:02:36.680524,epoch time: 0:39:17.198262,used: 8:55:45.665105,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_17_06_50_seed_1_21011748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9916317, 'precision': 0.9476582, 'recall': 0.91729486, 'specificity': 0.91729486, 'f1': 0.93190336, 'auroc': 0.99652016, 'binary_precision': 0.90082026, 'binary_recall': 0.8377254, 'binary_specificity': 0.99686426, 'binary_f1_score': 0.8681279}
confusion matrix:
       0     1
0  42281   133
1    234  1208
---- Validation: 
scalar performance:
{'acc': 0.9853255, 'precision': 0.93268156, 'recall': 0.8421833, 'specificity': 0.8421833, 'f1': 0.881722, 'auroc': 0.97191155, 'binary_precision': 0.87689394, 'binary_recall': 0.6879643, 'binary_specificity': 0.99640226, 'binary_f1_score': 0.77102417}
confusion matrix:
       0    1
0  18002   65
1    210  463
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611666, 'precision': 0.8595747, 'recall': 0.5530894, 'specificity': 0.5530894, 'f1': 0.5843297, 'auroc': 0.9198935, 'binary_precision': 0.7567568, 'binary_recall': 0.10769231, 'binary_specificity': 0.9984864, 'binary_f1_score': 0.1885522}
confusion matrix:
      0   1
0  5937   9
1   232  28
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011748_15.png
early stop counter: 2
val acc:0.9853255152702332, best validation acc: 0.9857524037361145, corresponding to test acc:                         0.9585884809494019 / 0.9660006165504456
after epoch: 15,now: 2024-06-03 02:41:44.694569,epoch time: 0:39:08.014045,used: 9:34:53.679150,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_17_06_50_seed_1_21011748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9905372, 'precision': 0.9497993, 'recall': 0.895627, 'specificity': 0.895627, 'f1': 0.9208492, 'auroc': 0.99664366, 'binary_precision': 0.9065716, 'binary_recall': 0.7940361, 'binary_specificity': 0.9972179, 'binary_f1_score': 0.8465804}
confusion matrix:
       0     1
0  42296   118
1    297  1145
---- Validation: 
scalar performance:
{'acc': 0.9835112, 'precision': 0.9167448, 'recall': 0.8283676, 'specificity': 0.8283676, 'f1': 0.86688423, 'auroc': 0.97162014, 'binary_precision': 0.8460076, 'binary_recall': 0.6612184, 'binary_specificity': 0.9955167, 'binary_f1_score': 0.74228525}
confusion matrix:
       0    1
0  17986   81
1    228  445
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95762163, 'precision': 0.67948633, 'recall': 0.51078165, 'specificity': 0.51078165, 'f1': 0.5109835, 'auroc': 0.87253636, 'binary_precision': 0.4, 'binary_recall': 0.023076924, 'binary_specificity': 0.9984864, 'binary_f1_score': 0.043636363}
confusion matrix:
      0  1
0  5937  9
1   254  6
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011748_16.png
early stop counter: 3
val acc:0.983511209487915, best validation acc: 0.9857524037361145, corresponding to test acc:                         0.9585884809494019 / 0.9660006165504456
after epoch: 16,now: 2024-06-03 03:21:22.082490,epoch time: 0:39:37.387921,used: 10:14:31.067071,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_17_06_50_seed_1_21011748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9927262, 'precision': 0.93914604, 'recall': 0.9476714, 'specificity': 0.9476714, 'f1': 0.9433645, 'auroc': 0.9979242, 'binary_precision': 0.8817131, 'binary_recall': 0.89944524, 'binary_specificity': 0.9958976, 'binary_f1_score': 0.8904909}
confusion matrix:
       0     1
0  42240   174
1    145  1297
---- Validation: 
scalar performance:
{'acc': 0.9853255, 'precision': 0.9159231, 'recall': 0.8614955, 'specificity': 0.8614955, 'f1': 0.8866425, 'auroc': 0.97114867, 'binary_precision': 0.84192437, 'binary_recall': 0.7280832, 'binary_specificity': 0.99490786, 'binary_f1_score': 0.78087646}
confusion matrix:
       0    1
0  17975   92
1    183  490
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959233, 'precision': 0.78063524, 'recall': 0.53920734, 'specificity': 0.53920734, 'f1': 0.56074655, 'auroc': 0.8744814, 'binary_precision': 0.6, 'binary_recall': 0.08076923, 'binary_specificity': 0.9976455, 'binary_f1_score': 0.14237288}
confusion matrix:
      0   1
0  5932  14
1   239  21
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011748_17.png
early stop counter: 4
val acc:0.9853255152702332, best validation acc: 0.9857524037361145, corresponding to test acc:                         0.9585884809494019 / 0.9660006165504456
after epoch: 17,now: 2024-06-03 04:00:54.245158,epoch time: 0:39:32.162668,used: 10:54:03.229739,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_17_06_50_seed_1_21011748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9930226, 'precision': 0.970476, 'recall': 0.91667414, 'specificity': 0.91667414, 'f1': 0.94182557, 'auroc': 0.9980029, 'binary_precision': 0.9465409, 'binary_recall': 0.83495146, 'binary_specificity': 0.99839675, 'binary_f1_score': 0.88725126}
confusion matrix:
       0     1
0  42346    68
1    238  1204
---- Validation: 
scalar performance:
{'acc': 0.9846852, 'precision': 0.9381982, 'recall': 0.8261153, 'specificity': 0.8261153, 'f1': 0.8732935, 'auroc': 0.972222, 'binary_precision': 0.8891129, 'binary_recall': 0.65527487, 'binary_specificity': 0.99695575, 'binary_f1_score': 0.754491}
confusion matrix:
       0    1
0  18012   55
1    232  441
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9622946, 'precision': 0.9632856, 'recall': 0.551839, 'specificity': 0.551839, 'f1': 0.5840997, 'auroc': 0.94288856, 'binary_precision': 0.96428573, 'binary_recall': 0.103846155, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.1875}
confusion matrix:
      0   1
0  5945   1
1   233  27
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011748_18.png
early stop counter: 5
val acc:0.9846851825714111, best validation acc: 0.9857524037361145, corresponding to test acc:                         0.9585884809494019 / 0.9660006165504456
after epoch: 18,now: 2024-06-03 04:40:29.538981,epoch time: 0:39:35.293823,used: 11:33:38.523562,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_17_06_50_seed_1_21011748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9936383, 'precision': 0.9674263, 'recall': 0.9300555, 'specificity': 0.9300555, 'f1': 0.94790566, 'auroc': 0.9976352, 'binary_precision': 0.9395314, 'binary_recall': 0.86199725, 'binary_specificity': 0.9981138, 'binary_f1_score': 0.89909583}
confusion matrix:
       0     1
0  42334    80
1    199  1243
---- Validation: 
scalar performance:
{'acc': 0.9847919, 'precision': 0.92582566, 'recall': 0.84047604, 'specificity': 0.84047604, 'f1': 0.87801015, 'auroc': 0.9764979, 'binary_precision': 0.86329585, 'binary_recall': 0.68499255, 'binary_specificity': 0.99595946, 'binary_f1_score': 0.7638774}
confusion matrix:
       0    1
0  17994   73
1    212  461
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621334, 'precision': 0.9003583, 'recall': 0.5591108, 'specificity': 0.5591108, 'f1': 0.5946784, 'auroc': 0.9314817, 'binary_precision': 0.8378378, 'binary_recall': 0.11923077, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.20875423}
confusion matrix:
      0   1
0  5940   6
1   229  31
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011748_19.png
early stop counter: 6
val acc:0.9847918748855591, best validation acc: 0.9857524037361145, corresponding to test acc:                         0.9585884809494019 / 0.9660006165504456
after epoch: 19,now: 2024-06-03 05:20:09.018519,epoch time: 0:39:39.479538,used: 12:13:18.003100,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_17_06_50_seed_1_21011748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99336463, 'precision': 0.9644559, 'recall': 0.92857426, 'specificity': 0.92857426, 'f1': 0.94574106, 'auroc': 0.99848044, 'binary_precision': 0.933685, 'binary_recall': 0.8592233, 'binary_specificity': 0.9979252, 'binary_f1_score': 0.8949079}
confusion matrix:
       0     1
0  42326    88
1    203  1239
---- Validation: 
scalar performance:
{'acc': 0.98623264, 'precision': 0.93641704, 'recall': 0.8533828, 'specificity': 0.8533828, 'f1': 0.8901826, 'auroc': 0.9740596, 'binary_precision': 0.883549, 'binary_recall': 0.7102526, 'binary_specificity': 0.996513, 'binary_f1_score': 0.7874794}
confusion matrix:
       0    1
0  18004   63
1    195  478
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597164, 'precision': 0.7934439, 'recall': 0.5468156, 'specificity': 0.5468156, 'f1': 0.57301295, 'auroc': 0.914022, 'binary_precision': 0.625, 'binary_recall': 0.09615385, 'binary_specificity': 0.9974773, 'binary_f1_score': 0.16666667}
confusion matrix:
      0   1
0  5931  15
1   235  25
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011748_20.png
better model found
persisted
after epoch: 20,now: 2024-06-03 05:59:42.941540,epoch time: 0:39:33.923021,used: 12:52:51.926121,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_17_06_50_seed_1_21011748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9943907, 'precision': 0.95371926, 'recall': 0.9585805, 'specificity': 0.9585805, 'f1': 0.956136, 'auroc': 0.9984987, 'binary_precision': 0.9101509, 'binary_recall': 0.92024964, 'binary_specificity': 0.9969114, 'binary_f1_score': 0.9151724}
confusion matrix:
       0     1
0  42283   131
1    115  1327
---- Validation: 
scalar performance:
{'acc': 0.98655283, 'precision': 0.9147732, 'recall': 0.8850206, 'specificity': 0.8850206, 'f1': 0.89929557, 'auroc': 0.9763758, 'binary_precision': 0.8378812, 'binary_recall': 0.7756315, 'binary_specificity': 0.9944097, 'binary_f1_score': 0.80555546}
confusion matrix:
       0    1
0  17966  101
1    151  522
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959233, 'precision': 0.78063524, 'recall': 0.53920734, 'specificity': 0.53920734, 'f1': 0.56074655, 'auroc': 0.90364826, 'binary_precision': 0.6, 'binary_recall': 0.08076923, 'binary_specificity': 0.9976455, 'binary_f1_score': 0.14237288}
confusion matrix:
      0   1
0  5932  14
1   239  21
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011748_21.png
better model found
persisted
after epoch: 21,now: 2024-06-03 06:39:10.997530,epoch time: 0:39:28.055990,used: 13:32:19.982111,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_17_06_50_seed_1_21011748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99493796, 'precision': 0.96600354, 'recall': 0.9535042, 'specificity': 0.9535042, 'f1': 0.95966256, 'auroc': 0.99894637, 'binary_precision': 0.93509275, 'binary_recall': 0.90915394, 'binary_specificity': 0.9978545, 'binary_f1_score': 0.921941}
confusion matrix:
       0     1
0  42323    91
1    131  1311
---- Validation: 
scalar performance:
{'acc': 0.9857524, 'precision': 0.9247929, 'recall': 0.8581406, 'specificity': 0.8581406, 'f1': 0.8883942, 'auroc': 0.9696953, 'binary_precision': 0.8599291, 'binary_recall': 0.7206538, 'binary_specificity': 0.9956274, 'binary_f1_score': 0.78415525}
confusion matrix:
       0    1
0  17988   79
1    188  485
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611666, 'precision': 0.8182365, 'recall': 0.5696402, 'specificity': 0.5696402, 'f1': 0.6074992, 'auroc': 0.9254408, 'binary_precision': 0.6727273, 'binary_recall': 0.1423077, 'binary_specificity': 0.99697274, 'binary_f1_score': 0.23492064}
confusion matrix:
      0   1
0  5928  18
1   223  37
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011748_22.png
early stop counter: 1
val acc:0.9857524037361145, best validation acc: 0.9865528345108032, corresponding to test acc:                         0.9592329859733582 / 0.9660006165504456
after epoch: 22,now: 2024-06-03 07:18:40.327798,epoch time: 0:39:29.330268,used: 14:11:49.312379,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_17_06_50_seed_1_21011748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99475557, 'precision': 0.98405933, 'recall': 0.931973, 'specificity': 0.931973, 'f1': 0.9564295, 'auroc': 0.99886954, 'binary_precision': 0.9726989, 'binary_recall': 0.8647711, 'binary_specificity': 0.9991748, 'binary_f1_score': 0.9155654}
confusion matrix:
       0     1
0  42379    35
1    195  1247
---- Validation: 
scalar performance:
{'acc': 0.98612595, 'precision': 0.9396335, 'recall': 0.8483206, 'specificity': 0.8483206, 'f1': 0.88826346, 'auroc': 0.9805708, 'binary_precision': 0.89035916, 'binary_recall': 0.6998514, 'binary_specificity': 0.99678975, 'binary_f1_score': 0.78369385}
confusion matrix:
       0    1
0  18009   58
1    202  471
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959233, 'precision': 0.8888326, 'recall': 0.5171395, 'specificity': 0.5171395, 'f1': 0.5227911, 'auroc': 0.8878113, 'binary_precision': 0.8181818, 'binary_recall': 0.034615386, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.06642067}
confusion matrix:
      0  1
0  5944  2
1   251  9
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011748_23.png
early stop counter: 2
val acc:0.9861259460449219, best validation acc: 0.9865528345108032, corresponding to test acc:                         0.9592329859733582 / 0.9660006165504456
after epoch: 23,now: 2024-06-03 07:58:15.868932,epoch time: 0:39:35.541134,used: 14:51:24.853513,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_17_06_50_seed_1_21011748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99528, 'precision': 0.96021926, 'recall': 0.9660743, 'specificity': 0.9660743, 'f1': 0.9631268, 'auroc': 0.9992231, 'binary_precision': 0.9226557, 'binary_recall': 0.9348128, 'binary_specificity': 0.9973358, 'binary_f1_score': 0.9286944}
confusion matrix:
       0     1
0  42301   113
1     94  1348
---- Validation: 
scalar performance:
{'acc': 0.98623264, 'precision': 0.9133046, 'recall': 0.8812782, 'specificity': 0.8812782, 'f1': 0.89659, 'auroc': 0.97561973, 'binary_precision': 0.8352181, 'binary_recall': 0.76820207, 'binary_specificity': 0.99435437, 'binary_f1_score': 0.80030954}
confusion matrix:
       0    1
0  17965  102
1    156  517
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9626168, 'precision': 0.877808, 'recall': 0.572236, 'specificity': 0.572236, 'f1': 0.613793, 'auroc': 0.90259576, 'binary_precision': 0.7916667, 'binary_recall': 0.14615385, 'binary_specificity': 0.9983182, 'binary_f1_score': 0.24675325}
confusion matrix:
      0   1
0  5936  10
1   222  38
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011748_24.png
early stop counter: 3
val acc:0.9862326383590698, best validation acc: 0.9865528345108032, corresponding to test acc:                         0.9592329859733582 / 0.9660006165504456
after epoch: 24,now: 2024-06-03 08:37:51.819601,epoch time: 0:39:35.950669,used: 15:31:00.804182,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_17_06_50_seed_1_21011748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9965797, 'precision': 0.9792663, 'recall': 0.96641123, 'specificity': 0.96641123, 'f1': 0.97274494, 'auroc': 0.9989075, 'binary_precision': 0.9607703, 'binary_recall': 0.9341193, 'binary_specificity': 0.99870324, 'binary_f1_score': 0.94725734}
confusion matrix:
       0     1
0  42359    55
1     95  1347
---- Validation: 
scalar performance:
{'acc': 0.9877268, 'precision': 0.940704, 'recall': 0.8734699, 'specificity': 0.8734699, 'f1': 0.9040848, 'auroc': 0.96972644, 'binary_precision': 0.89065254, 'binary_recall': 0.75037146, 'binary_specificity': 0.9965683, 'binary_f1_score': 0.8145161}
confusion matrix:
       0    1
0  18005   62
1    168  505
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9585885, 'precision': 0.75190175, 'recall': 0.535193, 'specificity': 0.535193, 'f1': 0.55380183, 'auroc': 0.89911216, 'binary_precision': 0.54285717, 'binary_recall': 0.073076926, 'binary_specificity': 0.9973091, 'binary_f1_score': 0.12881356}
confusion matrix:
      0   1
0  5930  16
1   241  19
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011748_25.png
better model found
persisted
after epoch: 25,now: 2024-06-03 09:17:25.829046,epoch time: 0:39:34.009445,used: 16:10:34.813627,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_17_06_50_seed_1_21011748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99569046, 'precision': 0.9753401, 'recall': 0.9558729, 'specificity': 0.9558729, 'f1': 0.96538806, 'auroc': 0.9992032, 'binary_precision': 0.9536232, 'binary_recall': 0.9132547, 'binary_specificity': 0.9984911, 'binary_f1_score': 0.9330025}
confusion matrix:
       0     1
0  42351    64
1    125  1316
---- Validation: 
scalar performance:
{'acc': 0.9866062, 'precision': 0.9289812, 'recall': 0.8678819, 'specificity': 0.8678819, 'f1': 0.89589477, 'auroc': 0.971577, 'binary_precision': 0.8675958, 'binary_recall': 0.73997027, 'binary_specificity': 0.99579346, 'binary_f1_score': 0.79871684}
confusion matrix:
       0    1
0  17991   76
1    175  498
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590719, 'precision': 0.7682817, 'recall': 0.54280126, 'specificity': 0.54280126, 'f1': 0.5661812, 'auroc': 0.8768117, 'binary_precision': 0.575, 'binary_recall': 0.08846154, 'binary_specificity': 0.99714094, 'binary_f1_score': 0.15333335}
confusion matrix:
      0   1
0  5929  17
1   237  23
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011748_26.png
early stop counter: 1
val acc:0.9866061806678772, best validation acc: 0.9877268075942993, corresponding to test acc:                         0.9585884809494019 / 0.9660006165504456
after epoch: 26,now: 2024-06-03 09:56:44.314442,epoch time: 0:39:18.485396,used: 16:49:53.299023,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_17_06_50_seed_1_21011748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9960325, 'precision': 0.9852862, 'recall': 0.95139045, 'specificity': 0.95139045, 'f1': 0.9676807, 'auroc': 0.99890834, 'binary_precision': 0.97384155, 'binary_recall': 0.9036061, 'binary_specificity': 0.9991748, 'binary_f1_score': 0.9374101}
confusion matrix:
       0     1
0  42379    35
1    139  1303
---- Validation: 
scalar performance:
{'acc': 0.98719317, 'precision': 0.95794404, 'recall': 0.8481588, 'specificity': 0.8481588, 'f1': 0.89499927, 'auroc': 0.9673172, 'binary_precision': 0.9270217, 'binary_recall': 0.6983655, 'binary_specificity': 0.99795204, 'binary_f1_score': 0.7966101}
confusion matrix:
       0    1
0  18030   37
1    203  470
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9577828, 'precision': 0.7145337, 'recall': 0.52741665, 'specificity': 0.52741665, 'f1': 0.54056126, 'auroc': 0.8777876, 'binary_precision': 0.46875, 'binary_recall': 0.057692308, 'binary_specificity': 0.99714094, 'binary_f1_score': 0.10273973}
confusion matrix:
      0   1
0  5929  17
1   245  15
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011748_27.png
early stop counter: 2
val acc:0.9871931672096252, best validation acc: 0.9877268075942993, corresponding to test acc:                         0.9585884809494019 / 0.9660006165504456
after epoch: 27,now: 2024-06-03 10:36:22.183604,epoch time: 0:39:37.869162,used: 17:29:31.168185,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_17_06_50_seed_1_21011748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9950292, 'precision': 0.9758203, 'recall': 0.94450766, 'specificity': 0.94450766, 'f1': 0.95959234, 'auroc': 0.9988222, 'binary_precision': 0.95535713, 'binary_recall': 0.89043, 'binary_specificity': 0.99858534, 'binary_f1_score': 0.9217516}
confusion matrix:
       0     1
0  42354    60
1    158  1284
---- Validation: 
scalar performance:
{'acc': 0.9868196, 'precision': 0.94931924, 'recall': 0.8501109, 'specificity': 0.8501109, 'f1': 0.89307606, 'auroc': 0.97515506, 'binary_precision': 0.9096154, 'binary_recall': 0.70282316, 'binary_specificity': 0.99739856, 'binary_f1_score': 0.792959}
confusion matrix:
       0    1
0  18020   47
1    200  473
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959233, 'precision': 0.84655684, 'recall': 0.5208175, 'specificity': 0.5208175, 'f1': 0.5295773, 'auroc': 0.9237524, 'binary_precision': 0.73333335, 'binary_recall': 0.042307694, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.080000006}
confusion matrix:
      0   1
0  5942   4
1   249  11
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011748_28.png
early stop counter: 3
val acc:0.9868196249008179, best validation acc: 0.9877268075942993, corresponding to test acc:                         0.9585884809494019 / 0.9660006165504456
after epoch: 28,now: 2024-06-03 11:15:49.792657,epoch time: 0:39:27.609053,used: 18:08:58.777238,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_17_06_50_seed_1_21011748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99464154, 'precision': 0.9821696, 'recall': 0.93191403, 'specificity': 0.93191403, 'f1': 0.9555613, 'auroc': 0.9991603, 'binary_precision': 0.96892, 'binary_recall': 0.8647711, 'binary_specificity': 0.99905694, 'binary_f1_score': 0.91388786}
confusion matrix:
       0     1
0  42374    40
1    195  1247
---- Validation: 
scalar performance:
{'acc': 0.983191, 'precision': 0.9325571, 'recall': 0.8067435, 'specificity': 0.8067435, 'f1': 0.85811067, 'auroc': 0.9738822, 'binary_precision': 0.8792373, 'binary_recall': 0.6166419, 'binary_specificity': 0.99684507, 'binary_f1_score': 0.72489077}
confusion matrix:
       0    1
0  18010   57
1    258  415
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9585885, 'precision': 0.7468797, 'recall': 0.5462269, 'specificity': 0.5462269, 'f1': 0.5708178, 'auroc': 0.89949673, 'binary_precision': 0.5319149, 'binary_recall': 0.09615385, 'binary_specificity': 0.99630004, 'binary_f1_score': 0.16286644}
confusion matrix:
      0   1
0  5924  22
1   235  25
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011748_29.png
early stop counter: 4
val acc:0.9831910133361816, best validation acc: 0.9877268075942993, corresponding to test acc:                         0.9585884809494019 / 0.9660006165504456
after epoch: 29,now: 2024-06-03 11:55:33.840187,epoch time: 0:39:44.047530,used: 18:48:42.824768,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_17_06_50_seed_1_21011748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99201936, 'precision': 0.91183615, 'recall': 0.9771167, 'specificity': 0.9771167, 'f1': 0.94187737, 'auroc': 0.99887276, 'binary_precision': 0.825, 'binary_recall': 0.9611651, 'binary_specificity': 0.99306834, 'binary_f1_score': 0.8878924}
confusion matrix:
       0     1
0  42120   294
1     56  1386
---- Validation: 
scalar performance:
{'acc': 0.98399144, 'precision': 0.8742055, 'recall': 0.90515023, 'specificity': 0.90515023, 'f1': 0.88900447, 'auroc': 0.9764762, 'binary_precision': 0.75512993, 'binary_recall': 0.820208, 'binary_specificity': 0.99009246, 'binary_f1_score': 0.7863248}
confusion matrix:
       0    1
0  17888  179
1    121  552
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96003866, 'precision': 0.80602497, 'recall': 0.54882276, 'specificity': 0.54882276, 'f1': 0.5764289, 'auroc': 0.9266533, 'binary_precision': 0.65, 'binary_recall': 0.1, 'binary_specificity': 0.9976455, 'binary_f1_score': 0.17333333}
confusion matrix:
      0   1
0  5932  14
1   234  26
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011748_30.png
early stop counter: 5
val acc:0.9839914441108704, best validation acc: 0.9877268075942993, corresponding to test acc:                         0.9585884809494019 / 0.9660006165504456
after epoch: 30,now: 2024-06-03 12:35:32.917410,epoch time: 0:39:59.077223,used: 19:28:41.901991,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_17_06_50_seed_1_21011748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 19:28:41.901991 at 2024-06-03 12:35:32.917410
persisted model performance metric: 

scalar performance:
{'acc': 0.96036094, 'precision': 0.85565716, 'recall': 0.539796, 'specificity': 0.539796, 'f1': 0.5627715, 'auroc': 0.88283944, 'binary_precision': 0.75, 'binary_recall': 0.08076923, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.14583333}
confusion matrix:
      0   1
0  5939   7
1   239  21
oracle model performance metric: 

scalar performance:
{'acc': 0.9661618, 'precision': 0.8649056, 'recall': 0.6384505, 'specificity': 0.6384505, 'f1': 0.6963468, 'auroc': 0.94699085, 'binary_precision': 0.7604167, 'binary_recall': 0.28076923, 'binary_specificity': 0.99613184, 'binary_f1_score': 0.41011238}
confusion matrix:
      0   1
0  5923  23
1   187  73
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/rule_results/7.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/confusion_matrix/7.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1664 MiB |  15807 MiB |   1984 TiB |   1984 TiB |
|       from large pool |   1657 MiB |  15782 MiB |   1958 TiB |   1958 TiB |
|       from small pool |      6 MiB |     26 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1664 MiB |  15807 MiB |   1984 TiB |   1984 TiB |
|       from large pool |   1657 MiB |  15782 MiB |   1958 TiB |   1958 TiB |
|       from small pool |      6 MiB |     26 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1653 MiB |  15770 MiB |   1979 TiB |   1979 TiB |
|       from large pool |   1647 MiB |  15745 MiB |   1953 TiB |   1953 TiB |
|       from small pool |      5 MiB |     25 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  16758 MiB |  16758 MiB |  31406 MiB |  14648 MiB |
|       from large pool |  16730 MiB |  16730 MiB |  31376 MiB |  14646 MiB |
|       from small pool |     28 MiB |     28 MiB |     30 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 397178 KiB |    905 MiB |    809 TiB |    809 TiB |
|       from large pool | 377232 KiB |    904 MiB |    784 TiB |    784 TiB |
|       from small pool |  19946 KiB |     25 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3342    |    6365    |  304912 K  |  304908 K  |
|       from large pool |     247    |     989    |  124920 K  |  124920 K  |
|       from small pool |    3095    |    6116    |  179991 K  |  179988 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3342    |    6365    |  304912 K  |  304908 K  |
|       from large pool |     247    |     989    |  124920 K  |  124920 K  |
|       from small pool |    3095    |    6116    |  179991 K  |  179988 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     621    |     621    |    1127    |     506    |
|       from large pool |     607    |     607    |    1112    |     505    |
|       from small pool |      14    |      14    |      15    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     140    |    2873    |  179612 K  |  179612 K  |
|       from large pool |     107    |     516    |   93731 K  |   93731 K  |
|       from small pool |      33    |    2766    |   85881 K  |   85881 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15807 MiB |   1984 TiB |   1984 TiB |
|       from large pool |  16640 KiB |  15782 MiB |   1958 TiB |   1958 TiB |
|       from small pool |      0 KiB |     26 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15807 MiB |   1984 TiB |   1984 TiB |
|       from large pool |  16640 KiB |  15782 MiB |   1958 TiB |   1958 TiB |
|       from small pool |      0 KiB |     26 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15770 MiB |   1979 TiB |   1979 TiB |
|       from large pool |  16640 KiB |  15745 MiB |   1953 TiB |   1953 TiB |
|       from small pool |      0 KiB |     25 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2052 MiB |  16758 MiB |  31406 MiB |  29354 MiB |
|       from large pool |   2026 MiB |  16730 MiB |  31376 MiB |  29350 MiB |
|       from small pool |     26 MiB |     28 MiB |     30 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    905 MiB |    809 TiB |    809 TiB |
|       from large pool |  24320 KiB |    904 MiB |    784 TiB |    784 TiB |
|       from small pool |      0 KiB |     25 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6365    |  304912 K  |  304912 K  |
|       from large pool |       2    |     989    |  124920 K  |  124920 K  |
|       from small pool |       0    |    6116    |  179991 K  |  179991 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6365    |  304912 K  |  304912 K  |
|       from large pool |       2    |     989    |  124920 K  |  124920 K  |
|       from small pool |       0    |    6116    |  179991 K  |  179991 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     113    |     621    |    1127    |    1014    |
|       from large pool |     100    |     607    |    1112    |    1012    |
|       from small pool |      13    |      14    |      15    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    2873    |  179614 K  |  179614 K  |
|       from large pool |       2    |     516    |   93731 K  |   93731 K  |
|       from small pool |       0    |    2766    |   85882 K  |   85882 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15807 MiB |   1984 TiB |   1984 TiB |
|       from large pool |  16640 KiB |  15782 MiB |   1958 TiB |   1958 TiB |
|       from small pool |      0 KiB |     26 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15807 MiB |   1984 TiB |   1984 TiB |
|       from large pool |  16640 KiB |  15782 MiB |   1958 TiB |   1958 TiB |
|       from small pool |      0 KiB |     26 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15770 MiB |   1979 TiB |   1979 TiB |
|       from large pool |  16640 KiB |  15745 MiB |   1953 TiB |   1953 TiB |
|       from small pool |      0 KiB |     25 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2052 MiB |  16758 MiB |  31406 MiB |  29354 MiB |
|       from large pool |   2026 MiB |  16730 MiB |  31376 MiB |  29350 MiB |
|       from small pool |     26 MiB |     28 MiB |     30 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    905 MiB |    809 TiB |    809 TiB |
|       from large pool |  24320 KiB |    904 MiB |    784 TiB |    784 TiB |
|       from small pool |      0 KiB |     25 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6365    |  304912 K  |  304912 K  |
|       from large pool |       2    |     989    |  124920 K  |  124920 K  |
|       from small pool |       0    |    6116    |  179991 K  |  179991 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6365    |  304912 K  |  304912 K  |
|       from large pool |       2    |     989    |  124920 K  |  124920 K  |
|       from small pool |       0    |    6116    |  179991 K  |  179991 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     113    |     621    |    1127    |    1014    |
|       from large pool |     100    |     607    |    1112    |    1012    |
|       from small pool |      13    |      14    |      15    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    2873    |  179614 K  |  179614 K  |
|       from large pool |       2    |     516    |   93731 K  |   93731 K  |
|       from small pool |       0    |    2766    |   85882 K  |   85882 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_12_42_32_seed_2_21011748

 Experiment start at: 2024-06-03 12:42:32.132450
before training, model accuracy: 0.1784917414188385
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9977587, 'precision': 0.9987622, 'recall': 0.9884336, 'specificity': 0.9884336, 'f1': 0.99352944, 'auroc': 0.9997625, 'binary_precision': 1.0, 'binary_recall': 0.97686714, 'binary_specificity': 1.0, 'binary_f1_score': 0.9882982}
confusion matrix:
       0     1
0  42309     0
1    105  4434
---- Validation: 
scalar performance:
{'acc': 0.96697384, 'precision': 0.48395094, 'recall': 0.49950472, 'specificity': 0.49950472, 'f1': 0.49160483, 'auroc': 0.8872332, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99900943, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18153  18
1    602   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99657893, 'precision': 0.9980897, 'recall': 0.98415977, 'specificity': 0.98415977, 'f1': 0.99099547, 'auroc': 0.99986064, 'binary_precision': 1.0, 'binary_recall': 0.96831954, 'binary_specificity': 1.0, 'binary_f1_score': 0.98390484}
confusion matrix:
      0    1
0  5997    0
1    23  703
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011748_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-03 13:19:33.338821,epoch time: 0:37:01.206371,used: 0:37:01.206371,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_12_42_32_seed_2_21011748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.99647796, 'precision': 0.9980576, 'recall': 0.98182416, 'specificity': 0.98182416, 'f1': 0.9897708, 'auroc': 0.9995944, 'binary_precision': 1.0, 'binary_recall': 0.9636484, 'binary_specificity': 1.0, 'binary_f1_score': 0.98148775}
confusion matrix:
       0     1
0  42309     0
1    165  4374
---- Validation: 
scalar performance:
{'acc': 0.9676663, 'precision': 0.48396206, 'recall': 0.49986243, 'specificity': 0.49986243, 'f1': 0.49178377, 'auroc': 0.87442636, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99972486, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18166  5
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99702513, 'precision': 0.99833804, 'recall': 0.9862259, 'specificity': 0.9862259, 'f1': 0.9921844, 'auroc': 0.99992144, 'binary_precision': 1.0, 'binary_recall': 0.9724518, 'binary_specificity': 1.0, 'binary_f1_score': 0.9860335}
confusion matrix:
      0    1
0  5997    0
1    20  706
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011748_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-03 13:55:30.430418,epoch time: 0:35:57.091597,used: 1:12:58.297968,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_12_42_32_seed_2_21011748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.99833506, 'precision': 0.9989796, 'recall': 0.9915061, 'specificity': 0.9915061, 'f1': 0.9952072, 'auroc': 0.99972343, 'binary_precision': 0.99977595, 'binary_recall': 0.9830359, 'binary_specificity': 0.99997634, 'binary_f1_score': 0.9913353}
confusion matrix:
       0     1
0  42308     1
1     77  4462
---- Validation: 
scalar performance:
{'acc': 0.9680925, 'precision': 0.8412365, 'recall': 0.50409776, 'specificity': 0.50409776, 'f1': 0.50010175, 'auroc': 0.899741, 'binary_precision': 0.71428573, 'binary_recall': 0.008305647, 'binary_specificity': 0.9998899, 'binary_f1_score': 0.016420359}
confusion matrix:
       0  1
0  18169  2
1    597  5
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9973226, 'precision': 0.99850374, 'recall': 0.9876033, 'specificity': 0.9876033, 'f1': 0.9929746, 'auroc': 0.9993015, 'binary_precision': 1.0, 'binary_recall': 0.9752066, 'binary_specificity': 1.0, 'binary_f1_score': 0.9874477}
confusion matrix:
      0    1
0  5997    0
1    18  708
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011748_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-03 14:31:35.039460,epoch time: 0:36:04.609042,used: 1:49:02.907010,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_12_42_32_seed_2_21011748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9990181, 'precision': 0.9984669, 'recall': 0.9959162, 'specificity': 0.9959162, 'f1': 0.9971874, 'auroc': 0.99980485, 'binary_precision': 0.9977842, 'binary_recall': 0.9920687, 'binary_specificity': 0.99976367, 'binary_f1_score': 0.9949182}
confusion matrix:
       0     1
0  42299    10
1     36  4503
---- Validation: 
scalar performance:
{'acc': 0.9665477, 'precision': 0.70594007, 'recall': 0.5747711, 'specificity': 0.5747711, 'f1': 0.6066472, 'auroc': 0.9230454, 'binary_precision': 0.43925235, 'binary_recall': 0.15614618, 'binary_specificity': 0.99339604, 'binary_f1_score': 0.23039216}
confusion matrix:
       0    1
0  18051  120
1    508   94
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99881005, 'precision': 0.99933386, 'recall': 0.9944904, 'specificity': 0.9944904, 'f1': 0.9968966, 'auroc': 0.9999182, 'binary_precision': 1.0, 'binary_recall': 0.9889807, 'binary_specificity': 1.0, 'binary_f1_score': 0.9944598}
confusion matrix:
      0    1
0  5997    0
1     8  718
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011748_4.png
new oracle model saved
early stop counter: 1
val acc:0.9665477275848389, best validation acc: 0.9680925011634827, corresponding to test acc:                         0.9973226189613342 / 0.9988100528717041
after epoch: 4,now: 2024-06-03 15:07:36.758938,epoch time: 0:36:01.719478,used: 2:25:04.626488,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_12_42_32_seed_2_21011748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9984204, 'precision': 0.99763495, 'recall': 0.9933235, 'specificity': 0.9933235, 'f1': 0.9954673, 'auroc': 0.99958146, 'binary_precision': 0.996663, 'binary_recall': 0.98700154, 'binary_specificity': 0.9996455, 'binary_f1_score': 0.9918088}
confusion matrix:
       0     1
0  42294    15
1     59  4480
---- Validation: 
scalar performance:
{'acc': 0.9712353, 'precision': 0.81407857, 'recall': 0.6077084, 'specificity': 0.6077084, 'f1': 0.65683055, 'auroc': 0.9413959, 'binary_precision': 0.65346533, 'binary_recall': 0.2192691, 'binary_specificity': 0.9961477, 'binary_f1_score': 0.3283582}
confusion matrix:
       0    1
0  18101   70
1    470  132
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99806637, 'precision': 0.998302, 'recall': 0.99165213, 'specificity': 0.99165213, 'f1': 0.9949478, 'auroc': 0.9999026, 'binary_precision': 0.9986014, 'binary_recall': 0.9834711, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.9909785}
confusion matrix:
      0    1
0  5996    1
1    12  714
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011748_5.png
better model found
persisted
after epoch: 5,now: 2024-06-03 15:43:40.679026,epoch time: 0:36:03.920088,used: 3:01:08.546576,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_12_42_32_seed_2_21011748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9990181, 'precision': 0.999457, 'recall': 0.9949328, 'specificity': 0.9949328, 'f1': 0.99718183, 'auroc': 0.9999043, 'binary_precision': 1.0, 'binary_recall': 0.9898656, 'binary_specificity': 1.0, 'binary_f1_score': 0.994907}
confusion matrix:
       0     1
0  42309     0
1     46  4493
---- Validation: 
scalar performance:
{'acc': 0.96777284, 'precision': 0.48396376, 'recall': 0.49991745, 'specificity': 0.49991745, 'f1': 0.49181125, 'auroc': 0.94024587, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998349, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18168  3
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99806637, 'precision': 0.9989185, 'recall': 0.99104685, 'specificity': 0.99104685, 'f1': 0.9949416, 'auroc': 0.9985987, 'binary_precision': 1.0, 'binary_recall': 0.9820937, 'binary_specificity': 1.0, 'binary_f1_score': 0.99096596}
confusion matrix:
      0    1
0  5997    0
1    13  713
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011748_6.png
early stop counter: 1
val acc:0.9677728414535522, best validation acc: 0.9712352752685547, corresponding to test acc:                         0.9980663657188416 / 0.9988100528717041
after epoch: 6,now: 2024-06-03 16:19:47.572711,epoch time: 0:36:06.893685,used: 3:37:15.440261,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_12_42_32_seed_2_21011748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9966487, 'precision': 0.99815154, 'recall': 0.98270166, 'specificity': 0.98270166, 'f1': 0.9902726, 'auroc': 0.9996966, 'binary_precision': 1.0, 'binary_recall': 0.96540326, 'binary_specificity': 1.0, 'binary_f1_score': 0.9823971}
confusion matrix:
       0     1
0  42310     0
1    157  4381
---- Validation: 
scalar performance:
{'acc': 0.9692644, 'precision': 0.83429456, 'recall': 0.536022, 'specificity': 0.536022, 'f1': 0.55834293, 'auroc': 0.9512853, 'binary_precision': 0.6984127, 'binary_recall': 0.073089704, 'binary_specificity': 0.99895436, 'binary_f1_score': 0.13233082}
confusion matrix:
       0   1
0  18152  19
1    558  44
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99657893, 'precision': 0.9980897, 'recall': 0.98415977, 'specificity': 0.98415977, 'f1': 0.99099547, 'auroc': 0.99992424, 'binary_precision': 1.0, 'binary_recall': 0.96831954, 'binary_specificity': 1.0, 'binary_f1_score': 0.98390484}
confusion matrix:
      0    1
0  5997    0
1    23  703
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011748_7.png
early stop counter: 2
val acc:0.9692643880844116, best validation acc: 0.9712352752685547, corresponding to test acc:                         0.9980663657188416 / 0.9988100528717041
after epoch: 7,now: 2024-06-03 16:55:37.371299,epoch time: 0:35:49.798588,used: 4:13:05.238849,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_12_42_32_seed_2_21011748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9986766, 'precision': 0.99926835, 'recall': 0.99317026, 'specificity': 0.99317026, 'f1': 0.99619555, 'auroc': 0.9997196, 'binary_precision': 1.0, 'binary_recall': 0.9863406, 'binary_specificity': 1.0, 'binary_f1_score': 0.99312335}
confusion matrix:
       0     1
0  42309     0
1     62  4477
---- Validation: 
scalar performance:
{'acc': 0.9683588, 'precision': 0.75949, 'recall': 0.5363573, 'specificity': 0.5363573, 'f1': 0.5577324, 'auroc': 0.94736886, 'binary_precision': 0.5487805, 'binary_recall': 0.07475083, 'binary_specificity': 0.9979638, 'binary_f1_score': 0.13157895}
confusion matrix:
       0   1
0  18134  37
1    557  45
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9979176, 'precision': 0.99883544, 'recall': 0.9903581, 'specificity': 0.9903581, 'f1': 0.99454916, 'auroc': 0.9996697, 'binary_precision': 1.0, 'binary_recall': 0.9807162, 'binary_specificity': 1.0, 'binary_f1_score': 0.99026424}
confusion matrix:
      0    1
0  5997    0
1    14  712
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011748_8.png
early stop counter: 3
val acc:0.9683588147163391, best validation acc: 0.9712352752685547, corresponding to test acc:                         0.9980663657188416 / 0.9988100528717041
after epoch: 8,now: 2024-06-03 18:31:52.003076,epoch time: 1:36:14.631777,used: 5:49:19.870626,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_12_42_32_seed_2_21011748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9984204, 'precision': 0.99912703, 'recall': 0.99184847, 'specificity': 0.99184847, 'f1': 0.99545383, 'auroc': 0.9996611, 'binary_precision': 1.0, 'binary_recall': 0.9836969, 'binary_specificity': 1.0, 'binary_f1_score': 0.9917814}
confusion matrix:
       0     1
0  42309     0
1     74  4465
---- Validation: 
scalar performance:
{'acc': 0.9688382, 'precision': 0.87167686, 'recall': 0.51974094, 'specificity': 0.51974094, 'f1': 0.5299907, 'auroc': 0.94310105, 'binary_precision': 0.7741935, 'binary_recall': 0.03986711, 'binary_specificity': 0.9996148, 'binary_f1_score': 0.07582939}
confusion matrix:
       0   1
0  18164   7
1    578  24
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9976201, 'precision': 0.9986695, 'recall': 0.9889807, 'specificity': 0.9889807, 'f1': 0.99376285, 'auroc': 0.9996047, 'binary_precision': 1.0, 'binary_recall': 0.9779614, 'binary_specificity': 1.0, 'binary_f1_score': 0.9888579}
confusion matrix:
      0    1
0  5997    0
1    16  710
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011748_9.png
early stop counter: 4
val acc:0.9688382148742676, best validation acc: 0.9712352752685547, corresponding to test acc:                         0.9980663657188416 / 0.9988100528717041
after epoch: 9,now: 2024-06-03 19:09:37.561293,epoch time: 0:37:45.558217,used: 6:27:05.428843,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_12_42_32_seed_2_21011748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9990395, 'precision': 0.99926996, 'recall': 0.9952396, 'specificity': 0.9952396, 'f1': 0.9972445, 'auroc': 0.9999409, 'binary_precision': 0.99955535, 'binary_recall': 0.99052656, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.9950205}
confusion matrix:
       0     1
0  42307     2
1     43  4496
---- Validation: 
scalar performance:
{'acc': 0.96745324, 'precision': 0.52943814, 'recall': 0.5005554, 'specificity': 0.5005554, 'f1': 0.4933596, 'auroc': 0.9336281, 'binary_precision': 0.09090909, 'binary_recall': 0.0016611295, 'binary_specificity': 0.9994497, 'binary_f1_score': 0.0032626425}
confusion matrix:
       0   1
0  18161  10
1    601   1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99836385, 'precision': 0.9990846, 'recall': 0.99242425, 'specificity': 0.99242425, 'f1': 0.99572504, 'auroc': 0.9999736, 'binary_precision': 1.0, 'binary_recall': 0.9848485, 'binary_specificity': 1.0, 'binary_f1_score': 0.99236643}
confusion matrix:
      0    1
0  5997    0
1    11  715
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011748_10.png
early stop counter: 5
val acc:0.9674532413482666, best validation acc: 0.9712352752685547, corresponding to test acc:                         0.9980663657188416 / 0.9988100528717041
after epoch: 10,now: 2024-06-03 19:46:48.644938,epoch time: 0:37:11.083645,used: 7:04:16.512488,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_12_42_32_seed_2_21011748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9978014, 'precision': 0.9907454, 'recall': 0.996816, 'specificity': 0.996816, 'f1': 0.99375695, 'auroc': 0.99977756, 'binary_precision': 0.98196435, 'binary_recall': 0.9955937, 'binary_specificity': 0.99803823, 'binary_f1_score': 0.98873204}
confusion matrix:
       0     1
0  42226    83
1     20  4519
---- Validation: 
scalar performance:
{'acc': 0.96500295, 'precision': 0.6870879, 'recall': 0.58762497, 'specificity': 0.58762497, 'f1': 0.6173209, 'auroc': 0.9307298, 'binary_precision': 0.40072203, 'binary_recall': 0.18438539, 'binary_specificity': 0.9908646, 'binary_f1_score': 0.25255972}
confusion matrix:
       0    1
0  18005  166
1    491  111
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9979176, 'precision': 0.9945954, 'recall': 0.9945954, 'specificity': 0.9945954, 'f1': 0.9945954, 'auroc': 0.9997021, 'binary_precision': 0.9903581, 'binary_recall': 0.9903581, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.9903581}
confusion matrix:
      0    1
0  5990    7
1     7  719
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011748_11.png
early stop counter: 6
val acc:0.9650029540061951, best validation acc: 0.9712352752685547, corresponding to test acc:                         0.9980663657188416 / 0.9988100528717041
after epoch: 11,now: 2024-06-03 20:22:32.329225,epoch time: 0:35:43.684287,used: 7:40:00.196775,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_12_42_32_seed_2_21011748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99895406, 'precision': 0.9994216, 'recall': 0.9946023, 'specificity': 0.9946023, 'f1': 0.9969971, 'auroc': 0.9997983, 'binary_precision': 1.0, 'binary_recall': 0.98920465, 'binary_specificity': 1.0, 'binary_f1_score': 0.99457306}
confusion matrix:
       0     1
0  42309     0
1     49  4490
---- Validation: 
scalar performance:
{'acc': 0.9686251, 'precision': 0.80387604, 'recall': 0.52444917, 'specificity': 0.52444917, 'f1': 0.53824323, 'auroc': 0.9269891, 'binary_precision': 0.63829786, 'binary_recall': 0.049833886, 'binary_specificity': 0.99906445, 'binary_f1_score': 0.092449926}
confusion matrix:
       0   1
0  18154  17
1    572  30
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99836385, 'precision': 0.9990846, 'recall': 0.99242425, 'specificity': 0.99242425, 'f1': 0.99572504, 'auroc': 0.99993914, 'binary_precision': 1.0, 'binary_recall': 0.9848485, 'binary_specificity': 1.0, 'binary_f1_score': 0.99236643}
confusion matrix:
      0    1
0  5997    0
1    11  715
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011748_12.png
early stop counter: 7
val acc:0.9686251282691956, best validation acc: 0.9712352752685547, corresponding to test acc:                         0.9980663657188416 / 0.9988100528717041
after epoch: 12,now: 2024-06-03 20:59:21.653405,epoch time: 0:36:49.324180,used: 8:16:49.520955,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_12_42_32_seed_2_21011748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
slurmstepd: error: *** JOB 21011748 ON gpusrv27 CANCELLED AT 2024-06-03T21:23:15 DUE TO TIME LIMIT ***
