Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jun  1 20:27:27 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/rule_results/3.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=3
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_20_37_51_seed_0_21011746

 Experiment start at: 2024-06-01 20:37:51.915294
before training, model accuracy: 0.6388623118400574
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9674598, 'precision': 0.7498007, 'recall': 0.7867763, 'specificity': 0.7867763, 'f1': 0.7668668, 'auroc': 0.9574343, 'binary_precision': 0.5138317, 'binary_recall': 0.5930706, 'binary_specificity': 0.98048204, 'binary_f1_score': 0.5506149}
confusion matrix:
       0    1
0  41494  826
1    599  873
---- Validation: 
scalar performance:
{'acc': 0.9673265, 'precision': 0.77121615, 'recall': 0.5885554, 'specificity': 0.5885554, 'f1': 0.6296147, 'auroc': 0.95404994, 'binary_precision': 0.5707317, 'binary_recall': 0.18195957, 'binary_specificity': 0.9951512, 'binary_f1_score': 0.2759434}
confusion matrix:
       0    1
0  18061   88
1    526  117
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97635025, 'precision': 0.9241573, 'recall': 0.75312173, 'specificity': 0.75312173, 'f1': 0.8151413, 'auroc': 0.9430012, 'binary_precision': 0.86928105, 'binary_recall': 0.5095785, 'binary_specificity': 0.996665, 'binary_f1_score': 0.6425121}
confusion matrix:
      0    1
0  5977   20
1   128  133
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011746_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-01 21:07:29.927602,epoch time: 0:29:38.012308,used: 0:29:38.012308,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_20_37_51_seed_0_21011746
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9713418, 'precision': 0.8210588, 'recall': 0.64518255, 'specificity': 0.64518255, 'f1': 0.6973632, 'auroc': 0.96309125, 'binary_precision': 0.6661562, 'binary_recall': 0.2955163, 'binary_specificity': 0.9948488, 'binary_f1_score': 0.40941176}
confusion matrix:
       0    1
0  42102  218
1   1037  435
---- Validation: 
scalar performance:
{'acc': 0.9706258, 'precision': 0.8107512, 'recall': 0.65401816, 'specificity': 0.65401816, 'f1': 0.7037618, 'auroc': 0.96491504, 'binary_precision': 0.6453674, 'binary_recall': 0.31415242, 'binary_specificity': 0.99388397, 'binary_f1_score': 0.42259413}
confusion matrix:
       0    1
0  18038  111
1    441  202
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97794825, 'precision': 0.9737976, 'recall': 0.7429615, 'specificity': 0.7429615, 'f1': 0.81828845, 'auroc': 0.95767677, 'binary_precision': 0.9694657, 'binary_recall': 0.48659003, 'binary_specificity': 0.999333, 'binary_f1_score': 0.6479592}
confusion matrix:
      0    1
0  5993    4
1   134  127
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011746_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-01 21:35:59.270453,epoch time: 0:28:29.342851,used: 0:58:07.355159,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_20_37_51_seed_0_21011746
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97170717, 'precision': 0.8228096, 'recall': 0.65333444, 'specificity': 0.65333444, 'f1': 0.70554376, 'auroc': 0.9583536, 'binary_precision': 0.66909623, 'binary_recall': 0.31203264, 'binary_specificity': 0.99463624, 'binary_f1_score': 0.4255911}
confusion matrix:
       0    1
0  42094  227
1   1012  459
---- Validation: 
scalar performance:
{'acc': 0.97110474, 'precision': 0.8617416, 'recall': 0.6152632, 'specificity': 0.6152632, 'f1': 0.6705464, 'auroc': 0.9575598, 'binary_precision': 0.75, 'binary_recall': 0.2332815, 'binary_specificity': 0.997245, 'binary_f1_score': 0.3558719}
confusion matrix:
       0    1
0  18099   50
1    493  150
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645254, 'precision': 0.9821515, 'recall': 0.57471263, 'specificity': 0.57471263, 'f1': 0.6209135, 'auroc': 0.9360149, 'binary_precision': 1.0, 'binary_recall': 0.14942528, 'binary_specificity': 1.0, 'binary_f1_score': 0.26}
confusion matrix:
      0   1
0  5997   0
1   222  39
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011746_3.png
better model found
persisted
after epoch: 3,now: 2024-06-01 22:04:20.022358,epoch time: 0:28:20.751905,used: 1:26:28.107064,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_20_37_51_seed_0_21011746
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9729631, 'precision': 0.81797916, 'recall': 0.70175743, 'specificity': 0.70175743, 'f1': 0.745766, 'auroc': 0.9719408, 'binary_precision': 0.6561822, 'binary_recall': 0.41100544, 'binary_specificity': 0.9925094, 'binary_f1_score': 0.5054303}
confusion matrix:
       0    1
0  42003  317
1    867  605
---- Validation: 
scalar performance:
{'acc': 0.9709983, 'precision': 0.8201839, 'recall': 0.6512108, 'specificity': 0.6512108, 'f1': 0.7029778, 'auroc': 0.97198534, 'binary_precision': 0.66442955, 'binary_recall': 0.30793157, 'binary_specificity': 0.99449, 'binary_f1_score': 0.4208289}
confusion matrix:
       0    1
0  18049  100
1    445  198
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9709172, 'precision': 0.8816626, 'recall': 0.7044787, 'specificity': 0.7044787, 'f1': 0.76384735, 'auroc': 0.95682406, 'binary_precision': 0.7883212, 'binary_recall': 0.41379312, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.5427136}
confusion matrix:
      0    1
0  5968   29
1   153  108
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011746_4.png
early stop counter: 1
val acc:0.9709982872009277, best validation acc: 0.9711047410964966, corresponding to test acc:                         0.9645254015922546 / 0.9779482483863831
after epoch: 4,now: 2024-06-01 22:32:33.583221,epoch time: 0:28:13.560863,used: 1:54:41.667927,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_20_37_51_seed_0_21011746
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97773564, 'precision': 0.89405763, 'recall': 0.71996397, 'specificity': 0.71996397, 'f1': 0.780563, 'auroc': 0.9755292, 'binary_precision': 0.8071693, 'binary_recall': 0.44361413, 'binary_specificity': 0.9963138, 'binary_f1_score': 0.5725559}
confusion matrix:
       0    1
0  42164  156
1    819  653
---- Validation: 
scalar performance:
{'acc': 0.97381866, 'precision': 0.9329339, 'recall': 0.63316953, 'specificity': 0.63316953, 'f1': 0.6990474, 'auroc': 0.9752774, 'binary_precision': 0.8911917, 'binary_recall': 0.2674961, 'binary_specificity': 0.9988429, 'binary_f1_score': 0.41148323}
confusion matrix:
       0    1
0  18128   21
1    471  172
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9638862, 'precision': 0.86758006, 'recall': 0.5945348, 'specificity': 0.5945348, 'f1': 0.64410436, 'auroc': 0.9534956, 'binary_precision': 0.7692308, 'binary_recall': 0.19157088, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.30674848}
confusion matrix:
      0   1
0  5982  15
1   211  50
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011746_5.png
better model found
persisted
after epoch: 5,now: 2024-06-01 23:00:47.071434,epoch time: 0:28:13.488213,used: 2:22:55.156140,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_20_37_51_seed_0_21011746
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9761829, 'precision': 0.9191402, 'recall': 0.67293245, 'specificity': 0.67293245, 'f1': 0.7416038, 'auroc': 0.9769724, 'binary_precision': 0.8605042, 'binary_recall': 0.3478261, 'binary_specificity': 0.99803877, 'binary_f1_score': 0.495404}
confusion matrix:
       0    1
0  42237   83
1    960  512
---- Validation: 
scalar performance:
{'acc': 0.9732865, 'precision': 0.90930796, 'recall': 0.6336441, 'specificity': 0.6336441, 'f1': 0.6971769, 'auroc': 0.9757358, 'binary_precision': 0.84390247, 'binary_recall': 0.2690513, 'binary_specificity': 0.99823684, 'binary_f1_score': 0.40801886}
confusion matrix:
       0    1
0  18117   32
1    470  173
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.8186836, 'recall': 0.5506403, 'specificity': 0.5506403, 'f1': 0.57959044, 'auroc': 0.95483994, 'binary_precision': 0.675, 'binary_recall': 0.10344828, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.179402}
confusion matrix:
      0   1
0  5984  13
1   234  27
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011746_6.png
early stop counter: 1
val acc:0.973286509513855, best validation acc: 0.9738186597824097, corresponding to test acc:                         0.9638862013816833 / 0.9779482483863831
after epoch: 6,now: 2024-06-01 23:28:56.780343,epoch time: 0:28:09.708909,used: 2:51:04.865049,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_20_37_51_seed_0_21011746
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9801562, 'precision': 0.9118555, 'recall': 0.75105155, 'specificity': 0.75105155, 'f1': 0.81055737, 'auroc': 0.97765255, 'binary_precision': 0.840678, 'binary_recall': 0.5054348, 'binary_specificity': 0.9966682, 'binary_f1_score': 0.63131106}
confusion matrix:
       0    1
0  42179  141
1    728  744
---- Validation: 
scalar performance:
{'acc': 0.9763729, 'precision': 0.9186658, 'recall': 0.68399554, 'specificity': 0.68399554, 'f1': 0.7526407, 'auroc': 0.9745319, 'binary_precision': 0.8592058, 'binary_recall': 0.37013996, 'binary_specificity': 0.99785113, 'binary_f1_score': 0.51739126}
confusion matrix:
       0    1
0  18110   39
1    405  238
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.84384453, 'recall': 0.55463845, 'specificity': 0.55463845, 'f1': 0.5863987, 'auroc': 0.9503952, 'binary_precision': 0.725, 'binary_recall': 0.11111111, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.19269103}
confusion matrix:
      0   1
0  5986  11
1   232  29
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011746_7.png
better model found
persisted
after epoch: 7,now: 2024-06-01 23:57:05.608240,epoch time: 0:28:08.827897,used: 3:19:13.692946,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_20_37_51_seed_0_21011746
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97880894, 'precision': 0.8457029, 'recall': 0.8138359, 'specificity': 0.8138359, 'f1': 0.82893115, 'auroc': 0.9766873, 'binary_precision': 0.703982, 'binary_recall': 0.63698167, 'binary_specificity': 0.9906902, 'binary_f1_score': 0.66880804}
confusion matrix:
       0    1
0  41927  394
1    534  937
---- Validation: 
scalar performance:
{'acc': 0.97993827, 'precision': 0.90389895, 'recall': 0.7608469, 'specificity': 0.7608469, 'f1': 0.81582767, 'auroc': 0.9765366, 'binary_precision': 0.82439023, 'binary_recall': 0.525661, 'binary_specificity': 0.99603283, 'binary_f1_score': 0.64197534}
confusion matrix:
       0    1
0  18077   72
1    305  338
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9654842, 'precision': 0.8440324, 'recall': 0.6393446, 'specificity': 0.6393446, 'f1': 0.6944093, 'auroc': 0.951916, 'binary_precision': 0.7184466, 'binary_recall': 0.2835249, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.4065934}
confusion matrix:
      0   1
0  5968  29
1   187  74
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011746_8.png
better model found
persisted
after epoch: 8,now: 2024-06-02 00:24:50.999853,epoch time: 0:27:45.391613,used: 3:46:59.084559,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_20_37_51_seed_0_21011746
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.97492695, 'precision': 0.8213291, 'recall': 0.7585096, 'specificity': 0.7585096, 'f1': 0.78621006, 'auroc': 0.96636647, 'binary_precision': 0.6590136, 'binary_recall': 0.52649456, 'binary_specificity': 0.9905246, 'binary_f1_score': 0.5853474}
confusion matrix:
       0    1
0  41919  401
1    697  775
---- Validation: 
scalar performance:
{'acc': 0.9750426, 'precision': 0.82799804, 'recall': 0.7590624, 'specificity': 0.7590624, 'f1': 0.7891179, 'auroc': 0.96692944, 'binary_precision': 0.67261904, 'binary_recall': 0.5272162, 'binary_specificity': 0.99090856, 'binary_f1_score': 0.59110725}
confusion matrix:
       0    1
0  17984  165
1    304  339
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9576542, 'precision': 0.60428, 'recall': 0.5033312, 'specificity': 0.5033312, 'f1': 0.49661598, 'auroc': 0.9378524, 'binary_precision': 0.25, 'binary_recall': 0.007662835, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.014869888}
confusion matrix:
      0  1
0  5991  6
1   259  2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011746_9.png
early stop counter: 1
val acc:0.9750425815582275, best validation acc: 0.979938268661499, corresponding to test acc:                         0.9654842019081116 / 0.9779482483863831
after epoch: 9,now: 2024-06-02 00:53:07.494221,epoch time: 0:28:16.494368,used: 4:15:15.578927,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_20_37_51_seed_0_21011746
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.97880894, 'precision': 0.8296968, 'recall': 0.8598594, 'specificity': 0.8598594, 'f1': 0.84405494, 'auroc': 0.97745514, 'binary_precision': 0.6687345, 'binary_recall': 0.73233694, 'binary_specificity': 0.9873819, 'binary_f1_score': 0.6990921}
confusion matrix:
       0     1
0  41786   534
1    394  1078
---- Validation: 
scalar performance:
{'acc': 0.97945935, 'precision': 0.8497262, 'recall': 0.8318542, 'specificity': 0.8318542, 'f1': 0.8405345, 'auroc': 0.9727706, 'binary_precision': 0.71100163, 'binary_recall': 0.6734059, 'binary_specificity': 0.9903025, 'binary_f1_score': 0.6916933}
confusion matrix:
       0    1
0  17973  176
1    210  433
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.8145914, 'recall': 0.5524726, 'specificity': 0.5524726, 'f1': 0.5822971, 'auroc': 0.94560754, 'binary_precision': 0.6666667, 'binary_recall': 0.107279696, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.18481848}
confusion matrix:
      0   1
0  5983  14
1   233  28
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011746_10.png
early stop counter: 2
val acc:0.9794593453407288, best validation acc: 0.979938268661499, corresponding to test acc:                         0.9654842019081116 / 0.9779482483863831
after epoch: 10,now: 2024-06-02 01:21:48.968126,epoch time: 0:28:41.473905,used: 4:43:57.052832,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_20_37_51_seed_0_21011746
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9794026, 'precision': 0.8767713, 'recall': 0.7733078, 'specificity': 0.7733078, 'f1': 0.8161546, 'auroc': 0.9811586, 'binary_precision': 0.7689394, 'binary_recall': 0.552381, 'binary_specificity': 0.9942347, 'binary_f1_score': 0.64291376}
confusion matrix:
       0    1
0  42078  244
1    658  812
---- Validation: 
scalar performance:
{'acc': 0.9748829, 'precision': 0.865593, 'recall': 0.69597507, 'specificity': 0.69597507, 'f1': 0.7532264, 'auroc': 0.9748261, 'binary_precision': 0.7522124, 'binary_recall': 0.39657855, 'binary_specificity': 0.99537164, 'binary_f1_score': 0.51934826}
confusion matrix:
       0    1
0  18065   84
1    388  255
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96580374, 'precision': 0.8991684, 'recall': 0.61202633, 'specificity': 0.61202633, 'f1': 0.66892886, 'auroc': 0.9599458, 'binary_precision': 0.8309859, 'binary_recall': 0.22605364, 'binary_specificity': 0.997999, 'binary_f1_score': 0.3554217}
confusion matrix:
      0   1
0  5985  12
1   202  59
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011746_11.png
early stop counter: 3
val acc:0.9748829007148743, best validation acc: 0.979938268661499, corresponding to test acc:                         0.9654842019081116 / 0.9779482483863831
after epoch: 11,now: 2024-06-02 01:50:18.638908,epoch time: 0:28:29.670782,used: 5:12:26.723614,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_20_37_51_seed_0_21011746
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98266804, 'precision': 0.93590045, 'recall': 0.7762849, 'specificity': 0.7762849, 'f1': 0.8369577, 'auroc': 0.98275673, 'binary_precision': 0.88707924, 'binary_recall': 0.5550272, 'binary_specificity': 0.99754256, 'binary_f1_score': 0.68282485}
confusion matrix:
       0    1
0  42216  104
1    655  817
---- Validation: 
scalar performance:
{'acc': 0.9807365, 'precision': 0.9543724, 'recall': 0.7365083, 'specificity': 0.7365083, 'f1': 0.80884224, 'auroc': 0.9728059, 'binary_precision': 0.92705166, 'binary_recall': 0.47433904, 'binary_specificity': 0.9986776, 'binary_f1_score': 0.627572}
confusion matrix:
       0    1
0  18125   24
1    338  305
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96244806, 'precision': 0.9120728, 'recall': 0.5589701, 'specificity': 0.5589701, 'f1': 0.59476095, 'auroc': 0.9530551, 'binary_precision': 0.8611111, 'binary_recall': 0.118773945, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.20875421}
confusion matrix:
      0   1
0  5992   5
1   230  31
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011746_12.png
better model found
persisted
after epoch: 12,now: 2024-06-02 02:18:39.365564,epoch time: 0:28:20.726656,used: 5:40:47.450270,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_20_37_51_seed_0_21011746
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9830334, 'precision': 0.8959566, 'recall': 0.82455194, 'specificity': 0.82455194, 'f1': 0.85643435, 'auroc': 0.9810721, 'binary_precision': 0.80383974, 'binary_recall': 0.6546567, 'binary_specificity': 0.9944472, 'binary_f1_score': 0.7216186}
confusion matrix:
       0    1
0  42086  235
1    508  963
---- Validation: 
scalar performance:
{'acc': 0.9819072, 'precision': 0.8929002, 'recall': 0.81211996, 'specificity': 0.81211996, 'f1': 0.84750795, 'auroc': 0.97775143, 'binary_precision': 0.79881656, 'binary_recall': 0.62986004, 'binary_specificity': 0.9943799, 'binary_f1_score': 0.70434785}
confusion matrix:
       0    1
0  18047  102
1    238  405
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96292746, 'precision': 0.7976601, 'recall': 0.6343459, 'specificity': 0.6343459, 'f1': 0.6819341, 'auroc': 0.9540937, 'binary_precision': 0.62608695, 'binary_recall': 0.27586207, 'binary_specificity': 0.99282974, 'binary_f1_score': 0.3829787}
confusion matrix:
      0   1
0  5954  43
1   189  72
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011746_13.png
better model found
persisted
after epoch: 13,now: 2024-06-02 02:47:03.775453,epoch time: 0:28:24.409889,used: 6:09:11.860159,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_20_37_51_seed_0_21011746
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98221135, 'precision': 0.88786316, 'recall': 0.8189981, 'specificity': 0.8189981, 'f1': 0.84980524, 'auroc': 0.98047197, 'binary_precision': 0.7880299, 'binary_recall': 0.64402175, 'binary_specificity': 0.9939745, 'binary_f1_score': 0.70878506}
confusion matrix:
       0    1
0  42065  255
1    524  948
---- Validation: 
scalar performance:
{'acc': 0.98366326, 'precision': 0.91315126, 'recall': 0.8212797, 'specificity': 0.8212797, 'f1': 0.8610208, 'auroc': 0.9795367, 'binary_precision': 0.83870965, 'binary_recall': 0.64696735, 'binary_specificity': 0.99559206, 'binary_f1_score': 0.7304653}
confusion matrix:
       0    1
0  18069   80
1    227  416
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96212846, 'precision': 0.8680984, 'recall': 0.56430036, 'specificity': 0.56430036, 'f1': 0.60177106, 'auroc': 0.94976336, 'binary_precision': 0.77272725, 'binary_recall': 0.1302682, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.22295083}
confusion matrix:
      0   1
0  5987  10
1   227  34
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011746_14.png
better model found
persisted
after epoch: 14,now: 2024-06-02 03:15:11.248916,epoch time: 0:28:07.473463,used: 6:37:19.333622,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_20_37_51_seed_0_21011746
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9822799, 'precision': 0.94378483, 'recall': 0.7636254, 'specificity': 0.7636254, 'f1': 0.82921046, 'auroc': 0.98563504, 'binary_precision': 0.9037123, 'binary_recall': 0.52921194, 'binary_specificity': 0.99803877, 'binary_f1_score': 0.6675235}
confusion matrix:
       0    1
0  42237   83
1    693  779
---- Validation: 
scalar performance:
{'acc': 0.9804704, 'precision': 0.9438636, 'recall': 0.73862076, 'specificity': 0.73862076, 'f1': 0.8083131, 'auroc': 0.9817292, 'binary_precision': 0.90588236, 'binary_recall': 0.47900465, 'binary_specificity': 0.99823684, 'binary_f1_score': 0.62665313}
confusion matrix:
       0    1
0  18117   32
1    335  308
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.829394, 'recall': 0.5601354, 'specificity': 0.5601354, 'f1': 0.59428287, 'auroc': 0.9565202, 'binary_precision': 0.6956522, 'binary_recall': 0.12260536, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.20846903}
confusion matrix:
      0   1
0  5983  14
1   229  32
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011746_15.png
early stop counter: 1
val acc:0.9804704189300537, best validation acc: 0.9836632609367371, corresponding to test acc:                         0.9621284604072571 / 0.9779482483863831
after epoch: 15,now: 2024-06-02 03:43:36.221621,epoch time: 0:28:24.972705,used: 7:05:44.306327,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_20_37_51_seed_0_21011746
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.98326176, 'precision': 0.9319289, 'recall': 0.7900343, 'specificity': 0.7900343, 'f1': 0.84604216, 'auroc': 0.9870596, 'binary_precision': 0.87819856, 'binary_recall': 0.58288044, 'binary_specificity': 0.9971881, 'binary_f1_score': 0.70069414}
confusion matrix:
       0    1
0  42201  119
1    614  858
---- Validation: 
scalar performance:
{'acc': 0.9808961, 'precision': 0.9463115, 'recall': 0.7440915, 'specificity': 0.7440915, 'f1': 0.8135985, 'auroc': 0.97572196, 'binary_precision': 0.9104046, 'binary_recall': 0.48989114, 'binary_specificity': 0.9982919, 'binary_f1_score': 0.63700706}
confusion matrix:
       0    1
0  18118   31
1    328  315
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96244806, 'precision': 0.82077765, 'recall': 0.59378445, 'specificity': 0.59378445, 'f1': 0.63960755, 'auroc': 0.9353337, 'binary_precision': 0.6756757, 'binary_recall': 0.19157088, 'binary_specificity': 0.995998, 'binary_f1_score': 0.29850745}
confusion matrix:
      0   1
0  5973  24
1   211  50
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011746_16.png
early stop counter: 2
val acc:0.9808961153030396, best validation acc: 0.9836632609367371, corresponding to test acc:                         0.9621284604072571 / 0.9779482483863831
after epoch: 16,now: 2024-06-02 04:11:50.683367,epoch time: 0:28:14.461746,used: 7:33:58.768073,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_20_37_51_seed_0_21011746
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9821885, 'precision': 0.9637627, 'recall': 0.74898213, 'specificity': 0.74898213, 'f1': 0.8219423, 'auroc': 0.9873718, 'binary_precision': 0.94465894, 'binary_recall': 0.49898028, 'binary_specificity': 0.998984, 'binary_f1_score': 0.6530249}
confusion matrix:
       0    1
0  42278   43
1    737  734
---- Validation: 
scalar performance:
{'acc': 0.9786079, 'precision': 0.95869505, 'recall': 0.7001537, 'specificity': 0.7001537, 'f1': 0.77556384, 'auroc': 0.97864056, 'binary_precision': 0.9381818, 'binary_recall': 0.40124416, 'binary_specificity': 0.9990633, 'binary_f1_score': 0.56209147}
confusion matrix:
       0    1
0  18132   17
1    385  258
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589326, 'precision': 0.75365746, 'recall': 0.5443095, 'specificity': 0.5443095, 'f1': 0.56816524, 'auroc': 0.94240606, 'binary_precision': 0.54545456, 'binary_recall': 0.09195402, 'binary_specificity': 0.996665, 'binary_f1_score': 0.15737705}
confusion matrix:
      0   1
0  5977  20
1   237  24
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011746_17.png
early stop counter: 3
val acc:0.9786078929901123, best validation acc: 0.9836632609367371, corresponding to test acc:                         0.9621284604072571 / 0.9779482483863831
after epoch: 17,now: 2024-06-02 04:40:08.465524,epoch time: 0:28:17.782157,used: 8:02:16.550230,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_20_37_51_seed_0_21011746
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9806586, 'precision': 0.9489483, 'recall': 0.7329513, 'specificity': 0.7329513, 'f1': 0.8045304, 'auroc': 0.9846891, 'binary_precision': 0.9161118, 'binary_recall': 0.4673913, 'binary_specificity': 0.9985113, 'binary_f1_score': 0.6189833}
confusion matrix:
       0    1
0  42257   63
1    784  688
---- Validation: 
scalar performance:
{'acc': 0.9765858, 'precision': 0.966, 'recall': 0.6653544, 'specificity': 0.6653544, 'f1': 0.7399668, 'auroc': 0.9774879, 'binary_precision': 0.9551569, 'binary_recall': 0.33125973, 'binary_specificity': 0.999449, 'binary_f1_score': 0.49191687}
confusion matrix:
       0    1
0  18139   10
1    430  213
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.72944, 'recall': 0.50732934, 'specificity': 0.50732934, 'f1': 0.5042142, 'auroc': 0.94957346, 'binary_precision': 0.5, 'binary_recall': 0.01532567, 'binary_specificity': 0.999333, 'binary_f1_score': 0.029739777}
confusion matrix:
      0  1
0  5993  4
1   257  4
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011746_18.png
early stop counter: 4
val acc:0.9765858054161072, best validation acc: 0.9836632609367371, corresponding to test acc:                         0.9621284604072571 / 0.9779482483863831
after epoch: 18,now: 2024-06-02 05:08:26.178780,epoch time: 0:28:17.713256,used: 8:30:34.263486,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_20_37_51_seed_0_21011746
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.98486024, 'precision': 0.8781322, 'recall': 0.89373994, 'specificity': 0.89373994, 'f1': 0.8857645, 'auroc': 0.9869834, 'binary_precision': 0.7633638, 'binary_recall': 0.7960571, 'binary_specificity': 0.9914227, 'binary_f1_score': 0.77936774}
confusion matrix:
       0     1
0  41958   363
1    300  1171
---- Validation: 
scalar performance:
{'acc': 0.9843018, 'precision': 0.8876739, 'recall': 0.8696138, 'specificity': 0.8696138, 'f1': 0.87841, 'auroc': 0.9789771, 'binary_precision': 0.78431374, 'binary_recall': 0.7465008, 'binary_specificity': 0.99272686, 'binary_f1_score': 0.76494026}
confusion matrix:
       0    1
0  18017  132
1    163  480
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96324706, 'precision': 0.80436516, 'recall': 0.6326803, 'specificity': 0.6326803, 'f1': 0.6813905, 'auroc': 0.9507679, 'binary_precision': 0.6396396, 'binary_recall': 0.27203065, 'binary_specificity': 0.99333, 'binary_f1_score': 0.38172042}
confusion matrix:
      0   1
0  5957  40
1   190  71
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011746_19.png
better model found
persisted
after epoch: 19,now: 2024-06-02 05:36:18.613923,epoch time: 0:27:52.435143,used: 8:58:26.698629,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_20_37_51_seed_0_21011746
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9845406, 'precision': 0.8696807, 'recall': 0.9047296, 'specificity': 0.9047296, 'f1': 0.8863406, 'auroc': 0.9871414, 'binary_precision': 0.7456683, 'binary_recall': 0.81917065, 'binary_specificity': 0.9902885, 'binary_f1_score': 0.7806933}
confusion matrix:
       0     1
0  41910   411
1    266  1205
---- Validation: 
scalar performance:
{'acc': 0.98366326, 'precision': 0.88607585, 'recall': 0.8587824, 'specificity': 0.8587824, 'f1': 0.8718863, 'auroc': 0.98006994, 'binary_precision': 0.7818792, 'binary_recall': 0.7247278, 'binary_specificity': 0.9928371, 'binary_f1_score': 0.7522195}
confusion matrix:
       0    1
0  18019  130
1    177  466
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.971876, 'precision': 0.89972806, 'recall': 0.70497894, 'specificity': 0.70497894, 'f1': 0.7682519, 'auroc': 0.9591887, 'binary_precision': 0.8244275, 'binary_recall': 0.41379312, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.55102044}
confusion matrix:
      0    1
0  5974   23
1   153  108
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011746_20.png
early stop counter: 1
val acc:0.9836632609367371, best validation acc: 0.9843018054962158, corresponding to test acc:                         0.9632470607757568 / 0.9779482483863831
after epoch: 20,now: 2024-06-02 06:04:10.043804,epoch time: 0:27:51.429881,used: 9:26:18.128510,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_20_37_51_seed_0_21011746
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.98545396, 'precision': 0.92189014, 'recall': 0.83969164, 'specificity': 0.83969164, 'f1': 0.876016, 'auroc': 0.98777074, 'binary_precision': 0.8547154, 'binary_recall': 0.68342394, 'binary_specificity': 0.99595934, 'binary_f1_score': 0.7595319}
confusion matrix:
       0     1
0  42149   171
1    466  1006
---- Validation: 
scalar performance:
{'acc': 0.9830779, 'precision': 0.9564779, 'recall': 0.7729731, 'specificity': 0.7729731, 'f1': 0.84007394, 'auroc': 0.97854674, 'binary_precision': 0.9287599, 'binary_recall': 0.5474339, 'binary_specificity': 0.9985123, 'binary_f1_score': 0.6888454}
confusion matrix:
       0    1
0  18122   27
1    291  352
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645254, 'precision': 0.91002303, 'recall': 0.5893713, 'specificity': 0.5893713, 'f1': 0.6396358, 'auroc': 0.9553033, 'binary_precision': 0.8545455, 'binary_recall': 0.18007663, 'binary_specificity': 0.998666, 'binary_f1_score': 0.29746836}
confusion matrix:
      0   1
0  5989   8
1   214  47
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011746_21.png
early stop counter: 2
val acc:0.983077883720398, best validation acc: 0.9843018054962158, corresponding to test acc:                         0.9632470607757568 / 0.9779482483863831
after epoch: 21,now: 2024-06-02 06:32:01.261669,epoch time: 0:27:51.217865,used: 9:54:09.346375,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_20_37_51_seed_0_21011746
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9825311, 'precision': 0.84123504, 'recall': 0.9345304, 'specificity': 0.9345304, 'f1': 0.88172066, 'auroc': 0.9898522, 'binary_precision': 0.68657506, 'binary_recall': 0.88307273, 'binary_specificity': 0.985988, 'binary_f1_score': 0.77252454}
confusion matrix:
       0     1
0  41728   593
1    172  1299
---- Validation: 
scalar performance:
{'acc': 0.9841954, 'precision': 0.8692867, 'recall': 0.90406126, 'specificity': 0.90406126, 'f1': 0.8858202, 'auroc': 0.98223937, 'binary_precision': 0.7450425, 'binary_recall': 0.81804043, 'binary_specificity': 0.9900821, 'binary_f1_score': 0.77983695}
confusion matrix:
       0    1
0  17969  180
1    117  526
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96180886, 'precision': 0.79204404, 'recall': 0.6081096, 'specificity': 0.6081096, 'f1': 0.6535538, 'auroc': 0.9455935, 'binary_precision': 0.61702126, 'binary_recall': 0.22222222, 'binary_specificity': 0.993997, 'binary_f1_score': 0.32676056}
confusion matrix:
      0   1
0  5961  36
1   203  58
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011746_22.png
early stop counter: 3
val acc:0.9841954112052917, best validation acc: 0.9843018054962158, corresponding to test acc:                         0.9632470607757568 / 0.9779482483863831
after epoch: 22,now: 2024-06-02 06:59:53.899765,epoch time: 0:27:52.638096,used: 10:22:01.984471,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_20_37_51_seed_0_21011746
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.98655003, 'precision': 0.9499085, 'recall': 0.8309646, 'specificity': 0.8309646, 'f1': 0.88072884, 'auroc': 0.98980963, 'binary_precision': 0.9113806, 'binary_recall': 0.664174, 'binary_specificity': 0.9977552, 'binary_f1_score': 0.7683838}
confusion matrix:
       0    1
0  42226   95
1    494  977
---- Validation: 
scalar performance:
{'acc': 0.9837697, 'precision': 0.9468422, 'recall': 0.7913326, 'specificity': 0.7913326, 'f1': 0.8515488, 'auroc': 0.97976506, 'binary_precision': 0.90821254, 'binary_recall': 0.58475894, 'binary_specificity': 0.9979062, 'binary_f1_score': 0.7114475}
confusion matrix:
       0    1
0  18111   38
1    267  376
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96340686, 'precision': 0.84731734, 'recall': 0.596117, 'specificity': 0.596117, 'f1': 0.64468175, 'auroc': 0.9444537, 'binary_precision': 0.7285714, 'binary_recall': 0.1954023, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.30815712}
confusion matrix:
      0   1
0  5978  19
1   210  51
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011746_23.png
early stop counter: 4
val acc:0.9837697148323059, best validation acc: 0.9843018054962158, corresponding to test acc:                         0.9632470607757568 / 0.9779482483863831
after epoch: 23,now: 2024-06-02 07:27:43.322403,epoch time: 0:27:49.422638,used: 10:49:51.407109,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_20_37_51_seed_0_21011746
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9877603, 'precision': 0.939012, 'recall': 0.8625237, 'specificity': 0.8625237, 'f1': 0.8968435, 'auroc': 0.9916183, 'binary_precision': 0.8874172, 'binary_recall': 0.7282609, 'binary_specificity': 0.9967864, 'binary_f1_score': 0.8}
confusion matrix:
       0     1
0  42184   136
1    400  1072
---- Validation: 
scalar performance:
{'acc': 0.9828118, 'precision': 0.9295918, 'recall': 0.78933656, 'specificity': 0.78933656, 'f1': 0.84478325, 'auroc': 0.9802423, 'binary_precision': 0.87383175, 'binary_recall': 0.5816485, 'binary_specificity': 0.99702466, 'binary_f1_score': 0.69841266}
confusion matrix:
       0    1
0  18095   54
1    269  374
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9603707, 'precision': 0.81443965, 'recall': 0.54872453, 'specificity': 0.54872453, 'f1': 0.57651603, 'auroc': 0.94582814, 'binary_precision': 0.6666667, 'binary_recall': 0.099616855, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.17333335}
confusion matrix:
      0   1
0  5984  13
1   235  26
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011746_24.png
early stop counter: 5
val acc:0.9828118085861206, best validation acc: 0.9843018054962158, corresponding to test acc:                         0.9632470607757568 / 0.9779482483863831
after epoch: 24,now: 2024-06-02 07:55:33.222322,epoch time: 0:27:49.899919,used: 11:17:41.307028,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_20_37_51_seed_0_21011746
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.98760045, 'precision': 0.8950305, 'recall': 0.9211277, 'specificity': 0.9211277, 'f1': 0.9076259, 'auroc': 0.99146426, 'binary_precision': 0.7952956, 'binary_recall': 0.8498641, 'binary_specificity': 0.9923913, 'binary_f1_score': 0.8216749}
confusion matrix:
       0     1
0  41998   322
1    221  1251
---- Validation: 
scalar performance:
{'acc': 0.98398256, 'precision': 0.87940687, 'recall': 0.87769914, 'specificity': 0.87769914, 'f1': 0.8785509, 'auroc': 0.98162866, 'binary_precision': 0.7671875, 'binary_recall': 0.7636081, 'binary_specificity': 0.9917902, 'binary_f1_score': 0.7653936}
confusion matrix:
       0    1
0  18000  149
1    152  491
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642058, 'precision': 0.8315482, 'recall': 0.6240189, 'specificity': 0.6240189, 'f1': 0.67618275, 'auroc': 0.94298875, 'binary_precision': 0.69473684, 'binary_recall': 0.25287357, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.37078652}
confusion matrix:
      0   1
0  5968  29
1   195  66
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011746_25.png
early stop counter: 6
val acc:0.9839825630187988, best validation acc: 0.9843018054962158, corresponding to test acc:                         0.9632470607757568 / 0.9779482483863831
after epoch: 25,now: 2024-06-02 08:23:30.500237,epoch time: 0:27:57.277915,used: 11:45:38.584943,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_20_37_51_seed_0_21011746
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9885139, 'precision': 0.91686976, 'recall': 0.9034406, 'specificity': 0.9034406, 'f1': 0.9100363, 'auroc': 0.9919977, 'binary_precision': 0.84025335, 'binary_recall': 0.8122449, 'binary_specificity': 0.99463636, 'binary_f1_score': 0.8260117}
confusion matrix:
       0     1
0  42095   227
1    276  1194
---- Validation: 
scalar performance:
{'acc': 0.98440826, 'precision': 0.9077686, 'recall': 0.84191686, 'specificity': 0.84191686, 'f1': 0.871718, 'auroc': 0.9820715, 'binary_precision': 0.82649255, 'binary_recall': 0.688958, 'binary_specificity': 0.9948757, 'binary_f1_score': 0.75148433}
confusion matrix:
       0    1
0  18056   93
1    200  443
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9686801, 'precision': 0.84645605, 'recall': 0.7014791, 'specificity': 0.7014791, 'f1': 0.75288045, 'auroc': 0.9471444, 'binary_precision': 0.7181208, 'binary_recall': 0.4099617, 'binary_specificity': 0.9929965, 'binary_f1_score': 0.52195126}
confusion matrix:
      0    1
0  5955   42
1   154  107
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011746_26.png
better model found
persisted
after epoch: 26,now: 2024-06-02 08:51:18.437724,epoch time: 0:27:47.937487,used: 12:13:26.522430,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_20_37_51_seed_0_21011746
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.98792017, 'precision': 0.94509274, 'recall': 0.858905, 'specificity': 0.858905, 'f1': 0.8970368, 'auroc': 0.9915702, 'binary_precision': 0.8998302, 'binary_recall': 0.7205982, 'binary_specificity': 0.9972118, 'binary_f1_score': 0.80030197}
confusion matrix:
       0     1
0  42203   118
1    411  1060
---- Validation: 
scalar performance:
{'acc': 0.9837697, 'precision': 0.91894853, 'recall': 0.81683445, 'specificity': 0.81683445, 'f1': 0.8602617, 'auroc': 0.9758742, 'binary_precision': 0.8506224, 'binary_recall': 0.63763607, 'binary_specificity': 0.99603283, 'binary_f1_score': 0.7288889}
confusion matrix:
       0    1
0  18077   72
1    233  410
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9637264, 'precision': 0.8348316, 'recall': 0.6109424, 'specificity': 0.6109424, 'f1': 0.66168904, 'auroc': 0.9418886, 'binary_precision': 0.70238096, 'binary_recall': 0.22605364, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.342029}
confusion matrix:
      0   1
0  5972  25
1   202  59
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011746_27.png
early stop counter: 1
val acc:0.9837697148323059, best validation acc: 0.9844082593917847, corresponding to test acc:                         0.9686800837516785 / 0.9779482483863831
after epoch: 27,now: 2024-06-02 09:19:12.604099,epoch time: 0:27:54.166375,used: 12:41:20.688805,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_20_37_51_seed_0_21011746
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.98088694, 'precision': 0.8289293, 'recall': 0.9323674, 'specificity': 0.9323674, 'f1': 0.8729087, 'auroc': 0.9893704, 'binary_precision': 0.66206545, 'binary_recall': 0.8803535, 'binary_specificity': 0.98438126, 'binary_f1_score': 0.75576305}
confusion matrix:
       0     1
0  41660   661
1    176  1295
---- Validation: 
scalar performance:
{'acc': 0.9802576, 'precision': 0.8333484, 'recall': 0.90427274, 'specificity': 0.90427274, 'f1': 0.8650583, 'auroc': 0.978151, 'binary_precision': 0.673028, 'binary_recall': 0.82270604, 'binary_specificity': 0.9858394, 'binary_f1_score': 0.7403779}
confusion matrix:
       0    1
0  17892  257
1    114  529
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606903, 'precision': 0.8147433, 'recall': 0.55622065, 'specificity': 0.55622065, 'f1': 0.5879655, 'auroc': 0.93535113, 'binary_precision': 0.6666667, 'binary_recall': 0.11494253, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.19607843}
confusion matrix:
      0   1
0  5982  15
1   231  30
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011746_28.png
early stop counter: 2
val acc:0.9802575707435608, best validation acc: 0.9844082593917847, corresponding to test acc:                         0.9686800837516785 / 0.9779482483863831
after epoch: 28,now: 2024-06-02 09:47:07.433708,epoch time: 0:27:54.829609,used: 13:09:15.518414,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_20_37_51_seed_0_21011746
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9895643, 'precision': 0.92776024, 'recall': 0.9083737, 'specificity': 0.9083737, 'f1': 0.91782427, 'auroc': 0.99425435, 'binary_precision': 0.86172485, 'binary_recall': 0.8213315, 'binary_specificity': 0.99541587, 'binary_f1_score': 0.8410435}
confusion matrix:
       0     1
0  42126   194
1    263  1209
---- Validation: 
scalar performance:
{'acc': 0.98664325, 'precision': 0.9228487, 'recall': 0.8648256, 'specificity': 0.8648256, 'f1': 0.8915302, 'auroc': 0.98118633, 'binary_precision': 0.85507244, 'binary_recall': 0.7340591, 'binary_specificity': 0.99559206, 'binary_f1_score': 0.7899581}
confusion matrix:
       0    1
0  18069   80
1    171  472
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96324706, 'precision': 0.83651304, 'recall': 0.5996983, 'specificity': 0.5996983, 'f1': 0.6482964, 'auroc': 0.95169985, 'binary_precision': 0.70666665, 'binary_recall': 0.20306513, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.3154762}
confusion matrix:
      0   1
0  5975  22
1   208  53
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011746_29.png
better model found
persisted
after epoch: 29,now: 2024-06-02 10:14:58.861175,epoch time: 0:27:51.427467,used: 13:37:06.945881,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_20_37_51_seed_0_21011746
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9886509, 'precision': 0.93043756, 'recall': 0.88822955, 'specificity': 0.88822955, 'f1': 0.90816045, 'auroc': 0.9932641, 'binary_precision': 0.86848074, 'binary_recall': 0.7805706, 'binary_specificity': 0.9958885, 'binary_f1_score': 0.8221824}
confusion matrix:
       0     1
0  42146   174
1    323  1149
---- Validation: 
scalar performance:
{'acc': 0.98616433, 'precision': 0.9252273, 'recall': 0.8533268, 'specificity': 0.8533268, 'f1': 0.885697, 'auroc': 0.98200566, 'binary_precision': 0.8606403, 'binary_recall': 0.71073097, 'binary_specificity': 0.9959226, 'binary_f1_score': 0.77853495}
confusion matrix:
       0    1
0  18075   74
1    186  457
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96596354, 'precision': 0.8371998, 'recall': 0.6560857, 'specificity': 0.6560857, 'f1': 0.7102226, 'auroc': 0.9445405, 'binary_precision': 0.7033898, 'binary_recall': 0.31800765, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.43799472}
confusion matrix:
      0   1
0  5962  35
1   178  83
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011746_30.png
early stop counter: 1
val acc:0.9861643314361572, best validation acc: 0.9866432547569275, corresponding to test acc:                         0.9632470607757568 / 0.9779482483863831
after epoch: 30,now: 2024-06-02 10:42:53.933377,epoch time: 0:27:55.072202,used: 14:05:02.018083,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_20_37_51_seed_0_21011746
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 14:05:02.018083 at 2024-06-02 10:42:53.933377
persisted model performance metric: 

scalar performance:
{'acc': 0.96212846, 'precision': 0.81611705, 'recall': 0.58995306, 'specificity': 0.58995306, 'f1': 0.6344175, 'auroc': 0.9460421, 'binary_precision': 0.6666667, 'binary_recall': 0.18390805, 'binary_specificity': 0.995998, 'binary_f1_score': 0.2882883}
confusion matrix:
      0   1
0  5973  24
1   213  48
oracle model performance metric: 

scalar performance:
{'acc': 0.97666985, 'precision': 0.9721669, 'recall': 0.72763586, 'specificity': 0.72763586, 'f1': 0.80387866, 'auroc': 0.9616865, 'binary_precision': 0.96747965, 'binary_recall': 0.4559387, 'binary_specificity': 0.999333, 'binary_f1_score': 0.6197917}
confusion matrix:
      0    1
0  5993    4
1   142  119
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/rule_results/3.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456549 KiB |  13219 MiB |   1121 TiB |   1121 TiB |
|       from large pool | 414861 KiB |  13181 MiB |   1107 TiB |   1107 TiB |
|       from small pool |  41687 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 456549 KiB |  13219 MiB |   1121 TiB |   1121 TiB |
|       from large pool | 414861 KiB |  13181 MiB |   1107 TiB |   1107 TiB |
|       from small pool |  41687 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447754 KiB |  13213 MiB |   1113 TiB |   1113 TiB |
|       from large pool | 407075 KiB |  13175 MiB |   1100 TiB |   1100 TiB |
|       from small pool |  40679 KiB |     60 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14474 MiB |  14474 MiB |  14474 MiB |      0 B   |
|       from large pool |  14404 MiB |  14404 MiB |  14404 MiB |      0 B   |
|       from small pool |     70 MiB |     70 MiB |     70 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 473243 KiB |   1229 MiB |    791 TiB |    791 TiB |
|       from large pool | 461682 KiB |   1224 MiB |    778 TiB |    778 TiB |
|       from small pool |  11560 KiB |     17 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3488    |    6479    |  197600 K  |  197597 K  |
|       from large pool |     187    |    1413    |  102630 K  |  102630 K  |
|       from small pool |    3301    |    6290    |   94970 K  |   94967 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3488    |    6479    |  197600 K  |  197597 K  |
|       from large pool |     187    |    1413    |  102630 K  |  102630 K  |
|       from small pool |    3301    |    6290    |   94970 K  |   94967 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     636    |     636    |     636    |       0    |
|       from large pool |     601    |     601    |     601    |       0    |
|       from small pool |      35    |      35    |      35    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      84    |    2804    |  135763 K  |  135763 K  |
|       from large pool |      39    |     600    |   83826 K  |   83826 K  |
|       from small pool |      45    |    2764    |   51936 K  |   51936 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   1121 TiB |   1121 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1107 TiB |   1107 TiB |
|       from small pool |      0 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   1121 TiB |   1121 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1107 TiB |   1107 TiB |
|       from small pool |      0 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   1113 TiB |   1113 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   1100 TiB |   1100 TiB |
|       from small pool |      0 KiB |     60 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    908 MiB |  14474 MiB |  14474 MiB |  13566 MiB |
|       from large pool |    856 MiB |  14404 MiB |  14404 MiB |  13548 MiB |
|       from small pool |     52 MiB |     70 MiB |     70 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1229 MiB |    791 TiB |    791 TiB |
|       from large pool |  24320 KiB |   1224 MiB |    778 TiB |    778 TiB |
|       from small pool |      0 KiB |     42 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6479    |  197600 K  |  197600 K  |
|       from large pool |       2    |    1413    |  102630 K  |  102630 K  |
|       from small pool |       0    |    6290    |   94970 K  |   94970 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6479    |  197600 K  |  197600 K  |
|       from large pool |       2    |    1413    |  102630 K  |  102630 K  |
|       from small pool |       0    |    6290    |   94970 K  |   94970 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      64    |     636    |     636    |     572    |
|       from large pool |      38    |     601    |     601    |     563    |
|       from small pool |      26    |      35    |      35    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2804    |  135764 K  |  135764 K  |
|       from large pool |       4    |     600    |   83826 K  |   83826 K  |
|       from small pool |       0    |    2764    |   51937 K  |   51937 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   1121 TiB |   1121 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1107 TiB |   1107 TiB |
|       from small pool |      0 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   1121 TiB |   1121 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1107 TiB |   1107 TiB |
|       from small pool |      0 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   1113 TiB |   1113 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   1100 TiB |   1100 TiB |
|       from small pool |      0 KiB |     60 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    908 MiB |  14474 MiB |  14474 MiB |  13566 MiB |
|       from large pool |    856 MiB |  14404 MiB |  14404 MiB |  13548 MiB |
|       from small pool |     52 MiB |     70 MiB |     70 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1229 MiB |    791 TiB |    791 TiB |
|       from large pool |  24320 KiB |   1224 MiB |    778 TiB |    778 TiB |
|       from small pool |      0 KiB |     42 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6479    |  197600 K  |  197600 K  |
|       from large pool |       2    |    1413    |  102630 K  |  102630 K  |
|       from small pool |       0    |    6290    |   94970 K  |   94970 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6479    |  197600 K  |  197600 K  |
|       from large pool |       2    |    1413    |  102630 K  |  102630 K  |
|       from small pool |       0    |    6290    |   94970 K  |   94970 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      64    |     636    |     636    |     572    |
|       from large pool |      38    |     601    |     601    |     563    |
|       from small pool |      26    |      35    |      35    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2804    |  135764 K  |  135764 K  |
|       from large pool |       4    |     600    |   83826 K  |   83826 K  |
|       from small pool |       0    |    2764    |   51937 K  |   51937 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_10_52_44_seed_1_21011746

 Experiment start at: 2024-06-02 10:52:44.068746
before training, model accuracy: 0.181115061044693
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96718806, 'precision': 0.9835929, 'recall': 0.5010402, 'specificity': 0.5010402, 'f1': 0.49373573, 'auroc': 0.94965017, 'binary_precision': 1.0, 'binary_recall': 0.0020804438, 'binary_specificity': 1.0, 'binary_f1_score': 0.004152249}
confusion matrix:
       0  1
0  42414  0
1   1439  3
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.9515308, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.92571783, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011746_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-02 11:21:50.736433,epoch time: 0:29:06.667687,used: 0:29:06.667687,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_10_52_44_seed_1_21011746
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96727926, 'precision': 0.82580626, 'recall': 0.5044369, 'specificity': 0.5044369, 'f1': 0.50057924, 'auroc': 0.9613334, 'binary_precision': 0.68421054, 'binary_recall': 0.009015257, 'binary_specificity': 0.99985856, 'binary_f1_score': 0.01779603}
confusion matrix:
       0   1
0  42408   6
1   1429  13
---- Validation: 
scalar performance:
{'acc': 0.96499467, 'precision': 0.9349121, 'recall': 0.51406056, 'specificity': 0.51406056, 'f1': 0.5184611, 'auroc': 0.9604946, 'binary_precision': 0.9047619, 'binary_recall': 0.028231798, 'binary_specificity': 0.9998893, 'binary_f1_score': 0.05475504}
confusion matrix:
       0   1
0  18065   2
1    654  19
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582662, 'precision': 0.97912973, 'recall': 0.5019231, 'specificity': 0.5019231, 'f1': 0.49317387, 'auroc': 0.9470825, 'binary_precision': 1.0, 'binary_recall': 0.0038461538, 'binary_specificity': 1.0, 'binary_f1_score': 0.007662835}
confusion matrix:
      0  1
0  5946  0
1   259  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011746_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-02 11:49:29.017639,epoch time: 0:27:38.281206,used: 0:56:44.948893,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_10_52_44_seed_1_21011746
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9671653, 'precision': 0.9835819, 'recall': 0.5006935, 'specificity': 0.5006935, 'f1': 0.49303892, 'auroc': 0.9648248, 'binary_precision': 1.0, 'binary_recall': 0.0013869626, 'binary_specificity': 1.0, 'binary_f1_score': 0.002770083}
confusion matrix:
       0  1
0  42414  0
1   1440  2
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.96374834, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.9531293, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011746_3.png
early stop counter: 1
val acc:0.9640874862670898, best validation acc: 0.9649946689605713, corresponding to test acc:                         0.9582661986351013 / 0.9582661986351013
after epoch: 3,now: 2024-06-02 12:16:57.168029,epoch time: 0:27:28.150390,used: 1:24:13.099283,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_10_52_44_seed_1_21011746
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9745531, 'precision': 0.86036134, 'recall': 0.67098415, 'specificity': 0.67098415, 'f1': 0.7295265, 'auroc': 0.96963173, 'binary_precision': 0.74255955, 'binary_recall': 0.34604716, 'binary_specificity': 0.99592113, 'binary_f1_score': 0.47209084}
confusion matrix:
       0    1
0  42241  173
1    943  499
---- Validation: 
scalar performance:
{'acc': 0.9703842, 'precision': 0.8647817, 'recall': 0.62772214, 'specificity': 0.62772214, 'f1': 0.68510425, 'auroc': 0.96531445, 'binary_precision': 0.75652176, 'binary_recall': 0.25854382, 'binary_specificity': 0.99690044, 'binary_f1_score': 0.38538206}
confusion matrix:
       0    1
0  18011   56
1    499  174
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9622946, 'precision': 0.98106796, 'recall': 0.55, 'specificity': 0.55, 'f1': 0.58126044, 'auroc': 0.9570644, 'binary_precision': 1.0, 'binary_recall': 0.1, 'binary_specificity': 1.0, 'binary_f1_score': 0.18181819}
confusion matrix:
      0   1
0  5946   0
1   234  26
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011746_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-02 12:45:52.866949,epoch time: 0:28:55.698920,used: 1:53:08.798203,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_10_52_44_seed_1_21011746
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96807736, 'precision': 0.749833, 'recall': 0.82104427, 'specificity': 0.82104427, 'f1': 0.78048086, 'auroc': 0.96528363, 'binary_precision': 0.51121795, 'binary_recall': 0.6636616, 'binary_specificity': 0.97842693, 'binary_f1_score': 0.5775498}
confusion matrix:
       0    1
0  41499  915
1    485  957
---- Validation: 
scalar performance:
{'acc': 0.9699573, 'precision': 0.7792971, 'recall': 0.8170465, 'specificity': 0.8170465, 'f1': 0.7968385, 'auroc': 0.9642566, 'binary_precision': 0.57161456, 'binary_recall': 0.6523031, 'binary_specificity': 0.98179, 'binary_f1_score': 0.60929906}
confusion matrix:
       0    1
0  17738  329
1    234  439
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96471155, 'precision': 0.8241904, 'recall': 0.6468887, 'specificity': 0.6468887, 'f1': 0.698903, 'auroc': 0.95430976, 'binary_precision': 0.67826086, 'binary_recall': 0.3, 'binary_specificity': 0.99377733, 'binary_f1_score': 0.416}
confusion matrix:
      0   1
0  5909  37
1   182  78
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011746_5.png
new oracle model saved
early stop counter: 1
val acc:0.9699572920799255, best validation acc: 0.9703841805458069, corresponding to test acc:                         0.9622945785522461 / 0.9647115468978882
after epoch: 5,now: 2024-06-02 13:14:24.712126,epoch time: 0:28:31.845177,used: 2:21:40.643380,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_10_52_44_seed_1_21011746
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9728885, 'precision': 0.77786607, 'recall': 0.8801385, 'specificity': 0.8801385, 'f1': 0.8201758, 'auroc': 0.9734837, 'binary_precision': 0.56328166, 'binary_recall': 0.7808599, 'binary_specificity': 0.97941715, 'binary_f1_score': 0.6544609}
confusion matrix:
       0     1
0  41541   873
1    316  1126
---- Validation: 
scalar performance:
{'acc': 0.97326577, 'precision': 0.799417, 'recall': 0.8466578, 'specificity': 0.8466578, 'f1': 0.82111746, 'auroc': 0.96827114, 'binary_precision': 0.6096939, 'binary_recall': 0.7102526, 'binary_specificity': 0.98306304, 'binary_f1_score': 0.6561427}
confusion matrix:
       0    1
0  17761  306
1    195  478
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.98243636, 'precision': 0.9103621, 'recall': 0.8602661, 'specificity': 0.8602661, 'f1': 0.88352, 'auroc': 0.9544524, 'binary_precision': 0.8325991, 'binary_recall': 0.72692305, 'binary_specificity': 0.99360913, 'binary_f1_score': 0.7761806}
confusion matrix:
      0    1
0  5908   38
1    71  189
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011746_6.png
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-06-02 13:42:57.520580,epoch time: 0:28:32.808454,used: 2:50:13.451834,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_10_52_44_seed_1_21011746
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9804588, 'precision': 0.8565505, 'recall': 0.8227561, 'specificity': 0.8227561, 'f1': 0.8387412, 'auroc': 0.975, 'binary_precision': 0.72482705, 'binary_recall': 0.65395284, 'binary_specificity': 0.9915594, 'binary_f1_score': 0.68756837}
confusion matrix:
       0    1
0  42056  358
1    499  943
---- Validation: 
scalar performance:
{'acc': 0.9779616, 'precision': 0.8993167, 'recall': 0.74680996, 'specificity': 0.74680996, 'f1': 0.8036524, 'auroc': 0.96864474, 'binary_precision': 0.81707317, 'binary_recall': 0.49777117, 'binary_specificity': 0.9958488, 'binary_f1_score': 0.6186519}
confusion matrix:
       0    1
0  17992   75
1    338  335
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96793425, 'precision': 0.8601748, 'recall': 0.6743163, 'specificity': 0.6743163, 'f1': 0.7319372, 'auroc': 0.95640314, 'binary_precision': 0.7479675, 'binary_recall': 0.35384616, 'binary_specificity': 0.9947864, 'binary_f1_score': 0.48041776}
confusion matrix:
      0   1
0  5915  31
1   168  92
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011746_7.png
better model found
persisted
after epoch: 7,now: 2024-06-02 14:11:30.171922,epoch time: 0:28:32.651342,used: 3:18:46.103176,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_10_52_44_seed_1_21011746
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9809376, 'precision': 0.8468037, 'recall': 0.8584142, 'specificity': 0.8584142, 'f1': 0.85250485, 'auroc': 0.9802041, 'binary_precision': 0.70288396, 'binary_recall': 0.72727275, 'binary_specificity': 0.9895556, 'binary_f1_score': 0.7148704}
confusion matrix:
       0     1
0  41972   443
1    393  1048
---- Validation: 
scalar performance:
{'acc': 0.97940236, 'precision': 0.919096, 'recall': 0.75470984, 'specificity': 0.75470984, 'f1': 0.8153304, 'auroc': 0.97564733, 'binary_precision': 0.8560794, 'binary_recall': 0.51263, 'binary_specificity': 0.99678975, 'binary_f1_score': 0.64126396}
confusion matrix:
       0    1
0  18009   58
1    328  345
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96036094, 'precision': 0.7901914, 'recall': 0.56921977, 'specificity': 0.56921977, 'f1': 0.605453, 'auroc': 0.9502269, 'binary_precision': 0.6166667, 'binary_recall': 0.1423077, 'binary_specificity': 0.99613184, 'binary_f1_score': 0.23125002}
confusion matrix:
      0   1
0  5923  23
1   223  37
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011746_8.png
better model found
persisted
after epoch: 8,now: 2024-06-02 14:40:03.692441,epoch time: 0:28:33.520519,used: 3:47:19.623695,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_10_52_44_seed_1_21011746
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.97735775, 'precision': 0.8408052, 'recall': 0.77158, 'specificity': 0.77158, 'f1': 0.8019494, 'auroc': 0.9789715, 'binary_precision': 0.69675726, 'binary_recall': 0.55131763, 'binary_specificity': 0.9918423, 'binary_f1_score': 0.61556333}
confusion matrix:
       0    1
0  42068  346
1    647  795
---- Validation: 
scalar performance:
{'acc': 0.9752401, 'precision': 0.8741286, 'recall': 0.71964896, 'specificity': 0.71964896, 'f1': 0.7751738, 'auroc': 0.97239864, 'binary_precision': 0.76863754, 'binary_recall': 0.44427934, 'binary_specificity': 0.99501854, 'binary_f1_score': 0.56308854}
confusion matrix:
       0    1
0  17977   90
1    374  299
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96052206, 'precision': 0.9508759, 'recall': 0.5306851, 'specificity': 0.5306851, 'f1': 0.5476669, 'auroc': 0.9624028, 'binary_precision': 0.9411765, 'binary_recall': 0.06153846, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.11552346}
confusion matrix:
      0   1
0  5945   1
1   244  16
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011746_9.png
early stop counter: 1
val acc:0.9752401113510132, best validation acc: 0.9794023633003235, corresponding to test acc:                         0.9603609442710876 / 0.9824363589286804
after epoch: 9,now: 2024-06-02 15:08:36.156547,epoch time: 0:28:32.464106,used: 4:15:52.087801,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_10_52_44_seed_1_21011746
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9775629, 'precision': 0.92135876, 'recall': 0.68761307, 'specificity': 0.68761307, 'f1': 0.7568033, 'auroc': 0.97985184, 'binary_precision': 0.8634921, 'binary_recall': 0.3772538, 'binary_specificity': 0.99797237, 'binary_f1_score': 0.5250965}
confusion matrix:
       0    1
0  42328   86
1    898  544
---- Validation: 
scalar performance:
{'acc': 0.973746, 'precision': 0.9316162, 'recall': 0.65306944, 'specificity': 0.65306944, 'f1': 0.7217507, 'auroc': 0.97226995, 'binary_precision': 0.888412, 'binary_recall': 0.307578, 'binary_specificity': 0.9985609, 'binary_f1_score': 0.45695361}
confusion matrix:
       0    1
0  18041   26
1    466  207
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582662, 'precision': 0.97912973, 'recall': 0.5019231, 'specificity': 0.5019231, 'f1': 0.49317387, 'auroc': 0.9602914, 'binary_precision': 1.0, 'binary_recall': 0.0038461538, 'binary_specificity': 1.0, 'binary_f1_score': 0.007662835}
confusion matrix:
      0  1
0  5946  0
1   259  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011746_10.png
early stop counter: 2
val acc:0.9737460017204285, best validation acc: 0.9794023633003235, corresponding to test acc:                         0.9603609442710876 / 0.9824363589286804
after epoch: 10,now: 2024-06-02 15:37:07.419540,epoch time: 0:28:31.262993,used: 4:44:23.350794,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_10_52_44_seed_1_21011746
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98150766, 'precision': 0.88580036, 'recall': 0.7985119, 'specificity': 0.7985119, 'f1': 0.8361565, 'auroc': 0.98102736, 'binary_precision': 0.7850045, 'binary_recall': 0.6026352, 'binary_specificity': 0.99438864, 'binary_f1_score': 0.68183595}
confusion matrix:
       0    1
0  42176  238
1    573  869
---- Validation: 
scalar performance:
{'acc': 0.9790288, 'precision': 0.92393136, 'recall': 0.7445024, 'specificity': 0.7445024, 'f1': 0.8083494, 'auroc': 0.96977043, 'binary_precision': 0.86649215, 'binary_recall': 0.49182764, 'binary_specificity': 0.9971772, 'binary_f1_score': 0.62748814}
confusion matrix:
       0    1
0  18016   51
1    342  331
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590719, 'precision': 0.8796643, 'recall': 0.51521647, 'specificity': 0.51521647, 'f1': 0.5191701, 'auroc': 0.9348424, 'binary_precision': 0.8, 'binary_recall': 0.03076923, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.05925926}
confusion matrix:
      0  1
0  5944  2
1   252  8
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011746_11.png
early stop counter: 3
val acc:0.9790288209915161, best validation acc: 0.9794023633003235, corresponding to test acc:                         0.9603609442710876 / 0.9824363589286804
after epoch: 11,now: 2024-06-02 16:05:41.444072,epoch time: 0:28:34.024532,used: 5:12:57.375326,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_10_52_44_seed_1_21011746
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.980892, 'precision': 0.9126929, 'recall': 0.75632465, 'specificity': 0.75632465, 'f1': 0.8149553, 'auroc': 0.9830096, 'binary_precision': 0.84162897, 'binary_recall': 0.5159501, 'binary_specificity': 0.9966992, 'binary_f1_score': 0.63972485}
confusion matrix:
       0    1
0  42274  140
1    698  744
---- Validation: 
scalar performance:
{'acc': 0.97710776, 'precision': 0.9398367, 'recall': 0.7027359, 'specificity': 0.7027359, 'f1': 0.77457416, 'auroc': 0.9784205, 'binary_precision': 0.9013158, 'binary_recall': 0.40713224, 'binary_specificity': 0.99833953, 'binary_f1_score': 0.5609007}
confusion matrix:
       0    1
0  18037   30
1    399  274
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95955527, 'precision': 0.97974825, 'recall': 0.5173077, 'specificity': 0.5173077, 'f1': 0.5231221, 'auroc': 0.9656446, 'binary_precision': 1.0, 'binary_recall': 0.034615386, 'binary_specificity': 1.0, 'binary_f1_score': 0.0669145}
confusion matrix:
      0  1
0  5946  0
1   251  9
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011746_12.png
early stop counter: 4
val acc:0.9771077632904053, best validation acc: 0.9794023633003235, corresponding to test acc:                         0.9603609442710876 / 0.9824363589286804
after epoch: 12,now: 2024-06-02 16:34:13.341430,epoch time: 0:28:31.897358,used: 5:41:29.272684,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_10_52_44_seed_1_21011746
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9828986, 'precision': 0.91055083, 'recall': 0.7972213, 'specificity': 0.7972213, 'f1': 0.8441465, 'auroc': 0.98563206, 'binary_precision': 0.8346228, 'binary_recall': 0.5984743, 'binary_specificity': 0.99596834, 'binary_f1_score': 0.69709206}
confusion matrix:
       0    1
0  42243  171
1    579  863
---- Validation: 
scalar performance:
{'acc': 0.97956246, 'precision': 0.92056584, 'recall': 0.75622344, 'specificity': 0.75622344, 'f1': 0.81693065, 'auroc': 0.97873163, 'binary_precision': 0.8589109, 'binary_recall': 0.51560175, 'binary_specificity': 0.99684507, 'binary_f1_score': 0.64438254}
confusion matrix:
       0    1
0  18010   57
1    326  347
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959233, 'precision': 0.754943, 'recall': 0.5778261, 'specificity': 0.5778261, 'f1': 0.6141529, 'auroc': 0.957381, 'binary_precision': 0.54545456, 'binary_recall': 0.16153847, 'binary_specificity': 0.9941137, 'binary_f1_score': 0.24925816}
confusion matrix:
      0   1
0  5911  35
1   218  42
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011746_13.png
better model found
persisted
after epoch: 13,now: 2024-06-02 17:02:48.753484,epoch time: 0:28:35.412054,used: 6:10:04.684738,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_10_52_44_seed_1_21011746
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9821005, 'precision': 0.85408056, 'recall': 0.871838, 'specificity': 0.871838, 'f1': 0.8627227, 'auroc': 0.9826173, 'binary_precision': 0.7165458, 'binary_recall': 0.75381416, 'binary_specificity': 0.98986185, 'binary_f1_score': 0.7347076}
confusion matrix:
       0     1
0  41984   430
1    355  1087
---- Validation: 
scalar performance:
{'acc': 0.982604, 'precision': 0.8916365, 'recall': 0.8443482, 'specificity': 0.8443482, 'f1': 0.86633945, 'auroc': 0.98019516, 'binary_precision': 0.79456705, 'binary_recall': 0.69539374, 'binary_specificity': 0.9933027, 'binary_f1_score': 0.74167985}
confusion matrix:
       0    1
0  17946  121
1    205  468
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96132773, 'precision': 0.8317251, 'recall': 0.56604636, 'specificity': 0.56604636, 'f1': 0.6029875, 'auroc': 0.94991785, 'binary_precision': 0.7, 'binary_recall': 0.13461539, 'binary_specificity': 0.9974773, 'binary_f1_score': 0.22580646}
confusion matrix:
      0   1
0  5931  15
1   225  35
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011746_14.png
better model found
persisted
after epoch: 14,now: 2024-06-02 17:31:24.118479,epoch time: 0:28:35.364995,used: 6:38:40.049733,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_10_52_44_seed_1_21011746
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98371947, 'precision': 0.88456494, 'recall': 0.8488934, 'specificity': 0.8488934, 'f1': 0.8657911, 'auroc': 0.9854975, 'binary_precision': 0.7791411, 'binary_recall': 0.70457697, 'binary_specificity': 0.9932098, 'binary_f1_score': 0.73998547}
confusion matrix:
       0     1
0  42126   288
1    426  1016
---- Validation: 
scalar performance:
{'acc': 0.9822839, 'precision': 0.90520346, 'recall': 0.8198631, 'specificity': 0.8198631, 'f1': 0.8570911, 'auroc': 0.97711587, 'binary_precision': 0.8235294, 'binary_recall': 0.6448737, 'binary_specificity': 0.9948525, 'binary_f1_score': 0.7233333}
confusion matrix:
       0    1
0  17974   93
1    239  434
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611666, 'precision': 0.8595747, 'recall': 0.5530894, 'specificity': 0.5530894, 'f1': 0.5843297, 'auroc': 0.96037936, 'binary_precision': 0.7567568, 'binary_recall': 0.10769231, 'binary_specificity': 0.9984864, 'binary_f1_score': 0.1885522}
confusion matrix:
      0   1
0  5937   9
1   232  28
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011746_15.png
early stop counter: 1
val acc:0.982283890247345, best validation acc: 0.9826040267944336, corresponding to test acc:                         0.9613277316093445 / 0.9824363589286804
after epoch: 15,now: 2024-06-02 17:59:56.674670,epoch time: 0:28:32.556191,used: 7:07:12.605924,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_10_52_44_seed_1_21011746
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9775173, 'precision': 0.80236185, 'recall': 0.9331094, 'specificity': 0.9331094, 'f1': 0.8548775, 'auroc': 0.9834261, 'binary_precision': 0.60867494, 'binary_recall': 0.8855756, 'binary_specificity': 0.9806432, 'binary_f1_score': 0.721469}
confusion matrix:
       0     1
0  41593   821
1    165  1277
---- Validation: 
scalar performance:
{'acc': 0.97876203, 'precision': 0.82707083, 'recall': 0.9131671, 'specificity': 0.9131671, 'f1': 0.86456865, 'auroc': 0.97822785, 'binary_precision': 0.6600698, 'binary_recall': 0.8424963, 'binary_specificity': 0.98383796, 'binary_f1_score': 0.74020886}
confusion matrix:
       0    1
0  17775  292
1    106  567
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95987755, 'precision': 0.7506996, 'recall': 0.70137453, 'specificity': 0.70137453, 'f1': 0.7229819, 'auroc': 0.9562414, 'binary_precision': 0.52657, 'binary_recall': 0.41923076, 'binary_specificity': 0.9835183, 'binary_f1_score': 0.46680942}
confusion matrix:
      0    1
0  5848   98
1   151  109
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011746_16.png
early stop counter: 2
val acc:0.9787620306015015, best validation acc: 0.9826040267944336, corresponding to test acc:                         0.9613277316093445 / 0.9824363589286804
after epoch: 16,now: 2024-06-02 18:28:26.713407,epoch time: 0:28:30.038737,used: 7:35:42.644661,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_10_52_44_seed_1_21011746
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9842667, 'precision': 0.9198133, 'recall': 0.81367135, 'specificity': 0.81367135, 'f1': 0.8585006, 'auroc': 0.98762393, 'binary_precision': 0.8520599, 'binary_recall': 0.63106793, 'binary_specificity': 0.9962748, 'binary_f1_score': 0.72509956}
confusion matrix:
       0    1
0  42256  158
1    532  910
---- Validation: 
scalar performance:
{'acc': 0.98116326, 'precision': 0.9230164, 'recall': 0.7813728, 'specificity': 0.7813728, 'f1': 0.83685046, 'auroc': 0.97156894, 'binary_precision': 0.8619909, 'binary_recall': 0.5661218, 'binary_specificity': 0.9966237, 'binary_f1_score': 0.683408}
confusion matrix:
       0    1
0  18006   61
1    292  381
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9634225, 'precision': 0.90767187, 'recall': 0.5763345, 'specificity': 0.5763345, 'f1': 0.6209169, 'auroc': 0.94288564, 'binary_precision': 0.85106385, 'binary_recall': 0.15384616, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.26058632}
confusion matrix:
      0   1
0  5939   7
1   220  40
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011746_17.png
early stop counter: 3
val acc:0.9811632633209229, best validation acc: 0.9826040267944336, corresponding to test acc:                         0.9613277316093445 / 0.9824363589286804
after epoch: 17,now: 2024-06-02 18:56:55.782793,epoch time: 0:28:29.069386,used: 8:04:11.714047,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_10_52_44_seed_1_21011746
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9826478, 'precision': 0.9171099, 'recall': 0.7857033, 'specificity': 0.7857033, 'f1': 0.83824253, 'auroc': 0.98851377, 'binary_precision': 0.84851587, 'binary_recall': 0.574896, 'binary_specificity': 0.99651057, 'binary_f1_score': 0.68540716}
confusion matrix:
       0    1
0  42266  148
1    613  829
---- Validation: 
scalar performance:
{'acc': 0.9791889, 'precision': 0.9100667, 'recall': 0.75889075, 'specificity': 0.75889075, 'f1': 0.8160696, 'auroc': 0.97589934, 'binary_precision': 0.83770883, 'binary_recall': 0.5215453, 'binary_specificity': 0.9962362, 'binary_f1_score': 0.64285713}
confusion matrix:
       0    1
0  17999   68
1    322  351
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589107, 'precision': 0.9080843, 'recall': 0.51145434, 'specificity': 0.51145434, 'f1': 0.5119738, 'auroc': 0.95217836, 'binary_precision': 0.85714287, 'binary_recall': 0.023076924, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.04494382}
confusion matrix:
      0  1
0  5945  1
1   254  6
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011746_18.png
early stop counter: 4
val acc:0.9791889190673828, best validation acc: 0.9826040267944336, corresponding to test acc:                         0.9613277316093445 / 0.9824363589286804
after epoch: 18,now: 2024-06-02 19:25:27.495926,epoch time: 0:28:31.713133,used: 8:32:43.427180,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_10_52_44_seed_1_21011746
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.97671926, 'precision': 0.7988144, 'recall': 0.9192987, 'specificity': 0.9192987, 'f1': 0.8478725, 'auroc': 0.9847364, 'binary_precision': 0.60253286, 'binary_recall': 0.85783637, 'binary_specificity': 0.98076105, 'binary_f1_score': 0.7078684}
confusion matrix:
       0     1
0  41598   816
1    205  1237
---- Validation: 
scalar performance:
{'acc': 0.97620064, 'precision': 0.81372964, 'recall': 0.8875196, 'specificity': 0.8875196, 'f1': 0.84631324, 'auroc': 0.97407526, 'binary_precision': 0.6352801, 'binary_recall': 0.7919762, 'binary_specificity': 0.98306304, 'binary_f1_score': 0.7050264}
confusion matrix:
       0    1
0  17761  306
1    140  533
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96165, 'precision': 0.7887046, 'recall': 0.6140282, 'specificity': 0.6140282, 'f1': 0.6595706, 'auroc': 0.94977844, 'binary_precision': 0.61, 'binary_recall': 0.23461539, 'binary_specificity': 0.993441, 'binary_f1_score': 0.33888888}
confusion matrix:
      0   1
0  5907  39
1   199  61
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011746_19.png
early stop counter: 5
val acc:0.9762006402015686, best validation acc: 0.9826040267944336, corresponding to test acc:                         0.9613277316093445 / 0.9824363589286804
after epoch: 19,now: 2024-06-02 19:53:57.486867,epoch time: 0:28:29.990941,used: 9:01:13.418121,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_10_52_44_seed_1_21011746
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.985498, 'precision': 0.89476824, 'recall': 0.8709149, 'specificity': 0.8709149, 'f1': 0.88243985, 'auroc': 0.99080515, 'binary_precision': 0.7980769, 'binary_recall': 0.7482663, 'binary_specificity': 0.9935635, 'binary_f1_score': 0.7723693}
confusion matrix:
       0     1
0  42141   273
1    363  1079
---- Validation: 
scalar performance:
{'acc': 0.98313767, 'precision': 0.9016021, 'recall': 0.84033334, 'specificity': 0.84033334, 'f1': 0.86822087, 'auroc': 0.9788413, 'binary_precision': 0.8148148, 'binary_recall': 0.68647844, 'binary_specificity': 0.9941883, 'binary_f1_score': 0.74516135}
confusion matrix:
       0    1
0  17962  105
1    211  462
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9655172, 'precision': 0.8567972, 'recall': 0.6325972, 'specificity': 0.6325972, 'f1': 0.6888663, 'auroc': 0.96851456, 'binary_precision': 0.7446808, 'binary_recall': 0.26923078, 'binary_specificity': 0.9959637, 'binary_f1_score': 0.39548022}
confusion matrix:
      0   1
0  5922  24
1   190  70
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011746_20.png
better model found
persisted
after epoch: 20,now: 2024-06-02 20:22:31.787267,epoch time: 0:28:34.300400,used: 9:29:47.718521,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_10_52_44_seed_1_21011746
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9868205, 'precision': 0.9311713, 'recall': 0.8491568, 'specificity': 0.8491568, 'f1': 0.88553596, 'auroc': 0.990147, 'binary_precision': 0.8724138, 'binary_recall': 0.701803, 'binary_specificity': 0.99651057, 'binary_f1_score': 0.7778632}
confusion matrix:
       0     1
0  42266   148
1    430  1012
---- Validation: 
scalar performance:
{'acc': 0.98223054, 'precision': 0.92351663, 'recall': 0.79909265, 'specificity': 0.79909265, 'f1': 0.8497486, 'auroc': 0.97986543, 'binary_precision': 0.86170214, 'binary_recall': 0.60178304, 'binary_specificity': 0.99640226, 'binary_f1_score': 0.7086614}
confusion matrix:
       0    1
0  18002   65
1    268  405
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589107, 'precision': 0.75658864, 'recall': 0.5500731, 'specificity': 0.5500731, 'f1': 0.57684404, 'auroc': 0.95126116, 'binary_precision': 0.5510204, 'binary_recall': 0.103846155, 'binary_specificity': 0.99630004, 'binary_f1_score': 0.17475729}
confusion matrix:
      0   1
0  5924  22
1   233  27
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011746_21.png
early stop counter: 1
val acc:0.982230544090271, best validation acc: 0.9831376671791077, corresponding to test acc:                         0.9655172228813171 / 0.9824363589286804
after epoch: 21,now: 2024-06-02 20:51:04.735276,epoch time: 0:28:32.948009,used: 9:58:20.666530,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_10_52_44_seed_1_21011746
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9844263, 'precision': 0.8792091, 'recall': 0.87438023, 'specificity': 0.87438023, 'f1': 0.8767779, 'auroc': 0.98743165, 'binary_precision': 0.7666901, 'binary_recall': 0.7565881, 'binary_specificity': 0.9921724, 'binary_f1_score': 0.76160556}
confusion matrix:
       0     1
0  42082   332
1    351  1091
---- Validation: 
scalar performance:
{'acc': 0.97940236, 'precision': 0.86573136, 'recall': 0.82051444, 'specificity': 0.82051444, 'f1': 0.8414968, 'auroc': 0.9697044, 'binary_precision': 0.7444634, 'binary_recall': 0.64933133, 'binary_specificity': 0.99169755, 'binary_f1_score': 0.6936508}
confusion matrix:
       0    1
0  17917  150
1    236  437
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96132773, 'precision': 0.803909, 'recall': 0.5844362, 'specificity': 0.5844362, 'f1': 0.6264315, 'auroc': 0.91466534, 'binary_precision': 0.64285713, 'binary_recall': 0.17307693, 'binary_specificity': 0.9957955, 'binary_f1_score': 0.27272728}
confusion matrix:
      0   1
0  5921  25
1   215  45
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011746_22.png
early stop counter: 2
val acc:0.9794023633003235, best validation acc: 0.9831376671791077, corresponding to test acc:                         0.9655172228813171 / 0.9824363589286804
after epoch: 22,now: 2024-06-02 21:19:37.350783,epoch time: 0:28:32.615507,used: 10:26:53.282037,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_10_52_44_seed_1_21011746
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.98620486, 'precision': 0.89435476, 'recall': 0.8866881, 'specificity': 0.8866881, 'f1': 0.89048076, 'auroc': 0.9897666, 'binary_precision': 0.79617834, 'binary_recall': 0.78016645, 'binary_specificity': 0.9932098, 'binary_f1_score': 0.7880911}
confusion matrix:
       0     1
0  42126   288
1    317  1125
---- Validation: 
scalar performance:
{'acc': 0.98207045, 'precision': 0.89152145, 'recall': 0.83405775, 'specificity': 0.83405775, 'f1': 0.86031556, 'auroc': 0.9706422, 'binary_precision': 0.79509634, 'binary_recall': 0.67459136, 'binary_specificity': 0.99352413, 'binary_f1_score': 0.7299036}
confusion matrix:
       0    1
0  17950  117
1    219  454
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589107, 'precision': 0.7662685, 'recall': 0.5372002, 'specificity': 0.5372002, 'f1': 0.5572742, 'auroc': 0.9223428, 'binary_precision': 0.5714286, 'binary_recall': 0.07692308, 'binary_specificity': 0.9974773, 'binary_f1_score': 0.13559324}
confusion matrix:
      0   1
0  5931  15
1   240  20
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011746_23.png
early stop counter: 3
val acc:0.9820704460144043, best validation acc: 0.9831376671791077, corresponding to test acc:                         0.9655172228813171 / 0.9824363589286804
after epoch: 23,now: 2024-06-02 21:48:10.671989,epoch time: 0:28:33.321206,used: 10:55:26.603243,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_10_52_44_seed_1_21011746
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.98383343, 'precision': 0.8556404, 'recall': 0.91460294, 'specificity': 0.91460294, 'f1': 0.8826583, 'auroc': 0.9890543, 'binary_precision': 0.71673566, 'binary_recall': 0.8404993, 'binary_specificity': 0.9887066, 'binary_f1_score': 0.7736993}
confusion matrix:
       0     1
0  41935   479
1    230  1212
---- Validation: 
scalar performance:
{'acc': 0.98297757, 'precision': 0.8713894, 'recall': 0.8888885, 'specificity': 0.8888885, 'f1': 0.87991834, 'auroc': 0.97514254, 'binary_precision': 0.7507082, 'binary_recall': 0.78751856, 'binary_specificity': 0.99025846, 'binary_f1_score': 0.76867294}
confusion matrix:
       0    1
0  17891  176
1    143  530
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96084434, 'precision': 0.821916, 'recall': 0.5602771, 'specificity': 0.5602771, 'f1': 0.59419733, 'auroc': 0.96278846, 'binary_precision': 0.68085104, 'binary_recall': 0.12307692, 'binary_specificity': 0.9974773, 'binary_f1_score': 0.20846906}
confusion matrix:
      0   1
0  5931  15
1   228  32
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011746_24.png
early stop counter: 4
val acc:0.982977569103241, best validation acc: 0.9831376671791077, corresponding to test acc:                         0.9655172228813171 / 0.9824363589286804
after epoch: 24,now: 2024-06-02 22:16:44.047265,epoch time: 0:28:33.375276,used: 11:23:59.978519,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_10_52_44_seed_1_21011746
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.98501915, 'precision': 0.9196471, 'recall': 0.8281284, 'specificity': 0.8281284, 'f1': 0.8678719, 'auroc': 0.9900325, 'binary_precision': 0.8507596, 'binary_recall': 0.66019416, 'binary_specificity': 0.99606264, 'binary_f1_score': 0.7434596}
confusion matrix:
       0    1
0  42247  167
1    490  952
---- Validation: 
scalar performance:
{'acc': 0.9806297, 'precision': 0.9219584, 'recall': 0.77322805, 'specificity': 0.77322805, 'f1': 0.83045936, 'auroc': 0.97475123, 'binary_precision': 0.8604651, 'binary_recall': 0.5497771, 'binary_specificity': 0.996679, 'binary_f1_score': 0.67089754}
confusion matrix:
       0    1
0  18007   60
1    303  370
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95987755, 'precision': 0.94151586, 'recall': 0.52299285, 'specificity': 0.52299285, 'f1': 0.5336998, 'auroc': 0.94907355, 'binary_precision': 0.9230769, 'binary_recall': 0.046153847, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.08791209}
confusion matrix:
      0   1
0  5945   1
1   248  12
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011746_25.png
early stop counter: 5
val acc:0.9806296825408936, best validation acc: 0.9831376671791077, corresponding to test acc:                         0.9655172228813171 / 0.9824363589286804
after epoch: 25,now: 2024-06-02 22:45:15.868538,epoch time: 0:28:31.821273,used: 11:52:31.799792,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_10_52_44_seed_1_21011746
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9865013, 'precision': 0.92134887, 'recall': 0.85435104, 'specificity': 0.85435104, 'f1': 0.88473773, 'auroc': 0.9896416, 'binary_precision': 0.85240465, 'binary_recall': 0.71289873, 'binary_specificity': 0.9958033, 'binary_f1_score': 0.776435}
confusion matrix:
       0     1
0  42236   178
1    414  1028
---- Validation: 
scalar performance:
{'acc': 0.98340446, 'precision': 0.9308857, 'recall': 0.81186104, 'specificity': 0.81186104, 'f1': 0.86108714, 'auroc': 0.98031706, 'binary_precision': 0.8755187, 'binary_recall': 0.62704307, 'binary_specificity': 0.996679, 'binary_f1_score': 0.7307359}
confusion matrix:
       0    1
0  18007   60
1    251  422
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96052206, 'precision': 0.90900797, 'recall': 0.5343631, 'specificity': 0.5343631, 'f1': 0.55395883, 'auroc': 0.95987976, 'binary_precision': 0.85714287, 'binary_recall': 0.06923077, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.12811388}
confusion matrix:
      0   1
0  5943   3
1   242  18
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011746_26.png
better model found
persisted
after epoch: 26,now: 2024-06-02 23:13:48.546052,epoch time: 0:28:32.677514,used: 12:21:04.477306,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_10_52_44_seed_1_21011746
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9874362, 'precision': 0.9063742, 'recall': 0.89301884, 'specificity': 0.89301884, 'f1': 0.89957595, 'auroc': 0.9932416, 'binary_precision': 0.8198134, 'binary_recall': 0.7919556, 'binary_specificity': 0.99408215, 'binary_f1_score': 0.8056437}
confusion matrix:
       0     1
0  42163   251
1    300  1142
---- Validation: 
scalar performance:
{'acc': 0.98148346, 'precision': 0.8831018, 'recall': 0.83518386, 'specificity': 0.83518386, 'f1': 0.85740215, 'auroc': 0.97709394, 'binary_precision': 0.778157, 'binary_recall': 0.67756313, 'binary_specificity': 0.9928046, 'binary_f1_score': 0.72438437}
confusion matrix:
       0    1
0  17937  130
1    217  456
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96036094, 'precision': 0.8281784, 'recall': 0.5471519, 'specificity': 0.5471519, 'f1': 0.57430756, 'auroc': 0.9473928, 'binary_precision': 0.6944444, 'binary_recall': 0.09615385, 'binary_specificity': 0.99815, 'binary_f1_score': 0.16891892}
confusion matrix:
      0   1
0  5935  11
1   235  25
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011746_27.png
early stop counter: 1
val acc:0.9814834594726562, best validation acc: 0.9834044575691223, corresponding to test acc:                         0.9605220556259155 / 0.9824363589286804
after epoch: 27,now: 2024-06-02 23:42:27.112607,epoch time: 0:28:38.566555,used: 12:49:43.043861,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_10_52_44_seed_1_21011746
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9816673, 'precision': 0.9475305, 'recall': 0.7439973, 'specificity': 0.7439973, 'f1': 0.8138901, 'auroc': 0.991602, 'binary_precision': 0.9121447, 'binary_recall': 0.48959777, 'binary_specificity': 0.99839675, 'binary_f1_score': 0.63718414}
confusion matrix:
       0    1
0  42346   68
1    736  706
---- Validation: 
scalar performance:
{'acc': 0.9766809, 'precision': 0.91306746, 'recall': 0.7125282, 'specificity': 0.7125282, 'f1': 0.7783123, 'auroc': 0.9799901, 'binary_precision': 0.84705883, 'binary_recall': 0.42793462, 'binary_specificity': 0.9971218, 'binary_f1_score': 0.5686081}
confusion matrix:
       0    1
0  18015   52
1    385  288
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95681596, 'precision': 0.61828446, 'recall': 0.5085222, 'specificity': 0.5085222, 'f1': 0.5069423, 'auroc': 0.9355295, 'binary_precision': 0.2777778, 'binary_recall': 0.01923077, 'binary_specificity': 0.99781364, 'binary_f1_score': 0.035971224}
confusion matrix:
      0   1
0  5933  13
1   255   5
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011746_28.png
early stop counter: 2
val acc:0.9766808748245239, best validation acc: 0.9834044575691223, corresponding to test acc:                         0.9605220556259155 / 0.9824363589286804
after epoch: 28,now: 2024-06-03 00:10:11.852833,epoch time: 0:27:44.740226,used: 13:17:27.784087,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_10_52_44_seed_1_21011746
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9876414, 'precision': 0.8826513, 'recall': 0.94132066, 'specificity': 0.94132066, 'f1': 0.9097144, 'auroc': 0.9945153, 'binary_precision': 0.7690006, 'binary_recall': 0.8917419, 'binary_specificity': 0.99089944, 'binary_f1_score': 0.8258354}
confusion matrix:
       0     1
0  42029   386
1    156  1285
---- Validation: 
scalar performance:
{'acc': 0.9827108, 'precision': 0.86596453, 'recall': 0.89518756, 'specificity': 0.89518756, 'f1': 0.8799605, 'auroc': 0.98009646, 'binary_precision': 0.739369, 'binary_recall': 0.8008915, 'binary_specificity': 0.9894836, 'binary_f1_score': 0.7689015}
confusion matrix:
       0    1
0  17877  190
1    134  539
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621334, 'precision': 0.787899, 'recall': 0.63267034, 'specificity': 0.63267034, 'f1': 0.67856574, 'auroc': 0.94501424, 'binary_precision': 0.60683763, 'binary_recall': 0.27307692, 'binary_specificity': 0.99226373, 'binary_f1_score': 0.37665784}
confusion matrix:
      0   1
0  5900  46
1   189  71
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011746_29.png
early stop counter: 3
val acc:0.9827107787132263, best validation acc: 0.9834044575691223, corresponding to test acc:                         0.9605220556259155 / 0.9824363589286804
after epoch: 29,now: 2024-06-03 00:38:09.590772,epoch time: 0:27:57.737939,used: 13:45:25.522026,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_10_52_44_seed_1_21011746
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9880746, 'precision': 0.92243457, 'recall': 0.88296545, 'specificity': 0.88296545, 'f1': 0.90165824, 'auroc': 0.99382675, 'binary_precision': 0.8526477, 'binary_recall': 0.7704577, 'binary_specificity': 0.9954732, 'binary_f1_score': 0.8094718}
confusion matrix:
       0     1
0  42222   192
1    331  1111
---- Validation: 
scalar performance:
{'acc': 0.98388475, 'precision': 0.91367984, 'recall': 0.838575, 'specificity': 0.838575, 'f1': 0.8720651, 'auroc': 0.97700727, 'binary_precision': 0.8391225, 'binary_recall': 0.6820208, 'binary_specificity': 0.9951292, 'binary_f1_score': 0.752459}
confusion matrix:
       0    1
0  17979   88
1    214  459
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96019983, 'precision': 0.800477, 'recall': 0.5562628, 'specificity': 0.5562628, 'f1': 0.5875175, 'auroc': 0.9537276, 'binary_precision': 0.63829786, 'binary_recall': 0.115384616, 'binary_specificity': 0.99714094, 'binary_f1_score': 0.19543974}
confusion matrix:
      0   1
0  5929  17
1   230  30
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011746_30.png
better model found
persisted
after epoch: 30,now: 2024-06-03 01:06:14.079296,epoch time: 0:28:04.488524,used: 14:13:30.010550,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_10_52_44_seed_1_21011746
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 14:13:30.010550 at 2024-06-03 01:06:14.079296
persisted model performance metric: 

scalar performance:
{'acc': 0.959233, 'precision': 0.77800727, 'recall': 0.5410463, 'specificity': 0.5410463, 'f1': 0.5636325, 'auroc': 0.9528544, 'binary_precision': 0.5945946, 'binary_recall': 0.08461539, 'binary_specificity': 0.9974773, 'binary_f1_score': 0.14814815}
confusion matrix:
      0   1
0  5931  15
1   238  22
oracle model performance metric: 

scalar performance:
{'acc': 0.98018044, 'precision': 0.89071745, 'recall': 0.85173285, 'specificity': 0.85173285, 'f1': 0.8700937, 'auroc': 0.95526075, 'binary_precision': 0.7939914, 'binary_recall': 0.71153843, 'binary_specificity': 0.9919273, 'binary_f1_score': 0.75050706}
confusion matrix:
      0    1
0  5898   48
1    75  185
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456479 KiB |  13219 MiB |   2240 TiB |   2240 TiB |
|       from large pool | 414803 KiB |  13181 MiB |   2213 TiB |   2213 TiB |
|       from small pool |  41675 KiB |     61 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 456479 KiB |  13219 MiB |   2240 TiB |   2240 TiB |
|       from large pool | 414803 KiB |  13181 MiB |   2213 TiB |   2213 TiB |
|       from small pool |  41675 KiB |     61 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447751 KiB |  13213 MiB |   2231 TiB |   2231 TiB |
|       from large pool | 407075 KiB |  13175 MiB |   2205 TiB |   2205 TiB |
|       from small pool |  40676 KiB |     60 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14478 MiB |  14478 MiB |  28044 MiB |  13566 MiB |
|       from large pool |  14412 MiB |  14412 MiB |  27960 MiB |  13548 MiB |
|       from small pool |     66 MiB |     70 MiB |     84 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 446689 KiB |   1232 MiB |   1572 TiB |   1572 TiB |
|       from large pool | 435116 KiB |   1229 MiB |   1546 TiB |   1546 TiB |
|       from small pool |  11572 KiB |     42 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3464    |    6487    |  395836 K  |  395832 K  |
|       from large pool |     187    |    1413    |  205680 K  |  205679 K  |
|       from small pool |    3277    |    6298    |  190156 K  |  190152 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3464    |    6487    |  395836 K  |  395832 K  |
|       from large pool |     187    |    1413    |  205680 K  |  205679 K  |
|       from small pool |    3277    |    6298    |  190156 K  |  190152 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     635    |     636    |    1207    |     572    |
|       from large pool |     602    |     602    |    1165    |     563    |
|       from small pool |      33    |      35    |      42    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      80    |    2805    |  264309 K  |  264309 K  |
|       from large pool |      38    |     605    |  162402 K  |  162402 K  |
|       from small pool |      42    |    2767    |  101906 K  |  101906 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   2240 TiB |   2240 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   2213 TiB |   2213 TiB |
|       from small pool |      0 KiB |     61 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   2240 TiB |   2240 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   2213 TiB |   2213 TiB |
|       from small pool |      0 KiB |     61 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   2231 TiB |   2231 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   2205 TiB |   2205 TiB |
|       from small pool |      0 KiB |     60 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14478 MiB |  28044 MiB |  27162 MiB |
|       from large pool |    830 MiB |  14412 MiB |  27960 MiB |  27130 MiB |
|       from small pool |     52 MiB |     70 MiB |     84 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1232 MiB |   1572 TiB |   1572 TiB |
|       from large pool |  24320 KiB |   1229 MiB |   1546 TiB |   1546 TiB |
|       from small pool |      0 KiB |     42 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6487    |  395836 K  |  395836 K  |
|       from large pool |       2    |    1413    |  205680 K  |  205680 K  |
|       from small pool |       0    |    6298    |  190156 K  |  190156 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6487    |  395836 K  |  395836 K  |
|       from large pool |       2    |    1413    |  205680 K  |  205680 K  |
|       from small pool |       0    |    6298    |  190156 K  |  190156 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     636    |    1207    |    1144    |
|       from large pool |      37    |     602    |    1165    |    1128    |
|       from small pool |      26    |      35    |      42    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2805    |  264310 K  |  264310 K  |
|       from large pool |       4    |     605    |  162402 K  |  162402 K  |
|       from small pool |       0    |    2767    |  101908 K  |  101908 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   2240 TiB |   2240 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   2213 TiB |   2213 TiB |
|       from small pool |      0 KiB |     61 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   2240 TiB |   2240 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   2213 TiB |   2213 TiB |
|       from small pool |      0 KiB |     61 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   2231 TiB |   2231 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   2205 TiB |   2205 TiB |
|       from small pool |      0 KiB |     60 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14478 MiB |  28044 MiB |  27162 MiB |
|       from large pool |    830 MiB |  14412 MiB |  27960 MiB |  27130 MiB |
|       from small pool |     52 MiB |     70 MiB |     84 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1232 MiB |   1572 TiB |   1572 TiB |
|       from large pool |  24320 KiB |   1229 MiB |   1546 TiB |   1546 TiB |
|       from small pool |      0 KiB |     42 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6487    |  395836 K  |  395836 K  |
|       from large pool |       2    |    1413    |  205680 K  |  205680 K  |
|       from small pool |       0    |    6298    |  190156 K  |  190156 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6487    |  395836 K  |  395836 K  |
|       from large pool |       2    |    1413    |  205680 K  |  205680 K  |
|       from small pool |       0    |    6298    |  190156 K  |  190156 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     636    |    1207    |    1144    |
|       from large pool |      37    |     602    |    1165    |    1128    |
|       from small pool |      26    |      35    |      42    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2805    |  264310 K  |  264310 K  |
|       from large pool |       4    |     605    |  162402 K  |  162402 K  |
|       from small pool |       0    |    2767    |  101908 K  |  101908 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_01_12_25_seed_2_21011746

 Experiment start at: 2024-06-03 01:12:25.770362
before training, model accuracy: 0.7911646366119385
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9927425, 'precision': 0.9761581, 'recall': 0.982703, 'specificity': 0.982703, 'f1': 0.979402, 'auroc': 0.9984288, 'binary_precision': 0.95551217, 'binary_recall': 0.9702512, 'binary_specificity': 0.9951548, 'binary_f1_score': 0.9628253}
confusion matrix:
       0     1
0  42105   205
1    135  4403
---- Validation: 
scalar performance:
{'acc': 0.9665477, 'precision': 0.7289222, 'recall': 0.7104863, 'specificity': 0.7104863, 'f1': 0.71927464, 'auroc': 0.92456913, 'binary_precision': 0.47644928, 'binary_recall': 0.43687707, 'binary_specificity': 0.9840955, 'binary_f1_score': 0.45580587}
confusion matrix:
       0    1
0  17882  289
1    339  263
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99628145, 'precision': 0.9960499, 'recall': 0.9845984, 'specificity': 0.9845984, 'f1': 0.9902365, 'auroc': 0.99903, 'binary_precision': 0.99575675, 'binary_recall': 0.969697, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.9825541}
confusion matrix:
      0    1
0  5994    3
1    22  704
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011746_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-03 01:36:20.597114,epoch time: 0:23:54.826752,used: 0:23:54.826752,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_01_12_25_seed_2_21011746
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9959443, 'precision': 0.99694145, 'recall': 0.97985256, 'specificity': 0.97985256, 'f1': 0.9882079, 'auroc': 0.99900323, 'binary_precision': 0.9981668, 'binary_recall': 0.95989424, 'binary_specificity': 0.99981093, 'binary_f1_score': 0.9786565}
confusion matrix:
       0     1
0  42302     8
1    182  4356
---- Validation: 
scalar performance:
{'acc': 0.9675598, 'precision': 0.72381413, 'recall': 0.5560208, 'specificity': 0.5560208, 'f1': 0.5851828, 'auroc': 0.9018939, 'binary_precision': 0.47619048, 'binary_recall': 0.11627907, 'binary_specificity': 0.99576247, 'binary_f1_score': 0.18691589}
confusion matrix:
       0   1
0  18094  77
1    532  70
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9955377, 'precision': 0.9975112, 'recall': 0.9793389, 'specificity': 0.9793389, 'f1': 0.988204, 'auroc': 0.99859554, 'binary_precision': 1.0, 'binary_recall': 0.9586777, 'binary_specificity': 1.0, 'binary_f1_score': 0.97890294}
confusion matrix:
      0    1
0  5997    0
1    30  696
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011746_2.png
better model found
persisted
after epoch: 2,now: 2024-06-03 01:59:29.107754,epoch time: 0:23:08.510640,used: 0:47:03.337392,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_01_12_25_seed_2_21011746
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9927638, 'precision': 0.99602556, 'recall': 0.962657, 'specificity': 0.962657, 'f1': 0.9786091, 'auroc': 0.9990431, 'binary_precision': 1.0, 'binary_recall': 0.92531395, 'binary_specificity': 1.0, 'binary_f1_score': 0.9612084}
confusion matrix:
       0     1
0  42309     0
1    339  4200
---- Validation: 
scalar performance:
{'acc': 0.9683588, 'precision': 0.9841727, 'recall': 0.50664455, 'specificity': 0.50664455, 'f1': 0.50507385, 'auroc': 0.9277618, 'binary_precision': 1.0, 'binary_recall': 0.013289036, 'binary_specificity': 1.0, 'binary_f1_score': 0.026229506}
confusion matrix:
       0  1
0  18171  0
1    594  8
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99018294, 'precision': 0.99455714, 'recall': 0.9545455, 'specificity': 0.9545455, 'f1': 0.9734541, 'auroc': 0.99929667, 'binary_precision': 1.0, 'binary_recall': 0.90909094, 'binary_specificity': 1.0, 'binary_f1_score': 0.95238096}
confusion matrix:
      0    1
0  5997    0
1    66  660
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011746_3.png
better model found
persisted
after epoch: 3,now: 2024-06-03 02:22:30.957230,epoch time: 0:23:01.849476,used: 1:10:05.186868,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_01_12_25_seed_2_21011746
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9972037, 'precision': 0.99784815, 'recall': 0.98615956, 'specificity': 0.98615956, 'f1': 0.99191594, 'auroc': 0.9993944, 'binary_precision': 0.9986425, 'binary_recall': 0.97246087, 'binary_specificity': 0.9998582, 'binary_f1_score': 0.9853778}
confusion matrix:
       0     1
0  42303     6
1    125  4414
---- Validation: 
scalar performance:
{'acc': 0.9717147, 'precision': 0.893414, 'recall': 0.57583416, 'specificity': 0.57583416, 'f1': 0.62146276, 'auroc': 0.9487946, 'binary_precision': 0.8141593, 'binary_recall': 0.15282393, 'binary_specificity': 0.9988443, 'binary_f1_score': 0.25734267}
confusion matrix:
       0   1
0  18150  21
1    510  92
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9958352, 'precision': 0.9976764, 'recall': 0.9807162, 'specificity': 0.9807162, 'f1': 0.989004, 'auroc': 0.99940944, 'binary_precision': 1.0, 'binary_recall': 0.9614325, 'binary_specificity': 1.0, 'binary_f1_score': 0.98033714}
confusion matrix:
      0    1
0  5997    0
1    28  698
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011746_4.png
better model found
persisted
after epoch: 4,now: 2024-06-03 02:45:35.458623,epoch time: 0:23:04.501393,used: 1:33:09.688261,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_01_12_25_seed_2_21011746
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.99590164, 'precision': 0.99763787, 'recall': 0.9789483, 'specificity': 0.9789483, 'f1': 0.9880669, 'auroc': 0.9995196, 'binary_precision': 0.99977005, 'binary_recall': 0.95792025, 'binary_specificity': 0.99997634, 'binary_f1_score': 0.97839785}
confusion matrix:
       0     1
0  42308     1
1    191  4348
---- Validation: 
scalar performance:
{'acc': 0.9697438, 'precision': 0.8391061, 'recall': 0.54751235, 'specificity': 0.54751235, 'f1': 0.5770909, 'auroc': 0.93035734, 'binary_precision': 0.70731705, 'binary_recall': 0.096345514, 'binary_specificity': 0.9986792, 'binary_f1_score': 0.16959065}
confusion matrix:
       0   1
0  18147  24
1    544  58
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9924141, 'precision': 0.9951265, 'recall': 0.96548134, 'specificity': 0.96548134, 'f1': 0.97970724, 'auroc': 0.9986813, 'binary_precision': 0.9985229, 'binary_recall': 0.93112946, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.96364933}
confusion matrix:
      0    1
0  5996    1
1    50  676
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011746_5.png
early stop counter: 1
val acc:0.9697437882423401, best validation acc: 0.9717146754264832, corresponding to test acc:                         0.9958351850509644 / 0.9962814450263977
after epoch: 5,now: 2024-06-03 03:08:59.487205,epoch time: 0:23:24.028582,used: 1:56:33.716843,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_01_12_25_seed_2_21011746
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.99647796, 'precision': 0.99785256, 'recall': 0.98202085, 'specificity': 0.98202085, 'f1': 0.98977494, 'auroc': 0.99957, 'binary_precision': 0.9995432, 'binary_recall': 0.96408904, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.98149604}
confusion matrix:
       0     1
0  42307     2
1    163  4376
---- Validation: 
scalar performance:
{'acc': 0.9676663, 'precision': 0.7254676, 'recall': 0.54804534, 'specificity': 0.54804534, 'f1': 0.5742879, 'auroc': 0.9224416, 'binary_precision': 0.48, 'binary_recall': 0.09966777, 'binary_specificity': 0.9964229, 'binary_f1_score': 0.16506189}
confusion matrix:
       0   1
0  18106  65
1    542  60
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9944965, 'precision': 0.99693406, 'recall': 0.97451794, 'specificity': 0.97451794, 'f1': 0.98538804, 'auroc': 0.99815977, 'binary_precision': 1.0, 'binary_recall': 0.9490358, 'binary_specificity': 1.0, 'binary_f1_score': 0.97385156}
confusion matrix:
      0    1
0  5997    0
1    37  689
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011746_6.png
early stop counter: 2
val acc:0.9676663279533386, best validation acc: 0.9717146754264832, corresponding to test acc:                         0.9958351850509644 / 0.9962814450263977
after epoch: 6,now: 2024-06-03 03:32:23.282539,epoch time: 0:23:23.795334,used: 2:19:57.512177,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_01_12_25_seed_2_21011746
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.99660605, 'precision': 0.99802554, 'recall': 0.98258346, 'specificity': 0.98258346, 'f1': 0.99015063, 'auroc': 0.99968386, 'binary_precision': 0.9997718, 'binary_recall': 0.9651906, 'binary_specificity': 0.99997634, 'binary_f1_score': 0.98217684}
confusion matrix:
       0     1
0  42308     1
1    158  4381
---- Validation: 
scalar performance:
{'acc': 0.9673467, 'precision': 0.48395693, 'recall': 0.49969733, 'specificity': 0.49969733, 'f1': 0.4917012, 'auroc': 0.93824244, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99939466, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18160  11
1    602   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9937528, 'precision': 0.99587536, 'recall': 0.9716797, 'specificity': 0.9716797, 'f1': 0.9833824, 'auroc': 0.99879634, 'binary_precision': 0.99854225, 'binary_recall': 0.94352615, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.97025496}
confusion matrix:
      0    1
0  5996    1
1    41  685
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011746_7.png
early stop counter: 3
val acc:0.967346727848053, best validation acc: 0.9717146754264832, corresponding to test acc:                         0.9958351850509644 / 0.9962814450263977
after epoch: 7,now: 2024-06-03 03:55:50.783131,epoch time: 0:23:27.500592,used: 2:43:25.012769,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_01_12_25_seed_2_21011746
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.99731046, 'precision': 0.9917455, 'recall': 0.9929057, 'specificity': 0.9929057, 'f1': 0.9923247, 'auroc': 0.9993044, 'binary_precision': 0.9848385, 'binary_recall': 0.9874422, 'binary_specificity': 0.99836916, 'binary_f1_score': 0.9861386}
confusion matrix:
       0     1
0  42240    69
1     57  4482
---- Validation: 
scalar performance:
{'acc': 0.96532255, 'precision': 0.7298136, 'recall': 0.81826496, 'specificity': 0.81826496, 'f1': 0.76603496, 'auroc': 0.9363858, 'binary_precision': 0.47100592, 'binary_recall': 0.6611296, 'binary_specificity': 0.9754004, 'binary_f1_score': 0.55010366}
confusion matrix:
       0    1
0  17724  447
1    204  398
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.995389, 'precision': 0.9942937, 'recall': 0.9816768, 'specificity': 0.9816768, 'f1': 0.9878783, 'auroc': 0.99890757, 'binary_precision': 0.9929078, 'binary_recall': 0.9641873, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.9783368}
confusion matrix:
      0    1
0  5992    5
1    26  700
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011746_8.png
early stop counter: 4
val acc:0.9653225541114807, best validation acc: 0.9717146754264832, corresponding to test acc:                         0.9958351850509644 / 0.9962814450263977
after epoch: 8,now: 2024-06-03 04:19:09.590153,epoch time: 0:23:18.807022,used: 3:06:43.819791,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_01_12_25_seed_2_21011746
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9980789, 'precision': 0.9961602, 'recall': 0.9928394, 'specificity': 0.9928394, 'f1': 0.9944927, 'auroc': 0.99944615, 'binary_precision': 0.99378467, 'binary_recall': 0.9863406, 'binary_specificity': 0.9993382, 'binary_f1_score': 0.99004865}
confusion matrix:
       0     1
0  42281    28
1     62  4477
---- Validation: 
scalar performance:
{'acc': 0.95866406, 'precision': 0.69361013, 'recall': 0.77868825, 'specificity': 0.77868825, 'f1': 0.72743297, 'auroc': 0.921875, 'binary_precision': 0.40113637, 'binary_recall': 0.58637875, 'binary_specificity': 0.97099775, 'binary_f1_score': 0.47638327}
confusion matrix:
       0    1
0  17644  527
1    249  353
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99598396, 'precision': 0.9904512, 'recall': 0.9886689, 'specificity': 0.9886689, 'f1': 0.9895579, 'auroc': 0.9997457, 'binary_precision': 0.9834025, 'binary_recall': 0.9793388, 'binary_specificity': 0.997999, 'binary_f1_score': 0.9813664}
confusion matrix:
      0    1
0  5985   12
1    15  711
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011746_9.png
early stop counter: 5
val acc:0.958664059638977, best validation acc: 0.9717146754264832, corresponding to test acc:                         0.9958351850509644 / 0.9962814450263977
after epoch: 9,now: 2024-06-03 04:42:27.319982,epoch time: 0:23:17.729829,used: 3:30:01.549620,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_01_12_25_seed_2_21011746
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9968195, 'precision': 0.9931664, 'recall': 0.9886019, 'specificity': 0.9886019, 'f1': 0.9908707, 'auroc': 0.9992331, 'binary_precision': 0.9886465, 'binary_recall': 0.97840935, 'binary_specificity': 0.99879456, 'binary_f1_score': 0.9835013}
confusion matrix:
       0     1
0  42258    51
1     98  4441
---- Validation: 
scalar performance:
{'acc': 0.9642039, 'precision': 0.7070854, 'recall': 0.6843811, 'specificity': 0.6843811, 'f1': 0.69499713, 'auroc': 0.9119415, 'binary_precision': 0.4344569, 'binary_recall': 0.38538206, 'binary_specificity': 0.98338014, 'binary_f1_score': 0.4084507}
confusion matrix:
       0    1
0  17869  302
1    370  232
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9968764, 'precision': 0.9976306, 'recall': 0.9861425, 'specificity': 0.9861425, 'f1': 0.99179864, 'auroc': 0.99977005, 'binary_precision': 0.9985856, 'binary_recall': 0.9724518, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.9853455}
confusion matrix:
      0    1
0  5996    1
1    20  706
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011746_10.png
new oracle model saved
early stop counter: 6
val acc:0.9642038941383362, best validation acc: 0.9717146754264832, corresponding to test acc:                         0.9958351850509644 / 0.9968764185905457
after epoch: 10,now: 2024-06-03 05:05:56.097205,epoch time: 0:23:28.777223,used: 3:53:30.326843,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_01_12_25_seed_2_21011746
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9976093, 'precision': 0.9984777, 'recall': 0.9878565, 'specificity': 0.9878565, 'f1': 0.9930947, 'auroc': 0.99954593, 'binary_precision': 0.99954855, 'binary_recall': 0.9757602, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.98751116}
confusion matrix:
       0     1
0  42308     2
1    110  4428
---- Validation: 
scalar performance:
{'acc': 0.9717147, 'precision': 0.8543663, 'recall': 0.59109205, 'specificity': 0.59109205, 'f1': 0.6401943, 'auroc': 0.9462335, 'binary_precision': 0.7350993, 'binary_recall': 0.18438539, 'binary_specificity': 0.9977987, 'binary_f1_score': 0.29482073}
confusion matrix:
       0    1
0  18131   40
1    491  111
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9952402, 'precision': 0.99734616, 'recall': 0.9779614, 'specificity': 0.9779614, 'f1': 0.98740196, 'auroc': 0.9996892, 'binary_precision': 1.0, 'binary_recall': 0.95592284, 'binary_specificity': 1.0, 'binary_f1_score': 0.9774648}
confusion matrix:
      0    1
0  5997    0
1    32  694
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011746_11.png
early stop counter: 7
val acc:0.9717146754264832, best validation acc: 0.9717146754264832, corresponding to test acc:                         0.9958351850509644 / 0.9968764185905457
after epoch: 11,now: 2024-06-03 05:29:14.136502,epoch time: 0:23:18.039297,used: 4:16:48.366140,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_01_12_25_seed_2_21011746
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99786544, 'precision': 0.9983177, 'recall': 0.9894737, 'specificity': 0.9894737, 'f1': 0.9938456, 'auroc': 0.99974656, 'binary_precision': 0.9988759, 'binary_recall': 0.97906566, 'binary_specificity': 0.9998818, 'binary_f1_score': 0.98887163}
confusion matrix:
       0     1
0  42305     5
1     95  4443
---- Validation: 
scalar performance:
{'acc': 0.97182125, 'precision': 0.86436415, 'recall': 0.58873796, 'specificity': 0.58873796, 'f1': 0.6377791, 'auroc': 0.9430323, 'binary_precision': 0.75524473, 'binary_recall': 0.179402, 'binary_specificity': 0.9980739, 'binary_f1_score': 0.2899329}
confusion matrix:
       0    1
0  18136   35
1    494  108
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99643016, 'precision': 0.9973792, 'recall': 0.9840764, 'specificity': 0.9840764, 'f1': 0.9906097, 'auroc': 0.9997641, 'binary_precision': 0.99857956, 'binary_recall': 0.96831954, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.98321676}
confusion matrix:
      0    1
0  5996    1
1    23  703
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011746_12.png
better model found
persisted
after epoch: 12,now: 2024-06-03 05:52:18.704628,epoch time: 0:23:04.568126,used: 4:39:52.934266,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_01_12_25_seed_2_21011746
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9983991, 'precision': 0.9959584, 'recall': 0.9948851, 'specificity': 0.9948851, 'f1': 0.995421, 'auroc': 0.99962604, 'binary_precision': 0.99293286, 'binary_recall': 0.99052656, 'binary_specificity': 0.9992437, 'binary_f1_score': 0.9917282}
confusion matrix:
       0     1
0  42277    32
1     43  4496
---- Validation: 
scalar performance:
{'acc': 0.9699036, 'precision': 0.75755584, 'recall': 0.7587967, 'specificity': 0.7587967, 'f1': 0.75817466, 'auroc': 0.93302923, 'binary_precision': 0.5305785, 'binary_recall': 0.5332226, 'binary_specificity': 0.9843707, 'binary_f1_score': 0.5318973}
confusion matrix:
       0    1
0  17887  284
1    281  321
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9973226, 'precision': 0.9960414, 'recall': 0.9900246, 'specificity': 0.9900246, 'f1': 0.993009, 'auroc': 0.9988307, 'binary_precision': 0.99441344, 'binary_recall': 0.9807162, 'binary_specificity': 0.999333, 'binary_f1_score': 0.98751736}
confusion matrix:
      0    1
0  5993    4
1    14  712
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011746_13.png
new oracle model saved
early stop counter: 1
val acc:0.9699035882949829, best validation acc: 0.9718212485313416, corresponding to test acc:                         0.9964301586151123 / 0.9973226189613342
after epoch: 13,now: 2024-06-03 06:15:18.707276,epoch time: 0:23:00.002648,used: 5:02:52.936914,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_01_12_25_seed_2_21011746
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9972891, 'precision': 0.9985037, 'recall': 0.9860071, 'specificity': 0.9860071, 'f1': 0.9921549, 'auroc': 0.9996239, 'binary_precision': 1.0, 'binary_recall': 0.9720141, 'binary_specificity': 1.0, 'binary_f1_score': 0.98580843}
confusion matrix:
       0     1
0  42310     0
1    127  4411
---- Validation: 
scalar performance:
{'acc': 0.9691046, 'precision': 0.8266771, 'recall': 0.53353035, 'specificity': 0.53353035, 'f1': 0.554071, 'auroc': 0.93626773, 'binary_precision': 0.68333334, 'binary_recall': 0.06810631, 'binary_specificity': 0.99895436, 'binary_f1_score': 0.123867065}
confusion matrix:
       0   1
0  18152  19
1    561  41
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99628145, 'precision': 0.99792427, 'recall': 0.98278236, 'specificity': 0.98278236, 'f1': 0.99020034, 'auroc': 0.9998969, 'binary_precision': 1.0, 'binary_recall': 0.9655647, 'binary_specificity': 1.0, 'binary_f1_score': 0.9824807}
confusion matrix:
      0    1
0  5997    0
1    25  701
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011746_14.png
early stop counter: 2
val acc:0.9691045880317688, best validation acc: 0.9718212485313416, corresponding to test acc:                         0.9964301586151123 / 0.9973226189613342
after epoch: 14,now: 2024-06-03 06:38:23.796762,epoch time: 0:23:05.089486,used: 5:25:58.026400,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_01_12_25_seed_2_21011746
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9984204, 'precision': 0.9979316, 'recall': 0.9930285, 'specificity': 0.9930285, 'f1': 0.9954647, 'auroc': 0.99979776, 'binary_precision': 0.9973268, 'binary_recall': 0.9863406, 'binary_specificity': 0.9997164, 'binary_f1_score': 0.9918033}
confusion matrix:
       0     1
0  42297    12
1     62  4477
---- Validation: 
scalar performance:
{'acc': 0.97299314, 'precision': 0.804311, 'recall': 0.6889213, 'specificity': 0.6889213, 'f1': 0.73199797, 'auroc': 0.9463943, 'binary_precision': 0.6287263, 'binary_recall': 0.38538206, 'binary_specificity': 0.9924605, 'binary_f1_score': 0.47785786}
confusion matrix:
       0    1
0  18034  137
1    370  232
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99657893, 'precision': 0.9980897, 'recall': 0.98415977, 'specificity': 0.98415977, 'f1': 0.99099547, 'auroc': 0.9998863, 'binary_precision': 1.0, 'binary_recall': 0.96831954, 'binary_specificity': 1.0, 'binary_f1_score': 0.98390484}
confusion matrix:
      0    1
0  5997    0
1    23  703
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011746_15.png
better model found
persisted
after epoch: 15,now: 2024-06-03 07:01:22.151667,epoch time: 0:22:58.354905,used: 5:48:56.381305,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_01_12_25_seed_2_21011746
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9979722, 'precision': 0.9938706, 'recall': 0.9945504, 'specificity': 0.9945504, 'f1': 0.99421024, 'auroc': 0.9995687, 'binary_precision': 0.98878133, 'binary_recall': 0.99030626, 'binary_specificity': 0.99879456, 'binary_f1_score': 0.98954326}
confusion matrix:
       0     1
0  42258    51
1     44  4495
---- Validation: 
scalar performance:
{'acc': 0.9695307, 'precision': 0.755847, 'recall': 0.7120272, 'specificity': 0.7120272, 'f1': 0.7316796, 'auroc': 0.92838866, 'binary_precision': 0.5302419, 'binary_recall': 0.43687707, 'binary_specificity': 0.9871774, 'binary_f1_score': 0.4790528}
confusion matrix:
       0    1
0  17938  233
1    339  263
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9971739, 'precision': 0.99842083, 'recall': 0.98691463, 'specificity': 0.98691463, 'f1': 0.9925797, 'auroc': 0.99966764, 'binary_precision': 1.0, 'binary_recall': 0.9738292, 'binary_specificity': 1.0, 'binary_f1_score': 0.98674107}
confusion matrix:
      0    1
0  5997    0
1    19  707
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011746_16.png
early stop counter: 1
val acc:0.9695307016372681, best validation acc: 0.9729931354522705, corresponding to test acc:                         0.9965789318084717 / 0.9973226189613342
after epoch: 16,now: 2024-06-03 07:24:16.598043,epoch time: 0:22:54.446376,used: 6:11:50.827681,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_01_12_25_seed_2_21011746
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99716103, 'precision': 0.99752116, 'recall': 0.9862312, 'specificity': 0.9862312, 'f1': 0.9917941, 'auroc': 0.99931914, 'binary_precision': 0.99796516, 'binary_recall': 0.9726752, 'binary_specificity': 0.9997873, 'binary_f1_score': 0.9851579}
confusion matrix:
       0     1
0  42301     9
1    124  4414
---- Validation: 
scalar performance:
{'acc': 0.96761304, 'precision': 0.73181033, 'recall': 0.60664034, 'specificity': 0.60664034, 'f1': 0.6438842, 'auroc': 0.8967306, 'binary_precision': 0.48897058, 'binary_recall': 0.22093023, 'binary_specificity': 0.99235046, 'binary_f1_score': 0.3043478}
confusion matrix:
       0    1
0  18032  139
1    469  133
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99643016, 'precision': 0.9973792, 'recall': 0.9840764, 'specificity': 0.9840764, 'f1': 0.9906097, 'auroc': 0.999681, 'binary_precision': 0.99857956, 'binary_recall': 0.96831954, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.98321676}
confusion matrix:
      0    1
0  5996    1
1    23  703
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011746_17.png
early stop counter: 2
val acc:0.9676130414009094, best validation acc: 0.9729931354522705, corresponding to test acc:                         0.9965789318084717 / 0.9973226189613342
after epoch: 17,now: 2024-06-03 07:47:21.095416,epoch time: 0:23:04.497373,used: 6:34:55.325054,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_01_12_25_seed_2_21011746
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.998207, 'precision': 0.9973152, 'recall': 0.992417, 'specificity': 0.992417, 'f1': 0.99485075, 'auroc': 0.9996364, 'binary_precision': 0.9962121, 'binary_recall': 0.9852358, 'binary_specificity': 0.9995982, 'binary_f1_score': 0.99069357}
confusion matrix:
       0     1
0  42293    17
1     67  4471
---- Validation: 
scalar performance:
{'acc': 0.9699569, 'precision': 0.85724556, 'recall': 0.54762244, 'specificity': 0.54762244, 'f1': 0.57764477, 'auroc': 0.91699225, 'binary_precision': 0.74358976, 'binary_recall': 0.096345514, 'binary_specificity': 0.99889934, 'binary_f1_score': 0.17058823}
confusion matrix:
       0   1
0  18151  20
1    544  58
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99881005, 'precision': 0.99933386, 'recall': 0.9944904, 'specificity': 0.9944904, 'f1': 0.9968966, 'auroc': 0.9999908, 'binary_precision': 1.0, 'binary_recall': 0.9889807, 'binary_specificity': 1.0, 'binary_f1_score': 0.9944598}
confusion matrix:
      0    1
0  5997    0
1     8  718
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011746_18.png
new oracle model saved
early stop counter: 3
val acc:0.9699568748474121, best validation acc: 0.9729931354522705, corresponding to test acc:                         0.9965789318084717 / 0.9988100528717041
after epoch: 18,now: 2024-06-03 08:10:20.732946,epoch time: 0:22:59.637530,used: 6:57:54.962584,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_01_12_25_seed_2_21011746
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9963926, 'precision': 0.99627936, 'recall': 0.98305535, 'specificity': 0.98305535, 'f1': 0.9895543, 'auroc': 0.99815446, 'binary_precision': 0.9961399, 'binary_recall': 0.96651244, 'binary_specificity': 0.9995982, 'binary_f1_score': 0.9811026}
confusion matrix:
       0     1
0  42292    17
1    152  4387
---- Validation: 
scalar performance:
{'acc': 0.9682523, 'precision': 0.7440177, 'recall': 0.5836821, 'specificity': 0.5836821, 'f1': 0.6212426, 'auroc': 0.8979523, 'binary_precision': 0.5148515, 'binary_recall': 0.17275748, 'binary_specificity': 0.9946068, 'binary_f1_score': 0.25870648}
confusion matrix:
       0    1
0  18073   98
1    498  104
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99434775, 'precision': 0.9955703, 'recall': 0.97503984, 'specificity': 0.97503984, 'f1': 0.9850211, 'auroc': 0.9963738, 'binary_precision': 0.99710983, 'binary_recall': 0.9504132, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.97320163}
confusion matrix:
      0    1
0  5995    2
1    36  690
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011746_19.png
early stop counter: 4
val acc:0.9682523012161255, best validation acc: 0.9729931354522705, corresponding to test acc:                         0.9965789318084717 / 0.9988100528717041
after epoch: 19,now: 2024-06-03 08:33:25.023529,epoch time: 0:23:04.290583,used: 7:20:59.253167,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_01_12_25_seed_2_21011746
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99863386, 'precision': 0.9986467, 'recall': 0.9935386, 'specificity': 0.9935386, 'f1': 0.996076, 'auroc': 0.9998889, 'binary_precision': 0.99866253, 'binary_recall': 0.98721904, 'binary_specificity': 0.9998582, 'binary_f1_score': 0.9929078}
confusion matrix:
       0     1
0  42304     6
1     58  4480
---- Validation: 
scalar performance:
{'acc': 0.97096896, 'precision': 0.80200124, 'recall': 0.6131922, 'specificity': 0.6131922, 'f1': 0.6614739, 'auroc': 0.93056166, 'binary_precision': 0.6289593, 'binary_recall': 0.23089701, 'binary_specificity': 0.99548733, 'binary_f1_score': 0.33778858}
confusion matrix:
       0    1
0  18089   82
1    463  139
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99628145, 'precision': 0.9954332, 'recall': 0.98520374, 'specificity': 0.98520374, 'f1': 0.99024844, 'auroc': 0.9993596, 'binary_precision': 0.99435824, 'binary_recall': 0.9710744, 'binary_specificity': 0.999333, 'binary_f1_score': 0.9825784}
confusion matrix:
      0    1
0  5993    4
1    21  705
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011746_20.png
early stop counter: 5
val acc:0.9709689617156982, best validation acc: 0.9729931354522705, corresponding to test acc:                         0.9965789318084717 / 0.9988100528717041
after epoch: 20,now: 2024-06-03 08:56:27.417728,epoch time: 0:23:02.394199,used: 7:44:01.647366,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_01_12_25_seed_2_21011746
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99814296, 'precision': 0.9981725, 'recall': 0.99120116, 'specificity': 0.99120116, 'f1': 0.9946557, 'auroc': 0.9995737, 'binary_precision': 0.99820906, 'binary_recall': 0.98259145, 'binary_specificity': 0.99981093, 'binary_f1_score': 0.9903387}
confusion matrix:
       0     1
0  42302     8
1     79  4459
---- Validation: 
scalar performance:
{'acc': 0.96777284, 'precision': 0.7304772, 'recall': 0.5561308, 'specificity': 0.5561308, 'f1': 0.58573985, 'auroc': 0.92033505, 'binary_precision': 0.48951048, 'binary_recall': 0.11627907, 'binary_specificity': 0.9959826, 'binary_f1_score': 0.18791947}
confusion matrix:
       0   1
0  18098  73
1    532  70
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9958352, 'precision': 0.9976764, 'recall': 0.9807162, 'specificity': 0.9807162, 'f1': 0.989004, 'auroc': 0.9997921, 'binary_precision': 1.0, 'binary_recall': 0.9614325, 'binary_specificity': 1.0, 'binary_f1_score': 0.98033714}
confusion matrix:
      0    1
0  5997    0
1    28  698
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011746_21.png
early stop counter: 6
val acc:0.9677728414535522, best validation acc: 0.9729931354522705, corresponding to test acc:                         0.9965789318084717 / 0.9988100528717041
after epoch: 21,now: 2024-06-03 09:19:26.620742,epoch time: 0:22:59.203014,used: 8:07:00.850380,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_01_12_25_seed_2_21011746
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9983564, 'precision': 0.99759847, 'recall': 0.992993, 'specificity': 0.992993, 'f1': 0.9952822, 'auroc': 0.9995303, 'binary_precision': 0.9966607, 'binary_recall': 0.9863406, 'binary_specificity': 0.9996455, 'binary_f1_score': 0.9914738}
confusion matrix:
       0     1
0  42294    15
1     62  4477
---- Validation: 
scalar performance:
{'acc': 0.97134185, 'precision': 0.92635024, 'recall': 0.5611866, 'specificity': 0.5611866, 'f1': 0.60057384, 'auroc': 0.9500494, 'binary_precision': 0.88095236, 'binary_recall': 0.12292359, 'binary_specificity': 0.9994497, 'binary_f1_score': 0.21574345}
confusion matrix:
       0   1
0  18161  10
1    528  74
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99672765, 'precision': 0.99754673, 'recall': 0.98545384, 'specificity': 0.98545384, 'f1': 0.99140286, 'auroc': 0.99894714, 'binary_precision': 0.99858356, 'binary_recall': 0.9710744, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.9846369}
confusion matrix:
      0    1
0  5996    1
1    21  705
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011746_22.png
early stop counter: 7
val acc:0.9713418483734131, best validation acc: 0.9729931354522705, corresponding to test acc:                         0.9965789318084717 / 0.9988100528717041
after epoch: 22,now: 2024-06-03 09:42:22.935729,epoch time: 0:22:56.314987,used: 8:29:57.165367,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_01_12_25_seed_2_21011746
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.998207, 'precision': 0.99721694, 'recall': 0.99251693, 'specificity': 0.99251693, 'f1': 0.9948528, 'auroc': 0.99977624, 'binary_precision': 0.995992, 'binary_recall': 0.9854593, 'binary_specificity': 0.99957454, 'binary_f1_score': 0.99069774}
confusion matrix:
       0     1
0  42291    18
1     66  4473
---- Validation: 
scalar performance:
{'acc': 0.9715549, 'precision': 0.8780496, 'recall': 0.57735765, 'specificity': 0.57735765, 'f1': 0.6229432, 'auroc': 0.9276407, 'binary_precision': 0.78333336, 'binary_recall': 0.15614618, 'binary_specificity': 0.99856913, 'binary_f1_score': 0.2603878}
confusion matrix:
       0   1
0  18145  26
1    508  94
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9950915, 'precision': 0.99662626, 'recall': 0.97787803, 'specificity': 0.97787803, 'f1': 0.9870163, 'auroc': 0.9992795, 'binary_precision': 0.99856114, 'binary_recall': 0.95592284, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.9767769}
confusion matrix:
      0    1
0  5996    1
1    32  694
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011746_23.png
early stop counter: 8
val acc:0.9715548753738403, best validation acc: 0.9729931354522705, corresponding to test acc:                         0.9965789318084717 / 0.9988100528717041
after epoch: 23,now: 2024-06-03 10:05:20.641626,epoch time: 0:22:57.705897,used: 8:52:54.871264,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_01_12_25_seed_2_21011746
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9981643, 'precision': 0.9988853, 'recall': 0.9906249, 'specificity': 0.9906249, 'f1': 0.9947114, 'auroc': 0.99978065, 'binary_precision': 0.9997755, 'binary_recall': 0.9812734, 'binary_specificity': 0.99997634, 'binary_f1_score': 0.9904381}
confusion matrix:
       0     1
0  42308     1
1     85  4454
---- Validation: 
scalar performance:
{'acc': 0.9697438, 'precision': 0.8190331, 'recall': 0.5555428, 'specificity': 0.5555428, 'f1': 0.58888227, 'auroc': 0.9433876, 'binary_precision': 0.6666667, 'binary_recall': 0.11295681, 'binary_specificity': 0.9981289, 'binary_f1_score': 0.1931818}
confusion matrix:
       0   1
0  18137  34
1    534  68
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99672765, 'precision': 0.99817246, 'recall': 0.9848485, 'specificity': 0.9848485, 'f1': 0.99139225, 'auroc': 0.9993104, 'binary_precision': 1.0, 'binary_recall': 0.969697, 'binary_specificity': 1.0, 'binary_f1_score': 0.9846154}
confusion matrix:
      0    1
0  5997    0
1    22  704
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011746_24.png
early stop counter: 9
val acc:0.9697437882423401, best validation acc: 0.9729931354522705, corresponding to test acc:                         0.9965789318084717 / 0.9988100528717041
after epoch: 24,now: 2024-06-03 10:28:10.198341,epoch time: 0:22:49.556715,used: 9:15:44.427979,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_01_12_25_seed_2_21011746
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9947063, 'precision': 0.97624886, 'recall': 0.9945124, 'specificity': 0.9945124, 'f1': 0.98516047, 'auroc': 0.999387, 'binary_precision': 0.9531151, 'binary_recall': 0.9942719, 'binary_specificity': 0.9947529, 'binary_f1_score': 0.9732586}
confusion matrix:
       0     1
0  42087   222
1     26  4513
---- Validation: 
scalar performance:
{'acc': 0.971182, 'precision': 0.7741268, 'recall': 0.708865, 'specificity': 0.708865, 'f1': 0.7366739, 'auroc': 0.9262406, 'binary_precision': 0.567033, 'binary_recall': 0.42857143, 'binary_specificity': 0.9891586, 'binary_f1_score': 0.4881741}
confusion matrix:
       0    1
0  17974  197
1    344  258
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99702513, 'precision': 0.9928677, 'recall': 0.9916739, 'specificity': 0.9916739, 'f1': 0.9922698, 'auroc': 0.99985135, 'binary_precision': 0.98756903, 'binary_recall': 0.9848485, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.9862069}
confusion matrix:
      0    1
0  5988    9
1    11  715
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011746_25.png
early stop counter: 10
val acc:0.9711819887161255, best validation acc: 0.9729931354522705, corresponding to test acc:                         0.9965789318084717 / 0.9988100528717041
after epoch: 25,now: 2024-06-03 10:50:50.602927,epoch time: 0:22:40.404586,used: 9:38:24.832565,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_01_12_25_seed_2_21011746
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99818563, 'precision': 0.9989975, 'recall': 0.9906367, 'specificity': 0.9906367, 'f1': 0.9947723, 'auroc': 0.9998957, 'binary_precision': 1.0, 'binary_recall': 0.9812734, 'binary_specificity': 1.0, 'binary_f1_score': 0.9905482}
confusion matrix:
       0     1
0  42309     0
1     85  4454
---- Validation: 
scalar performance:
{'acc': 0.9689448, 'precision': 0.8703711, 'recall': 0.5222051, 'specificity': 0.5222051, 'f1': 0.5344884, 'auroc': 0.9412755, 'binary_precision': 0.7714286, 'binary_recall': 0.0448505, 'binary_specificity': 0.99955976, 'binary_f1_score': 0.08477238}
confusion matrix:
       0   1
0  18163   8
1    575  27
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9961327, 'precision': 0.9978416, 'recall': 0.9820937, 'specificity': 0.9820937, 'f1': 0.98980206, 'auroc': 0.9999798, 'binary_precision': 1.0, 'binary_recall': 0.9641873, 'binary_specificity': 1.0, 'binary_f1_score': 0.9817672}
confusion matrix:
      0    1
0  5997    0
1    26  700
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011746_26.png
early stop counter: 11
val acc:0.968944787979126, best validation acc: 0.9729931354522705, corresponding to test acc:                         0.9965789318084717 / 0.9988100528717041
after epoch: 26,now: 2024-06-03 11:13:48.277303,epoch time: 0:22:57.674376,used: 10:01:22.506941,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_01_12_25_seed_2_21011746
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9988687, 'precision': 0.9988773, 'recall': 0.9946534, 'specificity': 0.9946534, 'f1': 0.99675393, 'auroc': 0.99974525, 'binary_precision': 0.9988879, 'binary_recall': 0.989425, 'binary_specificity': 0.9998818, 'binary_f1_score': 0.9941339}
confusion matrix:
       0     1
0  42304     5
1     48  4491
---- Validation: 
scalar performance:
{'acc': 0.9696905, 'precision': 0.81012434, 'recall': 0.5587275, 'specificity': 0.5587275, 'f1': 0.5932577, 'auroc': 0.9402524, 'binary_precision': 0.6486486, 'binary_recall': 0.11960133, 'binary_specificity': 0.9978537, 'binary_f1_score': 0.20196354}
confusion matrix:
       0   1
0  18132  39
1    530  72
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9982151, 'precision': 0.9990015, 'recall': 0.9917356, 'specificity': 0.9917356, 'f1': 0.99533355, 'auroc': 0.99996394, 'binary_precision': 1.0, 'binary_recall': 0.9834711, 'binary_specificity': 1.0, 'binary_f1_score': 0.9916667}
confusion matrix:
      0    1
0  5997    0
1    12  714
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011746_27.png
early stop counter: 12
val acc:0.9696905016899109, best validation acc: 0.9729931354522705, corresponding to test acc:                         0.9965789318084717 / 0.9988100528717041
after epoch: 27,now: 2024-06-03 11:36:59.984209,epoch time: 0:23:11.706906,used: 10:24:34.213847,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_01_12_25_seed_2_21011746
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9989114, 'precision': 0.99909955, 'recall': 0.99467707, 'specificity': 0.99467707, 'f1': 0.9968758, 'auroc': 0.99969316, 'binary_precision': 0.9993324, 'binary_recall': 0.989425, 'binary_specificity': 0.9999291, 'binary_f1_score': 0.99435407}
confusion matrix:
       0     1
0  42306     3
1     48  4491
---- Validation: 
scalar performance:
{'acc': 0.9740585, 'precision': 0.869556, 'recall': 0.6372735, 'specificity': 0.6372735, 'f1': 0.69678015, 'auroc': 0.95432293, 'binary_precision': 0.7625571, 'binary_recall': 0.27740863, 'binary_specificity': 0.9971383, 'binary_f1_score': 0.40682095}
confusion matrix:
       0    1
0  18119   52
1    435  167
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9973226, 'precision': 0.99850374, 'recall': 0.9876033, 'specificity': 0.9876033, 'f1': 0.9929746, 'auroc': 0.99990267, 'binary_precision': 1.0, 'binary_recall': 0.9752066, 'binary_specificity': 1.0, 'binary_f1_score': 0.9874477}
confusion matrix:
      0    1
0  5997    0
1    18  708
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011746_28.png
better model found
persisted
after epoch: 28,now: 2024-06-03 12:01:31.317691,epoch time: 0:24:31.333482,used: 10:49:05.547329,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_01_12_25_seed_2_21011746
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9955601, 'precision': 0.9956005, 'recall': 0.97895133, 'specificity': 0.97895133, 'f1': 0.9870959, 'auroc': 0.99912554, 'binary_precision': 0.9956502, 'binary_recall': 0.9583517, 'binary_specificity': 0.99955094, 'binary_f1_score': 0.9766449}
confusion matrix:
       0     1
0  42291    19
1    189  4349
---- Validation: 
scalar performance:
{'acc': 0.963032, 'precision': 0.67632776, 'recall': 0.6115014, 'specificity': 0.6115014, 'f1': 0.6357051, 'auroc': 0.90802354, 'binary_precision': 0.3776596, 'binary_recall': 0.2358804, 'binary_specificity': 0.98712236, 'binary_f1_score': 0.29038855}
confusion matrix:
       0    1
0  17937  234
1    460  142
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.994794, 'precision': 0.9945657, 'recall': 0.97831666, 'specificity': 0.97831666, 'f1': 0.9862635, 'auroc': 0.9990275, 'binary_precision': 0.99427754, 'binary_recall': 0.95730025, 'binary_specificity': 0.999333, 'binary_f1_score': 0.97543854}
confusion matrix:
      0    1
0  5993    4
1    31  695
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011746_29.png
early stop counter: 1
val acc:0.9630320072174072, best validation acc: 0.9740585088729858, corresponding to test acc:                         0.9973226189613342 / 0.9988100528717041
after epoch: 29,now: 2024-06-03 12:24:48.458271,epoch time: 0:23:17.140580,used: 11:12:22.687909,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_01_12_25_seed_2_21011746
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9991675, 'precision': 0.99894536, 'recall': 0.9962939, 'specificity': 0.9962939, 'f1': 0.99761516, 'auroc': 0.9997934, 'binary_precision': 0.9986702, 'binary_recall': 0.99272966, 'binary_specificity': 0.9998582, 'binary_f1_score': 0.99569106}
confusion matrix:
       0     1
0  42303     6
1     33  4506
---- Validation: 
scalar performance:
{'acc': 0.97341925, 'precision': 0.85263723, 'recall': 0.6345341, 'specificity': 0.6345341, 'f1': 0.6915122, 'auroc': 0.93832624, 'binary_precision': 0.72888887, 'binary_recall': 0.27242523, 'binary_specificity': 0.996643, 'binary_f1_score': 0.39661422}
confusion matrix:
       0    1
0  18110   61
1    438  164
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99866134, 'precision': 0.99925077, 'recall': 0.99380165, 'specificity': 0.99380165, 'f1': 0.9965066, 'auroc': 0.9999474, 'binary_precision': 1.0, 'binary_recall': 0.9876033, 'binary_specificity': 1.0, 'binary_f1_score': 0.99376297}
confusion matrix:
      0    1
0  5997    0
1     9  717
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011746_30.png
early stop counter: 2
val acc:0.9734192490577698, best validation acc: 0.9740585088729858, corresponding to test acc:                         0.9973226189613342 / 0.9988100528717041
after epoch: 30,now: 2024-06-03 12:47:55.357543,epoch time: 0:23:06.899272,used: 11:35:29.587181,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_01_12_25_seed_2_21011746
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 11:35:29.587181 at 2024-06-03 12:47:55.357543
persisted model performance metric: 

scalar performance:
{'acc': 0.99643016, 'precision': 0.99800694, 'recall': 0.98347104, 'specificity': 0.98347104, 'f1': 0.99059814, 'auroc': 0.9998971, 'binary_precision': 1.0, 'binary_recall': 0.96694213, 'binary_specificity': 1.0, 'binary_f1_score': 0.9831933}
confusion matrix:
      0    1
0  5997    0
1    24  702
oracle model performance metric: 

scalar performance:
{'acc': 0.9977689, 'precision': 0.9987525, 'recall': 0.98966944, 'specificity': 0.98966944, 'f1': 0.99415624, 'auroc': 0.9998707, 'binary_precision': 1.0, 'binary_recall': 0.9793388, 'binary_specificity': 1.0, 'binary_f1_score': 0.98956156}
confusion matrix:
      0    1
0  5997    0
1    15  711
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456578 KiB |  13219 MiB |   3432 TiB |   3432 TiB |
|       from large pool | 414803 KiB |  13181 MiB |   3392 TiB |   3392 TiB |
|       from small pool |  41774 KiB |     61 MiB |     40 TiB |     40 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 456578 KiB |  13219 MiB |   3432 TiB |   3432 TiB |
|       from large pool | 414803 KiB |  13181 MiB |   3392 TiB |   3392 TiB |
|       from small pool |  41774 KiB |     61 MiB |     40 TiB |     40 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447775 KiB |  13213 MiB |   3423 TiB |   3423 TiB |
|       from large pool | 407075 KiB |  13175 MiB |   3382 TiB |   3382 TiB |
|       from small pool |  40700 KiB |     60 MiB |     40 TiB |     40 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14478 MiB |  14478 MiB |  41640 MiB |  27162 MiB |
|       from large pool |  14412 MiB |  14412 MiB |  41542 MiB |  27130 MiB |
|       from small pool |     66 MiB |     70 MiB |     98 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 446590 KiB |   1232 MiB |   2404 TiB |   2404 TiB |
|       from large pool | 435116 KiB |   1229 MiB |   2363 TiB |   2363 TiB |
|       from small pool |  11473 KiB |     42 MiB |     40 TiB |     40 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3662    |    6861    |  606534 K  |  606530 K  |
|       from large pool |     187    |    1413    |  315447 K  |  315447 K  |
|       from small pool |    3475    |    6672    |  291086 K  |  291083 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3662    |    6861    |  606534 K  |  606530 K  |
|       from large pool |     187    |    1413    |  315447 K  |  315447 K  |
|       from small pool |    3475    |    6672    |  291086 K  |  291083 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     635    |     636    |    1779    |    1144    |
|       from large pool |     602    |     602    |    1730    |    1128    |
|       from small pool |      33    |      35    |      49    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      82    |    2993    |  400404 K  |  400404 K  |
|       from large pool |      38    |     605    |  245951 K  |  245951 K  |
|       from small pool |      44    |    2955    |  154453 K  |  154453 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   3432 TiB |   3432 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   3392 TiB |   3392 TiB |
|       from small pool |      0 KiB |     61 MiB |     40 TiB |     40 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   3432 TiB |   3432 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   3392 TiB |   3392 TiB |
|       from small pool |      0 KiB |     61 MiB |     40 TiB |     40 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   3423 TiB |   3423 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   3382 TiB |   3382 TiB |
|       from small pool |      0 KiB |     60 MiB |     40 TiB |     40 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14478 MiB |  41640 MiB |  40758 MiB |
|       from large pool |    830 MiB |  14412 MiB |  41542 MiB |  40712 MiB |
|       from small pool |     52 MiB |     70 MiB |     98 MiB |     46 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1232 MiB |   2404 TiB |   2404 TiB |
|       from large pool |  24320 KiB |   1229 MiB |   2363 TiB |   2363 TiB |
|       from small pool |      0 KiB |     42 MiB |     40 TiB |     40 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6861    |  606534 K  |  606534 K  |
|       from large pool |       2    |    1413    |  315447 K  |  315447 K  |
|       from small pool |       0    |    6672    |  291086 K  |  291086 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6861    |  606534 K  |  606534 K  |
|       from large pool |       2    |    1413    |  315447 K  |  315447 K  |
|       from small pool |       0    |    6672    |  291086 K  |  291086 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     636    |    1779    |    1716    |
|       from large pool |      37    |     602    |    1730    |    1693    |
|       from small pool |      26    |      35    |      49    |      23    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2993    |  400405 K  |  400405 K  |
|       from large pool |       4    |     605    |  245951 K  |  245951 K  |
|       from small pool |       0    |    2955    |  154454 K  |  154454 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Mon Jun  3 12:49:37 2024]
Finished job 0.
1 of 1 steps (100%) done
