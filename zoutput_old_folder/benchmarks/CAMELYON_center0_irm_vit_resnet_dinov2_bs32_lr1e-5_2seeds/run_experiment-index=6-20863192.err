Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sun May 26 12:25:42 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs32/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs32/rule_results/6.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=6
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863192

 Experiment start at: 2024-05-26 12:35:25.938554
before training, model accuracy: 0.955097496509552
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9723136, 'precision': 0.8245578, 'recall': 0.6694007, 'specificity': 0.6694007, 'f1': 0.7206606, 'auroc': 0.9659189, 'binary_precision': 0.67152315, 'binary_recall': 0.3446635, 'binary_specificity': 0.9941378, 'binary_f1_score': 0.45552558}
confusion matrix:
       0    1
0  42057  248
1    964  507
---- Validation: 
scalar performance:
{'acc': 0.97126436, 'precision': 0.8236234, 'recall': 0.6543488, 'specificity': 0.6543488, 'f1': 0.7066141, 'auroc': 0.9659495, 'binary_precision': 0.6710963, 'binary_recall': 0.31415242, 'binary_specificity': 0.99454516, 'binary_f1_score': 0.4279661}
confusion matrix:
       0    1
0  18050   99
1    441  202
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9685203, 'precision': 0.9566225, 'recall': 0.6299347, 'specificity': 0.6299347, 'f1': 0.6961192, 'auroc': 0.9453448, 'binary_precision': 0.9444444, 'binary_recall': 0.2605364, 'binary_specificity': 0.999333, 'binary_f1_score': 0.4084084}
confusion matrix:
      0   1
0  5993   4
1   193  68
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863192.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-26 12:59:15.316421,epoch time: 0:23:49.377867,used: 0:23:49.377867,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863192
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9775448, 'precision': 0.82948554, 'recall': 0.81974584, 'specificity': 0.81974584, 'f1': 0.82453585, 'auroc': 0.9766482, 'binary_precision': 0.671108, 'binary_recall': 0.65057784, 'binary_specificity': 0.98891383, 'binary_f1_score': 0.6606835}
confusion matrix:
       0    1
0  41836  469
1    514  957
---- Validation: 
scalar performance:
{'acc': 0.9774904, 'precision': 0.84643596, 'recall': 0.7873317, 'specificity': 0.7873317, 'f1': 0.8138844, 'auroc': 0.9731537, 'binary_precision': 0.7075472, 'binary_recall': 0.58320373, 'binary_specificity': 0.9914596, 'binary_f1_score': 0.6393861}
confusion matrix:
       0    1
0  17994  155
1    268  375
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97395337, 'precision': 0.94867027, 'recall': 0.7042305, 'specificity': 0.7042305, 'f1': 0.7771057, 'auroc': 0.95569134, 'binary_precision': 0.92241377, 'binary_recall': 0.4099617, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.56763923}
confusion matrix:
      0    1
0  5988    9
1   154  107
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863192.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-05-26 13:21:58.677229,epoch time: 0:22:43.360808,used: 0:46:32.738675,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863192
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9770422, 'precision': 0.9078828, 'recall': 0.69526315, 'specificity': 0.69526315, 'f1': 0.76158404, 'auroc': 0.980438, 'binary_precision': 0.8364689, 'binary_recall': 0.39319727, 'binary_specificity': 0.997329, 'binary_f1_score': 0.5349375}
confusion matrix:
       0    1
0  42193  113
1    892  578
---- Validation: 
scalar performance:
{'acc': 0.97573435, 'precision': 0.9248209, 'recall': 0.6694139, 'specificity': 0.6694139, 'f1': 0.73875225, 'auroc': 0.9765303, 'binary_precision': 0.87250996, 'binary_recall': 0.34059098, 'binary_specificity': 0.99823684, 'binary_f1_score': 0.48993292}
confusion matrix:
       0    1
0  18117   32
1    424  219
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.95189345, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863192.png
early stop counter: 1
val acc:0.9757343530654907, best validation acc: 0.9774904251098633, corresponding to test acc:                         0.973953366279602 / 0.973953366279602
after epoch: 3,now: 2024-05-26 13:44:41.633784,epoch time: 0:22:42.956555,used: 1:09:15.695230,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863192
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.981748, 'precision': 0.92860824, 'recall': 0.76565945, 'specificity': 0.76565945, 'f1': 0.8266735, 'auroc': 0.98463583, 'binary_precision': 0.8731924, 'binary_recall': 0.5340136, 'binary_specificity': 0.99730533, 'binary_f1_score': 0.66272694}
confusion matrix:
       0    1
0  42192  114
1    685  785
---- Validation: 
scalar performance:
{'acc': 0.9808961, 'precision': 0.9246491, 'recall': 0.75984263, 'specificity': 0.75984263, 'f1': 0.8209865, 'auroc': 0.97959924, 'binary_precision': 0.8659794, 'binary_recall': 0.5225505, 'binary_specificity': 0.9971348, 'binary_f1_score': 0.6517944}
confusion matrix:
       0    1
0  18097   52
1    307  336
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645254, 'precision': 0.95904505, 'recall': 0.5783773, 'specificity': 0.5783773, 'f1': 0.62577903, 'auroc': 0.955993, 'binary_precision': 0.95348835, 'binary_recall': 0.15708812, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.26973683}
confusion matrix:
      0   1
0  5995   2
1   220  41
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863192.png
better model found
persisted
after epoch: 4,now: 2024-05-26 14:07:20.736654,epoch time: 0:22:39.102870,used: 1:31:54.798100,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863192
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9853573, 'precision': 0.90776825, 'recall': 0.85538065, 'specificity': 0.85538065, 'f1': 0.87963283, 'auroc': 0.98783505, 'binary_precision': 0.825372, 'binary_recall': 0.7160326, 'binary_specificity': 0.9947286, 'binary_f1_score': 0.76682436}
confusion matrix:
       0     1
0  42081   223
1    418  1054
---- Validation: 
scalar performance:
{'acc': 0.98515326, 'precision': 0.9343157, 'recall': 0.8258014, 'specificity': 0.8258014, 'f1': 0.87173176, 'auroc': 0.9795755, 'binary_precision': 0.88075316, 'binary_recall': 0.6547434, 'binary_specificity': 0.9968593, 'binary_f1_score': 0.75111514}
confusion matrix:
       0    1
0  18092   57
1    222  421
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96580374, 'precision': 0.8991684, 'recall': 0.61202633, 'specificity': 0.61202633, 'f1': 0.66892886, 'auroc': 0.9603177, 'binary_precision': 0.8309859, 'binary_recall': 0.22605364, 'binary_specificity': 0.997999, 'binary_f1_score': 0.3554217}
confusion matrix:
      0   1
0  5985  12
1   202  59
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863192.png
better model found
persisted
after epoch: 5,now: 2024-05-26 14:30:02.364097,epoch time: 0:22:41.627443,used: 1:54:36.425543,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863192
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98405516, 'precision': 0.86193824, 'recall': 0.9120255, 'specificity': 0.9120255, 'f1': 0.88521165, 'auroc': 0.98969936, 'binary_precision': 0.7296494, 'binary_recall': 0.83480626, 'binary_specificity': 0.98924476, 'binary_f1_score': 0.7786937}
confusion matrix:
       0     1
0  41850   455
1    243  1228
---- Validation: 
scalar performance:
{'acc': 0.9830247, 'precision': 0.8591523, 'recall': 0.900455, 'specificity': 0.900455, 'f1': 0.87857515, 'auroc': 0.98372746, 'binary_precision': 0.725, 'binary_recall': 0.8118196, 'binary_specificity': 0.9890903, 'binary_f1_score': 0.7659574}
confusion matrix:
       0    1
0  17951  198
1    121  522
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9638862, 'precision': 0.91093576, 'recall': 0.5798762, 'specificity': 0.5798762, 'f1': 0.6262262, 'auroc': 0.9532584, 'binary_precision': 0.85714287, 'binary_recall': 0.16091955, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.27096778}
confusion matrix:
      0   1
0  5990   7
1   219  42
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863192.png
early stop counter: 1
val acc:0.9830247163772583, best validation acc: 0.9851532578468323, corresponding to test acc:                         0.9658037424087524 / 0.973953366279602
after epoch: 6,now: 2024-05-26 14:52:43.822877,epoch time: 0:22:41.458780,used: 2:17:17.884323,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863192
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98643094, 'precision': 0.91353405, 'recall': 0.8683069, 'specificity': 0.8683069, 'f1': 0.8895082, 'auroc': 0.9913794, 'binary_precision': 0.83601534, 'binary_recall': 0.74167234, 'binary_specificity': 0.9949415, 'binary_f1_score': 0.7860231}
confusion matrix:
       0     1
0  42091   214
1    380  1091
---- Validation: 
scalar performance:
{'acc': 0.9831311, 'precision': 0.90486026, 'recall': 0.8210042, 'specificity': 0.8210042, 'f1': 0.8577038, 'auroc': 0.9826585, 'binary_precision': 0.8221344, 'binary_recall': 0.64696735, 'binary_specificity': 0.9950411, 'binary_f1_score': 0.7241079}
confusion matrix:
       0    1
0  18059   90
1    227  416
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96356666, 'precision': 0.9332044, 'recall': 0.57054776, 'specificity': 0.57054776, 'f1': 0.613183, 'auroc': 0.95809543, 'binary_precision': 0.902439, 'binary_recall': 0.14176245, 'binary_specificity': 0.999333, 'binary_f1_score': 0.2450331}
confusion matrix:
      0   1
0  5993   4
1   224  37
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863192.png
early stop counter: 2
val acc:0.9831311106681824, best validation acc: 0.9851532578468323, corresponding to test acc:                         0.9658037424087524 / 0.973953366279602
after epoch: 7,now: 2024-05-26 15:15:30.877948,epoch time: 0:22:47.055071,used: 2:40:04.939394,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863192
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9862025, 'precision': 0.9113811, 'recall': 0.866965, 'specificity': 0.866965, 'f1': 0.8878044, 'auroc': 0.99164474, 'binary_precision': 0.8318043, 'binary_recall': 0.73913044, 'binary_specificity': 0.99479955, 'binary_f1_score': 0.78273374}
confusion matrix:
       0     1
0  42084   220
1    384  1088
---- Validation: 
scalar performance:
{'acc': 0.9829715, 'precision': 0.8995131, 'recall': 0.8246718, 'specificity': 0.8246718, 'f1': 0.8579134, 'auroc': 0.9825482, 'binary_precision': 0.81117535, 'binary_recall': 0.6547434, 'binary_specificity': 0.99460024, 'binary_f1_score': 0.72461265}
confusion matrix:
       0    1
0  18051   98
1    222  421
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645254, 'precision': 0.8485873, 'recall': 0.61685634, 'specificity': 0.61685634, 'f1': 0.67006993, 'auroc': 0.94163835, 'binary_precision': 0.7294118, 'binary_recall': 0.23754789, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.3583815}
confusion matrix:
      0   1
0  5974  23
1   199  62
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863192.png
early stop counter: 3
val acc:0.9829714894294739, best validation acc: 0.9851532578468323, corresponding to test acc:                         0.9658037424087524 / 0.973953366279602
after epoch: 8,now: 2024-05-26 15:38:14.986160,epoch time: 0:22:44.108212,used: 3:02:49.047606,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863192
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.99038285, 'precision': 0.94069946, 'recall': 0.90676916, 'specificity': 0.90676916, 'f1': 0.92300224, 'auroc': 0.9947915, 'binary_precision': 0.88774, 'binary_recall': 0.8171312, 'binary_specificity': 0.99640703, 'binary_f1_score': 0.8509735}
confusion matrix:
       0     1
0  42153   152
1    269  1202
---- Validation: 
scalar performance:
{'acc': 0.9867497, 'precision': 0.9144355, 'recall': 0.87763166, 'specificity': 0.87763166, 'f1': 0.8951087, 'auroc': 0.98482525, 'binary_precision': 0.8373288, 'binary_recall': 0.7604977, 'binary_specificity': 0.9947656, 'binary_f1_score': 0.7970661}
confusion matrix:
       0    1
0  18054   95
1    154  489
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614893, 'precision': 0.9391643, 'recall': 0.54197884, 'specificity': 0.54197884, 'f1': 0.56734097, 'auroc': 0.9466057, 'binary_precision': 0.9166667, 'binary_recall': 0.08429119, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.15438597}
confusion matrix:
      0   1
0  5995   2
1   239  22
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863192.png
better model found
persisted
after epoch: 9,now: 2024-05-26 16:00:57.588126,epoch time: 0:22:42.601966,used: 3:25:31.649572,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863192
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98569995, 'precision': 0.86813664, 'recall': 0.9367876, 'specificity': 0.9367876, 'f1': 0.8992641, 'auroc': 0.9924002, 'binary_precision': 0.7403189, 'binary_recall': 0.88435376, 'binary_specificity': 0.9892214, 'binary_f1_score': 0.80595165}
confusion matrix:
       0     1
0  41850   456
1    170  1300
---- Validation: 
scalar performance:
{'acc': 0.9853129, 'precision': 0.8796296, 'recall': 0.90689, 'specificity': 0.90689, 'f1': 0.8927448, 'auroc': 0.98361033, 'binary_precision': 0.76555717, 'binary_recall': 0.82270604, 'binary_specificity': 0.9910739, 'binary_f1_score': 0.7931034}
confusion matrix:
       0    1
0  17987  162
1    114  529
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9689997, 'precision': 0.8818153, 'recall': 0.67232853, 'specificity': 0.67232853, 'f1': 0.7340312, 'auroc': 0.95421576, 'binary_precision': 0.79130435, 'binary_recall': 0.348659, 'binary_specificity': 0.995998, 'binary_f1_score': 0.48404253}
confusion matrix:
      0   1
0  5973  24
1   170  91
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863192.png
early stop counter: 1
val acc:0.9853128790855408, best validation acc: 0.9867497086524963, corresponding to test acc:                         0.9614893198013306 / 0.973953366279602
after epoch: 10,now: 2024-05-26 16:23:34.446110,epoch time: 0:22:36.857984,used: 3:48:08.507556,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863192
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9897204, 'precision': 0.94723105, 'recall': 0.8875747, 'specificity': 0.8875747, 'f1': 0.91511035, 'auroc': 0.9950996, 'binary_precision': 0.902131, 'binary_recall': 0.77808034, 'binary_specificity': 0.99706906, 'binary_f1_score': 0.83552635}
confusion matrix:
       0     1
0  42183   124
1    326  1143
---- Validation: 
scalar performance:
{'acc': 0.98659, 'precision': 0.9360402, 'recall': 0.8490468, 'specificity': 0.8490468, 'f1': 0.8873559, 'auroc': 0.9825171, 'binary_precision': 0.88258314, 'binary_recall': 0.7013997, 'binary_specificity': 0.996694, 'binary_f1_score': 0.7816291}
confusion matrix:
       0    1
0  18089   60
1    192  451
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645254, 'precision': 0.9490423, 'recall': 0.5802096, 'specificity': 0.5802096, 'f1': 0.628164, 'auroc': 0.95010644, 'binary_precision': 0.93333334, 'binary_recall': 0.16091955, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.27450982}
confusion matrix:
      0   1
0  5994   3
1   219  42
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863192.png
early stop counter: 2
val acc:0.9865900278091431, best validation acc: 0.9867497086524963, corresponding to test acc:                         0.9614893198013306 / 0.973953366279602
after epoch: 11,now: 2024-05-26 16:46:14.044789,epoch time: 0:22:39.598679,used: 4:10:48.106235,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863192
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98864675, 'precision': 0.89738154, 'recall': 0.93867946, 'specificity': 0.93867946, 'f1': 0.9169221, 'auroc': 0.99504846, 'binary_precision': 0.798773, 'binary_recall': 0.88511217, 'binary_specificity': 0.9922468, 'binary_f1_score': 0.8397292}
confusion matrix:
       0     1
0  41977   328
1    169  1302
---- Validation: 
scalar performance:
{'acc': 0.9857918, 'precision': 0.88210106, 'recall': 0.9123883, 'specificity': 0.9123883, 'f1': 0.8966155, 'auroc': 0.9847931, 'binary_precision': 0.77011496, 'binary_recall': 0.83359253, 'binary_specificity': 0.9911841, 'binary_f1_score': 0.8005974}
confusion matrix:
       0    1
0  17989  160
1    107  536
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96324706, 'precision': 0.82078755, 'recall': 0.6125247, 'specificity': 0.6125247, 'f1': 0.661976, 'auroc': 0.95228493, 'binary_precision': 0.6741573, 'binary_recall': 0.22988506, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.34285715}
confusion matrix:
      0   1
0  5968  29
1   201  60
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863192.png
early stop counter: 3
val acc:0.985791802406311, best validation acc: 0.9867497086524963, corresponding to test acc:                         0.9614893198013306 / 0.973953366279602
after epoch: 12,now: 2024-05-26 17:08:56.880486,epoch time: 0:22:42.835697,used: 4:33:30.941932,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863192
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9889666, 'precision': 0.9578861, 'recall': 0.8642779, 'specificity': 0.8642779, 'f1': 0.90536606, 'auroc': 0.99549985, 'binary_precision': 0.9250646, 'binary_recall': 0.7306122, 'binary_specificity': 0.9979436, 'binary_f1_score': 0.8164196}
confusion matrix:
       0     1
0  42219    87
1    396  1074
---- Validation: 
scalar performance:
{'acc': 0.9825458, 'precision': 0.91979885, 'recall': 0.79369915, 'specificity': 0.79369915, 'f1': 0.844771, 'auroc': 0.98015076, 'binary_precision': 0.85393256, 'binary_recall': 0.59097975, 'binary_specificity': 0.99641854, 'binary_f1_score': 0.69852936}
confusion matrix:
       0    1
0  18084   65
1    263  380
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9646852, 'precision': 0.88937885, 'recall': 0.59861636, 'specificity': 0.59861636, 'f1': 0.65093595, 'auroc': 0.9395145, 'binary_precision': 0.8125, 'binary_recall': 0.19923371, 'binary_specificity': 0.997999, 'binary_f1_score': 0.32}
confusion matrix:
      0   1
0  5985  12
1   209  52
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863192.png
early stop counter: 4
val acc:0.982545793056488, best validation acc: 0.9867497086524963, corresponding to test acc:                         0.9614893198013306 / 0.973953366279602
after epoch: 13,now: 2024-05-26 17:31:38.663252,epoch time: 0:22:41.782766,used: 4:56:12.724698,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863192
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99289566, 'precision': 0.94807345, 'recall': 0.9419004, 'specificity': 0.9419004, 'f1': 0.9449638, 'auroc': 0.9972373, 'binary_precision': 0.90006894, 'binary_recall': 0.88722825, 'binary_specificity': 0.99657243, 'binary_f1_score': 0.89360243}
confusion matrix:
       0     1
0  42159   145
1    166  1306
---- Validation: 
scalar performance:
{'acc': 0.98781395, 'precision': 0.92385375, 'recall': 0.8849331, 'specificity': 0.8849331, 'f1': 0.90338147, 'auroc': 0.98433477, 'binary_precision': 0.8556701, 'binary_recall': 0.7744945, 'binary_specificity': 0.99537164, 'binary_f1_score': 0.8130612}
confusion matrix:
       0    1
0  18065   84
1    145  498
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.965644, 'precision': 0.9026395, 'recall': 0.6082783, 'specificity': 0.6082783, 'f1': 0.6644314, 'auroc': 0.94536936, 'binary_precision': 0.8382353, 'binary_recall': 0.21839081, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.34650457}
confusion matrix:
      0   1
0  5986  11
1   204  57
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863192.png
better model found
persisted
after epoch: 14,now: 2024-05-26 17:54:22.114555,epoch time: 0:22:43.451303,used: 5:18:56.176001,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863192
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9924616, 'precision': 0.93607867, 'recall': 0.9498071, 'specificity': 0.9498071, 'f1': 0.94282794, 'auroc': 0.9976493, 'binary_precision': 0.87549406, 'binary_recall': 0.90408164, 'binary_specificity': 0.9955326, 'binary_f1_score': 0.8895582}
confusion matrix:
       0     1
0  42117   189
1    141  1329
---- Validation: 
scalar performance:
{'acc': 0.98659, 'precision': 0.9017441, 'recall': 0.8933002, 'specificity': 0.8933002, 'f1': 0.89747345, 'auroc': 0.9823295, 'binary_precision': 0.8108108, 'binary_recall': 0.7931571, 'binary_specificity': 0.9934432, 'binary_f1_score': 0.8018868}
confusion matrix:
       0    1
0  18030  119
1    133  510
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608501, 'precision': 0.8086343, 'recall': 0.5636333, 'specificity': 0.5636333, 'f1': 0.5985877, 'auroc': 0.94441825, 'binary_precision': 0.65384614, 'binary_recall': 0.1302682, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.21725239}
confusion matrix:
      0   1
0  5979  18
1   227  34
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863192.png
early stop counter: 1
val acc:0.9865900278091431, best validation acc: 0.9878139495849609, corresponding to test acc:                         0.9656440019607544 / 0.973953366279602
after epoch: 15,now: 2024-05-26 18:17:03.329927,epoch time: 0:22:41.215372,used: 5:41:37.391373,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863192
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9921647, 'precision': 0.95264596, 'recall': 0.9237672, 'specificity': 0.9237672, 'f1': 0.9376942, 'auroc': 0.99758685, 'binary_precision': 0.9104803, 'binary_recall': 0.8504419, 'binary_specificity': 0.99709255, 'binary_f1_score': 0.87943757}
confusion matrix:
       0     1
0  42182   123
1    220  1251
---- Validation: 
scalar performance:
{'acc': 0.98621756, 'precision': 0.90842664, 'recall': 0.875856, 'specificity': 0.875856, 'f1': 0.89140916, 'auroc': 0.9849421, 'binary_precision': 0.8254237, 'binary_recall': 0.7573872, 'binary_specificity': 0.99432474, 'binary_f1_score': 0.7899433}
confusion matrix:
       0    1
0  18046  103
1    156  487
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96628314, 'precision': 0.902829, 'recall': 0.6177735, 'specificity': 0.6177735, 'f1': 0.6764136, 'auroc': 0.9539921, 'binary_precision': 0.8378378, 'binary_recall': 0.23754789, 'binary_specificity': 0.997999, 'binary_f1_score': 0.37014925}
confusion matrix:
      0   1
0  5985  12
1   199  62
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863192.png
early stop counter: 2
val acc:0.9862175583839417, best validation acc: 0.9878139495849609, corresponding to test acc:                         0.9656440019607544 / 0.973953366279602
after epoch: 16,now: 2024-05-26 18:39:46.714774,epoch time: 0:22:43.384847,used: 6:04:20.776220,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863192
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9902915, 'precision': 0.9044896, 'recall': 0.9591905, 'specificity': 0.9591905, 'f1': 0.92995775, 'auroc': 0.99727076, 'binary_precision': 0.81156826, 'binary_recall': 0.92585033, 'binary_specificity': 0.9925306, 'binary_f1_score': 0.8649507}
confusion matrix:
       0     1
0  41990   316
1    109  1361
---- Validation: 
scalar performance:
{'acc': 0.9837697, 'precision': 0.8610282, 'recall': 0.9143416, 'specificity': 0.9143416, 'f1': 0.8856789, 'auroc': 0.98149914, 'binary_precision': 0.7277628, 'binary_recall': 0.83981335, 'binary_specificity': 0.9888699, 'binary_f1_score': 0.7797834}
confusion matrix:
       0    1
0  17947  202
1    103  540
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96212846, 'precision': 0.7838609, 'recall': 0.6357614, 'specificity': 0.6357614, 'f1': 0.68083376, 'auroc': 0.94804215, 'binary_precision': 0.59836066, 'binary_recall': 0.27969348, 'binary_specificity': 0.9918293, 'binary_f1_score': 0.38120106}
confusion matrix:
      0   1
0  5948  49
1   188  73
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863192.png
early stop counter: 3
val acc:0.9837697148323059, best validation acc: 0.9878139495849609, corresponding to test acc:                         0.9656440019607544 / 0.973953366279602
after epoch: 17,now: 2024-05-26 19:02:32.460667,epoch time: 0:22:45.745893,used: 6:27:06.522113,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863192
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9925987, 'precision': 0.96521044, 'recall': 0.9173746, 'specificity': 0.9173746, 'f1': 0.9398992, 'auroc': 0.9979844, 'binary_precision': 0.93607306, 'binary_recall': 0.8367347, 'binary_specificity': 0.99801445, 'binary_f1_score': 0.8836207}
confusion matrix:
       0     1
0  42222    84
1    240  1230
---- Validation: 
scalar performance:
{'acc': 0.9863772, 'precision': 0.9407007, 'recall': 0.8406861, 'specificity': 0.8406861, 'f1': 0.8838121, 'auroc': 0.9852781, 'binary_precision': 0.8924949, 'binary_recall': 0.6842924, 'binary_specificity': 0.99707973, 'binary_f1_score': 0.77464795}
confusion matrix:
       0    1
0  18096   53
1    203  440
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96164906, 'precision': 0.82747936, 'recall': 0.57137954, 'specificity': 0.57137954, 'f1': 0.6104171, 'auroc': 0.9507793, 'binary_precision': 0.6909091, 'binary_recall': 0.14559387, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.24050632}
confusion matrix:
      0   1
0  5980  17
1   223  38
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863192.png
early stop counter: 4
val acc:0.9863771796226501, best validation acc: 0.9878139495849609, corresponding to test acc:                         0.9656440019607544 / 0.973953366279602
after epoch: 18,now: 2024-05-26 19:25:15.823406,epoch time: 0:22:43.362739,used: 6:49:49.884852,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863192
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9939693, 'precision': 0.98396087, 'recall': 0.92142004, 'specificity': 0.92142004, 'f1': 0.95037365, 'auroc': 0.99891114, 'binary_precision': 0.97333336, 'binary_recall': 0.8436438, 'binary_specificity': 0.9991963, 'binary_f1_score': 0.9038602}
confusion matrix:
       0     1
0  42271    34
1    230  1241
---- Validation: 
scalar performance:
{'acc': 0.9875479, 'precision': 0.9497439, 'recall': 0.85179293, 'specificity': 0.85179293, 'f1': 0.89433753, 'auroc': 0.9812995, 'binary_precision': 0.90981966, 'binary_recall': 0.7060653, 'binary_specificity': 0.9975205, 'binary_f1_score': 0.7950963}
confusion matrix:
       0    1
0  18104   45
1    189  454
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.92983353, 'recall': 0.517158, 'specificity': 0.517158, 'f1': 0.5228796, 'auroc': 0.9490478, 'binary_precision': 0.9, 'binary_recall': 0.03448276, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.06642067}
confusion matrix:
      0  1
0  5996  1
1   252  9
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863192.png
early stop counter: 5
val acc:0.9875478744506836, best validation acc: 0.9878139495849609, corresponding to test acc:                         0.9656440019607544 / 0.973953366279602
after epoch: 19,now: 2024-05-26 19:47:57.686189,epoch time: 0:22:41.862783,used: 7:12:31.747635,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863192
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99374086, 'precision': 0.9315311, 'recall': 0.9800292, 'specificity': 0.9800292, 'f1': 0.95438266, 'auroc': 0.9988221, 'binary_precision': 0.86427265, 'binary_recall': 0.9653297, 'binary_specificity': 0.99472874, 'binary_f1_score': 0.9120103}
confusion matrix:
       0     1
0  42082   223
1     51  1420
---- Validation: 
scalar performance:
{'acc': 0.98515326, 'precision': 0.8686547, 'recall': 0.92855895, 'specificity': 0.92855895, 'f1': 0.8961452, 'auroc': 0.9864584, 'binary_precision': 0.74202126, 'binary_recall': 0.86780715, 'binary_specificity': 0.9893107, 'binary_f1_score': 0.79999995}
confusion matrix:
       0    1
0  17955  194
1     85  558
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.73645437, 'recall': 0.6375084, 'specificity': 0.6375084, 'f1': 0.67218834, 'auroc': 0.92454547, 'binary_precision': 0.5033557, 'binary_recall': 0.28735632, 'binary_specificity': 0.98766047, 'binary_f1_score': 0.36585364}
confusion matrix:
      0   1
0  5923  74
1   186  75
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863192.png
early stop counter: 6
val acc:0.9851532578468323, best validation acc: 0.9878139495849609, corresponding to test acc:                         0.9656440019607544 / 0.973953366279602
after epoch: 20,now: 2024-05-26 20:10:38.638694,epoch time: 0:22:40.952505,used: 7:35:12.700140,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863192
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9938094, 'precision': 0.9310225, 'recall': 0.9820229, 'specificity': 0.9820229, 'f1': 0.95497954, 'auroc': 0.99911606, 'binary_precision': 0.8631133, 'binary_recall': 0.96938777, 'binary_specificity': 0.994658, 'binary_f1_score': 0.91316885}
confusion matrix:
       0     1
0  42080   226
1     45  1425
---- Validation: 
scalar performance:
{'acc': 0.9857918, 'precision': 0.8786018, 'recall': 0.91988885, 'specificity': 0.91988885, 'f1': 0.8980807, 'auroc': 0.98532635, 'binary_precision': 0.76256984, 'binary_recall': 0.84914464, 'binary_specificity': 0.9906331, 'binary_f1_score': 0.803532}
confusion matrix:
       0    1
0  17979  170
1     97  546
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96260786, 'precision': 0.79519343, 'recall': 0.62868214, 'specificity': 0.62868214, 'f1': 0.6758495, 'auroc': 0.9444587, 'binary_precision': 0.6216216, 'binary_recall': 0.26436782, 'binary_specificity': 0.9929965, 'binary_f1_score': 0.37096775}
confusion matrix:
      0   1
0  5955  42
1   192  69
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863192.png
early stop counter: 7
val acc:0.985791802406311, best validation acc: 0.9878139495849609, corresponding to test acc:                         0.9656440019607544 / 0.973953366279602
after epoch: 21,now: 2024-05-26 20:33:17.796371,epoch time: 0:22:39.157677,used: 7:57:51.857817,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863192
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9955455, 'precision': 0.96006787, 'recall': 0.97243273, 'specificity': 0.97243273, 'f1': 0.96616185, 'auroc': 0.99921143, 'binary_precision': 0.9219577, 'binary_recall': 0.94765466, 'binary_specificity': 0.99721074, 'binary_f1_score': 0.93462956}
confusion matrix:
       0     1
0  42187   118
1     77  1394
---- Validation: 
scalar performance:
{'acc': 0.987335, 'precision': 0.9028124, 'recall': 0.90643674, 'specificity': 0.90643674, 'f1': 0.90461576, 'auroc': 0.9833505, 'binary_precision': 0.8120185, 'binary_recall': 0.81959563, 'binary_specificity': 0.99327785, 'binary_f1_score': 0.8157894}
confusion matrix:
       0    1
0  18027  122
1    116  527
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9613295, 'precision': 0.79944545, 'recall': 0.58403915, 'specificity': 0.58403915, 'f1': 0.6256111, 'auroc': 0.93272054, 'binary_precision': 0.63380283, 'binary_recall': 0.1724138, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.27108437}
confusion matrix:
      0   1
0  5971  26
1   216  45
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863192.png
early stop counter: 8
val acc:0.9873350262641907, best validation acc: 0.9878139495849609, corresponding to test acc:                         0.9656440019607544 / 0.973953366279602
after epoch: 22,now: 2024-05-26 20:56:01.550800,epoch time: 0:22:43.754429,used: 8:20:35.612246,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863192
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9951343, 'precision': 0.9549303, 'recall': 0.9719099, 'specificity': 0.9719099, 'f1': 0.96325225, 'auroc': 0.99880546, 'binary_precision': 0.911707, 'binary_recall': 0.9470109, 'binary_specificity': 0.9968088, 'binary_f1_score': 0.9290236}
confusion matrix:
       0     1
0  42169   135
1     78  1394
---- Validation: 
scalar performance:
{'acc': 0.9882929, 'precision': 0.91490316, 'recall': 0.9061826, 'specificity': 0.9061826, 'f1': 0.91049266, 'auroc': 0.98211354, 'binary_precision': 0.83624804, 'binary_recall': 0.81804043, 'binary_specificity': 0.99432474, 'binary_f1_score': 0.827044}
confusion matrix:
       0    1
0  18046  103
1    117  526
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9638862, 'precision': 0.8343699, 'recall': 0.6146905, 'specificity': 0.6146905, 'f1': 0.66600066, 'auroc': 0.94801164, 'binary_precision': 0.7011494, 'binary_recall': 0.23371647, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.3505747}
confusion matrix:
      0   1
0  5971  26
1   200  61
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863192.png
better model found
persisted
after epoch: 23,now: 2024-05-26 21:18:43.528094,epoch time: 0:22:41.977294,used: 8:43:17.589540,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863192
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9933982, 'precision': 0.9812112, 'recall': 0.91483337, 'specificity': 0.91483337, 'f1': 0.94538546, 'auroc': 0.99775004, 'binary_precision': 0.9682791, 'binary_recall': 0.83061224, 'binary_specificity': 0.9990545, 'binary_f1_score': 0.894178}
confusion matrix:
       0     1
0  42266    40
1    249  1221
---- Validation: 
scalar performance:
{'acc': 0.9867497, 'precision': 0.94088435, 'recall': 0.84687936, 'specificity': 0.84687936, 'f1': 0.8878497, 'auroc': 0.9725156, 'binary_precision': 0.8924303, 'binary_recall': 0.6967341, 'binary_specificity': 0.99702466, 'binary_f1_score': 0.78253275}
confusion matrix:
       0    1
0  18095   54
1    195  448
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959412, 'precision': 0.7807167, 'recall': 0.5390626, 'specificity': 0.5390626, 'f1': 0.56055313, 'auroc': 0.91780376, 'binary_precision': 0.6, 'binary_recall': 0.08045977, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.1418919}
confusion matrix:
      0   1
0  5983  14
1   240  21
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863192.png
early stop counter: 1
val acc:0.9867497086524963, best validation acc: 0.9882928729057312, corresponding to test acc:                         0.9638862013816833 / 0.973953366279602
after epoch: 24,now: 2024-05-26 21:41:21.578562,epoch time: 0:22:38.050468,used: 9:05:55.640008,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863192
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9961623, 'precision': 0.9782502, 'recall': 0.9618995, 'specificity': 0.9618995, 'f1': 0.969922, 'auroc': 0.9993188, 'binary_precision': 0.9590973, 'binary_recall': 0.92517006, 'binary_specificity': 0.99862903, 'binary_f1_score': 0.9418283}
confusion matrix:
       0     1
0  42248    58
1    110  1360
---- Validation: 
scalar performance:
{'acc': 0.98813325, 'precision': 0.9339492, 'recall': 0.8783479, 'specificity': 0.8783479, 'f1': 0.90409607, 'auroc': 0.9838566, 'binary_precision': 0.8763441, 'binary_recall': 0.7604977, 'binary_specificity': 0.9961981, 'binary_f1_score': 0.8143214}
confusion matrix:
       0    1
0  18080   69
1    154  489
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959412, 'precision': 0.8135321, 'recall': 0.5262363, 'specificity': 0.5262363, 'f1': 0.53926444, 'auroc': 0.9462394, 'binary_precision': 0.6666667, 'binary_recall': 0.053639848, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.09929079}
confusion matrix:
      0   1
0  5990   7
1   247  14
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863192.png
early stop counter: 2
val acc:0.9881332516670227, best validation acc: 0.9882928729057312, corresponding to test acc:                         0.9638862013816833 / 0.973953366279602
after epoch: 25,now: 2024-05-26 22:04:09.306804,epoch time: 0:22:47.728242,used: 9:28:43.368250,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863192
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9957739, 'precision': 0.9585997, 'recall': 0.9781283, 'specificity': 0.9781283, 'f1': 0.9681444, 'auroc': 0.9994091, 'binary_precision': 0.9186198, 'binary_recall': 0.9592114, 'binary_specificity': 0.9970453, 'binary_f1_score': 0.9384769}
confusion matrix:
       0     1
0  42180   125
1     60  1411
---- Validation: 
scalar performance:
{'acc': 0.9868561, 'precision': 0.8990004, 'recall': 0.9031886, 'specificity': 0.9031886, 'f1': 0.90108263, 'auroc': 0.98352224, 'binary_precision': 0.8046154, 'binary_recall': 0.8133748, 'binary_specificity': 0.99300236, 'binary_f1_score': 0.80897135}
confusion matrix:
       0    1
0  18022  127
1    120  523
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.8047465, 'recall': 0.5747941, 'specificity': 0.5747941, 'f1': 0.61387426, 'auroc': 0.9439696, 'binary_precision': 0.6451613, 'binary_recall': 0.1532567, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.247678}
confusion matrix:
      0   1
0  5975  22
1   221  40
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863192.png
early stop counter: 3
val acc:0.9868561029434204, best validation acc: 0.9882928729057312, corresponding to test acc:                         0.9638862013816833 / 0.973953366279602
after epoch: 26,now: 2024-05-26 22:26:41.098395,epoch time: 0:22:31.791591,used: 9:51:15.159841,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863192
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99671054, 'precision': 0.9752835, 'recall': 0.9740368, 'specificity': 0.9740368, 'f1': 0.9746593, 'auroc': 0.9992266, 'binary_precision': 0.9523161, 'binary_recall': 0.94972825, 'binary_specificity': 0.9983453, 'binary_f1_score': 0.9510205}
confusion matrix:
       0     1
0  42234    70
1     74  1398
---- Validation: 
scalar performance:
{'acc': 0.98797363, 'precision': 0.92372537, 'recall': 0.888016, 'specificity': 0.888016, 'f1': 0.9050218, 'auroc': 0.9818154, 'binary_precision': 0.85519594, 'binary_recall': 0.7807154, 'binary_specificity': 0.99531657, 'binary_f1_score': 0.81626016}
confusion matrix:
       0    1
0  18064   85
1    141  502
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96212846, 'precision': 0.80156916, 'recall': 0.6046117, 'specificity': 0.6046117, 'f1': 0.650719, 'auroc': 0.94387364, 'binary_precision': 0.6363636, 'binary_recall': 0.21455939, 'binary_specificity': 0.994664, 'binary_f1_score': 0.32091692}
confusion matrix:
      0   1
0  5965  32
1   205  56
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863192.png
early stop counter: 4
val acc:0.9879736304283142, best validation acc: 0.9882928729057312, corresponding to test acc:                         0.9638862013816833 / 0.973953366279602
after epoch: 27,now: 2024-05-26 22:49:05.714799,epoch time: 0:22:24.616404,used: 10:13:39.776245,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863192
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9939693, 'precision': 0.98987335, 'recall': 0.91622746, 'specificity': 0.91622746, 'f1': 0.94984317, 'auroc': 0.9993702, 'binary_precision': 0.98553056, 'binary_recall': 0.83288044, 'binary_specificity': 0.9995745, 'binary_f1_score': 0.90279824}
confusion matrix:
       0     1
0  42286    18
1    246  1226
---- Validation: 
scalar performance:
{'acc': 0.9850468, 'precision': 0.94465053, 'recall': 0.81449544, 'specificity': 0.81449544, 'f1': 0.8676045, 'auroc': 0.97612655, 'binary_precision': 0.9022222, 'binary_recall': 0.63141525, 'binary_specificity': 0.99757564, 'binary_f1_score': 0.74290943}
confusion matrix:
       0    1
0  18105   44
1    237  406
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.84399235, 'recall': 0.53015107, 'specificity': 0.53015107, 'f1': 0.54627794, 'auroc': 0.93094456, 'binary_precision': 0.72727275, 'binary_recall': 0.06130268, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.1130742}
confusion matrix:
      0   1
0  5991   6
1   245  16
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863192.png
early stop counter: 5
val acc:0.9850468039512634, best validation acc: 0.9882928729057312, corresponding to test acc:                         0.9638862013816833 / 0.973953366279602
after epoch: 28,now: 2024-05-26 23:11:24.269086,epoch time: 0:22:18.554287,used: 10:35:58.330532,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863192
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99684757, 'precision': 0.98278475, 'recall': 0.9682063, 'specificity': 0.9682063, 'f1': 0.97537535, 'auroc': 0.9995004, 'binary_precision': 0.9677419, 'binary_recall': 0.9375, 'binary_specificity': 0.99891263, 'binary_f1_score': 0.9523809}
confusion matrix:
       0     1
0  42258    46
1     92  1380
---- Validation: 
scalar performance:
{'acc': 0.98781395, 'precision': 0.93711925, 'recall': 0.869182, 'specificity': 0.869182, 'f1': 0.9000666, 'auroc': 0.9877977, 'binary_precision': 0.8833333, 'binary_recall': 0.7418352, 'binary_specificity': 0.99652874, 'binary_f1_score': 0.8064243}
confusion matrix:
       0    1
0  18086   63
1    166  477
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96164906, 'precision': 0.8242049, 'recall': 0.5732119, 'specificity': 0.5732119, 'f1': 0.6128038, 'auroc': 0.9418657, 'binary_precision': 0.68421054, 'binary_recall': 0.14942528, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.24528302}
confusion matrix:
      0   1
0  5979  18
1   222  39
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863192.png
early stop counter: 6
val acc:0.9878139495849609, best validation acc: 0.9882928729057312, corresponding to test acc:                         0.9638862013816833 / 0.973953366279602
after epoch: 29,now: 2024-05-26 23:33:40.561570,epoch time: 0:22:16.292484,used: 10:58:14.623016,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863192
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99604803, 'precision': 0.9950107, 'recall': 0.943783, 'specificity': 0.943783, 'f1': 0.967898, 'auroc': 0.9996731, 'binary_precision': 0.9939071, 'binary_recall': 0.8877551, 'binary_specificity': 0.9998109, 'binary_f1_score': 0.9378369}
confusion matrix:
       0     1
0  42298     8
1    165  1305
---- Validation: 
scalar performance:
{'acc': 0.98541933, 'precision': 0.9508718, 'recall': 0.81543833, 'specificity': 0.81543833, 'f1': 0.87032706, 'auroc': 0.981029, 'binary_precision': 0.91460675, 'binary_recall': 0.63297045, 'binary_specificity': 0.9979062, 'binary_f1_score': 0.7481618}
confusion matrix:
       0    1
0  18111   38
1    236  407
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642058, 'precision': 0.88959944, 'recall': 0.5910369, 'specificity': 0.5910369, 'f1': 0.6408166, 'auroc': 0.94737935, 'binary_precision': 0.8135593, 'binary_recall': 0.18390805, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.3}
confusion matrix:
      0   1
0  5986  11
1   213  48
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863192.png
early stop counter: 7
val acc:0.9854193329811096, best validation acc: 0.9882928729057312, corresponding to test acc:                         0.9638862013816833 / 0.973953366279602
after epoch: 30,now: 2024-05-26 23:55:59.373306,epoch time: 0:22:18.811736,used: 11:20:33.434752,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863192
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 11:20:33.434752 at 2024-05-26 23:55:59.373306
persisted model performance metric: 

scalar performance:
{'acc': 0.9646852, 'precision': 0.8557595, 'recall': 0.61510736, 'specificity': 0.61510736, 'f1': 0.66876507, 'auroc': 0.94444317, 'binary_precision': 0.74390244, 'binary_recall': 0.23371647, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.3556851}
confusion matrix:
      0   1
0  5976  21
1   200  61
oracle model performance metric: 

scalar performance:
{'acc': 0.9747523, 'precision': 0.9472877, 'recall': 0.7156414, 'specificity': 0.7156414, 'f1': 0.7877591, 'auroc': 0.9525987, 'binary_precision': 0.9186992, 'binary_recall': 0.4329502, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.5885417}
confusion matrix:
      0    1
0  5987   10
1   148  113
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs32/rule_results/6.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs32/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs32/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1661 MiB |  30289 MiB |    989 TiB |    989 TiB |
|       from large pool |   1655 MiB |  30243 MiB |    983 TiB |    983 TiB |
|       from small pool |      5 MiB |     46 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1661 MiB |  30289 MiB |    989 TiB |    989 TiB |
|       from large pool |   1655 MiB |  30243 MiB |    983 TiB |    983 TiB |
|       from small pool |      5 MiB |     46 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1653 MiB |  30205 MiB |    986 TiB |    986 TiB |
|       from large pool |   1647 MiB |  30159 MiB |    980 TiB |    980 TiB |
|       from small pool |      5 MiB |     46 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  31378 MiB |  31378 MiB |  31378 MiB |      0 B   |
|       from large pool |  31330 MiB |  31330 MiB |  31330 MiB |      0 B   |
|       from small pool |     48 MiB |     48 MiB |     48 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 631114 KiB |   1049 MiB | 116018 GiB | 116017 GiB |
|       from large pool | 592160 KiB |   1047 MiB | 109182 GiB | 109182 GiB |
|       from small pool |  38954 KiB |     41 MiB |   6835 GiB |   6835 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2190    |    3619    |   76019 K  |   76016 K  |
|       from large pool |     247    |     989    |   31115 K  |   31115 K  |
|       from small pool |    1943    |    3370    |   44903 K  |   44901 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2190    |    3619    |   76019 K  |   76016 K  |
|       from large pool |     247    |     989    |   31115 K  |   31115 K  |
|       from small pool |    1943    |    3370    |   44903 K  |   44901 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     860    |     860    |     860    |       0    |
|       from large pool |     836    |     836    |     836    |       0    |
|       from small pool |      24    |      24    |      24    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     146    |    1500    |   42204 K  |   42203 K  |
|       from large pool |     103    |     544    |   20192 K  |   20192 K  |
|       from small pool |      43    |    1396    |   22011 K  |   22011 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  30289 MiB |    989 TiB |    989 TiB |
|       from large pool |  16640 KiB |  30243 MiB |    983 TiB |    983 TiB |
|       from small pool |      0 KiB |     46 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  30289 MiB |    989 TiB |    989 TiB |
|       from large pool |  16640 KiB |  30243 MiB |    983 TiB |    983 TiB |
|       from small pool |      0 KiB |     46 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  30205 MiB |    986 TiB |    986 TiB |
|       from large pool |  16640 KiB |  30159 MiB |    980 TiB |    980 TiB |
|       from small pool |      0 KiB |     46 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2278 MiB |  31378 MiB |  31378 MiB |  29100 MiB |
|       from large pool |   2234 MiB |  31330 MiB |  31330 MiB |  29096 MiB |
|       from small pool |     44 MiB |     48 MiB |     48 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1049 MiB | 116019 GiB | 116019 GiB |
|       from large pool |  24320 KiB |   1047 MiB | 109183 GiB | 109183 GiB |
|       from small pool |      0 KiB |     41 MiB |   6835 GiB |   6835 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3619    |   76019 K  |   76019 K  |
|       from large pool |       2    |     989    |   31115 K  |   31115 K  |
|       from small pool |       0    |    3370    |   44903 K  |   44903 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3619    |   76019 K  |   76019 K  |
|       from large pool |       2    |     989    |   31115 K  |   31115 K  |
|       from small pool |       0    |    3370    |   44903 K  |   44903 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     123    |     860    |     860    |     737    |
|       from large pool |     101    |     836    |     836    |     735    |
|       from small pool |      22    |      24    |      24    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1500    |   42204 K  |   42204 K  |
|       from large pool |       3    |     544    |   20192 K  |   20192 K  |
|       from small pool |       0    |    1396    |   22012 K  |   22012 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  30289 MiB |    989 TiB |    989 TiB |
|       from large pool |  16640 KiB |  30243 MiB |    983 TiB |    983 TiB |
|       from small pool |      0 KiB |     46 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  30289 MiB |    989 TiB |    989 TiB |
|       from large pool |  16640 KiB |  30243 MiB |    983 TiB |    983 TiB |
|       from small pool |      0 KiB |     46 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  30205 MiB |    986 TiB |    986 TiB |
|       from large pool |  16640 KiB |  30159 MiB |    980 TiB |    980 TiB |
|       from small pool |      0 KiB |     46 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2278 MiB |  31378 MiB |  31378 MiB |  29100 MiB |
|       from large pool |   2234 MiB |  31330 MiB |  31330 MiB |  29096 MiB |
|       from small pool |     44 MiB |     48 MiB |     48 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1049 MiB | 116019 GiB | 116019 GiB |
|       from large pool |  24320 KiB |   1047 MiB | 109183 GiB | 109183 GiB |
|       from small pool |      0 KiB |     41 MiB |   6835 GiB |   6835 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3619    |   76019 K  |   76019 K  |
|       from large pool |       2    |     989    |   31115 K  |   31115 K  |
|       from small pool |       0    |    3370    |   44903 K  |   44903 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3619    |   76019 K  |   76019 K  |
|       from large pool |       2    |     989    |   31115 K  |   31115 K  |
|       from small pool |       0    |    3370    |   44903 K  |   44903 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     123    |     860    |     860    |     737    |
|       from large pool |     101    |     836    |     836    |     735    |
|       from small pool |      22    |      24    |      24    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1500    |   42204 K  |   42204 K  |
|       from large pool |       3    |     544    |   20192 K  |   20192 K  |
|       from small pool |       0    |    1396    |   22012 K  |   22012 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_04_47_seed_1_20863192

 Experiment start at: 2024-05-27 00:04:47.455203
before training, model accuracy: 0.06445375829935074
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9741332, 'precision': 0.8222023, 'recall': 0.7124428, 'specificity': 0.7124428, 'f1': 0.75511754, 'auroc': 0.96585214, 'binary_precision': 0.66347176, 'binary_recall': 0.43233865, 'binary_specificity': 0.992547, 'binary_f1_score': 0.5235294}
confusion matrix:
       0    1
0  42083  316
1    818  623
---- Validation: 
scalar performance:
{'acc': 0.9711846, 'precision': 0.8362082, 'recall': 0.6724838, 'specificity': 0.6724838, 'f1': 0.72579783, 'auroc': 0.9648152, 'binary_precision': 0.6961652, 'binary_recall': 0.35066864, 'binary_specificity': 0.994299, 'binary_f1_score': 0.46640316}
confusion matrix:
       0    1
0  17964  103
1    437  236
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9626168, 'precision': 0.8387153, 'recall': 0.5887869, 'specificity': 0.5887869, 'f1': 0.6345739, 'auroc': 0.9463481, 'binary_precision': 0.7121212, 'binary_recall': 0.18076923, 'binary_specificity': 0.9968046, 'binary_f1_score': 0.28834355}
confusion matrix:
      0   1
0  5927  19
1   213  47
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863192.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-27 00:28:34.441072,epoch time: 0:23:46.985869,used: 0:23:46.985869,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_04_47_seed_1_20863192
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97228557, 'precision': 0.89146304, 'recall': 0.60215646, 'specificity': 0.60215646, 'f1': 0.65710455, 'auroc': 0.97343075, 'binary_precision': 0.8092643, 'binary_recall': 0.20596394, 'binary_specificity': 0.99834895, 'binary_f1_score': 0.3283582}
confusion matrix:
       0    1
0  42328   70
1   1145  297
---- Validation: 
scalar performance:
{'acc': 0.96873, 'precision': 0.9008766, 'recall': 0.58037186, 'specificity': 0.58037186, 'f1': 0.62758327, 'auroc': 0.96799946, 'binary_precision': 0.83206105, 'binary_recall': 0.16196136, 'binary_specificity': 0.99878234, 'binary_f1_score': 0.27114424}
confusion matrix:
       0    1
0  18045   22
1    564  109
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96422815, 'precision': 0.96957916, 'recall': 0.5749159, 'specificity': 0.5749159, 'f1': 0.62083554, 'auroc': 0.96173036, 'binary_precision': 0.975, 'binary_recall': 0.15, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.26000002}
confusion matrix:
      0   1
0  5945   1
1   221  39
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863192.png
new oracle model saved
early stop counter: 1
val acc:0.9687299728393555, best validation acc: 0.9711846113204956, corresponding to test acc:                         0.9626168012619019 / 0.9642281532287598
after epoch: 2,now: 2024-05-27 00:51:19.924686,epoch time: 0:22:45.483614,used: 0:46:32.469483,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_04_47_seed_1_20863192
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9779197, 'precision': 0.8971485, 'recall': 0.71158266, 'specificity': 0.71158266, 'f1': 0.77413785, 'auroc': 0.97620684, 'binary_precision': 0.81349206, 'binary_recall': 0.426491, 'binary_specificity': 0.99667436, 'binary_f1_score': 0.55959964}
confusion matrix:
       0    1
0  42257  141
1    827  615
---- Validation: 
scalar performance:
{'acc': 0.9768943, 'precision': 0.93777406, 'recall': 0.7004794, 'specificity': 0.7004794, 'f1': 0.772018, 'auroc': 0.97313464, 'binary_precision': 0.89735097, 'binary_recall': 0.4026746, 'binary_specificity': 0.99828416, 'binary_f1_score': 0.5558974}
confusion matrix:
       0    1
0  18036   31
1    402  271
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.72920024, 'recall': 0.50367796, 'specificity': 0.50367796, 'f1': 0.49687442, 'auroc': 0.9472674, 'binary_precision': 0.5, 'binary_recall': 0.0076923077, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.015151515}
confusion matrix:
      0  1
0  5944  2
1   258  2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863192.png
better model found
persisted
after epoch: 3,now: 2024-05-27 01:14:02.604991,epoch time: 0:22:42.680305,used: 1:09:15.149788,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_04_47_seed_1_20863192
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9813184, 'precision': 0.87512815, 'recall': 0.81013966, 'specificity': 0.81013966, 'f1': 0.8393041, 'auroc': 0.98058057, 'binary_precision': 0.7628692, 'binary_recall': 0.62690705, 'binary_specificity': 0.9933723, 'binary_f1_score': 0.6882375}
confusion matrix:
       0    1
0  42117  281
1    538  904
---- Validation: 
scalar performance:
{'acc': 0.9783885, 'precision': 0.90907335, 'recall': 0.7456008, 'specificity': 0.7456008, 'f1': 0.8053626, 'auroc': 0.9769371, 'binary_precision': 0.8366834, 'binary_recall': 0.4947994, 'binary_specificity': 0.99640226, 'binary_f1_score': 0.62184876}
confusion matrix:
       0    1
0  18002   65
1    340  333
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621334, 'precision': 0.9099359, 'recall': 0.55727184, 'specificity': 0.55727184, 'f1': 0.5919978, 'auroc': 0.94093895, 'binary_precision': 0.85714287, 'binary_recall': 0.115384616, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.20338982}
confusion matrix:
      0   1
0  5941   5
1   230  30
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863192.png
better model found
persisted
after epoch: 4,now: 2024-05-27 01:36:46.887648,epoch time: 0:22:44.282657,used: 1:31:59.432445,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_04_47_seed_1_20863192
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9808166, 'precision': 0.96135175, 'recall': 0.721789, 'specificity': 0.721789, 'f1': 0.7970164, 'auroc': 0.9884908, 'binary_precision': 0.94126284, 'binary_recall': 0.4445215, 'binary_specificity': 0.9990566, 'binary_f1_score': 0.6038624}
confusion matrix:
       0    1
0  42358   40
1    801  641
---- Validation: 
scalar performance:
{'acc': 0.9770544, 'precision': 0.9662143, 'recall': 0.68911815, 'specificity': 0.68911815, 'f1': 0.76539266, 'auroc': 0.9789107, 'binary_precision': 0.9550562, 'binary_recall': 0.37890044, 'binary_specificity': 0.9993358, 'binary_f1_score': 0.5425532}
confusion matrix:
       0    1
0  18055   12
1    418  255
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95955527, 'precision': 0.9343679, 'recall': 0.5191467, 'specificity': 0.5191467, 'f1': 0.52656347, 'auroc': 0.9583699, 'binary_precision': 0.90909094, 'binary_recall': 0.03846154, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.07380074}
confusion matrix:
      0   1
0  5945   1
1   250  10
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863192.png
early stop counter: 1
val acc:0.9770544171333313, best validation acc: 0.9783884882926941, corresponding to test acc:                         0.9621334075927734 / 0.9642281532287598
after epoch: 5,now: 2024-05-27 01:59:28.450988,epoch time: 0:22:41.563340,used: 1:54:40.995785,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_04_47_seed_1_20863192
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98423815, 'precision': 0.9582143, 'recall': 0.7804991, 'specificity': 0.7804991, 'f1': 0.8465797, 'auroc': 0.98865795, 'binary_precision': 0.93111366, 'binary_recall': 0.56241333, 'binary_specificity': 0.99858487, 'binary_f1_score': 0.70125383}
confusion matrix:
       0    1
0  42338   60
1    631  811
---- Validation: 
scalar performance:
{'acc': 0.9802028, 'precision': 0.96122116, 'recall': 0.73867387, 'specificity': 0.73867387, 'f1': 0.8121543, 'auroc': 0.98086834, 'binary_precision': 0.94152045, 'binary_recall': 0.47845468, 'binary_specificity': 0.998893, 'binary_f1_score': 0.63448274}
confusion matrix:
       0    1
0  18047   20
1    351  322
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96036094, 'precision': 0.8651979, 'recall': 0.537957, 'specificity': 0.537957, 'f1': 0.55978656, 'auroc': 0.9544275, 'binary_precision': 0.7692308, 'binary_recall': 0.07692308, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.13986015}
confusion matrix:
      0   1
0  5940   6
1   240  20
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863192.png
better model found
persisted
after epoch: 6,now: 2024-05-27 02:22:10.704595,epoch time: 0:22:42.253607,used: 2:17:23.249392,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_04_47_seed_1_20863192
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9864963, 'precision': 0.93244076, 'recall': 0.84195715, 'specificity': 0.84195715, 'f1': 0.8815259, 'auroc': 0.99154603, 'binary_precision': 0.8754417, 'binary_recall': 0.68723994, 'binary_specificity': 0.99667436, 'binary_f1_score': 0.7700077}
confusion matrix:
       0    1
0  42257  141
1    451  991
---- Validation: 
scalar performance:
{'acc': 0.9810032, 'precision': 0.9134244, 'recall': 0.7877271, 'specificity': 0.7877271, 'f1': 0.8384123, 'auroc': 0.97809917, 'binary_precision': 0.8423326, 'binary_recall': 0.5794948, 'binary_specificity': 0.99595946, 'binary_f1_score': 0.68661976}
confusion matrix:
       0    1
0  17994   73
1    283  390
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96132773, 'precision': 0.88729954, 'recall': 0.54949546, 'specificity': 0.54949546, 'f1': 0.5791401, 'auroc': 0.95404136, 'binary_precision': 0.8125, 'binary_recall': 0.1, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.1780822}
confusion matrix:
      0   1
0  5940   6
1   234  26
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863192.png
better model found
persisted
after epoch: 7,now: 2024-05-27 02:44:59.181548,epoch time: 0:22:48.476953,used: 2:40:11.726345,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_04_47_seed_1_20863192
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98822993, 'precision': 0.90624326, 'recall': 0.909508, 'specificity': 0.909508, 'f1': 0.90786856, 'auroc': 0.9921682, 'binary_precision': 0.8184319, 'binary_recall': 0.8252427, 'binary_specificity': 0.9937733, 'binary_f1_score': 0.8218232}
confusion matrix:
       0     1
0  42134   264
1    252  1190
---- Validation: 
scalar performance:
{'acc': 0.98404485, 'precision': 0.89641094, 'recall': 0.8651229, 'specificity': 0.8651229, 'f1': 0.8800672, 'auroc': 0.9795885, 'binary_precision': 0.802589, 'binary_recall': 0.7369985, 'binary_specificity': 0.99324733, 'binary_f1_score': 0.7683966}
confusion matrix:
       0    1
0  17945  122
1    177  496
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614889, 'precision': 0.8131011, 'recall': 0.5808423, 'specificity': 0.5808423, 'f1': 0.622421, 'auroc': 0.94304544, 'binary_precision': 0.6615385, 'binary_recall': 0.16538462, 'binary_specificity': 0.99630004, 'binary_f1_score': 0.2646154}
confusion matrix:
      0   1
0  5924  22
1   217  43
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863192.png
better model found
persisted
after epoch: 8,now: 2024-05-27 03:07:39.821655,epoch time: 0:22:40.640107,used: 3:02:52.366452,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_04_47_seed_1_20863192
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98736316, 'precision': 0.89185226, 'recall': 0.9159827, 'specificity': 0.9159827, 'f1': 0.9035267, 'auroc': 0.9924083, 'binary_precision': 0.7891645, 'binary_recall': 0.83958334, 'binary_specificity': 0.99238205, 'binary_f1_score': 0.8135935}
confusion matrix:
       0     1
0  42077   323
1    231  1209
---- Validation: 
scalar performance:
{'acc': 0.9851121, 'precision': 0.89869523, 'recall': 0.8821276, 'specificity': 0.8821276, 'f1': 0.89021987, 'auroc': 0.98450595, 'binary_precision': 0.80590063, 'binary_recall': 0.77117383, 'binary_specificity': 0.99308133, 'binary_f1_score': 0.78815484}
confusion matrix:
       0    1
0  17942  125
1    154  519
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9634225, 'precision': 0.8560306, 'recall': 0.5947243, 'specificity': 0.5947243, 'f1': 0.6435134, 'auroc': 0.95878065, 'binary_precision': 0.74626863, 'binary_recall': 0.1923077, 'binary_specificity': 0.99714094, 'binary_f1_score': 0.3058104}
confusion matrix:
      0   1
0  5929  17
1   210  50
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863192.png
better model found
persisted
after epoch: 9,now: 2024-05-27 03:30:23.051620,epoch time: 0:22:43.229965,used: 3:25:35.596417,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_04_47_seed_1_20863192
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98907393, 'precision': 0.9142412, 'recall': 0.91396374, 'specificity': 0.91396374, 'f1': 0.91410244, 'auroc': 0.9929935, 'binary_precision': 0.834143, 'binary_recall': 0.8335645, 'binary_specificity': 0.99436295, 'binary_f1_score': 0.8338537}
confusion matrix:
       0     1
0  42159   239
1    240  1202
---- Validation: 
scalar performance:
{'acc': 0.9848986, 'precision': 0.9180689, 'recall': 0.85126036, 'specificity': 0.85126036, 'f1': 0.88152105, 'auroc': 0.9820574, 'binary_precision': 0.8469751, 'binary_recall': 0.7072808, 'binary_specificity': 0.9952399, 'binary_f1_score': 0.7708501}
confusion matrix:
       0    1
0  17981   86
1    197  476
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597164, 'precision': 0.7905426, 'recall': 0.54865456, 'specificity': 0.54865456, 'f1': 0.5757707, 'auroc': 0.9429532, 'binary_precision': 0.61904764, 'binary_recall': 0.1, 'binary_specificity': 0.9973091, 'binary_f1_score': 0.17218544}
confusion matrix:
      0   1
0  5930  16
1   234  26
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863192.png
early stop counter: 1
val acc:0.9848986268043518, best validation acc: 0.9851120710372925, corresponding to test acc:                         0.9634224772453308 / 0.9642281532287598
after epoch: 10,now: 2024-05-27 03:53:08.298700,epoch time: 0:22:45.247080,used: 3:48:20.843497,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_04_47_seed_1_20863192
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9899179, 'precision': 0.9523296, 'recall': 0.88224506, 'specificity': 0.88224506, 'f1': 0.9141302, 'auroc': 0.9936889, 'binary_precision': 0.9125413, 'binary_recall': 0.7669903, 'binary_specificity': 0.9974999, 'binary_f1_score': 0.8334589}
confusion matrix:
       0     1
0  42292   106
1    336  1106
---- Validation: 
scalar performance:
{'acc': 0.9825507, 'precision': 0.94899654, 'recall': 0.7828076, 'specificity': 0.7828076, 'f1': 0.8456444, 'auroc': 0.9764744, 'binary_precision': 0.9138756, 'binary_recall': 0.5676077, 'binary_specificity': 0.9980074, 'binary_f1_score': 0.700275}
confusion matrix:
       0    1
0  18031   36
1    291  382
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96019983, 'precision': 0.94679916, 'recall': 0.52683896, 'specificity': 0.52683896, 'f1': 0.5407336, 'auroc': 0.9195534, 'binary_precision': 0.93333334, 'binary_recall': 0.053846154, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.10181818}
confusion matrix:
      0   1
0  5945   1
1   246  14
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863192.png
early stop counter: 2
val acc:0.9825506806373596, best validation acc: 0.9851120710372925, corresponding to test acc:                         0.9634224772453308 / 0.9642281532287598
after epoch: 11,now: 2024-05-27 04:15:58.731125,epoch time: 0:22:50.432425,used: 4:11:11.275922,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_04_47_seed_1_20863192
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9888458, 'precision': 0.9412707, 'recall': 0.8749919, 'specificity': 0.8749919, 'f1': 0.9052415, 'auroc': 0.9944452, 'binary_precision': 0.8908942, 'binary_recall': 0.75312066, 'binary_specificity': 0.99686307, 'binary_f1_score': 0.8162345}
confusion matrix:
       0     1
0  42265   133
1    356  1086
---- Validation: 
scalar performance:
{'acc': 0.98372465, 'precision': 0.9396033, 'recall': 0.809166, 'specificity': 0.809166, 'f1': 0.8621487, 'auroc': 0.9745525, 'binary_precision': 0.89316237, 'binary_recall': 0.62109953, 'binary_specificity': 0.9972325, 'binary_f1_score': 0.7326906}
confusion matrix:
       0    1
0  18017   50
1    255  418
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96036094, 'precision': 0.9801357, 'recall': 0.52692306, 'specificity': 0.52692306, 'f1': 0.54096144, 'auroc': 0.86907876, 'binary_precision': 1.0, 'binary_recall': 0.053846154, 'binary_specificity': 1.0, 'binary_f1_score': 0.10218979}
confusion matrix:
      0   1
0  5946   0
1   246  14
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863192.png
early stop counter: 3
val acc:0.9837246537208557, best validation acc: 0.9851120710372925, corresponding to test acc:                         0.9634224772453308 / 0.9642281532287598
after epoch: 12,now: 2024-05-27 04:38:42.579249,epoch time: 0:22:43.848124,used: 4:33:55.124046,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_04_47_seed_1_20863192
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98492247, 'precision': 0.85398316, 'recall': 0.9500014, 'specificity': 0.9500014, 'f1': 0.8957191, 'auroc': 0.993899, 'binary_precision': 0.71096706, 'binary_recall': 0.9126214, 'binary_specificity': 0.98738146, 'binary_f1_score': 0.7992712}
confusion matrix:
       0     1
0  41863   535
1    126  1316
---- Validation: 
scalar performance:
{'acc': 0.98223054, 'precision': 0.8581555, 'recall': 0.90352166, 'specificity': 0.90352166, 'f1': 0.8793529, 'auroc': 0.97342575, 'binary_precision': 0.7230971, 'binary_recall': 0.8187221, 'binary_specificity': 0.98832124, 'binary_f1_score': 0.7679442}
confusion matrix:
       0    1
0  17856  211
1    122  551
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9639059, 'precision': 0.85820836, 'recall': 0.60233253, 'specificity': 0.60233253, 'f1': 0.6533791, 'auroc': 0.9058509, 'binary_precision': 0.75, 'binary_recall': 0.20769231, 'binary_specificity': 0.99697274, 'binary_f1_score': 0.3253012}
confusion matrix:
      0   1
0  5928  18
1   206  54
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863192.png
early stop counter: 4
val acc:0.982230544090271, best validation acc: 0.9851120710372925, corresponding to test acc:                         0.9634224772453308 / 0.9642281532287598
after epoch: 13,now: 2024-05-27 05:01:23.590059,epoch time: 0:22:41.010810,used: 4:56:36.134856,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_04_47_seed_1_20863192
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9897582, 'precision': 0.91563404, 'recall': 0.9253708, 'specificity': 0.9253708, 'f1': 0.9204415, 'auroc': 0.9955834, 'binary_precision': 0.83615434, 'binary_recall': 0.85644937, 'binary_specificity': 0.9942922, 'binary_f1_score': 0.8461802}
confusion matrix:
       0     1
0  42156   242
1    207  1235
---- Validation: 
scalar performance:
{'acc': 0.98399144, 'precision': 0.89762664, 'recall': 0.8622342, 'specificity': 0.8622342, 'f1': 0.8790334, 'auroc': 0.97875786, 'binary_precision': 0.8052373, 'binary_recall': 0.73105496, 'binary_specificity': 0.9934134, 'binary_f1_score': 0.76635504}
confusion matrix:
       0    1
0  17948  119
1    181  492
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96100545, 'precision': 0.9181697, 'recall': 0.54013234, 'specificity': 0.54013234, 'f1': 0.56396675, 'auroc': 0.94939405, 'binary_precision': 0.875, 'binary_recall': 0.08076923, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.14788732}
confusion matrix:
      0   1
0  5943   3
1   239  21
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863192.png
early stop counter: 5
val acc:0.9839914441108704, best validation acc: 0.9851120710372925, corresponding to test acc:                         0.9634224772453308 / 0.9642281532287598
after epoch: 14,now: 2024-05-27 05:24:06.799394,epoch time: 0:22:43.209335,used: 5:19:19.344191,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_04_47_seed_1_20863192
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99142337, 'precision': 0.9340764, 'recall': 0.930586, 'specificity': 0.930586, 'f1': 0.9323236, 'auroc': 0.9963963, 'binary_precision': 0.8727273, 'binary_recall': 0.8654646, 'binary_specificity': 0.99570733, 'binary_f1_score': 0.8690808}
confusion matrix:
       0     1
0  42216   182
1    194  1248
---- Validation: 
scalar performance:
{'acc': 0.984952, 'precision': 0.9147701, 'recall': 0.85629493, 'specificity': 0.85629493, 'f1': 0.8831277, 'auroc': 0.9784499, 'binary_precision': 0.84, 'binary_recall': 0.717682, 'binary_specificity': 0.99490786, 'binary_f1_score': 0.77403843}
confusion matrix:
       0    1
0  17975   92
1    190  483
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96132773, 'precision': 0.8700882, 'recall': 0.5531734, 'specificity': 0.5531734, 'f1': 0.58469033, 'auroc': 0.94057107, 'binary_precision': 0.7777778, 'binary_recall': 0.10769231, 'binary_specificity': 0.99865454, 'binary_f1_score': 0.1891892}
confusion matrix:
      0   1
0  5938   8
1   232  28
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863192.png
early stop counter: 6
val acc:0.9849519729614258, best validation acc: 0.9851120710372925, corresponding to test acc:                         0.9634224772453308 / 0.9642281532287598
after epoch: 15,now: 2024-05-27 05:46:51.227568,epoch time: 0:22:44.428174,used: 5:42:03.772365,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_04_47_seed_1_20863192
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9915146, 'precision': 0.9696773, 'recall': 0.89244914, 'specificity': 0.89244914, 'f1': 0.92735827, 'auroc': 0.9973409, 'binary_precision': 0.9465776, 'binary_recall': 0.78640777, 'binary_specificity': 0.9984905, 'binary_f1_score': 0.85909086}
confusion matrix:
       0     1
0  42334    64
1    308  1134
---- Validation: 
scalar performance:
{'acc': 0.98265743, 'precision': 0.92562795, 'recall': 0.80432093, 'specificity': 0.80432093, 'f1': 0.85409987, 'auroc': 0.9765711, 'binary_precision': 0.8655462, 'binary_recall': 0.6121842, 'binary_specificity': 0.99645764, 'binary_f1_score': 0.71714526}
confusion matrix:
       0    1
0  18003   64
1    261  412
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96084434, 'precision': 0.8597534, 'recall': 0.54740417, 'specificity': 0.54740417, 'f1': 0.5752986, 'auroc': 0.8859682, 'binary_precision': 0.75757575, 'binary_recall': 0.09615385, 'binary_specificity': 0.99865454, 'binary_f1_score': 0.17064846}
confusion matrix:
      0   1
0  5938   8
1   235  25
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863192.png
early stop counter: 7
val acc:0.9826574325561523, best validation acc: 0.9851120710372925, corresponding to test acc:                         0.9634224772453308 / 0.9642281532287598
after epoch: 16,now: 2024-05-27 06:09:36.266560,epoch time: 0:22:45.038992,used: 6:04:48.811357,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_04_47_seed_1_20863192
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9921989, 'precision': 0.98026717, 'recall': 0.89406955, 'specificity': 0.89406955, 'f1': 0.9326228, 'auroc': 0.9972187, 'binary_precision': 0.9676596, 'binary_recall': 0.7890354, 'binary_specificity': 0.9991037, 'binary_f1_score': 0.86926603}
confusion matrix:
       0     1
0  42361    38
1    304  1137
---- Validation: 
scalar performance:
{'acc': 0.9851654, 'precision': 0.95137954, 'recall': 0.8220728, 'specificity': 0.8220728, 'f1': 0.87509406, 'auroc': 0.9804064, 'binary_precision': 0.9157895, 'binary_recall': 0.64635956, 'binary_specificity': 0.99778605, 'binary_f1_score': 0.75783974}
confusion matrix:
       0    1
0  18027   40
1    238  435
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959233, 'precision': 0.924112, 'recall': 0.5153005, 'specificity': 0.5153005, 'f1': 0.5193222, 'auroc': 0.87229276, 'binary_precision': 0.8888889, 'binary_recall': 0.03076923, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.059479553}
confusion matrix:
      0  1
0  5945  1
1   252  8
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863192.png
better model found
persisted
after epoch: 17,now: 2024-05-27 06:32:18.490517,epoch time: 0:22:42.223957,used: 6:27:31.035314,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_04_47_seed_1_20863192
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9931113, 'precision': 0.9501258, 'recall': 0.9404621, 'specificity': 0.9404621, 'f1': 0.9452375, 'auroc': 0.9975344, 'binary_precision': 0.9041874, 'binary_recall': 0.88410825, 'binary_specificity': 0.996816, 'binary_f1_score': 0.89403504}
confusion matrix:
       0     1
0  42264   135
1    167  1274
---- Validation: 
scalar performance:
{'acc': 0.98447174, 'precision': 0.9041501, 'recall': 0.861768, 'specificity': 0.861768, 'f1': 0.88168454, 'auroc': 0.9767026, 'binary_precision': 0.8183333, 'binary_recall': 0.7295691, 'binary_specificity': 0.9939669, 'binary_f1_score': 0.7714062}
confusion matrix:
       0    1
0  17958  109
1    182  491
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589107, 'precision': 0.76441276, 'recall': 0.53903913, 'specificity': 0.53903913, 'f1': 0.5601829, 'auroc': 0.93297243, 'binary_precision': 0.5675676, 'binary_recall': 0.08076923, 'binary_specificity': 0.9973091, 'binary_f1_score': 0.14141415}
confusion matrix:
      0   1
0  5930  16
1   239  21
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863192.png
early stop counter: 1
val acc:0.9844717383384705, best validation acc: 0.9851654171943665, corresponding to test acc:                         0.9592329859733582 / 0.9642281532287598
after epoch: 18,now: 2024-05-27 06:55:01.410927,epoch time: 0:22:42.920410,used: 6:50:13.955724,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_04_47_seed_1_20863192
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99320257, 'precision': 0.94730127, 'recall': 0.9455005, 'specificity': 0.9455005, 'f1': 0.946399, 'auroc': 0.9979339, 'binary_precision': 0.89818686, 'binary_recall': 0.89444447, 'binary_specificity': 0.9965566, 'binary_f1_score': 0.89631176}
confusion matrix:
       0     1
0  42254   146
1    152  1288
---- Validation: 
scalar performance:
{'acc': 0.9853255, 'precision': 0.903074, 'recall': 0.87937725, 'specificity': 0.87937725, 'f1': 0.89083505, 'auroc': 0.97625536, 'binary_precision': 0.8148734, 'binary_recall': 0.7652303, 'binary_specificity': 0.99352413, 'binary_f1_score': 0.789272}
confusion matrix:
       0    1
0  17950  117
1    158  515
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.73196805, 'recall': 0.5717205, 'specificity': 0.5717205, 'f1': 0.6046177, 'auroc': 0.9320805, 'binary_precision': 0.5, 'binary_recall': 0.15, 'binary_specificity': 0.993441, 'binary_f1_score': 0.23076925}
confusion matrix:
      0   1
0  5907  39
1   221  39
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863192.png
better model found
persisted
after epoch: 19,now: 2024-05-27 07:17:46.209398,epoch time: 0:22:44.798471,used: 7:12:58.754195,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_04_47_seed_1_20863192
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9941834, 'precision': 0.95692337, 'recall': 0.95110494, 'specificity': 0.95110494, 'f1': 0.9539941, 'auroc': 0.99858713, 'binary_precision': 0.9170766, 'binary_recall': 0.90499306, 'binary_specificity': 0.9972168, 'binary_f1_score': 0.91099477}
confusion matrix:
       0     1
0  42280   118
1    137  1305
---- Validation: 
scalar performance:
{'acc': 0.98623264, 'precision': 0.91918325, 'recall': 0.8734102, 'specificity': 0.8734102, 'f1': 0.89486265, 'auroc': 0.9765085, 'binary_precision': 0.8475712, 'binary_recall': 0.75185734, 'binary_specificity': 0.99496317, 'binary_f1_score': 0.7968504}
confusion matrix:
       0    1
0  17976   91
1    167  506
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587496, 'precision': 0.785436, 'recall': 0.5205652, 'specificity': 0.5205652, 'f1': 0.5290195, 'auroc': 0.8787485, 'binary_precision': 0.6111111, 'binary_recall': 0.042307694, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.07913669}
confusion matrix:
      0   1
0  5939   7
1   249  11
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863192.png
better model found
persisted
after epoch: 20,now: 2024-05-27 07:40:29.588991,epoch time: 0:22:43.379593,used: 7:35:42.133788,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_04_47_seed_1_20863192
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9949361, 'precision': 0.9539342, 'recall': 0.9679066, 'specificity': 0.9679066, 'f1': 0.9608063, 'auroc': 0.9991962, 'binary_precision': 0.90994626, 'binary_recall': 0.93897367, 'binary_specificity': 0.99683946, 'binary_f1_score': 0.9242321}
confusion matrix:
       0     1
0  42264   134
1     88  1354
---- Validation: 
scalar performance:
{'acc': 0.98628604, 'precision': 0.90995085, 'recall': 0.887028, 'specificity': 0.887028, 'f1': 0.89813083, 'auroc': 0.97763234, 'binary_precision': 0.8280757, 'binary_recall': 0.78008914, 'binary_specificity': 0.9939669, 'binary_f1_score': 0.8033665}
confusion matrix:
       0    1
0  17958  109
1    148  525
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96132773, 'precision': 0.8279543, 'recall': 0.56788534, 'specificity': 0.56788534, 'f1': 0.60546726, 'auroc': 0.9204095, 'binary_precision': 0.6923077, 'binary_recall': 0.13846155, 'binary_specificity': 0.9973091, 'binary_f1_score': 0.23076923}
confusion matrix:
      0   1
0  5930  16
1   224  36
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863192.png
better model found
persisted
after epoch: 21,now: 2024-05-27 08:03:16.476383,epoch time: 0:22:46.887392,used: 7:58:29.021180,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_04_47_seed_1_20863192
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9952555, 'precision': 0.9638591, 'recall': 0.96137273, 'specificity': 0.96137273, 'f1': 0.9626123, 'auroc': 0.9989177, 'binary_precision': 0.930265, 'binary_recall': 0.925104, 'binary_specificity': 0.9976414, 'binary_f1_score': 0.9276773}
confusion matrix:
       0     1
0  42298   100
1    108  1334
---- Validation: 
scalar performance:
{'acc': 0.98569906, 'precision': 0.9154009, 'recall': 0.8688419, 'specificity': 0.8688419, 'f1': 0.8906213, 'auroc': 0.97612494, 'binary_precision': 0.84033614, 'binary_recall': 0.74294204, 'binary_specificity': 0.9947418, 'binary_f1_score': 0.78864354}
confusion matrix:
       0    1
0  17972   95
1    173  500
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95939416, 'precision': 0.7630149, 'recall': 0.56687623, 'specificity': 0.56687623, 'f1': 0.60068756, 'auroc': 0.9297364, 'binary_precision': 0.5625, 'binary_recall': 0.13846155, 'binary_specificity': 0.99529094, 'binary_f1_score': 0.22222224}
confusion matrix:
      0   1
0  5918  28
1   224  36
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863192.png
early stop counter: 1
val acc:0.9856990575790405, best validation acc: 0.9862860441207886, corresponding to test acc:                         0.9613277316093445 / 0.9642281532287598
after epoch: 22,now: 2024-05-27 08:26:04.457423,epoch time: 0:22:47.981040,used: 8:21:17.002220,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_04_47_seed_1_20863192
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9929288, 'precision': 0.98726314, 'recall': 0.89980996, 'specificity': 0.89980996, 'f1': 0.93892705, 'auroc': 0.9985215, 'binary_precision': 0.9812766, 'binary_recall': 0.8001388, 'binary_specificity': 0.99948114, 'binary_f1_score': 0.88149846}
confusion matrix:
       0     1
0  42377    22
1    288  1153
---- Validation: 
scalar performance:
{'acc': 0.9838314, 'precision': 0.951064, 'recall': 0.80135345, 'specificity': 0.80135345, 'f1': 0.86020255, 'auroc': 0.9752816, 'binary_precision': 0.9166667, 'binary_recall': 0.6047548, 'binary_specificity': 0.99795204, 'binary_f1_score': 0.7287377}
confusion matrix:
       0    1
0  18030   37
1    266  407
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584273, 'precision': 0.7653655, 'recall': 0.51488006, 'specificity': 0.51488006, 'f1': 0.5185693, 'auroc': 0.921616, 'binary_precision': 0.5714286, 'binary_recall': 0.03076923, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.05839416}
confusion matrix:
      0  1
0  5940  6
1   252  8
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863192.png
early stop counter: 2
val acc:0.9838314056396484, best validation acc: 0.9862860441207886, corresponding to test acc:                         0.9613277316093445 / 0.9642281532287598
after epoch: 23,now: 2024-05-27 08:48:58.941645,epoch time: 0:22:54.484222,used: 8:44:11.486442,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_04_47_seed_1_20863192
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9960082, 'precision': 0.97141117, 'recall': 0.9653996, 'specificity': 0.9653996, 'f1': 0.9683846, 'auroc': 0.99934447, 'binary_precision': 0.94510907, 'binary_recall': 0.9326389, 'binary_specificity': 0.99816036, 'binary_f1_score': 0.9388325}
confusion matrix:
       0     1
0  42322    78
1     97  1343
---- Validation: 
scalar performance:
{'acc': 0.9866062, 'precision': 0.9277633, 'recall': 0.8693124, 'specificity': 0.8693124, 'f1': 0.89621615, 'auroc': 0.9762897, 'binary_precision': 0.8650519, 'binary_recall': 0.74294204, 'binary_specificity': 0.9956827, 'binary_f1_score': 0.7993605}
confusion matrix:
       0    1
0  17989   78
1    173  500
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9577828, 'precision': 0.7208317, 'recall': 0.5439675, 'specificity': 0.5439675, 'f1': 0.5665947, 'auroc': 0.92530775, 'binary_precision': 0.48, 'binary_recall': 0.092307694, 'binary_specificity': 0.9956273, 'binary_f1_score': 0.15483871}
confusion matrix:
      0   1
0  5920  26
1   236  24
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863192.png
better model found
persisted
after epoch: 24,now: 2024-05-27 09:11:45.968310,epoch time: 0:22:47.026665,used: 9:06:58.513107,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_04_47_seed_1_20863192
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9955292, 'precision': 0.95629454, 'recall': 0.975231, 'specificity': 0.975231, 'f1': 0.9655554, 'auroc': 0.9991892, 'binary_precision': 0.91417164, 'binary_recall': 0.9535045, 'binary_specificity': 0.9969575, 'binary_f1_score': 0.93342394}
confusion matrix:
       0     1
0  42270   129
1     67  1374
---- Validation: 
scalar performance:
{'acc': 0.98623264, 'precision': 0.91382086, 'recall': 0.8805629, 'specificity': 0.8805629, 'f1': 0.8964355, 'auroc': 0.9777241, 'binary_precision': 0.8363047, 'binary_recall': 0.7667162, 'binary_specificity': 0.9944097, 'binary_f1_score': 0.8}
confusion matrix:
       0    1
0  17966  101
1    157  516
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587496, 'precision': 0.8129911, 'recall': 0.51504827, 'specificity': 0.51504827, 'f1': 0.51886815, 'auroc': 0.94298506, 'binary_precision': 0.6666667, 'binary_recall': 0.03076923, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.05882353}
confusion matrix:
      0  1
0  5942  4
1   252  8
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863192.png
early stop counter: 1
val acc:0.9862326383590698, best validation acc: 0.9866061806678772, corresponding to test acc:                         0.9577828049659729 / 0.9642281532287598
after epoch: 25,now: 2024-05-27 09:34:40.283639,epoch time: 0:22:54.315329,used: 9:29:52.828436,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_04_47_seed_1_20863192
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9955976, 'precision': 0.98045003, 'recall': 0.9491565, 'specificity': 0.9491565, 'f1': 0.96423817, 'auroc': 0.9992393, 'binary_precision': 0.96431226, 'binary_recall': 0.89944524, 'binary_specificity': 0.99886787, 'binary_f1_score': 0.9307499}
confusion matrix:
       0     1
0  42350    48
1    145  1297
---- Validation: 
scalar performance:
{'acc': 0.9872999, 'precision': 0.9481076, 'recall': 0.8589431, 'specificity': 0.8589431, 'f1': 0.8982093, 'auroc': 0.9768554, 'binary_precision': 0.90654206, 'binary_recall': 0.7206538, 'binary_specificity': 0.9972325, 'binary_f1_score': 0.8029801}
confusion matrix:
       0    1
0  18017   50
1    188  485
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96100545, 'precision': 0.8336911, 'recall': 0.5585222, 'specificity': 0.5585222, 'f1': 0.5919803, 'auroc': 0.9382036, 'binary_precision': 0.70454544, 'binary_recall': 0.11923077, 'binary_specificity': 0.99781364, 'binary_f1_score': 0.20394737}
confusion matrix:
      0   1
0  5933  13
1   229  31
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863192.png
better model found
persisted
after epoch: 26,now: 2024-05-27 09:57:36.830851,epoch time: 0:22:56.547212,used: 9:52:49.375648,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_04_47_seed_1_20863192
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99630475, 'precision': 0.962968, 'recall': 0.9803246, 'specificity': 0.9803246, 'f1': 0.9714744, 'auroc': 0.9994414, 'binary_precision': 0.9271877, 'binary_recall': 0.96322, 'binary_specificity': 0.9974292, 'binary_f1_score': 0.94486046}
confusion matrix:
       0     1
0  42290   109
1     53  1388
---- Validation: 
scalar performance:
{'acc': 0.9868196, 'precision': 0.9130333, 'recall': 0.89231163, 'specificity': 0.89231163, 'f1': 0.9023826, 'auroc': 0.9733709, 'binary_precision': 0.8338558, 'binary_recall': 0.7904903, 'binary_specificity': 0.99413294, 'binary_f1_score': 0.8115942}
confusion matrix:
       0    1
0  17961  106
1    141  532
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96003866, 'precision': 0.78519744, 'recall': 0.5635346, 'specificity': 0.5635346, 'f1': 0.59734356, 'auroc': 0.9127619, 'binary_precision': 0.60714287, 'binary_recall': 0.13076924, 'binary_specificity': 0.99630004, 'binary_f1_score': 0.21518987}
confusion matrix:
      0   1
0  5924  22
1   226  34
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863192.png
early stop counter: 1
val acc:0.9868196249008179, best validation acc: 0.987299919128418, corresponding to test acc:                         0.961005449295044 / 0.9642281532287598
after epoch: 27,now: 2024-05-27 10:20:29.472385,epoch time: 0:22:52.641534,used: 10:15:42.017182,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_04_47_seed_1_20863192
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99386406, 'precision': 0.98353213, 'recall': 0.91805845, 'specificity': 0.91805845, 'f1': 0.9482498, 'auroc': 0.9991626, 'binary_precision': 0.9725807, 'binary_recall': 0.83691883, 'binary_specificity': 0.9991981, 'binary_f1_score': 0.89966434}
confusion matrix:
       0     1
0  42365    34
1    235  1206
---- Validation: 
scalar performance:
{'acc': 0.9842583, 'precision': 0.94260585, 'recall': 0.8151649, 'specificity': 0.8151649, 'f1': 0.867344, 'auroc': 0.9734136, 'binary_precision': 0.89873415, 'binary_recall': 0.6329866, 'binary_specificity': 0.99734324, 'binary_f1_score': 0.7428073}
confusion matrix:
       0    1
0  18019   48
1    247  426
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96019983, 'precision': 0.81879103, 'recall': 0.5470678, 'specificity': 0.5470678, 'f1': 0.5739811, 'auroc': 0.9386871, 'binary_precision': 0.6756757, 'binary_recall': 0.09615385, 'binary_specificity': 0.99798185, 'binary_f1_score': 0.16835018}
confusion matrix:
      0   1
0  5934  12
1   235  25
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863192.png
early stop counter: 2
val acc:0.9842582941055298, best validation acc: 0.987299919128418, corresponding to test acc:                         0.961005449295044 / 0.9642281532287598
after epoch: 28,now: 2024-05-27 10:43:28.492161,epoch time: 0:22:59.019776,used: 10:38:41.036958,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_04_47_seed_1_20863192
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9953923, 'precision': 0.9479786, 'recall': 0.98388493, 'specificity': 0.98388493, 'f1': 0.9651854, 'auroc': 0.99932337, 'binary_precision': 0.896927, 'binary_recall': 0.9715673, 'binary_specificity': 0.99620265, 'binary_f1_score': 0.9327563}
confusion matrix:
       0     1
0  42237   161
1     41  1401
---- Validation: 
scalar performance:
{'acc': 0.9851654, 'precision': 0.89166945, 'recall': 0.89503, 'specificity': 0.89503, 'f1': 0.8933419, 'auroc': 0.974668, 'binary_precision': 0.79086894, 'binary_recall': 0.79791975, 'binary_specificity': 0.99214035, 'binary_f1_score': 0.79437864}
confusion matrix:
       0    1
0  17925  142
1    136  537
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590719, 'precision': 0.75333863, 'recall': 0.57038605, 'specificity': 0.57038605, 'f1': 0.60464, 'auroc': 0.90540135, 'binary_precision': 0.54285717, 'binary_recall': 0.14615385, 'binary_specificity': 0.99461824, 'binary_f1_score': 0.23030303}
confusion matrix:
      0   1
0  5914  32
1   222  38
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863192.png
early stop counter: 3
val acc:0.9851654171943665, best validation acc: 0.987299919128418, corresponding to test acc:                         0.961005449295044 / 0.9642281532287598
after epoch: 29,now: 2024-05-27 11:06:16.607180,epoch time: 0:22:48.115019,used: 11:01:29.151977,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_04_47_seed_1_20863192
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9962819, 'precision': 0.9615475, 'recall': 0.98164177, 'specificity': 0.98164177, 'f1': 0.97136414, 'auroc': 0.99953324, 'binary_precision': 0.9242525, 'binary_recall': 0.96597224, 'binary_specificity': 0.9973113, 'binary_f1_score': 0.944652}
confusion matrix:
       0     1
0  42286   114
1     49  1391
---- Validation: 
scalar performance:
{'acc': 0.98564565, 'precision': 0.90410876, 'recall': 0.88383484, 'specificity': 0.88383484, 'f1': 0.89368796, 'auroc': 0.9750502, 'binary_precision': 0.81661445, 'binary_recall': 0.7741456, 'binary_specificity': 0.99352413, 'binary_f1_score': 0.79481316}
confusion matrix:
       0    1
0  17950  117
1    152  521
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95955527, 'precision': 0.77543366, 'recall': 0.5559264, 'specificity': 0.5559264, 'f1': 0.58609194, 'auroc': 0.86205995, 'binary_precision': 0.5882353, 'binary_recall': 0.115384616, 'binary_specificity': 0.9964682, 'binary_f1_score': 0.19292603}
confusion matrix:
      0   1
0  5925  21
1   230  30
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863192.png
early stop counter: 4
val acc:0.9856456518173218, best validation acc: 0.987299919128418, corresponding to test acc:                         0.961005449295044 / 0.9642281532287598
after epoch: 30,now: 2024-05-27 11:29:10.768521,epoch time: 0:22:54.161341,used: 11:24:23.313318,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_04_47_seed_1_20863192
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 11:24:23.313318 at 2024-05-27 11:29:10.768521
persisted model performance metric: 

scalar performance:
{'acc': 0.96019983, 'precision': 0.80347526, 'recall': 0.55442375, 'specificity': 0.55442375, 'f1': 0.58488125, 'auroc': 0.93880904, 'binary_precision': 0.64444447, 'binary_recall': 0.11153846, 'binary_specificity': 0.9973091, 'binary_f1_score': 0.19016394}
confusion matrix:
      0   1
0  5930  16
1   231  29
oracle model performance metric: 

scalar performance:
{'acc': 0.9634225, 'precision': 0.9674028, 'recall': 0.5653005, 'specificity': 0.5653005, 'f1': 0.6058872, 'auroc': 0.9566611, 'binary_precision': 0.9714286, 'binary_recall': 0.13076924, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.2305085}
confusion matrix:
      0   1
0  5945   1
1   226  34
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs32/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs32/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1662 MiB |  30289 MiB |   1985 TiB |   1985 TiB |
|       from large pool |   1656 MiB |  30244 MiB |   1972 TiB |   1972 TiB |
|       from small pool |      5 MiB |     46 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1662 MiB |  30289 MiB |   1985 TiB |   1985 TiB |
|       from large pool |   1656 MiB |  30244 MiB |   1972 TiB |   1972 TiB |
|       from small pool |      5 MiB |     46 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1653 MiB |  30205 MiB |   1979 TiB |   1979 TiB |
|       from large pool |   1647 MiB |  30159 MiB |   1966 TiB |   1966 TiB |
|       from small pool |      5 MiB |     46 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  31418 MiB |  31418 MiB |  60518 MiB |  29100 MiB |
|       from large pool |  31370 MiB |  31370 MiB |  60466 MiB |  29096 MiB |
|       from small pool |     48 MiB |     48 MiB |     52 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 650768 KiB |   1088 MiB | 234258 GiB | 234258 GiB |
|       from large pool | 611808 KiB |   1086 MiB | 220556 GiB | 220555 GiB |
|       from small pool |  38960 KiB |     41 MiB |  13702 GiB |  13702 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2178    |    3623    |  152354 K  |  152352 K  |
|       from large pool |     247    |     989    |   62411 K  |   62411 K  |
|       from small pool |    1931    |    3374    |   89943 K  |   89941 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2178    |    3623    |  152354 K  |  152352 K  |
|       from large pool |     247    |     989    |   62411 K  |   62411 K  |
|       from small pool |    1931    |    3374    |   89943 K  |   89941 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     856    |     860    |    1593    |     737    |
|       from large pool |     832    |     836    |    1567    |     735    |
|       from small pool |      24    |      24    |      26    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     146    |    1502    |   84405 K  |   84405 K  |
|       from large pool |     103    |     544    |   40504 K  |   40503 K  |
|       from small pool |      43    |    1398    |   43901 K  |   43901 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  30289 MiB |   1985 TiB |   1985 TiB |
|       from large pool |  16640 KiB |  30244 MiB |   1972 TiB |   1972 TiB |
|       from small pool |      0 KiB |     46 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  30289 MiB |   1985 TiB |   1985 TiB |
|       from large pool |  16640 KiB |  30244 MiB |   1972 TiB |   1972 TiB |
|       from small pool |      0 KiB |     46 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  30205 MiB |   1979 TiB |   1979 TiB |
|       from large pool |  16640 KiB |  30159 MiB |   1966 TiB |   1966 TiB |
|       from small pool |      0 KiB |     46 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2298 MiB |  31418 MiB |  60518 MiB |  58220 MiB |
|       from large pool |   2254 MiB |  31370 MiB |  60466 MiB |  58212 MiB |
|       from small pool |     44 MiB |     48 MiB |     52 MiB |      8 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1088 MiB | 234259 GiB | 234259 GiB |
|       from large pool |  24320 KiB |   1086 MiB | 220557 GiB | 220557 GiB |
|       from small pool |      0 KiB |     41 MiB |  13702 GiB |  13702 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3623    |  152354 K  |  152354 K  |
|       from large pool |       2    |     989    |   62411 K  |   62411 K  |
|       from small pool |       0    |    3374    |   89943 K  |   89943 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3623    |  152354 K  |  152354 K  |
|       from large pool |       2    |     989    |   62411 K  |   62411 K  |
|       from small pool |       0    |    3374    |   89943 K  |   89943 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     123    |     860    |    1593    |    1470    |
|       from large pool |     101    |     836    |    1567    |    1466    |
|       from small pool |      22    |      24    |      26    |       4    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1502    |   84406 K  |   84406 K  |
|       from large pool |       3    |     544    |   40504 K  |   40504 K  |
|       from small pool |       0    |    1398    |   43902 K  |   43902 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Mon May 27 11:31:16 2024]
Finished job 0.
1 of 1 steps (100%) done
