Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sun May 26 12:25:42 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs32/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs32/rule_results/2.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=2
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863190

 Experiment start at: 2024-05-26 12:35:25.999363
before training, model accuracy: 0.6388623118400574
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96744794, 'precision': 0.76792115, 'recall': 0.5616615, 'specificity': 0.5616615, 'f1': 0.59519726, 'auroc': 0.94905895, 'binary_precision': 0.5653495, 'binary_recall': 0.126703, 'binary_specificity': 0.99662, 'binary_f1_score': 0.20701168}
confusion matrix:
       0    1
0  42165  143
1   1282  186
---- Validation: 
scalar performance:
{'acc': 0.9665815, 'precision': 0.75283337, 'recall': 0.58891976, 'specificity': 0.58891976, 'f1': 0.62802285, 'auroc': 0.94959974, 'binary_precision': 0.5339367, 'binary_recall': 0.18351477, 'binary_specificity': 0.99432474, 'binary_f1_score': 0.27314815}
confusion matrix:
       0    1
0  18046  103
1    525  118
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96180886, 'precision': 0.9808371, 'recall': 0.5421456, 'specificity': 0.5421456, 'f1': 0.56796986, 'auroc': 0.9343951, 'binary_precision': 1.0, 'binary_recall': 0.08429119, 'binary_specificity': 1.0, 'binary_f1_score': 0.15547703}
confusion matrix:
      0   1
0  5997   0
1   239  22
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863190.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-26 12:56:02.219634,epoch time: 0:20:36.220271,used: 0:20:36.220271,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863190
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9692297, 'precision': 0.84770966, 'recall': 0.5670827, 'specificity': 0.5670827, 'f1': 0.6066328, 'auroc': 0.96197903, 'binary_precision': 0.7246377, 'binary_recall': 0.13596193, 'binary_specificity': 0.9982035, 'binary_f1_score': 0.22896394}
confusion matrix:
       0    1
0  42229   76
1   1271  200
---- Validation: 
scalar performance:
{'acc': 0.96977437, 'precision': 0.7999891, 'recall': 0.6430766, 'specificity': 0.6430766, 'f1': 0.6914014, 'auroc': 0.9630047, 'binary_precision': 0.62458473, 'binary_recall': 0.29237947, 'binary_specificity': 0.99377376, 'binary_f1_score': 0.39830512}
confusion matrix:
       0    1
0  18036  113
1    455  188
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614893, 'precision': 0.9806829, 'recall': 0.53831416, 'specificity': 0.53831416, 'f1': 0.56132555, 'auroc': 0.9352338, 'binary_precision': 1.0, 'binary_recall': 0.07662835, 'binary_specificity': 1.0, 'binary_f1_score': 0.14234875}
confusion matrix:
      0   1
0  5997   0
1   241  20
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863190.png
better model found
persisted
after epoch: 2,now: 2024-05-26 13:15:30.481999,epoch time: 0:19:28.262365,used: 0:40:04.482636,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863190
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9688642, 'precision': 0.7587386, 'recall': 0.83274937, 'specificity': 0.83274937, 'f1': 0.7905736, 'auroc': 0.9647789, 'binary_precision': 0.5284893, 'binary_recall': 0.6868206, 'binary_specificity': 0.97867817, 'binary_f1_score': 0.59734124}
confusion matrix:
       0     1
0  41402   902
1    461  1011
---- Validation: 
scalar performance:
{'acc': 0.96706045, 'precision': 0.7509951, 'recall': 0.8014333, 'specificity': 0.8014333, 'f1': 0.7736372, 'auroc': 0.96332496, 'binary_precision': 0.5154242, 'binary_recall': 0.62363917, 'binary_specificity': 0.9792275, 'binary_f1_score': 0.56439126}
confusion matrix:
       0    1
0  17772  377
1    242  401
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9750719, 'precision': 0.9025465, 'recall': 0.75245476, 'specificity': 0.75245476, 'f1': 0.8087164, 'auroc': 0.94466245, 'binary_precision': 0.82608694, 'binary_recall': 0.5095785, 'binary_specificity': 0.995331, 'binary_f1_score': 0.63033175}
confusion matrix:
      0    1
0  5969   28
1   128  133
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863190.png
new oracle model saved
early stop counter: 1
val acc:0.9670604467391968, best validation acc: 0.9697743654251099, corresponding to test acc:                         0.9614893198013306 / 0.975071907043457
after epoch: 3,now: 2024-05-26 13:35:02.346982,epoch time: 0:19:31.864983,used: 0:59:36.347619,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863190
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97030336, 'precision': 0.9237218, 'recall': 0.56731015, 'specificity': 0.56731015, 'f1': 0.6096257, 'auroc': 0.9732386, 'binary_precision': 0.876652, 'binary_recall': 0.13528211, 'binary_specificity': 0.99933815, 'binary_f1_score': 0.23439339}
confusion matrix:
       0    1
0  42277   28
1   1272  199
---- Validation: 
scalar performance:
{'acc': 0.97020006, 'precision': 0.87330854, 'recall': 0.59004307, 'specificity': 0.59004307, 'f1': 0.6397444, 'auroc': 0.968331, 'binary_precision': 0.77483445, 'binary_recall': 0.18195957, 'binary_specificity': 0.9981266, 'binary_f1_score': 0.29471034}
confusion matrix:
       0    1
0  18115   34
1    526  117
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581336, 'precision': 0.6458833, 'recall': 0.501749, 'specificity': 0.501749, 'f1': 0.49309576, 'auroc': 0.9540896, 'binary_precision': 0.33333334, 'binary_recall': 0.0038314175, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.0075757573}
confusion matrix:
      0  1
0  5995  2
1   260  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863190.png
better model found
persisted
after epoch: 4,now: 2024-05-26 13:54:33.864390,epoch time: 0:19:31.517408,used: 1:19:07.865027,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863190
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97590005, 'precision': 0.8093492, 'recall': 0.83704543, 'specificity': 0.83704543, 'f1': 0.82254463, 'auroc': 0.97406614, 'binary_precision': 0.6295836, 'binary_recall': 0.6881794, 'binary_specificity': 0.9859115, 'binary_f1_score': 0.6575787}
confusion matrix:
       0     1
0  41708   596
1    459  1013
---- Validation: 
scalar performance:
{'acc': 0.9771179, 'precision': 0.83003235, 'recall': 0.81714106, 'specificity': 0.81714106, 'f1': 0.82344615, 'auroc': 0.97049177, 'binary_precision': 0.6726094, 'binary_recall': 0.64541215, 'binary_specificity': 0.9888699, 'binary_f1_score': 0.6587302}
confusion matrix:
       0    1
0  17947  202
1    228  415
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9800256, 'precision': 0.9031825, 'recall': 0.8301651, 'specificity': 0.8301651, 'f1': 0.86267495, 'auroc': 0.9633254, 'binary_precision': 0.8207547, 'binary_recall': 0.6666667, 'binary_specificity': 0.9936635, 'binary_f1_score': 0.7357294}
confusion matrix:
      0    1
0  5959   38
1    87  174
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863190.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-05-26 14:14:02.213130,epoch time: 0:19:28.348740,used: 1:38:36.213767,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863190
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9790753, 'precision': 0.88972557, 'recall': 0.7514789, 'specificity': 0.7514789, 'f1': 0.80457926, 'auroc': 0.9774165, 'binary_precision': 0.7963753, 'binary_recall': 0.5074728, 'binary_specificity': 0.99548507, 'binary_f1_score': 0.61991704}
confusion matrix:
       0    1
0  42113  191
1    725  747
---- Validation: 
scalar performance:
{'acc': 0.9799915, 'precision': 0.91303545, 'recall': 0.7533739, 'specificity': 0.7533739, 'f1': 0.8126861, 'auroc': 0.97104526, 'binary_precision': 0.8431877, 'binary_recall': 0.5101089, 'binary_specificity': 0.99663895, 'binary_f1_score': 0.635659}
confusion matrix:
       0    1
0  18088   61
1    315  328
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96228826, 'precision': 0.9100113, 'recall': 0.5570544, 'specificity': 0.5570544, 'f1': 0.5916951, 'auroc': 0.9584696, 'binary_precision': 0.85714287, 'binary_recall': 0.11494253, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.2027027}
confusion matrix:
      0   1
0  5992   5
1   231  30
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863190.png
better model found
persisted
after epoch: 6,now: 2024-05-26 14:33:24.710440,epoch time: 0:19:22.497310,used: 1:57:58.711077,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863190
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97795594, 'precision': 0.87911224, 'recall': 0.73907375, 'specificity': 0.73907375, 'f1': 0.79202855, 'auroc': 0.977926, 'binary_precision': 0.7759563, 'binary_recall': 0.4829932, 'binary_specificity': 0.9951544, 'binary_f1_score': 0.59538776}
confusion matrix:
       0    1
0  42101  205
1    760  710
---- Validation: 
scalar performance:
{'acc': 0.9749361, 'precision': 0.8493534, 'recall': 0.7170042, 'specificity': 0.7170042, 'f1': 0.76645887, 'auroc': 0.97337985, 'binary_precision': 0.7182741, 'binary_recall': 0.44012442, 'binary_specificity': 0.99388397, 'binary_f1_score': 0.5458052}
confusion matrix:
       0    1
0  18038  111
1    360  283
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9688399, 'precision': 0.8943542, 'recall': 0.6612511, 'specificity': 0.6612511, 'f1': 0.7248527, 'auroc': 0.9614866, 'binary_precision': 0.8173077, 'binary_recall': 0.3256705, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.46575344}
confusion matrix:
      0   1
0  5978  19
1   176  85
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863190.png
early stop counter: 1
val acc:0.9749361276626587, best validation acc: 0.9799914956092834, corresponding to test acc:                         0.9622882604598999 / 0.980025589466095
after epoch: 7,now: 2024-05-26 14:52:52.916293,epoch time: 0:19:28.205853,used: 2:17:26.916930,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863190
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9769508, 'precision': 0.8066571, 'recall': 0.8979144, 'specificity': 0.8979144, 'f1': 0.84575313, 'auroc': 0.9794751, 'binary_precision': 0.61988604, 'binary_recall': 0.8131794, 'binary_specificity': 0.9826494, 'binary_f1_score': 0.70349693}
confusion matrix:
       0     1
0  41570   734
1    275  1197
---- Validation: 
scalar performance:
{'acc': 0.9771711, 'precision': 0.82128817, 'recall': 0.8486709, 'specificity': 0.8486709, 'f1': 0.83436424, 'auroc': 0.97732174, 'binary_precision': 0.6528571, 'binary_recall': 0.71073097, 'binary_specificity': 0.98661083, 'binary_f1_score': 0.6805659}
confusion matrix:
       0    1
0  17906  243
1    186  457
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97219557, 'precision': 0.85271907, 'recall': 0.76378036, 'specificity': 0.76378036, 'f1': 0.80115736, 'auroc': 0.9647373, 'binary_precision': 0.7253886, 'binary_recall': 0.5363985, 'binary_specificity': 0.99116224, 'binary_f1_score': 0.6167401}
confusion matrix:
      0    1
0  5944   53
1   121  140
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863190.png
early stop counter: 2
val acc:0.9771711230278015, best validation acc: 0.9799914956092834, corresponding to test acc:                         0.9622882604598999 / 0.980025589466095
after epoch: 8,now: 2024-05-26 15:12:22.511735,epoch time: 0:19:29.595442,used: 2:36:56.512372,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863190
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9800804, 'precision': 0.8328656, 'recall': 0.8889007, 'specificity': 0.8889007, 'f1': 0.8584961, 'auroc': 0.9822543, 'binary_precision': 0.6730324, 'binary_recall': 0.7911565, 'binary_specificity': 0.9866449, 'binary_f1_score': 0.7273296}
confusion matrix:
       0     1
0  41741   565
1    307  1163
---- Validation: 
scalar performance:
{'acc': 0.98217326, 'precision': 0.8558724, 'recall': 0.8872632, 'specificity': 0.8872632, 'f1': 0.8708426, 'auroc': 0.97798896, 'binary_precision': 0.7193732, 'binary_recall': 0.785381, 'binary_specificity': 0.9891454, 'binary_f1_score': 0.7509293}
confusion matrix:
       0    1
0  17952  197
1    138  505
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9745925, 'precision': 0.8638358, 'recall': 0.792516, 'specificity': 0.792516, 'f1': 0.8238913, 'auroc': 0.957016, 'binary_precision': 0.7451923, 'binary_recall': 0.59386975, 'binary_specificity': 0.99116224, 'binary_f1_score': 0.6609808}
confusion matrix:
      0    1
0  5944   53
1   106  155
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863190.png
better model found
persisted
after epoch: 9,now: 2024-05-26 15:32:01.649023,epoch time: 0:19:39.137288,used: 2:56:35.649660,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863190
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9803774, 'precision': 0.9185426, 'recall': 0.74936056, 'specificity': 0.74936056, 'f1': 0.8110199, 'auroc': 0.9831438, 'binary_precision': 0.8541667, 'binary_recall': 0.5016995, 'binary_specificity': 0.9970216, 'binary_f1_score': 0.6321199}
confusion matrix:
       0    1
0  42179  126
1    733  738
---- Validation: 
scalar performance:
{'acc': 0.9758408, 'precision': 0.907129, 'recall': 0.6814699, 'specificity': 0.6814699, 'f1': 0.74813694, 'auroc': 0.973788, 'binary_precision': 0.83629894, 'binary_recall': 0.36547434, 'binary_specificity': 0.99746543, 'binary_f1_score': 0.508658}
confusion matrix:
       0    1
0  18103   46
1    408  235
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96324706, 'precision': 0.89036655, 'recall': 0.57587796, 'specificity': 0.57587796, 'f1': 0.61961067, 'auroc': 0.9665837, 'binary_precision': 0.81632656, 'binary_recall': 0.1532567, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.2580645}
confusion matrix:
      0   1
0  5988   9
1   221  40
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863190.png
early stop counter: 1
val acc:0.9758408069610596, best validation acc: 0.9821732640266418, corresponding to test acc:                         0.9745925068855286 / 0.980025589466095
after epoch: 10,now: 2024-05-26 15:51:26.342166,epoch time: 0:19:24.693143,used: 3:16:00.342803,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863190
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98282164, 'precision': 0.915192, 'recall': 0.7980055, 'specificity': 0.7980055, 'f1': 0.84625334, 'auroc': 0.98349357, 'binary_precision': 0.84416825, 'binary_recall': 0.5998641, 'binary_specificity': 0.9961469, 'binary_f1_score': 0.7013502}
confusion matrix:
       0    1
0  42141  163
1    589  883
---- Validation: 
scalar performance:
{'acc': 0.9791933, 'precision': 0.918746, 'recall': 0.7342093, 'specificity': 0.7342093, 'f1': 0.79856825, 'auroc': 0.9792228, 'binary_precision': 0.8559322, 'binary_recall': 0.47122863, 'binary_specificity': 0.99718994, 'binary_f1_score': 0.60782343}
confusion matrix:
       0    1
0  18098   51
1    340  303
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.7383921, 'recall': 0.5294007, 'specificity': 0.5294007, 'f1': 0.5441597, 'auroc': 0.9514879, 'binary_precision': 0.516129, 'binary_recall': 0.06130268, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.10958905}
confusion matrix:
      0   1
0  5982  15
1   245  16
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863190.png
early stop counter: 2
val acc:0.9791932702064514, best validation acc: 0.9821732640266418, corresponding to test acc:                         0.9745925068855286 / 0.980025589466095
after epoch: 11,now: 2024-05-26 16:10:48.613643,epoch time: 0:19:22.271477,used: 3:35:22.614280,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863190
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98357546, 'precision': 0.9055684, 'recall': 0.8233125, 'specificity': 0.8233125, 'f1': 0.8594372, 'auroc': 0.9856827, 'binary_precision': 0.82317597, 'binary_recall': 0.65149456, 'binary_specificity': 0.9951305, 'binary_f1_score': 0.72734165}
confusion matrix:
       0    1
0  42098  206
1    513  959
---- Validation: 
scalar performance:
{'acc': 0.97993827, 'precision': 0.8919265, 'recall': 0.77359784, 'specificity': 0.77359784, 'f1': 0.8214221, 'auroc': 0.9824842, 'binary_precision': 0.7995495, 'binary_recall': 0.5520995, 'binary_specificity': 0.99509615, 'binary_f1_score': 0.65317386}
confusion matrix:
       0    1
0  18060   89
1    288  355
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96580374, 'precision': 0.85826963, 'recall': 0.63401437, 'specificity': 0.63401437, 'f1': 0.69063884, 'auroc': 0.958968, 'binary_precision': 0.7473684, 'binary_recall': 0.27203065, 'binary_specificity': 0.995998, 'binary_f1_score': 0.3988764}
confusion matrix:
      0   1
0  5973  24
1   190  71
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863190.png
early stop counter: 3
val acc:0.979938268661499, best validation acc: 0.9821732640266418, corresponding to test acc:                         0.9745925068855286 / 0.980025589466095
after epoch: 12,now: 2024-05-26 16:30:13.395116,epoch time: 0:19:24.781473,used: 3:54:47.395753,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863190
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98307294, 'precision': 0.86515975, 'recall': 0.87928617, 'specificity': 0.87928617, 'f1': 0.872077, 'auroc': 0.98567754, 'binary_precision': 0.7383911, 'binary_recall': 0.7680272, 'binary_specificity': 0.9905451, 'binary_f1_score': 0.7529177}
confusion matrix:
       0     1
0  41906   400
1    341  1129
---- Validation: 
scalar performance:
{'acc': 0.9844615, 'precision': 0.9097233, 'recall': 0.8404443, 'specificity': 0.8404443, 'f1': 0.871629, 'auroc': 0.97472394, 'binary_precision': 0.8305085, 'binary_recall': 0.6858476, 'binary_specificity': 0.9950411, 'binary_f1_score': 0.75127774}
confusion matrix:
       0    1
0  18059   90
1    202  441
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97395337, 'precision': 0.8923018, 'recall': 0.74454176, 'specificity': 0.74454176, 'f1': 0.7996749, 'auroc': 0.9637264, 'binary_precision': 0.80625, 'binary_recall': 0.49425286, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.6128266}
confusion matrix:
      0    1
0  5966   31
1   132  129
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863190.png
better model found
persisted
after epoch: 13,now: 2024-05-26 16:49:36.359137,epoch time: 0:19:22.964021,used: 4:14:10.359774,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863190
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9832328, 'precision': 0.9576739, 'recall': 0.77002275, 'specificity': 0.77002275, 'f1': 0.8380476, 'auroc': 0.9880221, 'binary_precision': 0.93107474, 'binary_recall': 0.5414402, 'binary_specificity': 0.9986053, 'binary_f1_score': 0.68470794}
confusion matrix:
       0    1
0  42245   59
1    675  797
---- Validation: 
scalar performance:
{'acc': 0.9795126, 'precision': 0.9580114, 'recall': 0.71487314, 'specificity': 0.71487314, 'f1': 0.7897416, 'auroc': 0.97942775, 'binary_precision': 0.9358108, 'binary_recall': 0.43079317, 'binary_specificity': 0.9989531, 'binary_f1_score': 0.58998936}
confusion matrix:
       0    1
0  18130   19
1    366  277
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95733464, 'precision': 0.6546409, 'recall': 0.51232606, 'specificity': 0.51232606, 'f1': 0.5139997, 'auroc': 0.94245005, 'binary_precision': 0.35, 'binary_recall': 0.026819924, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.049822066}
confusion matrix:
      0   1
0  5984  13
1   254   7
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863190.png
early stop counter: 1
val acc:0.9795125722885132, best validation acc: 0.9844614863395691, corresponding to test acc:                         0.973953366279602 / 0.980025589466095
after epoch: 14,now: 2024-05-26 17:09:09.916338,epoch time: 0:19:33.557201,used: 4:33:43.916975,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863190
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9835983, 'precision': 0.8531892, 'recall': 0.9245374, 'specificity': 0.9245374, 'f1': 0.88527995, 'auroc': 0.98780775, 'binary_precision': 0.71123594, 'binary_recall': 0.8612245, 'binary_specificity': 0.9878504, 'binary_f1_score': 0.77907693}
confusion matrix:
       0     1
0  41792   514
1    204  1266
---- Validation: 
scalar performance:
{'acc': 0.98398256, 'precision': 0.8714104, 'recall': 0.8942003, 'specificity': 0.8942003, 'f1': 0.8824353, 'auroc': 0.9802619, 'binary_precision': 0.75, 'binary_recall': 0.7978227, 'binary_specificity': 0.990578, 'binary_f1_score': 0.77317256}
confusion matrix:
       0    1
0  17978  171
1    130  513
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9755513, 'precision': 0.8814757, 'recall': 0.7838546, 'specificity': 0.7838546, 'f1': 0.82478416, 'auroc': 0.96013224, 'binary_precision': 0.78125, 'binary_recall': 0.57471263, 'binary_specificity': 0.9929965, 'binary_f1_score': 0.66225165}
confusion matrix:
      0    1
0  5955   42
1   111  150
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863190.png
early stop counter: 2
val acc:0.9839825630187988, best validation acc: 0.9844614863395691, corresponding to test acc:                         0.973953366279602 / 0.980025589466095
after epoch: 15,now: 2024-05-26 17:28:35.487866,epoch time: 0:19:25.571528,used: 4:53:09.488503,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863190
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.98309577, 'precision': 0.91903436, 'recall': 0.7989956, 'specificity': 0.7989956, 'f1': 0.8482388, 'auroc': 0.988059, 'binary_precision': 0.85178053, 'binary_recall': 0.6016315, 'binary_specificity': 0.99635977, 'binary_f1_score': 0.7051793}
confusion matrix:
       0    1
0  42151  154
1    586  885
---- Validation: 
scalar performance:
{'acc': 0.98174757, 'precision': 0.9065557, 'recall': 0.79253584, 'specificity': 0.79253584, 'f1': 0.83953166, 'auroc': 0.9775225, 'binary_precision': 0.8275109, 'binary_recall': 0.58942455, 'binary_specificity': 0.99564713, 'binary_f1_score': 0.688465}
confusion matrix:
       0    1
0  18070   79
1    264  379
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96276766, 'precision': 0.853109, 'recall': 0.58112484, 'specificity': 0.58112484, 'f1': 0.62524474, 'auroc': 0.9493561, 'binary_precision': 0.7413793, 'binary_recall': 0.16475096, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.26959246}
confusion matrix:
      0   1
0  5982  15
1   218  43
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863190.png
early stop counter: 3
val acc:0.981747567653656, best validation acc: 0.9844614863395691, corresponding to test acc:                         0.973953366279602 / 0.980025589466095
after epoch: 16,now: 2024-05-26 17:48:01.881229,epoch time: 0:19:26.393363,used: 5:12:35.881866,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863190
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9845349, 'precision': 0.935154, 'recall': 0.8097112, 'specificity': 0.8097112, 'f1': 0.8611053, 'auroc': 0.98890483, 'binary_precision': 0.88331723, 'binary_recall': 0.6222826, 'binary_specificity': 0.99713975, 'binary_f1_score': 0.7301714}
confusion matrix:
       0    1
0  42183  121
1    556  916
---- Validation: 
scalar performance:
{'acc': 0.9831311, 'precision': 0.93760157, 'recall': 0.7880018, 'specificity': 0.7880018, 'f1': 0.8462729, 'auroc': 0.9808532, 'binary_precision': 0.8899522, 'binary_recall': 0.5785381, 'binary_specificity': 0.99746543, 'binary_f1_score': 0.7012252}
confusion matrix:
       0    1
0  18103   46
1    271  372
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959412, 'precision': 0.7908393, 'recall': 0.53356564, 'specificity': 0.53356564, 'f1': 0.5516813, 'auroc': 0.87954164, 'binary_precision': 0.62068963, 'binary_recall': 0.06896552, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.12413794}
confusion matrix:
      0   1
0  5986  11
1   243  18
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863190.png
early stop counter: 4
val acc:0.9831311106681824, best validation acc: 0.9844614863395691, corresponding to test acc:                         0.973953366279602 / 0.980025589466095
after epoch: 17,now: 2024-05-26 18:07:39.273252,epoch time: 0:19:37.392023,used: 5:32:13.273889,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863190
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98391813, 'precision': 0.93810236, 'recall': 0.7961403, 'specificity': 0.7961403, 'f1': 0.8524243, 'auroc': 0.9895737, 'binary_precision': 0.89013225, 'binary_recall': 0.59483343, 'binary_specificity': 0.99744713, 'binary_f1_score': 0.7131214}
confusion matrix:
       0    1
0  42197  108
1    596  875
---- Validation: 
scalar performance:
{'acc': 0.9788208, 'precision': 0.92116785, 'recall': 0.7257658, 'specificity': 0.7257658, 'f1': 0.7919155, 'auroc': 0.97752, 'binary_precision': 0.8613569, 'binary_recall': 0.4541213, 'binary_specificity': 0.9974103, 'binary_f1_score': 0.5947047}
confusion matrix:
       0    1
0  18102   47
1    351  292
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96292746, 'precision': 0.82075024, 'recall': 0.60502857, 'specificity': 0.60502857, 'f1': 0.65326065, 'auroc': 0.9561091, 'binary_precision': 0.67469877, 'binary_recall': 0.21455939, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.3255814}
confusion matrix:
      0   1
0  5970  27
1   205  56
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863190.png
early stop counter: 5
val acc:0.97882080078125, best validation acc: 0.9844614863395691, corresponding to test acc:                         0.973953366279602 / 0.980025589466095
after epoch: 18,now: 2024-05-26 18:27:10.025649,epoch time: 0:19:30.752397,used: 5:51:44.026286,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863190
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9848776, 'precision': 0.8692139, 'recall': 0.913653, 'specificity': 0.913653, 'f1': 0.8900578, 'auroc': 0.99055064, 'binary_precision': 0.74410164, 'binary_recall': 0.8373043, 'binary_specificity': 0.9900017, 'binary_f1_score': 0.7879565}
confusion matrix:
       0     1
0  41884   423
1    239  1230
---- Validation: 
scalar performance:
{'acc': 0.9845147, 'precision': 0.88069725, 'recall': 0.8869753, 'specificity': 0.8869753, 'f1': 0.8838083, 'auroc': 0.98368675, 'binary_precision': 0.7691131, 'binary_recall': 0.7822706, 'binary_specificity': 0.99167997, 'binary_f1_score': 0.7756361}
confusion matrix:
       0    1
0  17998  151
1    140  503
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96628314, 'precision': 0.8381989, 'recall': 0.6617495, 'specificity': 0.6617495, 'f1': 0.7158478, 'auroc': 0.95527697, 'binary_precision': 0.704918, 'binary_recall': 0.32950193, 'binary_specificity': 0.993997, 'binary_f1_score': 0.44908616}
confusion matrix:
      0   1
0  5961  36
1   175  86
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863190.png
better model found
persisted
after epoch: 19,now: 2024-05-26 18:46:39.475973,epoch time: 0:19:29.450324,used: 6:11:13.476610,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863190
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9860883, 'precision': 0.9661299, 'recall': 0.81038654, 'specificity': 0.81038654, 'f1': 0.87157613, 'auroc': 0.9937653, 'binary_precision': 0.94524795, 'binary_recall': 0.62202585, 'binary_specificity': 0.99874717, 'binary_f1_score': 0.7503075}
confusion matrix:
       0    1
0  42252   53
1    556  915
---- Validation: 
scalar performance:
{'acc': 0.9804704, 'precision': 0.9427029, 'recall': 0.7393708, 'specificity': 0.7393708, 'f1': 0.80869174, 'auroc': 0.9774776, 'binary_precision': 0.9035088, 'binary_recall': 0.4805599, 'binary_specificity': 0.9981817, 'binary_f1_score': 0.6274111}
confusion matrix:
       0    1
0  18116   33
1    334  309
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96180886, 'precision': 0.8463869, 'recall': 0.56596595, 'specificity': 0.56596595, 'f1': 0.60347915, 'auroc': 0.9522317, 'binary_precision': 0.7291667, 'binary_recall': 0.13409962, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.22653723}
confusion matrix:
      0   1
0  5984  13
1   226  35
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863190.png
early stop counter: 1
val acc:0.9804704189300537, best validation acc: 0.9845147132873535, corresponding to test acc:                         0.9662831425666809 / 0.980025589466095
after epoch: 20,now: 2024-05-26 19:06:12.458629,epoch time: 0:19:32.982656,used: 6:30:46.459266,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863190
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.98691064, 'precision': 0.96282744, 'recall': 0.82611436, 'specificity': 0.82611436, 'f1': 0.881802, 'auroc': 0.99169254, 'binary_precision': 0.937561, 'binary_recall': 0.6537415, 'binary_specificity': 0.99848723, 'binary_f1_score': 0.7703407}
confusion matrix:
       0    1
0  42242   64
1    509  961
---- Validation: 
scalar performance:
{'acc': 0.9822265, 'precision': 0.95448065, 'recall': 0.7605314, 'specificity': 0.7605314, 'f1': 0.82943046, 'auroc': 0.9760544, 'binary_precision': 0.92561984, 'binary_recall': 0.5225505, 'binary_specificity': 0.9985123, 'binary_f1_score': 0.667992}
confusion matrix:
       0    1
0  18122   27
1    307  336
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.88097304, 'recall': 0.54547673, 'specificity': 0.54547673, 'f1': 0.5725356, 'auroc': 0.94885963, 'binary_precision': 0.8, 'binary_recall': 0.09195402, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.16494845}
confusion matrix:
      0   1
0  5991   6
1   237  24
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863190.png
early stop counter: 2
val acc:0.9822264909744263, best validation acc: 0.9845147132873535, corresponding to test acc:                         0.9662831425666809 / 0.980025589466095
after epoch: 21,now: 2024-05-26 19:25:44.095643,epoch time: 0:19:31.637014,used: 6:50:18.096280,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863190
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.98816705, 'precision': 0.90303713, 'recall': 0.9183649, 'specificity': 0.9183649, 'f1': 0.91054595, 'auroc': 0.9934101, 'binary_precision': 0.8115183, 'binary_recall': 0.8435374, 'binary_specificity': 0.99319243, 'binary_f1_score': 0.8272181}
confusion matrix:
       0     1
0  42018   288
1    230  1240
---- Validation: 
scalar performance:
{'acc': 0.9848872, 'precision': 0.90661216, 'recall': 0.8526656, 'specificity': 0.8526656, 'f1': 0.8775665, 'auroc': 0.9830158, 'binary_precision': 0.82342345, 'binary_recall': 0.71073097, 'binary_specificity': 0.99460024, 'binary_f1_score': 0.76293826}
confusion matrix:
       0    1
0  18051   98
1    186  457
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964845, 'precision': 0.82891226, 'recall': 0.6408434, 'specificity': 0.6408434, 'f1': 0.6936462, 'auroc': 0.9561558, 'binary_precision': 0.6880734, 'binary_recall': 0.28735632, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.4054054}
confusion matrix:
      0   1
0  5963  34
1   186  75
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863190.png
better model found
persisted
after epoch: 22,now: 2024-05-26 19:45:18.697148,epoch time: 0:19:34.601505,used: 7:09:52.697785,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863190
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.98629385, 'precision': 0.89967275, 'recall': 0.8860278, 'specificity': 0.8860278, 'f1': 0.89272195, 'auroc': 0.9922946, 'binary_precision': 0.80704224, 'binary_recall': 0.7785326, 'binary_specificity': 0.99352306, 'binary_f1_score': 0.79253113}
confusion matrix:
       0     1
0  42030   274
1    326  1146
---- Validation: 
scalar performance:
{'acc': 0.98483396, 'precision': 0.9026319, 'recall': 0.8571384, 'specificity': 0.8571384, 'f1': 0.87841094, 'auroc': 0.9820153, 'binary_precision': 0.81514084, 'binary_recall': 0.7200622, 'binary_specificity': 0.99421453, 'binary_f1_score': 0.7646573}
confusion matrix:
       0    1
0  18044  105
1    180  463
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9654842, 'precision': 0.8382492, 'recall': 0.64484155, 'specificity': 0.64484155, 'f1': 0.69921625, 'auroc': 0.9540674, 'binary_precision': 0.70642203, 'binary_recall': 0.29501915, 'binary_specificity': 0.994664, 'binary_f1_score': 0.4162162}
confusion matrix:
      0   1
0  5965  32
1   184  77
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863190.png
early stop counter: 1
val acc:0.9848339557647705, best validation acc: 0.9848871827125549, corresponding to test acc:                         0.9648450016975403 / 0.980025589466095
after epoch: 23,now: 2024-05-26 20:04:48.646146,epoch time: 0:19:29.948998,used: 7:29:22.646783,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863190
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.988464, 'precision': 0.95733404, 'recall': 0.8566602, 'specificity': 0.8566602, 'f1': 0.9003211, 'auroc': 0.9948242, 'binary_precision': 0.92449516, 'binary_recall': 0.71535325, 'binary_specificity': 0.9979671, 'binary_f1_score': 0.80658746}
confusion matrix:
       0     1
0  42218    86
1    419  1053
---- Validation: 
scalar performance:
{'acc': 0.9833972, 'precision': 0.95085466, 'recall': 0.78213906, 'specificity': 0.78213906, 'f1': 0.84573114, 'auroc': 0.9839188, 'binary_precision': 0.91687655, 'binary_recall': 0.5660964, 'binary_specificity': 0.9981817, 'binary_f1_score': 0.7}
confusion matrix:
       0    1
0  18116   33
1    279  364
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.75766563, 'recall': 0.5184901, 'specificity': 0.5184901, 'f1': 0.5252596, 'auroc': 0.93381304, 'binary_precision': 0.5555556, 'binary_recall': 0.038314175, 'binary_specificity': 0.998666, 'binary_f1_score': 0.071684584}
confusion matrix:
      0   1
0  5989   8
1   251  10
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863190.png
early stop counter: 2
val acc:0.9833971858024597, best validation acc: 0.9848871827125549, corresponding to test acc:                         0.9648450016975403 / 0.980025589466095
after epoch: 24,now: 2024-05-26 20:24:25.655467,epoch time: 0:19:37.009321,used: 7:48:59.656104,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863190
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99049705, 'precision': 0.94599795, 'recall': 0.90249795, 'specificity': 0.90249795, 'f1': 0.9230475, 'auroc': 0.99480087, 'binary_precision': 0.8986384, 'binary_recall': 0.8081633, 'binary_specificity': 0.9968326, 'binary_f1_score': 0.85100293}
confusion matrix:
       0     1
0  42172   134
1    282  1188
---- Validation: 
scalar performance:
{'acc': 0.9843018, 'precision': 0.9264672, 'recall': 0.8186101, 'specificity': 0.8186101, 'f1': 0.86414087, 'auroc': 0.9774144, 'binary_precision': 0.8655462, 'binary_recall': 0.6407465, 'binary_specificity': 0.9964736, 'binary_f1_score': 0.73637176}
confusion matrix:
       0    1
0  18085   64
1    231  412
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96596354, 'precision': 0.8310502, 'recall': 0.6634151, 'specificity': 0.6634151, 'f1': 0.7160256, 'auroc': 0.9577354, 'binary_precision': 0.6904762, 'binary_recall': 0.33333334, 'binary_specificity': 0.9934968, 'binary_f1_score': 0.44961238}
confusion matrix:
      0   1
0  5958  39
1   174  87
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863190.png
early stop counter: 3
val acc:0.9843018054962158, best validation acc: 0.9848871827125549, corresponding to test acc:                         0.9648450016975403 / 0.980025589466095
after epoch: 25,now: 2024-05-26 20:43:50.302589,epoch time: 0:19:24.647122,used: 8:08:24.303226,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863190
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9867507, 'precision': 0.89977115, 'recall': 0.8950473, 'specificity': 0.8950473, 'f1': 0.89739406, 'auroc': 0.99363416, 'binary_precision': 0.806607, 'binary_recall': 0.7967369, 'binary_specificity': 0.9933578, 'binary_f1_score': 0.8016416}
confusion matrix:
       0     1
0  42024   281
1    299  1172
---- Validation: 
scalar performance:
{'acc': 0.9843018, 'precision': 0.8986076, 'recall': 0.8523626, 'specificity': 0.8523626, 'f1': 0.8739433, 'auroc': 0.9801507, 'binary_precision': 0.8074205, 'binary_recall': 0.71073097, 'binary_specificity': 0.9939942, 'binary_f1_score': 0.75599664}
confusion matrix:
       0    1
0  18040  109
1    186  457
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96260786, 'precision': 0.82301795, 'recall': 0.59570014, 'specificity': 0.59570014, 'f1': 0.6421798, 'auroc': 0.9537088, 'binary_precision': 0.68, 'binary_recall': 0.1954023, 'binary_specificity': 0.995998, 'binary_f1_score': 0.30357143}
confusion matrix:
      0   1
0  5973  24
1   210  51
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863190.png
early stop counter: 4
val acc:0.9843018054962158, best validation acc: 0.9848871827125549, corresponding to test acc:                         0.9648450016975403 / 0.980025589466095
after epoch: 26,now: 2024-05-26 21:03:11.232331,epoch time: 0:19:20.929742,used: 8:27:45.232968,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863190
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9876873, 'precision': 0.95033157, 'recall': 0.849928, 'specificity': 0.849928, 'f1': 0.89337254, 'auroc': 0.9946656, 'binary_precision': 0.91093475, 'binary_recall': 0.7022434, 'binary_specificity': 0.9976126, 'binary_f1_score': 0.7930902}
confusion matrix:
       0     1
0  42204   101
1    438  1033
---- Validation: 
scalar performance:
{'acc': 0.9835568, 'precision': 0.95973384, 'recall': 0.77847147, 'specificity': 0.77847147, 'f1': 0.84533554, 'auroc': 0.97830737, 'binary_precision': 0.9348958, 'binary_recall': 0.55832034, 'binary_specificity': 0.99862254, 'binary_f1_score': 0.6991236}
confusion matrix:
       0    1
0  18124   25
1    284  359
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9613295, 'precision': 0.88427603, 'recall': 0.5473925, 'specificity': 0.5473925, 'f1': 0.57571787, 'auroc': 0.9590999, 'binary_precision': 0.8064516, 'binary_recall': 0.09578544, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.17123288}
confusion matrix:
      0   1
0  5991   6
1   236  25
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863190.png
early stop counter: 5
val acc:0.9835568070411682, best validation acc: 0.9848871827125549, corresponding to test acc:                         0.9648450016975403 / 0.980025589466095
after epoch: 27,now: 2024-05-26 21:22:42.669884,epoch time: 0:19:31.437553,used: 8:47:16.670521,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863190
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9866822, 'precision': 0.9702567, 'recall': 0.81692743, 'specificity': 0.81692743, 'f1': 0.8776436, 'auroc': 0.99495506, 'binary_precision': 0.9530612, 'binary_recall': 0.63494223, 'binary_specificity': 0.99891263, 'binary_f1_score': 0.76213795}
confusion matrix:
       0    1
0  42259   46
1    537  934
---- Validation: 
scalar performance:
{'acc': 0.98110896, 'precision': 0.96861994, 'recall': 0.734451, 'specificity': 0.734451, 'f1': 0.8100649, 'auroc': 0.9779671, 'binary_precision': 0.9556962, 'binary_recall': 0.4696734, 'binary_specificity': 0.9992286, 'binary_f1_score': 0.62982273}
confusion matrix:
       0    1
0  18135   14
1    341  302
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9678811, 'precision': 0.84698147, 'recall': 0.6845712, 'specificity': 0.6845712, 'f1': 0.73855865, 'auroc': 0.95774883, 'binary_precision': 0.7205882, 'binary_recall': 0.37547892, 'binary_specificity': 0.9936635, 'binary_f1_score': 0.49370274}
confusion matrix:
      0   1
0  5959  38
1   163  98
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863190.png
early stop counter: 6
val acc:0.9811089634895325, best validation acc: 0.9848871827125549, corresponding to test acc:                         0.9648450016975403 / 0.980025589466095
after epoch: 28,now: 2024-05-26 21:42:10.505191,epoch time: 0:19:27.835307,used: 9:06:44.505828,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863190
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9895605, 'precision': 0.9651569, 'recall': 0.8677188, 'specificity': 0.8677188, 'f1': 0.91032803, 'auroc': 0.99499226, 'binary_precision': 0.93939394, 'binary_recall': 0.7370924, 'binary_specificity': 0.9983453, 'binary_f1_score': 0.82603735}
confusion matrix:
       0     1
0  42234    70
1    387  1085
---- Validation: 
scalar performance:
{'acc': 0.9838229, 'precision': 0.92798585, 'recall': 0.8086114, 'specificity': 0.8086114, 'f1': 0.8579025, 'auroc': 0.978704, 'binary_precision': 0.86928105, 'binary_recall': 0.62052876, 'binary_specificity': 0.996694, 'binary_f1_score': 0.7241379}
confusion matrix:
       0    1
0  18089   60
1    244  399
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589326, 'precision': 0.745564, 'recall': 0.5717945, 'specificity': 0.5717945, 'f1': 0.6058687, 'auroc': 0.939729, 'binary_precision': 0.527027, 'binary_recall': 0.14942528, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.23283583}
confusion matrix:
      0   1
0  5962  35
1   222  39
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863190.png
early stop counter: 7
val acc:0.9838228821754456, best validation acc: 0.9848871827125549, corresponding to test acc:                         0.9648450016975403 / 0.980025589466095
after epoch: 29,now: 2024-05-26 22:01:41.066062,epoch time: 0:19:30.560871,used: 9:26:15.066699,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863190
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9889894, 'precision': 0.96492445, 'recall': 0.8584757, 'specificity': 0.8584757, 'f1': 0.9043281, 'auroc': 0.99418676, 'binary_precision': 0.9395555, 'binary_recall': 0.7185588, 'binary_specificity': 0.99839264, 'binary_f1_score': 0.81432974}
confusion matrix:
       0     1
0  42237    68
1    414  1057
---- Validation: 
scalar performance:
{'acc': 0.98243934, 'precision': 0.9505491, 'recall': 0.7666421, 'specificity': 0.7666421, 'f1': 0.8334051, 'auroc': 0.9785967, 'binary_precision': 0.9173333, 'binary_recall': 0.5349922, 'binary_specificity': 0.9982919, 'binary_f1_score': 0.6758349}
confusion matrix:
       0    1
0  18118   31
1    299  344
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614893, 'precision': 0.7912892, 'recall': 0.59878117, 'specificity': 0.59878117, 'f1': 0.64283556, 'auroc': 0.93687963, 'binary_precision': 0.61627907, 'binary_recall': 0.20306513, 'binary_specificity': 0.99449724, 'binary_f1_score': 0.3054755}
confusion matrix:
      0   1
0  5964  33
1   208  53
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863190.png
early stop counter: 8
val acc:0.9824393391609192, best validation acc: 0.9848871827125549, corresponding to test acc:                         0.9648450016975403 / 0.980025589466095
after epoch: 30,now: 2024-05-26 22:21:00.935318,epoch time: 0:19:19.869256,used: 9:45:34.935955,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863190
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 9:45:34.935955 at 2024-05-26 22:21:00.935318
persisted model performance metric: 

scalar performance:
{'acc': 0.9650048, 'precision': 0.830409, 'recall': 0.64275914, 'specificity': 0.64275914, 'f1': 0.6958357, 'auroc': 0.95844287, 'binary_precision': 0.6909091, 'binary_recall': 0.29118773, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.40970352}
confusion matrix:
      0   1
0  5963  34
1   185  76
oracle model performance metric: 

scalar performance:
{'acc': 0.9782678, 'precision': 0.8904145, 'recall': 0.818254, 'specificity': 0.818254, 'f1': 0.85028625, 'auroc': 0.95843387, 'binary_precision': 0.79620856, 'binary_recall': 0.6436782, 'binary_specificity': 0.99282974, 'binary_f1_score': 0.7118644}
confusion matrix:
      0    1
0  5954   43
1    93  168
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs32/rule_results/2.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs32/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs32/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456443 KiB |  26075 MiB |   1107 TiB |   1107 TiB |
|       from large pool | 415344 KiB |  26030 MiB |   1100 TiB |   1100 TiB |
|       from small pool |  41099 KiB |     57 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 456443 KiB |  26075 MiB |   1107 TiB |   1107 TiB |
|       from large pool | 415344 KiB |  26030 MiB |   1100 TiB |   1100 TiB |
|       from small pool |  41099 KiB |     57 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447754 KiB |  26071 MiB |   1106 TiB |   1106 TiB |
|       from large pool | 407075 KiB |  26026 MiB |   1100 TiB |   1100 TiB |
|       from small pool |  40679 KiB |     56 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  27758 MiB |  27758 MiB |  27758 MiB |      0 B   |
|       from large pool |  27690 MiB |  27690 MiB |  27690 MiB |      0 B   |
|       from small pool |     68 MiB |     68 MiB |     68 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 737540 KiB |   1705 MiB | 527576 GiB | 527575 GiB |
|       from large pool | 719248 KiB |   1701 MiB | 520672 GiB | 520672 GiB |
|       from small pool |  18292 KiB |     21 MiB |   6903 GiB |   6903 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2312    |    3741    |   98676 K  |   98674 K  |
|       from large pool |     187    |    1413    |   51244 K  |   51244 K  |
|       from small pool |    2125    |    3552    |   47431 K  |   47429 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2312    |    3741    |   98676 K  |   98674 K  |
|       from large pool |     187    |    1413    |   51244 K  |   51244 K  |
|       from small pool |    2125    |    3552    |   47431 K  |   47429 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     835    |     835    |     835    |       0    |
|       from large pool |     801    |     801    |     801    |       0    |
|       from small pool |      34    |      34    |      34    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      93    |    1445    |   69687 K  |   69687 K  |
|       from large pool |      36    |     800    |   45213 K  |   45213 K  |
|       from small pool |      57    |    1408    |   24473 K  |   24473 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  26075 MiB |   1107 TiB |   1107 TiB |
|       from large pool |  16640 KiB |  26030 MiB |   1100 TiB |   1100 TiB |
|       from small pool |      0 KiB |     57 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  26075 MiB |   1107 TiB |   1107 TiB |
|       from large pool |  16640 KiB |  26030 MiB |   1100 TiB |   1100 TiB |
|       from small pool |      0 KiB |     57 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  26071 MiB |   1106 TiB |   1106 TiB |
|       from large pool |  16640 KiB |  26026 MiB |   1100 TiB |   1100 TiB |
|       from small pool |      0 KiB |     56 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1166 MiB |  27758 MiB |  27758 MiB |  26592 MiB |
|       from large pool |   1108 MiB |  27690 MiB |  27690 MiB |  26582 MiB |
|       from small pool |     58 MiB |     68 MiB |     68 MiB |     10 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   3840 KiB |   1705 MiB | 527576 GiB | 527576 GiB |
|       from large pool |   3840 KiB |   1701 MiB | 520673 GiB | 520673 GiB |
|       from small pool |      0 KiB |     43 MiB |   6903 GiB |   6903 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3741    |   98676 K  |   98676 K  |
|       from large pool |       2    |    1413    |   51244 K  |   51244 K  |
|       from small pool |       0    |    3552    |   47431 K  |   47431 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3741    |   98676 K  |   98676 K  |
|       from large pool |       2    |    1413    |   51244 K  |   51244 K  |
|       from small pool |       0    |    3552    |   47431 K  |   47431 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      67    |     835    |     835    |     768    |
|       from large pool |      38    |     801    |     801    |     763    |
|       from small pool |      29    |      34    |      34    |       5    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |    1445    |   69687 K  |   69687 K  |
|       from large pool |       1    |     800    |   45213 K  |   45213 K  |
|       from small pool |       0    |    1408    |   24474 K  |   24474 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  26075 MiB |   1107 TiB |   1107 TiB |
|       from large pool |  16640 KiB |  26030 MiB |   1100 TiB |   1100 TiB |
|       from small pool |      0 KiB |     57 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  26075 MiB |   1107 TiB |   1107 TiB |
|       from large pool |  16640 KiB |  26030 MiB |   1100 TiB |   1100 TiB |
|       from small pool |      0 KiB |     57 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  26071 MiB |   1106 TiB |   1106 TiB |
|       from large pool |  16640 KiB |  26026 MiB |   1100 TiB |   1100 TiB |
|       from small pool |      0 KiB |     56 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1166 MiB |  27758 MiB |  27758 MiB |  26592 MiB |
|       from large pool |   1108 MiB |  27690 MiB |  27690 MiB |  26582 MiB |
|       from small pool |     58 MiB |     68 MiB |     68 MiB |     10 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   3840 KiB |   1705 MiB | 527576 GiB | 527576 GiB |
|       from large pool |   3840 KiB |   1701 MiB | 520673 GiB | 520673 GiB |
|       from small pool |      0 KiB |     43 MiB |   6903 GiB |   6903 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3741    |   98676 K  |   98676 K  |
|       from large pool |       2    |    1413    |   51244 K  |   51244 K  |
|       from small pool |       0    |    3552    |   47431 K  |   47431 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3741    |   98676 K  |   98676 K  |
|       from large pool |       2    |    1413    |   51244 K  |   51244 K  |
|       from small pool |       0    |    3552    |   47431 K  |   47431 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      67    |     835    |     835    |     768    |
|       from large pool |      38    |     801    |     801    |     763    |
|       from small pool |      29    |      34    |      34    |       5    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |    1445    |   69687 K  |   69687 K  |
|       from large pool |       1    |     800    |   45213 K  |   45213 K  |
|       from small pool |       0    |    1408    |   24474 K  |   24474 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_22_30_05_seed_1_20863190

 Experiment start at: 2024-05-26 22:30:05.886081
before training, model accuracy: 0.181115061044693
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9684763, 'precision': 0.75367796, 'recall': 0.69196266, 'specificity': 0.69196266, 'f1': 0.71811366, 'auroc': 0.9459765, 'binary_precision': 0.5277264, 'binary_recall': 0.3959778, 'binary_specificity': 0.9879475, 'binary_f1_score': 0.45245638}
confusion matrix:
       0    1
0  41887  511
1    871  571
---- Validation: 
scalar performance:
{'acc': 0.96616864, 'precision': 0.7582617, 'recall': 0.6963473, 'specificity': 0.6963473, 'f1': 0.72262317, 'auroc': 0.9372985, 'binary_precision': 0.53846157, 'binary_recall': 0.40564635, 'binary_specificity': 0.9870482, 'binary_f1_score': 0.4627119}
confusion matrix:
       0    1
0  17833  234
1    400  273
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9663229, 'precision': 0.9649916, 'recall': 0.6017549, 'specificity': 0.6017549, 'f1': 0.65961546, 'auroc': 0.91891336, 'binary_precision': 0.96363634, 'binary_recall': 0.20384616, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.33650792}
confusion matrix:
      0   1
0  5944   2
1   207  53
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863190.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-26 22:50:19.564292,epoch time: 0:20:13.678211,used: 0:20:13.678211,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_22_30_05_seed_1_20863190
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97178376, 'precision': 0.793712, 'recall': 0.6945951, 'specificity': 0.6945951, 'f1': 0.7332021, 'auroc': 0.96138644, 'binary_precision': 0.6076352, 'binary_recall': 0.39791667, 'binary_specificity': 0.9912736, 'binary_f1_score': 0.48090646}
confusion matrix:
       0    1
0  42030  370
1    867  573
---- Validation: 
scalar performance:
{'acc': 0.9691035, 'precision': 0.779772, 'recall': 0.7536602, 'specificity': 0.7536602, 'f1': 0.76600724, 'auroc': 0.9535172, 'binary_precision': 0.57730263, 'binary_recall': 0.5215453, 'binary_specificity': 0.9857752, 'binary_f1_score': 0.5480094}
confusion matrix:
       0    1
0  17810  257
1    322  351
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9761521, 'precision': 0.97939247, 'recall': 0.71906257, 'specificity': 0.71906257, 'f1': 0.79704326, 'auroc': 0.9516803, 'binary_precision': 0.98275864, 'binary_recall': 0.43846154, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.60638297}
confusion matrix:
      0    1
0  5944    2
1   146  114
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863190.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-05-26 23:09:43.651332,epoch time: 0:19:24.087040,used: 0:39:37.765251,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_22_30_05_seed_1_20863190
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96820253, 'precision': 0.926782, 'recall': 0.51865447, 'specificity': 0.51865447, 'f1': 0.5278642, 'auroc': 0.9664452, 'binary_precision': 0.8852459, 'binary_recall': 0.037473977, 'binary_specificity': 0.9998349, 'binary_f1_score': 0.07190412}
confusion matrix:
       0   1
0  42392   7
1   1387  54
---- Validation: 
scalar performance:
{'acc': 0.9649413, 'precision': 0.95470273, 'recall': 0.5126023, 'specificity': 0.5126023, 'f1': 0.51567274, 'auroc': 0.96411556, 'binary_precision': 0.9444444, 'binary_recall': 0.02526003, 'binary_specificity': 0.9999446, 'binary_f1_score': 0.04920405}
confusion matrix:
       0   1
0  18066   1
1    656  17
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.94793975, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863190.png
early stop counter: 1
val acc:0.9649413228034973, best validation acc: 0.9691035151481628, corresponding to test acc:                         0.9761521220207214 / 0.9761521220207214
after epoch: 3,now: 2024-05-26 23:28:57.686059,epoch time: 0:19:14.034727,used: 0:58:51.799978,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_22_30_05_seed_1_20863190
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97249085, 'precision': 0.8707762, 'recall': 0.6163304, 'specificity': 0.6163304, 'f1': 0.672908, 'auroc': 0.9673015, 'binary_precision': 0.7669683, 'binary_recall': 0.23509015, 'binary_specificity': 0.99757063, 'binary_f1_score': 0.3598726}
confusion matrix:
       0    1
0  42295  103
1   1103  339
---- Validation: 
scalar performance:
{'acc': 0.9665422, 'precision': 0.88898516, 'recall': 0.54418904, 'specificity': 0.54418904, 'f1': 0.57178676, 'auroc': 0.9603934, 'binary_precision': 0.8108108, 'binary_recall': 0.089153044, 'binary_specificity': 0.9992251, 'binary_f1_score': 0.16064256}
confusion matrix:
       0   1
0  18053  14
1    613  60
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96406704, 'precision': 0.96918046, 'recall': 0.5729928, 'specificity': 0.5729928, 'f1': 0.61788535, 'auroc': 0.9498776, 'binary_precision': 0.974359, 'binary_recall': 0.14615385, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.2541806}
confusion matrix:
      0   1
0  5945   1
1   222  38
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863190.png
early stop counter: 2
val acc:0.9665421843528748, best validation acc: 0.9691035151481628, corresponding to test acc:                         0.9761521220207214 / 0.9761521220207214
after epoch: 4,now: 2024-05-26 23:48:30.161893,epoch time: 0:19:32.475834,used: 1:18:24.275812,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_22_30_05_seed_1_20863190
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9743841, 'precision': 0.9044658, 'recall': 0.63740605, 'specificity': 0.63740605, 'f1': 0.70115685, 'auroc': 0.9726013, 'binary_precision': 0.8329854, 'binary_recall': 0.27669904, 'binary_specificity': 0.9981131, 'binary_f1_score': 0.41540864}
confusion matrix:
       0    1
0  42318   80
1   1043  399
---- Validation: 
scalar performance:
{'acc': 0.96835643, 'precision': 0.97803795, 'recall': 0.5601506, 'specificity': 0.5601506, 'f1': 0.5992112, 'auroc': 0.97198987, 'binary_precision': 0.9878049, 'binary_recall': 0.12035661, 'binary_specificity': 0.9999446, 'binary_f1_score': 0.21456954}
confusion matrix:
       0   1
0  18066   1
1    592  81
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587496, 'precision': 0.97936153, 'recall': 0.50769234, 'specificity': 0.50769234, 'f1': 0.5046148, 'auroc': 0.95406866, 'binary_precision': 1.0, 'binary_recall': 0.015384615, 'binary_specificity': 1.0, 'binary_f1_score': 0.03030303}
confusion matrix:
      0  1
0  5946  0
1   256  4
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863190.png
early stop counter: 3
val acc:0.9683564305305481, best validation acc: 0.9691035151481628, corresponding to test acc:                         0.9761521220207214 / 0.9761521220207214
after epoch: 5,now: 2024-05-27 00:08:02.061547,epoch time: 0:19:31.899654,used: 1:37:56.175466,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_22_30_05_seed_1_20863190
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97839874, 'precision': 0.8269081, 'recall': 0.8411201, 'specificity': 0.8411201, 'f1': 0.83384883, 'auroc': 0.9780575, 'binary_precision': 0.66423357, 'binary_recall': 0.69417477, 'binary_specificity': 0.9880655, 'binary_f1_score': 0.6788742}
confusion matrix:
       0     1
0  41892   506
1    441  1001
---- Validation: 
scalar performance:
{'acc': 0.97828174, 'precision': 0.88088024, 'recall': 0.7734409, 'specificity': 0.7734409, 'f1': 0.81759566, 'auroc': 0.9726316, 'binary_precision': 0.7782427, 'binary_recall': 0.55274886, 'binary_specificity': 0.99413294, 'binary_f1_score': 0.6463945}
confusion matrix:
       0    1
0  17961  106
1    301  372
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9740574, 'precision': 0.8986875, 'recall': 0.74187624, 'specificity': 0.74187624, 'f1': 0.7993141, 'auroc': 0.962281, 'binary_precision': 0.81935483, 'binary_recall': 0.48846152, 'binary_specificity': 0.99529094, 'binary_f1_score': 0.61204815}
confusion matrix:
      0    1
0  5918   28
1   133  127
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863190.png
better model found
persisted
after epoch: 6,now: 2024-05-27 00:27:30.986488,epoch time: 0:19:28.924941,used: 1:57:25.100407,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_22_30_05_seed_1_20863190
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97600365, 'precision': 0.80198383, 'recall': 0.8586389, 'specificity': 0.8586389, 'f1': 0.82763594, 'auroc': 0.97648776, 'binary_precision': 0.61310905, 'binary_recall': 0.7330097, 'binary_specificity': 0.9842681, 'binary_f1_score': 0.66771954}
confusion matrix:
       0     1
0  41731   667
1    385  1057
---- Validation: 
scalar performance:
{'acc': 0.9780683, 'precision': 0.8468009, 'recall': 0.8284058, 'specificity': 0.8284058, 'f1': 0.83732855, 'auroc': 0.9731657, 'binary_precision': 0.7059748, 'binary_recall': 0.66716194, 'binary_specificity': 0.98964965, 'binary_f1_score': 0.68601984}
confusion matrix:
       0    1
0  17880  187
1    224  449
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9624557, 'precision': 0.816517, 'recall': 0.60157573, 'specificity': 0.60157573, 'f1': 0.64870656, 'auroc': 0.9544277, 'binary_precision': 0.6666667, 'binary_recall': 0.20769231, 'binary_specificity': 0.99545914, 'binary_f1_score': 0.31671554}
confusion matrix:
      0   1
0  5919  27
1   206  54
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863190.png
early stop counter: 1
val acc:0.9780682921409607, best validation acc: 0.9782817363739014, corresponding to test acc:                         0.9740573763847351 / 0.9761521220207214
after epoch: 7,now: 2024-05-27 00:47:02.759408,epoch time: 0:19:31.772920,used: 2:16:56.873327,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_22_30_05_seed_1_20863190
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9715785, 'precision': 0.76885694, 'recall': 0.91587263, 'specificity': 0.91587263, 'f1': 0.8247465, 'auroc': 0.9797287, 'binary_precision': 0.5426937, 'binary_recall': 0.85625, 'binary_specificity': 0.9754953, 'binary_f1_score': 0.6643319}
confusion matrix:
       0     1
0  41361  1039
1    207  1233
---- Validation: 
scalar performance:
{'acc': 0.97363925, 'precision': 0.7950595, 'recall': 0.8990661, 'specificity': 0.8990661, 'f1': 0.8383548, 'auroc': 0.9741714, 'binary_precision': 0.5969664, 'binary_recall': 0.8187221, 'binary_specificity': 0.97941, 'binary_f1_score': 0.6904762}
confusion matrix:
       0    1
0  17695  372
1    122  551
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9756687, 'precision': 0.8459983, 'recall': 0.85489535, 'specificity': 0.85489535, 'f1': 0.85038376, 'auroc': 0.9564644, 'binary_precision': 0.70411986, 'binary_recall': 0.72307694, 'binary_specificity': 0.98671377, 'binary_f1_score': 0.71347255}
confusion matrix:
      0    1
0  5867   79
1    72  188
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863190.png
early stop counter: 2
val acc:0.9736392498016357, best validation acc: 0.9782817363739014, corresponding to test acc:                         0.9740573763847351 / 0.9761521220207214
after epoch: 8,now: 2024-05-27 01:06:23.441714,epoch time: 0:19:20.682306,used: 2:36:17.555633,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_22_30_05_seed_1_20863190
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9810447, 'precision': 0.85307705, 'recall': 0.845734, 'specificity': 0.845734, 'f1': 0.84936357, 'auroc': 0.98156035, 'binary_precision': 0.71631205, 'binary_recall': 0.70090216, 'binary_specificity': 0.99056584, 'binary_f1_score': 0.70852333}
confusion matrix:
       0     1
0  41999   400
1    431  1010
---- Validation: 
scalar performance:
{'acc': 0.9797759, 'precision': 0.88302076, 'recall': 0.8006807, 'specificity': 0.8006807, 'f1': 0.83646476, 'auroc': 0.9706117, 'binary_precision': 0.7805343, 'binary_recall': 0.6077266, 'binary_specificity': 0.9936348, 'binary_f1_score': 0.6833751}
confusion matrix:
       0    1
0  17952  115
1    264  409
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959233, 'precision': 0.7835908, 'recall': 0.53736836, 'specificity': 0.53736836, 'f1': 0.5578213, 'auroc': 0.9508944, 'binary_precision': 0.6060606, 'binary_recall': 0.07692308, 'binary_specificity': 0.99781364, 'binary_f1_score': 0.13651878}
confusion matrix:
      0   1
0  5933  13
1   240  20
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863190.png
better model found
persisted
after epoch: 9,now: 2024-05-27 01:25:53.263565,epoch time: 0:19:29.821851,used: 2:55:47.377484,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_22_30_05_seed_1_20863190
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9833257, 'precision': 0.8981893, 'recall': 0.82055604, 'specificity': 0.82055604, 'f1': 0.8548565, 'auroc': 0.9823723, 'binary_precision': 0.8083261, 'binary_recall': 0.6463246, 'binary_specificity': 0.9947875, 'binary_f1_score': 0.71830446}
confusion matrix:
       0    1
0  42177  221
1    510  932
---- Validation: 
scalar performance:
{'acc': 0.976841, 'precision': 0.8832133, 'recall': 0.7419372, 'specificity': 0.7419372, 'f1': 0.79531854, 'auroc': 0.97422594, 'binary_precision': 0.78520286, 'binary_recall': 0.48885587, 'binary_specificity': 0.99501854, 'binary_f1_score': 0.6025641}
confusion matrix:
       0    1
0  17977   90
1    344  329
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9622946, 'precision': 0.8340601, 'recall': 0.5849408, 'specificity': 0.5849408, 'f1': 0.6292099, 'auroc': 0.9541064, 'binary_precision': 0.703125, 'binary_recall': 0.17307693, 'binary_specificity': 0.9968046, 'binary_f1_score': 0.2777778}
confusion matrix:
      0   1
0  5927  19
1   215  45
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863190.png
early stop counter: 1
val acc:0.9768409729003906, best validation acc: 0.9797759056091309, corresponding to test acc:                         0.9592329859733582 / 0.9761521220207214
after epoch: 10,now: 2024-05-27 01:45:22.121855,epoch time: 0:19:28.858290,used: 3:15:16.235774,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_22_30_05_seed_1_20863190
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9765967, 'precision': 0.85143715, 'recall': 0.7316326, 'specificity': 0.7316326, 'f1': 0.77825856, 'auroc': 0.9786148, 'binary_precision': 0.7206823, 'binary_recall': 0.46944445, 'binary_specificity': 0.9938207, 'binary_f1_score': 0.568545}
confusion matrix:
       0    1
0  42138  262
1    764  676
---- Validation: 
scalar performance:
{'acc': 0.9745998, 'precision': 0.9147417, 'recall': 0.6756855, 'specificity': 0.6756855, 'f1': 0.74348444, 'auroc': 0.9688729, 'binary_precision': 0.8530466, 'binary_recall': 0.3536404, 'binary_specificity': 0.9977307, 'binary_f1_score': 0.5}
confusion matrix:
       0    1
0  18026   41
1    435  238
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587496, 'precision': 0.89610213, 'recall': 0.50953126, 'specificity': 0.50953126, 'f1': 0.5082585, 'auroc': 0.9578068, 'binary_precision': 0.8333333, 'binary_recall': 0.01923077, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.037593987}
confusion matrix:
      0  1
0  5945  1
1   255  5
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863190.png
early stop counter: 2
val acc:0.9745997786521912, best validation acc: 0.9797759056091309, corresponding to test acc:                         0.9592329859733582 / 0.9761521220207214
after epoch: 11,now: 2024-05-27 02:04:54.290154,epoch time: 0:19:32.168299,used: 3:34:48.404073,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_22_30_05_seed_1_20863190
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.982094, 'precision': 0.88272333, 'recall': 0.81589985, 'specificity': 0.81589985, 'f1': 0.84586155, 'auroc': 0.9844189, 'binary_precision': 0.77768385, 'binary_recall': 0.63800275, 'binary_specificity': 0.9937969, 'binary_f1_score': 0.70095235}
confusion matrix:
       0    1
0  42135  263
1    522  920
---- Validation: 
scalar performance:
{'acc': 0.9791355, 'precision': 0.9300976, 'recall': 0.7416967, 'specificity': 0.7416967, 'f1': 0.80755293, 'auroc': 0.9783988, 'binary_precision': 0.87903225, 'binary_recall': 0.4858841, 'binary_specificity': 0.9975093, 'binary_f1_score': 0.6258373}
confusion matrix:
       0    1
0  18022   45
1    346  327
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959233, 'precision': 0.924112, 'recall': 0.5153005, 'specificity': 0.5153005, 'f1': 0.5193222, 'auroc': 0.9499258, 'binary_precision': 0.8888889, 'binary_recall': 0.03076923, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.059479553}
confusion matrix:
      0  1
0  5945  1
1   252  8
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863190.png
early stop counter: 3
val acc:0.9791355133056641, best validation acc: 0.9797759056091309, corresponding to test acc:                         0.9592329859733582 / 0.9761521220207214
after epoch: 12,now: 2024-05-27 02:24:19.348476,epoch time: 0:19:25.058322,used: 3:54:13.462395,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_22_30_05_seed_1_20863190
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9835538, 'precision': 0.8816943, 'recall': 0.85014933, 'specificity': 0.85014933, 'f1': 0.86518615, 'auroc': 0.9862615, 'binary_precision': 0.7733131, 'binary_recall': 0.7073509, 'binary_specificity': 0.99294776, 'binary_f1_score': 0.73886275}
confusion matrix:
       0     1
0  42099   299
1    422  1020
---- Validation: 
scalar performance:
{'acc': 0.98191035, 'precision': 0.8894426, 'recall': 0.8339747, 'specificity': 0.8339747, 'f1': 0.85939574, 'auroc': 0.97835433, 'binary_precision': 0.79094076, 'binary_recall': 0.67459136, 'binary_specificity': 0.9933581, 'binary_f1_score': 0.7281476}
confusion matrix:
       0    1
0  17947  120
1    219  454
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9618111, 'precision': 0.85943663, 'recall': 0.5644596, 'specificity': 0.5644596, 'f1': 0.60168767, 'auroc': 0.96138483, 'binary_precision': 0.75555557, 'binary_recall': 0.13076924, 'binary_specificity': 0.99815, 'binary_f1_score': 0.22295082}
confusion matrix:
      0   1
0  5935  11
1   226  34
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863190.png
better model found
persisted
after epoch: 13,now: 2024-05-27 02:43:42.548813,epoch time: 0:19:23.200337,used: 4:13:36.662732,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_22_30_05_seed_1_20863190
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98540145, 'precision': 0.9005439, 'recall': 0.8601482, 'specificity': 0.8601482, 'f1': 0.8791883, 'auroc': 0.98848087, 'binary_precision': 0.8103715, 'binary_recall': 0.7260749, 'binary_specificity': 0.99422145, 'binary_f1_score': 0.7659108}
confusion matrix:
       0     1
0  42153   245
1    395  1047
---- Validation: 
scalar performance:
{'acc': 0.9810566, 'precision': 0.88505024, 'recall': 0.82351816, 'specificity': 0.82351816, 'f1': 0.8513781, 'auroc': 0.97900146, 'binary_precision': 0.78291816, 'binary_recall': 0.653789, 'binary_specificity': 0.99324733, 'binary_f1_score': 0.71255064}
confusion matrix:
       0    1
0  17945  122
1    233  440
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97164035, 'precision': 0.9149076, 'recall': 0.69280124, 'specificity': 0.69280124, 'f1': 0.75988317, 'auroc': 0.9660698, 'binary_precision': 0.8559322, 'binary_recall': 0.38846153, 'binary_specificity': 0.99714094, 'binary_f1_score': 0.5343915}
confusion matrix:
      0    1
0  5929   17
1   159  101
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863190.png
early stop counter: 1
val acc:0.9810565710067749, best validation acc: 0.9819103479385376, corresponding to test acc:                         0.9618111252784729 / 0.9761521220207214
after epoch: 14,now: 2024-05-27 03:03:14.570828,epoch time: 0:19:32.022015,used: 4:33:08.684747,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_22_30_05_seed_1_20863190
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98471713, 'precision': 0.9332005, 'recall': 0.80888236, 'specificity': 0.80888236, 'f1': 0.8598901, 'auroc': 0.9887248, 'binary_precision': 0.8791748, 'binary_recall': 0.6206657, 'binary_specificity': 0.9970989, 'binary_f1_score': 0.72764224}
confusion matrix:
       0    1
0  42275  123
1    547  895
---- Validation: 
scalar performance:
{'acc': 0.981857, 'precision': 0.954441, 'recall': 0.76814246, 'specificity': 0.76814246, 'f1': 0.8355572, 'auroc': 0.9794092, 'binary_precision': 0.9258312, 'binary_recall': 0.53789, 'binary_specificity': 0.99839485, 'binary_f1_score': 0.68045104}
confusion matrix:
       0    1
0  18038   29
1    311  362
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.962778, 'precision': 0.82726896, 'recall': 0.5999049, 'specificity': 0.5999049, 'f1': 0.6477048, 'auroc': 0.9588547, 'binary_precision': 0.6883117, 'binary_recall': 0.20384616, 'binary_specificity': 0.9959637, 'binary_f1_score': 0.31454006}
confusion matrix:
      0   1
0  5922  24
1   207  53
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863190.png
early stop counter: 2
val acc:0.9818570017814636, best validation acc: 0.9819103479385376, corresponding to test acc:                         0.9618111252784729 / 0.9761521220207214
after epoch: 15,now: 2024-05-27 03:22:46.406126,epoch time: 0:19:31.835298,used: 4:52:40.520045,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_22_30_05_seed_1_20863190
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9859717, 'precision': 0.88655686, 'recall': 0.8956125, 'specificity': 0.8956125, 'f1': 0.89102787, 'auroc': 0.9905882, 'binary_precision': 0.7799594, 'binary_recall': 0.7988904, 'binary_specificity': 0.99233454, 'binary_f1_score': 0.7893114}
confusion matrix:
       0     1
0  42073   325
1    290  1152
---- Validation: 
scalar performance:
{'acc': 0.983778, 'precision': 0.89274216, 'recall': 0.8656998, 'specificity': 0.8656998, 'f1': 0.8786958, 'auroc': 0.9787194, 'binary_precision': 0.7952, 'binary_recall': 0.7384844, 'binary_specificity': 0.9929153, 'binary_f1_score': 0.7657935}
confusion matrix:
       0    1
0  17939  128
1    176  497
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95955527, 'precision': 0.7629677, 'recall': 0.5761553, 'specificity': 0.5761553, 'f1': 0.6127332, 'auroc': 0.9552868, 'binary_precision': 0.56164384, 'binary_recall': 0.15769231, 'binary_specificity': 0.99461824, 'binary_f1_score': 0.24624625}
confusion matrix:
      0   1
0  5914  32
1   219  41
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863190.png
better model found
persisted
after epoch: 16,now: 2024-05-27 03:42:15.999608,epoch time: 0:19:29.593482,used: 5:12:10.113527,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_22_30_05_seed_1_20863190
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9851962, 'precision': 0.88604486, 'recall': 0.87905276, 'specificity': 0.87905276, 'f1': 0.88251424, 'auroc': 0.98858476, 'binary_precision': 0.7800566, 'binary_recall': 0.76544064, 'binary_specificity': 0.99266493, 'binary_f1_score': 0.77267957}
confusion matrix:
       0     1
0  42088   311
1    338  1103
---- Validation: 
scalar performance:
{'acc': 0.9825507, 'precision': 0.8928704, 'recall': 0.8414595, 'specificity': 0.8414595, 'f1': 0.8652077, 'auroc': 0.9728936, 'binary_precision': 0.79725087, 'binary_recall': 0.6894502, 'binary_specificity': 0.99346876, 'binary_f1_score': 0.7394423}
confusion matrix:
       0    1
0  17949  118
1    209  464
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590719, 'precision': 0.8050356, 'recall': 0.5244114, 'specificity': 0.5244114, 'f1': 0.53596044, 'auroc': 0.9483081, 'binary_precision': 0.65, 'binary_recall': 0.05, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.09285714}
confusion matrix:
      0   1
0  5939   7
1   247  13
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863190.png
early stop counter: 1
val acc:0.9825506806373596, best validation acc: 0.9837779998779297, corresponding to test acc:                         0.9595552682876587 / 0.9761521220207214
after epoch: 17,now: 2024-05-27 04:01:39.633947,epoch time: 0:19:23.634339,used: 5:31:33.747866,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_22_30_05_seed_1_20863190
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.985219, 'precision': 0.9284909, 'recall': 0.82241774, 'specificity': 0.82241774, 'f1': 0.8674197, 'auroc': 0.99116075, 'binary_precision': 0.86883724, 'binary_recall': 0.648161, 'binary_specificity': 0.9966745, 'binary_f1_score': 0.74244833}
confusion matrix:
       0    1
0  42258  141
1    507  934
---- Validation: 
scalar performance:
{'acc': 0.98345786, 'precision': 0.9465809, 'recall': 0.7990139, 'specificity': 0.7990139, 'f1': 0.8570969, 'auroc': 0.9788518, 'binary_precision': 0.90786517, 'binary_recall': 0.60029715, 'binary_specificity': 0.9977307, 'binary_f1_score': 0.72271913}
confusion matrix:
       0    1
0  18026   41
1    269  404
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9577828, 'precision': 0.7107045, 'recall': 0.5218997, 'specificity': 0.5218997, 'f1': 0.5311548, 'auroc': 0.9444321, 'binary_precision': 0.46153846, 'binary_recall': 0.046153847, 'binary_specificity': 0.9976455, 'binary_f1_score': 0.08391608}
confusion matrix:
      0   1
0  5932  14
1   248  12
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863190.png
early stop counter: 2
val acc:0.9834578633308411, best validation acc: 0.9837779998779297, corresponding to test acc:                         0.9595552682876587 / 0.9761521220207214
after epoch: 18,now: 2024-05-27 04:21:06.581407,epoch time: 0:19:26.947460,used: 5:51:00.695326,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_22_30_05_seed_1_20863190
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.98207116, 'precision': 0.88677067, 'recall': 0.80952406, 'specificity': 0.80952406, 'f1': 0.8435267, 'auroc': 0.9848547, 'binary_precision': 0.7862129, 'binary_recall': 0.6248266, 'binary_specificity': 0.99422145, 'binary_f1_score': 0.69629055}
confusion matrix:
       0    1
0  42153  245
1    541  901
---- Validation: 
scalar performance:
{'acc': 0.97966915, 'precision': 0.88896656, 'recall': 0.7906116, 'specificity': 0.7906116, 'f1': 0.8320719, 'auroc': 0.9668862, 'binary_precision': 0.7931727, 'binary_recall': 0.5869242, 'binary_specificity': 0.994299, 'binary_f1_score': 0.6746371}
confusion matrix:
       0    1
0  17964  103
1    278  395
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96326137, 'precision': 0.9539078, 'recall': 0.5652164, 'specificity': 0.5652164, 'f1': 0.6054558, 'auroc': 0.9357598, 'binary_precision': 0.9444444, 'binary_recall': 0.13076924, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.22972973}
confusion matrix:
      0   1
0  5944   2
1   226  34
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863190.png
early stop counter: 3
val acc:0.9796691536903381, best validation acc: 0.9837779998779297, corresponding to test acc:                         0.9595552682876587 / 0.9761521220207214
after epoch: 19,now: 2024-05-27 04:40:36.318572,epoch time: 0:19:29.737165,used: 6:10:30.432491,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_22_30_05_seed_1_20863190
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9880931, 'precision': 0.9015001, 'recall': 0.9144045, 'specificity': 0.9144045, 'f1': 0.90784186, 'auroc': 0.9920713, 'binary_precision': 0.8085964, 'binary_recall': 0.8355309, 'binary_specificity': 0.99327815, 'binary_f1_score': 0.821843}
confusion matrix:
       0     1
0  42114   285
1    237  1204
---- Validation: 
scalar performance:
{'acc': 0.984365, 'precision': 0.90131396, 'recall': 0.86385846, 'specificity': 0.86385846, 'f1': 0.8815892, 'auroc': 0.980605, 'binary_precision': 0.8125, 'binary_recall': 0.73402673, 'binary_specificity': 0.99369013, 'binary_f1_score': 0.7712725}
confusion matrix:
       0    1
0  17953  114
1    179  494
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96358365, 'precision': 0.8698442, 'recall': 0.59113044, 'specificity': 0.59113044, 'f1': 0.63972175, 'auroc': 0.95283175, 'binary_precision': 0.7741935, 'binary_recall': 0.18461539, 'binary_specificity': 0.9976455, 'binary_f1_score': 0.29813665}
confusion matrix:
      0   1
0  5932  14
1   212  48
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863190.png
better model found
persisted
after epoch: 20,now: 2024-05-27 05:00:07.983143,epoch time: 0:19:31.664571,used: 6:30:02.097062,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_22_30_05_seed_1_20863190
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9845347, 'precision': 0.92432344, 'recall': 0.8141471, 'specificity': 0.8141471, 'f1': 0.8604202, 'auroc': 0.9900081, 'binary_precision': 0.8610586, 'binary_recall': 0.63176143, 'binary_specificity': 0.99653286, 'binary_f1_score': 0.72880006}
confusion matrix:
       0    1
0  42251  147
1    531  911
---- Validation: 
scalar performance:
{'acc': 0.9787086, 'precision': 0.88691604, 'recall': 0.7743776, 'specificity': 0.7743776, 'f1': 0.82027364, 'auroc': 0.9787396, 'binary_precision': 0.79025424, 'binary_recall': 0.55423474, 'binary_specificity': 0.9945204, 'binary_f1_score': 0.65152836}
confusion matrix:
       0    1
0  17968   99
1    300  373
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621334, 'precision': 0.81841445, 'recall': 0.5922126, 'specificity': 0.5922126, 'f1': 0.6374195, 'auroc': 0.95038533, 'binary_precision': 0.6712329, 'binary_recall': 0.18846154, 'binary_specificity': 0.9959637, 'binary_f1_score': 0.29429433}
confusion matrix:
      0   1
0  5922  24
1   211  49
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863190.png
early stop counter: 1
val acc:0.9787086248397827, best validation acc: 0.9843649864196777, corresponding to test acc:                         0.9635836482048035 / 0.9761521220207214
after epoch: 21,now: 2024-05-27 05:19:39.556238,epoch time: 0:19:31.573095,used: 6:49:33.670157,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_22_30_05_seed_1_20863190
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.98740876, 'precision': 0.8805785, 'recall': 0.9409034, 'specificity': 0.9409034, 'f1': 0.90833104, 'auroc': 0.99334943, 'binary_precision': 0.76488096, 'binary_recall': 0.8911234, 'binary_specificity': 0.9906835, 'binary_f1_score': 0.8231902}
confusion matrix:
       0     1
0  42003   395
1    157  1285
---- Validation: 
scalar performance:
{'acc': 0.9840982, 'precision': 0.8789426, 'recall': 0.8973377, 'specificity': 0.8973377, 'f1': 0.88790154, 'auroc': 0.98209155, 'binary_precision': 0.7652051, 'binary_recall': 0.8038633, 'binary_specificity': 0.990812, 'binary_f1_score': 0.784058}
confusion matrix:
       0    1
0  17901  166
1    132  541
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95987755, 'precision': 0.7577417, 'recall': 0.6167812, 'specificity': 0.6167812, 'f1': 0.65765685, 'auroc': 0.9469093, 'binary_precision': 0.5478261, 'binary_recall': 0.2423077, 'binary_specificity': 0.9912546, 'binary_f1_score': 0.336}
confusion matrix:
      0   1
0  5894  52
1   197  63
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863190.png
early stop counter: 2
val acc:0.9840981960296631, best validation acc: 0.9843649864196777, corresponding to test acc:                         0.9635836482048035 / 0.9761521220207214
after epoch: 22,now: 2024-05-27 05:39:07.169941,epoch time: 0:19:27.613703,used: 7:09:01.283860,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_22_30_05_seed_1_20863190
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9890967, 'precision': 0.9502359, 'recall': 0.8700974, 'specificity': 0.8700974, 'f1': 0.90596884, 'auroc': 0.9937142, 'binary_precision': 0.90916806, 'binary_recall': 0.74271846, 'binary_specificity': 0.9974763, 'binary_f1_score': 0.8175573}
confusion matrix:
       0     1
0  42291   107
1    371  1071
---- Validation: 
scalar performance:
{'acc': 0.98345786, 'precision': 0.94308555, 'recall': 0.801875, 'specificity': 0.801875, 'f1': 0.858081, 'auroc': 0.9793184, 'binary_precision': 0.90066224, 'binary_recall': 0.6062407, 'binary_specificity': 0.9975093, 'binary_f1_score': 0.7246892}
confusion matrix:
       0    1
0  18022   45
1    265  408
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621334, 'precision': 0.83162534, 'recall': 0.5830177, 'specificity': 0.5830177, 'f1': 0.62650335, 'auroc': 0.95786566, 'binary_precision': 0.6984127, 'binary_recall': 0.16923077, 'binary_specificity': 0.9968046, 'binary_f1_score': 0.27244583}
confusion matrix:
      0   1
0  5927  19
1   216  44
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863190.png
early stop counter: 3
val acc:0.9834578633308411, best validation acc: 0.9843649864196777, corresponding to test acc:                         0.9635836482048035 / 0.9761521220207214
after epoch: 23,now: 2024-05-27 05:58:30.286248,epoch time: 0:19:23.116307,used: 7:28:24.400167,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_22_30_05_seed_1_20863190
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9884352, 'precision': 0.94697183, 'recall': 0.8615265, 'specificity': 0.8615265, 'f1': 0.89940786, 'auroc': 0.9933229, 'binary_precision': 0.90319794, 'binary_recall': 0.7256944, 'binary_specificity': 0.9973585, 'binary_f1_score': 0.8047747}
confusion matrix:
       0     1
0  42288   112
1    395  1045
---- Validation: 
scalar performance:
{'acc': 0.98431164, 'precision': 0.9605503, 'recall': 0.8016025, 'specificity': 0.8016025, 'f1': 0.863287, 'auroc': 0.984507, 'binary_precision': 0.93563217, 'binary_recall': 0.6047548, 'binary_specificity': 0.9984502, 'binary_f1_score': 0.734657}
confusion matrix:
       0    1
0  18039   28
1    266  407
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597164, 'precision': 0.8042488, 'recall': 0.5412986, 'specificity': 0.5412986, 'f1': 0.5645147, 'auroc': 0.962901, 'binary_precision': 0.64705884, 'binary_recall': 0.08461539, 'binary_specificity': 0.99798185, 'binary_f1_score': 0.14965987}
confusion matrix:
      0   1
0  5934  12
1   238  22
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863190.png
early stop counter: 4
val acc:0.9843116402626038, best validation acc: 0.9843649864196777, corresponding to test acc:                         0.9635836482048035 / 0.9761521220207214
after epoch: 24,now: 2024-05-27 06:18:00.183801,epoch time: 0:19:29.897553,used: 7:47:54.297720,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_22_30_05_seed_1_20863190
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9881387, 'precision': 0.8940814, 'recall': 0.92884123, 'specificity': 0.92884123, 'f1': 0.910665, 'auroc': 0.99284697, 'binary_precision': 0.7927527, 'binary_recall': 0.8653713, 'binary_specificity': 0.9923111, 'binary_f1_score': 0.82747173}
confusion matrix:
       0     1
0  42073   326
1    194  1247
---- Validation: 
scalar performance:
{'acc': 0.9821238, 'precision': 0.87772465, 'recall': 0.85768926, 'specificity': 0.85768926, 'f1': 0.86740893, 'auroc': 0.98318124, 'binary_precision': 0.7657233, 'binary_recall': 0.72362554, 'binary_specificity': 0.9917529, 'binary_f1_score': 0.7440794}
confusion matrix:
       0    1
0  17918  149
1    186  487
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96374476, 'precision': 0.8084974, 'recall': 0.64454514, 'specificity': 0.64454514, 'f1': 0.69381696, 'auroc': 0.9514499, 'binary_precision': 0.64705884, 'binary_recall': 0.29615384, 'binary_specificity': 0.99293643, 'binary_f1_score': 0.40633246}
confusion matrix:
      0   1
0  5904  42
1   183  77
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863190.png
early stop counter: 5
val acc:0.9821237921714783, best validation acc: 0.9843649864196777, corresponding to test acc:                         0.9635836482048035 / 0.9761521220207214
after epoch: 25,now: 2024-05-27 06:37:28.601933,epoch time: 0:19:28.418132,used: 8:07:22.715852,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_22_30_05_seed_1_20863190
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.98111314, 'precision': 0.90715545, 'recall': 0.76565933, 'specificity': 0.76565933, 'f1': 0.82046354, 'auroc': 0.9733907, 'binary_precision': 0.82992464, 'binary_recall': 0.5350451, 'binary_specificity': 0.9962735, 'binary_f1_score': 0.65063286}
confusion matrix:
       0    1
0  42241  158
1    670  771
---- Validation: 
scalar performance:
{'acc': 0.9776414, 'precision': 0.9164324, 'recall': 0.72661644, 'specificity': 0.72661644, 'f1': 0.79144454, 'auroc': 0.9672682, 'binary_precision': 0.8527778, 'binary_recall': 0.45616642, 'binary_specificity': 0.9970665, 'binary_f1_score': 0.59438527}
confusion matrix:
       0    1
0  18014   53
1    366  307
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582662, 'precision': 0.81253695, 'recall': 0.50376207, 'specificity': 0.50376207, 'f1': 0.49694523, 'auroc': 0.93330145, 'binary_precision': 0.6666667, 'binary_recall': 0.0076923077, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.015209124}
confusion matrix:
      0  1
0  5945  1
1   258  2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863190.png
early stop counter: 6
val acc:0.9776414036750793, best validation acc: 0.9843649864196777, corresponding to test acc:                         0.9635836482048035 / 0.9761521220207214
after epoch: 26,now: 2024-05-27 06:57:01.982935,epoch time: 0:19:33.381002,used: 8:26:56.096854,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_22_30_05_seed_1_20863190
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.98768246, 'precision': 0.9171887, 'recall': 0.8824292, 'specificity': 0.8824292, 'f1': 0.89899445, 'auroc': 0.99396855, 'binary_precision': 0.84218514, 'binary_recall': 0.76976424, 'binary_specificity': 0.9950941, 'binary_f1_score': 0.8043478}
confusion matrix:
       0     1
0  42190   208
1    332  1110
---- Validation: 
scalar performance:
{'acc': 0.98431164, 'precision': 0.9257418, 'recall': 0.832359, 'specificity': 0.832359, 'f1': 0.87283325, 'auroc': 0.9771497, 'binary_precision': 0.86372364, 'binary_recall': 0.6686478, 'binary_specificity': 0.9960702, 'binary_f1_score': 0.7537688}
confusion matrix:
       0    1
0  17996   71
1    223  450
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95987755, 'precision': 0.84991455, 'recall': 0.53218776, 'specificity': 0.53218776, 'f1': 0.549806, 'auroc': 0.9596903, 'binary_precision': 0.73913044, 'binary_recall': 0.06538462, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.12014135}
confusion matrix:
      0   1
0  5940   6
1   243  17
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863190.png
early stop counter: 7
val acc:0.9843116402626038, best validation acc: 0.9843649864196777, corresponding to test acc:                         0.9635836482048035 / 0.9761521220207214
after epoch: 27,now: 2024-05-27 07:16:33.920714,epoch time: 0:19:31.937779,used: 8:46:28.034633,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_22_30_05_seed_1_20863190
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9861542, 'precision': 0.9582311, 'recall': 0.8125104, 'specificity': 0.8125104, 'f1': 0.8706636, 'auroc': 0.993068, 'binary_precision': 0.92901236, 'binary_recall': 0.6266482, 'binary_specificity': 0.9983726, 'binary_f1_score': 0.748446}
confusion matrix:
       0    1
0  42330   69
1    538  903
---- Validation: 
scalar performance:
{'acc': 0.97940236, 'precision': 0.92531973, 'recall': 0.749703, 'specificity': 0.749703, 'f1': 0.81296784, 'auroc': 0.9726355, 'binary_precision': 0.8688946, 'binary_recall': 0.5022288, 'binary_specificity': 0.9971772, 'binary_f1_score': 0.6365348}
confusion matrix:
       0    1
0  18016   51
1    335  338
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587496, 'precision': 0.785436, 'recall': 0.5205652, 'specificity': 0.5205652, 'f1': 0.5290195, 'auroc': 0.93250924, 'binary_precision': 0.6111111, 'binary_recall': 0.042307694, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.07913669}
confusion matrix:
      0   1
0  5939   7
1   249  11
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863190.png
early stop counter: 8
val acc:0.9794023633003235, best validation acc: 0.9843649864196777, corresponding to test acc:                         0.9635836482048035 / 0.9761521220207214
after epoch: 28,now: 2024-05-27 07:35:57.370239,epoch time: 0:19:23.449525,used: 9:05:51.484158,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_22_30_05_seed_1_20863190
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99026006, 'precision': 0.9241686, 'recall': 0.92217636, 'specificity': 0.92217636, 'f1': 0.92317, 'auroc': 0.9952649, 'binary_precision': 0.8534543, 'binary_recall': 0.84930557, 'binary_specificity': 0.99504715, 'binary_f1_score': 0.8513749}
confusion matrix:
       0     1
0  42190   210
1    217  1223
---- Validation: 
scalar performance:
{'acc': 0.9847919, 'precision': 0.9072465, 'recall': 0.8633646, 'specificity': 0.8633646, 'f1': 0.8839481, 'auroc': 0.9778442, 'binary_precision': 0.82441473, 'binary_recall': 0.73254085, 'binary_specificity': 0.9941883, 'binary_f1_score': 0.77576715}
confusion matrix:
       0    1
0  17962  105
1    180  493
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96036094, 'precision': 0.8145144, 'recall': 0.5526689, 'specificity': 0.5526689, 'f1': 0.58255833, 'auroc': 0.9414717, 'binary_precision': 0.6666667, 'binary_recall': 0.10769231, 'binary_specificity': 0.9976455, 'binary_f1_score': 0.18543047}
confusion matrix:
      0   1
0  5932  14
1   232  28
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863190.png
better model found
persisted
after epoch: 29,now: 2024-05-27 07:55:31.115810,epoch time: 0:19:33.745571,used: 9:25:25.229729,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_22_30_05_seed_1_20863190
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.98802465, 'precision': 0.8832747, 'recall': 0.94889355, 'specificity': 0.94889355, 'f1': 0.91326964, 'auroc': 0.9939681, 'binary_precision': 0.7697291, 'binary_recall': 0.907009, 'binary_specificity': 0.9907781, 'binary_f1_score': 0.8327493}
confusion matrix:
       0     1
0  42008   391
1    134  1307
---- Validation: 
scalar performance:
{'acc': 0.9821238, 'precision': 0.86336553, 'recall': 0.8877305, 'specificity': 0.8877305, 'f1': 0.8751143, 'auroc': 0.98176926, 'binary_precision': 0.7347222, 'binary_recall': 0.7860327, 'binary_specificity': 0.9894282, 'binary_f1_score': 0.7595119}
confusion matrix:
       0    1
0  17876  191
1    144  529
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96084434, 'precision': 0.8119049, 'recall': 0.56579405, 'specificity': 0.56579405, 'f1': 0.6017789, 'auroc': 0.9473696, 'binary_precision': 0.6603774, 'binary_recall': 0.13461539, 'binary_specificity': 0.99697274, 'binary_f1_score': 0.22364217}
confusion matrix:
      0   1
0  5928  18
1   225  35
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863190.png
early stop counter: 1
val acc:0.9821237921714783, best validation acc: 0.9847918748855591, corresponding to test acc:                         0.9603609442710876 / 0.9761521220207214
after epoch: 30,now: 2024-05-27 08:15:01.977061,epoch time: 0:19:30.861251,used: 9:44:56.090980,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_22_30_05_seed_1_20863190
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 9:44:56.090980 at 2024-05-27 08:15:01.977061
persisted model performance metric: 

scalar performance:
{'acc': 0.95939416, 'precision': 0.7834195, 'recall': 0.5429694, 'specificity': 0.5429694, 'f1': 0.56678003, 'auroc': 0.9413372, 'binary_precision': 0.6052632, 'binary_recall': 0.08846154, 'binary_specificity': 0.9974773, 'binary_f1_score': 0.15436243}
confusion matrix:
      0   1
0  5931  15
1   237  23
oracle model performance metric: 

scalar performance:
{'acc': 0.9767966, 'precision': 0.9881773, 'recall': 0.72307694, 'specificity': 0.72307694, 'f1': 0.8025286, 'auroc': 0.94794047, 'binary_precision': 1.0, 'binary_recall': 0.44615385, 'binary_specificity': 1.0, 'binary_f1_score': 0.61702126}
confusion matrix:
      0    1
0  5946    0
1   144  116
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs32/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs32/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 453690 KiB |  26075 MiB |   2220 TiB |   2220 TiB |
|       from large pool | 412597 KiB |  26030 MiB |   2207 TiB |   2207 TiB |
|       from small pool |  41093 KiB |     57 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 453690 KiB |  26075 MiB |   2220 TiB |   2220 TiB |
|       from large pool | 412597 KiB |  26030 MiB |   2207 TiB |   2207 TiB |
|       from small pool |  41093 KiB |     57 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447751 KiB |  26071 MiB |   2220 TiB |   2220 TiB |
|       from large pool | 407075 KiB |  26026 MiB |   2206 TiB |   2206 TiB |
|       from small pool |  40676 KiB |     56 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  27792 MiB |  27792 MiB |  54384 MiB |  26592 MiB |
|       from large pool |  27724 MiB |  27724 MiB |  54306 MiB |  26582 MiB |
|       from small pool |     68 MiB |     68 MiB |     78 MiB |     10 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 738245 KiB |   1739 MiB |   1006 TiB |   1006 TiB |
|       from large pool | 721995 KiB |   1737 MiB |    992 TiB |    992 TiB |
|       from small pool |  16250 KiB |     43 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    2300    |    3745    |  197782 K  |  197780 K  |
|       from large pool |     187    |    1413    |  102766 K  |  102766 K  |
|       from small pool |    2113    |    3556    |   95016 K  |   95013 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2300    |    3745    |  197782 K  |  197780 K  |
|       from large pool |     187    |    1413    |  102766 K  |  102766 K  |
|       from small pool |    2113    |    3556    |   95016 K  |   95013 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     837    |     837    |    1605    |     768    |
|       from large pool |     803    |     803    |    1566    |     763    |
|       from small pool |      34    |      34    |      39    |       5    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      89    |    1451    |  139857 K  |  139857 K  |
|       from large pool |      40    |     806    |   90590 K  |   90590 K  |
|       from small pool |      49    |    1410    |   49266 K  |   49266 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  26075 MiB |   2220 TiB |   2220 TiB |
|       from large pool |  16640 KiB |  26030 MiB |   2207 TiB |   2207 TiB |
|       from small pool |      0 KiB |     57 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  26075 MiB |   2220 TiB |   2220 TiB |
|       from large pool |  16640 KiB |  26030 MiB |   2207 TiB |   2207 TiB |
|       from small pool |      0 KiB |     57 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  26071 MiB |   2220 TiB |   2220 TiB |
|       from large pool |  16640 KiB |  26026 MiB |   2206 TiB |   2206 TiB |
|       from small pool |      0 KiB |     56 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1164 MiB |  27792 MiB |  54384 MiB |  53220 MiB |
|       from large pool |   1108 MiB |  27724 MiB |  54306 MiB |  53198 MiB |
|       from small pool |     56 MiB |     68 MiB |     78 MiB |     22 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   3840 KiB |   1739 MiB |   1006 TiB |   1006 TiB |
|       from large pool |   3840 KiB |   1737 MiB |    992 TiB |    992 TiB |
|       from small pool |      0 KiB |     43 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3745    |  197782 K  |  197782 K  |
|       from large pool |       2    |    1413    |  102766 K  |  102766 K  |
|       from small pool |       0    |    3556    |   95016 K  |   95016 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3745    |  197782 K  |  197782 K  |
|       from large pool |       2    |    1413    |  102766 K  |  102766 K  |
|       from small pool |       0    |    3556    |   95016 K  |   95016 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      69    |     837    |    1605    |    1536    |
|       from large pool |      41    |     803    |    1566    |    1525    |
|       from small pool |      28    |      34    |      39    |      11    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |    1451    |  139858 K  |  139858 K  |
|       from large pool |       1    |     806    |   90590 K  |   90590 K  |
|       from small pool |       0    |    1410    |   49267 K  |   49267 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Mon May 27 08:16:57 2024]
Finished job 0.
1 of 1 steps (100%) done
