Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sun May 26 12:25:42 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs32/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs32/rule_results/4.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=4
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863191

 Experiment start at: 2024-05-26 12:35:25.937512
before training, model accuracy: 0.955097496509552
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.97178817, 'precision': 0.78212, 'recall': 0.788224, 'specificity': 0.788224, 'f1': 0.785136, 'auroc': 0.9718129, 'binary_precision': 0.5784575, 'binary_recall': 0.5914344, 'binary_specificity': 0.9850136, 'binary_f1_score': 0.58487403}
confusion matrix:
       0    1
0  41671  634
1    601  870
---- Validation: 
scalar performance:
{'acc': 0.96977437, 'precision': 0.7708417, 'recall': 0.7773365, 'specificity': 0.7773365, 'f1': 0.7740464, 'auroc': 0.9690566, 'binary_precision': 0.5569044, 'binary_recall': 0.57076204, 'binary_specificity': 0.983911, 'binary_f1_score': 0.56374806}
confusion matrix:
       0    1
0  17857  292
1    276  367
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97379357, 'precision': 0.955698, 'recall': 0.6986501, 'specificity': 0.6986501, 'f1': 0.7728176, 'auroc': 0.9574029, 'binary_precision': 0.9369369, 'binary_recall': 0.39846742, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.5591398}
confusion matrix:
      0    1
0  5990    7
1   157  104
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863191.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-26 12:59:52.013539,epoch time: 0:24:26.076027,used: 0:24:26.076027,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863191
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97775036, 'precision': 0.84507406, 'recall': 0.7862451, 'specificity': 0.7862451, 'f1': 0.81268096, 'auroc': 0.9794861, 'binary_precision': 0.7046205, 'binary_recall': 0.5809524, 'binary_specificity': 0.99153787, 'binary_f1_score': 0.6368382}
confusion matrix:
       0    1
0  41948  358
1    616  854
---- Validation: 
scalar performance:
{'acc': 0.9762133, 'precision': 0.85203135, 'recall': 0.7446674, 'specificity': 0.7446674, 'f1': 0.7878858, 'auroc': 0.9737511, 'binary_precision': 0.72171944, 'binary_recall': 0.496112, 'binary_specificity': 0.9932228, 'binary_f1_score': 0.5880184}
confusion matrix:
       0    1
0  18026  123
1    324  319
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9603707, 'precision': 0.98014414, 'recall': 0.5249042, 'specificity': 0.5249042, 'f1': 0.53731614, 'auroc': 0.9505856, 'binary_precision': 1.0, 'binary_recall': 0.049808428, 'binary_specificity': 1.0, 'binary_f1_score': 0.09489051}
confusion matrix:
      0   1
0  5997   0
1   248  13
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863191.png
better model found
persisted
after epoch: 2,now: 2024-05-26 13:23:06.463133,epoch time: 0:23:14.449594,used: 0:47:40.525621,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863191
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9801261, 'precision': 0.8377036, 'recall': 0.8743124, 'specificity': 0.8743124, 'f1': 0.85497713, 'auroc': 0.9857472, 'binary_precision': 0.6837607, 'binary_recall': 0.76086956, 'binary_specificity': 0.9877553, 'binary_f1_score': 0.7202572}
confusion matrix:
       0     1
0  41786   518
1    352  1120
---- Validation: 
scalar performance:
{'acc': 0.9799915, 'precision': 0.84335196, 'recall': 0.86288196, 'specificity': 0.86288196, 'f1': 0.8528213, 'auroc': 0.98040193, 'binary_precision': 0.69603527, 'binary_recall': 0.7371695, 'binary_specificity': 0.9885944, 'binary_f1_score': 0.7160121}
confusion matrix:
       0    1
0  17942  207
1    169  474
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.970278, 'precision': 0.8995322, 'recall': 0.68032485, 'specificity': 0.68032485, 'f1': 0.74499893, 'auroc': 0.9664123, 'binary_precision': 0.82608694, 'binary_recall': 0.36398467, 'binary_specificity': 0.996665, 'binary_f1_score': 0.5053192}
confusion matrix:
      0   1
0  5977  20
1   166  95
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863191.png
better model found
persisted
after epoch: 3,now: 2024-05-26 13:46:16.942657,epoch time: 0:23:10.479524,used: 1:10:51.005145,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863191
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9798063, 'precision': 0.8229579, 'recall': 0.9229973, 'specificity': 0.9229973, 'f1': 0.865582, 'auroc': 0.98707294, 'binary_precision': 0.65076923, 'binary_recall': 0.8620924, 'binary_specificity': 0.9839022, 'binary_f1_score': 0.7416715}
confusion matrix:
       0     1
0  41623   681
1    203  1269
---- Validation: 
scalar performance:
{'acc': 0.9810558, 'precision': 0.8405457, 'recall': 0.90243584, 'specificity': 0.90243584, 'f1': 0.86865914, 'auroc': 0.9812404, 'binary_precision': 0.6875817, 'binary_recall': 0.81804043, 'binary_specificity': 0.98683125, 'binary_f1_score': 0.7471591}
confusion matrix:
       0    1
0  17910  239
1    117  526
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96756154, 'precision': 0.80913305, 'recall': 0.7485361, 'specificity': 0.7485361, 'f1': 0.77515674, 'auroc': 0.9621111, 'binary_precision': 0.6394231, 'binary_recall': 0.5095785, 'binary_specificity': 0.98749375, 'binary_f1_score': 0.5671642}
confusion matrix:
      0    1
0  5922   75
1   128  133
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863191.png
better model found
persisted
after epoch: 4,now: 2024-05-26 14:09:25.738258,epoch time: 0:23:08.795601,used: 1:33:59.800746,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863191
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98355263, 'precision': 0.93892515, 'recall': 0.78891873, 'specificity': 0.78891873, 'f1': 0.8473786, 'auroc': 0.9908242, 'binary_precision': 0.8922594, 'binary_recall': 0.58027214, 'binary_specificity': 0.9975653, 'binary_f1_score': 0.70321524}
confusion matrix:
       0    1
0  42203  103
1    617  853
---- Validation: 
scalar performance:
{'acc': 0.98212004, 'precision': 0.94332343, 'recall': 0.76647675, 'specificity': 0.76647675, 'f1': 0.83134234, 'auroc': 0.9836351, 'binary_precision': 0.90288717, 'binary_recall': 0.5349922, 'binary_specificity': 0.99796134, 'binary_f1_score': 0.67187506}
confusion matrix:
       0    1
0  18112   37
1    299  344
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.7740087, 'recall': 0.51857346, 'specificity': 0.51857346, 'f1': 0.5254303, 'auroc': 0.9628133, 'binary_precision': 0.5882353, 'binary_recall': 0.038314175, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.07194245}
confusion matrix:
      0   1
0  5990   7
1   251  10
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863191.png
better model found
persisted
after epoch: 5,now: 2024-05-26 14:32:31.437344,epoch time: 0:23:05.699086,used: 1:57:05.499832,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863191
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98755026, 'precision': 0.90849006, 'recall': 0.89749706, 'specificity': 0.89749706, 'f1': 0.9029125, 'auroc': 0.992907, 'binary_precision': 0.8238994, 'binary_recall': 0.80095106, 'binary_specificity': 0.9940431, 'binary_f1_score': 0.8122632}
confusion matrix:
       0     1
0  42052   252
1    293  1179
---- Validation: 
scalar performance:
{'acc': 0.98472756, 'precision': 0.90717417, 'recall': 0.84883267, 'specificity': 0.84883267, 'f1': 0.87556994, 'auroc': 0.98598826, 'binary_precision': 0.82481754, 'binary_recall': 0.7029549, 'binary_specificity': 0.99471045, 'binary_f1_score': 0.75902605}
confusion matrix:
       0    1
0  18053   96
1    191  452
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96340686, 'precision': 0.86176306, 'recall': 0.5887877, 'specificity': 0.5887877, 'f1': 0.6361202, 'auroc': 0.9583943, 'binary_precision': 0.7580645, 'binary_recall': 0.18007663, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.29102167}
confusion matrix:
      0   1
0  5982  15
1   214  47
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863191.png
better model found
persisted
after epoch: 6,now: 2024-05-26 14:55:37.948312,epoch time: 0:23:06.510968,used: 2:20:12.010800,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863191
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9864766, 'precision': 0.95626956, 'recall': 0.8242482, 'specificity': 0.8242482, 'f1': 0.8783087, 'auroc': 0.99412465, 'binary_precision': 0.9245648, 'binary_recall': 0.65034014, 'binary_specificity': 0.9981563, 'binary_f1_score': 0.76357824}
confusion matrix:
       0    1
0  42228   78
1    514  956
---- Validation: 
scalar performance:
{'acc': 0.9837697, 'precision': 0.9517623, 'recall': 0.7875823, 'specificity': 0.7875823, 'f1': 0.8501719, 'auroc': 0.9763447, 'binary_precision': 0.91831684, 'binary_recall': 0.5769829, 'binary_specificity': 0.9981817, 'binary_f1_score': 0.7086915}
confusion matrix:
       0    1
0  18116   33
1    272  371
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96196866, 'precision': 0.8956452, 'recall': 0.5550553, 'specificity': 0.5550553, 'f1': 0.58823484, 'auroc': 0.9530009, 'binary_precision': 0.82857144, 'binary_recall': 0.11111111, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.19594595}
confusion matrix:
      0   1
0  5991   6
1   232  29
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863191.png
early stop counter: 1
val acc:0.9837697148323059, best validation acc: 0.9847275614738464, corresponding to test acc:                         0.9634068608283997 / 0.9737935662269592
after epoch: 7,now: 2024-05-26 15:18:49.115800,epoch time: 0:23:11.167488,used: 2:43:23.178288,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863191
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9881899, 'precision': 0.93409395, 'recall': 0.87536716, 'specificity': 0.87536716, 'f1': 0.90243673, 'auroc': 0.99526006, 'binary_precision': 0.87667984, 'binary_recall': 0.7544218, 'binary_specificity': 0.99631256, 'binary_f1_score': 0.81096894}
confusion matrix:
       0     1
0  42150   156
1    361  1109
---- Validation: 
scalar performance:
{'acc': 0.98361003, 'precision': 0.9066576, 'recall': 0.8280027, 'specificity': 0.8280027, 'f1': 0.8627843, 'auroc': 0.9794291, 'binary_precision': 0.8252427, 'binary_recall': 0.66096425, 'binary_specificity': 0.9950411, 'binary_f1_score': 0.73402417}
confusion matrix:
       0    1
0  18059   90
1    218  425
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608501, 'precision': 0.79867697, 'recall': 0.57096267, 'specificity': 0.57096267, 'f1': 0.60833496, 'auroc': 0.9443895, 'binary_precision': 0.6333333, 'binary_recall': 0.14559387, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.23676012}
confusion matrix:
      0   1
0  5975  22
1   223  38
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863191.png
early stop counter: 2
val acc:0.9836100339889526, best validation acc: 0.9847275614738464, corresponding to test acc:                         0.9634068608283997 / 0.9737935662269592
after epoch: 8,now: 2024-05-26 15:41:59.966941,epoch time: 0:23:10.851141,used: 3:06:34.029429,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863191
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98382676, 'precision': 0.9772435, 'recall': 0.76722145, 'specificity': 0.76722145, 'f1': 0.8407214, 'auroc': 0.9951377, 'binary_precision': 0.9704069, 'binary_recall': 0.5350102, 'binary_specificity': 0.9994327, 'binary_f1_score': 0.68974584}
confusion matrix:
       0    1
0  42281   24
1    684  787
---- Validation: 
scalar performance:
{'acc': 0.9798318, 'precision': 0.95739627, 'recall': 0.7202888, 'specificity': 0.7202888, 'f1': 0.7947221, 'auroc': 0.98119414, 'binary_precision': 0.93421054, 'binary_recall': 0.44167963, 'binary_specificity': 0.998898, 'binary_f1_score': 0.59978884}
confusion matrix:
       0    1
0  18129   20
1    359  284
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.97922325, 'recall': 0.5019157, 'specificity': 0.5019157, 'f1': 0.49320802, 'auroc': 0.93663514, 'binary_precision': 1.0, 'binary_recall': 0.0038314175, 'binary_specificity': 1.0, 'binary_f1_score': 0.007633588}
confusion matrix:
      0  1
0  5997  0
1   260  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863191.png
early stop counter: 3
val acc:0.9798318147659302, best validation acc: 0.9847275614738464, corresponding to test acc:                         0.9634068608283997 / 0.9737935662269592
after epoch: 9,now: 2024-05-26 16:05:11.429418,epoch time: 0:23:11.462477,used: 3:29:45.491906,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863191
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9914108, 'precision': 0.93220353, 'recall': 0.9361725, 'specificity': 0.9361725, 'f1': 0.93417823, 'auroc': 0.9962487, 'binary_precision': 0.86868685, 'binary_recall': 0.87695444, 'binary_specificity': 0.9953906, 'binary_f1_score': 0.8728011}
confusion matrix:
       0     1
0  42110   195
1    181  1290
---- Validation: 
scalar performance:
{'acc': 0.9871754, 'precision': 0.9268844, 'recall': 0.86960137, 'specificity': 0.86960137, 'f1': 0.89602005, 'auroc': 0.98296446, 'binary_precision': 0.86281586, 'binary_recall': 0.7433904, 'binary_specificity': 0.9958124, 'binary_f1_score': 0.7986633}
confusion matrix:
       0    1
0  18073   76
1    165  478
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.971876, 'precision': 0.8886118, 'recall': 0.7141406, 'specificity': 0.7141406, 'f1': 0.7738302, 'auroc': 0.95175654, 'binary_precision': 0.8014184, 'binary_recall': 0.4329502, 'binary_specificity': 0.995331, 'binary_f1_score': 0.56218904}
confusion matrix:
      0    1
0  5969   28
1   148  113
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863191.png
better model found
persisted
after epoch: 10,now: 2024-05-26 16:28:27.015025,epoch time: 0:23:15.585607,used: 3:53:01.077513,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863191
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99125093, 'precision': 0.94002616, 'recall': 0.92296636, 'specificity': 0.92296636, 'f1': 0.9313144, 'auroc': 0.9967129, 'binary_precision': 0.8852691, 'binary_recall': 0.8497621, 'binary_specificity': 0.99617064, 'binary_f1_score': 0.86715233}
confusion matrix:
       0     1
0  42143   162
1    221  1250
---- Validation: 
scalar performance:
{'acc': 0.9860579, 'precision': 0.91392064, 'recall': 0.8652726, 'specificity': 0.8652726, 'f1': 0.88795495, 'auroc': 0.9806078, 'binary_precision': 0.83716816, 'binary_recall': 0.7356143, 'binary_specificity': 0.99493086, 'binary_f1_score': 0.7831125}
confusion matrix:
       0    1
0  18057   92
1    170  473
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9651646, 'precision': 0.8499385, 'recall': 0.62818384, 'specificity': 0.62818384, 'f1': 0.6831281, 'auroc': 0.9551703, 'binary_precision': 0.7311828, 'binary_recall': 0.2605364, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.38418078}
confusion matrix:
      0   1
0  5972  25
1   193  68
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863191.png
early stop counter: 1
val acc:0.9860578775405884, best validation acc: 0.9871754050254822, corresponding to test acc:                         0.9718760251998901 / 0.9737935662269592
after epoch: 11,now: 2024-05-26 16:51:47.880694,epoch time: 0:23:20.865669,used: 4:16:21.943182,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863191
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9928043, 'precision': 0.97982824, 'recall': 0.9065833, 'specificity': 0.9065833, 'f1': 0.9399612, 'auroc': 0.9980165, 'binary_precision': 0.9660743, 'binary_recall': 0.8141593, 'binary_specificity': 0.9990073, 'binary_f1_score': 0.883635}
confusion matrix:
       0     1
0  42265    42
1    273  1196
---- Validation: 
scalar performance:
{'acc': 0.98408896, 'precision': 0.950547, 'recall': 0.793748, 'specificity': 0.793748, 'f1': 0.85446906, 'auroc': 0.98052615, 'binary_precision': 0.9154589, 'binary_recall': 0.58942455, 'binary_specificity': 0.9980715, 'binary_f1_score': 0.71712387}
confusion matrix:
       0    1
0  18114   35
1    264  379
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.87642366, 'recall': 0.5359816, 'specificity': 0.5359816, 'f1': 0.55656934, 'auroc': 0.94651186, 'binary_precision': 0.7916667, 'binary_recall': 0.07279693, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.13333333}
confusion matrix:
      0   1
0  5992   5
1   242  19
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863191.png
early stop counter: 2
val acc:0.9840889573097229, best validation acc: 0.9871754050254822, corresponding to test acc:                         0.9718760251998901 / 0.9737935662269592
after epoch: 12,now: 2024-05-26 17:15:21.062026,epoch time: 0:23:33.181332,used: 4:39:55.124514,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863191
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9891036, 'precision': 0.972146, 'recall': 0.8542697, 'specificity': 0.8542697, 'f1': 0.9042112, 'auroc': 0.99694234, 'binary_precision': 0.9542962, 'binary_recall': 0.70972127, 'binary_specificity': 0.9988181, 'binary_f1_score': 0.8140351}
confusion matrix:
       0     1
0  42255    50
1    427  1044
---- Validation: 
scalar performance:
{'acc': 0.9823861, 'precision': 0.9316762, 'recall': 0.7801155, 'specificity': 0.7801155, 'f1': 0.8385973, 'auroc': 0.98310316, 'binary_precision': 0.8786408, 'binary_recall': 0.562986, 'binary_specificity': 0.997245, 'binary_f1_score': 0.68625593}
confusion matrix:
       0    1
0  18099   50
1    281  362
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589326, 'precision': 0.76374435, 'recall': 0.5314832, 'specificity': 0.5314832, 'f1': 0.547908, 'auroc': 0.95710325, 'binary_precision': 0.56666666, 'binary_recall': 0.0651341, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.116838485}
confusion matrix:
      0   1
0  5984  13
1   244  17
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863191.png
early stop counter: 3
val acc:0.9823861122131348, best validation acc: 0.9871754050254822, corresponding to test acc:                         0.9718760251998901 / 0.9737935662269592
after epoch: 13,now: 2024-05-26 17:38:55.514131,epoch time: 0:23:34.452105,used: 5:03:29.576619,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863191
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9923017, 'precision': 0.9434027, 'recall': 0.93728966, 'specificity': 0.93728966, 'f1': 0.9403233, 'auroc': 0.9975507, 'binary_precision': 0.8910345, 'binary_recall': 0.8783141, 'binary_specificity': 0.99626523, 'binary_f1_score': 0.88462853}
confusion matrix:
       0     1
0  42147   158
1    179  1292
---- Validation: 
scalar performance:
{'acc': 0.98632395, 'precision': 0.91825, 'recall': 0.86466026, 'specificity': 0.86466026, 'f1': 0.889474, 'auroc': 0.9775488, 'binary_precision': 0.8458781, 'binary_recall': 0.7340591, 'binary_specificity': 0.99526143, 'binary_f1_score': 0.78601164}
confusion matrix:
       0    1
0  18063   86
1    171  472
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614893, 'precision': 0.8245397, 'recall': 0.56946385, 'specificity': 0.56946385, 'f1': 0.60758406, 'auroc': 0.9384269, 'binary_precision': 0.6851852, 'binary_recall': 0.14176245, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.23492064}
confusion matrix:
      0   1
0  5980  17
1   224  37
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863191.png
early stop counter: 4
val acc:0.9863239526748657, best validation acc: 0.9871754050254822, corresponding to test acc:                         0.9718760251998901 / 0.9737935662269592
after epoch: 14,now: 2024-05-26 18:02:28.512386,epoch time: 0:23:32.998255,used: 5:27:02.574874,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863191
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99241596, 'precision': 0.93558514, 'recall': 0.94984853, 'specificity': 0.94984853, 'f1': 0.9425926, 'auroc': 0.99789935, 'binary_precision': 0.87450725, 'binary_recall': 0.90421194, 'binary_specificity': 0.99548507, 'binary_f1_score': 0.8891116}
confusion matrix:
       0     1
0  42113   191
1    141  1331
---- Validation: 
scalar performance:
{'acc': 0.98515326, 'precision': 0.8977219, 'recall': 0.87080467, 'specificity': 0.87080467, 'f1': 0.8837522, 'auroc': 0.9798588, 'binary_precision': 0.8043478, 'binary_recall': 0.748056, 'binary_specificity': 0.99355334, 'binary_f1_score': 0.7751813}
confusion matrix:
       0    1
0  18032  117
1    162  481
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.957814, 'precision': 0.7198922, 'recall': 0.55655223, 'specificity': 0.55655223, 'f1': 0.5842635, 'auroc': 0.9311367, 'binary_precision': 0.47692308, 'binary_recall': 0.118773945, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.19018404}
confusion matrix:
      0   1
0  5963  34
1   230  31
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863191.png
early stop counter: 5
val acc:0.9851532578468323, best validation acc: 0.9871754050254822, corresponding to test acc:                         0.9718760251998901 / 0.9737935662269592
after epoch: 15,now: 2024-05-26 18:25:58.505886,epoch time: 0:23:29.993500,used: 5:50:32.568374,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863191
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9939693, 'precision': 0.97367376, 'recall': 0.9312626, 'specificity': 0.9312626, 'f1': 0.95140034, 'auroc': 0.9989405, 'binary_precision': 0.9520599, 'binary_recall': 0.86403805, 'binary_specificity': 0.9984872, 'binary_f1_score': 0.90591586}
confusion matrix:
       0     1
0  42241    64
1    200  1271
---- Validation: 
scalar performance:
{'acc': 0.98621756, 'precision': 0.9466904, 'recall': 0.83235276, 'specificity': 0.83235276, 'f1': 0.8805133, 'auroc': 0.98179203, 'binary_precision': 0.9050633, 'binary_recall': 0.66718507, 'binary_specificity': 0.9975205, 'binary_f1_score': 0.76812893}
confusion matrix:
       0    1
0  18104   45
1    214  429
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.8136451, 'recall': 0.616106, 'specificity': 0.616106, 'f1': 0.6651503, 'auroc': 0.9293916, 'binary_precision': 0.65957445, 'binary_recall': 0.23754789, 'binary_specificity': 0.994664, 'binary_f1_score': 0.3492958}
confusion matrix:
      0   1
0  5965  32
1   199  62
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863191.png
early stop counter: 6
val acc:0.9862175583839417, best validation acc: 0.9871754050254822, corresponding to test acc:                         0.9718760251998901 / 0.9737935662269592
after epoch: 16,now: 2024-05-26 18:49:32.582995,epoch time: 0:23:34.077109,used: 6:14:06.645483,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863191
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9940378, 'precision': 0.94194955, 'recall': 0.9700122, 'specificity': 0.9700122, 'f1': 0.9555141, 'auroc': 0.998572, 'binary_precision': 0.88584185, 'binary_recall': 0.9442556, 'binary_specificity': 0.99576885, 'binary_f1_score': 0.9141165}
confusion matrix:
       0     1
0  42126   179
1     82  1389
---- Validation: 
scalar performance:
{'acc': 0.9867497, 'precision': 0.91723895, 'recall': 0.87388134, 'specificity': 0.87388134, 'f1': 0.8942758, 'auroc': 0.977762, 'binary_precision': 0.8432056, 'binary_recall': 0.7527216, 'binary_specificity': 0.9950411, 'binary_f1_score': 0.7953985}
confusion matrix:
       0    1
0  18059   90
1    159  484
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96180886, 'precision': 0.84187824, 'recall': 0.56779826, 'specificity': 0.56779826, 'f1': 0.6059646, 'auroc': 0.94824886, 'binary_precision': 0.72, 'binary_recall': 0.13793103, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.23151125}
confusion matrix:
      0   1
0  5983  14
1   225  36
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863191.png
early stop counter: 7
val acc:0.9867497086524963, best validation acc: 0.9871754050254822, corresponding to test acc:                         0.9718760251998901 / 0.9737935662269592
after epoch: 17,now: 2024-05-26 19:13:06.688251,epoch time: 0:23:34.105256,used: 6:37:40.750739,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863191
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9944947, 'precision': 0.94940287, 'recall': 0.967952, 'specificity': 0.967952, 'f1': 0.95847493, 'auroc': 0.99886143, 'binary_precision': 0.90091264, 'binary_recall': 0.93949693, 'binary_specificity': 0.99640703, 'binary_f1_score': 0.91980034}
confusion matrix:
       0     1
0  42153   152
1     89  1382
---- Validation: 
scalar performance:
{'acc': 0.98616433, 'precision': 0.9142622, 'recall': 0.8668278, 'specificity': 0.8668278, 'f1': 0.88898796, 'auroc': 0.9802122, 'binary_precision': 0.8377425, 'binary_recall': 0.7387247, 'binary_specificity': 0.99493086, 'binary_f1_score': 0.7851239}
confusion matrix:
       0    1
0  18057   92
1    168  475
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96324706, 'precision': 0.8421838, 'recall': 0.59603363, 'specificity': 0.59603363, 'f1': 0.6441759, 'auroc': 0.93690026, 'binary_precision': 0.7183099, 'binary_recall': 0.1954023, 'binary_specificity': 0.996665, 'binary_f1_score': 0.30722892}
confusion matrix:
      0   1
0  5977  20
1   210  51
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863191.png
early stop counter: 8
val acc:0.9861643314361572, best validation acc: 0.9871754050254822, corresponding to test acc:                         0.9718760251998901 / 0.9737935662269592
after epoch: 18,now: 2024-05-26 19:36:40.862529,epoch time: 0:23:34.174278,used: 7:01:14.925017,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863191
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99348956, 'precision': 0.9280876, 'recall': 0.9808945, 'specificity': 0.9808945, 'f1': 0.9528284, 'auroc': 0.9982401, 'binary_precision': 0.8573149, 'binary_recall': 0.9673913, 'binary_specificity': 0.9943977, 'binary_f1_score': 0.90903294}
confusion matrix:
       0     1
0  42067   237
1     48  1424
---- Validation: 
scalar performance:
{'acc': 0.9865368, 'precision': 0.9039428, 'recall': 0.88877225, 'specificity': 0.88877225, 'f1': 0.8962002, 'auroc': 0.98069775, 'binary_precision': 0.815534, 'binary_recall': 0.7838258, 'binary_specificity': 0.9937187, 'binary_f1_score': 0.7993656}
confusion matrix:
       0    1
0  18035  114
1    139  504
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96644294, 'precision': 0.83488715, 'recall': 0.66916215, 'specificity': 0.66916215, 'f1': 0.72211015, 'auroc': 0.9444792, 'binary_precision': 0.6976744, 'binary_recall': 0.3448276, 'binary_specificity': 0.9934968, 'binary_f1_score': 0.4615385}
confusion matrix:
      0   1
0  5958  39
1   171  90
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863191.png
early stop counter: 9
val acc:0.9865368008613586, best validation acc: 0.9871754050254822, corresponding to test acc:                         0.9718760251998901 / 0.9737935662269592
after epoch: 19,now: 2024-05-26 20:00:13.162728,epoch time: 0:23:32.300199,used: 7:24:47.225216,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863191
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99358094, 'precision': 0.9761696, 'recall': 0.9224793, 'specificity': 0.9224793, 'f1': 0.9476025, 'auroc': 0.9982449, 'binary_precision': 0.9576597, 'binary_recall': 0.8462585, 'binary_specificity': 0.99869996, 'binary_f1_score': 0.89851934}
confusion matrix:
       0     1
0  42251    55
1    226  1244
---- Validation: 
scalar performance:
{'acc': 0.9852597, 'precision': 0.9486978, 'recall': 0.8146056, 'specificity': 0.8146056, 'f1': 0.86902404, 'auroc': 0.9824936, 'binary_precision': 0.9103139, 'binary_recall': 0.63141525, 'binary_specificity': 0.997796, 'binary_f1_score': 0.74563813}
confusion matrix:
       0    1
0  18109   40
1    237  406
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.76272094, 'recall': 0.52407044, 'specificity': 0.52407044, 'f1': 0.53522855, 'auroc': 0.9331232, 'binary_precision': 0.5652174, 'binary_recall': 0.049808428, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.09154929}
confusion matrix:
      0   1
0  5987  10
1   248  13
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863191.png
early stop counter: 10
val acc:0.9852597117424011, best validation acc: 0.9871754050254822, corresponding to test acc:                         0.9718760251998901 / 0.9737935662269592
after epoch: 20,now: 2024-05-26 20:23:45.778751,epoch time: 0:23:32.616023,used: 7:48:19.841239,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863191
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99410635, 'precision': 0.937906, 'recall': 0.9769094, 'specificity': 0.9769094, 'f1': 0.95650816, 'auroc': 0.99894583, 'binary_precision': 0.87725854, 'binary_recall': 0.9584752, 'binary_specificity': 0.99534357, 'binary_f1_score': 0.9160703}
confusion matrix:
       0     1
0  42110   197
1     61  1408
---- Validation: 
scalar performance:
{'acc': 0.98589826, 'precision': 0.8975344, 'recall': 0.8861915, 'specificity': 0.8861915, 'f1': 0.8917738, 'auroc': 0.9814745, 'binary_precision': 0.80288464, 'binary_recall': 0.7791602, 'binary_specificity': 0.9932228, 'binary_f1_score': 0.79084456}
confusion matrix:
       0    1
0  18026  123
1    142  501
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.82817894, 'recall': 0.53006774, 'specificity': 0.53006774, 'f1': 0.5460372, 'auroc': 0.9424887, 'binary_precision': 0.6956522, 'binary_recall': 0.06130268, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.112676054}
confusion matrix:
      0   1
0  5990   7
1   245  16
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863191.png
early stop counter: 11
val acc:0.9858982563018799, best validation acc: 0.9871754050254822, corresponding to test acc:                         0.9718760251998901 / 0.9737935662269592
after epoch: 21,now: 2024-05-26 20:47:14.596657,epoch time: 0:23:28.817906,used: 8:11:48.659145,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863191
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99038285, 'precision': 0.8958889, 'recall': 0.97861993, 'specificity': 0.97861993, 'f1': 0.9329915, 'auroc': 0.99872625, 'binary_precision': 0.79296875, 'binary_recall': 0.9660095, 'binary_specificity': 0.99123037, 'binary_f1_score': 0.87097764}
confusion matrix:
       0     1
0  41934   371
1     50  1421
---- Validation: 
scalar performance:
{'acc': 0.9830779, 'precision': 0.8568716, 'recall': 0.90798306, 'specificity': 0.90798306, 'f1': 0.8805574, 'auroc': 0.9812621, 'binary_precision': 0.7198917, 'binary_recall': 0.8273717, 'binary_specificity': 0.9885944, 'binary_f1_score': 0.7698988}
confusion matrix:
       0    1
0  17942  207
1    111  532
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96292746, 'precision': 0.84426093, 'recall': 0.5885376, 'specificity': 0.5885376, 'f1': 0.6346558, 'auroc': 0.95050895, 'binary_precision': 0.72307694, 'binary_recall': 0.18007663, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.28834355}
confusion matrix:
      0   1
0  5979  18
1   214  47
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863191.png
early stop counter: 12
val acc:0.983077883720398, best validation acc: 0.9871754050254822, corresponding to test acc:                         0.9718760251998901 / 0.9737935662269592
after epoch: 22,now: 2024-05-26 21:10:42.083261,epoch time: 0:23:27.486604,used: 8:35:16.145749,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863191
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99671054, 'precision': 0.9823289, 'recall': 0.9664961, 'specificity': 0.9664961, 'f1': 0.97427046, 'auroc': 0.99951637, 'binary_precision': 0.966948, 'binary_recall': 0.93410325, 'binary_specificity': 0.99888897, 'binary_f1_score': 0.95024186}
confusion matrix:
       0     1
0  42257    47
1     97  1375
---- Validation: 
scalar performance:
{'acc': 0.98547256, 'precision': 0.9251389, 'recall': 0.8409678, 'specificity': 0.8409678, 'f1': 0.8780712, 'auroc': 0.98532134, 'binary_precision': 0.8613281, 'binary_recall': 0.6858476, 'binary_specificity': 0.99608797, 'binary_f1_score': 0.76363635}
confusion matrix:
       0    1
0  18078   71
1    202  441
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9638862, 'precision': 0.89760846, 'recall': 0.5835408, 'specificity': 0.5835408, 'f1': 0.63086665, 'auroc': 0.944705, 'binary_precision': 0.8301887, 'binary_recall': 0.16858238, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.28025478}
confusion matrix:
      0   1
0  5988   9
1   217  44
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863191.png
early stop counter: 13
val acc:0.985472559928894, best validation acc: 0.9871754050254822, corresponding to test acc:                         0.9718760251998901 / 0.9737935662269592
after epoch: 23,now: 2024-05-26 21:34:11.270696,epoch time: 0:23:29.187435,used: 8:58:45.333184,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863191
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99312407, 'precision': 0.92679596, 'recall': 0.97611547, 'specificity': 0.97611547, 'f1': 0.94999576, 'auroc': 0.9991203, 'binary_precision': 0.8550637, 'binary_recall': 0.95788044, 'binary_specificity': 0.99435043, 'binary_f1_score': 0.9035565}
confusion matrix:
       0     1
0  42065   239
1     62  1410
---- Validation: 
scalar performance:
{'acc': 0.9848872, 'precision': 0.8934591, 'recall': 0.872167, 'specificity': 0.872167, 'f1': 0.8824918, 'auroc': 0.9784187, 'binary_precision': 0.79571664, 'binary_recall': 0.7511664, 'binary_specificity': 0.99316764, 'binary_f1_score': 0.77279997}
confusion matrix:
       0    1
0  18025  124
1    160  483
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650048, 'precision': 0.8561338, 'recall': 0.6207711, 'specificity': 0.6207711, 'f1': 0.6754398, 'auroc': 0.94020426, 'binary_precision': 0.74418604, 'binary_recall': 0.24521072, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.36887607}
confusion matrix:
      0   1
0  5975  22
1   197  64
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863191.png
early stop counter: 14
val acc:0.9848871827125549, best validation acc: 0.9871754050254822, corresponding to test acc:                         0.9718760251998901 / 0.9737935662269592
after epoch: 24,now: 2024-05-26 21:57:45.206222,epoch time: 0:23:33.935526,used: 9:22:19.268710,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863191
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9943119, 'precision': 0.98864126, 'recall': 0.92258155, 'specificity': 0.92258155, 'f1': 0.95304435, 'auroc': 0.9993929, 'binary_precision': 0.98262244, 'binary_recall': 0.8456832, 'binary_specificity': 0.99947995, 'binary_f1_score': 0.9090245}
confusion matrix:
       0     1
0  42283    22
1    227  1244
---- Validation: 
scalar performance:
{'acc': 0.98286504, 'precision': 0.9314734, 'recall': 0.78861403, 'specificity': 0.78861403, 'f1': 0.84484196, 'auroc': 0.978988, 'binary_precision': 0.87764704, 'binary_recall': 0.5800933, 'binary_specificity': 0.9971348, 'binary_f1_score': 0.6985019}
confusion matrix:
       0    1
0  18097   52
1    270  373
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9613295, 'precision': 0.8947692, 'recall': 0.5455601, 'specificity': 0.5455601, 'f1': 0.5728617, 'auroc': 0.9467913, 'binary_precision': 0.82758623, 'binary_recall': 0.09195402, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.16551723}
confusion matrix:
      0   1
0  5992   5
1   237  24
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863191.png
early stop counter: 15
val acc:0.982865035533905, best validation acc: 0.9871754050254822, corresponding to test acc:                         0.9718760251998901 / 0.9737935662269592
after epoch: 25,now: 2024-05-26 22:21:16.518617,epoch time: 0:23:31.312395,used: 9:45:50.581105,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863191
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99593383, 'precision': 0.96865547, 'recall': 0.96865547, 'specificity': 0.96865547, 'f1': 0.96865547, 'auroc': 0.99938476, 'binary_precision': 0.93941456, 'binary_recall': 0.93941456, 'binary_specificity': 0.9978963, 'binary_f1_score': 0.93941456}
confusion matrix:
       0     1
0  42218    89
1     89  1380
---- Validation: 
scalar performance:
{'acc': 0.9861111, 'precision': 0.91640306, 'recall': 0.86305, 'specificity': 0.86305, 'f1': 0.8877537, 'auroc': 0.98333216, 'binary_precision': 0.8422939, 'binary_recall': 0.7309487, 'binary_specificity': 0.9951512, 'binary_f1_score': 0.7826811}
confusion matrix:
       0    1
0  18061   88
1    173  470
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9693193, 'precision': 0.88882244, 'recall': 0.67249525, 'specificity': 0.67249525, 'f1': 0.7354091, 'auroc': 0.9494679, 'binary_precision': 0.8053097, 'binary_recall': 0.348659, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.48663104}
confusion matrix:
      0   1
0  5975  22
1   170  91
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863191.png
early stop counter: 16
val acc:0.9861111044883728, best validation acc: 0.9871754050254822, corresponding to test acc:                         0.9718760251998901 / 0.9737935662269592
after epoch: 26,now: 2024-05-26 22:44:51.953839,epoch time: 0:23:35.435222,used: 10:09:26.016327,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863191
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99744153, 'precision': 0.995515, 'recall': 0.9648596, 'specificity': 0.9648596, 'f1': 0.9796622, 'auroc': 0.9997536, 'binary_precision': 0.9934593, 'binary_recall': 0.929932, 'binary_specificity': 0.9997873, 'binary_f1_score': 0.9606465}
confusion matrix:
       0     1
0  42297     9
1    103  1367
---- Validation: 
scalar performance:
{'acc': 0.98573864, 'precision': 0.95160127, 'recall': 0.820104, 'specificity': 0.820104, 'f1': 0.8738415, 'auroc': 0.98568493, 'binary_precision': 0.9157428, 'binary_recall': 0.64230174, 'binary_specificity': 0.9979062, 'binary_f1_score': 0.7550275}
confusion matrix:
       0    1
0  18111   38
1    230  413
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9603707, 'precision': 0.8188698, 'recall': 0.5468922, 'specificity': 0.5468922, 'f1': 0.5737437, 'auroc': 0.95221317, 'binary_precision': 0.6756757, 'binary_recall': 0.09578544, 'binary_specificity': 0.997999, 'binary_f1_score': 0.16778523}
confusion matrix:
      0   1
0  5985  12
1   236  25
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863191.png
early stop counter: 17
val acc:0.9857386350631714, best validation acc: 0.9871754050254822, corresponding to test acc:                         0.9718760251998901 / 0.9737935662269592
after epoch: 27,now: 2024-05-26 23:08:27.609085,epoch time: 0:23:35.655246,used: 10:33:01.671573,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863191
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9958882, 'precision': 0.9724194, 'recall': 0.96372765, 'specificity': 0.96372765, 'f1': 0.9680301, 'auroc': 0.99928415, 'binary_precision': 0.9472954, 'binary_recall': 0.92925173, 'binary_specificity': 0.9982036, 'binary_f1_score': 0.9381868}
confusion matrix:
       0     1
0  42230    76
1    104  1366
---- Validation: 
scalar performance:
{'acc': 0.9853661, 'precision': 0.9372443, 'recall': 0.8266616, 'specificity': 0.8266616, 'f1': 0.8733517, 'auroc': 0.97521806, 'binary_precision': 0.8865546, 'binary_recall': 0.6562986, 'binary_specificity': 0.99702466, 'binary_f1_score': 0.75424486}
confusion matrix:
       0    1
0  18095   54
1    221  422
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9637264, 'precision': 0.8481281, 'recall': 0.6017808, 'specificity': 0.6017808, 'f1': 0.6518763, 'auroc': 0.9367968, 'binary_precision': 0.7297297, 'binary_recall': 0.20689656, 'binary_specificity': 0.996665, 'binary_f1_score': 0.32238808}
confusion matrix:
      0   1
0  5977  20
1   207  54
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863191.png
early stop counter: 18
val acc:0.9853661060333252, best validation acc: 0.9871754050254822, corresponding to test acc:                         0.9718760251998901 / 0.9737935662269592
after epoch: 28,now: 2024-05-26 23:32:02.115646,epoch time: 0:23:34.506561,used: 10:56:36.178134,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863191
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9958882, 'precision': 0.98679626, 'recall': 0.9490222, 'specificity': 0.9490222, 'f1': 0.9670906, 'auroc': 0.99953985, 'binary_precision': 0.9771049, 'binary_recall': 0.8987772, 'binary_specificity': 0.9992672, 'binary_f1_score': 0.9363057}
confusion matrix:
       0     1
0  42273    31
1    149  1323
---- Validation: 
scalar performance:
{'acc': 0.98408896, 'precision': 0.95352256, 'recall': 0.7914979, 'specificity': 0.7914979, 'f1': 0.8536623, 'auroc': 0.97899354, 'binary_precision': 0.92156863, 'binary_recall': 0.58475894, 'binary_specificity': 0.99823684, 'binary_f1_score': 0.715509}
confusion matrix:
       0    1
0  18117   32
1    267  376
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.88960725, 'recall': 0.5341493, 'specificity': 0.5341493, 'f1': 0.5535086, 'auroc': 0.9138562, 'binary_precision': 0.8181818, 'binary_recall': 0.06896552, 'binary_specificity': 0.999333, 'binary_f1_score': 0.12720849}
confusion matrix:
      0   1
0  5993   4
1   243  18
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863191.png
early stop counter: 19
val acc:0.9840889573097229, best validation acc: 0.9871754050254822, corresponding to test acc:                         0.9718760251998901 / 0.9737935662269592
after epoch: 29,now: 2024-05-26 23:55:32.365563,epoch time: 0:23:30.249917,used: 11:20:06.428051,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863191
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9968019, 'precision': 0.9721757, 'recall': 0.9789883, 'specificity': 0.9789883, 'f1': 0.9755558, 'auroc': 0.9995835, 'binary_precision': 0.94574684, 'binary_recall': 0.95989126, 'binary_specificity': 0.9980853, 'binary_f1_score': 0.9527666}
confusion matrix:
       0     1
0  42224    81
1     59  1412
---- Validation: 
scalar performance:
{'acc': 0.9883461, 'precision': 0.9404963, 'recall': 0.8747078, 'specificity': 0.8747078, 'f1': 0.9047421, 'auroc': 0.980317, 'binary_precision': 0.8897059, 'binary_recall': 0.7527216, 'binary_specificity': 0.996694, 'binary_f1_score': 0.81550133}
confusion matrix:
       0    1
0  18089   60
1    159  484
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9653244, 'precision': 0.9000323, 'recall': 0.6044468, 'specificity': 0.6044468, 'f1': 0.65929425, 'auroc': 0.94527936, 'binary_precision': 0.8333333, 'binary_recall': 0.21072797, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.33639142}
confusion matrix:
      0   1
0  5986  11
1   206  55
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863191.png
better model found
persisted
after epoch: 30,now: 2024-05-27 00:19:04.795154,epoch time: 0:23:32.429591,used: 11:43:38.857642,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863191
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 11:43:38.857642 at 2024-05-27 00:19:04.795154
persisted model performance metric: 

scalar performance:
{'acc': 0.96628314, 'precision': 0.9417151, 'recall': 0.6049471, 'specificity': 0.6049471, 'f1': 0.6626885, 'auroc': 0.9421989, 'binary_precision': 0.9166667, 'binary_recall': 0.21072797, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.34267914}
confusion matrix:
      0   1
0  5992   5
1   206  55
oracle model performance metric: 

scalar performance:
{'acc': 0.9752317, 'precision': 0.9662373, 'recall': 0.7122268, 'specificity': 0.7122268, 'f1': 0.78804535, 'auroc': 0.9556825, 'binary_precision': 0.95689654, 'binary_recall': 0.42528737, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.58885944}
confusion matrix:
      0    1
0  5992    5
1   150  111
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs32/rule_results/4.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs32/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs32/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1657 MiB |   5045 MiB |    827 TiB |    827 TiB |
|       from large pool |   1652 MiB |   5036 MiB |    822 TiB |    822 TiB |
|       from small pool |      5 MiB |     10 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1657 MiB |   5045 MiB |    827 TiB |    827 TiB |
|       from large pool |   1652 MiB |   5036 MiB |    822 TiB |    822 TiB |
|       from small pool |      5 MiB |     10 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1653 MiB |   5033 MiB |    825 TiB |    825 TiB |
|       from large pool |   1647 MiB |   5024 MiB |    819 TiB |    819 TiB |
|       from small pool |      5 MiB |     10 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   5446 MiB |   5446 MiB |   5446 MiB |      0 B   |
|       from large pool |   5434 MiB |   5434 MiB |   5434 MiB |      0 B   |
|       from small pool |     12 MiB |     12 MiB |     12 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 243722 KiB | 443556 KiB | 203780 GiB | 203779 GiB |
|       from large pool | 239584 KiB | 441760 KiB | 197440 GiB | 197439 GiB |
|       from small pool |   4138 KiB |   5691 KiB |   6340 GiB |   6340 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2190    |    3599    |   70430 K  |   70427 K  |
|       from large pool |     247    |     352    |   27255 K  |   27255 K  |
|       from small pool |    1943    |    3351    |   43174 K  |   43172 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2190    |    3599    |   70430 K  |   70427 K  |
|       from large pool |     247    |     352    |   27255 K  |   27255 K  |
|       from small pool |    1943    |    3351    |   43174 K  |   43172 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     159    |     159    |     159    |       0    |
|       from large pool |     153    |     153    |     153    |       0    |
|       from small pool |       6    |       6    |       6    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     105    |    1463    |   33569 K  |   33569 K  |
|       from large pool |      86    |     113    |   15739 K  |   15739 K  |
|       from small pool |      19    |    1377    |   17830 K  |   17830 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   5045 MiB |    827 TiB |    827 TiB |
|       from large pool |  16640 KiB |   5036 MiB |    822 TiB |    822 TiB |
|       from small pool |      0 KiB |     10 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   5045 MiB |    827 TiB |    827 TiB |
|       from large pool |  16640 KiB |   5036 MiB |    822 TiB |    822 TiB |
|       from small pool |      0 KiB |     10 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   5033 MiB |    825 TiB |    825 TiB |
|       from large pool |  16640 KiB |   5024 MiB |    819 TiB |    819 TiB |
|       from small pool |      0 KiB |     10 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1896 MiB |   5446 MiB |   5446 MiB |   3550 MiB |
|       from large pool |   1886 MiB |   5434 MiB |   5434 MiB |   3548 MiB |
|       from small pool |     10 MiB |     12 MiB |     12 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 443556 KiB | 203781 GiB | 203781 GiB |
|       from large pool |  24320 KiB | 441760 KiB | 197441 GiB | 197441 GiB |
|       from small pool |      0 KiB |   9631 KiB |   6340 GiB |   6340 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3599    |   70430 K  |   70430 K  |
|       from large pool |       2    |     352    |   27255 K  |   27255 K  |
|       from small pool |       0    |    3351    |   43174 K  |   43174 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3599    |   70430 K  |   70430 K  |
|       from large pool |       2    |     352    |   27255 K  |   27255 K  |
|       from small pool |       0    |    3351    |   43174 K  |   43174 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      92    |     159    |     159    |      67    |
|       from large pool |      87    |     153    |     153    |      66    |
|       from small pool |       5    |       6    |       6    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1463    |   33570 K  |   33570 K  |
|       from large pool |       3    |     113    |   15739 K  |   15739 K  |
|       from small pool |       0    |    1377    |   17830 K  |   17830 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   5045 MiB |    827 TiB |    827 TiB |
|       from large pool |  16640 KiB |   5036 MiB |    822 TiB |    822 TiB |
|       from small pool |      0 KiB |     10 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   5045 MiB |    827 TiB |    827 TiB |
|       from large pool |  16640 KiB |   5036 MiB |    822 TiB |    822 TiB |
|       from small pool |      0 KiB |     10 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   5033 MiB |    825 TiB |    825 TiB |
|       from large pool |  16640 KiB |   5024 MiB |    819 TiB |    819 TiB |
|       from small pool |      0 KiB |     10 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1896 MiB |   5446 MiB |   5446 MiB |   3550 MiB |
|       from large pool |   1886 MiB |   5434 MiB |   5434 MiB |   3548 MiB |
|       from small pool |     10 MiB |     12 MiB |     12 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 443556 KiB | 203781 GiB | 203781 GiB |
|       from large pool |  24320 KiB | 441760 KiB | 197441 GiB | 197441 GiB |
|       from small pool |      0 KiB |   9631 KiB |   6340 GiB |   6340 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3599    |   70430 K  |   70430 K  |
|       from large pool |       2    |     352    |   27255 K  |   27255 K  |
|       from small pool |       0    |    3351    |   43174 K  |   43174 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3599    |   70430 K  |   70430 K  |
|       from large pool |       2    |     352    |   27255 K  |   27255 K  |
|       from small pool |       0    |    3351    |   43174 K  |   43174 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      92    |     159    |     159    |      67    |
|       from large pool |      87    |     153    |     153    |      66    |
|       from small pool |       5    |       6    |       6    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1463    |   33570 K  |   33570 K  |
|       from large pool |       3    |     113    |   15739 K  |   15739 K  |
|       from small pool |       0    |    1377    |   17830 K  |   17830 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_27_59_seed_1_20863191

 Experiment start at: 2024-05-27 00:27:59.067697
before training, model accuracy: 0.06445375829935074
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.97490877, 'precision': 0.8455645, 'recall': 0.69641954, 'specificity': 0.69641954, 'f1': 0.74890023, 'auroc': 0.966211, 'binary_precision': 0.71127635, 'binary_recall': 0.3983345, 'binary_specificity': 0.9945046, 'binary_f1_score': 0.5106762}
confusion matrix:
       0    1
0  42166  233
1    867  574
---- Validation: 
scalar performance:
{'acc': 0.97198504, 'precision': 0.9311519, 'recall': 0.62497604, 'specificity': 0.62497604, 'f1': 0.68865967, 'auroc': 0.96600103, 'binary_precision': 0.8894737, 'binary_recall': 0.2511144, 'binary_specificity': 0.99883765, 'binary_f1_score': 0.391657}
confusion matrix:
       0    1
0  18046   21
1    504  169
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590719, 'precision': 0.97951615, 'recall': 0.51153845, 'specificity': 0.51153845, 'f1': 0.5121002, 'auroc': 0.95082986, 'binary_precision': 1.0, 'binary_recall': 0.023076924, 'binary_specificity': 1.0, 'binary_f1_score': 0.045112785}
confusion matrix:
      0  1
0  5946  0
1   254  6
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863191.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-27 00:52:07.140597,epoch time: 0:24:08.072900,used: 0:24:08.072900,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_27_59_seed_1_20863191
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.973677, 'precision': 0.78208363, 'recall': 0.8916007, 'specificity': 0.8916007, 'f1': 0.8269613, 'auroc': 0.976455, 'binary_precision': 0.57093596, 'binary_recall': 0.8037448, 'binary_specificity': 0.9794566, 'binary_f1_score': 0.66762674}
confusion matrix:
       0     1
0  41527   871
1    283  1159
---- Validation: 
scalar performance:
{'acc': 0.9760939, 'precision': 0.8217194, 'recall': 0.8474093, 'specificity': 0.8474093, 'f1': 0.83401954, 'auroc': 0.97587097, 'binary_precision': 0.654321, 'binary_recall': 0.7087667, 'binary_specificity': 0.9860519, 'binary_f1_score': 0.6804565}
confusion matrix:
       0    1
0  17815  252
1    196  477
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614889, 'precision': 0.76447964, 'recall': 0.69853747, 'specificity': 0.69853747, 'f1': 0.7262106, 'auroc': 0.9437605, 'binary_precision': 0.55440414, 'binary_recall': 0.41153845, 'binary_specificity': 0.9855365, 'binary_f1_score': 0.47240615}
confusion matrix:
      0    1
0  5860   86
1   153  107
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863191.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-05-27 01:15:09.889250,epoch time: 0:23:02.748653,used: 0:47:10.821553,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_27_59_seed_1_20863191
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97885495, 'precision': 0.8132361, 'recall': 0.92001927, 'specificity': 0.92001927, 'f1': 0.8580568, 'auroc': 0.98374, 'binary_precision': 0.6313906, 'binary_recall': 0.85704374, 'binary_specificity': 0.98299485, 'binary_f1_score': 0.7271122}
confusion matrix:
       0     1
0  41678   721
1    206  1235
---- Validation: 
scalar performance:
{'acc': 0.97716117, 'precision': 0.822781, 'recall': 0.87871933, 'specificity': 0.87871933, 'f1': 0.84828097, 'auroc': 0.9775029, 'binary_precision': 0.6540881, 'binary_recall': 0.7726597, 'binary_specificity': 0.9847789, 'binary_f1_score': 0.70844686}
confusion matrix:
       0    1
0  17792  275
1    153  520
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96455044, 'precision': 0.90525377, 'recall': 0.593474, 'specificity': 0.593474, 'f1': 0.64499265, 'auroc': 0.96358234, 'binary_precision': 0.8448276, 'binary_recall': 0.18846154, 'binary_specificity': 0.9984864, 'binary_f1_score': 0.30817607}
confusion matrix:
      0   1
0  5937   9
1   211  49
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863191.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-05-27 01:38:17.659332,epoch time: 0:23:07.770082,used: 1:10:18.591635,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_27_59_seed_1_20863191
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9827555, 'precision': 0.9220791, 'recall': 0.78293264, 'specificity': 0.78293264, 'f1': 0.8378048, 'auroc': 0.98757195, 'binary_precision': 0.85863876, 'binary_recall': 0.5690493, 'binary_specificity': 0.996816, 'binary_f1_score': 0.6844741}
confusion matrix:
       0    1
0  42264  135
1    621  820
---- Validation: 
scalar performance:
{'acc': 0.98127, 'precision': 0.9447242, 'recall': 0.76569223, 'specificity': 0.76569223, 'f1': 0.83100784, 'auroc': 0.9794121, 'binary_precision': 0.90656567, 'binary_recall': 0.53343236, 'binary_specificity': 0.99795204, 'binary_f1_score': 0.6716557}
confusion matrix:
       0    1
0  18030   37
1    314  359
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95939416, 'precision': 0.9796709, 'recall': 0.5153846, 'specificity': 0.5153846, 'f1': 0.5194752, 'auroc': 0.957461, 'binary_precision': 1.0, 'binary_recall': 0.03076923, 'binary_specificity': 1.0, 'binary_f1_score': 0.05970149}
confusion matrix:
      0  1
0  5946  0
1   252  8
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863191.png
better model found
persisted
after epoch: 4,now: 2024-05-27 02:01:22.183141,epoch time: 0:23:04.523809,used: 1:33:23.115444,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_27_59_seed_1_20863191
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98405564, 'precision': 0.8853904, 'recall': 0.855098, 'specificity': 0.855098, 'f1': 0.86957395, 'auroc': 0.9862973, 'binary_precision': 0.7803774, 'binary_recall': 0.7170596, 'binary_specificity': 0.99313647, 'binary_f1_score': 0.74737984}
confusion matrix:
       0     1
0  42107   291
1    408  1034
---- Validation: 
scalar performance:
{'acc': 0.9794557, 'precision': 0.87215734, 'recall': 0.8105284, 'specificity': 0.8105284, 'f1': 0.8383126, 'auroc': 0.9768901, 'binary_precision': 0.7580645, 'binary_recall': 0.62852895, 'binary_specificity': 0.99252784, 'binary_f1_score': 0.68724614}
confusion matrix:
       0    1
0  17932  135
1    250  423
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614889, 'precision': 0.9253475, 'recall': 0.5459016, 'specificity': 0.5459016, 'f1': 0.573768, 'auroc': 0.9558637, 'binary_precision': 0.8888889, 'binary_recall': 0.092307694, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.16724738}
confusion matrix:
      0   1
0  5943   3
1   236  24
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863191.png
early stop counter: 1
val acc:0.9794557094573975, best validation acc: 0.9812700152397156, corresponding to test acc:                         0.9593941569328308 / 0.9645504355430603
after epoch: 5,now: 2024-05-27 02:24:27.376208,epoch time: 0:23:05.193067,used: 1:56:28.308511,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_27_59_seed_1_20863191
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98478556, 'precision': 0.9141396, 'recall': 0.83001935, 'specificity': 0.83001935, 'f1': 0.86696756, 'auroc': 0.99065864, 'binary_precision': 0.8396144, 'binary_recall': 0.66435504, 'binary_specificity': 0.9956837, 'binary_f1_score': 0.7417732}
confusion matrix:
       0    1
0  42215  183
1    484  958
---- Validation: 
scalar performance:
{'acc': 0.9823906, 'precision': 0.92256904, 'recall': 0.802752, 'specificity': 0.802752, 'f1': 0.85198003, 'auroc': 0.97867537, 'binary_precision': 0.8595388, 'binary_recall': 0.60921246, 'binary_specificity': 0.9962916, 'binary_f1_score': 0.7130435}
confusion matrix:
       0    1
0  18000   67
1    263  410
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96019983, 'precision': 0.94679916, 'recall': 0.52683896, 'specificity': 0.52683896, 'f1': 0.5407336, 'auroc': 0.9594052, 'binary_precision': 0.93333334, 'binary_recall': 0.053846154, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.10181818}
confusion matrix:
      0   1
0  5945   1
1   246  14
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863191.png
better model found
persisted
after epoch: 6,now: 2024-05-27 02:47:32.913257,epoch time: 0:23:05.537049,used: 2:19:33.845560,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_27_59_seed_1_20863191
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9860402, 'precision': 0.95631516, 'recall': 0.8122459, 'specificity': 0.8122459, 'f1': 0.8698602, 'auroc': 0.99274385, 'binary_precision': 0.92520493, 'binary_recall': 0.6262136, 'binary_specificity': 0.9982782, 'binary_f1_score': 0.7468983}
confusion matrix:
       0    1
0  42325   73
1    539  903
---- Validation: 
scalar performance:
{'acc': 0.980683, 'precision': 0.9420775, 'recall': 0.7582351, 'specificity': 0.7582351, 'f1': 0.8242755, 'auroc': 0.97796607, 'binary_precision': 0.9018088, 'binary_recall': 0.5185735, 'binary_specificity': 0.99789673, 'binary_f1_score': 0.6584906}
confusion matrix:
       0    1
0  18029   38
1    324  349
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606832, 'precision': 0.9304397, 'recall': 0.5344472, 'specificity': 0.5344472, 'f1': 0.5542297, 'auroc': 0.9529393, 'binary_precision': 0.9, 'binary_recall': 0.06923077, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.12857144}
confusion matrix:
      0   1
0  5944   2
1   242  18
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863191.png
early stop counter: 1
val acc:0.9806830286979675, best validation acc: 0.9823905825614929, corresponding to test acc:                         0.9601998329162598 / 0.9645504355430603
after epoch: 7,now: 2024-05-27 03:10:38.750264,epoch time: 0:23:05.837007,used: 2:42:39.682567,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_27_59_seed_1_20863191
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.99007756, 'precision': 0.93620545, 'recall': 0.9030944, 'specificity': 0.9030944, 'f1': 0.91894686, 'auroc': 0.9942298, 'binary_precision': 0.8788563, 'binary_recall': 0.8099861, 'binary_specificity': 0.99620265, 'binary_f1_score': 0.8430169}
confusion matrix:
       0     1
0  42237   161
1    274  1168
---- Validation: 
scalar performance:
{'acc': 0.98415154, 'precision': 0.9322864, 'recall': 0.82297754, 'specificity': 0.82297754, 'f1': 0.86909544, 'auroc': 0.9824863, 'binary_precision': 0.87751, 'binary_recall': 0.64933133, 'binary_specificity': 0.9966237, 'binary_f1_score': 0.74637055}
confusion matrix:
       0    1
0  18006   61
1    236  437
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621334, 'precision': 0.9206834, 'recall': 0.55543286, 'specificity': 0.55543286, 'f1': 0.5892806, 'auroc': 0.9477449, 'binary_precision': 0.8787879, 'binary_recall': 0.11153846, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.19795221}
confusion matrix:
      0   1
0  5942   4
1   231  29
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863191.png
better model found
persisted
after epoch: 8,now: 2024-05-27 03:33:43.842563,epoch time: 0:23:05.092299,used: 3:05:44.774866,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_27_59_seed_1_20863191
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98679286, 'precision': 0.9466265, 'recall': 0.8334018, 'specificity': 0.8334018, 'f1': 0.88121635, 'auroc': 0.99426436, 'binary_precision': 0.9044049, 'binary_recall': 0.6692094, 'binary_specificity': 0.99759424, 'binary_f1_score': 0.7692308}
confusion matrix:
       0    1
0  42296  102
1    477  965
---- Validation: 
scalar performance:
{'acc': 0.98116326, 'precision': 0.94049805, 'recall': 0.76706743, 'specificity': 0.76706743, 'f1': 0.83096576, 'auroc': 0.9790073, 'binary_precision': 0.89800996, 'binary_recall': 0.53640413, 'binary_specificity': 0.9977307, 'binary_f1_score': 0.6716279}
confusion matrix:
       0    1
0  18026   41
1    312  361
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96084434, 'precision': 0.9803684, 'recall': 0.5326923, 'specificity': 0.5326923, 'f1': 0.55135953, 'auroc': 0.9561633, 'binary_precision': 1.0, 'binary_recall': 0.06538462, 'binary_specificity': 1.0, 'binary_f1_score': 0.12274369}
confusion matrix:
      0   1
0  5946   0
1   243  17
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863191.png
early stop counter: 1
val acc:0.9811632633209229, best validation acc: 0.9841515421867371, corresponding to test acc:                         0.9621334075927734 / 0.9645504355430603
after epoch: 9,now: 2024-05-27 03:56:50.856507,epoch time: 0:23:07.013944,used: 3:28:51.788810,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_27_59_seed_1_20863191
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99119526, 'precision': 0.9400047, 'recall': 0.9187449, 'specificity': 0.9187449, 'f1': 0.92909145, 'auroc': 0.99548614, 'binary_precision': 0.8854015, 'binary_recall': 0.8411928, 'binary_specificity': 0.996297, 'binary_f1_score': 0.8627312}
confusion matrix:
       0     1
0  42241   157
1    229  1213
---- Validation: 
scalar performance:
{'acc': 0.9840982, 'precision': 0.9054639, 'recall': 0.85299104, 'specificity': 0.85299104, 'f1': 0.8772561, 'auroc': 0.9781759, 'binary_precision': 0.82161236, 'binary_recall': 0.71173847, 'binary_specificity': 0.9942436, 'binary_f1_score': 0.7627388}
confusion matrix:
       0    1
0  17963  104
1    194  479
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96019983, 'precision': 0.8103713, 'recall': 0.55074584, 'specificity': 0.55074584, 'f1': 0.57950366, 'auroc': 0.9238892, 'binary_precision': 0.6585366, 'binary_recall': 0.103846155, 'binary_specificity': 0.9976455, 'binary_f1_score': 0.179402}
confusion matrix:
      0   1
0  5932  14
1   233  27
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863191.png
early stop counter: 2
val acc:0.9840981960296631, best validation acc: 0.9841515421867371, corresponding to test acc:                         0.9621334075927734 / 0.9645504355430603
after epoch: 10,now: 2024-05-27 04:19:59.224671,epoch time: 0:23:08.368164,used: 3:52:00.156974,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_27_59_seed_1_20863191
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98980385, 'precision': 0.9647219, 'recall': 0.86836255, 'specificity': 0.86836255, 'f1': 0.9105777, 'auroc': 0.995299, 'binary_precision': 0.9382716, 'binary_recall': 0.73837614, 'binary_specificity': 0.998349, 'binary_f1_score': 0.8264078}
confusion matrix:
       0     1
0  42329    70
1    377  1064
---- Validation: 
scalar performance:
{'acc': 0.9839381, 'precision': 0.93543863, 'recall': 0.8164294, 'specificity': 0.8164294, 'f1': 0.86577886, 'auroc': 0.9721036, 'binary_precision': 0.88429755, 'binary_recall': 0.6359584, 'binary_specificity': 0.99690044, 'binary_f1_score': 0.73984444}
confusion matrix:
       0    1
0  18011   56
1    245  428
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95987755, 'precision': 0.91338503, 'recall': 0.52483183, 'specificity': 0.52483183, 'f1': 0.53701484, 'auroc': 0.888782, 'binary_precision': 0.8666667, 'binary_recall': 0.05, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.094545454}
confusion matrix:
      0   1
0  5944   2
1   247  13
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863191.png
early stop counter: 3
val acc:0.9839380979537964, best validation acc: 0.9841515421867371, corresponding to test acc:                         0.9621334075927734 / 0.9645504355430603
after epoch: 11,now: 2024-05-27 04:43:08.605067,epoch time: 0:23:09.380396,used: 4:15:09.537370,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_27_59_seed_1_20863191
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99030566, 'precision': 0.9400147, 'recall': 0.90240955, 'specificity': 0.90240955, 'f1': 0.9203093, 'auroc': 0.9959332, 'binary_precision': 0.88651943, 'binary_recall': 0.80833334, 'binary_specificity': 0.9964858, 'binary_f1_score': 0.84562296}
confusion matrix:
       0     1
0  42251   149
1    276  1164
---- Validation: 
scalar performance:
{'acc': 0.9854856, 'precision': 0.9234179, 'recall': 0.85514116, 'specificity': 0.85514116, 'f1': 0.8860371, 'auroc': 0.9792601, 'binary_precision': 0.8573975, 'binary_recall': 0.71471024, 'binary_specificity': 0.99557203, 'binary_f1_score': 0.77957857}
confusion matrix:
       0    1
0  17987   80
1    192  481
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9585885, 'precision': 0.81283957, 'recall': 0.5112862, 'specificity': 0.5112862, 'f1': 0.51172256, 'auroc': 0.94801384, 'binary_precision': 0.6666667, 'binary_recall': 0.023076924, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.044609666}
confusion matrix:
      0  1
0  5943  3
1   254  6
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863191.png
better model found
persisted
after epoch: 12,now: 2024-05-27 05:06:26.721040,epoch time: 0:23:18.115973,used: 4:38:27.653343,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_27_59_seed_1_20863191
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9921761, 'precision': 0.9322132, 'recall': 0.94698244, 'specificity': 0.94698244, 'f1': 0.939464, 'auroc': 0.9970829, 'binary_precision': 0.8678739, 'binary_recall': 0.8986111, 'binary_specificity': 0.99535376, 'binary_f1_score': 0.88297516}
confusion matrix:
       0     1
0  42203   197
1    146  1294
---- Validation: 
scalar performance:
{'acc': 0.9851121, 'precision': 0.90931547, 'recall': 0.86639166, 'specificity': 0.86639166, 'f1': 0.8865634, 'auroc': 0.97628987, 'binary_precision': 0.8283333, 'binary_recall': 0.7384844, 'binary_specificity': 0.994299, 'binary_f1_score': 0.7808326}
confusion matrix:
       0    1
0  17964  103
1    176  497
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96084434, 'precision': 0.77804565, 'recall': 0.6044128, 'specificity': 0.6044128, 'f1': 0.6476693, 'auroc': 0.93883526, 'binary_precision': 0.58947366, 'binary_recall': 0.21538462, 'binary_specificity': 0.993441, 'binary_f1_score': 0.31549296}
confusion matrix:
      0   1
0  5907  39
1   204  56
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863191.png
early stop counter: 1
val acc:0.9851120710372925, best validation acc: 0.9854856133460999, corresponding to test acc:                         0.9585884809494019 / 0.9645504355430603
after epoch: 13,now: 2024-05-27 05:29:43.887546,epoch time: 0:23:17.166506,used: 5:01:44.819849,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_27_59_seed_1_20863191
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99270076, 'precision': 0.956846, 'recall': 0.92555225, 'specificity': 0.92555225, 'f1': 0.9406028, 'auroc': 0.9978987, 'binary_precision': 0.9186567, 'binary_recall': 0.8536754, 'binary_specificity': 0.99742913, 'binary_f1_score': 0.8849748}
confusion matrix:
       0     1
0  42289   109
1    211  1231
---- Validation: 
scalar performance:
{'acc': 0.98596585, 'precision': 0.91784716, 'recall': 0.8704108, 'specificity': 0.8704108, 'f1': 0.8925803, 'auroc': 0.9777134, 'binary_precision': 0.84511787, 'binary_recall': 0.7459138, 'binary_specificity': 0.99490786, 'binary_f1_score': 0.79242307}
confusion matrix:
       0    1
0  17975   92
1    171  502
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9626168, 'precision': 0.82755286, 'recall': 0.5961428, 'specificity': 0.5961428, 'f1': 0.64309037, 'auroc': 0.92517436, 'binary_precision': 0.6891892, 'binary_recall': 0.19615385, 'binary_specificity': 0.99613184, 'binary_f1_score': 0.30538923}
confusion matrix:
      0   1
0  5923  23
1   209  51
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863191.png
better model found
persisted
after epoch: 14,now: 2024-05-27 05:53:11.554848,epoch time: 0:23:27.667302,used: 5:25:12.487151,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_27_59_seed_1_20863191
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9933166, 'precision': 0.94760716, 'recall': 0.94730735, 'specificity': 0.94730735, 'f1': 0.9474572, 'auroc': 0.9976959, 'binary_precision': 0.89868146, 'binary_recall': 0.89805824, 'binary_specificity': 0.99655646, 'binary_f1_score': 0.8983697}
confusion matrix:
       0     1
0  42252   146
1    147  1295
---- Validation: 
scalar performance:
{'acc': 0.9872999, 'precision': 0.939037, 'recall': 0.86824167, 'specificity': 0.86824167, 'f1': 0.90028256, 'auroc': 0.9778619, 'binary_precision': 0.88770056, 'binary_recall': 0.73997027, 'binary_specificity': 0.996513, 'binary_f1_score': 0.80713135}
confusion matrix:
       0    1
0  18004   63
1    175  498
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.962778, 'precision': 0.84094226, 'recall': 0.59071, 'specificity': 0.59071, 'f1': 0.6372317, 'auroc': 0.9485954, 'binary_precision': 0.7164179, 'binary_recall': 0.18461539, 'binary_specificity': 0.9968046, 'binary_f1_score': 0.293578}
confusion matrix:
      0   1
0  5927  19
1   212  48
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863191.png
better model found
persisted
after epoch: 15,now: 2024-05-27 06:16:42.277280,epoch time: 0:23:30.722432,used: 5:48:43.209583,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_27_59_seed_1_20863191
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9895301, 'precision': 0.9153928, 'recall': 0.9212335, 'specificity': 0.9212335, 'f1': 0.9182911, 'auroc': 0.9955113, 'binary_precision': 0.83595353, 'binary_recall': 0.8481276, 'binary_specificity': 0.99433935, 'binary_f1_score': 0.8419966}
confusion matrix:
       0     1
0  42158   240
1    219  1223
---- Validation: 
scalar performance:
{'acc': 0.9839381, 'precision': 0.9065161, 'recall': 0.8486164, 'specificity': 0.8486164, 'f1': 0.87515664, 'auroc': 0.9717007, 'binary_precision': 0.8240418, 'binary_recall': 0.70282316, 'binary_specificity': 0.9944097, 'binary_f1_score': 0.7586206}
confusion matrix:
       0    1
0  17966  101
1    200  473
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9634225, 'precision': 0.94337726, 'recall': 0.5689785, 'specificity': 0.5689785, 'f1': 0.61103123, 'auroc': 0.92458636, 'binary_precision': 0.9230769, 'binary_recall': 0.13846155, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.24080269}
confusion matrix:
      0   1
0  5943   3
1   224  36
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863191.png
early stop counter: 1
val acc:0.9839380979537964, best validation acc: 0.987299919128418, corresponding to test acc:                         0.9627779722213745 / 0.9645504355430603
after epoch: 16,now: 2024-05-27 06:40:12.947553,epoch time: 0:23:30.670273,used: 6:12:13.879856,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_27_59_seed_1_20863191
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99270076, 'precision': 0.9749274, 'recall': 0.9071302, 'specificity': 0.9071302, 'f1': 0.9382376, 'auroc': 0.9982189, 'binary_precision': 0.95609754, 'binary_recall': 0.815534, 'binary_specificity': 0.99872637, 'binary_f1_score': 0.88023955}
confusion matrix:
       0     1
0  42344    54
1    266  1176
---- Validation: 
scalar performance:
{'acc': 0.9845251, 'precision': 0.94408095, 'recall': 0.81816435, 'specificity': 0.81816435, 'f1': 0.86992186, 'auroc': 0.9730861, 'binary_precision': 0.9014675, 'binary_recall': 0.63893014, 'binary_specificity': 0.99739856, 'binary_f1_score': 0.7478261}
confusion matrix:
       0    1
0  18020   47
1    243  430
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9577828, 'precision': 0.71341753, 'recall': 0.5255776, 'specificity': 0.5255776, 'f1': 0.537469, 'auroc': 0.9400408, 'binary_precision': 0.46666667, 'binary_recall': 0.053846154, 'binary_specificity': 0.9973091, 'binary_f1_score': 0.09655173}
confusion matrix:
      0   1
0  5930  16
1   246  14
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863191.png
early stop counter: 2
val acc:0.9845250844955444, best validation acc: 0.987299919128418, corresponding to test acc:                         0.9627779722213745 / 0.9645504355430603
after epoch: 17,now: 2024-05-27 07:03:43.110969,epoch time: 0:23:30.163416,used: 6:35:44.043272,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_27_59_seed_1_20863191
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9950502, 'precision': 0.9676765, 'recall': 0.95356274, 'specificity': 0.95356274, 'f1': 0.96050346, 'auroc': 0.99762857, 'binary_precision': 0.9384395, 'binary_recall': 0.90915394, 'binary_specificity': 0.9979716, 'binary_f1_score': 0.9235646}
confusion matrix:
       0     1
0  42312    86
1    131  1311
---- Validation: 
scalar performance:
{'acc': 0.9846318, 'precision': 0.93289804, 'recall': 0.83037925, 'specificity': 0.83037925, 'f1': 0.87420547, 'auroc': 0.96743, 'binary_precision': 0.87819254, 'binary_recall': 0.6641902, 'binary_specificity': 0.9965683, 'binary_f1_score': 0.7563452}
confusion matrix:
       0    1
0  18005   62
1    226  447
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611666, 'precision': 0.8125322, 'recall': 0.5733182, 'specificity': 0.5733182, 'f1': 0.61229265, 'auroc': 0.9336131, 'binary_precision': 0.66101694, 'binary_recall': 0.15, 'binary_specificity': 0.9966364, 'binary_f1_score': 0.24451412}
confusion matrix:
      0   1
0  5926  20
1   221  39
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863191.png
early stop counter: 3
val acc:0.9846317768096924, best validation acc: 0.987299919128418, corresponding to test acc:                         0.9627779722213745 / 0.9645504355430603
after epoch: 18,now: 2024-05-27 07:27:08.878233,epoch time: 0:23:25.767264,used: 6:59:09.810536,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_27_59_seed_1_20863191
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99447995, 'precision': 0.9889451, 'recall': 0.9230695, 'specificity': 0.9230695, 'f1': 0.9534608, 'auroc': 0.9990356, 'binary_precision': 0.9830782, 'binary_recall': 0.84663427, 'binary_specificity': 0.9995047, 'binary_f1_score': 0.9097689}
confusion matrix:
       0     1
0  42378    21
1    221  1220
---- Validation: 
scalar performance:
{'acc': 0.98399144, 'precision': 0.94527507, 'recall': 0.8085891, 'specificity': 0.8085891, 'f1': 0.86359787, 'auroc': 0.97500026, 'binary_precision': 0.9045553, 'binary_recall': 0.61961365, 'binary_specificity': 0.9975646, 'binary_f1_score': 0.73544973}
confusion matrix:
       0    1
0  18023   44
1    256  417
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614889, 'precision': 0.8812024, 'recall': 0.5532575, 'specificity': 0.5532575, 'f1': 0.5850531, 'auroc': 0.9437903, 'binary_precision': 0.8, 'binary_recall': 0.10769231, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.18983051}
confusion matrix:
      0   1
0  5939   7
1   232  28
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863191.png
early stop counter: 4
val acc:0.9839914441108704, best validation acc: 0.987299919128418, corresponding to test acc:                         0.9627779722213745 / 0.9645504355430603
after epoch: 19,now: 2024-05-27 07:50:37.963474,epoch time: 0:23:29.085241,used: 7:22:38.895777,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_27_59_seed_1_20863191
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99434304, 'precision': 0.961506, 'recall': 0.9485079, 'specificity': 0.9485079, 'f1': 0.9549072, 'auroc': 0.99789476, 'binary_precision': 0.92642856, 'binary_recall': 0.89944524, 'binary_specificity': 0.99757063, 'binary_f1_score': 0.9127375}
confusion matrix:
       0     1
0  42295   103
1    145  1297
---- Validation: 
scalar performance:
{'acc': 0.9850587, 'precision': 0.90759933, 'recall': 0.8677945, 'specificity': 0.8677945, 'f1': 0.8865866, 'auroc': 0.97601783, 'binary_precision': 0.8247934, 'binary_recall': 0.74145615, 'binary_specificity': 0.99413294, 'binary_f1_score': 0.78090763}
confusion matrix:
       0    1
0  17961  106
1    174  499
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606832, 'precision': 0.808561, 'recall': 0.56387097, 'specificity': 0.56387097, 'f1': 0.5988917, 'auroc': 0.93932843, 'binary_precision': 0.65384614, 'binary_recall': 0.13076924, 'binary_specificity': 0.99697274, 'binary_f1_score': 0.21794872}
confusion matrix:
      0   1
0  5928  18
1   226  34
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863191.png
early stop counter: 5
val acc:0.9850587248802185, best validation acc: 0.987299919128418, corresponding to test acc:                         0.9627779722213745 / 0.9645504355430603
after epoch: 20,now: 2024-05-27 08:14:09.754218,epoch time: 0:23:31.790744,used: 7:46:10.686521,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_27_59_seed_1_20863191
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99495894, 'precision': 0.98461413, 'recall': 0.93475854, 'specificity': 0.93475854, 'f1': 0.9582379, 'auroc': 0.9991546, 'binary_precision': 0.973623, 'binary_recall': 0.870319, 'binary_specificity': 0.9991981, 'binary_f1_score': 0.9190773}
confusion matrix:
       0     1
0  42364    34
1    187  1255
---- Validation: 
scalar performance:
{'acc': 0.98564565, 'precision': 0.94594187, 'recall': 0.8344814, 'specificity': 0.8344814, 'f1': 0.8816322, 'auroc': 0.9652597, 'binary_precision': 0.904, 'binary_recall': 0.6716196, 'binary_specificity': 0.99734324, 'binary_f1_score': 0.7706735}
confusion matrix:
       0    1
0  18019   48
1    221  452
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96003866, 'precision': 0.9443406, 'recall': 0.5249159, 'specificity': 0.5249159, 'f1': 0.5372294, 'auroc': 0.90989625, 'binary_precision': 0.9285714, 'binary_recall': 0.05, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.09489051}
confusion matrix:
      0   1
0  5945   1
1   247  13
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863191.png
early stop counter: 6
val acc:0.9856456518173218, best validation acc: 0.987299919128418, corresponding to test acc:                         0.9627779722213745 / 0.9645504355430603
after epoch: 21,now: 2024-05-27 08:37:51.869820,epoch time: 0:23:42.115602,used: 8:09:52.802123,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_27_59_seed_1_20863191
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99514145, 'precision': 0.98165137, 'recall': 0.940547, 'specificity': 0.940547, 'f1': 0.960117, 'auroc': 0.99875045, 'binary_precision': 0.96730036, 'binary_recall': 0.8821082, 'binary_specificity': 0.9989858, 'binary_f1_score': 0.92274207}
confusion matrix:
       0     1
0  42355    43
1    170  1272
---- Validation: 
scalar performance:
{'acc': 0.98569906, 'precision': 0.94528794, 'recall': 0.83593965, 'specificity': 0.83593965, 'f1': 0.8823633, 'auroc': 0.9735314, 'binary_precision': 0.9025845, 'binary_recall': 0.67459136, 'binary_specificity': 0.99728787, 'binary_f1_score': 0.7721088}
confusion matrix:
       0    1
0  18018   49
1    219  454
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589107, 'precision': 0.7844546, 'recall': 0.52616626, 'specificity': 0.52616626, 'f1': 0.53895795, 'auroc': 0.91977894, 'binary_precision': 0.6086956, 'binary_recall': 0.053846154, 'binary_specificity': 0.9984864, 'binary_f1_score': 0.09893993}
confusion matrix:
      0   1
0  5937   9
1   246  14
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863191.png
early stop counter: 7
val acc:0.9856990575790405, best validation acc: 0.987299919128418, corresponding to test acc:                         0.9627779722213745 / 0.9645504355430603
after epoch: 22,now: 2024-05-27 09:01:23.018518,epoch time: 0:23:31.148698,used: 8:33:23.950821,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_27_59_seed_1_20863191
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9957573, 'precision': 0.978935, 'recall': 0.9531624, 'specificity': 0.9531624, 'f1': 0.9656663, 'auroc': 0.99897575, 'binary_precision': 0.96100074, 'binary_recall': 0.9075747, 'binary_specificity': 0.99875003, 'binary_f1_score': 0.93352395}
confusion matrix:
       0     1
0  42348    53
1    133  1306
---- Validation: 
scalar performance:
{'acc': 0.9866595, 'precision': 0.9354814, 'recall': 0.86147213, 'specificity': 0.86147213, 'f1': 0.8947604, 'auroc': 0.97002685, 'binary_precision': 0.8810811, 'binary_recall': 0.7265973, 'binary_specificity': 0.99634695, 'binary_f1_score': 0.79641694}
confusion matrix:
       0    1
0  18001   66
1    184  489
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96036094, 'precision': 0.8281784, 'recall': 0.5471519, 'specificity': 0.5471519, 'f1': 0.57430756, 'auroc': 0.8958533, 'binary_precision': 0.6944444, 'binary_recall': 0.09615385, 'binary_specificity': 0.99815, 'binary_f1_score': 0.16891892}
confusion matrix:
      0   1
0  5935  11
1   235  25
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863191.png
early stop counter: 8
val acc:0.9866595268249512, best validation acc: 0.987299919128418, corresponding to test acc:                         0.9627779722213745 / 0.9645504355430603
after epoch: 23,now: 2024-05-27 09:24:53.638851,epoch time: 0:23:30.620333,used: 8:56:54.571154,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_27_59_seed_1_20863191
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9948677, 'precision': 0.95146006, 'recall': 0.9698809, 'specificity': 0.9698809, 'f1': 0.96047205, 'auroc': 0.9987643, 'binary_precision': 0.904857, 'binary_recall': 0.94313455, 'binary_specificity': 0.9966272, 'binary_f1_score': 0.9235994}
confusion matrix:
       0     1
0  42255   143
1     82  1360
---- Validation: 
scalar performance:
{'acc': 0.9846318, 'precision': 0.89485896, 'recall': 0.8790175, 'specificity': 0.8790175, 'f1': 0.8867614, 'auroc': 0.97143984, 'binary_precision': 0.79844964, 'binary_recall': 0.7652303, 'binary_specificity': 0.9928046, 'binary_f1_score': 0.7814871}
confusion matrix:
       0    1
0  17937  130
1    158  515
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9624557, 'precision': 0.86972684, 'recall': 0.5721519, 'specificity': 0.5721519, 'f1': 0.61335164, 'auroc': 0.9344435, 'binary_precision': 0.7755102, 'binary_recall': 0.14615385, 'binary_specificity': 0.99815, 'binary_f1_score': 0.2459547}
confusion matrix:
      0   1
0  5935  11
1   222  38
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863191.png
early stop counter: 9
val acc:0.9846317768096924, best validation acc: 0.987299919128418, corresponding to test acc:                         0.9627779722213745 / 0.9645504355430603
after epoch: 24,now: 2024-05-27 09:48:24.164615,epoch time: 0:23:30.525764,used: 9:20:25.096918,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_27_59_seed_1_20863191
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99491334, 'precision': 0.9531038, 'recall': 0.9685646, 'specificity': 0.9685646, 'f1': 0.96069455, 'auroc': 0.9991201, 'binary_precision': 0.9082385, 'binary_recall': 0.9403606, 'binary_specificity': 0.9967687, 'binary_f1_score': 0.92402047}
confusion matrix:
       0     1
0  42261   137
1     86  1356
---- Validation: 
scalar performance:
{'acc': 0.9853255, 'precision': 0.91209626, 'recall': 0.8665024, 'specificity': 0.8665024, 'f1': 0.8878498, 'auroc': 0.9732044, 'binary_precision': 0.83389264, 'binary_recall': 0.7384844, 'binary_specificity': 0.9945204, 'binary_f1_score': 0.78329396}
confusion matrix:
       0    1
0  17968   99
1    176  497
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.962778, 'precision': 0.86899626, 'recall': 0.5778371, 'specificity': 0.5778371, 'f1': 0.62144417, 'auroc': 0.9385265, 'binary_precision': 0.7735849, 'binary_recall': 0.15769231, 'binary_specificity': 0.99798185, 'binary_f1_score': 0.26198083}
confusion matrix:
      0   1
0  5934  12
1   219  41
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863191.png
early stop counter: 10
val acc:0.9853255152702332, best validation acc: 0.987299919128418, corresponding to test acc:                         0.9627779722213745 / 0.9645504355430603
after epoch: 25,now: 2024-05-27 10:11:58.586742,epoch time: 0:23:34.422127,used: 9:43:59.519045,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_27_59_seed_1_20863191
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9953923, 'precision': 0.9623662, 'recall': 0.9654628, 'specificity': 0.9654628, 'f1': 0.963909, 'auroc': 0.99883294, 'binary_precision': 0.92699724, 'binary_recall': 0.9334258, 'binary_specificity': 0.9974999, 'binary_f1_score': 0.9302004}
confusion matrix:
       0     1
0  42292   106
1     96  1346
---- Validation: 
scalar performance:
{'acc': 0.98569906, 'precision': 0.9121991, 'recall': 0.87313354, 'specificity': 0.87313354, 'f1': 0.89161086, 'auroc': 0.97152174, 'binary_precision': 0.8336079, 'binary_recall': 0.75185734, 'binary_specificity': 0.9944097, 'binary_f1_score': 0.79062504}
confusion matrix:
       0    1
0  17966  101
1    167  506
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.962778, 'precision': 0.8553118, 'recall': 0.58335406, 'specificity': 0.58335406, 'f1': 0.62838006, 'auroc': 0.91553545, 'binary_precision': 0.7457627, 'binary_recall': 0.16923077, 'binary_specificity': 0.9974773, 'binary_f1_score': 0.27586207}
confusion matrix:
      0   1
0  5931  15
1   216  44
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863191.png
early stop counter: 11
val acc:0.9856990575790405, best validation acc: 0.987299919128418, corresponding to test acc:                         0.9627779722213745 / 0.9645504355430603
after epoch: 26,now: 2024-05-27 10:35:29.517640,epoch time: 0:23:30.930898,used: 10:07:30.449943,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_27_59_seed_1_20863191
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9950958, 'precision': 0.95555043, 'recall': 0.96865904, 'specificity': 0.96865904, 'f1': 0.9620046, 'auroc': 0.99924856, 'binary_precision': 0.9131313, 'binary_recall': 0.9403606, 'binary_specificity': 0.9969574, 'binary_f1_score': 0.9265459}
confusion matrix:
       0     1
0  42269   129
1     86  1356
---- Validation: 
scalar performance:
{'acc': 0.9861793, 'precision': 0.9044142, 'recall': 0.8934101, 'specificity': 0.8934101, 'f1': 0.89882946, 'auroc': 0.9769355, 'binary_precision': 0.8165138, 'binary_recall': 0.7934621, 'binary_specificity': 0.9933581, 'binary_f1_score': 0.804823}
confusion matrix:
       0    1
0  17947  120
1    139  534
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9705124, 'precision': 0.90681386, 'recall': 0.6811787, 'specificity': 0.6811787, 'f1': 0.7470914, 'auroc': 0.93681747, 'binary_precision': 0.84070796, 'binary_recall': 0.3653846, 'binary_specificity': 0.99697274, 'binary_f1_score': 0.5093834}
confusion matrix:
      0   1
0  5928  18
1   165  95
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863191.png
new oracle model saved
early stop counter: 12
val acc:0.9861792922019958, best validation acc: 0.987299919128418, corresponding to test acc:                         0.9627779722213745 / 0.9705123901367188
after epoch: 27,now: 2024-05-27 10:59:02.015568,epoch time: 0:23:32.497928,used: 10:31:02.947871,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_27_59_seed_1_20863191
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9964872, 'precision': 0.9919593, 'recall': 0.952296, 'specificity': 0.952296, 'f1': 0.97123504, 'auroc': 0.999637, 'binary_precision': 0.9871407, 'binary_recall': 0.90499306, 'binary_specificity': 0.99959904, 'binary_f1_score': 0.94428366}
confusion matrix:
       0     1
0  42381    17
1    137  1305
---- Validation: 
scalar performance:
{'acc': 0.9850053, 'precision': 0.95362425, 'recall': 0.8176981, 'specificity': 0.8176981, 'f1': 0.87277997, 'auroc': 0.9668299, 'binary_precision': 0.92060083, 'binary_recall': 0.63744426, 'binary_specificity': 0.99795204, 'binary_f1_score': 0.75329226}
confusion matrix:
       0    1
0  18030   37
1    244  429
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611666, 'precision': 0.8595747, 'recall': 0.5530894, 'specificity': 0.5530894, 'f1': 0.5843297, 'auroc': 0.8966647, 'binary_precision': 0.7567568, 'binary_recall': 0.10769231, 'binary_specificity': 0.9984864, 'binary_f1_score': 0.1885522}
confusion matrix:
      0   1
0  5937   9
1   232  28
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863191.png
early stop counter: 13
val acc:0.9850053191184998, best validation acc: 0.987299919128418, corresponding to test acc:                         0.9627779722213745 / 0.9705123901367188
after epoch: 28,now: 2024-05-27 11:22:40.369543,epoch time: 0:23:38.353975,used: 10:54:41.301846,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_27_59_seed_1_20863191
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9967153, 'precision': 0.98459214, 'recall': 0.96313226, 'specificity': 0.96313226, 'f1': 0.9736016, 'auroc': 0.99920714, 'binary_precision': 0.971657, 'binary_recall': 0.92718446, 'binary_specificity': 0.9990801, 'binary_f1_score': 0.9489}
confusion matrix:
       0     1
0  42359    39
1    105  1337
---- Validation: 
scalar performance:
{'acc': 0.98580575, 'precision': 0.9374187, 'recall': 0.8452934, 'specificity': 0.8452934, 'f1': 0.88550067, 'auroc': 0.97303927, 'binary_precision': 0.88614804, 'binary_recall': 0.69390786, 'binary_specificity': 0.996679, 'binary_f1_score': 0.77833325}
confusion matrix:
       0    1
0  18007   60
1    206  467
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96132773, 'precision': 0.81823355, 'recall': 0.5734023, 'specificity': 0.5734023, 'f1': 0.61271924, 'auroc': 0.94016695, 'binary_precision': 0.67241377, 'binary_recall': 0.15, 'binary_specificity': 0.9968046, 'binary_f1_score': 0.24528302}
confusion matrix:
      0   1
0  5927  19
1   221  39
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863191.png
early stop counter: 14
val acc:0.9858057498931885, best validation acc: 0.987299919128418, corresponding to test acc:                         0.9627779722213745 / 0.9705123901367188
after epoch: 29,now: 2024-05-27 11:47:39.512029,epoch time: 0:24:59.142486,used: 11:19:40.444332,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_27_59_seed_1_20863191
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99692065, 'precision': 0.9857813, 'recall': 0.9652481, 'specificity': 0.9652481, 'f1': 0.9752769, 'auroc': 0.99937165, 'binary_precision': 0.9738941, 'binary_recall': 0.93134534, 'binary_specificity': 0.99915093, 'binary_f1_score': 0.9521446}
confusion matrix:
       0     1
0  42362    36
1     99  1343
---- Validation: 
scalar performance:
{'acc': 0.9853255, 'precision': 0.9347671, 'recall': 0.84003747, 'specificity': 0.84003747, 'f1': 0.88114774, 'auroc': 0.96641755, 'binary_precision': 0.88122606, 'binary_recall': 0.68350667, 'binary_specificity': 0.9965683, 'binary_f1_score': 0.76987445}
confusion matrix:
       0    1
0  18005   62
1    213  460
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959233, 'precision': 0.76687396, 'recall': 0.5520803, 'specificity': 0.5520803, 'f1': 0.58016294, 'auroc': 0.9216075, 'binary_precision': 0.5714286, 'binary_recall': 0.10769231, 'binary_specificity': 0.9964682, 'binary_f1_score': 0.18122979}
confusion matrix:
      0   1
0  5925  21
1   232  28
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863191.png
early stop counter: 15
val acc:0.9853255152702332, best validation acc: 0.987299919128418, corresponding to test acc:                         0.9627779722213745 / 0.9705123901367188
after epoch: 30,now: 2024-05-27 12:11:56.397086,epoch time: 0:24:16.885057,used: 11:43:57.329389,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_27_59_seed_1_20863191
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 11:43:57.329389 at 2024-05-27 12:11:56.397086
persisted model performance metric: 

scalar performance:
{'acc': 0.9606832, 'precision': 0.7965311, 'recall': 0.57306594, 'specificity': 0.57306594, 'f1': 0.611027, 'auroc': 0.9482863, 'binary_precision': 0.62903225, 'binary_recall': 0.15, 'binary_specificity': 0.99613184, 'binary_f1_score': 0.24223605}
confusion matrix:
      0   1
0  5923  23
1   221  39
oracle model performance metric: 

scalar performance:
{'acc': 0.96890104, 'precision': 0.8895644, 'recall': 0.66746485, 'specificity': 0.66746485, 'f1': 0.73046947, 'auroc': 0.94138867, 'binary_precision': 0.80733943, 'binary_recall': 0.33846155, 'binary_specificity': 0.9964682, 'binary_f1_score': 0.47696477}
confusion matrix:
      0   1
0  5925  21
1   172  88
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs32/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs32/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1657 MiB |   5047 MiB |   1655 TiB |   1655 TiB |
|       from large pool |   1651 MiB |   5037 MiB |   1643 TiB |   1643 TiB |
|       from small pool |      5 MiB |     10 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1657 MiB |   5047 MiB |   1655 TiB |   1655 TiB |
|       from large pool |   1651 MiB |   5037 MiB |   1643 TiB |   1643 TiB |
|       from small pool |      5 MiB |     10 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1653 MiB |   5033 MiB |   1651 TiB |   1651 TiB |
|       from large pool |   1647 MiB |   5024 MiB |   1639 TiB |   1639 TiB |
|       from small pool |      5 MiB |     10 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   5412 MiB |   5446 MiB |   8962 MiB |   3550 MiB |
|       from large pool |   5400 MiB |   5434 MiB |   8948 MiB |   3548 MiB |
|       from small pool |     12 MiB |     12 MiB |     14 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 356720 KiB | 446371 KiB | 486407 GiB | 486406 GiB |
|       from large pool | 352576 KiB | 444960 KiB | 473738 GiB | 473737 GiB |
|       from small pool |   4144 KiB |   9631 KiB |  12669 GiB |  12669 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2178    |    3603    |  140865 K  |  140863 K  |
|       from large pool |     247    |     352    |   54522 K  |   54521 K  |
|       from small pool |    1931    |    3355    |   86343 K  |   86341 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2178    |    3603    |  140865 K  |  140863 K  |
|       from large pool |     247    |     352    |   54522 K  |   54521 K  |
|       from small pool |    1931    |    3355    |   86343 K  |   86341 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     160    |     160    |     227    |      67    |
|       from large pool |     154    |     154    |     220    |      66    |
|       from small pool |       6    |       6    |       7    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     109    |    1468    |   68410 K  |   68410 K  |
|       from large pool |      88    |     114    |   32510 K  |   32510 K  |
|       from small pool |      21    |    1380    |   35899 K  |   35899 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   5047 MiB |   1655 TiB |   1655 TiB |
|       from large pool |  16640 KiB |   5037 MiB |   1643 TiB |   1643 TiB |
|       from small pool |      0 KiB |     10 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   5047 MiB |   1655 TiB |   1655 TiB |
|       from large pool |  16640 KiB |   5037 MiB |   1643 TiB |   1643 TiB |
|       from small pool |      0 KiB |     10 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   5033 MiB |   1651 TiB |   1651 TiB |
|       from large pool |  16640 KiB |   5024 MiB |   1639 TiB |   1639 TiB |
|       from small pool |      0 KiB |     10 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2006 MiB |   5446 MiB |   8962 MiB |   6956 MiB |
|       from large pool |   1996 MiB |   5434 MiB |   8948 MiB |   6952 MiB |
|       from small pool |     10 MiB |     12 MiB |     14 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 446371 KiB | 486408 GiB | 486408 GiB |
|       from large pool |  24320 KiB | 444960 KiB | 473739 GiB | 473739 GiB |
|       from small pool |      0 KiB |   9759 KiB |  12669 GiB |  12669 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3603    |  140865 K  |  140865 K  |
|       from large pool |       2    |     352    |   54522 K  |   54522 K  |
|       from small pool |       0    |    3355    |   86343 K  |   86343 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3603    |  140865 K  |  140865 K  |
|       from large pool |       2    |     352    |   54522 K  |   54522 K  |
|       from small pool |       0    |    3355    |   86343 K  |   86343 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      93    |     160    |     227    |     134    |
|       from large pool |      88    |     154    |     220    |     132    |
|       from small pool |       5    |       6    |       7    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1468    |   68411 K  |   68411 K  |
|       from large pool |       3    |     114    |   32510 K  |   32510 K  |
|       from small pool |       0    |    1380    |   35900 K  |   35900 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Mon May 27 12:14:09 2024]
Finished job 0.
1 of 1 steps (100%) done
