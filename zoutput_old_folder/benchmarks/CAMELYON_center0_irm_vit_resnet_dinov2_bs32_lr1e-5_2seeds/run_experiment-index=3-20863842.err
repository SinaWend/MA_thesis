Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sun May 26 18:31:24 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs32/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs32/rule_results/3.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=3
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_18_37_45_seed_0_20863842

 Experiment start at: 2024-05-26 18:37:45.035444
before training, model accuracy: 0.6388623118400574
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96795046, 'precision': 0.7532009, 'recall': 0.75867915, 'specificity': 0.75867915, 'f1': 0.7559074, 'auroc': 0.95292366, 'binary_precision': 0.5226064, 'binary_recall': 0.53433037, 'binary_specificity': 0.983028, 'binary_f1_score': 0.52840334}
confusion matrix:
       0    1
0  41587  718
1    685  786
---- Validation: 
scalar performance:
{'acc': 0.9656237, 'precision': 0.73999536, 'recall': 0.74143517, 'specificity': 0.74143517, 'f1': 0.7407129, 'auroc': 0.9546015, 'binary_precision': 0.49768162, 'binary_recall': 0.5007776, 'binary_specificity': 0.9820927, 'binary_f1_score': 0.4992248}
confusion matrix:
       0    1
0  17824  325
1    321  322
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.978907, 'precision': 0.9716369, 'recall': 0.7562881, 'specificity': 0.7562881, 'f1': 0.82955265, 'auroc': 0.944944, 'binary_precision': 0.9640288, 'binary_recall': 0.51341, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.67}
confusion matrix:
      0    1
0  5992    5
1   127  134
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863842.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-26 18:57:09.606408,epoch time: 0:19:24.570964,used: 0:19:24.570964,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_18_37_45_seed_0_20863842
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9708744, 'precision': 0.8592963, 'recall': 0.60035694, 'specificity': 0.60035694, 'f1': 0.6521964, 'auroc': 0.9552942, 'binary_precision': 0.7456359, 'binary_recall': 0.203125, 'binary_specificity': 0.9975889, 'binary_f1_score': 0.3192739}
confusion matrix:
       0    1
0  42202  102
1   1173  299
---- Validation: 
scalar performance:
{'acc': 0.9684972, 'precision': 0.863595, 'recall': 0.55765915, 'specificity': 0.55765915, 'f1': 0.59304386, 'auroc': 0.9512658, 'binary_precision': 0.75757575, 'binary_recall': 0.11664075, 'binary_specificity': 0.9986776, 'binary_f1_score': 0.20215634}
confusion matrix:
       0   1
0  18125  24
1    568  75
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.98022103, 'recall': 0.52681994, 'specificity': 0.52681994, 'f1': 0.54082, 'auroc': 0.9312571, 'binary_precision': 1.0, 'binary_recall': 0.053639848, 'binary_specificity': 1.0, 'binary_f1_score': 0.10181818}
confusion matrix:
      0   1
0  5997   0
1   247  14
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863842.png
better model found
persisted
after epoch: 2,now: 2024-05-26 19:15:22.951551,epoch time: 0:18:13.345143,used: 0:37:37.916107,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_18_37_45_seed_0_20863842
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9676307, 'precision': 0.8493451, 'recall': 0.52820504, 'specificity': 0.52820504, 'f1': 0.5447553, 'auroc': 0.96775955, 'binary_precision': 0.7304348, 'binary_recall': 0.057142857, 'binary_specificity': 0.9992672, 'binary_f1_score': 0.10599369}
confusion matrix:
       0   1
0  42275  31
1   1386  84
---- Validation: 
scalar performance:
{'acc': 0.9683908, 'precision': 0.9228157, 'recall': 0.5441031, 'specificity': 0.5441031, 'f1': 0.57245445, 'auroc': 0.96251065, 'binary_precision': 0.8769231, 'binary_recall': 0.08864697, 'binary_specificity': 0.9995592, 'binary_f1_score': 0.16101696}
confusion matrix:
       0   1
0  18141   8
1    586  57
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9592522, 'precision': 0.9796065, 'recall': 0.5114943, 'specificity': 0.5114943, 'f1': 0.5120629, 'auroc': 0.95792085, 'binary_precision': 1.0, 'binary_recall': 0.022988506, 'binary_specificity': 1.0, 'binary_f1_score': 0.044943817}
confusion matrix:
      0  1
0  5997  0
1   255  6
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863842.png
early stop counter: 1
val acc:0.9683908224105835, best validation acc: 0.9684972167015076, corresponding to test acc:                         0.9605305194854736 / 0.9789069890975952
after epoch: 3,now: 2024-05-26 19:33:16.701165,epoch time: 0:17:53.749614,used: 0:55:31.665721,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_18_37_45_seed_0_20863842
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9669225, 'precision': 0.7490474, 'recall': 0.890694, 'specificity': 0.890694, 'f1': 0.80221987, 'auroc': 0.9694458, 'binary_precision': 0.50487906, 'binary_recall': 0.8089735, 'binary_specificity': 0.9724146, 'binary_f1_score': 0.62173456}
confusion matrix:
       0     1
0  41138  1167
1    281  1190
---- Validation: 
scalar performance:
{'acc': 0.97307366, 'precision': 0.7876872, 'recall': 0.85780036, 'specificity': 0.85780036, 'f1': 0.81851554, 'auroc': 0.9703032, 'binary_precision': 0.58488226, 'binary_recall': 0.7340591, 'binary_specificity': 0.9815417, 'binary_f1_score': 0.6510345}
confusion matrix:
       0    1
0  17814  335
1    171  472
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97619045, 'precision': 0.8392618, 'recall': 0.88496643, 'specificity': 0.88496643, 'f1': 0.8604957, 'auroc': 0.95927143, 'binary_precision': 0.68791944, 'binary_recall': 0.7854406, 'binary_specificity': 0.98449224, 'binary_f1_score': 0.73345256}
confusion matrix:
      0    1
0  5904   93
1    56  205
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863842.png
better model found
persisted
after epoch: 4,now: 2024-05-26 19:51:07.292187,epoch time: 0:17:50.591022,used: 1:13:22.256743,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_18_37_45_seed_0_20863842
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9718567, 'precision': 0.775733, 'recall': 0.8648622, 'specificity': 0.8648622, 'f1': 0.8133985, 'auroc': 0.9675487, 'binary_precision': 0.560244, 'binary_recall': 0.7501702, 'binary_specificity': 0.97955424, 'binary_f1_score': 0.6414435}
confusion matrix:
       0     1
0  41442   865
1    367  1102
---- Validation: 
scalar performance:
{'acc': 0.97318006, 'precision': 0.7861756, 'recall': 0.8811072, 'specificity': 0.8811072, 'f1': 0.82612693, 'auroc': 0.9673916, 'binary_precision': 0.58016145, 'binary_recall': 0.7822706, 'binary_specificity': 0.9799438, 'binary_f1_score': 0.6662252}
confusion matrix:
       0    1
0  17785  364
1    140  503
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9705976, 'precision': 0.8069062, 'recall': 0.85822797, 'specificity': 0.85822797, 'f1': 0.8303281, 'auroc': 0.95333606, 'binary_precision': 0.62540716, 'binary_recall': 0.7356322, 'binary_specificity': 0.98082376, 'binary_f1_score': 0.67605627}
confusion matrix:
      0    1
0  5882  115
1    69  192
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863842.png
better model found
persisted
after epoch: 5,now: 2024-05-26 20:09:00.313155,epoch time: 0:17:53.020968,used: 1:31:15.277711,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_18_37_45_seed_0_20863842
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9712171, 'precision': 0.77284014, 'recall': 0.85035956, 'specificity': 0.85035956, 'f1': 0.80623484, 'auroc': 0.9720266, 'binary_precision': 0.5554974, 'binary_recall': 0.72078806, 'binary_specificity': 0.979931, 'binary_f1_score': 0.62743944}
confusion matrix:
       0     1
0  41455   849
1    411  1061
---- Validation: 
scalar performance:
{'acc': 0.9721158, 'precision': 0.78581274, 'recall': 0.81230116, 'specificity': 0.81230116, 'f1': 0.79840755, 'auroc': 0.9703068, 'binary_precision': 0.58439714, 'binary_recall': 0.6407465, 'binary_specificity': 0.98385584, 'binary_f1_score': 0.6112759}
confusion matrix:
       0    1
0  17856  293
1    231  412
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97714925, 'precision': 0.9119816, 'recall': 0.77552664, 'specificity': 0.77552664, 'f1': 0.8289556, 'auroc': 0.95241874, 'binary_precision': 0.84302324, 'binary_recall': 0.5555556, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.6697459}
confusion matrix:
      0    1
0  5970   27
1   116  145
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863842.png
early stop counter: 1
val acc:0.9721158146858215, best validation acc: 0.9731800556182861, corresponding to test acc:                         0.9705976247787476 / 0.9789069890975952
after epoch: 6,now: 2024-05-26 20:27:10.827310,epoch time: 0:18:10.514155,used: 1:49:25.791866,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_18_37_45_seed_0_20863842
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97836715, 'precision': 0.83624476, 'recall': 0.82542074, 'specificity': 0.82542074, 'f1': 0.83073604, 'auroc': 0.9791271, 'binary_precision': 0.68424755, 'binary_recall': 0.6614548, 'binary_specificity': 0.9893866, 'binary_f1_score': 0.67265815}
confusion matrix:
       0    1
0  41856  449
1    498  973
---- Validation: 
scalar performance:
{'acc': 0.98036397, 'precision': 0.87948316, 'recall': 0.79857004, 'specificity': 0.79857004, 'f1': 0.8338014, 'auroc': 0.97608846, 'binary_precision': 0.7729084, 'binary_recall': 0.60342145, 'binary_specificity': 0.9937187, 'binary_f1_score': 0.67772925}
confusion matrix:
       0    1
0  18035  114
1    255  388
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.979706, 'precision': 0.94037354, 'recall': 0.7878547, 'specificity': 0.7878547, 'f1': 0.8467278, 'auroc': 0.96302235, 'binary_precision': 0.89880955, 'binary_recall': 0.5785441, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.70396274}
confusion matrix:
      0    1
0  5980   17
1   110  151
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863842.png
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-05-26 20:45:17.107089,epoch time: 0:18:06.279779,used: 2:07:32.071645,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_18_37_45_seed_0_20863842
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9796464, 'precision': 0.8944911, 'recall': 0.75800365, 'specificity': 0.75800365, 'f1': 0.8109038, 'auroc': 0.9791656, 'binary_precision': 0.8054679, 'binary_recall': 0.52038044, 'binary_specificity': 0.99562687, 'binary_f1_score': 0.63227403}
confusion matrix:
       0    1
0  42119  185
1    706  766
---- Validation: 
scalar performance:
{'acc': 0.9760004, 'precision': 0.89721215, 'recall': 0.69130325, 'specificity': 0.69130325, 'f1': 0.75572467, 'auroc': 0.9754282, 'binary_precision': 0.81578946, 'binary_recall': 0.38569206, 'binary_specificity': 0.99691445, 'binary_f1_score': 0.52375925}
confusion matrix:
       0    1
0  18093   56
1    395  248
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606903, 'precision': 0.8601259, 'recall': 0.54156196, 'specificity': 0.54156196, 'f1': 0.56580156, 'auroc': 0.964435, 'binary_precision': 0.7586207, 'binary_recall': 0.08429119, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.15172414}
confusion matrix:
      0   1
0  5990   7
1   239  22
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863842.png
early stop counter: 1
val acc:0.9760004281997681, best validation acc: 0.9803639650344849, corresponding to test acc:                         0.9797059893608093 / 0.9797059893608093
after epoch: 8,now: 2024-05-26 21:03:17.517495,epoch time: 0:18:00.410406,used: 2:25:32.482051,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_18_37_45_seed_0_20863842
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98234195, 'precision': 0.8930873, 'recall': 0.8143537, 'specificity': 0.8143537, 'f1': 0.8489913, 'auroc': 0.98114294, 'binary_precision': 0.79880136, 'binary_recall': 0.6342624, 'binary_specificity': 0.9944451, 'binary_f1_score': 0.707086}
confusion matrix:
       0    1
0  42070  235
1    538  933
---- Validation: 
scalar performance:
{'acc': 0.9814815, 'precision': 0.919049, 'recall': 0.77514684, 'specificity': 0.77514684, 'f1': 0.8310851, 'auroc': 0.97967374, 'binary_precision': 0.853717, 'binary_recall': 0.55365473, 'binary_specificity': 0.99663895, 'binary_f1_score': 0.6716981}
confusion matrix:
       0    1
0  18088   61
1    287  356
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96212846, 'precision': 0.8745173, 'recall': 0.56246805, 'specificity': 0.56246805, 'f1': 0.5992082, 'auroc': 0.9621645, 'binary_precision': 0.78571427, 'binary_recall': 0.12643678, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.21782179}
confusion matrix:
      0   1
0  5988   9
1   228  33
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863842.png
better model found
persisted
after epoch: 9,now: 2024-05-26 21:21:18.121027,epoch time: 0:18:00.603532,used: 2:43:33.085583,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_18_37_45_seed_0_20863842
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9793951, 'precision': 0.893122, 'recall': 0.75410175, 'specificity': 0.75410175, 'f1': 0.80756605, 'auroc': 0.98232585, 'binary_precision': 0.8029819, 'binary_recall': 0.51257646, 'binary_specificity': 0.995627, 'binary_f1_score': 0.6257261}
confusion matrix:
       0    1
0  42120  185
1    717  754
---- Validation: 
scalar performance:
{'acc': 0.97679865, 'precision': 0.92338634, 'recall': 0.6887163, 'specificity': 0.6887163, 'f1': 0.7581227, 'auroc': 0.97792375, 'binary_precision': 0.8683274, 'binary_recall': 0.37947124, 'binary_specificity': 0.99796134, 'binary_f1_score': 0.5281385}
confusion matrix:
       0    1
0  18112   37
1    399  244
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.8716722, 'recall': 0.5473091, 'specificity': 0.5473091, 'f1': 0.5753839, 'auroc': 0.9555616, 'binary_precision': 0.78125, 'binary_recall': 0.09578544, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.17064846}
confusion matrix:
      0   1
0  5990   7
1   236  25
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863842.png
early stop counter: 1
val acc:0.9767986536026001, best validation acc: 0.9814814925193787, corresponding to test acc:                         0.9621284604072571 / 0.9797059893608093
after epoch: 10,now: 2024-05-26 21:39:23.419588,epoch time: 0:18:05.298561,used: 3:01:38.384144,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_18_37_45_seed_0_20863842
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9843978, 'precision': 0.87657523, 'recall': 0.88620967, 'specificity': 0.88620967, 'f1': 0.8813263, 'auroc': 0.98583776, 'binary_precision': 0.7607687, 'binary_recall': 0.7809524, 'binary_specificity': 0.99146694, 'binary_f1_score': 0.7707284}
confusion matrix:
       0     1
0  41945   361
1    322  1148
---- Validation: 
scalar performance:
{'acc': 0.98424864, 'precision': 0.8963739, 'recall': 0.8545852, 'specificity': 0.8545852, 'f1': 0.8742199, 'auroc': 0.9803297, 'binary_precision': 0.8027923, 'binary_recall': 0.7153966, 'binary_specificity': 0.99377376, 'binary_f1_score': 0.7565789}
confusion matrix:
       0    1
0  18036  113
1    183  460
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96580374, 'precision': 0.8243867, 'recall': 0.66882867, 'specificity': 0.66882867, 'f1': 0.7195995, 'auroc': 0.9551228, 'binary_precision': 0.6766917, 'binary_recall': 0.3448276, 'binary_specificity': 0.99282974, 'binary_f1_score': 0.4568528}
confusion matrix:
      0   1
0  5954  43
1   171  90
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863842.png
better model found
persisted
after epoch: 11,now: 2024-05-26 21:57:30.453833,epoch time: 0:18:07.034245,used: 3:19:45.418389,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_18_37_45_seed_0_20863842
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9724735, 'precision': 0.7760296, 'recall': 0.94081044, 'specificity': 0.94081044, 'f1': 0.8372357, 'auroc': 0.98414785, 'binary_precision': 0.5553705, 'binary_recall': 0.9068661, 'binary_specificity': 0.97475475, 'binary_f1_score': 0.6888716}
confusion matrix:
       0     1
0  41237  1068
1    137  1334
---- Validation: 
scalar performance:
{'acc': 0.9785547, 'precision': 0.8162501, 'recall': 0.9243927, 'specificity': 0.9243927, 'f1': 0.86158514, 'auroc': 0.9821474, 'binary_precision': 0.6372998, 'binary_recall': 0.86625195, 'binary_specificity': 0.98253345, 'binary_f1_score': 0.73434407}
confusion matrix:
       0    1
0  17832  317
1     86  557
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97347397, 'precision': 0.837976, 'recall': 0.8230821, 'specificity': 0.8230821, 'f1': 0.8303417, 'auroc': 0.9565284, 'binary_precision': 0.69076306, 'binary_recall': 0.65900385, 'binary_specificity': 0.98716027, 'binary_f1_score': 0.67450976}
confusion matrix:
      0    1
0  5920   77
1    89  172
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863842.png
early stop counter: 1
val acc:0.9785547256469727, best validation acc: 0.9842486381530762, corresponding to test acc:                         0.9658037424087524 / 0.9797059893608093
after epoch: 12,now: 2024-05-26 22:15:39.528695,epoch time: 0:18:09.074862,used: 3:37:54.493251,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_18_37_45_seed_0_20863842
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.97932655, 'precision': 0.82577324, 'recall': 0.89179385, 'specificity': 0.89179385, 'f1': 0.8554444, 'auroc': 0.98184085, 'binary_precision': 0.65861875, 'binary_recall': 0.7979592, 'binary_specificity': 0.98562855, 'binary_f1_score': 0.7216241}
confusion matrix:
       0     1
0  41698   608
1    297  1173
---- Validation: 
scalar performance:
{'acc': 0.98063004, 'precision': 0.84230477, 'recall': 0.8842141, 'specificity': 0.8842141, 'f1': 0.8619337, 'auroc': 0.9785995, 'binary_precision': 0.6924138, 'binary_recall': 0.7807154, 'binary_specificity': 0.9877128, 'binary_f1_score': 0.73391813}
confusion matrix:
       0    1
0  17926  223
1    141  502
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.8090857, 'recall': 0.62160295, 'specificity': 0.62160295, 'f1': 0.6705531, 'auroc': 0.9535272, 'binary_precision': 0.65, 'binary_recall': 0.24904214, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.36011076}
confusion matrix:
      0   1
0  5962  35
1   196  65
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863842.png
early stop counter: 2
val acc:0.9806300401687622, best validation acc: 0.9842486381530762, corresponding to test acc:                         0.9658037424087524 / 0.9797059893608093
after epoch: 13,now: 2024-05-26 22:33:40.467741,epoch time: 0:18:00.939046,used: 3:55:55.432297,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_18_37_45_seed_0_20863842
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98519737, 'precision': 0.90762603, 'recall': 0.85224867, 'specificity': 0.85224867, 'f1': 0.87775886, 'auroc': 0.98677576, 'binary_precision': 0.82529646, 'binary_recall': 0.70972127, 'binary_specificity': 0.994776, 'binary_f1_score': 0.76315784}
confusion matrix:
       0     1
0  42084   221
1    427  1044
---- Validation: 
scalar performance:
{'acc': 0.9843018, 'precision': 0.9160306, 'recall': 0.8298609, 'specificity': 0.8298609, 'f1': 0.8675792, 'auroc': 0.9816128, 'binary_precision': 0.8438735, 'binary_recall': 0.66407466, 'binary_specificity': 0.99564713, 'binary_f1_score': 0.743255}
confusion matrix:
       0    1
0  18070   79
1    216  427
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590924, 'precision': 0.760003, 'recall': 0.5443929, 'specificity': 0.5443929, 'f1': 0.5684659, 'auroc': 0.95610833, 'binary_precision': 0.55813956, 'binary_recall': 0.09195402, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.15789475}
confusion matrix:
      0   1
0  5978  19
1   237  24
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863842.png
better model found
persisted
after epoch: 14,now: 2024-05-26 22:51:38.069685,epoch time: 0:17:57.601944,used: 4:13:53.034241,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_18_37_45_seed_0_20863842
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9785727, 'precision': 0.8151214, 'recall': 0.91569936, 'specificity': 0.91569936, 'f1': 0.8577696, 'auroc': 0.9853089, 'binary_precision': 0.63557595, 'binary_recall': 0.8482993, 'binary_specificity': 0.98309934, 'binary_f1_score': 0.72669}
confusion matrix:
       0     1
0  41591   715
1    223  1247
---- Validation: 
scalar performance:
{'acc': 0.9810558, 'precision': 0.83905196, 'recall': 0.90768623, 'specificity': 0.90768623, 'f1': 0.8699019, 'auroc': 0.9818709, 'binary_precision': 0.68421054, 'binary_recall': 0.8289269, 'binary_specificity': 0.98644555, 'binary_f1_score': 0.7496484}
confusion matrix:
       0    1
0  17903  246
1    110  533
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9637264, 'precision': 0.77727103, 'recall': 0.7373735, 'specificity': 0.7373735, 'f1': 0.755578, 'auroc': 0.95565534, 'binary_precision': 0.5765766, 'binary_recall': 0.49042144, 'binary_specificity': 0.98432547, 'binary_f1_score': 0.5300207}
confusion matrix:
      0    1
0  5903   94
1   133  128
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863842.png
early stop counter: 1
val acc:0.9810557961463928, best validation acc: 0.9843018054962158, corresponding to test acc:                         0.959092378616333 / 0.9797059893608093
after epoch: 15,now: 2024-05-26 23:09:38.802690,epoch time: 0:18:00.733005,used: 4:31:53.767246,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_18_37_45_seed_0_20863842
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9856314, 'precision': 0.893319, 'recall': 0.8827344, 'specificity': 0.8827344, 'f1': 0.8879485, 'auroc': 0.98766464, 'binary_precision': 0.7945493, 'binary_recall': 0.7724185, 'binary_specificity': 0.9930503, 'binary_f1_score': 0.7833277}
confusion matrix:
       0     1
0  42010   294
1    335  1137
---- Validation: 
scalar performance:
{'acc': 0.98472756, 'precision': 0.9168174, 'recall': 0.8368318, 'specificity': 0.8368318, 'f1': 0.87224674, 'auroc': 0.98350614, 'binary_precision': 0.8449612, 'binary_recall': 0.67807156, 'binary_specificity': 0.99559206, 'binary_f1_score': 0.75237274}
confusion matrix:
       0    1
0  18069   80
1    207  436
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9696389, 'precision': 0.86857927, 'recall': 0.69465, 'specificity': 0.69465, 'f1': 0.7522627, 'auroc': 0.9626785, 'binary_precision': 0.76296294, 'binary_recall': 0.394636, 'binary_specificity': 0.994664, 'binary_f1_score': 0.520202}
confusion matrix:
      0    1
0  5965   32
1   158  103
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863842.png
better model found
persisted
after epoch: 16,now: 2024-05-26 23:27:44.412620,epoch time: 0:18:05.609930,used: 4:49:59.377176,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_18_37_45_seed_0_20863842
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9868421, 'precision': 0.900283, 'recall': 0.8960788, 'specificity': 0.8960788, 'f1': 0.8981689, 'auroc': 0.9886087, 'binary_precision': 0.80756015, 'binary_recall': 0.7987763, 'binary_specificity': 0.9933814, 'binary_f1_score': 0.8031442}
confusion matrix:
       0     1
0  42025   280
1    296  1175
---- Validation: 
scalar performance:
{'acc': 0.9853661, 'precision': 0.9122294, 'recall': 0.8544136, 'specificity': 0.8544136, 'f1': 0.88096595, 'auroc': 0.97654915, 'binary_precision': 0.83454543, 'binary_recall': 0.7138414, 'binary_specificity': 0.99498594, 'binary_f1_score': 0.76948863}
confusion matrix:
       0    1
0  18058   91
1    184  459
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96276766, 'precision': 0.8186884, 'recall': 0.6031129, 'specificity': 0.6031129, 'f1': 0.6507795, 'auroc': 0.9594124, 'binary_precision': 0.6707317, 'binary_recall': 0.21072797, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.32069972}
confusion matrix:
      0   1
0  5970  27
1   206  55
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863842.png
better model found
persisted
after epoch: 17,now: 2024-05-26 23:45:52.696923,epoch time: 0:18:08.284303,used: 5:08:07.661479,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_18_37_45_seed_0_20863842
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98394096, 'precision': 0.9409599, 'recall': 0.7943226, 'specificity': 0.7943226, 'f1': 0.8519895, 'auroc': 0.9882598, 'binary_precision': 0.8959835, 'binary_recall': 0.5910326, 'binary_specificity': 0.99761254, 'binary_f1_score': 0.712239}
confusion matrix:
       0    1
0  42203  101
1    602  870
---- Validation: 
scalar performance:
{'acc': 0.9795126, 'precision': 0.9395441, 'recall': 0.72537386, 'specificity': 0.72537386, 'f1': 0.7956736, 'auroc': 0.9808002, 'binary_precision': 0.8981481, 'binary_recall': 0.4525661, 'binary_specificity': 0.9981817, 'binary_f1_score': 0.6018614}
confusion matrix:
       0    1
0  18116   33
1    352  291
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9637264, 'precision': 0.884372, 'recall': 0.5852898, 'specificity': 0.5852898, 'f1': 0.6326518, 'auroc': 0.9647292, 'binary_precision': 0.8035714, 'binary_recall': 0.1724138, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.28391168}
confusion matrix:
      0   1
0  5986  11
1   216  45
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863842.png
early stop counter: 1
val acc:0.9795125722885132, best validation acc: 0.9853661060333252, corresponding to test acc:                         0.9627676606178284 / 0.9797059893608093
after epoch: 18,now: 2024-05-27 00:03:58.915389,epoch time: 0:18:06.218466,used: 5:26:13.879945,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_18_37_45_seed_0_20863842
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.98519737, 'precision': 0.93031585, 'recall': 0.8261188, 'specificity': 0.8261188, 'f1': 0.8705082, 'auroc': 0.9898437, 'binary_precision': 0.87251353, 'binary_recall': 0.6555706, 'binary_specificity': 0.99666697, 'binary_f1_score': 0.7486423}
confusion matrix:
       0    1
0  42163  141
1    507  965
---- Validation: 
scalar performance:
{'acc': 0.9803108, 'precision': 0.92720205, 'recall': 0.74753875, 'specificity': 0.74753875, 'f1': 0.8117734, 'auroc': 0.97809076, 'binary_precision': 0.8719346, 'binary_recall': 0.4976672, 'binary_specificity': 0.9974103, 'binary_f1_score': 0.63366336}
confusion matrix:
       0    1
0  18102   47
1    323  320
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96644294, 'precision': 0.90398836, 'recall': 0.61968917, 'specificity': 0.61968917, 'f1': 0.67887926, 'auroc': 0.95807326, 'binary_precision': 0.84, 'binary_recall': 0.2413793, 'binary_specificity': 0.997999, 'binary_f1_score': 0.375}
confusion matrix:
      0   1
0  5985  12
1   198  63
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863842.png
early stop counter: 2
val acc:0.9803107976913452, best validation acc: 0.9853661060333252, corresponding to test acc:                         0.9627676606178284 / 0.9797059893608093
after epoch: 19,now: 2024-05-27 00:22:01.305781,epoch time: 0:18:02.390392,used: 5:44:16.270337,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_18_37_45_seed_0_20863842
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9865908, 'precision': 0.940087, 'recall': 0.84072316, 'specificity': 0.84072316, 'f1': 0.88361716, 'auroc': 0.9920833, 'binary_precision': 0.89105403, 'binary_recall': 0.68435377, 'binary_specificity': 0.9970926, 'binary_f1_score': 0.77414393}
confusion matrix:
       0     1
0  42183   123
1    464  1006
---- Validation: 
scalar performance:
{'acc': 0.98334396, 'precision': 0.9457235, 'recall': 0.7851117, 'specificity': 0.7851117, 'f1': 0.84652674, 'auroc': 0.97342026, 'binary_precision': 0.90640396, 'binary_recall': 0.57231724, 'binary_specificity': 0.9979062, 'binary_f1_score': 0.7016206}
confusion matrix:
       0    1
0  18111   38
1    275  368
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.9030609, 'recall': 0.52090603, 'specificity': 0.52090603, 'f1': 0.5298535, 'auroc': 0.95133996, 'binary_precision': 0.84615386, 'binary_recall': 0.042145595, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.08029197}
confusion matrix:
      0   1
0  5995   2
1   250  11
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863842.png
early stop counter: 3
val acc:0.9833439588546753, best validation acc: 0.9853661060333252, corresponding to test acc:                         0.9627676606178284 / 0.9797059893608093
after epoch: 20,now: 2024-05-27 00:40:03.852812,epoch time: 0:18:02.547031,used: 6:02:18.817368,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_18_37_45_seed_0_20863842
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9865223, 'precision': 0.8829525, 'recall': 0.92150414, 'specificity': 0.92150414, 'f1': 0.9012228, 'auroc': 0.9901681, 'binary_precision': 0.7710769, 'binary_recall': 0.8518015, 'binary_specificity': 0.9912067, 'binary_f1_score': 0.80943155}
confusion matrix:
       0     1
0  41933   372
1    218  1253
---- Validation: 
scalar performance:
{'acc': 0.98621756, 'precision': 0.8917057, 'recall': 0.902858, 'specificity': 0.902858, 'f1': 0.89719677, 'auroc': 0.98140264, 'binary_precision': 0.79003024, 'binary_recall': 0.8133748, 'binary_specificity': 0.99234116, 'binary_f1_score': 0.8015326}
confusion matrix:
       0    1
0  18010  139
1    120  523
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608501, 'precision': 0.78276145, 'recall': 0.589286, 'specificity': 0.589286, 'f1': 0.6307009, 'auroc': 0.9504543, 'binary_precision': 0.6, 'binary_recall': 0.18390805, 'binary_specificity': 0.994664, 'binary_f1_score': 0.28152493}
confusion matrix:
      0   1
0  5965  32
1   213  48
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863842.png
better model found
persisted
after epoch: 21,now: 2024-05-27 00:58:04.978448,epoch time: 0:18:01.125636,used: 6:20:19.943004,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_18_37_45_seed_0_20863842
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9877102, 'precision': 0.92038614, 'recall': 0.88324916, 'specificity': 0.88324916, 'f1': 0.90089154, 'auroc': 0.99252033, 'binary_precision': 0.84868914, 'binary_recall': 0.77127296, 'binary_specificity': 0.99522537, 'binary_f1_score': 0.8081313}
confusion matrix:
       0     1
0  42105   202
1    336  1133
---- Validation: 
scalar performance:
{'acc': 0.9868561, 'precision': 0.9253404, 'recall': 0.8656858, 'specificity': 0.8656858, 'f1': 0.8930858, 'auroc': 0.9822042, 'binary_precision': 0.86, 'binary_recall': 0.7356143, 'binary_specificity': 0.99575734, 'binary_f1_score': 0.792959}
confusion matrix:
       0    1
0  18072   77
1    170  473
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9646852, 'precision': 0.8529316, 'recall': 0.6169397, 'specificity': 0.6169397, 'f1': 0.6706312, 'auroc': 0.9579574, 'binary_precision': 0.7380952, 'binary_recall': 0.23754789, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.3594203}
confusion matrix:
      0   1
0  5975  22
1   199  62
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863842.png
better model found
persisted
after epoch: 22,now: 2024-05-27 01:16:09.250201,epoch time: 0:18:04.271753,used: 6:38:24.214757,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_18_37_45_seed_0_20863842
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.98741317, 'precision': 0.9482697, 'recall': 0.84705836, 'specificity': 0.84705836, 'f1': 0.8907547, 'auroc': 0.9919832, 'binary_precision': 0.9069973, 'binary_recall': 0.69659865, 'binary_specificity': 0.99751806, 'binary_f1_score': 0.7879954}
confusion matrix:
       0     1
0  42201   105
1    446  1024
---- Validation: 
scalar performance:
{'acc': 0.9830779, 'precision': 0.92796916, 'recall': 0.79547477, 'specificity': 0.79547477, 'f1': 0.84869397, 'auroc': 0.9809904, 'binary_precision': 0.87015945, 'binary_recall': 0.5940902, 'binary_specificity': 0.9968593, 'binary_f1_score': 0.70609987}
confusion matrix:
       0    1
0  18092   57
1    261  382
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.8183303, 'recall': 0.56563246, 'specificity': 0.56563246, 'f1': 0.6018645, 'auroc': 0.9530396, 'binary_precision': 0.6730769, 'binary_recall': 0.13409962, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.22364217}
confusion matrix:
      0   1
0  5980  17
1   226  35
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863842.png
early stop counter: 1
val acc:0.983077883720398, best validation acc: 0.9868561029434204, corresponding to test acc:                         0.9646852016448975 / 0.9797059893608093
after epoch: 23,now: 2024-05-27 01:34:13.974083,epoch time: 0:18:04.723882,used: 6:56:28.938639,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_18_37_45_seed_0_20863842
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9826389, 'precision': 0.96637225, 'recall': 0.754962, 'specificity': 0.754962, 'f1': 0.8277, 'auroc': 0.9920057, 'binary_precision': 0.94949496, 'binary_recall': 0.51086956, 'binary_specificity': 0.9990545, 'binary_f1_score': 0.66431093}
confusion matrix:
       0    1
0  42264   40
1    720  752
---- Validation: 
scalar performance:
{'acc': 0.9786079, 'precision': 0.95409465, 'recall': 0.7024039, 'specificity': 0.7024039, 'f1': 0.7769847, 'auroc': 0.9799301, 'binary_precision': 0.9288256, 'binary_recall': 0.4059098, 'binary_specificity': 0.998898, 'binary_f1_score': 0.5649351}
confusion matrix:
       0    1
0  18129   20
1    382  261
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9653244, 'precision': 0.9000323, 'recall': 0.6044468, 'specificity': 0.6044468, 'f1': 0.65929425, 'auroc': 0.9540168, 'binary_precision': 0.8333333, 'binary_recall': 0.21072797, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.33639142}
confusion matrix:
      0   1
0  5986  11
1   206  55
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863842.png
early stop counter: 2
val acc:0.9786078929901123, best validation acc: 0.9868561029434204, corresponding to test acc:                         0.9646852016448975 / 0.9797059893608093
after epoch: 24,now: 2024-05-27 01:52:18.529322,epoch time: 0:18:04.555239,used: 7:14:33.493878,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_18_37_45_seed_0_20863842
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9863167, 'precision': 0.90868247, 'recall': 0.87292546, 'specificity': 0.87292546, 'f1': 0.88992, 'auroc': 0.99277115, 'binary_precision': 0.82598954, 'binary_recall': 0.7513587, 'binary_specificity': 0.99449223, 'binary_f1_score': 0.78690857}
confusion matrix:
       0     1
0  42071   233
1    366  1106
---- Validation: 
scalar performance:
{'acc': 0.98275864, 'precision': 0.920557, 'recall': 0.79680955, 'specificity': 0.79680955, 'f1': 0.847209, 'auroc': 0.9796501, 'binary_precision': 0.85523385, 'binary_recall': 0.59720063, 'binary_specificity': 0.99641854, 'binary_f1_score': 0.70329666}
confusion matrix:
       0    1
0  18084   65
1    259  384
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642058, 'precision': 0.9291785, 'recall': 0.5800429, 'specificity': 0.5800429, 'f1': 0.6271893, 'auroc': 0.95106924, 'binary_precision': 0.89361703, 'binary_recall': 0.16091955, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.27272728}
confusion matrix:
      0   1
0  5992   5
1   219  42
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863842.png
early stop counter: 3
val acc:0.982758641242981, best validation acc: 0.9868561029434204, corresponding to test acc:                         0.9646852016448975 / 0.9797059893608093
after epoch: 25,now: 2024-05-27 02:10:13.965156,epoch time: 0:17:55.435834,used: 7:32:28.929712,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_18_37_45_seed_0_20863842
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9838724, 'precision': 0.92339504, 'recall': 0.808912, 'specificity': 0.808912, 'f1': 0.85654247, 'auroc': 0.99171305, 'binary_precision': 0.8598307, 'binary_recall': 0.621346, 'binary_specificity': 0.99647796, 'binary_f1_score': 0.7213891}
confusion matrix:
       0    1
0  42156  149
1    557  914
---- Validation: 
scalar performance:
{'acc': 0.97945935, 'precision': 0.9040427, 'recall': 0.75159824, 'specificity': 0.75159824, 'f1': 0.8087845, 'auroc': 0.9805007, 'binary_precision': 0.8253164, 'binary_recall': 0.5069984, 'binary_specificity': 0.9961981, 'binary_f1_score': 0.628131}
confusion matrix:
       0    1
0  18080   69
1    317  326
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9613295, 'precision': 0.79156244, 'recall': 0.5932008, 'specificity': 0.5932008, 'f1': 0.6362596, 'auroc': 0.94656265, 'binary_precision': 0.61728394, 'binary_recall': 0.19157088, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.29239765}
confusion matrix:
      0   1
0  5966  31
1   211  50
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863842.png
early stop counter: 4
val acc:0.9794593453407288, best validation acc: 0.9868561029434204, corresponding to test acc:                         0.9646852016448975 / 0.9797059893608093
after epoch: 26,now: 2024-05-27 02:28:08.426926,epoch time: 0:17:54.461770,used: 7:50:23.391482,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_18_37_45_seed_0_20863842
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.98752743, 'precision': 0.96983236, 'recall': 0.8309308, 'specificity': 0.8309308, 'f1': 0.8875029, 'auroc': 0.99440813, 'binary_precision': 0.95126706, 'binary_recall': 0.6630435, 'binary_specificity': 0.9988181, 'binary_f1_score': 0.78142524}
confusion matrix:
       0    1
0  42254   50
1    496  976
---- Validation: 
scalar performance:
{'acc': 0.98201364, 'precision': 0.93895996, 'recall': 0.7679218, 'specificity': 0.7679218, 'f1': 0.83129907, 'auroc': 0.9808757, 'binary_precision': 0.89405686, 'binary_recall': 0.5381026, 'binary_specificity': 0.9977409, 'binary_f1_score': 0.67184466}
confusion matrix:
       0    1
0  18108   41
1    297  346
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96180886, 'precision': 0.8690053, 'recall': 0.5586366, 'specificity': 0.5586366, 'f1': 0.593207, 'auroc': 0.95860463, 'binary_precision': 0.775, 'binary_recall': 0.118773945, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.20598008}
confusion matrix:
      0   1
0  5988   9
1   230  31
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863842.png
early stop counter: 5
val acc:0.9820136427879333, best validation acc: 0.9868561029434204, corresponding to test acc:                         0.9646852016448975 / 0.9797059893608093
after epoch: 27,now: 2024-05-27 02:46:10.400251,epoch time: 0:18:01.973325,used: 8:08:25.364807,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_18_37_45_seed_0_20863842
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9883041, 'precision': 0.914166, 'recall': 0.9032694, 'specificity': 0.9032694, 'f1': 0.9086391, 'auroc': 0.9941826, 'binary_precision': 0.83484954, 'binary_recall': 0.8121171, 'binary_specificity': 0.9944217, 'binary_f1_score': 0.82332635}
confusion matrix:
       0     1
0  42071   236
1    276  1193
---- Validation: 
scalar performance:
{'acc': 0.98403573, 'precision': 0.91446257, 'recall': 0.8267229, 'specificity': 0.8267229, 'f1': 0.86499333, 'auroc': 0.97846615, 'binary_precision': 0.8409543, 'binary_recall': 0.6578538, 'binary_specificity': 0.99559206, 'binary_f1_score': 0.73821986}
confusion matrix:
       0    1
0  18069   80
1    220  423
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9576542, 'precision': 0.71453696, 'recall': 0.55097187, 'specificity': 0.55097187, 'f1': 0.5763623, 'auroc': 0.91757697, 'binary_precision': 0.46666667, 'binary_recall': 0.107279696, 'binary_specificity': 0.994664, 'binary_f1_score': 0.17445484}
confusion matrix:
      0   1
0  5965  32
1   233  28
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863842.png
early stop counter: 6
val acc:0.9840357303619385, best validation acc: 0.9868561029434204, corresponding to test acc:                         0.9646852016448975 / 0.9797059893608093
after epoch: 28,now: 2024-05-27 03:04:12.583926,epoch time: 0:18:02.183675,used: 8:26:27.548482,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_18_37_45_seed_0_20863842
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.991091, 'precision': 0.9287431, 'recall': 0.9349378, 'specificity': 0.9349378, 'f1': 0.9318164, 'auroc': 0.9954581, 'binary_precision': 0.8618377, 'binary_recall': 0.8747447, 'binary_specificity': 0.99513084, 'binary_f1_score': 0.8682432}
confusion matrix:
       0     1
0  42101   206
1    184  1285
---- Validation: 
scalar performance:
{'acc': 0.9870157, 'precision': 0.91862226, 'recall': 0.8770193, 'specificity': 0.8770193, 'f1': 0.89664507, 'auroc': 0.98287, 'binary_precision': 0.8457539, 'binary_recall': 0.7589425, 'binary_specificity': 0.99509615, 'binary_f1_score': 0.8}
confusion matrix:
       0    1
0  18060   89
1    155  488
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96276766, 'precision': 0.7913717, 'recall': 0.64159185, 'specificity': 0.64159185, 'f1': 0.6877991, 'auroc': 0.9513718, 'binary_precision': 0.61290324, 'binary_recall': 0.29118773, 'binary_specificity': 0.991996, 'binary_f1_score': 0.3948052}
confusion matrix:
      0   1
0  5949  48
1   185  76
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863842.png
better model found
persisted
after epoch: 29,now: 2024-05-27 03:22:16.599995,epoch time: 0:18:04.016069,used: 8:44:31.564551,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_18_37_45_seed_0_20863842
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9897204, 'precision': 0.91198075, 'recall': 0.9346418, 'specificity': 0.9346418, 'f1': 0.9229826, 'auroc': 0.9955108, 'binary_precision': 0.8282958, 'binary_recall': 0.87559485, 'binary_specificity': 0.9936887, 'binary_f1_score': 0.85128886}
confusion matrix:
       0     1
0  42038   267
1    183  1288
---- Validation: 
scalar performance:
{'acc': 0.98547256, 'precision': 0.896036, 'recall': 0.87997067, 'specificity': 0.87997067, 'f1': 0.88782287, 'auroc': 0.98571235, 'binary_precision': 0.8003247, 'binary_recall': 0.7667185, 'binary_specificity': 0.9932228, 'binary_f1_score': 0.7831612}
confusion matrix:
       0    1
0  18026  123
1    150  493
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590924, 'precision': 0.75666654, 'recall': 0.5498899, 'specificity': 0.5498899, 'f1': 0.57661015, 'auroc': 0.9490603, 'binary_precision': 0.5510204, 'binary_recall': 0.10344828, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.17419356}
confusion matrix:
      0   1
0  5975  22
1   234  27
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863842.png
early stop counter: 1
val acc:0.985472559928894, best validation acc: 0.9870157241821289, corresponding to test acc:                         0.9627676606178284 / 0.9797059893608093
after epoch: 30,now: 2024-05-27 03:40:21.545675,epoch time: 0:18:04.945680,used: 9:02:36.510231,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_18_37_45_seed_0_20863842
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 9:02:36.510231 at 2024-05-27 03:40:21.545675
persisted model performance metric: 

scalar performance:
{'acc': 0.96212846, 'precision': 0.7838609, 'recall': 0.6357614, 'specificity': 0.6357614, 'f1': 0.68083376, 'auroc': 0.949044, 'binary_precision': 0.59836066, 'binary_recall': 0.27969348, 'binary_specificity': 0.9918293, 'binary_f1_score': 0.38120106}
confusion matrix:
      0   1
0  5948  49
1   188  73
oracle model performance metric: 

scalar performance:
{'acc': 0.9785874, 'precision': 0.9329872, 'recall': 0.7781094, 'specificity': 0.7781094, 'f1': 0.8371812, 'auroc': 0.96187365, 'binary_precision': 0.8848485, 'binary_recall': 0.55938697, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.685446}
confusion matrix:
      0    1
0  5978   19
1   115  146
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs32/rule_results/3.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs32/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs32/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456443 KiB |  26075 MiB |   1107 TiB |   1107 TiB |
|       from large pool | 415344 KiB |  26030 MiB |   1100 TiB |   1100 TiB |
|       from small pool |  41099 KiB |     57 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 456443 KiB |  26075 MiB |   1107 TiB |   1107 TiB |
|       from large pool | 415344 KiB |  26030 MiB |   1100 TiB |   1100 TiB |
|       from small pool |  41099 KiB |     57 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447754 KiB |  26071 MiB |   1106 TiB |   1106 TiB |
|       from large pool | 407075 KiB |  26026 MiB |   1100 TiB |   1100 TiB |
|       from small pool |  40679 KiB |     56 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  27758 MiB |  27758 MiB |  27758 MiB |      0 B   |
|       from large pool |  27690 MiB |  27690 MiB |  27690 MiB |      0 B   |
|       from small pool |     68 MiB |     68 MiB |     68 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 733444 KiB |   1705 MiB | 527576 GiB | 527575 GiB |
|       from large pool | 719248 KiB |   1701 MiB | 520673 GiB | 520672 GiB |
|       from small pool |  14196 KiB |     21 MiB |   6902 GiB |   6902 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2312    |    3741    |   98677 K  |   98675 K  |
|       from large pool |     187    |    1413    |   51244 K  |   51244 K  |
|       from small pool |    2125    |    3552    |   47432 K  |   47430 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2312    |    3741    |   98677 K  |   98675 K  |
|       from large pool |     187    |    1413    |   51244 K  |   51244 K  |
|       from small pool |    2125    |    3552    |   47432 K  |   47430 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     835    |     835    |     835    |       0    |
|       from large pool |     801    |     801    |     801    |       0    |
|       from small pool |      34    |      34    |      34    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      85    |    1446    |   69800 K  |   69800 K  |
|       from large pool |      36    |     800    |   45213 K  |   45213 K  |
|       from small pool |      49    |    1409    |   24586 K  |   24586 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  26075 MiB |   1107 TiB |   1107 TiB |
|       from large pool |  16640 KiB |  26030 MiB |   1100 TiB |   1100 TiB |
|       from small pool |      0 KiB |     57 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  26075 MiB |   1107 TiB |   1107 TiB |
|       from large pool |  16640 KiB |  26030 MiB |   1100 TiB |   1100 TiB |
|       from small pool |      0 KiB |     57 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  26071 MiB |   1106 TiB |   1106 TiB |
|       from large pool |  16640 KiB |  26026 MiB |   1100 TiB |   1100 TiB |
|       from small pool |      0 KiB |     56 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1162 MiB |  27758 MiB |  27758 MiB |  26596 MiB |
|       from large pool |   1108 MiB |  27690 MiB |  27690 MiB |  26582 MiB |
|       from small pool |     54 MiB |     68 MiB |     68 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   3840 KiB |   1705 MiB | 527576 GiB | 527576 GiB |
|       from large pool |   3840 KiB |   1701 MiB | 520673 GiB | 520673 GiB |
|       from small pool |      0 KiB |     41 MiB |   6902 GiB |   6902 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3741    |   98677 K  |   98677 K  |
|       from large pool |       2    |    1413    |   51244 K  |   51244 K  |
|       from small pool |       0    |    3552    |   47432 K  |   47432 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3741    |   98677 K  |   98677 K  |
|       from large pool |       2    |    1413    |   51244 K  |   51244 K  |
|       from small pool |       0    |    3552    |   47432 K  |   47432 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      65    |     835    |     835    |     770    |
|       from large pool |      38    |     801    |     801    |     763    |
|       from small pool |      27    |      34    |      34    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |    1446    |   69801 K  |   69801 K  |
|       from large pool |       1    |     800    |   45213 K  |   45213 K  |
|       from small pool |       0    |    1409    |   24587 K  |   24587 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  26075 MiB |   1107 TiB |   1107 TiB |
|       from large pool |  16640 KiB |  26030 MiB |   1100 TiB |   1100 TiB |
|       from small pool |      0 KiB |     57 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  26075 MiB |   1107 TiB |   1107 TiB |
|       from large pool |  16640 KiB |  26030 MiB |   1100 TiB |   1100 TiB |
|       from small pool |      0 KiB |     57 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  26071 MiB |   1106 TiB |   1106 TiB |
|       from large pool |  16640 KiB |  26026 MiB |   1100 TiB |   1100 TiB |
|       from small pool |      0 KiB |     56 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1162 MiB |  27758 MiB |  27758 MiB |  26596 MiB |
|       from large pool |   1108 MiB |  27690 MiB |  27690 MiB |  26582 MiB |
|       from small pool |     54 MiB |     68 MiB |     68 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   3840 KiB |   1705 MiB | 527576 GiB | 527576 GiB |
|       from large pool |   3840 KiB |   1701 MiB | 520673 GiB | 520673 GiB |
|       from small pool |      0 KiB |     41 MiB |   6902 GiB |   6902 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3741    |   98677 K  |   98677 K  |
|       from large pool |       2    |    1413    |   51244 K  |   51244 K  |
|       from small pool |       0    |    3552    |   47432 K  |   47432 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3741    |   98677 K  |   98677 K  |
|       from large pool |       2    |    1413    |   51244 K  |   51244 K  |
|       from small pool |       0    |    3552    |   47432 K  |   47432 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      65    |     835    |     835    |     770    |
|       from large pool |      38    |     801    |     801    |     763    |
|       from small pool |      27    |      34    |      34    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |    1446    |   69801 K  |   69801 K  |
|       from large pool |       1    |     800    |   45213 K  |   45213 K  |
|       from small pool |       0    |    1409    |   24587 K  |   24587 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_03_48_51_seed_1_20863842

 Experiment start at: 2024-05-27 03:48:51.073424
before training, model accuracy: 0.181115061044693
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96827096, 'precision': 0.8732203, 'recall': 0.52405286, 'specificity': 0.52405286, 'f1': 0.53764856, 'auroc': 0.9531132, 'binary_precision': 0.7777778, 'binary_recall': 0.048577376, 'binary_specificity': 0.9995283, 'binary_f1_score': 0.0914435}
confusion matrix:
       0   1
0  42379  20
1   1371  70
---- Validation: 
scalar performance:
{'acc': 0.9646211, 'precision': 0.9406593, 'recall': 0.5081447, 'specificity': 0.5081447, 'f1': 0.507049, 'auroc': 0.9473518, 'binary_precision': 0.9166667, 'binary_recall': 0.016344724, 'binary_specificity': 0.9999446, 'binary_f1_score': 0.032116786}
confusion matrix:
       0   1
0  18066   1
1    662  11
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584273, 'precision': 0.9792069, 'recall': 0.50384617, 'specificity': 0.50384617, 'f1': 0.4970163, 'auroc': 0.94100344, 'binary_precision': 1.0, 'binary_recall': 0.0076923077, 'binary_specificity': 1.0, 'binary_f1_score': 0.015267175}
confusion matrix:
      0  1
0  5946  0
1   258  2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863842.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-27 04:07:52.769852,epoch time: 0:19:01.696428,used: 0:19:01.696428,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_03_48_51_seed_1_20863842
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9684763, 'precision': 0.8584879, 'recall': 0.53052753, 'specificity': 0.53052753, 'f1': 0.5490276, 'auroc': 0.9631506, 'binary_precision': 0.7478992, 'binary_recall': 0.061762664, 'binary_specificity': 0.99929243, 'binary_f1_score': 0.114102565}
confusion matrix:
       0   1
0  42369  30
1   1352  89
---- Validation: 
scalar performance:
{'acc': 0.96451443, 'precision': 0.9322744, 'recall': 0.5066588, 'specificity': 0.5066588, 'f1': 0.5041411, 'auroc': 0.9608358, 'binary_precision': 0.9, 'binary_recall': 0.013372957, 'binary_specificity': 0.9999446, 'binary_f1_score': 0.026354318}
confusion matrix:
       0  1
0  18066  1
1    664  9
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597164, 'precision': 0.97982574, 'recall': 0.5192308, 'specificity': 0.5192308, 'f1': 0.52674216, 'auroc': 0.94610566, 'binary_precision': 1.0, 'binary_recall': 0.03846154, 'binary_specificity': 1.0, 'binary_f1_score': 0.074074075}
confusion matrix:
      0   1
0  5946   0
1   250  10
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863842.png
new oracle model saved
early stop counter: 1
val acc:0.964514434337616, best validation acc: 0.9646211266517639, corresponding to test acc:                         0.9584273099899292 / 0.9597163796424866
after epoch: 2,now: 2024-05-27 04:25:59.478999,epoch time: 0:18:06.709147,used: 0:37:08.405575,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_03_48_51_seed_1_20863842
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96927464, 'precision': 0.75721854, 'recall': 0.8779364, 'specificity': 0.8779364, 'f1': 0.8047507, 'auroc': 0.96693206, 'binary_precision': 0.52204174, 'binary_recall': 0.78016645, 'binary_specificity': 0.9757064, 'binary_f1_score': 0.6255213}
confusion matrix:
       0     1
0  41368  1030
1    317  1125
---- Validation: 
scalar performance:
{'acc': 0.97155815, 'precision': 0.7867726, 'recall': 0.8522096, 'specificity': 0.8522096, 'f1': 0.81575024, 'auroc': 0.966925, 'binary_precision': 0.5839329, 'binary_recall': 0.72362554, 'binary_specificity': 0.9807937, 'binary_f1_score': 0.6463172}
confusion matrix:
       0    1
0  17720  347
1    186  487
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9779246, 'precision': 0.90405625, 'recall': 0.797225, 'specificity': 0.797225, 'f1': 0.8417127, 'auroc': 0.9515117, 'binary_precision': 0.82539684, 'binary_recall': 0.6, 'binary_specificity': 0.99445003, 'binary_f1_score': 0.6948775}
confusion matrix:
      0    1
0  5913   33
1   104  156
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863842.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-05-27 04:44:22.519380,epoch time: 0:18:23.040381,used: 0:55:31.445956,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_03_48_51_seed_1_20863842
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.973677, 'precision': 0.85084116, 'recall': 0.659147, 'specificity': 0.659147, 'f1': 0.7163876, 'auroc': 0.96654224, 'binary_precision': 0.7242991, 'binary_recall': 0.3224688, 'binary_specificity': 0.9958253, 'binary_f1_score': 0.4462572}
confusion matrix:
       0    1
0  42221  177
1    977  465
---- Validation: 
scalar performance:
{'acc': 0.96915686, 'precision': 0.8575592, 'recall': 0.60634285, 'specificity': 0.60634285, 'f1': 0.6591571, 'auroc': 0.96112585, 'binary_precision': 0.74358976, 'binary_recall': 0.2154532, 'binary_specificity': 0.9972325, 'binary_f1_score': 0.33410138}
confusion matrix:
       0    1
0  18017   50
1    528  145
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614889, 'precision': 0.98067904, 'recall': 0.5403846, 'specificity': 0.5403846, 'f1': 0.56488234, 'auroc': 0.94724995, 'binary_precision': 1.0, 'binary_recall': 0.08076923, 'binary_specificity': 1.0, 'binary_f1_score': 0.1494662}
confusion matrix:
      0   1
0  5946   0
1   239  21
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863842.png
early stop counter: 1
val acc:0.9691568613052368, best validation acc: 0.971558153629303, corresponding to test acc:                         0.9779245853424072 / 0.9779245853424072
after epoch: 4,now: 2024-05-27 05:02:49.434468,epoch time: 0:18:26.915088,used: 1:13:58.361044,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_03_48_51_seed_1_20863842
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9781478, 'precision': 0.83065003, 'recall': 0.8208935, 'specificity': 0.8208935, 'f1': 0.8256922, 'auroc': 0.97365487, 'binary_precision': 0.6731044, 'binary_recall': 0.6525659, 'binary_specificity': 0.9892212, 'binary_f1_score': 0.6626761}
confusion matrix:
       0    1
0  41941  457
1    501  941
---- Validation: 
scalar performance:
{'acc': 0.976841, 'precision': 0.86467767, 'recall': 0.765541, 'specificity': 0.765541, 'f1': 0.8066336, 'auroc': 0.9698767, 'binary_precision': 0.7463918, 'binary_recall': 0.53789, 'binary_specificity': 0.993192, 'binary_f1_score': 0.6252159}
confusion matrix:
       0    1
0  17944  123
1    311  362
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9690622, 'precision': 0.83316004, 'recall': 0.7337525, 'specificity': 0.7337525, 'f1': 0.7737995, 'auroc': 0.9501934, 'binary_precision': 0.6888889, 'binary_recall': 0.47692308, 'binary_specificity': 0.9905819, 'binary_f1_score': 0.56363636}
confusion matrix:
      0    1
0  5890   56
1   136  124
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863842.png
better model found
persisted
after epoch: 5,now: 2024-05-27 05:21:13.979313,epoch time: 0:18:24.544845,used: 1:32:22.905889,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_03_48_51_seed_1_20863842
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97488594, 'precision': 0.7929739, 'recall': 0.8613205, 'specificity': 0.8613205, 'f1': 0.8232058, 'auroc': 0.9775742, 'binary_precision': 0.5948661, 'binary_recall': 0.73976403, 'binary_specificity': 0.98287696, 'binary_f1_score': 0.65944946}
confusion matrix:
       0     1
0  41673   726
1    375  1066
---- Validation: 
scalar performance:
{'acc': 0.9766809, 'precision': 0.8299116, 'recall': 0.83698475, 'specificity': 0.83698475, 'f1': 0.8334068, 'auroc': 0.9722345, 'binary_precision': 0.67151165, 'binary_recall': 0.68647844, 'binary_specificity': 0.987491, 'binary_f1_score': 0.6789126}
confusion matrix:
       0    1
0  17841  226
1    211  462
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9705124, 'precision': 0.91613376, 'recall': 0.67566174, 'specificity': 0.67566174, 'f1': 0.74308467, 'auroc': 0.95497394, 'binary_precision': 0.8598131, 'binary_recall': 0.35384616, 'binary_specificity': 0.9974773, 'binary_f1_score': 0.5013624}
confusion matrix:
      0   1
0  5931  15
1   168  92
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863842.png
early stop counter: 1
val acc:0.9766808748245239, best validation acc: 0.9768409729003906, corresponding to test acc:                         0.9690622091293335 / 0.9779245853424072
after epoch: 6,now: 2024-05-27 05:39:37.497664,epoch time: 0:18:23.518351,used: 1:50:46.424240,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_03_48_51_seed_1_20863842
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9765739, 'precision': 0.8636182, 'recall': 0.7155762, 'specificity': 0.7155762, 'f1': 0.7692603, 'auroc': 0.97278273, 'binary_precision': 0.7461447, 'binary_recall': 0.43619972, 'binary_specificity': 0.9949526, 'binary_f1_score': 0.55054706}
confusion matrix:
       0    1
0  42184  214
1    813  629
---- Validation: 
scalar performance:
{'acc': 0.9757204, 'precision': 0.9136094, 'recall': 0.69557893, 'specificity': 0.69557893, 'f1': 0.76280177, 'auroc': 0.9647739, 'binary_precision': 0.849359, 'binary_recall': 0.39375928, 'binary_specificity': 0.99739856, 'binary_f1_score': 0.53807104}
confusion matrix:
       0    1
0  18020   47
1    408  265
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587496, 'precision': 0.97936153, 'recall': 0.50769234, 'specificity': 0.50769234, 'f1': 0.5046148, 'auroc': 0.93680346, 'binary_precision': 1.0, 'binary_recall': 0.015384615, 'binary_specificity': 1.0, 'binary_f1_score': 0.03030303}
confusion matrix:
      0  1
0  5946  0
1   256  4
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863842.png
early stop counter: 2
val acc:0.9757204055786133, best validation acc: 0.9768409729003906, corresponding to test acc:                         0.9690622091293335 / 0.9779245853424072
after epoch: 7,now: 2024-05-27 05:58:01.878090,epoch time: 0:18:24.380426,used: 2:09:10.804666,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_03_48_51_seed_1_20863842
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98134124, 'precision': 0.9019393, 'recall': 0.7754977, 'specificity': 0.7754977, 'f1': 0.82605493, 'auroc': 0.9819666, 'binary_precision': 0.8188332, 'binary_recall': 0.55517, 'binary_specificity': 0.99582535, 'binary_f1_score': 0.6617039}
confusion matrix:
       0    1
0  42222  177
1    641  800
---- Validation: 
scalar performance:
{'acc': 0.9787086, 'precision': 0.8956982, 'recall': 0.7643638, 'specificity': 0.7643638, 'f1': 0.8159102, 'auroc': 0.97160745, 'binary_precision': 0.8085586, 'binary_recall': 0.53343236, 'binary_specificity': 0.9952953, 'binary_f1_score': 0.6427932}
confusion matrix:
       0    1
0  17982   85
1    314  359
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96052206, 'precision': 0.8146676, 'recall': 0.55643094, 'specificity': 0.55643094, 'f1': 0.58824253, 'auroc': 0.95735776, 'binary_precision': 0.6666667, 'binary_recall': 0.115384616, 'binary_specificity': 0.9974773, 'binary_f1_score': 0.19672132}
confusion matrix:
      0   1
0  5931  15
1   230  30
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863842.png
better model found
persisted
after epoch: 8,now: 2024-05-27 06:16:29.379945,epoch time: 0:18:27.501855,used: 2:27:38.306521,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_03_48_51_seed_1_20863842
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9817518, 'precision': 0.92246747, 'recall': 0.76414096, 'specificity': 0.76414096, 'f1': 0.82378674, 'auroc': 0.9842335, 'binary_precision': 0.86067414, 'binary_recall': 0.53120667, 'binary_specificity': 0.9970753, 'binary_f1_score': 0.65694684}
confusion matrix:
       0    1
0  42274  124
1    676  766
---- Validation: 
scalar performance:
{'acc': 0.9806297, 'precision': 0.9360277, 'recall': 0.7617838, 'specificity': 0.7617838, 'f1': 0.8255472, 'auroc': 0.972669, 'binary_precision': 0.8894472, 'binary_recall': 0.52600294, 'binary_specificity': 0.9975646, 'binary_f1_score': 0.66106445}
confusion matrix:
       0    1
0  18023   44
1    319  354
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9574605, 'precision': 0.666983, 'recall': 0.51069754, 'specificity': 0.51069754, 'f1': 0.5108624, 'auroc': 0.95421505, 'binary_precision': 0.375, 'binary_recall': 0.023076924, 'binary_specificity': 0.9983182, 'binary_f1_score': 0.04347826}
confusion matrix:
      0   1
0  5936  10
1   254   6
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863842.png
better model found
persisted
after epoch: 9,now: 2024-05-27 06:34:57.568364,epoch time: 0:18:28.188419,used: 2:46:06.494940,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_03_48_51_seed_1_20863842
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9841925, 'precision': 0.8842942, 'recall': 0.8597634, 'specificity': 0.8597634, 'f1': 0.87159115, 'auroc': 0.98447824, 'binary_precision': 0.77786034, 'binary_recall': 0.7265788, 'binary_specificity': 0.99294794, 'binary_f1_score': 0.7513455}
confusion matrix:
       0     1
0  42100   299
1    394  1047
---- Validation: 
scalar performance:
{'acc': 0.98233724, 'precision': 0.9223945, 'recall': 0.8020091, 'specificity': 0.8020091, 'f1': 0.85140634, 'auroc': 0.9746421, 'binary_precision': 0.8592437, 'binary_recall': 0.6077266, 'binary_specificity': 0.9962916, 'binary_f1_score': 0.7119234}
confusion matrix:
       0    1
0  18000   67
1    264  409
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9687399, 'precision': 0.88859284, 'recall': 0.66554177, 'specificity': 0.66554177, 'f1': 0.7283592, 'auroc': 0.9550979, 'binary_precision': 0.8055556, 'binary_recall': 0.33461538, 'binary_specificity': 0.9964682, 'binary_f1_score': 0.4728261}
confusion matrix:
      0   1
0  5925  21
1   173  87
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863842.png
better model found
persisted
after epoch: 10,now: 2024-05-27 06:53:25.687114,epoch time: 0:18:28.118750,used: 3:04:34.613690,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_03_48_51_seed_1_20863842
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98412406, 'precision': 0.88096845, 'recall': 0.86408544, 'specificity': 0.86408544, 'f1': 0.8723198, 'auroc': 0.9860004, 'binary_precision': 0.7709091, 'binary_recall': 0.7356003, 'binary_specificity': 0.9925706, 'binary_f1_score': 0.75284094}
confusion matrix:
       0     1
0  42084   315
1    381  1060
---- Validation: 
scalar performance:
{'acc': 0.97998935, 'precision': 0.87587833, 'recall': 0.815812, 'specificity': 0.815812, 'f1': 0.84300506, 'auroc': 0.97720754, 'binary_precision': 0.76512456, 'binary_recall': 0.63893014, 'binary_specificity': 0.99269384, 'binary_f1_score': 0.6963563}
confusion matrix:
       0    1
0  17935  132
1    243  430
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96310025, 'precision': 0.79361564, 'recall': 0.65340376, 'specificity': 0.65340376, 'f1': 0.6991248, 'auroc': 0.9560833, 'binary_precision': 0.6165413, 'binary_recall': 0.31538463, 'binary_specificity': 0.99142283, 'binary_f1_score': 0.4173028}
confusion matrix:
      0   1
0  5895  51
1   178  82
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863842.png
early stop counter: 1
val acc:0.9799893498420715, best validation acc: 0.982337236404419, corresponding to test acc:                         0.968739926815033 / 0.9779245853424072
after epoch: 11,now: 2024-05-27 07:11:53.976811,epoch time: 0:18:28.289697,used: 3:23:02.903387,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_03_48_51_seed_1_20863842
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9819115, 'precision': 0.94070387, 'recall': 0.75249344, 'specificity': 0.75249344, 'f1': 0.8193711, 'auroc': 0.9837699, 'binary_precision': 0.897909, 'binary_recall': 0.5069444, 'binary_specificity': 0.99804246, 'binary_f1_score': 0.64802486}
confusion matrix:
       0    1
0  42317   83
1    710  730
---- Validation: 
scalar performance:
{'acc': 0.97620064, 'precision': 0.9541975, 'recall': 0.68152267, 'specificity': 0.68152267, 'f1': 0.7556499, 'auroc': 0.9767903, 'binary_precision': 0.9315589, 'binary_recall': 0.3640416, 'binary_specificity': 0.9990037, 'binary_f1_score': 0.52350426}
confusion matrix:
       0    1
0  18049   18
1    428  245
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95955527, 'precision': 0.97974825, 'recall': 0.5173077, 'specificity': 0.5173077, 'f1': 0.5231221, 'auroc': 0.95569634, 'binary_precision': 1.0, 'binary_recall': 0.034615386, 'binary_specificity': 1.0, 'binary_f1_score': 0.0669145}
confusion matrix:
      0  1
0  5946  0
1   251  9
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863842.png
early stop counter: 2
val acc:0.9762006402015686, best validation acc: 0.982337236404419, corresponding to test acc:                         0.968739926815033 / 0.9779245853424072
after epoch: 12,now: 2024-05-27 07:30:25.962216,epoch time: 0:18:31.985405,used: 3:41:34.888792,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_03_48_51_seed_1_20863842
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98339415, 'precision': 0.88455313, 'recall': 0.84158564, 'specificity': 0.84158564, 'f1': 0.8616953, 'auroc': 0.98635185, 'binary_precision': 0.77960783, 'binary_recall': 0.6897988, 'binary_specificity': 0.9933725, 'binary_f1_score': 0.7319588}
confusion matrix:
       0    1
0  42118  281
1    447  994
---- Validation: 
scalar performance:
{'acc': 0.981857, 'precision': 0.90362674, 'recall': 0.81391954, 'specificity': 0.81391954, 'f1': 0.85269773, 'auroc': 0.9770691, 'binary_precision': 0.82080925, 'binary_recall': 0.6329866, 'binary_specificity': 0.9948525, 'binary_f1_score': 0.714765}
confusion matrix:
       0    1
0  17974   93
1    247  426
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96019983, 'precision': 0.842723, 'recall': 0.5397119, 'specificity': 0.5397119, 'f1': 0.5624771, 'auroc': 0.9514415, 'binary_precision': 0.7241379, 'binary_recall': 0.08076923, 'binary_specificity': 0.99865454, 'binary_f1_score': 0.14532872}
confusion matrix:
      0   1
0  5938   8
1   239  21
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863842.png
early stop counter: 3
val acc:0.9818570017814636, best validation acc: 0.982337236404419, corresponding to test acc:                         0.968739926815033 / 0.9779245853424072
after epoch: 13,now: 2024-05-27 07:48:55.504899,epoch time: 0:18:29.542683,used: 4:00:04.431475,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_03_48_51_seed_1_20863842
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98601735, 'precision': 0.9149815, 'recall': 0.8525616, 'specificity': 0.8525616, 'f1': 0.88103944, 'auroc': 0.98768544, 'binary_precision': 0.8397699, 'binary_recall': 0.7097222, 'binary_specificity': 0.99540097, 'binary_f1_score': 0.76928866}
confusion matrix:
       0     1
0  42205   195
1    418  1022
---- Validation: 
scalar performance:
{'acc': 0.9835112, 'precision': 0.91611636, 'recall': 0.82908285, 'specificity': 0.82908285, 'f1': 0.86709857, 'auroc': 0.9781089, 'binary_precision': 0.844697, 'binary_recall': 0.6627043, 'binary_specificity': 0.99546134, 'binary_f1_score': 0.74271446}
confusion matrix:
       0    1
0  17985   82
1    227  446
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96003866, 'precision': 0.8306509, 'recall': 0.5396278, 'specificity': 0.5396278, 'f1': 0.56218445, 'auroc': 0.9597331, 'binary_precision': 0.7, 'binary_recall': 0.08076923, 'binary_specificity': 0.9984864, 'binary_f1_score': 0.14482759}
confusion matrix:
      0   1
0  5937   9
1   239  21
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863842.png
better model found
persisted
after epoch: 14,now: 2024-05-27 08:07:27.495075,epoch time: 0:18:31.990176,used: 4:18:36.421651,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_03_48_51_seed_1_20863842
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98562956, 'precision': 0.90908, 'recall': 0.8528972, 'specificity': 0.8528972, 'f1': 0.87875676, 'auroc': 0.98827314, 'binary_precision': 0.82794833, 'binary_recall': 0.7108183, 'binary_specificity': 0.99497616, 'binary_f1_score': 0.76492536}
confusion matrix:
       0     1
0  42185   213
1    417  1025
---- Validation: 
scalar performance:
{'acc': 0.9829242, 'precision': 0.911672, 'recall': 0.8237715, 'specificity': 0.8237715, 'f1': 0.86203414, 'auroc': 0.9759741, 'binary_precision': 0.83619046, 'binary_recall': 0.6523031, 'binary_specificity': 0.9952399, 'binary_f1_score': 0.7328881}
confusion matrix:
       0    1
0  17981   86
1    234  439
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614889, 'precision': 0.81558955, 'recall': 0.57900333, 'specificity': 0.57900333, 'f1': 0.6201459, 'auroc': 0.9596081, 'binary_precision': 0.6666667, 'binary_recall': 0.16153847, 'binary_specificity': 0.9964682, 'binary_f1_score': 0.26006192}
confusion matrix:
      0   1
0  5925  21
1   218  42
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863842.png
early stop counter: 1
val acc:0.982924222946167, best validation acc: 0.983511209487915, corresponding to test acc:                         0.9600386619567871 / 0.9779245853424072
after epoch: 15,now: 2024-05-27 08:25:58.354816,epoch time: 0:18:30.859741,used: 4:37:07.281392,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_03_48_51_seed_1_20863842
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9823905, 'precision': 0.9100925, 'recall': 0.78791755, 'specificity': 0.78791755, 'f1': 0.8375336, 'auroc': 0.98518276, 'binary_precision': 0.83433133, 'binary_recall': 0.57975036, 'binary_specificity': 0.99608475, 'binary_f1_score': 0.6841244}
confusion matrix:
       0    1
0  42232  166
1    606  836
---- Validation: 
scalar performance:
{'acc': 0.97993594, 'precision': 0.9272303, 'recall': 0.7571324, 'specificity': 0.7571324, 'f1': 0.81946313, 'auroc': 0.970419, 'binary_precision': 0.87218046, 'binary_recall': 0.51708764, 'binary_specificity': 0.9971772, 'binary_f1_score': 0.6492537}
confusion matrix:
       0    1
0  18016   51
1    325  348
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9585885, 'precision': 0.7489902, 'recall': 0.54071, 'specificity': 0.54071, 'f1': 0.56247956, 'auroc': 0.9239146, 'binary_precision': 0.5365854, 'binary_recall': 0.08461539, 'binary_specificity': 0.9968046, 'binary_f1_score': 0.1461794}
confusion matrix:
      0   1
0  5927  19
1   238  22
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863842.png
early stop counter: 2
val acc:0.9799359440803528, best validation acc: 0.983511209487915, corresponding to test acc:                         0.9600386619567871 / 0.9779245853424072
after epoch: 16,now: 2024-05-27 08:44:41.021033,epoch time: 0:18:42.666217,used: 4:55:49.947609,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_03_48_51_seed_1_20863842
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9857208, 'precision': 0.9154565, 'recall': 0.8465804, 'specificity': 0.8465804, 'f1': 0.877669, 'auroc': 0.98913586, 'binary_precision': 0.8411371, 'binary_recall': 0.69764215, 'binary_specificity': 0.9955187, 'binary_f1_score': 0.76269895}
confusion matrix:
       0     1
0  42208   190
1    436  1006
---- Validation: 
scalar performance:
{'acc': 0.98121667, 'precision': 0.90549004, 'recall': 0.7999973, 'specificity': 0.7999973, 'f1': 0.84421, 'auroc': 0.97387385, 'binary_precision': 0.8255578, 'binary_recall': 0.6047548, 'binary_specificity': 0.9952399, 'binary_f1_score': 0.6981132}
confusion matrix:
       0    1
0  17981   86
1    266  407
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9619723, 'precision': 0.8000709, 'recall': 0.6068404, 'specificity': 0.6068404, 'f1': 0.6530744, 'auroc': 0.94662607, 'binary_precision': 0.6333333, 'binary_recall': 0.21923077, 'binary_specificity': 0.99445003, 'binary_f1_score': 0.3257143}
confusion matrix:
      0   1
0  5913  33
1   203  57
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863842.png
early stop counter: 3
val acc:0.9812166690826416, best validation acc: 0.983511209487915, corresponding to test acc:                         0.9600386619567871 / 0.9779245853424072
after epoch: 17,now: 2024-05-27 09:03:10.167632,epoch time: 0:18:29.146599,used: 5:14:19.094208,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_03_48_51_seed_1_20863842
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98469436, 'precision': 0.9231686, 'recall': 0.81812423, 'specificity': 0.81812423, 'f1': 0.862661, 'auroc': 0.9884188, 'binary_precision': 0.858473, 'binary_recall': 0.63983345, 'binary_specificity': 0.996415, 'binary_f1_score': 0.7332008}
confusion matrix:
       0    1
0  42247  152
1    519  922
---- Validation: 
scalar performance:
{'acc': 0.97934896, 'precision': 0.9163536, 'recall': 0.7561127, 'specificity': 0.7561127, 'f1': 0.815683, 'auroc': 0.9682529, 'binary_precision': 0.8504902, 'binary_recall': 0.51560175, 'binary_specificity': 0.9966237, 'binary_f1_score': 0.6419981}
confusion matrix:
       0    1
0  18006   61
1    326  347
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9618111, 'precision': 0.8183099, 'recall': 0.5846885, 'specificity': 0.5846885, 'f1': 0.62780917, 'auroc': 0.9431997, 'binary_precision': 0.67164177, 'binary_recall': 0.17307693, 'binary_specificity': 0.99630004, 'binary_f1_score': 0.27522936}
confusion matrix:
      0   1
0  5924  22
1   215  45
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863842.png
early stop counter: 4
val acc:0.9793489575386047, best validation acc: 0.983511209487915, corresponding to test acc:                         0.9600386619567871 / 0.9779245853424072
after epoch: 18,now: 2024-05-27 09:21:39.897385,epoch time: 0:18:29.729753,used: 5:32:48.823961,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_03_48_51_seed_1_20863842
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9844434, 'precision': 0.8950407, 'recall': 0.84826463, 'specificity': 0.84826463, 'f1': 0.8700638, 'auroc': 0.9893233, 'binary_precision': 0.80015796, 'binary_recall': 0.7024965, 'binary_specificity': 0.99403274, 'binary_f1_score': 0.7481536}
confusion matrix:
       0     1
0  42145   253
1    429  1013
---- Validation: 
scalar performance:
{'acc': 0.9836179, 'precision': 0.92229223, 'recall': 0.82413125, 'specificity': 0.82413125, 'f1': 0.86623484, 'auroc': 0.9796219, 'binary_precision': 0.8574219, 'binary_recall': 0.6523031, 'binary_specificity': 0.99595946, 'binary_f1_score': 0.74092823}
confusion matrix:
       0    1
0  17994   73
1    234  439
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587496, 'precision': 0.89610213, 'recall': 0.50953126, 'specificity': 0.50953126, 'f1': 0.5082585, 'auroc': 0.9571054, 'binary_precision': 0.8333333, 'binary_recall': 0.01923077, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.037593987}
confusion matrix:
      0  1
0  5945  1
1   255  5
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863842.png
better model found
persisted
after epoch: 19,now: 2024-05-27 09:40:12.173868,epoch time: 0:18:32.276483,used: 5:51:21.100444,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_03_48_51_seed_1_20863842
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9870438, 'precision': 0.9112345, 'recall': 0.87807953, 'specificity': 0.87807953, 'f1': 0.8939059, 'auroc': 0.99041986, 'binary_precision': 0.83055973, 'binary_recall': 0.7614424, 'binary_specificity': 0.9947167, 'binary_f1_score': 0.7945007}
confusion matrix:
       0     1
0  42174   224
1    344  1098
---- Validation: 
scalar performance:
{'acc': 0.98217714, 'precision': 0.90422726, 'recall': 0.8190925, 'specificity': 0.8190925, 'f1': 0.85623026, 'auroc': 0.97472256, 'binary_precision': 0.82163185, 'binary_recall': 0.6433878, 'binary_specificity': 0.99479717, 'binary_f1_score': 0.72166663}
confusion matrix:
       0    1
0  17973   94
1    240  433
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95987755, 'precision': 0.91338503, 'recall': 0.52483183, 'specificity': 0.52483183, 'f1': 0.53701484, 'auroc': 0.9462054, 'binary_precision': 0.8666667, 'binary_recall': 0.05, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.094545454}
confusion matrix:
      0   1
0  5944   2
1   247  13
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863842.png
early stop counter: 1
val acc:0.9821771383285522, best validation acc: 0.983617901802063, corresponding to test acc:                         0.9587495923042297 / 0.9779245853424072
after epoch: 20,now: 2024-05-27 09:58:47.996380,epoch time: 0:18:35.822512,used: 6:09:56.922956,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_03_48_51_seed_1_20863842
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.98494524, 'precision': 0.85769486, 'recall': 0.93895996, 'specificity': 0.93895996, 'f1': 0.8937987, 'auroc': 0.99253905, 'binary_precision': 0.7191704, 'binary_recall': 0.8897365, 'binary_specificity': 0.9881834, 'binary_f1_score': 0.7954123}
confusion matrix:
       0     1
0  41897   501
1    159  1283
---- Validation: 
scalar performance:
{'acc': 0.98217714, 'precision': 0.8598413, 'recall': 0.89777184, 'specificity': 0.89777184, 'f1': 0.87776315, 'auroc': 0.9750796, 'binary_precision': 0.7269076, 'binary_recall': 0.80683506, 'binary_specificity': 0.9887087, 'binary_f1_score': 0.76478875}
confusion matrix:
       0    1
0  17863  204
1    130  543
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9663229, 'precision': 0.81067014, 'recall': 0.71209407, 'specificity': 0.71209407, 'f1': 0.75104505, 'auroc': 0.94756365, 'binary_precision': 0.6457143, 'binary_recall': 0.43461537, 'binary_specificity': 0.9895728, 'binary_f1_score': 0.5195402}
confusion matrix:
      0    1
0  5884   62
1   147  113
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863842.png
early stop counter: 2
val acc:0.9821771383285522, best validation acc: 0.983617901802063, corresponding to test acc:                         0.9587495923042297 / 0.9779245853424072
after epoch: 21,now: 2024-05-27 10:17:22.821338,epoch time: 0:18:34.824958,used: 6:28:31.747914,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_03_48_51_seed_1_20863842
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.98736316, 'precision': 0.9133564, 'recall': 0.88109803, 'specificity': 0.88109803, 'f1': 0.89652085, 'auroc': 0.99141335, 'binary_precision': 0.83459216, 'binary_recall': 0.7673611, 'binary_specificity': 0.9948349, 'binary_f1_score': 0.79956585}
confusion matrix:
       0     1
0  42181   219
1    335  1105
---- Validation: 
scalar performance:
{'acc': 0.98207045, 'precision': 0.90501195, 'recall': 0.81617606, 'specificity': 0.81617606, 'f1': 0.8546666, 'auroc': 0.9740603, 'binary_precision': 0.82341653, 'binary_recall': 0.63744426, 'binary_specificity': 0.99490786, 'binary_f1_score': 0.718593}
confusion matrix:
       0    1
0  17975   92
1    244  429
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96084434, 'precision': 0.821916, 'recall': 0.5602771, 'specificity': 0.5602771, 'f1': 0.59419733, 'auroc': 0.9436548, 'binary_precision': 0.68085104, 'binary_recall': 0.12307692, 'binary_specificity': 0.9974773, 'binary_f1_score': 0.20846906}
confusion matrix:
      0   1
0  5931  15
1   228  32
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863842.png
early stop counter: 3
val acc:0.9820704460144043, best validation acc: 0.983617901802063, corresponding to test acc:                         0.9587495923042297 / 0.9779245853424072
after epoch: 22,now: 2024-05-27 10:35:56.152756,epoch time: 0:18:33.331418,used: 6:47:05.079332,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_03_48_51_seed_1_20863842
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.98934764, 'precision': 0.9152864, 'recall': 0.9177897, 'specificity': 0.9177897, 'f1': 0.91653395, 'auroc': 0.99376297, 'binary_precision': 0.83597517, 'binary_recall': 0.8411928, 'binary_specificity': 0.99438655, 'binary_f1_score': 0.83857584}
confusion matrix:
       0     1
0  42160   238
1    229  1213
---- Validation: 
scalar performance:
{'acc': 0.9842583, 'precision': 0.892263, 'recall': 0.8759626, 'specificity': 0.8759626, 'f1': 0.88392437, 'auroc': 0.9758569, 'binary_precision': 0.79347825, 'binary_recall': 0.75928676, 'binary_specificity': 0.9926385, 'binary_f1_score': 0.7760061}
confusion matrix:
       0    1
0  17934  133
1    162  511
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9622946, 'precision': 0.8443396, 'recall': 0.5794238, 'specificity': 0.5794238, 'f1': 0.62240124, 'auroc': 0.94287854, 'binary_precision': 0.7241379, 'binary_recall': 0.16153847, 'binary_specificity': 0.9973091, 'binary_f1_score': 0.26415095}
confusion matrix:
      0   1
0  5930  16
1   218  42
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863842.png
better model found
persisted
after epoch: 23,now: 2024-05-27 10:54:34.784983,epoch time: 0:18:38.632227,used: 7:05:43.711559,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_03_48_51_seed_1_20863842
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9854927, 'precision': 0.86078084, 'recall': 0.9442327, 'specificity': 0.9442327, 'f1': 0.89778244, 'auroc': 0.99277544, 'binary_precision': 0.724986, 'binary_recall': 0.9000694, 'binary_specificity': 0.9883959, 'binary_f1_score': 0.803096}
confusion matrix:
       0     1
0  41907   492
1    144  1297
---- Validation: 
scalar performance:
{'acc': 0.9827108, 'precision': 0.85522807, 'recall': 0.9237982, 'specificity': 0.9237982, 'f1': 0.88618803, 'auroc': 0.97644657, 'binary_precision': 0.7156984, 'binary_recall': 0.8603269, 'binary_specificity': 0.9872696, 'binary_f1_score': 0.78137654}
confusion matrix:
       0    1
0  17837  230
1     94  579
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9687399, 'precision': 0.8322243, 'recall': 0.72806734, 'specificity': 0.72806734, 'f1': 0.7694234, 'auroc': 0.9557079, 'binary_precision': 0.6875, 'binary_recall': 0.4653846, 'binary_specificity': 0.9907501, 'binary_f1_score': 0.5550459}
confusion matrix:
      0    1
0  5891   55
1   139  121
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863842.png
early stop counter: 1
val acc:0.9827107787132263, best validation acc: 0.9842582941055298, corresponding to test acc:                         0.9622945785522461 / 0.9779245853424072
after epoch: 24,now: 2024-05-27 11:13:04.986486,epoch time: 0:18:30.201503,used: 7:24:13.913062,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_03_48_51_seed_1_20863842
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9889827, 'precision': 0.92229056, 'recall': 0.9004513, 'specificity': 0.9004513, 'f1': 0.9110584, 'auroc': 0.9941983, 'binary_precision': 0.85117304, 'binary_recall': 0.80569047, 'binary_specificity': 0.99521214, 'binary_f1_score': 0.82780755}
confusion matrix:
       0     1
0  42196   203
1    280  1161
---- Validation: 
scalar performance:
{'acc': 0.98329777, 'precision': 0.9160465, 'recall': 0.8253958, 'specificity': 0.8253958, 'f1': 0.8647245, 'auroc': 0.97623116, 'binary_precision': 0.8448276, 'binary_recall': 0.65527487, 'binary_specificity': 0.9955167, 'binary_f1_score': 0.73807526}
confusion matrix:
       0    1
0  17986   81
1    232  441
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9634225, 'precision': 0.89405555, 'recall': 0.58001244, 'specificity': 0.58001244, 'f1': 0.6256689, 'auroc': 0.9574537, 'binary_precision': 0.8235294, 'binary_recall': 0.16153847, 'binary_specificity': 0.9984864, 'binary_f1_score': 0.27009648}
confusion matrix:
      0   1
0  5937   9
1   218  42
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863842.png
early stop counter: 2
val acc:0.9832977652549744, best validation acc: 0.9842582941055298, corresponding to test acc:                         0.9622945785522461 / 0.9779245853424072
after epoch: 25,now: 2024-05-27 11:31:45.512347,epoch time: 0:18:40.525861,used: 7:42:54.438923,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_03_48_51_seed_1_20863842
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.98713505, 'precision': 0.9390216, 'recall': 0.8464308, 'specificity': 0.8464308, 'f1': 0.8868736, 'auroc': 0.9928469, 'binary_precision': 0.88829786, 'binary_recall': 0.6958333, 'binary_specificity': 0.9970283, 'binary_f1_score': 0.7803738}
confusion matrix:
       0     1
0  42274   126
1    438  1002
---- Validation: 
scalar performance:
{'acc': 0.98399144, 'precision': 0.948741, 'recall': 0.8057281, 'specificity': 0.8057281, 'f1': 0.862659, 'auroc': 0.9751247, 'binary_precision': 0.9116998, 'binary_recall': 0.6136701, 'binary_specificity': 0.99778605, 'binary_f1_score': 0.7335701}
confusion matrix:
       0    1
0  18027   40
1    260  413
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597164, 'precision': 0.819781, 'recall': 0.5357817, 'specificity': 0.5357817, 'f1': 0.55566216, 'auroc': 0.9524515, 'binary_precision': 0.6785714, 'binary_recall': 0.073076926, 'binary_specificity': 0.9984864, 'binary_f1_score': 0.13194445}
confusion matrix:
      0   1
0  5937   9
1   241  19
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863842.png
early stop counter: 3
val acc:0.9839914441108704, best validation acc: 0.9842582941055298, corresponding to test acc:                         0.9622945785522461 / 0.9779245853424072
after epoch: 26,now: 2024-05-27 11:50:33.167620,epoch time: 0:18:47.655273,used: 8:01:42.094196,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_03_48_51_seed_1_20863842
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.98718065, 'precision': 0.8925968, 'recall': 0.9109752, 'specificity': 0.9109752, 'f1': 0.90155816, 'auroc': 0.9928043, 'binary_precision': 0.7910053, 'binary_recall': 0.8294036, 'binary_specificity': 0.9925468, 'binary_f1_score': 0.80974954}
confusion matrix:
       0     1
0  42082   316
1    246  1196
---- Validation: 
scalar performance:
{'acc': 0.984365, 'precision': 0.89437294, 'recall': 0.8745874, 'specificity': 0.8745874, 'f1': 0.8842028, 'auroc': 0.9777316, 'binary_precision': 0.79780567, 'binary_recall': 0.756315, 'binary_specificity': 0.9928599, 'binary_f1_score': 0.7765065}
confusion matrix:
       0    1
0  17938  129
1    164  509
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9648727, 'precision': 0.8589105, 'recall': 0.6193879, 'specificity': 0.6193879, 'f1': 0.67410743, 'auroc': 0.93780273, 'binary_precision': 0.75, 'binary_recall': 0.2423077, 'binary_specificity': 0.9964682, 'binary_f1_score': 0.3662791}
confusion matrix:
      0   1
0  5925  21
1   197  63
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863842.png
better model found
persisted
after epoch: 27,now: 2024-05-27 12:10:23.298483,epoch time: 0:19:50.130863,used: 8:21:32.225059,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_03_48_51_seed_1_20863842
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.98759127, 'precision': 0.9014648, 'recall': 0.9041536, 'specificity': 0.9041536, 'f1': 0.9028044, 'auroc': 0.99275863, 'binary_precision': 0.80922866, 'binary_recall': 0.8148405, 'binary_specificity': 0.9934667, 'binary_f1_score': 0.8120249}
confusion matrix:
       0     1
0  42121   277
1    267  1175
---- Validation: 
scalar performance:
{'acc': 0.98116326, 'precision': 0.8704006, 'recall': 0.85075366, 'specificity': 0.85075366, 'f1': 0.8602846, 'auroc': 0.9768293, 'binary_precision': 0.7515723, 'binary_recall': 0.7102526, 'binary_specificity': 0.99125475, 'binary_f1_score': 0.7303285}
confusion matrix:
       0    1
0  17909  158
1    195  478
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584273, 'precision': 0.73888993, 'recall': 0.56637174, 'specificity': 0.56637174, 'f1': 0.5984138, 'auroc': 0.92569065, 'binary_precision': 0.51428574, 'binary_recall': 0.13846155, 'binary_specificity': 0.9942819, 'binary_f1_score': 0.21818183}
confusion matrix:
      0   1
0  5912  34
1   224  36
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863842.png
early stop counter: 1
val acc:0.9811632633209229, best validation acc: 0.9843649864196777, corresponding to test acc:                         0.9648727178573608 / 0.9779245853424072
after epoch: 28,now: 2024-05-27 12:30:10.263631,epoch time: 0:19:46.965148,used: 8:41:19.190207,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_03_48_51_seed_1_20863842
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9894389, 'precision': 0.91644216, 'recall': 0.9178368, 'specificity': 0.9178368, 'f1': 0.9171382, 'auroc': 0.99461126, 'binary_precision': 0.8382861, 'binary_recall': 0.8411928, 'binary_specificity': 0.99448085, 'binary_f1_score': 0.8397369}
confusion matrix:
       0     1
0  42164   234
1    229  1213
---- Validation: 
scalar performance:
{'acc': 0.9848452, 'precision': 0.90898204, 'recall': 0.8619617, 'specificity': 0.8619617, 'f1': 0.8839146, 'auroc': 0.9760062, 'binary_precision': 0.8279933, 'binary_recall': 0.7295691, 'binary_specificity': 0.99435437, 'binary_f1_score': 0.7756714}
confusion matrix:
       0    1
0  17965  102
1    182  491
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96132773, 'precision': 0.81282294, 'recall': 0.57708025, 'specificity': 0.57708025, 'f1': 0.6174036, 'auroc': 0.9466886, 'binary_precision': 0.66129035, 'binary_recall': 0.15769231, 'binary_specificity': 0.9964682, 'binary_f1_score': 0.2546584}
confusion matrix:
      0   1
0  5925  21
1   219  41
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863842.png
better model found
persisted
after epoch: 29,now: 2024-05-27 12:50:12.512334,epoch time: 0:20:02.248703,used: 9:01:21.438910,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_03_48_51_seed_1_20863842
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9893248, 'precision': 0.9237653, 'recall': 0.90498567, 'specificity': 0.90498567, 'f1': 0.91414607, 'auroc': 0.99429035, 'binary_precision': 0.8538182, 'binary_recall': 0.814712, 'binary_specificity': 0.99525934, 'binary_f1_score': 0.83380675}
confusion matrix:
       0     1
0  42198   201
1    267  1174
---- Validation: 
scalar performance:
{'acc': 0.98265743, 'precision': 0.8942456, 'recall': 0.8415148, 'specificity': 0.8415148, 'f1': 0.86582565, 'auroc': 0.9768857, 'binary_precision': 0.8, 'binary_recall': 0.6894502, 'binary_specificity': 0.99357945, 'binary_f1_score': 0.74062246}
confusion matrix:
       0    1
0  17951  116
1    209  464
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96052206, 'precision': 0.7837602, 'recall': 0.5821768, 'specificity': 0.5821768, 'f1': 0.62199056, 'auroc': 0.94895715, 'binary_precision': 0.60273975, 'binary_recall': 0.16923077, 'binary_specificity': 0.9951228, 'binary_f1_score': 0.2642643}
confusion matrix:
      0   1
0  5917  29
1   216  44
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863842.png
early stop counter: 1
val acc:0.9826574325561523, best validation acc: 0.9848452210426331, corresponding to test acc:                         0.9613277316093445 / 0.9779245853424072
after epoch: 30,now: 2024-05-27 13:13:31.486015,epoch time: 0:23:18.973681,used: 9:24:40.412591,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_03_48_51_seed_1_20863842
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 9:24:40.412591 at 2024-05-27 13:13:31.486015
persisted model performance metric: 

scalar performance:
{'acc': 0.96084434, 'precision': 0.8064284, 'recall': 0.5694721, 'specificity': 0.5694721, 'f1': 0.6066738, 'auroc': 0.95129454, 'binary_precision': 0.64912283, 'binary_recall': 0.1423077, 'binary_specificity': 0.9966364, 'binary_f1_score': 0.23343849}
confusion matrix:
      0   1
0  5926  20
1   223  37
oracle model performance metric: 

scalar performance:
{'acc': 0.97502416, 'precision': 0.8838129, 'recall': 0.7736436, 'specificity': 0.7736436, 'f1': 0.8185814, 'auroc': 0.9495245, 'binary_precision': 0.78688526, 'binary_recall': 0.5538462, 'binary_specificity': 0.993441, 'binary_f1_score': 0.6501129}
confusion matrix:
      0    1
0  5907   39
1   116  144
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs32/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs32/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 453690 KiB |  26075 MiB |   2220 TiB |   2220 TiB |
|       from large pool | 412597 KiB |  26030 MiB |   2207 TiB |   2207 TiB |
|       from small pool |  41093 KiB |     57 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 453690 KiB |  26075 MiB |   2220 TiB |   2220 TiB |
|       from large pool | 412597 KiB |  26030 MiB |   2207 TiB |   2207 TiB |
|       from small pool |  41093 KiB |     57 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447751 KiB |  26071 MiB |   2220 TiB |   2220 TiB |
|       from large pool | 407075 KiB |  26026 MiB |   2206 TiB |   2206 TiB |
|       from small pool |  40676 KiB |     56 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  27792 MiB |  27792 MiB |  54388 MiB |  26596 MiB |
|       from large pool |  27724 MiB |  27724 MiB |  54306 MiB |  26582 MiB |
|       from small pool |     68 MiB |     68 MiB |     82 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 738245 KiB |   1739 MiB |   1006 TiB |   1006 TiB |
|       from large pool | 721995 KiB |   1737 MiB |    992 TiB |    992 TiB |
|       from small pool |  16250 KiB |     41 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    2300    |    3745    |  197785 K  |  197782 K  |
|       from large pool |     187    |    1413    |  102766 K  |  102766 K  |
|       from small pool |    2113    |    3556    |   95018 K  |   95016 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2300    |    3745    |  197785 K  |  197782 K  |
|       from large pool |     187    |    1413    |  102766 K  |  102766 K  |
|       from small pool |    2113    |    3556    |   95018 K  |   95016 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     837    |     837    |    1607    |     770    |
|       from large pool |     803    |     803    |    1566    |     763    |
|       from small pool |      34    |      34    |      41    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      91    |    1451    |  139807 K  |  139806 K  |
|       from large pool |      40    |     806    |   90590 K  |   90590 K  |
|       from small pool |      51    |    1410    |   49216 K  |   49216 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  26075 MiB |   2220 TiB |   2220 TiB |
|       from large pool |  16640 KiB |  26030 MiB |   2207 TiB |   2207 TiB |
|       from small pool |      0 KiB |     57 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  26075 MiB |   2220 TiB |   2220 TiB |
|       from large pool |  16640 KiB |  26030 MiB |   2207 TiB |   2207 TiB |
|       from small pool |      0 KiB |     57 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  26071 MiB |   2220 TiB |   2220 TiB |
|       from large pool |  16640 KiB |  26026 MiB |   2206 TiB |   2206 TiB |
|       from small pool |      0 KiB |     56 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1164 MiB |  27792 MiB |  54388 MiB |  53224 MiB |
|       from large pool |   1108 MiB |  27724 MiB |  54306 MiB |  53198 MiB |
|       from small pool |     56 MiB |     68 MiB |     82 MiB |     26 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   3840 KiB |   1739 MiB |   1006 TiB |   1006 TiB |
|       from large pool |   3840 KiB |   1737 MiB |    992 TiB |    992 TiB |
|       from small pool |      0 KiB |     41 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3745    |  197785 K  |  197785 K  |
|       from large pool |       2    |    1413    |  102766 K  |  102766 K  |
|       from small pool |       0    |    3556    |   95018 K  |   95018 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3745    |  197785 K  |  197785 K  |
|       from large pool |       2    |    1413    |  102766 K  |  102766 K  |
|       from small pool |       0    |    3556    |   95018 K  |   95018 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      69    |     837    |    1607    |    1538    |
|       from large pool |      41    |     803    |    1566    |    1525    |
|       from small pool |      28    |      34    |      41    |      13    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |    1451    |  139807 K  |  139807 K  |
|       from large pool |       1    |     806    |   90590 K  |   90590 K  |
|       from small pool |       0    |    1410    |   49216 K  |   49216 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Mon May 27 13:15:26 2024]
Finished job 0.
1 of 1 steps (100%) done
