Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sun May 26 12:25:42 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs32/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs32/rule_results/1.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=1
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863196

 Experiment start at: 2024-05-26 12:35:25.902867
before training, model accuracy: 0.6388623118400574
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96783626, 'precision': 0.76660156, 'recall': 0.59495986, 'specificity': 0.59495986, 'f1': 0.63657606, 'auroc': 0.9416064, 'binary_precision': 0.5605469, 'binary_recall': 0.1952381, 'binary_specificity': 0.9946816, 'binary_f1_score': 0.28960645}
confusion matrix:
       0    1
0  42081  225
1   1183  287
---- Validation: 
scalar performance:
{'acc': 0.96706045, 'precision': 0.7695067, 'recall': 0.5756667, 'specificity': 0.5756667, 'f1': 0.6136818, 'auroc': 0.9461779, 'binary_precision': 0.5681818, 'binary_recall': 0.15552099, 'binary_specificity': 0.9958124, 'binary_f1_score': 0.24420024}
confusion matrix:
       0    1
0  18073   76
1    543  100
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642058, 'precision': 0.9819965, 'recall': 0.57088125, 'specificity': 0.57088125, 'f1': 0.6149943, 'auroc': 0.92162657, 'binary_precision': 1.0, 'binary_recall': 0.14176245, 'binary_specificity': 1.0, 'binary_f1_score': 0.24832213}
confusion matrix:
      0   1
0  5997   0
1   224  37
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863196.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-26 12:55:44.764998,epoch time: 0:20:18.862131,used: 0:20:18.862131,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863196
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97155976, 'precision': 0.81894755, 'recall': 0.65288854, 'specificity': 0.65288854, 'f1': 0.70438224, 'auroc': 0.9621673, 'binary_precision': 0.6613603, 'binary_recall': 0.3113079, 'binary_specificity': 0.9944691, 'binary_f1_score': 0.42334414}
confusion matrix:
       0    1
0  42074  234
1   1011  457
---- Validation: 
scalar performance:
{'acc': 0.97004044, 'precision': 0.84053767, 'recall': 0.6042115, 'specificity': 0.6042115, 'f1': 0.6552142, 'auroc': 0.962364, 'binary_precision': 0.7083333, 'binary_recall': 0.21150856, 'binary_specificity': 0.99691445, 'binary_f1_score': 0.3257485}
confusion matrix:
       0    1
0  18093   56
1    507  136
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9705976, 'precision': 0.97292227, 'recall': 0.65117425, 'specificity': 0.65117425, 'f1': 0.7234371, 'auroc': 0.9472814, 'binary_precision': 0.97530866, 'binary_recall': 0.30268198, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.46198833}
confusion matrix:
      0   1
0  5995   2
1   182  79
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863196.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-05-26 13:14:03.966140,epoch time: 0:18:19.201142,used: 0:38:38.063273,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863196
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9730903, 'precision': 0.80869424, 'recall': 0.7285299, 'specificity': 0.7285299, 'f1': 0.7620903, 'auroc': 0.9660398, 'binary_precision': 0.63577384, 'binary_recall': 0.46634942, 'binary_specificity': 0.9907103, 'binary_f1_score': 0.5380392}
confusion matrix:
       0    1
0  41912  393
1    785  686
---- Validation: 
scalar performance:
{'acc': 0.9708919, 'precision': 0.8189974, 'recall': 0.6496556, 'specificity': 0.6496556, 'f1': 0.7012692, 'auroc': 0.96342033, 'binary_precision': 0.6621622, 'binary_recall': 0.30482116, 'binary_specificity': 0.99449, 'binary_f1_score': 0.41746542}
confusion matrix:
       0    1
0  18049  100
1    447  196
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96660274, 'precision': 0.91447085, 'recall': 0.6179402, 'specificity': 0.6179402, 'f1': 0.67760867, 'auroc': 0.9550762, 'binary_precision': 0.8611111, 'binary_recall': 0.23754789, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.37237236}
confusion matrix:
      0   1
0  5987  10
1   199  62
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863196.png
better model found
persisted
after epoch: 3,now: 2024-05-26 13:32:21.080354,epoch time: 0:18:17.114214,used: 0:56:55.177487,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863196
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9743238, 'precision': 0.86275935, 'recall': 0.6760182, 'specificity': 0.6760182, 'f1': 0.73467, 'auroc': 0.97001207, 'binary_precision': 0.7475036, 'binary_recall': 0.35622025, 'binary_specificity': 0.9958161, 'binary_f1_score': 0.48250464}
confusion matrix:
       0    1
0  42128  177
1    947  524
---- Validation: 
scalar performance:
{'acc': 0.97302043, 'precision': 0.8649622, 'recall': 0.65525794, 'specificity': 0.65525794, 'f1': 0.71482193, 'auroc': 0.96757454, 'binary_precision': 0.75373137, 'binary_recall': 0.31415242, 'binary_specificity': 0.99636346, 'binary_f1_score': 0.44346875}
confusion matrix:
       0    1
0  18083   66
1    441  202
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96740174, 'precision': 0.8948749, 'recall': 0.63851273, 'specificity': 0.63851273, 'f1': 0.70018744, 'auroc': 0.94929874, 'binary_precision': 0.8202247, 'binary_recall': 0.27969348, 'binary_specificity': 0.997332, 'binary_f1_score': 0.41714287}
confusion matrix:
      0   1
0  5981  16
1   188  73
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863196.png
better model found
persisted
after epoch: 4,now: 2024-05-26 13:50:35.699941,epoch time: 0:18:14.619587,used: 1:15:09.797074,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863196
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97313595, 'precision': 0.8347493, 'recall': 0.6783564, 'specificity': 0.6783564, 'f1': 0.73084164, 'auroc': 0.9727107, 'binary_precision': 0.69131, 'binary_recall': 0.36233854, 'binary_specificity': 0.9943742, 'binary_f1_score': 0.47546834}
confusion matrix:
       0    1
0  42067  238
1    938  533
---- Validation: 
scalar performance:
{'acc': 0.971424, 'precision': 0.82117325, 'recall': 0.66268206, 'specificity': 0.66268206, 'f1': 0.7138519, 'auroc': 0.9696863, 'binary_precision': 0.665625, 'binary_recall': 0.33125973, 'binary_specificity': 0.9941044, 'binary_f1_score': 0.4423676}
confusion matrix:
       0    1
0  18042  107
1    430  213
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97635025, 'precision': 0.9644233, 'recall': 0.7274691, 'specificity': 0.7274691, 'f1': 0.8021896, 'auroc': 0.9657806, 'binary_precision': 0.952, 'binary_recall': 0.4559387, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.6165803}
confusion matrix:
      0    1
0  5991    6
1   142  119
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863196.png
new oracle model saved
early stop counter: 1
val acc:0.9714239835739136, best validation acc: 0.9730204343795776, corresponding to test acc:                         0.9674017429351807 / 0.9763502478599548
after epoch: 5,now: 2024-05-26 14:08:49.174092,epoch time: 0:18:13.474151,used: 1:33:23.271225,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863196
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9774534, 'precision': 0.83261716, 'recall': 0.8083422, 'specificity': 0.8083422, 'f1': 0.8199779, 'auroc': 0.9755977, 'binary_precision': 0.67817783, 'binary_recall': 0.62703806, 'binary_specificity': 0.9896464, 'binary_f1_score': 0.65160614}
confusion matrix:
       0    1
0  41866  438
1    549  923
---- Validation: 
scalar performance:
{'acc': 0.97631973, 'precision': 0.8374208, 'recall': 0.77472466, 'specificity': 0.77472466, 'f1': 0.80257535, 'auroc': 0.97218466, 'binary_precision': 0.6903846, 'binary_recall': 0.55832034, 'binary_specificity': 0.991129, 'binary_f1_score': 0.6173689}
confusion matrix:
       0    1
0  17988  161
1    284  359
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9654842, 'precision': 0.8728617, 'recall': 0.6191889, 'specificity': 0.6191889, 'f1': 0.6753391, 'auroc': 0.94847393, 'binary_precision': 0.7777778, 'binary_recall': 0.2413793, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.36842105}
confusion matrix:
      0   1
0  5979  18
1   198  63
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863196.png
better model found
persisted
after epoch: 6,now: 2024-05-26 14:27:08.480913,epoch time: 0:18:19.306821,used: 1:51:42.578046,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863196
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9806515, 'precision': 0.8545588, 'recall': 0.8426788, 'specificity': 0.8426788, 'f1': 0.8485086, 'auroc': 0.98022866, 'binary_precision': 0.71971834, 'binary_recall': 0.69476545, 'binary_specificity': 0.9905921, 'binary_f1_score': 0.7070218}
confusion matrix:
       0     1
0  41907   398
1    449  1022
---- Validation: 
scalar performance:
{'acc': 0.9815347, 'precision': 0.8679738, 'recall': 0.8441795, 'specificity': 0.8441795, 'f1': 0.8556441, 'auroc': 0.9773886, 'binary_precision': 0.74666667, 'binary_recall': 0.6967341, 'binary_specificity': 0.9916249, 'binary_f1_score': 0.72083664}
confusion matrix:
       0    1
0  17997  152
1    195  448
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964845, 'precision': 0.8257364, 'recall': 0.64450806, 'specificity': 0.64450806, 'f1': 0.6968229, 'auroc': 0.9515402, 'binary_precision': 0.6814159, 'binary_recall': 0.29501915, 'binary_specificity': 0.993997, 'binary_f1_score': 0.4117647}
confusion matrix:
      0   1
0  5961  36
1   184  77
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863196.png
better model found
persisted
after epoch: 7,now: 2024-05-26 14:45:27.842760,epoch time: 0:18:19.361847,used: 2:10:01.939893,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863196
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.978824, 'precision': 0.94523716, 'recall': 0.7038636, 'specificity': 0.7038636, 'f1': 0.7768662, 'auroc': 0.98105335, 'binary_precision': 0.9106061, 'binary_recall': 0.40912184, 'binary_specificity': 0.99860543, 'binary_f1_score': 0.5645843}
confusion matrix:
       0    1
0  42248   59
1    868  601
---- Validation: 
scalar performance:
{'acc': 0.9756279, 'precision': 0.97500014, 'recall': 0.6476072, 'specificity': 0.6476072, 'f1': 0.7204983, 'auroc': 0.97642255, 'binary_precision': 0.974359, 'binary_recall': 0.29548988, 'binary_specificity': 0.9997245, 'binary_f1_score': 0.4534606}
confusion matrix:
       0    1
0  18144    5
1    453  190
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.72958696, 'recall': 0.510994, 'specificity': 0.510994, 'f1': 0.51131886, 'auroc': 0.94724965, 'binary_precision': 0.5, 'binary_recall': 0.022988506, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.043956045}
confusion matrix:
      0  1
0  5991  6
1   255  6
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863196.png
early stop counter: 1
val acc:0.9756278991699219, best validation acc: 0.9815347194671631, corresponding to test acc:                         0.9648450016975403 / 0.9763502478599548
after epoch: 8,now: 2024-05-26 15:03:46.238394,epoch time: 0:18:18.395634,used: 2:28:20.335527,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863196
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9800119, 'precision': 0.9081085, 'recall': 0.7513002, 'specificity': 0.7513002, 'f1': 0.8097184, 'auroc': 0.9811275, 'binary_precision': 0.8331467, 'binary_recall': 0.50612247, 'binary_specificity': 0.996478, 'binary_f1_score': 0.629708}
confusion matrix:
       0    1
0  42157  149
1    726  744
---- Validation: 
scalar performance:
{'acc': 0.976639, 'precision': 0.88994694, 'recall': 0.7096352, 'specificity': 0.7096352, 'f1': 0.7707069, 'auroc': 0.9768573, 'binary_precision': 0.8, 'binary_recall': 0.4230171, 'binary_specificity': 0.99625325, 'binary_f1_score': 0.55340797}
confusion matrix:
       0    1
0  18081   68
1    371  272
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96708214, 'precision': 0.8513745, 'recall': 0.66399866, 'specificity': 0.66399866, 'f1': 0.7204602, 'auroc': 0.94783986, 'binary_precision': 0.73109245, 'binary_recall': 0.33333334, 'binary_specificity': 0.994664, 'binary_f1_score': 0.45789474}
confusion matrix:
      0   1
0  5965  32
1   174  87
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863196.png
early stop counter: 2
val acc:0.9766389727592468, best validation acc: 0.9815347194671631, corresponding to test acc:                         0.9648450016975403 / 0.9763502478599548
after epoch: 9,now: 2024-05-26 15:22:06.137303,epoch time: 0:18:19.898909,used: 2:46:40.234436,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863196
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98293585, 'precision': 0.88163745, 'recall': 0.8441888, 'specificity': 0.8441888, 'f1': 0.86186624, 'auroc': 0.9837364, 'binary_precision': 0.77382755, 'binary_recall': 0.6954453, 'binary_specificity': 0.99293226, 'binary_f1_score': 0.7325457}
confusion matrix:
       0     1
0  42006   299
1    448  1023
---- Validation: 
scalar performance:
{'acc': 0.9819072, 'precision': 0.89178395, 'recall': 0.8136201, 'specificity': 0.8136201, 'f1': 0.84801984, 'auroc': 0.97840905, 'binary_precision': 0.7964775, 'binary_recall': 0.63297045, 'binary_specificity': 0.99426967, 'binary_f1_score': 0.70537263}
confusion matrix:
       0    1
0  18045  104
1    236  407
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96260786, 'precision': 0.8146452, 'recall': 0.6030295, 'specificity': 0.6030295, 'f1': 0.6502715, 'auroc': 0.9564228, 'binary_precision': 0.6626506, 'binary_recall': 0.21072797, 'binary_specificity': 0.995331, 'binary_f1_score': 0.31976745}
confusion matrix:
      0   1
0  5969  28
1   206  55
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863196.png
better model found
persisted
after epoch: 10,now: 2024-05-26 15:40:17.006930,epoch time: 0:18:10.869627,used: 3:04:51.104063,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863196
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98355263, 'precision': 0.8962475, 'recall': 0.8344443, 'specificity': 0.8344443, 'f1': 0.8625226, 'auroc': 0.9811771, 'binary_precision': 0.8037307, 'binary_recall': 0.6746086, 'binary_specificity': 0.9942799, 'binary_f1_score': 0.73353076}
confusion matrix:
       0    1
0  42065  242
1    478  991
---- Validation: 
scalar performance:
{'acc': 0.9827054, 'precision': 0.9130502, 'recall': 0.80353254, 'specificity': 0.80353254, 'f1': 0.84928, 'auroc': 0.979113, 'binary_precision': 0.8397436, 'binary_recall': 0.61119753, 'binary_specificity': 0.99586755, 'binary_f1_score': 0.7074708}
confusion matrix:
       0    1
0  18074   75
1    250  393
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96212846, 'precision': 0.88940597, 'recall': 0.5588034, 'specificity': 0.5588034, 'f1': 0.59397936, 'auroc': 0.95731264, 'binary_precision': 0.81578946, 'binary_recall': 0.118773945, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.20735785}
confusion matrix:
      0   1
0  5990   7
1   230  31
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863196.png
better model found
persisted
after epoch: 11,now: 2024-05-26 15:58:10.192317,epoch time: 0:17:53.185387,used: 3:22:44.289450,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863196
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9846263, 'precision': 0.90241945, 'recall': 0.84801614, 'specificity': 0.84801614, 'f1': 0.87308764, 'auroc': 0.98541296, 'binary_precision': 0.8151659, 'binary_recall': 0.70156354, 'binary_specificity': 0.99446875, 'binary_f1_score': 0.75411034}
confusion matrix:
       0     1
0  42071   234
1    439  1032
---- Validation: 
scalar performance:
{'acc': 0.98249257, 'precision': 0.9036201, 'recall': 0.8101728, 'specificity': 0.8101728, 'f1': 0.85029733, 'auroc': 0.9805481, 'binary_precision': 0.82040817, 'binary_recall': 0.62519443, 'binary_specificity': 0.9951512, 'binary_f1_score': 0.7096204}
confusion matrix:
       0    1
0  18061   88
1    241  402
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9646852, 'precision': 0.82423526, 'recall': 0.6425924, 'specificity': 0.6425924, 'f1': 0.6946535, 'auroc': 0.9554417, 'binary_precision': 0.6785714, 'binary_recall': 0.29118773, 'binary_specificity': 0.993997, 'binary_f1_score': 0.4075067}
confusion matrix:
      0   1
0  5961  36
1   185  76
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863196.png
early stop counter: 1
val acc:0.9824925661087036, best validation acc: 0.9827054142951965, corresponding to test acc:                         0.9621284604072571 / 0.9763502478599548
after epoch: 12,now: 2024-05-26 16:16:01.691055,epoch time: 0:17:51.498738,used: 3:40:35.788188,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863196
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98133683, 'precision': 0.8712429, 'recall': 0.8259729, 'specificity': 0.8259729, 'f1': 0.8470142, 'auroc': 0.9845881, 'binary_precision': 0.7542768, 'binary_recall': 0.65941536, 'binary_specificity': 0.9925304, 'binary_f1_score': 0.70366335}
confusion matrix:
       0    1
0  41989  316
1    501  970
---- Validation: 
scalar performance:
{'acc': 0.9800447, 'precision': 0.857324, 'recall': 0.82990706, 'specificity': 0.82990706, 'f1': 0.84301984, 'auroc': 0.9805955, 'binary_precision': 0.7263514, 'binary_recall': 0.6687403, 'binary_specificity': 0.9910739, 'binary_f1_score': 0.6963563}
confusion matrix:
       0    1
0  17987  162
1    213  430
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9701182, 'precision': 0.84987324, 'recall': 0.7260498, 'specificity': 0.7260498, 'f1': 0.7732961, 'auroc': 0.96555984, 'binary_precision': 0.72289157, 'binary_recall': 0.4597701, 'binary_specificity': 0.9923295, 'binary_f1_score': 0.5620609}
confusion matrix:
      0    1
0  5951   46
1   141  120
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863196.png
early stop counter: 2
val acc:0.9800447225570679, best validation acc: 0.9827054142951965, corresponding to test acc:                         0.9621284604072571 / 0.9763502478599548
after epoch: 13,now: 2024-05-26 16:34:13.848614,epoch time: 0:18:12.157559,used: 3:58:47.945747,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863196
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9851517, 'precision': 0.9281854, 'recall': 0.8272905, 'specificity': 0.8272905, 'f1': 0.8704982, 'auroc': 0.98725635, 'binary_precision': 0.86816144, 'binary_recall': 0.6580557, 'binary_specificity': 0.9965252, 'binary_f1_score': 0.7486465}
confusion matrix:
       0    1
0  42158  147
1    503  968
---- Validation: 
scalar performance:
{'acc': 0.98068327, 'precision': 0.9257107, 'recall': 0.75523216, 'specificity': 0.75523216, 'f1': 0.81761634, 'auroc': 0.9813929, 'binary_precision': 0.8684211, 'binary_recall': 0.5132193, 'binary_specificity': 0.997245, 'binary_f1_score': 0.6451613}
confusion matrix:
       0    1
0  18099   50
1    313  330
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96692234, 'precision': 0.9267776, 'recall': 0.61810696, 'specificity': 0.61810696, 'f1': 0.67881715, 'auroc': 0.96326756, 'binary_precision': 0.8857143, 'binary_recall': 0.23754789, 'binary_specificity': 0.998666, 'binary_f1_score': 0.37462237}
confusion matrix:
      0   1
0  5989   8
1   199  62
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863196.png
early stop counter: 3
val acc:0.9806832671165466, best validation acc: 0.9827054142951965, corresponding to test acc:                         0.9621284604072571 / 0.9763502478599548
after epoch: 14,now: 2024-05-26 16:52:27.240660,epoch time: 0:18:13.392046,used: 4:17:01.337793,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863196
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9846491, 'precision': 0.88649493, 'recall': 0.8732906, 'specificity': 0.8732906, 'f1': 0.8797683, 'auroc': 0.98745215, 'binary_precision': 0.7815363, 'binary_recall': 0.75390893, 'binary_specificity': 0.99267226, 'binary_f1_score': 0.76747406}
confusion matrix:
       0     1
0  41995   310
1    362  1109
---- Validation: 
scalar performance:
{'acc': 0.98361003, 'precision': 0.89444625, 'recall': 0.8445039, 'specificity': 0.8445039, 'f1': 0.8676473, 'auroc': 0.9836614, 'binary_precision': 0.7996422, 'binary_recall': 0.69517887, 'binary_specificity': 0.99382883, 'binary_f1_score': 0.7437604}
confusion matrix:
       0    1
0  18037  112
1    196  447
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9643656, 'precision': 0.8585005, 'recall': 0.6076113, 'specificity': 0.6076113, 'f1': 0.65998435, 'auroc': 0.95816714, 'binary_precision': 0.75, 'binary_recall': 0.21839081, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.33827892}
confusion matrix:
      0   1
0  5978  19
1   204  57
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863196.png
better model found
persisted
after epoch: 15,now: 2024-05-26 17:10:43.835706,epoch time: 0:18:16.595046,used: 4:35:17.932839,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863196
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.97884685, 'precision': 0.8133629, 'recall': 0.9392215, 'specificity': 0.9392215, 'f1': 0.8646499, 'auroc': 0.98761445, 'binary_precision': 0.63037246, 'binary_recall': 0.8967391, 'binary_specificity': 0.9817039, 'binary_f1_score': 0.74032533}
confusion matrix:
       0     1
0  41530   774
1    152  1320
---- Validation: 
scalar performance:
{'acc': 0.97961897, 'precision': 0.8288207, 'recall': 0.901692, 'specificity': 0.901692, 'f1': 0.861253, 'auroc': 0.98275244, 'binary_precision': 0.6641414, 'binary_recall': 0.81804043, 'binary_specificity': 0.9853435, 'binary_f1_score': 0.73310107}
confusion matrix:
       0    1
0  17883  266
1    117  526
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95733464, 'precision': 0.7396542, 'recall': 0.84031385, 'specificity': 0.84031385, 'f1': 0.77983963, 'auroc': 0.9500743, 'binary_precision': 0.4920635, 'binary_recall': 0.7126437, 'binary_specificity': 0.967984, 'binary_f1_score': 0.58215964}
confusion matrix:
      0    1
0  5805  192
1    75  186
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863196.png
early stop counter: 1
val acc:0.9796189665794373, best validation acc: 0.9836100339889526, corresponding to test acc:                         0.9643656015396118 / 0.9763502478599548
after epoch: 16,now: 2024-05-26 17:29:00.417469,epoch time: 0:18:16.581763,used: 4:53:34.514602,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863196
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9845121, 'precision': 0.9268141, 'recall': 0.817117, 'specificity': 0.817117, 'f1': 0.8632787, 'auroc': 0.98874784, 'binary_precision': 0.86611265, 'binary_recall': 0.63766146, 'binary_specificity': 0.9965725, 'binary_f1_score': 0.734534}
confusion matrix:
       0    1
0  42160  145
1    533  938
---- Validation: 
scalar performance:
{'acc': 0.98068327, 'precision': 0.91761583, 'recall': 0.7619827, 'specificity': 0.7619827, 'f1': 0.8206817, 'auroc': 0.9810152, 'binary_precision': 0.8517588, 'binary_recall': 0.5272162, 'binary_specificity': 0.9967491, 'binary_f1_score': 0.6512969}
confusion matrix:
       0    1
0  18090   59
1    304  339
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650048, 'precision': 0.87934446, 'recall': 0.6079448, 'specificity': 0.6079448, 'f1': 0.6621832, 'auroc': 0.9582317, 'binary_precision': 0.7916667, 'binary_recall': 0.21839081, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.34234235}
confusion matrix:
      0   1
0  5982  15
1   204  57
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863196.png
early stop counter: 2
val acc:0.9806832671165466, best validation acc: 0.9836100339889526, corresponding to test acc:                         0.9643656015396118 / 0.9763502478599548
after epoch: 17,now: 2024-05-26 17:47:20.507325,epoch time: 0:18:20.089856,used: 5:11:54.604458,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863196
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9862253, 'precision': 0.91404074, 'recall': 0.86351633, 'specificity': 0.86351633, 'f1': 0.8870071, 'auroc': 0.9899235, 'binary_precision': 0.83735406, 'binary_recall': 0.7319728, 'binary_specificity': 0.9950598, 'binary_f1_score': 0.78112525}
confusion matrix:
       0     1
0  42097   209
1    394  1076
---- Validation: 
scalar performance:
{'acc': 0.9841954, 'precision': 0.90998906, 'recall': 0.8350562, 'specificity': 0.8350562, 'f1': 0.8684547, 'auroc': 0.9826717, 'binary_precision': 0.8314176, 'binary_recall': 0.6749611, 'binary_specificity': 0.9951512, 'binary_f1_score': 0.74506444}
confusion matrix:
       0    1
0  18061   88
1    209  434
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608501, 'precision': 0.7852424, 'recall': 0.58562136, 'specificity': 0.58562136, 'f1': 0.6264402, 'auroc': 0.95871866, 'binary_precision': 0.6052632, 'binary_recall': 0.17624521, 'binary_specificity': 0.9949975, 'binary_f1_score': 0.27299705}
confusion matrix:
      0   1
0  5967  30
1   215  46
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863196.png
better model found
persisted
after epoch: 18,now: 2024-05-26 18:05:39.131698,epoch time: 0:18:18.624373,used: 5:30:13.228831,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863196
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9806972, 'precision': 0.83624387, 'recall': 0.896902, 'specificity': 0.896902, 'f1': 0.8638195, 'auroc': 0.98676324, 'binary_precision': 0.6792453, 'binary_recall': 0.8070652, 'binary_specificity': 0.98673886, 'binary_f1_score': 0.7376591}
confusion matrix:
       0     1
0  41743   561
1    284  1188
---- Validation: 
scalar performance:
{'acc': 0.9801511, 'precision': 0.8363142, 'recall': 0.8899666, 'specificity': 0.8899666, 'f1': 0.86096305, 'auroc': 0.9799191, 'binary_precision': 0.68, 'binary_recall': 0.7931571, 'binary_specificity': 0.9867761, 'binary_f1_score': 0.7322326}
confusion matrix:
       0    1
0  17909  240
1    133  510
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95717484, 'precision': 0.69163585, 'recall': 0.5342307, 'specificity': 0.5342307, 'f1': 0.5511169, 'auroc': 0.92359143, 'binary_precision': 0.42222223, 'binary_recall': 0.07279693, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.12418301}
confusion matrix:
      0   1
0  5971  26
1   242  19
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863196.png
early stop counter: 1
val acc:0.9801511168479919, best validation acc: 0.9841954112052917, corresponding to test acc:                         0.9608501195907593 / 0.9763502478599548
after epoch: 19,now: 2024-05-26 18:23:53.812172,epoch time: 0:18:14.680474,used: 5:48:27.909305,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863196
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.98665935, 'precision': 0.92258954, 'recall': 0.8613, 'specificity': 0.8613, 'f1': 0.88936245, 'auroc': 0.9903308, 'binary_precision': 0.8546326, 'binary_recall': 0.7269022, 'binary_specificity': 0.9956978, 'binary_f1_score': 0.78560936}
confusion matrix:
       0     1
0  42122   182
1    402  1070
---- Validation: 
scalar performance:
{'acc': 0.98408896, 'precision': 0.91796815, 'recall': 0.82375026, 'specificity': 0.82375026, 'f1': 0.8644118, 'auroc': 0.9795474, 'binary_precision': 0.84817815, 'binary_recall': 0.65163296, 'binary_specificity': 0.99586755, 'binary_f1_score': 0.7370272}
confusion matrix:
       0    1
0  18074   75
1    224  419
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589326, 'precision': 0.75191224, 'recall': 0.54797417, 'specificity': 0.54797417, 'f1': 0.5736157, 'auroc': 0.9490926, 'binary_precision': 0.5416667, 'binary_recall': 0.099616855, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.16828479}
confusion matrix:
      0   1
0  5975  22
1   235  26
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863196.png
early stop counter: 2
val acc:0.9840889573097229, best validation acc: 0.9841954112052917, corresponding to test acc:                         0.9608501195907593 / 0.9763502478599548
after epoch: 20,now: 2024-05-26 18:42:09.685684,epoch time: 0:18:15.873512,used: 6:06:43.782817,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863196
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.98677355, 'precision': 0.9478367, 'recall': 0.83654964, 'specificity': 0.83654964, 'f1': 0.88372815, 'auroc': 0.99186534, 'binary_precision': 0.9068493, 'binary_recall': 0.6755102, 'binary_specificity': 0.997589, 'binary_f1_score': 0.77426904}
confusion matrix:
       0    1
0  42204  102
1    477  993
---- Validation: 
scalar performance:
{'acc': 0.9830247, 'precision': 0.9419473, 'recall': 0.78269625, 'specificity': 0.78269625, 'f1': 0.8435848, 'auroc': 0.97860485, 'binary_precision': 0.8990148, 'binary_recall': 0.5676516, 'binary_specificity': 0.9977409, 'binary_f1_score': 0.69590086}
confusion matrix:
       0    1
0  18108   41
1    278  365
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96580374, 'precision': 0.85826963, 'recall': 0.63401437, 'specificity': 0.63401437, 'f1': 0.69063884, 'auroc': 0.95412016, 'binary_precision': 0.7473684, 'binary_recall': 0.27203065, 'binary_specificity': 0.995998, 'binary_f1_score': 0.3988764}
confusion matrix:
      0   1
0  5973  24
1   190  71
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863196.png
early stop counter: 3
val acc:0.9830247163772583, best validation acc: 0.9841954112052917, corresponding to test acc:                         0.9608501195907593 / 0.9763502478599548
after epoch: 21,now: 2024-05-26 19:00:33.320729,epoch time: 0:18:23.635045,used: 6:25:07.417862,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863196
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9892407, 'precision': 0.94289804, 'recall': 0.8841964, 'specificity': 0.8841964, 'f1': 0.91130567, 'auroc': 0.99332064, 'binary_precision': 0.8937008, 'binary_recall': 0.771584, 'binary_specificity': 0.9968089, 'binary_f1_score': 0.8281649}
confusion matrix:
       0     1
0  42170   135
1    336  1135
---- Validation: 
scalar performance:
{'acc': 0.9850468, 'precision': 0.92804146, 'recall': 0.83024657, 'specificity': 0.83024657, 'f1': 0.8723568, 'auroc': 0.9860384, 'binary_precision': 0.8678862, 'binary_recall': 0.66407466, 'binary_specificity': 0.99641854, 'binary_f1_score': 0.7524229}
confusion matrix:
       0    1
0  18084   65
1    216  427
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96196866, 'precision': 0.799401, 'recall': 0.602696, 'specificity': 0.602696, 'f1': 0.6482662, 'auroc': 0.9468691, 'binary_precision': 0.6321839, 'binary_recall': 0.21072797, 'binary_specificity': 0.994664, 'binary_f1_score': 0.31609195}
confusion matrix:
      0   1
0  5965  32
1   206  55
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863196.png
better model found
persisted
after epoch: 22,now: 2024-05-26 19:18:43.640458,epoch time: 0:18:10.319729,used: 6:43:17.737591,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863196
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9879386, 'precision': 0.93031406, 'recall': 0.87523717, 'specificity': 0.87523717, 'f1': 0.9007472, 'auroc': 0.99167514, 'binary_precision': 0.86912227, 'binary_recall': 0.7544218, 'binary_specificity': 0.99605256, 'binary_f1_score': 0.80772036}
confusion matrix:
       0     1
0  42139   167
1    361  1109
---- Validation: 
scalar performance:
{'acc': 0.98483396, 'precision': 0.9398365, 'recall': 0.8151353, 'specificity': 0.8151353, 'f1': 0.86643094, 'auroc': 0.98588073, 'binary_precision': 0.89254385, 'binary_recall': 0.63297045, 'binary_specificity': 0.99730015, 'binary_f1_score': 0.7406733}
confusion matrix:
       0    1
0  18100   49
1    236  407
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614893, 'precision': 0.85054696, 'recall': 0.55846983, 'specificity': 0.55846983, 'f1': 0.59244365, 'auroc': 0.955894, 'binary_precision': 0.7380952, 'binary_recall': 0.118773945, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.20462047}
confusion matrix:
      0   1
0  5986  11
1   230  31
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863196.png
early stop counter: 1
val acc:0.9848339557647705, best validation acc: 0.9850468039512634, corresponding to test acc:                         0.9619686603546143 / 0.9763502478599548
after epoch: 23,now: 2024-05-26 19:36:47.088465,epoch time: 0:18:03.448007,used: 7:01:21.185598,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863196
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.987733, 'precision': 0.9048512, 'recall': 0.9067105, 'specificity': 0.9067105, 'f1': 0.9057785, 'auroc': 0.99221826, 'binary_precision': 0.8159675, 'binary_recall': 0.81985044, 'binary_specificity': 0.9935705, 'binary_f1_score': 0.8179043}
confusion matrix:
       0     1
0  42033   272
1    265  1206
---- Validation: 
scalar performance:
{'acc': 0.98291826, 'precision': 0.88397527, 'recall': 0.84639585, 'specificity': 0.84639585, 'f1': 0.8641366, 'auroc': 0.97998834, 'binary_precision': 0.7785467, 'binary_recall': 0.6998445, 'binary_specificity': 0.9929473, 'binary_f1_score': 0.7371007}
confusion matrix:
       0    1
0  18021  128
1    193  450
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96660274, 'precision': 0.840737, 'recall': 0.66558087, 'specificity': 0.66558087, 'f1': 0.7199571, 'auroc': 0.95459974, 'binary_precision': 0.7096774, 'binary_recall': 0.33716476, 'binary_specificity': 0.993997, 'binary_f1_score': 0.4571429}
confusion matrix:
      0   1
0  5961  36
1   173  88
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863196.png
early stop counter: 2
val acc:0.9829182624816895, best validation acc: 0.9850468039512634, corresponding to test acc:                         0.9619686603546143 / 0.9763502478599548
after epoch: 24,now: 2024-05-26 19:54:43.878684,epoch time: 0:17:56.790219,used: 7:19:17.975817,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863196
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9862482, 'precision': 0.9619787, 'recall': 0.8157973, 'specificity': 0.8157973, 'f1': 0.8742043, 'auroc': 0.993279, 'binary_precision': 0.93655586, 'binary_recall': 0.6330837, 'binary_specificity': 0.9985109, 'binary_f1_score': 0.7554833}
confusion matrix:
       0    1
0  42244   63
1    539  930
---- Validation: 
scalar performance:
{'acc': 0.9819604, 'precision': 0.9585755, 'recall': 0.75364316, 'specificity': 0.75364316, 'f1': 0.8246728, 'auroc': 0.98339844, 'binary_precision': 0.9342857, 'binary_recall': 0.5085537, 'binary_specificity': 0.9987327, 'binary_f1_score': 0.6586103}
confusion matrix:
       0    1
0  18126   23
1    316  327
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96756154, 'precision': 0.9250988, 'recall': 0.6276021, 'specificity': 0.6276021, 'f1': 0.69047904, 'auroc': 0.9597115, 'binary_precision': 0.8815789, 'binary_recall': 0.256705, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.3976261}
confusion matrix:
      0   1
0  5988   9
1   194  67
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863196.png
early stop counter: 3
val acc:0.9819604158401489, best validation acc: 0.9850468039512634, corresponding to test acc:                         0.9619686603546143 / 0.9763502478599548
after epoch: 25,now: 2024-05-26 20:12:50.390126,epoch time: 0:18:06.511442,used: 7:37:24.487259,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863196
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9854715, 'precision': 0.93960506, 'recall': 0.82199854, 'specificity': 0.82199854, 'f1': 0.8710625, 'auroc': 0.9917722, 'binary_precision': 0.8913858, 'binary_recall': 0.6467391, 'binary_specificity': 0.99725795, 'binary_f1_score': 0.7496064}
confusion matrix:
       0    1
0  42188  116
1    520  952
---- Validation: 
scalar performance:
{'acc': 0.9823329, 'precision': 0.94291747, 'recall': 0.7703372, 'specificity': 0.7703372, 'f1': 0.8342937, 'auroc': 0.9800699, 'binary_precision': 0.9018088, 'binary_recall': 0.5427683, 'binary_specificity': 0.9979062, 'binary_f1_score': 0.67766994}
confusion matrix:
       0    1
0  18111   38
1    294  349
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96164906, 'precision': 0.9254266, 'recall': 0.5457269, 'specificity': 0.5457269, 'f1': 0.57351977, 'auroc': 0.9519594, 'binary_precision': 0.8888889, 'binary_recall': 0.09195402, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.16666666}
confusion matrix:
      0   1
0  5994   3
1   237  24
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863196.png
early stop counter: 4
val acc:0.9823328852653503, best validation acc: 0.9850468039512634, corresponding to test acc:                         0.9619686603546143 / 0.9763502478599548
after epoch: 26,now: 2024-05-26 20:31:06.186978,epoch time: 0:18:15.796852,used: 7:55:40.284111,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863196
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9893549, 'precision': 0.92376643, 'recall': 0.9098462, 'specificity': 0.9098462, 'f1': 0.9166807, 'auroc': 0.99463016, 'binary_precision': 0.8536242, 'binary_recall': 0.8246091, 'binary_specificity': 0.99508333, 'binary_f1_score': 0.8388658}
confusion matrix:
       0     1
0  42097   208
1    258  1213
---- Validation: 
scalar performance:
{'acc': 0.98632395, 'precision': 0.92969346, 'recall': 0.8511593, 'specificity': 0.8511593, 'f1': 0.88617116, 'auroc': 0.98452497, 'binary_precision': 0.8697318, 'binary_recall': 0.7060653, 'binary_specificity': 0.99625325, 'binary_f1_score': 0.7793991}
confusion matrix:
       0    1
0  18081   68
1    189  454
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96212846, 'precision': 0.8474181, 'recall': 0.5716297, 'specificity': 0.5716297, 'f1': 0.611695, 'auroc': 0.9476399, 'binary_precision': 0.7307692, 'binary_recall': 0.14559387, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.24281149}
confusion matrix:
      0   1
0  5983  14
1   223  38
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863196.png
better model found
persisted
after epoch: 27,now: 2024-05-26 20:49:21.531821,epoch time: 0:18:15.344843,used: 8:13:55.628954,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863196
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9859055, 'precision': 0.93713, 'recall': 0.8312766, 'specificity': 0.8312766, 'f1': 0.8763776, 'auroc': 0.99385196, 'binary_precision': 0.8857661, 'binary_recall': 0.66553134, 'binary_specificity': 0.99702185, 'binary_f1_score': 0.76001555}
confusion matrix:
       0    1
0  42182  126
1    491  977
---- Validation: 
scalar performance:
{'acc': 0.97914004, 'precision': 0.9017364, 'recall': 0.7476827, 'specificity': 0.7476827, 'f1': 0.8050823, 'auroc': 0.98314047, 'binary_precision': 0.82097185, 'binary_recall': 0.4992224, 'binary_specificity': 0.99614304, 'binary_f1_score': 0.6208897}
confusion matrix:
       0    1
0  18079   70
1    322  321
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96212846, 'precision': 0.8291822, 'recall': 0.58079135, 'specificity': 0.58079135, 'f1': 0.6234083, 'auroc': 0.9514651, 'binary_precision': 0.6935484, 'binary_recall': 0.16475096, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.2662539}
confusion matrix:
      0   1
0  5978  19
1   218  43
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863196.png
early stop counter: 1
val acc:0.979140043258667, best validation acc: 0.9863239526748657, corresponding to test acc:                         0.9621284604072571 / 0.9763502478599548
after epoch: 28,now: 2024-05-26 21:07:38.162457,epoch time: 0:18:16.630636,used: 8:32:12.259590,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863196
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9883041, 'precision': 0.9421458, 'recall': 0.8685316, 'specificity': 0.8685316, 'f1': 0.9017453, 'auroc': 0.9916518, 'binary_precision': 0.89326763, 'binary_recall': 0.740136, 'binary_specificity': 0.99692714, 'binary_f1_score': 0.80952376}
confusion matrix:
       0     1
0  42176   130
1    382  1088
---- Validation: 
scalar performance:
{'acc': 0.98286504, 'precision': 0.92169785, 'recall': 0.7976147, 'specificity': 0.7976147, 'f1': 0.84815216, 'auroc': 0.9760695, 'binary_precision': 0.85746104, 'binary_recall': 0.59875584, 'binary_specificity': 0.9964736, 'binary_f1_score': 0.70512825}
confusion matrix:
       0    1
0  18085   64
1    258  385
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9638862, 'precision': 0.86758006, 'recall': 0.5945348, 'specificity': 0.5945348, 'f1': 0.64410436, 'auroc': 0.9567559, 'binary_precision': 0.7692308, 'binary_recall': 0.19157088, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.30674848}
confusion matrix:
      0   1
0  5982  15
1   211  50
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863196.png
early stop counter: 2
val acc:0.982865035533905, best validation acc: 0.9863239526748657, corresponding to test acc:                         0.9621284604072571 / 0.9763502478599548
after epoch: 29,now: 2024-05-26 21:25:57.095212,epoch time: 0:18:18.932755,used: 8:50:31.192345,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863196
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9891036, 'precision': 0.9302407, 'recall': 0.89652395, 'specificity': 0.89652395, 'f1': 0.9126407, 'auroc': 0.99317473, 'binary_precision': 0.86750555, 'binary_recall': 0.79727894, 'binary_specificity': 0.9957689, 'binary_f1_score': 0.83091104}
confusion matrix:
       0     1
0  42127   179
1    298  1172
---- Validation: 
scalar performance:
{'acc': 0.9844615, 'precision': 0.903993, 'recall': 0.84794486, 'specificity': 0.84794486, 'f1': 0.8737098, 'auroc': 0.98404765, 'binary_precision': 0.8185118, 'binary_recall': 0.7013997, 'binary_specificity': 0.99449, 'binary_f1_score': 0.7554438}
confusion matrix:
       0    1
0  18049  100
1    192  451
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.7791153, 'recall': 0.5520557, 'specificity': 0.5520557, 'f1': 0.580588, 'auroc': 0.9421282, 'binary_precision': 0.59574467, 'binary_recall': 0.107279696, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.18181817}
confusion matrix:
      0   1
0  5978  19
1   233  28
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863196.png
early stop counter: 3
val acc:0.9844614863395691, best validation acc: 0.9863239526748657, corresponding to test acc:                         0.9621284604072571 / 0.9763502478599548
after epoch: 30,now: 2024-05-26 21:44:12.991545,epoch time: 0:18:15.896333,used: 9:08:47.088678,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863196
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 9:08:47.088678 at 2024-05-26 21:44:12.991545
persisted model performance metric: 

scalar performance:
{'acc': 0.9611697, 'precision': 0.8183303, 'recall': 0.56563246, 'specificity': 0.56563246, 'f1': 0.6018645, 'auroc': 0.9471717, 'binary_precision': 0.6730769, 'binary_recall': 0.13409962, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.22364217}
confusion matrix:
      0   1
0  5980  17
1   226  35
oracle model performance metric: 

scalar performance:
{'acc': 0.9745925, 'precision': 0.9468749, 'recall': 0.7137256, 'specificity': 0.7137256, 'f1': 0.7858758, 'auroc': 0.95883477, 'binary_precision': 0.91803277, 'binary_recall': 0.42911878, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.5848564}
confusion matrix:
      0    1
0  5987   10
1   149  112
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs32/rule_results/1.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs32/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs32/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456443 KiB |  26075 MiB |   1107 TiB |   1107 TiB |
|       from large pool | 415344 KiB |  26030 MiB |   1100 TiB |   1100 TiB |
|       from small pool |  41099 KiB |     57 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 456443 KiB |  26075 MiB |   1107 TiB |   1107 TiB |
|       from large pool | 415344 KiB |  26030 MiB |   1100 TiB |   1100 TiB |
|       from small pool |  41099 KiB |     57 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447754 KiB |  26071 MiB |   1106 TiB |   1106 TiB |
|       from large pool | 407075 KiB |  26026 MiB |   1100 TiB |   1100 TiB |
|       from small pool |  40679 KiB |     56 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  27758 MiB |  27758 MiB |  27758 MiB |      0 B   |
|       from large pool |  27690 MiB |  27690 MiB |  27690 MiB |      0 B   |
|       from small pool |     68 MiB |     68 MiB |     68 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 735492 KiB |   1705 MiB | 527577 GiB | 527576 GiB |
|       from large pool | 719248 KiB |   1701 MiB | 520673 GiB | 520672 GiB |
|       from small pool |  16244 KiB |     21 MiB |   6903 GiB |   6903 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2312    |    3741    |   98677 K  |   98675 K  |
|       from large pool |     187    |    1413    |   51244 K  |   51244 K  |
|       from small pool |    2125    |    3552    |   47432 K  |   47430 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2312    |    3741    |   98677 K  |   98675 K  |
|       from large pool |     187    |    1413    |   51244 K  |   51244 K  |
|       from small pool |    2125    |    3552    |   47432 K  |   47430 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     835    |     835    |     835    |       0    |
|       from large pool |     801    |     801    |     801    |       0    |
|       from small pool |      34    |      34    |      34    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      88    |    1448    |   69660 K  |   69660 K  |
|       from large pool |      36    |     800    |   45213 K  |   45213 K  |
|       from small pool |      52    |    1411    |   24446 K  |   24446 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  26075 MiB |   1107 TiB |   1107 TiB |
|       from large pool |  16640 KiB |  26030 MiB |   1100 TiB |   1100 TiB |
|       from small pool |      0 KiB |     57 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  26075 MiB |   1107 TiB |   1107 TiB |
|       from large pool |  16640 KiB |  26030 MiB |   1100 TiB |   1100 TiB |
|       from small pool |      0 KiB |     57 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  26071 MiB |   1106 TiB |   1106 TiB |
|       from large pool |  16640 KiB |  26026 MiB |   1100 TiB |   1100 TiB |
|       from small pool |      0 KiB |     56 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1164 MiB |  27758 MiB |  27758 MiB |  26594 MiB |
|       from large pool |   1108 MiB |  27690 MiB |  27690 MiB |  26582 MiB |
|       from small pool |     56 MiB |     68 MiB |     68 MiB |     12 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   3840 KiB |   1705 MiB | 527577 GiB | 527577 GiB |
|       from large pool |   3840 KiB |   1701 MiB | 520673 GiB | 520673 GiB |
|       from small pool |      0 KiB |     35 MiB |   6903 GiB |   6903 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3741    |   98677 K  |   98677 K  |
|       from large pool |       2    |    1413    |   51244 K  |   51244 K  |
|       from small pool |       0    |    3552    |   47432 K  |   47432 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3741    |   98677 K  |   98677 K  |
|       from large pool |       2    |    1413    |   51244 K  |   51244 K  |
|       from small pool |       0    |    3552    |   47432 K  |   47432 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      66    |     835    |     835    |     769    |
|       from large pool |      38    |     801    |     801    |     763    |
|       from small pool |      28    |      34    |      34    |       6    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |    1448    |   69660 K  |   69660 K  |
|       from large pool |       1    |     800    |   45213 K  |   45213 K  |
|       from small pool |       0    |    1411    |   24447 K  |   24447 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  26075 MiB |   1107 TiB |   1107 TiB |
|       from large pool |  16640 KiB |  26030 MiB |   1100 TiB |   1100 TiB |
|       from small pool |      0 KiB |     57 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  26075 MiB |   1107 TiB |   1107 TiB |
|       from large pool |  16640 KiB |  26030 MiB |   1100 TiB |   1100 TiB |
|       from small pool |      0 KiB |     57 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  26071 MiB |   1106 TiB |   1106 TiB |
|       from large pool |  16640 KiB |  26026 MiB |   1100 TiB |   1100 TiB |
|       from small pool |      0 KiB |     56 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1164 MiB |  27758 MiB |  27758 MiB |  26594 MiB |
|       from large pool |   1108 MiB |  27690 MiB |  27690 MiB |  26582 MiB |
|       from small pool |     56 MiB |     68 MiB |     68 MiB |     12 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   3840 KiB |   1705 MiB | 527577 GiB | 527577 GiB |
|       from large pool |   3840 KiB |   1701 MiB | 520673 GiB | 520673 GiB |
|       from small pool |      0 KiB |     35 MiB |   6903 GiB |   6903 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3741    |   98677 K  |   98677 K  |
|       from large pool |       2    |    1413    |   51244 K  |   51244 K  |
|       from small pool |       0    |    3552    |   47432 K  |   47432 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3741    |   98677 K  |   98677 K  |
|       from large pool |       2    |    1413    |   51244 K  |   51244 K  |
|       from small pool |       0    |    3552    |   47432 K  |   47432 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      66    |     835    |     835    |     769    |
|       from large pool |      38    |     801    |     801    |     763    |
|       from small pool |      28    |      34    |      34    |       6    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |    1448    |   69660 K  |   69660 K  |
|       from large pool |       1    |     800    |   45213 K  |   45213 K  |
|       from small pool |       0    |    1411    |   24447 K  |   24447 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_21_52_33_seed_1_20863196

 Experiment start at: 2024-05-26 21:52:33.594546
before training, model accuracy: 0.181115061044693
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96751827, 'precision': 0.8744521, 'recall': 0.508586, 'specificity': 0.508586, 'f1': 0.5087013, 'auroc': 0.9487496, 'binary_precision': 0.78125, 'binary_recall': 0.017337032, 'binary_specificity': 0.9998349, 'binary_f1_score': 0.0339213}
confusion matrix:
       0   1
0  42391   7
1   1417  25
---- Validation: 
scalar performance:
{'acc': 0.9646211, 'precision': 0.88862556, 'recall': 0.5095752, 'specificity': 0.5095752, 'f1': 0.50985754, 'auroc': 0.949306, 'binary_precision': 0.8125, 'binary_recall': 0.019316493, 'binary_specificity': 0.99983394, 'binary_f1_score': 0.037735846}
confusion matrix:
       0   1
0  18064   3
1    660  13
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.9449151, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863196.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-26 22:11:44.892869,epoch time: 0:19:11.298323,used: 0:19:11.298323,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_21_52_33_seed_1_20863196
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9696168, 'precision': 0.75997204, 'recall': 0.79739094, 'specificity': 0.79739094, 'f1': 0.7772871, 'auroc': 0.95968974, 'binary_precision': 0.5331725, 'binary_recall': 0.61303747, 'binary_specificity': 0.9817444, 'binary_f1_score': 0.5703226}
confusion matrix:
       0    1
0  41624  774
1    558  884
---- Validation: 
scalar performance:
{'acc': 0.9665422, 'precision': 0.75737345, 'recall': 0.8066921, 'specificity': 0.8066921, 'f1': 0.77961016, 'auroc': 0.95971835, 'binary_precision': 0.52846533, 'binary_recall': 0.6344725, 'binary_specificity': 0.9789118, 'binary_f1_score': 0.5766374}
confusion matrix:
       0    1
0  17686  381
1    246  427
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97437966, 'precision': 0.92011684, 'recall': 0.7291715, 'specificity': 0.7291715, 'f1': 0.794134, 'auroc': 0.94432664, 'binary_precision': 0.8633093, 'binary_recall': 0.46153846, 'binary_specificity': 0.9968046, 'binary_f1_score': 0.60150373}
confusion matrix:
      0    1
0  5927   19
1   140  120
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863196.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-05-26 22:30:00.035739,epoch time: 0:18:15.142870,used: 0:37:26.441193,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_21_52_33_seed_1_20863196
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9732208, 'precision': 0.8280781, 'recall': 0.67319965, 'specificity': 0.67319965, 'f1': 0.7248523, 'auroc': 0.96929777, 'binary_precision': 0.6778075, 'binary_recall': 0.35208333, 'binary_specificity': 0.99431604, 'binary_f1_score': 0.46343696}
confusion matrix:
       0    1
0  42159  241
1    933  507
---- Validation: 
scalar performance:
{'acc': 0.9693703, 'precision': 0.90357685, 'recall': 0.5907177, 'specificity': 0.5907177, 'f1': 0.64217126, 'auroc': 0.9693198, 'binary_precision': 0.8367347, 'binary_recall': 0.18276374, 'binary_specificity': 0.9986716, 'binary_f1_score': 0.29999998}
confusion matrix:
       0    1
0  18043   24
1    550  123
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9643893, 'precision': 0.982082, 'recall': 0.575, 'specificity': 0.575, 'f1': 0.6213124, 'auroc': 0.9582528, 'binary_precision': 1.0, 'binary_recall': 0.15, 'binary_specificity': 1.0, 'binary_f1_score': 0.2608696}
confusion matrix:
      0   1
0  5946   0
1   221  39
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863196.png
better model found
persisted
after epoch: 3,now: 2024-05-26 22:48:15.189342,epoch time: 0:18:15.153603,used: 0:55:41.594796,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_21_52_33_seed_1_20863196
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9726505, 'precision': 0.83020306, 'recall': 0.6540239, 'specificity': 0.6540239, 'f1': 0.7076545, 'auroc': 0.97358596, 'binary_precision': 0.68333334, 'binary_recall': 0.3129771, 'binary_specificity': 0.99507064, 'binary_f1_score': 0.42931938}
confusion matrix:
       0    1
0  42190  209
1    990  451
---- Validation: 
scalar performance:
{'acc': 0.96915686, 'precision': 0.8373378, 'recall': 0.6206482, 'specificity': 0.6206482, 'f1': 0.67381585, 'auroc': 0.97007906, 'binary_precision': 0.70212764, 'binary_recall': 0.24517088, 'binary_specificity': 0.9961255, 'binary_f1_score': 0.36343613}
confusion matrix:
       0    1
0  17997   70
1    508  165
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9658395, 'precision': 0.95523584, 'recall': 0.59782463, 'specificity': 0.59782463, 'f1': 0.6536586, 'auroc': 0.9550351, 'binary_precision': 0.9444444, 'binary_recall': 0.19615385, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.32484075}
confusion matrix:
      0   1
0  5943   3
1   209  51
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863196.png
early stop counter: 1
val acc:0.9691568613052368, best validation acc: 0.9693703055381775, corresponding to test acc:                         0.9643893241882324 / 0.9743796586990356
after epoch: 4,now: 2024-05-26 23:06:24.507419,epoch time: 0:18:09.318077,used: 1:13:50.912873,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_21_52_33_seed_1_20863196
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9757527, 'precision': 0.8617468, 'recall': 0.69786143, 'specificity': 0.69786143, 'f1': 0.7540425, 'auroc': 0.97332716, 'binary_precision': 0.7435567, 'binary_recall': 0.40041637, 'binary_specificity': 0.9953065, 'binary_f1_score': 0.5205232}
confusion matrix:
       0    1
0  42200  199
1    864  577
---- Validation: 
scalar performance:
{'acc': 0.9723586, 'precision': 0.91872793, 'recall': 0.63589877, 'specificity': 0.63589877, 'f1': 0.7005973, 'auroc': 0.9714748, 'binary_precision': 0.86384976, 'binary_recall': 0.27340266, 'binary_specificity': 0.99839485, 'binary_f1_score': 0.41534987}
confusion matrix:
       0    1
0  18038   29
1    489  184
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96003866, 'precision': 0.8377191, 'recall': 0.5377888, 'specificity': 0.5377888, 'f1': 0.5592168, 'auroc': 0.954737, 'binary_precision': 0.71428573, 'binary_recall': 0.07692308, 'binary_specificity': 0.99865454, 'binary_f1_score': 0.1388889}
confusion matrix:
      0   1
0  5938   8
1   240  20
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863196.png
better model found
persisted
after epoch: 5,now: 2024-05-26 23:24:23.781567,epoch time: 0:17:59.274148,used: 1:31:50.187021,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_21_52_33_seed_1_20863196
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97933394, 'precision': 0.84654516, 'recall': 0.8138863, 'specificity': 0.8138863, 'f1': 0.8293383, 'auroc': 0.9772402, 'binary_precision': 0.7053846, 'binary_recall': 0.63680553, 'binary_specificity': 0.990967, 'binary_f1_score': 0.66934305}
confusion matrix:
       0    1
0  42017  383
1    523  917
---- Validation: 
scalar performance:
{'acc': 0.9776414, 'precision': 0.89557636, 'recall': 0.74449813, 'specificity': 0.74449813, 'f1': 0.80079985, 'auroc': 0.97112715, 'binary_precision': 0.8097561, 'binary_recall': 0.49331352, 'binary_specificity': 0.9956827, 'binary_f1_score': 0.61311173}
confusion matrix:
       0    1
0  17989   78
1    341  332
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9697067, 'precision': 0.90898323, 'recall': 0.6678853, 'specificity': 0.6678853, 'f1': 0.7339561, 'auroc': 0.95485055, 'binary_precision': 0.84615386, 'binary_recall': 0.33846155, 'binary_specificity': 0.9973091, 'binary_f1_score': 0.4835165}
confusion matrix:
      0   1
0  5930  16
1   172  88
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863196.png
better model found
persisted
after epoch: 6,now: 2024-05-26 23:42:20.867588,epoch time: 0:17:57.086021,used: 1:49:47.273042,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_21_52_33_seed_1_20863196
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9720347, 'precision': 0.7711724, 'recall': 0.92759585, 'specificity': 0.92759585, 'f1': 0.8298364, 'auroc': 0.98174477, 'binary_precision': 0.54651165, 'binary_recall': 0.8800277, 'binary_specificity': 0.97516394, 'binary_f1_score': 0.67428267}
confusion matrix:
       0     1
0  41345  1053
1    173  1269
---- Validation: 
scalar performance:
{'acc': 0.97049093, 'precision': 0.7760058, 'recall': 0.9238981, 'specificity': 0.9238981, 'f1': 0.8323469, 'auroc': 0.9773195, 'binary_precision': 0.5568182, 'binary_recall': 0.87369984, 'binary_specificity': 0.9740964, 'binary_f1_score': 0.68016195}
confusion matrix:
       0    1
0  17599  468
1     85  588
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9734128, 'precision': 0.851702, 'recall': 0.7930315, 'specificity': 0.7930315, 'f1': 0.8194045, 'auroc': 0.95896965, 'binary_precision': 0.7209302, 'binary_recall': 0.59615386, 'binary_specificity': 0.9899092, 'binary_f1_score': 0.6526316}
confusion matrix:
      0    1
0  5886   60
1   105  155
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863196.png
early stop counter: 1
val acc:0.9704909324645996, best validation acc: 0.9776414036750793, corresponding to test acc:                         0.9697067141532898 / 0.9743796586990356
after epoch: 7,now: 2024-05-27 00:00:33.081739,epoch time: 0:18:12.214151,used: 2:07:59.487193,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_21_52_33_seed_1_20863196
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98261863, 'precision': 0.88788724, 'recall': 0.8192741, 'specificity': 0.8192741, 'f1': 0.84999, 'auroc': 0.9829058, 'binary_precision': 0.7877759, 'binary_recall': 0.64444447, 'binary_specificity': 0.9941038, 'binary_f1_score': 0.7089381}
confusion matrix:
       0    1
0  42150  250
1    512  928
---- Validation: 
scalar performance:
{'acc': 0.9802028, 'precision': 0.93276685, 'recall': 0.7572708, 'specificity': 0.7572708, 'f1': 0.82105374, 'auroc': 0.9768204, 'binary_precision': 0.88324875, 'binary_recall': 0.51708764, 'binary_specificity': 0.9974539, 'binary_f1_score': 0.6522961}
confusion matrix:
       0    1
0  18021   46
1    325  348
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96036094, 'precision': 0.78363085, 'recall': 0.57657576, 'specificity': 0.57657576, 'f1': 0.61482126, 'auroc': 0.95452094, 'binary_precision': 0.60294116, 'binary_recall': 0.15769231, 'binary_specificity': 0.99545914, 'binary_f1_score': 0.25}
confusion matrix:
      0   1
0  5919  27
1   219  41
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863196.png
better model found
persisted
after epoch: 8,now: 2024-05-27 00:18:54.383835,epoch time: 0:18:21.302096,used: 2:26:20.789289,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_21_52_33_seed_1_20863196
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.97627735, 'precision': 0.79507554, 'recall': 0.9277368, 'specificity': 0.9277368, 'f1': 0.8479146, 'auroc': 0.98058116, 'binary_precision': 0.59444183, 'binary_recall': 0.8757807, 'binary_specificity': 0.97969294, 'binary_f1_score': 0.70819306}
confusion matrix:
       0     1
0  41538   861
1    179  1262
---- Validation: 
scalar performance:
{'acc': 0.97758806, 'precision': 0.82108986, 'recall': 0.901114, 'specificity': 0.901114, 'f1': 0.8561835, 'auroc': 0.9753286, 'binary_precision': 0.6489988, 'binary_recall': 0.8187221, 'binary_specificity': 0.98350585, 'binary_f1_score': 0.72404724}
confusion matrix:
       0    1
0  17769  298
1    122  551
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9634225, 'precision': 0.7773024, 'recall': 0.72897035, 'specificity': 0.72897035, 'f1': 0.7505356, 'auroc': 0.95460534, 'binary_precision': 0.57746476, 'binary_recall': 0.4730769, 'binary_specificity': 0.98486376, 'binary_f1_score': 0.52008456}
confusion matrix:
      0    1
0  5856   90
1   137  123
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863196.png
early stop counter: 1
val acc:0.9775880575180054, best validation acc: 0.9802027940750122, corresponding to test acc:                         0.9603609442710876 / 0.9743796586990356
after epoch: 9,now: 2024-05-27 00:37:19.774902,epoch time: 0:18:25.391067,used: 2:44:46.180356,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_21_52_33_seed_1_20863196
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9812728, 'precision': 0.90494037, 'recall': 0.77126217, 'specificity': 0.77126217, 'f1': 0.82393086, 'auroc': 0.98098767, 'binary_precision': 0.8251309, 'binary_recall': 0.54646325, 'binary_specificity': 0.99606115, 'binary_f1_score': 0.6574885}
confusion matrix:
       0    1
0  42231  167
1    654  788
---- Validation: 
scalar performance:
{'acc': 0.9767343, 'precision': 0.91949964, 'recall': 0.70897955, 'specificity': 0.70897955, 'f1': 0.7764589, 'auroc': 0.97547543, 'binary_precision': 0.86018234, 'binary_recall': 0.4205052, 'binary_specificity': 0.9974539, 'binary_f1_score': 0.56487024}
confusion matrix:
       0    1
0  18021   46
1    390  283
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584273, 'precision': 0.76097536, 'recall': 0.51671904, 'specificity': 0.51671904, 'f1': 0.5219792, 'auroc': 0.9433187, 'binary_precision': 0.5625, 'binary_recall': 0.034615386, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.0652174}
confusion matrix:
      0  1
0  5939  7
1   251  9
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863196.png
early stop counter: 2
val acc:0.9767342805862427, best validation acc: 0.9802027940750122, corresponding to test acc:                         0.9603609442710876 / 0.9743796586990356
after epoch: 10,now: 2024-05-27 00:55:37.998843,epoch time: 0:18:18.223941,used: 3:03:04.404297,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_21_52_33_seed_1_20863196
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98118156, 'precision': 0.8349388, 'recall': 0.9041892, 'specificity': 0.9041892, 'f1': 0.8660095, 'auroc': 0.9858359, 'binary_precision': 0.675984, 'binary_recall': 0.8217753, 'binary_specificity': 0.98660314, 'binary_f1_score': 0.74178404}
confusion matrix:
       0     1
0  41830   568
1    257  1185
---- Validation: 
scalar performance:
{'acc': 0.9819637, 'precision': 0.8648633, 'recall': 0.8804948, 'specificity': 0.8804948, 'f1': 0.87249935, 'auroc': 0.97846055, 'binary_precision': 0.73826456, 'binary_recall': 0.77117383, 'binary_specificity': 0.9898157, 'binary_f1_score': 0.7543605}
confusion matrix:
       0    1
0  17883  184
1    154  519
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96471155, 'precision': 0.85732543, 'recall': 0.61746484, 'specificity': 0.61746484, 'f1': 0.67168516, 'auroc': 0.9647225, 'binary_precision': 0.74698794, 'binary_recall': 0.23846154, 'binary_specificity': 0.9964682, 'binary_f1_score': 0.36151603}
confusion matrix:
      0   1
0  5925  21
1   198  62
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863196.png
better model found
persisted
after epoch: 11,now: 2024-05-27 01:13:57.313301,epoch time: 0:18:19.314458,used: 3:21:23.718755,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_21_52_33_seed_1_20863196
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.985333, 'precision': 0.9018361, 'recall': 0.85666597, 'specificity': 0.85666597, 'f1': 0.87779987, 'auroc': 0.988402, 'binary_precision': 0.8131868, 'binary_recall': 0.7189452, 'binary_specificity': 0.9943867, 'binary_f1_score': 0.76316756}
confusion matrix:
       0     1
0  42161   238
1    405  1036
---- Validation: 
scalar performance:
{'acc': 0.98329777, 'precision': 0.9240351, 'recall': 0.8168126, 'specificity': 0.8168126, 'f1': 0.86204326, 'auroc': 0.9791653, 'binary_precision': 0.8614458, 'binary_recall': 0.63744426, 'binary_specificity': 0.9961809, 'binary_f1_score': 0.732707}
confusion matrix:
       0    1
0  17998   69
1    244  429
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9643893, 'precision': 0.8309736, 'recall': 0.63200855, 'specificity': 0.63200855, 'f1': 0.6847365, 'auroc': 0.95634526, 'binary_precision': 0.6930693, 'binary_recall': 0.26923078, 'binary_specificity': 0.9947864, 'binary_f1_score': 0.38781166}
confusion matrix:
      0   1
0  5915  31
1   190  70
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863196.png
better model found
persisted
after epoch: 12,now: 2024-05-27 01:32:16.591721,epoch time: 0:18:19.278420,used: 3:39:42.997175,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_21_52_33_seed_1_20863196
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9851506, 'precision': 0.9272815, 'recall': 0.82238233, 'specificity': 0.82238233, 'f1': 0.8669599, 'auroc': 0.9861897, 'binary_precision': 0.8664193, 'binary_recall': 0.648161, 'binary_specificity': 0.99660367, 'binary_f1_score': 0.74156415}
confusion matrix:
       0    1
0  42255  144
1    507  934
---- Validation: 
scalar performance:
{'acc': 0.9819637, 'precision': 0.9485272, 'recall': 0.77391994, 'specificity': 0.77391994, 'f1': 0.8385856, 'auroc': 0.97648585, 'binary_precision': 0.91358024, 'binary_recall': 0.5497771, 'binary_specificity': 0.9980628, 'binary_f1_score': 0.68645644}
confusion matrix:
       0    1
0  18032   35
1    303  370
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96036094, 'precision': 0.8895243, 'recall': 0.53427905, 'specificity': 0.53427905, 'f1': 0.55368966, 'auroc': 0.9477147, 'binary_precision': 0.8181818, 'binary_recall': 0.06923077, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.12765957}
confusion matrix:
      0   1
0  5942   4
1   242  18
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863196.png
early stop counter: 1
val acc:0.9819636940956116, best validation acc: 0.9832977652549744, corresponding to test acc:                         0.9643893241882324 / 0.9743796586990356
after epoch: 13,now: 2024-05-27 01:50:33.471964,epoch time: 0:18:16.880243,used: 3:57:59.877418,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_21_52_33_seed_1_20863196
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98334855, 'precision': 0.94336283, 'recall': 0.7758651, 'specificity': 0.7758651, 'f1': 0.838802, 'auroc': 0.98958504, 'binary_precision': 0.9016949, 'binary_recall': 0.5537821, 'binary_specificity': 0.99794805, 'binary_f1_score': 0.6861565}
confusion matrix:
       0    1
0  42312   87
1    643  798
---- Validation: 
scalar performance:
{'acc': 0.97908217, 'precision': 0.9548117, 'recall': 0.7252179, 'specificity': 0.7252179, 'f1': 0.79862714, 'auroc': 0.9799906, 'binary_precision': 0.9296636, 'binary_recall': 0.45170876, 'binary_specificity': 0.99872696, 'binary_f1_score': 0.608}
confusion matrix:
       0    1
0  18044   23
1    369  304
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582662, 'precision': 0.81253695, 'recall': 0.50376207, 'specificity': 0.50376207, 'f1': 0.49694523, 'auroc': 0.95017195, 'binary_precision': 0.6666667, 'binary_recall': 0.0076923077, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.015209124}
confusion matrix:
      0  1
0  5945  1
1   258  2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863196.png
early stop counter: 2
val acc:0.9790821671485901, best validation acc: 0.9832977652549744, corresponding to test acc:                         0.9643893241882324 / 0.9743796586990356
after epoch: 14,now: 2024-05-27 02:08:50.279705,epoch time: 0:18:16.807741,used: 4:16:16.685159,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_21_52_33_seed_1_20863196
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9845347, 'precision': 0.8770148, 'recall': 0.88105714, 'specificity': 0.88105714, 'f1': 0.87902427, 'auroc': 0.9882765, 'binary_precision': 0.7618394, 'binary_recall': 0.7702984, 'binary_specificity': 0.99181587, 'binary_f1_score': 0.7660455}
confusion matrix:
       0     1
0  42052   347
1    331  1110
---- Validation: 
scalar performance:
{'acc': 0.9789755, 'precision': 0.85856736, 'recall': 0.82458466, 'specificity': 0.82458466, 'f1': 0.84065175, 'auroc': 0.978131, 'binary_precision': 0.72981876, 'binary_recall': 0.65824664, 'binary_specificity': 0.9909227, 'binary_f1_score': 0.6921875}
confusion matrix:
       0    1
0  17903  164
1    230  443
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9574605, 'precision': 0.7185713, 'recall': 0.5658672, 'specificity': 0.5658672, 'f1': 0.5962121, 'auroc': 0.95165825, 'binary_precision': 0.47368422, 'binary_recall': 0.13846155, 'binary_specificity': 0.9932728, 'binary_f1_score': 0.21428573}
confusion matrix:
      0   1
0  5906  40
1   224  36
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863196.png
early stop counter: 3
val acc:0.9789754748344421, best validation acc: 0.9832977652549744, corresponding to test acc:                         0.9643893241882324 / 0.9743796586990356
after epoch: 15,now: 2024-05-27 02:27:07.716098,epoch time: 0:18:17.436393,used: 4:34:34.121552,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_21_52_33_seed_1_20863196
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9870438, 'precision': 0.90074, 'recall': 0.8937508, 'specificity': 0.8937508, 'f1': 0.89721215, 'auroc': 0.99114925, 'binary_precision': 0.80848056, 'binary_recall': 0.79389316, 'binary_specificity': 0.99360836, 'binary_f1_score': 0.80112046}
confusion matrix:
       0     1
0  42128   271
1    297  1144
---- Validation: 
scalar performance:
{'acc': 0.98191035, 'precision': 0.8913914, 'recall': 0.83111364, 'specificity': 0.83111364, 'f1': 0.85851914, 'auroc': 0.9810757, 'binary_precision': 0.795053, 'binary_recall': 0.6686478, 'binary_specificity': 0.99357945, 'binary_f1_score': 0.7263923}
confusion matrix:
       0    1
0  17951  116
1    223  450
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96052206, 'precision': 0.7824662, 'recall': 0.5840157, 'specificity': 0.5840157, 'f1': 0.6241851, 'auroc': 0.9447517, 'binary_precision': 0.6, 'binary_recall': 0.17307693, 'binary_specificity': 0.9949546, 'binary_f1_score': 0.26865673}
confusion matrix:
      0   1
0  5916  30
1   215  45
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863196.png
early stop counter: 4
val acc:0.9819103479385376, best validation acc: 0.9832977652549744, corresponding to test acc:                         0.9643893241882324 / 0.9743796586990356
after epoch: 16,now: 2024-05-27 02:45:30.509529,epoch time: 0:18:22.793431,used: 4:52:56.914983,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_21_52_33_seed_1_20863196
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9853102, 'precision': 0.90642, 'recall': 0.8500526, 'specificity': 0.8500526, 'f1': 0.87597287, 'auroc': 0.9895326, 'binary_precision': 0.82281554, 'binary_recall': 0.70527047, 'binary_specificity': 0.99483466, 'binary_f1_score': 0.759522}
confusion matrix:
       0     1
0  42179   219
1    425  1017
---- Validation: 
scalar performance:
{'acc': 0.98164356, 'precision': 0.91230196, 'recall': 0.80021876, 'specificity': 0.80021876, 'f1': 0.8467326, 'auroc': 0.9803485, 'binary_precision': 0.8391753, 'binary_recall': 0.6047548, 'binary_specificity': 0.9956827, 'binary_f1_score': 0.70293605}
confusion matrix:
       0    1
0  17989   78
1    266  407
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96003866, 'precision': 0.8142085, 'recall': 0.5451448, 'specificity': 0.5451448, 'f1': 0.5708467, 'auroc': 0.9540077, 'binary_precision': 0.6666667, 'binary_recall': 0.092307694, 'binary_specificity': 0.99798185, 'binary_f1_score': 0.16216217}
confusion matrix:
      0   1
0  5934  12
1   236  24
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863196.png
early stop counter: 5
val acc:0.981643557548523, best validation acc: 0.9832977652549744, corresponding to test acc:                         0.9643893241882324 / 0.9743796586990356
after epoch: 17,now: 2024-05-27 03:03:28.940596,epoch time: 0:17:58.431067,used: 5:10:55.346050,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_21_52_33_seed_1_20863196
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9841469, 'precision': 0.9546227, 'recall': 0.7813057, 'specificity': 0.7813057, 'f1': 0.84620905, 'auroc': 0.9888756, 'binary_precision': 0.92386365, 'binary_recall': 0.5641915, 'binary_specificity': 0.99841976, 'binary_f1_score': 0.7005601}
confusion matrix:
       0    1
0  42332   67
1    628  813
---- Validation: 
scalar performance:
{'acc': 0.9780683, 'precision': 0.93143785, 'recall': 0.72326154, 'specificity': 0.72326154, 'f1': 0.79190135, 'auroc': 0.97668797, 'binary_precision': 0.88304096, 'binary_recall': 0.448737, 'binary_specificity': 0.99778605, 'binary_f1_score': 0.5950739}
confusion matrix:
       0    1
0  18027   40
1    371  302
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96019983, 'precision': 0.87173456, 'recall': 0.53419495, 'specificity': 0.53419495, 'f1': 0.55342203, 'auroc': 0.94835174, 'binary_precision': 0.7826087, 'binary_recall': 0.06923077, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.12720849}
confusion matrix:
      0   1
0  5941   5
1   242  18
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863196.png
early stop counter: 6
val acc:0.9780682921409607, best validation acc: 0.9832977652549744, corresponding to test acc:                         0.9643893241882324 / 0.9743796586990356
after epoch: 18,now: 2024-05-27 03:21:22.763300,epoch time: 0:17:53.822704,used: 5:28:49.168754,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_21_52_33_seed_1_20863196
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.98736316, 'precision': 0.9363814, 'recall': 0.8532573, 'specificity': 0.8532573, 'f1': 0.89012384, 'auroc': 0.9901906, 'binary_precision': 0.88255614, 'binary_recall': 0.7097222, 'binary_specificity': 0.99679244, 'binary_f1_score': 0.7867591}
confusion matrix:
       0     1
0  42264   136
1    418  1022
---- Validation: 
scalar performance:
{'acc': 0.97956246, 'precision': 0.90214145, 'recall': 0.7733898, 'specificity': 0.7733898, 'f1': 0.8245102, 'auroc': 0.98085845, 'binary_precision': 0.8207965, 'binary_recall': 0.551263, 'binary_specificity': 0.9955167, 'binary_f1_score': 0.65955555}
confusion matrix:
       0    1
0  17986   81
1    302  371
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95939416, 'precision': 0.7834195, 'recall': 0.5429694, 'specificity': 0.5429694, 'f1': 0.56678003, 'auroc': 0.9506285, 'binary_precision': 0.6052632, 'binary_recall': 0.08846154, 'binary_specificity': 0.9974773, 'binary_f1_score': 0.15436243}
confusion matrix:
      0   1
0  5931  15
1   237  23
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863196.png
early stop counter: 7
val acc:0.9795624613761902, best validation acc: 0.9832977652549744, corresponding to test acc:                         0.9643893241882324 / 0.9743796586990356
after epoch: 19,now: 2024-05-27 03:39:19.024933,epoch time: 0:17:56.261633,used: 5:46:45.430387,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_21_52_33_seed_1_20863196
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9850821, 'precision': 0.91077095, 'recall': 0.8398862, 'specificity': 0.8398862, 'f1': 0.87172604, 'auroc': 0.9864727, 'binary_precision': 0.8322091, 'binary_recall': 0.684466, 'binary_specificity': 0.9953064, 'binary_f1_score': 0.7511415}
confusion matrix:
       0    1
0  42199  199
1    455  987
---- Validation: 
scalar performance:
{'acc': 0.98041624, 'precision': 0.909778, 'recall': 0.7809853, 'specificity': 0.7809853, 'f1': 0.8324188, 'auroc': 0.96962225, 'binary_precision': 0.8355263, 'binary_recall': 0.5661218, 'binary_specificity': 0.9958488, 'binary_f1_score': 0.67493355}
confusion matrix:
       0    1
0  17992   75
1    292  381
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96036094, 'precision': 0.8281784, 'recall': 0.5471519, 'specificity': 0.5471519, 'f1': 0.57430756, 'auroc': 0.931979, 'binary_precision': 0.6944444, 'binary_recall': 0.09615385, 'binary_specificity': 0.99815, 'binary_f1_score': 0.16891892}
confusion matrix:
      0   1
0  5935  11
1   235  25
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863196.png
early stop counter: 8
val acc:0.9804162383079529, best validation acc: 0.9832977652549744, corresponding to test acc:                         0.9643893241882324 / 0.9743796586990356
after epoch: 20,now: 2024-05-27 03:57:35.369333,epoch time: 0:18:16.344400,used: 6:05:01.774787,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_21_52_33_seed_1_20863196
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9859717, 'precision': 0.87810963, 'recall': 0.9126948, 'specificity': 0.9126948, 'f1': 0.8945803, 'auroc': 0.99149585, 'binary_precision': 0.7618746, 'binary_recall': 0.83425796, 'binary_specificity': 0.99113166, 'binary_f1_score': 0.79642504}
confusion matrix:
       0     1
0  42022   376
1    239  1203
---- Validation: 
scalar performance:
{'acc': 0.9819637, 'precision': 0.86549056, 'recall': 0.8790642, 'specificity': 0.8790642, 'f1': 0.8721417, 'auroc': 0.979236, 'binary_precision': 0.739628, 'binary_recall': 0.76820207, 'binary_specificity': 0.9899264, 'binary_f1_score': 0.7536443}
confusion matrix:
       0    1
0  17885  182
1    156  517
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621334, 'precision': 0.8382, 'recall': 0.5793397, 'specificity': 0.5793397, 'f1': 0.6219451, 'auroc': 0.9433987, 'binary_precision': 0.7118644, 'binary_recall': 0.16153847, 'binary_specificity': 0.99714094, 'binary_f1_score': 0.2633229}
confusion matrix:
      0   1
0  5929  17
1   218  42
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863196.png
early stop counter: 9
val acc:0.9819636940956116, best validation acc: 0.9832977652549744, corresponding to test acc:                         0.9643893241882324 / 0.9743796586990356
after epoch: 21,now: 2024-05-27 04:15:59.475255,epoch time: 0:18:24.105922,used: 6:23:25.880709,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_21_52_33_seed_1_20863196
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.98768246, 'precision': 0.9266593, 'recall': 0.87037104, 'specificity': 0.87037104, 'f1': 0.89637685, 'auroc': 0.9916703, 'binary_precision': 0.86195827, 'binary_recall': 0.7447989, 'binary_specificity': 0.9959432, 'binary_f1_score': 0.7991072}
confusion matrix:
       0     1
0  42226   172
1    368  1074
---- Validation: 
scalar performance:
{'acc': 0.98180366, 'precision': 0.9177147, 'recall': 0.79744077, 'specificity': 0.79744077, 'f1': 0.8466587, 'auroc': 0.97974545, 'binary_precision': 0.85021096, 'binary_recall': 0.59881127, 'binary_specificity': 0.9960702, 'binary_f1_score': 0.7027027}
confusion matrix:
       0    1
0  17996   71
1    270  403
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95939416, 'precision': 0.7671777, 'recall': 0.5595203, 'specificity': 0.5595203, 'f1': 0.5908492, 'auroc': 0.9429924, 'binary_precision': 0.5714286, 'binary_recall': 0.12307692, 'binary_specificity': 0.9959637, 'binary_f1_score': 0.20253165}
confusion matrix:
      0   1
0  5922  24
1   228  32
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863196.png
early stop counter: 10
val acc:0.9818036556243896, best validation acc: 0.9832977652549744, corresponding to test acc:                         0.9643893241882324 / 0.9743796586990356
after epoch: 22,now: 2024-05-27 04:34:18.322881,epoch time: 0:18:18.847626,used: 6:41:44.728335,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_21_52_33_seed_1_20863196
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9866104, 'precision': 0.9046058, 'recall': 0.87877834, 'specificity': 0.87877834, 'f1': 0.8912323, 'auroc': 0.9912855, 'binary_precision': 0.81723624, 'binary_recall': 0.7633588, 'binary_specificity': 0.99419796, 'binary_f1_score': 0.78937924}
confusion matrix:
       0     1
0  42153   246
1    341  1100
---- Validation: 
scalar performance:
{'acc': 0.98164356, 'precision': 0.89083993, 'recall': 0.82668364, 'specificity': 0.82668364, 'f1': 0.85564446, 'auroc': 0.97706866, 'binary_precision': 0.79427546, 'binary_recall': 0.6597325, 'binary_specificity': 0.9936348, 'binary_f1_score': 0.7207792}
confusion matrix:
       0    1
0  17952  115
1    229  444
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9585885, 'precision': 0.7417928, 'recall': 0.57381177, 'specificity': 0.57381177, 'f1': 0.6080525, 'auroc': 0.9365019, 'binary_precision': 0.5194805, 'binary_recall': 0.15384616, 'binary_specificity': 0.99377733, 'binary_f1_score': 0.23738873}
confusion matrix:
      0   1
0  5909  37
1   220  40
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863196.png
early stop counter: 11
val acc:0.981643557548523, best validation acc: 0.9832977652549744, corresponding to test acc:                         0.9643893241882324 / 0.9743796586990356
after epoch: 23,now: 2024-05-27 04:52:37.690735,epoch time: 0:18:19.367854,used: 7:00:04.096189,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_21_52_33_seed_1_20863196
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.98640513, 'precision': 0.9667481, 'recall': 0.8104249, 'specificity': 0.8104249, 'f1': 0.87181985, 'auroc': 0.991642, 'binary_precision': 0.9462025, 'binary_recall': 0.6220527, 'binary_specificity': 0.9987971, 'binary_f1_score': 0.7506277}
confusion matrix:
       0    1
0  42347   51
1    545  897
---- Validation: 
scalar performance:
{'acc': 0.98041624, 'precision': 0.9402844, 'recall': 0.7552357, 'specificity': 0.7552357, 'f1': 0.82135737, 'auroc': 0.973688, 'binary_precision': 0.8984375, 'binary_recall': 0.51263, 'binary_specificity': 0.99784136, 'binary_f1_score': 0.6527909}
confusion matrix:
       0    1
0  18028   39
1    328  345
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.7294222, 'recall': 0.5091949, 'specificity': 0.5091949, 'f1': 0.5078119, 'auroc': 0.9280931, 'binary_precision': 0.5, 'binary_recall': 0.01923077, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.037037037}
confusion matrix:
      0  1
0  5941  5
1   255  5
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863196.png
early stop counter: 12
val acc:0.9804162383079529, best validation acc: 0.9832977652549744, corresponding to test acc:                         0.9643893241882324 / 0.9743796586990356
after epoch: 24,now: 2024-05-27 05:10:53.333198,epoch time: 0:18:15.642463,used: 7:18:19.738652,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_21_52_33_seed_1_20863196
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9894389, 'precision': 0.9301945, 'recall': 0.89867604, 'specificity': 0.89867604, 'f1': 0.91378987, 'auroc': 0.99389905, 'binary_precision': 0.8671171, 'binary_recall': 0.8015267, 'binary_specificity': 0.99582535, 'binary_f1_score': 0.8330328}
confusion matrix:
       0     1
0  42222   177
1    286  1155
---- Validation: 
scalar performance:
{'acc': 0.9861793, 'precision': 0.93293166, 'recall': 0.8562162, 'specificity': 0.8562162, 'f1': 0.8905411, 'auroc': 0.9801482, 'binary_precision': 0.87636364, 'binary_recall': 0.7161961, 'binary_specificity': 0.9962362, 'binary_f1_score': 0.78822565}
confusion matrix:
       0    1
0  17999   68
1    191  482
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621334, 'precision': 0.8457531, 'recall': 0.5756617, 'specificity': 0.5756617, 'f1': 0.617271, 'auroc': 0.9330864, 'binary_precision': 0.72727275, 'binary_recall': 0.15384616, 'binary_specificity': 0.9974773, 'binary_f1_score': 0.25396827}
confusion matrix:
      0   1
0  5931  15
1   220  40
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863196.png
better model found
persisted
after epoch: 25,now: 2024-05-27 05:29:13.996652,epoch time: 0:18:20.663454,used: 7:36:40.402106,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_21_52_33_seed_1_20863196
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9882755, 'precision': 0.911544, 'recall': 0.90216273, 'specificity': 0.90216273, 'f1': 0.90679497, 'auroc': 0.9920331, 'binary_precision': 0.82954544, 'binary_recall': 0.8099861, 'binary_specificity': 0.99433935, 'binary_f1_score': 0.8196491}
confusion matrix:
       0     1
0  42158   240
1    274  1168
---- Validation: 
scalar performance:
{'acc': 0.9836713, 'precision': 0.89280605, 'recall': 0.8634987, 'specificity': 0.8634987, 'f1': 0.8775338, 'auroc': 0.9713978, 'binary_precision': 0.79549116, 'binary_recall': 0.73402673, 'binary_specificity': 0.9929706, 'binary_f1_score': 0.76352394}
confusion matrix:
       0    1
0  17940  127
1    179  494
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590719, 'precision': 0.75144356, 'recall': 0.577742, 'specificity': 0.577742, 'f1': 0.6137419, 'auroc': 0.9424144, 'binary_precision': 0.53846157, 'binary_recall': 0.16153847, 'binary_specificity': 0.99394554, 'binary_f1_score': 0.24852072}
confusion matrix:
      0   1
0  5910  36
1   218  42
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863196.png
early stop counter: 1
val acc:0.9836713075637817, best validation acc: 0.9861792922019958, corresponding to test acc:                         0.9621334075927734 / 0.9743796586990356
after epoch: 26,now: 2024-05-27 05:47:36.296519,epoch time: 0:18:22.299867,used: 7:55:02.701973,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_21_52_33_seed_1_20863196
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9890283, 'precision': 0.91080904, 'recall': 0.91823995, 'specificity': 0.91823995, 'f1': 0.9144885, 'auroc': 0.9931439, 'binary_precision': 0.82697546, 'binary_recall': 0.8424705, 'binary_specificity': 0.9940093, 'binary_f1_score': 0.8346511}
confusion matrix:
       0     1
0  42145   254
1    227  1214
---- Validation: 
scalar performance:
{'acc': 0.98441833, 'precision': 0.9044769, 'recall': 0.8603098, 'specificity': 0.8603098, 'f1': 0.8810073, 'auroc': 0.97999823, 'binary_precision': 0.8190955, 'binary_recall': 0.7265973, 'binary_specificity': 0.99402225, 'binary_f1_score': 0.7700787}
confusion matrix:
       0    1
0  17959  108
1    184  489
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582662, 'precision': 0.73532444, 'recall': 0.5626096, 'specificity': 0.5626096, 'f1': 0.5932598, 'auroc': 0.9502783, 'binary_precision': 0.5074627, 'binary_recall': 0.13076924, 'binary_specificity': 0.99445003, 'binary_f1_score': 0.20795108}
confusion matrix:
      0   1
0  5913  33
1   226  34
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863196.png
early stop counter: 2
val acc:0.9844183325767517, best validation acc: 0.9861792922019958, corresponding to test acc:                         0.9621334075927734 / 0.9743796586990356
after epoch: 27,now: 2024-05-27 06:05:54.583187,epoch time: 0:18:18.286668,used: 8:13:20.988641,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_21_52_33_seed_1_20863196
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9886177, 'precision': 0.9349803, 'recall': 0.87788844, 'specificity': 0.87788844, 'f1': 0.90427893, 'auroc': 0.99379456, 'binary_precision': 0.8781074, 'binary_recall': 0.759362, 'binary_specificity': 0.9964149, 'binary_f1_score': 0.8144291}
confusion matrix:
       0     1
0  42246   152
1    347  1095
---- Validation: 
scalar performance:
{'acc': 0.98553896, 'precision': 0.9433727, 'recall': 0.8351413, 'specificity': 0.8351413, 'f1': 0.88114434, 'auroc': 0.9783149, 'binary_precision': 0.89880955, 'binary_recall': 0.6731055, 'binary_specificity': 0.9971772, 'binary_f1_score': 0.76975363}
confusion matrix:
       0    1
0  18016   51
1    220  453
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959233, 'precision': 0.83290565, 'recall': 0.5226565, 'specificity': 0.5226565, 'f1': 0.5328969, 'auroc': 0.9555205, 'binary_precision': 0.7058824, 'binary_recall': 0.046153847, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.0866426}
confusion matrix:
      0   1
0  5941   5
1   248  12
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863196.png
early stop counter: 3
val acc:0.9855389595031738, best validation acc: 0.9861792922019958, corresponding to test acc:                         0.9621334075927734 / 0.9743796586990356
after epoch: 28,now: 2024-05-27 06:24:14.110706,epoch time: 0:18:19.527519,used: 8:31:40.516160,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_21_52_33_seed_1_20863196
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99026006, 'precision': 0.91192377, 'recall': 0.94137275, 'specificity': 0.94137275, 'f1': 0.9260982, 'auroc': 0.99495345, 'binary_precision': 0.82763076, 'binary_recall': 0.889043, 'binary_specificity': 0.99370253, 'binary_f1_score': 0.8572384}
confusion matrix:
       0     1
0  42131   267
1    160  1282
---- Validation: 
scalar performance:
{'acc': 0.9854322, 'precision': 0.906301, 'recall': 0.8765715, 'specificity': 0.8765715, 'f1': 0.8908223, 'auroc': 0.98081625, 'binary_precision': 0.8215434, 'binary_recall': 0.75928676, 'binary_specificity': 0.9938562, 'binary_f1_score': 0.7891892}
confusion matrix:
       0    1
0  17956  111
1    162  511
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96100545, 'precision': 0.78118384, 'recall': 0.6044969, 'specificity': 0.6044969, 'f1': 0.64815724, 'auroc': 0.949075, 'binary_precision': 0.59574467, 'binary_recall': 0.21538462, 'binary_specificity': 0.99360913, 'binary_f1_score': 0.3163842}
confusion matrix:
      0   1
0  5908  38
1   204  56
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863196.png
early stop counter: 4
val acc:0.9854322075843811, best validation acc: 0.9861792922019958, corresponding to test acc:                         0.9621334075927734 / 0.9743796586990356
after epoch: 29,now: 2024-05-27 06:42:17.251382,epoch time: 0:18:03.140676,used: 8:49:43.656836,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_21_52_33_seed_1_20863196
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99026006, 'precision': 0.9266533, 'recall': 0.91893125, 'specificity': 0.91893125, 'f1': 0.9227543, 'auroc': 0.9953433, 'binary_precision': 0.85865724, 'binary_recall': 0.8425797, 'binary_specificity': 0.99528277, 'binary_f1_score': 0.85054255}
confusion matrix:
       0     1
0  42198   200
1    227  1215
---- Validation: 
scalar performance:
{'acc': 0.9846318, 'precision': 0.914333, 'recall': 0.851122, 'specificity': 0.851122, 'f1': 0.8798974, 'auroc': 0.9818505, 'binary_precision': 0.83950615, 'binary_recall': 0.7072808, 'binary_specificity': 0.99496317, 'binary_f1_score': 0.76774186}
confusion matrix:
       0    1
0  17976   91
1    197  476
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95955527, 'precision': 0.7602267, 'recall': 0.58351123, 'specificity': 0.58351123, 'f1': 0.621568, 'auroc': 0.93476605, 'binary_precision': 0.5555556, 'binary_recall': 0.17307693, 'binary_specificity': 0.99394554, 'binary_f1_score': 0.26392964}
confusion matrix:
      0   1
0  5910  36
1   215  45
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863196.png
early stop counter: 5
val acc:0.9846317768096924, best validation acc: 0.9861792922019958, corresponding to test acc:                         0.9621334075927734 / 0.9743796586990356
after epoch: 30,now: 2024-05-27 07:00:13.705434,epoch time: 0:17:56.454052,used: 9:07:40.110888,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_21_52_33_seed_1_20863196
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 9:07:40.110888 at 2024-05-27 07:00:13.705434
persisted model performance metric: 

scalar performance:
{'acc': 0.96165, 'precision': 0.8338089, 'recall': 0.57173145, 'specificity': 0.57173145, 'f1': 0.61118275, 'auroc': 0.93215716, 'binary_precision': 0.7037037, 'binary_recall': 0.14615385, 'binary_specificity': 0.9973091, 'binary_f1_score': 0.24203822}
confusion matrix:
      0   1
0  5930  16
1   222  38
oracle model performance metric: 

scalar performance:
{'acc': 0.9761521, 'precision': 0.9362167, 'recall': 0.7429694, 'specificity': 0.7429694, 'f1': 0.80975884, 'auroc': 0.94238025, 'binary_precision': 0.8943662, 'binary_recall': 0.48846152, 'binary_specificity': 0.9974773, 'binary_f1_score': 0.63184077}
confusion matrix:
      0    1
0  5931   15
1   133  127
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs32/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs32/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 453690 KiB |  26075 MiB |   2220 TiB |   2220 TiB |
|       from large pool | 412597 KiB |  26030 MiB |   2207 TiB |   2207 TiB |
|       from small pool |  41093 KiB |     57 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 453690 KiB |  26075 MiB |   2220 TiB |   2220 TiB |
|       from large pool | 412597 KiB |  26030 MiB |   2207 TiB |   2207 TiB |
|       from small pool |  41093 KiB |     57 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447751 KiB |  26071 MiB |   2220 TiB |   2220 TiB |
|       from large pool | 407075 KiB |  26026 MiB |   2206 TiB |   2206 TiB |
|       from small pool |  40676 KiB |     56 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  27792 MiB |  27792 MiB |  54386 MiB |  26594 MiB |
|       from large pool |  27724 MiB |  27724 MiB |  54306 MiB |  26582 MiB |
|       from small pool |     68 MiB |     68 MiB |     80 MiB |     12 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 738245 KiB |   1739 MiB |   1006 TiB |   1006 TiB |
|       from large pool | 721995 KiB |   1737 MiB |    992 TiB |    992 TiB |
|       from small pool |  16250 KiB |     35 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    2300    |    3745    |  197784 K  |  197781 K  |
|       from large pool |     187    |    1413    |  102766 K  |  102766 K  |
|       from small pool |    2113    |    3556    |   95017 K  |   95015 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2300    |    3745    |  197784 K  |  197781 K  |
|       from large pool |     187    |    1413    |  102766 K  |  102766 K  |
|       from small pool |    2113    |    3556    |   95017 K  |   95015 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     837    |     837    |    1606    |     769    |
|       from large pool |     803    |     803    |    1566    |     763    |
|       from small pool |      34    |      34    |      40    |       6    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      93    |    1451    |  139764 K  |  139764 K  |
|       from large pool |      40    |     806    |   90590 K  |   90590 K  |
|       from small pool |      53    |    1411    |   49173 K  |   49173 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  26075 MiB |   2220 TiB |   2220 TiB |
|       from large pool |  16640 KiB |  26030 MiB |   2207 TiB |   2207 TiB |
|       from small pool |      0 KiB |     57 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  26075 MiB |   2220 TiB |   2220 TiB |
|       from large pool |  16640 KiB |  26030 MiB |   2207 TiB |   2207 TiB |
|       from small pool |      0 KiB |     57 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  26071 MiB |   2220 TiB |   2220 TiB |
|       from large pool |  16640 KiB |  26026 MiB |   2206 TiB |   2206 TiB |
|       from small pool |      0 KiB |     56 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1164 MiB |  27792 MiB |  54386 MiB |  53222 MiB |
|       from large pool |   1108 MiB |  27724 MiB |  54306 MiB |  53198 MiB |
|       from small pool |     56 MiB |     68 MiB |     80 MiB |     24 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   3840 KiB |   1739 MiB |   1006 TiB |   1006 TiB |
|       from large pool |   3840 KiB |   1737 MiB |    992 TiB |    992 TiB |
|       from small pool |      0 KiB |     39 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3745    |  197784 K  |  197784 K  |
|       from large pool |       2    |    1413    |  102766 K  |  102766 K  |
|       from small pool |       0    |    3556    |   95017 K  |   95017 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3745    |  197784 K  |  197784 K  |
|       from large pool |       2    |    1413    |  102766 K  |  102766 K  |
|       from small pool |       0    |    3556    |   95017 K  |   95017 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      69    |     837    |    1606    |    1537    |
|       from large pool |      41    |     803    |    1566    |    1525    |
|       from small pool |      28    |      34    |      40    |      12    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |    1451    |  139764 K  |  139764 K  |
|       from large pool |       1    |     806    |   90590 K  |   90590 K  |
|       from small pool |       0    |    1411    |   49173 K  |   49173 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Mon May 27 07:02:05 2024]
Finished job 0.
1 of 1 steps (100%) done
