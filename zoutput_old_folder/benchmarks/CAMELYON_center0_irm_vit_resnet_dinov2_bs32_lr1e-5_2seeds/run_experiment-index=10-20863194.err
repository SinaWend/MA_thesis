Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sun May 26 12:25:43 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs32/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs32/rule_results/10.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=10
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_36_37_seed_0_20863194

 Experiment start at: 2024-05-26 12:36:37.493216
before training, model accuracy: 0.2401725947856903
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9664885, 'precision': 0.8166187, 'recall': 0.50267196, 'specificity': 0.50267196, 'f1': 0.49687222, 'auroc': 0.88636696, 'binary_precision': 0.6666667, 'binary_recall': 0.0054384773, 'binary_specificity': 0.99990547, 'binary_f1_score': 0.010788941}
confusion matrix:
       0  1
0  42301  4
1   1463  8
---- Validation: 
scalar performance:
{'acc': 0.96588975, 'precision': 0.85796785, 'recall': 0.50230527, 'specificity': 0.50230527, 'f1': 0.49595985, 'auroc': 0.8760071, 'binary_precision': 0.75, 'binary_recall': 0.00466563, 'binary_specificity': 0.9999449, 'binary_f1_score': 0.009273571}
confusion matrix:
       0  1
0  18148  1
1    640  3
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.8366661, 'recall': 0.5094118, 'specificity': 0.5094118, 'f1': 0.50812435, 'auroc': 0.8786322, 'binary_precision': 0.71428573, 'binary_recall': 0.019157087, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.037313428}
confusion matrix:
      0  1
0  5995  2
1   256  5
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863194.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-26 12:55:37.194546,epoch time: 0:18:59.701330,used: 0:18:59.701330,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_36_37_seed_0_20863194
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9662601, 'precision': 0.7327441, 'recall': 0.5720689, 'specificity': 0.5720689, 'f1': 0.6061388, 'auroc': 0.91020554, 'binary_precision': 0.49438202, 'binary_recall': 0.14945652, 'binary_specificity': 0.99468136, 'binary_f1_score': 0.2295253}
confusion matrix:
       0    1
0  42079  225
1   1252  220
---- Validation: 
scalar performance:
{'acc': 0.9655172, 'precision': 0.73073125, 'recall': 0.58911884, 'specificity': 0.58911884, 'f1': 0.6254827, 'auroc': 0.9056707, 'binary_precision': 0.48971194, 'binary_recall': 0.18506998, 'binary_specificity': 0.99316764, 'binary_f1_score': 0.26862302}
confusion matrix:
       0    1
0  18025  124
1    524  119
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9704378, 'precision': 0.89010227, 'recall': 0.6895699, 'specificity': 0.6895699, 'f1': 0.75211513, 'auroc': 0.8999099, 'binary_precision': 0.8064516, 'binary_recall': 0.38314176, 'binary_specificity': 0.995998, 'binary_f1_score': 0.5194805}
confusion matrix:
      0    1
0  5973   24
1   161  100
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863194.png
new oracle model saved
early stop counter: 1
val acc:0.9655172228813171, best validation acc: 0.9658897519111633, corresponding to test acc:                         0.9587727785110474 / 0.9704378247261047
after epoch: 2,now: 2024-05-26 13:12:02.112451,epoch time: 0:16:24.917905,used: 0:35:24.619235,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_36_37_seed_0_20863194
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9658032, 'precision': 0.72667396, 'recall': 0.60002804, 'specificity': 0.60002804, 'f1': 0.6363323, 'auroc': 0.92378753, 'binary_precision': 0.48037678, 'binary_recall': 0.20788044, 'binary_specificity': 0.9921757, 'binary_f1_score': 0.29018494}
confusion matrix:
       0    1
0  41973  331
1   1166  306
---- Validation: 
scalar performance:
{'acc': 0.96525115, 'precision': 0.73048806, 'recall': 0.63248426, 'specificity': 0.63248426, 'f1': 0.66684324, 'auroc': 0.9120369, 'binary_precision': 0.48626372, 'binary_recall': 0.27527216, 'binary_specificity': 0.9896964, 'binary_f1_score': 0.35153922}
confusion matrix:
       0    1
0  17962  187
1    466  177
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9744327, 'precision': 0.9105594, 'recall': 0.7356303, 'specificity': 0.7356303, 'f1': 0.7973144, 'auroc': 0.89837956, 'binary_precision': 0.8435374, 'binary_recall': 0.47509578, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.60784316}
confusion matrix:
      0    1
0  5974   23
1   137  124
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863194.png
new oracle model saved
early stop counter: 2
val acc:0.9652511477470398, best validation acc: 0.9658897519111633, corresponding to test acc:                         0.9587727785110474 / 0.9744327068328857
after epoch: 3,now: 2024-05-26 13:28:22.720518,epoch time: 0:16:20.608067,used: 0:51:45.227302,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_36_37_seed_0_20863194
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96781343, 'precision': 0.7531915, 'recall': 0.70348984, 'specificity': 0.70348984, 'f1': 0.7253511, 'auroc': 0.9296968, 'binary_precision': 0.52640545, 'binary_recall': 0.42012236, 'binary_specificity': 0.98685735, 'binary_f1_score': 0.46729678}
confusion matrix:
       0    1
0  41749  556
1    853  618
---- Validation: 
scalar performance:
{'acc': 0.96647507, 'precision': 0.7460413, 'recall': 0.7171241, 'specificity': 0.7171241, 'f1': 0.73057884, 'auroc': 0.92251956, 'binary_precision': 0.5115044, 'binary_recall': 0.44945568, 'binary_specificity': 0.98479253, 'binary_f1_score': 0.4784768}
confusion matrix:
       0    1
0  17873  276
1    354  289
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97746885, 'precision': 0.896064, 'recall': 0.79768145, 'specificity': 0.79768145, 'f1': 0.8392097, 'auroc': 0.9053079, 'binary_precision': 0.80927837, 'binary_recall': 0.6015326, 'binary_specificity': 0.99383026, 'binary_f1_score': 0.6901099}
confusion matrix:
      0    1
0  5960   37
1   104  157
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863194.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-05-26 13:44:40.332051,epoch time: 0:16:17.611533,used: 1:08:02.838835,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_36_37_seed_0_20863194
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96852154, 'precision': 0.75808525, 'recall': 0.74995273, 'specificity': 0.74995273, 'f1': 0.7539468, 'auroc': 0.9401077, 'binary_precision': 0.5330056, 'binary_recall': 0.515625, 'binary_specificity': 0.98428047, 'binary_f1_score': 0.52417123}
confusion matrix:
       0    1
0  41639  665
1    713  759
---- Validation: 
scalar performance:
{'acc': 0.9654108, 'precision': 0.73911893, 'recall': 0.755576, 'specificity': 0.755576, 'f1': 0.747041, 'auroc': 0.93037224, 'binary_precision': 0.49492016, 'binary_recall': 0.5303266, 'binary_specificity': 0.98082536, 'binary_f1_score': 0.512012}
confusion matrix:
       0    1
0  17801  348
1    302  341
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97730905, 'precision': 0.89108026, 'recall': 0.80126274, 'specificity': 0.80126274, 'f1': 0.83976305, 'auroc': 0.92863417, 'binary_precision': 0.79899496, 'binary_recall': 0.6091954, 'binary_specificity': 0.99333, 'binary_f1_score': 0.6913044}
confusion matrix:
      0    1
0  5957   40
1   102  159
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863194.png
early stop counter: 1
val acc:0.9654108285903931, best validation acc: 0.9664750695228577, corresponding to test acc:                         0.9774688482284546 / 0.9774688482284546
after epoch: 5,now: 2024-05-26 14:00:57.651936,epoch time: 0:16:17.319885,used: 1:24:20.158720,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_36_37_seed_0_20863194
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9679962, 'precision': 0.7537967, 'recall': 0.74295473, 'specificity': 0.74295473, 'f1': 0.7482444, 'auroc': 0.94098365, 'binary_precision': 0.52489334, 'binary_recall': 0.5016995, 'binary_specificity': 0.9842099, 'binary_f1_score': 0.51303446}
confusion matrix:
       0    1
0  41637  668
1    733  738
---- Validation: 
scalar performance:
{'acc': 0.96599615, 'precision': 0.74298334, 'recall': 0.75062865, 'specificity': 0.75062865, 'f1': 0.74673986, 'auroc': 0.93259144, 'binary_precision': 0.50301206, 'binary_recall': 0.5194401, 'binary_specificity': 0.9818172, 'binary_f1_score': 0.51109415}
confusion matrix:
       0    1
0  17819  330
1    309  334
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97762865, 'precision': 0.8855098, 'recall': 0.8142558, 'specificity': 0.8142558, 'f1': 0.8458829, 'auroc': 0.9308454, 'binary_precision': 0.7867299, 'binary_recall': 0.6360153, 'binary_specificity': 0.99249625, 'binary_f1_score': 0.70338976}
confusion matrix:
      0    1
0  5952   45
1    95  166
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863194.png
new oracle model saved
early stop counter: 2
val acc:0.9659961462020874, best validation acc: 0.9664750695228577, corresponding to test acc:                         0.9774688482284546 / 0.9776286482810974
after epoch: 6,now: 2024-05-26 14:17:15.257562,epoch time: 0:16:17.605626,used: 1:40:37.764346,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_36_37_seed_0_20863194
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96792763, 'precision': 0.7528732, 'recall': 0.7947568, 'specificity': 0.7947568, 'f1': 0.7720285, 'auroc': 0.9455923, 'binary_precision': 0.51942027, 'binary_recall': 0.60910946, 'binary_specificity': 0.9804042, 'binary_f1_score': 0.56070083}
confusion matrix:
       0    1
0  41476  829
1    575  896
---- Validation: 
scalar performance:
{'acc': 0.96525115, 'precision': 0.73973835, 'recall': 0.790746, 'specificity': 0.790746, 'f1': 0.762488, 'auroc': 0.9364774, 'binary_precision': 0.49363866, 'binary_recall': 0.60342145, 'binary_specificity': 0.97807044, 'binary_f1_score': 0.54303706}
confusion matrix:
       0    1
0  17751  398
1    255  388
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97666985, 'precision': 0.8691905, 'recall': 0.8229172, 'specificity': 0.8229172, 'f1': 0.8443407, 'auroc': 0.93131495, 'binary_precision': 0.75330395, 'binary_recall': 0.6551724, 'binary_specificity': 0.990662, 'binary_f1_score': 0.7008197}
confusion matrix:
      0    1
0  5941   56
1    90  171
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863194.png
early stop counter: 3
val acc:0.9652511477470398, best validation acc: 0.9664750695228577, corresponding to test acc:                         0.9774688482284546 / 0.9776286482810974
after epoch: 7,now: 2024-05-26 14:33:34.628316,epoch time: 0:16:19.370754,used: 1:56:57.135100,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_36_37_seed_0_20863194
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.96897846, 'precision': 0.76108, 'recall': 0.76723754, 'specificity': 0.76723754, 'f1': 0.764119, 'auroc': 0.9511078, 'binary_precision': 0.5377984, 'binary_recall': 0.55095106, 'binary_specificity': 0.983524, 'binary_f1_score': 0.5442953}
confusion matrix:
       0    1
0  41607  697
1    661  811
---- Validation: 
scalar performance:
{'acc': 0.96620905, 'precision': 0.7451741, 'recall': 0.77774084, 'specificity': 0.77774084, 'f1': 0.7603224, 'auroc': 0.94130147, 'binary_precision': 0.5054645, 'binary_recall': 0.5754277, 'binary_specificity': 0.980054, 'binary_f1_score': 0.53818184}
confusion matrix:
       0    1
0  17787  362
1    273  370
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97794825, 'precision': 0.8892766, 'recall': 0.8144225, 'specificity': 0.8144225, 'f1': 0.8474634, 'auroc': 0.9409039, 'binary_precision': 0.79425836, 'binary_recall': 0.6360153, 'binary_specificity': 0.99282974, 'binary_f1_score': 0.70638293}
confusion matrix:
      0    1
0  5954   43
1    95  166
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863194.png
new oracle model saved
early stop counter: 4
val acc:0.9662090539932251, best validation acc: 0.9664750695228577, corresponding to test acc:                         0.9774688482284546 / 0.9779482483863831
after epoch: 8,now: 2024-05-26 14:49:52.455226,epoch time: 0:16:17.826910,used: 2:13:14.962010,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_36_37_seed_0_20863194
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.96820176, 'precision': 0.755293, 'recall': 0.75863934, 'specificity': 0.75863934, 'f1': 0.7569541, 'auroc': 0.9484679, 'binary_precision': 0.52680963, 'binary_recall': 0.5339674, 'binary_specificity': 0.9833113, 'binary_f1_score': 0.53036433}
confusion matrix:
       0    1
0  41598  706
1    686  786
---- Validation: 
scalar performance:
{'acc': 0.96647507, 'precision': 0.74669147, 'recall': 0.7658777, 'specificity': 0.7658777, 'f1': 0.75588334, 'auroc': 0.94111687, 'binary_precision': 0.5093525, 'binary_recall': 0.5505443, 'binary_specificity': 0.98121107, 'binary_f1_score': 0.529148}
confusion matrix:
       0    1
0  17808  341
1    289  354
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9790668, 'precision': 0.9030476, 'recall': 0.81500614, 'specificity': 0.81500614, 'f1': 0.85309696, 'auroc': 0.9243667, 'binary_precision': 0.8217822, 'binary_recall': 0.6360153, 'binary_specificity': 0.993997, 'binary_f1_score': 0.7170626}
confusion matrix:
      0    1
0  5961   36
1    95  166
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863194.png
new oracle model saved
early stop counter: 5
val acc:0.9664750695228577, best validation acc: 0.9664750695228577, corresponding to test acc:                         0.9774688482284546 / 0.979066789150238
after epoch: 9,now: 2024-05-26 15:06:09.603974,epoch time: 0:16:17.148748,used: 2:29:32.110758,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_36_37_seed_0_20863194
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9667398, 'precision': 0.7461271, 'recall': 0.8239981, 'specificity': 0.8239981, 'f1': 0.779101, 'auroc': 0.95269287, 'binary_precision': 0.50382847, 'binary_recall': 0.6709721, 'binary_specificity': 0.977024, 'binary_f1_score': 0.57551014}
confusion matrix:
       0    1
0  41333  972
1    484  987
---- Validation: 
scalar performance:
{'acc': 0.9655172, 'precision': 0.7420623, 'recall': 0.808885, 'specificity': 0.808885, 'f1': 0.7709192, 'auroc': 0.94690984, 'binary_precision': 0.49698433, 'binary_recall': 0.6407465, 'binary_specificity': 0.97702354, 'binary_f1_score': 0.5597826}
confusion matrix:
       0    1
0  17732  417
1    231  412
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97363377, 'precision': 0.8360233, 'recall': 0.83232707, 'specificity': 0.83232707, 'f1': 0.8341637, 'auroc': 0.92739856, 'binary_precision': 0.68604654, 'binary_recall': 0.6781609, 'binary_specificity': 0.98649323, 'binary_f1_score': 0.6820809}
confusion matrix:
      0    1
0  5916   81
1    84  177
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863194.png
early stop counter: 6
val acc:0.9655172228813171, best validation acc: 0.9664750695228577, corresponding to test acc:                         0.9774688482284546 / 0.979066789150238
after epoch: 10,now: 2024-05-26 15:22:33.335546,epoch time: 0:16:23.731572,used: 2:45:55.842330,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_36_37_seed_0_20863194
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9685444, 'precision': 0.75688946, 'recall': 0.8042624, 'specificity': 0.8042624, 'f1': 0.778347, 'auroc': 0.95504206, 'binary_precision': 0.5267959, 'binary_recall': 0.62814415, 'binary_specificity': 0.9803806, 'binary_f1_score': 0.57302326}
confusion matrix:
       0    1
0  41475  830
1    547  924
---- Validation: 
scalar performance:
{'acc': 0.9664219, 'precision': 0.7471992, 'recall': 0.8063531, 'specificity': 0.8063531, 'f1': 0.773232, 'auroc': 0.94651055, 'binary_precision': 0.5074627, 'binary_recall': 0.63452566, 'binary_specificity': 0.9781806, 'binary_f1_score': 0.5639254}
confusion matrix:
       0    1
0  17753  396
1    235  408
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9785874, 'precision': 0.8806432, 'recall': 0.8385764, 'specificity': 0.8385764, 'f1': 0.85824895, 'auroc': 0.93717057, 'binary_precision': 0.7748918, 'binary_recall': 0.68582374, 'binary_specificity': 0.991329, 'binary_f1_score': 0.7276423}
confusion matrix:
      0    1
0  5945   52
1    82  179
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863194.png
early stop counter: 7
val acc:0.966421902179718, best validation acc: 0.9664750695228577, corresponding to test acc:                         0.9774688482284546 / 0.979066789150238
after epoch: 11,now: 2024-05-26 15:38:55.304958,epoch time: 0:16:21.969412,used: 3:02:17.811742,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_36_37_seed_0_20863194
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9666712, 'precision': 0.7449883, 'recall': 0.7945672, 'specificity': 0.7945672, 'f1': 0.7672293, 'auroc': 0.95372605, 'binary_precision': 0.50364554, 'binary_recall': 0.6100544, 'binary_specificity': 0.97908, 'binary_f1_score': 0.5517665}
confusion matrix:
       0    1
0  41419  885
1    574  898
---- Validation: 
scalar performance:
{'acc': 0.96599615, 'precision': 0.7444809, 'recall': 0.7993822, 'specificity': 0.7993822, 'f1': 0.7688229, 'auroc': 0.9450307, 'binary_precision': 0.5025189, 'binary_recall': 0.62052876, 'binary_specificity': 0.9782357, 'binary_f1_score': 0.5553236}
confusion matrix:
       0    1
0  17754  395
1    244  399
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9741131, 'precision': 0.845914, 'recall': 0.81791854, 'specificity': 0.81791854, 'f1': 0.83125895, 'auroc': 0.9328259, 'binary_precision': 0.70711297, 'binary_recall': 0.6475096, 'binary_specificity': 0.9883275, 'binary_f1_score': 0.67599994}
confusion matrix:
      0    1
0  5927   70
1    92  169
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863194.png
early stop counter: 8
val acc:0.9659961462020874, best validation acc: 0.9664750695228577, corresponding to test acc:                         0.9774688482284546 / 0.979066789150238
after epoch: 12,now: 2024-05-26 15:55:17.811934,epoch time: 0:16:22.506976,used: 3:18:40.318718,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_36_37_seed_0_20863194
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9679048, 'precision': 0.7527242, 'recall': 0.7957293, 'specificity': 0.7957293, 'f1': 0.77234584, 'auroc': 0.9562273, 'binary_precision': 0.5190531, 'binary_recall': 0.6111489, 'binary_specificity': 0.98030967, 'binary_f1_score': 0.5613487}
confusion matrix:
       0    1
0  41472  833
1    572  899
---- Validation: 
scalar performance:
{'acc': 0.96663475, 'precision': 0.7483272, 'recall': 0.7989628, 'specificity': 0.7989628, 'f1': 0.77102125, 'auroc': 0.9486374, 'binary_precision': 0.5102564, 'binary_recall': 0.61897355, 'binary_specificity': 0.978952, 'binary_f1_score': 0.5593816}
confusion matrix:
       0    1
0  17767  382
1    245  398
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97299457, 'precision': 0.85550845, 'recall': 0.77519125, 'specificity': 0.77519125, 'f1': 0.80969334, 'auroc': 0.9364965, 'binary_precision': 0.73, 'binary_recall': 0.55938697, 'binary_specificity': 0.9909955, 'binary_f1_score': 0.6334056}
confusion matrix:
      0    1
0  5943   54
1   115  146
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863194.png
better model found
persisted
after epoch: 13,now: 2024-05-26 16:11:38.876588,epoch time: 0:16:21.064654,used: 3:35:01.383372,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_36_37_seed_0_20863194
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96708244, 'precision': 0.7487437, 'recall': 0.8469088, 'specificity': 0.8469088, 'f1': 0.78875, 'auroc': 0.9598713, 'binary_precision': 0.50744116, 'binary_recall': 0.7180706, 'binary_specificity': 0.975747, 'binary_f1_score': 0.5946554}
confusion matrix:
       0     1
0  41278  1026
1    415  1057
---- Validation: 
scalar performance:
{'acc': 0.96663475, 'precision': 0.7495242, 'recall': 0.8544669, 'specificity': 0.8544669, 'f1': 0.79174036, 'auroc': 0.95028853, 'binary_precision': 0.5086207, 'binary_recall': 0.7340591, 'binary_specificity': 0.9748747, 'binary_f1_score': 0.6008911}
confusion matrix:
       0    1
0  17693  456
1    171  472
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97379357, 'precision': 0.84222984, 'recall': 0.81958413, 'specificity': 0.81958413, 'f1': 0.8304751, 'auroc': 0.94038844, 'binary_precision': 0.6995885, 'binary_recall': 0.651341, 'binary_specificity': 0.98782724, 'binary_f1_score': 0.6746032}
confusion matrix:
      0    1
0  5924   73
1    91  170
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863194.png
early stop counter: 1
val acc:0.9666347503662109, best validation acc: 0.9666347503662109, corresponding to test acc:                         0.9729945659637451 / 0.979066789150238
after epoch: 14,now: 2024-05-26 16:27:55.754784,epoch time: 0:16:16.878196,used: 3:51:18.261568,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_36_37_seed_0_20863194
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.965392, 'precision': 0.7397011, 'recall': 0.83947706, 'specificity': 0.83947706, 'f1': 0.7799166, 'auroc': 0.957994, 'binary_precision': 0.4898441, 'binary_recall': 0.7044837, 'binary_specificity': 0.9744705, 'binary_f1_score': 0.57787687}
confusion matrix:
       0     1
0  41224  1080
1    435  1037
---- Validation: 
scalar performance:
{'acc': 0.9656237, 'precision': 0.7448249, 'recall': 0.8644442, 'specificity': 0.8644442, 'f1': 0.79139006, 'auroc': 0.95137435, 'binary_precision': 0.49846154, 'binary_recall': 0.755832, 'binary_specificity': 0.9730564, 'binary_f1_score': 0.6007416}
confusion matrix:
       0    1
0  17660  489
1    157  486
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9686801, 'precision': 0.8040898, 'recall': 0.8040898, 'specificity': 0.8040898, 'f1': 0.8040898, 'auroc': 0.9309725, 'binary_precision': 0.6245211, 'binary_recall': 0.6245211, 'binary_specificity': 0.9836585, 'binary_f1_score': 0.6245211}
confusion matrix:
      0    1
0  5899   98
1    98  163
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863194.png
early stop counter: 2
val acc:0.965623676776886, best validation acc: 0.9666347503662109, corresponding to test acc:                         0.9729945659637451 / 0.979066789150238
after epoch: 15,now: 2024-05-26 16:44:18.883303,epoch time: 0:16:23.128519,used: 4:07:41.390087,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_36_37_seed_0_20863194
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.96840733, 'precision': 0.75578105, 'recall': 0.8175262, 'specificity': 0.8175262, 'f1': 0.7829421, 'auroc': 0.96176034, 'binary_precision': 0.5236285, 'binary_recall': 0.65578234, 'binary_specificity': 0.9792701, 'binary_f1_score': 0.58230144}
confusion matrix:
       0    1
0  41429  877
1    506  964
---- Validation: 
scalar performance:
{'acc': 0.9669008, 'precision': 0.75031304, 'recall': 0.82235223, 'specificity': 0.82235223, 'f1': 0.78125083, 'auroc': 0.9486666, 'binary_precision': 0.5125448, 'binary_recall': 0.66718507, 'binary_specificity': 0.9775194, 'binary_f1_score': 0.57972974}
confusion matrix:
       0    1
0  17741  408
1    214  429
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97203577, 'precision': 0.8519231, 'recall': 0.76186466, 'specificity': 0.76186466, 'f1': 0.79958963, 'auroc': 0.9422176, 'binary_precision': 0.7239583, 'binary_recall': 0.532567, 'binary_specificity': 0.99116224, 'binary_f1_score': 0.6136865}
confusion matrix:
      0    1
0  5944   53
1   122  139
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863194.png
better model found
persisted
after epoch: 16,now: 2024-05-26 17:00:40.120184,epoch time: 0:16:21.236881,used: 4:24:02.626968,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_36_37_seed_0_20863194
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9691383, 'precision': 0.76011515, 'recall': 0.84590846, 'specificity': 0.84590846, 'f1': 0.7962276, 'auroc': 0.96206003, 'binary_precision': 0.530303, 'binary_recall': 0.71380013, 'binary_specificity': 0.9780168, 'binary_f1_score': 0.6085192}
confusion matrix:
       0     1
0  41375   930
1    421  1050
---- Validation: 
scalar performance:
{'acc': 0.967433, 'precision': 0.7533697, 'recall': 0.8136271, 'specificity': 0.8136271, 'f1': 0.7799142, 'auroc': 0.94906783, 'binary_precision': 0.5193026, 'binary_recall': 0.64852256, 'binary_specificity': 0.97873163, 'binary_f1_score': 0.57676345}
confusion matrix:
       0    1
0  17763  386
1    226  417
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9701182, 'precision': 0.829025, 'recall': 0.7645288, 'specificity': 0.7645288, 'f1': 0.7928784, 'auroc': 0.93372023, 'binary_precision': 0.67788464, 'binary_recall': 0.54022986, 'binary_specificity': 0.98882776, 'binary_f1_score': 0.6012793}
confusion matrix:
      0    1
0  5930   67
1   120  141
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863194.png
better model found
persisted
after epoch: 17,now: 2024-05-26 17:17:04.493860,epoch time: 0:16:24.373676,used: 4:40:27.000644,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_36_37_seed_0_20863194
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.970212, 'precision': 0.76893693, 'recall': 0.7925228, 'specificity': 0.7925228, 'f1': 0.7801805, 'auroc': 0.9595157, 'binary_precision': 0.55174565, 'binary_recall': 0.6020408, 'binary_specificity': 0.98300475, 'binary_f1_score': 0.575797}
confusion matrix:
       0    1
0  41587  719
1    585  885
---- Validation: 
scalar performance:
{'acc': 0.9684972, 'precision': 0.7605509, 'recall': 0.7916764, 'specificity': 0.7916764, 'f1': 0.77513623, 'auroc': 0.94811034, 'binary_precision': 0.53526974, 'binary_recall': 0.60186625, 'binary_specificity': 0.98148656, 'binary_f1_score': 0.56661785}
confusion matrix:
       0    1
0  17813  336
1    256  387
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9638862, 'precision': 0.8343699, 'recall': 0.6146905, 'specificity': 0.6146905, 'f1': 0.66600066, 'auroc': 0.93433064, 'binary_precision': 0.7011494, 'binary_recall': 0.23371647, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.3505747}
confusion matrix:
      0   1
0  5971  26
1   200  61
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863194.png
better model found
persisted
after epoch: 18,now: 2024-05-26 17:33:26.582918,epoch time: 0:16:22.089058,used: 4:56:49.089702,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_36_37_seed_0_20863194
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9664885, 'precision': 0.74531555, 'recall': 0.84795725, 'specificity': 0.84795725, 'f1': 0.78666186, 'auroc': 0.96432745, 'binary_precision': 0.5004726, 'binary_recall': 0.72089857, 'binary_specificity': 0.97501594, 'binary_f1_score': 0.590795}
confusion matrix:
       0     1
0  41250  1057
1    410  1059
---- Validation: 
scalar performance:
{'acc': 0.96588975, 'precision': 0.7452684, 'recall': 0.84058017, 'specificity': 0.84058017, 'f1': 0.78419816, 'auroc': 0.95369816, 'binary_precision': 0.50110376, 'binary_recall': 0.7060653, 'binary_specificity': 0.97509503, 'binary_f1_score': 0.5861846}
confusion matrix:
       0    1
0  17697  452
1    189  454
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9691595, 'precision': 0.8230096, 'recall': 0.7548669, 'specificity': 0.7548669, 'f1': 0.7844655, 'auroc': 0.94516414, 'binary_precision': 0.6666667, 'binary_recall': 0.5210728, 'binary_specificity': 0.988661, 'binary_f1_score': 0.5849463}
confusion matrix:
      0    1
0  5929   68
1   125  136
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863194.png
early stop counter: 1
val acc:0.9658897519111633, best validation acc: 0.9684972167015076, corresponding to test acc:                         0.9638862013816833 / 0.979066789150238
after epoch: 19,now: 2024-05-26 17:49:51.422256,epoch time: 0:16:24.839338,used: 5:13:13.929040,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_36_37_seed_0_20863194
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.96831596, 'precision': 0.755471, 'recall': 0.8380393, 'specificity': 0.8380393, 'f1': 0.7903316, 'auroc': 0.96558106, 'binary_precision': 0.52156264, 'binary_recall': 0.69836956, 'binary_specificity': 0.97770894, 'binary_f1_score': 0.59715366}
confusion matrix:
       0     1
0  41361   943
1    444  1028
---- Validation: 
scalar performance:
{'acc': 0.9668476, 'precision': 0.7502515, 'recall': 0.8358257, 'specificity': 0.8358257, 'f1': 0.78602386, 'auroc': 0.95435554, 'binary_precision': 0.51144165, 'binary_recall': 0.69517887, 'binary_specificity': 0.97647256, 'binary_f1_score': 0.5893211}
confusion matrix:
       0    1
0  17722  427
1    196  447
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9686801, 'precision': 0.83998615, 'recall': 0.7106408, 'specificity': 0.7106408, 'f1': 0.75856483, 'auroc': 0.93719196, 'binary_precision': 0.7044025, 'binary_recall': 0.42911878, 'binary_specificity': 0.99216276, 'binary_f1_score': 0.5333333}
confusion matrix:
      0    1
0  5950   47
1   149  112
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863194.png
early stop counter: 2
val acc:0.9668475985527039, best validation acc: 0.9684972167015076, corresponding to test acc:                         0.9638862013816833 / 0.979066789150238
after epoch: 20,now: 2024-05-26 18:06:23.975290,epoch time: 0:16:32.553034,used: 5:29:46.482074,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_36_37_seed_0_20863194
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.96893275, 'precision': 0.7590585, 'recall': 0.8426205, 'specificity': 0.8426205, 'f1': 0.7943558, 'auroc': 0.96408, 'binary_precision': 0.5284264, 'binary_recall': 0.70720106, 'binary_specificity': 0.9780399, 'binary_f1_score': 0.6048809}
confusion matrix:
       0     1
0  41375   929
1    431  1041
---- Validation: 
scalar performance:
{'acc': 0.96796507, 'precision': 0.7565696, 'recall': 0.8289037, 'specificity': 0.8289037, 'f1': 0.7877343, 'auroc': 0.9515002, 'binary_precision': 0.52460986, 'binary_recall': 0.67962676, 'binary_specificity': 0.9781806, 'binary_f1_score': 0.5921409}
confusion matrix:
       0    1
0  17753  396
1    206  437
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9689997, 'precision': 0.8206716, 'recall': 0.7566159, 'specificity': 0.7566159, 'f1': 0.7846839, 'auroc': 0.9411098, 'binary_precision': 0.66183573, 'binary_recall': 0.5249042, 'binary_specificity': 0.9883275, 'binary_f1_score': 0.58547}
confusion matrix:
      0    1
0  5927   70
1   124  137
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863194.png
early stop counter: 3
val acc:0.9679650664329529, best validation acc: 0.9684972167015076, corresponding to test acc:                         0.9638862013816833 / 0.979066789150238
after epoch: 21,now: 2024-05-26 18:22:34.529729,epoch time: 0:16:10.554439,used: 5:45:57.036513,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_36_37_seed_0_20863194
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9691612, 'precision': 0.7602606, 'recall': 0.844936, 'specificity': 0.844936, 'f1': 0.7959816, 'auroc': 0.96505165, 'binary_precision': 0.53066397, 'binary_recall': 0.7117607, 'binary_specificity': 0.9781113, 'binary_f1_score': 0.6080139}
confusion matrix:
       0     1
0  41379   926
1    424  1047
---- Validation: 
scalar performance:
{'acc': 0.9694019, 'precision': 0.7652908, 'recall': 0.8318977, 'specificity': 0.8318977, 'f1': 0.7944479, 'auroc': 0.9551969, 'binary_precision': 0.5418719, 'binary_recall': 0.6842924, 'binary_specificity': 0.979503, 'binary_f1_score': 0.60481095}
confusion matrix:
       0    1
0  17777  372
1    203  440
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96708214, 'precision': 0.8174009, 'recall': 0.7134717, 'specificity': 0.7134717, 'f1': 0.75414777, 'auroc': 0.94140303, 'binary_precision': 0.6589595, 'binary_recall': 0.43678162, 'binary_specificity': 0.9901618, 'binary_f1_score': 0.5253456}
confusion matrix:
      0    1
0  5938   59
1   147  114
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863194.png
better model found
persisted
after epoch: 22,now: 2024-05-26 18:38:33.523296,epoch time: 0:15:58.993567,used: 6:01:56.030080,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_36_37_seed_0_20863194
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9672652, 'precision': 0.74937564, 'recall': 0.84704494, 'specificity': 0.84704494, 'f1': 0.78924143, 'auroc': 0.9644377, 'binary_precision': 0.50867885, 'binary_recall': 0.71817565, 'binary_specificity': 0.9759142, 'binary_f1_score': 0.59554046}
confusion matrix:
       0     1
0  41288  1019
1    414  1055
---- Validation: 
scalar performance:
{'acc': 0.96631545, 'precision': 0.74756646, 'recall': 0.8430507, 'specificity': 0.8430507, 'f1': 0.7866279, 'auroc': 0.9530426, 'binary_precision': 0.50553095, 'binary_recall': 0.71073097, 'binary_specificity': 0.9753705, 'binary_f1_score': 0.59082097}
confusion matrix:
       0    1
0  17702  447
1    186  457
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9678811, 'precision': 0.82089686, 'recall': 0.72671485, 'specificity': 0.72671485, 'f1': 0.7648133, 'auroc': 0.9447681, 'binary_precision': 0.66483516, 'binary_recall': 0.46360153, 'binary_specificity': 0.9898282, 'binary_f1_score': 0.5462754}
confusion matrix:
      0    1
0  5936   61
1   140  121
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863194.png
early stop counter: 1
val acc:0.9663154482841492, best validation acc: 0.9694018959999084, corresponding to test acc:                         0.967082142829895 / 0.979066789150238
after epoch: 23,now: 2024-05-26 18:54:40.085535,epoch time: 0:16:06.562239,used: 6:18:02.592319,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_36_37_seed_0_20863194
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9679048, 'precision': 0.75305915, 'recall': 0.8325808, 'specificity': 0.8325808, 'f1': 0.78677887, 'auroc': 0.9649801, 'binary_precision': 0.51711804, 'binary_recall': 0.6875, 'binary_specificity': 0.97766167, 'binary_f1_score': 0.59025955}
confusion matrix:
       0     1
0  41359   945
1    460  1012
---- Validation: 
scalar performance:
{'acc': 0.9665815, 'precision': 0.7487602, 'recall': 0.83418787, 'specificity': 0.83418787, 'f1': 0.78444266, 'auroc': 0.9544561, 'binary_precision': 0.50857145, 'binary_recall': 0.69206846, 'binary_specificity': 0.9763072, 'binary_f1_score': 0.58629775}
confusion matrix:
       0    1
0  17719  430
1    198  445
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9689997, 'precision': 0.8610086, 'recall': 0.69065183, 'specificity': 0.69065183, 'f1': 0.7470472, 'auroc': 0.94463456, 'binary_precision': 0.74814814, 'binary_recall': 0.38697317, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.51010096}
confusion matrix:
      0    1
0  5963   34
1   160  101
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863194.png
early stop counter: 2
val acc:0.9665815234184265, best validation acc: 0.9694018959999084, corresponding to test acc:                         0.967082142829895 / 0.979066789150238
after epoch: 24,now: 2024-05-26 19:10:37.007200,epoch time: 0:15:56.921665,used: 6:33:59.513984,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_36_37_seed_0_20863194
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9685444, 'precision': 0.75679797, 'recall': 0.85258305, 'specificity': 0.85258305, 'f1': 0.79626554, 'auroc': 0.96591884, 'binary_precision': 0.52318203, 'binary_recall': 0.7282609, 'binary_specificity': 0.9769053, 'binary_f1_score': 0.6089179}
confusion matrix:
       0     1
0  41327   977
1    400  1072
---- Validation: 
scalar performance:
{'acc': 0.96620905, 'precision': 0.7471434, 'recall': 0.847496, 'specificity': 0.847496, 'f1': 0.7877909, 'auroc': 0.9536643, 'binary_precision': 0.5043573, 'binary_recall': 0.7200622, 'binary_specificity': 0.97492975, 'binary_f1_score': 0.59320945}
confusion matrix:
       0    1
0  17694  455
1    180  463
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9654842, 'precision': 0.8256514, 'recall': 0.65950024, 'specificity': 0.65950024, 'f1': 0.7113037, 'auroc': 0.93865114, 'binary_precision': 0.68, 'binary_recall': 0.3256705, 'binary_specificity': 0.99333, 'binary_f1_score': 0.4404145}
confusion matrix:
      0   1
0  5957  40
1   176  85
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863194.png
early stop counter: 3
val acc:0.9662090539932251, best validation acc: 0.9694018959999084, corresponding to test acc:                         0.967082142829895 / 0.979066789150238
after epoch: 25,now: 2024-05-26 19:26:29.323962,epoch time: 0:15:52.316762,used: 6:49:51.830746,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_36_37_seed_0_20863194
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.96792763, 'precision': 0.75323147, 'recall': 0.857661, 'specificity': 0.857661, 'f1': 0.79544127, 'auroc': 0.96781623, 'binary_precision': 0.5156546, 'binary_recall': 0.73945576, 'binary_specificity': 0.9758663, 'binary_f1_score': 0.607602}
confusion matrix:
       0     1
0  41285  1021
1    383  1087
---- Validation: 
scalar performance:
{'acc': 0.9667944, 'precision': 0.75028485, 'recall': 0.85154927, 'specificity': 0.85154927, 'f1': 0.79133916, 'auroc': 0.95536447, 'binary_precision': 0.5103599, 'binary_recall': 0.7278383, 'binary_specificity': 0.9752603, 'binary_f1_score': 0.6}
confusion matrix:
       0    1
0  17700  449
1    175  468
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96356666, 'precision': 0.79836965, 'recall': 0.65300274, 'specificity': 0.65300274, 'f1': 0.6997808, 'auroc': 0.91522837, 'binary_precision': 0.6259542, 'binary_recall': 0.31417623, 'binary_specificity': 0.9918293, 'binary_f1_score': 0.41836733}
confusion matrix:
      0   1
0  5948  49
1   179  82
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863194.png
early stop counter: 4
val acc:0.9667943716049194, best validation acc: 0.9694018959999084, corresponding to test acc:                         0.967082142829895 / 0.979066789150238
after epoch: 26,now: 2024-05-26 19:42:20.973486,epoch time: 0:15:51.649524,used: 7:05:43.480270,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_36_37_seed_0_20863194
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.96943533, 'precision': 0.7626652, 'recall': 0.8116131, 'specificity': 0.8116131, 'f1': 0.7848172, 'auroc': 0.9656185, 'binary_precision': 0.5378486, 'binary_recall': 0.6424201, 'binary_specificity': 0.98080605, 'binary_f1_score': 0.58550185}
confusion matrix:
       0    1
0  41493  812
1    526  945
---- Validation: 
scalar performance:
{'acc': 0.968923, 'precision': 0.7625921, 'recall': 0.8203989, 'specificity': 0.8203989, 'f1': 0.78829634, 'auroc': 0.9522961, 'binary_precision': 0.53729457, 'binary_recall': 0.66096425, 'binary_specificity': 0.9798336, 'binary_f1_score': 0.5927475}
confusion matrix:
       0    1
0  17783  366
1    218  425
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.7580035, 'recall': 0.57945734, 'specificity': 0.57945734, 'f1': 0.6164552, 'auroc': 0.89144444, 'binary_precision': 0.55128205, 'binary_recall': 0.16475096, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.25368732}
confusion matrix:
      0   1
0  5962  35
1   218  43
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863194.png
early stop counter: 5
val acc:0.9689229726791382, best validation acc: 0.9694018959999084, corresponding to test acc:                         0.967082142829895 / 0.979066789150238
after epoch: 27,now: 2024-05-26 19:58:10.885719,epoch time: 0:15:49.912233,used: 7:21:33.392503,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_36_37_seed_0_20863194
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.96943533, 'precision': 0.76179606, 'recall': 0.8506553, 'specificity': 0.8506553, 'f1': 0.799026, 'auroc': 0.9690007, 'binary_precision': 0.53333336, 'binary_recall': 0.72331744, 'binary_specificity': 0.97799313, 'binary_f1_score': 0.61396426}
confusion matrix:
       0     1
0  41374   931
1    407  1064
---- Validation: 
scalar performance:
{'acc': 0.9661558, 'precision': 0.74700874, 'recall': 0.85196877, 'specificity': 0.85196877, 'f1': 0.78913605, 'auroc': 0.9568231, 'binary_precision': 0.5037594, 'binary_recall': 0.7293935, 'binary_specificity': 0.97454405, 'binary_f1_score': 0.5959339}
confusion matrix:
       0    1
0  17687  462
1    174  469
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96596354, 'precision': 0.8157636, 'recall': 0.68723536, 'specificity': 0.68723536, 'f1': 0.73333126, 'auroc': 0.9344014, 'binary_precision': 0.65789473, 'binary_recall': 0.38314176, 'binary_specificity': 0.991329, 'binary_f1_score': 0.48426148}
confusion matrix:
      0    1
0  5945   52
1   161  100
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863194.png
early stop counter: 6
val acc:0.9661558270454407, best validation acc: 0.9694018959999084, corresponding to test acc:                         0.967082142829895 / 0.979066789150238
after epoch: 28,now: 2024-05-26 20:14:08.432587,epoch time: 0:15:57.546868,used: 7:37:30.939371,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_36_37_seed_0_20863194
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.96781343, 'precision': 0.75283515, 'recall': 0.871063, 'specificity': 0.871063, 'f1': 0.79937804, 'auroc': 0.97037375, 'binary_precision': 0.5138952, 'binary_recall': 0.7673469, 'binary_specificity': 0.974779, 'binary_f1_score': 0.6155525}
confusion matrix:
       0     1
0  41239  1067
1    342  1128
---- Validation: 
scalar performance:
{'acc': 0.96706045, 'precision': 0.7520015, 'recall': 0.8689383, 'specificity': 0.8689383, 'f1': 0.798082, 'auroc': 0.9561972, 'binary_precision': 0.5125261, 'binary_recall': 0.7636081, 'binary_specificity': 0.97426856, 'binary_f1_score': 0.6133666}
confusion matrix:
       0    1
0  17682  467
1    152  491
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96628314, 'precision': 0.822282, 'recall': 0.68373746, 'specificity': 0.68373746, 'f1': 0.7320737, 'auroc': 0.940444, 'binary_precision': 0.6712329, 'binary_recall': 0.37547892, 'binary_specificity': 0.991996, 'binary_f1_score': 0.48157248}
confusion matrix:
      0   1
0  5949  48
1   163  98
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863194.png
early stop counter: 7
val acc:0.9670604467391968, best validation acc: 0.9694018959999084, corresponding to test acc:                         0.967082142829895 / 0.979066789150238
after epoch: 29,now: 2024-05-26 20:29:59.296625,epoch time: 0:15:50.864038,used: 7:53:21.803409,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_36_37_seed_0_20863194
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9676307, 'precision': 0.7516847, 'recall': 0.8530025, 'specificity': 0.8530025, 'f1': 0.7928265, 'auroc': 0.9679139, 'binary_precision': 0.512894, 'binary_recall': 0.7301156, 'binary_specificity': 0.9758894, 'binary_f1_score': 0.6025246}
confusion matrix:
       0     1
0  41285  1020
1    397  1074
---- Validation: 
scalar performance:
{'acc': 0.9655172, 'precision': 0.74413294, 'recall': 0.8598888, 'specificity': 0.8598888, 'f1': 0.7895014, 'auroc': 0.9567473, 'binary_precision': 0.4974093, 'binary_recall': 0.7465008, 'binary_specificity': 0.9732768, 'binary_f1_score': 0.5970149}
confusion matrix:
       0    1
0  17664  485
1    163  480
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9610099, 'precision': 0.7652652, 'recall': 0.64617175, 'specificity': 0.64617175, 'f1': 0.6864464, 'auroc': 0.8944292, 'binary_precision': 0.56028366, 'binary_recall': 0.30268198, 'binary_specificity': 0.9896615, 'binary_f1_score': 0.39303482}
confusion matrix:
      0   1
0  5935  62
1   182  79
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863194.png
early stop counter: 8
val acc:0.9655172228813171, best validation acc: 0.9694018959999084, corresponding to test acc:                         0.967082142829895 / 0.979066789150238
after epoch: 30,now: 2024-05-26 20:45:47.253275,epoch time: 0:15:47.956650,used: 8:09:09.760059,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_36_37_seed_0_20863194
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 8:09:09.760059 at 2024-05-26 20:45:47.253275
persisted model performance metric: 

scalar performance:
{'acc': 0.96612334, 'precision': 0.8160059, 'recall': 0.6909834, 'specificity': 0.6909834, 'f1': 0.73643196, 'auroc': 0.9417026, 'binary_precision': 0.65806454, 'binary_recall': 0.3908046, 'binary_specificity': 0.99116224, 'binary_f1_score': 0.4903846}
confusion matrix:
      0    1
0  5944   53
1   159  102
oracle model performance metric: 

scalar performance:
{'acc': 0.97794825, 'precision': 0.8866739, 'recall': 0.8180872, 'specificity': 0.8180872, 'f1': 0.84870046, 'auroc': 0.93392724, 'binary_precision': 0.7887324, 'binary_recall': 0.6436782, 'binary_specificity': 0.99249625, 'binary_f1_score': 0.70886075}
confusion matrix:
      0    1
0  5952   45
1    93  168
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs32/rule_results/10.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs32/rule_results/10.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs32/confusion_matrix/10.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 488335 KiB |  21386 MiB |   1187 TiB |   1187 TiB |
|       from large pool | 399104 KiB |  21312 MiB |   1185 TiB |   1185 TiB |
|       from small pool |  89231 KiB |    123 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 488335 KiB |  21386 MiB |   1187 TiB |   1187 TiB |
|       from large pool | 399104 KiB |  21312 MiB |   1185 TiB |   1185 TiB |
|       from small pool |  89231 KiB |    123 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476573 KiB |  21360 MiB |   1185 TiB |   1185 TiB |
|       from large pool | 387840 KiB |  21287 MiB |   1184 TiB |   1184 TiB |
|       from small pool |  88733 KiB |    122 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  22004 MiB |  22004 MiB |  22004 MiB |      0 B   |
|       from large pool |  21880 MiB |  21880 MiB |  21880 MiB |      0 B   |
|       from small pool |    124 MiB |    124 MiB |    124 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |   2125 MiB |   2696 MiB | 534131 GiB | 534128 GiB |
|       from large pool |   2112 MiB |   2693 MiB | 532625 GiB | 532623 GiB |
|       from small pool |     12 MiB |     14 MiB |   1505 GiB |   1505 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2553    |    3982    |   69656 K  |   69654 K  |
|       from large pool |      87    |     909    |   33390 K  |   33389 K  |
|       from small pool |    2466    |    3893    |   36266 K  |   36264 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2553    |    3982    |   69656 K  |   69654 K  |
|       from large pool |      87    |     909    |   33390 K  |   33389 K  |
|       from small pool |    2466    |    3893    |   36266 K  |   36264 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     285    |     285    |     285    |       0    |
|       from large pool |     223    |     223    |     223    |       0    |
|       from small pool |      62    |      62    |      62    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      89    |    1417    |   36919 K  |   36919 K  |
|       from large pool |      29    |     127    |   17058 K  |   17058 K  |
|       from small pool |      60    |    1387    |   19861 K  |   19861 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  21386 MiB |   1187 TiB |   1187 TiB |
|       from large pool |  16640 KiB |  21312 MiB |   1185 TiB |   1185 TiB |
|       from small pool |      0 KiB |    123 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  21386 MiB |   1187 TiB |   1187 TiB |
|       from large pool |  16640 KiB |  21312 MiB |   1185 TiB |   1185 TiB |
|       from small pool |      0 KiB |    123 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  21360 MiB |   1185 TiB |   1185 TiB |
|       from large pool |  16640 KiB |  21287 MiB |   1184 TiB |   1184 TiB |
|       from small pool |      0 KiB |    122 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2602 MiB |  22004 MiB |  22004 MiB |  19402 MiB |
|       from large pool |   2502 MiB |  21880 MiB |  21880 MiB |  19378 MiB |
|       from small pool |    100 MiB |    124 MiB |    124 MiB |     24 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 214784 KiB |   2696 MiB | 534131 GiB | 534131 GiB |
|       from large pool | 214784 KiB |   2693 MiB | 532625 GiB | 532625 GiB |
|       from small pool |      0 KiB |     31 MiB |   1505 GiB |   1505 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3982    |   69656 K  |   69656 K  |
|       from large pool |       2    |     909    |   33390 K  |   33390 K  |
|       from small pool |       0    |    3893    |   36266 K  |   36266 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3982    |   69656 K  |   69656 K  |
|       from large pool |       2    |     909    |   33390 K  |   33390 K  |
|       from small pool |       0    |    3893    |   36266 K  |   36266 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      81    |     285    |     285    |     204    |
|       from large pool |      31    |     223    |     223    |     192    |
|       from small pool |      50    |      62    |      62    |      12    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1417    |   36920 K  |   36920 K  |
|       from large pool |       3    |     127    |   17058 K  |   17058 K  |
|       from small pool |       0    |    1387    |   19861 K  |   19861 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  21386 MiB |   1187 TiB |   1187 TiB |
|       from large pool |  16640 KiB |  21312 MiB |   1185 TiB |   1185 TiB |
|       from small pool |      0 KiB |    123 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  21386 MiB |   1187 TiB |   1187 TiB |
|       from large pool |  16640 KiB |  21312 MiB |   1185 TiB |   1185 TiB |
|       from small pool |      0 KiB |    123 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  21360 MiB |   1185 TiB |   1185 TiB |
|       from large pool |  16640 KiB |  21287 MiB |   1184 TiB |   1184 TiB |
|       from small pool |      0 KiB |    122 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2602 MiB |  22004 MiB |  22004 MiB |  19402 MiB |
|       from large pool |   2502 MiB |  21880 MiB |  21880 MiB |  19378 MiB |
|       from small pool |    100 MiB |    124 MiB |    124 MiB |     24 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 214784 KiB |   2696 MiB | 534131 GiB | 534131 GiB |
|       from large pool | 214784 KiB |   2693 MiB | 532625 GiB | 532625 GiB |
|       from small pool |      0 KiB |     31 MiB |   1505 GiB |   1505 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3982    |   69656 K  |   69656 K  |
|       from large pool |       2    |     909    |   33390 K  |   33390 K  |
|       from small pool |       0    |    3893    |   36266 K  |   36266 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3982    |   69656 K  |   69656 K  |
|       from large pool |       2    |     909    |   33390 K  |   33390 K  |
|       from small pool |       0    |    3893    |   36266 K  |   36266 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      81    |     285    |     285    |     204    |
|       from large pool |      31    |     223    |     223    |     192    |
|       from small pool |      50    |      62    |      62    |      12    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1417    |   36920 K  |   36920 K  |
|       from large pool |       3    |     127    |   17058 K  |   17058 K  |
|       from small pool |       0    |    1387    |   19861 K  |   19861 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_20_54_29_seed_1_20863194

 Experiment start at: 2024-05-26 20:54:29.445318
before training, model accuracy: 0.09458588808774948
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96710765, 'precision': 0.71285987, 'recall': 0.50366616, 'specificity': 0.50366616, 'f1': 0.49915096, 'auroc': 0.86226666, 'binary_precision': 0.45833334, 'binary_recall': 0.007638889, 'binary_specificity': 0.9996934, 'binary_f1_score': 0.015027322}
confusion matrix:
       0   1
0  42387  13
1   1429  11
---- Validation: 
scalar performance:
{'acc': 0.9645678, 'precision': 0.8051292, 'recall': 0.5145544, 'specificity': 0.5145544, 'f1': 0.51938146, 'auroc': 0.84932274, 'binary_precision': 0.6451613, 'binary_recall': 0.029717682, 'binary_specificity': 0.99939114, 'binary_f1_score': 0.056818184}
confusion matrix:
       0   1
0  18056  11
1    653  20
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95939416, 'precision': 0.92974496, 'recall': 0.5172236, 'specificity': 0.5172236, 'f1': 0.52295613, 'auroc': 0.87286603, 'binary_precision': 0.9, 'binary_recall': 0.034615386, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.06666667}
confusion matrix:
      0  1
0  5945  1
1   251  9
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863194.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-26 21:11:15.962024,epoch time: 0:16:46.516706,used: 0:16:46.516706,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_20_54_29_seed_1_20863194
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96633214, 'precision': 0.70272857, 'recall': 0.5404979, 'specificity': 0.5404979, 'f1': 0.56234485, 'auroc': 0.9052782, 'binary_precision': 0.43571427, 'binary_recall': 0.08472222, 'binary_specificity': 0.9962736, 'binary_f1_score': 0.14186046}
confusion matrix:
       0    1
0  42242  158
1   1318  122
---- Validation: 
scalar performance:
{'acc': 0.96526146, 'precision': 0.7555042, 'recall': 0.6086142, 'specificity': 0.6086142, 'f1': 0.6495358, 'auroc': 0.8955492, 'binary_precision': 0.5392857, 'binary_recall': 0.2243685, 'binary_specificity': 0.9928599, 'binary_f1_score': 0.316894}
confusion matrix:
       0    1
0  17938  129
1    522  151
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9656784, 'precision': 0.92586136, 'recall': 0.60325754, 'specificity': 0.60325754, 'f1': 0.6594161, 'auroc': 0.88759476, 'binary_precision': 0.8852459, 'binary_recall': 0.20769231, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.3364486}
confusion matrix:
      0   1
0  5939   7
1   206  54
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863194.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-05-26 21:27:08.526198,epoch time: 0:15:52.564174,used: 0:32:39.080880,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_20_54_29_seed_1_20863194
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9662865, 'precision': 0.7202279, 'recall': 0.5869968, 'specificity': 0.5869968, 'f1': 0.6218749, 'auroc': 0.9218468, 'binary_precision': 0.46774194, 'binary_recall': 0.18099861, 'binary_specificity': 0.99299496, 'binary_f1_score': 0.261}
confusion matrix:
       0    1
0  42101  297
1   1181  261
---- Validation: 
scalar performance:
{'acc': 0.9652081, 'precision': 0.7501334, 'recall': 0.6586552, 'specificity': 0.6586552, 'f1': 0.69305146, 'auroc': 0.9231411, 'binary_precision': 0.5249406, 'binary_recall': 0.32838038, 'binary_specificity': 0.9889301, 'binary_f1_score': 0.40402195}
confusion matrix:
       0    1
0  17867  200
1    452  221
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97067356, 'precision': 0.90759236, 'recall': 0.6831018, 'specificity': 0.6831018, 'f1': 0.74912506, 'auroc': 0.91188484, 'binary_precision': 0.84210527, 'binary_recall': 0.36923078, 'binary_specificity': 0.99697274, 'binary_f1_score': 0.51336896}
confusion matrix:
      0   1
0  5928  18
1   164  96
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863194.png
new oracle model saved
early stop counter: 1
val acc:0.965208113193512, best validation acc: 0.9652614593505859, corresponding to test acc:                         0.9656783938407898 / 0.9706735610961914
after epoch: 3,now: 2024-05-26 21:42:59.728096,epoch time: 0:15:51.201898,used: 0:48:30.282778,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_20_54_29_seed_1_20863194
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96751827, 'precision': 0.7430518, 'recall': 0.66186583, 'specificity': 0.66186583, 'f1': 0.69349474, 'auroc': 0.9320911, 'binary_precision': 0.5084388, 'binary_recall': 0.33472222, 'binary_specificity': 0.98900944, 'binary_f1_score': 0.4036851}
confusion matrix:
       0    1
0  41934  466
1    958  482
---- Validation: 
scalar performance:
{'acc': 0.96574175, 'precision': 0.7528645, 'recall': 0.73618084, 'specificity': 0.73618084, 'f1': 0.74420464, 'auroc': 0.9255042, 'binary_precision': 0.5247209, 'binary_recall': 0.48885587, 'binary_specificity': 0.98350585, 'binary_f1_score': 0.5061538}
confusion matrix:
       0    1
0  17769  298
1    344  329
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97019017, 'precision': 0.8704478, 'recall': 0.7049173, 'specificity': 0.7049173, 'f1': 0.7616254, 'auroc': 0.9159674, 'binary_precision': 0.7659575, 'binary_recall': 0.41538462, 'binary_specificity': 0.99445003, 'binary_f1_score': 0.5386533}
confusion matrix:
      0    1
0  5913   33
1   152  108
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863194.png
better model found
persisted
after epoch: 4,now: 2024-05-26 21:58:56.102962,epoch time: 0:15:56.374866,used: 1:04:26.657644,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_20_54_29_seed_1_20863194
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9680657, 'precision': 0.7493167, 'recall': 0.6824908, 'specificity': 0.6824908, 'f1': 0.7102066, 'auroc': 0.937263, 'binary_precision': 0.5196172, 'binary_recall': 0.37682164, 'binary_specificity': 0.9881601, 'binary_f1_score': 0.43684632}
confusion matrix:
       0    1
0  41897  502
1    898  543
---- Validation: 
scalar performance:
{'acc': 0.96558166, 'precision': 0.7514357, 'recall': 0.7611322, 'specificity': 0.7611322, 'f1': 0.7561811, 'auroc': 0.9324957, 'binary_precision': 0.52, 'binary_recall': 0.5408618, 'binary_specificity': 0.9814026, 'binary_f1_score': 0.53022575}
confusion matrix:
       0    1
0  17731  336
1    309  364
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9740574, 'precision': 0.91161394, 'recall': 0.73084235, 'specificity': 0.73084235, 'f1': 0.79354477, 'auroc': 0.9251759, 'binary_precision': 0.84615386, 'binary_recall': 0.4653846, 'binary_specificity': 0.99630004, 'binary_f1_score': 0.60049623}
confusion matrix:
      0    1
0  5924   22
1   139  121
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863194.png
new oracle model saved
early stop counter: 1
val acc:0.9655816555023193, best validation acc: 0.965741753578186, corresponding to test acc:                         0.970190167427063 / 0.9740573763847351
after epoch: 5,now: 2024-05-26 22:14:42.680439,epoch time: 0:15:46.577477,used: 1:20:13.235121,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_20_54_29_seed_1_20863194
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9680885, 'precision': 0.7488315, 'recall': 0.73260087, 'specificity': 0.73260087, 'f1': 0.7404131, 'auroc': 0.94197047, 'binary_precision': 0.51526433, 'binary_recall': 0.48055556, 'binary_specificity': 0.9846462, 'binary_f1_score': 0.49730507}
confusion matrix:
       0    1
0  41749  651
1    748  692
---- Validation: 
scalar performance:
{'acc': 0.9663821, 'precision': 0.75659984, 'recall': 0.78801215, 'specificity': 0.78801215, 'f1': 0.7712896, 'auroc': 0.93989336, 'binary_precision': 0.52832675, 'binary_recall': 0.5958395, 'binary_specificity': 0.98018485, 'binary_f1_score': 0.56005585}
confusion matrix:
       0    1
0  17709  358
1    272  401
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97212374, 'precision': 0.86359096, 'recall': 0.7482231, 'specificity': 0.7482231, 'f1': 0.7939273, 'auroc': 0.9233389, 'binary_precision': 0.74857146, 'binary_recall': 0.50384617, 'binary_specificity': 0.9926001, 'binary_f1_score': 0.6022989}
confusion matrix:
      0    1
0  5902   44
1   129  131
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863194.png
better model found
persisted
after epoch: 6,now: 2024-05-26 22:30:33.453984,epoch time: 0:15:50.773545,used: 1:36:04.008666,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_20_54_29_seed_1_20863194
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96838504, 'precision': 0.7513437, 'recall': 0.7570678, 'specificity': 0.7570678, 'f1': 0.75417, 'auroc': 0.9462483, 'binary_precision': 0.5186441, 'binary_recall': 0.53088135, 'binary_specificity': 0.9832543, 'binary_f1_score': 0.52469134}
confusion matrix:
       0    1
0  41689  710
1    676  765
---- Validation: 
scalar performance:
{'acc': 0.965635, 'precision': 0.751934, 'recall': 0.80765224, 'specificity': 0.80765224, 'f1': 0.77666926, 'auroc': 0.94512844, 'binary_precision': 0.5174909, 'binary_recall': 0.63744426, 'binary_specificity': 0.9778602, 'binary_f1_score': 0.57123834}
confusion matrix:
       0    1
0  17667  400
1    244  429
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97486305, 'precision': 0.87745047, 'recall': 0.77907646, 'specificity': 0.77907646, 'f1': 0.82014596, 'auroc': 0.9310417, 'binary_precision': 0.7736842, 'binary_recall': 0.5653846, 'binary_specificity': 0.9927682, 'binary_f1_score': 0.6533333}
confusion matrix:
      0    1
0  5903   43
1   113  147
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863194.png
new oracle model saved
early stop counter: 1
val acc:0.9656350016593933, best validation acc: 0.9663820862770081, corresponding to test acc:                         0.9721237421035767 / 0.9748630523681641
after epoch: 7,now: 2024-05-26 22:46:25.781205,epoch time: 0:15:52.327221,used: 1:51:56.335887,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_20_54_29_seed_1_20863194
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9661268, 'precision': 0.7372985, 'recall': 0.793242, 'specificity': 0.793242, 'f1': 0.76196945, 'auroc': 0.95020044, 'binary_precision': 0.48803562, 'binary_recall': 0.6081831, 'binary_specificity': 0.97830087, 'binary_f1_score': 0.5415252}
confusion matrix:
       0    1
0  41478  920
1    565  877
---- Validation: 
scalar performance:
{'acc': 0.9646745, 'precision': 0.74703187, 'recall': 0.8286121, 'specificity': 0.8286121, 'f1': 0.78128624, 'auroc': 0.94841105, 'binary_precision': 0.50606394, 'binary_recall': 0.6820208, 'binary_specificity': 0.9752034, 'binary_f1_score': 0.58101267}
confusion matrix:
       0    1
0  17619  448
1    214  459
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97550756, 'precision': 0.8761755, 'recall': 0.7922857, 'specificity': 0.7922857, 'f1': 0.82842386, 'auroc': 0.9335306, 'binary_precision': 0.77, 'binary_recall': 0.5923077, 'binary_specificity': 0.99226373, 'binary_f1_score': 0.6695652}
confusion matrix:
      0    1
0  5900   46
1   106  154
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863194.png
new oracle model saved
early stop counter: 2
val acc:0.9646744728088379, best validation acc: 0.9663820862770081, corresponding to test acc:                         0.9721237421035767 / 0.9755075573921204
after epoch: 8,now: 2024-05-26 23:02:20.134441,epoch time: 0:15:54.353236,used: 2:07:50.689123,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_20_54_29_seed_1_20863194
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9687728, 'precision': 0.754539, 'recall': 0.7570958, 'specificity': 0.7570958, 'f1': 0.7558104, 'auroc': 0.9519638, 'binary_precision': 0.5250515, 'binary_recall': 0.53051317, 'binary_specificity': 0.98367846, 'binary_f1_score': 0.5277682}
confusion matrix:
       0    1
0  41706  692
1    677  765
---- Validation: 
scalar performance:
{'acc': 0.96835643, 'precision': 0.7710651, 'recall': 0.77687657, 'specificity': 0.77687657, 'f1': 0.7739365, 'auroc': 0.94736934, 'binary_precision': 0.55813956, 'binary_recall': 0.57057947, 'binary_specificity': 0.9831737, 'binary_f1_score': 0.56429094}
confusion matrix:
       0    1
0  17763  304
1    289  384
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97260714, 'precision': 0.85292625, 'recall': 0.7742212, 'specificity': 0.7742212, 'f1': 0.8081056, 'auroc': 0.93420184, 'binary_precision': 0.725, 'binary_recall': 0.5576923, 'binary_specificity': 0.9907501, 'binary_f1_score': 0.63043475}
confusion matrix:
      0    1
0  5891   55
1   115  145
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863194.png
better model found
persisted
after epoch: 9,now: 2024-05-26 23:18:09.710530,epoch time: 0:15:49.576089,used: 2:23:40.265212,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_20_54_29_seed_1_20863194
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.96699363, 'precision': 0.74340844, 'recall': 0.8196991, 'specificity': 0.8196991, 'f1': 0.7757718, 'auroc': 0.9529015, 'binary_precision': 0.4984326, 'binary_recall': 0.66204023, 'binary_specificity': 0.977358, 'binary_f1_score': 0.5687034}
confusion matrix:
       0    1
0  41439  960
1    487  954
---- Validation: 
scalar performance:
{'acc': 0.9652081, 'precision': 0.7496226, 'recall': 0.8167293, 'specificity': 0.8167293, 'f1': 0.77869076, 'auroc': 0.9491924, 'binary_precision': 0.51216686, 'binary_recall': 0.65676075, 'binary_specificity': 0.97669786, 'binary_f1_score': 0.5755208}
confusion matrix:
       0    1
0  17646  421
1    231  442
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9747019, 'precision': 0.84947014, 'recall': 0.824967, 'specificity': 0.824967, 'f1': 0.83672285, 'auroc': 0.94081664, 'binary_precision': 0.71369296, 'binary_recall': 0.6615385, 'binary_specificity': 0.9883956, 'binary_f1_score': 0.68662673}
confusion matrix:
      0    1
0  5877   69
1    88  172
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863194.png
early stop counter: 1
val acc:0.965208113193512, best validation acc: 0.9683564305305481, corresponding to test acc:                         0.9726071357727051 / 0.9755075573921204
after epoch: 10,now: 2024-05-26 23:34:02.955533,epoch time: 0:15:53.245003,used: 2:39:33.510215,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_20_54_29_seed_1_20863194
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96649176, 'precision': 0.74189126, 'recall': 0.8460174, 'specificity': 0.8460174, 'f1': 0.783609, 'auroc': 0.9559289, 'binary_precision': 0.49355608, 'binary_recall': 0.7170596, 'binary_specificity': 0.9749752, 'binary_f1_score': 0.5846763}
confusion matrix:
       0     1
0  41337  1061
1    408  1034
---- Validation: 
scalar performance:
{'acc': 0.96387404, 'precision': 0.7426126, 'recall': 0.8210443, 'specificity': 0.8210443, 'f1': 0.7756517, 'auroc': 0.952929, 'binary_precision': 0.4977827, 'binary_recall': 0.66716194, 'binary_specificity': 0.97492665, 'binary_f1_score': 0.5701587}
confusion matrix:
       0    1
0  17614  453
1    224  449
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9727683, 'precision': 0.83252966, 'recall': 0.8239579, 'specificity': 0.8239579, 'f1': 0.82818127, 'auroc': 0.93688065, 'binary_precision': 0.6798419, 'binary_recall': 0.6615385, 'binary_specificity': 0.9863774, 'binary_f1_score': 0.6705653}
confusion matrix:
      0    1
0  5865   81
1    88  172
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863194.png
early stop counter: 2
val acc:0.9638740420341492, best validation acc: 0.9683564305305481, corresponding to test acc:                         0.9726071357727051 / 0.9755075573921204
after epoch: 11,now: 2024-05-26 23:50:04.478919,epoch time: 0:16:01.523386,used: 2:55:35.033601,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_20_54_29_seed_1_20863194
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9689097, 'precision': 0.7551556, 'recall': 0.7873119, 'specificity': 0.7873119, 'f1': 0.77017486, 'auroc': 0.957337, 'binary_precision': 0.52421826, 'binary_recall': 0.5929265, 'binary_specificity': 0.98169726, 'binary_f1_score': 0.5564595}
confusion matrix:
       0    1
0  41622  776
1    587  855
---- Validation: 
scalar performance:
{'acc': 0.96616864, 'precision': 0.7554256, 'recall': 0.770735, 'specificity': 0.770735, 'f1': 0.7628307, 'auroc': 0.95012224, 'binary_precision': 0.5272727, 'binary_recall': 0.5601783, 'binary_specificity': 0.98129183, 'binary_f1_score': 0.5432276}
confusion matrix:
       0    1
0  17729  338
1    296  377
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97260714, 'precision': 0.85088056, 'recall': 0.77789915, 'specificity': 0.77789915, 'f1': 0.8096962, 'auroc': 0.9437002, 'binary_precision': 0.7205882, 'binary_recall': 0.5653846, 'binary_specificity': 0.9904137, 'binary_f1_score': 0.6336207}
confusion matrix:
      0    1
0  5889   57
1   113  147
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863194.png
early stop counter: 3
val acc:0.9661686420440674, best validation acc: 0.9683564305305481, corresponding to test acc:                         0.9726071357727051 / 0.9755075573921204
after epoch: 12,now: 2024-05-27 00:05:57.543695,epoch time: 0:15:53.064776,used: 3:11:28.098377,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_20_54_29_seed_1_20863194
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.96699363, 'precision': 0.7442664, 'recall': 0.8395779, 'specificity': 0.8395779, 'f1': 0.78320646, 'auroc': 0.9574695, 'binary_precision': 0.4987703, 'binary_recall': 0.70319, 'binary_specificity': 0.97596586, 'binary_f1_score': 0.5835971}
confusion matrix:
       0     1
0  41379  1019
1    428  1014
---- Validation: 
scalar performance:
{'acc': 0.96360725, 'precision': 0.7415333, 'recall': 0.82734334, 'specificity': 0.82734334, 'f1': 0.77710485, 'auroc': 0.95391285, 'binary_precision': 0.49513513, 'binary_recall': 0.6805349, 'binary_specificity': 0.9741518, 'binary_f1_score': 0.5732165}
confusion matrix:
       0    1
0  17600  467
1    215  458
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.972446, 'precision': 0.8292637, 'recall': 0.82562876, 'specificity': 0.82562876, 'f1': 0.8274349, 'auroc': 0.93802214, 'binary_precision': 0.67315173, 'binary_recall': 0.6653846, 'binary_specificity': 0.98587286, 'binary_f1_score': 0.66924566}
confusion matrix:
      0    1
0  5862   84
1    87  173
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863194.png
early stop counter: 4
val acc:0.9636072516441345, best validation acc: 0.9683564305305481, corresponding to test acc:                         0.9726071357727051 / 0.9755075573921204
after epoch: 13,now: 2024-05-27 00:21:49.105144,epoch time: 0:15:51.561449,used: 3:27:19.659826,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_20_54_29_seed_1_20863194
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9695256, 'precision': 0.7590088, 'recall': 0.8137562, 'specificity': 0.8137562, 'f1': 0.783473, 'auroc': 0.96029484, 'binary_precision': 0.53011364, 'binary_recall': 0.647018, 'binary_specificity': 0.9804944, 'binary_f1_score': 0.58276075}
confusion matrix:
       0    1
0  41571  827
1    509  933
---- Validation: 
scalar performance:
{'acc': 0.9653148, 'precision': 0.74995077, 'recall': 0.798903, 'specificity': 0.798903, 'f1': 0.77196854, 'auroc': 0.9525431, 'binary_precision': 0.51418, 'binary_recall': 0.61961365, 'binary_specificity': 0.97819227, 'binary_f1_score': 0.5619946}
confusion matrix:
       0    1
0  17673  394
1    256  417
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97260714, 'precision': 0.8394593, 'recall': 0.801806, 'specificity': 0.801806, 'f1': 0.81940097, 'auroc': 0.9441032, 'binary_precision': 0.6956522, 'binary_recall': 0.61538464, 'binary_specificity': 0.98822737, 'binary_f1_score': 0.6530613}
confusion matrix:
      0    1
0  5876   70
1   100  160
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863194.png
early stop counter: 5
val acc:0.9653148055076599, best validation acc: 0.9683564305305481, corresponding to test acc:                         0.9726071357727051 / 0.9755075573921204
after epoch: 14,now: 2024-05-27 00:37:40.575053,epoch time: 0:15:51.469909,used: 3:43:11.129735,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_20_54_29_seed_1_20863194
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.96833944, 'precision': 0.75153685, 'recall': 0.825871, 'specificity': 0.825871, 'f1': 0.78336394, 'auroc': 0.96011996, 'binary_precision': 0.5143008, 'binary_recall': 0.6733703, 'binary_specificity': 0.9783716, 'binary_f1_score': 0.58318317}
confusion matrix:
       0    1
0  41481  917
1    471  971
---- Validation: 
scalar performance:
{'acc': 0.964301, 'precision': 0.744058, 'recall': 0.79837716, 'specificity': 0.79837716, 'f1': 0.76814747, 'auroc': 0.9528439, 'binary_precision': 0.50240964, 'binary_recall': 0.61961365, 'binary_specificity': 0.97714067, 'binary_f1_score': 0.55489016}
confusion matrix:
       0    1
0  17654  413
1    256  417
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9708347, 'precision': 0.84402704, 'recall': 0.7530674, 'specificity': 0.7530674, 'f1': 0.79087603, 'auroc': 0.9400225, 'binary_precision': 0.7089947, 'binary_recall': 0.5153846, 'binary_specificity': 0.9907501, 'binary_f1_score': 0.596882}
confusion matrix:
      0    1
0  5891   55
1   126  134
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863194.png
early stop counter: 6
val acc:0.9643009901046753, best validation acc: 0.9683564305305481, corresponding to test acc:                         0.9726071357727051 / 0.9755075573921204
after epoch: 15,now: 2024-05-27 00:53:39.019455,epoch time: 0:15:58.444402,used: 3:59:09.574137,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_20_54_29_seed_1_20863194
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.96950275, 'precision': 0.7586026, 'recall': 0.82233703, 'specificity': 0.82233703, 'f1': 0.7865794, 'auroc': 0.9629719, 'binary_precision': 0.52869755, 'binary_recall': 0.6648161, 'binary_specificity': 0.97985804, 'binary_f1_score': 0.58899474}
confusion matrix:
       0    1
0  41545  854
1    483  958
---- Validation: 
scalar performance:
{'acc': 0.9654749, 'precision': 0.75081104, 'recall': 0.788257, 'specificity': 0.788257, 'f1': 0.7680714, 'auroc': 0.9521253, 'binary_precision': 0.5167095, 'binary_recall': 0.5973254, 'binary_specificity': 0.97918856, 'binary_f1_score': 0.5541006}
confusion matrix:
       0    1
0  17691  376
1    271  402
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97147924, 'precision': 0.84436625, 'recall': 0.7662766, 'specificity': 0.7662766, 'f1': 0.7997855, 'auroc': 0.94853747, 'binary_precision': 0.7085427, 'binary_recall': 0.5423077, 'binary_specificity': 0.9902455, 'binary_f1_score': 0.61437905}
confusion matrix:
      0    1
0  5888   58
1   119  141
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863194.png
early stop counter: 7
val acc:0.9654749035835266, best validation acc: 0.9683564305305481, corresponding to test acc:                         0.9726071357727051 / 0.9755075573921204
after epoch: 16,now: 2024-05-27 01:09:29.546354,epoch time: 0:15:50.526899,used: 4:15:00.101036,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_20_54_29_seed_1_20863194
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9686816, 'precision': 0.7535989, 'recall': 0.8433646, 'specificity': 0.8433646, 'f1': 0.79094565, 'auroc': 0.96341616, 'binary_precision': 0.5172065, 'binary_recall': 0.7092297, 'binary_specificity': 0.9774995, 'binary_f1_score': 0.5981856}
confusion matrix:
       0     1
0  41445   954
1    419  1022
---- Validation: 
scalar performance:
{'acc': 0.9644077, 'precision': 0.74542993, 'recall': 0.8220363, 'specificity': 0.8220363, 'f1': 0.77788657, 'auroc': 0.9525383, 'binary_precision': 0.5033557, 'binary_recall': 0.6686478, 'binary_specificity': 0.9754248, 'binary_f1_score': 0.5743458}
confusion matrix:
       0    1
0  17623  444
1    223  450
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96696746, 'precision': 0.8030118, 'recall': 0.7547272, 'specificity': 0.7547272, 'f1': 0.77652717, 'auroc': 0.9463109, 'binary_precision': 0.6267281, 'binary_recall': 0.52307695, 'binary_specificity': 0.9863774, 'binary_f1_score': 0.57023066}
confusion matrix:
      0    1
0  5865   81
1   124  136
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863194.png
early stop counter: 8
val acc:0.9644076824188232, best validation acc: 0.9683564305305481, corresponding to test acc:                         0.9726071357727051 / 0.9755075573921204
after epoch: 17,now: 2024-05-27 01:25:27.415949,epoch time: 0:15:57.869595,used: 4:30:57.970631,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_20_54_29_seed_1_20863194
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9680885, 'precision': 0.7500181, 'recall': 0.83132637, 'specificity': 0.83132637, 'f1': 0.7843208, 'auroc': 0.96427727, 'binary_precision': 0.51086956, 'binary_recall': 0.684941, 'binary_specificity': 0.97771174, 'binary_f1_score': 0.58523566}
confusion matrix:
       0    1
0  41454  945
1    454  987
---- Validation: 
scalar performance:
{'acc': 0.96344715, 'precision': 0.7403525, 'recall': 0.8193924, 'specificity': 0.8193924, 'f1': 0.7735504, 'auroc': 0.9518494, 'binary_precision': 0.49337748, 'binary_recall': 0.6641902, 'binary_specificity': 0.9745946, 'binary_f1_score': 0.5661811}
confusion matrix:
       0    1
0  17608  459
1    226  447
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9705124, 'precision': 0.8339874, 'recall': 0.7657721, 'specificity': 0.7657721, 'f1': 0.79556704, 'auroc': 0.94309783, 'binary_precision': 0.6878049, 'binary_recall': 0.5423077, 'binary_specificity': 0.9892365, 'binary_f1_score': 0.60645163}
confusion matrix:
      0    1
0  5882   64
1   119  141
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863194.png
early stop counter: 9
val acc:0.9634471535682678, best validation acc: 0.9683564305305481, corresponding to test acc:                         0.9726071357727051 / 0.9755075573921204
after epoch: 18,now: 2024-05-27 01:41:23.293593,epoch time: 0:15:55.877644,used: 4:46:53.848275,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_20_54_29_seed_1_20863194
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.97018707, 'precision': 0.7642472, 'recall': 0.78984237, 'specificity': 0.78984237, 'f1': 0.7763899, 'auroc': 0.96340036, 'binary_precision': 0.5422446, 'binary_recall': 0.5968078, 'binary_specificity': 0.98287696, 'binary_f1_score': 0.5682193}
confusion matrix:
       0    1
0  41673  726
1    581  860
---- Validation: 
scalar performance:
{'acc': 0.9659018, 'precision': 0.75352025, 'recall': 0.78204095, 'specificity': 0.78204095, 'f1': 0.766928, 'auroc': 0.95087373, 'binary_precision': 0.5226064, 'binary_recall': 0.5839524, 'binary_specificity': 0.98012954, 'binary_f1_score': 0.55157894}
confusion matrix:
       0    1
0  17708  359
1    280  393
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9668063, 'precision': 0.8292644, 'recall': 0.68843955, 'specificity': 0.68843955, 'f1': 0.7377264, 'auroc': 0.9392475, 'binary_precision': 0.6849315, 'binary_recall': 0.3846154, 'binary_specificity': 0.99226373, 'binary_f1_score': 0.49261084}
confusion matrix:
      0    1
0  5900   46
1   160  100
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863194.png
early stop counter: 10
val acc:0.965901792049408, best validation acc: 0.9683564305305481, corresponding to test acc:                         0.9726071357727051 / 0.9755075573921204
after epoch: 19,now: 2024-05-27 01:57:14.988259,epoch time: 0:15:51.694666,used: 5:02:45.542941,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_20_54_29_seed_1_20863194
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9685219, 'precision': 0.7526774, 'recall': 0.8426117, 'specificity': 0.8426117, 'f1': 0.79005665, 'auroc': 0.96384716, 'binary_precision': 0.51541185, 'binary_recall': 0.70784175, 'binary_specificity': 0.9773815, 'binary_f1_score': 0.5964912}
confusion matrix:
       0     1
0  41440   959
1    421  1020
---- Validation: 
scalar performance:
{'acc': 0.96526146, 'precision': 0.7497198, 'recall': 0.80459744, 'specificity': 0.80459744, 'f1': 0.7740976, 'auroc': 0.95479023, 'binary_precision': 0.51328504, 'binary_recall': 0.6315007, 'binary_specificity': 0.97769415, 'binary_f1_score': 0.5662891}
confusion matrix:
       0    1
0  17664  403
1    248  425
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97147924, 'precision': 0.83643866, 'recall': 0.7828275, 'specificity': 0.7828275, 'f1': 0.8070502, 'auroc': 0.95204663, 'binary_precision': 0.69124424, 'binary_recall': 0.5769231, 'binary_specificity': 0.9887319, 'binary_f1_score': 0.6289308}
confusion matrix:
      0    1
0  5879   67
1   110  150
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863194.png
early stop counter: 11
val acc:0.9652614593505859, best validation acc: 0.9683564305305481, corresponding to test acc:                         0.9726071357727051 / 0.9755075573921204
after epoch: 20,now: 2024-05-27 02:13:02.852494,epoch time: 0:15:47.864235,used: 5:18:33.407176,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_20_54_29_seed_1_20863194
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9684763, 'precision': 0.75224864, 'recall': 0.8128788, 'specificity': 0.8128788, 'f1': 0.77893865, 'auroc': 0.96235645, 'binary_precision': 0.5166297, 'binary_recall': 0.6463246, 'binary_specificity': 0.979433, 'binary_f1_score': 0.5742452}
confusion matrix:
       0    1
0  41526  872
1    510  932
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.7435316, 'recall': 0.81614816, 'specificity': 0.81614816, 'f1': 0.77451205, 'auroc': 0.95402604, 'binary_precision': 0.5, 'binary_recall': 0.65676075, 'binary_specificity': 0.9755355, 'binary_f1_score': 0.56775856}
confusion matrix:
       0    1
0  17625  442
1    231  442
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96841764, 'precision': 0.8274385, 'recall': 0.7297381, 'specificity': 0.7297381, 'f1': 0.76908696, 'auroc': 0.9378618, 'binary_precision': 0.67777777, 'binary_recall': 0.46923077, 'binary_specificity': 0.9902455, 'binary_f1_score': 0.5545454}
confusion matrix:
      0    1
0  5888   58
1   138  122
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863194.png
early stop counter: 12
val acc:0.9640874862670898, best validation acc: 0.9683564305305481, corresponding to test acc:                         0.9726071357727051 / 0.9755075573921204
after epoch: 21,now: 2024-05-27 02:28:53.046548,epoch time: 0:15:50.194054,used: 5:34:23.601230,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_20_54_29_seed_1_20863194
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9695712, 'precision': 0.75906914, 'recall': 0.8301922, 'specificity': 0.8301922, 'f1': 0.78985167, 'auroc': 0.96687555, 'binary_precision': 0.5290948, 'binary_recall': 0.6809986, 'binary_specificity': 0.9793858, 'binary_f1_score': 0.5955124}
confusion matrix:
       0    1
0  41524  874
1    460  982
---- Validation: 
scalar performance:
{'acc': 0.9667556, 'precision': 0.758901, 'recall': 0.79535854, 'specificity': 0.79535854, 'f1': 0.7757847, 'auroc': 0.95430285, 'binary_precision': 0.53238344, 'binary_recall': 0.61069834, 'binary_specificity': 0.9800188, 'binary_f1_score': 0.56885815}
confusion matrix:
       0    1
0  17706  361
1    262  411
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9687399, 'precision': 0.818398, 'recall': 0.75933015, 'specificity': 0.75933015, 'f1': 0.78549445, 'auroc': 0.9464824, 'binary_precision': 0.6571429, 'binary_recall': 0.5307692, 'binary_specificity': 0.987891, 'binary_f1_score': 0.587234}
confusion matrix:
      0    1
0  5874   72
1   122  138
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863194.png
early stop counter: 13
val acc:0.9667556285858154, best validation acc: 0.9683564305305481, corresponding to test acc:                         0.9726071357727051 / 0.9755075573921204
after epoch: 22,now: 2024-05-27 02:44:43.784009,epoch time: 0:15:50.737461,used: 5:50:14.338691,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_20_54_29_seed_1_20863194
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.96731293, 'precision': 0.74646187, 'recall': 0.8613404, 'specificity': 0.8613404, 'f1': 0.7917306, 'auroc': 0.96643543, 'binary_precision': 0.5016302, 'binary_recall': 0.74791664, 'binary_specificity': 0.97476417, 'binary_f1_score': 0.60050184}
confusion matrix:
       0     1
0  41330  1070
1    363  1077
---- Validation: 
scalar performance:
{'acc': 0.96344715, 'precision': 0.7419549, 'recall': 0.85300994, 'specificity': 0.85300994, 'f1': 0.7857128, 'auroc': 0.95611936, 'binary_precision': 0.494, 'binary_recall': 0.73402673, 'binary_specificity': 0.97199315, 'binary_f1_score': 0.5905559}
confusion matrix:
       0    1
0  17561  506
1    179  494
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97164035, 'precision': 0.8372288, 'recall': 0.7847506, 'specificity': 0.7847506, 'f1': 0.8085257, 'auroc': 0.9519156, 'binary_precision': 0.69266057, 'binary_recall': 0.58076924, 'binary_specificity': 0.9887319, 'binary_f1_score': 0.63179916}
confusion matrix:
      0    1
0  5879   67
1   109  151
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863194.png
early stop counter: 14
val acc:0.9634471535682678, best validation acc: 0.9683564305305481, corresponding to test acc:                         0.9726071357727051 / 0.9755075573921204
after epoch: 23,now: 2024-05-27 03:00:33.544503,epoch time: 0:15:49.760494,used: 6:06:04.099185,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_20_54_29_seed_1_20863194
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.968864, 'precision': 0.7547091, 'recall': 0.8248024, 'specificity': 0.8248024, 'f1': 0.78503084, 'auroc': 0.9680544, 'binary_precision': 0.52073234, 'binary_recall': 0.6705964, 'binary_specificity': 0.97900844, 'binary_f1_score': 0.5862382}
confusion matrix:
       0    1
0  41508  890
1    475  967
---- Validation: 
scalar performance:
{'acc': 0.9659018, 'precision': 0.7535155, 'recall': 0.81065166, 'specificity': 0.81065166, 'f1': 0.7788265, 'auroc': 0.9542881, 'binary_precision': 0.5204327, 'binary_recall': 0.6433878, 'binary_specificity': 0.9779155, 'binary_f1_score': 0.5754153}
confusion matrix:
       0    1
0  17668  399
1    240  433
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9639059, 'precision': 0.7948097, 'recall': 0.677731, 'specificity': 0.677731, 'f1': 0.7201337, 'auroc': 0.94234616, 'binary_precision': 0.6168831, 'binary_recall': 0.3653846, 'binary_specificity': 0.9900774, 'binary_f1_score': 0.45893717}
confusion matrix:
      0   1
0  5887  59
1   165  95
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863194.png
early stop counter: 15
val acc:0.965901792049408, best validation acc: 0.9683564305305481, corresponding to test acc:                         0.9726071357727051 / 0.9755075573921204
after epoch: 24,now: 2024-05-27 03:16:26.825970,epoch time: 0:15:53.281467,used: 6:21:57.380652,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_20_54_29_seed_1_20863194
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9685903, 'precision': 0.75342155, 'recall': 0.8708029, 'specificity': 0.8708029, 'f1': 0.7997626, 'auroc': 0.9694842, 'binary_precision': 0.51492536, 'binary_recall': 0.7661346, 'binary_specificity': 0.97547114, 'binary_f1_score': 0.61589956}
confusion matrix:
       0     1
0  41359  1040
1    337  1104
---- Validation: 
scalar performance:
{'acc': 0.9648879, 'precision': 0.74862206, 'recall': 0.84660447, 'specificity': 0.84660447, 'f1': 0.78848684, 'auroc': 0.95844996, 'binary_precision': 0.5078699, 'binary_recall': 0.7191679, 'binary_specificity': 0.97404104, 'binary_f1_score': 0.59532595}
confusion matrix:
       0    1
0  17598  469
1    189  484
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.970029, 'precision': 0.81681395, 'recall': 0.8004606, 'specificity': 0.8004606, 'f1': 0.8083943, 'auroc': 0.9468583, 'binary_precision': 0.6504065, 'binary_recall': 0.61538464, 'binary_specificity': 0.9855365, 'binary_f1_score': 0.63241106}
confusion matrix:
      0    1
0  5860   86
1   100  160
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863194.png
early stop counter: 16
val acc:0.9648879170417786, best validation acc: 0.9683564305305481, corresponding to test acc:                         0.9726071357727051 / 0.9755075573921204
after epoch: 25,now: 2024-05-27 03:32:14.445424,epoch time: 0:15:47.619454,used: 6:37:45.000106,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_20_54_29_seed_1_20863194
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9699133, 'precision': 0.76044226, 'recall': 0.87677276, 'specificity': 0.87677276, 'f1': 0.80675125, 'auroc': 0.97220147, 'binary_precision': 0.52857816, 'binary_recall': 0.77708334, 'binary_specificity': 0.97646224, 'binary_f1_score': 0.6291819}
confusion matrix:
       0     1
0  41402   998
1    321  1119
---- Validation: 
scalar performance:
{'acc': 0.965635, 'precision': 0.752358, 'recall': 0.8434156, 'specificity': 0.8434156, 'f1': 0.7900264, 'auroc': 0.9607988, 'binary_precision': 0.5156082, 'binary_recall': 0.71173847, 'binary_specificity': 0.9750927, 'binary_f1_score': 0.5980025}
confusion matrix:
       0    1
0  17617  450
1    194  479
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9695456, 'precision': 0.83595353, 'recall': 0.73952174, 'specificity': 0.73952174, 'f1': 0.7787863, 'auroc': 0.94865716, 'binary_precision': 0.6939891, 'binary_recall': 0.48846152, 'binary_specificity': 0.9905819, 'binary_f1_score': 0.5733634}
confusion matrix:
      0    1
0  5890   56
1   133  127
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863194.png
early stop counter: 17
val acc:0.9656350016593933, best validation acc: 0.9683564305305481, corresponding to test acc:                         0.9726071357727051 / 0.9755075573921204
after epoch: 26,now: 2024-05-27 03:48:05.111840,epoch time: 0:15:50.666416,used: 6:53:35.666522,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_20_54_29_seed_1_20863194
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9689325, 'precision': 0.75506204, 'recall': 0.846511, 'specificity': 0.846511, 'f1': 0.7930273, 'auroc': 0.97047937, 'binary_precision': 0.51991934, 'binary_recall': 0.7154754, 'binary_specificity': 0.97754663, 'binary_f1_score': 0.60221964}
confusion matrix:
       0     1
0  41447   952
1    410  1031
---- Validation: 
scalar performance:
{'acc': 0.96600854, 'precision': 0.7543367, 'recall': 0.8457551, 'specificity': 0.8457551, 'f1': 0.7921847, 'auroc': 0.9587293, 'binary_precision': 0.51939654, 'binary_recall': 0.7161961, 'binary_specificity': 0.9753141, 'binary_f1_score': 0.6021237}
confusion matrix:
       0    1
0  17621  446
1    191  482
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9639059, 'precision': 0.8088954, 'recall': 0.6483072, 'specificity': 0.6483072, 'f1': 0.69749624, 'auroc': 0.9248102, 'binary_precision': 0.647541, 'binary_recall': 0.30384615, 'binary_specificity': 0.9927682, 'binary_f1_score': 0.41361254}
confusion matrix:
      0   1
0  5903  43
1   181  79
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863194.png
early stop counter: 18
val acc:0.9660085439682007, best validation acc: 0.9683564305305481, corresponding to test acc:                         0.9726071357727051 / 0.9755075573921204
after epoch: 27,now: 2024-05-27 04:03:53.883340,epoch time: 0:15:48.771500,used: 7:09:24.438022,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_20_54_29_seed_1_20863194
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.96993613, 'precision': 0.761068, 'recall': 0.84846807, 'specificity': 0.84846807, 'f1': 0.7977865, 'auroc': 0.96985173, 'binary_precision': 0.5318275, 'binary_recall': 0.7184466, 'binary_specificity': 0.9784896, 'binary_f1_score': 0.6112094}
confusion matrix:
       0     1
0  41486   912
1    406  1036
---- Validation: 
scalar performance:
{'acc': 0.965048, 'precision': 0.7493205, 'recall': 0.8423959, 'specificity': 0.8423959, 'f1': 0.78757966, 'auroc': 0.9588078, 'binary_precision': 0.50959486, 'binary_recall': 0.7102526, 'binary_specificity': 0.9745392, 'binary_f1_score': 0.5934202}
confusion matrix:
       0    1
0  17607  460
1    195  478
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650338, 'precision': 0.80605125, 'recall': 0.68567556, 'specificity': 0.68567556, 'f1': 0.7295103, 'auroc': 0.93027586, 'binary_precision': 0.63870966, 'binary_recall': 0.38076922, 'binary_specificity': 0.9905819, 'binary_f1_score': 0.47710842}
confusion matrix:
      0   1
0  5890  56
1   161  99
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863194.png
early stop counter: 19
val acc:0.9650480151176453, best validation acc: 0.9683564305305481, corresponding to test acc:                         0.9726071357727051 / 0.9755075573921204
after epoch: 28,now: 2024-05-27 04:19:42.356435,epoch time: 0:15:48.473095,used: 7:25:12.911117,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_20_54_29_seed_1_20863194
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9712591, 'precision': 0.7691803, 'recall': 0.8504919, 'specificity': 0.8504919, 'f1': 0.8039075, 'auroc': 0.9726783, 'binary_precision': 0.5479452, 'binary_recall': 0.72122055, 'binary_specificity': 0.9797632, 'binary_f1_score': 0.6227545}
confusion matrix:
       0     1
0  41540   858
1    402  1040
---- Validation: 
scalar performance:
{'acc': 0.9653148, 'precision': 0.75064504, 'recall': 0.8403885, 'specificity': 0.8403885, 'f1': 0.78781706, 'auroc': 0.95943165, 'binary_precision': 0.51240563, 'binary_recall': 0.70579493, 'binary_specificity': 0.974982, 'binary_f1_score': 0.59375}
confusion matrix:
       0    1
0  17615  452
1    198  475
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650338, 'precision': 0.8086096, 'recall': 0.6801586, 'specificity': 0.6801586, 'f1': 0.7256794, 'auroc': 0.93687415, 'binary_precision': 0.6442953, 'binary_recall': 0.36923078, 'binary_specificity': 0.9910864, 'binary_f1_score': 0.46943763}
confusion matrix:
      0   1
0  5893  53
1   164  96
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863194.png
early stop counter: 20
val acc:0.9653148055076599, best validation acc: 0.9683564305305481, corresponding to test acc:                         0.9726071357727051 / 0.9755075573921204
after epoch: 29,now: 2024-05-27 04:35:33.658772,epoch time: 0:15:51.302337,used: 7:41:04.213454,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_20_54_29_seed_1_20863194
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 29 with time: 7:41:04.213454 at 2024-05-27 04:35:33.658772
persisted model performance metric: 

scalar performance:
{'acc': 0.9742185, 'precision': 0.8682332, 'recall': 0.7805791, 'specificity': 0.7805791, 'f1': 0.81787026, 'auroc': 0.9392009, 'binary_precision': 0.75510204, 'binary_recall': 0.5692308, 'binary_specificity': 0.9919273, 'binary_f1_score': 0.64912283}
confusion matrix:
      0    1
0  5898   48
1   112  148
oracle model performance metric: 

scalar performance:
{'acc': 0.97454077, 'precision': 0.86064756, 'recall': 0.7991371, 'specificity': 0.7991371, 'f1': 0.8267158, 'auroc': 0.9284147, 'binary_precision': 0.7383177, 'binary_recall': 0.6076923, 'binary_specificity': 0.9905819, 'binary_f1_score': 0.6666667}
confusion matrix:
      0    1
0  5890   56
1   102  158
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs32/rule_results/10.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs32/confusion_matrix/10.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 487305 KiB |  21386 MiB |   2340 TiB |   2340 TiB |
|       from large pool | 398080 KiB |  21312 MiB |   2338 TiB |   2338 TiB |
|       from small pool |  89225 KiB |    123 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 487305 KiB |  21386 MiB |   2340 TiB |   2340 TiB |
|       from large pool | 398080 KiB |  21312 MiB |   2338 TiB |   2338 TiB |
|       from small pool |  89225 KiB |    123 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476570 KiB |  21360 MiB |   2337 TiB |   2337 TiB |
|       from large pool | 387840 KiB |  21287 MiB |   2334 TiB |   2334 TiB |
|       from small pool |  88730 KiB |    122 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  22048 MiB |  22048 MiB |  41450 MiB |  19402 MiB |
|       from large pool |  21924 MiB |  21924 MiB |  41302 MiB |  19378 MiB |
|       from small pool |    124 MiB |    124 MiB |    148 MiB |     24 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   2410 MiB |   3357 MiB |   1028 TiB |   1028 TiB |
|       from large pool |   2401 MiB |   3354 MiB |   1025 TiB |   1025 TiB |
|       from small pool |      8 MiB |     31 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    2541    |    3986    |  137294 K  |  137292 K  |
|       from large pool |      87    |     909    |   65842 K  |   65842 K  |
|       from small pool |    2454    |    3897    |   71452 K  |   71449 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2541    |    3986    |  137294 K  |  137292 K  |
|       from large pool |      87    |     909    |   65842 K  |   65842 K  |
|       from small pool |    2454    |    3897    |   71452 K  |   71449 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     285    |     285    |     489    |     204    |
|       from large pool |     223    |     223    |     415    |     192    |
|       from small pool |      62    |      62    |      74    |      12    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      90    |    1422    |   70140 K  |   70140 K  |
|       from large pool |      31    |     136    |   31268 K  |   31268 K  |
|       from small pool |      59    |    1389    |   38871 K  |   38871 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  21386 MiB |   2340 TiB |   2340 TiB |
|       from large pool |  16640 KiB |  21312 MiB |   2338 TiB |   2338 TiB |
|       from small pool |      0 KiB |    123 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  21386 MiB |   2340 TiB |   2340 TiB |
|       from large pool |  16640 KiB |  21312 MiB |   2338 TiB |   2338 TiB |
|       from small pool |      0 KiB |    123 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  21360 MiB |   2337 TiB |   2337 TiB |
|       from large pool |  16640 KiB |  21287 MiB |   2334 TiB |   2334 TiB |
|       from small pool |      0 KiB |    122 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2886 MiB |  22048 MiB |  41450 MiB |  38564 MiB |
|       from large pool |   2790 MiB |  21924 MiB |  41302 MiB |  38512 MiB |
|       from small pool |     96 MiB |    124 MiB |    148 MiB |     52 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 214784 KiB |   3357 MiB |   1028 TiB |   1028 TiB |
|       from large pool | 214784 KiB |   3354 MiB |   1025 TiB |   1025 TiB |
|       from small pool |      0 KiB |     31 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3986    |  137294 K  |  137294 K  |
|       from large pool |       2    |     909    |   65842 K  |   65842 K  |
|       from small pool |       0    |    3897    |   71452 K  |   71452 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3986    |  137294 K  |  137294 K  |
|       from large pool |       2    |     909    |   65842 K  |   65842 K  |
|       from small pool |       0    |    3897    |   71452 K  |   71452 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      81    |     285    |     489    |     408    |
|       from large pool |      33    |     223    |     415    |     382    |
|       from small pool |      48    |      62    |      74    |      26    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1422    |   70141 K  |   70141 K  |
|       from large pool |       3    |     136    |   31268 K  |   31268 K  |
|       from small pool |       0    |    1389    |   38872 K  |   38872 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Mon May 27 04:37:19 2024]
Finished job 0.
1 of 1 steps (100%) done
