Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sun May 26 12:25:42 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs32/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs32/rule_results/11.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=11
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863189

 Experiment start at: 2024-05-26 12:35:25.937060
before training, model accuracy: 0.2401725947856903
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9666027, 'precision': 0.7890032, 'recall': 0.50731754, 'specificity': 0.50731754, 'f1': 0.50611275, 'auroc': 0.891356, 'binary_precision': 0.6111111, 'binary_recall': 0.014965987, 'binary_specificity': 0.9996691, 'binary_f1_score': 0.029216468}
confusion matrix:
       0   1
0  42292  14
1   1448  22
---- Validation: 
scalar performance:
{'acc': 0.9657301, 'precision': 0.7163977, 'recall': 0.50522286, 'specificity': 0.50522286, 'f1': 0.50191814, 'auroc': 0.8826564, 'binary_precision': 0.46666667, 'binary_recall': 0.01088647, 'binary_specificity': 0.9995592, 'binary_f1_score': 0.021276597}
confusion matrix:
       0  1
0  18141  8
1    636  7
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.97983676, 'recall': 0.51724136, 'specificity': 0.51724136, 'f1': 0.5230443, 'auroc': 0.87936366, 'binary_precision': 1.0, 'binary_recall': 0.03448276, 'binary_specificity': 1.0, 'binary_f1_score': 0.06666667}
confusion matrix:
      0  1
0  5997  0
1   252  9
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863189.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-26 12:55:27.665064,epoch time: 0:20:01.728004,used: 0:20:01.728004,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863189
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9660088, 'precision': 0.72891814, 'recall': 0.5959843, 'specificity': 0.5959843, 'f1': 0.6325689, 'auroc': 0.91999865, 'binary_precision': 0.48509935, 'binary_recall': 0.19931974, 'binary_specificity': 0.9926488, 'binary_f1_score': 0.2825458}
confusion matrix:
       0    1
0  41995  311
1   1177  293
---- Validation: 
scalar performance:
{'acc': 0.9658365, 'precision': 0.7376077, 'recall': 0.6162861, 'specificity': 0.6162861, 'f1': 0.6540523, 'auroc': 0.9080974, 'binary_precision': 0.50161815, 'binary_recall': 0.24105754, 'binary_specificity': 0.9915147, 'binary_f1_score': 0.32563028}
confusion matrix:
       0    1
0  17995  154
1    488  155
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97347397, 'precision': 0.90447307, 'recall': 0.72596836, 'specificity': 0.72596836, 'f1': 0.7877017, 'auroc': 0.9041085, 'binary_precision': 0.8321678, 'binary_recall': 0.4559387, 'binary_specificity': 0.995998, 'binary_f1_score': 0.58910894}
confusion matrix:
      0    1
0  5973   24
1   142  119
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863189.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-05-26 13:11:41.599336,epoch time: 0:16:13.934272,used: 0:36:15.662276,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863189
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9661687, 'precision': 0.7347264, 'recall': 0.63603747, 'specificity': 0.63603747, 'f1': 0.6708888, 'auroc': 0.92547035, 'binary_precision': 0.4940476, 'binary_recall': 0.282121, 'binary_specificity': 0.98995394, 'binary_f1_score': 0.3591519}
confusion matrix:
       0    1
0  41880  425
1   1056  415
---- Validation: 
scalar performance:
{'acc': 0.9655172, 'precision': 0.7352315, 'recall': 0.6566238, 'specificity': 0.6566238, 'f1': 0.6871877, 'auroc': 0.91829026, 'binary_precision': 0.49408984, 'binary_recall': 0.32503888, 'binary_specificity': 0.9882087, 'binary_f1_score': 0.39212006}
confusion matrix:
       0    1
0  17935  214
1    434  209
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9755513, 'precision': 0.9043782, 'recall': 0.7582019, 'specificity': 0.7582019, 'f1': 0.813673, 'auroc': 0.91598624, 'binary_precision': 0.8292683, 'binary_recall': 0.5210728, 'binary_specificity': 0.995331, 'binary_f1_score': 0.64}
confusion matrix:
      0    1
0  5969   28
1   125  136
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863189.png
new oracle model saved
early stop counter: 1
val acc:0.9655172228813171, best validation acc: 0.9658365249633789, corresponding to test acc:                         0.9734739661216736 / 0.9755513072013855
after epoch: 3,now: 2024-05-26 13:27:42.221107,epoch time: 0:16:00.621771,used: 0:52:16.284047,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863189
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9671509, 'precision': 0.746467, 'recall': 0.7126092, 'specificity': 0.7126092, 'f1': 0.72815347, 'auroc': 0.92986757, 'binary_precision': 0.51229185, 'binary_recall': 0.43975493, 'binary_specificity': 0.9854634, 'binary_f1_score': 0.47326007}
confusion matrix:
       0    1
0  41692  615
1    823  646
---- Validation: 
scalar performance:
{'acc': 0.96647507, 'precision': 0.74603546, 'recall': 0.71637404, 'specificity': 0.71637404, 'f1': 0.7301469, 'auroc': 0.92256945, 'binary_precision': 0.5115453, 'binary_recall': 0.44790047, 'binary_specificity': 0.98484766, 'binary_f1_score': 0.47761196}
confusion matrix:
       0    1
0  17874  275
1    355  288
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97714925, 'precision': 0.8964464, 'recall': 0.79201764, 'specificity': 0.79201764, 'f1': 0.8355372, 'auroc': 0.91405725, 'binary_precision': 0.8105263, 'binary_recall': 0.5900383, 'binary_specificity': 0.993997, 'binary_f1_score': 0.6829268}
confusion matrix:
      0    1
0  5961   36
1   107  154
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863189.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-05-26 13:43:44.991791,epoch time: 0:16:02.770684,used: 1:08:19.054731,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863189
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96708244, 'precision': 0.746398, 'recall': 0.7006856, 'specificity': 0.7006856, 'f1': 0.720953, 'auroc': 0.9341175, 'binary_precision': 0.51301426, 'binary_recall': 0.41508153, 'binary_specificity': 0.98628974, 'binary_f1_score': 0.45888096}
confusion matrix:
       0    1
0  41724  580
1    861  611
---- Validation: 
scalar performance:
{'acc': 0.96722007, 'precision': 0.7528117, 'recall': 0.70775914, 'specificity': 0.70775914, 'f1': 0.7278435, 'auroc': 0.9194932, 'binary_precision': 0.5257143, 'binary_recall': 0.42923796, 'binary_specificity': 0.98628026, 'binary_f1_score': 0.47260275}
confusion matrix:
       0    1
0  17900  249
1    367  276
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97778845, 'precision': 0.8957071, 'recall': 0.80334514, 'specificity': 0.80334514, 'f1': 0.8428196, 'auroc': 0.9193047, 'binary_precision': 0.8080808, 'binary_recall': 0.6130268, 'binary_specificity': 0.9936635, 'binary_f1_score': 0.69716775}
confusion matrix:
      0    1
0  5959   38
1   101  160
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863189.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-05-26 13:59:55.921421,epoch time: 0:16:10.929630,used: 1:24:29.984361,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863189
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9674936, 'precision': 0.74980235, 'recall': 0.7279308, 'specificity': 0.7279308, 'f1': 0.73831105, 'auroc': 0.937075, 'binary_precision': 0.51793724, 'binary_recall': 0.47110808, 'binary_specificity': 0.98475355, 'binary_f1_score': 0.493414}
confusion matrix:
       0    1
0  41660  645
1    778  693
---- Validation: 
scalar performance:
{'acc': 0.9676458, 'precision': 0.75571656, 'recall': 0.7364816, 'specificity': 0.7364816, 'f1': 0.7456817, 'auroc': 0.92146105, 'binary_precision': 0.529511, 'binary_recall': 0.48833594, 'binary_specificity': 0.98462725, 'binary_f1_score': 0.5080906}
confusion matrix:
       0    1
0  17870  279
1    329  314
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9782678, 'precision': 0.88781947, 'recall': 0.8219186, 'specificity': 0.8219186, 'f1': 0.851495, 'auroc': 0.9181072, 'binary_precision': 0.7906977, 'binary_recall': 0.651341, 'binary_specificity': 0.99249625, 'binary_f1_score': 0.7142857}
confusion matrix:
      0    1
0  5952   45
1    91  170
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863189.png
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-05-26 14:16:01.396278,epoch time: 0:16:05.474857,used: 1:40:35.459218,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863189
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9682474, 'precision': 0.7551585, 'recall': 0.77851796, 'specificity': 0.77851796, 'f1': 0.7662693, 'auroc': 0.94686496, 'binary_precision': 0.5251397, 'binary_recall': 0.57511896, 'binary_specificity': 0.981917, 'binary_f1_score': 0.5489942}
confusion matrix:
       0    1
0  41540  765
1    625  846
---- Validation: 
scalar performance:
{'acc': 0.96631545, 'precision': 0.7459731, 'recall': 0.7822963, 'specificity': 0.7822963, 'f1': 0.7627368, 'auroc': 0.93289787, 'binary_precision': 0.50673854, 'binary_recall': 0.58475894, 'binary_specificity': 0.9798336, 'binary_f1_score': 0.54296035}
confusion matrix:
       0    1
0  17783  366
1    267  376
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97698945, 'precision': 0.872541, 'recall': 0.823084, 'specificity': 0.823084, 'f1': 0.84586686, 'auroc': 0.9274992, 'binary_precision': 0.76, 'binary_recall': 0.6551724, 'binary_specificity': 0.9909955, 'binary_f1_score': 0.70370376}
confusion matrix:
      0    1
0  5943   54
1    90  171
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863189.png
early stop counter: 1
val acc:0.9663154482841492, best validation acc: 0.9676458239555359, corresponding to test acc:                         0.9782677888870239 / 0.9782677888870239
after epoch: 7,now: 2024-05-26 14:31:57.465664,epoch time: 0:15:56.069386,used: 1:56:31.528604,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863189
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9676078, 'precision': 0.7504852, 'recall': 0.7704915, 'specificity': 0.7704915, 'f1': 0.7600605, 'auroc': 0.9420755, 'binary_precision': 0.5163317, 'binary_recall': 0.55918366, 'binary_specificity': 0.98179924, 'binary_f1_score': 0.53690404}
confusion matrix:
       0    1
0  41536  770
1    648  822
---- Validation: 
scalar performance:
{'acc': 0.9669008, 'precision': 0.74971807, 'recall': 0.77434874, 'specificity': 0.77434874, 'f1': 0.7613869, 'auroc': 0.93130344, 'binary_precision': 0.5148096, 'binary_recall': 0.5676516, 'binary_specificity': 0.9810458, 'binary_f1_score': 0.53994083}
confusion matrix:
       0    1
0  17805  344
1    278  365
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97698945, 'precision': 0.8674118, 'recall': 0.83224565, 'specificity': 0.83224565, 'f1': 0.8488487, 'auroc': 0.9336755, 'binary_precision': 0.7489362, 'binary_recall': 0.6743295, 'binary_specificity': 0.9901618, 'binary_f1_score': 0.70967746}
confusion matrix:
      0    1
0  5938   59
1    85  176
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863189.png
early stop counter: 2
val acc:0.9669008255004883, best validation acc: 0.9676458239555359, corresponding to test acc:                         0.9782677888870239 / 0.9782677888870239
after epoch: 8,now: 2024-05-26 14:47:54.860751,epoch time: 0:15:57.395087,used: 2:12:28.923691,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863189
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9679962, 'precision': 0.7539146, 'recall': 0.7457466, 'specificity': 0.7457466, 'f1': 0.74975646, 'auroc': 0.9436388, 'binary_precision': 0.5249473, 'binary_recall': 0.5074728, 'binary_specificity': 0.9840204, 'binary_f1_score': 0.5160621}
confusion matrix:
       0    1
0  41628  676
1    725  747
---- Validation: 
scalar performance:
{'acc': 0.9656237, 'precision': 0.7415461, 'recall': 0.780438, 'specificity': 0.780438, 'f1': 0.7593676, 'auroc': 0.9338638, 'binary_precision': 0.49800265, 'binary_recall': 0.5816485, 'binary_specificity': 0.9792275, 'binary_f1_score': 0.5365854}
confusion matrix:
       0    1
0  17772  377
1    269  374
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97778845, 'precision': 0.8873843, 'recall': 0.81433916, 'specificity': 0.81433916, 'f1': 0.8466716, 'auroc': 0.9370853, 'binary_precision': 0.7904762, 'binary_recall': 0.6360153, 'binary_specificity': 0.992663, 'binary_f1_score': 0.70488316}
confusion matrix:
      0    1
0  5953   44
1    95  166
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863189.png
early stop counter: 3
val acc:0.965623676776886, best validation acc: 0.9676458239555359, corresponding to test acc:                         0.9782677888870239 / 0.9782677888870239
after epoch: 9,now: 2024-05-26 15:03:50.727820,epoch time: 0:15:55.867069,used: 2:28:24.790760,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863189
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.96744794, 'precision': 0.7496767, 'recall': 0.78860307, 'specificity': 0.78860307, 'f1': 0.76756895, 'auroc': 0.94897175, 'binary_precision': 0.51345026, 'binary_recall': 0.59687287, 'binary_specificity': 0.98033327, 'binary_f1_score': 0.5520276}
confusion matrix:
       0    1
0  41473  832
1    593  878
---- Validation: 
scalar performance:
{'acc': 0.9656769, 'precision': 0.7418785, 'recall': 0.7804656, 'specificity': 0.7804656, 'f1': 0.75957423, 'auroc': 0.9323946, 'binary_precision': 0.49866667, 'binary_recall': 0.5816485, 'binary_specificity': 0.9792826, 'binary_f1_score': 0.53697056}
confusion matrix:
       0    1
0  17773  376
1    269  374
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9753915, 'precision': 0.84823865, 'recall': 0.84057355, 'specificity': 0.84057355, 'f1': 0.84435856, 'auroc': 0.9365075, 'binary_precision': 0.70980394, 'binary_recall': 0.6934866, 'binary_specificity': 0.98766047, 'binary_f1_score': 0.70155036}
confusion matrix:
      0    1
0  5923   74
1    80  181
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863189.png
early stop counter: 4
val acc:0.9656769037246704, best validation acc: 0.9676458239555359, corresponding to test acc:                         0.9782677888870239 / 0.9782677888870239
after epoch: 10,now: 2024-05-26 15:19:59.999553,epoch time: 0:16:09.271733,used: 2:44:34.062493,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863189
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96708244, 'precision': 0.74759924, 'recall': 0.7967471, 'specificity': 0.7967471, 'f1': 0.7696929, 'auroc': 0.9473335, 'binary_precision': 0.50872254, 'binary_recall': 0.61413044, 'binary_specificity': 0.9793637, 'binary_f1_score': 0.5564789}
confusion matrix:
       0    1
0  41431  873
1    568  904
---- Validation: 
scalar performance:
{'acc': 0.9657301, 'precision': 0.7432128, 'recall': 0.8074951, 'specificity': 0.8074951, 'f1': 0.7711399, 'auroc': 0.9366963, 'binary_precision': 0.499391, 'binary_recall': 0.63763607, 'binary_specificity': 0.9773541, 'binary_f1_score': 0.5601093}
confusion matrix:
       0    1
0  17738  411
1    233  410
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97619045, 'precision': 0.86050415, 'recall': 0.8299964, 'specificity': 0.8299964, 'f1': 0.84450185, 'auroc': 0.9401808, 'binary_precision': 0.7352941, 'binary_recall': 0.6704981, 'binary_specificity': 0.98949474, 'binary_f1_score': 0.7014028}
confusion matrix:
      0    1
0  5934   63
1    86  175
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863189.png
early stop counter: 5
val acc:0.9657300710678101, best validation acc: 0.9676458239555359, corresponding to test acc:                         0.9782677888870239 / 0.9782677888870239
after epoch: 11,now: 2024-05-26 15:35:58.568586,epoch time: 0:15:58.569033,used: 3:00:32.631526,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863189
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.96758497, 'precision': 0.7503776, 'recall': 0.78032917, 'specificity': 0.78032917, 'f1': 0.7644111, 'auroc': 0.95005274, 'binary_precision': 0.5154265, 'binary_recall': 0.5795918, 'binary_specificity': 0.9810665, 'binary_f1_score': 0.5456292}
confusion matrix:
       0    1
0  41505  801
1    618  852
---- Validation: 
scalar performance:
{'acc': 0.96647507, 'precision': 0.7471094, 'recall': 0.7876293, 'specificity': 0.7876293, 'f1': 0.76565075, 'auroc': 0.93563366, 'binary_precision': 0.5086321, 'binary_recall': 0.5956454, 'binary_specificity': 0.9796132, 'binary_f1_score': 0.5487105}
confusion matrix:
       0    1
0  17779  370
1    260  383
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97363377, 'precision': 0.840795, 'recall': 0.81950074, 'specificity': 0.81950074, 'f1': 0.82976496, 'auroc': 0.9351727, 'binary_precision': 0.6967213, 'binary_recall': 0.651341, 'binary_specificity': 0.98766047, 'binary_f1_score': 0.67326736}
confusion matrix:
      0    1
0  5923   74
1    91  170
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863189.png
early stop counter: 6
val acc:0.9664750695228577, best validation acc: 0.9676458239555359, corresponding to test acc:                         0.9782677888870239 / 0.9782677888870239
after epoch: 12,now: 2024-05-26 15:51:51.745783,epoch time: 0:15:53.177197,used: 3:16:25.808723,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863189
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9679048, 'precision': 0.7527528, 'recall': 0.80557185, 'specificity': 0.80557185, 'f1': 0.7763729, 'auroc': 0.95552874, 'binary_precision': 0.51841515, 'binary_recall': 0.63154316, 'binary_specificity': 0.97960055, 'binary_f1_score': 0.5694146}
confusion matrix:
       0    1
0  41442  863
1    542  929
---- Validation: 
scalar performance:
{'acc': 0.9669008, 'precision': 0.7502296, 'recall': 0.81710184, 'specificity': 0.81710184, 'f1': 0.7792474, 'auroc': 0.9389591, 'binary_precision': 0.5127582, 'binary_recall': 0.6562986, 'binary_specificity': 0.9779051, 'binary_f1_score': 0.5757162}
confusion matrix:
       0    1
0  17748  401
1    221  422
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97331417, 'precision': 0.8473237, 'recall': 0.797346, 'specificity': 0.797346, 'f1': 0.82018286, 'auroc': 0.9367238, 'binary_precision': 0.7117117, 'binary_recall': 0.60536397, 'binary_specificity': 0.989328, 'binary_f1_score': 0.65424424}
confusion matrix:
      0    1
0  5933   64
1   103  158
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863189.png
early stop counter: 7
val acc:0.9669008255004883, best validation acc: 0.9676458239555359, corresponding to test acc:                         0.9782677888870239 / 0.9782677888870239
after epoch: 13,now: 2024-05-26 16:07:44.659860,epoch time: 0:15:52.914077,used: 3:32:18.722800,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863189
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96719664, 'precision': 0.7481035, 'recall': 0.79982734, 'specificity': 0.79982734, 'f1': 0.7712366, 'auroc': 0.95611703, 'binary_precision': 0.5094972, 'binary_recall': 0.6204082, 'binary_specificity': 0.97924644, 'binary_f1_score': 0.5595092}
confusion matrix:
       0    1
0  41428  878
1    558  912
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.74376184, 'recall': 0.8142731, 'specificity': 0.8142731, 'f1': 0.77401185, 'auroc': 0.94001806, 'binary_precision': 0.5, 'binary_recall': 0.65163296, 'binary_specificity': 0.97691333, 'binary_f1_score': 0.56583387}
confusion matrix:
       0    1
0  17730  419
1    224  419
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9701182, 'precision': 0.8367389, 'recall': 0.7480378, 'specificity': 0.7480378, 'f1': 0.7849332, 'auroc': 0.93643564, 'binary_precision': 0.69473684, 'binary_recall': 0.50574714, 'binary_specificity': 0.9903285, 'binary_f1_score': 0.58536583}
confusion matrix:
      0    1
0  5939   58
1   129  132
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863189.png
early stop counter: 8
val acc:0.9657832980155945, best validation acc: 0.9676458239555359, corresponding to test acc:                         0.9782677888870239 / 0.9782677888870239
after epoch: 14,now: 2024-05-26 16:23:37.413874,epoch time: 0:15:52.754014,used: 3:48:11.476814,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863189
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.96584886, 'precision': 0.7406851, 'recall': 0.809223, 'specificity': 0.809223, 'f1': 0.77016133, 'auroc': 0.9583212, 'binary_precision': 0.4939822, 'binary_recall': 0.6413044, 'binary_specificity': 0.9771416, 'binary_f1_score': 0.55808455}
confusion matrix:
       0    1
0  41337  967
1    528  944
---- Validation: 
scalar performance:
{'acc': 0.9650915, 'precision': 0.74029803, 'recall': 0.82141554, 'specificity': 0.82141554, 'f1': 0.77426195, 'auroc': 0.9445559, 'binary_precision': 0.49253732, 'binary_recall': 0.66718507, 'binary_specificity': 0.975646, 'binary_f1_score': 0.5667107}
confusion matrix:
       0    1
0  17707  442
1    214  429
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96740174, 'precision': 0.8029096, 'recall': 0.7649438, 'specificity': 0.7649438, 'f1': 0.7825034, 'auroc': 0.93465185, 'binary_precision': 0.6255507, 'binary_recall': 0.5440613, 'binary_specificity': 0.98582625, 'binary_f1_score': 0.5819673}
confusion matrix:
      0    1
0  5912   85
1   119  142
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863189.png
early stop counter: 9
val acc:0.9650915265083313, best validation acc: 0.9676458239555359, corresponding to test acc:                         0.9782677888870239 / 0.9782677888870239
after epoch: 15,now: 2024-05-26 16:39:37.475920,epoch time: 0:16:00.062046,used: 4:04:11.538860,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863189
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9676307, 'precision': 0.75107515, 'recall': 0.79571927, 'specificity': 0.79571927, 'f1': 0.7713628, 'auroc': 0.956558, 'binary_precision': 0.5157593, 'binary_recall': 0.61141306, 'binary_specificity': 0.98002553, 'binary_f1_score': 0.5595275}
confusion matrix:
       0    1
0  41459  845
1    572  900
---- Validation: 
scalar performance:
{'acc': 0.96599615, 'precision': 0.7448411, 'recall': 0.81063306, 'specificity': 0.81063306, 'f1': 0.77336234, 'auroc': 0.9406576, 'binary_precision': 0.50242716, 'binary_recall': 0.64385694, 'binary_specificity': 0.97740924, 'binary_f1_score': 0.5644172}
confusion matrix:
       0    1
0  17739  410
1    229  414
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9713966, 'precision': 0.8416602, 'recall': 0.76702815, 'specificity': 0.76702815, 'f1': 0.7992699, 'auroc': 0.9459979, 'binary_precision': 0.7029703, 'binary_recall': 0.5440613, 'binary_specificity': 0.989995, 'binary_f1_score': 0.6133909}
confusion matrix:
      0    1
0  5937   60
1   119  142
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863189.png
early stop counter: 10
val acc:0.9659961462020874, best validation acc: 0.9676458239555359, corresponding to test acc:                         0.9782677888870239 / 0.9782677888870239
after epoch: 16,now: 2024-05-26 16:55:37.587860,epoch time: 0:16:00.111940,used: 4:20:11.650800,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863189
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9669682, 'precision': 0.7479918, 'recall': 0.8541193, 'specificity': 0.8541193, 'f1': 0.79055464, 'auroc': 0.96087265, 'binary_precision': 0.50539654, 'binary_recall': 0.7331518, 'binary_specificity': 0.97508687, 'binary_f1_score': 0.59833336}
confusion matrix:
       0     1
0  41253  1054
1    392  1077
---- Validation: 
scalar performance:
{'acc': 0.9657301, 'precision': 0.7450569, 'recall': 0.85699874, 'specificity': 0.85699874, 'f1': 0.7892982, 'auroc': 0.94787645, 'binary_precision': 0.49947533, 'binary_recall': 0.7402799, 'binary_specificity': 0.9737176, 'binary_f1_score': 0.59649116}
confusion matrix:
       0    1
0  17672  477
1    167  476
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9758709, 'precision': 0.85168874, 'recall': 0.842656, 'specificity': 0.842656, 'f1': 0.84710693, 'auroc': 0.94074494, 'binary_precision': 0.71653545, 'binary_recall': 0.697318, 'binary_specificity': 0.987994, 'binary_f1_score': 0.70679617}
confusion matrix:
      0    1
0  5925   72
1    79  182
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863189.png
early stop counter: 11
val acc:0.9657300710678101, best validation acc: 0.9676458239555359, corresponding to test acc:                         0.9782677888870239 / 0.9782677888870239
after epoch: 17,now: 2024-05-26 17:11:36.454191,epoch time: 0:15:58.866331,used: 4:36:10.517131,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863189
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9687728, 'precision': 0.7584467, 'recall': 0.80175585, 'specificity': 0.80175585, 'f1': 0.7782366, 'auroc': 0.96142566, 'binary_precision': 0.5300926, 'binary_recall': 0.62270564, 'binary_specificity': 0.98080605, 'binary_f1_score': 0.572679}
confusion matrix:
       0    1
0  41493  812
1    555  916
---- Validation: 
scalar performance:
{'acc': 0.9672733, 'precision': 0.7524632, 'recall': 0.821045, 'specificity': 0.821045, 'f1': 0.78215945, 'auroc': 0.94577676, 'binary_precision': 0.5169492, 'binary_recall': 0.66407466, 'binary_specificity': 0.9780153, 'binary_f1_score': 0.5813479}
confusion matrix:
       0    1
0  17750  399
1    216  427
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9688399, 'precision': 0.82847863, 'recall': 0.7345445, 'specificity': 0.7345445, 'f1': 0.77282166, 'auroc': 0.93853235, 'binary_precision': 0.6793478, 'binary_recall': 0.4789272, 'binary_specificity': 0.9901618, 'binary_f1_score': 0.56179774}
confusion matrix:
      0    1
0  5938   59
1   136  125
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863189.png
early stop counter: 12
val acc:0.9672732949256897, best validation acc: 0.9676458239555359, corresponding to test acc:                         0.9782677888870239 / 0.9782677888870239
after epoch: 18,now: 2024-05-26 17:27:31.032600,epoch time: 0:15:54.578409,used: 4:52:05.095540,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863189
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.96669406, 'precision': 0.745582, 'recall': 0.8186097, 'specificity': 0.8186097, 'f1': 0.7767993, 'auroc': 0.96126413, 'binary_precision': 0.503112, 'binary_recall': 0.65986395, 'binary_specificity': 0.9773555, 'binary_f1_score': 0.57092404}
confusion matrix:
       0    1
0  41348  958
1    500  970
---- Validation: 
scalar performance:
{'acc': 0.9655172, 'precision': 0.7428889, 'recall': 0.8291365, 'specificity': 0.8291365, 'f1': 0.7786947, 'auroc': 0.9481658, 'binary_precision': 0.49716875, 'binary_recall': 0.6827372, 'binary_specificity': 0.97553587, 'binary_f1_score': 0.5753604}
confusion matrix:
       0    1
0  17705  444
1    204  439
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96756154, 'precision': 0.8129271, 'recall': 0.73754215, 'specificity': 0.73754215, 'f1': 0.7694824, 'auroc': 0.9388546, 'binary_precision': 0.6479592, 'binary_recall': 0.48659003, 'binary_specificity': 0.9884942, 'binary_f1_score': 0.5557987}
confusion matrix:
      0    1
0  5928   69
1   134  127
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863189.png
early stop counter: 13
val acc:0.9655172228813171, best validation acc: 0.9676458239555359, corresponding to test acc:                         0.9782677888870239 / 0.9782677888870239
after epoch: 19,now: 2024-05-26 17:43:28.766857,epoch time: 0:15:57.734257,used: 5:08:02.829797,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863189
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.96708244, 'precision': 0.74766386, 'recall': 0.80613065, 'specificity': 0.80613065, 'f1': 0.7734448, 'auroc': 0.9614329, 'binary_precision': 0.50817883, 'binary_recall': 0.6335826, 'binary_specificity': 0.97867864, 'binary_f1_score': 0.56399393}
confusion matrix:
       0    1
0  41403  902
1    539  932
---- Validation: 
scalar performance:
{'acc': 0.96647507, 'precision': 0.74767065, 'recall': 0.8131312, 'specificity': 0.8131312, 'f1': 0.7761152, 'auroc': 0.94782287, 'binary_precision': 0.50791717, 'binary_recall': 0.64852256, 'binary_specificity': 0.9777398, 'binary_f1_score': 0.5696721}
confusion matrix:
       0    1
0  17745  404
1    226  417
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96708214, 'precision': 0.8281236, 'recall': 0.693316, 'specificity': 0.693316, 'f1': 0.7414904, 'auroc': 0.93107414, 'binary_precision': 0.6821192, 'binary_recall': 0.394636, 'binary_specificity': 0.991996, 'binary_f1_score': 0.5}
confusion matrix:
      0    1
0  5949   48
1   158  103
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863189.png
early stop counter: 14
val acc:0.9664750695228577, best validation acc: 0.9676458239555359, corresponding to test acc:                         0.9782677888870239 / 0.9782677888870239
after epoch: 20,now: 2024-05-26 17:59:29.772621,epoch time: 0:16:01.005764,used: 5:24:03.835561,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863189
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9676535, 'precision': 0.7515123, 'recall': 0.8339853, 'specificity': 0.8339853, 'f1': 0.7862454, 'auroc': 0.96292907, 'binary_precision': 0.51390994, 'binary_recall': 0.6906866, 'binary_specificity': 0.977284, 'binary_f1_score': 0.5893271}
confusion matrix:
       0     1
0  41344   961
1    455  1016
---- Validation: 
scalar performance:
{'acc': 0.9667944, 'precision': 0.7502208, 'recall': 0.84854907, 'specificity': 0.84854907, 'f1': 0.7903101, 'auroc': 0.9486499, 'binary_precision': 0.510451, 'binary_recall': 0.7216174, 'binary_specificity': 0.97548074, 'binary_f1_score': 0.5979381}
confusion matrix:
       0    1
0  17704  445
1    179  464
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97219557, 'precision': 0.8495589, 'recall': 0.76927733, 'specificity': 0.76927733, 'f1': 0.80365324, 'auroc': 0.93623614, 'binary_precision': 0.71859294, 'binary_recall': 0.54789275, 'binary_specificity': 0.990662, 'binary_f1_score': 0.62173915}
confusion matrix:
      0    1
0  5941   56
1   118  143
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863189.png
early stop counter: 15
val acc:0.9667943716049194, best validation acc: 0.9676458239555359, corresponding to test acc:                         0.9782677888870239 / 0.9782677888870239
after epoch: 21,now: 2024-05-26 18:15:33.488678,epoch time: 0:16:03.716057,used: 5:40:07.551618,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863189
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.96705955, 'precision': 0.74885726, 'recall': 0.85607696, 'specificity': 0.85607696, 'f1': 0.7917981, 'auroc': 0.96450084, 'binary_precision': 0.5070093, 'binary_recall': 0.7370924, 'binary_specificity': 0.9750615, 'binary_f1_score': 0.6007752}
confusion matrix:
       0     1
0  41249  1055
1    387  1085
---- Validation: 
scalar performance:
{'acc': 0.96546406, 'precision': 0.7439675, 'recall': 0.8621114, 'specificity': 0.8621114, 'f1': 0.79004955, 'auroc': 0.95034146, 'binary_precision': 0.49691358, 'binary_recall': 0.7511664, 'binary_specificity': 0.9730564, 'binary_f1_score': 0.5981424}
confusion matrix:
       0    1
0  17660  489
1    160  483
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97235537, 'precision': 0.84933364, 'recall': 0.7730254, 'specificity': 0.7730254, 'f1': 0.8059983, 'auroc': 0.94685835, 'binary_precision': 0.7178218, 'binary_recall': 0.5555556, 'binary_specificity': 0.99049526, 'binary_f1_score': 0.62634987}
confusion matrix:
      0    1
0  5940   57
1   116  145
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863189.png
early stop counter: 16
val acc:0.9654640555381775, best validation acc: 0.9676458239555359, corresponding to test acc:                         0.9782677888870239 / 0.9782677888870239
after epoch: 22,now: 2024-05-26 18:31:31.215504,epoch time: 0:15:57.726826,used: 5:56:05.278444,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863189
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9682703, 'precision': 0.7550564, 'recall': 0.82216525, 'specificity': 0.82216525, 'f1': 0.784253, 'auroc': 0.9639971, 'binary_precision': 0.521855, 'binary_recall': 0.66553366, 'binary_specificity': 0.97879684, 'binary_f1_score': 0.58500147}
confusion matrix:
       0    1
0  41408  897
1    492  979
---- Validation: 
scalar performance:
{'acc': 0.9668476, 'precision': 0.75005925, 'recall': 0.8253249, 'specificity': 0.8253249, 'f1': 0.7821692, 'auroc': 0.94890803, 'binary_precision': 0.5118203, 'binary_recall': 0.6734059, 'binary_specificity': 0.9772439, 'binary_f1_score': 0.5815984}
confusion matrix:
       0    1
0  17736  413
1    210  433
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645254, 'precision': 0.800212, 'recall': 0.6791557, 'specificity': 0.6791557, 'f1': 0.72271204, 'auroc': 0.935163, 'binary_precision': 0.627451, 'binary_recall': 0.3678161, 'binary_specificity': 0.99049526, 'binary_f1_score': 0.46376812}
confusion matrix:
      0   1
0  5940  57
1   165  96
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863189.png
early stop counter: 17
val acc:0.9668475985527039, best validation acc: 0.9676458239555359, corresponding to test acc:                         0.9782677888870239 / 0.9782677888870239
after epoch: 23,now: 2024-05-26 18:47:02.419836,epoch time: 0:15:31.204332,used: 6:11:36.482776,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863189
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.97014344, 'precision': 0.76713574, 'recall': 0.81985354, 'specificity': 0.81985354, 'f1': 0.79086185, 'auroc': 0.96590096, 'binary_precision': 0.5462232, 'binary_recall': 0.6587356, 'binary_specificity': 0.9809715, 'binary_f1_score': 0.5972265}
confusion matrix:
       0    1
0  41500  805
1    502  969
---- Validation: 
scalar performance:
{'acc': 0.96812475, 'precision': 0.75749314, 'recall': 0.8334867, 'specificity': 0.8334867, 'f1': 0.79001987, 'auroc': 0.9498047, 'binary_precision': 0.5261283, 'binary_recall': 0.688958, 'binary_specificity': 0.9780153, 'binary_f1_score': 0.596633}
confusion matrix:
       0    1
0  17750  399
1    200  443
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9683605, 'precision': 0.8457792, 'recall': 0.6958153, 'specificity': 0.6958153, 'f1': 0.7479826, 'auroc': 0.94648665, 'binary_precision': 0.7172414, 'binary_recall': 0.39846742, 'binary_specificity': 0.9931632, 'binary_f1_score': 0.5123153}
confusion matrix:
      0    1
0  5956   41
1   157  104
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863189.png
better model found
persisted
after epoch: 24,now: 2024-05-26 19:02:27.170690,epoch time: 0:15:24.750854,used: 6:27:01.233630,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863189
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9674936, 'precision': 0.750702, 'recall': 0.83948004, 'specificity': 0.83948004, 'f1': 0.78760946, 'auroc': 0.9657681, 'binary_precision': 0.511893, 'binary_recall': 0.7022434, 'binary_specificity': 0.9767167, 'binary_f1_score': 0.59214675}
confusion matrix:
       0     1
0  41320   985
1    438  1033
---- Validation: 
scalar performance:
{'acc': 0.9663687, 'precision': 0.74786735, 'recall': 0.8438283, 'specificity': 0.8438283, 'f1': 0.7870966, 'auroc': 0.9538379, 'binary_precision': 0.50607735, 'binary_recall': 0.7122862, 'binary_specificity': 0.9753705, 'binary_f1_score': 0.5917313}
confusion matrix:
       0    1
0  17702  447
1    185  458
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96628314, 'precision': 0.82453895, 'recall': 0.6800728, 'specificity': 0.6800728, 'f1': 0.72950375, 'auroc': 0.9274976, 'binary_precision': 0.6760563, 'binary_recall': 0.3678161, 'binary_specificity': 0.9923295, 'binary_f1_score': 0.4764268}
confusion matrix:
      0   1
0  5951  46
1   165  96
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863189.png
early stop counter: 1
val acc:0.9663686752319336, best validation acc: 0.9681247472763062, corresponding to test acc:                         0.9683604836463928 / 0.9782677888870239
after epoch: 25,now: 2024-05-26 19:17:34.560217,epoch time: 0:15:07.389527,used: 6:42:08.623157,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863189
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.96795046, 'precision': 0.7530526, 'recall': 0.8085482, 'specificity': 0.8085482, 'f1': 0.7777387, 'auroc': 0.965637, 'binary_precision': 0.5188053, 'binary_recall': 0.63766146, 'binary_specificity': 0.979435, 'binary_f1_score': 0.57212573}
confusion matrix:
       0    1
0  41435  870
1    533  938
---- Validation: 
scalar performance:
{'acc': 0.96674114, 'precision': 0.7494113, 'recall': 0.8230196, 'specificity': 0.8230196, 'f1': 0.7809056, 'auroc': 0.95237494, 'binary_precision': 0.51068884, 'binary_recall': 0.6687403, 'binary_specificity': 0.97729903, 'binary_f1_score': 0.5791246}
confusion matrix:
       0    1
0  17737  412
1    213  430
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96324706, 'precision': 0.796181, 'recall': 0.647339, 'specificity': 0.647339, 'f1': 0.694126, 'auroc': 0.931515, 'binary_precision': 0.62204725, 'binary_recall': 0.30268198, 'binary_specificity': 0.991996, 'binary_f1_score': 0.4072165}
confusion matrix:
      0   1
0  5949  48
1   182  79
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863189.png
early stop counter: 2
val acc:0.966741144657135, best validation acc: 0.9681247472763062, corresponding to test acc:                         0.9683604836463928 / 0.9782677888870239
after epoch: 26,now: 2024-05-26 19:32:56.820153,epoch time: 0:15:22.259936,used: 6:57:30.883093,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863189
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.96610016, 'precision': 0.7429372, 'recall': 0.82967997, 'specificity': 0.82967997, 'f1': 0.77893, 'auroc': 0.96494794, 'binary_precision': 0.49703556, 'binary_recall': 0.68342394, 'binary_specificity': 0.97593606, 'binary_f1_score': 0.5755149}
confusion matrix:
       0     1
0  41286  1018
1    466  1006
---- Validation: 
scalar performance:
{'acc': 0.9646126, 'precision': 0.7391943, 'recall': 0.8474195, 'specificity': 0.8474195, 'f1': 0.7820359, 'auroc': 0.9529224, 'binary_precision': 0.48842105, 'binary_recall': 0.7216174, 'binary_specificity': 0.97322166, 'binary_f1_score': 0.5825487}
confusion matrix:
       0    1
0  17663  486
1    179  464
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96180886, 'precision': 0.77043605, 'recall': 0.6685766, 'specificity': 0.6685766, 'f1': 0.7062719, 'auroc': 0.92470515, 'binary_precision': 0.56875, 'binary_recall': 0.348659, 'binary_specificity': 0.9884942, 'binary_f1_score': 0.43230405}
confusion matrix:
      0   1
0  5928  69
1   170  91
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863189.png
early stop counter: 3
val acc:0.964612603187561, best validation acc: 0.9681247472763062, corresponding to test acc:                         0.9683604836463928 / 0.9782677888870239
after epoch: 27,now: 2024-05-26 19:48:33.544725,epoch time: 0:15:36.724572,used: 7:13:07.607665,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863189
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9683617, 'precision': 0.75562286, 'recall': 0.84156954, 'specificity': 0.84156954, 'f1': 0.7916782, 'auroc': 0.96761274, 'binary_precision': 0.52160805, 'binary_recall': 0.7056424, 'binary_specificity': 0.97749674, 'binary_f1_score': 0.59982663}
confusion matrix:
       0     1
0  41353   952
1    433  1038
---- Validation: 
scalar performance:
{'acc': 0.96631545, 'precision': 0.74756646, 'recall': 0.8430507, 'specificity': 0.8430507, 'f1': 0.7866279, 'auroc': 0.9519299, 'binary_precision': 0.50553095, 'binary_recall': 0.71073097, 'binary_specificity': 0.9753705, 'binary_f1_score': 0.59082097}
confusion matrix:
       0    1
0  17702  447
1    186  457
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96212846, 'precision': 0.7838609, 'recall': 0.6357614, 'specificity': 0.6357614, 'f1': 0.68083376, 'auroc': 0.929726, 'binary_precision': 0.59836066, 'binary_recall': 0.27969348, 'binary_specificity': 0.9918293, 'binary_f1_score': 0.38120106}
confusion matrix:
      0   1
0  5948  49
1   188  73
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863189.png
early stop counter: 4
val acc:0.9663154482841492, best validation acc: 0.9681247472763062, corresponding to test acc:                         0.9683604836463928 / 0.9782677888870239
after epoch: 28,now: 2024-05-26 20:04:10.657134,epoch time: 0:15:37.112409,used: 7:28:44.720074,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863189
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.96893275, 'precision': 0.75866497, 'recall': 0.8475791, 'specificity': 0.8475791, 'f1': 0.7958344, 'auroc': 0.96824455, 'binary_precision': 0.52726364, 'binary_recall': 0.7174949, 'binary_specificity': 0.9776633, 'binary_f1_score': 0.6078431}
confusion matrix:
       0     1
0  41362   945
1    415  1054
---- Validation: 
scalar performance:
{'acc': 0.9665815, 'precision': 0.74904644, 'recall': 0.8461887, 'specificity': 0.8461887, 'f1': 0.7887054, 'auroc': 0.9508422, 'binary_precision': 0.508269, 'binary_recall': 0.7169518, 'binary_specificity': 0.97542566, 'binary_f1_score': 0.59483874}
confusion matrix:
       0    1
0  17703  446
1    182  461
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96356666, 'precision': 0.79079914, 'recall': 0.6713261, 'specificity': 0.6713261, 'f1': 0.71388257, 'auroc': 0.9274548, 'binary_precision': 0.6092715, 'binary_recall': 0.35249043, 'binary_specificity': 0.9901618, 'binary_f1_score': 0.44660193}
confusion matrix:
      0   1
0  5938  59
1   169  92
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863189.png
early stop counter: 5
val acc:0.9665815234184265, best validation acc: 0.9681247472763062, corresponding to test acc:                         0.9683604836463928 / 0.9782677888870239
after epoch: 29,now: 2024-05-26 20:19:43.075862,epoch time: 0:15:32.418728,used: 7:44:17.138802,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863189
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.96845305, 'precision': 0.75617886, 'recall': 0.82127553, 'specificity': 0.82127553, 'f1': 0.7846304, 'auroc': 0.96315384, 'binary_precision': 0.52416754, 'binary_recall': 0.6634942, 'binary_specificity': 0.97905684, 'binary_f1_score': 0.58565855}
confusion matrix:
       0    1
0  41419  886
1    495  976
---- Validation: 
scalar performance:
{'acc': 0.96753937, 'precision': 0.75409734, 'recall': 0.83318365, 'specificity': 0.83318365, 'f1': 0.78767145, 'auroc': 0.9503557, 'binary_precision': 0.5193435, 'binary_recall': 0.688958, 'binary_specificity': 0.97740924, 'binary_f1_score': 0.59224594}
confusion matrix:
       0    1
0  17739  410
1    200  443
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96212846, 'precision': 0.7753073, 'recall': 0.6632464, 'specificity': 0.6632464, 'f1': 0.70328414, 'auroc': 0.9312886, 'binary_precision': 0.57894737, 'binary_recall': 0.33716476, 'binary_specificity': 0.989328, 'binary_f1_score': 0.42615014}
confusion matrix:
      0   1
0  5933  64
1   173  88
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863189.png
early stop counter: 6
val acc:0.967539370059967, best validation acc: 0.9681247472763062, corresponding to test acc:                         0.9683604836463928 / 0.9782677888870239
after epoch: 30,now: 2024-05-26 20:35:14.984114,epoch time: 0:15:31.908252,used: 7:59:49.047054,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_25_seed_0_20863189
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 7:59:49.047054 at 2024-05-26 20:35:14.984114
persisted model performance metric: 

scalar performance:
{'acc': 0.9685203, 'precision': 0.84406024, 'recall': 0.70139575, 'specificity': 0.70139575, 'f1': 0.75220346, 'auroc': 0.93590665, 'binary_precision': 0.7133333, 'binary_recall': 0.4099617, 'binary_specificity': 0.99282974, 'binary_f1_score': 0.52068126}
confusion matrix:
      0    1
0  5954   43
1   154  107
oracle model performance metric: 

scalar performance:
{'acc': 0.9792266, 'precision': 0.90356785, 'recall': 0.81692183, 'specificity': 0.81692183, 'f1': 0.8545205, 'auroc': 0.92240375, 'binary_precision': 0.8226601, 'binary_recall': 0.63984674, 'binary_specificity': 0.993997, 'binary_f1_score': 0.7198276}
confusion matrix:
      0    1
0  5961   36
1    94  167
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs32/rule_results/11.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs32/rule_results/11.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs32/confusion_matrix/11.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 488335 KiB |  21386 MiB |   1187 TiB |   1187 TiB |
|       from large pool | 399104 KiB |  21312 MiB |   1185 TiB |   1185 TiB |
|       from small pool |  89231 KiB |    123 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 488335 KiB |  21386 MiB |   1187 TiB |   1187 TiB |
|       from large pool | 399104 KiB |  21312 MiB |   1185 TiB |   1185 TiB |
|       from small pool |  89231 KiB |    123 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476573 KiB |  21360 MiB |   1185 TiB |   1185 TiB |
|       from large pool | 387840 KiB |  21287 MiB |   1184 TiB |   1184 TiB |
|       from small pool |  88733 KiB |    122 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  22004 MiB |  22004 MiB |  22004 MiB |      0 B   |
|       from large pool |  21880 MiB |  21880 MiB |  21880 MiB |      0 B   |
|       from small pool |    124 MiB |    124 MiB |    124 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |   2123 MiB |   2696 MiB | 534124 GiB | 534122 GiB |
|       from large pool |   2112 MiB |   2693 MiB | 532625 GiB | 532623 GiB |
|       from small pool |     10 MiB |     13 MiB |   1499 GiB |   1499 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2553    |    3982    |   69655 K  |   69652 K  |
|       from large pool |      87    |     909    |   33390 K  |   33389 K  |
|       from small pool |    2466    |    3893    |   36265 K  |   36262 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2553    |    3982    |   69655 K  |   69652 K  |
|       from large pool |      87    |     909    |   33390 K  |   33389 K  |
|       from small pool |    2466    |    3893    |   36265 K  |   36262 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     285    |     285    |     285    |       0    |
|       from large pool |     223    |     223    |     223    |       0    |
|       from small pool |      62    |      62    |      62    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      88    |    1417    |   36879 K  |   36879 K  |
|       from large pool |      29    |     127    |   17058 K  |   17058 K  |
|       from small pool |      59    |    1387    |   19821 K  |   19821 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  21386 MiB |   1187 TiB |   1187 TiB |
|       from large pool |  16640 KiB |  21312 MiB |   1185 TiB |   1185 TiB |
|       from small pool |      0 KiB |    123 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  21386 MiB |   1187 TiB |   1187 TiB |
|       from large pool |  16640 KiB |  21312 MiB |   1185 TiB |   1185 TiB |
|       from small pool |      0 KiB |    123 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  21360 MiB |   1185 TiB |   1185 TiB |
|       from large pool |  16640 KiB |  21287 MiB |   1184 TiB |   1184 TiB |
|       from small pool |      0 KiB |    122 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2600 MiB |  22004 MiB |  22004 MiB |  19404 MiB |
|       from large pool |   2502 MiB |  21880 MiB |  21880 MiB |  19378 MiB |
|       from small pool |     98 MiB |    124 MiB |    124 MiB |     26 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 214784 KiB |   2696 MiB | 534125 GiB | 534125 GiB |
|       from large pool | 214784 KiB |   2693 MiB | 532625 GiB | 532625 GiB |
|       from small pool |      0 KiB |     25 MiB |   1499 GiB |   1499 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3982    |   69655 K  |   69655 K  |
|       from large pool |       2    |     909    |   33390 K  |   33390 K  |
|       from small pool |       0    |    3893    |   36265 K  |   36265 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3982    |   69655 K  |   69655 K  |
|       from large pool |       2    |     909    |   33390 K  |   33390 K  |
|       from small pool |       0    |    3893    |   36265 K  |   36265 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      80    |     285    |     285    |     205    |
|       from large pool |      31    |     223    |     223    |     192    |
|       from small pool |      49    |      62    |      62    |      13    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1417    |   36880 K  |   36880 K  |
|       from large pool |       3    |     127    |   17058 K  |   17058 K  |
|       from small pool |       0    |    1387    |   19821 K  |   19821 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  21386 MiB |   1187 TiB |   1187 TiB |
|       from large pool |  16640 KiB |  21312 MiB |   1185 TiB |   1185 TiB |
|       from small pool |      0 KiB |    123 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  21386 MiB |   1187 TiB |   1187 TiB |
|       from large pool |  16640 KiB |  21312 MiB |   1185 TiB |   1185 TiB |
|       from small pool |      0 KiB |    123 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  21360 MiB |   1185 TiB |   1185 TiB |
|       from large pool |  16640 KiB |  21287 MiB |   1184 TiB |   1184 TiB |
|       from small pool |      0 KiB |    122 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2600 MiB |  22004 MiB |  22004 MiB |  19404 MiB |
|       from large pool |   2502 MiB |  21880 MiB |  21880 MiB |  19378 MiB |
|       from small pool |     98 MiB |    124 MiB |    124 MiB |     26 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 214784 KiB |   2696 MiB | 534125 GiB | 534125 GiB |
|       from large pool | 214784 KiB |   2693 MiB | 532625 GiB | 532625 GiB |
|       from small pool |      0 KiB |     25 MiB |   1499 GiB |   1499 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3982    |   69655 K  |   69655 K  |
|       from large pool |       2    |     909    |   33390 K  |   33390 K  |
|       from small pool |       0    |    3893    |   36265 K  |   36265 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3982    |   69655 K  |   69655 K  |
|       from large pool |       2    |     909    |   33390 K  |   33390 K  |
|       from small pool |       0    |    3893    |   36265 K  |   36265 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      80    |     285    |     285    |     205    |
|       from large pool |      31    |     223    |     223    |     192    |
|       from small pool |      49    |      62    |      62    |      13    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1417    |   36880 K  |   36880 K  |
|       from large pool |       3    |     127    |   17058 K  |   17058 K  |
|       from small pool |       0    |    1387    |   19821 K  |   19821 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_20_44_27_seed_1_20863189

 Experiment start at: 2024-05-26 20:44:27.245990
before training, model accuracy: 0.09458588808774948
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96699363, 'precision': 0.67411345, 'recall': 0.50262064, 'specificity': 0.50262064, 'f1': 0.4970766, 'auroc': 0.8704717, 'binary_precision': 0.3809524, 'binary_recall': 0.0055478504, 'binary_specificity': 0.9996934, 'binary_f1_score': 0.0109364325}
confusion matrix:
       0   1
0  42385  13
1   1434   8
---- Validation: 
scalar performance:
{'acc': 0.9639808, 'precision': 0.7095625, 'recall': 0.5070973, 'specificity': 0.5070973, 'f1': 0.50521356, 'auroc': 0.8746306, 'binary_precision': 0.45454547, 'binary_recall': 0.014858841, 'binary_specificity': 0.9993358, 'binary_f1_score': 0.02877698}
confusion matrix:
       0   1
0  18055  12
1    663  10
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959233, 'precision': 0.924112, 'recall': 0.5153005, 'specificity': 0.5153005, 'f1': 0.5193222, 'auroc': 0.86976117, 'binary_precision': 0.8888889, 'binary_recall': 0.03076923, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.059479553}
confusion matrix:
      0  1
0  5945  1
1   252  8
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863189.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-26 21:00:48.469620,epoch time: 0:16:21.223630,used: 0:16:21.223630,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_20_44_27_seed_1_20863189
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96633214, 'precision': 0.70683295, 'recall': 0.544482, 'specificity': 0.544482, 'f1': 0.5682471, 'auroc': 0.90797794, 'binary_precision': 0.4437086, 'binary_recall': 0.09292649, 'binary_specificity': 0.99603754, 'binary_f1_score': 0.15366971}
confusion matrix:
       0    1
0  42230  168
1   1308  134
---- Validation: 
scalar performance:
{'acc': 0.9647279, 'precision': 0.7467668, 'recall': 0.6004695, 'specificity': 0.6004695, 'f1': 0.6397328, 'auroc': 0.9091065, 'binary_precision': 0.52238804, 'binary_recall': 0.20802377, 'binary_specificity': 0.9929153, 'binary_f1_score': 0.29755577}
confusion matrix:
       0    1
0  17939  128
1    533  140
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9624557, 'precision': 0.8644, 'recall': 0.57399094, 'specificity': 0.57399094, 'f1': 0.61577463, 'auroc': 0.8892225, 'binary_precision': 0.7647059, 'binary_recall': 0.15, 'binary_specificity': 0.99798185, 'binary_f1_score': 0.2508039}
confusion matrix:
      0   1
0  5934  12
1   221  39
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863189.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-05-26 21:16:18.776689,epoch time: 0:15:30.307069,used: 0:31:51.530699,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_20_44_27_seed_1_20863189
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9669252, 'precision': 0.7337796, 'recall': 0.6162762, 'specificity': 0.6162762, 'f1': 0.65337104, 'auroc': 0.9230887, 'binary_precision': 0.49289772, 'binary_recall': 0.24097222, 'binary_specificity': 0.9915802, 'binary_f1_score': 0.32369405}
confusion matrix:
       0    1
0  42043  357
1   1093  347
---- Validation: 
scalar performance:
{'acc': 0.96419424, 'precision': 0.74027437, 'recall': 0.7060523, 'specificity': 0.7060523, 'f1': 0.72169477, 'auroc': 0.9239303, 'binary_precision': 0.5017422, 'binary_recall': 0.42793462, 'binary_specificity': 0.98417, 'binary_f1_score': 0.46190858}
confusion matrix:
       0    1
0  17781  286
1    385  288
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9693845, 'precision': 0.8897202, 'recall': 0.6750731, 'specificity': 0.6750731, 'f1': 0.73809767, 'auroc': 0.9170263, 'binary_precision': 0.80701756, 'binary_recall': 0.35384616, 'binary_specificity': 0.99630004, 'binary_f1_score': 0.49197862}
confusion matrix:
      0   1
0  5924  22
1   168  92
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863189.png
new oracle model saved
early stop counter: 1
val acc:0.9641942381858826, best validation acc: 0.9647278785705566, corresponding to test acc:                         0.962455689907074 / 0.969384491443634
after epoch: 3,now: 2024-05-26 21:31:46.577621,epoch time: 0:15:27.800932,used: 0:47:19.331631,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_20_44_27_seed_1_20863189
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96731293, 'precision': 0.7410845, 'recall': 0.6571966, 'specificity': 0.6571966, 'f1': 0.68940794, 'auroc': 0.9294379, 'binary_precision': 0.5048439, 'binary_recall': 0.32524273, 'binary_specificity': 0.9891504, 'binary_f1_score': 0.39561367}
confusion matrix:
       0    1
0  41938  460
1    973  469
---- Validation: 
scalar performance:
{'acc': 0.9639808, 'precision': 0.7397869, 'recall': 0.73669815, 'specificity': 0.73669815, 'f1': 0.7382313, 'auroc': 0.9306495, 'binary_precision': 0.49849397, 'binary_recall': 0.49182764, 'binary_specificity': 0.98156863, 'binary_f1_score': 0.49513835}
confusion matrix:
       0    1
0  17734  333
1    342  331
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97212374, 'precision': 0.8901402, 'recall': 0.7187993, 'specificity': 0.7187993, 'f1': 0.7781569, 'auroc': 0.9116027, 'binary_precision': 0.8041958, 'binary_recall': 0.44230768, 'binary_specificity': 0.99529094, 'binary_f1_score': 0.5707196}
confusion matrix:
      0    1
0  5918   28
1   145  115
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863189.png
new oracle model saved
early stop counter: 2
val acc:0.9639807939529419, best validation acc: 0.9647278785705566, corresponding to test acc:                         0.962455689907074 / 0.9721237421035767
after epoch: 4,now: 2024-05-26 21:47:16.344345,epoch time: 0:15:29.766724,used: 1:02:49.098355,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_20_44_27_seed_1_20863189
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9678376, 'precision': 0.74698436, 'recall': 0.700676, 'specificity': 0.700676, 'f1': 0.72118354, 'auroc': 0.93636036, 'binary_precision': 0.5137457, 'binary_recall': 0.4147018, 'binary_specificity': 0.9866503, 'binary_f1_score': 0.45894092}
confusion matrix:
       0    1
0  41832  566
1    844  598
---- Validation: 
scalar performance:
{'acc': 0.9646211, 'precision': 0.74465966, 'recall': 0.749905, 'specificity': 0.749905, 'f1': 0.74725103, 'auroc': 0.93650925, 'binary_precision': 0.5072674, 'binary_recall': 0.5185735, 'binary_specificity': 0.9812365, 'binary_f1_score': 0.5128581}
confusion matrix:
       0    1
0  17728  339
1    324  349
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97550756, 'precision': 0.8970331, 'recall': 0.76653993, 'specificity': 0.76653993, 'f1': 0.8177302, 'auroc': 0.92707634, 'binary_precision': 0.81395346, 'binary_recall': 0.53846157, 'binary_specificity': 0.99461824, 'binary_f1_score': 0.6481482}
confusion matrix:
      0    1
0  5914   32
1   120  140
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863189.png
new oracle model saved
early stop counter: 3
val acc:0.9646211266517639, best validation acc: 0.9647278785705566, corresponding to test acc:                         0.962455689907074 / 0.9755075573921204
after epoch: 5,now: 2024-05-26 22:02:41.223149,epoch time: 0:15:24.878804,used: 1:18:13.977159,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_20_44_27_seed_1_20863189
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9676779, 'precision': 0.74539495, 'recall': 0.6737977, 'specificity': 0.6737977, 'f1': 0.7028569, 'auroc': 0.94072485, 'binary_precision': 0.512364, 'binary_recall': 0.3592233, 'binary_specificity': 0.9883721, 'binary_f1_score': 0.42233998}
confusion matrix:
       0    1
0  41905  493
1    924  518
---- Validation: 
scalar performance:
{'acc': 0.9645678, 'precision': 0.7440889, 'recall': 0.74129415, 'specificity': 0.74129415, 'f1': 0.74268246, 'auroc': 0.9395905, 'binary_precision': 0.5067669, 'binary_recall': 0.5007429, 'binary_specificity': 0.9818454, 'binary_f1_score': 0.5037369}
confusion matrix:
       0    1
0  17739  328
1    336  337
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9756687, 'precision': 0.9152297, 'recall': 0.7519121, 'specificity': 0.7519121, 'f1': 0.8117791, 'auroc': 0.92627037, 'binary_precision': 0.8516129, 'binary_recall': 0.50769234, 'binary_specificity': 0.99613184, 'binary_f1_score': 0.63614464}
confusion matrix:
      0    1
0  5923   23
1   128  132
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863189.png
new oracle model saved
early stop counter: 4
val acc:0.9645677804946899, best validation acc: 0.9647278785705566, corresponding to test acc:                         0.962455689907074 / 0.975668728351593
after epoch: 6,now: 2024-05-26 22:18:04.656271,epoch time: 0:15:23.433122,used: 1:33:37.410281,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_20_44_27_seed_1_20863189
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96845347, 'precision': 0.75317633, 'recall': 0.6871711, 'specificity': 0.6871711, 'f1': 0.7147281, 'auroc': 0.94448674, 'binary_precision': 0.5270142, 'binary_recall': 0.3861111, 'binary_specificity': 0.9882311, 'binary_f1_score': 0.4456914}
confusion matrix:
       0    1
0  41901  499
1    884  556
---- Validation: 
scalar performance:
{'acc': 0.9645678, 'precision': 0.74342585, 'recall': 0.7091071, 'specificity': 0.7091071, 'f1': 0.72481114, 'auroc': 0.94580865, 'binary_precision': 0.5078261, 'binary_recall': 0.43387815, 'binary_specificity': 0.9843361, 'binary_f1_score': 0.4679487}
confusion matrix:
       0    1
0  17784  283
1    381  292
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9761521, 'precision': 0.9067296, 'recall': 0.7668762, 'specificity': 0.7668762, 'f1': 0.82092786, 'auroc': 0.93415105, 'binary_precision': 0.8333333, 'binary_recall': 0.53846157, 'binary_specificity': 0.99529094, 'binary_f1_score': 0.65420556}
confusion matrix:
      0    1
0  5918   28
1   120  140
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863189.png
new oracle model saved
early stop counter: 5
val acc:0.9645677804946899, best validation acc: 0.9647278785705566, corresponding to test acc:                         0.962455689907074 / 0.9761521220207214
after epoch: 7,now: 2024-05-26 22:33:29.300963,epoch time: 0:15:24.644692,used: 1:49:02.054973,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_20_44_27_seed_1_20863189
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.967427, 'precision': 0.74460125, 'recall': 0.76778823, 'specificity': 0.76778823, 'f1': 0.7556106, 'auroc': 0.94866663, 'binary_precision': 0.5044192, 'binary_recall': 0.5540915, 'binary_specificity': 0.98148495, 'binary_f1_score': 0.5280899}
confusion matrix:
       0    1
0  41613  785
1    643  799
---- Validation: 
scalar performance:
{'acc': 0.9653682, 'precision': 0.7502341, 'recall': 0.79606956, 'specificity': 0.79606956, 'f1': 0.77098733, 'auroc': 0.9467151, 'binary_precision': 0.5149626, 'binary_recall': 0.6136701, 'binary_specificity': 0.978469, 'binary_f1_score': 0.55999994}
confusion matrix:
       0    1
0  17678  389
1    260  413
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9730905, 'precision': 0.837265, 'recall': 0.8186091, 'specificity': 0.8186091, 'f1': 0.8276408, 'auroc': 0.9385723, 'binary_precision': 0.6897959, 'binary_recall': 0.65, 'binary_specificity': 0.9872183, 'binary_f1_score': 0.66930693}
confusion matrix:
      0    1
0  5870   76
1    91  169
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863189.png
better model found
persisted
after epoch: 8,now: 2024-05-26 22:48:56.633230,epoch time: 0:15:27.332267,used: 2:04:29.387240,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_20_44_27_seed_1_20863189
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.96861315, 'precision': 0.7534957, 'recall': 0.7426106, 'specificity': 0.7426106, 'f1': 0.74792093, 'auroc': 0.94985735, 'binary_precision': 0.5239478, 'binary_recall': 0.5006935, 'binary_specificity': 0.9845276, 'binary_f1_score': 0.51205677}
confusion matrix:
       0    1
0  41742  656
1    720  722
---- Validation: 
scalar performance:
{'acc': 0.96542156, 'precision': 0.750406, 'recall': 0.7317232, 'specificity': 0.7317232, 'f1': 0.7406599, 'auroc': 0.9447268, 'binary_precision': 0.52012885, 'binary_recall': 0.47994056, 'binary_specificity': 0.98350585, 'binary_f1_score': 0.49922723}
confusion matrix:
       0    1
0  17769  298
1    350  323
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9742185, 'precision': 0.86244255, 'recall': 0.78977394, 'specificity': 0.78977394, 'f1': 0.8216294, 'auroc': 0.9454584, 'binary_precision': 0.74271846, 'binary_recall': 0.5884615, 'binary_specificity': 0.9910864, 'binary_f1_score': 0.65665233}
confusion matrix:
      0    1
0  5893   53
1   107  153
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863189.png
better model found
persisted
after epoch: 9,now: 2024-05-26 23:04:24.734590,epoch time: 0:15:28.101360,used: 2:19:57.488600,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_20_44_27_seed_1_20863189
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.96817976, 'precision': 0.7497536, 'recall': 0.7455653, 'specificity': 0.7455653, 'f1': 0.7476398, 'auroc': 0.9546002, 'binary_precision': 0.5162429, 'binary_recall': 0.5072866, 'binary_specificity': 0.983844, 'binary_f1_score': 0.51172554}
confusion matrix:
       0    1
0  41714  685
1    710  731
---- Validation: 
scalar performance:
{'acc': 0.9646211, 'precision': 0.744892, 'recall': 0.75991875, 'specificity': 0.75991875, 'f1': 0.752154, 'auroc': 0.9457935, 'binary_precision': 0.5069832, 'binary_recall': 0.5393759, 'binary_specificity': 0.9804616, 'binary_f1_score': 0.52267814}
confusion matrix:
       0    1
0  17714  353
1    310  363
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9732517, 'precision': 0.85491097, 'recall': 0.7837525, 'specificity': 0.7837525, 'f1': 0.8149405, 'auroc': 0.94691646, 'binary_precision': 0.7281553, 'binary_recall': 0.5769231, 'binary_specificity': 0.9905819, 'binary_f1_score': 0.64377683}
confusion matrix:
      0    1
0  5890   56
1   110  150
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863189.png
early stop counter: 1
val acc:0.9646211266517639, best validation acc: 0.9654215574264526, corresponding to test acc:                         0.974218487739563 / 0.9761521220207214
after epoch: 10,now: 2024-05-26 23:19:51.191964,epoch time: 0:15:26.457374,used: 2:35:23.945974,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_20_44_27_seed_1_20863189
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96815693, 'precision': 0.749918, 'recall': 0.7832383, 'specificity': 0.7832383, 'f1': 0.7654196, 'auroc': 0.9537543, 'binary_precision': 0.51400733, 'binary_recall': 0.5852982, 'binary_specificity': 0.98117834, 'binary_f1_score': 0.5473411}
confusion matrix:
       0    1
0  41600  798
1    598  844
---- Validation: 
scalar performance:
{'acc': 0.96403414, 'precision': 0.7416897, 'recall': 0.77606547, 'specificity': 0.77606547, 'f1': 0.75759107, 'auroc': 0.94987756, 'binary_precision': 0.49935317, 'binary_recall': 0.57355124, 'binary_specificity': 0.97857976, 'binary_f1_score': 0.5338866}
confusion matrix:
       0    1
0  17680  387
1    287  386
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9732517, 'precision': 0.8528988, 'recall': 0.78743047, 'specificity': 0.78743047, 'f1': 0.816454, 'auroc': 0.9487587, 'binary_precision': 0.72380954, 'binary_recall': 0.5846154, 'binary_specificity': 0.9902455, 'binary_f1_score': 0.6468085}
confusion matrix:
      0    1
0  5888   58
1   108  152
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863189.png
early stop counter: 2
val acc:0.9640341401100159, best validation acc: 0.9654215574264526, corresponding to test acc:                         0.974218487739563 / 0.9761521220207214
after epoch: 11,now: 2024-05-26 23:35:20.756459,epoch time: 0:15:29.564495,used: 2:50:53.510469,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_20_44_27_seed_1_20863189
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9683166, 'precision': 0.7509897, 'recall': 0.775617, 'specificity': 0.775617, 'f1': 0.76266325, 'auroc': 0.95695424, 'binary_precision': 0.51667714, 'binary_recall': 0.56934816, 'binary_specificity': 0.9818859, 'binary_f1_score': 0.5417355}
confusion matrix:
       0    1
0  41630  768
1    621  821
---- Validation: 
scalar performance:
{'acc': 0.96360725, 'precision': 0.7383652, 'recall': 0.76010823, 'specificity': 0.76010823, 'f1': 0.74870217, 'auroc': 0.94458634, 'binary_precision': 0.49389416, 'binary_recall': 0.5408618, 'binary_specificity': 0.9793546, 'binary_f1_score': 0.516312}
confusion matrix:
       0    1
0  17694  373
1    309  364
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9687399, 'precision': 0.82423985, 'recall': 0.74461824, 'specificity': 0.74461824, 'f1': 0.77823186, 'auroc': 0.93746525, 'binary_precision': 0.6701031, 'binary_recall': 0.5, 'binary_specificity': 0.9892365, 'binary_f1_score': 0.5726872}
confusion matrix:
      0    1
0  5882   64
1   130  130
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863189.png
early stop counter: 3
val acc:0.9636072516441345, best validation acc: 0.9654215574264526, corresponding to test acc:                         0.974218487739563 / 0.9761521220207214
after epoch: 12,now: 2024-05-26 23:50:42.111913,epoch time: 0:15:21.355454,used: 3:06:14.865923,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_20_44_27_seed_1_20863189
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9685903, 'precision': 0.75295913, 'recall': 0.77542365, 'specificity': 0.77542365, 'f1': 0.7636609, 'auroc': 0.95808715, 'binary_precision': 0.52063495, 'binary_recall': 0.56865466, 'binary_specificity': 0.9821926, 'binary_f1_score': 0.5435863}
confusion matrix:
       0    1
0  41643  755
1    622  820
---- Validation: 
scalar performance:
{'acc': 0.9641409, 'precision': 0.7417151, 'recall': 0.7589544, 'specificity': 0.7589544, 'f1': 0.7500007, 'auroc': 0.9485287, 'binary_precision': 0.5006916, 'binary_recall': 0.53789, 'binary_specificity': 0.9800188, 'binary_f1_score': 0.5186246}
confusion matrix:
       0    1
0  17706  361
1    311  362
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9722849, 'precision': 0.84933394, 'recall': 0.774053, 'specificity': 0.774053, 'f1': 0.8066561, 'auroc': 0.94305074, 'binary_precision': 0.7178218, 'binary_recall': 0.5576923, 'binary_specificity': 0.9904137, 'binary_f1_score': 0.6277056}
confusion matrix:
      0    1
0  5889   57
1   115  145
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863189.png
early stop counter: 4
val acc:0.9641408920288086, best validation acc: 0.9654215574264526, corresponding to test acc:                         0.974218487739563 / 0.9761521220207214
after epoch: 13,now: 2024-05-27 00:06:05.483755,epoch time: 0:15:23.371842,used: 3:21:38.237765,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_20_44_27_seed_1_20863189
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9680657, 'precision': 0.749074, 'recall': 0.75840497, 'specificity': 0.75840497, 'f1': 0.7536442, 'auroc': 0.9574298, 'binary_precision': 0.5140187, 'binary_recall': 0.5339806, 'binary_specificity': 0.9828294, 'binary_f1_score': 0.5238095}
confusion matrix:
       0    1
0  41670  728
1    672  770
---- Validation: 
scalar performance:
{'acc': 0.9639808, 'precision': 0.7406217, 'recall': 0.75744087, 'specificity': 0.75744087, 'f1': 0.7487116, 'auroc': 0.9479604, 'binary_precision': 0.49861497, 'binary_recall': 0.53491825, 'binary_specificity': 0.9799635, 'binary_f1_score': 0.516129}
confusion matrix:
       0    1
0  17705  362
1    313  360
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9709958, 'precision': 0.848068, 'recall': 0.74947345, 'specificity': 0.74947345, 'f1': 0.7897773, 'auroc': 0.9461721, 'binary_precision': 0.7173913, 'binary_recall': 0.50769234, 'binary_specificity': 0.9912546, 'binary_f1_score': 0.59459466}
confusion matrix:
      0    1
0  5894   52
1   128  132
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863189.png
early stop counter: 5
val acc:0.9639807939529419, best validation acc: 0.9654215574264526, corresponding to test acc:                         0.974218487739563 / 0.9761521220207214
after epoch: 14,now: 2024-05-27 00:21:31.421134,epoch time: 0:15:25.937379,used: 3:37:04.175144,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_20_44_27_seed_1_20863189
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9684763, 'precision': 0.7520026, 'recall': 0.79230976, 'specificity': 0.79230976, 'f1': 0.77049565, 'auroc': 0.96057475, 'binary_precision': 0.5175491, 'binary_recall': 0.60374737, 'binary_specificity': 0.9808722, 'binary_f1_score': 0.5573351}
confusion matrix:
       0    1
0  41588  811
1    571  870
---- Validation: 
scalar performance:
{'acc': 0.9636606, 'precision': 0.7394124, 'recall': 0.7751565, 'specificity': 0.7751565, 'f1': 0.7558836, 'auroc': 0.94744956, 'binary_precision': 0.49485862, 'binary_recall': 0.57206535, 'binary_specificity': 0.97824764, 'binary_f1_score': 0.5306685}
confusion matrix:
       0    1
0  17674  393
1    288  385
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9698679, 'precision': 0.82816255, 'recall': 0.7635968, 'specificity': 0.7635968, 'f1': 0.79195833, 'auroc': 0.94126296, 'binary_precision': 0.6763285, 'binary_recall': 0.53846157, 'binary_specificity': 0.9887319, 'binary_f1_score': 0.5995717}
confusion matrix:
      0    1
0  5879   67
1   120  140
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863189.png
early stop counter: 6
val acc:0.9636605978012085, best validation acc: 0.9654215574264526, corresponding to test acc:                         0.974218487739563 / 0.9761521220207214
after epoch: 15,now: 2024-05-27 00:37:01.647365,epoch time: 0:15:30.226231,used: 3:52:34.401375,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_20_44_27_seed_1_20863189
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.96799725, 'precision': 0.7491995, 'recall': 0.8082768, 'specificity': 0.8082768, 'f1': 0.7752466, 'auroc': 0.9569744, 'binary_precision': 0.51083934, 'binary_recall': 0.6373093, 'binary_specificity': 0.9792443, 'binary_f1_score': 0.56710887}
confusion matrix:
       0    1
0  41518  880
1    523  919
---- Validation: 
scalar performance:
{'acc': 0.96403414, 'precision': 0.7423569, 'recall': 0.7932319, 'specificity': 0.7932319, 'f1': 0.76506627, 'auroc': 0.94941175, 'binary_precision': 0.499391, 'binary_recall': 0.60921246, 'binary_specificity': 0.97725135, 'binary_f1_score': 0.5488621}
confusion matrix:
       0    1
0  17656  411
1    263  410
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97164035, 'precision': 0.8372288, 'recall': 0.7847506, 'specificity': 0.7847506, 'f1': 0.8085257, 'auroc': 0.9456142, 'binary_precision': 0.69266057, 'binary_recall': 0.58076924, 'binary_specificity': 0.9887319, 'binary_f1_score': 0.63179916}
confusion matrix:
      0    1
0  5879   67
1   109  151
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863189.png
early stop counter: 7
val acc:0.9640341401100159, best validation acc: 0.9654215574264526, corresponding to test acc:                         0.974218487739563 / 0.9761521220207214
after epoch: 16,now: 2024-05-27 00:52:30.806259,epoch time: 0:15:29.158894,used: 4:08:03.560269,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_20_44_27_seed_1_20863189
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9691378, 'precision': 0.756385, 'recall': 0.7941916, 'specificity': 0.7941916, 'f1': 0.77384615, 'auroc': 0.96104896, 'binary_precision': 0.526189, 'binary_recall': 0.60694444, 'binary_specificity': 0.9814387, 'binary_f1_score': 0.5636891}
confusion matrix:
       0    1
0  41613  787
1    566  874
---- Validation: 
scalar performance:
{'acc': 0.9644077, 'precision': 0.744062, 'recall': 0.77912027, 'specificity': 0.77912027, 'f1': 0.76026773, 'auroc': 0.94890034, 'binary_precision': 0.503876, 'binary_recall': 0.5794948, 'binary_specificity': 0.97874576, 'binary_f1_score': 0.53904635}
confusion matrix:
       0    1
0  17683  384
1    283  390
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9737351, 'precision': 0.87255186, 'recall': 0.76561487, 'specificity': 0.76561487, 'f1': 0.8092178, 'auroc': 0.94237304, 'binary_precision': 0.76502734, 'binary_recall': 0.53846157, 'binary_specificity': 0.9927682, 'binary_f1_score': 0.6320542}
confusion matrix:
      0    1
0  5903   43
1   120  140
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863189.png
early stop counter: 8
val acc:0.9644076824188232, best validation acc: 0.9654215574264526, corresponding to test acc:                         0.974218487739563 / 0.9761521220207214
after epoch: 17,now: 2024-05-27 01:07:55.956880,epoch time: 0:15:25.150621,used: 4:23:28.710890,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_20_44_27_seed_1_20863189
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9662409, 'precision': 0.7397902, 'recall': 0.8291403, 'specificity': 0.8291403, 'f1': 0.77659756, 'auroc': 0.9591952, 'binary_precision': 0.4905284, 'binary_recall': 0.68238556, 'binary_specificity': 0.9758951, 'binary_f1_score': 0.5707656}
confusion matrix:
       0     1
0  41376  1022
1    458   984
---- Validation: 
scalar performance:
{'acc': 0.9614728, 'precision': 0.7295383, 'recall': 0.8040631, 'specificity': 0.8040631, 'f1': 0.7608845, 'auroc': 0.9456886, 'binary_precision': 0.4728682, 'binary_recall': 0.6344725, 'binary_specificity': 0.9736536, 'binary_f1_score': 0.54187816}
confusion matrix:
       0    1
0  17591  476
1    246  427
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9709958, 'precision': 0.8268465, 'recall': 0.7954481, 'specificity': 0.7954481, 'f1': 0.8102622, 'auroc': 0.950375, 'binary_precision': 0.67094016, 'binary_recall': 0.60384613, 'binary_specificity': 0.9870501, 'binary_f1_score': 0.63562757}
confusion matrix:
      0    1
0  5869   77
1   103  157
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863189.png
early stop counter: 9
val acc:0.9614728093147278, best validation acc: 0.9654215574264526, corresponding to test acc:                         0.974218487739563 / 0.9761521220207214
after epoch: 18,now: 2024-05-27 01:23:26.275877,epoch time: 0:15:30.318997,used: 4:38:59.029887,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_20_44_27_seed_1_20863189
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9689781, 'precision': 0.75552493, 'recall': 0.7845247, 'specificity': 0.7845247, 'f1': 0.76916015, 'auroc': 0.9608705, 'binary_precision': 0.5251397, 'binary_recall': 0.5870923, 'binary_specificity': 0.98195714, 'binary_f1_score': 0.5543906}
confusion matrix:
       0    1
0  41634  765
1    595  846
---- Validation: 
scalar performance:
{'acc': 0.9653682, 'precision': 0.7500199, 'recall': 0.773181, 'specificity': 0.773181, 'f1': 0.7610246, 'auroc': 0.94595003, 'binary_precision': 0.51626015, 'binary_recall': 0.5661218, 'binary_specificity': 0.9802402, 'binary_f1_score': 0.5400425}
confusion matrix:
       0    1
0  17710  357
1    292  381
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9740574, 'precision': 0.8797127, 'recall': 0.7621051, 'specificity': 0.7621051, 'f1': 0.80906713, 'auroc': 0.95136666, 'binary_precision': 0.779661, 'binary_recall': 0.5307692, 'binary_specificity': 0.993441, 'binary_f1_score': 0.6315789}
confusion matrix:
      0    1
0  5907   39
1   122  138
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863189.png
early stop counter: 10
val acc:0.9653682112693787, best validation acc: 0.9654215574264526, corresponding to test acc:                         0.974218487739563 / 0.9761521220207214
after epoch: 19,now: 2024-05-27 01:38:51.936677,epoch time: 0:15:25.660800,used: 4:54:24.690687,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_20_44_27_seed_1_20863189
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9687728, 'precision': 0.75385386, 'recall': 0.8033949, 'specificity': 0.8033949, 'f1': 0.7761736, 'auroc': 0.9624169, 'binary_precision': 0.5204847, 'binary_recall': 0.6263889, 'binary_specificity': 0.9804009, 'binary_f1_score': 0.5685471}
confusion matrix:
       0    1
0  41569  831
1    538  902
---- Validation: 
scalar performance:
{'acc': 0.963714, 'precision': 0.7403493, 'recall': 0.78877425, 'specificity': 0.78877425, 'f1': 0.76205885, 'auroc': 0.94718635, 'binary_precision': 0.49570552, 'binary_recall': 0.60029715, 'binary_specificity': 0.97725135, 'binary_f1_score': 0.5430107}
confusion matrix:
       0    1
0  17656  411
1    269  404
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97147924, 'precision': 0.8453449, 'recall': 0.7644377, 'specificity': 0.7644377, 'f1': 0.798943, 'auroc': 0.94974315, 'binary_precision': 0.7106599, 'binary_recall': 0.53846157, 'binary_specificity': 0.9904137, 'binary_f1_score': 0.6126915}
confusion matrix:
      0    1
0  5889   57
1   120  140
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863189.png
early stop counter: 11
val acc:0.9637140035629272, best validation acc: 0.9654215574264526, corresponding to test acc:                         0.974218487739563 / 0.9761521220207214
after epoch: 20,now: 2024-05-27 01:54:08.904755,epoch time: 0:15:16.968078,used: 5:09:41.658765,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_20_44_27_seed_1_20863189
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9680885, 'precision': 0.74969023, 'recall': 0.8270799, 'specificity': 0.8270799, 'f1': 0.7825876, 'auroc': 0.960877, 'binary_precision': 0.51049316, 'binary_recall': 0.67616403, 'binary_specificity': 0.9779958, 'binary_f1_score': 0.5817638}
confusion matrix:
       0    1
0  41468  933
1    466  973
---- Validation: 
scalar performance:
{'acc': 0.9628068, 'precision': 0.7373308, 'recall': 0.8226366, 'specificity': 0.8226366, 'f1': 0.7726103, 'auroc': 0.9497191, 'binary_precision': 0.48706895, 'binary_recall': 0.6716196, 'binary_specificity': 0.9736536, 'binary_f1_score': 0.5646471}
confusion matrix:
       0    1
0  17591  476
1    221  452
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96841764, 'precision': 0.8179349, 'recall': 0.751806, 'specificity': 0.751806, 'f1': 0.7805909, 'auroc': 0.94815695, 'binary_precision': 0.65686274, 'binary_recall': 0.5153846, 'binary_specificity': 0.98822737, 'binary_f1_score': 0.5775862}
confusion matrix:
      0    1
0  5876   70
1   126  134
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863189.png
early stop counter: 12
val acc:0.9628068208694458, best validation acc: 0.9654215574264526, corresponding to test acc:                         0.974218487739563 / 0.9761521220207214
after epoch: 21,now: 2024-05-27 02:09:32.008519,epoch time: 0:15:23.103764,used: 5:25:04.762529,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_20_44_27_seed_1_20863189
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9685675, 'precision': 0.7527831, 'recall': 0.80321246, 'specificity': 0.80321246, 'f1': 0.7754513, 'auroc': 0.96197855, 'binary_precision': 0.5183697, 'binary_recall': 0.6262136, 'binary_specificity': 0.9802113, 'binary_f1_score': 0.5672111}
confusion matrix:
       0    1
0  41559  839
1    539  903
---- Validation: 
scalar performance:
{'acc': 0.96387404, 'precision': 0.7416866, 'recall': 0.79887104, 'specificity': 0.79887104, 'f1': 0.7668609, 'auroc': 0.9489092, 'binary_precision': 0.49761903, 'binary_recall': 0.62109953, 'binary_specificity': 0.9766425, 'binary_f1_score': 0.55254453}
confusion matrix:
       0    1
0  17645  422
1    255  418
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9671286, 'precision': 0.8210776, 'recall': 0.7106756, 'specificity': 0.7106756, 'f1': 0.7531709, 'auroc': 0.94412905, 'binary_precision': 0.6666667, 'binary_recall': 0.43076923, 'binary_specificity': 0.9905819, 'binary_f1_score': 0.5233645}
confusion matrix:
      0    1
0  5890   56
1   148  112
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863189.png
early stop counter: 13
val acc:0.9638740420341492, best validation acc: 0.9654215574264526, corresponding to test acc:                         0.974218487739563 / 0.9761521220207214
after epoch: 22,now: 2024-05-27 02:25:00.842884,epoch time: 0:15:28.834365,used: 5:40:33.596894,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_20_44_27_seed_1_20863189
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9680885, 'precision': 0.750309, 'recall': 0.8404789, 'specificity': 0.8404789, 'f1': 0.7877021, 'auroc': 0.96491194, 'binary_precision': 0.5108203, 'binary_recall': 0.70388347, 'binary_specificity': 0.9770744, 'binary_f1_score': 0.5920093}
confusion matrix:
       0     1
0  41426   972
1    427  1015
---- Validation: 
scalar performance:
{'acc': 0.9649413, 'precision': 0.7488147, 'recall': 0.8437711, 'specificity': 0.8437711, 'f1': 0.7876861, 'auroc': 0.95350814, 'binary_precision': 0.5084746, 'binary_recall': 0.71322435, 'binary_specificity': 0.9743178, 'binary_f1_score': 0.59369195}
confusion matrix:
       0    1
0  17603  464
1    193  480
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9708347, 'precision': 0.838267, 'recall': 0.76410127, 'specificity': 0.76410127, 'f1': 0.79611504, 'auroc': 0.95406604, 'binary_precision': 0.6965174, 'binary_recall': 0.53846157, 'binary_specificity': 0.989741, 'binary_f1_score': 0.6073753}
confusion matrix:
      0    1
0  5885   61
1   120  140
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863189.png
early stop counter: 14
val acc:0.9649413228034973, best validation acc: 0.9654215574264526, corresponding to test acc:                         0.974218487739563 / 0.9761521220207214
after epoch: 23,now: 2024-05-27 02:40:27.329178,epoch time: 0:15:26.486294,used: 5:56:00.083188,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_20_44_27_seed_1_20863189
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.97139597, 'precision': 0.7697407, 'recall': 0.8520466, 'specificity': 0.8520466, 'f1': 0.8048413, 'auroc': 0.9695041, 'binary_precision': 0.5489474, 'binary_recall': 0.72430557, 'binary_specificity': 0.9797877, 'binary_f1_score': 0.62455094}
confusion matrix:
       0     1
0  41543   857
1    397  1043
---- Validation: 
scalar performance:
{'acc': 0.96659553, 'precision': 0.7574594, 'recall': 0.84248316, 'specificity': 0.84248316, 'f1': 0.7931801, 'auroc': 0.95584047, 'binary_precision': 0.5259096, 'binary_recall': 0.7087667, 'binary_specificity': 0.9761997, 'binary_f1_score': 0.60379744}
confusion matrix:
       0    1
0  17637  430
1    196  477
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9705124, 'precision': 0.8525586, 'recall': 0.7326703, 'specificity': 0.7326703, 'f1': 0.7790774, 'auroc': 0.95037514, 'binary_precision': 0.7278106, 'binary_recall': 0.4730769, 'binary_specificity': 0.99226373, 'binary_f1_score': 0.57342654}
confusion matrix:
      0    1
0  5900   46
1   137  123
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863189.png
better model found
persisted
after epoch: 24,now: 2024-05-27 02:55:54.911579,epoch time: 0:15:27.582401,used: 6:11:27.665589,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_20_44_27_seed_1_20863189
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9697536, 'precision': 0.7603117, 'recall': 0.8245925, 'specificity': 0.8245925, 'f1': 0.7885227, 'auroc': 0.96437544, 'binary_precision': 0.53197354, 'binary_recall': 0.6692094, 'binary_specificity': 0.97997546, 'binary_f1_score': 0.59275186}
confusion matrix:
       0    1
0  41549  849
1    477  965
---- Validation: 
scalar performance:
{'acc': 0.9655283, 'precision': 0.7513662, 'recall': 0.8126037, 'specificity': 0.8126037, 'f1': 0.7782383, 'auroc': 0.9538044, 'binary_precision': 0.5159763, 'binary_recall': 0.64784545, 'binary_specificity': 0.97736204, 'binary_f1_score': 0.57444006}
confusion matrix:
       0    1
0  17658  409
1    237  436
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96841764, 'precision': 0.8427094, 'recall': 0.70399237, 'specificity': 0.70399237, 'f1': 0.75396925, 'auroc': 0.952952, 'binary_precision': 0.7105263, 'binary_recall': 0.41538462, 'binary_specificity': 0.9926001, 'binary_f1_score': 0.52427185}
confusion matrix:
      0    1
0  5902   44
1   152  108
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863189.png
early stop counter: 1
val acc:0.9655283093452454, best validation acc: 0.9665955305099487, corresponding to test acc:                         0.9705123901367188 / 0.9761521220207214
after epoch: 25,now: 2024-05-27 03:11:22.406383,epoch time: 0:15:27.494804,used: 6:26:55.160393,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_20_44_27_seed_1_20863189
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9696624, 'precision': 0.75967467, 'recall': 0.82789475, 'specificity': 0.82789475, 'f1': 0.789377, 'auroc': 0.96551156, 'binary_precision': 0.5304679, 'binary_recall': 0.67614424, 'binary_specificity': 0.97964525, 'binary_f1_score': 0.5945122}
confusion matrix:
       0    1
0  41535  863
1    467  975
---- Validation: 
scalar performance:
{'acc': 0.9667022, 'precision': 0.75821996, 'recall': 0.81750417, 'specificity': 0.81750417, 'f1': 0.78443, 'auroc': 0.9514006, 'binary_precision': 0.52934134, 'binary_recall': 0.65676075, 'binary_specificity': 0.97824764, 'binary_f1_score': 0.58620685}
confusion matrix:
       0    1
0  17674  393
1    231  442
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9668063, 'precision': 0.81982124, 'recall': 0.7049904, 'specificity': 0.7049904, 'f1': 0.74848354, 'auroc': 0.9456717, 'binary_precision': 0.66463417, 'binary_recall': 0.41923076, 'binary_specificity': 0.9907501, 'binary_f1_score': 0.5141509}
confusion matrix:
      0    1
0  5891   55
1   151  109
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863189.png
better model found
persisted
after epoch: 26,now: 2024-05-27 03:26:42.809270,epoch time: 0:15:20.402887,used: 6:42:15.563280,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_20_44_27_seed_1_20863189
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.96911496, 'precision': 0.7562763, 'recall': 0.8215827, 'specificity': 0.8215827, 'f1': 0.7848195, 'auroc': 0.9659891, 'binary_precision': 0.52409637, 'binary_recall': 0.6636616, 'binary_specificity': 0.97950375, 'binary_f1_score': 0.5856793}
confusion matrix:
       0    1
0  41529  869
1    485  957
---- Validation: 
scalar performance:
{'acc': 0.9655283, 'precision': 0.75141764, 'recall': 0.81689537, 'specificity': 0.81689537, 'f1': 0.7799041, 'auroc': 0.9536788, 'binary_precision': 0.5157526, 'binary_recall': 0.65676075, 'binary_specificity': 0.9770299, 'binary_f1_score': 0.57777774}
confusion matrix:
       0    1
0  17652  415
1    231  442
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650338, 'precision': 0.804463, 'recall': 0.6893535, 'specificity': 0.6893535, 'f1': 0.73200315, 'auroc': 0.9525395, 'binary_precision': 0.6352201, 'binary_recall': 0.38846153, 'binary_specificity': 0.9902455, 'binary_f1_score': 0.48210025}
confusion matrix:
      0    1
0  5888   58
1   159  101
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863189.png
early stop counter: 1
val acc:0.9655283093452454, best validation acc: 0.9667022228240967, corresponding to test acc:                         0.9668062925338745 / 0.9761521220207214
after epoch: 27,now: 2024-05-27 03:42:05.552277,epoch time: 0:15:22.743007,used: 6:57:38.306287,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_20_44_27_seed_1_20863189
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9694343, 'precision': 0.75809497, 'recall': 0.82934064, 'specificity': 0.82934064, 'f1': 0.78890646, 'auroc': 0.9681281, 'binary_precision': 0.5271944, 'binary_recall': 0.6793893, 'binary_specificity': 0.979292, 'binary_f1_score': 0.5936931}
confusion matrix:
       0    1
0  41521  878
1    462  979
---- Validation: 
scalar performance:
{'acc': 0.9645678, 'precision': 0.74707687, 'recall': 0.847869, 'specificity': 0.847869, 'f1': 0.78780365, 'auroc': 0.9541446, 'binary_precision': 0.5046729, 'binary_recall': 0.72213966, 'binary_specificity': 0.9735983, 'binary_f1_score': 0.594132}
confusion matrix:
       0    1
0  17590  477
1    187  486
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650338, 'precision': 0.816666, 'recall': 0.6654467, 'specificity': 0.6654467, 'f1': 0.7148912, 'auroc': 0.9495295, 'binary_precision': 0.6616541, 'binary_recall': 0.33846155, 'binary_specificity': 0.9924319, 'binary_f1_score': 0.44783714}
confusion matrix:
      0   1
0  5901  45
1   172  88
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863189.png
early stop counter: 2
val acc:0.9645677804946899, best validation acc: 0.9667022228240967, corresponding to test acc:                         0.9668062925338745 / 0.9761521220207214
after epoch: 28,now: 2024-05-27 03:57:33.069820,epoch time: 0:15:27.517543,used: 7:13:05.823830,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_20_44_27_seed_1_20863189
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9691834, 'precision': 0.7566384, 'recall': 0.84037507, 'specificity': 0.84037507, 'f1': 0.7919576, 'auroc': 0.96854335, 'binary_precision': 0.5235142, 'binary_recall': 0.7024965, 'binary_specificity': 0.97825366, 'binary_f1_score': 0.5999407}
confusion matrix:
       0     1
0  41476   922
1    429  1013
---- Validation: 
scalar performance:
{'acc': 0.9646211, 'precision': 0.74753976, 'recall': 0.85433406, 'specificity': 0.85433406, 'f1': 0.79020274, 'auroc': 0.9552574, 'binary_precision': 0.50510204, 'binary_recall': 0.7355126, 'binary_specificity': 0.9731555, 'binary_f1_score': 0.59891105}
confusion matrix:
       0    1
0  17582  485
1    178  495
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9693845, 'precision': 0.83042085, 'recall': 0.7467936, 'specificity': 0.7467936, 'f1': 0.7818799, 'auroc': 0.95311475, 'binary_precision': 0.6822917, 'binary_recall': 0.50384617, 'binary_specificity': 0.989741, 'binary_f1_score': 0.579646}
confusion matrix:
      0    1
0  5885   61
1   129  131
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863189.png
early stop counter: 3
val acc:0.9646211266517639, best validation acc: 0.9667022228240967, corresponding to test acc:                         0.9668062925338745 / 0.9761521220207214
after epoch: 29,now: 2024-05-27 04:12:50.620333,epoch time: 0:15:17.550513,used: 7:28:23.374343,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_20_44_27_seed_1_20863189
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.97066605, 'precision': 0.7658986, 'recall': 0.83645236, 'specificity': 0.83645236, 'f1': 0.79658335, 'auroc': 0.9698465, 'binary_precision': 0.5423453, 'binary_recall': 0.69278777, 'binary_specificity': 0.98011696, 'binary_f1_score': 0.6084044}
confusion matrix:
       0    1
0  41555  843
1    443  999
---- Validation: 
scalar performance:
{'acc': 0.96558166, 'precision': 0.75203604, 'recall': 0.8405268, 'specificity': 0.8405268, 'f1': 0.7888186, 'auroc': 0.956197, 'binary_precision': 0.5151844, 'binary_recall': 0.70579493, 'binary_specificity': 0.97525877, 'binary_f1_score': 0.5956113}
confusion matrix:
       0    1
0  17620  447
1    198  475
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96890104, 'precision': 0.8384597, 'recall': 0.7207955, 'specificity': 0.7207955, 'f1': 0.76595294, 'auroc': 0.946985, 'binary_precision': 0.7005988, 'binary_recall': 0.45, 'binary_specificity': 0.991591, 'binary_f1_score': 0.54800934}
confusion matrix:
      0    1
0  5896   50
1   143  117
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863189.png
early stop counter: 4
val acc:0.9655816555023193, best validation acc: 0.9667022228240967, corresponding to test acc:                         0.9668062925338745 / 0.9761521220207214
after epoch: 30,now: 2024-05-27 04:27:56.051174,epoch time: 0:15:05.430841,used: 7:43:28.805184,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_20_44_27_seed_1_20863189
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 7:43:28.805184 at 2024-05-27 04:27:56.051174
persisted model performance metric: 

scalar performance:
{'acc': 0.9698679, 'precision': 0.85021406, 'recall': 0.72313905, 'specificity': 0.72313905, 'f1': 0.771161, 'auroc': 0.9604839, 'binary_precision': 0.72392637, 'binary_recall': 0.45384616, 'binary_specificity': 0.9924319, 'binary_f1_score': 0.5579196}
confusion matrix:
      0    1
0  5901   45
1   142  118
oracle model performance metric: 

scalar performance:
{'acc': 0.97437966, 'precision': 0.9040464, 'recall': 0.7420444, 'specificity': 0.7420444, 'f1': 0.80088043, 'auroc': 0.93790317, 'binary_precision': 0.83006537, 'binary_recall': 0.48846152, 'binary_specificity': 0.9956273, 'binary_f1_score': 0.6150121}
confusion matrix:
      0    1
0  5920   26
1   133  127
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs32/rule_results/11.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs32/confusion_matrix/11.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 487305 KiB |  21386 MiB |   2380 TiB |   2380 TiB |
|       from large pool | 398080 KiB |  21312 MiB |   2377 TiB |   2377 TiB |
|       from small pool |  89225 KiB |    123 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 487305 KiB |  21386 MiB |   2380 TiB |   2380 TiB |
|       from large pool | 398080 KiB |  21312 MiB |   2377 TiB |   2377 TiB |
|       from small pool |  89225 KiB |    123 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476570 KiB |  21360 MiB |   2376 TiB |   2376 TiB |
|       from large pool | 387840 KiB |  21287 MiB |   2374 TiB |   2374 TiB |
|       from small pool |  88730 KiB |    122 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  22048 MiB |  22048 MiB |  41452 MiB |  19404 MiB |
|       from large pool |  21924 MiB |  21924 MiB |  41302 MiB |  19378 MiB |
|       from small pool |    124 MiB |    124 MiB |    150 MiB |     26 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   2408 MiB |   3357 MiB |   1045 TiB |   1045 TiB |
|       from large pool |   2401 MiB |   3354 MiB |   1042 TiB |   1042 TiB |
|       from small pool |      6 MiB |     25 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    2541    |    3986    |  139619 K  |  139617 K  |
|       from large pool |      87    |     909    |   66958 K  |   66958 K  |
|       from small pool |    2454    |    3897    |   72661 K  |   72658 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2541    |    3986    |  139619 K  |  139617 K  |
|       from large pool |      87    |     909    |   66958 K  |   66958 K  |
|       from small pool |    2454    |    3897    |   72661 K  |   72658 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     285    |     285    |     490    |     205    |
|       from large pool |     223    |     223    |     415    |     192    |
|       from small pool |      62    |      62    |      75    |      13    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      83    |    1422    |   71249 K  |   71249 K  |
|       from large pool |      31    |     136    |   31756 K  |   31756 K  |
|       from small pool |      52    |    1389    |   39492 K  |   39492 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  21386 MiB |   2380 TiB |   2380 TiB |
|       from large pool |  16640 KiB |  21312 MiB |   2377 TiB |   2377 TiB |
|       from small pool |      0 KiB |    123 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  21386 MiB |   2380 TiB |   2380 TiB |
|       from large pool |  16640 KiB |  21312 MiB |   2377 TiB |   2377 TiB |
|       from small pool |      0 KiB |    123 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  21360 MiB |   2376 TiB |   2376 TiB |
|       from large pool |  16640 KiB |  21287 MiB |   2374 TiB |   2374 TiB |
|       from small pool |      0 KiB |    122 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2884 MiB |  22048 MiB |  41452 MiB |  38568 MiB |
|       from large pool |   2790 MiB |  21924 MiB |  41302 MiB |  38512 MiB |
|       from small pool |     94 MiB |    124 MiB |    150 MiB |     56 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 214784 KiB |   3357 MiB |   1045 TiB |   1045 TiB |
|       from large pool | 214784 KiB |   3354 MiB |   1042 TiB |   1042 TiB |
|       from small pool |      0 KiB |     27 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3986    |  139619 K  |  139619 K  |
|       from large pool |       2    |     909    |   66958 K  |   66958 K  |
|       from small pool |       0    |    3897    |   72661 K  |   72661 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3986    |  139619 K  |  139619 K  |
|       from large pool |       2    |     909    |   66958 K  |   66958 K  |
|       from small pool |       0    |    3897    |   72661 K  |   72661 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      80    |     285    |     490    |     410    |
|       from large pool |      33    |     223    |     415    |     382    |
|       from small pool |      47    |      62    |      75    |      28    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1422    |   71249 K  |   71249 K  |
|       from large pool |       3    |     136    |   31756 K  |   31756 K  |
|       from small pool |       0    |    1389    |   39492 K  |   39492 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Mon May 27 04:29:42 2024]
Finished job 0.
1 of 1 steps (100%) done
