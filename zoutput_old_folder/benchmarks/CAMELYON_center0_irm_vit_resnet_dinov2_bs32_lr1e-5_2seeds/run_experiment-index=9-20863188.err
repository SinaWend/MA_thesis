Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sun May 26 12:25:43 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs32/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs32/rule_results/9.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=9
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_29_seed_0_20863188

 Experiment start at: 2024-05-26 12:35:29.191632
before training, model accuracy: 0.2401725947856903
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/autograd/graph.py:744: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9666027, 'precision': 0.7890032, 'recall': 0.50731754, 'specificity': 0.50731754, 'f1': 0.50611275, 'auroc': 0.89104104, 'binary_precision': 0.6111111, 'binary_recall': 0.014965987, 'binary_specificity': 0.9996691, 'binary_f1_score': 0.029216468}
confusion matrix:
       0   1
0  42292  14
1   1448  22
---- Validation: 
scalar performance:
{'acc': 0.9658365, 'precision': 0.752297, 'recall': 0.50527793, 'specificity': 0.50527793, 'f1': 0.50197816, 'auroc': 0.88198906, 'binary_precision': 0.53846157, 'binary_recall': 0.01088647, 'binary_specificity': 0.99966943, 'binary_f1_score': 0.021341462}
confusion matrix:
       0  1
0  18143  6
1    636  7
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.97983676, 'recall': 0.51724136, 'specificity': 0.51724136, 'f1': 0.5230443, 'auroc': 0.87935984, 'binary_precision': 1.0, 'binary_recall': 0.03448276, 'binary_specificity': 1.0, 'binary_f1_score': 0.06666667}
confusion matrix:
      0  1
0  5997  0
1   252  9
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863188.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-26 13:00:02.773040,epoch time: 0:24:33.581408,used: 0:24:33.581408,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_29_seed_0_20863188
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9660088, 'precision': 0.7295015, 'recall': 0.60156566, 'specificity': 0.60156566, 'f1': 0.6383514, 'auroc': 0.920295, 'binary_precision': 0.48589343, 'binary_recall': 0.21088435, 'binary_specificity': 0.992247, 'binary_f1_score': 0.29411766}
confusion matrix:
       0    1
0  41978  328
1   1160  310
---- Validation: 
scalar performance:
{'acc': 0.9657301, 'precision': 0.7361161, 'recall': 0.6192312, 'specificity': 0.6192312, 'f1': 0.6564882, 'auroc': 0.9093835, 'binary_precision': 0.4984326, 'binary_recall': 0.24727838, 'binary_specificity': 0.9911841, 'binary_f1_score': 0.33056134}
confusion matrix:
       0    1
0  17989  160
1    484  159
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97363377, 'precision': 0.90513575, 'recall': 0.72788405, 'specificity': 0.72788405, 'f1': 0.7894843, 'auroc': 0.9045389, 'binary_precision': 0.8333333, 'binary_recall': 0.4597701, 'binary_specificity': 0.995998, 'binary_f1_score': 0.5925926}
confusion matrix:
      0    1
0  5973   24
1   141  120
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863188.png
new oracle model saved
early stop counter: 1
val acc:0.9657300710678101, best validation acc: 0.9658365249633789, corresponding to test acc:                         0.9597315192222595 / 0.9736337661743164
after epoch: 2,now: 2024-05-26 13:23:15.203813,epoch time: 0:23:12.430773,used: 0:47:46.012181,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_29_seed_0_20863188
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96630573, 'precision': 0.7363229, 'recall': 0.6318432, 'specificity': 0.6318432, 'f1': 0.6677445, 'auroc': 0.92548275, 'binary_precision': 0.49752474, 'binary_recall': 0.27328348, 'binary_specificity': 0.990403, 'binary_f1_score': 0.3527863}
confusion matrix:
       0    1
0  41899  406
1   1069  402
---- Validation: 
scalar performance:
{'acc': 0.9653576, 'precision': 0.73344177, 'recall': 0.6557911, 'specificity': 0.6557911, 'f1': 0.68602544, 'auroc': 0.91929454, 'binary_precision': 0.49056605, 'binary_recall': 0.32348368, 'binary_specificity': 0.9880985, 'binary_f1_score': 0.38987818}
confusion matrix:
       0    1
0  17933  216
1    435  208
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9753915, 'precision': 0.9057341, 'recall': 0.7544539, 'specificity': 0.7544539, 'f1': 0.8111688, 'auroc': 0.9184803, 'binary_precision': 0.83229816, 'binary_recall': 0.51341, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.6350711}
confusion matrix:
      0    1
0  5970   27
1   127  134
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863188.png
new oracle model saved
early stop counter: 2
val acc:0.9653576016426086, best validation acc: 0.9658365249633789, corresponding to test acc:                         0.9597315192222595 / 0.9753915071487427
after epoch: 3,now: 2024-05-26 13:46:21.849408,epoch time: 0:23:06.645595,used: 1:10:52.657776,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_29_seed_0_20863188
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9670367, 'precision': 0.745484, 'recall': 0.71550703, 'specificity': 0.71550703, 'f1': 0.72941387, 'auroc': 0.9295883, 'binary_precision': 0.5101246, 'binary_recall': 0.44588155, 'binary_specificity': 0.98513246, 'binary_f1_score': 0.47584453}
confusion matrix:
       0    1
0  41678  629
1    814  655
---- Validation: 
scalar performance:
{'acc': 0.96663475, 'precision': 0.7474106, 'recall': 0.71870685, 'specificity': 0.71870685, 'f1': 0.7320762, 'auroc': 0.92319417, 'binary_precision': 0.5141343, 'binary_recall': 0.4525661, 'binary_specificity': 0.98484766, 'binary_f1_score': 0.48138958}
confusion matrix:
       0    1
0  17874  275
1    352  291
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97730905, 'precision': 0.89548886, 'recall': 0.7957657, 'specificity': 0.7957657, 'f1': 0.8377261, 'auroc': 0.914831, 'binary_precision': 0.8082902, 'binary_recall': 0.59770113, 'binary_specificity': 0.99383026, 'binary_f1_score': 0.6872247}
confusion matrix:
      0    1
0  5960   37
1   105  156
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863188.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-05-26 14:09:30.222564,epoch time: 0:23:08.373156,used: 1:34:01.030932,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_29_seed_0_20863188
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96710527, 'precision': 0.74662244, 'recall': 0.6941403, 'specificity': 0.6941403, 'f1': 0.7169229, 'auroc': 0.9341594, 'binary_precision': 0.51391304, 'binary_recall': 0.40149456, 'binary_specificity': 0.9867861, 'binary_f1_score': 0.45080093}
confusion matrix:
       0    1
0  41745  559
1    881  591
---- Validation: 
scalar performance:
{'acc': 0.9669008, 'precision': 0.7499093, 'recall': 0.70309347, 'specificity': 0.70309347, 'f1': 0.7238192, 'auroc': 0.92060286, 'binary_precision': 0.5202312, 'binary_recall': 0.41990668, 'binary_specificity': 0.98628026, 'binary_f1_score': 0.464716}
confusion matrix:
       0    1
0  17900  249
1    373  270
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97778845, 'precision': 0.9002818, 'recall': 0.79784817, 'specificity': 0.79784817, 'f1': 0.840817, 'auroc': 0.9222325, 'binary_precision': 0.8177083, 'binary_recall': 0.6015326, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.6931567}
confusion matrix:
      0    1
0  5962   35
1   104  157
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863188.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-05-26 14:32:35.252793,epoch time: 0:23:05.030229,used: 1:57:06.061161,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_29_seed_0_20863188
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9671509, 'precision': 0.7469145, 'recall': 0.725785, 'specificity': 0.725785, 'f1': 0.7358253, 'auroc': 0.9383463, 'binary_precision': 0.51230425, 'binary_recall': 0.46702924, 'binary_specificity': 0.9845408, 'binary_f1_score': 0.4886202}
confusion matrix:
       0    1
0  41651  654
1    784  687
---- Validation: 
scalar performance:
{'acc': 0.9670072, 'precision': 0.75048065, 'recall': 0.7331508, 'specificity': 0.7331508, 'f1': 0.74147046, 'auroc': 0.9233793, 'binary_precision': 0.51926297, 'binary_recall': 0.4821151, 'binary_specificity': 0.9841865, 'binary_f1_score': 0.5}
confusion matrix:
       0    1
0  17862  287
1    333  310
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9784276, 'precision': 0.89097655, 'recall': 0.8201697, 'specificity': 0.8201697, 'f1': 0.851689, 'auroc': 0.9213074, 'binary_precision': 0.7971698, 'binary_recall': 0.6475096, 'binary_specificity': 0.99282974, 'binary_f1_score': 0.71458775}
confusion matrix:
      0    1
0  5954   43
1    92  169
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863188.png
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-05-26 14:55:38.277210,epoch time: 0:23:03.024417,used: 2:20:09.085578,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_29_seed_0_20863188
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9682474, 'precision': 0.7551881, 'recall': 0.7762214, 'specificity': 0.7762214, 'f1': 0.7652416, 'auroc': 0.9483621, 'binary_precision': 0.52536005, 'binary_recall': 0.5703603, 'binary_specificity': 0.9820825, 'binary_f1_score': 0.54693615}
confusion matrix:
       0    1
0  41547  758
1    632  839
---- Validation: 
scalar performance:
{'acc': 0.9664219, 'precision': 0.74662703, 'recall': 0.78085124, 'specificity': 0.78085124, 'f1': 0.76249677, 'auroc': 0.93369573, 'binary_precision': 0.5081522, 'binary_recall': 0.5816485, 'binary_specificity': 0.980054, 'binary_f1_score': 0.54242206}
confusion matrix:
       0    1
0  17787  362
1    269  374
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97698945, 'precision': 0.87473327, 'recall': 0.81941926, 'specificity': 0.81941926, 'f1': 0.84463936, 'auroc': 0.9297893, 'binary_precision': 0.7647059, 'binary_recall': 0.6475096, 'binary_specificity': 0.991329, 'binary_f1_score': 0.70124483}
confusion matrix:
      0    1
0  5945   52
1    92  169
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863188.png
early stop counter: 1
val acc:0.966421902179718, best validation acc: 0.9670072197914124, corresponding to test acc:                         0.9784275889396667 / 0.9784275889396667
after epoch: 7,now: 2024-05-26 15:18:48.854489,epoch time: 0:23:10.577279,used: 2:43:19.662857,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_29_seed_0_20863188
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9676078, 'precision': 0.7504742, 'recall': 0.76720834, 'specificity': 0.76720834, 'f1': 0.75854015, 'auroc': 0.9429422, 'binary_precision': 0.51653945, 'binary_recall': 0.552381, 'binary_specificity': 0.98203564, 'binary_f1_score': 0.5338594}
confusion matrix:
       0    1
0  41546  760
1    658  812
---- Validation: 
scalar performance:
{'acc': 0.96753937, 'precision': 0.7541621, 'recall': 0.77392924, 'specificity': 0.77392924, 'f1': 0.76363313, 'auroc': 0.9334508, 'binary_precision': 0.523741, 'binary_recall': 0.5660964, 'binary_specificity': 0.98176205, 'binary_f1_score': 0.54409564}
confusion matrix:
       0    1
0  17818  331
1    279  364
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97682965, 'precision': 0.8677813, 'recall': 0.8284976, 'specificity': 0.8284976, 'f1': 0.8469111, 'auroc': 0.934036, 'binary_precision': 0.75, 'binary_recall': 0.6666667, 'binary_specificity': 0.9903285, 'binary_f1_score': 0.7058823}
confusion matrix:
      0    1
0  5939   58
1    87  174
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863188.png
better model found
persisted
after epoch: 8,now: 2024-05-26 15:42:00.926722,epoch time: 0:23:12.072233,used: 3:06:31.735090,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_29_seed_0_20863188
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9678591, 'precision': 0.75279367, 'recall': 0.7469871, 'specificity': 0.7469871, 'f1': 0.7498529, 'auroc': 0.94350654, 'binary_precision': 0.52261657, 'binary_recall': 0.5101902, 'binary_specificity': 0.983784, 'binary_f1_score': 0.51632863}
confusion matrix:
       0    1
0  41618  686
1    721  751
---- Validation: 
scalar performance:
{'acc': 0.96588975, 'precision': 0.74319196, 'recall': 0.7798257, 'specificity': 0.7798257, 'f1': 0.76007146, 'auroc': 0.9340892, 'binary_precision': 0.5013441, 'binary_recall': 0.5800933, 'binary_specificity': 0.9795581, 'binary_f1_score': 0.5378515}
confusion matrix:
       0    1
0  17778  371
1    270  373
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9787472, 'precision': 0.8895042, 'recall': 0.82766575, 'specificity': 0.82766575, 'f1': 0.85564446, 'auroc': 0.9397689, 'binary_precision': 0.79357797, 'binary_recall': 0.66283524, 'binary_specificity': 0.99249625, 'binary_f1_score': 0.7223382}
confusion matrix:
      0    1
0  5952   45
1    88  173
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863188.png
new oracle model saved
early stop counter: 1
val acc:0.9658897519111633, best validation acc: 0.967539370059967, corresponding to test acc:                         0.9768296480178833 / 0.9787471890449524
after epoch: 9,now: 2024-05-26 16:05:05.363586,epoch time: 0:23:04.436864,used: 3:29:36.171954,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_29_seed_0_20863188
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9673337, 'precision': 0.7488868, 'recall': 0.78559124, 'specificity': 0.78559124, 'f1': 0.7658324, 'auroc': 0.9495789, 'binary_precision': 0.51208013, 'binary_recall': 0.59075457, 'binary_specificity': 0.98042786, 'binary_f1_score': 0.5486111}
confusion matrix:
       0    1
0  41477  828
1    602  869
---- Validation: 
scalar performance:
{'acc': 0.9664219, 'precision': 0.7467068, 'recall': 0.78460157, 'specificity': 0.78460157, 'f1': 0.76414144, 'auroc': 0.9339185, 'binary_precision': 0.5080429, 'binary_recall': 0.58942455, 'binary_specificity': 0.9797785, 'binary_f1_score': 0.5457163}
confusion matrix:
       0    1
0  17782  367
1    264  379
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9752317, 'precision': 0.8454209, 'recall': 0.84415483, 'specificity': 0.84415483, 'f1': 0.8447865, 'auroc': 0.93631923, 'binary_precision': 0.70384616, 'binary_recall': 0.7011494, 'binary_specificity': 0.98716027, 'binary_f1_score': 0.70249516}
confusion matrix:
      0    1
0  5920   77
1    78  183
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863188.png
early stop counter: 2
val acc:0.966421902179718, best validation acc: 0.967539370059967, corresponding to test acc:                         0.9768296480178833 / 0.9787471890449524
after epoch: 10,now: 2024-05-26 16:28:10.076595,epoch time: 0:23:04.713009,used: 3:52:40.884963,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_29_seed_0_20863188
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96742505, 'precision': 0.74975455, 'recall': 0.79594076, 'specificity': 0.79594076, 'f1': 0.7706647, 'auroc': 0.94764245, 'binary_precision': 0.51309794, 'binary_recall': 0.6120924, 'binary_specificity': 0.97978914, 'binary_f1_score': 0.5582404}
confusion matrix:
       0    1
0  41449  855
1    571  901
---- Validation: 
scalar performance:
{'acc': 0.9656769, 'precision': 0.7427944, 'recall': 0.8044673, 'specificity': 0.8044673, 'f1': 0.76972795, 'auroc': 0.93672, 'binary_precision': 0.4987715, 'binary_recall': 0.63141525, 'binary_specificity': 0.9775194, 'binary_f1_score': 0.5573095}
confusion matrix:
       0    1
0  17741  408
1    237  406
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97666985, 'precision': 0.863315, 'recall': 0.8339112, 'specificity': 0.8339112, 'f1': 0.84792477, 'auroc': 0.9371685, 'binary_precision': 0.74058574, 'binary_recall': 0.6781609, 'binary_specificity': 0.9896615, 'binary_f1_score': 0.70799994}
confusion matrix:
      0    1
0  5935   62
1    84  177
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863188.png
early stop counter: 3
val acc:0.9656769037246704, best validation acc: 0.967539370059967, corresponding to test acc:                         0.9768296480178833 / 0.9787471890449524
after epoch: 11,now: 2024-05-26 16:51:13.098918,epoch time: 0:23:03.022323,used: 4:15:43.907286,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_29_seed_0_20863188
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9672423, 'precision': 0.7480829, 'recall': 0.7817935, 'specificity': 0.7817935, 'f1': 0.7637415, 'auroc': 0.9501543, 'binary_precision': 0.51072705, 'binary_recall': 0.5829932, 'binary_specificity': 0.98059374, 'binary_f1_score': 0.54447275}
confusion matrix:
       0    1
0  41485  821
1    613  857
---- Validation: 
scalar performance:
{'acc': 0.9664219, 'precision': 0.74678814, 'recall': 0.7883518, 'specificity': 0.7883518, 'f1': 0.7657627, 'auroc': 0.9349646, 'binary_precision': 0.50793654, 'binary_recall': 0.59720063, 'binary_specificity': 0.979503, 'binary_f1_score': 0.5489636}
confusion matrix:
       0    1
0  17777  372
1    259  384
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9744327, 'precision': 0.8465113, 'recall': 0.8235823, 'specificity': 0.8235823, 'f1': 0.83460987, 'auroc': 0.9342321, 'binary_precision': 0.7078189, 'binary_recall': 0.65900385, 'binary_specificity': 0.9881607, 'binary_f1_score': 0.6825397}
confusion matrix:
      0    1
0  5926   71
1    89  172
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863188.png
early stop counter: 4
val acc:0.966421902179718, best validation acc: 0.967539370059967, corresponding to test acc:                         0.9768296480178833 / 0.9787471890449524
after epoch: 12,now: 2024-05-26 17:14:14.785119,epoch time: 0:23:01.686201,used: 4:38:45.593487,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_29_seed_0_20863188
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9678591, 'precision': 0.75246346, 'recall': 0.8055482, 'specificity': 0.8055482, 'f1': 0.77618647, 'auroc': 0.9547038, 'binary_precision': 0.5178372, 'binary_recall': 0.63154316, 'binary_specificity': 0.9795532, 'binary_f1_score': 0.5690658}
confusion matrix:
       0    1
0  41440  865
1    542  929
---- Validation: 
scalar performance:
{'acc': 0.9669008, 'precision': 0.7501837, 'recall': 0.81410164, 'specificity': 0.81410164, 'f1': 0.7780853, 'auroc': 0.93852437, 'binary_precision': 0.5128834, 'binary_recall': 0.65007776, 'binary_specificity': 0.9781255, 'binary_f1_score': 0.57338816}
confusion matrix:
       0    1
0  17752  397
1    225  418
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9744327, 'precision': 0.8489002, 'recall': 0.8180853, 'specificity': 0.8180853, 'f1': 0.8327007, 'auroc': 0.9355011, 'binary_precision': 0.71308017, 'binary_recall': 0.6475096, 'binary_specificity': 0.988661, 'binary_f1_score': 0.6787149}
confusion matrix:
      0    1
0  5929   68
1    92  169
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863188.png
early stop counter: 5
val acc:0.9669008255004883, best validation acc: 0.967539370059967, corresponding to test acc:                         0.9768296480178833 / 0.9787471890449524
after epoch: 13,now: 2024-05-26 17:37:24.034107,epoch time: 0:23:09.248988,used: 5:01:54.842475,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_29_seed_0_20863188
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9675164, 'precision': 0.7500309, 'recall': 0.7927698, 'specificity': 0.7927698, 'f1': 0.76952213, 'auroc': 0.9554546, 'binary_precision': 0.5138568, 'binary_recall': 0.60544217, 'binary_specificity': 0.9800974, 'binary_f1_score': 0.5559026}
confusion matrix:
       0    1
0  41464  842
1    580  890
---- Validation: 
scalar performance:
{'acc': 0.9658365, 'precision': 0.74379694, 'recall': 0.8068001, 'specificity': 0.8068001, 'f1': 0.77125096, 'auroc': 0.93840694, 'binary_precision': 0.500612, 'binary_recall': 0.63608086, 'binary_specificity': 0.9775194, 'binary_f1_score': 0.560274}
confusion matrix:
       0    1
0  17741  408
1    234  409
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.971876, 'precision': 0.8469638, 'recall': 0.7672783, 'specificity': 0.7672783, 'f1': 0.8013964, 'auroc': 0.9342149, 'binary_precision': 0.71356785, 'binary_recall': 0.5440613, 'binary_specificity': 0.99049526, 'binary_f1_score': 0.61739135}
confusion matrix:
      0    1
0  5940   57
1   119  142
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863188.png
early stop counter: 6
val acc:0.9658365249633789, best validation acc: 0.967539370059967, corresponding to test acc:                         0.9768296480178833 / 0.9787471890449524
after epoch: 14,now: 2024-05-26 18:00:24.896999,epoch time: 0:23:00.862892,used: 5:24:55.705367,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_29_seed_0_20863188
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9651407, 'precision': 0.73677534, 'recall': 0.8095123, 'specificity': 0.8095123, 'f1': 0.76770115, 'auroc': 0.9575358, 'binary_precision': 0.48612538, 'binary_recall': 0.64266306, 'binary_specificity': 0.9763616, 'binary_f1_score': 0.55354005}
confusion matrix:
       0     1
0  41304  1000
1    526   946
---- Validation: 
scalar performance:
{'acc': 0.9645594, 'precision': 0.7378339, 'recall': 0.8271405, 'specificity': 0.8271405, 'f1': 0.77452755, 'auroc': 0.94411457, 'binary_precision': 0.4871795, 'binary_recall': 0.67962676, 'binary_specificity': 0.97465426, 'binary_f1_score': 0.5675325}
confusion matrix:
       0    1
0  17689  460
1    206  437
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96628314, 'precision': 0.79354167, 'recall': 0.7643602, 'specificity': 0.7643602, 'f1': 0.7780924, 'auroc': 0.9358183, 'binary_precision': 0.60683763, 'binary_recall': 0.5440613, 'binary_specificity': 0.984659, 'binary_f1_score': 0.5737374}
confusion matrix:
      0    1
0  5905   92
1   119  142
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863188.png
early stop counter: 7
val acc:0.9645593762397766, best validation acc: 0.967539370059967, corresponding to test acc:                         0.9768296480178833 / 0.9787471890449524
after epoch: 15,now: 2024-05-26 18:23:29.401889,epoch time: 0:23:04.504890,used: 5:48:00.210257,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_29_seed_0_20863188
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9679048, 'precision': 0.75286365, 'recall': 0.79651684, 'specificity': 0.79651684, 'f1': 0.7727553, 'auroc': 0.95640224, 'binary_precision': 0.5192861, 'binary_recall': 0.61277175, 'binary_specificity': 0.9802619, 'binary_f1_score': 0.56216884}
confusion matrix:
       0    1
0  41469  835
1    570  902
---- Validation: 
scalar performance:
{'acc': 0.96620905, 'precision': 0.7460892, 'recall': 0.81149334, 'specificity': 0.81149334, 'f1': 0.77448606, 'auroc': 0.9422138, 'binary_precision': 0.5048662, 'binary_recall': 0.64541215, 'binary_specificity': 0.9775745, 'binary_f1_score': 0.5665529}
confusion matrix:
       0    1
0  17742  407
1    228  415
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9704378, 'precision': 0.83314383, 'recall': 0.7628633, 'specificity': 0.7628633, 'f1': 0.7933996, 'auroc': 0.9471928, 'binary_precision': 0.6862745, 'binary_recall': 0.5363985, 'binary_specificity': 0.989328, 'binary_f1_score': 0.6021506}
confusion matrix:
      0    1
0  5933   64
1   121  140
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863188.png
early stop counter: 8
val acc:0.9662090539932251, best validation acc: 0.967539370059967, corresponding to test acc:                         0.9768296480178833 / 0.9787471890449524
after epoch: 16,now: 2024-05-26 18:46:31.960272,epoch time: 0:23:02.558383,used: 6:11:02.768640,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_29_seed_0_20863188
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9670367, 'precision': 0.74849176, 'recall': 0.8594116, 'specificity': 0.8594116, 'f1': 0.79258776, 'auroc': 0.9608491, 'binary_precision': 0.5060185, 'binary_recall': 0.7440436, 'binary_specificity': 0.9747796, 'binary_f1_score': 0.6023698}
confusion matrix:
       0     1
0  41240  1067
1    376  1093
---- Validation: 
scalar performance:
{'acc': 0.96599615, 'precision': 0.7465527, 'recall': 0.8623869, 'specificity': 0.8623869, 'f1': 0.7920544, 'auroc': 0.94887704, 'binary_precision': 0.502079, 'binary_recall': 0.7511664, 'binary_specificity': 0.97360736, 'binary_f1_score': 0.60186917}
confusion matrix:
       0    1
0  17670  479
1    160  483
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9741131, 'precision': 0.8368052, 'recall': 0.8417389, 'specificity': 0.8417389, 'f1': 0.839252, 'auroc': 0.9443946, 'binary_precision': 0.68679243, 'binary_recall': 0.697318, 'binary_specificity': 0.98615974, 'binary_f1_score': 0.69201523}
confusion matrix:
      0    1
0  5914   83
1    79  182
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863188.png
early stop counter: 9
val acc:0.9659961462020874, best validation acc: 0.967539370059967, corresponding to test acc:                         0.9768296480178833 / 0.9787471890449524
after epoch: 17,now: 2024-05-26 19:09:37.908514,epoch time: 0:23:05.948242,used: 6:34:08.716882,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_29_seed_0_20863188
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.96909267, 'precision': 0.76072854, 'recall': 0.7976562, 'specificity': 0.7976562, 'f1': 0.77783394, 'auroc': 0.96144915, 'binary_precision': 0.5349526, 'binary_recall': 0.6138681, 'binary_specificity': 0.9814443, 'binary_f1_score': 0.5716999}
confusion matrix:
       0    1
0  41520  785
1    568  903
---- Validation: 
scalar performance:
{'acc': 0.96753937, 'precision': 0.75402015, 'recall': 0.81443226, 'specificity': 0.81443226, 'f1': 0.78063345, 'auroc': 0.9465546, 'binary_precision': 0.5205479, 'binary_recall': 0.65007776, 'binary_specificity': 0.9787867, 'binary_f1_score': 0.57814664}
confusion matrix:
       0    1
0  17764  385
1    225  418
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9694791, 'precision': 0.8370482, 'recall': 0.73304564, 'specificity': 0.73304564, 'f1': 0.7745525, 'auroc': 0.9406574, 'binary_precision': 0.6966292, 'binary_recall': 0.47509578, 'binary_specificity': 0.9909955, 'binary_f1_score': 0.56492025}
confusion matrix:
      0    1
0  5943   54
1   137  124
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863188.png
early stop counter: 10
val acc:0.967539370059967, best validation acc: 0.967539370059967, corresponding to test acc:                         0.9768296480178833 / 0.9787471890449524
after epoch: 18,now: 2024-05-26 19:32:38.305302,epoch time: 0:23:00.396788,used: 6:57:09.113670,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_29_seed_0_20863188
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.96699107, 'precision': 0.74725044, 'recall': 0.81712174, 'specificity': 0.81712174, 'f1': 0.7773428, 'auroc': 0.961895, 'binary_precision': 0.5065617, 'binary_recall': 0.6564626, 'binary_specificity': 0.97778094, 'binary_f1_score': 0.57185185}
confusion matrix:
       0    1
0  41366  940
1    505  965
---- Validation: 
scalar performance:
{'acc': 0.96588975, 'precision': 0.7447479, 'recall': 0.82557905, 'specificity': 0.82557905, 'f1': 0.7787234, 'auroc': 0.9488274, 'binary_precision': 0.5011547, 'binary_recall': 0.6749611, 'binary_specificity': 0.97619706, 'binary_f1_score': 0.5752154}
confusion matrix:
       0    1
0  17717  432
1    209  434
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9683605, 'precision': 0.8184179, 'recall': 0.7452884, 'specificity': 0.7452884, 'f1': 0.7765709, 'auroc': 0.9407073, 'binary_precision': 0.65829146, 'binary_recall': 0.5019157, 'binary_specificity': 0.988661, 'binary_f1_score': 0.56956524}
confusion matrix:
      0    1
0  5929   68
1   130  131
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863188.png
early stop counter: 11
val acc:0.9658897519111633, best validation acc: 0.967539370059967, corresponding to test acc:                         0.9768296480178833 / 0.9787471890449524
after epoch: 19,now: 2024-05-26 19:55:42.058419,epoch time: 0:23:03.753117,used: 7:20:12.866787,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_29_seed_0_20863188
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.96779054, 'precision': 0.75211936, 'recall': 0.81699574, 'specificity': 0.81699574, 'f1': 0.7804242, 'auroc': 0.96091986, 'binary_precision': 0.5163364, 'binary_recall': 0.6553365, 'binary_specificity': 0.978655, 'binary_f1_score': 0.5775914}
confusion matrix:
       0    1
0  41402  903
1    507  964
---- Validation: 
scalar performance:
{'acc': 0.9664219, 'precision': 0.7476784, 'recall': 0.82585454, 'specificity': 0.82585454, 'f1': 0.7807832, 'auroc': 0.94934934, 'binary_precision': 0.5070093, 'binary_recall': 0.6749611, 'binary_specificity': 0.97674805, 'binary_f1_score': 0.57905275}
confusion matrix:
       0    1
0  17727  422
1    209  434
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9651646, 'precision': 0.80373096, 'recall': 0.6904832, 'specificity': 0.6904832, 'f1': 0.73269343, 'auroc': 0.9291042, 'binary_precision': 0.6335404, 'binary_recall': 0.3908046, 'binary_specificity': 0.9901618, 'binary_f1_score': 0.48341236}
confusion matrix:
      0    1
0  5938   59
1   159  102
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863188.png
early stop counter: 12
val acc:0.966421902179718, best validation acc: 0.967539370059967, corresponding to test acc:                         0.9768296480178833 / 0.9787471890449524
after epoch: 20,now: 2024-05-26 20:18:43.091653,epoch time: 0:23:01.033234,used: 7:43:13.900021,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_29_seed_0_20863188
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.96808755, 'precision': 0.7540002, 'recall': 0.83289754, 'specificity': 0.83289754, 'f1': 0.7875174, 'auroc': 0.96387005, 'binary_precision': 0.51897436, 'binary_recall': 0.68796736, 'binary_specificity': 0.97782767, 'binary_f1_score': 0.5916399}
confusion matrix:
       0     1
0  41367   938
1    459  1012
---- Validation: 
scalar performance:
{'acc': 0.9665815, 'precision': 0.74906474, 'recall': 0.8469387, 'specificity': 0.8469387, 'f1': 0.78896594, 'auroc': 0.9480071, 'binary_precision': 0.50825083, 'binary_recall': 0.718507, 'binary_specificity': 0.9753705, 'binary_f1_score': 0.5953609}
confusion matrix:
       0    1
0  17702  447
1    181  462
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97235537, 'precision': 0.8546097, 'recall': 0.76386374, 'specificity': 0.76386374, 'f1': 0.8018801, 'auroc': 0.9390538, 'binary_precision': 0.7291667, 'binary_recall': 0.5363985, 'binary_specificity': 0.991329, 'binary_f1_score': 0.61810154}
confusion matrix:
      0    1
0  5945   52
1   121  140
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863188.png
early stop counter: 13
val acc:0.9665815234184265, best validation acc: 0.967539370059967, corresponding to test acc:                         0.9768296480178833 / 0.9787471890449524
after epoch: 21,now: 2024-05-26 20:41:33.962121,epoch time: 0:22:50.870468,used: 8:06:04.770489,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_29_seed_0_20863188
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.96708244, 'precision': 0.7487848, 'recall': 0.84854805, 'specificity': 0.84854805, 'f1': 0.7893175, 'auroc': 0.96394336, 'binary_precision': 0.50740564, 'binary_recall': 0.7214674, 'binary_specificity': 0.9756288, 'binary_f1_score': 0.5957924}
confusion matrix:
       0     1
0  41273  1031
1    410  1062
---- Validation: 
scalar performance:
{'acc': 0.9658365, 'precision': 0.7456635, 'recall': 0.859304, 'specificity': 0.859304, 'f1': 0.7904544, 'auroc': 0.9514022, 'binary_precision': 0.5005225, 'binary_recall': 0.7449456, 'binary_specificity': 0.97366244, 'binary_f1_score': 0.59875}
confusion matrix:
       0    1
0  17671  478
1    164  479
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9715564, 'precision': 0.84634924, 'recall': 0.7616145, 'specificity': 0.7616145, 'f1': 0.7974447, 'auroc': 0.94394064, 'binary_precision': 0.71282053, 'binary_recall': 0.532567, 'binary_specificity': 0.990662, 'binary_f1_score': 0.60964906}
confusion matrix:
      0    1
0  5941   56
1   122  139
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863188.png
early stop counter: 14
val acc:0.9658365249633789, best validation acc: 0.967539370059967, corresponding to test acc:                         0.9768296480178833 / 0.9787471890449524
after epoch: 22,now: 2024-05-26 21:04:16.885265,epoch time: 0:22:42.923144,used: 8:28:47.693633,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_29_seed_0_20863188
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.96820176, 'precision': 0.7546619, 'recall': 0.83131623, 'specificity': 0.83131623, 'f1': 0.7873834, 'auroc': 0.96408606, 'binary_precision': 0.52041346, 'binary_recall': 0.68456835, 'binary_specificity': 0.97806406, 'binary_f1_score': 0.5913095}
confusion matrix:
       0     1
0  41377   928
1    464  1007
---- Validation: 
scalar performance:
{'acc': 0.9671669, 'precision': 0.7520515, 'recall': 0.83824116, 'specificity': 0.83824116, 'f1': 0.7880846, 'auroc': 0.9500734, 'binary_precision': 0.51487416, 'binary_recall': 0.6998445, 'binary_specificity': 0.97663784, 'binary_f1_score': 0.59327626}
confusion matrix:
       0    1
0  17725  424
1    193  450
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96324706, 'precision': 0.7831089, 'recall': 0.68398565, 'specificity': 0.68398565, 'f1': 0.72179484, 'auroc': 0.93802154, 'binary_precision': 0.5928144, 'binary_recall': 0.37931034, 'binary_specificity': 0.988661, 'binary_f1_score': 0.46261683}
confusion matrix:
      0   1
0  5929  68
1   162  99
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863188.png
early stop counter: 15
val acc:0.9671669006347656, best validation acc: 0.967539370059967, corresponding to test acc:                         0.9768296480178833 / 0.9787471890449524
after epoch: 23,now: 2024-05-26 21:27:01.182914,epoch time: 0:22:44.297649,used: 8:51:31.991282,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_29_seed_0_20863188
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.97041756, 'precision': 0.76930934, 'recall': 0.8140898, 'specificity': 0.8140898, 'f1': 0.7897905, 'auroc': 0.96609175, 'binary_precision': 0.5509849, 'binary_recall': 0.646499, 'binary_specificity': 0.98168063, 'binary_f1_score': 0.59493273}
confusion matrix:
       0    1
0  41530  775
1    520  951
---- Validation: 
scalar performance:
{'acc': 0.9684972, 'precision': 0.7597295, 'recall': 0.83142936, 'specificity': 0.83142936, 'f1': 0.7907163, 'auroc': 0.9501467, 'binary_precision': 0.53075993, 'binary_recall': 0.6842924, 'binary_specificity': 0.9785663, 'binary_f1_score': 0.59782606}
confusion matrix:
       0    1
0  17760  389
1    203  440
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9696389, 'precision': 0.8615339, 'recall': 0.70197934, 'specificity': 0.70197934, 'f1': 0.7570081, 'auroc': 0.947935, 'binary_precision': 0.74825174, 'binary_recall': 0.4099617, 'binary_specificity': 0.993997, 'binary_f1_score': 0.529703}
confusion matrix:
      0    1
0  5961   36
1   154  107
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863188.png
better model found
persisted
after epoch: 24,now: 2024-05-26 21:49:48.288667,epoch time: 0:22:47.105753,used: 9:14:19.097035,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_29_seed_0_20863188
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.96806467, 'precision': 0.7538692, 'recall': 0.8332138, 'specificity': 0.8332138, 'f1': 0.787544, 'auroc': 0.96605647, 'binary_precision': 0.5186892, 'binary_recall': 0.68864715, 'binary_specificity': 0.9777804, 'binary_f1_score': 0.5917056}
confusion matrix:
       0     1
0  41365   940
1    458  1013
---- Validation: 
scalar performance:
{'acc': 0.9665815, 'precision': 0.74877775, 'recall': 0.83493793, 'specificity': 0.83493793, 'f1': 0.7847143, 'auroc': 0.95535314, 'binary_precision': 0.5085519, 'binary_recall': 0.69362366, 'binary_specificity': 0.97625214, 'binary_f1_score': 0.58684206}
confusion matrix:
       0    1
0  17718  431
1    197  446
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96612334, 'precision': 0.8221729, 'recall': 0.67998946, 'specificity': 0.67998946, 'f1': 0.7288721, 'auroc': 0.932722, 'binary_precision': 0.67132866, 'binary_recall': 0.3678161, 'binary_specificity': 0.99216276, 'binary_f1_score': 0.47524753}
confusion matrix:
      0   1
0  5950  47
1   165  96
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863188.png
early stop counter: 1
val acc:0.9665815234184265, best validation acc: 0.9684972167015076, corresponding to test acc:                         0.9696388840675354 / 0.9787471890449524
after epoch: 25,now: 2024-05-26 22:12:30.352892,epoch time: 0:22:42.064225,used: 9:37:01.161260,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_29_seed_0_20863188
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9684759, 'precision': 0.7564361, 'recall': 0.80455494, 'specificity': 0.80455494, 'f1': 0.7781948, 'auroc': 0.9657844, 'binary_precision': 0.525867, 'binary_recall': 0.62882394, 'binary_specificity': 0.980286, 'binary_f1_score': 0.5727554}
confusion matrix:
       0    1
0  41471  834
1    546  925
---- Validation: 
scalar performance:
{'acc': 0.96695405, 'precision': 0.7505748, 'recall': 0.81937957, 'specificity': 0.81937957, 'f1': 0.78032106, 'auroc': 0.95474625, 'binary_precision': 0.51328504, 'binary_recall': 0.66096425, 'binary_specificity': 0.97779495, 'binary_f1_score': 0.5778382}
confusion matrix:
       0    1
0  17746  403
1    218  425
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964845, 'precision': 0.82423544, 'recall': 0.6463404, 'specificity': 0.6463404, 'f1': 0.6983859, 'auroc': 0.9393956, 'binary_precision': 0.67826086, 'binary_recall': 0.29885057, 'binary_specificity': 0.99383026, 'binary_f1_score': 0.4148936}
confusion matrix:
      0   1
0  5960  37
1   183  78
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863188.png
early stop counter: 2
val acc:0.9669540524482727, best validation acc: 0.9684972167015076, corresponding to test acc:                         0.9696388840675354 / 0.9787471890449524
after epoch: 26,now: 2024-05-26 22:35:14.451933,epoch time: 0:22:44.099041,used: 9:59:45.260301,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_29_seed_0_20863188
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9672423, 'precision': 0.7490783, 'recall': 0.8224025, 'specificity': 0.8224025, 'f1': 0.7804734, 'auroc': 0.9674143, 'binary_precision': 0.509865, 'binary_recall': 0.66711956, 'binary_specificity': 0.97768533, 'binary_f1_score': 0.577987}
confusion matrix:
       0    1
0  41360  944
1    490  982
---- Validation: 
scalar performance:
{'acc': 0.965943, 'precision': 0.74580157, 'recall': 0.8481083, 'specificity': 0.8481083, 'f1': 0.78703344, 'auroc': 0.9551958, 'binary_precision': 0.5016216, 'binary_recall': 0.7216174, 'binary_specificity': 0.9745991, 'binary_f1_score': 0.59183675}
confusion matrix:
       0    1
0  17688  461
1    179  464
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9638862, 'precision': 0.7956145, 'recall': 0.6696605, 'specificity': 0.6696605, 'f1': 0.7137065, 'auroc': 0.9278449, 'binary_precision': 0.61904764, 'binary_recall': 0.348659, 'binary_specificity': 0.990662, 'binary_f1_score': 0.44607842}
confusion matrix:
      0   1
0  5941  56
1   170  91
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863188.png
early stop counter: 3
val acc:0.9659429788589478, best validation acc: 0.9684972167015076, corresponding to test acc:                         0.9696388840675354 / 0.9787471890449524
after epoch: 27,now: 2024-05-26 22:57:53.443628,epoch time: 0:22:38.991695,used: 10:22:24.251996,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_29_seed_0_20863188
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9687728, 'precision': 0.75803375, 'recall': 0.836861, 'specificity': 0.836861, 'f1': 0.79161286, 'auroc': 0.96772665, 'binary_precision': 0.5267765, 'binary_recall': 0.6954453, 'binary_specificity': 0.9782768, 'binary_f1_score': 0.5994726}
confusion matrix:
       0     1
0  41386   919
1    448  1023
---- Validation: 
scalar performance:
{'acc': 0.9665815, 'precision': 0.7489737, 'recall': 0.8431885, 'specificity': 0.8431885, 'f1': 0.7876563, 'auroc': 0.95317304, 'binary_precision': 0.5083426, 'binary_recall': 0.71073097, 'binary_specificity': 0.975646, 'binary_f1_score': 0.5927367}
confusion matrix:
       0    1
0  17707  442
1    186  457
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96244806, 'precision': 0.7843877, 'recall': 0.6469221, 'specificity': 0.6469221, 'f1': 0.6913255, 'auroc': 0.92440474, 'binary_precision': 0.5984849, 'binary_recall': 0.30268198, 'binary_specificity': 0.99116224, 'binary_f1_score': 0.40203562}
confusion matrix:
      0   1
0  5944  53
1   182  79
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863188.png
early stop counter: 4
val acc:0.9665815234184265, best validation acc: 0.9684972167015076, corresponding to test acc:                         0.9696388840675354 / 0.9787471890449524
after epoch: 28,now: 2024-05-26 23:20:30.485915,epoch time: 0:22:37.042287,used: 10:45:01.294283,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_29_seed_0_20863188
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9692297, 'precision': 0.7604036, 'recall': 0.84674704, 'specificity': 0.84674704, 'f1': 0.796718, 'auroc': 0.9683114, 'binary_precision': 0.5308081, 'binary_recall': 0.7154527, 'binary_specificity': 0.97804147, 'binary_f1_score': 0.609452}
confusion matrix:
       0     1
0  41378   929
1    418  1051
---- Validation: 
scalar performance:
{'acc': 0.9668476, 'precision': 0.7505637, 'recall': 0.85157686, 'specificity': 0.85157686, 'f1': 0.7915456, 'auroc': 0.9538418, 'binary_precision': 0.510917, 'binary_recall': 0.7278383, 'binary_specificity': 0.97531545, 'binary_f1_score': 0.6003849}
confusion matrix:
       0    1
0  17701  448
1    175  468
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642058, 'precision': 0.7929308, 'recall': 0.6881506, 'specificity': 0.6881506, 'f1': 0.72782534, 'auroc': 0.9365023, 'binary_precision': 0.6121212, 'binary_recall': 0.38697317, 'binary_specificity': 0.989328, 'binary_f1_score': 0.4741784}
confusion matrix:
      0    1
0  5933   64
1   160  101
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863188.png
early stop counter: 5
val acc:0.9668475985527039, best validation acc: 0.9684972167015076, corresponding to test acc:                         0.9696388840675354 / 0.9787471890449524
after epoch: 29,now: 2024-05-26 23:43:17.060928,epoch time: 0:22:46.575013,used: 11:07:47.869296,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_29_seed_0_20863188
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9689556, 'precision': 0.7593559, 'recall': 0.81891084, 'specificity': 0.81891084, 'f1': 0.7857139, 'auroc': 0.9651272, 'binary_precision': 0.53070176, 'binary_recall': 0.6580557, 'binary_specificity': 0.979766, 'binary_f1_score': 0.58755696}
confusion matrix:
       0    1
0  41449  856
1    503  968
---- Validation: 
scalar performance:
{'acc': 0.968178, 'precision': 0.7578366, 'recall': 0.8290139, 'specificity': 0.8290139, 'f1': 0.7885952, 'auroc': 0.9543062, 'binary_precision': 0.52714115, 'binary_recall': 0.67962676, 'binary_specificity': 0.978401, 'binary_f1_score': 0.59375}
confusion matrix:
       0    1
0  17757  392
1    206  437
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96260786, 'precision': 0.77914345, 'recall': 0.67082584, 'specificity': 0.67082584, 'f1': 0.71042466, 'auroc': 0.93015856, 'binary_precision': 0.58598727, 'binary_recall': 0.35249043, 'binary_specificity': 0.98916125, 'binary_f1_score': 0.4401914}
confusion matrix:
      0   1
0  5932  65
1   169  92
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863188.png
early stop counter: 6
val acc:0.9681779742240906, best validation acc: 0.9684972167015076, corresponding to test acc:                         0.9696388840675354 / 0.9787471890449524
after epoch: 30,now: 2024-05-27 00:05:55.668719,epoch time: 0:22:38.607791,used: 11:30:26.477087,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_29_seed_0_20863188
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 11:30:26.477087 at 2024-05-27 00:05:55.668719
persisted model performance metric: 

scalar performance:
{'acc': 0.9699584, 'precision': 0.86020625, 'recall': 0.7094754, 'specificity': 0.7094754, 'f1': 0.762967, 'auroc': 0.9380442, 'binary_precision': 0.74496645, 'binary_recall': 0.42528737, 'binary_specificity': 0.9936635, 'binary_f1_score': 0.54146343}
confusion matrix:
      0    1
0  5959   38
1   150  111
oracle model performance metric: 

scalar performance:
{'acc': 0.9785874, 'precision': 0.89286685, 'recall': 0.820253, 'specificity': 0.820253, 'f1': 0.8524879, 'auroc': 0.9339881, 'binary_precision': 0.80094784, 'binary_recall': 0.6475096, 'binary_specificity': 0.9929965, 'binary_f1_score': 0.71610165}
confusion matrix:
      0    1
0  5955   42
1    92  169
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs32/rule_results/9.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs32/rule_results/9.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs32/confusion_matrix/9.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 494735 KiB |  21448 MiB |    791 TiB |    791 TiB |
|       from large pool | 405504 KiB |  21375 MiB |    790 TiB |    790 TiB |
|       from small pool |  89231 KiB |    123 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 494735 KiB |  21448 MiB |    791 TiB |    791 TiB |
|       from large pool | 405504 KiB |  21375 MiB |    790 TiB |    790 TiB |
|       from small pool |  89231 KiB |    123 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476573 KiB |  21332 MiB |    788 TiB |    788 TiB |
|       from large pool | 387840 KiB |  21259 MiB |    787 TiB |    787 TiB |
|       from small pool |  88733 KiB |    122 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  22140 MiB |  22140 MiB |  22140 MiB |      0 B   |
|       from large pool |  22016 MiB |  22016 MiB |  22016 MiB |      0 B   |
|       from small pool |    124 MiB |    124 MiB |    124 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |    802 MiB |   1473 MiB | 378637 GiB | 378636 GiB |
|       from large pool |    794 MiB |   1469 MiB | 376780 GiB | 376779 GiB |
|       from small pool |      8 MiB |     10 MiB |   1857 GiB |   1857 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2553    |    3982    |   69785 K  |   69783 K  |
|       from large pool |      87    |     908    |   28293 K  |   28293 K  |
|       from small pool |    2466    |    3893    |   41491 K  |   41489 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2553    |    3982    |   69785 K  |   69783 K  |
|       from large pool |      87    |     908    |   28293 K  |   28293 K  |
|       from small pool |    2466    |    3893    |   41491 K  |   41489 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     510    |     510    |     510    |       0    |
|       from large pool |     448    |     448    |     448    |       0    |
|       from small pool |      62    |      62    |      62    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      77    |    1407    |   38720 K  |   38720 K  |
|       from large pool |      21    |     225    |   17801 K  |   17801 K  |
|       from small pool |      56    |    1385    |   20918 K  |   20918 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  21448 MiB |    791 TiB |    791 TiB |
|       from large pool |  16640 KiB |  21375 MiB |    790 TiB |    790 TiB |
|       from small pool |      0 KiB |    123 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  21448 MiB |    791 TiB |    791 TiB |
|       from large pool |  16640 KiB |  21375 MiB |    790 TiB |    790 TiB |
|       from small pool |      0 KiB |    123 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  21332 MiB |    788 TiB |    788 TiB |
|       from large pool |  16640 KiB |  21259 MiB |    787 TiB |    787 TiB |
|       from small pool |      0 KiB |    122 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1286 MiB |  22140 MiB |  22140 MiB |  20854 MiB |
|       from large pool |   1190 MiB |  22016 MiB |  22016 MiB |  20826 MiB |
|       from small pool |     96 MiB |    124 MiB |    124 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 139008 KiB |   1473 MiB | 378638 GiB | 378637 GiB |
|       from large pool | 139008 KiB |   1469 MiB | 376780 GiB | 376780 GiB |
|       from small pool |      0 KiB |     27 MiB |   1857 GiB |   1857 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3982    |   69785 K  |   69785 K  |
|       from large pool |       2    |     908    |   28293 K  |   28293 K  |
|       from small pool |       0    |    3893    |   41491 K  |   41491 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3982    |   69785 K  |   69785 K  |
|       from large pool |       2    |     908    |   28293 K  |   28293 K  |
|       from small pool |       0    |    3893    |   41491 K  |   41491 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      77    |     510    |     510    |     433    |
|       from large pool |      29    |     448    |     448    |     419    |
|       from small pool |      48    |      62    |      62    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1407    |   38721 K  |   38721 K  |
|       from large pool |       3    |     225    |   17801 K  |   17801 K  |
|       from small pool |       0    |    1385    |   20919 K  |   20919 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  21448 MiB |    791 TiB |    791 TiB |
|       from large pool |  16640 KiB |  21375 MiB |    790 TiB |    790 TiB |
|       from small pool |      0 KiB |    123 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  21448 MiB |    791 TiB |    791 TiB |
|       from large pool |  16640 KiB |  21375 MiB |    790 TiB |    790 TiB |
|       from small pool |      0 KiB |    123 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  21332 MiB |    788 TiB |    788 TiB |
|       from large pool |  16640 KiB |  21259 MiB |    787 TiB |    787 TiB |
|       from small pool |      0 KiB |    122 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1286 MiB |  22140 MiB |  22140 MiB |  20854 MiB |
|       from large pool |   1190 MiB |  22016 MiB |  22016 MiB |  20826 MiB |
|       from small pool |     96 MiB |    124 MiB |    124 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 139008 KiB |   1473 MiB | 378638 GiB | 378637 GiB |
|       from large pool | 139008 KiB |   1469 MiB | 376780 GiB | 376780 GiB |
|       from small pool |      0 KiB |     27 MiB |   1857 GiB |   1857 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3982    |   69785 K  |   69785 K  |
|       from large pool |       2    |     908    |   28293 K  |   28293 K  |
|       from small pool |       0    |    3893    |   41491 K  |   41491 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3982    |   69785 K  |   69785 K  |
|       from large pool |       2    |     908    |   28293 K  |   28293 K  |
|       from small pool |       0    |    3893    |   41491 K  |   41491 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      77    |     510    |     510    |     433    |
|       from large pool |      29    |     448    |     448    |     419    |
|       from small pool |      48    |      62    |      62    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1407    |   38721 K  |   38721 K  |
|       from large pool |       3    |     225    |   17801 K  |   17801 K  |
|       from small pool |       0    |    1385    |   20919 K  |   20919 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_17_06_seed_1_20863188

 Experiment start at: 2024-05-27 00:17:06.701832
before training, model accuracy: 0.09474702179431915
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9669708, 'precision': 0.66545504, 'recall': 0.50260884, 'specificity': 0.50260884, 'f1': 0.49706697, 'auroc': 0.87150747, 'binary_precision': 0.36363637, 'binary_recall': 0.0055478504, 'binary_specificity': 0.9996698, 'binary_f1_score': 0.010928962}
confusion matrix:
       0   1
0  42384  14
1   1434   8
---- Validation: 
scalar performance:
{'acc': 0.96387404, 'precision': 0.6906212, 'recall': 0.50704193, 'specificity': 0.50704193, 'f1': 0.5051446, 'auroc': 0.8752495, 'binary_precision': 0.41666666, 'binary_recall': 0.014858841, 'binary_specificity': 0.9992251, 'binary_f1_score': 0.028694406}
confusion matrix:
       0   1
0  18053  14
1    663  10
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95939416, 'precision': 0.92974496, 'recall': 0.5172236, 'specificity': 0.5172236, 'f1': 0.52295613, 'auroc': 0.87034273, 'binary_precision': 0.9, 'binary_recall': 0.034615386, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.06666667}
confusion matrix:
      0  1
0  5945  1
1   251  9
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863188.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-27 00:40:55.219579,epoch time: 0:23:48.517747,used: 0:23:48.517747,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_17_06_seed_1_20863188
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96649176, 'precision': 0.7112429, 'recall': 0.54288983, 'specificity': 0.54288983, 'f1': 0.56615067, 'auroc': 0.908206, 'binary_precision': 0.4526316, 'binary_recall': 0.089459084, 'binary_specificity': 0.9963206, 'binary_f1_score': 0.14939202}
confusion matrix:
       0    1
0  42242  156
1   1313  129
---- Validation: 
scalar performance:
{'acc': 0.9647812, 'precision': 0.74788, 'recall': 0.5990667, 'specificity': 0.5990667, 'f1': 0.6384057, 'auroc': 0.90882194, 'binary_precision': 0.5247148, 'binary_recall': 0.205052, 'binary_specificity': 0.99308133, 'binary_f1_score': 0.29487178}
confusion matrix:
       0    1
0  17942  125
1    535  138
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621334, 'precision': 0.8594415, 'recall': 0.5701448, 'specificity': 0.5701448, 'f1': 0.61003274, 'auroc': 0.88885015, 'binary_precision': 0.75510204, 'binary_recall': 0.1423077, 'binary_specificity': 0.99798185, 'binary_f1_score': 0.23948221}
confusion matrix:
      0   1
0  5934  12
1   223  37
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863188.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-05-27 01:03:37.232256,epoch time: 0:22:42.012677,used: 0:46:30.530424,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_17_06_seed_1_20863188
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96699363, 'precision': 0.734979, 'recall': 0.618995, 'specificity': 0.618995, 'f1': 0.6561207, 'auroc': 0.9236202, 'binary_precision': 0.49511856, 'binary_recall': 0.24652778, 'binary_specificity': 0.9914623, 'binary_f1_score': 0.32916087}
confusion matrix:
       0    1
0  42038  362
1   1085  355
---- Validation: 
scalar performance:
{'acc': 0.9641409, 'precision': 0.7398375, 'recall': 0.70602465, 'specificity': 0.70602465, 'f1': 0.7214957, 'auroc': 0.9242125, 'binary_precision': 0.5008696, 'binary_recall': 0.42793462, 'binary_specificity': 0.9841147, 'binary_f1_score': 0.4615385}
confusion matrix:
       0    1
0  17780  287
1    385  288
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97019017, 'precision': 0.89417386, 'recall': 0.68468845, 'specificity': 0.68468845, 'f1': 0.7482495, 'auroc': 0.91803527, 'binary_precision': 0.81512606, 'binary_recall': 0.37307692, 'binary_specificity': 0.99630004, 'binary_f1_score': 0.51187336}
confusion matrix:
      0   1
0  5924  22
1   163  97
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863188.png
new oracle model saved
early stop counter: 1
val acc:0.9641408920288086, best validation acc: 0.9647812247276306, corresponding to test acc:                         0.9621334075927734 / 0.970190167427063
after epoch: 3,now: 2024-05-27 01:26:18.300032,epoch time: 0:22:41.067776,used: 1:09:11.598200,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_17_06_seed_1_20863188
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9670164, 'precision': 0.73750365, 'recall': 0.6546986, 'specificity': 0.6546986, 'f1': 0.6864617, 'auroc': 0.92918134, 'binary_precision': 0.49784482, 'binary_recall': 0.32038835, 'binary_specificity': 0.9890089, 'binary_f1_score': 0.38987345}
confusion matrix:
       0    1
0  41932  466
1    980  462
---- Validation: 
scalar performance:
{'acc': 0.96403414, 'precision': 0.73977476, 'recall': 0.72671205, 'specificity': 0.72671205, 'f1': 0.7330381, 'auroc': 0.9296365, 'binary_precision': 0.4992126, 'binary_recall': 0.47102526, 'binary_specificity': 0.98239887, 'binary_f1_score': 0.48470947}
confusion matrix:
       0    1
0  17749  318
1    356  317
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.972446, 'precision': 0.89803964, 'recall': 0.7171285, 'specificity': 0.7171285, 'f1': 0.778597, 'auroc': 0.9108224, 'binary_precision': 0.8201439, 'binary_recall': 0.43846154, 'binary_specificity': 0.9957955, 'binary_f1_score': 0.57142854}
confusion matrix:
      0    1
0  5921   25
1   146  114
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863188.png
new oracle model saved
early stop counter: 2
val acc:0.9640341401100159, best validation acc: 0.9647812247276306, corresponding to test acc:                         0.9621334075927734 / 0.9724460244178772
after epoch: 4,now: 2024-05-27 01:48:53.670651,epoch time: 0:22:35.370619,used: 1:31:46.968819,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_17_06_seed_1_20863188
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96738136, 'precision': 0.7426899, 'recall': 0.70278484, 'specificity': 0.70278484, 'f1': 0.7207589, 'auroc': 0.93612015, 'binary_precision': 0.50500834, 'binary_recall': 0.41955617, 'binary_specificity': 0.9860135, 'binary_f1_score': 0.45833337}
confusion matrix:
       0    1
0  41805  593
1    837  605
---- Validation: 
scalar performance:
{'acc': 0.9644077, 'precision': 0.7431101, 'recall': 0.7469332, 'specificity': 0.7469332, 'f1': 0.74500495, 'auroc': 0.9362099, 'binary_precision': 0.50438595, 'binary_recall': 0.51263, 'binary_specificity': 0.9812365, 'binary_f1_score': 0.5084746}
confusion matrix:
       0    1
0  17728  339
1    328  345
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9756687, 'precision': 0.8994147, 'recall': 0.766624, 'specificity': 0.766624, 'f1': 0.81852436, 'auroc': 0.9241573, 'binary_precision': 0.8187134, 'binary_recall': 0.53846157, 'binary_specificity': 0.9947864, 'binary_f1_score': 0.649652}
confusion matrix:
      0    1
0  5915   31
1   120  140
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863188.png
new oracle model saved
early stop counter: 3
val acc:0.9644076824188232, best validation acc: 0.9647812247276306, corresponding to test acc:                         0.9621334075927734 / 0.975668728351593
after epoch: 5,now: 2024-05-27 02:11:22.645026,epoch time: 0:22:28.974375,used: 1:54:15.943194,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_17_06_seed_1_20863188
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9679288, 'precision': 0.74830306, 'recall': 0.66990805, 'specificity': 0.66990805, 'f1': 0.7010187, 'auroc': 0.9403912, 'binary_precision': 0.51844263, 'binary_recall': 0.3509015, 'binary_specificity': 0.98891455, 'binary_f1_score': 0.41852772}
confusion matrix:
       0    1
0  41928  470
1    936  506
---- Validation: 
scalar performance:
{'acc': 0.96526146, 'precision': 0.7491462, 'recall': 0.7395081, 'specificity': 0.7395081, 'f1': 0.74422073, 'auroc': 0.9412197, 'binary_precision': 0.51702785, 'binary_recall': 0.4962853, 'binary_specificity': 0.9827309, 'binary_f1_score': 0.5064443}
confusion matrix:
       0    1
0  17755  312
1    339  334
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9756687, 'precision': 0.91972864, 'recall': 0.7482341, 'specificity': 0.7482341, 'f1': 0.81001055, 'auroc': 0.92653835, 'binary_precision': 0.86092716, 'binary_recall': 0.5, 'binary_specificity': 0.9964682, 'binary_f1_score': 0.63260347}
confusion matrix:
      0    1
0  5925   21
1   130  130
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863188.png
better model found
persisted
after epoch: 6,now: 2024-05-27 02:33:57.319964,epoch time: 0:22:34.674938,used: 2:16:50.618132,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_17_06_seed_1_20863188
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96861315, 'precision': 0.7551042, 'recall': 0.6842348, 'specificity': 0.6842348, 'f1': 0.7133833, 'auroc': 0.942443, 'binary_precision': 0.53106797, 'binary_recall': 0.37986112, 'binary_specificity': 0.9886085, 'binary_f1_score': 0.442915}
confusion matrix:
       0    1
0  41917  483
1    893  547
---- Validation: 
scalar performance:
{'acc': 0.96499467, 'precision': 0.747013, 'recall': 0.7100438, 'specificity': 0.7100438, 'f1': 0.72685856, 'auroc': 0.944823, 'binary_precision': 0.5149385, 'binary_recall': 0.43536404, 'binary_specificity': 0.9847235, 'binary_f1_score': 0.47181964}
confusion matrix:
       0    1
0  17791  276
1    380  293
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9751853, 'precision': 0.89937365, 'recall': 0.7590158, 'specificity': 0.7590158, 'f1': 0.81282467, 'auroc': 0.93330693, 'binary_precision': 0.8192771, 'binary_recall': 0.52307695, 'binary_specificity': 0.9949546, 'binary_f1_score': 0.63849765}
confusion matrix:
      0    1
0  5916   30
1   124  136
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863188.png
early stop counter: 1
val acc:0.9649946689605713, best validation acc: 0.9652614593505859, corresponding to test acc:                         0.975668728351593 / 0.975668728351593
after epoch: 7,now: 2024-05-27 02:56:31.848815,epoch time: 0:22:34.528851,used: 2:39:25.146983,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_17_06_seed_1_20863188
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.96749544, 'precision': 0.74517787, 'recall': 0.771843, 'specificity': 0.771843, 'f1': 0.7577448, 'auroc': 0.9486004, 'binary_precision': 0.50529593, 'binary_recall': 0.56241333, 'binary_specificity': 0.9812727, 'binary_f1_score': 0.53232694}
confusion matrix:
       0    1
0  41604  794
1    631  811
---- Validation: 
scalar performance:
{'acc': 0.96526146, 'precision': 0.74964416, 'recall': 0.7995906, 'specificity': 0.7995906, 'f1': 0.77205944, 'auroc': 0.9464435, 'binary_precision': 0.5135135, 'binary_recall': 0.62109953, 'binary_specificity': 0.9780816, 'binary_f1_score': 0.5622058}
confusion matrix:
       0    1
0  17671  396
1    255  418
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.973574, 'precision': 0.8422896, 'recall': 0.81702244, 'specificity': 0.81702244, 'f1': 0.8291162, 'auroc': 0.94038844, 'binary_precision': 0.7, 'binary_recall': 0.64615387, 'binary_specificity': 0.987891, 'binary_f1_score': 0.672}
confusion matrix:
      0    1
0  5874   72
1    92  168
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863188.png
early stop counter: 2
val acc:0.9652614593505859, best validation acc: 0.9652614593505859, corresponding to test acc:                         0.975668728351593 / 0.975668728351593
after epoch: 8,now: 2024-05-27 03:19:06.840403,epoch time: 0:22:34.991588,used: 3:02:00.138571,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_17_06_seed_1_20863188
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9689553, 'precision': 0.7566037, 'recall': 0.7360885, 'specificity': 0.7360885, 'f1': 0.74587405, 'auroc': 0.9498607, 'binary_precision': 0.53061223, 'binary_recall': 0.48682386, 'binary_specificity': 0.9853531, 'binary_f1_score': 0.5077758}
confusion matrix:
       0    1
0  41777  621
1    740  702
---- Validation: 
scalar performance:
{'acc': 0.9666489, 'precision': 0.7604208, 'recall': 0.7323597, 'specificity': 0.7323597, 'f1': 0.7455002, 'auroc': 0.9440403, 'binary_precision': 0.5401338, 'binary_recall': 0.47994056, 'binary_specificity': 0.9847789, 'binary_f1_score': 0.5082612}
confusion matrix:
       0    1
0  17792  275
1    350  323
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9730905, 'precision': 0.8511821, 'recall': 0.78734636, 'specificity': 0.78734636, 'f1': 0.8157249, 'auroc': 0.94347787, 'binary_precision': 0.7203792, 'binary_recall': 0.5846154, 'binary_specificity': 0.9900774, 'binary_f1_score': 0.6454353}
confusion matrix:
      0    1
0  5887   59
1   108  152
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863188.png
better model found
persisted
after epoch: 9,now: 2024-05-27 03:41:39.202617,epoch time: 0:22:32.362214,used: 3:24:32.500785,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_17_06_seed_1_20863188
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.96827096, 'precision': 0.7504879, 'recall': 0.74494207, 'specificity': 0.74494207, 'f1': 0.74768054, 'auroc': 0.953801, 'binary_precision': 0.5177557, 'binary_recall': 0.50589865, 'binary_specificity': 0.9839855, 'binary_f1_score': 0.5117585}
confusion matrix:
       0    1
0  41720  679
1    712  729
---- Validation: 
scalar performance:
{'acc': 0.96451443, 'precision': 0.74414694, 'recall': 0.75843287, 'specificity': 0.75843287, 'f1': 0.7510617, 'auroc': 0.9447553, 'binary_precision': 0.50560224, 'binary_recall': 0.53640413, 'binary_specificity': 0.9804616, 'binary_f1_score': 0.5205479}
confusion matrix:
       0    1
0  17714  353
1    312  361
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.973574, 'precision': 0.860676, 'recall': 0.7802427, 'specificity': 0.7802427, 'f1': 0.81487834, 'auroc': 0.9424498, 'binary_precision': 0.74, 'binary_recall': 0.5692308, 'binary_specificity': 0.9912546, 'binary_f1_score': 0.6434783}
confusion matrix:
      0    1
0  5894   52
1   112  148
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863188.png
early stop counter: 1
val acc:0.964514434337616, best validation acc: 0.9666488766670227, corresponding to test acc:                         0.9730905294418335 / 0.975668728351593
after epoch: 10,now: 2024-05-27 04:04:10.270880,epoch time: 0:22:31.068263,used: 3:47:03.569048,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_17_06_seed_1_20863188
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96760947, 'precision': 0.7464038, 'recall': 0.7913289, 'specificity': 0.7913289, 'f1': 0.766774, 'auroc': 0.9529754, 'binary_precision': 0.50641024, 'binary_recall': 0.6026352, 'binary_specificity': 0.98002267, 'binary_f1_score': 0.5503483}
confusion matrix:
       0    1
0  41551  847
1    573  869
---- Validation: 
scalar performance:
{'acc': 0.96451443, 'precision': 0.74473584, 'recall': 0.7798909, 'specificity': 0.7798909, 'f1': 0.76098657, 'auroc': 0.9479953, 'binary_precision': 0.50516796, 'binary_recall': 0.58098066, 'binary_specificity': 0.97880113, 'binary_f1_score': 0.54042846}
confusion matrix:
       0    1
0  17684  383
1    282  391
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9730905, 'precision': 0.84324664, 'recall': 0.80389726, 'specificity': 0.80389726, 'f1': 0.82224005, 'auroc': 0.9450317, 'binary_precision': 0.70305675, 'binary_recall': 0.61923075, 'binary_specificity': 0.9885637, 'binary_f1_score': 0.65848666}
confusion matrix:
      0    1
0  5878   68
1    99  161
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863188.png
early stop counter: 2
val acc:0.964514434337616, best validation acc: 0.9666488766670227, corresponding to test acc:                         0.9730905294418335 / 0.975668728351593
after epoch: 11,now: 2024-05-27 04:26:42.517024,epoch time: 0:22:32.246144,used: 4:09:35.815192,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_17_06_seed_1_20863188
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.96849906, 'precision': 0.75229824, 'recall': 0.7757114, 'specificity': 0.7757114, 'f1': 0.76342803, 'auroc': 0.95576704, 'binary_precision': 0.5192916, 'binary_recall': 0.56934816, 'binary_specificity': 0.9820746, 'binary_f1_score': 0.543169}
confusion matrix:
       0    1
0  41638  760
1    621  821
---- Validation: 
scalar performance:
{'acc': 0.9639808, 'precision': 0.7405643, 'recall': 0.7560103, 'specificity': 0.7560103, 'f1': 0.74801695, 'auroc': 0.94447386, 'binary_precision': 0.49860725, 'binary_recall': 0.5319465, 'binary_specificity': 0.98007417, 'binary_f1_score': 0.5147376}
confusion matrix:
       0    1
0  17707  360
1    315  358
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96777314, 'precision': 0.8155489, 'recall': 0.7404357, 'specificity': 0.7404357, 'f1': 0.77233773, 'auroc': 0.93703717, 'binary_precision': 0.6530612, 'binary_recall': 0.4923077, 'binary_specificity': 0.9885637, 'binary_f1_score': 0.5614035}
confusion matrix:
      0    1
0  5878   68
1   132  128
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863188.png
early stop counter: 3
val acc:0.9639807939529419, best validation acc: 0.9666488766670227, corresponding to test acc:                         0.9730905294418335 / 0.975668728351593
after epoch: 12,now: 2024-05-27 04:49:13.258761,epoch time: 0:22:30.741737,used: 4:32:06.556929,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_17_06_seed_1_20863188
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.96927464, 'precision': 0.75809705, 'recall': 0.7727629, 'specificity': 0.7727629, 'f1': 0.7652054, 'auroc': 0.9585035, 'binary_precision': 0.53110677, 'binary_recall': 0.56241333, 'binary_specificity': 0.9831124, 'binary_f1_score': 0.54631186}
confusion matrix:
       0    1
0  41682  716
1    631  811
---- Validation: 
scalar performance:
{'acc': 0.9645678, 'precision': 0.74453795, 'recall': 0.7598911, 'specificity': 0.7598911, 'f1': 0.7519518, 'auroc': 0.95019543, 'binary_precision': 0.50627613, 'binary_recall': 0.5393759, 'binary_specificity': 0.9804063, 'binary_f1_score': 0.5223021}
confusion matrix:
       0    1
0  17713  354
1    310  363
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.972446, 'precision': 0.85215366, 'recall': 0.7722981, 'specificity': 0.7722981, 'f1': 0.80657244, 'auroc': 0.94518566, 'binary_precision': 0.7236181, 'binary_recall': 0.5538462, 'binary_specificity': 0.9907501, 'binary_f1_score': 0.627451}
confusion matrix:
      0    1
0  5891   55
1   116  144
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863188.png
early stop counter: 4
val acc:0.9645677804946899, best validation acc: 0.9666488766670227, corresponding to test acc:                         0.9730905294418335 / 0.975668728351593
after epoch: 13,now: 2024-05-27 05:11:47.590693,epoch time: 0:22:34.331932,used: 4:54:40.888861,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_17_06_seed_1_20863188
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96820253, 'precision': 0.75011146, 'recall': 0.7598155, 'specificity': 0.7598155, 'f1': 0.754861, 'auroc': 0.9566835, 'binary_precision': 0.516, 'binary_recall': 0.5367545, 'binary_specificity': 0.98287654, 'binary_f1_score': 0.52617264}
confusion matrix:
       0    1
0  41672  726
1    668  774
---- Validation: 
scalar performance:
{'acc': 0.9638207, 'precision': 0.7396832, 'recall': 0.7595036, 'specificity': 0.7595036, 'f1': 0.74915016, 'auroc': 0.9492579, 'binary_precision': 0.49658003, 'binary_recall': 0.5393759, 'binary_specificity': 0.97963136, 'binary_f1_score': 0.517094}
confusion matrix:
       0    1
0  17699  368
1    310  363
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9698679, 'precision': 0.8408387, 'recall': 0.7378509, 'specificity': 0.7378509, 'f1': 0.7792067, 'auroc': 0.94885576, 'binary_precision': 0.7039106, 'binary_recall': 0.4846154, 'binary_specificity': 0.9910864, 'binary_f1_score': 0.5740319}
confusion matrix:
      0    1
0  5893   53
1   134  126
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863188.png
early stop counter: 5
val acc:0.9638206958770752, best validation acc: 0.9666488766670227, corresponding to test acc:                         0.9730905294418335 / 0.975668728351593
after epoch: 14,now: 2024-05-27 05:34:15.580866,epoch time: 0:22:27.990173,used: 5:17:08.879034,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_17_06_seed_1_20863188
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.96815693, 'precision': 0.7499329, 'recall': 0.7981781, 'specificity': 0.7981781, 'f1': 0.77169, 'auroc': 0.9600202, 'binary_precision': 0.5129983, 'binary_recall': 0.6162387, 'binary_specificity': 0.98011744, 'binary_f1_score': 0.55989915}
confusion matrix:
       0    1
0  41556  843
1    553  888
---- Validation: 
scalar performance:
{'acc': 0.9635539, 'precision': 0.7390224, 'recall': 0.780108, 'specificity': 0.780108, 'f1': 0.7577293, 'auroc': 0.94962084, 'binary_precision': 0.49370277, 'binary_recall': 0.58246654, 'binary_specificity': 0.97774947, 'binary_f1_score': 0.534424}
confusion matrix:
       0    1
0  17665  402
1    281  392
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9697067, 'precision': 0.8313542, 'recall': 0.7524787, 'specificity': 0.7524787, 'f1': 0.7859975, 'auroc': 0.93950087, 'binary_precision': 0.68367344, 'binary_recall': 0.5153846, 'binary_specificity': 0.9895728, 'binary_f1_score': 0.58771926}
confusion matrix:
      0    1
0  5884   62
1   126  134
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863188.png
early stop counter: 6
val acc:0.9635539054870605, best validation acc: 0.9666488766670227, corresponding to test acc:                         0.9730905294418335 / 0.975668728351593
after epoch: 15,now: 2024-05-27 05:56:48.715469,epoch time: 0:22:33.134603,used: 5:39:42.013637,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_17_06_seed_1_20863188
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9676323, 'precision': 0.74692124, 'recall': 0.80708325, 'specificity': 0.80708325, 'f1': 0.77335596, 'auroc': 0.9563397, 'binary_precision': 0.5063571, 'binary_recall': 0.6352289, 'binary_specificity': 0.9789377, 'binary_f1_score': 0.5635189}
confusion matrix:
       0    1
0  41505  893
1    526  916
---- Validation: 
scalar performance:
{'acc': 0.96376735, 'precision': 0.7410635, 'recall': 0.7981004, 'specificity': 0.7981004, 'f1': 0.7661722, 'auroc': 0.94986886, 'binary_precision': 0.49642858, 'binary_recall': 0.61961365, 'binary_specificity': 0.9765872, 'binary_f1_score': 0.5512227}
confusion matrix:
       0    1
0  17644  423
1    256  417
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97212374, 'precision': 0.84756434, 'recall': 0.77396894, 'specificity': 0.77396894, 'f1': 0.80593586, 'auroc': 0.94401217, 'binary_precision': 0.71428573, 'binary_recall': 0.5576923, 'binary_specificity': 0.9902455, 'binary_f1_score': 0.62634987}
confusion matrix:
      0    1
0  5888   58
1   115  145
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863188.png
early stop counter: 7
val acc:0.9637673497200012, best validation acc: 0.9666488766670227, corresponding to test acc:                         0.9730905294418335 / 0.975668728351593
after epoch: 16,now: 2024-05-27 06:19:17.185915,epoch time: 0:22:28.470446,used: 6:02:10.484083,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_17_06_seed_1_20863188
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9696396, 'precision': 0.7599826, 'recall': 0.792103, 'specificity': 0.792103, 'f1': 0.7750061, 'auroc': 0.96003747, 'binary_precision': 0.53353846, 'binary_recall': 0.6020833, 'binary_specificity': 0.98212266, 'binary_f1_score': 0.56574225}
confusion matrix:
       0    1
0  41642  758
1    573  867
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.74190587, 'recall': 0.7732321, 'specificity': 0.7732321, 'f1': 0.75649554, 'auroc': 0.9503865, 'binary_precision': 0.5, 'binary_recall': 0.5676077, 'binary_specificity': 0.9788565, 'binary_f1_score': 0.5316632}
confusion matrix:
       0    1
0  17685  382
1    291  382
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9729294, 'precision': 0.87311435, 'recall': 0.75048256, 'specificity': 0.75048256, 'f1': 0.7985439, 'auroc': 0.94144547, 'binary_precision': 0.76744187, 'binary_recall': 0.50769234, 'binary_specificity': 0.9932728, 'binary_f1_score': 0.61111116}
confusion matrix:
      0    1
0  5906   40
1   128  132
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863188.png
early stop counter: 8
val acc:0.9640874862670898, best validation acc: 0.9666488766670227, corresponding to test acc:                         0.9730905294418335 / 0.975668728351593
after epoch: 17,now: 2024-05-27 06:41:50.621914,epoch time: 0:22:33.435999,used: 6:24:43.920082,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_17_06_seed_1_20863188
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.96598995, 'precision': 0.73876834, 'recall': 0.8350397, 'specificity': 0.8350397, 'f1': 0.7778398, 'auroc': 0.9599955, 'binary_precision': 0.48806626, 'binary_recall': 0.69486827, 'binary_specificity': 0.9752111, 'binary_f1_score': 0.5733906}
confusion matrix:
       0     1
0  41347  1051
1    440  1002
---- Validation: 
scalar performance:
{'acc': 0.9617396, 'precision': 0.7314498, 'recall': 0.81206936, 'specificity': 0.81206936, 'f1': 0.76496327, 'auroc': 0.947168, 'binary_precision': 0.47608694, 'binary_recall': 0.6508172, 'binary_specificity': 0.9733215, 'binary_f1_score': 0.54990584}
confusion matrix:
       0    1
0  17585  482
1    235  438
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96841764, 'precision': 0.80714524, 'recall': 0.78674674, 'specificity': 0.78674674, 'f1': 0.7965525, 'auroc': 0.94987416, 'binary_precision': 0.6322314, 'binary_recall': 0.5884615, 'binary_specificity': 0.98503196, 'binary_f1_score': 0.60956174}
confusion matrix:
      0    1
0  5857   89
1   107  153
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863188.png
early stop counter: 9
val acc:0.9617395997047424, best validation acc: 0.9666488766670227, corresponding to test acc:                         0.9730905294418335 / 0.975668728351593
after epoch: 18,now: 2024-05-27 07:04:21.139350,epoch time: 0:22:30.517436,used: 6:47:14.437518,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_17_06_seed_1_20863188
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.96888685, 'precision': 0.75479937, 'recall': 0.7935276, 'specificity': 0.7935276, 'f1': 0.7726431, 'auroc': 0.9620024, 'binary_precision': 0.5230677, 'binary_recall': 0.6058293, 'binary_specificity': 0.98122597, 'binary_f1_score': 0.56141484}
confusion matrix:
       0    1
0  41603  796
1    568  873
---- Validation: 
scalar performance:
{'acc': 0.9647279, 'precision': 0.7461517, 'recall': 0.7842932, 'specificity': 0.7842932, 'f1': 0.7636781, 'auroc': 0.9491111, 'binary_precision': 0.5076726, 'binary_recall': 0.58989596, 'binary_specificity': 0.97869045, 'binary_f1_score': 0.5457045}
confusion matrix:
       0    1
0  17682  385
1    276  397
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9732517, 'precision': 0.87315786, 'recall': 0.7561677, 'specificity': 0.7561677, 'f1': 0.80270255, 'auroc': 0.95237005, 'binary_precision': 0.76704544, 'binary_recall': 0.5192308, 'binary_specificity': 0.99310464, 'binary_f1_score': 0.6192661}
confusion matrix:
      0    1
0  5905   41
1   125  135
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863188.png
early stop counter: 10
val acc:0.9647278785705566, best validation acc: 0.9666488766670227, corresponding to test acc:                         0.9730905294418335 / 0.975668728351593
after epoch: 19,now: 2024-05-27 07:26:53.815710,epoch time: 0:22:32.676360,used: 7:09:47.113878,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_17_06_seed_1_20863188
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9689781, 'precision': 0.7552278, 'recall': 0.80115306, 'specificity': 0.80115306, 'f1': 0.7760825, 'auroc': 0.96273994, 'binary_precision': 0.5233918, 'binary_recall': 0.6215278, 'binary_specificity': 0.9807783, 'binary_f1_score': 0.56825393}
confusion matrix:
       0    1
0  41585  815
1    545  895
---- Validation: 
scalar performance:
{'acc': 0.9636606, 'precision': 0.73977983, 'recall': 0.78302443, 'specificity': 0.78302443, 'f1': 0.7593826, 'auroc': 0.949828, 'binary_precision': 0.495, 'binary_recall': 0.5884101, 'binary_specificity': 0.9776388, 'binary_f1_score': 0.53767824}
confusion matrix:
       0    1
0  17663  404
1    277  396
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97180146, 'precision': 0.8469621, 'recall': 0.7682838, 'specificity': 0.7682838, 'f1': 0.80204785, 'auroc': 0.95392686, 'binary_precision': 0.71356785, 'binary_recall': 0.54615384, 'binary_specificity': 0.9904137, 'binary_f1_score': 0.6187363}
confusion matrix:
      0    1
0  5889   57
1   118  142
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863188.png
early stop counter: 11
val acc:0.9636605978012085, best validation acc: 0.9666488766670227, corresponding to test acc:                         0.9730905294418335 / 0.975668728351593
after epoch: 20,now: 2024-05-27 07:49:26.821881,epoch time: 0:22:33.006171,used: 7:32:20.120049,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_17_06_seed_1_20863188
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.968636, 'precision': 0.75295365, 'recall': 0.8280343, 'specificity': 0.8280343, 'f1': 0.785083, 'auroc': 0.9621115, 'binary_precision': 0.5169671, 'binary_recall': 0.67755383, 'binary_specificity': 0.9785147, 'binary_f1_score': 0.58646613}
confusion matrix:
       0    1
0  41490  911
1    464  975
---- Validation: 
scalar performance:
{'acc': 0.9628068, 'precision': 0.7374956, 'recall': 0.8254977, 'specificity': 0.8254977, 'f1': 0.7736905, 'auroc': 0.9542862, 'binary_precision': 0.4871795, 'binary_recall': 0.67756313, 'binary_specificity': 0.97343224, 'binary_f1_score': 0.56681174}
confusion matrix:
       0    1
0  17587  480
1    217  456
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9653561, 'precision': 0.79409105, 'recall': 0.73181844, 'specificity': 0.73181844, 'f1': 0.75882196, 'auroc': 0.94763577, 'binary_precision': 0.61083746, 'binary_recall': 0.47692308, 'binary_specificity': 0.98671377, 'binary_f1_score': 0.53563714}
confusion matrix:
      0    1
0  5867   79
1   136  124
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863188.png
early stop counter: 12
val acc:0.9628068208694458, best validation acc: 0.9666488766670227, corresponding to test acc:                         0.9730905294418335 / 0.975668728351593
after epoch: 21,now: 2024-05-27 08:12:00.774531,epoch time: 0:22:33.952650,used: 7:54:54.072699,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_17_06_seed_1_20863188
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9680201, 'precision': 0.7494302, 'recall': 0.81364775, 'specificity': 0.81364775, 'f1': 0.77745306, 'auroc': 0.9623164, 'binary_precision': 0.510929, 'binary_recall': 0.648405, 'binary_specificity': 0.97889054, 'binary_f1_score': 0.5715159}
confusion matrix:
       0    1
0  41503  895
1    507  935
---- Validation: 
scalar performance:
{'acc': 0.963127, 'precision': 0.73760223, 'recall': 0.7984836, 'specificity': 0.7984836, 'f1': 0.76412964, 'auroc': 0.95150083, 'binary_precision': 0.48946136, 'binary_recall': 0.62109953, 'binary_specificity': 0.9758676, 'binary_f1_score': 0.54747874}
confusion matrix:
       0    1
0  17631  436
1    255  418
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96648407, 'precision': 0.81495965, 'recall': 0.7066612, 'specificity': 0.7066612, 'f1': 0.74833107, 'auroc': 0.94321454, 'binary_precision': 0.6547619, 'binary_recall': 0.42307693, 'binary_specificity': 0.9902455, 'binary_f1_score': 0.51401865}
confusion matrix:
      0    1
0  5888   58
1   150  110
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863188.png
early stop counter: 13
val acc:0.9631270170211792, best validation acc: 0.9666488766670227, corresponding to test acc:                         0.9730905294418335 / 0.975668728351593
after epoch: 22,now: 2024-05-27 08:34:32.861177,epoch time: 0:22:32.086646,used: 8:17:26.159345,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_17_06_seed_1_20863188
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9671761, 'precision': 0.74591374, 'recall': 0.8590992, 'specificity': 0.8590992, 'f1': 0.790635, 'auroc': 0.96443695, 'binary_precision': 0.5007006, 'binary_recall': 0.7434119, 'binary_specificity': 0.9747865, 'binary_f1_score': 0.5983812}
confusion matrix:
       0     1
0  41329  1069
1    370  1072
---- Validation: 
scalar performance:
{'acc': 0.963127, 'precision': 0.7402237, 'recall': 0.847837, 'specificity': 0.847837, 'f1': 0.78284574, 'auroc': 0.9542239, 'binary_precision': 0.49092743, 'binary_recall': 0.72362554, 'binary_specificity': 0.97204846, 'binary_f1_score': 0.58498496}
confusion matrix:
       0    1
0  17562  505
1    186  487
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97019017, 'precision': 0.8268881, 'recall': 0.77479887, 'specificity': 0.77479887, 'f1': 0.79832935, 'auroc': 0.9559492, 'binary_precision': 0.67281103, 'binary_recall': 0.56153846, 'binary_specificity': 0.9880592, 'binary_f1_score': 0.6121593}
confusion matrix:
      0    1
0  5875   71
1   114  146
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863188.png
early stop counter: 14
val acc:0.9631270170211792, best validation acc: 0.9666488766670227, corresponding to test acc:                         0.9730905294418335 / 0.975668728351593
after epoch: 23,now: 2024-05-27 08:56:59.158729,epoch time: 0:22:26.297552,used: 8:39:52.456897,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_17_06_seed_1_20863188
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9707117, 'precision': 0.76509845, 'recall': 0.8667872, 'specificity': 0.8667872, 'f1': 0.806828, 'auroc': 0.96984076, 'binary_precision': 0.53861386, 'binary_recall': 0.75555557, 'binary_specificity': 0.9780189, 'binary_f1_score': 0.6289018}
confusion matrix:
       0     1
0  41468   932
1    352  1088
---- Validation: 
scalar performance:
{'acc': 0.96627533, 'precision': 0.7557417, 'recall': 0.84517825, 'specificity': 0.84517825, 'f1': 0.79295087, 'auroc': 0.95700586, 'binary_precision': 0.5222584, 'binary_recall': 0.71471024, 'binary_specificity': 0.9756462, 'binary_f1_score': 0.6035131}
confusion matrix:
       0    1
0  17627  440
1    192  481
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97019017, 'precision': 0.841584, 'recall': 0.74353606, 'specificity': 0.74353606, 'f1': 0.78346807, 'auroc': 0.95165396, 'binary_precision': 0.704918, 'binary_recall': 0.49615383, 'binary_specificity': 0.9909183, 'binary_f1_score': 0.58239275}
confusion matrix:
      0    1
0  5892   54
1   131  129
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863188.png
early stop counter: 15
val acc:0.9662753343582153, best validation acc: 0.9666488766670227, corresponding to test acc:                         0.9730905294418335 / 0.975668728351593
after epoch: 24,now: 2024-05-27 09:19:53.339858,epoch time: 0:22:54.181129,used: 9:02:46.638026,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_17_06_seed_1_20863188
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.970073, 'precision': 0.7622844, 'recall': 0.82877696, 'specificity': 0.82877696, 'f1': 0.7913714, 'auroc': 0.9648756, 'binary_precision': 0.53563595, 'binary_recall': 0.6775312, 'binary_specificity': 0.98002267, 'binary_f1_score': 0.5982853}
confusion matrix:
       0    1
0  41551  847
1    465  977
---- Validation: 
scalar performance:
{'acc': 0.96542156, 'precision': 0.7507179, 'recall': 0.8096873, 'specificity': 0.8096873, 'f1': 0.7767062, 'auroc': 0.9555603, 'binary_precision': 0.5148987, 'binary_recall': 0.6419019, 'binary_specificity': 0.9774727, 'binary_f1_score': 0.57142854}
confusion matrix:
       0    1
0  17660  407
1    241  432
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96728975, 'precision': 0.83267736, 'recall': 0.6942088, 'specificity': 0.6942088, 'f1': 0.7433775, 'auroc': 0.95327115, 'binary_precision': 0.6912752, 'binary_recall': 0.39615384, 'binary_specificity': 0.99226373, 'binary_f1_score': 0.5036675}
confusion matrix:
      0    1
0  5900   46
1   157  103
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863188.png
early stop counter: 16
val acc:0.9654215574264526, best validation acc: 0.9666488766670227, corresponding to test acc:                         0.9730905294418335 / 0.975668728351593
after epoch: 25,now: 2024-05-27 09:42:45.076393,epoch time: 0:22:51.736535,used: 9:25:38.374561,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_17_06_seed_1_20863188
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.96922904, 'precision': 0.75690603, 'recall': 0.84207344, 'specificity': 0.84207344, 'f1': 0.7927369, 'auroc': 0.9666153, 'binary_precision': 0.52393204, 'binary_recall': 0.7059639, 'binary_specificity': 0.9781829, 'binary_f1_score': 0.6014771}
confusion matrix:
       0     1
0  41473   925
1    424  1018
---- Validation: 
scalar performance:
{'acc': 0.9646745, 'precision': 0.7471149, 'recall': 0.8314732, 'specificity': 0.8314732, 'f1': 0.7823396, 'auroc': 0.95472187, 'binary_precision': 0.50601095, 'binary_recall': 0.6879643, 'binary_specificity': 0.974982, 'binary_f1_score': 0.58312345}
confusion matrix:
       0    1
0  17615  452
1    210  463
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96761197, 'precision': 0.81987345, 'recall': 0.72563976, 'specificity': 0.72563976, 'f1': 0.76371354, 'auroc': 0.9474341, 'binary_precision': 0.6629834, 'binary_recall': 0.46153846, 'binary_specificity': 0.989741, 'binary_f1_score': 0.5442177}
confusion matrix:
      0    1
0  5885   61
1   140  120
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863188.png
early stop counter: 17
val acc:0.9646744728088379, best validation acc: 0.9666488766670227, corresponding to test acc:                         0.9730905294418335 / 0.975668728351593
after epoch: 26,now: 2024-05-27 10:05:07.189773,epoch time: 0:22:22.113380,used: 9:48:00.487941,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_17_06_seed_1_20863188
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9694799, 'precision': 0.7587339, 'recall': 0.81205785, 'specificity': 0.81205785, 'f1': 0.78262633, 'auroc': 0.96467054, 'binary_precision': 0.5296804, 'binary_recall': 0.64355063, 'binary_specificity': 0.98056513, 'binary_f1_score': 0.58108956}
confusion matrix:
       0    1
0  41574  824
1    514  928
---- Validation: 
scalar performance:
{'acc': 0.9659552, 'precision': 0.7538214, 'recall': 0.80710304, 'specificity': 0.80710304, 'f1': 0.7776147, 'auroc': 0.9553033, 'binary_precision': 0.52131546, 'binary_recall': 0.6359584, 'binary_specificity': 0.97824764, 'binary_f1_score': 0.5729585}
confusion matrix:
       0    1
0  17674  393
1    245  428
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.965195, 'precision': 0.813695, 'recall': 0.6747258, 'specificity': 0.6747258, 'f1': 0.72235084, 'auroc': 0.9526074, 'binary_precision': 0.6549296, 'binary_recall': 0.3576923, 'binary_specificity': 0.9917592, 'binary_f1_score': 0.46268657}
confusion matrix:
      0   1
0  5897  49
1   167  93
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863188.png
early stop counter: 18
val acc:0.9659551978111267, best validation acc: 0.9666488766670227, corresponding to test acc:                         0.9730905294418335 / 0.975668728351593
after epoch: 27,now: 2024-05-27 10:27:14.152945,epoch time: 0:22:06.963172,used: 10:10:07.451113,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_17_06_seed_1_20863188
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.96904653, 'precision': 0.7557048, 'recall': 0.8264587, 'specificity': 0.8264587, 'f1': 0.78629065, 'auroc': 0.96828425, 'binary_precision': 0.52260494, 'binary_recall': 0.6738376, 'binary_specificity': 0.9790797, 'binary_f1_score': 0.58866316}
confusion matrix:
       0    1
0  41512  887
1    470  971
---- Validation: 
scalar performance:
{'acc': 0.964461, 'precision': 0.74645835, 'recall': 0.8449526, 'specificity': 0.8449526, 'f1': 0.7864169, 'auroc': 0.9551894, 'binary_precision': 0.5036573, 'binary_recall': 0.7161961, 'binary_specificity': 0.973709, 'binary_f1_score': 0.59141105}
confusion matrix:
       0    1
0  17592  475
1    191  482
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9634225, 'precision': 0.79661596, 'recall': 0.65724987, 'specificity': 0.65724987, 'f1': 0.7032133, 'auroc': 0.9447365, 'binary_precision': 0.62222224, 'binary_recall': 0.32307693, 'binary_specificity': 0.99142283, 'binary_f1_score': 0.42531648}
confusion matrix:
      0   1
0  5895  51
1   176  84
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863188.png
early stop counter: 19
val acc:0.9644610285758972, best validation acc: 0.9666488766670227, corresponding to test acc:                         0.9730905294418335 / 0.975668728351593
after epoch: 28,now: 2024-05-27 10:49:33.004056,epoch time: 0:22:18.851111,used: 10:32:26.302224,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_17_06_seed_1_20863188
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9685219, 'precision': 0.75283444, 'recall': 0.8457272, 'specificity': 0.8457272, 'f1': 0.79122776, 'auroc': 0.967837, 'binary_precision': 0.5155155, 'binary_recall': 0.71428573, 'binary_specificity': 0.97716874, 'binary_f1_score': 0.59883726}
confusion matrix:
       0     1
0  41430   968
1    412  1030
---- Validation: 
scalar performance:
{'acc': 0.9641409, 'precision': 0.7453474, 'recall': 0.85694605, 'specificity': 0.85694605, 'f1': 0.78941953, 'auroc': 0.9560987, 'binary_precision': 0.5005015, 'binary_recall': 0.74145615, 'binary_specificity': 0.97243595, 'binary_f1_score': 0.59760475}
confusion matrix:
       0    1
0  17569  498
1    174  499
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96777314, 'precision': 0.8169843, 'recall': 0.73675776, 'specificity': 0.73675776, 'f1': 0.7703998, 'auroc': 0.9565356, 'binary_precision': 0.65625, 'binary_recall': 0.4846154, 'binary_specificity': 0.9889001, 'binary_f1_score': 0.5575221}
confusion matrix:
      0    1
0  5880   66
1   134  126
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863188.png
early stop counter: 20
val acc:0.9641408920288086, best validation acc: 0.9666488766670227, corresponding to test acc:                         0.9730905294418335 / 0.975668728351593
after epoch: 29,now: 2024-05-27 11:11:48.292638,epoch time: 0:22:15.288582,used: 10:54:41.590806,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_00_17_06_seed_1_20863188
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 29 with time: 10:54:41.590806 at 2024-05-27 11:11:48.292638
persisted model performance metric: 

scalar performance:
{'acc': 0.97486305, 'precision': 0.871009, 'recall': 0.78827137, 'specificity': 0.78827137, 'f1': 0.8239086, 'auroc': 0.93569, 'binary_precision': 0.76, 'binary_recall': 0.5846154, 'binary_specificity': 0.9919273, 'binary_f1_score': 0.66086954}
confusion matrix:
      0    1
0  5898   48
1   108  152
oracle model performance metric: 

scalar performance:
{'acc': 0.9740574, 'precision': 0.8894057, 'recall': 0.7510712, 'specificity': 0.7510712, 'f1': 0.80387264, 'auroc': 0.9245453, 'binary_precision': 0.8, 'binary_recall': 0.50769234, 'binary_specificity': 0.99445003, 'binary_f1_score': 0.62117654}
confusion matrix:
      0    1
0  5913   33
1   128  132
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs32/rule_results/9.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs32/confusion_matrix/9.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 498825 KiB |  21448 MiB |   1561 TiB |   1561 TiB |
|       from large pool | 409600 KiB |  21375 MiB |   1558 TiB |   1558 TiB |
|       from small pool |  89225 KiB |    123 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 498825 KiB |  21448 MiB |   1561 TiB |   1561 TiB |
|       from large pool | 409600 KiB |  21375 MiB |   1558 TiB |   1558 TiB |
|       from small pool |  89225 KiB |    123 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476570 KiB |  21332 MiB |   1555 TiB |   1555 TiB |
|       from large pool | 387840 KiB |  21259 MiB |   1553 TiB |   1553 TiB |
|       from small pool |  88730 KiB |    122 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  22164 MiB |  22164 MiB |  43018 MiB |  20854 MiB |
|       from large pool |  22040 MiB |  22040 MiB |  42866 MiB |  20826 MiB |
|       from small pool |    124 MiB |    124 MiB |    152 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    908 MiB |   1725 MiB | 669375 GiB | 669374 GiB |
|       from large pool |    900 MiB |   1722 MiB | 665840 GiB | 665839 GiB |
|       from small pool |      8 MiB |     27 MiB |   3535 GiB |   3535 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2541    |    3986    |  137551 K  |  137548 K  |
|       from large pool |      87    |     908    |   55796 K  |   55796 K  |
|       from small pool |    2454    |    3897    |   81754 K  |   81751 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2541    |    3986    |  137551 K  |  137548 K  |
|       from large pool |      87    |     908    |   55796 K  |   55796 K  |
|       from small pool |    2454    |    3897    |   81754 K  |   81751 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     517    |     517    |     950    |     433    |
|       from large pool |     455    |     455    |     874    |     419    |
|       from small pool |      62    |      62    |      76    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      82    |    1411    |   76065 K  |   76065 K  |
|       from large pool |      22    |     238    |   35174 K  |   35174 K  |
|       from small pool |      60    |    1388    |   40890 K  |   40890 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  21448 MiB |   1561 TiB |   1561 TiB |
|       from large pool |  16640 KiB |  21375 MiB |   1558 TiB |   1558 TiB |
|       from small pool |      0 KiB |    123 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  21448 MiB |   1561 TiB |   1561 TiB |
|       from large pool |  16640 KiB |  21375 MiB |   1558 TiB |   1558 TiB |
|       from small pool |      0 KiB |    123 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  21332 MiB |   1555 TiB |   1555 TiB |
|       from large pool |  16640 KiB |  21259 MiB |   1553 TiB |   1553 TiB |
|       from small pool |      0 KiB |    122 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1396 MiB |  22164 MiB |  43018 MiB |  41622 MiB |
|       from large pool |   1300 MiB |  22040 MiB |  42866 MiB |  41566 MiB |
|       from small pool |     96 MiB |    124 MiB |    152 MiB |     56 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 139008 KiB |   1725 MiB | 669376 GiB | 669375 GiB |
|       from large pool | 139008 KiB |   1722 MiB | 665840 GiB | 665840 GiB |
|       from small pool |      0 KiB |     27 MiB |   3535 GiB |   3535 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3986    |  137551 K  |  137551 K  |
|       from large pool |       2    |     908    |   55796 K  |   55796 K  |
|       from small pool |       0    |    3897    |   81754 K  |   81754 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3986    |  137551 K  |  137551 K  |
|       from large pool |       2    |     908    |   55796 K  |   55796 K  |
|       from small pool |       0    |    3897    |   81754 K  |   81754 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      84    |     517    |     950    |     866    |
|       from large pool |      36    |     455    |     874    |     838    |
|       from small pool |      48    |      62    |      76    |      28    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1411    |   76066 K  |   76066 K  |
|       from large pool |       3    |     238    |   35174 K  |   35174 K  |
|       from small pool |       0    |    1388    |   40891 K  |   40891 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Mon May 27 11:14:12 2024]
Finished job 0.
1 of 1 steps (100%) done
