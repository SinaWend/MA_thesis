Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Mon May 27 04:37:39 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs32/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs32/rule_results/7.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=7
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_04_45_51_seed_0_20863846

 Experiment start at: 2024-05-27 04:45:51.605364
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.955097496509552
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9722679, 'precision': 0.8156955, 'recall': 0.6836973, 'specificity': 0.6836973, 'f1': 0.73078877, 'auroc': 0.9651625, 'binary_precision': 0.6528436, 'binary_recall': 0.37432066, 'binary_specificity': 0.99307394, 'binary_f1_score': 0.4758204}
confusion matrix:
       0    1
0  42011  293
1    921  551
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.97264796, 'precision': 0.8236925, 'recall': 0.6955681, 'specificity': 0.6955681, 'f1': 0.7424827, 'auroc': 0.96556425, 'binary_precision': 0.6684073, 'binary_recall': 0.39813375, 'binary_specificity': 0.99300236, 'binary_f1_score': 0.49902534}
confusion matrix:
       0    1
0  18022  127
1    387  256
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9704378, 'precision': 0.9378512, 'recall': 0.6620849, 'specificity': 0.6620849, 'f1': 0.73183036, 'auroc': 0.9529113, 'binary_precision': 0.90425533, 'binary_recall': 0.3256705, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.47887325}
confusion matrix:
      0   1
0  5988   9
1   176  85
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863846.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-27 05:18:17.451671,epoch time: 0:32:25.846307,used: 0:32:25.846307,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_04_45_51_seed_0_20863846
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97427815, 'precision': 0.9747385, 'recall': 0.62021995, 'specificity': 0.62021995, 'f1': 0.6864527, 'auroc': 0.97619545, 'binary_precision': 0.9752066, 'binary_recall': 0.24065262, 'binary_specificity': 0.9997873, 'binary_f1_score': 0.38604146}
confusion matrix:
       0    1
0  42296    9
1   1117  354
---- Validation: 
scalar performance:
{'acc': 0.9702533, 'precision': 0.97374654, 'recall': 0.56681895, 'specificity': 0.56681895, 'f1': 0.61006284, 'auroc': 0.9715755, 'binary_precision': 0.97727275, 'binary_recall': 0.13374805, 'binary_specificity': 0.9998898, 'binary_f1_score': 0.2352941}
confusion matrix:
       0   1
0  18147   2
1    557  86
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.9792999, 'recall': 0.50383145, 'specificity': 0.50383145, 'f1': 0.4970357, 'auroc': 0.9482311, 'binary_precision': 1.0, 'binary_recall': 0.007662835, 'binary_specificity': 1.0, 'binary_f1_score': 0.015209124}
confusion matrix:
      0  1
0  5997  0
1   259  2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863846.png
early stop counter: 1
val acc:0.9702532887458801, best validation acc: 0.9726479649543762, corresponding to test acc:                         0.9704378247261047 / 0.9704378247261047
after epoch: 2,now: 2024-05-27 05:49:36.495862,epoch time: 0:31:19.044191,used: 1:03:44.890498,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_04_45_51_seed_0_20863846
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9809256, 'precision': 0.9034556, 'recall': 0.7734419, 'specificity': 0.7734419, 'f1': 0.8250327, 'auroc': 0.98381734, 'binary_precision': 0.822335, 'binary_recall': 0.5510204, 'binary_specificity': 0.9958635, 'binary_f1_score': 0.6598778}
confusion matrix:
       0    1
0  42131  175
1    660  810
---- Validation: 
scalar performance:
{'acc': 0.9765858, 'precision': 0.89972925, 'recall': 0.70060694, 'specificity': 0.70060694, 'f1': 0.7648263, 'auroc': 0.9758115, 'binary_precision': 0.8201893, 'binary_recall': 0.4043546, 'binary_specificity': 0.9968593, 'binary_f1_score': 0.5416666}
confusion matrix:
       0    1
0  18092   57
1    383  260
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9610099, 'precision': 0.90074766, 'recall': 0.53989637, 'specificity': 0.53989637, 'f1': 0.5634511, 'auroc': 0.95534164, 'binary_precision': 0.84, 'binary_recall': 0.08045977, 'binary_specificity': 0.999333, 'binary_f1_score': 0.14685315}
confusion matrix:
      0   1
0  5993   4
1   240  21
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863846.png
better model found
persisted
after epoch: 3,now: 2024-05-27 06:20:45.048358,epoch time: 0:31:08.552496,used: 1:34:53.442994,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_04_45_51_seed_0_20863846
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98419225, 'precision': 0.8786413, 'recall': 0.8776474, 'specificity': 0.8776474, 'f1': 0.87814367, 'auroc': 0.9848223, 'binary_precision': 0.7655078, 'binary_recall': 0.76342624, 'binary_specificity': 0.99186856, 'binary_f1_score': 0.76446563}
confusion matrix:
       0     1
0  41961   344
1    348  1123
---- Validation: 
scalar performance:
{'acc': 0.9825458, 'precision': 0.8861892, 'recall': 0.83495224, 'specificity': 0.83495224, 'f1': 0.85859793, 'auroc': 0.979587, 'binary_precision': 0.7837838, 'binary_recall': 0.67651635, 'binary_specificity': 0.99338806, 'binary_f1_score': 0.72621036}
confusion matrix:
       0    1
0  18029  120
1    208  435
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96356666, 'precision': 0.83296037, 'recall': 0.60902673, 'specificity': 0.60902673, 'f1': 0.6592389, 'auroc': 0.9544049, 'binary_precision': 0.6987952, 'binary_recall': 0.22222222, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.33720928}
confusion matrix:
      0   1
0  5972  25
1   203  58
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863846.png
better model found
persisted
after epoch: 4,now: 2024-05-27 06:51:56.975739,epoch time: 0:31:11.927381,used: 2:06:05.370375,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_04_45_51_seed_0_20863846
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9765625, 'precision': 0.79888994, 'recall': 0.93902314, 'specificity': 0.93902314, 'f1': 0.8541782, 'auroc': 0.9883822, 'binary_precision': 0.60136366, 'binary_recall': 0.8987772, 'binary_specificity': 0.9792691, 'binary_f1_score': 0.7205882}
confusion matrix:
       0     1
0  41427   877
1    149  1323
---- Validation: 
scalar performance:
{'acc': 0.976639, 'precision': 0.80253196, 'recall': 0.93240154, 'specificity': 0.93240154, 'f1': 0.8547156, 'auroc': 0.981537, 'binary_precision': 0.6092077, 'binary_recall': 0.88491446, 'binary_specificity': 0.9798887, 'binary_f1_score': 0.72162336}
confusion matrix:
       0    1
0  17784  365
1     74  569
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9651646, 'precision': 0.7989347, 'recall': 0.70330954, 'specificity': 0.70330954, 'f1': 0.7409768, 'auroc': 0.95377696, 'binary_precision': 0.62285715, 'binary_recall': 0.41762453, 'binary_specificity': 0.9889945, 'binary_f1_score': 0.5}
confusion matrix:
      0    1
0  5931   66
1   152  109
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863846.png
early stop counter: 1
val acc:0.9766389727592468, best validation acc: 0.982545793056488, corresponding to test acc:                         0.9635666608810425 / 0.9704378247261047
after epoch: 5,now: 2024-05-27 07:23:11.055955,epoch time: 0:31:14.080216,used: 2:37:19.450591,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_04_45_51_seed_0_20863846
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.987002, 'precision': 0.90928906, 'recall': 0.88533473, 'specificity': 0.88533473, 'f1': 0.8969215, 'auroc': 0.9904305, 'binary_precision': 0.82633865, 'binary_recall': 0.77634263, 'binary_specificity': 0.9943269, 'binary_f1_score': 0.80056083}
confusion matrix:
       0     1
0  42065   240
1    329  1142
---- Validation: 
scalar performance:
{'acc': 0.9850468, 'precision': 0.9105717, 'recall': 0.8504981, 'specificity': 0.8504981, 'f1': 0.8779731, 'auroc': 0.9837172, 'binary_precision': 0.83150184, 'binary_recall': 0.7060653, 'binary_specificity': 0.99493086, 'binary_f1_score': 0.7636669}
confusion matrix:
       0    1
0  18057   92
1    189  454
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608501, 'precision': 0.81163657, 'recall': 0.561801, 'specificity': 0.561801, 'f1': 0.59607244, 'auroc': 0.93561786, 'binary_precision': 0.66, 'binary_recall': 0.12643678, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.21221867}
confusion matrix:
      0   1
0  5980  17
1   228  33
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863846.png
better model found
persisted
after epoch: 6,now: 2024-05-27 07:54:22.203282,epoch time: 0:31:11.147327,used: 3:08:30.597918,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_04_45_51_seed_0_20863846
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9875959, 'precision': 0.90612745, 'recall': 0.9015888, 'specificity': 0.9015888, 'f1': 0.90384436, 'auroc': 0.9916557, 'binary_precision': 0.81887054, 'binary_recall': 0.8093941, 'binary_specificity': 0.99378353, 'binary_f1_score': 0.81410474}
confusion matrix:
       0     1
0  42044   263
1    280  1189
---- Validation: 
scalar performance:
{'acc': 0.9848872, 'precision': 0.8958008, 'recall': 0.8684168, 'specificity': 0.8684168, 'f1': 0.8815768, 'auroc': 0.9828797, 'binary_precision': 0.80067, 'binary_recall': 0.7433904, 'binary_specificity': 0.9934432, 'binary_f1_score': 0.7709677}
confusion matrix:
       0    1
0  18030  119
1    165  478
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614893, 'precision': 0.85054696, 'recall': 0.55846983, 'specificity': 0.55846983, 'f1': 0.59244365, 'auroc': 0.9407453, 'binary_precision': 0.7380952, 'binary_recall': 0.118773945, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.20462047}
confusion matrix:
      0   1
0  5986  11
1   230  31
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863846.png
early stop counter: 1
val acc:0.9848871827125549, best validation acc: 0.9850468039512634, corresponding to test acc:                         0.9608501195907593 / 0.9704378247261047
after epoch: 7,now: 2024-05-27 08:25:51.211654,epoch time: 0:31:29.008372,used: 3:39:59.606290,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_04_45_51_seed_0_20863846
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98812133, 'precision': 0.9057572, 'recall': 0.91320175, 'specificity': 0.91320175, 'f1': 0.9094428, 'auroc': 0.99299824, 'binary_precision': 0.81733334, 'binary_recall': 0.83288044, 'binary_specificity': 0.99352306, 'binary_f1_score': 0.82503366}
confusion matrix:
       0     1
0  42030   274
1    246  1226
---- Validation: 
scalar performance:
{'acc': 0.98738825, 'precision': 0.9287443, 'recall': 0.8712117, 'specificity': 0.8712117, 'f1': 0.89774585, 'auroc': 0.9843063, 'binary_precision': 0.866426, 'binary_recall': 0.7465008, 'binary_specificity': 0.9959226, 'binary_f1_score': 0.80200505}
confusion matrix:
       0    1
0  18075   74
1    163  480
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96196866, 'precision': 0.8653782, 'recall': 0.56238467, 'specificity': 0.56238467, 'f1': 0.5988081, 'auroc': 0.9371662, 'binary_precision': 0.76744187, 'binary_recall': 0.12643678, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.21710527}
confusion matrix:
      0   1
0  5987  10
1   228  33
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863846.png
better model found
persisted
after epoch: 8,now: 2024-05-27 08:57:05.514833,epoch time: 0:31:14.303179,used: 4:11:13.909469,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_04_45_51_seed_0_20863846
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98677355, 'precision': 0.90187204, 'recall': 0.89210635, 'specificity': 0.89210635, 'f1': 0.89692414, 'auroc': 0.99361074, 'binary_precision': 0.8110181, 'binary_recall': 0.7906186, 'binary_specificity': 0.9935941, 'binary_f1_score': 0.8006885}
confusion matrix:
       0     1
0  42034   271
1    308  1163
---- Validation: 
scalar performance:
{'acc': 0.9852065, 'precision': 0.90187746, 'recall': 0.86558187, 'specificity': 0.86558187, 'f1': 0.8828001, 'auroc': 0.982411, 'binary_precision': 0.813036, 'binary_recall': 0.7371695, 'binary_specificity': 0.9939942, 'binary_f1_score': 0.7732464}
confusion matrix:
       0    1
0  18040  109
1    169  474
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96196866, 'precision': 0.8653782, 'recall': 0.56238467, 'specificity': 0.56238467, 'f1': 0.5988081, 'auroc': 0.9277344, 'binary_precision': 0.76744187, 'binary_recall': 0.12643678, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.21710527}
confusion matrix:
      0   1
0  5987  10
1   228  33
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863846.png
early stop counter: 1
val acc:0.9852064847946167, best validation acc: 0.9873882532119751, corresponding to test acc:                         0.9619686603546143 / 0.9704378247261047
after epoch: 9,now: 2024-05-27 09:28:23.770125,epoch time: 0:31:18.255292,used: 4:42:32.164761,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_04_45_51_seed_0_20863846
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.989926, 'precision': 0.9531016, 'recall': 0.88528425, 'specificity': 0.88528425, 'f1': 0.91624516, 'auroc': 0.99509096, 'binary_precision': 0.91405624, 'binary_recall': 0.7730978, 'binary_specificity': 0.9974707, 'binary_f1_score': 0.8376887}
confusion matrix:
       0     1
0  42197   107
1    334  1138
---- Validation: 
scalar performance:
{'acc': 0.9843018, 'precision': 0.9491388, 'recall': 0.79835856, 'specificity': 0.79835856, 'f1': 0.85746336, 'auroc': 0.9857876, 'binary_precision': 0.9123223, 'binary_recall': 0.59875584, 'binary_specificity': 0.99796134, 'binary_f1_score': 0.7230047}
confusion matrix:
       0    1
0  18112   37
1    258  385
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590924, 'precision': 0.9081747, 'recall': 0.5114109, 'specificity': 0.5114109, 'f1': 0.5119374, 'auroc': 0.9224036, 'binary_precision': 0.85714287, 'binary_recall': 0.022988506, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.04477612}
confusion matrix:
      0  1
0  5996  1
1   255  6
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863846.png
early stop counter: 2
val acc:0.9843018054962158, best validation acc: 0.9873882532119751, corresponding to test acc:                         0.9619686603546143 / 0.9704378247261047
after epoch: 10,now: 2024-05-27 09:59:49.562007,epoch time: 0:31:25.791882,used: 5:13:57.956643,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_04_45_51_seed_0_20863846
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9903143, 'precision': 0.9171382, 'recall': 0.93790185, 'specificity': 0.93790185, 'f1': 0.9272469, 'auroc': 0.99447805, 'binary_precision': 0.8383969, 'binary_recall': 0.8817131, 'binary_specificity': 0.99409056, 'binary_f1_score': 0.8595096}
confusion matrix:
       0     1
0  42055   250
1    174  1297
---- Validation: 
scalar performance:
{'acc': 0.98659, 'precision': 0.9133836, 'recall': 0.8760488, 'specificity': 0.8760488, 'f1': 0.89376116, 'auroc': 0.98553413, 'binary_precision': 0.8353345, 'binary_recall': 0.7573872, 'binary_specificity': 0.99471045, 'binary_f1_score': 0.7944535}
confusion matrix:
       0    1
0  18053   96
1    156  487
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.76272094, 'recall': 0.52407044, 'specificity': 0.52407044, 'f1': 0.53522855, 'auroc': 0.9118747, 'binary_precision': 0.5652174, 'binary_recall': 0.049808428, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.09154929}
confusion matrix:
      0   1
0  5987  10
1   248  13
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863846.png
early stop counter: 3
val acc:0.9865900278091431, best validation acc: 0.9873882532119751, corresponding to test acc:                         0.9619686603546143 / 0.9704378247261047
after epoch: 11,now: 2024-05-27 10:31:09.463689,epoch time: 0:31:19.901682,used: 5:45:17.858325,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_04_45_51_seed_0_20863846
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9896976, 'precision': 0.91078234, 'recall': 0.93631136, 'specificity': 0.93631136, 'f1': 0.92312974, 'auroc': 0.9964609, 'binary_precision': 0.82578176, 'binary_recall': 0.87907606, 'binary_specificity': 0.9935467, 'binary_f1_score': 0.8515959}
confusion matrix:
       0     1
0  42031   273
1    178  1294
---- Validation: 
scalar performance:
{'acc': 0.98659, 'precision': 0.91789925, 'recall': 0.8700484, 'specificity': 0.8700484, 'f1': 0.8924037, 'auroc': 0.9853748, 'binary_precision': 0.8447972, 'binary_recall': 0.7449456, 'binary_specificity': 0.9951512, 'binary_f1_score': 0.7917356}
confusion matrix:
       0    1
0  18061   88
1    164  479
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96276766, 'precision': 0.8573444, 'recall': 0.57929254, 'specificity': 0.57929254, 'f1': 0.62294215, 'auroc': 0.94276845, 'binary_precision': 0.75, 'binary_recall': 0.16091955, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.26498425}
confusion matrix:
      0   1
0  5983  14
1   219  42
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863846.png
early stop counter: 4
val acc:0.9865900278091431, best validation acc: 0.9873882532119751, corresponding to test acc:                         0.9619686603546143 / 0.9704378247261047
after epoch: 12,now: 2024-05-27 11:02:32.014838,epoch time: 0:31:22.551149,used: 6:16:40.409474,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_04_45_51_seed_0_20863846
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9901773, 'precision': 0.93966806, 'recall': 0.90436614, 'specificity': 0.90436614, 'f1': 0.92122144, 'auroc': 0.9964978, 'binary_precision': 0.88584137, 'binary_recall': 0.81237257, 'binary_specificity': 0.99635977, 'binary_f1_score': 0.8475177}
confusion matrix:
       0     1
0  42151   154
1    276  1195
---- Validation: 
scalar performance:
{'acc': 0.98557895, 'precision': 0.919582, 'recall': 0.84927344, 'specificity': 0.84927344, 'f1': 0.8809593, 'auroc': 0.98488724, 'binary_precision': 0.84962404, 'binary_recall': 0.7029549, 'binary_specificity': 0.99559206, 'binary_f1_score': 0.7693617}
confusion matrix:
       0    1
0  18069   80
1    191  452
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96212846, 'precision': 0.85688406, 'recall': 0.56796503, 'specificity': 0.56796503, 'f1': 0.6067973, 'auroc': 0.93069255, 'binary_precision': 0.75, 'binary_recall': 0.13793103, 'binary_specificity': 0.997999, 'binary_f1_score': 0.2330097}
confusion matrix:
      0   1
0  5985  12
1   225  36
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863846.png
early stop counter: 5
val acc:0.9855789542198181, best validation acc: 0.9873882532119751, corresponding to test acc:                         0.9619686603546143 / 0.9704378247261047
after epoch: 13,now: 2024-05-27 11:34:20.652788,epoch time: 0:31:48.637950,used: 6:48:29.047424,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_04_45_51_seed_0_20863846
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9927586, 'precision': 0.97801054, 'recall': 0.9077325, 'specificity': 0.9077325, 'f1': 0.93988097, 'auroc': 0.99785507, 'binary_precision': 0.9623699, 'binary_recall': 0.81657606, 'binary_specificity': 0.99888897, 'binary_f1_score': 0.8834988}
confusion matrix:
       0     1
0  42257    47
1    270  1202
---- Validation: 
scalar performance:
{'acc': 0.9857918, 'precision': 0.9544394, 'recall': 0.8186314, 'specificity': 0.8186314, 'f1': 0.8737524, 'auroc': 0.980299, 'binary_precision': 0.92152464, 'binary_recall': 0.63919127, 'binary_specificity': 0.9980715, 'binary_f1_score': 0.7548209}
confusion matrix:
       0    1
0  18114   35
1    232  411
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.8486262, 'recall': 0.52640307, 'specificity': 0.52640307, 'f1': 0.5397025, 'auroc': 0.9363277, 'binary_precision': 0.7368421, 'binary_recall': 0.053639848, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.1}
confusion matrix:
      0   1
0  5992   5
1   247  14
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863846.png
early stop counter: 6
val acc:0.985791802406311, best validation acc: 0.9873882532119751, corresponding to test acc:                         0.9619686603546143 / 0.9704378247261047
after epoch: 14,now: 2024-05-27 12:06:00.253034,epoch time: 0:31:39.600246,used: 7:20:08.647670,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_04_45_51_seed_0_20863846
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9901087, 'precision': 0.9059444, 'recall': 0.9528874, 'specificity': 0.9528874, 'f1': 0.9280226, 'auroc': 0.9971418, 'binary_precision': 0.81492716, 'binary_recall': 0.9129844, 'binary_specificity': 0.99279046, 'binary_f1_score': 0.86117345}
confusion matrix:
       0     1
0  42000   305
1    128  1343
---- Validation: 
scalar performance:
{'acc': 0.9852065, 'precision': 0.8821651, 'recall': 0.8993343, 'specificity': 0.8993343, 'f1': 0.8905443, 'auroc': 0.98217356, 'binary_precision': 0.77117383, 'binary_recall': 0.80715394, 'binary_specificity': 0.9915147, 'binary_f1_score': 0.7887538}
confusion matrix:
       0    1
0  17995  154
1    124  519
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9603707, 'precision': 0.78879464, 'recall': 0.5652156, 'specificity': 0.5652156, 'f1': 0.59989727, 'auroc': 0.9380677, 'binary_precision': 0.61403507, 'binary_recall': 0.13409962, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.22012578}
confusion matrix:
      0   1
0  5975  22
1   226  35
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863846.png
early stop counter: 7
val acc:0.9852064847946167, best validation acc: 0.9873882532119751, corresponding to test acc:                         0.9619686603546143 / 0.9704378247261047
after epoch: 15,now: 2024-05-27 12:38:47.035974,epoch time: 0:32:46.782940,used: 7:52:55.430610,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_04_45_51_seed_0_20863846
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9944262, 'precision': 0.9606631, 'recall': 0.95279336, 'specificity': 0.95279336, 'f1': 0.95669174, 'auroc': 0.99827933, 'binary_precision': 0.92451525, 'binary_recall': 0.90816325, 'binary_specificity': 0.9974235, 'binary_f1_score': 0.91626626}
confusion matrix:
       0     1
0  42197   109
1    135  1335
---- Validation: 
scalar performance:
{'acc': 0.9881865, 'precision': 0.92606986, 'recall': 0.8888762, 'specificity': 0.8888762, 'f1': 0.906556, 'auroc': 0.9843933, 'binary_precision': 0.85982907, 'binary_recall': 0.7822706, 'binary_specificity': 0.99548185, 'binary_f1_score': 0.8192182}
confusion matrix:
       0    1
0  18067   82
1    140  503
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96164906, 'precision': 0.8595511, 'recall': 0.5585532, 'specificity': 0.5585532, 'f1': 0.5928242, 'auroc': 0.94451827, 'binary_precision': 0.75609756, 'binary_recall': 0.118773945, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.205298}
confusion matrix:
      0   1
0  5987  10
1   230  31
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863846.png
better model found
persisted
after epoch: 16,now: 2024-05-27 13:14:27.540052,epoch time: 0:35:40.504078,used: 8:28:35.934688,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_04_45_51_seed_0_20863846
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99351245, 'precision': 0.93274164, 'recall': 0.9740214, 'specificity': 0.9740214, 'f1': 0.9523641, 'auroc': 0.99833995, 'binary_precision': 0.8671199, 'binary_recall': 0.953125, 'binary_specificity': 0.99491775, 'binary_f1_score': 0.9080906}
confusion matrix:
       0     1
0  42089   215
1     69  1403
---- Validation: 
scalar performance:
{'acc': 0.98648363, 'precision': 0.90045875, 'recall': 0.89324504, 'specificity': 0.89324504, 'f1': 0.8968164, 'auroc': 0.98206365, 'binary_precision': 0.8082409, 'binary_recall': 0.7931571, 'binary_specificity': 0.993333, 'binary_f1_score': 0.800628}
confusion matrix:
       0    1
0  18028  121
1    133  510
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.8122984, 'recall': 0.56929713, 'specificity': 0.56929713, 'f1': 0.6067594, 'auroc': 0.9312349, 'binary_precision': 0.66071427, 'binary_recall': 0.14176245, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.23343849}
confusion matrix:
      0   1
0  5978  19
1   224  37
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863846.png
early stop counter: 1
val acc:0.986483633518219, best validation acc: 0.9881864786148071, corresponding to test acc:                         0.9616490602493286 / 0.9704378247261047
after epoch: 17,now: 2024-05-27 13:51:28.670173,epoch time: 0:37:01.130121,used: 9:05:37.064809,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_04_45_51_seed_0_20863846
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99518, 'precision': 0.9721234, 'recall': 0.9525901, 'specificity': 0.9525901, 'f1': 0.9621348, 'auroc': 0.99865925, 'binary_precision': 0.9474805, 'binary_recall': 0.9069294, 'binary_specificity': 0.9982508, 'binary_f1_score': 0.9267615}
confusion matrix:
       0     1
0  42230    74
1    137  1335
---- Validation: 
scalar performance:
{'acc': 0.9871754, 'precision': 0.93477654, 'recall': 0.8606007, 'specificity': 0.8606007, 'f1': 0.8939625, 'auroc': 0.9798184, 'binary_precision': 0.8792453, 'binary_recall': 0.7247278, 'binary_specificity': 0.9964736, 'binary_f1_score': 0.79454386}
confusion matrix:
       0    1
0  18085   64
1    177  466
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96228826, 'precision': 0.84582245, 'recall': 0.5753777, 'specificity': 0.5753777, 'f1': 0.6169101, 'auroc': 0.9334979, 'binary_precision': 0.72727275, 'binary_recall': 0.1532567, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.25316453}
confusion matrix:
      0   1
0  5982  15
1   221  40
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863846.png
early stop counter: 2
val acc:0.9871754050254822, best validation acc: 0.9881864786148071, corresponding to test acc:                         0.9616490602493286 / 0.9704378247261047
after epoch: 18,now: 2024-05-27 14:27:23.311572,epoch time: 0:35:54.641399,used: 9:41:31.706208,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_04_45_51_seed_0_20863846
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9921875, 'precision': 0.9872737, 'recall': 0.8907165, 'specificity': 0.8907165, 'f1': 0.93331134, 'auroc': 0.998349, 'binary_precision': 0.9820819, 'binary_recall': 0.7819294, 'binary_specificity': 0.9995036, 'binary_f1_score': 0.8706506}
confusion matrix:
       0     1
0  42283    21
1    321  1151
---- Validation: 
scalar performance:
{'acc': 0.9856322, 'precision': 0.9658319, 'recall': 0.80729795, 'specificity': 0.80729795, 'f1': 0.869185, 'auroc': 0.97921896, 'binary_precision': 0.9451074, 'binary_recall': 0.61586314, 'binary_specificity': 0.9987327, 'binary_f1_score': 0.7457627}
confusion matrix:
       0    1
0  18126   23
1    247  396
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.86248434, 'recall': 0.5245707, 'specificity': 0.5245707, 'f1': 0.53646684, 'auroc': 0.9191041, 'binary_precision': 0.7647059, 'binary_recall': 0.049808428, 'binary_specificity': 0.999333, 'binary_f1_score': 0.09352518}
confusion matrix:
      0   1
0  5993   4
1   248  13
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863846.png
early stop counter: 3
val acc:0.9856321811676025, best validation acc: 0.9881864786148071, corresponding to test acc:                         0.9616490602493286 / 0.9704378247261047
after epoch: 19,now: 2024-05-27 15:04:27.454040,epoch time: 0:37:04.142468,used: 10:18:35.848676,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_04_45_51_seed_0_20863846
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9930327, 'precision': 0.977269, 'recall': 0.9127922, 'specificity': 0.9127922, 'f1': 0.9425247, 'auroc': 0.9979304, 'binary_precision': 0.9605367, 'binary_recall': 0.8267663, 'binary_specificity': 0.9988181, 'binary_f1_score': 0.8886455}
confusion matrix:
       0     1
0  42254    50
1    255  1217
---- Validation: 
scalar performance:
{'acc': 0.9856854, 'precision': 0.9365691, 'recall': 0.8328273, 'specificity': 0.8328273, 'f1': 0.87717855, 'auroc': 0.98346585, 'binary_precision': 0.8847737, 'binary_recall': 0.6687403, 'binary_specificity': 0.99691445, 'binary_f1_score': 0.76173604}
confusion matrix:
       0    1
0  18093   56
1    213  430
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579738, 'precision': 0.69840395, 'recall': 0.5126596, 'specificity': 0.5126596, 'f1': 0.5145264, 'auroc': 0.925641, 'binary_precision': 0.4375, 'binary_recall': 0.026819924, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.050541516}
confusion matrix:
      0  1
0  5988  9
1   254  7
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863846.png
early stop counter: 4
val acc:0.985685408115387, best validation acc: 0.9881864786148071, corresponding to test acc:                         0.9616490602493286 / 0.9704378247261047
after epoch: 20,now: 2024-05-27 15:44:44.777849,epoch time: 0:40:17.323809,used: 10:58:53.172485,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_04_45_51_seed_0_20863846
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99511147, 'precision': 0.98574454, 'recall': 0.93775916, 'specificity': 0.93775916, 'f1': 0.9604138, 'auroc': 0.9993222, 'binary_precision': 0.97577596, 'binary_recall': 0.87627465, 'binary_specificity': 0.9992436, 'binary_f1_score': 0.9233524}
confusion matrix:
       0     1
0  42273    32
1    182  1289
---- Validation: 
scalar performance:
{'acc': 0.9862707, 'precision': 0.9451785, 'recall': 0.8346305, 'specificity': 0.8346305, 'f1': 0.8814888, 'auroc': 0.97628134, 'binary_precision': 0.9018789, 'binary_recall': 0.6718507, 'binary_specificity': 0.9974103, 'binary_f1_score': 0.7700535}
confusion matrix:
       0    1
0  18102   47
1    211  432
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9600511, 'precision': 0.89197624, 'recall': 0.5265698, 'specificity': 0.5265698, 'f1': 0.5401456, 'auroc': 0.9143908, 'binary_precision': 0.8235294, 'binary_recall': 0.053639848, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.10071943}
confusion matrix:
      0   1
0  5994   3
1   247  14
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863846.png
early stop counter: 5
val acc:0.9862707257270813, best validation acc: 0.9881864786148071, corresponding to test acc:                         0.9616490602493286 / 0.9704378247261047
after epoch: 21,now: 2024-05-27 16:24:57.277022,epoch time: 0:40:12.499173,used: 11:39:05.671658,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_04_45_51_seed_0_20863846
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99522567, 'precision': 0.9582002, 'recall': 0.96931446, 'specificity': 0.96931446, 'f1': 0.9636855, 'auroc': 0.9993013, 'binary_precision': 0.91843504, 'binary_recall': 0.94153637, 'binary_specificity': 0.99709255, 'binary_f1_score': 0.9298423}
confusion matrix:
       0     1
0  42182   123
1     86  1385
---- Validation: 
scalar performance:
{'acc': 0.98722863, 'precision': 0.91013515, 'recall': 0.8928807, 'specificity': 0.8928807, 'f1': 0.901307, 'auroc': 0.982272, 'binary_precision': 0.82764226, 'binary_recall': 0.79160184, 'binary_specificity': 0.99415946, 'binary_f1_score': 0.8092209}
confusion matrix:
       0    1
0  18043  106
1    134  509
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.8337661, 'recall': 0.5583031, 'specificity': 0.5583031, 'f1': 0.5916893, 'auroc': 0.9304271, 'binary_precision': 0.70454544, 'binary_recall': 0.118773945, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.20327869}
confusion matrix:
      0   1
0  5984  13
1   230  31
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863846.png
early stop counter: 6
val acc:0.9872286319732666, best validation acc: 0.9881864786148071, corresponding to test acc:                         0.9616490602493286 / 0.9704378247261047
after epoch: 22,now: 2024-05-27 16:59:45.444917,epoch time: 0:34:48.167895,used: 12:13:53.839553,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_04_45_51_seed_0_20863846
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9937866, 'precision': 0.97778314, 'recall': 0.9242272, 'specificity': 0.9242272, 'f1': 0.9492984, 'auroc': 0.9983164, 'binary_precision': 0.96076924, 'binary_recall': 0.84965986, 'binary_specificity': 0.9987945, 'binary_f1_score': 0.90180504}
confusion matrix:
       0     1
0  42255    51
1    221  1249
---- Validation: 
scalar performance:
{'acc': 0.9864304, 'precision': 0.94007146, 'recall': 0.84221375, 'specificity': 0.84221375, 'f1': 0.8845613, 'auroc': 0.9819994, 'binary_precision': 0.891129, 'binary_recall': 0.6874028, 'binary_specificity': 0.99702466, 'binary_f1_score': 0.7761194}
confusion matrix:
       0    1
0  18095   54
1    201  442
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.8337661, 'recall': 0.5583031, 'specificity': 0.5583031, 'f1': 0.5916893, 'auroc': 0.94861734, 'binary_precision': 0.70454544, 'binary_recall': 0.118773945, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.20327869}
confusion matrix:
      0   1
0  5984  13
1   230  31
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863846.png
early stop counter: 7
val acc:0.9864304065704346, best validation acc: 0.9881864786148071, corresponding to test acc:                         0.9616490602493286 / 0.9704378247261047
after epoch: 23,now: 2024-05-27 17:38:59.322623,epoch time: 0:39:13.877706,used: 12:53:07.717259,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_04_45_51_seed_0_20863846
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.995911, 'precision': 0.9710071, 'recall': 0.9657546, 'specificity': 0.9657546, 'f1': 0.96836495, 'auroc': 0.9993042, 'binary_precision': 0.9443299, 'binary_recall': 0.93342394, 'binary_specificity': 0.99808526, 'binary_f1_score': 0.9388452}
confusion matrix:
       0     1
0  42223    81
1     98  1374
---- Validation: 
scalar performance:
{'acc': 0.98855895, 'precision': 0.9300597, 'recall': 0.8905692, 'specificity': 0.8905692, 'f1': 0.9092883, 'auroc': 0.9836569, 'binary_precision': 0.8676976, 'binary_recall': 0.785381, 'binary_specificity': 0.99575734, 'binary_f1_score': 0.8244898}
confusion matrix:
       0    1
0  18072   77
1    138  505
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9592522, 'precision': 0.77026147, 'recall': 0.5408116, 'specificity': 0.5408116, 'f1': 0.5631423, 'auroc': 0.93540025, 'binary_precision': 0.57894737, 'binary_recall': 0.08429119, 'binary_specificity': 0.997332, 'binary_f1_score': 0.1471572}
confusion matrix:
      0   1
0  5981  16
1   239  22
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863846.png
better model found
persisted
after epoch: 24,now: 2024-05-27 18:18:53.118156,epoch time: 0:39:53.795533,used: 13:33:01.512792,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_04_45_51_seed_0_20863846
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99572825, 'precision': 0.979689, 'recall': 0.9535294, 'specificity': 0.9535294, 'f1': 0.9662151, 'auroc': 0.9994142, 'binary_precision': 0.962563, 'binary_recall': 0.90828806, 'binary_specificity': 0.9987708, 'binary_f1_score': 0.9346382}
confusion matrix:
       0     1
0  42252    52
1    135  1337
---- Validation: 
scalar performance:
{'acc': 0.9870157, 'precision': 0.9316285, 'recall': 0.86126816, 'specificity': 0.86126816, 'f1': 0.8930836, 'auroc': 0.9767841, 'binary_precision': 0.8728972, 'binary_recall': 0.7262831, 'binary_specificity': 0.99625325, 'binary_f1_score': 0.79286927}
confusion matrix:
       0    1
0  18081   68
1    176  467
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.830202, 'recall': 0.5263197, 'specificity': 0.5263197, 'f1': 0.5394829, 'auroc': 0.90493315, 'binary_precision': 0.7, 'binary_recall': 0.053639848, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.09964413}
confusion matrix:
      0   1
0  5991   6
1   247  14
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863846.png
early stop counter: 1
val acc:0.9870157241821289, best validation acc: 0.9885589480400085, corresponding to test acc:                         0.9592521786689758 / 0.9704378247261047
after epoch: 25,now: 2024-05-27 18:54:18.049812,epoch time: 0:35:24.931656,used: 14:08:26.444448,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_04_45_51_seed_0_20863846
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9948602, 'precision': 0.9810506, 'recall': 0.93832684, 'specificity': 0.93832684, 'f1': 0.9586226, 'auroc': 0.9993509, 'binary_precision': 0.96634257, 'binary_recall': 0.8777174, 'binary_specificity': 0.9989363, 'binary_f1_score': 0.9199003}
confusion matrix:
       0     1
0  42259    45
1    180  1292
---- Validation: 
scalar performance:
{'acc': 0.9867497, 'precision': 0.95733875, 'recall': 0.83187824, 'specificity': 0.83187824, 'f1': 0.8839174, 'auroc': 0.9819021, 'binary_precision': 0.9264069, 'binary_recall': 0.66562986, 'binary_specificity': 0.9981266, 'binary_f1_score': 0.77466065}
confusion matrix:
       0    1
0  18115   34
1    215  428
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96164906, 'precision': 0.82747936, 'recall': 0.57137954, 'specificity': 0.57137954, 'f1': 0.6104171, 'auroc': 0.92441, 'binary_precision': 0.6909091, 'binary_recall': 0.14559387, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.24050632}
confusion matrix:
      0   1
0  5980  17
1   223  38
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863846.png
early stop counter: 2
val acc:0.9867497086524963, best validation acc: 0.9885589480400085, corresponding to test acc:                         0.9592521786689758 / 0.9704378247261047
after epoch: 26,now: 2024-05-27 19:25:09.773743,epoch time: 0:30:51.723931,used: 14:39:18.168379,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_04_45_51_seed_0_20863846
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9961166, 'precision': 0.9772796, 'recall': 0.96222943, 'specificity': 0.96222943, 'f1': 0.9696249, 'auroc': 0.9994426, 'binary_precision': 0.9571328, 'binary_recall': 0.92590076, 'binary_specificity': 0.9985581, 'binary_f1_score': 0.94125783}
confusion matrix:
       0     1
0  42244    61
1    109  1362
---- Validation: 
scalar performance:
{'acc': 0.9882929, 'precision': 0.93436134, 'recall': 0.8806807, 'specificity': 0.8806807, 'f1': 0.9056142, 'auroc': 0.9832908, 'binary_precision': 0.87700534, 'binary_recall': 0.7651633, 'binary_specificity': 0.9961981, 'binary_f1_score': 0.8172757}
confusion matrix:
       0    1
0  18080   69
1    151  492
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96180886, 'precision': 0.8566543, 'recall': 0.5623013, 'specificity': 0.5623013, 'f1': 0.5984104, 'auroc': 0.933419, 'binary_precision': 0.75, 'binary_recall': 0.12643678, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.21639346}
confusion matrix:
      0   1
0  5986  11
1   228  33
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863846.png
early stop counter: 3
val acc:0.9882928729057312, best validation acc: 0.9885589480400085, corresponding to test acc:                         0.9592521786689758 / 0.9704378247261047
after epoch: 27,now: 2024-05-27 19:55:13.095527,epoch time: 0:30:03.321784,used: 15:09:21.490163,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_04_45_51_seed_0_20863846
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9975329, 'precision': 0.9837599, 'recall': 0.97803956, 'specificity': 0.97803956, 'f1': 0.98088145, 'auroc': 0.99975836, 'binary_precision': 0.96900827, 'binary_recall': 0.95714283, 'binary_specificity': 0.9989363, 'binary_f1_score': 0.96303904}
confusion matrix:
       0     1
0  42261    45
1     63  1407
---- Validation: 
scalar performance:
{'acc': 0.9890911, 'precision': 0.9376465, 'recall': 0.8908447, 'specificity': 0.8908447, 'f1': 0.9128195, 'auroc': 0.983094, 'binary_precision': 0.88286716, 'binary_recall': 0.785381, 'binary_specificity': 0.9963083, 'binary_f1_score': 0.8312757}
confusion matrix:
       0    1
0  18082   67
1    138  505
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9600511, 'precision': 0.7951281, 'recall': 0.5503901, 'specificity': 0.5503901, 'f1': 0.57857996, 'auroc': 0.9429015, 'binary_precision': 0.627907, 'binary_recall': 0.10344828, 'binary_specificity': 0.997332, 'binary_f1_score': 0.17763159}
confusion matrix:
      0   1
0  5981  16
1   234  27
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863846.png
better model found
persisted
after epoch: 28,now: 2024-05-27 20:25:12.425890,epoch time: 0:29:59.330363,used: 15:39:20.820526,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_04_45_51_seed_0_20863846
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9957968, 'precision': 0.98983335, 'recall': 0.94471276, 'specificity': 0.94471276, 'f1': 0.96610415, 'auroc': 0.99948007, 'binary_precision': 0.9834835, 'binary_recall': 0.8899456, 'binary_specificity': 0.99947995, 'binary_f1_score': 0.93437946}
confusion matrix:
       0     1
0  42282    22
1    162  1310
---- Validation: 
scalar performance:
{'acc': 0.9868561, 'precision': 0.9540416, 'recall': 0.83643365, 'specificity': 0.83643365, 'f1': 0.88585126, 'auroc': 0.97573256, 'binary_precision': 0.9194915, 'binary_recall': 0.6749611, 'binary_specificity': 0.9979062, 'binary_f1_score': 0.77847534}
confusion matrix:
       0    1
0  18111   38
1    209  434
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.9030609, 'recall': 0.52090603, 'specificity': 0.52090603, 'f1': 0.5298535, 'auroc': 0.923524, 'binary_precision': 0.84615386, 'binary_recall': 0.042145595, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.08029197}
confusion matrix:
      0   1
0  5995   2
1   250  11
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863846.png
early stop counter: 1
val acc:0.9868561029434204, best validation acc: 0.9890910983085632, corresponding to test acc:                         0.9600511193275452 / 0.9704378247261047
after epoch: 29,now: 2024-05-27 20:55:10.051896,epoch time: 0:29:57.626006,used: 16:09:18.446532,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_04_45_51_seed_0_20863846
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9937637, 'precision': 0.99047565, 'recall': 0.9124553, 'specificity': 0.9124553, 'f1': 0.94785446, 'auroc': 0.9990057, 'binary_precision': 0.9869919, 'binary_recall': 0.8252889, 'binary_specificity': 0.9996218, 'binary_f1_score': 0.8989263}
confusion matrix:
       0     1
0  42289    16
1    257  1214
---- Validation: 
scalar performance:
{'acc': 0.9841954, 'precision': 0.9665685, 'recall': 0.78405243, 'specificity': 0.78405243, 'f1': 0.8516227, 'auroc': 0.98420215, 'binary_precision': 0.9481865, 'binary_recall': 0.56920683, 'binary_specificity': 0.998898, 'binary_f1_score': 0.7113702}
confusion matrix:
       0    1
0  18129   20
1    277  366
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614893, 'precision': 0.8873775, 'recall': 0.5493082, 'specificity': 0.5493082, 'f1': 0.57887876, 'auroc': 0.9532367, 'binary_precision': 0.8125, 'binary_recall': 0.099616855, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.1774744}
confusion matrix:
      0   1
0  5991   6
1   235  26
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863846.png
early stop counter: 2
val acc:0.9841954112052917, best validation acc: 0.9890910983085632, corresponding to test acc:                         0.9600511193275452 / 0.9704378247261047
after epoch: 30,now: 2024-05-27 21:25:18.748313,epoch time: 0:30:08.696417,used: 16:39:27.142949,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_04_45_51_seed_0_20863846
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 16:39:27.142949 at 2024-05-27 21:25:18.748313
persisted model performance metric: 

scalar performance:
{'acc': 0.959412, 'precision': 0.7807167, 'recall': 0.5390626, 'specificity': 0.5390626, 'f1': 0.56055313, 'auroc': 0.9356992, 'binary_precision': 0.6, 'binary_recall': 0.08045977, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.1418919}
confusion matrix:
      0   1
0  5983  14
1   240  21
oracle model performance metric: 

scalar performance:
{'acc': 0.97267497, 'precision': 0.94516265, 'recall': 0.6889048, 'specificity': 0.6889048, 'f1': 0.76125395, 'auroc': 0.948254, 'binary_precision': 0.9166667, 'binary_recall': 0.37931034, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.5365854}
confusion matrix:
      0   1
0  5988   9
1   162  99
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs32/rule_results/7.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs32/rule_results/7.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs32/confusion_matrix/7.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1654 MiB |  30289 MiB |    949 TiB |    949 TiB |
|       from large pool |   1648 MiB |  30244 MiB |    942 TiB |    942 TiB |
|       from small pool |      5 MiB |     46 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1654 MiB |  30289 MiB |    949 TiB |    949 TiB |
|       from large pool |   1648 MiB |  30244 MiB |    942 TiB |    942 TiB |
|       from small pool |      5 MiB |     46 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1653 MiB |  30205 MiB |    945 TiB |    945 TiB |
|       from large pool |   1647 MiB |  30159 MiB |    938 TiB |    938 TiB |
|       from small pool |      5 MiB |     46 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  31326 MiB |  31326 MiB |  31326 MiB |      0 B   |
|       from large pool |  31278 MiB |  31278 MiB |  31278 MiB |      0 B   |
|       from small pool |     48 MiB |     48 MiB |     48 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 255274 KiB |    993 MiB | 131009 GiB | 131009 GiB |
|       from large pool | 216320 KiB |    991 MiB | 124164 GiB | 124164 GiB |
|       from small pool |  38954 KiB |     41 MiB |   6845 GiB |   6845 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2190    |    3619    |   76019 K  |   76016 K  |
|       from large pool |     247    |     989    |   30936 K  |   30935 K  |
|       from small pool |    1943    |    3370    |   45083 K  |   45081 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2190    |    3619    |   76019 K  |   76016 K  |
|       from large pool |     247    |     989    |   30936 K  |   30935 K  |
|       from small pool |    1943    |    3370    |   45083 K  |   45081 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     868    |     868    |     868    |       0    |
|       from large pool |     844    |     844    |     844    |       0    |
|       from small pool |      24    |      24    |      24    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     137    |    1492    |   42523 K  |   42523 K  |
|       from large pool |      95    |     549    |   20534 K  |   20534 K  |
|       from small pool |      42    |    1396    |   21988 K  |   21988 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  30289 MiB |    949 TiB |    949 TiB |
|       from large pool |  16640 KiB |  30244 MiB |    942 TiB |    942 TiB |
|       from small pool |      0 KiB |     46 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  30289 MiB |    949 TiB |    949 TiB |
|       from large pool |  16640 KiB |  30244 MiB |    942 TiB |    942 TiB |
|       from small pool |      0 KiB |     46 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  30205 MiB |    945 TiB |    945 TiB |
|       from large pool |  16640 KiB |  30159 MiB |    938 TiB |    938 TiB |
|       from small pool |      0 KiB |     46 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1904 MiB |  31326 MiB |  31326 MiB |  29422 MiB |
|       from large pool |   1860 MiB |  31278 MiB |  31278 MiB |  29418 MiB |
|       from small pool |     44 MiB |     48 MiB |     48 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    993 MiB | 131010 GiB | 131010 GiB |
|       from large pool |  24320 KiB |    991 MiB | 124165 GiB | 124165 GiB |
|       from small pool |      0 KiB |     41 MiB |   6845 GiB |   6845 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3619    |   76019 K  |   76019 K  |
|       from large pool |       2    |     989    |   30936 K  |   30936 K  |
|       from small pool |       0    |    3370    |   45083 K  |   45083 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3619    |   76019 K  |   76019 K  |
|       from large pool |       2    |     989    |   30936 K  |   30936 K  |
|       from small pool |       0    |    3370    |   45083 K  |   45083 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     115    |     868    |     868    |     753    |
|       from large pool |      93    |     844    |     844    |     751    |
|       from small pool |      22    |      24    |      24    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1492    |   42524 K  |   42524 K  |
|       from large pool |       3    |     549    |   20534 K  |   20534 K  |
|       from small pool |       0    |    1396    |   21989 K  |   21989 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  30289 MiB |    949 TiB |    949 TiB |
|       from large pool |  16640 KiB |  30244 MiB |    942 TiB |    942 TiB |
|       from small pool |      0 KiB |     46 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  30289 MiB |    949 TiB |    949 TiB |
|       from large pool |  16640 KiB |  30244 MiB |    942 TiB |    942 TiB |
|       from small pool |      0 KiB |     46 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  30205 MiB |    945 TiB |    945 TiB |
|       from large pool |  16640 KiB |  30159 MiB |    938 TiB |    938 TiB |
|       from small pool |      0 KiB |     46 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1904 MiB |  31326 MiB |  31326 MiB |  29422 MiB |
|       from large pool |   1860 MiB |  31278 MiB |  31278 MiB |  29418 MiB |
|       from small pool |     44 MiB |     48 MiB |     48 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    993 MiB | 131010 GiB | 131010 GiB |
|       from large pool |  24320 KiB |    991 MiB | 124165 GiB | 124165 GiB |
|       from small pool |      0 KiB |     41 MiB |   6845 GiB |   6845 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3619    |   76019 K  |   76019 K  |
|       from large pool |       2    |     989    |   30936 K  |   30936 K  |
|       from small pool |       0    |    3370    |   45083 K  |   45083 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3619    |   76019 K  |   76019 K  |
|       from large pool |       2    |     989    |   30936 K  |   30936 K  |
|       from small pool |       0    |    3370    |   45083 K  |   45083 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     115    |     868    |     868    |     753    |
|       from large pool |      93    |     844    |     844    |     751    |
|       from small pool |      22    |      24    |      24    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1492    |   42524 K  |   42524 K  |
|       from large pool |       3    |     549    |   20534 K  |   20534 K  |
|       from small pool |       0    |    1396    |   21989 K  |   21989 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_21_37_30_seed_1_20863846

 Experiment start at: 2024-05-27 21:37:30.660550
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.06461489200592041
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9734261, 'precision': 0.8047947, 'recall': 0.73032886, 'specificity': 0.73032886, 'f1': 0.7619174, 'auroc': 0.95738184, 'binary_precision': 0.6274328, 'binary_recall': 0.47013888, 'binary_specificity': 0.99051887, 'binary_f1_score': 0.53751487}
confusion matrix:
       0    1
0  41998  402
1    763  677
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.97203845, 'precision': 0.82343185, 'recall': 0.7165579, 'specificity': 0.7165579, 'f1': 0.75844765, 'auroc': 0.95604396, 'binary_precision': 0.66741574, 'binary_recall': 0.44130757, 'binary_specificity': 0.9918083, 'binary_f1_score': 0.5313059}
confusion matrix:
       0    1
0  17919  148
1    376  297
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97164035, 'precision': 0.9345886, 'recall': 0.6817673, 'specificity': 0.6817673, 'f1': 0.75225747, 'auroc': 0.94486403, 'binary_precision': 0.8962264, 'binary_recall': 0.3653846, 'binary_specificity': 0.99815, 'binary_f1_score': 0.51912564}
confusion matrix:
      0   1
0  5935  11
1   165  95
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863846.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-27 22:09:35.460519,epoch time: 0:32:04.799969,used: 0:32:04.799969,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_21_37_30_seed_1_20863846
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97734946, 'precision': 0.85572124, 'recall': 0.74511755, 'specificity': 0.74511755, 'f1': 0.789434, 'auroc': 0.9746404, 'binary_precision': 0.7283825, 'binary_recall': 0.4965326, 'binary_specificity': 0.99370253, 'binary_f1_score': 0.59051543}
confusion matrix:
       0    1
0  42131  267
1    726  716
---- Validation: 
scalar performance:
{'acc': 0.9735859, 'precision': 0.8447978, 'recall': 0.7202216, 'specificity': 0.7202216, 'f1': 0.76758206, 'auroc': 0.9688061, 'binary_precision': 0.7099057, 'binary_recall': 0.4472511, 'binary_specificity': 0.993192, 'binary_f1_score': 0.54876935}
confusion matrix:
       0    1
0  17944  123
1    372  301
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96003866, 'precision': 0.79382515, 'recall': 0.5561787, 'specificity': 0.5561787, 'f1': 0.587158, 'auroc': 0.9416345, 'binary_precision': 0.625, 'binary_recall': 0.115384616, 'binary_specificity': 0.99697274, 'binary_f1_score': 0.19480519}
confusion matrix:
      0   1
0  5928  18
1   230  30
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863846.png
better model found
persisted
after epoch: 2,now: 2024-05-27 22:39:34.945212,epoch time: 0:29:59.484693,used: 1:02:04.284662,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_21_37_30_seed_1_20863846
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97848994, 'precision': 0.8162203, 'recall': 0.8883229, 'specificity': 0.8883229, 'f1': 0.8482156, 'auroc': 0.9805802, 'binary_precision': 0.639574, 'binary_recall': 0.7918112, 'binary_specificity': 0.98483455, 'binary_f1_score': 0.70759684}
confusion matrix:
       0     1
0  41756   643
1    300  1141
---- Validation: 
scalar performance:
{'acc': 0.97998935, 'precision': 0.8628333, 'recall': 0.8394158, 'specificity': 0.8394158, 'f1': 0.8506975, 'auroc': 0.9732113, 'binary_precision': 0.7372612, 'binary_recall': 0.6879643, 'binary_specificity': 0.9908673, 'binary_f1_score': 0.71176016}
confusion matrix:
       0    1
0  17902  165
1    210  463
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9661618, 'precision': 0.819105, 'recall': 0.6899422, 'specificity': 0.6899422, 'f1': 0.7363956, 'auroc': 0.9446192, 'binary_precision': 0.6644737, 'binary_recall': 0.38846153, 'binary_specificity': 0.99142283, 'binary_f1_score': 0.49029127}
confusion matrix:
      0    1
0  5895   51
1   159  101
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863846.png
better model found
persisted
after epoch: 3,now: 2024-05-27 23:09:35.474839,epoch time: 0:30:00.529627,used: 1:32:04.814289,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_21_37_30_seed_1_20863846
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9797217, 'precision': 0.91846067, 'recall': 0.7295967, 'specificity': 0.7295967, 'f1': 0.7946636, 'auroc': 0.98047847, 'binary_precision': 0.85494226, 'binary_recall': 0.46185854, 'binary_specificity': 0.9973348, 'binary_f1_score': 0.59972984}
confusion matrix:
       0    1
0  42285  113
1    776  666
---- Validation: 
scalar performance:
{'acc': 0.9748132, 'precision': 0.93351424, 'recall': 0.66935885, 'specificity': 0.66935885, 'f1': 0.73977965, 'auroc': 0.9734474, 'binary_precision': 0.8910506, 'binary_recall': 0.34026745, 'binary_specificity': 0.9984502, 'binary_f1_score': 0.49247313}
confusion matrix:
       0    1
0  18039   28
1    444  229
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584273, 'precision': 0.9792069, 'recall': 0.50384617, 'specificity': 0.50384617, 'f1': 0.4970163, 'auroc': 0.9321562, 'binary_precision': 1.0, 'binary_recall': 0.0076923077, 'binary_specificity': 1.0, 'binary_f1_score': 0.015267175}
confusion matrix:
      0  1
0  5946  0
1   258  2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863846.png
early stop counter: 1
val acc:0.9748132228851318, best validation acc: 0.9799893498420715, corresponding to test acc:                         0.9661617875099182 / 0.9716403484344482
after epoch: 4,now: 2024-05-27 23:39:42.661446,epoch time: 0:30:07.186607,used: 2:02:12.000896,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_21_37_30_seed_1_20863846
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9844206, 'precision': 0.8816602, 'recall': 0.86909026, 'specificity': 0.86909026, 'f1': 0.8752613, 'auroc': 0.98451984, 'binary_precision': 0.77194244, 'binary_recall': 0.7456567, 'binary_specificity': 0.9925238, 'binary_f1_score': 0.758572}
confusion matrix:
       0     1
0  42084   317
1    366  1073
---- Validation: 
scalar performance:
{'acc': 0.9810566, 'precision': 0.87660146, 'recall': 0.83710825, 'specificity': 0.83710825, 'f1': 0.8556632, 'auroc': 0.97398585, 'binary_precision': 0.765, 'binary_recall': 0.6820208, 'binary_specificity': 0.9921957, 'binary_f1_score': 0.72113115}
confusion matrix:
       0    1
0  17926  141
1    214  459
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96728975, 'precision': 0.8913849, 'recall': 0.6408782, 'specificity': 0.6408782, 'f1': 0.7024107, 'auroc': 0.9546629, 'binary_precision': 0.8131868, 'binary_recall': 0.2846154, 'binary_specificity': 0.99714094, 'binary_f1_score': 0.42165247}
confusion matrix:
      0   1
0  5929  17
1   186  74
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863846.png
better model found
persisted
after epoch: 5,now: 2024-05-28 00:09:55.424628,epoch time: 0:30:12.763182,used: 2:32:24.764078,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_21_37_30_seed_1_20863846
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9828695, 'precision': 0.8642854, 'recall': 0.86745906, 'specificity': 0.86745906, 'f1': 0.8658648, 'auroc': 0.98525125, 'binary_precision': 0.7372765, 'binary_recall': 0.74392784, 'binary_specificity': 0.99099034, 'binary_f1_score': 0.7405873}
confusion matrix:
       0     1
0  42017   382
1    369  1072
---- Validation: 
scalar performance:
{'acc': 0.9798826, 'precision': 0.86271095, 'recall': 0.8372147, 'specificity': 0.8372147, 'f1': 0.849455, 'auroc': 0.9757718, 'binary_precision': 0.73717946, 'binary_recall': 0.68350667, 'binary_specificity': 0.9909227, 'binary_f1_score': 0.70932925}
confusion matrix:
       0    1
0  17903  164
1    213  460
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96165, 'precision': 0.7985699, 'recall': 0.59931624, 'specificity': 0.59931624, 'f1': 0.64420897, 'auroc': 0.94900453, 'binary_precision': 0.63095236, 'binary_recall': 0.20384616, 'binary_specificity': 0.9947864, 'binary_f1_score': 0.30813953}
confusion matrix:
      0   1
0  5915  31
1   207  53
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863846.png
early stop counter: 1
val acc:0.9798825979232788, best validation acc: 0.9810565710067749, corresponding to test acc:                         0.9672897458076477 / 0.9716403484344482
after epoch: 6,now: 2024-05-28 00:40:17.393633,epoch time: 0:30:21.969005,used: 3:02:46.733083,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_21_37_30_seed_1_20863846
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98656476, 'precision': 0.8922239, 'recall': 0.8982637, 'specificity': 0.8982637, 'f1': 0.8952188, 'auroc': 0.98924553, 'binary_precision': 0.79112625, 'binary_recall': 0.8037448, 'binary_specificity': 0.99278265, 'binary_f1_score': 0.7973856}
confusion matrix:
       0     1
0  42092   306
1    283  1159
---- Validation: 
scalar performance:
{'acc': 0.9833511, 'precision': 0.8907503, 'recall': 0.86047155, 'specificity': 0.86047155, 'f1': 0.8749461, 'auroc': 0.9799155, 'binary_precision': 0.79159933, 'binary_recall': 0.7280832, 'binary_specificity': 0.9928599, 'binary_f1_score': 0.75851387}
confusion matrix:
       0    1
0  17938  129
1    183  490
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96003866, 'precision': 0.91762924, 'recall': 0.5267549, 'specificity': 0.5267549, 'f1': 0.54050714, 'auroc': 0.94644916, 'binary_precision': 0.875, 'binary_recall': 0.053846154, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.10144927}
confusion matrix:
      0   1
0  5944   2
1   246  14
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863846.png
better model found
persisted
after epoch: 7,now: 2024-05-28 01:10:32.335715,epoch time: 0:30:14.942082,used: 3:33:01.675165,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_21_37_30_seed_1_20863846
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9888914, 'precision': 0.93570095, 'recall': 0.8820493, 'specificity': 0.8820493, 'f1': 0.9069828, 'auroc': 0.99385726, 'binary_precision': 0.87926924, 'binary_recall': 0.76768374, 'binary_specificity': 0.9964149, 'binary_f1_score': 0.8196964}
confusion matrix:
       0     1
0  42246   152
1    335  1107
---- Validation: 
scalar performance:
{'acc': 0.9832444, 'precision': 0.9342769, 'recall': 0.8060559, 'specificity': 0.8060559, 'f1': 0.8582014, 'auroc': 0.98071396, 'binary_precision': 0.88272923, 'binary_recall': 0.615156, 'binary_specificity': 0.99695575, 'binary_f1_score': 0.7250438}
confusion matrix:
       0    1
0  18012   55
1    259  414
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621334, 'precision': 0.96254635, 'recall': 0.5499159, 'specificity': 0.5499159, 'f1': 0.5809016, 'auroc': 0.95651734, 'binary_precision': 0.962963, 'binary_recall': 0.1, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.18118468}
confusion matrix:
      0   1
0  5945   1
1   234  26
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863846.png
early stop counter: 1
val acc:0.9832444190979004, best validation acc: 0.9833511114120483, corresponding to test acc:                         0.9600386619567871 / 0.9716403484344482
after epoch: 8,now: 2024-05-28 01:40:55.154093,epoch time: 0:30:22.818378,used: 4:03:24.493543,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_21_37_30_seed_1_20863846
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.97618616, 'precision': 0.79266775, 'recall': 0.949839, 'specificity': 0.949839, 'f1': 0.8527792, 'auroc': 0.99002796, 'binary_precision': 0.5880531, 'binary_recall': 0.92163664, 'binary_specificity': 0.9780414, 'binary_f1_score': 0.7179902}
confusion matrix:
       0     1
0  41467   931
1    113  1329
---- Validation: 
scalar performance:
{'acc': 0.9738527, 'precision': 0.79542494, 'recall': 0.90775996, 'specificity': 0.90775996, 'f1': 0.8415597, 'auroc': 0.97910154, 'binary_precision': 0.59703076, 'binary_recall': 0.83655274, 'binary_specificity': 0.9789672, 'binary_f1_score': 0.6967822}
confusion matrix:
       0    1
0  17687  380
1    110  563
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9569771, 'precision': 0.7295989, 'recall': 0.69986093, 'specificity': 0.69986093, 'f1': 0.71354914, 'auroc': 0.946039, 'binary_precision': 0.48444444, 'binary_recall': 0.41923076, 'binary_specificity': 0.9804911, 'binary_f1_score': 0.44948453}
confusion matrix:
      0    1
0  5830  116
1   151  109
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863846.png
early stop counter: 2
val acc:0.9738526940345764, best validation acc: 0.9833511114120483, corresponding to test acc:                         0.9600386619567871 / 0.9716403484344482
after epoch: 9,now: 2024-05-28 02:11:07.074978,epoch time: 0:30:11.920885,used: 4:33:36.414428,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_21_37_30_seed_1_20863846
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98779655, 'precision': 0.9005699, 'recall': 0.90995383, 'specificity': 0.90995383, 'f1': 0.9052031, 'auroc': 0.99353415, 'binary_precision': 0.8070413, 'binary_recall': 0.8266297, 'binary_specificity': 0.99327797, 'binary_f1_score': 0.816718}
confusion matrix:
       0     1
0  42113   285
1    250  1192
---- Validation: 
scalar performance:
{'acc': 0.984365, 'precision': 0.9022947, 'recall': 0.86242795, 'specificity': 0.86242795, 'f1': 0.8812314, 'auroc': 0.9787632, 'binary_precision': 0.81456953, 'binary_recall': 0.73105496, 'binary_specificity': 0.9938009, 'binary_f1_score': 0.770556}
confusion matrix:
       0    1
0  17955  112
1    181  492
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.965195, 'precision': 0.89997286, 'recall': 0.6048442, 'specificity': 0.6048442, 'f1': 0.6597757, 'auroc': 0.9627096, 'binary_precision': 0.8333333, 'binary_recall': 0.21153846, 'binary_specificity': 0.99815, 'binary_f1_score': 0.3374233}
confusion matrix:
      0   1
0  5935  11
1   205  55
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863846.png
better model found
persisted
after epoch: 10,now: 2024-05-28 02:41:29.096529,epoch time: 0:30:22.021551,used: 5:03:58.435979,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_21_37_30_seed_1_20863846
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98968977, 'precision': 0.9569471, 'recall': 0.8737535, 'specificity': 0.8737535, 'f1': 0.9108857, 'auroc': 0.9948733, 'binary_precision': 0.92235494, 'binary_recall': 0.7496533, 'binary_specificity': 0.9978537, 'binary_f1_score': 0.82708496}
confusion matrix:
       0     1
0  42307    91
1    361  1081
---- Validation: 
scalar performance:
{'acc': 0.98281753, 'precision': 0.9218124, 'recall': 0.8108413, 'specificity': 0.8108413, 'f1': 0.8572506, 'auroc': 0.97992915, 'binary_precision': 0.8574338, 'binary_recall': 0.6255572, 'binary_specificity': 0.9961255, 'binary_f1_score': 0.72336763}
confusion matrix:
       0    1
0  17997   70
1    252  421
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9624557, 'precision': 0.91395295, 'recall': 0.561118, 'specificity': 0.561118, 'f1': 0.5981279, 'auroc': 0.9559542, 'binary_precision': 0.8648649, 'binary_recall': 0.12307692, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.21548823}
confusion matrix:
      0   1
0  5941   5
1   228  32
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863846.png
early stop counter: 1
val acc:0.982817530632019, best validation acc: 0.9843649864196777, corresponding to test acc:                         0.9651950001716614 / 0.9716403484344482
after epoch: 11,now: 2024-05-28 03:11:44.183972,epoch time: 0:30:15.087443,used: 5:34:13.523422,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_21_37_30_seed_1_20863846
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9870894, 'precision': 0.8693317, 'recall': 0.9615052, 'specificity': 0.9615052, 'f1': 0.9098379, 'auroc': 0.9956649, 'binary_precision': 0.7409241, 'binary_recall': 0.9341193, 'binary_specificity': 0.988891, 'binary_f1_score': 0.8263804}
confusion matrix:
       0     1
0  41927   471
1     95  1347
---- Validation: 
scalar performance:
{'acc': 0.9842583, 'precision': 0.87115115, 'recall': 0.9181634, 'specificity': 0.9181634, 'f1': 0.8931204, 'auroc': 0.9800741, 'binary_precision': 0.7480315, 'binary_recall': 0.8469539, 'binary_specificity': 0.9893729, 'binary_f1_score': 0.794425}
confusion matrix:
       0    1
0  17875  192
1    103  570
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9624557, 'precision': 0.79618114, 'recall': 0.62732154, 'specificity': 0.62732154, 'f1': 0.6746082, 'auroc': 0.9425926, 'binary_precision': 0.6238532, 'binary_recall': 0.26153848, 'binary_specificity': 0.99310464, 'binary_f1_score': 0.36856368}
confusion matrix:
      0   1
0  5905  41
1   192  68
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863846.png
early stop counter: 2
val acc:0.9842582941055298, best validation acc: 0.9843649864196777, corresponding to test acc:                         0.9651950001716614 / 0.9716403484344482
after epoch: 12,now: 2024-05-28 03:42:05.153967,epoch time: 0:30:20.969995,used: 6:04:34.493417,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_21_37_30_seed_1_20863846
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99190235, 'precision': 0.9385091, 'recall': 0.9335132, 'specificity': 0.9335132, 'f1': 0.93599576, 'auroc': 0.99691683, 'binary_precision': 0.8814035, 'binary_recall': 0.8710125, 'binary_specificity': 0.99601394, 'binary_f1_score': 0.8761772}
confusion matrix:
       0     1
0  42229   169
1    186  1256
---- Validation: 
scalar performance:
{'acc': 0.9848986, 'precision': 0.9060659, 'recall': 0.8669963, 'specificity': 0.8669963, 'f1': 0.88545793, 'auroc': 0.97195494, 'binary_precision': 0.8217822, 'binary_recall': 0.73997027, 'binary_specificity': 0.99402225, 'binary_f1_score': 0.7787334}
confusion matrix:
       0    1
0  17959  108
1    175  498
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590719, 'precision': 0.83695555, 'recall': 0.51889443, 'specificity': 0.51889443, 'f1': 0.52603334, 'auroc': 0.9094558, 'binary_precision': 0.71428573, 'binary_recall': 0.03846154, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.072992705}
confusion matrix:
      0   1
0  5942   4
1   250  10
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863846.png
better model found
persisted
after epoch: 13,now: 2024-05-28 04:12:26.556447,epoch time: 0:30:21.402480,used: 6:34:55.895897,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_21_37_30_seed_1_20863846
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9930885, 'precision': 0.9566659, 'recall': 0.9324517, 'specificity': 0.9324517, 'f1': 0.94420433, 'auroc': 0.99739206, 'binary_precision': 0.9178283, 'binary_recall': 0.86754507, 'binary_specificity': 0.9973584, 'binary_f1_score': 0.89197856}
confusion matrix:
       0     1
0  42286   112
1    191  1251
---- Validation: 
scalar performance:
{'acc': 0.98537886, 'precision': 0.9255916, 'recall': 0.8507942, 'specificity': 0.8507942, 'f1': 0.8842932, 'auroc': 0.97734493, 'binary_precision': 0.86206895, 'binary_recall': 0.70579493, 'binary_specificity': 0.99579346, 'binary_f1_score': 0.7761438}
confusion matrix:
       0    1
0  17991   76
1    198  475
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96165, 'precision': 0.8418064, 'recall': 0.56805354, 'specificity': 0.56805354, 'f1': 0.60629594, 'auroc': 0.9374188, 'binary_precision': 0.72, 'binary_recall': 0.13846155, 'binary_specificity': 0.9976455, 'binary_f1_score': 0.23225808}
confusion matrix:
      0   1
0  5932  14
1   224  36
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863846.png
better model found
persisted
after epoch: 14,now: 2024-05-28 04:42:44.390485,epoch time: 0:30:17.834038,used: 7:05:13.729935,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_21_37_30_seed_1_20863846
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99162865, 'precision': 0.91410345, 'recall': 0.9651917, 'specificity': 0.9651917, 'f1': 0.9380398, 'auroc': 0.99761176, 'binary_precision': 0.8303626, 'binary_recall': 0.9368932, 'binary_specificity': 0.9934903, 'binary_f1_score': 0.8804171}
confusion matrix:
       0     1
0  42122   276
1     91  1351
---- Validation: 
scalar performance:
{'acc': 0.98596585, 'precision': 0.8951435, 'recall': 0.9047437, 'specificity': 0.9047437, 'f1': 0.89988065, 'auroc': 0.9785111, 'binary_precision': 0.79710144, 'binary_recall': 0.81723624, 'binary_specificity': 0.99225104, 'binary_f1_score': 0.80704325}
confusion matrix:
       0    1
0  17927  140
1    123  550
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9629391, 'precision': 0.895024, 'recall': 0.5724042, 'specificity': 0.5724042, 'f1': 0.6146836, 'auroc': 0.9471314, 'binary_precision': 0.82608694, 'binary_recall': 0.14615385, 'binary_specificity': 0.99865454, 'binary_f1_score': 0.24836601}
confusion matrix:
      0   1
0  5938   8
1   222  38
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863846.png
better model found
persisted
after epoch: 15,now: 2024-05-28 05:13:03.500240,epoch time: 0:30:19.109755,used: 7:35:32.839690,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_21_37_30_seed_1_20863846
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99078465, 'precision': 0.90701133, 'recall': 0.96073604, 'specificity': 0.96073604, 'f1': 0.9320704, 'auroc': 0.99726224, 'binary_precision': 0.8164634, 'binary_recall': 0.9285714, 'binary_specificity': 0.9929006, 'binary_f1_score': 0.8689163}
confusion matrix:
       0     1
0  42097   301
1    103  1339
---- Validation: 
scalar performance:
{'acc': 0.9851121, 'precision': 0.8918903, 'recall': 0.89357185, 'specificity': 0.89357185, 'f1': 0.8927291, 'auroc': 0.979458, 'binary_precision': 0.7914201, 'binary_recall': 0.794948, 'binary_specificity': 0.9921957, 'binary_f1_score': 0.7931801}
confusion matrix:
       0    1
0  17926  141
1    138  535
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9618111, 'precision': 0.8788693, 'recall': 0.5589427, 'specificity': 0.5589427, 'f1': 0.59389603, 'auroc': 0.936602, 'binary_precision': 0.7948718, 'binary_recall': 0.11923077, 'binary_specificity': 0.99865454, 'binary_f1_score': 0.20735787}
confusion matrix:
      0   1
0  5938   8
1   229  31
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863846.png
early stop counter: 1
val acc:0.9851120710372925, best validation acc: 0.9859658479690552, corresponding to test acc:                         0.9629390835762024 / 0.9716403484344482
after epoch: 16,now: 2024-05-28 05:43:25.579892,epoch time: 0:30:22.079652,used: 8:05:54.919342,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_21_37_30_seed_1_20863846
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99229014, 'precision': 0.95046943, 'recall': 0.9256749, 'specificity': 0.9256749, 'f1': 0.9376948, 'auroc': 0.99765587, 'binary_precision': 0.90588236, 'binary_recall': 0.8543689, 'binary_specificity': 0.99698097, 'binary_f1_score': 0.8793719}
confusion matrix:
       0     1
0  42270   128
1    210  1232
---- Validation: 
scalar performance:
{'acc': 0.98623264, 'precision': 0.9357376, 'recall': 0.8540981, 'specificity': 0.8540981, 'f1': 0.89035726, 'auroc': 0.97593063, 'binary_precision': 0.8821363, 'binary_recall': 0.71173847, 'binary_specificity': 0.99645764, 'binary_f1_score': 0.787829}
confusion matrix:
       0    1
0  18003   64
1    194  479
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96132773, 'precision': 0.87818325, 'recall': 0.55133444, 'specificity': 0.55133444, 'f1': 0.58193415, 'auroc': 0.9302178, 'binary_precision': 0.7941176, 'binary_recall': 0.103846155, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.18367349}
confusion matrix:
      0   1
0  5939   7
1   233  27
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863846.png
better model found
persisted
after epoch: 17,now: 2024-05-28 06:13:57.582197,epoch time: 0:30:32.002305,used: 8:36:26.921647,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_21_37_30_seed_1_20863846
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9935675, 'precision': 0.94123757, 'recall': 0.9601389, 'specificity': 0.9601389, 'f1': 0.95047444, 'auroc': 0.9977399, 'binary_precision': 0.8850498, 'binary_recall': 0.92435807, 'binary_specificity': 0.9959197, 'binary_f1_score': 0.90427697}
confusion matrix:
       0     1
0  42226   173
1    109  1332
---- Validation: 
scalar performance:
{'acc': 0.98596585, 'precision': 0.9094596, 'recall': 0.88185513, 'specificity': 0.88185513, 'f1': 0.89513385, 'auroc': 0.9801039, 'binary_precision': 0.827476, 'binary_recall': 0.76968795, 'binary_specificity': 0.99402225, 'binary_f1_score': 0.7975366}
confusion matrix:
       0    1
0  17959  108
1    155  518
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611666, 'precision': 0.8841975, 'recall': 0.5475724, 'specificity': 0.5475724, 'f1': 0.5759692, 'auroc': 0.9091039, 'binary_precision': 0.8064516, 'binary_recall': 0.09615385, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.1718213}
confusion matrix:
      0   1
0  5940   6
1   235  25
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863846.png
early stop counter: 1
val acc:0.9859658479690552, best validation acc: 0.9862326383590698, corresponding to test acc:                         0.9613277316093445 / 0.9716403484344482
after epoch: 18,now: 2024-05-28 06:44:17.033146,epoch time: 0:30:19.450949,used: 9:06:46.372596,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_21_37_30_seed_1_20863846
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99279195, 'precision': 0.92444766, 'recall': 0.97042704, 'specificity': 0.97042704, 'f1': 0.9461596, 'auroc': 0.99763507, 'binary_precision': 0.8507183, 'binary_recall': 0.94649065, 'binary_specificity': 0.99436337, 'binary_f1_score': 0.89605266}
confusion matrix:
       0     1
0  42162   239
1     77  1362
---- Validation: 
scalar performance:
{'acc': 0.98553896, 'precision': 0.8921342, 'recall': 0.90166116, 'specificity': 0.90166116, 'f1': 0.8968352, 'auroc': 0.97864354, 'binary_precision': 0.79130435, 'binary_recall': 0.8112927, 'binary_specificity': 0.99202967, 'binary_f1_score': 0.8011739}
confusion matrix:
       0    1
0  17923  144
1    127  546
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96036094, 'precision': 0.8401816, 'recall': 0.54347396, 'specificity': 0.54347396, 'f1': 0.5686186, 'auroc': 0.9247699, 'binary_precision': 0.71875, 'binary_recall': 0.08846154, 'binary_specificity': 0.9984864, 'binary_f1_score': 0.15753426}
confusion matrix:
      0   1
0  5937   9
1   237  23
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863846.png
early stop counter: 2
val acc:0.9855389595031738, best validation acc: 0.9862326383590698, corresponding to test acc:                         0.9613277316093445 / 0.9716403484344482
after epoch: 19,now: 2024-05-28 07:14:34.931954,epoch time: 0:30:17.898808,used: 9:37:04.271404,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_21_37_30_seed_1_20863846
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99368155, 'precision': 0.94994134, 'recall': 0.9508455, 'specificity': 0.9508455, 'f1': 0.95039296, 'auroc': 0.99777913, 'binary_precision': 0.9031142, 'binary_recall': 0.90499306, 'binary_specificity': 0.99669796, 'binary_f1_score': 0.9040526}
confusion matrix:
       0     1
0  42258   140
1    137  1305
---- Validation: 
scalar performance:
{'acc': 0.9863394, 'precision': 0.91894025, 'recall': 0.8756114, 'specificity': 0.8756114, 'f1': 0.8959937, 'auroc': 0.97445416, 'binary_precision': 0.8469218, 'binary_recall': 0.756315, 'binary_specificity': 0.99490786, 'binary_f1_score': 0.7990581}
confusion matrix:
       0    1
0  17975   92
1    164  509
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.962778, 'precision': 0.9175741, 'recall': 0.5649642, 'specificity': 0.5649642, 'f1': 0.6041772, 'auroc': 0.9384856, 'binary_precision': 0.8717949, 'binary_recall': 0.13076924, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.22742477}
confusion matrix:
      0   1
0  5941   5
1   226  34
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863846.png
better model found
persisted
after epoch: 20,now: 2024-05-28 07:44:54.378321,epoch time: 0:30:19.446367,used: 10:07:23.717771,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_21_37_30_seed_1_20863846
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9951642, 'precision': 0.9684491, 'recall': 0.95462656, 'specificity': 0.95462656, 'f1': 0.9614266, 'auroc': 0.99909306, 'binary_precision': 0.93991417, 'binary_recall': 0.9112344, 'binary_specificity': 0.9980188, 'binary_f1_score': 0.92535204}
confusion matrix:
       0     1
0  42314    84
1    128  1314
---- Validation: 
scalar performance:
{'acc': 0.9857524, 'precision': 0.93180174, 'recall': 0.85027266, 'specificity': 0.85027266, 'f1': 0.8864422, 'auroc': 0.97515863, 'binary_precision': 0.8745387, 'binary_recall': 0.70430905, 'binary_specificity': 0.9962362, 'binary_f1_score': 0.78024685}
confusion matrix:
       0    1
0  17999   68
1    199  474
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95939416, 'precision': 0.8301164, 'recall': 0.5264185, 'specificity': 0.5264185, 'f1': 0.5396142, 'auroc': 0.89824474, 'binary_precision': 0.7, 'binary_recall': 0.053846154, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.1}
confusion matrix:
      0   1
0  5940   6
1   246  14
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863846.png
early stop counter: 1
val acc:0.9857524037361145, best validation acc: 0.9863393902778625, corresponding to test acc:                         0.9627779722213745 / 0.9716403484344482
after epoch: 21,now: 2024-05-28 08:15:16.847122,epoch time: 0:30:22.468801,used: 10:37:46.186572,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_21_37_30_seed_1_20863846
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99053377, 'precision': 0.97754544, 'recall': 0.8695005, 'specificity': 0.8695005, 'f1': 0.9161582, 'auroc': 0.9981179, 'binary_precision': 0.9638663, 'binary_recall': 0.7399445, 'binary_specificity': 0.9990566, 'binary_f1_score': 0.8371911}
confusion matrix:
       0     1
0  42358    40
1    375  1067
---- Validation: 
scalar performance:
{'acc': 0.98009604, 'precision': 0.93629634, 'recall': 0.75292385, 'specificity': 0.75292385, 'f1': 0.8184368, 'auroc': 0.9710318, 'binary_precision': 0.890625, 'binary_recall': 0.50817233, 'binary_specificity': 0.9976753, 'binary_f1_score': 0.64711446}
confusion matrix:
       0    1
0  18025   42
1    331  342
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582662, 'precision': 0.7650658, 'recall': 0.50744003, 'specificity': 0.50744003, 'f1': 0.5043185, 'auroc': 0.88525236, 'binary_precision': 0.5714286, 'binary_recall': 0.015384615, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.029962547}
confusion matrix:
      0  1
0  5943  3
1   256  4
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863846.png
early stop counter: 2
val acc:0.9800960421562195, best validation acc: 0.9863393902778625, corresponding to test acc:                         0.9627779722213745 / 0.9716403484344482
after epoch: 22,now: 2024-05-28 08:45:38.253090,epoch time: 0:30:21.405968,used: 11:08:07.592540,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_21_37_30_seed_1_20863846
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9948221, 'precision': 0.97011137, 'recall': 0.94708085, 'specificity': 0.94708085, 'f1': 0.95828557, 'auroc': 0.9989096, 'binary_precision': 0.94375455, 'binary_recall': 0.8959778, 'binary_specificity': 0.9981839, 'binary_f1_score': 0.9192458}
confusion matrix:
       0     1
0  42321    77
1    150  1292
---- Validation: 
scalar performance:
{'acc': 0.9857524, 'precision': 0.91833323, 'recall': 0.8660085, 'specificity': 0.8660085, 'f1': 0.8902778, 'auroc': 0.9731613, 'binary_precision': 0.84641635, 'binary_recall': 0.7369985, 'binary_specificity': 0.99501854, 'binary_f1_score': 0.787927}
confusion matrix:
       0    1
0  17977   90
1    177  496
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96019983, 'precision': 0.80675936, 'recall': 0.5525848, 'specificity': 0.5525848, 'f1': 0.5822102, 'auroc': 0.90509653, 'binary_precision': 0.6511628, 'binary_recall': 0.10769231, 'binary_specificity': 0.9974773, 'binary_f1_score': 0.18481848}
confusion matrix:
      0   1
0  5931  15
1   232  28
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863846.png
early stop counter: 3
val acc:0.9857524037361145, best validation acc: 0.9863393902778625, corresponding to test acc:                         0.9627779722213745 / 0.9716403484344482
after epoch: 23,now: 2024-05-28 09:15:57.432712,epoch time: 0:30:19.179622,used: 11:38:26.772162,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_21_37_30_seed_1_20863846
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9928832, 'precision': 0.9574808, 'recall': 0.9279913, 'specificity': 0.9279913, 'f1': 0.9422083, 'auroc': 0.9984303, 'binary_precision': 0.91976225, 'binary_recall': 0.8585298, 'binary_specificity': 0.99745274, 'binary_f1_score': 0.8880918}
confusion matrix:
       0     1
0  42290   108
1    204  1238
---- Validation: 
scalar performance:
{'acc': 0.9829242, 'precision': 0.9046449, 'recall': 0.8323547, 'specificity': 0.8323547, 'f1': 0.8646543, 'auroc': 0.9637639, 'binary_precision': 0.8214936, 'binary_recall': 0.6701337, 'binary_specificity': 0.99457574, 'binary_f1_score': 0.7381342}
confusion matrix:
       0    1
0  17969   98
1    222  451
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96036094, 'precision': 0.8145144, 'recall': 0.5526689, 'specificity': 0.5526689, 'f1': 0.58255833, 'auroc': 0.83303756, 'binary_precision': 0.6666667, 'binary_recall': 0.10769231, 'binary_specificity': 0.9976455, 'binary_f1_score': 0.18543047}
confusion matrix:
      0   1
0  5932  14
1   232  28
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863846.png
early stop counter: 4
val acc:0.982924222946167, best validation acc: 0.9863393902778625, corresponding to test acc:                         0.9627779722213745 / 0.9716403484344482
after epoch: 24,now: 2024-05-28 09:46:14.292413,epoch time: 0:30:16.859701,used: 12:08:43.631863,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_21_37_30_seed_1_20863846
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99580294, 'precision': 0.9633049, 'recall': 0.97136927, 'specificity': 0.97136927, 'f1': 0.9672996, 'auroc': 0.9991274, 'binary_precision': 0.9284741, 'binary_recall': 0.945215, 'binary_specificity': 0.9975235, 'binary_f1_score': 0.9367697}
confusion matrix:
       0     1
0  42293   105
1     79  1363
---- Validation: 
scalar performance:
{'acc': 0.9855923, 'precision': 0.91617686, 'recall': 0.8659255, 'specificity': 0.8659255, 'f1': 0.8892995, 'auroc': 0.97659016, 'binary_precision': 0.84210527, 'binary_recall': 0.7369985, 'binary_specificity': 0.9948525, 'binary_f1_score': 0.7860539}
confusion matrix:
       0    1
0  17974   93
1    177  496
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96100545, 'precision': 0.8070208, 'recall': 0.5732341, 'specificity': 0.5732341, 'f1': 0.6118684, 'auroc': 0.9079648, 'binary_precision': 0.65, 'binary_recall': 0.15, 'binary_specificity': 0.9964682, 'binary_f1_score': 0.24375002}
confusion matrix:
      0   1
0  5925  21
1   221  39
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863846.png
early stop counter: 5
val acc:0.9855923056602478, best validation acc: 0.9863393902778625, corresponding to test acc:                         0.9627779722213745 / 0.9716403484344482
after epoch: 25,now: 2024-05-28 10:16:31.657329,epoch time: 0:30:17.364916,used: 12:39:00.996779,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_21_37_30_seed_1_20863846
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99473083, 'precision': 0.9442358, 'recall': 0.97717893, 'specificity': 0.97717893, 'f1': 0.96007186, 'auroc': 0.9991269, 'binary_precision': 0.88989055, 'binary_recall': 0.95839113, 'binary_specificity': 0.9959668, 'binary_f1_score': 0.9228715}
confusion matrix:
       0     1
0  42227   171
1     60  1382
---- Validation: 
scalar performance:
{'acc': 0.98553896, 'precision': 0.9019114, 'recall': 0.88521004, 'specificity': 0.88521004, 'f1': 0.89336777, 'auroc': 0.973716, 'binary_precision': 0.8121118, 'binary_recall': 0.7771174, 'binary_specificity': 0.9933027, 'binary_f1_score': 0.7942293}
confusion matrix:
       0    1
0  17946  121
1    150  523
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96100545, 'precision': 0.84376824, 'recall': 0.5548442, 'specificity': 0.5548442, 'f1': 0.5866766, 'auroc': 0.9055855, 'binary_precision': 0.725, 'binary_recall': 0.11153846, 'binary_specificity': 0.99815, 'binary_f1_score': 0.19333334}
confusion matrix:
      0   1
0  5935  11
1   231  29
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863846.png
early stop counter: 6
val acc:0.9855389595031738, best validation acc: 0.9863393902778625, corresponding to test acc:                         0.9627779722213745 / 0.9716403484344482
after epoch: 26,now: 2024-05-28 10:47:01.872282,epoch time: 0:30:30.214953,used: 13:09:31.211732,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_21_37_30_seed_1_20863846
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9953239, 'precision': 0.9505218, 'recall': 0.9791471, 'specificity': 0.9791471, 'f1': 0.9643593, 'auroc': 0.99937904, 'binary_precision': 0.90234375, 'binary_recall': 0.96183205, 'binary_specificity': 0.99646217, 'binary_f1_score': 0.9311387}
confusion matrix:
       0     1
0  42249   150
1     55  1386
---- Validation: 
scalar performance:
{'acc': 0.9860726, 'precision': 0.9059315, 'recall': 0.8890631, 'specificity': 0.8890631, 'f1': 0.8973025, 'auroc': 0.9778682, 'binary_precision': 0.8198758, 'binary_recall': 0.7845468, 'binary_specificity': 0.99357945, 'binary_f1_score': 0.8018223}
confusion matrix:
       0    1
0  17951  116
1    145  528
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96052206, 'precision': 0.85177743, 'recall': 0.54355806, 'specificity': 0.54355806, 'f1': 0.56893134, 'auroc': 0.9120207, 'binary_precision': 0.7419355, 'binary_recall': 0.08846154, 'binary_specificity': 0.99865454, 'binary_f1_score': 0.1580756}
confusion matrix:
      0   1
0  5938   8
1   237  23
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863846.png
early stop counter: 7
val acc:0.9860725998878479, best validation acc: 0.9863393902778625, corresponding to test acc:                         0.9627779722213745 / 0.9716403484344482
after epoch: 27,now: 2024-05-28 11:17:27.030027,epoch time: 0:30:25.157745,used: 13:39:56.369477,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_21_37_30_seed_1_20863846
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99302006, 'precision': 0.92759156, 'recall': 0.96989256, 'specificity': 0.96989256, 'f1': 0.94766426, 'auroc': 0.9987167, 'binary_precision': 0.8570529, 'binary_recall': 0.9451389, 'binary_specificity': 0.99464625, 'binary_f1_score': 0.89894325}
confusion matrix:
       0     1
0  42173   227
1     79  1361
---- Validation: 
scalar performance:
{'acc': 0.9846318, 'precision': 0.8927165, 'recall': 0.88259375, 'specificity': 0.88259375, 'f1': 0.88758314, 'auroc': 0.9789789, 'binary_precision': 0.79389316, 'binary_recall': 0.7726597, 'binary_specificity': 0.99252784, 'binary_f1_score': 0.78313255}
confusion matrix:
       0    1
0  17932  135
1    153  520
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587496, 'precision': 0.8129911, 'recall': 0.51504827, 'specificity': 0.51504827, 'f1': 0.51886815, 'auroc': 0.94083774, 'binary_precision': 0.6666667, 'binary_recall': 0.03076923, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.05882353}
confusion matrix:
      0  1
0  5942  4
1   252  8
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863846.png
early stop counter: 8
val acc:0.9846317768096924, best validation acc: 0.9863393902778625, corresponding to test acc:                         0.9627779722213745 / 0.9716403484344482
after epoch: 28,now: 2024-05-28 11:48:17.126434,epoch time: 0:30:50.096407,used: 14:10:46.465884,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_21_37_30_seed_1_20863846
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9962135, 'precision': 0.973845, 'recall': 0.96622235, 'specificity': 0.96622235, 'f1': 0.9700005, 'auroc': 0.9993845, 'binary_precision': 0.9499295, 'binary_recall': 0.9341193, 'binary_specificity': 0.9983254, 'binary_f1_score': 0.94195807}
confusion matrix:
       0     1
0  42327    71
1     95  1347
---- Validation: 
scalar performance:
{'acc': 0.9864461, 'precision': 0.92612493, 'recall': 0.86851406, 'specificity': 0.86851406, 'f1': 0.8950567, 'auroc': 0.97617954, 'binary_precision': 0.8618308, 'binary_recall': 0.74145615, 'binary_specificity': 0.99557203, 'binary_f1_score': 0.79712456}
confusion matrix:
       0    1
0  17987   80
1    174  499
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95939416, 'precision': 0.7971556, 'recall': 0.5356135, 'specificity': 0.5356135, 'f1': 0.5551229, 'auroc': 0.90335566, 'binary_precision': 0.6333333, 'binary_recall': 0.073076926, 'binary_specificity': 0.99815, 'binary_f1_score': 0.1310345}
confusion matrix:
      0   1
0  5935  11
1   241  19
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863846.png
better model found
persisted
after epoch: 29,now: 2024-05-28 12:17:36.494869,epoch time: 0:29:19.368435,used: 14:40:05.834319,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_21_37_30_seed_1_20863846
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99491334, 'precision': 0.9377407, 'recall': 0.9900013, 'specificity': 0.9900013, 'f1': 0.96228015, 'auroc': 0.9994681, 'binary_precision': 0.8760025, 'binary_recall': 0.9847434, 'binary_specificity': 0.9952592, 'binary_f1_score': 0.9271956}
confusion matrix:
       0     1
0  42197   201
1     22  1420
---- Validation: 
scalar performance:
{'acc': 0.98537886, 'precision': 0.8831135, 'recall': 0.91588354, 'specificity': 0.91588354, 'f1': 0.8987627, 'auroc': 0.9806008, 'binary_precision': 0.7721692, 'binary_recall': 0.8410104, 'binary_specificity': 0.99075663, 'binary_f1_score': 0.80512094}
confusion matrix:
       0    1
0  17900  167
1    107  566
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96052206, 'precision': 0.79153585, 'recall': 0.57298183, 'specificity': 0.57298183, 'f1': 0.6106099, 'auroc': 0.93638176, 'binary_precision': 0.61904764, 'binary_recall': 0.15, 'binary_specificity': 0.9959637, 'binary_f1_score': 0.24148609}
confusion matrix:
      0   1
0  5922  24
1   221  39
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863846.png
early stop counter: 1
val acc:0.9853788614273071, best validation acc: 0.9864460825920105, corresponding to test acc:                         0.9593941569328308 / 0.9716403484344482
after epoch: 30,now: 2024-05-28 12:47:53.903719,epoch time: 0:30:17.408850,used: 15:10:23.243169,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_21_37_30_seed_1_20863846
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 15:10:23.243169 at 2024-05-28 12:47:53.903719
persisted model performance metric: 

scalar performance:
{'acc': 0.96019983, 'precision': 0.842723, 'recall': 0.5397119, 'specificity': 0.5397119, 'f1': 0.5624771, 'auroc': 0.912164, 'binary_precision': 0.7241379, 'binary_recall': 0.08076923, 'binary_specificity': 0.99865454, 'binary_f1_score': 0.14532872}
confusion matrix:
      0   1
0  5938   8
1   239  21
oracle model performance metric: 

scalar performance:
{'acc': 0.9722849, 'precision': 0.9299326, 'recall': 0.6931376, 'specificity': 0.6931376, 'f1': 0.7629094, 'auroc': 0.94146156, 'binary_precision': 0.88596493, 'binary_recall': 0.38846153, 'binary_specificity': 0.99781364, 'binary_f1_score': 0.54010695}
confusion matrix:
      0    1
0  5933   13
1   159  101
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs32/rule_results/7.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs32/confusion_matrix/7.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1654 MiB |  30289 MiB |   1904 TiB |   1904 TiB |
|       from large pool |   1648 MiB |  30244 MiB |   1890 TiB |   1890 TiB |
|       from small pool |      5 MiB |     46 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1654 MiB |  30289 MiB |   1904 TiB |   1904 TiB |
|       from large pool |   1648 MiB |  30244 MiB |   1890 TiB |   1890 TiB |
|       from small pool |      5 MiB |     46 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1653 MiB |  30205 MiB |   1896 TiB |   1896 TiB |
|       from large pool |   1647 MiB |  30159 MiB |   1883 TiB |   1883 TiB |
|       from small pool |      5 MiB |     46 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  31332 MiB |  31332 MiB |  60754 MiB |  29422 MiB |
|       from large pool |  31284 MiB |  31284 MiB |  60702 MiB |  29418 MiB |
|       from small pool |     48 MiB |     48 MiB |     52 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 257328 KiB |    999 MiB | 260063 GiB | 260063 GiB |
|       from large pool | 216320 KiB |    996 MiB | 246356 GiB | 246355 GiB |
|       from small pool |  41008 KiB |     41 MiB |  13707 GiB |  13707 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2178    |    3623    |  152354 K  |  152351 K  |
|       from large pool |     247    |     989    |   62051 K  |   62051 K  |
|       from small pool |    1931    |    3374    |   90302 K  |   90300 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2178    |    3623    |  152354 K  |  152351 K  |
|       from large pool |     247    |     989    |   62051 K  |   62051 K  |
|       from small pool |    1931    |    3374    |   90302 K  |   90300 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     871    |     871    |    1624    |     753    |
|       from large pool |     847    |     847    |    1598    |     751    |
|       from small pool |      24    |      24    |      26    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     141    |    1495    |   84690 K  |   84689 K  |
|       from large pool |      95    |     554    |   41241 K  |   41241 K  |
|       from small pool |      46    |    1399    |   43448 K  |   43448 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  30289 MiB |   1904 TiB |   1904 TiB |
|       from large pool |  16640 KiB |  30244 MiB |   1890 TiB |   1890 TiB |
|       from small pool |      0 KiB |     46 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  30289 MiB |   1904 TiB |   1904 TiB |
|       from large pool |  16640 KiB |  30244 MiB |   1890 TiB |   1890 TiB |
|       from small pool |      0 KiB |     46 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  30205 MiB |   1896 TiB |   1896 TiB |
|       from large pool |  16640 KiB |  30159 MiB |   1883 TiB |   1883 TiB |
|       from small pool |      0 KiB |     46 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1906 MiB |  31332 MiB |  60754 MiB |  58848 MiB |
|       from large pool |   1860 MiB |  31284 MiB |  60702 MiB |  58842 MiB |
|       from small pool |     46 MiB |     48 MiB |     52 MiB |      6 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    999 MiB | 260065 GiB | 260065 GiB |
|       from large pool |  24320 KiB |    996 MiB | 246357 GiB | 246357 GiB |
|       from small pool |      0 KiB |     45 MiB |  13707 GiB |  13707 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3623    |  152354 K  |  152354 K  |
|       from large pool |       2    |     989    |   62051 K  |   62051 K  |
|       from small pool |       0    |    3374    |   90302 K  |   90302 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3623    |  152354 K  |  152354 K  |
|       from large pool |       2    |     989    |   62051 K  |   62051 K  |
|       from small pool |       0    |    3374    |   90302 K  |   90302 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     116    |     871    |    1624    |    1508    |
|       from large pool |      93    |     847    |    1598    |    1505    |
|       from small pool |      23    |      24    |      26    |       3    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1495    |   84690 K  |   84690 K  |
|       from large pool |       3    |     554    |   41241 K  |   41241 K  |
|       from small pool |       0    |    1399    |   43449 K  |   43449 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Tue May 28 12:50:33 2024]
Finished job 0.
1 of 1 steps (100%) done
