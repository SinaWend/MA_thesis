Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sun May 26 12:25:44 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs32/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs32/rule_results/8.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=8
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_36_35_seed_0_20863193

 Experiment start at: 2024-05-26 12:36:35.718671
before training, model accuracy: 0.2401725947856903
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9675164, 'precision': 0.74989176, 'recall': 0.71857005, 'specificity': 0.71857005, 'f1': 0.7330703, 'auroc': 0.94436795, 'binary_precision': 0.51875, 'binary_recall': 0.4517007, 'binary_specificity': 0.9854394, 'binary_f1_score': 0.48290908}
confusion matrix:
       0    1
0  41690  616
1    806  664
---- Validation: 
scalar performance:
{'acc': 0.96647507, 'precision': 0.74620724, 'recall': 0.7336253, 'specificity': 0.7336253, 'f1': 0.7397325, 'auroc': 0.9399668, 'binary_precision': 0.5106732, 'binary_recall': 0.4836703, 'binary_specificity': 0.98358035, 'binary_f1_score': 0.49680513}
confusion matrix:
       0    1
0  17851  298
1    332  311
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96756154, 'precision': 0.915711, 'recall': 0.6312668, 'specificity': 0.6312668, 'f1': 0.69400924, 'auroc': 0.90633225, 'binary_precision': 0.8625, 'binary_recall': 0.26436782, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.40469208}
confusion matrix:
      0   1
0  5986  11
1   192  69
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863193.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-26 12:55:33.706041,epoch time: 0:18:57.987370,used: 0:18:57.987370,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_36_35_seed_0_20863193
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9698693, 'precision': 0.7677049, 'recall': 0.77279544, 'specificity': 0.77279544, 'f1': 0.7702236, 'auroc': 0.95298076, 'binary_precision': 0.5506667, 'binary_recall': 0.5615228, 'binary_specificity': 0.9840681, 'binary_f1_score': 0.5560417}
confusion matrix:
       0    1
0  41631  674
1    645  826
---- Validation: 
scalar performance:
{'acc': 0.97046614, 'precision': 0.78522694, 'recall': 0.71919036, 'specificity': 0.71919036, 'f1': 0.7474621, 'auroc': 0.9527328, 'binary_precision': 0.58979595, 'binary_recall': 0.44945568, 'binary_specificity': 0.988925, 'binary_f1_score': 0.5101501}
confusion matrix:
       0    1
0  17948  201
1    354  289
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97315437, 'precision': 0.93601644, 'recall': 0.70014894, 'specificity': 0.70014894, 'f1': 0.7708574, 'auroc': 0.92441475, 'binary_precision': 0.8974359, 'binary_recall': 0.40229884, 'binary_specificity': 0.997999, 'binary_f1_score': 0.5555556}
confusion matrix:
      0    1
0  5985   12
1   156  105
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863193.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-05-26 13:13:21.046318,epoch time: 0:17:47.340277,used: 0:36:45.327647,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_36_35_seed_0_20863193
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9725877, 'precision': 0.78852427, 'recall': 0.7907971, 'specificity': 0.7907971, 'f1': 0.7896558, 'auroc': 0.96475077, 'binary_precision': 0.5910931, 'binary_recall': 0.59591836, 'binary_specificity': 0.9856758, 'binary_f1_score': 0.59349597}
confusion matrix:
       0    1
0  41700  606
1    594  876
---- Validation: 
scalar performance:
{'acc': 0.9736058, 'precision': 0.8077898, 'recall': 0.76881933, 'specificity': 0.76881933, 'f1': 0.7868607, 'auroc': 0.9598519, 'binary_precision': 0.6314848, 'binary_recall': 0.5489891, 'binary_specificity': 0.9886495, 'binary_f1_score': 0.5873544}
confusion matrix:
       0    1
0  17943  206
1    290  353
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97794825, 'precision': 0.94614506, 'recall': 0.7594525, 'specificity': 0.7594525, 'f1': 0.8260076, 'auroc': 0.9350978, 'binary_precision': 0.9127517, 'binary_recall': 0.5210728, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.6634146}
confusion matrix:
      0    1
0  5984   13
1   125  136
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863193.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-05-26 13:31:01.686200,epoch time: 0:17:40.639882,used: 0:54:25.967529,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_36_35_seed_0_20863193
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.975466, 'precision': 0.80990285, 'recall': 0.81559676, 'specificity': 0.81559676, 'f1': 0.8127214, 'auroc': 0.96991086, 'binary_precision': 0.6321762, 'binary_recall': 0.64421767, 'binary_specificity': 0.98697585, 'binary_f1_score': 0.63814014}
confusion matrix:
       0    1
0  41755  551
1    523  947
---- Validation: 
scalar performance:
{'acc': 0.9770647, 'precision': 0.8436182, 'recall': 0.7818608, 'specificity': 0.7818608, 'f1': 0.80942094, 'auroc': 0.9641153, 'binary_precision': 0.70229006, 'binary_recall': 0.57231724, 'binary_specificity': 0.9914045, 'binary_f1_score': 0.6306769}
confusion matrix:
       0    1
0  17993  156
1    275  368
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97746885, 'precision': 0.92987347, 'recall': 0.7646994, 'specificity': 0.7646994, 'f1': 0.8259144, 'auroc': 0.9311858, 'binary_precision': 0.87974685, 'binary_recall': 0.532567, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.66348445}
confusion matrix:
      0    1
0  5978   19
1   122  139
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863193.png
better model found
persisted
after epoch: 4,now: 2024-05-26 13:48:43.443500,epoch time: 0:17:41.757300,used: 1:12:07.724829,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_36_35_seed_0_20863193
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9761513, 'precision': 0.8180435, 'recall': 0.81094706, 'specificity': 0.81094706, 'f1': 0.8144514, 'auroc': 0.9719181, 'binary_precision': 0.6488178, 'binary_recall': 0.6338315, 'binary_specificity': 0.9880626, 'binary_f1_score': 0.6412371}
confusion matrix:
       0    1
0  41799  505
1    539  933
---- Validation: 
scalar performance:
{'acc': 0.9775969, 'precision': 0.8412256, 'recall': 0.8016378, 'specificity': 0.8016378, 'f1': 0.8201022, 'auroc': 0.96836823, 'binary_precision': 0.69611305, 'binary_recall': 0.61275274, 'binary_specificity': 0.9905229, 'binary_f1_score': 0.65177834}
confusion matrix:
       0    1
0  17977  172
1    249  394
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9742729, 'precision': 0.95676565, 'recall': 0.7043972, 'specificity': 0.7043972, 'f1': 0.7787029, 'auroc': 0.94498336, 'binary_precision': 0.9385965, 'binary_recall': 0.4099617, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.5706667}
confusion matrix:
      0    1
0  5990    7
1   154  107
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863193.png
better model found
persisted
after epoch: 5,now: 2024-05-26 14:06:21.212927,epoch time: 0:17:37.769427,used: 1:29:45.494256,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_36_35_seed_0_20863193
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9793951, 'precision': 0.87219745, 'recall': 0.78002053, 'specificity': 0.78002053, 'f1': 0.8190701, 'auroc': 0.9757595, 'binary_precision': 0.7593437, 'binary_recall': 0.56628144, 'binary_specificity': 0.99375963, 'binary_f1_score': 0.6487539}
confusion matrix:
       0    1
0  42041  264
1    638  833
---- Validation: 
scalar performance:
{'acc': 0.9793529, 'precision': 0.90041363, 'recall': 0.7530433, 'specificity': 0.7530433, 'f1': 0.80886704, 'auroc': 0.969486, 'binary_precision': 0.81795514, 'binary_recall': 0.5101089, 'binary_specificity': 0.99597776, 'binary_f1_score': 0.6283526}
confusion matrix:
       0    1
0  18076   73
1    315  328
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96676254, 'precision': 0.9742236, 'recall': 0.6033649, 'specificity': 0.6033649, 'f1': 0.66236144, 'auroc': 0.9492802, 'binary_precision': 0.9818182, 'binary_recall': 0.20689656, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.34177217}
confusion matrix:
      0   1
0  5996   1
1   207  54
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863193.png
better model found
persisted
after epoch: 6,now: 2024-05-26 14:23:56.981894,epoch time: 0:17:35.768967,used: 1:47:21.263223,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_36_35_seed_0_20863193
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97962356, 'precision': 0.84554666, 'recall': 0.83646184, 'specificity': 0.83646184, 'f1': 0.84093827, 'auroc': 0.9778429, 'binary_precision': 0.7020979, 'binary_recall': 0.6829932, 'binary_specificity': 0.9899305, 'binary_f1_score': 0.6924138}
confusion matrix:
       0     1
0  41880   426
1    466  1004
---- Validation: 
scalar performance:
{'acc': 0.98052365, 'precision': 0.8823396, 'recall': 0.79790264, 'specificity': 0.79790264, 'f1': 0.8344523, 'auroc': 0.97106576, 'binary_precision': 0.77867204, 'binary_recall': 0.60186625, 'binary_specificity': 0.99393904, 'binary_f1_score': 0.6789474}
confusion matrix:
       0    1
0  18039  110
1    256  387
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96596354, 'precision': 0.95529765, 'recall': 0.59745103, 'specificity': 0.59745103, 'f1': 0.653176, 'auroc': 0.94759434, 'binary_precision': 0.9444444, 'binary_recall': 0.1954023, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.32380953}
confusion matrix:
      0   1
0  5994   3
1   210  51
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863193.png
better model found
persisted
after epoch: 7,now: 2024-05-26 14:41:35.844127,epoch time: 0:17:38.862233,used: 2:05:00.125456,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_36_35_seed_0_20863193
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97960067, 'precision': 0.8527087, 'recall': 0.8194972, 'specificity': 0.8194972, 'f1': 0.8352105, 'auroc': 0.9806541, 'binary_precision': 0.7176205, 'binary_recall': 0.6478586, 'binary_specificity': 0.9911358, 'binary_f1_score': 0.6809575}
confusion matrix:
       0    1
0  41930  375
1    518  953
---- Validation: 
scalar performance:
{'acc': 0.98020434, 'precision': 0.8813634, 'recall': 0.79248697, 'specificity': 0.79248697, 'f1': 0.83058643, 'auroc': 0.9740961, 'binary_precision': 0.7770961, 'binary_recall': 0.59097975, 'binary_specificity': 0.9939942, 'binary_f1_score': 0.6713781}
confusion matrix:
       0    1
0  18040  109
1    263  380
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96180886, 'precision': 0.96007776, 'recall': 0.5439779, 'specificity': 0.5439779, 'f1': 0.5709315, 'auroc': 0.94835556, 'binary_precision': 0.9583333, 'binary_recall': 0.08812261, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.1614035}
confusion matrix:
      0   1
0  5996   1
1   238  23
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863193.png
early stop counter: 1
val acc:0.9802043437957764, best validation acc: 0.9805236458778381, corresponding to test acc:                         0.9659635424613953 / 0.9779482483863831
after epoch: 8,now: 2024-05-26 14:59:20.825581,epoch time: 0:17:44.981454,used: 2:22:45.106910,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_36_35_seed_0_20863193
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9818851, 'precision': 0.9047058, 'recall': 0.7912917, 'specificity': 0.7912917, 'f1': 0.8380581, 'auroc': 0.98518944, 'binary_precision': 0.82364154, 'binary_recall': 0.5869565, 'binary_specificity': 0.99562687, 'binary_f1_score': 0.68544227}
confusion matrix:
       0    1
0  42119  185
1    608  864
---- Validation: 
scalar performance:
{'acc': 0.98020434, 'precision': 0.90210843, 'recall': 0.7677351, 'specificity': 0.7677351, 'f1': 0.82042253, 'auroc': 0.9744403, 'binary_precision': 0.820331, 'binary_recall': 0.53965783, 'binary_specificity': 0.9958124, 'binary_f1_score': 0.65103185}
confusion matrix:
       0    1
0  18073   76
1    296  347
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9603707, 'precision': 0.8852012, 'recall': 0.53223354, 'specificity': 0.53223354, 'f1': 0.550148, 'auroc': 0.9445443, 'binary_precision': 0.8095238, 'binary_recall': 0.0651341, 'binary_specificity': 0.999333, 'binary_f1_score': 0.120567374}
confusion matrix:
      0   1
0  5993   4
1   244  17
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863193.png
early stop counter: 2
val acc:0.9802043437957764, best validation acc: 0.9805236458778381, corresponding to test acc:                         0.9659635424613953 / 0.9779482483863831
after epoch: 9,now: 2024-05-26 15:17:29.054595,epoch time: 0:18:08.229014,used: 2:40:53.335924,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_36_35_seed_0_20863193
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9828445, 'precision': 0.88291943, 'recall': 0.8403106, 'specificity': 0.8403106, 'f1': 0.8602554, 'auroc': 0.9862778, 'binary_precision': 0.7766692, 'binary_recall': 0.6875, 'binary_specificity': 0.9931212, 'binary_f1_score': 0.72936934}
confusion matrix:
       0     1
0  42013   291
1    460  1012
---- Validation: 
scalar performance:
{'acc': 0.9827054, 'precision': 0.90445507, 'recall': 0.8132832, 'specificity': 0.8132832, 'f1': 0.8526215, 'auroc': 0.9772374, 'binary_precision': 0.82186234, 'binary_recall': 0.63141525, 'binary_specificity': 0.9951512, 'binary_f1_score': 0.71416}
confusion matrix:
       0    1
0  18061   88
1    237  406
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589326, 'precision': 0.78552353, 'recall': 0.52048916, 'specificity': 0.52048916, 'f1': 0.5289256, 'auroc': 0.9447441, 'binary_precision': 0.6111111, 'binary_recall': 0.042145595, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.07885305}
confusion matrix:
      0   1
0  5990   7
1   250  11
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863193.png
better model found
persisted
after epoch: 10,now: 2024-05-26 15:35:18.119381,epoch time: 0:17:49.064786,used: 2:58:42.400710,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_36_35_seed_0_20863193
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98318714, 'precision': 0.8659589, 'recall': 0.8808141, 'specificity': 0.8808141, 'f1': 0.8732255, 'auroc': 0.9866918, 'binary_precision': 0.7398957, 'binary_recall': 0.7710598, 'binary_specificity': 0.9905683, 'binary_f1_score': 0.75515634}
confusion matrix:
       0     1
0  41905   399
1    337  1135
---- Validation: 
scalar performance:
{'acc': 0.9831311, 'precision': 0.87368333, 'recall': 0.8697578, 'specificity': 0.8697578, 'f1': 0.8717092, 'auroc': 0.97800064, 'binary_precision': 0.7562893, 'binary_recall': 0.748056, 'binary_specificity': 0.9914596, 'binary_f1_score': 0.7521501}
confusion matrix:
       0    1
0  17994  155
1    162  481
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.8550545, 'recall': 0.522655, 'specificity': 0.522655, 'f1': 0.5329855, 'auroc': 0.9366586, 'binary_precision': 0.75, 'binary_recall': 0.04597701, 'binary_specificity': 0.999333, 'binary_f1_score': 0.0866426}
confusion matrix:
      0   1
0  5993   4
1   249  12
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863193.png
better model found
persisted
after epoch: 11,now: 2024-05-26 15:52:57.265224,epoch time: 0:17:39.145843,used: 3:16:21.546553,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_36_35_seed_0_20863193
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9840095, 'precision': 0.87172484, 'recall': 0.887322, 'specificity': 0.887322, 'f1': 0.879349, 'auroc': 0.9883964, 'binary_precision': 0.7509778, 'binary_recall': 0.78367347, 'binary_specificity': 0.99097055, 'binary_f1_score': 0.7669773}
confusion matrix:
       0     1
0  41924   382
1    318  1152
---- Validation: 
scalar performance:
{'acc': 0.9849404, 'precision': 0.9014465, 'recall': 0.8609438, 'specificity': 0.8609438, 'f1': 0.88003016, 'auroc': 0.978018, 'binary_precision': 0.8125, 'binary_recall': 0.7278383, 'binary_specificity': 0.99404925, 'binary_f1_score': 0.76784253}
confusion matrix:
       0    1
0  18041  108
1    175  468
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.81986356, 'recall': 0.5356481, 'specificity': 0.5356481, 'f1': 0.55547976, 'auroc': 0.94954467, 'binary_precision': 0.6785714, 'binary_recall': 0.07279693, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.13148788}
confusion matrix:
      0   1
0  5988   9
1   242  19
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863193.png
better model found
persisted
after epoch: 12,now: 2024-05-26 16:10:36.684959,epoch time: 0:17:39.419735,used: 3:34:00.966288,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_36_35_seed_0_20863193
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.984375, 'precision': 0.89518356, 'recall': 0.8535609, 'specificity': 0.8535609, 'f1': 0.87312067, 'auroc': 0.9875616, 'binary_precision': 0.8003049, 'binary_recall': 0.7133152, 'binary_specificity': 0.9938067, 'binary_f1_score': 0.7543103}
confusion matrix:
       0     1
0  42042   262
1    422  1050
---- Validation: 
scalar performance:
{'acc': 0.98408896, 'precision': 0.9026356, 'recall': 0.84250164, 'specificity': 0.84250164, 'f1': 0.86994475, 'auroc': 0.9793921, 'binary_precision': 0.8161765, 'binary_recall': 0.6905132, 'binary_specificity': 0.99449, 'binary_f1_score': 0.74810445}
confusion matrix:
       0    1
0  18049  100
1    199  444
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579738, 'precision': 0.6878402, 'recall': 0.50899494, 'specificity': 0.50899494, 'f1': 0.5075742, 'auroc': 0.93590724, 'binary_precision': 0.41666666, 'binary_recall': 0.019157087, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.03663004}
confusion matrix:
      0  1
0  5990  7
1   256  5
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863193.png
early stop counter: 1
val acc:0.9840889573097229, best validation acc: 0.9849404096603394, corresponding to test acc:                         0.9598913192749023 / 0.9779482483863831
after epoch: 13,now: 2024-05-26 16:28:12.786016,epoch time: 0:17:36.101057,used: 3:51:37.067345,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_36_35_seed_0_20863193
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98496896, 'precision': 0.87220806, 'recall': 0.9083253, 'specificity': 0.9083253, 'f1': 0.88935626, 'auroc': 0.9907825, 'binary_precision': 0.7504644, 'binary_recall': 0.82617587, 'binary_specificity': 0.9904748, 'binary_f1_score': 0.78650224}
confusion matrix:
       0     1
0  41906   403
1    255  1212
---- Validation: 
scalar performance:
{'acc': 0.9837165, 'precision': 0.87312996, 'recall': 0.8843119, 'specificity': 0.8843119, 'f1': 0.878631, 'auroc': 0.9782629, 'binary_precision': 0.7541478, 'binary_recall': 0.777605, 'binary_specificity': 0.9910188, 'binary_f1_score': 0.7656968}
confusion matrix:
       0    1
0  17986  163
1    143  500
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590924, 'precision': 0.78026634, 'recall': 0.5279019, 'specificity': 0.5279019, 'f1': 0.54198146, 'auroc': 0.9452519, 'binary_precision': 0.6, 'binary_recall': 0.057471264, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.1048951}
confusion matrix:
      0   1
0  5987  10
1   246  15
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863193.png
early stop counter: 2
val acc:0.9837164878845215, best validation acc: 0.9849404096603394, corresponding to test acc:                         0.9598913192749023 / 0.9779482483863831
after epoch: 14,now: 2024-05-26 16:45:45.339600,epoch time: 0:17:32.553584,used: 4:09:09.620929,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_36_35_seed_0_20863193
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98691064, 'precision': 0.9158125, 'recall': 0.8744607, 'specificity': 0.8744607, 'f1': 0.89396846, 'auroc': 0.99193895, 'binary_precision': 0.8401515, 'binary_recall': 0.75390893, 'binary_specificity': 0.9950124, 'binary_f1_score': 0.7946972}
confusion matrix:
       0     1
0  42094   211
1    362  1109
---- Validation: 
scalar performance:
{'acc': 0.98499364, 'precision': 0.9109731, 'recall': 0.8489704, 'specificity': 0.8489704, 'f1': 0.8772391, 'auroc': 0.97769976, 'binary_precision': 0.83241254, 'binary_recall': 0.7029549, 'binary_specificity': 0.99498594, 'binary_f1_score': 0.7622259}
confusion matrix:
       0    1
0  18058   91
1    191  452
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.9344558, 'recall': 0.5190737, 'specificity': 0.5190737, 'f1': 0.52647394, 'auroc': 0.938838, 'binary_precision': 0.90909094, 'binary_recall': 0.038314175, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.07352941}
confusion matrix:
      0   1
0  5996   1
1   251  10
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863193.png
better model found
persisted
after epoch: 15,now: 2024-05-26 17:03:21.043982,epoch time: 0:17:35.704382,used: 4:26:45.325311,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_36_35_seed_0_20863193
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9856314, 'precision': 0.90113866, 'recall': 0.8702759, 'specificity': 0.8702759, 'f1': 0.8850393, 'auroc': 0.9918752, 'binary_precision': 0.8110701, 'binary_recall': 0.74660325, 'binary_specificity': 0.9939486, 'binary_f1_score': 0.7775026}
confusion matrix:
       0     1
0  42048   256
1    373  1099
---- Validation: 
scalar performance:
{'acc': 0.9852065, 'precision': 0.9050052, 'recall': 0.8610815, 'specificity': 0.8610815, 'f1': 0.8816806, 'auroc': 0.97891307, 'binary_precision': 0.8196147, 'binary_recall': 0.7278383, 'binary_specificity': 0.99432474, 'binary_f1_score': 0.771005}
confusion matrix:
       0    1
0  18046  103
1    175  468
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96196866, 'precision': 0.8653782, 'recall': 0.56238467, 'specificity': 0.56238467, 'f1': 0.5988081, 'auroc': 0.94820905, 'binary_precision': 0.76744187, 'binary_recall': 0.12643678, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.21710527}
confusion matrix:
      0   1
0  5987  10
1   228  33
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863193.png
better model found
persisted
after epoch: 16,now: 2024-05-26 17:20:59.756519,epoch time: 0:17:38.712537,used: 4:44:24.037848,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_36_35_seed_0_20863193
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98617965, 'precision': 0.8902081, 'recall': 0.89967316, 'specificity': 0.89967316, 'f1': 0.89487904, 'auroc': 0.9921824, 'binary_precision': 0.7871353, 'binary_recall': 0.80693406, 'binary_specificity': 0.99241227, 'binary_f1_score': 0.7969117}
confusion matrix:
       0     1
0  41984   321
1    284  1187
---- Validation: 
scalar performance:
{'acc': 0.9832908, 'precision': 0.86931336, 'recall': 0.88259137, 'specificity': 0.88259137, 'f1': 0.87582445, 'auroc': 0.97894084, 'binary_precision': 0.7466267, 'binary_recall': 0.7744945, 'binary_specificity': 0.9906882, 'binary_f1_score': 0.7603053}
confusion matrix:
       0    1
0  17980  169
1    145  498
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9600511, 'precision': 0.9134711, 'recall': 0.5247375, 'specificity': 0.5247375, 'f1': 0.536889, 'auroc': 0.93971074, 'binary_precision': 0.8666667, 'binary_recall': 0.049808428, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.09420289}
confusion matrix:
      0   1
0  5995   2
1   248  13
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863193.png
early stop counter: 1
val acc:0.9832907915115356, best validation acc: 0.9852064847946167, corresponding to test acc:                         0.9619686603546143 / 0.9779482483863831
after epoch: 17,now: 2024-05-26 17:38:42.157803,epoch time: 0:17:42.401284,used: 5:02:06.439132,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_36_35_seed_0_20863193
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9876873, 'precision': 0.9121545, 'recall': 0.89454764, 'specificity': 0.89454764, 'f1': 0.9031433, 'auroc': 0.99316275, 'binary_precision': 0.8314367, 'binary_recall': 0.79469746, 'binary_specificity': 0.9943978, 'binary_f1_score': 0.81265205}
confusion matrix:
       0     1
0  42068   237
1    302  1169
---- Validation: 
scalar performance:
{'acc': 0.98515326, 'precision': 0.9064375, 'recall': 0.8580537, 'specificity': 0.8580537, 'f1': 0.88058937, 'auroc': 0.98020065, 'binary_precision': 0.822695, 'binary_recall': 0.7216174, 'binary_specificity': 0.99449, 'binary_f1_score': 0.7688483}
confusion matrix:
       0    1
0  18049  100
1    179  464
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.8145914, 'recall': 0.5524726, 'specificity': 0.5524726, 'f1': 0.5822971, 'auroc': 0.9356885, 'binary_precision': 0.6666667, 'binary_recall': 0.107279696, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.18481848}
confusion matrix:
      0   1
0  5983  14
1   233  28
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863193.png
early stop counter: 2
val acc:0.9851532578468323, best validation acc: 0.9852064847946167, corresponding to test acc:                         0.9619686603546143 / 0.9779482483863831
after epoch: 18,now: 2024-05-26 17:56:20.744211,epoch time: 0:17:38.586408,used: 5:19:45.025540,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_36_35_seed_0_20863193
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9888295, 'precision': 0.91172, 'recall': 0.9173944, 'specificity': 0.9173944, 'f1': 0.9145362, 'auroc': 0.9942299, 'binary_precision': 0.8289738, 'binary_recall': 0.8408163, 'binary_specificity': 0.9939725, 'binary_f1_score': 0.8348531}
confusion matrix:
       0     1
0  42051   255
1    234  1236
---- Validation: 
scalar performance:
{'acc': 0.98696256, 'precision': 0.9020531, 'recall': 0.90024346, 'specificity': 0.90024346, 'f1': 0.9011461, 'auroc': 0.98286474, 'binary_precision': 0.8109375, 'binary_recall': 0.80715394, 'binary_specificity': 0.993333, 'binary_f1_score': 0.8090413}
confusion matrix:
       0    1
0  18028  121
1    124  519
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.8138341, 'recall': 0.5337324, 'specificity': 0.5337324, 'f1': 0.5521958, 'auroc': 0.9303229, 'binary_precision': 0.6666667, 'binary_recall': 0.06896552, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.125}
confusion matrix:
      0   1
0  5988   9
1   243  18
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863193.png
better model found
persisted
after epoch: 19,now: 2024-05-26 18:14:00.471214,epoch time: 0:17:39.727003,used: 5:37:24.752543,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_36_35_seed_0_20863193
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9896062, 'precision': 0.920663, 'recall': 0.91872776, 'specificity': 0.91872776, 'f1': 0.919693, 'auroc': 0.9953836, 'binary_precision': 0.84678525, 'binary_recall': 0.8427502, 'binary_specificity': 0.9947054, 'binary_f1_score': 0.8447629}
confusion matrix:
       0     1
0  42083   224
1    231  1238
---- Validation: 
scalar performance:
{'acc': 0.98770756, 'precision': 0.9141767, 'recall': 0.89612883, 'specificity': 0.89612883, 'f1': 0.9049351, 'auroc': 0.97935545, 'binary_precision': 0.8355049, 'binary_recall': 0.7978227, 'binary_specificity': 0.99443495, 'binary_f1_score': 0.81622916}
confusion matrix:
       0    1
0  18048  101
1    130  513
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589326, 'precision': 0.77185595, 'recall': 0.5259862, 'specificity': 0.5259862, 'f1': 0.53861666, 'auroc': 0.91173446, 'binary_precision': 0.5833333, 'binary_recall': 0.053639848, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.09824561}
confusion matrix:
      0   1
0  5987  10
1   247  14
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863193.png
better model found
persisted
after epoch: 20,now: 2024-05-26 18:31:58.617571,epoch time: 0:17:58.146357,used: 5:55:22.898900,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_36_35_seed_0_20863193
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.98940057, 'precision': 0.92064226, 'recall': 0.91511923, 'specificity': 0.91511923, 'f1': 0.917861, 'auroc': 0.99421966, 'binary_precision': 0.8470021, 'binary_recall': 0.83548605, 'binary_specificity': 0.9947524, 'binary_f1_score': 0.8412046}
confusion matrix:
       0     1
0  42083   222
1    242  1229
---- Validation: 
scalar performance:
{'acc': 0.985845, 'precision': 0.89598703, 'recall': 0.8876641, 'specificity': 0.8876641, 'f1': 0.8917776, 'auroc': 0.98050153, 'binary_precision': 0.799682, 'binary_recall': 0.7822706, 'binary_specificity': 0.9930575, 'binary_f1_score': 0.7908805}
confusion matrix:
       0    1
0  18023  126
1    140  503
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96196866, 'precision': 0.8868393, 'recall': 0.5568876, 'specificity': 0.5568876, 'f1': 0.5909314, 'auroc': 0.9517224, 'binary_precision': 0.8108108, 'binary_recall': 0.11494253, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.20134228}
confusion matrix:
      0   1
0  5990   7
1   231  30
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863193.png
early stop counter: 1
val acc:0.9858450293540955, best validation acc: 0.9877075552940369, corresponding to test acc:                         0.9589325785636902 / 0.9779482483863831
after epoch: 21,now: 2024-05-26 18:49:39.314689,epoch time: 0:17:40.697118,used: 6:13:03.596018,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_36_35_seed_0_20863193
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.98928636, 'precision': 0.90755427, 'recall': 0.93343294, 'specificity': 0.93343294, 'f1': 0.92006177, 'auroc': 0.99554914, 'binary_precision': 0.8195153, 'binary_recall': 0.8735554, 'binary_specificity': 0.9933105, 'binary_f1_score': 0.84567297}
confusion matrix:
       0     1
0  42022   283
1    186  1285
---- Validation: 
scalar performance:
{'acc': 0.9860579, 'precision': 0.8879373, 'recall': 0.9065256, 'specificity': 0.9065256, 'f1': 0.8969947, 'auroc': 0.9823048, 'binary_precision': 0.7822222, 'binary_recall': 0.82115084, 'binary_specificity': 0.9919004, 'binary_f1_score': 0.8012139}
confusion matrix:
       0    1
0  18002  147
1    115  528
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.7834997, 'recall': 0.5428107, 'specificity': 0.5428107, 'f1': 0.5665687, 'auroc': 0.92413914, 'binary_precision': 0.6052632, 'binary_recall': 0.08812261, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.15384616}
confusion matrix:
      0   1
0  5982  15
1   238  23
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863193.png
early stop counter: 2
val acc:0.9860578775405884, best validation acc: 0.9877075552940369, corresponding to test acc:                         0.9589325785636902 / 0.9779482483863831
after epoch: 22,now: 2024-05-26 19:07:26.971082,epoch time: 0:17:47.656393,used: 6:30:51.252411,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_36_35_seed_0_20863193
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.98901224, 'precision': 0.8977603, 'recall': 0.94579244, 'specificity': 0.94579244, 'f1': 0.92028964, 'auroc': 0.9961537, 'binary_precision': 0.7990344, 'binary_recall': 0.8994565, 'binary_specificity': 0.99212843, 'binary_f1_score': 0.8462768}
confusion matrix:
       0     1
0  41971   333
1    148  1324
---- Validation: 
scalar performance:
{'acc': 0.9849404, 'precision': 0.8708861, 'recall': 0.917948, 'specificity': 0.917948, 'f1': 0.89288324, 'auroc': 0.98271537, 'binary_precision': 0.74725276, 'binary_recall': 0.8460342, 'binary_specificity': 0.9898617, 'binary_f1_score': 0.79358137}
confusion matrix:
       0    1
0  17965  184
1     99  544
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606903, 'precision': 0.79764724, 'recall': 0.5672146, 'specificity': 0.5672146, 'f1': 0.6031239, 'auroc': 0.9316973, 'binary_precision': 0.6315789, 'binary_recall': 0.13793103, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.22641508}
confusion matrix:
      0   1
0  5976  21
1   225  36
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863193.png
early stop counter: 3
val acc:0.9849404096603394, best validation acc: 0.9877075552940369, corresponding to test acc:                         0.9589325785636902 / 0.9779482483863831
after epoch: 23,now: 2024-05-26 19:25:06.958949,epoch time: 0:17:39.987867,used: 6:48:31.240278,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_36_35_seed_0_20863193
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9894463, 'precision': 0.9067664, 'recall': 0.9381485, 'specificity': 0.9381485, 'f1': 0.92182505, 'auroc': 0.99566567, 'binary_precision': 0.8176101, 'binary_recall': 0.8831522, 'binary_specificity': 0.99314487, 'binary_f1_score': 0.84911823}
confusion matrix:
       0     1
0  42014   290
1    172  1300
---- Validation: 
scalar performance:
{'acc': 0.9868561, 'precision': 0.8943137, 'recall': 0.9114392, 'specificity': 0.9114392, 'f1': 0.9026785, 'auroc': 0.9829658, 'binary_precision': 0.79464287, 'binary_recall': 0.8304821, 'binary_specificity': 0.9923963, 'binary_f1_score': 0.8121673}
confusion matrix:
       0    1
0  18011  138
1    109  534
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.7729066, 'recall': 0.5519723, 'specificity': 0.5519723, 'f1': 0.580252, 'auroc': 0.9347205, 'binary_precision': 0.5833333, 'binary_recall': 0.107279696, 'binary_specificity': 0.996665, 'binary_f1_score': 0.18122977}
confusion matrix:
      0   1
0  5977  20
1   233  28
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863193.png
early stop counter: 4
val acc:0.9868561029434204, best validation acc: 0.9877075552940369, corresponding to test acc:                         0.9589325785636902 / 0.9779482483863831
after epoch: 24,now: 2024-05-26 19:42:44.075556,epoch time: 0:17:37.116607,used: 7:06:08.356885,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_36_35_seed_0_20863193
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9866822, 'precision': 0.8723941, 'recall': 0.95016044, 'specificity': 0.95016044, 'f1': 0.9072614, 'auroc': 0.9961448, 'binary_precision': 0.74790853, 'binary_recall': 0.91100544, 'binary_specificity': 0.98931545, 'binary_f1_score': 0.8214395}
confusion matrix:
       0     1
0  41852   452
1    131  1341
---- Validation: 
scalar performance:
{'acc': 0.98259896, 'precision': 0.8461691, 'recall': 0.9279866, 'specificity': 0.9279866, 'f1': 0.8823271, 'auroc': 0.98330045, 'binary_precision': 0.6970075, 'binary_recall': 0.86936235, 'binary_specificity': 0.98661083, 'binary_f1_score': 0.7737025}
confusion matrix:
       0    1
0  17906  243
1     84  559
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.79390097, 'recall': 0.5559705, 'specificity': 0.5559705, 'f1': 0.58688825, 'auroc': 0.9027793, 'binary_precision': 0.625, 'binary_recall': 0.11494253, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.19417475}
confusion matrix:
      0   1
0  5979  18
1   231  30
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863193.png
early stop counter: 5
val acc:0.9825989603996277, best validation acc: 0.9877075552940369, corresponding to test acc:                         0.9589325785636902 / 0.9779482483863831
after epoch: 25,now: 2024-05-26 20:00:27.266289,epoch time: 0:17:43.190733,used: 7:23:51.547618,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_36_35_seed_0_20863193
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9906798, 'precision': 0.9240947, 'recall': 0.934111, 'specificity': 0.934111, 'f1': 0.9290396, 'auroc': 0.9971195, 'binary_precision': 0.85258967, 'binary_recall': 0.8734694, 'binary_specificity': 0.9947525, 'binary_f1_score': 0.86290324}
confusion matrix:
       0     1
0  42084   222
1    186  1284
---- Validation: 
scalar performance:
{'acc': 0.9878672, 'precision': 0.9077393, 'recall': 0.90896237, 'specificity': 0.90896237, 'f1': 0.9083499, 'auroc': 0.98373526, 'binary_precision': 0.8217054, 'binary_recall': 0.82426125, 'binary_specificity': 0.99366355, 'binary_f1_score': 0.82298136}
confusion matrix:
       0    1
0  18034  115
1    113  530
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96356666, 'precision': 0.872489, 'recall': 0.58703876, 'specificity': 0.58703876, 'f1': 0.63440263, 'auroc': 0.91283506, 'binary_precision': 0.779661, 'binary_recall': 0.17624521, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.2875}
confusion matrix:
      0   1
0  5984  13
1   215  46
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863193.png
better model found
persisted
after epoch: 26,now: 2024-05-26 20:18:09.353351,epoch time: 0:17:42.087062,used: 7:41:33.634680,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_36_35_seed_0_20863193
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99122804, 'precision': 0.9280396, 'recall': 0.9387027, 'specificity': 0.9387027, 'f1': 0.9333002, 'auroc': 0.99692076, 'binary_precision': 0.8601723, 'binary_recall': 0.88239294, 'binary_specificity': 0.9950124, 'binary_f1_score': 0.87114096}
confusion matrix:
       0     1
0  42094   211
1    173  1298
---- Validation: 
scalar performance:
{'acc': 0.98664325, 'precision': 0.9087775, 'recall': 0.8835769, 'specificity': 0.8835769, 'f1': 0.89574313, 'auroc': 0.98551005, 'binary_precision': 0.8255814, 'binary_recall': 0.7729393, 'binary_specificity': 0.99421453, 'binary_f1_score': 0.7983935}
confusion matrix:
       0    1
0  18044  105
1    146  497
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.8108779, 'recall': 0.55430496, 'specificity': 0.55430496, 'f1': 0.58496815, 'auroc': 0.8808224, 'binary_precision': 0.65909094, 'binary_recall': 0.11111111, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.19016396}
confusion matrix:
      0   1
0  5982  15
1   232  29
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863193.png
early stop counter: 1
val acc:0.9866432547569275, best validation acc: 0.9878671765327454, corresponding to test acc:                         0.9635666608810425 / 0.9779482483863831
after epoch: 27,now: 2024-05-26 20:35:43.755868,epoch time: 0:17:34.402517,used: 7:59:08.037197,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_36_35_seed_0_20863193
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99111384, 'precision': 0.92353916, 'recall': 0.94323677, 'specificity': 0.94323677, 'f1': 0.9331457, 'auroc': 0.9974005, 'binary_precision': 0.8508431, 'binary_recall': 0.89191025, 'binary_specificity': 0.9945633, 'binary_f1_score': 0.8708928}
confusion matrix:
       0     1
0  42075   230
1    159  1312
---- Validation: 
scalar performance:
{'acc': 0.9879204, 'precision': 0.91691685, 'recall': 0.89623904, 'specificity': 0.89623904, 'f1': 0.90629333, 'auroc': 0.9820348, 'binary_precision': 0.8409836, 'binary_recall': 0.7978227, 'binary_specificity': 0.9946554, 'binary_f1_score': 0.8188348}
confusion matrix:
       0    1
0  18052   97
1    130  513
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9651646, 'precision': 0.8808496, 'recall': 0.6098605, 'specificity': 0.6098605, 'f1': 0.66470504, 'auroc': 0.92593694, 'binary_precision': 0.79452056, 'binary_recall': 0.22222222, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.34730536}
confusion matrix:
      0   1
0  5982  15
1   203  58
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863193.png
better model found
persisted
after epoch: 28,now: 2024-05-26 20:53:17.948109,epoch time: 0:17:34.192241,used: 8:16:42.229438,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_36_35_seed_0_20863193
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9911824, 'precision': 0.9232895, 'recall': 0.9449127, 'specificity': 0.9449127, 'f1': 0.9338095, 'auroc': 0.9972594, 'binary_precision': 0.8502259, 'binary_recall': 0.8953093, 'binary_specificity': 0.994516, 'binary_f1_score': 0.8721854}
confusion matrix:
       0     1
0  42073   232
1    154  1317
---- Validation: 
scalar performance:
{'acc': 0.98706895, 'precision': 0.8962739, 'recall': 0.91229945, 'specificity': 0.91229945, 'f1': 0.904114, 'auroc': 0.9821585, 'binary_precision': 0.79850745, 'binary_recall': 0.8320373, 'binary_specificity': 0.9925616, 'binary_f1_score': 0.81492764}
confusion matrix:
       0    1
0  18014  135
1    108  535
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9600511, 'precision': 0.80944884, 'recall': 0.5430608, 'specificity': 0.5430608, 'f1': 0.5674736, 'auroc': 0.88766223, 'binary_precision': 0.6571429, 'binary_recall': 0.08812261, 'binary_specificity': 0.997999, 'binary_f1_score': 0.1554054}
confusion matrix:
      0   1
0  5985  12
1   238  23
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863193.png
early stop counter: 1
val acc:0.9870689511299133, best validation acc: 0.9879204034805298, corresponding to test acc:                         0.9651646018028259 / 0.9779482483863831
after epoch: 29,now: 2024-05-26 21:10:52.791358,epoch time: 0:17:34.843249,used: 8:34:17.072687,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_36_35_seed_0_20863193
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9920276, 'precision': 0.9361049, 'recall': 0.9421069, 'specificity': 0.9421069, 'f1': 0.93908376, 'auroc': 0.9978633, 'binary_precision': 0.87608844, 'binary_recall': 0.88858694, 'binary_specificity': 0.99562687, 'binary_f1_score': 0.88229346}
confusion matrix:
       0     1
0  42119   185
1    164  1308
---- Validation: 
scalar performance:
{'acc': 0.9876543, 'precision': 0.90996855, 'recall': 0.9013517, 'specificity': 0.9013517, 'f1': 0.9056105, 'auroc': 0.9816557, 'binary_precision': 0.8267091, 'binary_recall': 0.8087092, 'binary_specificity': 0.9939942, 'binary_f1_score': 0.8176101}
confusion matrix:
       0    1
0  18040  109
1    123  520
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9638862, 'precision': 0.8861729, 'recall': 0.58720547, 'specificity': 0.58720547, 'f1': 0.6353903, 'auroc': 0.9400225, 'binary_precision': 0.80701756, 'binary_recall': 0.17624521, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.2893082}
confusion matrix:
      0   1
0  5986  11
1   215  46
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863193.png
early stop counter: 2
val acc:0.9876543283462524, best validation acc: 0.9879204034805298, corresponding to test acc:                         0.9651646018028259 / 0.9779482483863831
after epoch: 30,now: 2024-05-26 21:28:27.896675,epoch time: 0:17:35.105317,used: 8:51:52.178004,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_36_35_seed_0_20863193
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 8:51:52.178004 at 2024-05-26 21:28:27.896675
persisted model performance metric: 

scalar performance:
{'acc': 0.9643656, 'precision': 0.8729046, 'recall': 0.60028195, 'specificity': 0.60028195, 'f1': 0.6519451, 'auroc': 0.91405714, 'binary_precision': 0.7794118, 'binary_recall': 0.20306513, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.32218844}
confusion matrix:
      0   1
0  5982  15
1   208  53
oracle model performance metric: 

scalar performance:
{'acc': 0.97682965, 'precision': 0.93285525, 'recall': 0.7533719, 'specificity': 0.7533719, 'f1': 0.8176117, 'auroc': 0.9350346, 'binary_precision': 0.88666666, 'binary_recall': 0.5095785, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.6472019}
confusion matrix:
      0    1
0  5980   17
1   128  133
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs32/rule_results/8.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs32/rule_results/8.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs32/confusion_matrix/8.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 485775 KiB |   3086 MiB |   1004 TiB |   1004 TiB |
|       from large pool | 396544 KiB |   3015 MiB |   1002 TiB |   1002 TiB |
|       from small pool |  89231 KiB |    123 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 485775 KiB |   3086 MiB |   1004 TiB |   1004 TiB |
|       from large pool | 396544 KiB |   3015 MiB |   1002 TiB |   1002 TiB |
|       from small pool |  89231 KiB |    123 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476573 KiB |   3080 MiB |   1002 TiB |   1002 TiB |
|       from large pool | 387840 KiB |   3010 MiB |   1000 TiB |   1000 TiB |
|       from small pool |  88733 KiB |    122 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3386 MiB |   3386 MiB |   3386 MiB |      0 B   |
|       from large pool |   3262 MiB |   3262 MiB |   3262 MiB |      0 B   |
|       from small pool |    124 MiB |    124 MiB |    124 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1133 MiB |   1186 MiB | 578331 GiB | 578330 GiB |
|       from large pool |   1122 MiB |   1175 MiB | 576604 GiB | 576602 GiB |
|       from small pool |     10 MiB |     14 MiB |   1727 GiB |   1727 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2553    |    3962    |   65280 K  |   65278 K  |
|       from large pool |      87    |     178    |   28574 K  |   28574 K  |
|       from small pool |    2466    |    3874    |   36706 K  |   36703 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2553    |    3962    |   65280 K  |   65278 K  |
|       from large pool |      87    |     178    |   28574 K  |   28574 K  |
|       from small pool |    2466    |    3874    |   36706 K  |   36703 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     100    |     100    |     100    |       0    |
|       from large pool |      38    |      38    |      38    |       0    |
|       from small pool |      62    |      62    |      62    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      58    |    1399    |   28223 K  |   28223 K  |
|       from large pool |      21    |      25    |   11446 K  |   11446 K  |
|       from small pool |      37    |    1378    |   16776 K  |   16776 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3086 MiB |   1004 TiB |   1004 TiB |
|       from large pool |  16640 KiB |   3015 MiB |   1002 TiB |   1002 TiB |
|       from small pool |      0 KiB |    123 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3086 MiB |   1004 TiB |   1004 TiB |
|       from large pool |  16640 KiB |   3015 MiB |   1002 TiB |   1002 TiB |
|       from small pool |      0 KiB |    123 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3080 MiB |   1002 TiB |   1002 TiB |
|       from large pool |  16640 KiB |   3010 MiB |   1000 TiB |   1000 TiB |
|       from small pool |      0 KiB |    122 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1608 MiB |   3386 MiB |   3386 MiB |   1778 MiB |
|       from large pool |   1510 MiB |   3262 MiB |   3262 MiB |   1752 MiB |
|       from small pool |     98 MiB |    124 MiB |    124 MiB |     26 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 214784 KiB |   1309 MiB | 578332 GiB | 578332 GiB |
|       from large pool | 214784 KiB |   1287 MiB | 576604 GiB | 576604 GiB |
|       from small pool |      0 KiB |     33 MiB |   1727 GiB |   1727 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3962    |   65280 K  |   65280 K  |
|       from large pool |       2    |     178    |   28574 K  |   28574 K  |
|       from small pool |       0    |    3874    |   36706 K  |   36706 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3962    |   65280 K  |   65280 K  |
|       from large pool |       2    |     178    |   28574 K  |   28574 K  |
|       from small pool |       0    |    3874    |   36706 K  |   36706 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      70    |     100    |     100    |      30    |
|       from large pool |      21    |      38    |      38    |      17    |
|       from small pool |      49    |      62    |      62    |      13    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1399    |   28223 K  |   28223 K  |
|       from large pool |       3    |      30    |   11446 K  |   11446 K  |
|       from small pool |       0    |    1378    |   16777 K  |   16777 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3086 MiB |   1004 TiB |   1004 TiB |
|       from large pool |  16640 KiB |   3015 MiB |   1002 TiB |   1002 TiB |
|       from small pool |      0 KiB |    123 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3086 MiB |   1004 TiB |   1004 TiB |
|       from large pool |  16640 KiB |   3015 MiB |   1002 TiB |   1002 TiB |
|       from small pool |      0 KiB |    123 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3080 MiB |   1002 TiB |   1002 TiB |
|       from large pool |  16640 KiB |   3010 MiB |   1000 TiB |   1000 TiB |
|       from small pool |      0 KiB |    122 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1608 MiB |   3386 MiB |   3386 MiB |   1778 MiB |
|       from large pool |   1510 MiB |   3262 MiB |   3262 MiB |   1752 MiB |
|       from small pool |     98 MiB |    124 MiB |    124 MiB |     26 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 214784 KiB |   1309 MiB | 578332 GiB | 578332 GiB |
|       from large pool | 214784 KiB |   1287 MiB | 576604 GiB | 576604 GiB |
|       from small pool |      0 KiB |     33 MiB |   1727 GiB |   1727 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3962    |   65280 K  |   65280 K  |
|       from large pool |       2    |     178    |   28574 K  |   28574 K  |
|       from small pool |       0    |    3874    |   36706 K  |   36706 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3962    |   65280 K  |   65280 K  |
|       from large pool |       2    |     178    |   28574 K  |   28574 K  |
|       from small pool |       0    |    3874    |   36706 K  |   36706 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      70    |     100    |     100    |      30    |
|       from large pool |      21    |      38    |      38    |      17    |
|       from small pool |      49    |      62    |      62    |      13    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1399    |   28223 K  |   28223 K  |
|       from large pool |       3    |      30    |   11446 K  |   11446 K  |
|       from small pool |       0    |    1378    |   16777 K  |   16777 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_21_37_10_seed_1_20863193

 Experiment start at: 2024-05-26 21:37:10.841700
before training, model accuracy: 0.09458588808774948
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96756387, 'precision': 0.7442752, 'recall': 0.63655955, 'specificity': 0.63655955, 'f1': 0.6737002, 'auroc': 0.93954927, 'binary_precision': 0.51259446, 'binary_recall': 0.2822469, 'binary_specificity': 0.9908722, 'binary_f1_score': 0.36404294}
confusion matrix:
       0    1
0  42011  387
1   1035  407
---- Validation: 
scalar performance:
{'acc': 0.9665422, 'precision': 0.76171523, 'recall': 0.70011735, 'specificity': 0.70011735, 'f1': 0.72635865, 'auroc': 0.9356551, 'binary_precision': 0.54509807, 'binary_recall': 0.41307577, 'binary_specificity': 0.9871589, 'binary_f1_score': 0.46999156}
confusion matrix:
       0    1
0  17835  232
1    395  278
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96745086, 'precision': 0.9535732, 'recall': 0.6188944, 'specificity': 0.6188944, 'f1': 0.68182725, 'auroc': 0.90903175, 'binary_precision': 0.93939394, 'binary_recall': 0.23846154, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.38036808}
confusion matrix:
      0   1
0  5942   4
1   198  62
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863193.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-26 21:55:37.215553,epoch time: 0:18:26.373853,used: 0:18:26.373853,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_21_37_10_seed_1_20863193
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97109944, 'precision': 0.7775072, 'recall': 0.7316561, 'specificity': 0.7316561, 'f1': 0.75231576, 'auroc': 0.9552938, 'binary_precision': 0.57274246, 'binary_recall': 0.47536433, 'binary_specificity': 0.9879478, 'binary_f1_score': 0.51952976}
confusion matrix:
       0    1
0  41888  511
1    756  685
---- Validation: 
scalar performance:
{'acc': 0.9708645, 'precision': 0.80095106, 'recall': 0.73669183, 'specificity': 0.73669183, 'f1': 0.7645958, 'auroc': 0.9519894, 'binary_precision': 0.62095237, 'binary_recall': 0.48439822, 'binary_specificity': 0.9889854, 'binary_f1_score': 0.5442404}
confusion matrix:
       0    1
0  17868  199
1    347  326
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9693845, 'precision': 0.9650103, 'recall': 0.6401323, 'specificity': 0.6401323, 'f1': 0.70939505, 'auroc': 0.92034626, 'binary_precision': 0.9605263, 'binary_recall': 0.28076923, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.4345238}
confusion matrix:
      0   1
0  5943   3
1   187  73
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863193.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-05-26 22:13:13.168205,epoch time: 0:17:35.952652,used: 0:36:02.326505,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_21_37_10_seed_1_20863193
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9744754, 'precision': 0.8031181, 'recall': 0.7821506, 'specificity': 0.7821506, 'f1': 0.7922232, 'auroc': 0.9640231, 'binary_precision': 0.6206124, 'binary_recall': 0.5762829, 'binary_specificity': 0.9880183, 'binary_f1_score': 0.5976267}
confusion matrix:
       0    1
0  41890  508
1    611  831
---- Validation: 
scalar performance:
{'acc': 0.9740662, 'precision': 0.8222579, 'recall': 0.7805531, 'specificity': 0.7805531, 'f1': 0.7998204, 'auroc': 0.96222246, 'binary_precision': 0.6603774, 'binary_recall': 0.57206535, 'binary_specificity': 0.9890408, 'binary_f1_score': 0.6130573}
confusion matrix:
       0    1
0  17869  198
1    288  385
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9730905, 'precision': 0.97142124, 'recall': 0.6843631, 'specificity': 0.6843631, 'f1': 0.7604817, 'auroc': 0.9369259, 'binary_precision': 0.969697, 'binary_recall': 0.36923078, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.53481895}
confusion matrix:
      0   1
0  5943   3
1   164  96
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863193.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-05-26 22:30:47.654113,epoch time: 0:17:34.485908,used: 0:53:36.812413,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_21_37_10_seed_1_20863193
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9763686, 'precision': 0.8207222, 'recall': 0.79183805, 'specificity': 0.79183805, 'f1': 0.8055372, 'auroc': 0.97157025, 'binary_precision': 0.65519875, 'binary_recall': 0.59431344, 'binary_specificity': 0.9893627, 'binary_f1_score': 0.6232727}
confusion matrix:
       0    1
0  41947  451
1    585  857
---- Validation: 
scalar performance:
{'acc': 0.97774816, 'precision': 0.8755132, 'recall': 0.7695878, 'specificity': 0.7695878, 'f1': 0.8131139, 'auroc': 0.96507967, 'binary_precision': 0.76778245, 'binary_recall': 0.54531944, 'binary_specificity': 0.9938562, 'binary_f1_score': 0.63770634}
confusion matrix:
       0    1
0  17956  111
1    306  367
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9747019, 'precision': 0.9577682, 'recall': 0.71094984, 'specificity': 0.71094984, 'f1': 0.7852546, 'auroc': 0.94066, 'binary_precision': 0.94017094, 'binary_recall': 0.42307693, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.5835544}
confusion matrix:
      0    1
0  5939    7
1   150  110
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863193.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-05-26 22:48:18.070398,epoch time: 0:17:30.416285,used: 1:11:07.228698,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_21_37_10_seed_1_20863193
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97760034, 'precision': 0.8385089, 'recall': 0.78376627, 'specificity': 0.78376627, 'f1': 0.80852246, 'auroc': 0.974959, 'binary_precision': 0.6913478, 'binary_recall': 0.5762829, 'binary_specificity': 0.99124956, 'binary_f1_score': 0.6285931}
confusion matrix:
       0    1
0  42027  371
1    611  831
---- Validation: 
scalar performance:
{'acc': 0.9752935, 'precision': 0.86755157, 'recall': 0.7282598, 'specificity': 0.7282598, 'f1': 0.78027517, 'auroc': 0.96261156, 'binary_precision': 0.7548544, 'binary_recall': 0.46210995, 'binary_specificity': 0.9944097, 'binary_f1_score': 0.5732719}
confusion matrix:
       0    1
0  17966  101
1    362  311
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650338, 'precision': 0.97135925, 'recall': 0.5845313, 'specificity': 0.5845313, 'f1': 0.6353005, 'auroc': 0.93631315, 'binary_precision': 0.9777778, 'binary_recall': 0.16923077, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.2885246}
confusion matrix:
      0   1
0  5945   1
1   216  44
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863193.png
early stop counter: 1
val acc:0.9752935171127319, best validation acc: 0.9777481555938721, corresponding to test acc:                         0.9747018814086914 / 0.9747018814086914
after epoch: 5,now: 2024-05-26 23:05:50.632219,epoch time: 0:17:32.561821,used: 1:28:39.790519,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_21_37_10_seed_1_20863193
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9788777, 'precision': 0.85241497, 'recall': 0.78964275, 'specificity': 0.78964275, 'f1': 0.8177043, 'auroc': 0.9783119, 'binary_precision': 0.7187765, 'binary_recall': 0.5870923, 'binary_specificity': 0.9921932, 'binary_f1_score': 0.64629483}
confusion matrix:
       0    1
0  42068  331
1    595  846
---- Validation: 
scalar performance:
{'acc': 0.9769477, 'precision': 0.88248265, 'recall': 0.7448536, 'specificity': 0.7448536, 'f1': 0.7973417, 'auroc': 0.9684006, 'binary_precision': 0.7835294, 'binary_recall': 0.4947994, 'binary_specificity': 0.99490786, 'binary_f1_score': 0.60655737}
confusion matrix:
       0    1
0  17975   92
1    340  333
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621334, 'precision': 0.9328275, 'recall': 0.5535939, 'specificity': 0.5535939, 'f1': 0.58652604, 'auroc': 0.93831635, 'binary_precision': 0.9032258, 'binary_recall': 0.10769231, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.19243985}
confusion matrix:
      0   1
0  5943   3
1   232  28
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863193.png
early stop counter: 2
val acc:0.9769477248191833, best validation acc: 0.9777481555938721, corresponding to test acc:                         0.9747018814086914 / 0.9747018814086914
after epoch: 6,now: 2024-05-26 23:23:25.050302,epoch time: 0:17:34.418083,used: 1:46:14.208602,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_21_37_10_seed_1_20863193
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9807026, 'precision': 0.86877394, 'recall': 0.80613685, 'specificity': 0.80613685, 'f1': 0.834312, 'auroc': 0.980482, 'binary_precision': 0.75042015, 'binary_recall': 0.6192788, 'binary_specificity': 0.99299496, 'binary_f1_score': 0.6785714}
confusion matrix:
       0    1
0  42101  297
1    549  893
---- Validation: 
scalar performance:
{'acc': 0.98025614, 'precision': 0.89611566, 'recall': 0.79306185, 'specificity': 0.79306185, 'f1': 0.8362435, 'auroc': 0.9696403, 'binary_precision': 0.80730224, 'binary_recall': 0.59138185, 'binary_specificity': 0.9947418, 'binary_f1_score': 0.68267584}
confusion matrix:
       0    1
0  17972   95
1    275  398
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9618111, 'precision': 0.94394696, 'recall': 0.5479087, 'specificity': 0.5479087, 'f1': 0.5773349, 'auroc': 0.9410206, 'binary_precision': 0.9259259, 'binary_recall': 0.09615385, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.17421603}
confusion matrix:
      0   1
0  5944   2
1   235  25
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863193.png
better model found
persisted
after epoch: 7,now: 2024-05-26 23:41:00.152544,epoch time: 0:17:35.102242,used: 2:03:49.310844,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_21_37_10_seed_1_20863193
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9817518, 'precision': 0.8592828, 'recall': 0.85012186, 'specificity': 0.85012186, 'f1': 0.85463804, 'auroc': 0.98214, 'binary_precision': 0.72843903, 'binary_recall': 0.7092297, 'binary_specificity': 0.99101394, 'binary_f1_score': 0.718706}
confusion matrix:
       0     1
0  42018   381
1    419  1022
---- Validation: 
scalar performance:
{'acc': 0.98025614, 'precision': 0.88930225, 'recall': 0.80164504, 'specificity': 0.80164504, 'f1': 0.83944, 'auroc': 0.97207224, 'binary_precision': 0.79303676, 'binary_recall': 0.60921246, 'binary_specificity': 0.9940776, 'binary_f1_score': 0.6890756}
confusion matrix:
       0    1
0  17960  107
1    263  410
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96052206, 'precision': 0.86954916, 'recall': 0.53988004, 'specificity': 0.53988004, 'f1': 0.5630677, 'auroc': 0.9437272, 'binary_precision': 0.7777778, 'binary_recall': 0.08076923, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.14634147}
confusion matrix:
      0   1
0  5940   6
1   239  21
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863193.png
early stop counter: 1
val acc:0.9802561402320862, best validation acc: 0.9802561402320862, corresponding to test acc:                         0.9618111252784729 / 0.9747018814086914
after epoch: 8,now: 2024-05-26 23:58:34.219156,epoch time: 0:17:34.066612,used: 2:21:23.377456,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_21_37_10_seed_1_20863193
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9824818, 'precision': 0.8891082, 'recall': 0.8150954, 'specificity': 0.8150954, 'f1': 0.8479078, 'auroc': 0.9841144, 'binary_precision': 0.7905173, 'binary_recall': 0.6359223, 'binary_specificity': 0.9942686, 'binary_f1_score': 0.7048425}
confusion matrix:
       0    1
0  42155  243
1    525  917
---- Validation: 
scalar performance:
{'acc': 0.98041624, 'precision': 0.9179913, 'recall': 0.77311736, 'specificity': 0.77311736, 'f1': 0.82919174, 'auroc': 0.96734774, 'binary_precision': 0.85253453, 'binary_recall': 0.5497771, 'binary_specificity': 0.99645764, 'binary_f1_score': 0.66847336}
confusion matrix:
       0    1
0  18003   64
1    303  370
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597164, 'precision': 0.8690117, 'recall': 0.5265867, 'specificity': 0.5265867, 'f1': 0.5400581, 'auroc': 0.9497015, 'binary_precision': 0.7777778, 'binary_recall': 0.053846154, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.10071942}
confusion matrix:
      0   1
0  5942   4
1   246  14
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863193.png
better model found
persisted
after epoch: 9,now: 2024-05-27 00:16:14.061274,epoch time: 0:17:39.842118,used: 2:39:03.219574,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_21_37_10_seed_1_20863193
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98339415, 'precision': 0.8876638, 'recall': 0.8364465, 'specificity': 0.8364465, 'f1': 0.86009896, 'auroc': 0.98611075, 'binary_precision': 0.78617364, 'binary_recall': 0.6791667, 'binary_specificity': 0.99372643, 'binary_f1_score': 0.72876304}
confusion matrix:
       0    1
0  42134  266
1    462  978
---- Validation: 
scalar performance:
{'acc': 0.97876203, 'precision': 0.8639194, 'recall': 0.80945337, 'specificity': 0.80945337, 'f1': 0.8342831, 'auroc': 0.97065586, 'binary_precision': 0.741652, 'binary_recall': 0.62704307, 'binary_specificity': 0.9918636, 'binary_f1_score': 0.6795491}
confusion matrix:
       0    1
0  17920  147
1    251  422
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95955527, 'precision': 0.86239815, 'recall': 0.5246636, 'specificity': 0.5246636, 'f1': 0.5365894, 'auroc': 0.93999004, 'binary_precision': 0.7647059, 'binary_recall': 0.05, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.09386282}
confusion matrix:
      0   1
0  5942   4
1   247  13
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863193.png
early stop counter: 1
val acc:0.9787620306015015, best validation acc: 0.9804162383079529, corresponding to test acc:                         0.9597163796424866 / 0.9747018814086914
after epoch: 10,now: 2024-05-27 00:33:46.565970,epoch time: 0:17:32.504696,used: 2:56:35.724270,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_21_37_10_seed_1_20863193
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98396444, 'precision': 0.87128973, 'recall': 0.8790055, 'specificity': 0.8790055, 'f1': 0.87510455, 'auroc': 0.98665786, 'binary_precision': 0.75050986, 'binary_recall': 0.76666665, 'binary_specificity': 0.99134433, 'binary_f1_score': 0.75850224}
confusion matrix:
       0     1
0  42033   367
1    336  1104
---- Validation: 
scalar performance:
{'acc': 0.9813767, 'precision': 0.88635975, 'recall': 0.8279758, 'specificity': 0.8279758, 'f1': 0.8545723, 'auroc': 0.9742726, 'binary_precision': 0.78521127, 'binary_recall': 0.6627043, 'binary_specificity': 0.99324733, 'binary_f1_score': 0.71877515}
confusion matrix:
       0    1
0  17945  122
1    227  446
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96052206, 'precision': 0.90900797, 'recall': 0.5343631, 'specificity': 0.5343631, 'f1': 0.55395883, 'auroc': 0.95011246, 'binary_precision': 0.85714287, 'binary_recall': 0.06923077, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.12811388}
confusion matrix:
      0   1
0  5943   3
1   242  18
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863193.png
better model found
persisted
after epoch: 11,now: 2024-05-27 00:51:22.408590,epoch time: 0:17:35.842620,used: 3:14:11.566890,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_21_37_10_seed_1_20863193
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9834854, 'precision': 0.8725136, 'recall': 0.86552155, 'specificity': 0.86552155, 'f1': 0.86898166, 'auroc': 0.987043, 'binary_precision': 0.7538897, 'binary_recall': 0.739251, 'binary_specificity': 0.9917921, 'binary_f1_score': 0.74649864}
confusion matrix:
       0     1
0  42050   348
1    376  1066
---- Validation: 
scalar performance:
{'acc': 0.98116326, 'precision': 0.87788135, 'recall': 0.83716357, 'specificity': 0.83716357, 'f1': 0.8562585, 'auroc': 0.9724046, 'binary_precision': 0.7675585, 'binary_recall': 0.6820208, 'binary_specificity': 0.9923064, 'binary_f1_score': 0.7222659}
confusion matrix:
       0    1
0  17928  139
1    214  459
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959233, 'precision': 0.82214403, 'recall': 0.5244954, 'specificity': 0.5244954, 'f1': 0.5361689, 'auroc': 0.95171845, 'binary_precision': 0.68421054, 'binary_recall': 0.05, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.09318997}
confusion matrix:
      0   1
0  5940   6
1   247  13
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863193.png
early stop counter: 1
val acc:0.9811632633209229, best validation acc: 0.9813767075538635, corresponding to test acc:                         0.9605220556259155 / 0.9747018814086914
after epoch: 12,now: 2024-05-27 01:08:51.893656,epoch time: 0:17:29.485066,used: 3:31:41.051956,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_21_37_10_seed_1_20863193
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9848312, 'precision': 0.89027023, 'recall': 0.8637806, 'specificity': 0.8637806, 'f1': 0.8765223, 'auroc': 0.98939025, 'binary_precision': 0.7895522, 'binary_recall': 0.73421234, 'binary_specificity': 0.9933489, 'binary_f1_score': 0.7608773}
confusion matrix:
       0     1
0  42117   282
1    383  1058
---- Validation: 
scalar performance:
{'acc': 0.9827641, 'precision': 0.90186614, 'recall': 0.83298695, 'specificity': 0.83298695, 'f1': 0.8639234, 'auroc': 0.9729717, 'binary_precision': 0.8158845, 'binary_recall': 0.6716196, 'binary_specificity': 0.99435437, 'binary_f1_score': 0.7367563}
confusion matrix:
       0    1
0  17965  102
1    221  452
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95939416, 'precision': 0.7862687, 'recall': 0.5411304, 'specificity': 0.5411304, 'f1': 0.56392485, 'auroc': 0.95331156, 'binary_precision': 0.6111111, 'binary_recall': 0.08461539, 'binary_specificity': 0.9976455, 'binary_f1_score': 0.14864865}
confusion matrix:
      0   1
0  5932  14
1   238  22
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863193.png
better model found
persisted
after epoch: 13,now: 2024-05-27 01:26:22.775497,epoch time: 0:17:30.881841,used: 3:49:11.933797,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_21_37_10_seed_1_20863193
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9857208, 'precision': 0.9049134, 'recall': 0.8602183, 'specificity': 0.8602183, 'f1': 0.88115776, 'auroc': 0.9898276, 'binary_precision': 0.8191073, 'binary_recall': 0.7258848, 'binary_specificity': 0.9945518, 'binary_f1_score': 0.7696836}
confusion matrix:
       0     1
0  42168   231
1    395  1046
---- Validation: 
scalar performance:
{'acc': 0.98313767, 'precision': 0.9136316, 'recall': 0.82531273, 'specificity': 0.82531273, 'f1': 0.8637588, 'auroc': 0.97483206, 'binary_precision': 0.84, 'binary_recall': 0.65527487, 'binary_specificity': 0.99535066, 'binary_f1_score': 0.7362271}
confusion matrix:
       0    1
0  17983   84
1    232  441
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96084434, 'precision': 0.8773676, 'recall': 0.5437262, 'specificity': 0.5437262, 'f1': 0.5695625, 'auroc': 0.9565284, 'binary_precision': 0.79310346, 'binary_recall': 0.08846154, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.15916955}
confusion matrix:
      0   1
0  5940   6
1   237  23
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863193.png
better model found
persisted
after epoch: 14,now: 2024-05-27 01:43:55.936676,epoch time: 0:17:33.161179,used: 4:06:45.094976,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_21_37_10_seed_1_20863193
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9869754, 'precision': 0.89995253, 'recall': 0.8937868, 'specificity': 0.8937868, 'f1': 0.8968438, 'auroc': 0.9911977, 'binary_precision': 0.8069063, 'binary_recall': 0.7940361, 'binary_specificity': 0.9935374, 'binary_f1_score': 0.8004195}
confusion matrix:
       0     1
0  42124   274
1    297  1145
---- Validation: 
scalar performance:
{'acc': 0.9832444, 'precision': 0.8959212, 'recall': 0.8504025, 'specificity': 0.8504025, 'f1': 0.871652, 'auroc': 0.9762854, 'binary_precision': 0.80269814, 'binary_recall': 0.7072808, 'binary_specificity': 0.99352413, 'binary_f1_score': 0.7519747}
confusion matrix:
       0    1
0  17950  117
1    197  476
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96132773, 'precision': 0.9231329, 'recall': 0.5439785, 'specificity': 0.5439785, 'f1': 0.5705235, 'auroc': 0.95572865, 'binary_precision': 0.88461536, 'binary_recall': 0.08846154, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.16083917}
confusion matrix:
      0   1
0  5943   3
1   237  23
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863193.png
better model found
persisted
after epoch: 15,now: 2024-05-27 02:01:25.679092,epoch time: 0:17:29.742416,used: 4:24:14.837392,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_21_37_10_seed_1_20863193
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.98551553, 'precision': 0.8751259, 'recall': 0.9084396, 'specificity': 0.9084396, 'f1': 0.8910129, 'auroc': 0.99191004, 'binary_precision': 0.7561905, 'binary_recall': 0.8259362, 'binary_specificity': 0.99094296, 'binary_f1_score': 0.78952605}
confusion matrix:
       0     1
0  42014   384
1    251  1191
---- Validation: 
scalar performance:
{'acc': 0.9822839, 'precision': 0.86902267, 'recall': 0.878515, 'specificity': 0.878515, 'f1': 0.8737028, 'auroc': 0.9776983, 'binary_precision': 0.74674386, 'binary_recall': 0.7667162, 'binary_specificity': 0.9903138, 'binary_f1_score': 0.75659823}
confusion matrix:
       0    1
0  17892  175
1    157  516
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96132773, 'precision': 0.9094714, 'recall': 0.5458175, 'specificity': 0.5458175, 'f1': 0.5734356, 'auroc': 0.94128954, 'binary_precision': 0.85714287, 'binary_recall': 0.092307694, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.16666667}
confusion matrix:
      0   1
0  5942   4
1   236  24
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863193.png
early stop counter: 1
val acc:0.982283890247345, best validation acc: 0.9832444190979004, corresponding to test acc:                         0.9613277316093445 / 0.9747018814086914
after epoch: 16,now: 2024-05-27 02:18:53.912178,epoch time: 0:17:28.233086,used: 4:41:43.070478,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_21_37_10_seed_1_20863193
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9875, 'precision': 0.90814215, 'recall': 0.8917134, 'specificity': 0.8917134, 'f1': 0.89974546, 'auroc': 0.99286664, 'binary_precision': 0.8234443, 'binary_recall': 0.7891817, 'binary_specificity': 0.994245, 'binary_f1_score': 0.80594903}
confusion matrix:
       0     1
0  42154   244
1    304  1138
---- Validation: 
scalar performance:
{'acc': 0.98431164, 'precision': 0.90016437, 'recall': 0.86454606, 'specificity': 0.86454606, 'f1': 0.8814528, 'auroc': 0.97792166, 'binary_precision': 0.8101473, 'binary_recall': 0.7355126, 'binary_specificity': 0.99357945, 'binary_f1_score': 0.771028}
confusion matrix:
       0    1
0  17951  116
1    178  495
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96019983, 'precision': 0.842723, 'recall': 0.5397119, 'specificity': 0.5397119, 'f1': 0.5624771, 'auroc': 0.94169545, 'binary_precision': 0.7241379, 'binary_recall': 0.08076923, 'binary_specificity': 0.99865454, 'binary_f1_score': 0.14532872}
confusion matrix:
      0   1
0  5938   8
1   239  21
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863193.png
better model found
persisted
after epoch: 17,now: 2024-05-27 02:36:22.468843,epoch time: 0:17:28.556665,used: 4:59:11.627143,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_21_37_10_seed_1_20863193
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9884124, 'precision': 0.91555494, 'recall': 0.89881575, 'specificity': 0.89881575, 'f1': 0.9069997, 'auroc': 0.994274, 'binary_precision': 0.8377987, 'binary_recall': 0.8029146, 'binary_specificity': 0.9947169, 'binary_f1_score': 0.81998587}
confusion matrix:
       0     1
0  42175   224
1    284  1157
---- Validation: 
scalar performance:
{'acc': 0.9839381, 'precision': 0.9038764, 'recall': 0.85219276, 'specificity': 0.85219276, 'f1': 0.8761156, 'auroc': 0.9787614, 'binary_precision': 0.8184931, 'binary_recall': 0.7102526, 'binary_specificity': 0.99413294, 'binary_f1_score': 0.76054096}
confusion matrix:
       0    1
0  17961  106
1    195  478
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96036094, 'precision': 0.8763413, 'recall': 0.53611803, 'specificity': 0.53611803, 'f1': 0.5567596, 'auroc': 0.9310522, 'binary_precision': 0.7916667, 'binary_recall': 0.073076926, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.13380282}
confusion matrix:
      0   1
0  5941   5
1   241  19
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863193.png
early stop counter: 1
val acc:0.9839380979537964, best validation acc: 0.9843116402626038, corresponding to test acc:                         0.9601998329162598 / 0.9747018814086914
after epoch: 18,now: 2024-05-27 02:53:55.478497,epoch time: 0:17:33.009654,used: 5:16:44.636797,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_21_37_10_seed_1_20863193
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.98834395, 'precision': 0.908077, 'recall': 0.90889704, 'specificity': 0.90889704, 'f1': 0.9084866, 'auroc': 0.9936216, 'binary_precision': 0.82214534, 'binary_recall': 0.82385576, 'binary_specificity': 0.9939384, 'binary_f1_score': 0.82299966}
confusion matrix:
       0     1
0  42141   257
1    254  1188
---- Validation: 
scalar performance:
{'acc': 0.9839381, 'precision': 0.9049208, 'recall': 0.85076225, 'specificity': 0.85076225, 'f1': 0.87573385, 'auroc': 0.976459, 'binary_precision': 0.8206897, 'binary_recall': 0.7072808, 'binary_specificity': 0.9942436, 'binary_f1_score': 0.7597765}
confusion matrix:
       0    1
0  17963  104
1    197  476
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.7297931, 'recall': 0.5183899, 'specificity': 0.5183899, 'f1': 0.5249988, 'auroc': 0.9358696, 'binary_precision': 0.5, 'binary_recall': 0.03846154, 'binary_specificity': 0.9983182, 'binary_f1_score': 0.07142857}
confusion matrix:
      0   1
0  5936  10
1   250  10
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863193.png
early stop counter: 2
val acc:0.9839380979537964, best validation acc: 0.9843116402626038, corresponding to test acc:                         0.9601998329162598 / 0.9747018814086914
after epoch: 19,now: 2024-05-27 03:11:27.416219,epoch time: 0:17:31.937722,used: 5:34:16.574519,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_21_37_10_seed_1_20863193
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9903969, 'precision': 0.92818785, 'recall': 0.9192827, 'specificity': 0.9192827, 'f1': 0.92368484, 'auroc': 0.9946475, 'binary_precision': 0.86170214, 'binary_recall': 0.84316444, 'binary_specificity': 0.99540085, 'binary_f1_score': 0.8523325}
confusion matrix:
       0     1
0  42204   195
1    226  1215
---- Validation: 
scalar performance:
{'acc': 0.98527217, 'precision': 0.9192007, 'recall': 0.8564609, 'specificity': 0.8564609, 'f1': 0.8850807, 'auroc': 0.97615105, 'binary_precision': 0.84885764, 'binary_recall': 0.717682, 'binary_specificity': 0.9952399, 'binary_f1_score': 0.77777773}
confusion matrix:
       0    1
0  17981   86
1    190  483
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587496, 'precision': 0.7616517, 'recall': 0.53343815, 'specificity': 0.53343815, 'f1': 0.5510828, 'auroc': 0.9112213, 'binary_precision': 0.5625, 'binary_recall': 0.06923077, 'binary_specificity': 0.9976455, 'binary_f1_score': 0.12328768}
confusion matrix:
      0   1
0  5932  14
1   242  18
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863193.png
better model found
persisted
after epoch: 20,now: 2024-05-27 03:29:00.520582,epoch time: 0:17:33.104363,used: 5:51:49.678882,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_21_37_10_seed_1_20863193
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.98996353, 'precision': 0.9439496, 'recall': 0.8919822, 'specificity': 0.8919822, 'f1': 0.9162301, 'auroc': 0.9955095, 'binary_precision': 0.8951104, 'binary_recall': 0.78710127, 'binary_specificity': 0.99686307, 'binary_f1_score': 0.83763844}
confusion matrix:
       0     1
0  42265   133
1    307  1135
---- Validation: 
scalar performance:
{'acc': 0.98441833, 'precision': 0.91899985, 'recall': 0.84171283, 'specificity': 0.84171283, 'f1': 0.8761051, 'auroc': 0.9771019, 'binary_precision': 0.8495413, 'binary_recall': 0.6879643, 'binary_specificity': 0.99546134, 'binary_f1_score': 0.7602627}
confusion matrix:
       0    1
0  17985   82
1    210  463
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590719, 'precision': 0.8236369, 'recall': 0.5207334, 'specificity': 0.5207334, 'f1': 0.5293904, 'auroc': 0.9394346, 'binary_precision': 0.6875, 'binary_recall': 0.042307694, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.07971015}
confusion matrix:
      0   1
0  5941   5
1   249  11
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863193.png
early stop counter: 1
val acc:0.9844183325767517, best validation acc: 0.9852721691131592, corresponding to test acc:                         0.9587495923042297 / 0.9747018814086914
after epoch: 21,now: 2024-05-27 03:46:31.800426,epoch time: 0:17:31.279844,used: 6:09:20.958726,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_21_37_10_seed_1_20863193
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.98907393, 'precision': 0.9080558, 'recall': 0.92362654, 'specificity': 0.92362654, 'f1': 0.9156834, 'auroc': 0.9958042, 'binary_precision': 0.8210948, 'binary_recall': 0.8535739, 'binary_specificity': 0.9936791, 'binary_f1_score': 0.8370193}
confusion matrix:
       0     1
0  42131   268
1    211  1230
---- Validation: 
scalar performance:
{'acc': 0.9840982, 'precision': 0.903395, 'recall': 0.8558521, 'specificity': 0.8558521, 'f1': 0.878006, 'auroc': 0.9750005, 'binary_precision': 0.8172589, 'binary_recall': 0.717682, 'binary_specificity': 0.99402225, 'binary_f1_score': 0.76424044}
confusion matrix:
       0    1
0  17959  108
1    190  483
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.962778, 'precision': 0.8742852, 'recall': 0.57599807, 'specificity': 0.57599807, 'f1': 0.6190727, 'auroc': 0.9401662, 'binary_precision': 0.78431374, 'binary_recall': 0.15384616, 'binary_specificity': 0.99815, 'binary_f1_score': 0.25723475}
confusion matrix:
      0   1
0  5935  11
1   220  40
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863193.png
early stop counter: 2
val acc:0.9840981960296631, best validation acc: 0.9852721691131592, corresponding to test acc:                         0.9587495923042297 / 0.9747018814086914
after epoch: 22,now: 2024-05-27 04:04:02.245651,epoch time: 0:17:30.445225,used: 6:26:51.403951,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_21_37_10_seed_1_20863193
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9897354, 'precision': 0.93589187, 'recall': 0.89722335, 'specificity': 0.89722335, 'f1': 0.91559196, 'auroc': 0.9956391, 'binary_precision': 0.8786259, 'binary_recall': 0.798197, 'binary_specificity': 0.9962498, 'binary_f1_score': 0.8364825}
confusion matrix:
       0     1
0  42239   159
1    291  1151
---- Validation: 
scalar performance:
{'acc': 0.9840982, 'precision': 0.90238255, 'recall': 0.85728264, 'specificity': 0.85728264, 'f1': 0.87837744, 'auroc': 0.97632957, 'binary_precision': 0.81512606, 'binary_recall': 0.7206538, 'binary_specificity': 0.99391156, 'binary_f1_score': 0.76498425}
confusion matrix:
       0    1
0  17957  110
1    188  485
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614889, 'precision': 0.84335494, 'recall': 0.5642914, 'specificity': 0.5642914, 'f1': 0.60087717, 'auroc': 0.9122511, 'binary_precision': 0.7234042, 'binary_recall': 0.13076924, 'binary_specificity': 0.99781364, 'binary_f1_score': 0.22149837}
confusion matrix:
      0   1
0  5933  13
1   226  34
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863193.png
early stop counter: 3
val acc:0.9840981960296631, best validation acc: 0.9852721691131592, corresponding to test acc:                         0.9587495923042297 / 0.9747018814086914
after epoch: 23,now: 2024-05-27 04:21:35.310853,epoch time: 0:17:33.065202,used: 6:44:24.469153,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_21_37_10_seed_1_20863193
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9888914, 'precision': 0.89465845, 'recall': 0.9439426, 'specificity': 0.9439426, 'f1': 0.91772866, 'auroc': 0.9956243, 'binary_precision': 0.79287034, 'binary_recall': 0.8958333, 'binary_specificity': 0.9920519, 'binary_f1_score': 0.84121287}
confusion matrix:
       0     1
0  42063   337
1    150  1290
---- Validation: 
scalar performance:
{'acc': 0.98356456, 'precision': 0.87698317, 'recall': 0.8899082, 'specificity': 0.8899082, 'f1': 0.88332653, 'auroc': 0.97769976, 'binary_precision': 0.76183647, 'binary_recall': 0.78900445, 'binary_specificity': 0.990812, 'binary_f1_score': 0.7751825}
confusion matrix:
       0    1
0  17901  166
1    142  531
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96003866, 'precision': 0.78916776, 'recall': 0.55985665, 'specificity': 0.55985665, 'f1': 0.59231615, 'auroc': 0.93106514, 'binary_precision': 0.61538464, 'binary_recall': 0.12307692, 'binary_specificity': 0.9966364, 'binary_f1_score': 0.2051282}
confusion matrix:
      0   1
0  5926  20
1   228  32
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863193.png
early stop counter: 4
val acc:0.983564555644989, best validation acc: 0.9852721691131592, corresponding to test acc:                         0.9587495923042297 / 0.9747018814086914
after epoch: 24,now: 2024-05-27 04:39:08.066167,epoch time: 0:17:32.755314,used: 7:01:57.224467,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_21_37_10_seed_1_20863193
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99073905, 'precision': 0.9191555, 'recall': 0.9388196, 'specificity': 0.9388196, 'f1': 0.92874396, 'auroc': 0.9970998, 'binary_precision': 0.8422797, 'binary_recall': 0.88325226, 'binary_specificity': 0.9943869, 'binary_f1_score': 0.86227953}
confusion matrix:
       0     1
0  42163   238
1    168  1271
---- Validation: 
scalar performance:
{'acc': 0.98265743, 'precision': 0.8756745, 'recall': 0.87298656, 'specificity': 0.87298656, 'f1': 0.8743253, 'auroc': 0.97706074, 'binary_precision': 0.76047903, 'binary_recall': 0.7548291, 'binary_specificity': 0.99114406, 'binary_f1_score': 0.7576435}
confusion matrix:
       0    1
0  17907  160
1    165  508
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9619723, 'precision': 0.85681224, 'recall': 0.5682217, 'specificity': 0.5682217, 'f1': 0.6071343, 'auroc': 0.9275639, 'binary_precision': 0.75, 'binary_recall': 0.13846155, 'binary_specificity': 0.99798185, 'binary_f1_score': 0.23376626}
confusion matrix:
      0   1
0  5934  12
1   224  36
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863193.png
early stop counter: 5
val acc:0.9826574325561523, best validation acc: 0.9852721691131592, corresponding to test acc:                         0.9587495923042297 / 0.9747018814086914
after epoch: 25,now: 2024-05-27 04:56:43.279829,epoch time: 0:17:35.213662,used: 7:19:32.438129,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_21_37_10_seed_1_20863193
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99174273, 'precision': 0.94959885, 'recall': 0.9169617, 'specificity': 0.9169617, 'f1': 0.9326195, 'auroc': 0.99708134, 'binary_precision': 0.9047262, 'binary_recall': 0.83691883, 'binary_specificity': 0.9970046, 'binary_f1_score': 0.86950254}
confusion matrix:
       0     1
0  42272   127
1    235  1206
---- Validation: 
scalar performance:
{'acc': 0.9846852, 'precision': 0.9038638, 'recall': 0.8661703, 'specificity': 0.8661703, 'f1': 0.88401395, 'auroc': 0.9745656, 'binary_precision': 0.8174342, 'binary_recall': 0.7384844, 'binary_specificity': 0.9938562, 'binary_f1_score': 0.7759563}
confusion matrix:
       0    1
0  17956  111
1    176  497
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582662, 'precision': 0.74001944, 'recall': 0.5239909, 'specificity': 0.5239909, 'f1': 0.53493536, 'auroc': 0.8788711, 'binary_precision': 0.52, 'binary_recall': 0.05, 'binary_specificity': 0.99798185, 'binary_f1_score': 0.09122807}
confusion matrix:
      0   1
0  5934  12
1   247  13
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863193.png
early stop counter: 6
val acc:0.9846851825714111, best validation acc: 0.9852721691131592, corresponding to test acc:                         0.9587495923042297 / 0.9747018814086914
after epoch: 26,now: 2024-05-27 05:14:14.936099,epoch time: 0:17:31.656270,used: 7:37:04.094399,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_21_37_10_seed_1_20863193
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99167424, 'precision': 0.9392687, 'recall': 0.9283711, 'specificity': 0.9283711, 'f1': 0.9337461, 'auroc': 0.99721587, 'binary_precision': 0.883274, 'binary_recall': 0.86061025, 'binary_specificity': 0.9961319, 'binary_f1_score': 0.8717948}
confusion matrix:
       0     1
0  42234   164
1    201  1241
---- Validation: 
scalar performance:
{'acc': 0.9842049, 'precision': 0.9022466, 'recall': 0.85948384, 'specificity': 0.85948384, 'f1': 0.8795603, 'auroc': 0.9711618, 'binary_precision': 0.8146911, 'binary_recall': 0.7251114, 'binary_specificity': 0.9938562, 'binary_f1_score': 0.7672956}
confusion matrix:
       0    1
0  17956  111
1    185  488
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590719, 'precision': 0.83695555, 'recall': 0.51889443, 'specificity': 0.51889443, 'f1': 0.52603334, 'auroc': 0.88898337, 'binary_precision': 0.71428573, 'binary_recall': 0.03846154, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.072992705}
confusion matrix:
      0   1
0  5942   4
1   250  10
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863193.png
early stop counter: 7
val acc:0.984204888343811, best validation acc: 0.9852721691131592, corresponding to test acc:                         0.9587495923042297 / 0.9747018814086914
after epoch: 27,now: 2024-05-27 05:31:47.458458,epoch time: 0:17:32.522359,used: 7:54:36.616758,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_21_37_10_seed_1_20863193
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9921989, 'precision': 0.93449676, 'recall': 0.9443848, 'specificity': 0.9443848, 'f1': 0.93938076, 'auroc': 0.9977493, 'binary_precision': 0.87262875, 'binary_recall': 0.89320385, 'binary_specificity': 0.99556583, 'binary_f1_score': 0.88279635}
confusion matrix:
       0     1
0  42210   188
1    154  1288
---- Validation: 
scalar performance:
{'acc': 0.98356456, 'precision': 0.894243, 'recall': 0.8591517, 'specificity': 0.8591517, 'f1': 0.8758077, 'auroc': 0.97457576, 'binary_precision': 0.7986907, 'binary_recall': 0.7251114, 'binary_specificity': 0.993192, 'binary_f1_score': 0.7601246}
confusion matrix:
       0    1
0  17944  123
1    185  488
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95665485, 'precision': 0.6657013, 'recall': 0.52315, 'specificity': 0.52315, 'f1': 0.5329677, 'auroc': 0.90003717, 'binary_precision': 0.37142858, 'binary_recall': 0.05, 'binary_specificity': 0.99630004, 'binary_f1_score': 0.08813559}
confusion matrix:
      0   1
0  5924  22
1   247  13
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863193.png
early stop counter: 8
val acc:0.983564555644989, best validation acc: 0.9852721691131592, corresponding to test acc:                         0.9587495923042297 / 0.9747018814086914
after epoch: 28,now: 2024-05-27 05:49:18.178605,epoch time: 0:17:30.720147,used: 8:12:07.336905,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_21_37_10_seed_1_20863193
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99229014, 'precision': 0.93588364, 'recall': 0.94405985, 'specificity': 0.94405985, 'f1': 0.9399308, 'auroc': 0.9975671, 'binary_precision': 0.87542546, 'binary_recall': 0.8924358, 'binary_specificity': 0.99568385, 'binary_f1_score': 0.8838488}
confusion matrix:
       0     1
0  42216   183
1    155  1286
---- Validation: 
scalar performance:
{'acc': 0.9847385, 'precision': 0.8965435, 'recall': 0.8783575, 'specificity': 0.8783575, 'f1': 0.887218, 'auroc': 0.9737428, 'binary_precision': 0.8018721, 'binary_recall': 0.7637444, 'binary_specificity': 0.9929706, 'binary_f1_score': 0.782344}
confusion matrix:
       0    1
0  17940  127
1    159  514
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587496, 'precision': 0.7659668, 'recall': 0.5297602, 'specificity': 0.5297602, 'f1': 0.544998, 'auroc': 0.8313577, 'binary_precision': 0.5714286, 'binary_recall': 0.06153846, 'binary_specificity': 0.99798185, 'binary_f1_score': 0.11111111}
confusion matrix:
      0   1
0  5934  12
1   244  16
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863193.png
early stop counter: 9
val acc:0.9847385287284851, best validation acc: 0.9852721691131592, corresponding to test acc:                         0.9587495923042297 / 0.9747018814086914
after epoch: 29,now: 2024-05-27 06:06:47.737460,epoch time: 0:17:29.558855,used: 8:29:36.895760,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_21_37_10_seed_1_20863193
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9916971, 'precision': 0.93449974, 'recall': 0.93508184, 'specificity': 0.93508184, 'f1': 0.93479055, 'auroc': 0.9975239, 'binary_precision': 0.8732687, 'binary_recall': 0.8744799, 'binary_specificity': 0.9956837, 'binary_f1_score': 0.8738739}
confusion matrix:
       0     1
0  42215   183
1    181  1261
---- Validation: 
scalar performance:
{'acc': 0.9838314, 'precision': 0.9019692, 'recall': 0.8528527, 'specificity': 0.8528527, 'f1': 0.87567437, 'auroc': 0.97293985, 'binary_precision': 0.81462586, 'binary_recall': 0.71173847, 'binary_specificity': 0.9939669, 'binary_f1_score': 0.7597145}
confusion matrix:
       0    1
0  17958  109
1    194  479
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606832, 'precision': 0.79860616, 'recall': 0.57122695, 'specificity': 0.57122695, 'f1': 0.6086607, 'auroc': 0.91197634, 'binary_precision': 0.6333333, 'binary_recall': 0.14615385, 'binary_specificity': 0.99630004, 'binary_f1_score': 0.23750001}
confusion matrix:
      0   1
0  5924  22
1   222  38
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863193.png
early stop counter: 10
val acc:0.9838314056396484, best validation acc: 0.9852721691131592, corresponding to test acc:                         0.9587495923042297 / 0.9747018814086914
after epoch: 30,now: 2024-05-27 06:24:19.664161,epoch time: 0:17:31.926701,used: 8:47:08.822461,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_21_37_10_seed_1_20863193
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 8:47:08.822461 at 2024-05-27 06:24:19.664161
persisted model performance metric: 

scalar performance:
{'acc': 0.9597164, 'precision': 0.80876964, 'recall': 0.5394596, 'specificity': 0.5394596, 'f1': 0.5616043, 'auroc': 0.90124035, 'binary_precision': 0.65625, 'binary_recall': 0.08076923, 'binary_specificity': 0.99815, 'binary_f1_score': 0.14383562}
confusion matrix:
      0   1
0  5935  11
1   239  21
oracle model performance metric: 

scalar performance:
{'acc': 0.9737351, 'precision': 0.96792173, 'recall': 0.6938944, 'specificity': 0.6938944, 'f1': 0.7699472, 'auroc': 0.94301367, 'binary_precision': 0.96190476, 'binary_recall': 0.38846153, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.55342466}
confusion matrix:
      0    1
0  5942    4
1   159  101
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs32/rule_results/8.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs32/confusion_matrix/8.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 484873 KiB |   3086 MiB |   2006 TiB |   2006 TiB |
|       from large pool | 395648 KiB |   3015 MiB |   2003 TiB |   2003 TiB |
|       from small pool |  89225 KiB |    123 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 484873 KiB |   3086 MiB |   2006 TiB |   2006 TiB |
|       from large pool | 395648 KiB |   3015 MiB |   2003 TiB |   2003 TiB |
|       from small pool |  89225 KiB |    123 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476570 KiB |   3080 MiB |   2005 TiB |   2005 TiB |
|       from large pool | 387840 KiB |   3010 MiB |   2002 TiB |   2002 TiB |
|       from small pool |  88730 KiB |    122 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3432 MiB |   3432 MiB |   5210 MiB |   1778 MiB |
|       from large pool |   3308 MiB |   3308 MiB |   5060 MiB |   1752 MiB |
|       from small pool |    124 MiB |    124 MiB |    150 MiB |     26 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1164 MiB |   1309 MiB |   1176 TiB |   1176 TiB |
|       from large pool |   1155 MiB |   1287 MiB |   1172 TiB |   1172 TiB |
|       from small pool |      8 MiB |     33 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    2541    |    3966    |  130571 K  |  130569 K  |
|       from large pool |      87    |     178    |   57154 K  |   57154 K  |
|       from small pool |    2454    |    3878    |   73416 K  |   73414 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2541    |    3966    |  130571 K  |  130569 K  |
|       from large pool |      87    |     178    |   57154 K  |   57154 K  |
|       from small pool |    2454    |    3878    |   73416 K  |   73414 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      97    |     100    |     127    |      30    |
|       from large pool |      35    |      38    |      52    |      17    |
|       from small pool |      62    |      62    |      75    |      13    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      56    |    1402    |   55809 K  |   55809 K  |
|       from large pool |      23    |      33    |   22194 K  |   22194 K  |
|       from small pool |      33    |    1379    |   33614 K  |   33614 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3086 MiB |   2006 TiB |   2006 TiB |
|       from large pool |  16640 KiB |   3015 MiB |   2003 TiB |   2003 TiB |
|       from small pool |      0 KiB |    123 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3086 MiB |   2006 TiB |   2006 TiB |
|       from large pool |  16640 KiB |   3015 MiB |   2003 TiB |   2003 TiB |
|       from small pool |      0 KiB |    123 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3080 MiB |   2005 TiB |   2005 TiB |
|       from large pool |  16640 KiB |   3010 MiB |   2002 TiB |   2002 TiB |
|       from small pool |      0 KiB |    122 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1638 MiB |   3432 MiB |   5210 MiB |   3572 MiB |
|       from large pool |   1542 MiB |   3308 MiB |   5060 MiB |   3518 MiB |
|       from small pool |     96 MiB |    124 MiB |    150 MiB |     54 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 214784 KiB |   1345 MiB |   1176 TiB |   1176 TiB |
|       from large pool | 214784 KiB |   1324 MiB |   1172 TiB |   1172 TiB |
|       from small pool |      0 KiB |     33 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3966    |  130571 K  |  130571 K  |
|       from large pool |       2    |     178    |   57154 K  |   57154 K  |
|       from small pool |       0    |    3878    |   73416 K  |   73416 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3966    |  130571 K  |  130571 K  |
|       from large pool |       2    |     178    |   57154 K  |   57154 K  |
|       from small pool |       0    |    3878    |   73416 K  |   73416 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      69    |     100    |     127    |      58    |
|       from large pool |      21    |      38    |      52    |      31    |
|       from small pool |      48    |      62    |      75    |      27    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1402    |   55810 K  |   55810 K  |
|       from large pool |       3    |      33    |   22194 K  |   22194 K  |
|       from small pool |       0    |    1379    |   33615 K  |   33615 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Mon May 27 06:26:05 2024]
Finished job 0.
1 of 1 steps (100%) done
