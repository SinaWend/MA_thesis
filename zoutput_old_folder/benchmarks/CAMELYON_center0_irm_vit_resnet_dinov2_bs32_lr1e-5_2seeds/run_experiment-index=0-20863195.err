Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sun May 26 12:25:42 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs32/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs32/rule_results/0.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=0
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_36_seed_0_20863195

 Experiment start at: 2024-05-26 12:35:36.384957
before training, model accuracy: 0.6388623118400574
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9668083, 'precision': 0.88001347, 'recall': 0.50775224, 'specificity': 0.50775224, 'f1': 0.50690114, 'auroc': 0.96007615, 'binary_precision': 0.79310346, 'binary_recall': 0.015646258, 'binary_specificity': 0.9998582, 'binary_f1_score': 0.030687124}
confusion matrix:
       0   1
0  42300   6
1   1447  23
---- Validation: 
scalar performance:
{'acc': 0.9661026, 'precision': 0.8830955, 'recall': 0.50616574, 'specificity': 0.50616574, 'f1': 0.50362694, 'auroc': 0.9589258, 'binary_precision': 0.8, 'binary_recall': 0.01244168, 'binary_specificity': 0.9998898, 'binary_f1_score': 0.024502298}
confusion matrix:
       0  1
0  18147  2
1    635  8
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.94490826, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863195.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-26 12:56:15.017336,epoch time: 0:20:38.632379,used: 0:20:38.632379,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_36_seed_0_20863195
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96641994, 'precision': 0.8165536, 'recall': 0.500668, 'specificity': 0.500668, 'f1': 0.49281806, 'auroc': 0.966026, 'binary_precision': 0.6666667, 'binary_recall': 0.0013596193, 'binary_specificity': 0.99997634, 'binary_f1_score': 0.002713704}
confusion matrix:
       0  1
0  42304  1
1   1469  2
---- Validation: 
scalar performance:
{'acc': 0.96599615, 'precision': 0.98299444, 'recall': 0.5031104, 'specificity': 0.5031104, 'f1': 0.49753252, 'auroc': 0.96965915, 'binary_precision': 1.0, 'binary_recall': 0.00622084, 'binary_specificity': 1.0, 'binary_f1_score': 0.012364761}
confusion matrix:
       0  1
0  18149  0
1    639  4
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.94368845, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863195.png
early stop counter: 1
val acc:0.9659961462020874, best validation acc: 0.9661026000976562, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 2,now: 2024-05-26 13:15:48.475720,epoch time: 0:19:33.458384,used: 0:40:12.090763,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_36_seed_0_20863195
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9709887, 'precision': 0.76983285, 'recall': 0.8841969, 'specificity': 0.8841969, 'f1': 0.81585145, 'auroc': 0.9702333, 'binary_precision': 0.5470367, 'binary_recall': 0.7911565, 'binary_specificity': 0.9772373, 'binary_f1_score': 0.6468298}
confusion matrix:
       0     1
0  41343   963
1    307  1163
---- Validation: 
scalar performance:
{'acc': 0.9703065, 'precision': 0.7699703, 'recall': 0.8563678, 'specificity': 0.8563678, 'f1': 0.8065153, 'auroc': 0.96446645, 'binary_precision': 0.54947615, 'binary_recall': 0.7340591, 'binary_specificity': 0.9786765, 'binary_f1_score': 0.62849534}
confusion matrix:
       0    1
0  17762  387
1    171  472
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97730905, 'precision': 0.9226712, 'recall': 0.7682807, 'specificity': 0.7682807, 'f1': 0.8266755, 'auroc': 0.9541842, 'binary_precision': 0.86503065, 'binary_recall': 0.54022986, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.66509426}
confusion matrix:
      0    1
0  5975   22
1   120  141
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863195.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-05-26 13:35:23.471997,epoch time: 0:19:34.996277,used: 0:59:47.087040,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_36_seed_0_20863195
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9621482, 'precision': 0.7307881, 'recall': 0.9196778, 'specificity': 0.9196778, 'f1': 0.7940551, 'auroc': 0.97327995, 'binary_precision': 0.46608633, 'binary_recall': 0.8741497, 'binary_specificity': 0.9652059, 'binary_f1_score': 0.6079962}
confusion matrix:
       0     1
0  40834  1472
1    185  1285
---- Validation: 
scalar performance:
{'acc': 0.9653044, 'precision': 0.745468, 'recall': 0.91528267, 'specificity': 0.91528267, 'f1': 0.8056727, 'auroc': 0.9734433, 'binary_precision': 0.49597135, 'binary_recall': 0.86158633, 'binary_specificity': 0.968979, 'binary_f1_score': 0.6295455}
confusion matrix:
       0    1
0  17586  563
1     89  554
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9760307, 'precision': 0.843943, 'recall': 0.86655974, 'specificity': 0.86655974, 'f1': 0.85484856, 'auroc': 0.9536716, 'binary_precision': 0.6989247, 'binary_recall': 0.74712646, 'binary_specificity': 0.98599297, 'binary_f1_score': 0.72222227}
confusion matrix:
      0    1
0  5913   84
1    66  195
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863195.png
early stop counter: 1
val acc:0.9653043746948242, best validation acc: 0.9703065156936646, corresponding to test acc:                         0.9773090481758118 / 0.9773090481758118
after epoch: 4,now: 2024-05-26 13:55:00.718235,epoch time: 0:19:37.246238,used: 1:19:24.333278,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_36_seed_0_20863195
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9751462, 'precision': 0.8092547, 'recall': 0.80682063, 'specificity': 0.80682063, 'f1': 0.80803233, 'auroc': 0.9722426, 'binary_precision': 0.63150686, 'binary_recall': 0.6263587, 'binary_specificity': 0.9872825, 'binary_f1_score': 0.6289222}
confusion matrix:
       0    1
0  41766  538
1    550  922
---- Validation: 
scalar performance:
{'acc': 0.9743508, 'precision': 0.8099673, 'recall': 0.7894565, 'specificity': 0.7894565, 'f1': 0.79932666, 'auroc': 0.9703798, 'binary_precision': 0.63439065, 'binary_recall': 0.59097975, 'binary_specificity': 0.9879332, 'binary_f1_score': 0.61191624}
confusion matrix:
       0    1
0  17930  219
1    263  380
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96228826, 'precision': 0.8184782, 'recall': 0.59186876, 'specificity': 0.59186876, 'f1': 0.6370202, 'auroc': 0.9556432, 'binary_precision': 0.6712329, 'binary_recall': 0.18773946, 'binary_specificity': 0.995998, 'binary_f1_score': 0.2934132}
confusion matrix:
      0   1
0  5973  24
1   212  49
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863195.png
better model found
persisted
after epoch: 5,now: 2024-05-26 14:14:55.722675,epoch time: 0:19:55.004440,used: 1:39:19.337718,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_36_seed_0_20863195
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9785499, 'precision': 0.8349214, 'recall': 0.83470166, 'specificity': 0.83470166, 'f1': 0.8348115, 'auroc': 0.97780025, 'binary_precision': 0.68095237, 'binary_recall': 0.6804895, 'binary_specificity': 0.98891383, 'binary_f1_score': 0.68072087}
confusion matrix:
       0     1
0  41836   469
1    470  1001
---- Validation: 
scalar performance:
{'acc': 0.98052365, 'precision': 0.8575232, 'recall': 0.84140587, 'specificity': 0.84140587, 'f1': 0.8492619, 'auroc': 0.9750373, 'binary_precision': 0.725938, 'binary_recall': 0.69206846, 'binary_specificity': 0.9907433, 'binary_f1_score': 0.70859873}
confusion matrix:
       0    1
0  17981  168
1    198  445
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9653244, 'precision': 0.83865654, 'recall': 0.6410935, 'specificity': 0.6410935, 'f1': 0.69542885, 'auroc': 0.95344913, 'binary_precision': 0.7075472, 'binary_recall': 0.28735632, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.40871933}
confusion matrix:
      0   1
0  5966  31
1   186  75
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863195.png
better model found
persisted
after epoch: 6,now: 2024-05-26 14:34:51.185068,epoch time: 0:19:55.462393,used: 1:59:14.800111,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_36_seed_0_20863195
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97848135, 'precision': 0.8361527, 'recall': 0.8290887, 'specificity': 0.8290887, 'f1': 0.83257973, 'auroc': 0.9751923, 'binary_precision': 0.6838082, 'binary_recall': 0.6689327, 'binary_specificity': 0.98924476, 'binary_f1_score': 0.67628866}
confusion matrix:
       0    1
0  41850  455
1    487  984
---- Validation: 
scalar performance:
{'acc': 0.9798318, 'precision': 0.86604786, 'recall': 0.80804527, 'specificity': 0.80804527, 'f1': 0.8343371, 'auroc': 0.97254, 'binary_precision': 0.74535316, 'binary_recall': 0.62363917, 'binary_specificity': 0.99245137, 'binary_f1_score': 0.6790855}
confusion matrix:
       0    1
0  18012  137
1    242  401
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964046, 'precision': 0.8194635, 'recall': 0.6330972, 'specificity': 0.6330972, 'f1': 0.68420047, 'auroc': 0.95228887, 'binary_precision': 0.6698113, 'binary_recall': 0.27203065, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.386921}
confusion matrix:
      0   1
0  5962  35
1   190  71
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863195.png
early stop counter: 1
val acc:0.9798318147659302, best validation acc: 0.9805236458778381, corresponding to test acc:                         0.9653244018554688 / 0.9773090481758118
after epoch: 7,now: 2024-05-26 14:54:50.429497,epoch time: 0:19:59.244429,used: 2:19:14.044540,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_36_seed_0_20863195
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9744609, 'precision': 0.9115107, 'recall': 0.6458172, 'specificity': 0.6458172, 'f1': 0.711429, 'auroc': 0.9734211, 'binary_precision': 0.84705883, 'binary_recall': 0.29347825, 'binary_specificity': 0.9981562, 'binary_f1_score': 0.43592334}
confusion matrix:
       0    1
0  42226   78
1   1040  432
---- Validation: 
scalar performance:
{'acc': 0.97190297, 'precision': 0.9589101, 'recall': 0.59467494, 'specificity': 0.59467494, 'f1': 0.65085953, 'auroc': 0.971743, 'binary_precision': 0.9457364, 'binary_recall': 0.18973562, 'binary_specificity': 0.9996143, 'binary_f1_score': 0.31606218}
confusion matrix:
       0    1
0  18142    7
1    521  122
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.97922325, 'recall': 0.5019157, 'specificity': 0.5019157, 'f1': 0.49320802, 'auroc': 0.95729554, 'binary_precision': 1.0, 'binary_recall': 0.0038314175, 'binary_specificity': 1.0, 'binary_f1_score': 0.007633588}
confusion matrix:
      0  1
0  5997  0
1   260  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863195.png
early stop counter: 2
val acc:0.9719029664993286, best validation acc: 0.9805236458778381, corresponding to test acc:                         0.9653244018554688 / 0.9773090481758118
after epoch: 8,now: 2024-05-26 15:15:00.822428,epoch time: 0:20:10.392931,used: 2:39:24.437471,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_36_seed_0_20863195
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.981748, 'precision': 0.860963, 'recall': 0.8564639, 'specificity': 0.8564639, 'f1': 0.85869807, 'auroc': 0.98063797, 'binary_precision': 0.7315898, 'binary_recall': 0.72214675, 'binary_specificity': 0.990781, 'binary_f1_score': 0.7268376}
confusion matrix:
       0     1
0  41914   390
1    409  1063
---- Validation: 
scalar performance:
{'acc': 0.98217326, 'precision': 0.90623057, 'recall': 0.80100685, 'specificity': 0.80100685, 'f1': 0.84518284, 'auroc': 0.9766133, 'binary_precision': 0.8262712, 'binary_recall': 0.60653186, 'binary_specificity': 0.99548185, 'binary_f1_score': 0.6995515}
confusion matrix:
       0    1
0  18067   82
1    253  390
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642058, 'precision': 0.90712297, 'recall': 0.5855399, 'specificity': 0.5855399, 'f1': 0.6341333, 'auroc': 0.961946, 'binary_precision': 0.8490566, 'binary_recall': 0.1724138, 'binary_specificity': 0.998666, 'binary_f1_score': 0.2866242}
confusion matrix:
      0   1
0  5989   8
1   216  45
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863195.png
better model found
persisted
after epoch: 9,now: 2024-05-26 15:35:11.194274,epoch time: 0:20:10.371846,used: 2:59:34.809317,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_36_seed_0_20863195
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.97985196, 'precision': 0.87973845, 'recall': 0.77960074, 'specificity': 0.77960074, 'f1': 0.8214632, 'auroc': 0.97961545, 'binary_precision': 0.77446413, 'binary_recall': 0.5649218, 'binary_specificity': 0.9942796, 'binary_f1_score': 0.6533019}
confusion matrix:
       0    1
0  42063  242
1    640  831
---- Validation: 
scalar performance:
{'acc': 0.9775969, 'precision': 0.87710863, 'recall': 0.7423834, 'specificity': 0.7423834, 'f1': 0.7939527, 'auroc': 0.97772396, 'binary_precision': 0.77205884, 'binary_recall': 0.48989114, 'binary_specificity': 0.9948757, 'binary_f1_score': 0.59942913}
confusion matrix:
       0    1
0  18056   93
1    328  315
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.75729454, 'recall': 0.50924504, 'specificity': 0.50924504, 'f1': 0.5079028, 'auroc': 0.95424944, 'binary_precision': 0.5555556, 'binary_recall': 0.019157087, 'binary_specificity': 0.999333, 'binary_f1_score': 0.037037034}
confusion matrix:
      0  1
0  5993  4
1   256  5
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863195.png
early stop counter: 1
val acc:0.9775968790054321, best validation acc: 0.9821732640266418, corresponding to test acc:                         0.964205801486969 / 0.9773090481758118
after epoch: 10,now: 2024-05-26 15:55:13.150839,epoch time: 0:20:01.956565,used: 3:19:36.765882,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_36_seed_0_20863195
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9796464, 'precision': 0.9050535, 'recall': 0.74734193, 'specificity': 0.74734193, 'f1': 0.8057594, 'auroc': 0.9787717, 'binary_precision': 0.8273138, 'binary_recall': 0.49830046, 'binary_specificity': 0.9963834, 'binary_f1_score': 0.6219771}
confusion matrix:
       0    1
0  42152  153
1    738  733
---- Validation: 
scalar performance:
{'acc': 0.9760004, 'precision': 0.9233645, 'recall': 0.67480206, 'specificity': 0.67480206, 'f1': 0.74412924, 'auroc': 0.97640824, 'binary_precision': 0.86923075, 'binary_recall': 0.35147744, 'binary_specificity': 0.9981266, 'binary_f1_score': 0.5005537}
confusion matrix:
       0    1
0  18115   34
1    417  226
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589326, 'precision': 0.97945315, 'recall': 0.50766283, 'specificity': 0.50766283, 'f1': 0.5046054, 'auroc': 0.94438314, 'binary_precision': 1.0, 'binary_recall': 0.01532567, 'binary_specificity': 1.0, 'binary_f1_score': 0.030188678}
confusion matrix:
      0  1
0  5997  0
1   257  4
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863195.png
early stop counter: 2
val acc:0.9760004281997681, best validation acc: 0.9821732640266418, corresponding to test acc:                         0.964205801486969 / 0.9773090481758118
after epoch: 11,now: 2024-05-26 16:15:01.945191,epoch time: 0:19:48.794352,used: 3:39:25.560234,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_36_seed_0_20863195
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98156524, 'precision': 0.9287635, 'recall': 0.7622818, 'specificity': 0.7622818, 'f1': 0.82407165, 'auroc': 0.98405385, 'binary_precision': 0.8737317, 'binary_recall': 0.5272109, 'binary_specificity': 0.9973526, 'binary_f1_score': 0.6576156}
confusion matrix:
       0    1
0  42194  112
1    695  775
---- Validation: 
scalar performance:
{'acc': 0.97887397, 'precision': 0.95338166, 'recall': 0.707042, 'specificity': 0.707042, 'f1': 0.7813727, 'auroc': 0.9782239, 'binary_precision': 0.9270833, 'binary_recall': 0.41524106, 'binary_specificity': 0.9988429, 'binary_f1_score': 0.5735768}
confusion matrix:
       0    1
0  18128   21
1    376  267
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589326, 'precision': 0.78552353, 'recall': 0.52048916, 'specificity': 0.52048916, 'f1': 0.5289256, 'auroc': 0.95103097, 'binary_precision': 0.6111111, 'binary_recall': 0.042145595, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.07885305}
confusion matrix:
      0   1
0  5990   7
1   250  11
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863195.png
early stop counter: 3
val acc:0.9788739681243896, best validation acc: 0.9821732640266418, corresponding to test acc:                         0.964205801486969 / 0.9773090481758118
after epoch: 12,now: 2024-05-26 16:34:35.856826,epoch time: 0:19:33.911635,used: 3:58:59.471869,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_36_seed_0_20863195
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.97759044, 'precision': 0.80810535, 'recall': 0.917211, 'specificity': 0.917211, 'f1': 0.85358036, 'auroc': 0.9826815, 'binary_precision': 0.62140733, 'binary_recall': 0.8524813, 'binary_specificity': 0.9819407, 'binary_f1_score': 0.7188306}
confusion matrix:
       0     1
0  41541   764
1    217  1254
---- Validation: 
scalar performance:
{'acc': 0.9777033, 'precision': 0.8168063, 'recall': 0.8879492, 'specificity': 0.8879492, 'f1': 0.84841436, 'auroc': 0.9781466, 'binary_precision': 0.6410579, 'binary_recall': 0.79160184, 'binary_specificity': 0.9842967, 'binary_f1_score': 0.7084203}
confusion matrix:
       0    1
0  17864  285
1    134  509
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96212846, 'precision': 0.80156916, 'recall': 0.6046117, 'specificity': 0.6046117, 'f1': 0.650719, 'auroc': 0.9503379, 'binary_precision': 0.6363636, 'binary_recall': 0.21455939, 'binary_specificity': 0.994664, 'binary_f1_score': 0.32091692}
confusion matrix:
      0   1
0  5965  32
1   205  56
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863195.png
early stop counter: 4
val acc:0.9777032732963562, best validation acc: 0.9821732640266418, corresponding to test acc:                         0.964205801486969 / 0.9773090481758118
after epoch: 13,now: 2024-05-26 16:54:09.668166,epoch time: 0:19:33.811340,used: 4:18:33.283209,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_36_seed_0_20863195
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9844664, 'precision': 0.8987211, 'recall': 0.8498019, 'specificity': 0.8498019, 'f1': 0.8725337, 'auroc': 0.98657405, 'binary_precision': 0.8076324, 'binary_recall': 0.7054422, 'binary_specificity': 0.9941616, 'binary_f1_score': 0.7530864}
confusion matrix:
       0     1
0  42059   247
1    433  1037
---- Validation: 
scalar performance:
{'acc': 0.98169434, 'precision': 0.9330791, 'recall': 0.7670064, 'specificity': 0.7670064, 'f1': 0.8289498, 'auroc': 0.9802711, 'binary_precision': 0.88235295, 'binary_recall': 0.5365474, 'binary_specificity': 0.99746543, 'binary_f1_score': 0.6673114}
confusion matrix:
       0    1
0  18103   46
1    298  345
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96260786, 'precision': 0.8364879, 'recall': 0.5865385, 'specificity': 0.5865385, 'f1': 0.63150626, 'auroc': 0.94746625, 'binary_precision': 0.7076923, 'binary_recall': 0.17624521, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.2822086}
confusion matrix:
      0   1
0  5978  19
1   215  46
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863195.png
early stop counter: 5
val acc:0.9816943407058716, best validation acc: 0.9821732640266418, corresponding to test acc:                         0.964205801486969 / 0.9773090481758118
after epoch: 14,now: 2024-05-26 17:13:45.039107,epoch time: 0:19:35.370941,used: 4:38:08.654150,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_36_seed_0_20863195
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9820221, 'precision': 0.9041004, 'recall': 0.79464114, 'specificity': 0.79464114, 'f1': 0.84014475, 'auroc': 0.98179555, 'binary_precision': 0.8222013, 'binary_recall': 0.59375, 'binary_specificity': 0.99553233, 'binary_f1_score': 0.6895464}
confusion matrix:
       0    1
0  42115  189
1    598  874
---- Validation: 
scalar performance:
{'acc': 0.9802576, 'precision': 0.9167541, 'recall': 0.7550118, 'specificity': 0.7550118, 'f1': 0.8150028, 'auroc': 0.97611535, 'binary_precision': 0.8505155, 'binary_recall': 0.5132193, 'binary_specificity': 0.99680424, 'binary_f1_score': 0.64015526}
confusion matrix:
       0    1
0  18091   58
1    313  330
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.8555101, 'recall': 0.5339825, 'specificity': 0.5339825, 'f1': 0.5529788, 'auroc': 0.9285387, 'binary_precision': 0.75, 'binary_recall': 0.06896552, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.12631579}
confusion matrix:
      0   1
0  5991   6
1   243  18
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863195.png
early stop counter: 6
val acc:0.9802575707435608, best validation acc: 0.9821732640266418, corresponding to test acc:                         0.964205801486969 / 0.9773090481758118
after epoch: 15,now: 2024-05-26 17:33:31.910690,epoch time: 0:19:46.871583,used: 4:57:55.525733,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_36_seed_0_20863195
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9786869, 'precision': 0.97210157, 'recall': 0.6892194, 'specificity': 0.6892194, 'f1': 0.7666497, 'auroc': 0.9861794, 'binary_precision': 0.96533793, 'binary_recall': 0.37891155, 'binary_specificity': 0.9995273, 'binary_f1_score': 0.54421103}
confusion matrix:
       0    1
0  42286   20
1    913  557
---- Validation: 
scalar performance:
{'acc': 0.9744572, 'precision': 0.9649743, 'recall': 0.63275003, 'specificity': 0.63275003, 'f1': 0.7015007, 'auroc': 0.978421, 'binary_precision': 0.95530725, 'binary_recall': 0.2659409, 'binary_specificity': 0.9995592, 'binary_f1_score': 0.4160584}
confusion matrix:
       0    1
0  18141    8
1    472  171
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.81262994, 'recall': 0.50374806, 'specificity': 0.50374806, 'f1': 0.49696523, 'auroc': 0.9426995, 'binary_precision': 0.6666667, 'binary_recall': 0.007662835, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.015151515}
confusion matrix:
      0  1
0  5996  1
1   259  2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863195.png
early stop counter: 7
val acc:0.9744572043418884, best validation acc: 0.9821732640266418, corresponding to test acc:                         0.964205801486969 / 0.9773090481758118
after epoch: 16,now: 2024-05-26 17:53:30.479339,epoch time: 0:19:58.568649,used: 5:17:54.094382,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_36_seed_0_20863195
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9856314, 'precision': 0.91895366, 'recall': 0.8461365, 'specificity': 0.8461365, 'f1': 0.87881225, 'auroc': 0.9886241, 'binary_precision': 0.84838444, 'binary_recall': 0.69659865, 'binary_specificity': 0.9956744, 'binary_f1_score': 0.76503545}
confusion matrix:
       0     1
0  42123   183
1    446  1024
---- Validation: 
scalar performance:
{'acc': 0.9830247, 'precision': 0.9372834, 'recall': 0.7864466, 'specificity': 0.7864466, 'f1': 0.84501934, 'auroc': 0.97985643, 'binary_precision': 0.8894231, 'binary_recall': 0.5754277, 'binary_specificity': 0.99746543, 'binary_f1_score': 0.69877243}
confusion matrix:
       0    1
0  18103   46
1    273  370
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642058, 'precision': 0.87118036, 'recall': 0.59836626, 'specificity': 0.59836626, 'f1': 0.6493472, 'auroc': 0.95260096, 'binary_precision': 0.7761194, 'binary_recall': 0.19923371, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.31707317}
confusion matrix:
      0   1
0  5982  15
1   209  52
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863195.png
better model found
persisted
after epoch: 17,now: 2024-05-26 18:13:27.959835,epoch time: 0:19:57.480496,used: 5:37:51.574878,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_36_seed_0_20863195
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9869792, 'precision': 0.9172676, 'recall': 0.87384, 'specificity': 0.87384, 'f1': 0.8942672, 'auroc': 0.989781, 'binary_precision': 0.8431074, 'binary_recall': 0.7525493, 'binary_specificity': 0.9951306, 'binary_f1_score': 0.79525864}
confusion matrix:
       0     1
0  42099   206
1    364  1107
---- Validation: 
scalar performance:
{'acc': 0.9832908, 'precision': 0.9079391, 'recall': 0.8203368, 'specificity': 0.8203368, 'f1': 0.85845375, 'auroc': 0.98073137, 'binary_precision': 0.82834333, 'binary_recall': 0.64541215, 'binary_specificity': 0.99526143, 'binary_f1_score': 0.7255245}
confusion matrix:
       0    1
0  18063   86
1    228  415
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96324706, 'precision': 0.8268553, 'recall': 0.60702765, 'specificity': 0.60702765, 'f1': 0.65624976, 'auroc': 0.9543768, 'binary_precision': 0.686747, 'binary_recall': 0.21839081, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.33139536}
confusion matrix:
      0   1
0  5971  26
1   204  57
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863195.png
better model found
persisted
after epoch: 18,now: 2024-05-26 18:33:17.675777,epoch time: 0:19:49.715942,used: 5:57:41.290820,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_36_seed_0_20863195
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9852202, 'precision': 0.915729, 'recall': 0.8424179, 'specificity': 0.8424179, 'f1': 0.87525403, 'auroc': 0.9894277, 'binary_precision': 0.8421927, 'binary_recall': 0.689327, 'binary_specificity': 0.9955088, 'binary_f1_score': 0.7581309}
confusion matrix:
       0     1
0  42115   190
1    457  1014
---- Validation: 
scalar performance:
{'acc': 0.9830247, 'precision': 0.9286159, 'recall': 0.7939471, 'specificity': 0.7939471, 'f1': 0.8478087, 'auroc': 0.9752519, 'binary_precision': 0.8715596, 'binary_recall': 0.59097975, 'binary_specificity': 0.99691445, 'binary_f1_score': 0.70435584}
confusion matrix:
       0    1
0  18093   56
1    263  380
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579738, 'precision': 0.7239326, 'recall': 0.5584679, 'specificity': 0.5584679, 'f1': 0.58707094, 'auroc': 0.9219939, 'binary_precision': 0.4848485, 'binary_recall': 0.12260536, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.19571865}
confusion matrix:
      0   1
0  5963  34
1   229  32
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863195.png
early stop counter: 1
val acc:0.9830247163772583, best validation acc: 0.9832907915115356, corresponding to test acc:                         0.9632470607757568 / 0.9773090481758118
after epoch: 19,now: 2024-05-26 18:53:11.831304,epoch time: 0:19:54.155527,used: 6:17:35.446347,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_36_seed_0_20863195
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.986568, 'precision': 0.90830994, 'recall': 0.87822044, 'specificity': 0.87822044, 'f1': 0.89264286, 'auroc': 0.98960876, 'binary_precision': 0.82487124, 'binary_recall': 0.7620666, 'binary_specificity': 0.9943742, 'binary_f1_score': 0.7922261}
confusion matrix:
       0     1
0  42067   238
1    350  1121
---- Validation: 
scalar performance:
{'acc': 0.98243934, 'precision': 0.912757, 'recall': 0.7988944, 'specificity': 0.7988944, 'f1': 0.84602046, 'auroc': 0.97554696, 'binary_precision': 0.8394794, 'binary_recall': 0.60186625, 'binary_specificity': 0.9959226, 'binary_f1_score': 0.70108694}
confusion matrix:
       0    1
0  18075   74
1    256  387
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9653244, 'precision': 0.8350358, 'recall': 0.6447582, 'specificity': 0.6447582, 'f1': 0.6986134, 'auroc': 0.94502807, 'binary_precision': 0.7, 'binary_recall': 0.29501915, 'binary_specificity': 0.99449724, 'binary_f1_score': 0.41509435}
confusion matrix:
      0   1
0  5964  33
1   184  77
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863195.png
early stop counter: 2
val acc:0.9824393391609192, best validation acc: 0.9832907915115356, corresponding to test acc:                         0.9632470607757568 / 0.9773090481758118
after epoch: 20,now: 2024-05-26 19:13:09.917023,epoch time: 0:19:58.085719,used: 6:37:33.532066,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_36_seed_0_20863195
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9839638, 'precision': 0.870716, 'recall': 0.88868415, 'specificity': 0.88868415, 'f1': 0.8794686, 'auroc': 0.9872489, 'binary_precision': 0.74886733, 'binary_recall': 0.7865398, 'binary_specificity': 0.9908285, 'binary_f1_score': 0.7672414}
confusion matrix:
       0     1
0  41917   388
1    314  1157
---- Validation: 
scalar performance:
{'acc': 0.98249257, 'precision': 0.87177026, 'recall': 0.8589264, 'specificity': 0.8589264, 'f1': 0.8652255, 'auroc': 0.9742861, 'binary_precision': 0.7532258, 'binary_recall': 0.7262831, 'binary_specificity': 0.99156976, 'binary_f1_score': 0.7395091}
confusion matrix:
       0    1
0  17996  153
1    176  467
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.8211849, 'recall': 0.528152, 'specificity': 0.528152, 'f1': 0.5426627, 'auroc': 0.93749523, 'binary_precision': 0.6818182, 'binary_recall': 0.057471264, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.10600707}
confusion matrix:
      0   1
0  5990   7
1   246  15
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863195.png
early stop counter: 3
val acc:0.9824925661087036, best validation acc: 0.9832907915115356, corresponding to test acc:                         0.9632470607757568 / 0.9773090481758118
after epoch: 21,now: 2024-05-26 19:33:15.157641,epoch time: 0:20:05.240618,used: 6:57:38.772684,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_36_seed_0_20863195
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.98517454, 'precision': 0.94276446, 'recall': 0.81385076, 'specificity': 0.81385076, 'f1': 0.8665402, 'auroc': 0.989615, 'binary_precision': 0.8982558, 'binary_recall': 0.6301836, 'binary_specificity': 0.997518, 'binary_f1_score': 0.7407112}
confusion matrix:
       0    1
0  42200  105
1    544  927
---- Validation: 
scalar performance:
{'acc': 0.98291826, 'precision': 0.9595065, 'recall': 0.7683901, 'specificity': 0.7683901, 'f1': 0.837171, 'auroc': 0.973063, 'binary_precision': 0.9351351, 'binary_recall': 0.5381026, 'binary_specificity': 0.9986776, 'binary_f1_score': 0.6831195}
confusion matrix:
       0    1
0  18125   24
1    297  346
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589326, 'precision': 0.97945315, 'recall': 0.50766283, 'specificity': 0.50766283, 'f1': 0.5046054, 'auroc': 0.88682103, 'binary_precision': 1.0, 'binary_recall': 0.01532567, 'binary_specificity': 1.0, 'binary_f1_score': 0.030188678}
confusion matrix:
      0  1
0  5997  0
1   257  4
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863195.png
early stop counter: 4
val acc:0.9829182624816895, best validation acc: 0.9832907915115356, corresponding to test acc:                         0.9632470607757568 / 0.9773090481758118
after epoch: 22,now: 2024-05-26 19:53:08.721135,epoch time: 0:19:53.563494,used: 7:17:32.336178,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_36_seed_0_20863195
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.98693347, 'precision': 0.94269407, 'recall': 0.8442886, 'specificity': 0.8442886, 'f1': 0.8868865, 'auroc': 0.99328995, 'binary_precision': 0.89603525, 'binary_recall': 0.69136643, 'binary_specificity': 0.99721074, 'binary_f1_score': 0.7805066}
confusion matrix:
       0     1
0  42187   118
1    454  1017
---- Validation: 
scalar performance:
{'acc': 0.9833972, 'precision': 0.9468429, 'recall': 0.7851393, 'specificity': 0.7851393, 'f1': 0.8468753, 'auroc': 0.9832551, 'binary_precision': 0.908642, 'binary_recall': 0.57231724, 'binary_specificity': 0.99796134, 'binary_f1_score': 0.70229006}
confusion matrix:
       0    1
0  18112   37
1    275  368
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9613295, 'precision': 0.8286589, 'recall': 0.5638835, 'specificity': 0.5638835, 'f1': 0.5997643, 'auroc': 0.9391247, 'binary_precision': 0.6938776, 'binary_recall': 0.1302682, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.21935484}
confusion matrix:
      0   1
0  5982  15
1   227  34
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863195.png
better model found
persisted
after epoch: 23,now: 2024-05-26 20:12:56.148900,epoch time: 0:19:47.427765,used: 7:37:19.763943,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_36_seed_0_20863195
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9872533, 'precision': 0.92173195, 'recall': 0.87341005, 'specificity': 0.87341005, 'f1': 0.89598715, 'auroc': 0.99168146, 'binary_precision': 0.8520801, 'binary_recall': 0.7513587, 'binary_specificity': 0.9954614, 'binary_f1_score': 0.7985559}
confusion matrix:
       0     1
0  42112   192
1    366  1106
---- Validation: 
scalar performance:
{'acc': 0.9833972, 'precision': 0.9070897, 'recall': 0.8233921, 'specificity': 0.8233921, 'f1': 0.8600661, 'auroc': 0.97985727, 'binary_precision': 0.82642996, 'binary_recall': 0.65163296, 'binary_specificity': 0.9951512, 'binary_f1_score': 0.72869563}
confusion matrix:
       0    1
0  18061   88
1    224  419
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959412, 'precision': 0.7567071, 'recall': 0.5720447, 'specificity': 0.5720447, 'f1': 0.60704637, 'auroc': 0.94435406, 'binary_precision': 0.5492958, 'binary_recall': 0.14942528, 'binary_specificity': 0.994664, 'binary_f1_score': 0.23493977}
confusion matrix:
      0   1
0  5965  32
1   222  39
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863195.png
early stop counter: 1
val acc:0.9833971858024597, best validation acc: 0.9833971858024597, corresponding to test acc:                         0.9613295197486877 / 0.9773090481758118
after epoch: 24,now: 2024-05-26 20:32:38.295878,epoch time: 0:19:42.146978,used: 7:57:01.910921,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_36_seed_0_20863195
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.985837, 'precision': 0.9497229, 'recall': 0.8189925, 'specificity': 0.8189925, 'f1': 0.8724543, 'auroc': 0.9932968, 'binary_precision': 0.9118217, 'binary_recall': 0.64013606, 'binary_specificity': 0.997849, 'binary_f1_score': 0.7521983}
confusion matrix:
       0    1
0  42215   91
1    529  941
---- Validation: 
scalar performance:
{'acc': 0.98126864, 'precision': 0.9429239, 'recall': 0.752535, 'specificity': 0.752535, 'f1': 0.8198898, 'auroc': 0.97512615, 'binary_precision': 0.9030471, 'binary_recall': 0.5069984, 'binary_specificity': 0.9980715, 'binary_f1_score': 0.6494024}
confusion matrix:
       0    1
0  18114   35
1    317  326
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.7762617, 'recall': 0.56130075, 'specificity': 0.56130075, 'f1': 0.59381324, 'auroc': 0.9217589, 'binary_precision': 0.58928573, 'binary_recall': 0.12643678, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.2082019}
confusion matrix:
      0   1
0  5974  23
1   228  33
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863195.png
early stop counter: 2
val acc:0.9812686443328857, best validation acc: 0.9833971858024597, corresponding to test acc:                         0.9613295197486877 / 0.9773090481758118
after epoch: 25,now: 2024-05-26 20:52:24.472131,epoch time: 0:19:46.176253,used: 8:16:48.087174,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_36_seed_0_20863195
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9848776, 'precision': 0.9221039, 'recall': 0.82890403, 'specificity': 0.82890403, 'f1': 0.8692833, 'auroc': 0.9923372, 'binary_precision': 0.85588753, 'binary_recall': 0.6616848, 'binary_specificity': 0.9961233, 'binary_f1_score': 0.7463601}
confusion matrix:
       0    1
0  42140  164
1    498  974
---- Validation: 
scalar performance:
{'acc': 0.98217326, 'precision': 0.92001116, 'recall': 0.7867558, 'specificity': 0.7867558, 'f1': 0.83988726, 'auroc': 0.9804652, 'binary_precision': 0.8548387, 'binary_recall': 0.5769829, 'binary_specificity': 0.99652874, 'binary_f1_score': 0.68895084}
confusion matrix:
       0    1
0  18086   63
1    272  371
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.7727549, 'recall': 0.5946163, 'specificity': 0.5946163, 'f1': 0.6359814, 'auroc': 0.9457927, 'binary_precision': 0.57954544, 'binary_recall': 0.1954023, 'binary_specificity': 0.99383026, 'binary_f1_score': 0.2922636}
confusion matrix:
      0   1
0  5960  37
1   210  51
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863195.png
early stop counter: 3
val acc:0.9821732640266418, best validation acc: 0.9833971858024597, corresponding to test acc:                         0.9613295197486877 / 0.9773090481758118
after epoch: 26,now: 2024-05-26 21:12:17.141982,epoch time: 0:19:52.669851,used: 8:36:40.757025,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_36_seed_0_20863195
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.98517454, 'precision': 0.8644229, 'recall': 0.93356085, 'specificity': 0.93356085, 'f1': 0.89571834, 'auroc': 0.99282086, 'binary_precision': 0.7331062, 'binary_recall': 0.8782313, 'binary_specificity': 0.98889047, 'binary_f1_score': 0.7991334}
confusion matrix:
       0     1
0  41836   470
1    179  1291
---- Validation: 
scalar performance:
{'acc': 0.98350364, 'precision': 0.86783266, 'recall': 0.89095217, 'specificity': 0.89095217, 'f1': 0.879008, 'auroc': 0.9787425, 'binary_precision': 0.7430657, 'binary_recall': 0.79160184, 'binary_specificity': 0.9903025, 'binary_f1_score': 0.7665663}
confusion matrix:
       0    1
0  17973  176
1    134  509
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959412, 'precision': 0.75170445, 'recall': 0.5922003, 'specificity': 0.5922003, 'f1': 0.63080055, 'auroc': 0.9381592, 'binary_precision': 0.53763443, 'binary_recall': 0.19157088, 'binary_specificity': 0.99282974, 'binary_f1_score': 0.28248587}
confusion matrix:
      0   1
0  5954  43
1   211  50
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863195.png
better model found
persisted
after epoch: 27,now: 2024-05-26 21:32:26.163178,epoch time: 0:20:09.021196,used: 8:56:49.778221,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_36_seed_0_20863195
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.98617965, 'precision': 0.9100389, 'recall': 0.86817694, 'specificity': 0.86817694, 'f1': 0.8878917, 'auroc': 0.9910363, 'binary_precision': 0.82902735, 'binary_recall': 0.74167234, 'binary_specificity': 0.9946815, 'binary_f1_score': 0.7829207}
confusion matrix:
       0     1
0  42080   225
1    380  1091
---- Validation: 
scalar performance:
{'acc': 0.98185396, 'precision': 0.90428483, 'recall': 0.7970913, 'specificity': 0.7970913, 'f1': 0.84186, 'auroc': 0.97688663, 'binary_precision': 0.8226496, 'binary_recall': 0.59875584, 'binary_specificity': 0.9954268, 'binary_f1_score': 0.69306934}
confusion matrix:
       0    1
0  18066   83
1    258  385
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9600511, 'precision': 0.7709532, 'recall': 0.57604283, 'specificity': 0.57604283, 'f1': 0.61323464, 'auroc': 0.91891813, 'binary_precision': 0.57746476, 'binary_recall': 0.15708812, 'binary_specificity': 0.9949975, 'binary_f1_score': 0.24698795}
confusion matrix:
      0   1
0  5967  30
1   220  41
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863195.png
early stop counter: 1
val acc:0.9818539619445801, best validation acc: 0.9835036396980286, corresponding to test acc:                         0.9594119787216187 / 0.9773090481758118
after epoch: 28,now: 2024-05-26 21:52:23.559616,epoch time: 0:19:57.396438,used: 9:16:47.174659,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_36_seed_0_20863195
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.98839545, 'precision': 0.9139519, 'recall': 0.90580297, 'specificity': 0.90580297, 'f1': 0.9098336, 'auroc': 0.994202, 'binary_precision': 0.83425796, 'binary_recall': 0.81725544, 'binary_specificity': 0.99435043, 'binary_f1_score': 0.8256692}
confusion matrix:
       0     1
0  42065   239
1    269  1203
---- Validation: 
scalar performance:
{'acc': 0.9841422, 'precision': 0.90011394, 'recall': 0.8470295, 'specificity': 0.8470295, 'f1': 0.871531, 'auroc': 0.97670364, 'binary_precision': 0.8108108, 'binary_recall': 0.6998445, 'binary_specificity': 0.99421453, 'binary_f1_score': 0.75125206}
confusion matrix:
       0    1
0  18044  105
1    193  450
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95126235, 'precision': 0.643276, 'recall': 0.56962484, 'specificity': 0.56962484, 'f1': 0.591325, 'auroc': 0.90783274, 'binary_precision': 0.32258064, 'binary_recall': 0.1532567, 'binary_specificity': 0.98599297, 'binary_f1_score': 0.2077922}
confusion matrix:
      0   1
0  5913  84
1   221  40
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863195.png
better model found
persisted
after epoch: 29,now: 2024-05-26 22:12:07.976064,epoch time: 0:19:44.416448,used: 9:36:31.591107,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_36_seed_0_20863195
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.989926, 'precision': 0.9326843, 'recall': 0.90850127, 'specificity': 0.90850127, 'f1': 0.9202177, 'auroc': 0.9954144, 'binary_precision': 0.87157285, 'binary_recall': 0.8212101, 'binary_specificity': 0.99579245, 'binary_f1_score': 0.8456423}
confusion matrix:
       0     1
0  42127   178
1    263  1208
---- Validation: 
scalar performance:
{'acc': 0.98510003, 'precision': 0.91678095, 'recall': 0.84377515, 'specificity': 0.84377515, 'f1': 0.8764972, 'auroc': 0.9818866, 'binary_precision': 0.84440225, 'binary_recall': 0.69206846, 'binary_specificity': 0.99548185, 'binary_f1_score': 0.7606838}
confusion matrix:
       0    1
0  18067   82
1    198  445
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.76609564, 'recall': 0.56113404, 'specificity': 0.56113404, 'f1': 0.5930768, 'auroc': 0.9331461, 'binary_precision': 0.5689655, 'binary_recall': 0.12643678, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.20689654}
confusion matrix:
      0   1
0  5972  25
1   228  33
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863195.png
better model found
persisted
after epoch: 30,now: 2024-05-26 22:31:55.632029,epoch time: 0:19:47.655965,used: 9:56:19.247072,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_12_35_36_seed_0_20863195
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 9:56:19.247072 at 2024-05-26 22:31:55.632029
persisted model performance metric: 

scalar performance:
{'acc': 0.959412, 'precision': 0.7683965, 'recall': 0.55005664, 'specificity': 0.55005664, 'f1': 0.5772593, 'auroc': 0.92208713, 'binary_precision': 0.5744681, 'binary_recall': 0.10344828, 'binary_specificity': 0.996665, 'binary_f1_score': 0.17532468}
confusion matrix:
      0   1
0  5977  20
1   234  27
oracle model performance metric: 

scalar performance:
{'acc': 0.97651005, 'precision': 0.91583735, 'recall': 0.76236683, 'specificity': 0.76236683, 'f1': 0.82016325, 'auroc': 0.9538775, 'binary_precision': 0.8518519, 'binary_recall': 0.52873564, 'binary_specificity': 0.995998, 'binary_f1_score': 0.6524822}
confusion matrix:
      0    1
0  5973   24
1   123  138
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs32/rule_results/0.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs32/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs32/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 454882 KiB |   3644 MiB |    921 TiB |    921 TiB |
|       from large pool | 413783 KiB |   3611 MiB |    915 TiB |    915 TiB |
|       from small pool |  41099 KiB |     57 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 454882 KiB |   3644 MiB |    921 TiB |    921 TiB |
|       from large pool | 413783 KiB |   3611 MiB |    915 TiB |    915 TiB |
|       from small pool |  41099 KiB |     57 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447754 KiB |   3642 MiB |    920 TiB |    920 TiB |
|       from large pool | 407075 KiB |   3608 MiB |    914 TiB |    914 TiB |
|       from small pool |  40679 KiB |     56 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4034 MiB |   4034 MiB |   4034 MiB |      0 B   |
|       from large pool |   3970 MiB |   3970 MiB |   3970 MiB |      0 B   |
|       from small pool |     64 MiB |     64 MiB |     64 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 538397 KiB | 643599 KiB | 539105 GiB | 539104 GiB |
|       from large pool | 532393 KiB | 636880 KiB | 532519 GiB | 532518 GiB |
|       from small pool |   6004 KiB |  11568 KiB |   6585 GiB |   6585 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2312    |    3721    |   90249 K  |   90247 K  |
|       from large pool |     187    |     311    |   43966 K  |   43965 K  |
|       from small pool |    2125    |    3533    |   46283 K  |   46281 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2312    |    3721    |   90249 K  |   90247 K  |
|       from large pool |     187    |     311    |   43966 K  |   43965 K  |
|       from small pool |    2125    |    3533    |   46283 K  |   46281 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     148    |     148    |     148    |       0    |
|       from large pool |     116    |     116    |     116    |       0    |
|       from small pool |      32    |      32    |      32    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      65    |    1422    |   52936 K  |   52936 K  |
|       from large pool |      32    |     115    |   35167 K  |   35167 K  |
|       from small pool |      33    |    1390    |   17769 K  |   17769 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3644 MiB |    921 TiB |    921 TiB |
|       from large pool |  16640 KiB |   3611 MiB |    915 TiB |    915 TiB |
|       from small pool |      0 KiB |     57 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3644 MiB |    921 TiB |    921 TiB |
|       from large pool |  16640 KiB |   3611 MiB |    915 TiB |    915 TiB |
|       from small pool |      0 KiB |     57 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3642 MiB |    920 TiB |    920 TiB |
|       from large pool |  16640 KiB |   3608 MiB |    914 TiB |    914 TiB |
|       from small pool |      0 KiB |     56 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    970 MiB |   4034 MiB |   4034 MiB |   3064 MiB |
|       from large pool |    924 MiB |   3970 MiB |   3970 MiB |   3046 MiB |
|       from small pool |     46 MiB |     64 MiB |     64 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   3840 KiB | 643599 KiB | 539105 GiB | 539105 GiB |
|       from large pool |   3840 KiB | 636880 KiB | 532519 GiB | 532519 GiB |
|       from small pool |      0 KiB |  19804 KiB |   6585 GiB |   6585 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3721    |   90249 K  |   90249 K  |
|       from large pool |       2    |     311    |   43966 K  |   43966 K  |
|       from small pool |       0    |    3533    |   46283 K  |   46283 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3721    |   90249 K  |   90249 K  |
|       from large pool |       2    |     311    |   43966 K  |   43966 K  |
|       from small pool |       0    |    3533    |   46283 K  |   46283 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      59    |     148    |     148    |      89    |
|       from large pool |      36    |     116    |     116    |      80    |
|       from small pool |      23    |      32    |      32    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |    1422    |   52937 K  |   52937 K  |
|       from large pool |       1    |     115    |   35167 K  |   35167 K  |
|       from small pool |       0    |    1390    |   17770 K  |   17770 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3644 MiB |    921 TiB |    921 TiB |
|       from large pool |  16640 KiB |   3611 MiB |    915 TiB |    915 TiB |
|       from small pool |      0 KiB |     57 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3644 MiB |    921 TiB |    921 TiB |
|       from large pool |  16640 KiB |   3611 MiB |    915 TiB |    915 TiB |
|       from small pool |      0 KiB |     57 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3642 MiB |    920 TiB |    920 TiB |
|       from large pool |  16640 KiB |   3608 MiB |    914 TiB |    914 TiB |
|       from small pool |      0 KiB |     56 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    970 MiB |   4034 MiB |   4034 MiB |   3064 MiB |
|       from large pool |    924 MiB |   3970 MiB |   3970 MiB |   3046 MiB |
|       from small pool |     46 MiB |     64 MiB |     64 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   3840 KiB | 643599 KiB | 539105 GiB | 539105 GiB |
|       from large pool |   3840 KiB | 636880 KiB | 532519 GiB | 532519 GiB |
|       from small pool |      0 KiB |  19804 KiB |   6585 GiB |   6585 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3721    |   90249 K  |   90249 K  |
|       from large pool |       2    |     311    |   43966 K  |   43966 K  |
|       from small pool |       0    |    3533    |   46283 K  |   46283 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3721    |   90249 K  |   90249 K  |
|       from large pool |       2    |     311    |   43966 K  |   43966 K  |
|       from small pool |       0    |    3533    |   46283 K  |   46283 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      59    |     148    |     148    |      89    |
|       from large pool |      36    |     116    |     116    |      80    |
|       from small pool |      23    |      32    |      32    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |    1422    |   52937 K  |   52937 K  |
|       from large pool |       1    |     115    |   35167 K  |   35167 K  |
|       from small pool |       0    |    1390    |   17770 K  |   17770 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_22_40_42_seed_1_20863195

 Experiment start at: 2024-05-26 22:40:42.140969
before training, model accuracy: 0.181115061044693
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9627509, 'precision': 0.72721803, 'recall': 0.8819325, 'specificity': 0.8819325, 'f1': 0.7823316, 'auroc': 0.95507044, 'binary_precision': 0.46156943, 'binary_recall': 0.79542303, 'binary_specificity': 0.9684419, 'binary_f1_score': 0.5841609}
confusion matrix:
       0     1
0  41060  1338
1    295  1147
---- Validation: 
scalar performance:
{'acc': 0.96318036, 'precision': 0.7407607, 'recall': 0.8535868, 'specificity': 0.8535868, 'f1': 0.7850059, 'auroc': 0.95438457, 'binary_precision': 0.4915591, 'binary_recall': 0.7355126, 'binary_specificity': 0.97166103, 'binary_f1_score': 0.5892857}
confusion matrix:
       0    1
0  17555  512
1    178  495
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96809536, 'precision': 0.796065, 'recall': 0.8307142, 'specificity': 0.8307142, 'f1': 0.81230474, 'auroc': 0.9338974, 'binary_precision': 0.6061644, 'binary_recall': 0.6807692, 'binary_specificity': 0.98065925, 'binary_f1_score': 0.6413043}
confusion matrix:
      0    1
0  5831  115
1    83  177
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863195.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-26 23:01:29.841869,epoch time: 0:20:47.700900,used: 0:20:47.700900,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_22_40_42_seed_1_20863195
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.967906, 'precision': 0.7487917, 'recall': 0.8166033, 'specificity': 0.8166033, 'f1': 0.7781579, 'auroc': 0.96118766, 'binary_precision': 0.5094441, 'binary_recall': 0.65464634, 'binary_specificity': 0.9785603, 'binary_f1_score': 0.5729894}
confusion matrix:
       0    1
0  41489  909
1    498  944
---- Validation: 
scalar performance:
{'acc': 0.96526146, 'precision': 0.75002193, 'recall': 0.8224791, 'specificity': 0.8224791, 'f1': 0.78107584, 'auroc': 0.95807993, 'binary_precision': 0.5125285, 'binary_recall': 0.6686478, 'binary_specificity': 0.9763104, 'binary_f1_score': 0.58027077}
confusion matrix:
       0    1
0  17639  428
1    223  450
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9761521, 'precision': 0.8913184, 'recall': 0.7834271, 'specificity': 0.7834271, 'f1': 0.82789654, 'auroc': 0.9457512, 'binary_precision': 0.8010753, 'binary_recall': 0.5730769, 'binary_specificity': 0.99377733, 'binary_f1_score': 0.66816145}
confusion matrix:
      0    1
0  5909   37
1   111  149
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863195.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-05-26 23:21:20.507156,epoch time: 0:19:50.665287,used: 0:40:38.366187,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_22_40_42_seed_1_20863195
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96710765, 'precision': 0.48355383, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4916394, 'auroc': 0.9644736, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42398  0
1   1442  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.9579847, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.94899976, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863195.png
early stop counter: 1
val acc:0.9640874862670898, best validation acc: 0.9652614593505859, corresponding to test acc:                         0.9761521220207214 / 0.9761521220207214
after epoch: 3,now: 2024-05-26 23:41:12.845644,epoch time: 0:19:52.338488,used: 1:00:30.704675,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_22_40_42_seed_1_20863195
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9671305, 'precision': 0.48356524, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49164534, 'auroc': 0.71690476, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42399  0
1   1441  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.7822556, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.6555952, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863195.png
early stop counter: 2
val acc:0.9640874862670898, best validation acc: 0.9652614593505859, corresponding to test acc:                         0.9761521220207214 / 0.9761521220207214
after epoch: 4,now: 2024-05-27 00:00:50.062766,epoch time: 0:19:37.217122,used: 1:20:07.921797,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_22_40_42_seed_1_20863195
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9721031, 'precision': 0.8041993, 'recall': 0.67933047, 'specificity': 0.67933047, 'f1': 0.7242847, 'auroc': 0.9665731, 'binary_precision': 0.6296296, 'binary_recall': 0.36597222, 'binary_specificity': 0.99268866, 'binary_f1_score': 0.46288976}
confusion matrix:
       0    1
0  42090  310
1    913  527
---- Validation: 
scalar performance:
{'acc': 0.96921027, 'precision': 0.8471562, 'recall': 0.61423844, 'specificity': 0.61423844, 'f1': 0.6675936, 'auroc': 0.95775056, 'binary_precision': 0.7222222, 'binary_recall': 0.23179792, 'binary_specificity': 0.996679, 'binary_f1_score': 0.3509561}
confusion matrix:
       0    1
0  18007   60
1    517  156
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96455044, 'precision': 0.9821602, 'recall': 0.5769231, 'specificity': 0.5769231, 'f1': 0.6242515, 'auroc': 0.9403702, 'binary_precision': 1.0, 'binary_recall': 0.15384616, 'binary_specificity': 1.0, 'binary_f1_score': 0.26666668}
confusion matrix:
      0   1
0  5946   0
1   220  40
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863195.png
better model found
persisted
after epoch: 5,now: 2024-05-27 00:20:31.851635,epoch time: 0:19:41.788869,used: 1:39:49.710666,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_22_40_42_seed_1_20863195
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97151005, 'precision': 0.9311062, 'recall': 0.5756705, 'specificity': 0.5756705, 'f1': 0.62255394, 'auroc': 0.97338784, 'binary_precision': 0.8902439, 'binary_recall': 0.15197779, 'binary_specificity': 0.9993632, 'binary_f1_score': 0.25963247}
confusion matrix:
       0    1
0  42372   27
1   1222  219
---- Validation: 
scalar performance:
{'acc': 0.9686766, 'precision': 0.9732052, 'recall': 0.56532353, 'specificity': 0.56532353, 'f1': 0.6073406, 'auroc': 0.9641348, 'binary_precision': 0.9777778, 'binary_recall': 0.1307578, 'binary_specificity': 0.9998893, 'binary_f1_score': 0.23066841}
confusion matrix:
       0   1
0  18065   2
1    585  88
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.94946456, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863195.png
early stop counter: 1
val acc:0.9686766266822815, best validation acc: 0.9692102670669556, corresponding to test acc:                         0.9645504355430603 / 0.9761521220207214
after epoch: 6,now: 2024-05-27 00:40:14.196311,epoch time: 0:19:42.344676,used: 1:59:32.055342,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_22_40_42_seed_1_20863195
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9700274, 'precision': 0.81197685, 'recall': 0.5933393, 'specificity': 0.5933393, 'f1': 0.6394978, 'auroc': 0.96728253, 'binary_precision': 0.65083134, 'binary_recall': 0.19014573, 'binary_specificity': 0.9965329, 'binary_f1_score': 0.2943072}
confusion matrix:
       0    1
0  42252  147
1   1167  274
---- Validation: 
scalar performance:
{'acc': 0.9667556, 'precision': 0.8519591, 'recall': 0.55717456, 'specificity': 0.55717456, 'f1': 0.59164083, 'auroc': 0.96266913, 'binary_precision': 0.7358491, 'binary_recall': 0.11589896, 'binary_specificity': 0.9984502, 'binary_f1_score': 0.20025674}
confusion matrix:
       0   1
0  18039  28
1    595  78
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95987755, 'precision': 0.8612273, 'recall': 0.5303488, 'specificity': 0.5303488, 'f1': 0.5466766, 'auroc': 0.9530483, 'binary_precision': 0.7619048, 'binary_recall': 0.06153846, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.113879}
confusion matrix:
      0   1
0  5941   5
1   244  16
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863195.png
early stop counter: 2
val acc:0.9667556285858154, best validation acc: 0.9692102670669556, corresponding to test acc:                         0.9645504355430603 / 0.9761521220207214
after epoch: 7,now: 2024-05-27 00:59:49.144112,epoch time: 0:19:34.947801,used: 2:19:07.003143,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_22_40_42_seed_1_20863195
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97912866, 'precision': 0.8805064, 'recall': 0.75323695, 'specificity': 0.75323695, 'f1': 0.8031333, 'auroc': 0.9759065, 'binary_precision': 0.7774262, 'binary_recall': 0.5114504, 'binary_specificity': 0.9950235, 'binary_f1_score': 0.6169946}
confusion matrix:
       0    1
0  42188  211
1    704  737
---- Validation: 
scalar performance:
{'acc': 0.9754002, 'precision': 0.9108746, 'recall': 0.69183654, 'specificity': 0.69183654, 'f1': 0.75872046, 'auroc': 0.9705566, 'binary_precision': 0.84415585, 'binary_recall': 0.38632986, 'binary_specificity': 0.99734324, 'binary_f1_score': 0.5300714}
confusion matrix:
       0    1
0  18019   48
1    413  260
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590719, 'precision': 0.774675, 'recall': 0.5372843, 'specificity': 0.5372843, 'f1': 0.5575469, 'auroc': 0.9590411, 'binary_precision': 0.5882353, 'binary_recall': 0.07692308, 'binary_specificity': 0.9976455, 'binary_f1_score': 0.13605443}
confusion matrix:
      0   1
0  5932  14
1   240  20
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863195.png
better model found
persisted
after epoch: 8,now: 2024-05-27 01:19:35.907290,epoch time: 0:19:46.763178,used: 2:38:53.766321,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_22_40_42_seed_1_20863195
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9815465, 'precision': 0.85546803, 'recall': 0.8538008, 'specificity': 0.8538008, 'f1': 0.85463226, 'auroc': 0.9800111, 'binary_precision': 0.7205575, 'binary_recall': 0.7170596, 'binary_specificity': 0.990542, 'binary_f1_score': 0.7188043}
confusion matrix:
       0     1
0  41997   401
1    408  1034
---- Validation: 
scalar performance:
{'acc': 0.97982925, 'precision': 0.8817496, 'recall': 0.80356944, 'specificity': 0.80356944, 'f1': 0.8378132, 'auroc': 0.97267663, 'binary_precision': 0.7777778, 'binary_recall': 0.6136701, 'binary_specificity': 0.99346876, 'binary_f1_score': 0.6860465}
confusion matrix:
       0    1
0  17949  118
1    260  413
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590719, 'precision': 0.81329453, 'recall': 0.5225724, 'specificity': 0.5225724, 'f1': 0.532699, 'auroc': 0.95244104, 'binary_precision': 0.6666667, 'binary_recall': 0.046153847, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.086330935}
confusion matrix:
      0   1
0  5940   6
1   248  12
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863195.png
better model found
persisted
after epoch: 9,now: 2024-05-27 01:39:31.198497,epoch time: 0:19:55.291207,used: 2:58:49.057528,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_22_40_42_seed_1_20863195
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9817746, 'precision': 0.8726859, 'recall': 0.8242047, 'specificity': 0.8242047, 'f1': 0.8466208, 'auroc': 0.9806079, 'binary_precision': 0.75701684, 'binary_recall': 0.65555555, 'binary_specificity': 0.99285376, 'binary_f1_score': 0.7026423}
confusion matrix:
       0    1
0  42097  303
1    496  944
---- Validation: 
scalar performance:
{'acc': 0.97950906, 'precision': 0.8844303, 'recall': 0.7933897, 'specificity': 0.7933897, 'f1': 0.83227384, 'auroc': 0.97212183, 'binary_precision': 0.78389, 'binary_recall': 0.59286773, 'binary_specificity': 0.99391156, 'binary_f1_score': 0.67512685}
confusion matrix:
       0    1
0  17957  110
1    274  399
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584273, 'precision': 0.7919289, 'recall': 0.5093631, 'specificity': 0.5093631, 'f1': 0.50803417, 'auroc': 0.94944537, 'binary_precision': 0.625, 'binary_recall': 0.01923077, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.03731343}
confusion matrix:
      0  1
0  5943  3
1   255  5
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863195.png
early stop counter: 1
val acc:0.9795090556144714, best validation acc: 0.9798292517662048, corresponding to test acc:                         0.9590718746185303 / 0.9761521220207214
after epoch: 10,now: 2024-05-27 01:59:29.184721,epoch time: 0:19:57.986224,used: 3:18:47.043752,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_22_40_42_seed_1_20863195
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98195714, 'precision': 0.87967587, 'recall': 0.8175038, 'specificity': 0.8175038, 'f1': 0.84559536, 'auroc': 0.98320466, 'binary_precision': 0.7714762, 'binary_recall': 0.6414702, 'binary_specificity': 0.9935374, 'binary_f1_score': 0.7004922}
confusion matrix:
       0    1
0  42124  274
1    517  925
---- Validation: 
scalar performance:
{'acc': 0.97950906, 'precision': 0.9032966, 'recall': 0.7712164, 'specificity': 0.7712164, 'f1': 0.82329094, 'auroc': 0.9752323, 'binary_precision': 0.8232662, 'binary_recall': 0.5468053, 'binary_specificity': 0.9956274, 'binary_f1_score': 0.6571428}
confusion matrix:
       0    1
0  17988   79
1    305  368
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9577828, 'precision': 0.71862733, 'recall': 0.53661156, 'specificity': 0.53661156, 'f1': 0.55540764, 'auroc': 0.962587, 'binary_precision': 0.47619048, 'binary_recall': 0.07692308, 'binary_specificity': 0.99630004, 'binary_f1_score': 0.13245033}
confusion matrix:
      0   1
0  5924  22
1   240  20
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863195.png
early stop counter: 2
val acc:0.9795090556144714, best validation acc: 0.9798292517662048, corresponding to test acc:                         0.9590718746185303 / 0.9761521220207214
after epoch: 11,now: 2024-05-27 02:19:30.488465,epoch time: 0:20:01.303744,used: 3:38:48.347496,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_22_40_42_seed_1_20863195
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9802007, 'precision': 0.8368156, 'recall': 0.86650294, 'specificity': 0.86650294, 'f1': 0.8509747, 'auroc': 0.9837855, 'binary_precision': 0.682338, 'binary_recall': 0.7447989, 'binary_specificity': 0.988207, 'binary_f1_score': 0.7122016}
confusion matrix:
       0     1
0  41898   500
1    368  1074
---- Validation: 
scalar performance:
{'acc': 0.9807898, 'precision': 0.8680949, 'recall': 0.8469836, 'specificity': 0.8469836, 'f1': 0.8571986, 'auroc': 0.973753, 'binary_precision': 0.74723536, 'binary_recall': 0.70282316, 'binary_specificity': 0.99114406, 'binary_f1_score': 0.72434914}
confusion matrix:
       0    1
0  17907  160
1    200  473
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9548824, 'precision': 0.5824454, 'recall': 0.5111911, 'specificity': 0.5111911, 'f1': 0.5122565, 'auroc': 0.9462436, 'binary_precision': 0.20588236, 'binary_recall': 0.026923077, 'binary_specificity': 0.99545914, 'binary_f1_score': 0.04761905}
confusion matrix:
      0   1
0  5919  27
1   253   7
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863195.png
better model found
persisted
after epoch: 12,now: 2024-05-27 02:39:26.748850,epoch time: 0:19:56.260385,used: 3:58:44.607881,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_22_40_42_seed_1_20863195
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.97445256, 'precision': 0.9339537, 'recall': 0.6263882, 'specificity': 0.6263882, 'f1': 0.6910995, 'auroc': 0.9798478, 'binary_precision': 0.8926829, 'binary_recall': 0.25381416, 'binary_specificity': 0.9989622, 'binary_f1_score': 0.3952484}
confusion matrix:
       0    1
0  42354   44
1   1076  366
---- Validation: 
scalar performance:
{'acc': 0.97129136, 'precision': 0.9592542, 'recall': 0.6060193, 'specificity': 0.6060193, 'f1': 0.66620517, 'auroc': 0.96696305, 'binary_precision': 0.9470199, 'binary_recall': 0.21248142, 'binary_specificity': 0.9995572, 'binary_f1_score': 0.34708738}
confusion matrix:
       0    1
0  18059    8
1    530  143
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.952458, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863195.png
early stop counter: 1
val acc:0.9712913632392883, best validation acc: 0.9807897806167603, corresponding to test acc:                         0.9548823833465576 / 0.9761521220207214
after epoch: 13,now: 2024-05-27 02:59:17.986378,epoch time: 0:19:51.237528,used: 4:18:35.845409,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_22_40_42_seed_1_20863195
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.983531, 'precision': 0.8812065, 'recall': 0.8504725, 'specificity': 0.8504725, 'f1': 0.8651409, 'auroc': 0.985902, 'binary_precision': 0.77231467, 'binary_recall': 0.7080444, 'binary_specificity': 0.9929006, 'binary_f1_score': 0.7387844}
confusion matrix:
       0     1
0  42097   301
1    421  1021
---- Validation: 
scalar performance:
{'acc': 0.980683, 'precision': 0.9053595, 'recall': 0.79042214, 'specificity': 0.79042214, 'f1': 0.8376265, 'auroc': 0.9725167, 'binary_precision': 0.8259958, 'binary_recall': 0.5854383, 'binary_specificity': 0.995406, 'binary_f1_score': 0.6852173}
confusion matrix:
       0    1
0  17984   83
1    279  394
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.7305384, 'recall': 0.53677976, 'specificity': 0.53677976, 'f1': 0.55593354, 'auroc': 0.9478859, 'binary_precision': 0.5, 'binary_recall': 0.07692308, 'binary_specificity': 0.9966364, 'binary_f1_score': 0.13333334}
confusion matrix:
      0   1
0  5926  20
1   240  20
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863195.png
early stop counter: 2
val acc:0.9806830286979675, best validation acc: 0.9807897806167603, corresponding to test acc:                         0.9548823833465576 / 0.9761521220207214
after epoch: 14,now: 2024-05-27 03:19:10.371294,epoch time: 0:19:52.384916,used: 4:38:28.230325,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_22_40_42_seed_1_20863195
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.982208, 'precision': 0.8979392, 'recall': 0.7978716, 'specificity': 0.7978716, 'f1': 0.84016603, 'auroc': 0.983283, 'binary_precision': 0.8093458, 'binary_recall': 0.60055476, 'binary_specificity': 0.9951885, 'binary_f1_score': 0.68949044}
confusion matrix:
       0    1
0  42194  204
1    576  866
---- Validation: 
scalar performance:
{'acc': 0.97785485, 'precision': 0.9375074, 'recall': 0.7159981, 'specificity': 0.7159981, 'f1': 0.7866044, 'auroc': 0.9716919, 'binary_precision': 0.8957055, 'binary_recall': 0.43387815, 'binary_specificity': 0.9981181, 'binary_f1_score': 0.5845846}
confusion matrix:
       0    1
0  18033   34
1    381  292
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9585885, 'precision': 0.83657503, 'recall': 0.5094472, 'specificity': 0.5094472, 'f1': 0.5081461, 'auroc': 0.9490944, 'binary_precision': 0.71428573, 'binary_recall': 0.01923077, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.037453186}
confusion matrix:
      0  1
0  5944  2
1   255  5
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863195.png
early stop counter: 3
val acc:0.97785484790802, best validation acc: 0.9807897806167603, corresponding to test acc:                         0.9548823833465576 / 0.9761521220207214
after epoch: 15,now: 2024-05-27 03:39:03.004762,epoch time: 0:19:52.633468,used: 4:58:20.863793,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_22_40_42_seed_1_20863195
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.98380476, 'precision': 0.88354635, 'recall': 0.8526237, 'specificity': 0.8526237, 'f1': 0.8673823, 'auroc': 0.9877112, 'binary_precision': 0.77685326, 'binary_recall': 0.7122053, 'binary_specificity': 0.9930421, 'binary_f1_score': 0.7431259}
confusion matrix:
       0     1
0  42103   295
1    415  1027
---- Validation: 
scalar performance:
{'acc': 0.98175025, 'precision': 0.9140402, 'recall': 0.80027413, 'specificity': 0.80027413, 'f1': 0.8473685, 'auroc': 0.9783194, 'binary_precision': 0.8426501, 'binary_recall': 0.6047548, 'binary_specificity': 0.99579346, 'binary_f1_score': 0.7041523}
confusion matrix:
       0    1
0  17991   76
1    266  407
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96036094, 'precision': 0.9053589, 'recall': 0.53244, 'specificity': 0.53244, 'f1': 0.5505758, 'auroc': 0.95741075, 'binary_precision': 0.85, 'binary_recall': 0.06538462, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.12142858}
confusion matrix:
      0   1
0  5943   3
1   243  17
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863195.png
better model found
persisted
after epoch: 16,now: 2024-05-27 03:58:43.741944,epoch time: 0:19:40.737182,used: 5:18:01.600975,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_22_40_42_seed_1_20863195
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98478556, 'precision': 0.89016825, 'recall': 0.8631792, 'specificity': 0.8631792, 'f1': 0.87615097, 'auroc': 0.98747325, 'binary_precision': 0.7893951, 'binary_recall': 0.7330097, 'binary_specificity': 0.9933487, 'binary_f1_score': 0.76015824}
confusion matrix:
       0     1
0  42116   282
1    385  1057
---- Validation: 
scalar performance:
{'acc': 0.9811099, 'precision': 0.8966909, 'recall': 0.8085252, 'specificity': 0.8085252, 'f1': 0.8466324, 'auroc': 0.97507477, 'binary_precision': 0.8073218, 'binary_recall': 0.6225854, 'binary_specificity': 0.99446505, 'binary_f1_score': 0.70302016}
confusion matrix:
       0    1
0  17967  100
1    254  419
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96036094, 'precision': 0.7883852, 'recall': 0.57105875, 'specificity': 0.57105875, 'f1': 0.60783875, 'auroc': 0.952626, 'binary_precision': 0.61290324, 'binary_recall': 0.14615385, 'binary_specificity': 0.9959637, 'binary_f1_score': 0.23602484}
confusion matrix:
      0   1
0  5922  24
1   222  38
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863195.png
early stop counter: 1
val acc:0.9811099171638489, best validation acc: 0.9817502498626709, corresponding to test acc:                         0.9603609442710876 / 0.9761521220207214
after epoch: 17,now: 2024-05-27 04:18:26.874128,epoch time: 0:19:43.132184,used: 5:37:44.733159,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_22_40_42_seed_1_20863195
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98396444, 'precision': 0.8774873, 'recall': 0.867109, 'specificity': 0.867109, 'f1': 0.87221974, 'auroc': 0.9874031, 'binary_precision': 0.7637402, 'binary_recall': 0.74202496, 'binary_specificity': 0.99219304, 'binary_f1_score': 0.75272596}
confusion matrix:
       0     1
0  42067   331
1    372  1070
---- Validation: 
scalar performance:
{'acc': 0.97982925, 'precision': 0.885324, 'recall': 0.7985625, 'specificity': 0.7985625, 'f1': 0.8359684, 'auroc': 0.97630465, 'binary_precision': 0.7852998, 'binary_recall': 0.6032689, 'binary_specificity': 0.9938562, 'binary_f1_score': 0.68235296}
confusion matrix:
       0    1
0  17956  111
1    267  406
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96100545, 'precision': 0.7842191, 'recall': 0.59897995, 'specificity': 0.59897995, 'f1': 0.642269, 'auroc': 0.95430243, 'binary_precision': 0.60227275, 'binary_recall': 0.20384616, 'binary_specificity': 0.9941137, 'binary_f1_score': 0.3045977}
confusion matrix:
      0   1
0  5911  35
1   207  53
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863195.png
early stop counter: 2
val acc:0.9798292517662048, best validation acc: 0.9817502498626709, corresponding to test acc:                         0.9603609442710876 / 0.9761521220207214
after epoch: 18,now: 2024-05-27 04:38:13.228974,epoch time: 0:19:46.354846,used: 5:57:31.088005,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_22_40_42_seed_1_20863195
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9841469, 'precision': 0.87350976, 'recall': 0.8792615, 'specificity': 0.8792615, 'f1': 0.8763617, 'auroc': 0.98764086, 'binary_precision': 0.7549488, 'binary_recall': 0.7669903, 'binary_specificity': 0.9915326, 'binary_f1_score': 0.7609219}
confusion matrix:
       0     1
0  42039   359
1    336  1106
---- Validation: 
scalar performance:
{'acc': 0.98313767, 'precision': 0.9010757, 'recall': 0.8410486, 'specificity': 0.8410486, 'f1': 0.8684257, 'auroc': 0.97720635, 'binary_precision': 0.81370825, 'binary_recall': 0.6879643, 'binary_specificity': 0.99413294, 'binary_f1_score': 0.7455717}
confusion matrix:
       0    1
0  17961  106
1    210  463
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9574605, 'precision': 0.71565145, 'recall': 0.55483323, 'specificity': 0.55483323, 'f1': 0.58167267, 'auroc': 0.9510448, 'binary_precision': 0.46875, 'binary_recall': 0.115384616, 'binary_specificity': 0.9942819, 'binary_f1_score': 0.18518518}
confusion matrix:
      0   1
0  5912  34
1   230  30
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863195.png
better model found
persisted
after epoch: 19,now: 2024-05-27 04:58:08.570098,epoch time: 0:19:55.341124,used: 6:17:26.429129,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_22_40_42_seed_1_20863195
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.98585767, 'precision': 0.873515, 'recall': 0.92033964, 'specificity': 0.92033964, 'f1': 0.8954246, 'auroc': 0.99078614, 'binary_precision': 0.75214726, 'binary_recall': 0.85020804, 'binary_specificity': 0.99047124, 'binary_f1_score': 0.7981771}
confusion matrix:
       0     1
0  41994   404
1    216  1226
---- Validation: 
scalar performance:
{'acc': 0.9838314, 'precision': 0.8970642, 'recall': 0.8600054, 'specificity': 0.8600054, 'f1': 0.8775478, 'auroc': 0.9817692, 'binary_precision': 0.8042763, 'binary_recall': 0.7265973, 'binary_specificity': 0.9934134, 'binary_f1_score': 0.76346606}
confusion matrix:
       0    1
0  17948  119
1    184  489
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96084434, 'precision': 0.8064284, 'recall': 0.5694721, 'specificity': 0.5694721, 'f1': 0.6066738, 'auroc': 0.96610796, 'binary_precision': 0.64912283, 'binary_recall': 0.1423077, 'binary_specificity': 0.9966364, 'binary_f1_score': 0.23343849}
confusion matrix:
      0   1
0  5926  20
1   223  37
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863195.png
better model found
persisted
after epoch: 20,now: 2024-05-27 05:18:00.496483,epoch time: 0:19:51.926385,used: 6:37:18.355514,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_22_40_42_seed_1_20863195
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.98674726, 'precision': 0.9124303, 'recall': 0.8705574, 'specificity': 0.8705574, 'f1': 0.8902868, 'auroc': 0.9908545, 'binary_precision': 0.8334624, 'binary_recall': 0.74618584, 'binary_specificity': 0.994929, 'binary_f1_score': 0.78741306}
confusion matrix:
       0     1
0  42183   215
1    366  1076
---- Validation: 
scalar performance:
{'acc': 0.98281753, 'precision': 0.91380394, 'recall': 0.81942457, 'specificity': 0.81942457, 'f1': 0.86004186, 'auroc': 0.9791665, 'binary_precision': 0.8407767, 'binary_recall': 0.6433878, 'binary_specificity': 0.99546134, 'binary_f1_score': 0.7289562}
confusion matrix:
       0    1
0  17985   82
1    240  433
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597164, 'precision': 0.93823326, 'recall': 0.52106977, 'specificity': 0.52106977, 'f1': 0.5301446, 'auroc': 0.956, 'binary_precision': 0.9166667, 'binary_recall': 0.042307694, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.080882356}
confusion matrix:
      0   1
0  5945   1
1   249  11
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863195.png
early stop counter: 1
val acc:0.982817530632019, best validation acc: 0.9838314056396484, corresponding to test acc:                         0.9608443379402161 / 0.9761521220207214
after epoch: 21,now: 2024-05-27 05:37:54.404086,epoch time: 0:19:53.907603,used: 6:57:12.263117,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_22_40_42_seed_1_20863195
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.98651916, 'precision': 0.90028906, 'recall': 0.8833451, 'specificity': 0.8833451, 'f1': 0.8916191, 'auroc': 0.9912351, 'binary_precision': 0.80827886, 'binary_recall': 0.7729167, 'binary_specificity': 0.9937736, 'binary_f1_score': 0.7902023}
confusion matrix:
       0     1
0  42136   264
1    327  1113
---- Validation: 
scalar performance:
{'acc': 0.98329777, 'precision': 0.90995204, 'recall': 0.83254844, 'specificity': 0.83254844, 'f1': 0.8668779, 'auroc': 0.9763411, 'binary_precision': 0.8321033, 'binary_recall': 0.6701337, 'binary_specificity': 0.99496317, 'binary_f1_score': 0.74238676}
confusion matrix:
       0    1
0  17976   91
1    222  451
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9643893, 'precision': 0.9099585, 'recall': 0.5897119, 'specificity': 0.5897119, 'f1': 0.64007187, 'auroc': 0.9507235, 'binary_precision': 0.8545455, 'binary_recall': 0.18076923, 'binary_specificity': 0.99865454, 'binary_f1_score': 0.2984127}
confusion matrix:
      0   1
0  5938   8
1   213  47
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863195.png
early stop counter: 2
val acc:0.9832977652549744, best validation acc: 0.9838314056396484, corresponding to test acc:                         0.9608443379402161 / 0.9761521220207214
after epoch: 22,now: 2024-05-27 05:57:53.357296,epoch time: 0:19:58.953210,used: 7:17:11.216327,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_22_40_42_seed_1_20863195
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9825958, 'precision': 0.85263634, 'recall': 0.88869625, 'specificity': 0.88869625, 'f1': 0.86970997, 'auroc': 0.9859218, 'binary_precision': 0.71249217, 'binary_recall': 0.7881944, 'binary_specificity': 0.9891981, 'binary_f1_score': 0.7484338}
confusion matrix:
       0     1
0  41942   458
1    305  1135
---- Validation: 
scalar performance:
{'acc': 0.9782284, 'precision': 0.845539, 'recall': 0.8356415, 'specificity': 0.8356415, 'f1': 0.8405113, 'auroc': 0.96820986, 'binary_precision': 0.70290965, 'binary_recall': 0.6820208, 'binary_specificity': 0.98926216, 'binary_f1_score': 0.6923077}
confusion matrix:
       0    1
0  17873  194
1    214  459
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584273, 'precision': 0.7653655, 'recall': 0.51488006, 'specificity': 0.51488006, 'f1': 0.5185693, 'auroc': 0.9112576, 'binary_precision': 0.5714286, 'binary_recall': 0.03076923, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.05839416}
confusion matrix:
      0  1
0  5940  6
1   252  8
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863195.png
early stop counter: 3
val acc:0.9782283902168274, best validation acc: 0.9838314056396484, corresponding to test acc:                         0.9608443379402161 / 0.9761521220207214
after epoch: 23,now: 2024-05-27 06:17:56.089901,epoch time: 0:20:02.732605,used: 7:37:13.948932,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_22_40_42_seed_1_20863195
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9851962, 'precision': 0.86143714, 'recall': 0.9347353, 'specificity': 0.9347353, 'f1': 0.8944033, 'auroc': 0.99193776, 'binary_precision': 0.7269605, 'binary_recall': 0.8807212, 'binary_specificity': 0.98874944, 'binary_f1_score': 0.79648787}
confusion matrix:
       0     1
0  41921   477
1    172  1270
---- Validation: 
scalar performance:
{'acc': 0.98281753, 'precision': 0.87277913, 'recall': 0.8823681, 'specificity': 0.8823681, 'f1': 0.877507, 'auroc': 0.97627634, 'binary_precision': 0.75397974, 'binary_recall': 0.7741456, 'binary_specificity': 0.9905906, 'binary_f1_score': 0.76392967}
confusion matrix:
       0    1
0  17897  170
1    152  521
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95955527, 'precision': 0.77543366, 'recall': 0.5559264, 'specificity': 0.5559264, 'f1': 0.58609194, 'auroc': 0.93283737, 'binary_precision': 0.5882353, 'binary_recall': 0.115384616, 'binary_specificity': 0.9964682, 'binary_f1_score': 0.19292603}
confusion matrix:
      0   1
0  5925  21
1   230  30
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863195.png
early stop counter: 4
val acc:0.982817530632019, best validation acc: 0.9838314056396484, corresponding to test acc:                         0.9608443379402161 / 0.9761521220207214
after epoch: 24,now: 2024-05-27 06:38:05.965032,epoch time: 0:20:09.875131,used: 7:57:23.824063,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_22_40_42_seed_1_20863195
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9858805, 'precision': 0.90454316, 'recall': 0.8639879, 'specificity': 0.8639879, 'f1': 0.88311106, 'auroc': 0.9904059, 'binary_precision': 0.8181115, 'binary_recall': 0.73351836, 'binary_specificity': 0.9944574, 'binary_f1_score': 0.773509}
confusion matrix:
       0     1
0  42164   235
1    384  1057
---- Validation: 
scalar performance:
{'acc': 0.9808965, 'precision': 0.9017464, 'recall': 0.79840076, 'specificity': 0.79840076, 'f1': 0.8418171, 'auroc': 0.9796893, 'binary_precision': 0.8181818, 'binary_recall': 0.60178304, 'binary_specificity': 0.99501854, 'binary_f1_score': 0.6934931}
confusion matrix:
       0    1
0  17977   90
1    268  405
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582662, 'precision': 0.7393531, 'recall': 0.5258299, 'specificity': 0.5258299, 'f1': 0.53810006, 'auroc': 0.92657924, 'binary_precision': 0.5185185, 'binary_recall': 0.053846154, 'binary_specificity': 0.99781364, 'binary_f1_score': 0.09756097}
confusion matrix:
      0   1
0  5933  13
1   246  14
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863195.png
early stop counter: 5
val acc:0.9808964729309082, best validation acc: 0.9838314056396484, corresponding to test acc:                         0.9608443379402161 / 0.9761521220207214
after epoch: 25,now: 2024-05-27 06:58:05.197024,epoch time: 0:19:59.231992,used: 8:17:23.056055,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_22_40_42_seed_1_20863195
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.98423815, 'precision': 0.8522733, 'recall': 0.93624973, 'specificity': 0.93624973, 'f1': 0.88937104, 'auroc': 0.9928585, 'binary_precision': 0.70849526, 'binary_recall': 0.8848821, 'binary_specificity': 0.9876173, 'binary_f1_score': 0.7869257}
confusion matrix:
       0     1
0  41873   525
1    166  1276
---- Validation: 
scalar performance:
{'acc': 0.98249733, 'precision': 0.8578863, 'recall': 0.91081274, 'specificity': 0.91081274, 'f1': 0.88234484, 'auroc': 0.9812536, 'binary_precision': 0.72200775, 'binary_recall': 0.833581, 'binary_specificity': 0.9880445, 'binary_f1_score': 0.77379316}
confusion matrix:
       0    1
0  17851  216
1    112  561
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9548824, 'precision': 0.6886584, 'recall': 0.5847506, 'specificity': 0.5847506, 'f1': 0.6140386, 'auroc': 0.9533772, 'binary_precision': 0.4122807, 'binary_recall': 0.18076923, 'binary_specificity': 0.9887319, 'binary_f1_score': 0.2513369}
confusion matrix:
      0   1
0  5879  67
1   213  47
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863195.png
early stop counter: 6
val acc:0.9824973344802856, best validation acc: 0.9838314056396484, corresponding to test acc:                         0.9608443379402161 / 0.9761521220207214
after epoch: 26,now: 2024-05-27 07:18:19.596991,epoch time: 0:20:14.399967,used: 8:37:37.456022,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_22_40_42_seed_1_20863195
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9867701, 'precision': 0.9255737, 'recall': 0.8543922, 'specificity': 0.8543922, 'f1': 0.8864914, 'auroc': 0.9915533, 'binary_precision': 0.860855, 'binary_recall': 0.71269953, 'binary_specificity': 0.9960848, 'binary_f1_score': 0.77980256}
confusion matrix:
       0     1
0  42233   166
1    414  1027
---- Validation: 
scalar performance:
{'acc': 0.9829242, 'precision': 0.913535, 'recall': 0.8216257, 'specificity': 0.8216257, 'f1': 0.86136264, 'auroc': 0.9746562, 'binary_precision': 0.84007704, 'binary_recall': 0.64784545, 'binary_specificity': 0.995406, 'binary_f1_score': 0.7315436}
confusion matrix:
       0    1
0  17984   83
1    237  436
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96019983, 'precision': 0.78351796, 'recall': 0.57097465, 'specificity': 0.57097465, 'f1': 0.6074312, 'auroc': 0.9438571, 'binary_precision': 0.6031746, 'binary_recall': 0.14615385, 'binary_specificity': 0.9957955, 'binary_f1_score': 0.23529413}
confusion matrix:
      0   1
0  5921  25
1   222  38
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863195.png
early stop counter: 7
val acc:0.982924222946167, best validation acc: 0.9838314056396484, corresponding to test acc:                         0.9608443379402161 / 0.9761521220207214
after epoch: 27,now: 2024-05-27 07:38:36.505809,epoch time: 0:20:16.908818,used: 8:57:54.364840,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_22_40_42_seed_1_20863195
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9879334, 'precision': 0.89206344, 'recall': 0.9284467, 'specificity': 0.9284467, 'f1': 0.9093797, 'auroc': 0.994166, 'binary_precision': 0.7887413, 'binary_recall': 0.8647711, 'binary_specificity': 0.9921223, 'binary_f1_score': 0.8250082}
confusion matrix:
       0     1
0  42064   334
1    195  1247
---- Validation: 
scalar performance:
{'acc': 0.98399144, 'precision': 0.89131814, 'recall': 0.87224793, 'specificity': 0.87224793, 'f1': 0.8815234, 'auroc': 0.9805579, 'binary_precision': 0.7918623, 'binary_recall': 0.75185734, 'binary_specificity': 0.9926385, 'binary_f1_score': 0.77134144}
confusion matrix:
       0    1
0  17934  133
1    167  506
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9618111, 'precision': 0.8296441, 'recall': 0.5773325, 'specificity': 0.5773325, 'f1': 0.61872756, 'auroc': 0.94413453, 'binary_precision': 0.69491524, 'binary_recall': 0.15769231, 'binary_specificity': 0.99697274, 'binary_f1_score': 0.2570533}
confusion matrix:
      0   1
0  5928  18
1   219  41
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863195.png
better model found
persisted
after epoch: 28,now: 2024-05-27 07:58:55.364824,epoch time: 0:20:18.859015,used: 9:18:13.223855,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_22_40_42_seed_1_20863195
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9886633, 'precision': 0.91432333, 'recall': 0.9057127, 'specificity': 0.9057127, 'f1': 0.9099692, 'auroc': 0.9943205, 'binary_precision': 0.8348689, 'binary_recall': 0.81692094, 'binary_specificity': 0.99450445, 'binary_f1_score': 0.82579744}
confusion matrix:
       0     1
0  42165   233
1    264  1178
---- Validation: 
scalar performance:
{'acc': 0.98399144, 'precision': 0.9051024, 'recall': 0.85150516, 'specificity': 0.85150516, 'f1': 0.8762421, 'auroc': 0.9787383, 'binary_precision': 0.82099825, 'binary_recall': 0.7087667, 'binary_specificity': 0.9942436, 'binary_f1_score': 0.7607656}
confusion matrix:
       0    1
0  17963  104
1    196  477
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95939416, 'precision': 0.7545654, 'recall': 0.59262204, 'specificity': 0.59262204, 'f1': 0.63159764, 'auroc': 0.9532661, 'binary_precision': 0.54347825, 'binary_recall': 0.1923077, 'binary_specificity': 0.99293643, 'binary_f1_score': 0.2840909}
confusion matrix:
      0   1
0  5904  42
1   210  50
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863195.png
early stop counter: 1
val acc:0.9839914441108704, best validation acc: 0.9839914441108704, corresponding to test acc:                         0.9618111252784729 / 0.9761521220207214
after epoch: 29,now: 2024-05-27 08:19:25.104250,epoch time: 0:20:29.739426,used: 9:38:42.963281,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_22_40_42_seed_1_20863195
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9873175, 'precision': 0.95619756, 'recall': 0.834008, 'specificity': 0.834008, 'f1': 0.88500047, 'auroc': 0.9946123, 'binary_precision': 0.9235182, 'binary_recall': 0.6699029, 'binary_specificity': 0.9981131, 'binary_f1_score': 0.77652735}
confusion matrix:
       0    1
0  42318   80
1    476  966
---- Validation: 
scalar performance:
{'acc': 0.98057634, 'precision': 0.9193644, 'recall': 0.7746309, 'specificity': 0.7746309, 'f1': 0.83073616, 'auroc': 0.98057276, 'binary_precision': 0.8551724, 'binary_recall': 0.55274886, 'binary_specificity': 0.996513, 'binary_f1_score': 0.67148006}
confusion matrix:
       0    1
0  18004   63
1    301  372
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611666, 'precision': 0.7854358, 'recall': 0.602742, 'specificity': 0.602742, 'f1': 0.6467043, 'auroc': 0.95008993, 'binary_precision': 0.6043956, 'binary_recall': 0.21153846, 'binary_specificity': 0.99394554, 'binary_f1_score': 0.3133903}
confusion matrix:
      0   1
0  5910  36
1   205  55
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863195.png
early stop counter: 2
val acc:0.9805763363838196, best validation acc: 0.9839914441108704, corresponding to test acc:                         0.9618111252784729 / 0.9761521220207214
after epoch: 30,now: 2024-05-27 08:40:44.533844,epoch time: 0:21:19.429594,used: 10:00:02.392875,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_26_22_40_42_seed_1_20863195
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 10:00:02.392875 at 2024-05-27 08:40:44.533844
persisted model performance metric: 

scalar performance:
{'acc': 0.96310025, 'precision': 0.85567904, 'recall': 0.58903915, 'specificity': 0.58903915, 'f1': 0.6360394, 'auroc': 0.9479122, 'binary_precision': 0.74603176, 'binary_recall': 0.18076923, 'binary_specificity': 0.9973091, 'binary_f1_score': 0.2910217}
confusion matrix:
      0   1
0  5930  16
1   213  47
oracle model performance metric: 

scalar performance:
{'acc': 0.9776023, 'precision': 0.90986884, 'recall': 0.7860229, 'specificity': 0.7860229, 'f1': 0.8358809, 'auroc': 0.95659447, 'binary_precision': 0.83798885, 'binary_recall': 0.5769231, 'binary_specificity': 0.9951228, 'binary_f1_score': 0.68337125}
confusion matrix:
      0    1
0  5917   29
1   110  150
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs32/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs32/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 452563 KiB |   3644 MiB |   1842 TiB |   1842 TiB |
|       from large pool | 411470 KiB |   3611 MiB |   1830 TiB |   1830 TiB |
|       from small pool |  41093 KiB |     57 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 452563 KiB |   3644 MiB |   1842 TiB |   1842 TiB |
|       from large pool | 411470 KiB |   3611 MiB |   1830 TiB |   1830 TiB |
|       from small pool |  41093 KiB |     57 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447751 KiB |   3642 MiB |   1842 TiB |   1842 TiB |
|       from large pool | 407075 KiB |   3608 MiB |   1830 TiB |   1830 TiB |
|       from small pool |  40676 KiB |     56 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4084 MiB |   4084 MiB |   7148 MiB |   3064 MiB |
|       from large pool |   4020 MiB |   4020 MiB |   7066 MiB |   3046 MiB |
|       from small pool |     64 MiB |     64 MiB |     82 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 538668 KiB | 662353 KiB |   1029 TiB |   1029 TiB |
|       from large pool | 532658 KiB | 657915 KiB |   1016 TiB |   1016 TiB |
|       from small pool |   6010 KiB |  19804 KiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    2300    |    3725    |  180505 K  |  180503 K  |
|       from large pool |     187    |     311    |   87942 K  |   87942 K  |
|       from small pool |    2113    |    3537    |   92563 K  |   92561 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2300    |    3725    |  180505 K  |  180503 K  |
|       from large pool |     187    |     311    |   87942 K  |   87942 K  |
|       from small pool |    2113    |    3537    |   92563 K  |   92561 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     152    |     152    |     241    |      89    |
|       from large pool |     120    |     120    |     200    |      80    |
|       from small pool |      32    |      32    |      41    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      63    |    1425    |  105248 K  |  105248 K  |
|       from large pool |      33    |     120    |   69846 K  |   69846 K  |
|       from small pool |      30    |    1392    |   35401 K  |   35401 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3644 MiB |   1842 TiB |   1842 TiB |
|       from large pool |  16640 KiB |   3611 MiB |   1830 TiB |   1830 TiB |
|       from small pool |      0 KiB |     57 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3644 MiB |   1842 TiB |   1842 TiB |
|       from large pool |  16640 KiB |   3611 MiB |   1830 TiB |   1830 TiB |
|       from small pool |      0 KiB |     57 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3642 MiB |   1842 TiB |   1842 TiB |
|       from large pool |  16640 KiB |   3608 MiB |   1830 TiB |   1830 TiB |
|       from small pool |      0 KiB |     56 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    968 MiB |   4084 MiB |   7148 MiB |   6180 MiB |
|       from large pool |    922 MiB |   4020 MiB |   7066 MiB |   6144 MiB |
|       from small pool |     46 MiB |     64 MiB |     82 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   3840 KiB | 662353 KiB |   1029 TiB |   1029 TiB |
|       from large pool |   3840 KiB | 657915 KiB |   1016 TiB |   1016 TiB |
|       from small pool |      0 KiB |  20933 KiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3725    |  180505 K  |  180505 K  |
|       from large pool |       2    |     311    |   87942 K  |   87942 K  |
|       from small pool |       0    |    3537    |   92563 K  |   92563 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3725    |  180505 K  |  180505 K  |
|       from large pool |       2    |     311    |   87942 K  |   87942 K  |
|       from small pool |       0    |    3537    |   92563 K  |   92563 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      61    |     152    |     241    |     180    |
|       from large pool |      38    |     120    |     200    |     162    |
|       from small pool |      23    |      32    |      41    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |    1425    |  105248 K  |  105248 K  |
|       from large pool |       1    |     120    |   69846 K  |   69846 K  |
|       from small pool |       0    |    1392    |   35402 K  |   35402 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Mon May 27 08:42:43 2024]
Finished job 0.
1 of 1 steps (100%) done
