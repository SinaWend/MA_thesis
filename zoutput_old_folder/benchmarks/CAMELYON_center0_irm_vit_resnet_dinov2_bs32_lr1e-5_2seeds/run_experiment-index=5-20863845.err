Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Mon May 27 04:31:32 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs32/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs32/rule_results/5.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=5
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_04_41_24_seed_0_20863845

 Experiment start at: 2024-05-27 04:41:24.870508
before training, model accuracy: 0.955097496509552
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9692754, 'precision': 0.80604887, 'recall': 0.596306, 'specificity': 0.596306, 'f1': 0.6424324, 'auroc': 0.96078765, 'binary_precision': 0.6393805, 'binary_recall': 0.19646499, 'binary_specificity': 0.99614704, 'binary_f1_score': 0.300572}
confusion matrix:
       0    1
0  42142  163
1   1182  289
---- Validation: 
scalar performance:
{'acc': 0.9677522, 'precision': 0.7810799, 'recall': 0.591776, 'specificity': 0.591776, 'f1': 0.6344406, 'auroc': 0.9588993, 'binary_precision': 0.5902439, 'binary_recall': 0.1881804, 'binary_specificity': 0.99537164, 'binary_f1_score': 0.28537735}
confusion matrix:
       0    1
0  18065   84
1    522  121
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96612334, 'precision': 0.98292804, 'recall': 0.59386975, 'specificity': 0.59386975, 'f1': 0.6493802, 'auroc': 0.93803525, 'binary_precision': 1.0, 'binary_recall': 0.18773946, 'binary_specificity': 1.0, 'binary_f1_score': 0.31612903}
confusion matrix:
      0   1
0  5997   0
1   212  49
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863845.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-27 05:05:31.993080,epoch time: 0:24:07.122572,used: 0:24:07.122572,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_04_41_24_seed_0_20863845
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9774534, 'precision': 0.88711464, 'recall': 0.72080505, 'specificity': 0.72080505, 'f1': 0.7795528, 'auroc': 0.97731316, 'binary_precision': 0.79322857, 'binary_recall': 0.4456522, 'binary_specificity': 0.99595785, 'binary_f1_score': 0.5706829}
confusion matrix:
       0    1
0  42133  171
1    816  656
---- Validation: 
scalar performance:
{'acc': 0.9760004, 'precision': 0.89721215, 'recall': 0.69130325, 'specificity': 0.69130325, 'f1': 0.75572467, 'auroc': 0.9752063, 'binary_precision': 0.81578946, 'binary_recall': 0.38569206, 'binary_specificity': 0.99691445, 'binary_f1_score': 0.52375925}
confusion matrix:
       0    1
0  18093   56
1    395  248
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96180886, 'precision': 0.9808371, 'recall': 0.5421456, 'specificity': 0.5421456, 'f1': 0.56796986, 'auroc': 0.9589199, 'binary_precision': 1.0, 'binary_recall': 0.08429119, 'binary_specificity': 1.0, 'binary_f1_score': 0.15547703}
confusion matrix:
      0   1
0  5997   0
1   239  22
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863845.png
better model found
persisted
after epoch: 2,now: 2024-05-27 05:28:28.360549,epoch time: 0:22:56.367469,used: 0:47:03.490041,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_04_41_24_seed_0_20863845
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9781387, 'precision': 0.8836819, 'recall': 0.7385359, 'specificity': 0.7385359, 'f1': 0.79290855, 'auroc': 0.9793416, 'binary_precision': 0.7851606, 'binary_recall': 0.4816576, 'binary_specificity': 0.99541414, 'binary_f1_score': 0.59705263}
confusion matrix:
       0    1
0  42110  194
1    763  709
---- Validation: 
scalar performance:
{'acc': 0.9747233, 'precision': 0.87627363, 'recall': 0.6823914, 'specificity': 0.6823914, 'f1': 0.7432537, 'auroc': 0.97520375, 'binary_precision': 0.7745098, 'binary_recall': 0.36858475, 'binary_specificity': 0.9961981, 'binary_f1_score': 0.49947315}
confusion matrix:
       0    1
0  18080   69
1    406  237
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96580374, 'precision': 0.94670904, 'recall': 0.59736764, 'specificity': 0.59736764, 'f1': 0.6526219, 'auroc': 0.9645503, 'binary_precision': 0.92727274, 'binary_recall': 0.1954023, 'binary_specificity': 0.999333, 'binary_f1_score': 0.3227848}
confusion matrix:
      0   1
0  5993   4
1   210  51
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863845.png
early stop counter: 1
val acc:0.9747232794761658, best validation acc: 0.9760004281997681, corresponding to test acc:                         0.9618088603019714 / 0.9661233425140381
after epoch: 3,now: 2024-05-27 05:51:22.305978,epoch time: 0:22:53.945429,used: 1:09:57.435470,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_04_41_24_seed_0_20863845
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9803774, 'precision': 0.87136924, 'recall': 0.8033635, 'specificity': 0.8033635, 'f1': 0.8336562, 'auroc': 0.98393637, 'binary_precision': 0.7560771, 'binary_recall': 0.61360544, 'binary_specificity': 0.99312156, 'binary_f1_score': 0.67743146}
confusion matrix:
       0    1
0  42015  291
1    568  902
---- Validation: 
scalar performance:
{'acc': 0.9813218, 'precision': 0.87225306, 'recall': 0.8313183, 'specificity': 0.8313183, 'f1': 0.8504921, 'auroc': 0.9766153, 'binary_precision': 0.75614035, 'binary_recall': 0.6702955, 'binary_specificity': 0.99234116, 'binary_f1_score': 0.71063477}
confusion matrix:
       0    1
0  18010  139
1    212  431
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9683605, 'precision': 0.9390949, 'recall': 0.633516, 'specificity': 0.633516, 'f1': 0.69897115, 'auroc': 0.9612694, 'binary_precision': 0.90909094, 'binary_recall': 0.26819924, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.41420117}
confusion matrix:
      0   1
0  5990   7
1   191  70
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863845.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-05-27 06:14:15.768783,epoch time: 0:22:53.462805,used: 1:32:50.898275,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_04_41_24_seed_0_20863845
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9774077, 'precision': 0.91547155, 'recall': 0.6975037, 'specificity': 0.6975037, 'f1': 0.76516795, 'auroc': 0.9841479, 'binary_precision': 0.8515284, 'binary_recall': 0.39741847, 'binary_specificity': 0.9975889, 'binary_f1_score': 0.54191756}
confusion matrix:
       0    1
0  42202  102
1    887  585
---- Validation: 
scalar performance:
{'acc': 0.9777033, 'precision': 0.9182238, 'recall': 0.707936, 'specificity': 0.707936, 'f1': 0.7753669, 'auroc': 0.9763472, 'binary_precision': 0.8566879, 'binary_recall': 0.41835147, 'binary_specificity': 0.9975205, 'binary_f1_score': 0.5621734}
confusion matrix:
       0    1
0  18104   45
1    374  269
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96276766, 'precision': 0.96470773, 'recall': 0.5554722, 'specificity': 0.5554722, 'f1': 0.5901267, 'auroc': 0.94976753, 'binary_precision': 0.96666664, 'binary_recall': 0.11111111, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.19931272}
confusion matrix:
      0   1
0  5996   1
1   232  29
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863845.png
early stop counter: 1
val acc:0.9777032732963562, best validation acc: 0.9813218116760254, corresponding to test acc:                         0.9683604836463928 / 0.9683604836463928
after epoch: 5,now: 2024-05-27 06:37:12.329718,epoch time: 0:22:56.560935,used: 1:55:47.459210,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_04_41_24_seed_0_20863845
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98444355, 'precision': 0.92059493, 'recall': 0.8223309, 'specificity': 0.8223309, 'f1': 0.8644744, 'auroc': 0.9896241, 'binary_precision': 0.85330945, 'binary_recall': 0.6485384, 'binary_specificity': 0.9961234, 'binary_f1_score': 0.7369641}
confusion matrix:
       0    1
0  42141  164
1    517  954
---- Validation: 
scalar performance:
{'acc': 0.9829715, 'precision': 0.91197306, 'recall': 0.8096707, 'specificity': 0.8096707, 'f1': 0.8530094, 'auroc': 0.9805382, 'binary_precision': 0.83716077, 'binary_recall': 0.62363917, 'binary_specificity': 0.99570227, 'binary_f1_score': 0.71479505}
confusion matrix:
       0    1
0  18071   78
1    242  401
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96244806, 'precision': 0.9120728, 'recall': 0.5589701, 'specificity': 0.5589701, 'f1': 0.59476095, 'auroc': 0.96047306, 'binary_precision': 0.8611111, 'binary_recall': 0.118773945, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.20875421}
confusion matrix:
      0   1
0  5992   5
1   230  31
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863845.png
better model found
persisted
after epoch: 6,now: 2024-05-27 07:00:04.451348,epoch time: 0:22:52.121630,used: 2:18:39.580840,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_04_41_24_seed_0_20863845
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98755026, 'precision': 0.91908276, 'recall': 0.8824158, 'specificity': 0.8824158, 'f1': 0.8998437, 'auroc': 0.9910862, 'binary_precision': 0.84615386, 'binary_recall': 0.76970106, 'binary_specificity': 0.9951305, 'binary_f1_score': 0.8061188}
confusion matrix:
       0     1
0  42098   206
1    339  1133
---- Validation: 
scalar performance:
{'acc': 0.9860047, 'precision': 0.90985787, 'recall': 0.8697454, 'specificity': 0.8697454, 'f1': 0.8886851, 'auroc': 0.9826716, 'binary_precision': 0.82871974, 'binary_recall': 0.7449456, 'binary_specificity': 0.99454516, 'binary_f1_score': 0.78460276}
confusion matrix:
       0    1
0  18050   99
1    164  479
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96772134, 'precision': 0.93629086, 'recall': 0.6258532, 'specificity': 0.6258532, 'f1': 0.6893138, 'auroc': 0.9536401, 'binary_precision': 0.9041096, 'binary_recall': 0.25287357, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.39520958}
confusion matrix:
      0   1
0  5990   7
1   195  66
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863845.png
better model found
persisted
after epoch: 7,now: 2024-05-27 07:22:56.648231,epoch time: 0:22:52.196883,used: 2:41:31.777723,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_04_41_24_seed_0_20863845
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98812133, 'precision': 0.9005597, 'recall': 0.9220538, 'specificity': 0.9220538, 'f1': 0.911002, 'auroc': 0.9926684, 'binary_precision': 0.8063063, 'binary_recall': 0.8512228, 'binary_specificity': 0.9928848, 'binary_f1_score': 0.82815593}
confusion matrix:
       0     1
0  42003   301
1    219  1253
---- Validation: 
scalar performance:
{'acc': 0.9863772, 'precision': 0.89827603, 'recall': 0.89469004, 'specificity': 0.89469004, 'f1': 0.89647424, 'auroc': 0.98164666, 'binary_precision': 0.8037677, 'binary_recall': 0.7962675, 'binary_specificity': 0.99311256, 'binary_f1_score': 0.8000001}
confusion matrix:
       0    1
0  18024  125
1    131  512
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9678811, 'precision': 0.8770426, 'recall': 0.6570862, 'specificity': 0.6570862, 'f1': 0.71788573, 'auroc': 0.9616877, 'binary_precision': 0.7830189, 'binary_recall': 0.31800765, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.45231605}
confusion matrix:
      0   1
0  5974  23
1   178  83
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863845.png
better model found
persisted
after epoch: 8,now: 2024-05-27 07:45:51.754833,epoch time: 0:22:55.106602,used: 3:04:26.884325,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_04_41_24_seed_0_20863845
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9880985, 'precision': 0.9299778, 'recall': 0.87868416, 'specificity': 0.87868416, 'f1': 0.9025779, 'auroc': 0.99337906, 'binary_precision': 0.86821705, 'binary_recall': 0.7613868, 'binary_specificity': 0.9959816, 'binary_f1_score': 0.8113002}
confusion matrix:
       0     1
0  42135   170
1    351  1120
---- Validation: 
scalar performance:
{'acc': 0.98424864, 'precision': 0.91455245, 'recall': 0.8305834, 'specificity': 0.8305834, 'f1': 0.86746544, 'auroc': 0.9833872, 'binary_precision': 0.8408644, 'binary_recall': 0.66562986, 'binary_specificity': 0.9955369, 'binary_f1_score': 0.7430556}
confusion matrix:
       0    1
0  18068   81
1    215  428
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9693193, 'precision': 0.9170568, 'recall': 0.65600425, 'specificity': 0.65600425, 'f1': 0.7224424, 'auroc': 0.9596487, 'binary_precision': 0.86315787, 'binary_recall': 0.31417623, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.46067417}
confusion matrix:
      0   1
0  5984  13
1   179  82
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863845.png
new oracle model saved
early stop counter: 1
val acc:0.9842486381530762, best validation acc: 0.9863771796226501, corresponding to test acc:                         0.9678810834884644 / 0.9693192839622498
after epoch: 9,now: 2024-05-27 08:08:45.324326,epoch time: 0:22:53.569493,used: 3:27:20.453818,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_04_41_24_seed_0_20863845
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9875731, 'precision': 0.9063861, 'recall': 0.9010503, 'specificity': 0.9010503, 'f1': 0.90369904, 'auroc': 0.9929936, 'binary_precision': 0.8194349, 'binary_recall': 0.8082937, 'binary_specificity': 0.9938069, 'binary_f1_score': 0.81382614}
confusion matrix:
       0     1
0  42043   262
1    282  1189
---- Validation: 
scalar performance:
{'acc': 0.9832908, 'precision': 0.88503826, 'recall': 0.85258913, 'specificity': 0.85258913, 'f1': 0.86803913, 'auroc': 0.9816546, 'binary_precision': 0.7802385, 'binary_recall': 0.7122862, 'binary_specificity': 0.99289215, 'binary_f1_score': 0.7447155}
confusion matrix:
       0    1
0  18020  129
1    185  458
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9744327, 'precision': 0.94988644, 'recall': 0.7099776, 'specificity': 0.7099776, 'f1': 0.78288174, 'auroc': 0.960927, 'binary_precision': 0.92436975, 'binary_recall': 0.42145595, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.5789474}
confusion matrix:
      0    1
0  5988    9
1   151  110
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863845.png
new oracle model saved
early stop counter: 2
val acc:0.9832907915115356, best validation acc: 0.9863771796226501, corresponding to test acc:                         0.9678810834884644 / 0.9744327068328857
after epoch: 10,now: 2024-05-27 08:31:44.735002,epoch time: 0:22:59.410676,used: 3:50:19.864494,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_04_41_24_seed_0_20863845
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9908397, 'precision': 0.92959726, 'recall': 0.9293153, 'specificity': 0.9293153, 'f1': 0.92945623, 'auroc': 0.99598694, 'binary_precision': 0.8639456, 'binary_recall': 0.86335826, 'binary_specificity': 0.9952724, 'binary_f1_score': 0.8636518}
confusion matrix:
       0     1
0  42105   200
1    201  1270
---- Validation: 
scalar performance:
{'acc': 0.98510003, 'precision': 0.89705026, 'recall': 0.87077713, 'specificity': 0.87077713, 'f1': 0.8834263, 'auroc': 0.98359776, 'binary_precision': 0.803005, 'binary_recall': 0.748056, 'binary_specificity': 0.99349827, 'binary_f1_score': 0.7745572}
confusion matrix:
       0    1
0  18031  118
1    162  481
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9696389, 'precision': 0.8881123, 'recall': 0.678159, 'specificity': 0.678159, 'f1': 0.74085057, 'auroc': 0.95755017, 'binary_precision': 0.8034188, 'binary_recall': 0.36015326, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.4973545}
confusion matrix:
      0   1
0  5974  23
1   167  94
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863845.png
early stop counter: 3
val acc:0.9851000308990479, best validation acc: 0.9863771796226501, corresponding to test acc:                         0.9678810834884644 / 0.9744327068328857
after epoch: 11,now: 2024-05-27 08:54:48.584845,epoch time: 0:23:03.849843,used: 4:13:23.714337,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_04_41_24_seed_0_20863845
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9908397, 'precision': 0.9315061, 'recall': 0.9266907, 'specificity': 0.9266907, 'f1': 0.92908376, 'auroc': 0.9961151, 'binary_precision': 0.8679505, 'binary_recall': 0.8579198, 'binary_specificity': 0.9954615, 'binary_f1_score': 0.862906}
confusion matrix:
       0     1
0  42113   192
1    209  1262
---- Validation: 
scalar performance:
{'acc': 0.98557895, 'precision': 0.9016712, 'recall': 0.8732752, 'specificity': 0.8732752, 'f1': 0.8869095, 'auroc': 0.98126876, 'binary_precision': 0.81208056, 'binary_recall': 0.7527216, 'binary_specificity': 0.99382883, 'binary_f1_score': 0.7812753}
confusion matrix:
       0    1
0  18037  112
1    159  484
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9680409, 'precision': 0.89244616, 'recall': 0.64984024, 'specificity': 0.64984024, 'f1': 0.7124454, 'auroc': 0.95527697, 'binary_precision': 0.814433, 'binary_recall': 0.30268198, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.44134074}
confusion matrix:
      0   1
0  5979  18
1   182  79
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863845.png
early stop counter: 4
val acc:0.9855789542198181, best validation acc: 0.9863771796226501, corresponding to test acc:                         0.9678810834884644 / 0.9744327068328857
after epoch: 12,now: 2024-05-27 09:17:46.893708,epoch time: 0:22:58.308863,used: 4:36:22.023200,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_04_41_24_seed_0_20863845
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98775584, 'precision': 0.9790258, 'recall': 0.8277704, 'specificity': 0.8277704, 'f1': 0.88826025, 'auroc': 0.99603415, 'binary_precision': 0.9698795, 'binary_recall': 0.65625, 'binary_specificity': 0.9992908, 'binary_f1_score': 0.7828201}
confusion matrix:
       0    1
0  42274   30
1    506  966
---- Validation: 
scalar performance:
{'acc': 0.98366326, 'precision': 0.9556428, 'recall': 0.7830269, 'specificity': 0.7830269, 'f1': 0.8477768, 'auroc': 0.97708905, 'binary_precision': 0.92639595, 'binary_recall': 0.5676516, 'binary_specificity': 0.9984021, 'binary_f1_score': 0.7039536}
confusion matrix:
       0    1
0  18120   29
1    278  365
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96292746, 'precision': 0.9813774, 'recall': 0.5555556, 'specificity': 0.5555556, 'f1': 0.59051204, 'auroc': 0.93830967, 'binary_precision': 1.0, 'binary_recall': 0.11111111, 'binary_specificity': 1.0, 'binary_f1_score': 0.19999999}
confusion matrix:
      0   1
0  5997   0
1   232  29
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863845.png
early stop counter: 5
val acc:0.9836632609367371, best validation acc: 0.9863771796226501, corresponding to test acc:                         0.9678810834884644 / 0.9744327068328857
after epoch: 13,now: 2024-05-27 09:40:42.443366,epoch time: 0:22:55.549658,used: 4:59:17.572858,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_04_41_24_seed_0_20863845
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99090827, 'precision': 0.9700915, 'recall': 0.8848258, 'specificity': 0.8848258, 'f1': 0.92289996, 'auroc': 0.9979334, 'binary_precision': 0.9480737, 'binary_recall': 0.77111715, 'binary_specificity': 0.99853456, 'binary_f1_score': 0.85048836}
confusion matrix:
       0     1
0  42246    62
1    336  1132
---- Validation: 
scalar performance:
{'acc': 0.9860047, 'precision': 0.94130623, 'recall': 0.83374274, 'specificity': 0.83374274, 'f1': 0.8795043, 'auroc': 0.9789834, 'binary_precision': 0.89419085, 'binary_recall': 0.6702955, 'binary_specificity': 0.99718994, 'binary_f1_score': 0.76622224}
confusion matrix:
       0    1
0  18098   51
1    212  431
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964046, 'precision': 0.92794454, 'recall': 0.5781272, 'specificity': 0.5781272, 'f1': 0.62433594, 'auroc': 0.93264484, 'binary_precision': 0.8913044, 'binary_recall': 0.15708812, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.26710096}
confusion matrix:
      0   1
0  5992   5
1   220  41
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863845.png
early stop counter: 6
val acc:0.9860047101974487, best validation acc: 0.9863771796226501, corresponding to test acc:                         0.9678810834884644 / 0.9744327068328857
after epoch: 14,now: 2024-05-27 10:03:40.344772,epoch time: 0:22:57.901406,used: 5:22:15.474264,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_04_41_24_seed_0_20863845
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.993284, 'precision': 0.95201385, 'recall': 0.9437034, 'specificity': 0.9437034, 'f1': 0.9478171, 'auroc': 0.9974172, 'binary_precision': 0.9078309, 'binary_recall': 0.8905507, 'binary_specificity': 0.99685615, 'binary_f1_score': 0.89910775}
confusion matrix:
       0     1
0  42172   133
1    161  1310
---- Validation: 
scalar performance:
{'acc': 0.98696256, 'precision': 0.9113517, 'recall': 0.8859924, 'specificity': 0.8859924, 'f1': 0.89823544, 'auroc': 0.97566414, 'binary_precision': 0.8305648, 'binary_recall': 0.777605, 'binary_specificity': 0.9943799, 'binary_f1_score': 0.8032128}
confusion matrix:
       0    1
0  18047  102
1    143  500
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9682007, 'precision': 0.8874221, 'recall': 0.6554206, 'specificity': 0.6554206, 'f1': 0.717708, 'auroc': 0.94675946, 'binary_precision': 0.8039216, 'binary_recall': 0.31417623, 'binary_specificity': 0.996665, 'binary_f1_score': 0.45179063}
confusion matrix:
      0   1
0  5977  20
1   179  82
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863845.png
better model found
persisted
after epoch: 15,now: 2024-05-27 10:26:50.782120,epoch time: 0:23:10.437348,used: 5:45:25.911612,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_04_41_24_seed_0_20863845
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99163926, 'precision': 0.9207915, 'recall': 0.95764303, 'specificity': 0.95764303, 'f1': 0.9383794, 'auroc': 0.9976996, 'binary_precision': 0.84433377, 'binary_recall': 0.9211956, 'binary_specificity': 0.9940904, 'binary_f1_score': 0.8810916}
confusion matrix:
       0     1
0  42054   250
1    116  1356
---- Validation: 
scalar performance:
{'acc': 0.9871754, 'precision': 0.89538693, 'recall': 0.9161048, 'specificity': 0.9161048, 'f1': 0.9054582, 'auroc': 0.98010015, 'binary_precision': 0.79646015, 'binary_recall': 0.83981335, 'binary_specificity': 0.9923963, 'binary_f1_score': 0.8175624}
confusion matrix:
       0    1
0  18011  138
1    103  540
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9707574, 'precision': 0.8808048, 'recall': 0.702563, 'specificity': 0.702563, 'f1': 0.7619713, 'auroc': 0.94659126, 'binary_precision': 0.7867647, 'binary_recall': 0.4099617, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.53904283}
confusion matrix:
      0    1
0  5968   29
1   154  107
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863845.png
better model found
persisted
after epoch: 16,now: 2024-05-27 10:49:57.453916,epoch time: 0:23:06.671796,used: 6:08:32.583408,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_04_41_24_seed_0_20863845
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99374086, 'precision': 0.9791255, 'recall': 0.92228615, 'specificity': 0.92228615, 'f1': 0.94878256, 'auroc': 0.9982116, 'binary_precision': 0.96359414, 'binary_recall': 0.8456832, 'binary_specificity': 0.998889, 'binary_f1_score': 0.9007966}
confusion matrix:
       0     1
0  42258    47
1    227  1244
---- Validation: 
scalar performance:
{'acc': 0.98573864, 'precision': 0.9507101, 'recall': 0.82085407, 'specificity': 0.82085407, 'f1': 0.8740648, 'auroc': 0.97797847, 'binary_precision': 0.9139073, 'binary_recall': 0.64385694, 'binary_specificity': 0.99785113, 'binary_f1_score': 0.75547445}
confusion matrix:
       0    1
0  18110   39
1    229  414
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9691595, 'precision': 0.9241353, 'recall': 0.6504239, 'specificity': 0.6504239, 'f1': 0.71713865, 'auroc': 0.9352826, 'binary_precision': 0.87777776, 'binary_recall': 0.30268198, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.45014247}
confusion matrix:
      0   1
0  5986  11
1   182  79
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863845.png
early stop counter: 1
val acc:0.9857386350631714, best validation acc: 0.9871754050254822, corresponding to test acc:                         0.9707574248313904 / 0.9744327068328857
after epoch: 17,now: 2024-05-27 11:12:59.387886,epoch time: 0:23:01.933970,used: 6:31:34.517378,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_04_41_24_seed_0_20863845
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9941749, 'precision': 0.9682065, 'recall': 0.9401473, 'specificity': 0.9401473, 'f1': 0.9537108, 'auroc': 0.9981125, 'binary_precision': 0.94049346, 'binary_recall': 0.8822328, 'binary_specificity': 0.9980618, 'binary_f1_score': 0.910432}
confusion matrix:
       0     1
0  42225    82
1    173  1296
---- Validation: 
scalar performance:
{'acc': 0.9874415, 'precision': 0.94950837, 'recall': 0.8502377, 'specificity': 0.8502377, 'f1': 0.8932533, 'auroc': 0.9831677, 'binary_precision': 0.90945673, 'binary_recall': 0.7029549, 'binary_specificity': 0.9975205, 'binary_f1_score': 0.79298246}
confusion matrix:
       0    1
0  18104   45
1    191  452
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645254, 'precision': 0.88781273, 'recall': 0.59670067, 'specificity': 0.59670067, 'f1': 0.6483031, 'auroc': 0.9588964, 'binary_precision': 0.8095238, 'binary_recall': 0.1954023, 'binary_specificity': 0.997999, 'binary_f1_score': 0.31481484}
confusion matrix:
      0   1
0  5985  12
1   210  51
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863845.png
better model found
persisted
after epoch: 18,now: 2024-05-27 11:36:08.332487,epoch time: 0:23:08.944601,used: 6:54:43.461979,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_04_41_24_seed_0_20863845
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99237025, 'precision': 0.97539437, 'recall': 0.9039252, 'specificity': 0.9039252, 'f1': 0.936544, 'auroc': 0.9982462, 'binary_precision': 0.9573955, 'binary_recall': 0.80910325, 'binary_specificity': 0.99874717, 'binary_f1_score': 0.877025}
confusion matrix:
       0     1
0  42251    53
1    281  1191
---- Validation: 
scalar performance:
{'acc': 0.9852065, 'precision': 0.94767916, 'recall': 0.81457806, 'specificity': 0.81457806, 'f1': 0.86866826, 'auroc': 0.9776822, 'binary_precision': 0.9082774, 'binary_recall': 0.63141525, 'binary_specificity': 0.9977409, 'binary_f1_score': 0.74495417}
confusion matrix:
       0    1
0  18108   41
1    237  406
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96180886, 'precision': 0.9144669, 'recall': 0.54947495, 'specificity': 0.54947495, 'f1': 0.579572, 'auroc': 0.95291644, 'binary_precision': 0.8666667, 'binary_recall': 0.099616855, 'binary_specificity': 0.999333, 'binary_f1_score': 0.17869414}
confusion matrix:
      0   1
0  5993   4
1   235  26
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863845.png
early stop counter: 1
val acc:0.9852064847946167, best validation acc: 0.9874414801597595, corresponding to test acc:                         0.9645254015922546 / 0.9744327068328857
after epoch: 19,now: 2024-05-27 11:59:55.684710,epoch time: 0:23:47.352223,used: 7:18:30.814202,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_04_41_24_seed_0_20863845
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99383223, 'precision': 0.9451507, 'recall': 0.9620562, 'specificity': 0.9620562, 'f1': 0.9534333, 'auroc': 0.9985093, 'binary_precision': 0.89281046, 'binary_recall': 0.9279891, 'binary_specificity': 0.9961233, 'binary_f1_score': 0.9100599}
confusion matrix:
       0     1
0  42140   164
1    106  1366
---- Validation: 
scalar performance:
{'acc': 0.9889847, 'precision': 0.9259492, 'recall': 0.9035405, 'specificity': 0.9035405, 'f1': 0.9144176, 'auroc': 0.98435587, 'binary_precision': 0.85855263, 'binary_recall': 0.8118196, 'binary_specificity': 0.99526143, 'binary_f1_score': 0.83453244}
confusion matrix:
       0    1
0  18063   86
1    121  522
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642058, 'precision': 0.86005914, 'recall': 0.60386324, 'specificity': 0.60386324, 'f1': 0.65547675, 'auroc': 0.95938694, 'binary_precision': 0.75342464, 'binary_recall': 0.21072797, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.32934132}
confusion matrix:
      0   1
0  5979  18
1   206  55
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863845.png
better model found
persisted
after epoch: 20,now: 2024-05-27 12:25:02.145491,epoch time: 0:25:06.460781,used: 7:43:37.274983,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_04_41_24_seed_0_20863845
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99424344, 'precision': 0.97081506, 'recall': 0.9385812, 'specificity': 0.9385812, 'f1': 0.9540839, 'auroc': 0.9987315, 'binary_precision': 0.94582725, 'binary_recall': 0.87891155, 'binary_specificity': 0.99825084, 'binary_f1_score': 0.91114247}
confusion matrix:
       0     1
0  42232    74
1    178  1292
---- Validation: 
scalar performance:
{'acc': 0.98483396, 'precision': 0.9171709, 'recall': 0.838387, 'specificity': 0.838387, 'f1': 0.87334865, 'auroc': 0.9778542, 'binary_precision': 0.84555984, 'binary_recall': 0.68118197, 'binary_specificity': 0.99559206, 'binary_f1_score': 0.754522}
confusion matrix:
       0    1
0  18069   80
1    205  438
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9637264, 'precision': 0.879213, 'recall': 0.5871221, 'specificity': 0.5871221, 'f1': 0.6348951, 'auroc': 0.9422575, 'binary_precision': 0.79310346, 'binary_recall': 0.17624521, 'binary_specificity': 0.997999, 'binary_f1_score': 0.28840125}
confusion matrix:
      0   1
0  5985  12
1   215  46
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863845.png
early stop counter: 1
val acc:0.9848339557647705, best validation acc: 0.9889847040176392, corresponding to test acc:                         0.964205801486969 / 0.9744327068328857
after epoch: 21,now: 2024-05-27 12:49:40.838854,epoch time: 0:24:38.693363,used: 8:08:15.968346,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_04_41_24_seed_0_20863845
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9957054, 'precision': 0.9734203, 'recall': 0.95974684, 'specificity': 0.95974684, 'f1': 0.9664757, 'auroc': 0.9991543, 'binary_precision': 0.94957983, 'binary_recall': 0.9211956, 'binary_specificity': 0.99829805, 'binary_f1_score': 0.9351724}
confusion matrix:
       0     1
0  42232    72
1    116  1356
---- Validation: 
scalar performance:
{'acc': 0.98797363, 'precision': 0.92787546, 'recall': 0.8827656, 'specificity': 0.8827656, 'f1': 0.90396523, 'auroc': 0.98285574, 'binary_precision': 0.8638743, 'binary_recall': 0.7698289, 'binary_specificity': 0.99570227, 'binary_f1_score': 0.81414473}
confusion matrix:
       0    1
0  18071   78
1    148  495
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9697987, 'precision': 0.8865591, 'recall': 0.68190706, 'specificity': 0.68190706, 'f1': 0.7441811, 'auroc': 0.952708, 'binary_precision': 0.8, 'binary_recall': 0.3678161, 'binary_specificity': 0.995998, 'binary_f1_score': 0.50393695}
confusion matrix:
      0   1
0  5973  24
1   165  96
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863845.png
early stop counter: 2
val acc:0.9879736304283142, best validation acc: 0.9889847040176392, corresponding to test acc:                         0.964205801486969 / 0.9744327068328857
after epoch: 22,now: 2024-05-27 13:14:03.559670,epoch time: 0:24:22.720816,used: 8:32:38.689162,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_04_41_24_seed_0_20863845
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9961851, 'precision': 0.97552276, 'recall': 0.96521765, 'specificity': 0.96521765, 'f1': 0.9703095, 'auroc': 0.9991208, 'binary_precision': 0.9534075, 'binary_recall': 0.93201905, 'binary_specificity': 0.99841624, 'binary_f1_score': 0.94259197}
confusion matrix:
       0     1
0  42238    67
1    100  1371
---- Validation: 
scalar performance:
{'acc': 0.9877607, 'precision': 0.9303994, 'recall': 0.8759049, 'specificity': 0.8759049, 'f1': 0.90116525, 'auroc': 0.9860332, 'binary_precision': 0.8694097, 'binary_recall': 0.755832, 'binary_specificity': 0.99597776, 'binary_f1_score': 0.8086522}
confusion matrix:
       0    1
0  18076   73
1    157  486
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96676254, 'precision': 0.8591187, 'recall': 0.65100557, 'specificity': 0.65100557, 'f1': 0.70883024, 'auroc': 0.9576035, 'binary_precision': 0.74766356, 'binary_recall': 0.3065134, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.4347826}
confusion matrix:
      0   1
0  5970  27
1   181  80
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863845.png
early stop counter: 3
val acc:0.9877607226371765, best validation acc: 0.9889847040176392, corresponding to test acc:                         0.964205801486969 / 0.9744327068328857
after epoch: 23,now: 2024-05-27 13:50:57.505889,epoch time: 0:36:53.946219,used: 9:09:32.635381,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_04_41_24_seed_0_20863845
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99524856, 'precision': 0.94793856, 'recall': 0.9831059, 'specificity': 0.9831059, 'f1': 0.96480435, 'auroc': 0.9992628, 'binary_precision': 0.8969202, 'binary_recall': 0.97008836, 'binary_specificity': 0.9961234, 'binary_f1_score': 0.93207055}
confusion matrix:
       0     1
0  42141   164
1     44  1427
---- Validation: 
scalar performance:
{'acc': 0.98648363, 'precision': 0.88639146, 'recall': 0.91874695, 'specificity': 0.91874695, 'f1': 0.90186095, 'auroc': 0.9837768, 'binary_precision': 0.7782546, 'binary_recall': 0.8460342, 'binary_specificity': 0.9914596, 'binary_f1_score': 0.8107303}
confusion matrix:
       0    1
0  17994  155
1     99  544
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9705976, 'precision': 0.90684706, 'recall': 0.68049157, 'specificity': 0.68049157, 'f1': 0.7464337, 'auroc': 0.95758796, 'binary_precision': 0.84070796, 'binary_recall': 0.36398467, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.5080214}
confusion matrix:
      0   1
0  5979  18
1   166  95
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863845.png
early stop counter: 4
val acc:0.986483633518219, best validation acc: 0.9889847040176392, corresponding to test acc:                         0.964205801486969 / 0.9744327068328857
after epoch: 24,now: 2024-05-27 14:25:55.316061,epoch time: 0:34:57.810172,used: 9:44:30.445553,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_04_41_24_seed_0_20863845
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99458605, 'precision': 0.9595855, 'recall': 0.9568727, 'specificity': 0.9568727, 'f1': 0.9582247, 'auroc': 0.9987166, 'binary_precision': 0.9220779, 'binary_recall': 0.9164402, 'binary_specificity': 0.9973052, 'binary_f1_score': 0.91925037}
confusion matrix:
       0     1
0  42190   114
1    123  1349
---- Validation: 
scalar performance:
{'acc': 0.98738825, 'precision': 0.9287443, 'recall': 0.8712117, 'specificity': 0.8712117, 'f1': 0.89774585, 'auroc': 0.981345, 'binary_precision': 0.866426, 'binary_recall': 0.7465008, 'binary_specificity': 0.9959226, 'binary_f1_score': 0.80200505}
confusion matrix:
       0    1
0  18075   74
1    163  480
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96756154, 'precision': 0.915711, 'recall': 0.6312668, 'specificity': 0.6312668, 'f1': 0.69400924, 'auroc': 0.95714635, 'binary_precision': 0.8625, 'binary_recall': 0.26436782, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.40469208}
confusion matrix:
      0   1
0  5986  11
1   192  69
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863845.png
early stop counter: 5
val acc:0.9873882532119751, best validation acc: 0.9889847040176392, corresponding to test acc:                         0.964205801486969 / 0.9744327068328857
after epoch: 25,now: 2024-05-27 15:03:34.259772,epoch time: 0:37:38.943711,used: 10:22:09.389264,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_04_41_24_seed_0_20863845
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99623084, 'precision': 0.98507494, 'recall': 0.9560253, 'specificity': 0.9560253, 'f1': 0.97006845, 'auroc': 0.9995284, 'binary_precision': 0.97316897, 'binary_recall': 0.9129252, 'binary_specificity': 0.9991254, 'binary_f1_score': 0.942085}
confusion matrix:
       0     1
0  42269    37
1    128  1342
---- Validation: 
scalar performance:
{'acc': 0.9860579, 'precision': 0.9414428, 'recall': 0.83452034, 'specificity': 0.83452034, 'f1': 0.8800658, 'auroc': 0.9855914, 'binary_precision': 0.89440995, 'binary_recall': 0.6718507, 'binary_specificity': 0.99718994, 'binary_f1_score': 0.76731795}
confusion matrix:
       0    1
0  18098   51
1    211  432
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96356666, 'precision': 0.88809395, 'recall': 0.5815417, 'specificity': 0.5815417, 'f1': 0.62759995, 'auroc': 0.95295525, 'binary_precision': 0.8113208, 'binary_recall': 0.16475096, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.27388537}
confusion matrix:
      0   1
0  5987  10
1   218  43
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863845.png
early stop counter: 6
val acc:0.9860578775405884, best validation acc: 0.9889847040176392, corresponding to test acc:                         0.964205801486969 / 0.9744327068328857
after epoch: 26,now: 2024-05-27 15:43:37.011279,epoch time: 0:40:02.751507,used: 11:02:12.140771,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_04_41_24_seed_0_20863845
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9957054, 'precision': 0.9855925, 'recall': 0.9472172, 'specificity': 0.9472172, 'f1': 0.9655573, 'auroc': 0.9995503, 'binary_precision': 0.97481483, 'binary_recall': 0.8952381, 'binary_specificity': 0.99919635, 'binary_f1_score': 0.93333334}
confusion matrix:
       0     1
0  42272    34
1    154  1316
---- Validation: 
scalar performance:
{'acc': 0.9868561, 'precision': 0.94343823, 'recall': 0.8461844, 'specificity': 0.8461844, 'f1': 0.8883728, 'auroc': 0.98254496, 'binary_precision': 0.89759034, 'binary_recall': 0.69517887, 'binary_specificity': 0.99718994, 'binary_f1_score': 0.78352326}
confusion matrix:
       0    1
0  18098   51
1    196  447
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96692234, 'precision': 0.89150363, 'recall': 0.6327656, 'specificity': 0.6327656, 'f1': 0.69322383, 'auroc': 0.9567012, 'binary_precision': 0.81395346, 'binary_recall': 0.26819924, 'binary_specificity': 0.997332, 'binary_f1_score': 0.4034582}
confusion matrix:
      0   1
0  5981  16
1   191  70
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863845.png
early stop counter: 7
val acc:0.9868561029434204, best validation acc: 0.9889847040176392, corresponding to test acc:                         0.964205801486969 / 0.9744327068328857
after epoch: 27,now: 2024-05-27 16:24:26.913282,epoch time: 0:40:49.902003,used: 11:43:02.042774,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_04_41_24_seed_0_20863845
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9963679, 'precision': 0.97789586, 'recall': 0.96566314, 'specificity': 0.96566314, 'f1': 0.97169423, 'auroc': 0.9993341, 'binary_precision': 0.9581298, 'binary_recall': 0.93274456, 'binary_specificity': 0.9985817, 'binary_f1_score': 0.94526684}
confusion matrix:
       0     1
0  42244    60
1     99  1373
---- Validation: 
scalar performance:
{'acc': 0.9879204, 'precision': 0.93470544, 'recall': 0.87373734, 'specificity': 0.87373734, 'f1': 0.9017428, 'auroc': 0.98354614, 'binary_precision': 0.8781818, 'binary_recall': 0.7511664, 'binary_specificity': 0.9963083, 'binary_f1_score': 0.8097234}
confusion matrix:
       0    1
0  18082   67
1    160  483
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.965644, 'precision': 0.9026395, 'recall': 0.6082783, 'specificity': 0.6082783, 'f1': 0.6644314, 'auroc': 0.9513988, 'binary_precision': 0.8382353, 'binary_recall': 0.21839081, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.34650457}
confusion matrix:
      0   1
0  5986  11
1   204  57
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863845.png
early stop counter: 8
val acc:0.9879204034805298, best validation acc: 0.9889847040176392, corresponding to test acc:                         0.964205801486969 / 0.9744327068328857
after epoch: 28,now: 2024-05-27 16:58:32.889956,epoch time: 0:34:05.976674,used: 12:17:08.019448,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_04_41_24_seed_0_20863845
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9960252, 'precision': 0.974668, 'recall': 0.9634216, 'specificity': 0.9634216, 'f1': 0.96897227, 'auroc': 0.99871993, 'binary_precision': 0.95181566, 'binary_recall': 0.9284741, 'binary_specificity': 0.9983691, 'binary_f1_score': 0.94}
confusion matrix:
       0     1
0  42239    69
1    105  1363
---- Validation: 
scalar performance:
{'acc': 0.9870157, 'precision': 0.91748595, 'recall': 0.8785194, 'specificity': 0.8785194, 'f1': 0.89697146, 'auroc': 0.97734654, 'binary_precision': 0.8433735, 'binary_recall': 0.7620529, 'binary_specificity': 0.99498594, 'binary_f1_score': 0.80065364}
confusion matrix:
       0    1
0  18058   91
1    153  490
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614893, 'precision': 0.8104466, 'recall': 0.57862556, 'specificity': 0.57862556, 'f1': 0.61934644, 'auroc': 0.92850864, 'binary_precision': 0.65625, 'binary_recall': 0.16091955, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.25846156}
confusion matrix:
      0   1
0  5975  22
1   219  42
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863845.png
early stop counter: 9
val acc:0.9870157241821289, best validation acc: 0.9889847040176392, corresponding to test acc:                         0.964205801486969 / 0.9744327068328857
after epoch: 29,now: 2024-05-27 17:38:31.925149,epoch time: 0:39:59.035193,used: 12:57:07.054641,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_04_41_24_seed_0_20863845
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9971217, 'precision': 0.97635686, 'recall': 0.9794818, 'specificity': 0.9794818, 'f1': 0.97791386, 'auroc': 0.99930036, 'binary_precision': 0.95408505, 'binary_recall': 0.96057105, 'binary_specificity': 0.99839264, 'binary_f1_score': 0.95731705}
confusion matrix:
       0     1
0  42237    68
1     58  1413
---- Validation: 
scalar performance:
{'acc': 0.9874415, 'precision': 0.9314654, 'recall': 0.8689891, 'specificity': 0.8689891, 'f1': 0.897598, 'auroc': 0.98124933, 'binary_precision': 0.87202924, 'binary_recall': 0.7418352, 'binary_specificity': 0.99614304, 'binary_f1_score': 0.8016807}
confusion matrix:
       0    1
0  18079   70
1    166  477
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96580374, 'precision': 0.89470994, 'recall': 0.61385864, 'specificity': 0.61385864, 'f1': 0.6708573, 'auroc': 0.9546683, 'binary_precision': 0.82191783, 'binary_recall': 0.22988506, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.35928145}
confusion matrix:
      0   1
0  5984  13
1   201  60
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863845.png
early stop counter: 10
val acc:0.9874414801597595, best validation acc: 0.9889847040176392, corresponding to test acc:                         0.964205801486969 / 0.9744327068328857
after epoch: 30,now: 2024-05-27 18:18:27.052241,epoch time: 0:39:55.127092,used: 13:37:02.181733,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_04_41_24_seed_0_20863845
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 13:37:02.181733 at 2024-05-27 18:18:27.052241
persisted model performance metric: 

scalar performance:
{'acc': 0.964046, 'precision': 0.86176467, 'recall': 0.6001152, 'specificity': 0.6001152, 'f1': 0.6508882, 'auroc': 0.96461976, 'binary_precision': 0.75714284, 'binary_recall': 0.20306513, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.3202417}
confusion matrix:
      0   1
0  5980  17
1   208  53
oracle model performance metric: 

scalar performance:
{'acc': 0.97299457, 'precision': 0.92904043, 'recall': 0.70189786, 'specificity': 0.70189786, 'f1': 0.7712519, 'auroc': 0.9670205, 'binary_precision': 0.8833333, 'binary_recall': 0.40613025, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.55643046}
confusion matrix:
      0    1
0  5983   14
1   155  106
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs32/rule_results/5.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs32/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs32/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1661 MiB |  30289 MiB |    989 TiB |    989 TiB |
|       from large pool |   1655 MiB |  30243 MiB |    983 TiB |    983 TiB |
|       from small pool |      5 MiB |     46 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1661 MiB |  30289 MiB |    989 TiB |    989 TiB |
|       from large pool |   1655 MiB |  30243 MiB |    983 TiB |    983 TiB |
|       from small pool |      5 MiB |     46 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1653 MiB |  30205 MiB |    986 TiB |    986 TiB |
|       from large pool |   1647 MiB |  30159 MiB |    980 TiB |    980 TiB |
|       from small pool |      5 MiB |     46 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  31378 MiB |  31378 MiB |  31378 MiB |      0 B   |
|       from large pool |  31330 MiB |  31330 MiB |  31330 MiB |      0 B   |
|       from small pool |     48 MiB |     48 MiB |     48 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 633162 KiB |   1049 MiB | 116030 GiB | 116029 GiB |
|       from large pool | 592160 KiB |   1047 MiB | 109184 GiB | 109184 GiB |
|       from small pool |  41002 KiB |     41 MiB |   6845 GiB |   6845 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2190    |    3619    |   76020 K  |   76018 K  |
|       from large pool |     247    |     989    |   31115 K  |   31115 K  |
|       from small pool |    1943    |    3370    |   44904 K  |   44902 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2190    |    3619    |   76020 K  |   76018 K  |
|       from large pool |     247    |     989    |   31115 K  |   31115 K  |
|       from small pool |    1943    |    3370    |   44904 K  |   44902 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     860    |     860    |     860    |       0    |
|       from large pool |     836    |     836    |     836    |       0    |
|       from small pool |      24    |      24    |      24    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     149    |    1501    |   42413 K  |   42412 K  |
|       from large pool |     103    |     544    |   20192 K  |   20192 K  |
|       from small pool |      46    |    1397    |   22220 K  |   22220 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  30289 MiB |    989 TiB |    989 TiB |
|       from large pool |  16640 KiB |  30243 MiB |    983 TiB |    983 TiB |
|       from small pool |      0 KiB |     46 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  30289 MiB |    989 TiB |    989 TiB |
|       from large pool |  16640 KiB |  30243 MiB |    983 TiB |    983 TiB |
|       from small pool |      0 KiB |     46 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  30205 MiB |    986 TiB |    986 TiB |
|       from large pool |  16640 KiB |  30159 MiB |    980 TiB |    980 TiB |
|       from small pool |      0 KiB |     46 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2280 MiB |  31378 MiB |  31378 MiB |  29098 MiB |
|       from large pool |   2234 MiB |  31330 MiB |  31330 MiB |  29096 MiB |
|       from small pool |     46 MiB |     48 MiB |     48 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1049 MiB | 116031 GiB | 116031 GiB |
|       from large pool |  24320 KiB |   1047 MiB | 109185 GiB | 109185 GiB |
|       from small pool |      0 KiB |     43 MiB |   6845 GiB |   6845 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3619    |   76020 K  |   76020 K  |
|       from large pool |       2    |     989    |   31115 K  |   31115 K  |
|       from small pool |       0    |    3370    |   44904 K  |   44904 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3619    |   76020 K  |   76020 K  |
|       from large pool |       2    |     989    |   31115 K  |   31115 K  |
|       from small pool |       0    |    3370    |   44904 K  |   44904 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     124    |     860    |     860    |     736    |
|       from large pool |     101    |     836    |     836    |     735    |
|       from small pool |      23    |      24    |      24    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1501    |   42413 K  |   42413 K  |
|       from large pool |       3    |     544    |   20192 K  |   20192 K  |
|       from small pool |       0    |    1397    |   22221 K  |   22221 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  30289 MiB |    989 TiB |    989 TiB |
|       from large pool |  16640 KiB |  30243 MiB |    983 TiB |    983 TiB |
|       from small pool |      0 KiB |     46 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  30289 MiB |    989 TiB |    989 TiB |
|       from large pool |  16640 KiB |  30243 MiB |    983 TiB |    983 TiB |
|       from small pool |      0 KiB |     46 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  30205 MiB |    986 TiB |    986 TiB |
|       from large pool |  16640 KiB |  30159 MiB |    980 TiB |    980 TiB |
|       from small pool |      0 KiB |     46 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2280 MiB |  31378 MiB |  31378 MiB |  29098 MiB |
|       from large pool |   2234 MiB |  31330 MiB |  31330 MiB |  29096 MiB |
|       from small pool |     46 MiB |     48 MiB |     48 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1049 MiB | 116031 GiB | 116031 GiB |
|       from large pool |  24320 KiB |   1047 MiB | 109185 GiB | 109185 GiB |
|       from small pool |      0 KiB |     43 MiB |   6845 GiB |   6845 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3619    |   76020 K  |   76020 K  |
|       from large pool |       2    |     989    |   31115 K  |   31115 K  |
|       from small pool |       0    |    3370    |   44904 K  |   44904 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3619    |   76020 K  |   76020 K  |
|       from large pool |       2    |     989    |   31115 K  |   31115 K  |
|       from small pool |       0    |    3370    |   44904 K  |   44904 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     124    |     860    |     860    |     736    |
|       from large pool |     101    |     836    |     836    |     735    |
|       from small pool |      23    |      24    |      24    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1501    |   42413 K  |   42413 K  |
|       from large pool |       3    |     544    |   20192 K  |   20192 K  |
|       from small pool |       0    |    1397    |   22221 K  |   22221 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_18_29_49_seed_1_20863845

 Experiment start at: 2024-05-27 18:29:49.772421
before training, model accuracy: 0.06445375829935074
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96950275, 'precision': 0.947622, 'recall': 0.5387828, 'specificity': 0.5387828, 'f1': 0.56398636, 'auroc': 0.96544814, 'binary_precision': 0.92561984, 'binary_recall': 0.07777778, 'binary_specificity': 0.99978775, 'binary_f1_score': 0.14349777}
confusion matrix:
       0    1
0  42391    9
1   1328  112
---- Validation: 
scalar performance:
{'acc': 0.9657951, 'precision': 0.9828683, 'recall': 0.52377415, 'specificity': 0.52377415, 'f1': 0.53667486, 'auroc': 0.96419084, 'binary_precision': 1.0, 'binary_recall': 0.04754829, 'binary_specificity': 1.0, 'binary_f1_score': 0.09078014}
confusion matrix:
       0   1
0  18067   0
1    641  32
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.94883794, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863845.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-27 18:55:14.256278,epoch time: 0:25:24.483857,used: 0:25:24.483857,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_18_29_49_seed_1_20863845
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9771898, 'precision': 0.87878263, 'recall': 0.7126823, 'specificity': 0.7126823, 'f1': 0.7707343, 'auroc': 0.97373754, 'binary_precision': 0.77666247, 'binary_recall': 0.4295628, 'binary_specificity': 0.9958018, 'binary_f1_score': 0.55317247}
confusion matrix:
       0    1
0  42221  178
1    822  619
---- Validation: 
scalar performance:
{'acc': 0.9738527, 'precision': 0.90434086, 'recall': 0.6688607, 'specificity': 0.6688607, 'f1': 0.7348547, 'auroc': 0.9718704, 'binary_precision': 0.83272725, 'binary_recall': 0.34026745, 'binary_specificity': 0.9974539, 'binary_f1_score': 0.48312235}
confusion matrix:
       0    1
0  18021   46
1    444  229
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589107, 'precision': 0.84329736, 'recall': 0.51513237, 'specificity': 0.51513237, 'f1': 0.51901865, 'auroc': 0.9484309, 'binary_precision': 0.72727275, 'binary_recall': 0.03076923, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.05904059}
confusion matrix:
      0  1
0  5943  3
1   252  8
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863845.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-05-27 19:20:38.171450,epoch time: 0:25:23.915172,used: 0:50:48.399029,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_18_29_49_seed_1_20863845
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.978125, 'precision': 0.91336834, 'recall': 0.70331514, 'specificity': 0.70331514, 'f1': 0.77022433, 'auroc': 0.9778371, 'binary_precision': 0.84648496, 'binary_recall': 0.40915394, 'binary_specificity': 0.9974763, 'binary_f1_score': 0.55165964}
confusion matrix:
       0    1
0  42291  107
1    852  590
---- Validation: 
scalar performance:
{'acc': 0.97379935, 'precision': 0.91822326, 'recall': 0.6602498, 'specificity': 0.6602498, 'f1': 0.7278787, 'auroc': 0.9662504, 'binary_precision': 0.8611111, 'binary_recall': 0.32243684, 'binary_specificity': 0.9980628, 'binary_f1_score': 0.46918914}
confusion matrix:
       0    1
0  18032   35
1    456  217
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9622946, 'precision': 0.88642967, 'recall': 0.56471187, 'specificity': 0.56471187, 'f1': 0.60292137, 'auroc': 0.93404984, 'binary_precision': 0.8095238, 'binary_recall': 0.13076924, 'binary_specificity': 0.99865454, 'binary_f1_score': 0.22516558}
confusion matrix:
      0   1
0  5938   8
1   226  34
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863845.png
new oracle model saved
early stop counter: 1
val acc:0.9737993478775024, best validation acc: 0.9738526940345764, corresponding to test acc:                         0.9589107036590576 / 0.9622945785522461
after epoch: 3,now: 2024-05-27 19:45:51.704818,epoch time: 0:25:13.533368,used: 1:16:01.932397,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_18_29_49_seed_1_20863845
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9818659, 'precision': 0.8639219, 'recall': 0.8431418, 'specificity': 0.8431418, 'f1': 0.85320055, 'auroc': 0.9828377, 'binary_precision': 0.7382006, 'binary_recall': 0.6946565, 'binary_specificity': 0.99162716, 'binary_f1_score': 0.71576697}
confusion matrix:
       0     1
0  42044   355
1    440  1001
---- Validation: 
scalar performance:
{'acc': 0.97646743, 'precision': 0.84108746, 'recall': 0.80039537, 'specificity': 0.80039537, 'f1': 0.81932735, 'auroc': 0.97659755, 'binary_precision': 0.69661015, 'binary_recall': 0.61069834, 'binary_specificity': 0.99009246, 'binary_f1_score': 0.6508314}
confusion matrix:
       0    1
0  17888  179
1    262  411
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614889, 'precision': 0.81558955, 'recall': 0.57900333, 'specificity': 0.57900333, 'f1': 0.6201459, 'auroc': 0.9444884, 'binary_precision': 0.6666667, 'binary_recall': 0.16153847, 'binary_specificity': 0.9964682, 'binary_f1_score': 0.26006192}
confusion matrix:
      0   1
0  5925  21
1   218  42
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863845.png
better model found
persisted
after epoch: 4,now: 2024-05-27 20:09:29.568518,epoch time: 0:23:37.863700,used: 1:39:39.796097,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_18_29_49_seed_1_20863845
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9837591, 'precision': 0.94503856, 'recall': 0.78192616, 'specificity': 0.78192616, 'f1': 0.8439511, 'auroc': 0.986403, 'binary_precision': 0.9046563, 'binary_recall': 0.5658807, 'binary_specificity': 0.9979716, 'binary_f1_score': 0.69624573}
confusion matrix:
       0    1
0  42312   86
1    626  816
---- Validation: 
scalar performance:
{'acc': 0.97993594, 'precision': 0.9441185, 'recall': 0.7449729, 'specificity': 0.7449729, 'f1': 0.81372356, 'auroc': 0.9798776, 'binary_precision': 0.9068493, 'binary_recall': 0.49182764, 'binary_specificity': 0.9981181, 'binary_f1_score': 0.63776493}
confusion matrix:
       0    1
0  18033   34
1    342  331
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606832, 'precision': 0.9802908, 'recall': 0.5307692, 'specificity': 0.5307692, 'f1': 0.5479183, 'auroc': 0.9487215, 'binary_precision': 1.0, 'binary_recall': 0.06153846, 'binary_specificity': 1.0, 'binary_f1_score': 0.11594203}
confusion matrix:
      0   1
0  5946   0
1   244  16
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863845.png
better model found
persisted
after epoch: 5,now: 2024-05-27 20:33:05.683860,epoch time: 0:23:36.115342,used: 2:03:15.911439,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_18_29_49_seed_1_20863845
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9851049, 'precision': 0.89333975, 'recall': 0.86450076, 'specificity': 0.86450076, 'f1': 0.87832725, 'auroc': 0.98871505, 'binary_precision': 0.7956424, 'binary_recall': 0.73541665, 'binary_specificity': 0.99358493, 'binary_f1_score': 0.764345}
confusion matrix:
       0     1
0  42128   272
1    381  1059
---- Validation: 
scalar performance:
{'acc': 0.9800427, 'precision': 0.87265956, 'recall': 0.82227707, 'specificity': 0.82227707, 'f1': 0.8454772, 'auroc': 0.9804082, 'binary_precision': 0.7582038, 'binary_recall': 0.6523031, 'binary_specificity': 0.99225104, 'binary_f1_score': 0.7012779}
confusion matrix:
       0    1
0  17927  140
1    234  439
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95987755, 'precision': 0.77550006, 'recall': 0.56896746, 'specificity': 0.56896746, 'f1': 0.60425246, 'auroc': 0.95654833, 'binary_precision': 0.5873016, 'binary_recall': 0.1423077, 'binary_specificity': 0.9956273, 'binary_f1_score': 0.22910218}
confusion matrix:
      0   1
0  5920  26
1   223  37
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863845.png
better model found
persisted
after epoch: 6,now: 2024-05-27 20:56:30.033231,epoch time: 0:23:24.349371,used: 2:26:40.260810,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_18_29_49_seed_1_20863845
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98307484, 'precision': 0.8470142, 'recall': 0.9199058, 'specificity': 0.9199058, 'f1': 0.879671, 'auroc': 0.9889981, 'binary_precision': 0.6990899, 'binary_recall': 0.8522885, 'binary_specificity': 0.987523, 'binary_f1_score': 0.768125}
confusion matrix:
       0     1
0  41869   529
1    213  1229
---- Validation: 
scalar performance:
{'acc': 0.97998935, 'precision': 0.84664345, 'recall': 0.87875557, 'specificity': 0.87875557, 'f1': 0.86191714, 'auroc': 0.97776115, 'binary_precision': 0.701897, 'binary_recall': 0.76968795, 'binary_specificity': 0.9878231, 'binary_f1_score': 0.734231}
confusion matrix:
       0    1
0  17847  220
1    155  518
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9655172, 'precision': 0.8496872, 'recall': 0.6381142, 'specificity': 0.6381142, 'f1': 0.6938996, 'auroc': 0.9496654, 'binary_precision': 0.73, 'binary_recall': 0.28076923, 'binary_specificity': 0.99545914, 'binary_f1_score': 0.40555555}
confusion matrix:
      0   1
0  5919  27
1   187  73
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863845.png
new oracle model saved
early stop counter: 1
val acc:0.9799893498420715, best validation acc: 0.9800426959991455, corresponding to test acc:                         0.9598775506019592 / 0.9655172228813171
after epoch: 7,now: 2024-05-27 21:20:16.986157,epoch time: 0:23:46.952926,used: 2:50:27.213736,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_18_29_49_seed_1_20863845
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.984489, 'precision': 0.96880484, 'recall': 0.77761424, 'specificity': 0.77761424, 'f1': 0.8471569, 'auroc': 0.99089277, 'binary_precision': 0.9524941, 'binary_recall': 0.55617195, 'binary_specificity': 0.9990566, 'binary_f1_score': 0.70227665}
confusion matrix:
       0    1
0  42358   40
1    640  802
---- Validation: 
scalar performance:
{'acc': 0.98148346, 'precision': 0.9443112, 'recall': 0.76937926, 'specificity': 0.76937926, 'f1': 0.8338389, 'auroc': 0.98258376, 'binary_precision': 0.90547264, 'binary_recall': 0.5408618, 'binary_specificity': 0.99789673, 'binary_f1_score': 0.6772093}
confusion matrix:
       0    1
0  18029   38
1    309  364
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959233, 'precision': 0.8888326, 'recall': 0.5171395, 'specificity': 0.5171395, 'f1': 0.5227911, 'auroc': 0.9447549, 'binary_precision': 0.8181818, 'binary_recall': 0.034615386, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.06642067}
confusion matrix:
      0  1
0  5944  2
1   251  9
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863845.png
better model found
persisted
after epoch: 8,now: 2024-05-27 21:44:12.163339,epoch time: 0:23:55.177182,used: 3:14:22.390918,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_18_29_49_seed_1_20863845
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98807025, 'precision': 0.89836395, 'recall': 0.91942054, 'specificity': 0.91942054, 'f1': 0.9085986, 'auroc': 0.9926598, 'binary_precision': 0.8019737, 'binary_recall': 0.8459403, 'binary_specificity': 0.9929008, 'binary_f1_score': 0.8233705}
confusion matrix:
       0     1
0  42098   301
1    222  1219
---- Validation: 
scalar performance:
{'acc': 0.9809498, 'precision': 0.8622843, 'recall': 0.8628025, 'specificity': 0.8628025, 'f1': 0.8625432, 'auroc': 0.9769189, 'binary_precision': 0.7344214, 'binary_recall': 0.7355126, 'binary_specificity': 0.99009246, 'binary_f1_score': 0.73496664}
confusion matrix:
       0    1
0  17888  179
1    178  495
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9624557, 'precision': 0.8185506, 'recall': 0.5997367, 'specificity': 0.5997367, 'f1': 0.6466926, 'auroc': 0.9350761, 'binary_precision': 0.6708861, 'binary_recall': 0.20384616, 'binary_specificity': 0.9956273, 'binary_f1_score': 0.31268436}
confusion matrix:
      0   1
0  5920  26
1   207  53
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863845.png
early stop counter: 1
val acc:0.9809498190879822, best validation acc: 0.9814834594726562, corresponding to test acc:                         0.9592329859733582 / 0.9655172228813171
after epoch: 9,now: 2024-05-27 22:08:47.729904,epoch time: 0:24:35.566565,used: 3:38:57.957483,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_18_29_49_seed_1_20863845
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98900545, 'precision': 0.90511715, 'recall': 0.9273262, 'specificity': 0.9273262, 'f1': 0.9159009, 'auroc': 0.99354064, 'binary_precision': 0.81496066, 'binary_recall': 0.86130375, 'binary_specificity': 0.9933487, 'binary_f1_score': 0.8374916}
confusion matrix:
       0     1
0  42116   282
1    200  1242
---- Validation: 
scalar performance:
{'acc': 0.9783885, 'precision': 0.8267644, 'recall': 0.9022443, 'specificity': 0.9022443, 'f1': 0.8601756, 'auroc': 0.97626597, 'binary_precision': 0.6602871, 'binary_recall': 0.820208, 'binary_specificity': 0.9842807, 'binary_f1_score': 0.7316103}
confusion matrix:
       0    1
0  17783  284
1    121  552
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9634225, 'precision': 0.83290243, 'recall': 0.6094362, 'specificity': 0.6094362, 'f1': 0.65969193, 'auroc': 0.94057655, 'binary_precision': 0.6987952, 'binary_recall': 0.22307692, 'binary_specificity': 0.9957955, 'binary_f1_score': 0.33819243}
confusion matrix:
      0   1
0  5921  25
1   202  58
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863845.png
early stop counter: 2
val acc:0.9783884882926941, best validation acc: 0.9814834594726562, corresponding to test acc:                         0.9592329859733582 / 0.9655172228813171
after epoch: 10,now: 2024-05-27 22:32:17.683892,epoch time: 0:23:29.953988,used: 4:02:27.911471,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_18_29_49_seed_1_20863845
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99046534, 'precision': 0.9355131, 'recall': 0.91093826, 'specificity': 0.91093826, 'f1': 0.92284155, 'auroc': 0.9945917, 'binary_precision': 0.8769344, 'binary_recall': 0.8258154, 'binary_specificity': 0.9960612, 'binary_f1_score': 0.85060763}
confusion matrix:
       0     1
0  42232   167
1    251  1190
---- Validation: 
scalar performance:
{'acc': 0.9853255, 'precision': 0.918198, 'recall': 0.8586345, 'specificity': 0.8586345, 'f1': 0.88594043, 'auroc': 0.97809505, 'binary_precision': 0.8466899, 'binary_recall': 0.72213966, 'binary_specificity': 0.9951292, 'binary_f1_score': 0.7794707}
confusion matrix:
       0    1
0  17979   88
1    187  486
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.962778, 'precision': 0.8930134, 'recall': 0.5704811, 'specificity': 0.5704811, 'f1': 0.6117715, 'auroc': 0.9460468, 'binary_precision': 0.82222223, 'binary_recall': 0.1423077, 'binary_specificity': 0.99865454, 'binary_f1_score': 0.24262296}
confusion matrix:
      0   1
0  5938   8
1   223  37
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863845.png
better model found
persisted
after epoch: 11,now: 2024-05-27 22:55:22.435263,epoch time: 0:23:04.751371,used: 4:25:32.662842,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_18_29_49_seed_1_20863845
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9898266, 'precision': 0.9174713, 'recall': 0.92362946, 'specificity': 0.92362946, 'f1': 0.920526, 'auroc': 0.9947275, 'binary_precision': 0.83994526, 'binary_recall': 0.8527778, 'binary_specificity': 0.99448115, 'binary_f1_score': 0.8463129}
confusion matrix:
       0     1
0  42166   234
1    212  1228
---- Validation: 
scalar performance:
{'acc': 0.9830843, 'precision': 0.89390004, 'recall': 0.85031945, 'specificity': 0.85031945, 'f1': 0.8707214, 'auroc': 0.9720812, 'binary_precision': 0.7986577, 'binary_recall': 0.7072808, 'binary_specificity': 0.9933581, 'binary_f1_score': 0.75019705}
confusion matrix:
       0    1
0  17947  120
1    197  476
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96036094, 'precision': 0.85565716, 'recall': 0.539796, 'specificity': 0.539796, 'f1': 0.5627715, 'auroc': 0.92325157, 'binary_precision': 0.75, 'binary_recall': 0.08076923, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.14583333}
confusion matrix:
      0   1
0  5939   7
1   239  21
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863845.png
early stop counter: 1
val acc:0.9830843210220337, best validation acc: 0.9853255152702332, corresponding to test acc:                         0.9627779722213745 / 0.9655172228813171
after epoch: 12,now: 2024-05-27 23:18:22.015233,epoch time: 0:22:59.579970,used: 4:48:32.242812,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_18_29_49_seed_1_20863845
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98923355, 'precision': 0.9315641, 'recall': 0.89327955, 'specificity': 0.89327955, 'f1': 0.9114654, 'auroc': 0.994547, 'binary_precision': 0.870229, 'binary_recall': 0.79056865, 'binary_specificity': 0.9959904, 'binary_f1_score': 0.8284884}
confusion matrix:
       0     1
0  42228   170
1    302  1140
---- Validation: 
scalar performance:
{'acc': 0.98052293, 'precision': 0.9240574, 'recall': 0.76959634, 'specificity': 0.76959634, 'f1': 0.8283175, 'auroc': 0.9625847, 'binary_precision': 0.8649289, 'binary_recall': 0.54234767, 'binary_specificity': 0.99684507, 'binary_f1_score': 0.66666657}
confusion matrix:
       0    1
0  18010   57
1    308  365
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.962778, 'precision': 0.80201674, 'recall': 0.62748975, 'specificity': 0.62748975, 'f1': 0.6756971, 'auroc': 0.9457743, 'binary_precision': 0.635514, 'binary_recall': 0.26153848, 'binary_specificity': 0.993441, 'binary_f1_score': 0.3705722}
confusion matrix:
      0   1
0  5907  39
1   192  68
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863845.png
early stop counter: 2
val acc:0.9805229306221008, best validation acc: 0.9853255152702332, corresponding to test acc:                         0.9627779722213745 / 0.9655172228813171
after epoch: 13,now: 2024-05-27 23:41:21.449183,epoch time: 0:22:59.433950,used: 5:11:31.676762,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_18_29_49_seed_1_20863845
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.991104, 'precision': 0.91476625, 'recall': 0.9535322, 'specificity': 0.9535322, 'f1': 0.9332124, 'auroc': 0.9970591, 'binary_precision': 0.8324905, 'binary_recall': 0.9133148, 'binary_specificity': 0.9937497, 'binary_f1_score': 0.87103176}
confusion matrix:
       0     1
0  42133   265
1    125  1317
---- Validation: 
scalar performance:
{'acc': 0.98628604, 'precision': 0.89459467, 'recall': 0.9120624, 'specificity': 0.9120624, 'f1': 0.90312195, 'auroc': 0.9796493, 'binary_precision': 0.79545456, 'binary_recall': 0.8320951, 'binary_specificity': 0.99202967, 'binary_f1_score': 0.8133624}
confusion matrix:
       0    1
0  17923  144
1    113  560
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96310025, 'precision': 0.81084406, 'recall': 0.6239799, 'specificity': 0.6239799, 'f1': 0.67332417, 'auroc': 0.94260216, 'binary_precision': 0.65346533, 'binary_recall': 0.25384617, 'binary_specificity': 0.9941137, 'binary_f1_score': 0.36565098}
confusion matrix:
      0   1
0  5911  35
1   194  66
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863845.png
better model found
persisted
after epoch: 14,now: 2024-05-28 00:04:29.679405,epoch time: 0:23:08.230222,used: 5:34:39.906984,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_18_29_49_seed_1_20863845
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9910584, 'precision': 0.9214917, 'recall': 0.9417855, 'specificity': 0.9417855, 'f1': 0.93138075, 'auroc': 0.99648917, 'binary_precision': 0.84676355, 'binary_recall': 0.889043, 'binary_specificity': 0.99452806, 'binary_f1_score': 0.86738837}
confusion matrix:
       0     1
0  42166   232
1    160  1282
---- Validation: 
scalar performance:
{'acc': 0.98404485, 'precision': 0.89369154, 'recall': 0.86941457, 'specificity': 0.86941457, 'f1': 0.88113236, 'auroc': 0.9689013, 'binary_precision': 0.7968254, 'binary_recall': 0.7459138, 'binary_specificity': 0.9929153, 'binary_f1_score': 0.7705296}
confusion matrix:
       0    1
0  17939  128
1    171  502
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.962778, 'precision': 0.9175741, 'recall': 0.5649642, 'specificity': 0.5649642, 'f1': 0.6041772, 'auroc': 0.8802736, 'binary_precision': 0.8717949, 'binary_recall': 0.13076924, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.22742477}
confusion matrix:
      0   1
0  5941   5
1   226  34
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863845.png
early stop counter: 1
val acc:0.9840448498725891, best validation acc: 0.9862860441207886, corresponding to test acc:                         0.963100254535675 / 0.9655172228813171
after epoch: 15,now: 2024-05-28 00:27:39.009850,epoch time: 0:23:09.330445,used: 5:57:49.237429,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_18_29_49_seed_1_20863845
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9921533, 'precision': 0.9786937, 'recall': 0.894789, 'specificity': 0.894789, 'f1': 0.932429, 'auroc': 0.997256, 'binary_precision': 0.964467, 'binary_recall': 0.79056865, 'binary_specificity': 0.9990094, 'binary_f1_score': 0.8689024}
confusion matrix:
       0     1
0  42356    42
1    302  1140
---- Validation: 
scalar performance:
{'acc': 0.98372465, 'precision': 0.9340798, 'recall': 0.81417286, 'specificity': 0.81417286, 'f1': 0.86376715, 'auroc': 0.9759946, 'binary_precision': 0.8817427, 'binary_recall': 0.6315007, 'binary_specificity': 0.99684507, 'binary_f1_score': 0.73593074}
confusion matrix:
       0    1
0  18010   57
1    248  425
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96100545, 'precision': 0.8808938, 'recall': 0.5456493, 'specificity': 0.5456493, 'f1': 0.5727768, 'auroc': 0.91538703, 'binary_precision': 0.8, 'binary_recall': 0.092307694, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.16551724}
confusion matrix:
      0   1
0  5940   6
1   236  24
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863845.png
early stop counter: 2
val acc:0.9837246537208557, best validation acc: 0.9862860441207886, corresponding to test acc:                         0.963100254535675 / 0.9655172228813171
after epoch: 16,now: 2024-05-28 00:51:02.277214,epoch time: 0:23:23.267364,used: 6:21:12.504793,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_18_29_49_seed_1_20863845
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9934763, 'precision': 0.9748694, 'recall': 0.9199242, 'specificity': 0.9199242, 'f1': 0.9455884, 'auroc': 0.99829197, 'binary_precision': 0.9551181, 'binary_recall': 0.8411928, 'binary_specificity': 0.9986556, 'binary_f1_score': 0.8945428}
confusion matrix:
       0     1
0  42341    57
1    229  1213
---- Validation: 
scalar performance:
{'acc': 0.98655283, 'precision': 0.9534596, 'recall': 0.84210455, 'specificity': 0.84210455, 'f1': 0.8893864, 'auroc': 0.97303045, 'binary_precision': 0.91848904, 'binary_recall': 0.68647844, 'binary_specificity': 0.9977307, 'binary_f1_score': 0.78571427}
confusion matrix:
       0    1
0  18026   41
1    211  462
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96165, 'precision': 0.9424446, 'recall': 0.5459857, 'specificity': 0.5459857, 'f1': 0.57410246, 'auroc': 0.89046586, 'binary_precision': 0.9230769, 'binary_recall': 0.092307694, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.16783217}
confusion matrix:
      0   1
0  5944   2
1   236  24
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863845.png
better model found
persisted
after epoch: 17,now: 2024-05-28 01:14:05.171469,epoch time: 0:23:02.894255,used: 6:44:15.399048,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_18_29_49_seed_1_20863845
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9940465, 'precision': 0.9604199, 'recall': 0.9446702, 'specificity': 0.9446702, 'f1': 0.9523977, 'auroc': 0.9981819, 'binary_precision': 0.9245147, 'binary_recall': 0.8918169, 'binary_specificity': 0.9975235, 'binary_f1_score': 0.90787154}
confusion matrix:
       0     1
0  42293   105
1    156  1286
---- Validation: 
scalar performance:
{'acc': 0.98569906, 'precision': 0.91485786, 'recall': 0.86955714, 'specificity': 0.86955714, 'f1': 0.8907876, 'auroc': 0.9775303, 'binary_precision': 0.83919597, 'binary_recall': 0.7444279, 'binary_specificity': 0.9946864, 'binary_f1_score': 0.7889764}
confusion matrix:
       0    1
0  17971   96
1    172  501
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590719, 'precision': 0.7701806, 'recall': 0.5409622, 'specificity': 0.5409622, 'f1': 0.56334174, 'auroc': 0.91752046, 'binary_precision': 0.57894737, 'binary_recall': 0.08461539, 'binary_specificity': 0.9973091, 'binary_f1_score': 0.147651}
confusion matrix:
      0   1
0  5930  16
1   238  22
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863845.png
early stop counter: 1
val acc:0.9856990575790405, best validation acc: 0.9865528345108032, corresponding to test acc:                         0.961650013923645 / 0.9655172228813171
after epoch: 18,now: 2024-05-28 01:37:09.269652,epoch time: 0:23:04.098183,used: 7:07:19.497231,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_18_29_49_seed_1_20863845
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.994229, 'precision': 0.96987903, 'recall': 0.9373529, 'specificity': 0.9373529, 'f1': 0.95299006, 'auroc': 0.9978256, 'binary_precision': 0.9439462, 'binary_recall': 0.8764747, 'binary_specificity': 0.9982311, 'binary_f1_score': 0.9089601}
confusion matrix:
       0     1
0  42324    75
1    178  1263
---- Validation: 
scalar performance:
{'acc': 0.9861793, 'precision': 0.93293166, 'recall': 0.8562162, 'specificity': 0.8562162, 'f1': 0.8905411, 'auroc': 0.9775418, 'binary_precision': 0.87636364, 'binary_recall': 0.7161961, 'binary_specificity': 0.9962362, 'binary_f1_score': 0.78822565}
confusion matrix:
       0    1
0  17999   68
1    191  482
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621334, 'precision': 0.87062883, 'recall': 0.5664668, 'specificity': 0.5664668, 'f1': 0.60504895, 'auroc': 0.9178683, 'binary_precision': 0.7777778, 'binary_recall': 0.13461539, 'binary_specificity': 0.9983182, 'binary_f1_score': 0.2295082}
confusion matrix:
      0   1
0  5936  10
1   225  35
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863845.png
early stop counter: 2
val acc:0.9861792922019958, best validation acc: 0.9865528345108032, corresponding to test acc:                         0.961650013923645 / 0.9655172228813171
after epoch: 19,now: 2024-05-28 02:00:11.574031,epoch time: 0:23:02.304379,used: 7:30:21.801610,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_18_29_49_seed_1_20863845
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99053377, 'precision': 0.9759097, 'recall': 0.870751, 'specificity': 0.870751, 'f1': 0.91634905, 'auroc': 0.99780524, 'binary_precision': 0.9605027, 'binary_recall': 0.7425399, 'binary_specificity': 0.9989622, 'binary_f1_score': 0.8375734}
confusion matrix:
       0     1
0  42355    44
1    371  1070
---- Validation: 
scalar performance:
{'acc': 0.98121667, 'precision': 0.92808414, 'recall': 0.77782404, 'specificity': 0.77782404, 'f1': 0.8357413, 'auroc': 0.9770049, 'binary_precision': 0.8723898, 'binary_recall': 0.5586924, 'binary_specificity': 0.99695575, 'binary_f1_score': 0.6811594}
confusion matrix:
       0    1
0  18012   55
1    297  376
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96036094, 'precision': 0.9053589, 'recall': 0.53244, 'specificity': 0.53244, 'f1': 0.5505758, 'auroc': 0.9111322, 'binary_precision': 0.85, 'binary_recall': 0.06538462, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.12142858}
confusion matrix:
      0   1
0  5943   3
1   243  17
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863845.png
early stop counter: 3
val acc:0.9812166690826416, best validation acc: 0.9865528345108032, corresponding to test acc:                         0.961650013923645 / 0.9655172228813171
after epoch: 20,now: 2024-05-28 02:23:20.416909,epoch time: 0:23:08.842878,used: 7:53:30.644488,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_18_29_49_seed_1_20863845
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9933394, 'precision': 0.9872226, 'recall': 0.9063908, 'specificity': 0.9063908, 'f1': 0.9428963, 'auroc': 0.9984305, 'binary_precision': 0.9807531, 'binary_recall': 0.8133241, 'binary_specificity': 0.99945754, 'binary_f1_score': 0.88922614}
confusion matrix:
       0     1
0  42376    23
1    269  1172
---- Validation: 
scalar performance:
{'acc': 0.9835112, 'precision': 0.9406872, 'recall': 0.80476373, 'specificity': 0.80476373, 'f1': 0.85938567, 'auroc': 0.97702026, 'binary_precision': 0.8956522, 'binary_recall': 0.6121842, 'binary_specificity': 0.99734324, 'binary_f1_score': 0.72727275}
confusion matrix:
       0    1
0  18019   48
1    261  412
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9585885, 'precision': 0.76566577, 'recall': 0.52232015, 'specificity': 0.52232015, 'f1': 0.53211194, 'auroc': 0.9056767, 'binary_precision': 0.5714286, 'binary_recall': 0.046153847, 'binary_specificity': 0.9984864, 'binary_f1_score': 0.085409254}
confusion matrix:
      0   1
0  5937   9
1   248  12
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863845.png
early stop counter: 4
val acc:0.983511209487915, best validation acc: 0.9865528345108032, corresponding to test acc:                         0.961650013923645 / 0.9655172228813171
after epoch: 21,now: 2024-05-28 02:46:30.756132,epoch time: 0:23:10.339223,used: 8:16:40.983711,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_18_29_49_seed_1_20863845
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99587137, 'precision': 0.97717106, 'recall': 0.9570018, 'specificity': 0.9570018, 'f1': 0.9668527, 'auroc': 0.9988829, 'binary_precision': 0.95721537, 'binary_recall': 0.91539526, 'binary_specificity': 0.9986084, 'binary_f1_score': 0.9358384}
confusion matrix:
       0     1
0  42339    59
1    122  1320
---- Validation: 
scalar performance:
{'acc': 0.98751336, 'precision': 0.9422255, 'recall': 0.8683523, 'specificity': 0.8683523, 'f1': 0.9016504, 'auroc': 0.97661245, 'binary_precision': 0.8940754, 'binary_recall': 0.73997027, 'binary_specificity': 0.9967344, 'binary_f1_score': 0.8097561}
confusion matrix:
       0    1
0  18008   59
1    175  498
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95939416, 'precision': 0.8072629, 'recall': 0.5319355, 'specificity': 0.5319355, 'f1': 0.5490497, 'auroc': 0.9163414, 'binary_precision': 0.65384614, 'binary_recall': 0.06538462, 'binary_specificity': 0.9984864, 'binary_f1_score': 0.11888112}
confusion matrix:
      0   1
0  5937   9
1   243  17
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863845.png
better model found
persisted
after epoch: 22,now: 2024-05-28 03:09:39.040616,epoch time: 0:23:08.284484,used: 8:39:49.268195,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_18_29_49_seed_1_20863845
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99409217, 'precision': 0.9409375, 'recall': 0.97013056, 'specificity': 0.97013056, 'f1': 0.95502925, 'auroc': 0.9987502, 'binary_precision': 0.88376623, 'binary_recall': 0.944483, 'binary_specificity': 0.9957782, 'binary_f1_score': 0.9131164}
confusion matrix:
       0     1
0  42220   179
1     80  1361
---- Validation: 
scalar performance:
{'acc': 0.9858591, 'precision': 0.9007014, 'recall': 0.893244, 'specificity': 0.893244, 'f1': 0.8969345, 'auroc': 0.97595483, 'binary_precision': 0.8090909, 'binary_recall': 0.7934621, 'binary_specificity': 0.99302596, 'binary_f1_score': 0.8012003}
confusion matrix:
       0    1
0  17941  126
1    139  534
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9626168, 'precision': 0.80973107, 'recall': 0.6126937, 'specificity': 0.6126937, 'f1': 0.660836, 'auroc': 0.93704104, 'binary_precision': 0.65217394, 'binary_recall': 0.23076923, 'binary_specificity': 0.99461824, 'binary_f1_score': 0.34090912}
confusion matrix:
      0   1
0  5914  32
1   200  60
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863845.png
early stop counter: 1
val acc:0.9858590960502625, best validation acc: 0.9875133633613586, corresponding to test acc:                         0.9593941569328308 / 0.9655172228813171
after epoch: 23,now: 2024-05-28 03:32:47.815736,epoch time: 0:23:08.775120,used: 9:02:58.043315,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_18_29_49_seed_1_20863845
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.994708, 'precision': 0.982569, 'recall': 0.93252623, 'specificity': 0.93252623, 'f1': 0.95608133, 'auroc': 0.99903846, 'binary_precision': 0.9696734, 'binary_recall': 0.8659722, 'binary_specificity': 0.9990802, 'binary_f1_score': 0.91489357}
confusion matrix:
       0     1
0  42361    39
1    193  1247
---- Validation: 
scalar performance:
{'acc': 0.9830843, 'precision': 0.9322462, 'recall': 0.80525756, 'specificity': 0.80525756, 'f1': 0.8569679, 'auroc': 0.9720681, 'binary_precision': 0.8787234, 'binary_recall': 0.6136701, 'binary_specificity': 0.99684507, 'binary_f1_score': 0.72265965}
confusion matrix:
       0    1
0  18010   57
1    260  413
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606832, 'precision': 0.8311871, 'recall': 0.5528371, 'specificity': 0.5528371, 'f1': 0.58326066, 'auroc': 0.90601116, 'binary_precision': 0.7, 'binary_recall': 0.10769231, 'binary_specificity': 0.99798185, 'binary_f1_score': 0.18666667}
confusion matrix:
      0   1
0  5934  12
1   232  28
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863845.png
early stop counter: 2
val acc:0.9830843210220337, best validation acc: 0.9875133633613586, corresponding to test acc:                         0.9593941569328308 / 0.9655172228813171
after epoch: 24,now: 2024-05-28 03:55:59.164625,epoch time: 0:23:11.348889,used: 9:26:09.392204,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_18_29_49_seed_1_20863845
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9957801, 'precision': 0.96608925, 'recall': 0.96765137, 'specificity': 0.96765137, 'f1': 0.96686894, 'auroc': 0.9990276, 'binary_precision': 0.9343015, 'binary_recall': 0.9375434, 'binary_specificity': 0.9977594, 'binary_f1_score': 0.93591964}
confusion matrix:
       0     1
0  42304    95
1     90  1351
---- Validation: 
scalar performance:
{'acc': 0.98596585, 'precision': 0.92124295, 'recall': 0.8661192, 'specificity': 0.8661192, 'f1': 0.8915889, 'auroc': 0.9806825, 'binary_precision': 0.85223365, 'binary_recall': 0.7369985, 'binary_specificity': 0.9952399, 'binary_f1_score': 0.7904382}
confusion matrix:
       0    1
0  17981   86
1    177  496
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9653561, 'precision': 0.8439849, 'recall': 0.6398691, 'specificity': 0.6398691, 'f1': 0.69493484, 'auroc': 0.94938827, 'binary_precision': 0.7184466, 'binary_recall': 0.2846154, 'binary_specificity': 0.9951228, 'binary_f1_score': 0.4077135}
confusion matrix:
      0   1
0  5917  29
1   186  74
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863845.png
early stop counter: 3
val acc:0.9859658479690552, best validation acc: 0.9875133633613586, corresponding to test acc:                         0.9593941569328308 / 0.9655172228813171
after epoch: 25,now: 2024-05-28 04:19:06.663825,epoch time: 0:23:07.499200,used: 9:49:16.891404,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_18_29_49_seed_1_20863845
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9937044, 'precision': 0.96337664, 'recall': 0.9353175, 'specificity': 0.9353175, 'f1': 0.94887656, 'auroc': 0.9974816, 'binary_precision': 0.93106, 'binary_recall': 0.87282836, 'binary_specificity': 0.99780667, 'binary_f1_score': 0.9010043}
confusion matrix:
       0     1
0  42308    93
1    183  1256
---- Validation: 
scalar performance:
{'acc': 0.9853255, 'precision': 0.94285965, 'recall': 0.83216953, 'specificity': 0.83216953, 'f1': 0.8789921, 'auroc': 0.9713828, 'binary_precision': 0.898, 'binary_recall': 0.66716194, 'binary_specificity': 0.9971772, 'binary_f1_score': 0.7655584}
confusion matrix:
       0    1
0  18016   51
1    224  449
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96036094, 'precision': 0.9053589, 'recall': 0.53244, 'specificity': 0.53244, 'f1': 0.5505758, 'auroc': 0.92833465, 'binary_precision': 0.85, 'binary_recall': 0.06538462, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.12142858}
confusion matrix:
      0   1
0  5943   3
1   243  17
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863845.png
early stop counter: 4
val acc:0.9853255152702332, best validation acc: 0.9875133633613586, corresponding to test acc:                         0.9593941569328308 / 0.9655172228813171
after epoch: 26,now: 2024-05-28 04:42:20.162461,epoch time: 0:23:13.498636,used: 10:12:30.390040,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_18_29_49_seed_1_20863845
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9959854, 'precision': 0.9669962, 'recall': 0.97012377, 'specificity': 0.97012377, 'f1': 0.9685543, 'auroc': 0.9992224, 'binary_precision': 0.9359504, 'binary_recall': 0.94244105, 'binary_specificity': 0.9978065, 'binary_f1_score': 0.9391844}
confusion matrix:
       0     1
0  42305    93
1     83  1359
---- Validation: 
scalar performance:
{'acc': 0.9872465, 'precision': 0.9306642, 'recall': 0.8767972, 'specificity': 0.8767972, 'f1': 0.9017842, 'auroc': 0.9791645, 'binary_precision': 0.87030715, 'binary_recall': 0.7578009, 'binary_specificity': 0.99579346, 'binary_f1_score': 0.8101668}
confusion matrix:
       0    1
0  17991   76
1    163  510
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96019983, 'precision': 0.8237355, 'recall': 0.54522884, 'specificity': 0.54522884, 'f1': 0.57116365, 'auroc': 0.9076538, 'binary_precision': 0.6857143, 'binary_recall': 0.092307694, 'binary_specificity': 0.99815, 'binary_f1_score': 0.16271187}
confusion matrix:
      0   1
0  5935  11
1   236  24
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863845.png
early stop counter: 5
val acc:0.9872465133666992, best validation acc: 0.9875133633613586, corresponding to test acc:                         0.9593941569328308 / 0.9655172228813171
after epoch: 27,now: 2024-05-28 05:05:30.704034,epoch time: 0:23:10.541573,used: 10:35:40.931613,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_18_29_49_seed_1_20863845
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99589413, 'precision': 0.96628386, 'recall': 0.9694067, 'specificity': 0.9694067, 'f1': 0.9678397, 'auroc': 0.99887544, 'binary_precision': 0.934573, 'binary_recall': 0.9410541, 'binary_specificity': 0.99775934, 'binary_f1_score': 0.9378024}
confusion matrix:
       0     1
0  42303    95
1     85  1357
---- Validation: 
scalar performance:
{'acc': 0.9874066, 'precision': 0.9310764, 'recall': 0.879026, 'specificity': 0.879026, 'f1': 0.90323955, 'auroc': 0.977298, 'binary_precision': 0.87096775, 'binary_recall': 0.7622585, 'binary_specificity': 0.99579346, 'binary_f1_score': 0.8129952}
confusion matrix:
       0    1
0  17991   76
1    160  513
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95987755, 'precision': 0.81935745, 'recall': 0.5395437, 'specificity': 0.5395437, 'f1': 0.56189346, 'auroc': 0.91476893, 'binary_precision': 0.67741936, 'binary_recall': 0.08076923, 'binary_specificity': 0.9983182, 'binary_f1_score': 0.1443299}
confusion matrix:
      0   1
0  5936  10
1   239  21
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863845.png
early stop counter: 6
val acc:0.9874066114425659, best validation acc: 0.9875133633613586, corresponding to test acc:                         0.9593941569328308 / 0.9655172228813171
after epoch: 28,now: 2024-05-28 05:28:35.382048,epoch time: 0:23:04.678014,used: 10:58:45.609627,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_18_29_49_seed_1_20863845
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9966241, 'precision': 0.9737507, 'recall': 0.97311556, 'specificity': 0.97311556, 'f1': 0.9734329, 'auroc': 0.9989687, 'binary_precision': 0.9492703, 'binary_recall': 0.9479528, 'binary_specificity': 0.99827826, 'binary_f1_score': 0.94861114}
confusion matrix:
       0     1
0  42326    73
1     75  1366
---- Validation: 
scalar performance:
{'acc': 0.98655283, 'precision': 0.9223441, 'recall': 0.87500685, 'specificity': 0.87500685, 'f1': 0.8971514, 'auroc': 0.969977, 'binary_precision': 0.8537815, 'binary_recall': 0.7548291, 'binary_specificity': 0.9951846, 'binary_f1_score': 0.8012618}
confusion matrix:
       0    1
0  17980   87
1    165  508
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9671286, 'precision': 0.8674033, 'recall': 0.653667, 'specificity': 0.653667, 'f1': 0.71284395, 'auroc': 0.92081857, 'binary_precision': 0.7641509, 'binary_recall': 0.31153846, 'binary_specificity': 0.9957955, 'binary_f1_score': 0.44262296}
confusion matrix:
      0   1
0  5921  25
1   179  81
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863845.png
new oracle model saved
early stop counter: 7
val acc:0.9865528345108032, best validation acc: 0.9875133633613586, corresponding to test acc:                         0.9593941569328308 / 0.967128574848175
after epoch: 29,now: 2024-05-28 05:51:44.612484,epoch time: 0:23:09.230436,used: 11:21:54.840063,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_18_29_49_seed_1_20863845
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99619067, 'precision': 0.97629076, 'recall': 0.96319604, 'specificity': 0.96319604, 'f1': 0.9696454, 'auroc': 0.99941754, 'binary_precision': 0.9550321, 'binary_recall': 0.92787796, 'binary_specificity': 0.99851406, 'binary_f1_score': 0.94125926}
confusion matrix:
       0     1
0  42335    63
1    104  1338
---- Validation: 
scalar performance:
{'acc': 0.986873, 'precision': 0.94644195, 'recall': 0.8537149, 'specificity': 0.8537149, 'f1': 0.8942801, 'auroc': 0.9731916, 'binary_precision': 0.9035917, 'binary_recall': 0.7102526, 'binary_specificity': 0.9971772, 'binary_f1_score': 0.79534113}
confusion matrix:
       0    1
0  18016   51
1    195  478
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9622946, 'precision': 0.8619688, 'recall': 0.57206786, 'specificity': 0.57206786, 'f1': 0.6129128, 'auroc': 0.9362257, 'binary_precision': 0.76, 'binary_recall': 0.14615385, 'binary_specificity': 0.99798185, 'binary_f1_score': 0.2451613}
confusion matrix:
      0   1
0  5934  12
1   222  38
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20863845.png
early stop counter: 8
val acc:0.9868729710578918, best validation acc: 0.9875133633613586, corresponding to test acc:                         0.9593941569328308 / 0.967128574848175
after epoch: 30,now: 2024-05-28 06:14:58.521208,epoch time: 0:23:13.908724,used: 11:45:08.748787,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_18_29_49_seed_1_20863845
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 11:45:08.748787 at 2024-05-28 06:14:58.521208
persisted model performance metric: 

scalar performance:
{'acc': 0.9597164, 'precision': 0.8439081, 'recall': 0.5302647, 'specificity': 0.5302647, 'f1': 0.54643255, 'auroc': 0.90931106, 'binary_precision': 0.72727275, 'binary_recall': 0.06153846, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.11347518}
confusion matrix:
      0   1
0  5940   6
1   244  16
oracle model performance metric: 

scalar performance:
{'acc': 0.96809536, 'precision': 0.8652823, 'recall': 0.6725614, 'specificity': 0.6725614, 'f1': 0.73124564, 'auroc': 0.92719054, 'binary_precision': 0.7583333, 'binary_recall': 0.35, 'binary_specificity': 0.9951228, 'binary_f1_score': 0.47894734}
confusion matrix:
      0   1
0  5917  29
1   169  91
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs32/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs32/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1662 MiB |  30289 MiB |   1985 TiB |   1985 TiB |
|       from large pool |   1656 MiB |  30244 MiB |   1972 TiB |   1972 TiB |
|       from small pool |      5 MiB |     46 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1662 MiB |  30289 MiB |   1985 TiB |   1985 TiB |
|       from large pool |   1656 MiB |  30244 MiB |   1972 TiB |   1972 TiB |
|       from small pool |      5 MiB |     46 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1653 MiB |  30205 MiB |   1979 TiB |   1979 TiB |
|       from large pool |   1647 MiB |  30159 MiB |   1966 TiB |   1966 TiB |
|       from small pool |      5 MiB |     46 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  31418 MiB |  31418 MiB |  60516 MiB |  29098 MiB |
|       from large pool |  31370 MiB |  31370 MiB |  60466 MiB |  29096 MiB |
|       from small pool |     48 MiB |     48 MiB |     50 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 650768 KiB |   1088 MiB | 234267 GiB | 234266 GiB |
|       from large pool | 611808 KiB |   1086 MiB | 220558 GiB | 220558 GiB |
|       from small pool |  38960 KiB |     43 MiB |  13708 GiB |  13708 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2178    |    3623    |  152356 K  |  152354 K  |
|       from large pool |     247    |     989    |   62411 K  |   62411 K  |
|       from small pool |    1931    |    3374    |   89944 K  |   89942 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2178    |    3623    |  152356 K  |  152354 K  |
|       from large pool |     247    |     989    |   62411 K  |   62411 K  |
|       from small pool |    1931    |    3374    |   89944 K  |   89942 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     856    |     860    |    1592    |     736    |
|       from large pool |     832    |     836    |    1567    |     735    |
|       from small pool |      24    |      24    |      25    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     147    |    1502    |   84392 K  |   84392 K  |
|       from large pool |     103    |     544    |   40504 K  |   40504 K  |
|       from small pool |      44    |    1398    |   43888 K  |   43888 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  30289 MiB |   1985 TiB |   1985 TiB |
|       from large pool |  16640 KiB |  30244 MiB |   1972 TiB |   1972 TiB |
|       from small pool |      0 KiB |     46 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  30289 MiB |   1985 TiB |   1985 TiB |
|       from large pool |  16640 KiB |  30244 MiB |   1972 TiB |   1972 TiB |
|       from small pool |      0 KiB |     46 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  30205 MiB |   1979 TiB |   1979 TiB |
|       from large pool |  16640 KiB |  30159 MiB |   1966 TiB |   1966 TiB |
|       from small pool |      0 KiB |     46 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2298 MiB |  31418 MiB |  60516 MiB |  58218 MiB |
|       from large pool |   2254 MiB |  31370 MiB |  60466 MiB |  58212 MiB |
|       from small pool |     44 MiB |     48 MiB |     50 MiB |      6 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1088 MiB | 234267 GiB | 234267 GiB |
|       from large pool |  24320 KiB |   1086 MiB | 220559 GiB | 220559 GiB |
|       from small pool |      0 KiB |     43 MiB |  13708 GiB |  13708 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3623    |  152356 K  |  152356 K  |
|       from large pool |       2    |     989    |   62411 K  |   62411 K  |
|       from small pool |       0    |    3374    |   89944 K  |   89944 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3623    |  152356 K  |  152356 K  |
|       from large pool |       2    |     989    |   62411 K  |   62411 K  |
|       from small pool |       0    |    3374    |   89944 K  |   89944 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     123    |     860    |    1592    |    1469    |
|       from large pool |     101    |     836    |    1567    |    1466    |
|       from small pool |      22    |      24    |      25    |       3    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1502    |   84393 K  |   84393 K  |
|       from large pool |       3    |     544    |   40504 K  |   40504 K  |
|       from small pool |       0    |    1398    |   43888 K  |   43888 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Tue May 28 06:17:03 2024]
Finished job 0.
1 of 1 steps (100%) done
