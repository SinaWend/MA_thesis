Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Fri May 24 03:08:43 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_dial_irm/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_dial_irm/rule_results/5.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=5
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_03_20_50_seed_0_20754612

 Experiment start at: 2024-05-24 03:20:50.619370
before training, model accuracy: 0.2401725947856903
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/autograd/graph.py:744: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96750546, 'precision': 0.77025974, 'recall': 0.5661508, 'specificity': 0.5661508, 'f1': 0.60141295, 'auroc': 0.93858516, 'binary_precision': 0.56980056, 'binary_recall': 0.13586956, 'binary_specificity': 0.99643195, 'binary_f1_score': 0.21941853}
confusion matrix:
       0    1
0  42169  151
1   1272  200
---- Validation: 
scalar performance:
{'acc': 0.9673265, 'precision': 0.77220637, 'recall': 0.58630526, 'specificity': 0.58630526, 'f1': 0.62703633, 'auroc': 0.9380043, 'binary_precision': 0.5728643, 'binary_recall': 0.17729394, 'binary_specificity': 0.99531657, 'binary_f1_score': 0.27078384}
confusion matrix:
       0    1
0  18064   85
1    529  114
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96228826, 'precision': 0.9810685, 'recall': 0.5478927, 'specificity': 0.5478927, 'f1': 0.57776415, 'auroc': 0.9240257, 'binary_precision': 1.0, 'binary_recall': 0.09578544, 'binary_specificity': 1.0, 'binary_f1_score': 0.17482518}
confusion matrix:
      0   1
0  5997   0
1   236  25
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754612.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-24 04:04:48.228573,epoch time: 0:43:57.609203,used: 0:43:57.609203,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_03_20_50_seed_0_20754612
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9697433, 'precision': 0.81037724, 'recall': 0.60763526, 'specificity': 0.60763526, 'f1': 0.6561379, 'auroc': 0.9560257, 'binary_precision': 0.6472946, 'binary_recall': 0.21942934, 'binary_specificity': 0.9958412, 'binary_f1_score': 0.3277524}
confusion matrix:
       0    1
0  42144  176
1   1149  323
---- Validation: 
scalar performance:
{'acc': 0.96961474, 'precision': 0.8034605, 'recall': 0.63099307, 'specificity': 0.63099307, 'f1': 0.68019223, 'auroc': 0.9545129, 'binary_precision': 0.63235295, 'binary_recall': 0.2674961, 'binary_specificity': 0.99449, 'binary_f1_score': 0.37595627}
confusion matrix:
       0    1
0  18049  100
1    471  172
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.8543732, 'recall': 0.50566375, 'specificity': 0.50566375, 'f1': 0.5007502, 'auroc': 0.93147004, 'binary_precision': 0.75, 'binary_recall': 0.011494253, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.022641508}
confusion matrix:
      0  1
0  5996  1
1   258  3
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754612.png
better model found
persisted
after epoch: 2,now: 2024-05-24 04:45:58.486479,epoch time: 0:41:10.257906,used: 1:25:07.867109,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_03_20_50_seed_0_20754612
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9713418, 'precision': 0.79541147, 'recall': 0.6979679, 'specificity': 0.6979679, 'f1': 0.73619306, 'auroc': 0.9611412, 'binary_precision': 0.61128205, 'binary_recall': 0.4048913, 'binary_specificity': 0.9910444, 'binary_f1_score': 0.4871271}
confusion matrix:
       0    1
0  41941  379
1    876  596
---- Validation: 
scalar performance:
{'acc': 0.9723819, 'precision': 0.8143701, 'recall': 0.70593107, 'specificity': 0.70593107, 'f1': 0.74785274, 'auroc': 0.9614209, 'binary_precision': 0.64903843, 'binary_recall': 0.41990668, 'binary_specificity': 0.99195546, 'binary_f1_score': 0.50991493}
confusion matrix:
       0    1
0  18003  146
1    373  270
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.92983353, 'recall': 0.517158, 'specificity': 0.517158, 'f1': 0.5228796, 'auroc': 0.93806994, 'binary_precision': 0.9, 'binary_recall': 0.03448276, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.06642067}
confusion matrix:
      0  1
0  5996  1
1   252  9
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754612.png
better model found
persisted
after epoch: 3,now: 2024-05-24 05:25:27.385291,epoch time: 0:39:28.898812,used: 2:04:36.765921,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_03_20_50_seed_0_20754612
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97207254, 'precision': 0.799817, 'recall': 0.7153946, 'specificity': 0.7153946, 'f1': 0.7500563, 'auroc': 0.96764684, 'binary_precision': 0.61891115, 'binary_recall': 0.4402174, 'binary_specificity': 0.99057186, 'binary_f1_score': 0.5144899}
confusion matrix:
       0    1
0  41921  399
1    824  648
---- Validation: 
scalar performance:
{'acc': 0.9709983, 'precision': 0.7927257, 'recall': 0.71421546, 'specificity': 0.71421546, 'f1': 0.74681234, 'auroc': 0.9658673, 'binary_precision': 0.6051502, 'binary_recall': 0.43856922, 'binary_specificity': 0.9898617, 'binary_f1_score': 0.5085663}
confusion matrix:
       0    1
0  17965  184
1    361  282
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.9177147, 'recall': 0.5266532, 'specificity': 0.5266532, 'f1': 0.5403691, 'auroc': 0.9455964, 'binary_precision': 0.875, 'binary_recall': 0.053639848, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.10108303}
confusion matrix:
      0   1
0  5995   2
1   247  14
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754612.png
early stop counter: 1
val acc:0.9709982872009277, best validation acc: 0.9723818898200989, corresponding to test acc:                         0.9595717191696167 / 0.9622882604598999
after epoch: 4,now: 2024-05-24 06:01:48.961709,epoch time: 0:36:21.576418,used: 2:40:58.342339,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_03_20_50_seed_0_20754612
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97243786, 'precision': 0.78815234, 'recall': 0.7860734, 'specificity': 0.7860734, 'f1': 0.7871087, 'auroc': 0.9708452, 'binary_precision': 0.5906913, 'binary_recall': 0.5862772, 'binary_specificity': 0.9858696, 'binary_f1_score': 0.58847594}
confusion matrix:
       0    1
0  41722  598
1    609  863
---- Validation: 
scalar performance:
{'acc': 0.9725415, 'precision': 0.79947305, 'recall': 0.7570175, 'specificity': 0.7570175, 'f1': 0.77646756, 'auroc': 0.9680102, 'binary_precision': 0.61566484, 'binary_recall': 0.525661, 'binary_specificity': 0.988374, 'binary_f1_score': 0.5671141}
confusion matrix:
       0    1
0  17938  211
1    305  338
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96740174, 'precision': 0.8984796, 'recall': 0.6366804, 'specificity': 0.6366804, 'f1': 0.6985139, 'auroc': 0.9388318, 'binary_precision': 0.82758623, 'binary_recall': 0.27586207, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.41379312}
confusion matrix:
      0   1
0  5982  15
1   189  72
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754612.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-05-24 06:38:07.168009,epoch time: 0:36:18.206300,used: 3:17:16.548639,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_03_20_50_seed_0_20754612
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9715473, 'precision': 0.7779367, 'recall': 0.8098742, 'specificity': 0.8098742, 'f1': 0.79294455, 'auroc': 0.9735484, 'binary_precision': 0.56856793, 'binary_recall': 0.63654894, 'binary_specificity': 0.9831994, 'binary_f1_score': 0.600641}
confusion matrix:
       0    1
0  41609  711
1    535  937
---- Validation: 
scalar performance:
{'acc': 0.9722222, 'precision': 0.7948273, 'recall': 0.76285267, 'specificity': 0.76285267, 'f1': 0.77783203, 'auroc': 0.97084755, 'binary_precision': 0.60595447, 'binary_recall': 0.5381026, 'binary_specificity': 0.98760265, 'binary_f1_score': 0.5700165}
confusion matrix:
       0    1
0  17924  225
1    297  346
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96724194, 'precision': 0.93400127, 'recall': 0.62010604, 'specificity': 0.62010604, 'f1': 0.68192035, 'auroc': 0.9455929, 'binary_precision': 0.9, 'binary_recall': 0.2413793, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.38066468}
confusion matrix:
      0   1
0  5990   7
1   198  63
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754612.png
early stop counter: 1
val acc:0.9722222089767456, best validation acc: 0.9725415110588074, corresponding to test acc:                         0.9674017429351807 / 0.9674017429351807
after epoch: 6,now: 2024-05-24 07:14:39.090986,epoch time: 0:36:31.922977,used: 3:53:48.471616,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_03_20_50_seed_0_20754612
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9754978, 'precision': 0.8244134, 'recall': 0.7689686, 'specificity': 0.7689686, 'f1': 0.793867, 'auroc': 0.97654396, 'binary_precision': 0.6644683, 'binary_recall': 0.5475544, 'binary_specificity': 0.9903828, 'binary_f1_score': 0.60037243}
confusion matrix:
       0    1
0  41913  407
1    666  806
---- Validation: 
scalar performance:
{'acc': 0.9753619, 'precision': 0.84544736, 'recall': 0.7337258, 'specificity': 0.7337258, 'f1': 0.7779092, 'auroc': 0.9740026, 'binary_precision': 0.7093023, 'binary_recall': 0.47433904, 'binary_specificity': 0.99311256, 'binary_f1_score': 0.56849957}
confusion matrix:
       0    1
0  18024  125
1    338  305
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589326, 'precision': 0.8546, 'recall': 0.5113275, 'specificity': 0.5113275, 'f1': 0.51181245, 'auroc': 0.94845635, 'binary_precision': 0.75, 'binary_recall': 0.022988506, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.044609666}
confusion matrix:
      0  1
0  5995  2
1   255  6
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754612.png
better model found
persisted
after epoch: 7,now: 2024-05-24 07:51:17.702217,epoch time: 0:36:38.611231,used: 4:30:27.082847,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_03_20_50_seed_0_20754612
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9795853, 'precision': 0.87698257, 'recall': 0.7776406, 'specificity': 0.7776406, 'f1': 0.81917405, 'auroc': 0.98100007, 'binary_precision': 0.76908755, 'binary_recall': 0.5611413, 'binary_specificity': 0.9941399, 'binary_f1_score': 0.648861}
confusion matrix:
       0    1
0  42072  248
1    646  826
---- Validation: 
scalar performance:
{'acc': 0.97796935, 'precision': 0.90087134, 'recall': 0.72607505, 'specificity': 0.72607505, 'f1': 0.7873418, 'auroc': 0.979523, 'binary_precision': 0.8207283, 'binary_recall': 0.45567653, 'binary_specificity': 0.9964736, 'binary_f1_score': 0.586}
confusion matrix:
       0    1
0  18085   64
1    350  293
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96292746, 'precision': 0.93874335, 'recall': 0.56105256, 'specificity': 0.56105256, 'f1': 0.59861547, 'auroc': 0.9484031, 'binary_precision': 0.9142857, 'binary_recall': 0.12260536, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.2162162}
confusion matrix:
      0   1
0  5994   3
1   229  32
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754612.png
better model found
persisted
after epoch: 8,now: 2024-05-24 08:27:39.724805,epoch time: 0:36:22.022588,used: 5:06:49.105435,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_03_20_50_seed_0_20754612
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.97812384, 'precision': 0.85191226, 'recall': 0.7831138, 'specificity': 0.7831138, 'f1': 0.8134692, 'auroc': 0.98177814, 'binary_precision': 0.7185374, 'binary_recall': 0.57404894, 'binary_specificity': 0.9921786, 'binary_f1_score': 0.6382175}
confusion matrix:
       0    1
0  41989  331
1    627  845
---- Validation: 
scalar performance:
{'acc': 0.9782354, 'precision': 0.8680571, 'recall': 0.7682159, 'specificity': 0.7682159, 'f1': 0.8096602, 'auroc': 0.97869706, 'binary_precision': 0.7521552, 'binary_recall': 0.5427683, 'binary_specificity': 0.99366355, 'binary_f1_score': 0.6305329}
confusion matrix:
       0    1
0  18034  115
1    294  349
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96260786, 'precision': 0.94911337, 'recall': 0.5553888, 'specificity': 0.5553888, 'f1': 0.58974373, 'auroc': 0.95686984, 'binary_precision': 0.9354839, 'binary_recall': 0.11111111, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.19863014}
confusion matrix:
      0   1
0  5995   2
1   232  29
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754612.png
better model found
persisted
after epoch: 9,now: 2024-05-24 09:04:24.140315,epoch time: 0:36:44.415510,used: 5:43:33.520945,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_03_20_50_seed_0_20754612
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9811381, 'precision': 0.88559455, 'recall': 0.799427, 'specificity': 0.799427, 'f1': 0.8366595, 'auroc': 0.98277485, 'binary_precision': 0.7848325, 'binary_recall': 0.60461956, 'binary_specificity': 0.9942344, 'binary_f1_score': 0.6830392}
confusion matrix:
       0    1
0  42076  244
1    582  890
---- Validation: 
scalar performance:
{'acc': 0.9786611, 'precision': 0.881713, 'recall': 0.75943565, 'specificity': 0.75943565, 'f1': 0.80799663, 'auroc': 0.9804101, 'binary_precision': 0.7800926, 'binary_recall': 0.5241057, 'binary_specificity': 0.9947656, 'binary_f1_score': 0.6269767}
confusion matrix:
       0    1
0  18054   95
1    306  337
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9613295, 'precision': 0.8947692, 'recall': 0.5455601, 'specificity': 0.5455601, 'f1': 0.5728617, 'auroc': 0.9502145, 'binary_precision': 0.82758623, 'binary_recall': 0.09195402, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.16551723}
confusion matrix:
      0   1
0  5992   5
1   237  24
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754612.png
better model found
persisted
after epoch: 10,now: 2024-05-24 09:40:53.797319,epoch time: 0:36:29.657004,used: 6:20:03.177949,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_03_20_50_seed_0_20754612
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9820744, 'precision': 0.89577436, 'recall': 0.805485, 'specificity': 0.805485, 'f1': 0.84436196, 'auroc': 0.98571825, 'binary_precision': 0.8047915, 'binary_recall': 0.6161685, 'binary_specificity': 0.9948015, 'binary_f1_score': 0.69796085}
confusion matrix:
       0    1
0  42100  220
1    565  907
---- Validation: 
scalar performance:
{'acc': 0.98068327, 'precision': 0.9150827, 'recall': 0.7642328, 'specificity': 0.7642328, 'f1': 0.82167995, 'auroc': 0.9823272, 'binary_precision': 0.84653467, 'binary_recall': 0.5318818, 'binary_specificity': 0.9965838, 'binary_f1_score': 0.6532951}
confusion matrix:
       0    1
0  18087   62
1    301  342
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590924, 'precision': 0.97952986, 'recall': 0.5095785, 'specificity': 0.5095785, 'f1': 0.508348, 'auroc': 0.95101285, 'binary_precision': 1.0, 'binary_recall': 0.019157087, 'binary_specificity': 1.0, 'binary_f1_score': 0.037593983}
confusion matrix:
      0  1
0  5997  0
1   256  5
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754612.png
better model found
persisted
after epoch: 11,now: 2024-05-24 10:18:02.621098,epoch time: 0:37:08.823779,used: 6:57:12.001728,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_03_20_50_seed_0_20754612
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98212004, 'precision': 0.8608681, 'recall': 0.8658347, 'specificity': 0.8658347, 'f1': 0.86333287, 'auroc': 0.9859457, 'binary_precision': 0.73074347, 'binary_recall': 0.7411685, 'binary_specificity': 0.9905009, 'binary_f1_score': 0.7359191}
confusion matrix:
       0     1
0  41918   402
1    381  1091
---- Validation: 
scalar performance:
{'acc': 0.9816411, 'precision': 0.8716129, 'recall': 0.8397342, 'specificity': 0.8397342, 'f1': 0.85489714, 'auroc': 0.98225945, 'binary_precision': 0.7542662, 'binary_recall': 0.6874028, 'binary_specificity': 0.99206567, 'binary_f1_score': 0.719284}
confusion matrix:
       0    1
0  18005  144
1    201  442
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.7874361, 'recall': 0.5149088, 'specificity': 0.5149088, 'f1': 0.5186596, 'auroc': 0.9477991, 'binary_precision': 0.61538464, 'binary_recall': 0.03065134, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.058394164}
confusion matrix:
      0  1
0  5992  5
1   253  8
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754612.png
better model found
persisted
after epoch: 12,now: 2024-05-24 10:55:31.783196,epoch time: 0:37:29.162098,used: 7:34:41.163826,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_03_20_50_seed_0_20754612
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9796081, 'precision': 0.839961, 'recall': 0.8513236, 'specificity': 0.8513236, 'f1': 0.8455403, 'auroc': 0.9847533, 'binary_precision': 0.68988174, 'binary_recall': 0.71380013, 'binary_specificity': 0.98884714, 'binary_f1_score': 0.70163715}
confusion matrix:
       0     1
0  41849   472
1    421  1050
---- Validation: 
scalar performance:
{'acc': 0.98020434, 'precision': 0.8649461, 'recall': 0.81873894, 'specificity': 0.81873894, 'f1': 0.84014547, 'auroc': 0.97831416, 'binary_precision': 0.7423971, 'binary_recall': 0.64541215, 'binary_specificity': 0.99206567, 'binary_f1_score': 0.6905158}
confusion matrix:
       0    1
0  18005  144
1    228  415
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9592522, 'precision': 0.8370436, 'recall': 0.5188236, 'specificity': 0.5188236, 'f1': 0.52594787, 'auroc': 0.95103425, 'binary_precision': 0.71428573, 'binary_recall': 0.038314175, 'binary_specificity': 0.999333, 'binary_f1_score': 0.07272727}
confusion matrix:
      0   1
0  5993   4
1   251  10
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754612.png
early stop counter: 1
val acc:0.9802043437957764, best validation acc: 0.9816411137580872, corresponding to test acc:                         0.9587727785110474 / 0.9674017429351807
after epoch: 13,now: 2024-05-24 11:39:25.763069,epoch time: 0:43:53.979873,used: 8:18:35.143699,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_03_20_50_seed_0_20754612
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98428935, 'precision': 0.8962979, 'recall': 0.8498085, 'specificity': 0.8498085, 'f1': 0.871487, 'auroc': 0.98832715, 'binary_precision': 0.8027842, 'binary_recall': 0.7056424, 'binary_specificity': 0.9939746, 'binary_f1_score': 0.7510853}
confusion matrix:
       0     1
0  42066   255
1    433  1038
---- Validation: 
scalar performance:
{'acc': 0.98063004, 'precision': 0.90846694, 'recall': 0.7694557, 'specificity': 0.7694557, 'f1': 0.82364196, 'auroc': 0.98452693, 'binary_precision': 0.8329356, 'binary_recall': 0.5427683, 'binary_specificity': 0.99614304, 'binary_f1_score': 0.6572505}
confusion matrix:
       0    1
0  18079   70
1    294  349
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590924, 'precision': 0.9081747, 'recall': 0.5114109, 'specificity': 0.5114109, 'f1': 0.5119374, 'auroc': 0.9490205, 'binary_precision': 0.85714287, 'binary_recall': 0.022988506, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.04477612}
confusion matrix:
      0  1
0  5996  1
1   255  6
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754612.png
early stop counter: 2
val acc:0.9806300401687622, best validation acc: 0.9816411137580872, corresponding to test acc:                         0.9587727785110474 / 0.9674017429351807
after epoch: 14,now: 2024-05-24 12:35:32.953898,epoch time: 0:56:07.190829,used: 9:14:42.334528,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_03_20_50_seed_0_20754612
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98410666, 'precision': 0.8851708, 'recall': 0.86391187, 'specificity': 0.86391187, 'f1': 0.8742142, 'auroc': 0.9878844, 'binary_precision': 0.7795389, 'binary_recall': 0.7350544, 'binary_specificity': 0.99276936, 'binary_f1_score': 0.7566433}
confusion matrix:
       0     1
0  42014   306
1    390  1082
---- Validation: 
scalar performance:
{'acc': 0.9829715, 'precision': 0.9054824, 'recall': 0.8171712, 'specificity': 0.8171712, 'f1': 0.8555044, 'auroc': 0.9848925, 'binary_precision': 0.8236473, 'binary_recall': 0.63919127, 'binary_specificity': 0.9951512, 'binary_f1_score': 0.7197898}
confusion matrix:
       0    1
0  18061   88
1    232  411
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.830202, 'recall': 0.5263197, 'specificity': 0.5263197, 'f1': 0.5394829, 'auroc': 0.9429672, 'binary_precision': 0.7, 'binary_recall': 0.053639848, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.09964413}
confusion matrix:
      0   1
0  5991   6
1   247  14
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754612.png
better model found
persisted
after epoch: 15,now: 2024-05-24 13:20:57.096883,epoch time: 0:45:24.142985,used: 10:00:06.477513,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_03_20_50_seed_0_20754612
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.98428935, 'precision': 0.9073659, 'recall': 0.8347164, 'specificity': 0.8347164, 'f1': 0.8672063, 'auroc': 0.9898902, 'binary_precision': 0.82597834, 'binary_recall': 0.6743712, 'binary_specificity': 0.9950616, 'binary_f1_score': 0.742515}
confusion matrix:
       0    1
0  42112  209
1    479  992
---- Validation: 
scalar performance:
{'acc': 0.9838761, 'precision': 0.9313192, 'recall': 0.8063888, 'specificity': 0.8063888, 'f1': 0.85749185, 'auroc': 0.98526853, 'binary_precision': 0.8761062, 'binary_recall': 0.61586314, 'binary_specificity': 0.99691445, 'binary_f1_score': 0.72328764}
confusion matrix:
       0    1
0  18093   56
1    247  396
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.87944984, 'recall': 0.50757945, 'specificity': 0.50757945, 'f1': 0.50450695, 'auroc': 0.94543755, 'binary_precision': 0.8, 'binary_recall': 0.01532567, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.030075189}
confusion matrix:
      0  1
0  5996  1
1   257  4
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754612.png
better model found
persisted
after epoch: 16,now: 2024-05-24 14:00:07.676882,epoch time: 0:39:10.579999,used: 10:39:17.057512,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_03_20_50_seed_0_20754612
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9839925, 'precision': 0.8836912, 'recall': 0.86376286, 'specificity': 0.86376286, 'f1': 0.87343884, 'auroc': 0.9911531, 'binary_precision': 0.77658045, 'binary_recall': 0.73487425, 'binary_specificity': 0.9926514, 'binary_f1_score': 0.7551519}
confusion matrix:
       0     1
0  42010   311
1    390  1081
---- Validation: 
scalar performance:
{'acc': 0.9826522, 'precision': 0.8713138, 'recall': 0.8635094, 'specificity': 0.8635094, 'f1': 0.8673665, 'auroc': 0.982833, 'binary_precision': 0.7519873, 'binary_recall': 0.7356143, 'binary_specificity': 0.9914045, 'binary_f1_score': 0.7437107}
confusion matrix:
       0    1
0  17993  156
1    170  473
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.746404, 'recall': 0.5147421, 'specificity': 0.5147421, 'f1': 0.5183646, 'auroc': 0.9410513, 'binary_precision': 0.53333336, 'binary_recall': 0.03065134, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.057971016}
confusion matrix:
      0  1
0  5990  7
1   253  8
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754612.png
early stop counter: 1
val acc:0.9826521873474121, best validation acc: 0.98387610912323, corresponding to test acc:                         0.9587727785110474 / 0.9674017429351807
after epoch: 17,now: 2024-05-24 14:43:09.181194,epoch time: 0:43:01.504312,used: 11:22:18.561824,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_03_20_50_seed_0_20754612
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98310196, 'precision': 0.8777044, 'recall': 0.8548677, 'specificity': 0.8548677, 'f1': 0.8658998, 'auroc': 0.9906845, 'binary_precision': 0.76521736, 'binary_recall': 0.7173913, 'binary_specificity': 0.992344, 'binary_f1_score': 0.74053293}
confusion matrix:
       0     1
0  41996   324
1    416  1056
---- Validation: 
scalar performance:
{'acc': 0.9829715, 'precision': 0.8865104, 'recall': 0.84342325, 'specificity': 0.84342325, 'f1': 0.86358786, 'auroc': 0.9824207, 'binary_precision': 0.7838313, 'binary_recall': 0.69362366, 'binary_specificity': 0.9932228, 'binary_f1_score': 0.73597366}
confusion matrix:
       0    1
0  18026  123
1    197  446
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.79201996, 'recall': 0.5093284, 'specificity': 0.5093284, 'f1': 0.50801337, 'auroc': 0.95808136, 'binary_precision': 0.625, 'binary_recall': 0.019157087, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.03717472}
confusion matrix:
      0  1
0  5994  3
1   256  5
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754612.png
early stop counter: 2
val acc:0.9829714894294739, best validation acc: 0.98387610912323, corresponding to test acc:                         0.9587727785110474 / 0.9674017429351807
after epoch: 18,now: 2024-05-24 15:25:05.195601,epoch time: 0:41:56.014407,used: 12:04:14.576231,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_03_20_50_seed_0_20754612
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9847232, 'precision': 0.9423446, 'recall': 0.8065276, 'specificity': 0.8065276, 'f1': 0.8612448, 'auroc': 0.9919499, 'binary_precision': 0.89791876, 'binary_recall': 0.6154891, 'binary_specificity': 0.99756616, 'binary_f1_score': 0.7303506}
confusion matrix:
       0    1
0  42217  103
1    566  906
---- Validation: 
scalar performance:
{'acc': 0.9827054, 'precision': 0.9353986, 'recall': 0.78253096, 'specificity': 0.78253096, 'f1': 0.84152305, 'auroc': 0.9843551, 'binary_precision': 0.8859223, 'binary_recall': 0.5676516, 'binary_specificity': 0.9974103, 'binary_f1_score': 0.6919431}
confusion matrix:
       0    1
0  18102   47
1    278  365
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590924, 'precision': 0.97952986, 'recall': 0.5095785, 'specificity': 0.5095785, 'f1': 0.508348, 'auroc': 0.9619018, 'binary_precision': 1.0, 'binary_recall': 0.019157087, 'binary_specificity': 1.0, 'binary_f1_score': 0.037593983}
confusion matrix:
      0  1
0  5997  0
1   256  5
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754612.png
early stop counter: 3
val acc:0.9827054142951965, best validation acc: 0.98387610912323, corresponding to test acc:                         0.9587727785110474 / 0.9674017429351807
after epoch: 19,now: 2024-05-24 16:04:06.505886,epoch time: 0:39:01.310285,used: 12:43:15.886516,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_03_20_50_seed_0_20754612
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9860477, 'precision': 0.934415, 'recall': 0.8370481, 'specificity': 0.8370481, 'f1': 0.8791305, 'auroc': 0.9928293, 'binary_precision': 0.8799647, 'binary_recall': 0.6773098, 'binary_specificity': 0.9967864, 'binary_f1_score': 0.765451}
confusion matrix:
       0    1
0  42184  136
1    475  997
---- Validation: 
scalar performance:
{'acc': 0.98318434, 'precision': 0.9291354, 'recall': 0.7962799, 'specificity': 0.7962799, 'f1': 0.8496456, 'auroc': 0.98310256, 'binary_precision': 0.87243736, 'binary_recall': 0.5956454, 'binary_specificity': 0.99691445, 'binary_f1_score': 0.70794827}
confusion matrix:
       0    1
0  18093   56
1    260  383
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589326, 'precision': 0.8546, 'recall': 0.5113275, 'specificity': 0.5113275, 'f1': 0.51181245, 'auroc': 0.9591181, 'binary_precision': 0.75, 'binary_recall': 0.022988506, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.044609666}
confusion matrix:
      0  1
0  5995  2
1   255  6
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754612.png
early stop counter: 4
val acc:0.9831843376159668, best validation acc: 0.98387610912323, corresponding to test acc:                         0.9587727785110474 / 0.9674017429351807
after epoch: 20,now: 2024-05-24 16:46:12.003904,epoch time: 0:42:05.498018,used: 13:25:21.384534,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_03_20_50_seed_0_20754612
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9848146, 'precision': 0.92402077, 'recall': 0.8255907, 'specificity': 0.8255907, 'f1': 0.867858, 'auroc': 0.992283, 'binary_precision': 0.8599465, 'binary_recall': 0.6548913, 'binary_specificity': 0.99629015, 'binary_f1_score': 0.74354035}
confusion matrix:
       0    1
0  42163  157
1    508  964
---- Validation: 
scalar performance:
{'acc': 0.98350364, 'precision': 0.92463607, 'recall': 0.806196, 'specificity': 0.806196, 'f1': 0.85509795, 'auroc': 0.9826124, 'binary_precision': 0.8627451, 'binary_recall': 0.61586314, 'binary_specificity': 0.99652874, 'binary_f1_score': 0.71869326}
confusion matrix:
       0    1
0  18086   63
1    247  396
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959412, 'precision': 0.8135321, 'recall': 0.5262363, 'specificity': 0.5262363, 'f1': 0.53926444, 'auroc': 0.948192, 'binary_precision': 0.6666667, 'binary_recall': 0.053639848, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.09929079}
confusion matrix:
      0   1
0  5990   7
1   247  14
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754612.png
early stop counter: 5
val acc:0.9835036396980286, best validation acc: 0.98387610912323, corresponding to test acc:                         0.9587727785110474 / 0.9674017429351807
after epoch: 21,now: 2024-05-24 17:28:05.478940,epoch time: 0:41:53.475036,used: 14:07:14.859570,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_03_20_50_seed_0_20754612
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9833075, 'precision': 0.87549615, 'recall': 0.8634084, 'specificity': 0.8634084, 'f1': 0.86934483, 'auroc': 0.99050677, 'binary_precision': 0.7601969, 'binary_recall': 0.73487425, 'binary_specificity': 0.9919425, 'binary_f1_score': 0.7473211}
confusion matrix:
       0     1
0  41980   341
1    390  1081
---- Validation: 
scalar performance:
{'acc': 0.9838761, 'precision': 0.88735867, 'recall': 0.8611428, 'specificity': 0.8611428, 'f1': 0.8737524, 'auroc': 0.9835073, 'binary_precision': 0.78428096, 'binary_recall': 0.7293935, 'binary_specificity': 0.99289215, 'binary_f1_score': 0.7558421}
confusion matrix:
       0    1
0  18020  129
1    174  469
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96196866, 'precision': 0.85950965, 'recall': 0.564217, 'specificity': 0.564217, 'f1': 0.60136503, 'auroc': 0.9517019, 'binary_precision': 0.75555557, 'binary_recall': 0.1302682, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.22222222}
confusion matrix:
      0   1
0  5986  11
1   227  34
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754612.png
early stop counter: 6
val acc:0.98387610912323, best validation acc: 0.98387610912323, corresponding to test acc:                         0.9587727785110474 / 0.9674017429351807
after epoch: 22,now: 2024-05-24 18:08:16.363220,epoch time: 0:40:10.884280,used: 14:47:25.743850,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_03_20_50_seed_0_20754612
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9852941, 'precision': 0.9074609, 'recall': 0.85426545, 'specificity': 0.85426545, 'f1': 0.8788577, 'auroc': 0.99256927, 'binary_precision': 0.82482326, 'binary_recall': 0.71380013, 'binary_specificity': 0.9947308, 'binary_f1_score': 0.7653061}
confusion matrix:
       0     1
0  42098   223
1    421  1050
---- Validation: 
scalar performance:
{'acc': 0.9828118, 'precision': 0.89888316, 'recall': 0.822339, 'specificity': 0.822339, 'f1': 0.856222, 'auroc': 0.9824064, 'binary_precision': 0.81007755, 'binary_recall': 0.65007776, 'binary_specificity': 0.99460024, 'binary_f1_score': 0.7213115}
confusion matrix:
       0    1
0  18051   98
1    225  418
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.8716722, 'recall': 0.5473091, 'specificity': 0.5473091, 'f1': 0.5753839, 'auroc': 0.95187664, 'binary_precision': 0.78125, 'binary_recall': 0.09578544, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.17064846}
confusion matrix:
      0   1
0  5990   7
1   236  25
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754612.png
early stop counter: 7
val acc:0.9828118085861206, best validation acc: 0.98387610912323, corresponding to test acc:                         0.9587727785110474 / 0.9674017429351807
after epoch: 23,now: 2024-05-24 18:50:07.858865,epoch time: 0:41:51.495645,used: 15:29:17.239495,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_03_20_50_seed_0_20754612
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.98639023, 'precision': 0.9109003, 'recall': 0.870823, 'specificity': 0.870823, 'f1': 0.889752, 'auroc': 0.99235666, 'binary_precision': 0.83055973, 'binary_recall': 0.74693877, 'binary_specificity': 0.9947072, 'binary_f1_score': 0.78653294}
confusion matrix:
       0     1
0  42098   224
1    372  1098
---- Validation: 
scalar performance:
{'acc': 0.9823861, 'precision': 0.88221276, 'recall': 0.83786976, 'specificity': 0.83786976, 'f1': 0.8585602, 'auroc': 0.98097456, 'binary_precision': 0.7756184, 'binary_recall': 0.6827372, 'binary_specificity': 0.99300236, 'binary_f1_score': 0.7262201}
confusion matrix:
       0    1
0  18022  127
1    204  439
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959412, 'precision': 0.8466443, 'recall': 0.5207393, 'specificity': 0.5207393, 'f1': 0.52947927, 'auroc': 0.94466805, 'binary_precision': 0.73333335, 'binary_recall': 0.042145595, 'binary_specificity': 0.999333, 'binary_f1_score': 0.07971015}
confusion matrix:
      0   1
0  5993   4
1   250  11
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754612.png
early stop counter: 8
val acc:0.9823861122131348, best validation acc: 0.98387610912323, corresponding to test acc:                         0.9587727785110474 / 0.9674017429351807
after epoch: 24,now: 2024-05-24 19:32:26.072703,epoch time: 0:42:18.213838,used: 16:11:35.453333,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_03_20_50_seed_0_20754612
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9871894, 'precision': 0.93141335, 'recall': 0.86049545, 'specificity': 0.86049545, 'f1': 0.89253676, 'auroc': 0.99423456, 'binary_precision': 0.87234044, 'binary_recall': 0.7246771, 'binary_specificity': 0.99631387, 'binary_f1_score': 0.7916821}
confusion matrix:
       0     1
0  42165   156
1    405  1066
---- Validation: 
scalar performance:
{'acc': 0.9841422, 'precision': 0.9274619, 'recall': 0.81477714, 'specificity': 0.81477714, 'f1': 0.86192185, 'auroc': 0.98276645, 'binary_precision': 0.8678038, 'binary_recall': 0.63297045, 'binary_specificity': 0.9965838, 'binary_f1_score': 0.73201436}
confusion matrix:
       0    1
0  18087   62
1    236  407
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9600511, 'precision': 0.89197624, 'recall': 0.5265698, 'specificity': 0.5265698, 'f1': 0.5401456, 'auroc': 0.9565557, 'binary_precision': 0.8235294, 'binary_recall': 0.053639848, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.10071943}
confusion matrix:
      0   1
0  5994   3
1   247  14
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754612.png
better model found
persisted
after epoch: 25,now: 2024-05-24 20:11:02.298646,epoch time: 0:38:36.225943,used: 16:50:11.679276,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_03_20_50_seed_0_20754612
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9854996, 'precision': 0.8845673, 'recall': 0.8949177, 'specificity': 0.8949177, 'f1': 0.88966787, 'auroc': 0.9936106, 'binary_precision': 0.7761589, 'binary_recall': 0.79782164, 'binary_specificity': 0.9920138, 'binary_f1_score': 0.7868412}
confusion matrix:
       0     1
0  41985   338
1    297  1172
---- Validation: 
scalar performance:
{'acc': 0.98174757, 'precision': 0.8708774, 'recall': 0.8435396, 'specificity': 0.8435396, 'f1': 0.85663974, 'auroc': 0.98304886, 'binary_precision': 0.75252527, 'binary_recall': 0.69517887, 'binary_specificity': 0.9919004, 'binary_f1_score': 0.7227163}
confusion matrix:
       0    1
0  18002  147
1    196  447
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606903, 'precision': 0.8185448, 'recall': 0.55438834, 'specificity': 0.55438834, 'f1': 0.58532274, 'auroc': 0.9542655, 'binary_precision': 0.6744186, 'binary_recall': 0.11111111, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.19078949}
confusion matrix:
      0   1
0  5983  14
1   232  29
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754612.png
early stop counter: 1
val acc:0.981747567653656, best validation acc: 0.9841421842575073, corresponding to test acc:                         0.9600511193275452 / 0.9674017429351807
after epoch: 26,now: 2024-05-24 20:51:31.174627,epoch time: 0:40:28.875981,used: 17:30:40.555257,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_03_20_50_seed_0_20754612
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9839925, 'precision': 0.8970338, 'recall': 0.84286976, 'specificity': 0.84286976, 'f1': 0.8678091, 'auroc': 0.99252903, 'binary_precision': 0.8047431, 'binary_recall': 0.69157606, 'binary_specificity': 0.9941635, 'binary_f1_score': 0.74388015}
confusion matrix:
       0     1
0  42073   247
1    454  1018
---- Validation: 
scalar performance:
{'acc': 0.98036397, 'precision': 0.876457, 'recall': 0.8030704, 'specificity': 0.8030704, 'f1': 0.8354709, 'auroc': 0.98081666, 'binary_precision': 0.76653695, 'binary_recall': 0.61275274, 'binary_specificity': 0.99338806, 'binary_f1_score': 0.68107176}
confusion matrix:
       0    1
0  18029  120
1    249  394
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96244806, 'precision': 0.9026443, 'recall': 0.5608024, 'specificity': 0.5608024, 'f1': 0.5974057, 'auroc': 0.95026827, 'binary_precision': 0.84210527, 'binary_recall': 0.12260536, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.21404682}
confusion matrix:
      0   1
0  5991   6
1   229  32
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754612.png
early stop counter: 2
val acc:0.9803639650344849, best validation acc: 0.9841421842575073, corresponding to test acc:                         0.9600511193275452 / 0.9674017429351807
after epoch: 27,now: 2024-05-24 21:33:05.286151,epoch time: 0:41:34.111524,used: 18:12:14.666781,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_03_20_50_seed_0_20754612
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.98410666, 'precision': 0.9141499, 'recall': 0.8232573, 'specificity': 0.8232573, 'f1': 0.8626733, 'auroc': 0.9922904, 'binary_precision': 0.84035087, 'binary_recall': 0.6508152, 'binary_specificity': 0.9956994, 'binary_f1_score': 0.73353744}
confusion matrix:
       0    1
0  42138  182
1    514  958
---- Validation: 
scalar performance:
{'acc': 0.97961897, 'precision': 0.89651567, 'recall': 0.76218176, 'specificity': 0.76218176, 'f1': 0.81460595, 'auroc': 0.98125076, 'binary_precision': 0.8095238, 'binary_recall': 0.5287714, 'binary_specificity': 0.99559206, 'binary_f1_score': 0.639699}
confusion matrix:
       0    1
0  18069   80
1    303  340
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9610099, 'precision': 0.88822913, 'recall': 0.54172873, 'specificity': 0.54172873, 'f1': 0.5664118, 'auroc': 0.94600254, 'binary_precision': 0.8148148, 'binary_recall': 0.08429119, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.15277778}
confusion matrix:
      0   1
0  5992   5
1   239  22
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754612.png
early stop counter: 3
val acc:0.9796189665794373, best validation acc: 0.9841421842575073, corresponding to test acc:                         0.9600511193275452 / 0.9674017429351807
after epoch: 28,now: 2024-05-24 22:17:07.185169,epoch time: 0:44:01.899018,used: 18:56:16.565799,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_03_20_50_seed_0_20754612
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9835358, 'precision': 0.9103464, 'recall': 0.81673265, 'specificity': 0.81673265, 'f1': 0.8570509, 'auroc': 0.99194056, 'binary_precision': 0.83318543, 'binary_recall': 0.6379076, 'binary_specificity': 0.99555767, 'binary_f1_score': 0.7225856}
confusion matrix:
       0    1
0  42132  188
1    533  939
---- Validation: 
scalar performance:
{'acc': 0.9759472, 'precision': 0.8537383, 'recall': 0.73552895, 'specificity': 0.73552895, 'f1': 0.7818037, 'auroc': 0.98048866, 'binary_precision': 0.7257683, 'binary_recall': 0.47744945, 'binary_specificity': 0.9936085, 'binary_f1_score': 0.575985}
confusion matrix:
       0    1
0  18033  116
1    336  307
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96164906, 'precision': 0.9409081, 'recall': 0.5438945, 'specificity': 0.5438945, 'f1': 0.57060766, 'auroc': 0.9493554, 'binary_precision': 0.92, 'binary_recall': 0.08812261, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.16083916}
confusion matrix:
      0   1
0  5995   2
1   238  23
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754612.png
early stop counter: 4
val acc:0.9759472012519836, best validation acc: 0.9841421842575073, corresponding to test acc:                         0.9600511193275452 / 0.9674017429351807
after epoch: 29,now: 2024-05-24 23:02:35.071197,epoch time: 0:45:27.886028,used: 19:41:44.451827,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_03_20_50_seed_0_20754612
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9880572, 'precision': 0.9240302, 'recall': 0.88522315, 'specificity': 0.88522315, 'f1': 0.9036227, 'auroc': 0.99539614, 'binary_precision': 0.8558559, 'binary_recall': 0.774983, 'binary_specificity': 0.99546325, 'binary_f1_score': 0.8134142}
confusion matrix:
       0     1
0  42129   192
1    331  1140
---- Validation: 
scalar performance:
{'acc': 0.9838761, 'precision': 0.89753115, 'recall': 0.84539163, 'specificity': 0.84539163, 'f1': 0.86948085, 'auroc': 0.9842216, 'binary_precision': 0.8057554, 'binary_recall': 0.6967341, 'binary_specificity': 0.99404925, 'binary_f1_score': 0.74728936}
confusion matrix:
       0    1
0  18041  108
1    195  448
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9600511, 'precision': 0.8015387, 'recall': 0.5467255, 'specificity': 0.5467255, 'f1': 0.57310086, 'auroc': 0.94262743, 'binary_precision': 0.64102566, 'binary_recall': 0.09578544, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.16666666}
confusion matrix:
      0   1
0  5983  14
1   236  25
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754612.png
early stop counter: 5
val acc:0.98387610912323, best validation acc: 0.9841421842575073, corresponding to test acc:                         0.9600511193275452 / 0.9674017429351807
after epoch: 30,now: 2024-05-24 23:45:54.198771,epoch time: 0:43:19.127574,used: 20:25:03.579401,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_24_03_20_50_seed_0_20754612
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 20:25:03.579401 at 2024-05-24 23:45:54.198771
persisted model performance metric: 

scalar performance:
{'acc': 0.9602109, 'precision': 0.9177147, 'recall': 0.5266532, 'specificity': 0.5266532, 'f1': 0.5403691, 'auroc': 0.9494779, 'binary_precision': 0.875, 'binary_recall': 0.053639848, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.10108303}
confusion matrix:
      0   1
0  5995   2
1   247  14
oracle model performance metric: 

scalar performance:
{'acc': 0.96692234, 'precision': 0.8951652, 'recall': 0.6309333, 'specificity': 0.6309333, 'f1': 0.6914962, 'auroc': 0.93862486, 'binary_precision': 0.8214286, 'binary_recall': 0.26436782, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.40000004}
confusion matrix:
      0   1
0  5982  15
1   192  69
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dial_irm/rule_results/5.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dial_irm/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dial_irm/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 490587 KiB |   5710 MiB |   2133 TiB |   2133 TiB |
|       from large pool | 400768 KiB |   5639 MiB |   2127 TiB |   2127 TiB |
|       from small pool |  89819 KiB |    125 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 490587 KiB |   5710 MiB |   2133 TiB |   2133 TiB |
|       from large pool | 400768 KiB |   5639 MiB |   2127 TiB |   2127 TiB |
|       from small pool |  89819 KiB |    125 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476573 KiB |   5640 MiB |   2112 TiB |   2112 TiB |
|       from large pool | 387840 KiB |   5569 MiB |   2106 TiB |   2106 TiB |
|       from small pool |  88733 KiB |    124 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   6088 MiB |   6088 MiB |   6088 MiB |      0 B   |
|       from large pool |   5962 MiB |   5962 MiB |   5962 MiB |      0 B   |
|       from small pool |    126 MiB |    126 MiB |    126 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 242596 KiB | 491235 KiB |   1274 TiB |   1274 TiB |
|       from large pool | 236160 KiB | 480192 KiB |   1267 TiB |   1267 TiB |
|       from small pool |   6436 KiB |  16720 KiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3729    |    6700    |  303565 K  |  303561 K  |
|       from large pool |      87    |     490    |  138106 K  |  138106 K  |
|       from small pool |    3642    |    6612    |  165459 K  |  165455 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3729    |    6700    |  303565 K  |  303561 K  |
|       from large pool |      87    |     490    |  138106 K  |  138106 K  |
|       from small pool |    3642    |    6612    |  165459 K  |  165455 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     233    |     233    |     233    |       0    |
|       from large pool |     170    |     170    |     170    |       0    |
|       from small pool |      63    |      63    |      63    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      62    |    2773    |  153270 K  |  153270 K  |
|       from large pool |      27    |      87    |   84903 K  |   84903 K  |
|       from small pool |      35    |    2746    |   68367 K  |   68367 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   5710 MiB |   2133 TiB |   2133 TiB |
|       from large pool |  16640 KiB |   5639 MiB |   2127 TiB |   2127 TiB |
|       from small pool |      0 KiB |    125 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   5710 MiB |   2133 TiB |   2133 TiB |
|       from large pool |  16640 KiB |   5639 MiB |   2127 TiB |   2127 TiB |
|       from small pool |      0 KiB |    125 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   5640 MiB |   2112 TiB |   2112 TiB |
|       from large pool |  16640 KiB |   5569 MiB |   2106 TiB |   2106 TiB |
|       from small pool |      0 KiB |    124 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 733184 KiB |   6088 MiB |   6088 MiB |   5372 MiB |
|       from large pool | 636928 KiB |   5962 MiB |   5962 MiB |   5340 MiB |
|       from small pool |  96256 KiB |    126 MiB |    126 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB | 491235 KiB |   1274 TiB |   1274 TiB |
|       from large pool |  50944 KiB | 480192 KiB |   1267 TiB |   1267 TiB |
|       from small pool |      0 KiB |  29381 KiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6700    |  303565 K  |  303565 K  |
|       from large pool |       2    |     490    |  138106 K  |  138106 K  |
|       from small pool |       0    |    6612    |  165459 K  |  165459 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6700    |  303565 K  |  303565 K  |
|       from large pool |       2    |     490    |  138106 K  |  138106 K  |
|       from small pool |       0    |    6612    |  165459 K  |  165459 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      78    |     233    |     233    |     155    |
|       from large pool |      31    |     170    |     170    |     139    |
|       from small pool |      47    |      63    |      63    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2773    |  153271 K  |  153271 K  |
|       from large pool |       4    |      87    |   84903 K  |   84903 K  |
|       from small pool |       0    |    2746    |   68368 K  |   68368 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Fri May 24 23:48:33 2024]
Finished job 0.
1 of 1 steps (100%) done
