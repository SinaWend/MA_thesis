Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Thu May 23 13:47:24 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_dial_irm/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_dial_irm/rule_results/0.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=0
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_14_03_29_seed_0_20754609

 Experiment start at: 2024-05-23 14:03:29.908149
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.955097496509552
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.97652537, 'precision': 0.82634276, 'recall': 0.7967125, 'specificity': 0.7967125, 'f1': 0.81075823, 'auroc': 0.97126853, 'binary_precision': 0.66641676, 'binary_recall': 0.6039402, 'binary_specificity': 0.9894849, 'binary_f1_score': 0.6336422}
confusion matrix:
       0    1
0  41875  445
1    583  889
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.9773308, 'precision': 0.85938704, 'recall': 0.760247, 'specificity': 0.760247, 'f1': 0.8012264, 'auroc': 0.9719735, 'binary_precision': 0.73535794, 'binary_recall': 0.5272162, 'binary_specificity': 0.99327785, 'binary_f1_score': 0.61413044}
confusion matrix:
       0    1
0  18027  122
1    304  339
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9637264, 'precision': 0.90936995, 'recall': 0.57796043, 'specificity': 0.57796043, 'f1': 0.6233882, 'auroc': 0.94929135, 'binary_precision': 0.8541667, 'binary_recall': 0.15708812, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.26537216}
confusion matrix:
      0   1
0  5990   7
1   220  41
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754609.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-23 14:43:18.876475,epoch time: 0:39:48.968326,used: 0:39:48.968326,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_14_03_29_seed_0_20754609
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97241503, 'precision': 0.92183554, 'recall': 0.6044871, 'specificity': 0.6044871, 'f1': 0.6621793, 'auroc': 0.97717214, 'binary_precision': 0.87042254, 'binary_recall': 0.21006118, 'binary_specificity': 0.99891305, 'binary_f1_score': 0.3384447}
confusion matrix:
       0    1
0  42275   46
1   1162  309
---- Validation: 
scalar performance:
{'acc': 0.9710515, 'precision': 0.89583397, 'recall': 0.59798443, 'specificity': 0.59798443, 'f1': 0.6517538, 'auroc': 0.9756195, 'binary_precision': 0.81935483, 'binary_recall': 0.19751166, 'binary_specificity': 0.9984572, 'binary_f1_score': 0.31829575}
confusion matrix:
       0    1
0  18121   28
1    516  127
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.97922325, 'recall': 0.5019157, 'specificity': 0.5019157, 'f1': 0.49320802, 'auroc': 0.96073914, 'binary_precision': 1.0, 'binary_recall': 0.0038314175, 'binary_specificity': 1.0, 'binary_f1_score': 0.007633588}
confusion matrix:
      0  1
0  5997  0
1   260  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754609.png
early stop counter: 1
val acc:0.9710515141487122, best validation acc: 0.9773308038711548, corresponding to test acc:                         0.9637264013290405 / 0.9637264013290405
after epoch: 2,now: 2024-05-23 15:22:16.179540,epoch time: 0:38:57.303065,used: 1:18:46.271391,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_14_03_29_seed_0_20754609
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.979905, 'precision': 0.90492606, 'recall': 0.75256085, 'specificity': 0.75256085, 'f1': 0.8098066, 'auroc': 0.9840339, 'binary_precision': 0.8267108, 'binary_recall': 0.5088315, 'binary_specificity': 0.99629015, 'binary_f1_score': 0.6299411}
confusion matrix:
       0    1
0  42163  157
1    723  749
---- Validation: 
scalar performance:
{'acc': 0.9786079, 'precision': 0.9511371, 'recall': 0.70390403, 'specificity': 0.70390403, 'f1': 0.7779218, 'auroc': 0.9807911, 'binary_precision': 0.92280704, 'binary_recall': 0.40902022, 'binary_specificity': 0.9987878, 'binary_f1_score': 0.56681037}
confusion matrix:
       0    1
0  18127   22
1    380  263
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581336, 'precision': 0.67928994, 'recall': 0.5035813, 'specificity': 0.5035813, 'f1': 0.49682495, 'auroc': 0.9599805, 'binary_precision': 0.4, 'binary_recall': 0.007662835, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.015037594}
confusion matrix:
      0  1
0  5994  3
1   259  2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754609.png
better model found
persisted
after epoch: 3,now: 2024-05-23 16:08:07.274811,epoch time: 0:45:51.095271,used: 2:04:37.366662,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_14_03_29_seed_0_20754609
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9804302, 'precision': 0.88487756, 'recall': 0.78452945, 'specificity': 0.78452945, 'f1': 0.82659185, 'auroc': 0.98449636, 'binary_precision': 0.78438663, 'binary_recall': 0.5745405, 'binary_specificity': 0.99451834, 'binary_f1_score': 0.6632613}
confusion matrix:
       0    1
0  42091  232
1    625  844
---- Validation: 
scalar performance:
{'acc': 0.9777033, 'precision': 0.86716634, 'recall': 0.7574396, 'specificity': 0.7574396, 'f1': 0.80188113, 'auroc': 0.9783627, 'binary_precision': 0.7511211, 'binary_recall': 0.5209953, 'binary_specificity': 0.99388397, 'binary_f1_score': 0.6152433}
confusion matrix:
       0    1
0  18038  111
1    308  335
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9638862, 'precision': 0.89760846, 'recall': 0.5835408, 'specificity': 0.5835408, 'f1': 0.63086665, 'auroc': 0.95351297, 'binary_precision': 0.8301887, 'binary_recall': 0.16858238, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.28025478}
confusion matrix:
      0   1
0  5988   9
1   217  44
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754609.png
new oracle model saved
early stop counter: 1
val acc:0.9777032732963562, best validation acc: 0.9786078929901123, corresponding to test acc:                         0.9581335783004761 / 0.9638862013816833
after epoch: 4,now: 2024-05-23 16:43:51.301306,epoch time: 0:35:44.026495,used: 2:40:21.393157,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_14_03_29_seed_0_20754609
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98097825, 'precision': 0.8429985, 'recall': 0.8822168, 'specificity': 0.8822168, 'f1': 0.861447, 'auroc': 0.98655164, 'binary_precision': 0.69380313, 'binary_recall': 0.77634263, 'binary_specificity': 0.988091, 'binary_f1_score': 0.73275584}
confusion matrix:
       0     1
0  41817   504
1    329  1142
---- Validation: 
scalar performance:
{'acc': 0.98036397, 'precision': 0.8578025, 'recall': 0.83682287, 'specificity': 0.83682287, 'f1': 0.84696746, 'auroc': 0.97845715, 'binary_precision': 0.7268212, 'binary_recall': 0.6827372, 'binary_specificity': 0.99090856, 'binary_f1_score': 0.7040898}
confusion matrix:
       0    1
0  17984  165
1    204  439
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96228826, 'precision': 0.77587676, 'recall': 0.66882676, 'specificity': 0.66882676, 'f1': 0.70794964, 'auroc': 0.9511659, 'binary_precision': 0.57961786, 'binary_recall': 0.348659, 'binary_specificity': 0.9889945, 'binary_f1_score': 0.43540668}
confusion matrix:
      0   1
0  5931  66
1   170  91
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754609.png
better model found
persisted
after epoch: 5,now: 2024-05-23 17:17:47.848384,epoch time: 0:33:56.547078,used: 3:14:17.940235,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_14_03_29_seed_0_20754609
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9810468, 'precision': 0.96868014, 'recall': 0.7280498, 'specificity': 0.7280498, 'f1': 0.8042487, 'auroc': 0.99030745, 'binary_precision': 0.9559033, 'binary_recall': 0.45683208, 'binary_specificity': 0.9992675, 'binary_f1_score': 0.61821526}
confusion matrix:
       0    1
0  42290   31
1    799  672
---- Validation: 
scalar performance:
{'acc': 0.9772776, 'precision': 0.9601782, 'recall': 0.67846346, 'specificity': 0.67846346, 'f1': 0.75348306, 'auroc': 0.97991675, 'binary_precision': 0.94262296, 'binary_recall': 0.3576983, 'binary_specificity': 0.9992286, 'binary_f1_score': 0.5186021}
confusion matrix:
       0    1
0  18135   14
1    413  230
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.97922325, 'recall': 0.5019157, 'specificity': 0.5019157, 'f1': 0.49320802, 'auroc': 0.95537055, 'binary_precision': 1.0, 'binary_recall': 0.0038314175, 'binary_specificity': 1.0, 'binary_f1_score': 0.007633588}
confusion matrix:
      0  1
0  5997  0
1   260  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754609.png
early stop counter: 1
val acc:0.9772775769233704, best validation acc: 0.9803639650344849, corresponding to test acc:                         0.9622882604598999 / 0.9638862013816833
after epoch: 6,now: 2024-05-23 17:51:54.790757,epoch time: 0:34:06.942373,used: 3:48:24.882608,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_14_03_29_seed_0_20754609
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98696107, 'precision': 0.893917, 'recall': 0.9096497, 'specificity': 0.9096497, 'f1': 0.90161616, 'auroc': 0.99255633, 'binary_precision': 0.79386824, 'binary_recall': 0.8267663, 'binary_specificity': 0.9925331, 'binary_f1_score': 0.8099834}
confusion matrix:
       0     1
0  42004   316
1    255  1217
---- Validation: 
scalar performance:
{'acc': 0.9845147, 'precision': 0.8999087, 'recall': 0.8547229, 'specificity': 0.8547229, 'f1': 0.87585115, 'auroc': 0.9781001, 'binary_precision': 0.80985916, 'binary_recall': 0.7153966, 'binary_specificity': 0.99404925, 'binary_f1_score': 0.7597028}
confusion matrix:
       0    1
0  18041  108
1    183  460
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9603707, 'precision': 0.7929485, 'recall': 0.5615509, 'specificity': 0.5615509, 'f1': 0.59493333, 'auroc': 0.94988716, 'binary_precision': 0.6226415, 'binary_recall': 0.12643678, 'binary_specificity': 0.996665, 'binary_f1_score': 0.21019109}
confusion matrix:
      0   1
0  5977  20
1   228  33
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754609.png
better model found
persisted
after epoch: 7,now: 2024-05-23 18:25:16.349685,epoch time: 0:33:21.558928,used: 4:21:46.441536,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_14_03_29_seed_0_20754609
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9889934, 'precision': 0.9249772, 'recall': 0.90152115, 'specificity': 0.90152115, 'f1': 0.9128897, 'auroc': 0.993304, 'binary_precision': 0.85662824, 'binary_recall': 0.80774456, 'binary_specificity': 0.99529773, 'binary_f1_score': 0.8314685}
confusion matrix:
       0     1
0  42121   199
1    283  1189
---- Validation: 
scalar performance:
{'acc': 0.9863772, 'precision': 0.93121725, 'recall': 0.8504368, 'specificity': 0.8504368, 'f1': 0.8863307, 'auroc': 0.98280144, 'binary_precision': 0.87283236, 'binary_recall': 0.7045101, 'binary_specificity': 0.99636346, 'binary_f1_score': 0.77969015}
confusion matrix:
       0    1
0  18083   66
1    190  453
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9613295, 'precision': 0.8947692, 'recall': 0.5455601, 'specificity': 0.5455601, 'f1': 0.5728617, 'auroc': 0.95399165, 'binary_precision': 0.82758623, 'binary_recall': 0.09195402, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.16551723}
confusion matrix:
      0   1
0  5992   5
1   237  24
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754609.png
better model found
persisted
after epoch: 8,now: 2024-05-23 18:58:07.442587,epoch time: 0:32:51.092902,used: 4:54:37.534438,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_14_03_29_seed_0_20754609
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98960996, 'precision': 0.945578, 'recall': 0.8877422, 'specificity': 0.8877422, 'f1': 0.9145008, 'auroc': 0.9951196, 'binary_precision': 0.8988235, 'binary_recall': 0.7785326, 'binary_specificity': 0.9969518, 'binary_f1_score': 0.8343648}
confusion matrix:
       0     1
0  42191   129
1    326  1146
---- Validation: 
scalar performance:
{'acc': 0.9848872, 'precision': 0.93277824, 'recall': 0.8226634, 'specificity': 0.8226634, 'f1': 0.8690935, 'auroc': 0.98442304, 'binary_precision': 0.87789476, 'binary_recall': 0.64852256, 'binary_specificity': 0.99680424, 'binary_f1_score': 0.745975}
confusion matrix:
       0    1
0  18091   58
1    226  417
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96164906, 'precision': 0.9004854, 'recall': 0.54939157, 'specificity': 0.54939157, 'f1': 0.57922435, 'auroc': 0.9596572, 'binary_precision': 0.83870965, 'binary_recall': 0.099616855, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.1780822}
confusion matrix:
      0   1
0  5992   5
1   235  26
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754609.png
early stop counter: 1
val acc:0.9848871827125549, best validation acc: 0.9863771796226501, corresponding to test acc:                         0.9613295197486877 / 0.9638862013816833
after epoch: 9,now: 2024-05-23 19:30:35.793699,epoch time: 0:32:28.351112,used: 5:27:05.885550,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_14_03_29_seed_0_20754609
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9889021, 'precision': 0.9069471, 'recall': 0.9266715, 'specificity': 0.9266715, 'f1': 0.91655624, 'auroc': 0.9940754, 'binary_precision': 0.81877023, 'binary_recall': 0.8599592, 'binary_specificity': 0.9933839, 'binary_f1_score': 0.8388594}
confusion matrix:
       0     1
0  42041   280
1    206  1265
---- Validation: 
scalar performance:
{'acc': 0.9852597, 'precision': 0.9030914, 'recall': 0.86485934, 'specificity': 0.86485934, 'f1': 0.8829449, 'auroc': 0.9818758, 'binary_precision': 0.81551725, 'binary_recall': 0.7356143, 'binary_specificity': 0.9941044, 'binary_f1_score': 0.7735078}
confusion matrix:
       0    1
0  18042  107
1    170  473
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96196866, 'precision': 0.8653782, 'recall': 0.56238467, 'specificity': 0.56238467, 'f1': 0.5988081, 'auroc': 0.9544554, 'binary_precision': 0.76744187, 'binary_recall': 0.12643678, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.21710527}
confusion matrix:
      0   1
0  5987  10
1   228  33
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754609.png
early stop counter: 2
val acc:0.9852597117424011, best validation acc: 0.9863771796226501, corresponding to test acc:                         0.9613295197486877 / 0.9638862013816833
after epoch: 10,now: 2024-05-23 20:04:00.347619,epoch time: 0:33:24.553920,used: 6:00:30.439470,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_14_03_29_seed_0_20754609
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99219036, 'precision': 0.94010556, 'recall': 0.93952787, 'specificity': 0.93952787, 'f1': 0.9398165, 'auroc': 0.997144, 'binary_precision': 0.884275, 'binary_recall': 0.88307273, 'binary_specificity': 0.99598306, 'binary_f1_score': 0.8836734}
confusion matrix:
       0     1
0  42151   170
1    172  1299
---- Validation: 
scalar performance:
{'acc': 0.98557895, 'precision': 0.90953755, 'recall': 0.8620244, 'specificity': 0.8620244, 'f1': 0.88419884, 'auroc': 0.98480904, 'binary_precision': 0.8286219, 'binary_recall': 0.7293935, 'binary_specificity': 0.9946554, 'binary_f1_score': 0.7758479}
confusion matrix:
       0    1
0  18052   97
1    174  469
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96212846, 'precision': 0.7949907, 'recall': 0.61377335, 'specificity': 0.61377335, 'f1': 0.66016895, 'auroc': 0.9641851, 'binary_precision': 0.622449, 'binary_recall': 0.23371647, 'binary_specificity': 0.99383026, 'binary_f1_score': 0.33983287}
confusion matrix:
      0   1
0  5960  37
1   200  61
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754609.png
early stop counter: 3
val acc:0.9855789542198181, best validation acc: 0.9863771796226501, corresponding to test acc:                         0.9613295197486877 / 0.9638862013816833
after epoch: 11,now: 2024-05-23 20:36:41.462066,epoch time: 0:32:41.114447,used: 6:33:11.553917,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_14_03_29_seed_0_20754609
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98924464, 'precision': 0.89808625, 'recall': 0.9498151, 'specificity': 0.9498151, 'f1': 0.922235, 'auroc': 0.99584305, 'binary_precision': 0.7994012, 'binary_recall': 0.90754586, 'binary_specificity': 0.9920843, 'binary_f1_score': 0.8500477}
confusion matrix:
       0     1
0  41986   335
1    136  1335
---- Validation: 
scalar performance:
{'acc': 0.9838761, 'precision': 0.8680293, 'recall': 0.89939564, 'specificity': 0.89939564, 'f1': 0.88301253, 'auroc': 0.9790944, 'binary_precision': 0.74285716, 'binary_recall': 0.8087092, 'binary_specificity': 0.9900821, 'binary_f1_score': 0.7743857}
confusion matrix:
       0    1
0  17969  180
1    123  520
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.7811685, 'recall': 0.5502234, 'specificity': 0.5502234, 'f1': 0.5779159, 'auroc': 0.9477151, 'binary_precision': 0.6, 'binary_recall': 0.10344828, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.1764706}
confusion matrix:
      0   1
0  5979  18
1   234  27
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754609.png
early stop counter: 4
val acc:0.98387610912323, best validation acc: 0.9863771796226501, corresponding to test acc:                         0.9613295197486877 / 0.9638862013816833
after epoch: 12,now: 2024-05-23 21:08:57.735997,epoch time: 0:32:16.273931,used: 7:05:27.827848,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_14_03_29_seed_0_20754609
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9918935, 'precision': 0.9438188, 'recall': 0.92953163, 'specificity': 0.92953163, 'f1': 0.9365492, 'auroc': 0.9973807, 'binary_precision': 0.8924051, 'binary_recall': 0.86267847, 'binary_specificity': 0.9963848, 'binary_f1_score': 0.87729}
confusion matrix:
       0     1
0  42168   153
1    202  1269
---- Validation: 
scalar performance:
{'acc': 0.9860579, 'precision': 0.928245, 'recall': 0.84802127, 'specificity': 0.84802127, 'f1': 0.88366663, 'auroc': 0.9860742, 'binary_precision': 0.867052, 'binary_recall': 0.6998445, 'binary_specificity': 0.9961981, 'binary_f1_score': 0.7745267}
confusion matrix:
       0    1
0  18080   69
1    193  450
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9600511, 'precision': 0.7875204, 'recall': 0.55588716, 'specificity': 0.55588716, 'f1': 0.58653337, 'auroc': 0.9595783, 'binary_precision': 0.6122449, 'binary_recall': 0.11494253, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.19354838}
confusion matrix:
      0   1
0  5978  19
1   231  30
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754609.png
early stop counter: 5
val acc:0.9860578775405884, best validation acc: 0.9863771796226501, corresponding to test acc:                         0.9613295197486877 / 0.9638862013816833
after epoch: 13,now: 2024-05-23 21:41:02.987177,epoch time: 0:32:05.251180,used: 7:37:33.079028,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_14_03_29_seed_0_20754609
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99237305, 'precision': 0.94488513, 'recall': 0.9367114, 'specificity': 0.9367114, 'f1': 0.9407574, 'auroc': 0.9973295, 'binary_precision': 0.89404434, 'binary_recall': 0.87703806, 'binary_specificity': 0.9963847, 'binary_f1_score': 0.88545954}
confusion matrix:
       0     1
0  42167   153
1    181  1291
---- Validation: 
scalar performance:
{'acc': 0.98616433, 'precision': 0.9103817, 'recall': 0.8720782, 'specificity': 0.8720782, 'f1': 0.89021546, 'auroc': 0.98101974, 'binary_precision': 0.82960415, 'binary_recall': 0.7496112, 'binary_specificity': 0.99454516, 'binary_f1_score': 0.7875817}
confusion matrix:
       0    1
0  18050   99
1    161  482
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9613295, 'precision': 0.8053957, 'recall': 0.5785421, 'specificity': 0.5785421, 'f1': 0.61890817, 'auroc': 0.9446984, 'binary_precision': 0.64615387, 'binary_recall': 0.16091955, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.25766873}
confusion matrix:
      0   1
0  5974  23
1   219  42
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754609.png
early stop counter: 6
val acc:0.9861643314361572, best validation acc: 0.9863771796226501, corresponding to test acc:                         0.9613295197486877 / 0.9638862013816833
after epoch: 14,now: 2024-05-23 22:13:03.436830,epoch time: 0:32:00.449653,used: 8:09:33.528681,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_14_03_29_seed_0_20754609
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9931951, 'precision': 0.9425143, 'recall': 0.9541259, 'specificity': 0.9541259, 'f1': 0.94823885, 'auroc': 0.99809194, 'binary_precision': 0.88807946, 'binary_recall': 0.9122449, 'binary_specificity': 0.9960068, 'binary_f1_score': 0.9}
confusion matrix:
       0     1
0  42153   169
1    129  1341
---- Validation: 
scalar performance:
{'acc': 0.9879204, 'precision': 0.9308296, 'recall': 0.8782377, 'specificity': 0.8782377, 'f1': 0.9026892, 'auroc': 0.98706603, 'binary_precision': 0.87010676, 'binary_recall': 0.7604977, 'binary_specificity': 0.99597776, 'binary_f1_score': 0.81161827}
confusion matrix:
       0    1
0  18076   73
1    154  489
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96596354, 'precision': 0.84623307, 'recall': 0.646924, 'specificity': 0.646924, 'f1': 0.7026145, 'auroc': 0.94725734, 'binary_precision': 0.7222222, 'binary_recall': 0.29885057, 'binary_specificity': 0.9949975, 'binary_f1_score': 0.4227642}
confusion matrix:
      0   1
0  5967  30
1   183  78
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754609.png
new oracle model saved
better model found
persisted
after epoch: 15,now: 2024-05-23 22:44:58.630500,epoch time: 0:31:55.193670,used: 8:41:28.722351,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_14_03_29_seed_0_20754609
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9913911, 'precision': 0.9225577, 'recall': 0.9499414, 'specificity': 0.9499414, 'f1': 0.9357841, 'auroc': 0.99706966, 'binary_precision': 0.8484076, 'binary_recall': 0.90550643, 'binary_specificity': 0.9943763, 'binary_f1_score': 0.8760275}
confusion matrix:
       0     1
0  42083   238
1    139  1332
---- Validation: 
scalar performance:
{'acc': 0.98541933, 'precision': 0.90211666, 'recall': 0.86944234, 'specificity': 0.86944234, 'f1': 0.88503, 'auroc': 0.97372305, 'binary_precision': 0.8132428, 'binary_recall': 0.7449456, 'binary_specificity': 0.99393904, 'binary_f1_score': 0.77759737}
confusion matrix:
       0    1
0  18039  110
1    164  479
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96260786, 'precision': 0.8818928, 'recall': 0.56821513, 'specificity': 0.56821513, 'f1': 0.6080648, 'auroc': 0.9252209, 'binary_precision': 0.8, 'binary_recall': 0.13793103, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.2352941}
confusion matrix:
      0   1
0  5988   9
1   225  36
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754609.png
early stop counter: 1
val acc:0.9854193329811096, best validation acc: 0.9879204034805298, corresponding to test acc:                         0.9659635424613953 / 0.9659635424613953
after epoch: 16,now: 2024-05-23 23:16:57.957823,epoch time: 0:31:59.327323,used: 9:13:28.049674,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_14_03_29_seed_0_20754609
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99321795, 'precision': 0.9572142, 'recall': 0.9364928, 'specificity': 0.9364928, 'f1': 0.9465948, 'auroc': 0.997918, 'binary_precision': 0.9187455, 'binary_recall': 0.8756794, 'binary_specificity': 0.9973062, 'binary_f1_score': 0.8966957}
confusion matrix:
       0     1
0  42206   114
1    183  1289
---- Validation: 
scalar performance:
{'acc': 0.98573864, 'precision': 0.9266222, 'recall': 0.8441057, 'specificity': 0.8441057, 'f1': 0.8806045, 'auroc': 0.9814503, 'binary_precision': 0.8640777, 'binary_recall': 0.69206846, 'binary_specificity': 0.99614304, 'binary_f1_score': 0.7685665}
confusion matrix:
       0    1
0  18079   70
1    198  445
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9610099, 'precision': 0.8150475, 'recall': 0.5637167, 'specificity': 0.5637167, 'f1': 0.5989776, 'auroc': 0.9409771, 'binary_precision': 0.6666667, 'binary_recall': 0.1302682, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.21794872}
confusion matrix:
      0   1
0  5980  17
1   227  34
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754609.png
early stop counter: 2
val acc:0.9857386350631714, best validation acc: 0.9879204034805298, corresponding to test acc:                         0.9659635424613953 / 0.9659635424613953
after epoch: 17,now: 2024-05-23 23:49:33.320425,epoch time: 0:32:35.362602,used: 9:46:03.412276,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_14_03_29_seed_0_20754609
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9952046, 'precision': 0.9639356, 'recall': 0.9621101, 'specificity': 0.9621101, 'f1': 0.9630209, 'auroc': 0.99887145, 'binary_precision': 0.9304229, 'binary_recall': 0.92663044, 'binary_specificity': 0.99758977, 'binary_f1_score': 0.9285228}
confusion matrix:
       0     1
0  42218   102
1    108  1364
---- Validation: 
scalar performance:
{'acc': 0.9877607, 'precision': 0.93495566, 'recall': 0.8706545, 'specificity': 0.8706545, 'f1': 0.90003896, 'auroc': 0.98679894, 'binary_precision': 0.8788991, 'binary_recall': 0.7449456, 'binary_specificity': 0.99636346, 'binary_f1_score': 0.8063973}
confusion matrix:
       0    1
0  18083   66
1    164  479
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964845, 'precision': 0.86677647, 'recall': 0.6115261, 'specificity': 0.6115261, 'f1': 0.6655235, 'auroc': 0.9577031, 'binary_precision': 0.76623374, 'binary_recall': 0.22605364, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.3491124}
confusion matrix:
      0   1
0  5979  18
1   202  59
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754609.png
early stop counter: 3
val acc:0.9877607226371765, best validation acc: 0.9879204034805298, corresponding to test acc:                         0.9659635424613953 / 0.9659635424613953
after epoch: 18,now: 2024-05-24 00:21:15.920084,epoch time: 0:31:42.599659,used: 10:17:46.011935,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_14_03_29_seed_0_20754609
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9930581, 'precision': 0.95808715, 'recall': 0.93280363, 'specificity': 0.93280363, 'f1': 0.94505906, 'auroc': 0.9978461, 'binary_precision': 0.9207493, 'binary_recall': 0.8682065, 'binary_specificity': 0.99740076, 'binary_f1_score': 0.89370626}
confusion matrix:
       0     1
0  42210   110
1    194  1278
---- Validation: 
scalar performance:
{'acc': 0.9853129, 'precision': 0.9260234, 'recall': 0.83713484, 'specificity': 0.83713484, 'f1': 0.8760035, 'auroc': 0.97996247, 'binary_precision': 0.86336637, 'binary_recall': 0.67807156, 'binary_specificity': 0.9961981, 'binary_f1_score': 0.7595819}
confusion matrix:
       0    1
0  18080   69
1    207  436
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.8474791, 'recall': 0.5414786, 'specificity': 0.5414786, 'f1': 0.5654991, 'auroc': 0.93009734, 'binary_precision': 0.73333335, 'binary_recall': 0.08429119, 'binary_specificity': 0.998666, 'binary_f1_score': 0.15120275}
confusion matrix:
      0   1
0  5989   8
1   239  22
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754609.png
early stop counter: 4
val acc:0.9853128790855408, best validation acc: 0.9879204034805298, corresponding to test acc:                         0.9659635424613953 / 0.9659635424613953
after epoch: 19,now: 2024-05-24 00:53:19.735899,epoch time: 0:32:03.815815,used: 10:49:49.827750,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_14_03_29_seed_0_20754609
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9932408, 'precision': 0.97543764, 'recall': 0.91781664, 'specificity': 0.91781664, 'f1': 0.944632, 'auroc': 0.9984267, 'binary_precision': 0.95652175, 'binary_recall': 0.8369565, 'binary_specificity': 0.9986768, 'binary_f1_score': 0.8927536}
confusion matrix:
       0     1
0  42264    56
1    240  1232
---- Validation: 
scalar performance:
{'acc': 0.9850468, 'precision': 0.9481844, 'recall': 0.8114952, 'specificity': 0.8114952, 'f1': 0.8666575, 'auroc': 0.97992814, 'binary_precision': 0.90950227, 'binary_recall': 0.62519443, 'binary_specificity': 0.997796, 'binary_f1_score': 0.7410138}
confusion matrix:
       0    1
0  18109   40
1    241  402
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606903, 'precision': 0.9090909, 'recall': 0.5342326, 'specificity': 0.5342326, 'f1': 0.55377585, 'auroc': 0.9451261, 'binary_precision': 0.85714287, 'binary_recall': 0.06896552, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.12765957}
confusion matrix:
      0   1
0  5994   3
1   243  18
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754609.png
early stop counter: 5
val acc:0.9850468039512634, best validation acc: 0.9879204034805298, corresponding to test acc:                         0.9659635424613953 / 0.9659635424613953
after epoch: 20,now: 2024-05-24 01:25:50.503265,epoch time: 0:32:30.767366,used: 11:22:20.595116,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_14_03_29_seed_0_20754609
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9938345, 'precision': 0.95228374, 'recall': 0.9528769, 'specificity': 0.9528769, 'f1': 0.9525801, 'auroc': 0.99767715, 'binary_precision': 0.90773404, 'binary_recall': 0.9089674, 'binary_specificity': 0.9967864, 'binary_f1_score': 0.9083503}
confusion matrix:
       0     1
0  42184   136
1    134  1338
---- Validation: 
scalar performance:
{'acc': 0.98573864, 'precision': 0.9146228, 'recall': 0.8583568, 'specificity': 0.8583568, 'f1': 0.88427734, 'auroc': 0.9765115, 'binary_precision': 0.83905965, 'binary_recall': 0.7216174, 'binary_specificity': 0.99509615, 'binary_f1_score': 0.7759197}
confusion matrix:
       0    1
0  18060   89
1    179  464
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645254, 'precision': 0.8292256, 'recall': 0.63334733, 'specificity': 0.63334733, 'f1': 0.6859207, 'auroc': 0.9435088, 'binary_precision': 0.6893204, 'binary_recall': 0.27203065, 'binary_specificity': 0.994664, 'binary_f1_score': 0.3901099}
confusion matrix:
      0   1
0  5965  32
1   190  71
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754609.png
early stop counter: 6
val acc:0.9857386350631714, best validation acc: 0.9879204034805298, corresponding to test acc:                         0.9659635424613953 / 0.9659635424613953
after epoch: 21,now: 2024-05-24 01:57:36.979447,epoch time: 0:31:46.476182,used: 11:54:07.071298,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_14_03_29_seed_0_20754609
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.993766, 'precision': 0.9492479, 'recall': 0.9554353, 'specificity': 0.9554353, 'f1': 0.9523188, 'auroc': 0.99835515, 'binary_precision': 0.90147454, 'binary_recall': 0.914344, 'binary_specificity': 0.99652654, 'binary_f1_score': 0.9078637}
confusion matrix:
       0     1
0  42174   147
1    126  1345
---- Validation: 
scalar performance:
{'acc': 0.98659, 'precision': 0.9184826, 'recall': 0.86929834, 'specificity': 0.86929834, 'f1': 0.8922315, 'auroc': 0.97590464, 'binary_precision': 0.8460177, 'binary_recall': 0.7433904, 'binary_specificity': 0.99520636, 'binary_f1_score': 0.7913907}
confusion matrix:
       0    1
0  18062   87
1    165  478
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96244806, 'precision': 0.8620393, 'recall': 0.5717964, 'specificity': 0.5717964, 'f1': 0.6125593, 'auroc': 0.9326775, 'binary_precision': 0.76, 'binary_recall': 0.14559387, 'binary_specificity': 0.997999, 'binary_f1_score': 0.24437298}
confusion matrix:
      0   1
0  5985  12
1   223  38
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754609.png
early stop counter: 7
val acc:0.9865900278091431, best validation acc: 0.9879204034805298, corresponding to test acc:                         0.9659635424613953 / 0.9659635424613953
after epoch: 22,now: 2024-05-24 02:29:36.105358,epoch time: 0:31:59.125911,used: 12:26:06.197209,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_14_03_29_seed_0_20754609
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9938573, 'precision': 0.9311706, 'recall': 0.98271406, 'specificity': 0.98271406, 'f1': 0.95536745, 'auroc': 0.9991696, 'binary_precision': 0.86336154, 'binary_recall': 0.9707682, 'binary_specificity': 0.99465984, 'binary_f1_score': 0.91392}
confusion matrix:
       0     1
0  42095   226
1     43  1428
---- Validation: 
scalar performance:
{'acc': 0.9865368, 'precision': 0.8961772, 'recall': 0.90152323, 'specificity': 0.90152323, 'f1': 0.89883065, 'auroc': 0.9806135, 'binary_precision': 0.7990798, 'binary_recall': 0.8102644, 'binary_specificity': 0.992782, 'binary_f1_score': 0.8046332}
confusion matrix:
       0    1
0  18018  131
1    122  521
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606903, 'precision': 0.8080896, 'recall': 0.5598853, 'specificity': 0.5598853, 'f1': 0.5931488, 'auroc': 0.9165028, 'binary_precision': 0.6530612, 'binary_recall': 0.12260536, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.2064516}
confusion matrix:
      0   1
0  5980  17
1   229  32
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754609.png
early stop counter: 8
val acc:0.9865368008613586, best validation acc: 0.9879204034805298, corresponding to test acc:                         0.9659635424613953 / 0.9659635424613953
after epoch: 23,now: 2024-05-24 03:01:35.536531,epoch time: 0:31:59.431173,used: 12:58:05.628382,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_14_03_29_seed_0_20754609
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99547863, 'precision': 0.97653615, 'recall': 0.952744, 'specificity': 0.952744, 'f1': 0.96431255, 'auroc': 0.9992399, 'binary_precision': 0.9563037, 'binary_recall': 0.9069294, 'binary_specificity': 0.9985586, 'binary_f1_score': 0.9309623}
confusion matrix:
       0     1
0  42259    61
1    137  1335
---- Validation: 
scalar performance:
{'acc': 0.9852597, 'precision': 0.9338537, 'recall': 0.82810664, 'specificity': 0.82810664, 'f1': 0.87309015, 'auroc': 0.97783923, 'binary_precision': 0.87966806, 'binary_recall': 0.65940905, 'binary_specificity': 0.99680424, 'binary_f1_score': 0.7537778}
confusion matrix:
       0    1
0  18091   58
1    219  424
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9613295, 'precision': 0.8531424, 'recall': 0.55472183, 'specificity': 0.55472183, 'f1': 0.58676165, 'auroc': 0.9265728, 'binary_precision': 0.74358976, 'binary_recall': 0.11111111, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.19333333}
confusion matrix:
      0   1
0  5987  10
1   232  29
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754609.png
early stop counter: 9
val acc:0.9852597117424011, best validation acc: 0.9879204034805298, corresponding to test acc:                         0.9659635424613953 / 0.9659635424613953
after epoch: 24,now: 2024-05-24 03:34:06.695037,epoch time: 0:32:31.158506,used: 13:30:36.786888,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_14_03_29_seed_0_20754609
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9957298, 'precision': 0.95699716, 'recall': 0.97943056, 'specificity': 0.97943056, 'f1': 0.9679238, 'auroc': 0.99940455, 'binary_precision': 0.91532, 'binary_recall': 0.9619565, 'binary_specificity': 0.99690455, 'binary_f1_score': 0.938059}
confusion matrix:
       0     1
0  42189   131
1     56  1416
---- Validation: 
scalar performance:
{'acc': 0.987335, 'precision': 0.9242642, 'recall': 0.8756845, 'specificity': 0.8756845, 'f1': 0.8983813, 'auroc': 0.9764049, 'binary_precision': 0.85714287, 'binary_recall': 0.755832, 'binary_specificity': 0.9955369, 'binary_f1_score': 0.80330575}
confusion matrix:
       0    1
0  18068   81
1    157  486
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606903, 'precision': 0.82272446, 'recall': 0.552556, 'specificity': 0.552556, 'f1': 0.5826448, 'auroc': 0.9318697, 'binary_precision': 0.68292683, 'binary_recall': 0.107279696, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.18543045}
confusion matrix:
      0   1
0  5984  13
1   233  28
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754609.png
early stop counter: 10
val acc:0.9873350262641907, best validation acc: 0.9879204034805298, corresponding to test acc:                         0.9659635424613953 / 0.9659635424613953
after epoch: 25,now: 2024-05-24 04:06:41.140802,epoch time: 0:32:34.445765,used: 14:03:11.232653,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_14_03_29_seed_0_20754609
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9962322, 'precision': 0.9729036, 'recall': 0.9688711, 'specificity': 0.9688711, 'f1': 0.970878, 'auroc': 0.99944186, 'binary_precision': 0.94790953, 'binary_recall': 0.93953806, 'binary_specificity': 0.9982042, 'binary_f1_score': 0.94370526}
confusion matrix:
       0     1
0  42244    76
1     89  1383
---- Validation: 
scalar performance:
{'acc': 0.98738825, 'precision': 0.93066955, 'recall': 0.8689616, 'specificity': 0.8689616, 'f1': 0.8972477, 'auroc': 0.97961855, 'binary_precision': 0.870438, 'binary_recall': 0.7418352, 'binary_specificity': 0.99608797, 'binary_f1_score': 0.8010075}
confusion matrix:
       0    1
0  18078   71
1    166  477
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.79314566, 'recall': 0.5373137, 'specificity': 0.5373137, 'f1': 0.55791, 'auroc': 0.9123069, 'binary_precision': 0.625, 'binary_recall': 0.07662835, 'binary_specificity': 0.997999, 'binary_f1_score': 0.13651878}
confusion matrix:
      0   1
0  5985  12
1   241  20
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754609.png
early stop counter: 11
val acc:0.9873882532119751, best validation acc: 0.9879204034805298, corresponding to test acc:                         0.9659635424613953 / 0.9659635424613953
after epoch: 26,now: 2024-05-24 04:39:12.017495,epoch time: 0:32:30.876693,used: 14:35:42.109346,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_14_03_29_seed_0_20754609
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9932408, 'precision': 0.9360088, 'recall': 0.96399915, 'specificity': 0.96399915, 'f1': 0.9495332, 'auroc': 0.998789, 'binary_precision': 0.87436223, 'binary_recall': 0.93265307, 'binary_specificity': 0.99534523, 'binary_f1_score': 0.90256745}
confusion matrix:
       0     1
0  42125   197
1     99  1371
---- Validation: 
scalar performance:
{'acc': 0.9856322, 'precision': 0.9131104, 'recall': 0.85830164, 'specificity': 0.85830164, 'f1': 0.88360196, 'auroc': 0.9762136, 'binary_precision': 0.836036, 'binary_recall': 0.7216174, 'binary_specificity': 0.99498594, 'binary_f1_score': 0.77462435}
confusion matrix:
       0    1
0  18058   91
1    179  464
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.791682, 'recall': 0.54289407, 'specificity': 0.54289407, 'f1': 0.56686854, 'auroc': 0.9388626, 'binary_precision': 0.6216216, 'binary_recall': 0.08812261, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.15436241}
confusion matrix:
      0   1
0  5983  14
1   238  23
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754609.png
early stop counter: 12
val acc:0.9856321811676025, best validation acc: 0.9879204034805298, corresponding to test acc:                         0.9659635424613953 / 0.9659635424613953
after epoch: 27,now: 2024-05-24 05:11:42.438353,epoch time: 0:32:30.420858,used: 15:08:12.530204,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_14_03_29_seed_0_20754609
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9966661, 'precision': 0.9758228, 'recall': 0.972702, 'specificity': 0.972702, 'f1': 0.9742569, 'auroc': 0.9995723, 'binary_precision': 0.95348835, 'binary_recall': 0.9470109, 'binary_specificity': 0.9983932, 'binary_f1_score': 0.9502385}
confusion matrix:
       0     1
0  42252    68
1     78  1394
---- Validation: 
scalar performance:
{'acc': 0.9876543, 'precision': 0.92281425, 'recall': 0.8833504, 'specificity': 0.8833504, 'f1': 0.9020384, 'auroc': 0.9792981, 'binary_precision': 0.8537005, 'binary_recall': 0.7713841, 'binary_specificity': 0.99531657, 'binary_f1_score': 0.81045747}
confusion matrix:
       0    1
0  18064   85
1    147  496
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.74759376, 'recall': 0.5442261, 'specificity': 0.5442261, 'f1': 0.56786627, 'auroc': 0.93324697, 'binary_precision': 0.53333336, 'binary_recall': 0.09195402, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.15686274}
confusion matrix:
      0   1
0  5976  21
1   237  24
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754609.png
early stop counter: 13
val acc:0.9876543283462524, best validation acc: 0.9879204034805298, corresponding to test acc:                         0.9659635424613953 / 0.9659635424613953
after epoch: 28,now: 2024-05-24 05:44:09.291743,epoch time: 0:32:26.853390,used: 15:40:39.383594,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_14_03_29_seed_0_20754609
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9962094, 'precision': 0.9783317, 'recall': 0.96263, 'specificity': 0.96263, 'f1': 0.97033995, 'auroc': 0.9994749, 'binary_precision': 0.95921236, 'binary_recall': 0.92663044, 'binary_specificity': 0.9986295, 'binary_f1_score': 0.94263995}
confusion matrix:
       0     1
0  42262    58
1    108  1364
---- Validation: 
scalar performance:
{'acc': 0.9859515, 'precision': 0.9335726, 'recall': 0.84046566, 'specificity': 0.84046566, 'f1': 0.880993, 'auroc': 0.97021234, 'binary_precision': 0.8782435, 'binary_recall': 0.6842924, 'binary_specificity': 0.99663895, 'binary_f1_score': 0.7692308}
confusion matrix:
       0    1
0  18088   61
1    203  440
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.83445287, 'recall': 0.5977826, 'specificity': 0.5977826, 'f1': 0.6457419, 'auroc': 0.92461014, 'binary_precision': 0.7027027, 'binary_recall': 0.19923371, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.31044775}
confusion matrix:
      0   1
0  5975  22
1   209  52
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754609.png
early stop counter: 14
val acc:0.9859514832496643, best validation acc: 0.9879204034805298, corresponding to test acc:                         0.9659635424613953 / 0.9659635424613953
after epoch: 29,now: 2024-05-24 06:16:31.484051,epoch time: 0:32:22.192308,used: 16:13:01.575902,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_14_03_29_seed_0_20754609
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99595815, 'precision': 0.96509063, 'recall': 0.97331935, 'specificity': 0.97331935, 'f1': 0.96916604, 'auroc': 0.9992855, 'binary_precision': 0.9319546, 'binary_recall': 0.94904894, 'binary_specificity': 0.99758977, 'binary_f1_score': 0.940424}
confusion matrix:
       0     1
0  42218   102
1     75  1397
---- Validation: 
scalar performance:
{'acc': 0.9867497, 'precision': 0.9262985, 'recall': 0.8626305, 'specificity': 0.8626305, 'f1': 0.8916931, 'auroc': 0.97358084, 'binary_precision': 0.8621324, 'binary_recall': 0.7293935, 'binary_specificity': 0.99586755, 'binary_f1_score': 0.7902275}
confusion matrix:
       0    1
0  18074   75
1    174  469
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96196866, 'precision': 0.83665085, 'recall': 0.5733786, 'specificity': 0.5733786, 'f1': 0.6136636, 'auroc': 0.9198544, 'binary_precision': 0.7090909, 'binary_recall': 0.14942528, 'binary_specificity': 0.997332, 'binary_f1_score': 0.24683544}
confusion matrix:
      0   1
0  5981  16
1   222  39
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754609.png
early stop counter: 15
val acc:0.9867497086524963, best validation acc: 0.9879204034805298, corresponding to test acc:                         0.9659635424613953 / 0.9659635424613953
after epoch: 30,now: 2024-05-24 06:48:55.408988,epoch time: 0:32:23.924937,used: 16:45:25.500839,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_14_03_29_seed_0_20754609
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 16:45:25.500839 at 2024-05-24 06:48:55.408988
persisted model performance metric: 

scalar performance:
{'acc': 0.9646852, 'precision': 0.82738936, 'recall': 0.6389277, 'specificity': 0.6389277, 'f1': 0.6914451, 'auroc': 0.9528051, 'binary_precision': 0.6851852, 'binary_recall': 0.2835249, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.40108404}
confusion matrix:
      0   1
0  5963  34
1   187  74
oracle model performance metric: 

scalar performance:
{'acc': 0.96628314, 'precision': 0.83982974, 'recall': 0.6599171, 'specificity': 0.6599171, 'f1': 0.7144033, 'auroc': 0.950975, 'binary_precision': 0.7083333, 'binary_recall': 0.3256705, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.4461942}
confusion matrix:
      0   1
0  5962  35
1   176  85
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dial_irm/rule_results/0.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dial_irm/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dial_irm/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1669 MiB |   3199 MiB |    873 TiB |    873 TiB |
|       from large pool |   1662 MiB |   3192 MiB |    862 TiB |    862 TiB |
|       from small pool |      6 MiB |     11 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1669 MiB |   3199 MiB |    873 TiB |    873 TiB |
|       from large pool |   1662 MiB |   3192 MiB |    862 TiB |    862 TiB |
|       from small pool |      6 MiB |     11 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1653 MiB |   3184 MiB |    872 TiB |    872 TiB |
|       from large pool |   1647 MiB |   3177 MiB |    860 TiB |    860 TiB |
|       from small pool |      5 MiB |      9 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3476 MiB |   3476 MiB |   3476 MiB |      0 B   |
|       from large pool |   3464 MiB |   3464 MiB |   3464 MiB |      0 B   |
|       from small pool |     12 MiB |     12 MiB |     12 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 275054 KiB | 312915 KiB | 507549 GiB | 507549 GiB |
|       from large pool | 271504 KiB | 309392 KiB | 496046 GiB | 496046 GiB |
|       from small pool |   3550 KiB |   3881 KiB |  11503 GiB |  11503 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3366    |    6337    |  140835 K  |  140832 K  |
|       from large pool |     247    |     352    |   54216 K  |   54215 K  |
|       from small pool |    3119    |    6089    |   86619 K  |   86616 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3366    |    6337    |  140835 K  |  140832 K  |
|       from large pool |     247    |     352    |   54216 K  |   54215 K  |
|       from small pool |    3119    |    6089    |   86619 K  |   86616 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     137    |     137    |     137    |       0    |
|       from large pool |     131    |     131    |     131    |       0    |
|       from small pool |       6    |       6    |       6    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      99    |    2827    |   79663 K  |   79663 K  |
|       from large pool |      81    |     117    |   41501 K  |   41501 K  |
|       from small pool |      18    |    2746    |   38162 K  |   38162 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3199 MiB |    873 TiB |    873 TiB |
|       from large pool |  16640 KiB |   3192 MiB |    862 TiB |    862 TiB |
|       from small pool |      0 KiB |     11 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3199 MiB |    873 TiB |    873 TiB |
|       from large pool |  16640 KiB |   3192 MiB |    862 TiB |    862 TiB |
|       from small pool |      0 KiB |     11 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3184 MiB |    872 TiB |    872 TiB |
|       from large pool |  16640 KiB |   3177 MiB |    860 TiB |    860 TiB |
|       from small pool |      0 KiB |      9 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1938 MiB |   3476 MiB |   3476 MiB |   1538 MiB |
|       from large pool |   1928 MiB |   3464 MiB |   3464 MiB |   1536 MiB |
|       from small pool |     10 MiB |     12 MiB |     12 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 319776 KiB | 507550 GiB | 507550 GiB |
|       from large pool |  24320 KiB | 315536 KiB | 496047 GiB | 496047 GiB |
|       from small pool |      0 KiB |   9143 KiB |  11503 GiB |  11503 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6337    |  140835 K  |  140835 K  |
|       from large pool |       2    |     352    |   54216 K  |   54216 K  |
|       from small pool |       0    |    6089    |   86619 K  |   86619 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6337    |  140835 K  |  140835 K  |
|       from large pool |       2    |     352    |   54216 K  |   54216 K  |
|       from small pool |       0    |    6089    |   86619 K  |   86619 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      93    |     137    |     137    |      44    |
|       from large pool |      88    |     131    |     131    |      43    |
|       from small pool |       5    |       6    |       6    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2827    |   79664 K  |   79664 K  |
|       from large pool |       3    |     117    |   41501 K  |   41501 K  |
|       from small pool |       0    |    2746    |   38163 K  |   38163 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Fri May 24 06:51:49 2024]
Finished job 0.
1 of 1 steps (100%) done
