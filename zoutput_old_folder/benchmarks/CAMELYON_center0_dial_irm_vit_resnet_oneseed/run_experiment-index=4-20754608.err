Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Thu May 23 13:47:24 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_dial_irm/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_dial_irm/rule_results/4.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=4
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_14_03_29_seed_0_20754608

 Experiment start at: 2024-05-23 14:03:29.908521
before training, model accuracy: 0.2401725947856903
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/autograd/graph.py:744: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96650076, 'precision': 0.7415084, 'recall': 0.5223574, 'specificity': 0.5223574, 'f1': 0.5338895, 'auroc': 0.88689804, 'binary_precision': 0.5151515, 'binary_recall': 0.046227057, 'binary_specificity': 0.9984878, 'binary_f1_score': 0.08484092}
confusion matrix:
       0   1
0  42257  64
1   1403  68
---- Validation: 
scalar performance:
{'acc': 0.9653576, 'precision': 0.69496965, 'recall': 0.51628083, 'specificity': 0.51628083, 'f1': 0.5228309, 'auroc': 0.884958, 'binary_precision': 0.42307693, 'binary_recall': 0.03421462, 'binary_specificity': 0.99834704, 'binary_f1_score': 0.06330936}
confusion matrix:
       0   1
0  18119  30
1    621  22
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9637264, 'precision': 0.8899187, 'recall': 0.58345747, 'specificity': 0.58345747, 'f1': 0.63038003, 'auroc': 0.88588035, 'binary_precision': 0.8148148, 'binary_recall': 0.16858238, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.2793651}
confusion matrix:
      0   1
0  5987  10
1   217  44
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754608.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-23 14:41:04.705200,epoch time: 0:37:34.796679,used: 0:37:34.796679,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_14_03_29_seed_0_20754608
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9661354, 'precision': 0.73242414, 'recall': 0.60478497, 'specificity': 0.60478497, 'f1': 0.6420536, 'auroc': 0.9206867, 'binary_precision': 0.49155146, 'binary_recall': 0.2173913, 'binary_specificity': 0.9921786, 'binary_f1_score': 0.30146018}
confusion matrix:
       0    1
0  41989  331
1   1152  320
---- Validation: 
scalar performance:
{'acc': 0.9650915, 'precision': 0.7269012, 'recall': 0.6174005, 'specificity': 0.6174005, 'f1': 0.65289736, 'auroc': 0.9226508, 'binary_precision': 0.48012233, 'binary_recall': 0.24416797, 'binary_specificity': 0.9906331, 'binary_f1_score': 0.32371134}
confusion matrix:
       0    1
0  17979  170
1    486  157
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9753915, 'precision': 0.88816357, 'recall': 0.7727772, 'specificity': 0.7727772, 'f1': 0.8194145, 'auroc': 0.8999231, 'binary_precision': 0.7955801, 'binary_recall': 0.55172414, 'binary_specificity': 0.99383026, 'binary_f1_score': 0.6515837}
confusion matrix:
      0    1
0  5960   37
1   117  144
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754608.png
new oracle model saved
early stop counter: 1
val acc:0.9650915265083313, best validation acc: 0.9653576016426086, corresponding to test acc:                         0.9637264013290405 / 0.9753915071487427
after epoch: 2,now: 2024-05-23 15:15:25.212342,epoch time: 0:34:20.507142,used: 1:11:55.303821,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_14_03_29_seed_0_20754608
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96618104, 'precision': 0.7365725, 'recall': 0.6721293, 'specificity': 0.6721293, 'f1': 0.6987215, 'auroc': 0.92754, 'binary_precision': 0.495283, 'binary_recall': 0.35690007, 'binary_specificity': 0.9873585, 'binary_f1_score': 0.41485578}
confusion matrix:
       0    1
0  41786  535
1    946  525
---- Validation: 
scalar performance:
{'acc': 0.96647507, 'precision': 0.7460081, 'recall': 0.7126238, 'specificity': 0.7126238, 'f1': 0.7279654, 'auroc': 0.92763126, 'binary_precision': 0.5117541, 'binary_recall': 0.44012442, 'binary_specificity': 0.98512316, 'binary_f1_score': 0.47324416}
confusion matrix:
       0    1
0  17879  270
1    360  283
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9782678, 'precision': 0.90038, 'recall': 0.8054276, 'specificity': 0.8054276, 'f1': 0.845889, 'auroc': 0.9167745, 'binary_precision': 0.8172589, 'binary_recall': 0.61685824, 'binary_specificity': 0.993997, 'binary_f1_score': 0.70305675}
confusion matrix:
      0    1
0  5961   36
1   100  161
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754608.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-05-23 15:53:39.471873,epoch time: 0:38:14.259531,used: 1:50:09.563352,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_14_03_29_seed_0_20754608
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9674826, 'precision': 0.7497382, 'recall': 0.7461336, 'specificity': 0.7461336, 'f1': 0.74792135, 'auroc': 0.9323281, 'binary_precision': 0.51655173, 'binary_recall': 0.5088315, 'binary_specificity': 0.98343575, 'binary_f1_score': 0.5126626}
confusion matrix:
       0    1
0  41619  701
1    723  749
---- Validation: 
scalar performance:
{'acc': 0.9657301, 'precision': 0.74160093, 'recall': 0.7639919, 'specificity': 0.7639919, 'f1': 0.75224143, 'auroc': 0.9287704, 'binary_precision': 0.4992908, 'binary_recall': 0.5474339, 'binary_specificity': 0.9805499, 'binary_f1_score': 0.52225524}
confusion matrix:
       0    1
0  17796  353
1    291  352
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9758709, 'precision': 0.8649787, 'recall': 0.815171, 'specificity': 0.815171, 'f1': 0.8380544, 'auroc': 0.9157388, 'binary_precision': 0.74553573, 'binary_recall': 0.63984674, 'binary_specificity': 0.99049526, 'binary_f1_score': 0.68865985}
confusion matrix:
      0    1
0  5940   57
1    94  167
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754608.png
early stop counter: 1
val acc:0.9657300710678101, best validation acc: 0.9664750695228577, corresponding to test acc:                         0.9782677888870239 / 0.9782677888870239
after epoch: 4,now: 2024-05-23 16:21:28.900092,epoch time: 0:27:49.428219,used: 2:17:58.991571,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_14_03_29_seed_0_20754608
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9683047, 'precision': 0.7569748, 'recall': 0.72342587, 'specificity': 0.72342587, 'f1': 0.7389045, 'auroc': 0.9366505, 'binary_precision': 0.53260016, 'binary_recall': 0.46091095, 'binary_specificity': 0.9859408, 'binary_f1_score': 0.49416912}
confusion matrix:
       0    1
0  41726  595
1    793  678
---- Validation: 
scalar performance:
{'acc': 0.96631545, 'precision': 0.74507606, 'recall': 0.74029315, 'specificity': 0.74029315, 'f1': 0.7426583, 'auroc': 0.9349319, 'binary_precision': 0.50793654, 'binary_recall': 0.4976672, 'binary_specificity': 0.98291916, 'binary_f1_score': 0.50274944}
confusion matrix:
       0    1
0  17839  310
1    323  320
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97698945, 'precision': 0.8818517, 'recall': 0.8084253, 'specificity': 0.8084253, 'f1': 0.8408314, 'auroc': 0.91063416, 'binary_precision': 0.7799043, 'binary_recall': 0.6245211, 'binary_specificity': 0.9923295, 'binary_f1_score': 0.69361705}
confusion matrix:
      0    1
0  5951   46
1    98  163
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754608.png
early stop counter: 2
val acc:0.9663154482841492, best validation acc: 0.9664750695228577, corresponding to test acc:                         0.9782677888870239 / 0.9782677888870239
after epoch: 5,now: 2024-05-23 16:46:43.892025,epoch time: 0:25:14.991933,used: 2:43:13.983504,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_14_03_29_seed_0_20754608
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96903545, 'precision': 0.7622567, 'recall': 0.7505435, 'specificity': 0.7505435, 'f1': 0.75625193, 'auroc': 0.9407244, 'binary_precision': 0.54131055, 'binary_recall': 0.5163044, 'binary_specificity': 0.98478264, 'binary_f1_score': 0.5285118}
confusion matrix:
       0    1
0  41676  644
1    712  760
---- Validation: 
scalar performance:
{'acc': 0.96695405, 'precision': 0.7500092, 'recall': 0.74212384, 'specificity': 0.74212384, 'f1': 0.74599624, 'auroc': 0.9369002, 'binary_precision': 0.5176849, 'binary_recall': 0.5007776, 'binary_specificity': 0.98347014, 'binary_f1_score': 0.5090909}
confusion matrix:
       0    1
0  17849  300
1    321  322
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97730905, 'precision': 0.8869442, 'recall': 0.8067597, 'specificity': 0.8067597, 'f1': 0.8417474, 'auroc': 0.9300856, 'binary_precision': 0.7902439, 'binary_recall': 0.62068963, 'binary_specificity': 0.99282974, 'binary_f1_score': 0.695279}
confusion matrix:
      0    1
0  5954   43
1    99  162
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754608.png
better model found
persisted
after epoch: 6,now: 2024-05-23 17:17:42.567711,epoch time: 0:30:58.675686,used: 3:14:12.659190,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_14_03_29_seed_0_20754608
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.967711, 'precision': 0.751507, 'recall': 0.79313564, 'specificity': 0.79313564, 'f1': 0.7705462, 'auroc': 0.94796175, 'binary_precision': 0.51680183, 'binary_recall': 0.60597825, 'binary_specificity': 0.980293, 'binary_f1_score': 0.55784863}
confusion matrix:
       0    1
0  41486  834
1    580  892
---- Validation: 
scalar performance:
{'acc': 0.96599615, 'precision': 0.7444809, 'recall': 0.7993822, 'specificity': 0.7993822, 'f1': 0.7688229, 'auroc': 0.9411158, 'binary_precision': 0.5025189, 'binary_recall': 0.62052876, 'binary_specificity': 0.9782357, 'binary_f1_score': 0.5553236}
confusion matrix:
       0    1
0  17754  395
1    244  399
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97698945, 'precision': 0.8654901, 'recall': 0.8359103, 'specificity': 0.8359103, 'f1': 0.850008, 'auroc': 0.93084794, 'binary_precision': 0.7447699, 'binary_recall': 0.68199235, 'binary_specificity': 0.9898282, 'binary_f1_score': 0.712}
confusion matrix:
      0    1
0  5936   61
1    83  178
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754608.png
early stop counter: 1
val acc:0.9659961462020874, best validation acc: 0.9669540524482727, corresponding to test acc:                         0.9773090481758118 / 0.9782677888870239
after epoch: 7,now: 2024-05-23 17:48:50.565548,epoch time: 0:31:07.997837,used: 3:45:20.657027,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_14_03_29_seed_0_20754608
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9698575, 'precision': 0.7670462, 'recall': 0.7827711, 'specificity': 0.7827711, 'f1': 0.77465934, 'auroc': 0.9496437, 'binary_precision': 0.54865557, 'binary_recall': 0.58220106, 'binary_specificity': 0.9833412, 'binary_f1_score': 0.56493074}
confusion matrix:
       0    1
0  41615  705
1    615  857
---- Validation: 
scalar performance:
{'acc': 0.9668476, 'precision': 0.74922806, 'recall': 0.7570699, 'specificity': 0.7570699, 'f1': 0.7530812, 'auroc': 0.944581, 'binary_precision': 0.51506025, 'binary_recall': 0.5318818, 'binary_specificity': 0.98225796, 'binary_f1_score': 0.52333593}
confusion matrix:
       0    1
0  17827  322
1    301  342
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9785874, 'precision': 0.8784652, 'recall': 0.84224105, 'specificity': 0.84224105, 'f1': 0.8593453, 'auroc': 0.9372117, 'binary_precision': 0.77021277, 'binary_recall': 0.6934866, 'binary_specificity': 0.9909955, 'binary_f1_score': 0.7298387}
confusion matrix:
      0    1
0  5943   54
1    80  181
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754608.png
new oracle model saved
early stop counter: 2
val acc:0.9668475985527039, best validation acc: 0.9669540524482727, corresponding to test acc:                         0.9773090481758118 / 0.9785873889923096
after epoch: 8,now: 2024-05-23 18:14:05.048857,epoch time: 0:25:14.483309,used: 4:10:35.140336,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_14_03_29_seed_0_20754608
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9669803, 'precision': 0.74669623, 'recall': 0.78816754, 'specificity': 0.78816754, 'f1': 0.7656355, 'auroc': 0.9554732, 'binary_precision': 0.5075145, 'binary_recall': 0.5964674, 'binary_specificity': 0.9798677, 'binary_f1_score': 0.54840726}
confusion matrix:
       0    1
0  41468  852
1    594  878
---- Validation: 
scalar performance:
{'acc': 0.96674114, 'precision': 0.74913514, 'recall': 0.80801857, 'specificity': 0.80801857, 'f1': 0.77508986, 'auroc': 0.9459846, 'binary_precision': 0.51122195, 'binary_recall': 0.63763607, 'binary_specificity': 0.978401, 'binary_f1_score': 0.567474}
confusion matrix:
       0    1
0  17757  392
1    233  410
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97635025, 'precision': 0.86023974, 'recall': 0.83374447, 'specificity': 0.83374447, 'f1': 0.8464302, 'auroc': 0.9405712, 'binary_precision': 0.73443985, 'binary_recall': 0.6781609, 'binary_specificity': 0.989328, 'binary_f1_score': 0.7051793}
confusion matrix:
      0    1
0  5933   64
1    84  177
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754608.png
early stop counter: 3
val acc:0.966741144657135, best validation acc: 0.9669540524482727, corresponding to test acc:                         0.9773090481758118 / 0.9785873889923096
after epoch: 9,now: 2024-05-23 18:38:31.640554,epoch time: 0:24:26.591697,used: 4:35:01.732033,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_14_03_29_seed_0_20754608
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9688984, 'precision': 0.75954235, 'recall': 0.79375, 'specificity': 0.79375, 'f1': 0.77546954, 'auroc': 0.95284903, 'binary_precision': 0.53285545, 'binary_recall': 0.60597825, 'binary_specificity': 0.9815217, 'binary_f1_score': 0.56706923}
confusion matrix:
       0    1
0  41538  782
1    580  892
---- Validation: 
scalar performance:
{'acc': 0.965943, 'precision': 0.7446861, 'recall': 0.81510586, 'specificity': 0.81510586, 'f1': 0.7749205, 'auroc': 0.9481133, 'binary_precision': 0.50179213, 'binary_recall': 0.65318817, 'binary_specificity': 0.97702354, 'binary_f1_score': 0.5675676}
confusion matrix:
       0    1
0  17732  417
1    223  420
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9758709, 'precision': 0.8540652, 'recall': 0.837159, 'specificity': 0.837159, 'f1': 0.845382, 'auroc': 0.9376272, 'binary_precision': 0.7217742, 'binary_recall': 0.68582374, 'binary_specificity': 0.9884942, 'binary_f1_score': 0.7033399}
confusion matrix:
      0    1
0  5928   69
1    82  179
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754608.png
early stop counter: 4
val acc:0.9659429788589478, best validation acc: 0.9669540524482727, corresponding to test acc:                         0.9773090481758118 / 0.9785873889923096
after epoch: 10,now: 2024-05-23 19:02:38.274288,epoch time: 0:24:06.633734,used: 4:59:08.365767,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_14_03_29_seed_0_20754608
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96969765, 'precision': 0.7698797, 'recall': 0.7305588, 'specificity': 0.7305588, 'f1': 0.74851626, 'auroc': 0.95211804, 'binary_precision': 0.55795366, 'binary_recall': 0.47418478, 'binary_specificity': 0.9869329, 'binary_f1_score': 0.51266986}
confusion matrix:
       0    1
0  41767  553
1    774  698
---- Validation: 
scalar performance:
{'acc': 0.9667944, 'precision': 0.74930215, 'recall': 0.7982954, 'specificity': 0.7982954, 'f1': 0.7713449, 'auroc': 0.9497908, 'binary_precision': 0.51225805, 'binary_recall': 0.61741835, 'binary_specificity': 0.9791724, 'binary_f1_score': 0.5599436}
confusion matrix:
       0    1
0  17771  378
1    246  397
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9741131, 'precision': 0.8713132, 'recall': 0.7721102, 'specificity': 0.7721102, 'f1': 0.8132869, 'auroc': 0.9366324, 'binary_precision': 0.7619048, 'binary_recall': 0.55172414, 'binary_specificity': 0.99249625, 'binary_f1_score': 0.64}
confusion matrix:
      0    1
0  5952   45
1   117  144
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754608.png
early stop counter: 5
val acc:0.9667943716049194, best validation acc: 0.9669540524482727, corresponding to test acc:                         0.9773090481758118 / 0.9785873889923096
after epoch: 11,now: 2024-05-23 19:27:58.959852,epoch time: 0:25:20.685564,used: 5:24:29.051331,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_14_03_29_seed_0_20754608
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.96800786, 'precision': 0.7534653, 'recall': 0.80115783, 'specificity': 0.80115783, 'f1': 0.7750236, 'auroc': 0.9572746, 'binary_precision': 0.520159, 'binary_recall': 0.6222826, 'binary_specificity': 0.9800331, 'binary_f1_score': 0.56665635}
confusion matrix:
       0    1
0  41475  845
1    556  916
---- Validation: 
scalar performance:
{'acc': 0.9661558, 'precision': 0.74611485, 'recall': 0.8227166, 'specificity': 0.8227166, 'f1': 0.7786213, 'auroc': 0.9515137, 'binary_precision': 0.5041032, 'binary_recall': 0.6687403, 'binary_specificity': 0.9766929, 'binary_f1_score': 0.5748663}
confusion matrix:
       0    1
0  17726  423
1    213  430
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97203577, 'precision': 0.8288733, 'recall': 0.81316996, 'specificity': 0.81316996, 'f1': 0.82080686, 'auroc': 0.94004875, 'binary_precision': 0.6733871, 'binary_recall': 0.63984674, 'binary_specificity': 0.98649323, 'binary_f1_score': 0.6561886}
confusion matrix:
      0    1
0  5916   81
1    94  167
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754608.png
early stop counter: 6
val acc:0.9661558270454407, best validation acc: 0.9669540524482727, corresponding to test acc:                         0.9773090481758118 / 0.9785873889923096
after epoch: 12,now: 2024-05-23 19:55:08.511069,epoch time: 0:27:09.551217,used: 5:51:38.602548,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_14_03_29_seed_0_20754608
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9670944, 'precision': 0.74713856, 'recall': 0.7721615, 'specificity': 0.7721615, 'f1': 0.75897753, 'auroc': 0.957422, 'binary_precision': 0.5095267, 'binary_recall': 0.5631794, 'binary_specificity': 0.98114365, 'binary_f1_score': 0.5350113}
confusion matrix:
       0    1
0  41522  798
1    643  829
---- Validation: 
scalar performance:
{'acc': 0.9680715, 'precision': 0.7576883, 'recall': 0.7877058, 'specificity': 0.7877058, 'f1': 0.7717759, 'auroc': 0.9541374, 'binary_precision': 0.52981967, 'binary_recall': 0.5940902, 'binary_specificity': 0.9813213, 'binary_f1_score': 0.56011724}
confusion matrix:
       0    1
0  17810  339
1    261  382
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9713966, 'precision': 0.83563894, 'recall': 0.77985454, 'specificity': 0.77985454, 'f1': 0.80493486, 'auroc': 0.9278696, 'binary_precision': 0.6898148, 'binary_recall': 0.57088125, 'binary_specificity': 0.98882776, 'binary_f1_score': 0.624738}
confusion matrix:
      0    1
0  5930   67
1   112  149
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754608.png
better model found
persisted
after epoch: 13,now: 2024-05-23 20:19:31.267262,epoch time: 0:24:22.756193,used: 6:16:01.358741,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_14_03_29_seed_0_20754608
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96579283, 'precision': 0.7401433, 'recall': 0.81124663, 'specificity': 0.81124663, 'f1': 0.77054965, 'auroc': 0.957855, 'binary_precision': 0.49273103, 'binary_recall': 0.6455782, 'binary_specificity': 0.97691506, 'binary_f1_score': 0.55889285}
confusion matrix:
       0    1
0  41345  977
1    521  949
---- Validation: 
scalar performance:
{'acc': 0.964453, 'precision': 0.73611224, 'recall': 0.80683386, 'specificity': 0.80683386, 'f1': 0.7662846, 'auroc': 0.95242584, 'binary_precision': 0.4852071, 'binary_recall': 0.63763607, 'binary_specificity': 0.9760317, 'binary_f1_score': 0.5510753}
confusion matrix:
       0    1
0  17714  435
1    233  410
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.7480526, 'recall': 0.73712146, 'specificity': 0.73712146, 'f1': 0.7424464, 'auroc': 0.9241587, 'binary_precision': 0.5180723, 'binary_recall': 0.49425286, 'binary_specificity': 0.97999, 'binary_f1_score': 0.5058824}
confusion matrix:
      0    1
0  5877  120
1   132  129
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754608.png
early stop counter: 1
val acc:0.9644529819488525, best validation acc: 0.9680715203285217, corresponding to test acc:                         0.9713966250419617 / 0.9785873889923096
after epoch: 14,now: 2024-05-23 20:43:50.902227,epoch time: 0:24:19.634965,used: 6:40:20.993706,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_14_03_29_seed_0_20754608
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.96750546, 'precision': 0.7499677, 'recall': 0.7996565, 'specificity': 0.7996565, 'f1': 0.77230346, 'auroc': 0.96144736, 'binary_precision': 0.51323944, 'binary_recall': 0.6197279, 'binary_specificity': 0.9795851, 'binary_f1_score': 0.5614792}
confusion matrix:
       0    1
0  41458  864
1    559  911
---- Validation: 
scalar performance:
{'acc': 0.9668476, 'precision': 0.74977493, 'recall': 0.80807364, 'specificity': 0.80807364, 'f1': 0.77551126, 'auroc': 0.9562259, 'binary_precision': 0.5125, 'binary_recall': 0.63763607, 'binary_specificity': 0.9785112, 'binary_f1_score': 0.5682606}
confusion matrix:
       0    1
0  17759  390
1    233  410
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96756154, 'precision': 0.8129271, 'recall': 0.73754215, 'specificity': 0.73754215, 'f1': 0.7694824, 'auroc': 0.9331473, 'binary_precision': 0.6479592, 'binary_recall': 0.48659003, 'binary_specificity': 0.9884942, 'binary_f1_score': 0.5557987}
confusion matrix:
      0    1
0  5928   69
1   134  127
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754608.png
early stop counter: 2
val acc:0.9668475985527039, best validation acc: 0.9680715203285217, corresponding to test acc:                         0.9713966250419617 / 0.9785873889923096
after epoch: 15,now: 2024-05-23 21:08:32.333894,epoch time: 0:24:41.431667,used: 7:05:02.425373,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_14_03_29_seed_0_20754608
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9691496, 'precision': 0.76096773, 'recall': 0.8056829, 'specificity': 0.8056829, 'f1': 0.7813613, 'auroc': 0.9608954, 'binary_precision': 0.5348703, 'binary_recall': 0.6304348, 'binary_specificity': 0.980931, 'binary_f1_score': 0.57873404}
confusion matrix:
       0    1
0  41513  807
1    544  928
---- Validation: 
scalar performance:
{'acc': 0.9661558, 'precision': 0.74602544, 'recall': 0.8197164, 'specificity': 0.8197164, 'f1': 0.7774805, 'auroc': 0.9536681, 'binary_precision': 0.504142, 'binary_recall': 0.66251945, 'binary_specificity': 0.97691333, 'binary_f1_score': 0.5725806}
confusion matrix:
       0    1
0  17730  419
1    217  426
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96660274, 'precision': 0.80753446, 'recall': 0.72421557, 'specificity': 0.72421557, 'f1': 0.7586006, 'auroc': 0.9284284, 'binary_precision': 0.63829786, 'binary_recall': 0.4597701, 'binary_specificity': 0.988661, 'binary_f1_score': 0.5345211}
confusion matrix:
      0    1
0  5929   68
1   141  120
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754608.png
early stop counter: 3
val acc:0.9661558270454407, best validation acc: 0.9680715203285217, corresponding to test acc:                         0.9713966250419617 / 0.9785873889923096
after epoch: 16,now: 2024-05-23 21:32:12.401264,epoch time: 0:23:40.067370,used: 7:28:42.492743,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_14_03_29_seed_0_20754608
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9688984, 'precision': 0.75929415, 'recall': 0.8048972, 'specificity': 0.8048972, 'f1': 0.7800429, 'auroc': 0.9602159, 'binary_precision': 0.5315729, 'binary_recall': 0.62907606, 'binary_specificity': 0.9807183, 'binary_f1_score': 0.576229}
confusion matrix:
       0    1
0  41504  816
1    546  926
---- Validation: 
scalar performance:
{'acc': 0.966688, 'precision': 0.7490178, 'recall': 0.8184918, 'specificity': 0.8184918, 'f1': 0.77898467, 'auroc': 0.9540654, 'binary_precision': 0.51022863, 'binary_recall': 0.65940905, 'binary_specificity': 0.9775745, 'binary_f1_score': 0.5753053}
confusion matrix:
       0    1
0  17742  407
1    219  424
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96756154, 'precision': 0.81576025, 'recall': 0.7302128, 'specificity': 0.7302128, 'f1': 0.7655307, 'auroc': 0.94117284, 'binary_precision': 0.65425533, 'binary_recall': 0.47126436, 'binary_specificity': 0.98916125, 'binary_f1_score': 0.54788417}
confusion matrix:
      0    1
0  5932   65
1   138  123
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754608.png
early stop counter: 4
val acc:0.9666879773139954, best validation acc: 0.9680715203285217, corresponding to test acc:                         0.9713966250419617 / 0.9785873889923096
after epoch: 17,now: 2024-05-23 21:57:03.118561,epoch time: 0:24:50.717297,used: 7:53:33.210040,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_14_03_29_seed_0_20754608
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9671173, 'precision': 0.7488646, 'recall': 0.8514229, 'specificity': 0.8514229, 'f1': 0.7903116, 'auroc': 0.9652293, 'binary_precision': 0.50734943, 'binary_recall': 0.7273963, 'binary_specificity': 0.97544956, 'binary_f1_score': 0.5977653}
confusion matrix:
       0     1
0  41282  1039
1    401  1070
---- Validation: 
scalar performance:
{'acc': 0.9647722, 'precision': 0.74068505, 'recall': 0.8617532, 'specificity': 0.8617532, 'f1': 0.7874774, 'auroc': 0.9558367, 'binary_precision': 0.49035534, 'binary_recall': 0.7511664, 'binary_specificity': 0.97234005, 'binary_f1_score': 0.59336615}
confusion matrix:
       0    1
0  17647  502
1    160  483
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9685203, 'precision': 0.8066779, 'recall': 0.7875154, 'specificity': 0.7875154, 'f1': 0.79674965, 'auroc': 0.9415067, 'binary_precision': 0.63114756, 'binary_recall': 0.5900383, 'binary_specificity': 0.9849925, 'binary_f1_score': 0.60990095}
confusion matrix:
      0    1
0  5907   90
1   107  154
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754608.png
early stop counter: 5
val acc:0.9647722244262695, best validation acc: 0.9680715203285217, corresponding to test acc:                         0.9713966250419617 / 0.9785873889923096
after epoch: 18,now: 2024-05-23 22:20:37.235718,epoch time: 0:23:34.117157,used: 8:17:07.327197,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_14_03_29_seed_0_20754608
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9689441, 'precision': 0.7596253, 'recall': 0.797577, 'specificity': 0.797577, 'f1': 0.7771628, 'auroc': 0.9583951, 'binary_precision': 0.53274333, 'binary_recall': 0.6138681, 'binary_specificity': 0.98128587, 'binary_f1_score': 0.5704359}
confusion matrix:
       0    1
0  41529  792
1    568  903
---- Validation: 
scalar performance:
{'acc': 0.9665815, 'precision': 0.7485037, 'recall': 0.822937, 'specificity': 0.822937, 'f1': 0.78027946, 'auroc': 0.95548004, 'binary_precision': 0.5088757, 'binary_recall': 0.6687403, 'binary_specificity': 0.97713375, 'binary_f1_score': 0.577957}
confusion matrix:
       0    1
0  17734  415
1    213  430
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9678811, 'precision': 0.8302895, 'recall': 0.70839155, 'specificity': 0.70839155, 'f1': 0.7541008, 'auroc': 0.9381645, 'binary_precision': 0.6851852, 'binary_recall': 0.42528737, 'binary_specificity': 0.9914957, 'binary_f1_score': 0.5248227}
confusion matrix:
      0    1
0  5946   51
1   150  111
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754608.png
early stop counter: 6
val acc:0.9665815234184265, best validation acc: 0.9680715203285217, corresponding to test acc:                         0.9713966250419617 / 0.9785873889923096
after epoch: 19,now: 2024-05-23 22:44:28.309756,epoch time: 0:23:51.074038,used: 8:40:58.401235,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_14_03_29_seed_0_20754608
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.96800786, 'precision': 0.7534715, 'recall': 0.84620976, 'specificity': 0.84620976, 'f1': 0.7918112, 'auroc': 0.96112823, 'binary_precision': 0.5169533, 'binary_recall': 0.71564627, 'binary_specificity': 0.9767733, 'binary_f1_score': 0.6002853}
confusion matrix:
       0     1
0  41339   983
1    418  1052
---- Validation: 
scalar performance:
{'acc': 0.96471906, 'precision': 0.7403983, 'recall': 0.8609756, 'specificity': 0.8609756, 'f1': 0.7870314, 'auroc': 0.959023, 'binary_precision': 0.4898374, 'binary_recall': 0.7496112, 'binary_specificity': 0.97234005, 'binary_f1_score': 0.5925016}
confusion matrix:
       0    1
0  17647  502
1    161  482
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97235537, 'precision': 0.83226573, 'recall': 0.81150436, 'specificity': 0.81150436, 'f1': 0.82151115, 'auroc': 0.93965805, 'binary_precision': 0.6803279, 'binary_recall': 0.6360153, 'binary_specificity': 0.9869935, 'binary_f1_score': 0.6574257}
confusion matrix:
      0    1
0  5919   78
1    95  166
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754608.png
early stop counter: 7
val acc:0.9647190570831299, best validation acc: 0.9680715203285217, corresponding to test acc:                         0.9713966250419617 / 0.9785873889923096
after epoch: 20,now: 2024-05-23 23:08:03.747167,epoch time: 0:23:35.437411,used: 9:04:33.838646,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_14_03_29_seed_0_20754608
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.96846455, 'precision': 0.7562704, 'recall': 0.8371308, 'specificity': 0.8371308, 'f1': 0.7905414, 'auroc': 0.96535575, 'binary_precision': 0.52322614, 'binary_recall': 0.6963315, 'binary_specificity': 0.97793007, 'binary_f1_score': 0.5974934}
confusion matrix:
       0     1
0  41386   934
1    447  1025
---- Validation: 
scalar performance:
{'acc': 0.9665815, 'precision': 0.74874276, 'recall': 0.8334378, 'specificity': 0.8334378, 'f1': 0.78417015, 'auroc': 0.95511174, 'binary_precision': 0.50859106, 'binary_recall': 0.6905132, 'binary_specificity': 0.97636235, 'binary_f1_score': 0.58575195}
confusion matrix:
       0    1
0  17720  429
1    199  444
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9694791, 'precision': 0.8370482, 'recall': 0.73304564, 'specificity': 0.73304564, 'f1': 0.7745525, 'auroc': 0.9489552, 'binary_precision': 0.6966292, 'binary_recall': 0.47509578, 'binary_specificity': 0.9909955, 'binary_f1_score': 0.56492025}
confusion matrix:
      0    1
0  5943   54
1   137  124
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754608.png
early stop counter: 8
val acc:0.9665815234184265, best validation acc: 0.9680715203285217, corresponding to test acc:                         0.9713966250419617 / 0.9785873889923096
after epoch: 21,now: 2024-05-23 23:31:38.465884,epoch time: 0:23:34.718717,used: 9:28:08.557363,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_14_03_29_seed_0_20754608
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.96789366, 'precision': 0.75320923, 'recall': 0.8571627, 'specificity': 0.8571627, 'f1': 0.79526263, 'auroc': 0.9663571, 'binary_precision': 0.5156546, 'binary_recall': 0.73845106, 'binary_specificity': 0.9758743, 'binary_f1_score': 0.60726255}
confusion matrix:
       0     1
0  41299  1021
1    385  1087
---- Validation: 
scalar performance:
{'acc': 0.96546406, 'precision': 0.7436906, 'recall': 0.85536087, 'specificity': 0.85536087, 'f1': 0.78778934, 'auroc': 0.9600603, 'binary_precision': 0.49685535, 'binary_recall': 0.7371695, 'binary_specificity': 0.9735523, 'binary_f1_score': 0.593613}
confusion matrix:
       0    1
0  17669  480
1    169  474
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9689997, 'precision': 0.8086986, 'recall': 0.79509485, 'specificity': 0.79509485, 'f1': 0.8017247, 'auroc': 0.9384601, 'binary_precision': 0.6345382, 'binary_recall': 0.60536397, 'binary_specificity': 0.98482573, 'binary_f1_score': 0.61960787}
confusion matrix:
      0    1
0  5906   91
1   103  158
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754608.png
early stop counter: 9
val acc:0.9654640555381775, best validation acc: 0.9680715203285217, corresponding to test acc:                         0.9713966250419617 / 0.9785873889923096
after epoch: 22,now: 2024-05-23 23:55:16.223672,epoch time: 0:23:37.757788,used: 9:51:46.315151,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_14_03_29_seed_0_20754608
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9653133, 'precision': 0.7388964, 'recall': 0.8394624, 'specificity': 0.8394624, 'f1': 0.77933896, 'auroc': 0.96443015, 'binary_precision': 0.48820755, 'binary_recall': 0.70456094, 'binary_specificity': 0.9743638, 'binary_f1_score': 0.5767624}
confusion matrix:
       0     1
0  41238  1085
1    434  1035
---- Validation: 
scalar performance:
{'acc': 0.96152616, 'precision': 0.7259186, 'recall': 0.8548223, 'specificity': 0.8548223, 'f1': 0.774112, 'auroc': 0.9586786, 'binary_precision': 0.46124032, 'binary_recall': 0.7402799, 'binary_specificity': 0.9693647, 'binary_f1_score': 0.5683582}
confusion matrix:
       0    1
0  17593  556
1    167  476
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96676254, 'precision': 0.8037305, 'recall': 0.7407899, 'specificity': 0.7407899, 'f1': 0.76819336, 'auroc': 0.93437076, 'binary_precision': 0.6292683, 'binary_recall': 0.49425286, 'binary_specificity': 0.987327, 'binary_f1_score': 0.5536481}
confusion matrix:
      0    1
0  5921   76
1   132  129
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754608.png
early stop counter: 10
val acc:0.9615261554718018, best validation acc: 0.9680715203285217, corresponding to test acc:                         0.9713966250419617 / 0.9785873889923096
after epoch: 23,now: 2024-05-24 00:18:51.153377,epoch time: 0:23:34.929705,used: 10:15:21.244856,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_14_03_29_seed_0_20754608
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9676653, 'precision': 0.7517407, 'recall': 0.8413073, 'specificity': 0.8413073, 'f1': 0.78894734, 'auroc': 0.9676008, 'binary_precision': 0.51384765, 'binary_recall': 0.7058424, 'binary_specificity': 0.9767722, 'binary_f1_score': 0.5947338}
confusion matrix:
       0     1
0  41337   983
1    433  1039
---- Validation: 
scalar performance:
{'acc': 0.9648787, 'precision': 0.7410022, 'recall': 0.8580581, 'specificity': 0.8580581, 'f1': 0.7866173, 'auroc': 0.9620012, 'binary_precision': 0.49126413, 'binary_recall': 0.7433904, 'binary_specificity': 0.97272575, 'binary_f1_score': 0.59158415}
confusion matrix:
       0    1
0  17654  495
1    165  478
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9693193, 'precision': 0.8231697, 'recall': 0.7586149, 'specificity': 0.7586149, 'f1': 0.7869036, 'auroc': 0.94731915, 'binary_precision': 0.6666667, 'binary_recall': 0.52873564, 'binary_specificity': 0.9884942, 'binary_f1_score': 0.58974355}
confusion matrix:
      0    1
0  5928   69
1   123  138
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754608.png
early stop counter: 11
val acc:0.9648786783218384, best validation acc: 0.9680715203285217, corresponding to test acc:                         0.9713966250419617 / 0.9785873889923096
after epoch: 24,now: 2024-05-24 00:42:35.218905,epoch time: 0:23:44.065528,used: 10:39:05.310384,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_14_03_29_seed_0_20754608
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.96618104, 'precision': 0.7456272, 'recall': 0.88939035, 'specificity': 0.88939035, 'f1': 0.79916716, 'auroc': 0.9692359, 'binary_precision': 0.49811321, 'binary_recall': 0.8070652, 'binary_specificity': 0.9717155, 'binary_f1_score': 0.6160228}
confusion matrix:
       0     1
0  41123  1197
1    284  1188
---- Validation: 
scalar performance:
{'acc': 0.9638676, 'precision': 0.73816425, 'recall': 0.88903695, 'specificity': 0.88903695, 'f1': 0.7930354, 'auroc': 0.9621014, 'binary_precision': 0.4832714, 'binary_recall': 0.8087092, 'binary_specificity': 0.9693647, 'binary_f1_score': 0.6050029}
confusion matrix:
       0    1
0  17593  556
1    123  520
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9747523, 'precision': 0.8388384, 'recall': 0.851234, 'specificity': 0.851234, 'f1': 0.8449117, 'auroc': 0.9430231, 'binary_precision': 0.6900369, 'binary_recall': 0.71647507, 'binary_specificity': 0.98599297, 'binary_f1_score': 0.7030075}
confusion matrix:
      0    1
0  5913   84
1    74  187
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754608.png
early stop counter: 12
val acc:0.9638676047325134, best validation acc: 0.9680715203285217, corresponding to test acc:                         0.9713966250419617 / 0.9785873889923096
after epoch: 25,now: 2024-05-24 01:06:14.314895,epoch time: 0:23:39.095990,used: 11:02:44.406374,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_14_03_29_seed_0_20754608
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9651306, 'precision': 0.7387634, 'recall': 0.8475366, 'specificity': 0.8475366, 'f1': 0.7817826, 'auroc': 0.9683466, 'binary_precision': 0.48737952, 'binary_recall': 0.7214674, 'binary_specificity': 0.9736059, 'binary_f1_score': 0.5817584}
confusion matrix:
       0     1
0  41203  1117
1    410  1062
---- Validation: 
scalar performance:
{'acc': 0.96136653, 'precision': 0.72692883, 'recall': 0.8742411, 'specificity': 0.8742411, 'f1': 0.780049, 'auroc': 0.9619012, 'binary_precision': 0.46182153, 'binary_recall': 0.7807154, 'binary_specificity': 0.9677668, 'binary_f1_score': 0.5803468}
confusion matrix:
       0    1
0  17564  585
1    141  502
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9654842, 'precision': 0.7993766, 'recall': 0.7126379, 'specificity': 0.7126379, 'f1': 0.7478104, 'auroc': 0.9291303, 'binary_precision': 0.6229508, 'binary_recall': 0.43678162, 'binary_specificity': 0.9884942, 'binary_f1_score': 0.5135135}
confusion matrix:
      0    1
0  5928   69
1   147  114
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754608.png
early stop counter: 13
val acc:0.9613665342330933, best validation acc: 0.9680715203285217, corresponding to test acc:                         0.9713966250419617 / 0.9785873889923096
after epoch: 26,now: 2024-05-24 01:29:33.729062,epoch time: 0:23:19.414167,used: 11:26:03.820541,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_14_03_29_seed_0_20754608
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9657472, 'precision': 0.74154216, 'recall': 0.8416263, 'specificity': 0.8416263, 'f1': 0.7819245, 'auroc': 0.966215, 'binary_precision': 0.49337748, 'binary_recall': 0.7085598, 'binary_specificity': 0.9746928, 'binary_f1_score': 0.5817066}
confusion matrix:
       0     1
0  41249  1071
1    429  1043
---- Validation: 
scalar performance:
{'acc': 0.96290976, 'precision': 0.7332647, 'recall': 0.87504005, 'specificity': 0.87504005, 'f1': 0.7854084, 'auroc': 0.9620387, 'binary_precision': 0.47448015, 'binary_recall': 0.7807154, 'binary_specificity': 0.9693647, 'binary_f1_score': 0.590241}
confusion matrix:
       0    1
0  17593  556
1    141  502
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9637264, 'precision': 0.7767519, 'recall': 0.74103814, 'specificity': 0.74103814, 'f1': 0.75750494, 'auroc': 0.93295884, 'binary_precision': 0.57522124, 'binary_recall': 0.49808428, 'binary_specificity': 0.983992, 'binary_f1_score': 0.5338809}
confusion matrix:
      0    1
0  5901   96
1   131  130
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754608.png
early stop counter: 14
val acc:0.9629097580909729, best validation acc: 0.9680715203285217, corresponding to test acc:                         0.9713966250419617 / 0.9785873889923096
after epoch: 27,now: 2024-05-24 01:54:16.426184,epoch time: 0:24:42.697122,used: 11:50:46.517663,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_14_03_29_seed_0_20754608
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9591478, 'precision': 0.71643335, 'recall': 0.87919426, 'specificity': 0.87919426, 'f1': 0.77243364, 'auroc': 0.96966773, 'binary_precision': 0.44025633, 'binary_recall': 0.79347825, 'binary_specificity': 0.9649102, 'binary_f1_score': 0.566303}
confusion matrix:
       0     1
0  40835  1485
1    304  1168
---- Validation: 
scalar performance:
{'acc': 0.95881224, 'precision': 0.71914333, 'recall': 0.8924202, 'specificity': 0.8924202, 'f1': 0.77770066, 'auroc': 0.9630079, 'binary_precision': 0.44481888, 'binary_recall': 0.82115084, 'binary_specificity': 0.96368945, 'binary_f1_score': 0.5770492}
confusion matrix:
       0    1
0  17490  659
1    115  528
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96244806, 'precision': 0.76281536, 'recall': 0.82282615, 'specificity': 0.82282615, 'f1': 0.789297, 'auroc': 0.9487215, 'binary_precision': 0.54012346, 'binary_recall': 0.6704981, 'binary_specificity': 0.9751542, 'binary_f1_score': 0.59829056}
confusion matrix:
      0    1
0  5848  149
1    86  175
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754608.png
early stop counter: 15
val acc:0.9588122367858887, best validation acc: 0.9680715203285217, corresponding to test acc:                         0.9713966250419617 / 0.9785873889923096
after epoch: 28,now: 2024-05-24 02:17:52.710414,epoch time: 0:23:36.284230,used: 12:14:22.801893,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_14_03_29_seed_0_20754608
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9643999, 'precision': 0.7367142, 'recall': 0.87298334, 'specificity': 0.87298334, 'f1': 0.78764427, 'auroc': 0.96824515, 'binary_precision': 0.4814189, 'binary_recall': 0.774983, 'binary_specificity': 0.9709837, 'binary_f1_score': 0.5939046}
confusion matrix:
       0     1
0  41093  1228
1    331  1140
---- Validation: 
scalar performance:
{'acc': 0.9605683, 'precision': 0.7248556, 'recall': 0.88582873, 'specificity': 0.88582873, 'f1': 0.78115535, 'auroc': 0.96190405, 'binary_precision': 0.45679012, 'binary_recall': 0.80559874, 'binary_specificity': 0.96605873, 'binary_f1_score': 0.5830051}
confusion matrix:
       0    1
0  17533  616
1    125  518
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9653244, 'precision': 0.7896972, 'recall': 0.7437042, 'specificity': 0.7437042, 'f1': 0.7644726, 'auroc': 0.928918, 'binary_precision': 0.60091746, 'binary_recall': 0.5019157, 'binary_specificity': 0.98549277, 'binary_f1_score': 0.5469729}
confusion matrix:
      0    1
0  5910   87
1   130  131
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754608.png
early stop counter: 16
val acc:0.9605683088302612, best validation acc: 0.9680715203285217, corresponding to test acc:                         0.9713966250419617 / 0.9785873889923096
after epoch: 29,now: 2024-05-24 02:41:34.274670,epoch time: 0:23:41.564256,used: 12:38:04.366149,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_14_03_29_seed_0_20754608
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.96401167, 'precision': 0.73482746, 'recall': 0.8701578, 'specificity': 0.8701578, 'f1': 0.78538203, 'auroc': 0.96918255, 'binary_precision': 0.47783875, 'binary_recall': 0.76954454, 'binary_specificity': 0.970771, 'binary_f1_score': 0.58958334}
confusion matrix:
       0     1
0  41084  1237
1    339  1132
---- Validation: 
scalar performance:
{'acc': 0.96152616, 'precision': 0.7273203, 'recall': 0.8713235, 'specificity': 0.8713235, 'f1': 0.7796238, 'auroc': 0.96288335, 'binary_precision': 0.46282527, 'binary_recall': 0.7744945, 'binary_specificity': 0.9681525, 'binary_f1_score': 0.57940656}
confusion matrix:
       0    1
0  17571  578
1    145  498
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96772134, 'precision': 0.8145904, 'recall': 0.7376255, 'specificity': 0.7376255, 'f1': 0.770134, 'auroc': 0.93367374, 'binary_precision': 0.6512821, 'binary_recall': 0.48659003, 'binary_specificity': 0.988661, 'binary_f1_score': 0.55701756}
confusion matrix:
      0    1
0  5929   68
1   134  127
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754608.png
early stop counter: 17
val acc:0.9615261554718018, best validation acc: 0.9680715203285217, corresponding to test acc:                         0.9713966250419617 / 0.9785873889923096
after epoch: 30,now: 2024-05-24 03:04:49.754411,epoch time: 0:23:15.479741,used: 13:01:19.845890,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_14_03_29_seed_0_20754608
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 13:01:19.845890 at 2024-05-24 03:04:49.754411
persisted model performance metric: 

scalar performance:
{'acc': 0.9713966, 'precision': 0.8348479, 'recall': 0.7816868, 'specificity': 0.7816868, 'f1': 0.805717, 'auroc': 0.93396014, 'binary_precision': 0.6880734, 'binary_recall': 0.57471263, 'binary_specificity': 0.988661, 'binary_f1_score': 0.6263048}
confusion matrix:
      0    1
0  5929   68
1   111  150
oracle model performance metric: 

scalar performance:
{'acc': 0.9784276, 'precision': 0.87789226, 'recall': 0.84032536, 'specificity': 0.84032536, 'f1': 0.8580212, 'auroc': 0.9324094, 'binary_precision': 0.7692308, 'binary_recall': 0.6896552, 'binary_specificity': 0.9909955, 'binary_f1_score': 0.72727275}
confusion matrix:
      0    1
0  5943   54
1    81  180
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dial_irm/rule_results/4.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dial_irm/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dial_irm/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 493147 KiB |  10997 MiB |    907 TiB |    907 TiB |
|       from large pool | 403328 KiB |  10925 MiB |    904 TiB |    904 TiB |
|       from small pool |  89819 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 493147 KiB |  10997 MiB |    907 TiB |    907 TiB |
|       from large pool | 403328 KiB |  10925 MiB |    904 TiB |    904 TiB |
|       from small pool |  89819 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476573 KiB |  10880 MiB |    898 TiB |    898 TiB |
|       from large pool | 387840 KiB |  10808 MiB |    895 TiB |    895 TiB |
|       from small pool |  88733 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11482 MiB |  11482 MiB |  11482 MiB |      0 B   |
|       from large pool |  11356 MiB |  11356 MiB |  11356 MiB |      0 B   |
|       from small pool |    126 MiB |    126 MiB |    126 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 752036 KiB |   1325 MiB | 384641 GiB | 384640 GiB |
|       from large pool | 741504 KiB |   1322 MiB | 381641 GiB | 381641 GiB |
|       from small pool |  10532 KiB |     11 MiB |   2999 GiB |   2999 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3729    |    6720    |  139676 K  |  139672 K  |
|       from large pool |      87    |     908    |   56777 K  |   56777 K  |
|       from small pool |    3642    |    6631    |   82898 K  |   82894 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3729    |    6720    |  139676 K  |  139672 K  |
|       from large pool |      87    |     908    |   56777 K  |   56777 K  |
|       from small pool |    3642    |    6631    |   82898 K  |   82894 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     404    |     404    |     404    |       0    |
|       from large pool |     341    |     341    |     341    |       0    |
|       from small pool |      63    |      63    |      63    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      74    |    2767    |   74812 K  |   74812 K  |
|       from large pool |      19    |     187    |   34810 K  |   34810 K  |
|       from small pool |      55    |    2747    |   40001 K  |   40001 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10997 MiB |    907 TiB |    907 TiB |
|       from large pool |  16640 KiB |  10925 MiB |    904 TiB |    904 TiB |
|       from small pool |      0 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10997 MiB |    907 TiB |    907 TiB |
|       from large pool |  16640 KiB |  10925 MiB |    904 TiB |    904 TiB |
|       from small pool |      0 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10880 MiB |    898 TiB |    898 TiB |
|       from large pool |  16640 KiB |  10808 MiB |    895 TiB |    895 TiB |
|       from small pool |      0 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1216 MiB |  11482 MiB |  11482 MiB |  10266 MiB |
|       from large pool |   1118 MiB |  11356 MiB |  11356 MiB |  10238 MiB |
|       from small pool |     98 MiB |    126 MiB |    126 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1325 MiB | 384641 GiB | 384641 GiB |
|       from large pool |  50944 KiB |   1322 MiB | 381642 GiB | 381642 GiB |
|       from small pool |      0 KiB |     24 MiB |   2999 GiB |   2999 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6720    |  139676 K  |  139676 K  |
|       from large pool |       2    |     908    |   56777 K  |   56777 K  |
|       from small pool |       0    |    6631    |   82898 K  |   82898 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6720    |  139676 K  |  139676 K  |
|       from large pool |       2    |     908    |   56777 K  |   56777 K  |
|       from small pool |       0    |    6631    |   82898 K  |   82898 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      79    |     404    |     404    |     325    |
|       from large pool |      30    |     341    |     341    |     311    |
|       from small pool |      49    |      63    |      63    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2767    |   74813 K  |   74813 K  |
|       from large pool |       4    |     187    |   34810 K  |   34810 K  |
|       from small pool |       0    |    2747    |   40003 K  |   40003 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Fri May 24 03:07:17 2024]
Finished job 0.
1 of 1 steps (100%) done
